{"version":3,"file":"module.js","sources":["src/constants/constants.js","src/systems/dnd4e.js","src/systems/dnd4e-0.4.43.js","node_modules/svelte/src/runtime/internal/utils.js","node_modules/svelte/src/runtime/internal/environment.js","node_modules/svelte/src/runtime/internal/loop.js","node_modules/svelte/src/runtime/internal/globals.js","node_modules/svelte/src/runtime/internal/dom.js","node_modules/svelte/src/runtime/internal/style_manager.js","node_modules/svelte/src/runtime/internal/animations.js","node_modules/svelte/src/runtime/internal/lifecycle.js","node_modules/svelte/src/runtime/internal/scheduler.js","node_modules/svelte/src/runtime/internal/transitions.js","node_modules/svelte/src/runtime/internal/each.js","node_modules/svelte/src/runtime/internal/spread.js","node_modules/svelte/src/runtime/internal/Component.js","node_modules/svelte/src/shared/version.js","node_modules/svelte/src/runtime/internal/disclose-version/index.js","src/helpers/caches.js","src/helpers/sharing-utilities.js","node_modules/@typhonjs-fvtt/runtime/_dist/util/object/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/util/browser/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/cssVariables.js","node_modules/@typhonjs-fvtt/runtime/_dist/util/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/util/store/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/action/dom/index.js","node_modules/svelte/src/runtime/easing/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/math/interpolate/index.js","node_modules/svelte/src/runtime/transition/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/transition/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/TJSGlassPane.svelte","node_modules/svelte/src/runtime/store/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/AppShellContextInternal.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/util/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/helper/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/store/writable-derived/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/math/gl-matrix/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/util/animate/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/math/util/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/store/position/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/TJSHeaderButton.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/TJSApplicationHeader.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/TJSFocusWrap.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/ResizableHandle.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/ApplicationShell.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/dialog/DialogContent.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/dialog/DialogShell.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/index.js","src/applications/components/SliderInput.svelte","src/applications/dialogs/drop-item-dialog/drop-item-dialog-shell.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/state-app/ApplicationState.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/state-svelte/GetSvelteData.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/store/web-storage/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/state-reactive/SvelteReactive.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/util/applicationShellContract.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/util/isApplicationShell.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/util/loadSvelteConfig.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/TJSAppIndex.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/SvelteApplication.js","node_modules/@typhonjs-fvtt/runtime/_dist/util/async/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/state-dialog/TJSDialogData.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/TJSDialog.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/index.js","src/applications/dialogs/drop-item-dialog/drop-item-dialog.js","src/applications/item-pile-inventory-app/ListEntry.svelte","src/applications/item-pile-inventory-app/ListGroupEntry.svelte","src/applications/item-pile-inventory-app/ItemList.svelte","src/applications/item-pile-inventory-app/CurrencyList.svelte","src/applications/components/ActorPicker.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/store/reducer/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/store/fvtt/document/index.js","src/plugins/base-plugin.js","src/helpers/transaction.js","src/plugins/simple-calendar.js","src/plugins/levels-3d-preview.js","src/plugins/rarity-colors.js","src/plugins/main.js","src/helpers/compendium-utilities.js","src/stores/pile-item.js","src/applications/dialogs/drop-currency-dialog/drop-currency-dialog-shell.svelte","src/applications/dialogs/drop-currency-dialog/drop-currency-dialog.js","src/stores/item-pile-store.js","src/applications/item-pile-inventory-app/CategorizedItemList.svelte","src/applications/item-pile-inventory-app/item-pile-inventory-shell.svelte","src/applications/components/Tabs.svelte","node_modules/@typhonjs-fvtt/svelte-standard/_dist/fvtt/index.js","node_modules/@typhonjs-fvtt/svelte-standard/_dist/component/internal/cssVariables.js","node_modules/@typhonjs-fvtt/svelte-standard/_dist/prosemirror/index.js","node_modules/@typhonjs-fvtt/svelte-standard/_dist/prosemirror/plugins/index.js","node_modules/@typhonjs-fvtt/svelte-standard/_dist/component/standard/editor/prosemirror/TJSProseMirror.svelte","node_modules/@typhonjs-fvtt/svelte-standard/_dist/component/standard/label/TJSToggleLabel.svelte","node_modules/@typhonjs-fvtt/svelte-standard/_dist/component/standard/menu/TJSMenu.svelte","node_modules/@typhonjs-fvtt/svelte-standard/_dist/component/standard/menu/context/TJSContextMenuImpl.svelte","node_modules/@typhonjs-fvtt/svelte-standard/_dist/component/standard/index.js","src/applications/components/PriceSelector.svelte","src/applications/dialogs/trade-merchant-item-dialog/trade-merchant-item-dialog-shell.svelte","src/applications/dialogs/trade-merchant-item-dialog/trade-merchant-item-dialog.js","src/applications/merchant-app/components/CustomColumn.svelte","src/applications/merchant-app/components/QuantityColumn.svelte","src/applications/merchant-app/components/ItemEntry.svelte","src/applications/item-editor/ItemPriceStore.js","src/applications/components/FilePicker.svelte","node_modules/svelte/src/runtime/animate/index.js","node_modules/svelte-dnd-action/src/helpers/dispatcher.js","node_modules/svelte-dnd-action/src/constants.js","node_modules/svelte-dnd-action/src/helpers/intersection.js","node_modules/svelte-dnd-action/src/helpers/listUtil.js","node_modules/svelte-dnd-action/src/helpers/util.js","node_modules/svelte-dnd-action/src/helpers/observer.js","node_modules/svelte-dnd-action/src/helpers/scroller.js","node_modules/svelte-dnd-action/src/helpers/multiScroller.js","node_modules/svelte-dnd-action/src/helpers/svelteNodeClone.js","node_modules/svelte-dnd-action/src/featureFlags.js","node_modules/svelte-dnd-action/src/helpers/styler.js","node_modules/svelte-dnd-action/src/pointerAction.js","node_modules/svelte-dnd-action/src/helpers/aria.js","node_modules/svelte-dnd-action/src/keyboardAction.js","node_modules/svelte-dnd-action/src/action.js","src/applications/components/DropZone.svelte","src/applications/components/PriceList.svelte","src/applications/components/MacroSelector.svelte","src/applications/components/CustomCategoryInput.svelte","src/applications/item-editor/item-editor-shell.svelte","src/applications/item-editor/item-editor.js","src/applications/merchant-app/components/EntryButtons.svelte","src/stores/merchant-store.js","src/applications/dialogs/text-editor-dialog/text-editor-dialog-shell.svelte","src/applications/dialogs/text-editor-dialog/text-editor-dialog.js","src/applications/merchant-app/MerchantLeftPane.svelte","src/applications/merchant-app/MerchantItemEntry.svelte","src/applications/merchant-app/components/CategoryHeader.svelte","src/applications/merchant-app/MerchantItemTab.svelte","src/applications/components/CustomDialog.svelte","src/applications/merchant-app/MerchantPopulateItemsTab.svelte","src/applications/components/CurrencyListEntry.svelte","src/applications/components/CurrencyList.svelte","src/applications/merchant-app/MerchantFooter.svelte","src/applications/merchant-app/MerchantActivityLog.svelte","src/applications/merchant-app/MerchantRightPane.svelte","src/applications/merchant-app/MerchantTopBar.svelte","src/applications/merchant-app/merchant-app-shell.svelte","src/applications/dialogs/user-select-dialog/user-select-dialog-shell.svelte","src/applications/dialogs/user-select-dialog/user-select-dialog.js","src/applications/merchant-app/merchant-app.js","node_modules/@typhonjs-fvtt/svelte-standard/_dist/application/index.js","src/applications/components/Grid/grid-utils.js","src/applications/components/Grid/GridItem.svelte","src/applications/components/Grid/Grid.svelte","src/applications/vault-app/VaultItemEntry.svelte","src/stores/vault-store.js","src/applications/vault-app/VaultExpanderEntry.svelte","src/applications/components/FloatingElement/FloatingElementImpl.svelte","src/applications/components/FloatingElement/FloatingElement.js","src/applications/vault-app/vault-shell.svelte","src/applications/vault-app/vault-app.js","src/applications/editors/currencies-editor/CurrencyList.svelte","src/applications/editors/currencies-editor/currency-store.js","src/applications/editors/currencies-editor/currencies-editor-shell.svelte","src/applications/editors/Editor.js","src/applications/editors/currencies-editor/currencies-editor.js","src/applications/editors/item-filters-editor/item-filters-editor.svelte","src/applications/editors/item-filters-editor/item-filters-editor.js","src/applications/item-pile-config/settings/main.svelte","src/applications/editors/item-type-price-modifiers-editor/item-type-price-modifiers-editor.svelte","src/applications/editors/item-type-price-modifiers-editor/item-type-price-modifiers-editor.js","src/applications/editors/price-modifiers-editor/price-modifiers-editor-shell.svelte","src/applications/editors/price-modifiers-editor/price-modifiers-editor.js","src/applications/components/PropertyPathInput.svelte","src/applications/editors/string-list-editor/string-list-editor.svelte","src/applications/editors/string-list-editor/string-list-editor.js","src/applications/editors/merchant-columns-editor/merchant-columns-editor-shell.svelte","src/applications/editors/merchant-columns-editor/merchant-columns-editor.js","src/applications/item-pile-config/settings/merchant.svelte","src/applications/item-pile-config/settings/itempile.svelte","src/applications/item-pile-config/settings/container.svelte","src/applications/item-pile-config/settings/sharing.svelte","src/applications/editors/vault-access-editor/vault-access-editor-shell.svelte","src/applications/editors/vault-access-editor/vault-access-editor.js","src/applications/item-pile-config/settings/vault.svelte","src/applications/item-pile-config/settings/custom.svelte","src/applications/item-pile-config/item-pile-config.svelte","src/applications/item-pile-config/item-pile-config.js","src/applications/item-pile-inventory-app/item-pile-inventory-app.js","src/applications/dialogs/receive-items-dialog/receive-items-shell.svelte","src/API/private-api.js","src/hotkeys.js","src/helpers/pile-utilities.js","node_modules/@floating-ui/utils/dist/floating-ui.utils.mjs","node_modules/@floating-ui/core/dist/floating-ui.core.mjs","node_modules/@floating-ui/utils/dist/floating-ui.utils.dom.mjs","node_modules/@floating-ui/dom/dist/floating-ui.dom.mjs","node_modules/svelte-floating-ui/index.js","node_modules/svelte-select/filter.js","node_modules/svelte-select/get-items.js","node_modules/svelte-select/ChevronIcon.svelte","node_modules/svelte-select/ClearIcon.svelte","node_modules/svelte-select/LoadingIcon.svelte","node_modules/svelte-select/Select.svelte","src/applications/dialogs/give-items-dialog/give-items-shell.svelte","src/applications/dialogs/give-items-dialog/give-items-dialog.js","src/systems/dnd5e.js","src/systems/dnd5e-2.0.3.js","src/systems/pf1.js","src/systems/pf1-9.0.js","src/applications/components/BasicItemDialog.svelte","src/systems/pf2e.js","src/systems/ds4.js","src/systems/d35e.js","src/systems/sfrpg.js","src/systems/swade.js","src/systems/tormenta20.js","src/systems/wfrp4e.js","src/systems/splittermond.js","src/systems/forbidden-lands.js","src/systems/icrpg.js","src/systems/shadowdark.js","src/systems/swse.js","src/systems/sw5e.js","src/systems/sw5e-2.0.3.2.3.8.js","src/systems/fallout.js","src/systems/cyberpunk-red-core.js","src/systems/knave.js","src/systems/t2k4e.js","src/systems/yzecoriolis.js","src/systems/kamigakari.js","src/systems/symbaroum.js","src/systems/wwn.js","src/systems/cyphersystem.js","src/systems/ptu.js","src/systems/dcc.js","src/systems/a5e.js","src/systems/dark-heresy.js","src/systems/naheulbeuk.js","src/systems/icrpgme.js","src/systems/blade-runner.js","src/systems/alienrpg.js","src/systems/pirateborg.js","src/systems/starwarsffg.js","src/systems/demonlord.js","src/systems/dnd5e-2.4.1.js","src/systems/dragonbane.js","src/systems/vaarfeu.js","src/systems/_index.js","src/systems.js","src/applications/settings-app/Setting.svelte","src/applications/editors/price-preset-editor/price-preset-editor-shell.svelte","src/applications/editors/price-preset-editor/price-preset-editor.js","src/applications/editors/unstackable-item-types-editor/unstackable-item-types-editor.svelte","src/applications/editors/unstackable-item-types-editor/unstackable-item-types-editor.js","src/applications/editors/styles-editor/styles-editor.svelte","src/applications/editors/styles-editor/styles-editor.js","src/applications/editors/vault-styles-editor/StyleEntry.svelte","src/applications/editors/vault-styles-editor/vault-styles-editor.svelte","src/applications/editors/vault-styles-editor/vault-styles-editor.js","src/applications/editors/index.js","src/applications/settings-app/SettingButton.svelte","src/applications/settings-app/settings-shell.svelte","src/applications/settings-app/settings-app.js","src/settings.js","src/constants/settings.js","src/helpers/utilities.js","src/applications/trade-dialogs/ActorDropSelect.svelte","src/applications/trade-dialogs/trade-dialog-prompt.svelte","node_modules/svelte/src/runtime/motion/utils.js","node_modules/svelte/src/runtime/motion/tweened.js","src/applications/trade-dialogs/trade-dialog-request.svelte","src/applications/trade-dialogs/trade-dialogs.js","src/applications/trading-app/trade-store.js","src/applications/trading-app/TradeEntry.svelte","src/applications/trading-app/trading-app-shell.svelte","src/applications/trading-app/trading-app.js","src/API/trade-api.js","src/API/chat-api.js","src/socket.js","src/helpers/helpers.js","src/foundry-ui-overrides.js","src/libwrapper.js","src/API/api.js","src/migrations.js","src/module.js"],"sourcesContent":["/** @module item_piles_constants */\r\nconst module_name = \"item-piles\";\r\nconst module_path = `modules/${module_name}/`;\r\nconst baseFlag = `flags.${module_name}`\r\n\r\nconst CONSTANTS = {\r\n\r\n\tMODULE_NAME: module_name,\r\n\tPATH: module_path,\r\n\tIS_V12: false,\r\n\r\n\tACTOR_DELTA_PROPERTY: \"delta\",\r\n\r\n\tFLAGS: {\r\n\t\tVERSION: `${baseFlag}.version`,\r\n\t\tPILE: `${baseFlag}.data`,\r\n\t\tITEM: `${baseFlag}.item`,\r\n\t\tNO_VERSION: `${baseFlag}.-=version`,\r\n\t\tNO_PILE: `${baseFlag}.-=data`,\r\n\t\tNO_ITEM: `${baseFlag}.-=item`,\r\n\t\tLOG: `${baseFlag}.log`,\r\n\t\tSHARING: `${baseFlag}.sharing`,\r\n\t\tPUBLIC_TRADE_ID: `${baseFlag}.publicTradeId`,\r\n\t\tTRADE_USERS: `${baseFlag}.tradeUsers`,\r\n\t\tTEMPORARY_ITEM: `${baseFlag}.temporary_item`,\r\n\t\tCUSTOM_CATEGORY: `${baseFlag}.item.customCategory`\r\n\t},\r\n\r\n\tSIMPLE_FLAGS: {\r\n\t\tVERSION: `${module_name}.version`,\r\n\t\tPILE: `${module_name}.data`,\r\n\t\tITEM: `${module_name}.item`,\r\n\t\tNO_VERSION: `${module_name}.-=version`,\r\n\t\tNO_PILE: `${module_name}.-=data`,\r\n\t\tNO_ITEM: `${module_name}.-=item`,\r\n\t\tLOG: `${module_name}.log`,\r\n\t\tSHARING: `${module_name}.sharing`,\r\n\t\tPUBLIC_TRADE_ID: `${module_name}.publicTradeId`,\r\n\t\tTRADE_USERS: `${module_name}.tradeUsers`,\r\n\t\tTEMPORARY_ITEM: `${module_name}.temporary_item`,\r\n\t\tCUSTOM_CATEGORY: `${module_name}.item.customCategory`\r\n\t},\r\n\r\n\tITEM_TYPE_METHODS: {\r\n\t\tHAS_CURRENCY: \"hasCurrency\",\r\n\t\tCONTENTS: \"contents\",\r\n\t\tTRANSFER: \"transfer\",\r\n\t\tIS_CONTAINED: \"isContained\",\r\n\t\tIS_CONTAINED_PATH: \"isContainedPath\",\r\n\t},\r\n\r\n\tITEM_DEFAULTS: {\r\n\t\t// Merchants\r\n\t\thidden: false,\r\n\t\tnotForSale: false,\r\n\t\tinfiniteQuantity: \"default\",\r\n\t\tdisplayQuantity: \"default\",\r\n\t\tfree: false,\r\n\t\tkeepZeroQuantity: false,\r\n\t\tdisableNormalCost: false,\r\n\t\tpurchaseOptionsAsSellOption: false,\r\n\t\tcantBeSoldToMerchants: false,\r\n\t\tisService: false,\r\n\t\tkeepOnMerchant: false,\r\n\t\tmacro: \"\",\r\n\t\tcustomCategory: \"\",\r\n\t\tprices: [],\r\n\t\tsellPrices: [],\r\n\t\tbuyPriceModifier: 1,\r\n\t\tsellPriceModifier: 1,\r\n\r\n\t\t// Crafting\r\n\t\tcraftingComponents: [],\r\n\t\tbreakdownComponents: [],\r\n\r\n\t\t// Vaults\r\n\t\tvaultExpander: false,\r\n\t\tvaultSlot: null,\r\n\t\taddsCols: 0,\r\n\t\taddsRows: 0,\r\n\t\tx: null,\r\n\t\ty: null,\r\n\t\twidth: 1,\r\n\t\theight: 1,\r\n\t\tflipped: false,\r\n\t\tvaultImage: \"\",\r\n\t\tvaultImageFlipped: \"\",\r\n\t\tcanStack: \"default\"\r\n\t},\r\n\r\n\tPILE_TYPES: {\r\n\t\tPILE: \"pile\",\r\n\t\tCONTAINER: \"container\",\r\n\t\tMERCHANT: \"merchant\",\r\n\t\tVAULT: \"vault\",\r\n\t\tAUCTIONEER: \"auctioneer\",\r\n\t\tBANKER: \"banker\"\r\n\t},\r\n\r\n\tVAULT_LOGGING_TYPES: {\r\n\t\tUSER_ACTOR: \"user_actor\",\r\n\t\tUSER: \"user\",\r\n\t\tACTOR: \"actor\",\r\n\t},\r\n\r\n\tMACRO_EXECUTION_TYPES: {\r\n\t\tTRADE_ITEMS: \"tradeItems\",\r\n\t\tADD_ITEMS: \"addItems\",\r\n\t\tREMOVE_ITEMS: \"removeItems\",\r\n\t\tTRANSFER_ITEMS: \"transferItems\",\r\n\t\tTRANSFER_ALL_ITEMS: \"transferAllItems\",\r\n\t\tUPDATE_CURRENCIES: \"updateCurrencies\",\r\n\t\tADD_CURRENCIES: \"addCurrencies\",\r\n\t\tREMOVE_CURRENCIES: \"removeCurrencies\",\r\n\t\tTRANSFER_CURRENCIES: \"transferCurrencies\",\r\n\t\tTRANSFER_ALL_CURRENCIES: \"transferAllCurrencies\",\r\n\t\tSET_ATTRIBUTES: \"setAttributes\",\r\n\t\tADD_ATTRIBUTES: \"addAttributes\",\r\n\t\tREMOVE_ATTRIBUTES: \"removeAttributes\",\r\n\t\tTRANSFER_ATTRIBUTES: \"transferAttributes\",\r\n\t\tTRANSFER_ALL_ATTRIBUTES: \"transferAllAttributes\",\r\n\t\tTRANSFER_EVERYTHING: \"transferEverything\",\r\n\t\tCLOSE_ITEM_PILE: \"closeItemPile\",\r\n\t\tLOCK_ITEM_PILE: \"lockItemPile\",\r\n\t\tUNLOCK_ITEM_PILE: \"unlockItemPile\",\r\n\t\tOPEN_ITEM_PILE: \"openItemPile\",\r\n\t\tSPLIT_INVENTORY: \"splitInventory\",\r\n\t\tRENDER_INTERFACE: \"renderInterface\"\r\n\t},\r\n\r\n\tCUSTOM_PILE_TYPES: {},\r\n\r\n\tPILE_DEFAULTS: {\r\n\t\t// Core settings\r\n\t\tenabled: false,\r\n\t\ttype: \"pile\",\r\n\t\tdistance: 1,\r\n\t\tmacro: \"\",\r\n\t\tdeleteWhenEmpty: \"default\",\r\n\t\tcanStackItems: \"yes\",\r\n\t\tcanInspectItems: true,\r\n\t\tdisplayItemTypes: false,\r\n\t\tdescription: \"\",\r\n\r\n\t\t// Overrides\r\n\t\toverrideItemFilters: false,\r\n\t\toverrideCurrencies: false,\r\n\t\toverrideSecondaryCurrencies: false,\r\n\t\trequiredItemProperties: [],\r\n\r\n\t\t// Token settings\r\n\t\tdisplayOne: false,\r\n\t\tshowItemName: false,\r\n\t\toverrideSingleItemScale: false,\r\n\t\tsingleItemScale: 1.0,\r\n\r\n\t\t// Sharing settings\r\n\t\tshareItemsEnabled: false,\r\n\t\tshareCurrenciesEnabled: true,\r\n\t\ttakeAllEnabled: false,\r\n\t\tsplitAllEnabled: true,\r\n\t\tactivePlayers: false,\r\n\r\n\t\t// Container settings\r\n\t\tclosed: false,\r\n\t\tlocked: false,\r\n\t\tclosedImage: \"\",\r\n\t\tclosedImages: [],\r\n\t\temptyImage: \"\",\r\n\t\temptyImages: [],\r\n\t\topenedImage: \"\",\r\n\t\topenedImages: [],\r\n\t\tlockedImage: \"\",\r\n\t\tlockedImages: [],\r\n\t\tcloseSound: \"\",\r\n\t\tcloseSounds: [],\r\n\t\topenSound: \"\",\r\n\t\topenSounds: [],\r\n\t\tlockedSound: \"\",\r\n\t\tlockedSounds: [],\r\n\t\tunlockedSound: \"\",\r\n\t\tunlockedSounds: [],\r\n\r\n\t\t// Merchant settings\r\n\t\tmerchantImage: \"\",\r\n\t\tinfiniteQuantity: false,\r\n\t\tinfiniteCurrencies: true,\r\n\t\tpurchaseOnly: false,\r\n\t\thideNewItems: false,\r\n\t\thideItemsWithZeroCost: false,\r\n\t\tkeepZeroQuantity: false,\r\n\t\tonlyAcceptBasePrice: true,\r\n\t\tdisplayQuantity: \"yes\",\r\n\t\tbuyPriceModifier: 1,\r\n\t\tsellPriceModifier: 0.5,\r\n\t\titemTypePriceModifiers: [],\r\n\t\tactorPriceModifiers: [],\r\n\t\ttablesForPopulate: [],\r\n\t\tmerchantColumns: [],\r\n\t\thideTokenWhenClosed: false,\r\n\t\topenTimes: {\r\n\t\t\tenabled: false,\r\n\t\t\tstatus: \"open\",\r\n\t\t\t/*\r\n\t\t\tauto = rely on simple calendar\r\n\t\t\topen = always open\r\n\t\t\tclosed = always closed\r\n\t\t\t */\r\n\t\t\topen: {\r\n\t\t\t\thour: 9,\r\n\t\t\t\tminute: 0\r\n\t\t\t},\r\n\t\t\tclose: {\r\n\t\t\t\thour: 18,\r\n\t\t\t\tminute: 0\r\n\t\t\t},\r\n\t\t},\r\n\t\tclosedDays: [],\r\n\t\tclosedHolidays: [],\r\n\t\trefreshItemsOnOpen: false,\r\n\t\trefreshItemsDays: [],\r\n\t\trefreshItemsHolidays: [],\r\n\t\tlogMerchantActivity: false,\r\n\r\n\t\t// Vault settings\r\n\t\tcols: 10,\r\n\t\trows: 5,\r\n\t\trestrictVaultAccess: false,\r\n\t\tvaultExpansion: false,\r\n\t\tbaseExpansionCols: 0,\r\n\t\tbaseExpansionRows: 0,\r\n\t\tvaultAccess: [],\r\n\t\tlogVaultActions: false,\r\n\t\tvaultLogType: \"user_actor\"\r\n\t}\r\n}\r\n\r\nCONSTANTS.DEFAULT_PILE_TYPES = [\r\n\tCONSTANTS.PILE_TYPES.PILE,\r\n\tCONSTANTS.PILE_TYPES.CONTAINER,\r\n\tCONSTANTS.PILE_TYPES.MERCHANT,\r\n\tCONSTANTS.PILE_TYPES.VAULT\r\n]\r\n\r\nCONSTANTS.ITEM_FORCED_UNIQUE_KEYS = [\"vaultExpander\"]\r\n\t.map(val => CONSTANTS.FLAGS.ITEM + \".\" + val);\r\n\r\nconst prefix = (string) => (strings, ...expressions) => `${string}-${strings.reduce((a, c, i) => a + expressions[i - 1] + c)}`\r\nconst module = prefix(CONSTANTS.MODULE_NAME);\r\n\r\nCONSTANTS.HOOKS = {\r\n\tREADY: module`ready`,\r\n\tRESET_SETTINGS: module`resetSettings`,\r\n\tDRAG_DOCUMENT: module`onDragDocument`,\r\n\tDROP_DOCUMENT: module`onDropDocument`,\r\n\tPRE_TRANSFER_EVERYTHING: module`preTransferEverything`,\r\n\tTRANSFER_EVERYTHING: module`transferEverything`,\r\n\tPRE_RENDER_SHEET: module`preRenderActorSheet`,\r\n\tPRE_RENDER_INTERFACE: module`preRenderInterface`,\r\n\tPRE_OPEN_INTERFACE: module`preOpenInterface`,\r\n\tOPEN_INTERFACE: module`openInterface`,\r\n\tPRE_CLOSE_INTERFACE: module`preCloseInterface`,\r\n\tCLOSE_INTERFACE: module`closeInterface`,\r\n\tRENDER_VAULT_GRID_ITEM: module`renderVaultGridItem`,\r\n\tPILE: {\r\n\t\tPRE_CREATE: module`preCreateItemPile`,\r\n\t\tCREATE: module`createItemPile`,\r\n\t\tPRE_UPDATE: module`preUpdateItemPile`,\r\n\t\tUPDATE: module`updateItemPile`,\r\n\t\tPRE_DELETE: module`preDeleteItemPile`,\r\n\t\tDELETE: module`deleteItemPile`,\r\n\t\tPRE_CLOSE: module`preCloseItemPile`,\r\n\t\tCLOSE: module`closeItemPile`,\r\n\t\tPRE_OPEN: module`preOpenItemPile`,\r\n\t\tOPEN: module`openItemPile`,\r\n\t\tPRE_LOCK: module`preLockItemPile`,\r\n\t\tLOCK: module`lockItemPile`,\r\n\t\tPRE_UNLOCK: module`preUnlockItemPile`,\r\n\t\tUNLOCK: module`unlockItemPile`,\r\n\t\tPRE_RATTLE: module`preRattleItemPile`,\r\n\t\tRATTLE: module`rattleItemPile`,\r\n\t\tPRE_TURN_INTO: module`preTurnIntoItemPiles`,\r\n\t\tTURN_INTO: module`turnIntoItemPiles`,\r\n\t\tPRE_REVERT_FROM: module`preRevertFromItemPiles`,\r\n\t\tREVERT_FROM: module`revertFromItemPiles`,\r\n\t\tPRE_SPLIT_INVENTORY: module`preSplitItemPileContent`,\r\n\t\tSPLIT_INVENTORY: module`splitItemPileContent`,\r\n\t\tPRE_CLICK: module`preClickItemPile`,\r\n\t\tPRE_DIRECTORY_CLICK: module`preClickDirectoryItemPile`,\r\n\t\tPRE_RIGHT_CLICK_ITEM: module`preRightClickItem`,\r\n\t\tPRE_REFRESH_INVENTORY: module`preRefreshInventory`\r\n\t},\r\n\tITEM: {\r\n\t\tPRE_DROP_DETERMINED: module`preDropItemDetermined`,\r\n\t\tPRE_DROP: module`preDropItem`,\r\n\t\tDROP: module`dropItem`,\r\n\t\tPRE_TRANSFER: module`preTransferItems`,\r\n\t\tTRANSFER: module`transferItems`,\r\n\t\tPRE_ADD: module`preAddItems`,\r\n\t\tADD: module`addItems`,\r\n\t\tPRE_REMOVE: module`preRemoveItems`,\r\n\t\tREMOVE: module`removeItems`,\r\n\t\tPRE_TRANSFER_ALL: module`preTransferAllItems`,\r\n\t\tTRANSFER_ALL: module`transferAllItems`,\r\n\t\tPRE_CALC_TRADE: module`preCalculateTradeItems`,\r\n\t\tPRE_TRADE: module`preTradeItems`,\r\n\t\tTRADE: module`tradeItems`,\r\n\t\tPRE_GIVE: module`preGiveItem`,\r\n\t\tGIVE: module`giveItem`,\r\n\t},\r\n\tCURRENCY: {\r\n\t\tPRE_TRANSFER: module`preTransferCurrencies`,\r\n\t\tTRANSFER: module`transferCurrencies`,\r\n\t\tPRE_UPDATE: module`preUpdateCurrencies`,\r\n\t\tUPDATE: module`updateCurrencies`,\r\n\t\tPRE_ADD: module`preAddCurrencies`,\r\n\t\tADD: module`addCurrencies`,\r\n\t\tPRE_REMOVE: module`preRemoveCurrencies`,\r\n\t\tREMOVE: module`removeCurrencies`,\r\n\t\tPRE_TRANSFER_ALL: module`preTransferAllCurrencies`,\r\n\t\tTRANSFER_ALL: module`transferAllCurrencies`,\r\n\t},\r\n\tATTRIBUTE: {\r\n\t\tPRE_TRANSFER: module`preTransferAttributes`,\r\n\t\tTRANSFER: module`transferAttributes`,\r\n\t\tPRE_SET: module`preSetAttributes`,\r\n\t\tSET: module`setAttributes`,\r\n\t\tPRE_ADD: module`preAddAttributes`,\r\n\t\tADD: module`addAttributes`,\r\n\t\tPRE_REMOVE: module`preRemoveAttributes`,\r\n\t\tREMOVE: module`removeAttributes`,\r\n\t\tPRE_TRANSFER_ALL: module`preTransferAllAttributes`,\r\n\t\tTRANSFER_ALL: module`transferAllAttributes`,\r\n\t},\r\n\tTRADE: {\r\n\t\tSTARTED: module`tradeStarted`,\r\n\t\tCOMPLETE: module`tradeComplete`\r\n\t}\r\n}\r\n\r\nexport default CONSTANTS;\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.5\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"Player Character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n\t// Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"classFeats,feat,raceFeats,pathFeats,destinyFeats,ritual,power\"\r\n\t\t}\r\n\t],\r\n\r\n\t// This function is an optional system handler that specifically transforms an item when it is added to actors\r\n\t\"ITEM_TRANSFORMER\": async (itemData) => {\r\n\t\t[\"equipped\", \"proficient\", \"prepared\"].forEach(key => {\r\n\t\t\tif (itemData?.system?.[key] !== undefined) {\r\n\t\t\t\tdelete itemData.system[key];\r\n\t\t\t}\r\n\t\t});\r\n\t\tfoundry.utils.setProperty(itemData, \"system.attunement\", false);\r\n\t\treturn itemData;\r\n\t},\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"DND4E.CurrencyAD\",\r\n\t\t\timg: \"icons/commodities/gems/gem-faceted-round-white.webp\",\r\n\t\t\tabbreviation: \"{#}AD\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.ad\"\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 10000\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"DND4E.CurrencyPP\",\r\n\t\t\timg: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\r\n\t\t\tabbreviation: \"{#}PP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.pp\"\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 100\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"DND4E.CurrencyGP\",\r\n\t\t\timg: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\r\n\t\t\tabbreviation: \"{#}GP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.gp\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"DND4E.CurrencySP\",\r\n\t\t\timg: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\r\n\t\t\tabbreviation: \"{#}SP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.sp\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"DND4E.CurrencyCP\",\r\n\t\t\timg: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\r\n\t\t\tabbreviation: \"{#}CP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.cp\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.01\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"DND4E.RitualCompAR\",\r\n\t\t\timg: \"icons/commodities/materials/bowl-powder-teal.webp\",\r\n\t\t\tabbreviation: \"{#}AR\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.ritualcomp.ar\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"DND4E.RitualCompMS\",\r\n\t\t\timg: \"icons/commodities/materials/bowl-liquid-white.webp\",\r\n\t\t\tabbreviation: \"{#}MS\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.ritualcomp.ms\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"DND4E.RitualCompRH\",\r\n\t\t\timg: \"icons/commodities/materials/plant-sprout-seed-brown-green.webp\",\r\n\t\t\tabbreviation: \"{#}RH\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.ritualcomp.rh\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"DND4E.RitualCompSI\",\r\n\t\t\timg: \"icons/commodities/materials/bowl-liquid-red.webp\",\r\n\t\t\tabbreviation: \"{#}SI\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.ritualcomp.si\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"DND4E.RitualCompRS\",\r\n\t\t\timg: \"icons/commodities/gems/gem-faceted-cushion-teal.webp\",\r\n\t\t\tabbreviation: \"{#}RS\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.ritualcomp.rs\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 1\r\n\t\t}\r\n\t]\r\n}\r\n","export default {\n\n\t\"VERSION\": \"1.0.4\",\n\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n\t\"ACTOR_CLASS_TYPE\": \"Player Character\",\n\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\n\n\t// Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n\t\"ITEM_FILTERS\": [\n\t\t{\n\t\t\t\"path\": \"type\",\n\t\t\t\"filters\": \"classFeats,feat,raceFeats,pathFeats,destinyFeats,ritual,power\"\n\t\t}\n\t],\n\n\t// This function is an optional system handler that specifically transforms an item when it is added to actors\n\t\"ITEM_TRANSFORMER\": async (itemData) => {\n\t\t[\"equipped\", \"proficient\", \"prepared\"].forEach(key => {\n\t\t\tif (itemData?.system?.[key] !== undefined) {\n\t\t\t\tdelete itemData.system[key];\n\t\t\t}\n\t\t});\n\t\tfoundry.utils.setProperty(itemData, \"system.attunement\", false);\n\t\treturn itemData;\n\t},\n\n\t// Item similarities determines how item piles detect similarities and differences in the system\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n\t// In the case of attributes, the path is relative to the \"actor.system\"\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n\t\"CURRENCIES\": [\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND4EBETA.CurrencyAD\",\n\t\t\timg: \"icons/commodities/gems/gem-faceted-round-white.webp\",\n\t\t\tabbreviation: \"{#}AD\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.ad\"\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 10000\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND4EBETA.CurrencyPP\",\n\t\t\timg: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\n\t\t\tabbreviation: \"{#}PP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.pp\"\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 100\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND4EBETA.CurrencyGP\",\n\t\t\timg: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n\t\t\tabbreviation: \"{#}GP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.gp\",\n\t\t\t},\n\t\t\tprimary: true,\n\t\t\texchangeRate: 1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND4EBETA.CurrencySP\",\n\t\t\timg: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\n\t\t\tabbreviation: \"{#}SP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.sp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND4EBETA.CurrencyCP\",\n\t\t\timg: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\n\t\t\tabbreviation: \"{#}CP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.cp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.01\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND4EBETA.RitualCompAR\",\n\t\t\timg: \"icons/commodities/materials/bowl-powder-teal.webp\",\n\t\t\tabbreviation: \"{#}AR\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.ritualcomp.ar\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND4EBETA.RitualCompMS\",\n\t\t\timg: \"icons/commodities/materials/bowl-liquid-white.webp\",\n\t\t\tabbreviation: \"{#}MS\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.ritualcomp.ms\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND4EBETA.RitualCompRH\",\n\t\t\timg: \"icons/commodities/materials/plant-sprout-seed-brown-green.webp\",\n\t\t\tabbreviation: \"{#}RH\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.ritualcomp.rh\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND4EBETA.RitualCompSI\",\n\t\t\timg: \"icons/commodities/materials/bowl-liquid-red.webp\",\n\t\t\tabbreviation: \"{#}SI\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.ritualcomp.si\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND4EBETA.RitualCompRS\",\n\t\t\timg: \"icons/commodities/gems/gem-faceted-cushion-teal.webp\",\n\t\t\tabbreviation: \"{#}RS\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.ritualcomp.rs\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 1\n\t\t}\n\t]\n}\n","/** @returns {void} */\nexport function noop() {}\n\nexport const identity = (x) => x;\n\n/**\n * @template T\n * @template S\n * @param {T} tar\n * @param {S} src\n * @returns {T & S}\n */\nexport function assign(tar, src) {\n\t// @ts-ignore\n\tfor (const k in src) tar[k] = src[k];\n\treturn /** @type {T & S} */ (tar);\n}\n\n// Adapted from https://github.com/then/is-promise/blob/master/index.js\n// Distributed under MIT License https://github.com/then/is-promise/blob/master/LICENSE\n/**\n * @param {any} value\n * @returns {value is PromiseLike<any>}\n */\nexport function is_promise(value) {\n\treturn (\n\t\t!!value &&\n\t\t(typeof value === 'object' || typeof value === 'function') &&\n\t\ttypeof (/** @type {any} */ (value).then) === 'function'\n\t);\n}\n\n/** @returns {void} */\nexport function add_location(element, file, line, column, char) {\n\telement.__svelte_meta = {\n\t\tloc: { file, line, column, char }\n\t};\n}\n\nexport function run(fn) {\n\treturn fn();\n}\n\nexport function blank_object() {\n\treturn Object.create(null);\n}\n\n/**\n * @param {Function[]} fns\n * @returns {void}\n */\nexport function run_all(fns) {\n\tfns.forEach(run);\n}\n\n/**\n * @param {any} thing\n * @returns {thing is Function}\n */\nexport function is_function(thing) {\n\treturn typeof thing === 'function';\n}\n\n/** @returns {boolean} */\nexport function safe_not_equal(a, b) {\n\treturn a != a ? b == b : a !== b || (a && typeof a === 'object') || typeof a === 'function';\n}\n\nlet src_url_equal_anchor;\n\n/**\n * @param {string} element_src\n * @param {string} url\n * @returns {boolean}\n */\nexport function src_url_equal(element_src, url) {\n\tif (element_src === url) return true;\n\tif (!src_url_equal_anchor) {\n\t\tsrc_url_equal_anchor = document.createElement('a');\n\t}\n\t// This is actually faster than doing URL(..).href\n\tsrc_url_equal_anchor.href = url;\n\treturn element_src === src_url_equal_anchor.href;\n}\n\n/** @param {string} srcset */\nfunction split_srcset(srcset) {\n\treturn srcset.split(',').map((src) => src.trim().split(' ').filter(Boolean));\n}\n\n/**\n * @param {HTMLSourceElement | HTMLImageElement} element_srcset\n * @param {string | undefined | null} srcset\n * @returns {boolean}\n */\nexport function srcset_url_equal(element_srcset, srcset) {\n\tconst element_urls = split_srcset(element_srcset.srcset);\n\tconst urls = split_srcset(srcset || '');\n\n\treturn (\n\t\turls.length === element_urls.length &&\n\t\turls.every(\n\t\t\t([url, width], i) =>\n\t\t\t\twidth === element_urls[i][1] &&\n\t\t\t\t// We need to test both ways because Vite will create an a full URL with\n\t\t\t\t// `new URL(asset, import.meta.url).href` for the client when `base: './'`, and the\n\t\t\t\t// relative URLs inside srcset are not automatically resolved to absolute URLs by\n\t\t\t\t// browsers (in contrast to img.src). This means both SSR and DOM code could\n\t\t\t\t// contain relative or absolute URLs.\n\t\t\t\t(src_url_equal(element_urls[i][0], url) || src_url_equal(url, element_urls[i][0]))\n\t\t)\n\t);\n}\n\n/** @returns {boolean} */\nexport function not_equal(a, b) {\n\treturn a != a ? b == b : a !== b;\n}\n\n/** @returns {boolean} */\nexport function is_empty(obj) {\n\treturn Object.keys(obj).length === 0;\n}\n\n/** @returns {void} */\nexport function validate_store(store, name) {\n\tif (store != null && typeof store.subscribe !== 'function') {\n\t\tthrow new Error(`'${name}' is not a store with a 'subscribe' method`);\n\t}\n}\n\nexport function subscribe(store, ...callbacks) {\n\tif (store == null) {\n\t\tfor (const callback of callbacks) {\n\t\t\tcallback(undefined);\n\t\t}\n\t\treturn noop;\n\t}\n\tconst unsub = store.subscribe(...callbacks);\n\treturn unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\n\n/**\n * Get the current value from a store by subscribing and immediately unsubscribing.\n *\n * https://svelte.dev/docs/svelte-store#get\n * @template T\n * @param {import('../store/public.js').Readable<T>} store\n * @returns {T}\n */\nexport function get_store_value(store) {\n\tlet value;\n\tsubscribe(store, (_) => (value = _))();\n\treturn value;\n}\n\n/** @returns {void} */\nexport function component_subscribe(component, store, callback) {\n\tcomponent.$$.on_destroy.push(subscribe(store, callback));\n}\n\nexport function create_slot(definition, ctx, $$scope, fn) {\n\tif (definition) {\n\t\tconst slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n\t\treturn definition[0](slot_ctx);\n\t}\n}\n\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n\treturn definition[1] && fn ? assign($$scope.ctx.slice(), definition[1](fn(ctx))) : $$scope.ctx;\n}\n\nexport function get_slot_changes(definition, $$scope, dirty, fn) {\n\tif (definition[2] && fn) {\n\t\tconst lets = definition[2](fn(dirty));\n\t\tif ($$scope.dirty === undefined) {\n\t\t\treturn lets;\n\t\t}\n\t\tif (typeof lets === 'object') {\n\t\t\tconst merged = [];\n\t\t\tconst len = Math.max($$scope.dirty.length, lets.length);\n\t\t\tfor (let i = 0; i < len; i += 1) {\n\t\t\t\tmerged[i] = $$scope.dirty[i] | lets[i];\n\t\t\t}\n\t\t\treturn merged;\n\t\t}\n\t\treturn $$scope.dirty | lets;\n\t}\n\treturn $$scope.dirty;\n}\n\n/** @returns {void} */\nexport function update_slot_base(\n\tslot,\n\tslot_definition,\n\tctx,\n\t$$scope,\n\tslot_changes,\n\tget_slot_context_fn\n) {\n\tif (slot_changes) {\n\t\tconst slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n\t\tslot.p(slot_context, slot_changes);\n\t}\n}\n\n/** @returns {void} */\nexport function update_slot(\n\tslot,\n\tslot_definition,\n\tctx,\n\t$$scope,\n\tdirty,\n\tget_slot_changes_fn,\n\tget_slot_context_fn\n) {\n\tconst slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n\tupdate_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn);\n}\n\n/** @returns {any[] | -1} */\nexport function get_all_dirty_from_scope($$scope) {\n\tif ($$scope.ctx.length > 32) {\n\t\tconst dirty = [];\n\t\tconst length = $$scope.ctx.length / 32;\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tdirty[i] = -1;\n\t\t}\n\t\treturn dirty;\n\t}\n\treturn -1;\n}\n\n/** @returns {{}} */\nexport function exclude_internal_props(props) {\n\tconst result = {};\n\tfor (const k in props) if (k[0] !== '$') result[k] = props[k];\n\treturn result;\n}\n\n/** @returns {{}} */\nexport function compute_rest_props(props, keys) {\n\tconst rest = {};\n\tkeys = new Set(keys);\n\tfor (const k in props) if (!keys.has(k) && k[0] !== '$') rest[k] = props[k];\n\treturn rest;\n}\n\n/** @returns {{}} */\nexport function compute_slots(slots) {\n\tconst result = {};\n\tfor (const key in slots) {\n\t\tresult[key] = true;\n\t}\n\treturn result;\n}\n\n/** @returns {(this: any, ...args: any[]) => void} */\nexport function once(fn) {\n\tlet ran = false;\n\treturn function (...args) {\n\t\tif (ran) return;\n\t\tran = true;\n\t\tfn.call(this, ...args);\n\t};\n}\n\nexport function null_to_empty(value) {\n\treturn value == null ? '' : value;\n}\n\nexport function set_store_value(store, ret, value) {\n\tstore.set(value);\n\treturn ret;\n}\n\nexport const has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\n\nexport function action_destroyer(action_result) {\n\treturn action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\n/** @param {number | string} value\n * @returns {[number, string]}\n */\nexport function split_css_unit(value) {\n\tconst split = typeof value === 'string' && value.match(/^\\s*(-?[\\d.]+)([^\\s]*)\\s*$/);\n\treturn split ? [parseFloat(split[1]), split[2] || 'px'] : [/** @type {number} */ (value), 'px'];\n}\n\nexport const contenteditable_truthy_values = ['', true, 1, 'true', 'contenteditable'];\n","import { noop } from './utils.js';\n\nexport const is_client = typeof window !== 'undefined';\n\n/** @type {() => number} */\nexport let now = is_client ? () => window.performance.now() : () => Date.now();\n\nexport let raf = is_client ? (cb) => requestAnimationFrame(cb) : noop;\n\n// used internally for testing\n/** @returns {void} */\nexport function set_now(fn) {\n\tnow = fn;\n}\n\n/** @returns {void} */\nexport function set_raf(fn) {\n\traf = fn;\n}\n","import { raf } from './environment.js';\n\nconst tasks = new Set();\n\n/**\n * @param {number} now\n * @returns {void}\n */\nfunction run_tasks(now) {\n\ttasks.forEach((task) => {\n\t\tif (!task.c(now)) {\n\t\t\ttasks.delete(task);\n\t\t\ttask.f();\n\t\t}\n\t});\n\tif (tasks.size !== 0) raf(run_tasks);\n}\n\n/**\n * For testing purposes only!\n * @returns {void}\n */\nexport function clear_loops() {\n\ttasks.clear();\n}\n\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n * @param {import('./private.js').TaskCallback} callback\n * @returns {import('./private.js').Task}\n */\nexport function loop(callback) {\n\t/** @type {import('./private.js').TaskEntry} */\n\tlet task;\n\tif (tasks.size === 0) raf(run_tasks);\n\treturn {\n\t\tpromise: new Promise((fulfill) => {\n\t\t\ttasks.add((task = { c: callback, f: fulfill }));\n\t\t}),\n\t\tabort() {\n\t\t\ttasks.delete(task);\n\t\t}\n\t};\n}\n","/** @type {typeof globalThis} */\nexport const globals =\n\ttypeof window !== 'undefined'\n\t\t? window\n\t\t: typeof globalThis !== 'undefined'\n\t\t? globalThis\n\t\t: // @ts-ignore Node typings have this\n\t\t  global;\n","import { contenteditable_truthy_values, has_prop } from './utils.js';\n\nimport { ResizeObserverSingleton } from './ResizeObserverSingleton.js';\n\n// Track which nodes are claimed during hydration. Unclaimed nodes can then be removed from the DOM\n// at the end of hydration without touching the remaining nodes.\nlet is_hydrating = false;\n\n/**\n * @returns {void}\n */\nexport function start_hydrating() {\n\tis_hydrating = true;\n}\n\n/**\n * @returns {void}\n */\nexport function end_hydrating() {\n\tis_hydrating = false;\n}\n\n/**\n * @param {number} low\n * @param {number} high\n * @param {(index: number) => number} key\n * @param {number} value\n * @returns {number}\n */\nfunction upper_bound(low, high, key, value) {\n\t// Return first index of value larger than input value in the range [low, high)\n\twhile (low < high) {\n\t\tconst mid = low + ((high - low) >> 1);\n\t\tif (key(mid) <= value) {\n\t\t\tlow = mid + 1;\n\t\t} else {\n\t\t\thigh = mid;\n\t\t}\n\t}\n\treturn low;\n}\n\n/**\n * @param {NodeEx} target\n * @returns {void}\n */\nfunction init_hydrate(target) {\n\tif (target.hydrate_init) return;\n\ttarget.hydrate_init = true;\n\t// We know that all children have claim_order values since the unclaimed have been detached if target is not <head>\n\n\tlet children = /** @type {ArrayLike<NodeEx2>} */ (target.childNodes);\n\t// If target is <head>, there may be children without claim_order\n\tif (target.nodeName === 'HEAD') {\n\t\tconst my_children = [];\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tconst node = children[i];\n\t\t\tif (node.claim_order !== undefined) {\n\t\t\t\tmy_children.push(node);\n\t\t\t}\n\t\t}\n\t\tchildren = my_children;\n\t}\n\t/*\n\t * Reorder claimed children optimally.\n\t * We can reorder claimed children optimally by finding the longest subsequence of\n\t * nodes that are already claimed in order and only moving the rest. The longest\n\t * subsequence of nodes that are claimed in order can be found by\n\t * computing the longest increasing subsequence of .claim_order values.\n\t *\n\t * This algorithm is optimal in generating the least amount of reorder operations\n\t * possible.\n\t *\n\t * Proof:\n\t * We know that, given a set of reordering operations, the nodes that do not move\n\t * always form an increasing subsequence, since they do not move among each other\n\t * meaning that they must be already ordered among each other. Thus, the maximal\n\t * set of nodes that do not move form a longest increasing subsequence.\n\t */\n\t// Compute longest increasing subsequence\n\t// m: subsequence length j => index k of smallest value that ends an increasing subsequence of length j\n\tconst m = new Int32Array(children.length + 1);\n\t// Predecessor indices + 1\n\tconst p = new Int32Array(children.length);\n\tm[0] = -1;\n\tlet longest = 0;\n\tfor (let i = 0; i < children.length; i++) {\n\t\tconst current = children[i].claim_order;\n\t\t// Find the largest subsequence length such that it ends in a value less than our current value\n\t\t// upper_bound returns first greater value, so we subtract one\n\t\t// with fast path for when we are on the current longest subsequence\n\t\tconst seq_len =\n\t\t\t(longest > 0 && children[m[longest]].claim_order <= current\n\t\t\t\t? longest + 1\n\t\t\t\t: upper_bound(1, longest, (idx) => children[m[idx]].claim_order, current)) - 1;\n\t\tp[i] = m[seq_len] + 1;\n\t\tconst new_len = seq_len + 1;\n\t\t// We can guarantee that current is the smallest value. Otherwise, we would have generated a longer sequence.\n\t\tm[new_len] = i;\n\t\tlongest = Math.max(new_len, longest);\n\t}\n\t// The longest increasing subsequence of nodes (initially reversed)\n\n\t/**\n\t * @type {NodeEx2[]}\n\t */\n\tconst lis = [];\n\t// The rest of the nodes, nodes that will be moved\n\n\t/**\n\t * @type {NodeEx2[]}\n\t */\n\tconst to_move = [];\n\tlet last = children.length - 1;\n\tfor (let cur = m[longest] + 1; cur != 0; cur = p[cur - 1]) {\n\t\tlis.push(children[cur - 1]);\n\t\tfor (; last >= cur; last--) {\n\t\t\tto_move.push(children[last]);\n\t\t}\n\t\tlast--;\n\t}\n\tfor (; last >= 0; last--) {\n\t\tto_move.push(children[last]);\n\t}\n\tlis.reverse();\n\t// We sort the nodes being moved to guarantee that their insertion order matches the claim order\n\tto_move.sort((a, b) => a.claim_order - b.claim_order);\n\t// Finally, we move the nodes\n\tfor (let i = 0, j = 0; i < to_move.length; i++) {\n\t\twhile (j < lis.length && to_move[i].claim_order >= lis[j].claim_order) {\n\t\t\tj++;\n\t\t}\n\t\tconst anchor = j < lis.length ? lis[j] : null;\n\t\ttarget.insertBefore(to_move[i], anchor);\n\t}\n}\n\n/**\n * @param {Node} target\n * @param {Node} node\n * @returns {void}\n */\nexport function append(target, node) {\n\ttarget.appendChild(node);\n}\n\n/**\n * @param {Node} target\n * @param {string} style_sheet_id\n * @param {string} styles\n * @returns {void}\n */\nexport function append_styles(target, style_sheet_id, styles) {\n\tconst append_styles_to = get_root_for_style(target);\n\tif (!append_styles_to.getElementById(style_sheet_id)) {\n\t\tconst style = element('style');\n\t\tstyle.id = style_sheet_id;\n\t\tstyle.textContent = styles;\n\t\tappend_stylesheet(append_styles_to, style);\n\t}\n}\n\n/**\n * @param {Node} node\n * @returns {ShadowRoot | Document}\n */\nexport function get_root_for_style(node) {\n\tif (!node) return document;\n\tconst root = node.getRootNode ? node.getRootNode() : node.ownerDocument;\n\tif (root && /** @type {ShadowRoot} */ (root).host) {\n\t\treturn /** @type {ShadowRoot} */ (root);\n\t}\n\treturn node.ownerDocument;\n}\n\n/**\n * @param {Node} node\n * @returns {CSSStyleSheet}\n */\nexport function append_empty_stylesheet(node) {\n\tconst style_element = element('style');\n\t// For transitions to work without 'style-src: unsafe-inline' Content Security Policy,\n\t// these empty tags need to be allowed with a hash as a workaround until we move to the Web Animations API.\n\t// Using the hash for the empty string (for an empty tag) works in all browsers except Safari.\n\t// So as a workaround for the workaround, when we append empty style tags we set their content to /* empty */.\n\t// The hash 'sha256-9OlNO0DNEeaVzHL4RZwCLsBHA8WBQ8toBp/4F5XV2nc=' will then work even in Safari.\n\tstyle_element.textContent = '/* empty */';\n\tappend_stylesheet(get_root_for_style(node), style_element);\n\treturn style_element.sheet;\n}\n\n/**\n * @param {ShadowRoot | Document} node\n * @param {HTMLStyleElement} style\n * @returns {CSSStyleSheet}\n */\nfunction append_stylesheet(node, style) {\n\tappend(/** @type {Document} */ (node).head || node, style);\n\treturn style.sheet;\n}\n\n/**\n * @param {NodeEx} target\n * @param {NodeEx} node\n * @returns {void}\n */\nexport function append_hydration(target, node) {\n\tif (is_hydrating) {\n\t\tinit_hydrate(target);\n\t\tif (\n\t\t\ttarget.actual_end_child === undefined ||\n\t\t\t(target.actual_end_child !== null && target.actual_end_child.parentNode !== target)\n\t\t) {\n\t\t\ttarget.actual_end_child = target.firstChild;\n\t\t}\n\t\t// Skip nodes of undefined ordering\n\t\twhile (target.actual_end_child !== null && target.actual_end_child.claim_order === undefined) {\n\t\t\ttarget.actual_end_child = target.actual_end_child.nextSibling;\n\t\t}\n\t\tif (node !== target.actual_end_child) {\n\t\t\t// We only insert if the ordering of this node should be modified or the parent node is not target\n\t\t\tif (node.claim_order !== undefined || node.parentNode !== target) {\n\t\t\t\ttarget.insertBefore(node, target.actual_end_child);\n\t\t\t}\n\t\t} else {\n\t\t\ttarget.actual_end_child = node.nextSibling;\n\t\t}\n\t} else if (node.parentNode !== target || node.nextSibling !== null) {\n\t\ttarget.appendChild(node);\n\t}\n}\n\n/**\n * @param {Node} target\n * @param {Node} node\n * @param {Node} [anchor]\n * @returns {void}\n */\nexport function insert(target, node, anchor) {\n\ttarget.insertBefore(node, anchor || null);\n}\n\n/**\n * @param {NodeEx} target\n * @param {NodeEx} node\n * @param {NodeEx} [anchor]\n * @returns {void}\n */\nexport function insert_hydration(target, node, anchor) {\n\tif (is_hydrating && !anchor) {\n\t\tappend_hydration(target, node);\n\t} else if (node.parentNode !== target || node.nextSibling != anchor) {\n\t\ttarget.insertBefore(node, anchor || null);\n\t}\n}\n\n/**\n * @param {Node} node\n * @returns {void}\n */\nexport function detach(node) {\n\tif (node.parentNode) {\n\t\tnode.parentNode.removeChild(node);\n\t}\n}\n\n/**\n * @returns {void} */\nexport function destroy_each(iterations, detaching) {\n\tfor (let i = 0; i < iterations.length; i += 1) {\n\t\tif (iterations[i]) iterations[i].d(detaching);\n\t}\n}\n\n/**\n * @template {keyof HTMLElementTagNameMap} K\n * @param {K} name\n * @returns {HTMLElementTagNameMap[K]}\n */\nexport function element(name) {\n\treturn document.createElement(name);\n}\n\n/**\n * @template {keyof HTMLElementTagNameMap} K\n * @param {K} name\n * @param {string} is\n * @returns {HTMLElementTagNameMap[K]}\n */\nexport function element_is(name, is) {\n\treturn document.createElement(name, { is });\n}\n\n/**\n * @template T\n * @template {keyof T} K\n * @param {T} obj\n * @param {K[]} exclude\n * @returns {Pick<T, Exclude<keyof T, K>>}\n */\nexport function object_without_properties(obj, exclude) {\n\tconst target = /** @type {Pick<T, Exclude<keyof T, K>>} */ ({});\n\tfor (const k in obj) {\n\t\tif (\n\t\t\thas_prop(obj, k) &&\n\t\t\t// @ts-ignore\n\t\t\texclude.indexOf(k) === -1\n\t\t) {\n\t\t\t// @ts-ignore\n\t\t\ttarget[k] = obj[k];\n\t\t}\n\t}\n\treturn target;\n}\n\n/**\n * @template {keyof SVGElementTagNameMap} K\n * @param {K} name\n * @returns {SVGElement}\n */\nexport function svg_element(name) {\n\treturn document.createElementNS('http://www.w3.org/2000/svg', name);\n}\n\n/**\n * @param {string} data\n * @returns {Text}\n */\nexport function text(data) {\n\treturn document.createTextNode(data);\n}\n\n/**\n * @returns {Text} */\nexport function space() {\n\treturn text(' ');\n}\n\n/**\n * @returns {Text} */\nexport function empty() {\n\treturn text('');\n}\n\n/**\n * @param {string} content\n * @returns {Comment}\n */\nexport function comment(content) {\n\treturn document.createComment(content);\n}\n\n/**\n * @param {EventTarget} node\n * @param {string} event\n * @param {EventListenerOrEventListenerObject} handler\n * @param {boolean | AddEventListenerOptions | EventListenerOptions} [options]\n * @returns {() => void}\n */\nexport function listen(node, event, handler, options) {\n\tnode.addEventListener(event, handler, options);\n\treturn () => node.removeEventListener(event, handler, options);\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function prevent_default(fn) {\n\treturn function (event) {\n\t\tevent.preventDefault();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function stop_propagation(fn) {\n\treturn function (event) {\n\t\tevent.stopPropagation();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function stop_immediate_propagation(fn) {\n\treturn function (event) {\n\t\tevent.stopImmediatePropagation();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => void} */\nexport function self(fn) {\n\treturn function (event) {\n\t\t// @ts-ignore\n\t\tif (event.target === this) fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => void} */\nexport function trusted(fn) {\n\treturn function (event) {\n\t\t// @ts-ignore\n\t\tif (event.isTrusted) fn.call(this, event);\n\t};\n}\n\n/**\n * @param {Element} node\n * @param {string} attribute\n * @param {string} [value]\n * @returns {void}\n */\nexport function attr(node, attribute, value) {\n\tif (value == null) node.removeAttribute(attribute);\n\telse if (node.getAttribute(attribute) !== value) node.setAttribute(attribute, value);\n}\n/**\n * List of attributes that should always be set through the attr method,\n * because updating them through the property setter doesn't work reliably.\n * In the example of `width`/`height`, the problem is that the setter only\n * accepts numeric values, but the attribute can also be set to a string like `50%`.\n * If this list becomes too big, rethink this approach.\n */\nconst always_set_through_set_attribute = ['width', 'height'];\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {{ [x: string]: string }} attributes\n * @returns {void}\n */\nexport function set_attributes(node, attributes) {\n\t// @ts-ignore\n\tconst descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n\tfor (const key in attributes) {\n\t\tif (attributes[key] == null) {\n\t\t\tnode.removeAttribute(key);\n\t\t} else if (key === 'style') {\n\t\t\tnode.style.cssText = attributes[key];\n\t\t} else if (key === '__value') {\n\t\t\t/** @type {any} */ (node).value = node[key] = attributes[key];\n\t\t} else if (\n\t\t\tdescriptors[key] &&\n\t\t\tdescriptors[key].set &&\n\t\t\talways_set_through_set_attribute.indexOf(key) === -1\n\t\t) {\n\t\t\tnode[key] = attributes[key];\n\t\t} else {\n\t\t\tattr(node, key, attributes[key]);\n\t\t}\n\t}\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {{ [x: string]: string }} attributes\n * @returns {void}\n */\nexport function set_svg_attributes(node, attributes) {\n\tfor (const key in attributes) {\n\t\tattr(node, key, attributes[key]);\n\t}\n}\n\n/**\n * @param {Record<string, unknown>} data_map\n * @returns {void}\n */\nexport function set_custom_element_data_map(node, data_map) {\n\tObject.keys(data_map).forEach((key) => {\n\t\tset_custom_element_data(node, key, data_map[key]);\n\t});\n}\n\n/**\n * @returns {void} */\nexport function set_custom_element_data(node, prop, value) {\n\tconst lower = prop.toLowerCase(); // for backwards compatibility with existing behavior we do lowercase first\n\tif (lower in node) {\n\t\tnode[lower] = typeof node[lower] === 'boolean' && value === '' ? true : value;\n\t} else if (prop in node) {\n\t\tnode[prop] = typeof node[prop] === 'boolean' && value === '' ? true : value;\n\t} else {\n\t\tattr(node, prop, value);\n\t}\n}\n\n/**\n * @param {string} tag\n */\nexport function set_dynamic_element_data(tag) {\n\treturn /-/.test(tag) ? set_custom_element_data_map : set_attributes;\n}\n\n/**\n * @returns {void}\n */\nexport function xlink_attr(node, attribute, value) {\n\tnode.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\n\n/**\n * @param {HTMLElement} node\n * @returns {string}\n */\nexport function get_svelte_dataset(node) {\n\treturn node.dataset.svelteH;\n}\n\n/**\n * @returns {unknown[]} */\nexport function get_binding_group_value(group, __value, checked) {\n\tconst value = new Set();\n\tfor (let i = 0; i < group.length; i += 1) {\n\t\tif (group[i].checked) value.add(group[i].__value);\n\t}\n\tif (!checked) {\n\t\tvalue.delete(__value);\n\t}\n\treturn Array.from(value);\n}\n\n/**\n * @param {HTMLInputElement[]} group\n * @returns {{ p(...inputs: HTMLInputElement[]): void; r(): void; }}\n */\nexport function init_binding_group(group) {\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _inputs;\n\treturn {\n\t\t/* push */ p(...inputs) {\n\t\t\t_inputs = inputs;\n\t\t\t_inputs.forEach((input) => group.push(input));\n\t\t},\n\t\t/* remove */ r() {\n\t\t\t_inputs.forEach((input) => group.splice(group.indexOf(input), 1));\n\t\t}\n\t};\n}\n\n/**\n * @param {number[]} indexes\n * @returns {{ u(new_indexes: number[]): void; p(...inputs: HTMLInputElement[]): void; r: () => void; }}\n */\nexport function init_binding_group_dynamic(group, indexes) {\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _group = get_binding_group(group);\n\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _inputs;\n\n\tfunction get_binding_group(group) {\n\t\tfor (let i = 0; i < indexes.length; i++) {\n\t\t\tgroup = group[indexes[i]] = group[indexes[i]] || [];\n\t\t}\n\t\treturn group;\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction push() {\n\t\t_inputs.forEach((input) => _group.push(input));\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction remove() {\n\t\t_inputs.forEach((input) => _group.splice(_group.indexOf(input), 1));\n\t}\n\treturn {\n\t\t/* update */ u(new_indexes) {\n\t\t\tindexes = new_indexes;\n\t\t\tconst new_group = get_binding_group(group);\n\t\t\tif (new_group !== _group) {\n\t\t\t\tremove();\n\t\t\t\t_group = new_group;\n\t\t\t\tpush();\n\t\t\t}\n\t\t},\n\t\t/* push */ p(...inputs) {\n\t\t\t_inputs = inputs;\n\t\t\tpush();\n\t\t},\n\t\t/* remove */ r: remove\n\t};\n}\n\n/** @returns {number} */\nexport function to_number(value) {\n\treturn value === '' ? null : +value;\n}\n\n/** @returns {any[]} */\nexport function time_ranges_to_array(ranges) {\n\tconst array = [];\n\tfor (let i = 0; i < ranges.length; i += 1) {\n\t\tarray.push({ start: ranges.start(i), end: ranges.end(i) });\n\t}\n\treturn array;\n}\n\n/**\n * @param {Element} element\n * @returns {ChildNode[]}\n */\nexport function children(element) {\n\treturn Array.from(element.childNodes);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {void}\n */\nfunction init_claim_info(nodes) {\n\tif (nodes.claim_info === undefined) {\n\t\tnodes.claim_info = { last_index: 0, total_claimed: 0 };\n\t}\n}\n\n/**\n * @template {ChildNodeEx} R\n * @param {ChildNodeArray} nodes\n * @param {(node: ChildNodeEx) => node is R} predicate\n * @param {(node: ChildNodeEx) => ChildNodeEx | undefined} process_node\n * @param {() => R} create_node\n * @param {boolean} dont_update_last_index\n * @returns {R}\n */\nfunction claim_node(nodes, predicate, process_node, create_node, dont_update_last_index = false) {\n\t// Try to find nodes in an order such that we lengthen the longest increasing subsequence\n\tinit_claim_info(nodes);\n\tconst result_node = (() => {\n\t\t// We first try to find an element after the previous one\n\t\tfor (let i = nodes.claim_info.last_index; i < nodes.length; i++) {\n\t\t\tconst node = nodes[i];\n\t\t\tif (predicate(node)) {\n\t\t\t\tconst replacement = process_node(node);\n\t\t\t\tif (replacement === undefined) {\n\t\t\t\t\tnodes.splice(i, 1);\n\t\t\t\t} else {\n\t\t\t\t\tnodes[i] = replacement;\n\t\t\t\t}\n\t\t\t\tif (!dont_update_last_index) {\n\t\t\t\t\tnodes.claim_info.last_index = i;\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\t// Otherwise, we try to find one before\n\t\t// We iterate in reverse so that we don't go too far back\n\t\tfor (let i = nodes.claim_info.last_index - 1; i >= 0; i--) {\n\t\t\tconst node = nodes[i];\n\t\t\tif (predicate(node)) {\n\t\t\t\tconst replacement = process_node(node);\n\t\t\t\tif (replacement === undefined) {\n\t\t\t\t\tnodes.splice(i, 1);\n\t\t\t\t} else {\n\t\t\t\t\tnodes[i] = replacement;\n\t\t\t\t}\n\t\t\t\tif (!dont_update_last_index) {\n\t\t\t\t\tnodes.claim_info.last_index = i;\n\t\t\t\t} else if (replacement === undefined) {\n\t\t\t\t\t// Since we spliced before the last_index, we decrease it\n\t\t\t\t\tnodes.claim_info.last_index--;\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\t// If we can't find any matching node, we create a new one\n\t\treturn create_node();\n\t})();\n\tresult_node.claim_order = nodes.claim_info.total_claimed;\n\tnodes.claim_info.total_claimed += 1;\n\treturn result_node;\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @param {(name: string) => Element | SVGElement} create_element\n * @returns {Element | SVGElement}\n */\nfunction claim_element_base(nodes, name, attributes, create_element) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Element | SVGElement} */\n\t\t(node) => node.nodeName === name,\n\t\t/** @param {Element} node */\n\t\t(node) => {\n\t\t\tconst remove = [];\n\t\t\tfor (let j = 0; j < node.attributes.length; j++) {\n\t\t\t\tconst attribute = node.attributes[j];\n\t\t\t\tif (!attributes[attribute.name]) {\n\t\t\t\t\tremove.push(attribute.name);\n\t\t\t\t}\n\t\t\t}\n\t\t\tremove.forEach((v) => node.removeAttribute(v));\n\t\t\treturn undefined;\n\t\t},\n\t\t() => create_element(name)\n\t);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @returns {Element | SVGElement}\n */\nexport function claim_element(nodes, name, attributes) {\n\treturn claim_element_base(nodes, name, attributes, element);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @returns {Element | SVGElement}\n */\nexport function claim_svg_element(nodes, name, attributes) {\n\treturn claim_element_base(nodes, name, attributes, svg_element);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {Text}\n */\nexport function claim_text(nodes, data) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Text} */\n\t\t(node) => node.nodeType === 3,\n\t\t/** @param {Text} node */\n\t\t(node) => {\n\t\t\tconst data_str = '' + data;\n\t\t\tif (node.data.startsWith(data_str)) {\n\t\t\t\tif (node.data.length !== data_str.length) {\n\t\t\t\t\treturn node.splitText(data_str.length);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnode.data = data_str;\n\t\t\t}\n\t\t},\n\t\t() => text(data),\n\t\ttrue // Text nodes should not update last index since it is likely not worth it to eliminate an increasing subsequence of actual elements\n\t);\n}\n\n/**\n * @returns {Text} */\nexport function claim_space(nodes) {\n\treturn claim_text(nodes, ' ');\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {Comment}\n */\nexport function claim_comment(nodes, data) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Comment} */\n\t\t(node) => node.nodeType === 8,\n\t\t/** @param {Comment} node */\n\t\t(node) => {\n\t\t\tnode.data = '' + data;\n\t\t\treturn undefined;\n\t\t},\n\t\t() => comment(data),\n\t\ttrue\n\t);\n}\n\nfunction get_comment_idx(nodes, text, start) {\n\tfor (let i = start; i < nodes.length; i += 1) {\n\t\tconst node = nodes[i];\n\t\tif (node.nodeType === 8 /* comment node */ && node.textContent.trim() === text) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n}\n\n/**\n * @param {boolean} is_svg\n * @returns {HtmlTagHydration}\n */\nexport function claim_html_tag(nodes, is_svg) {\n\t// find html opening tag\n\tconst start_index = get_comment_idx(nodes, 'HTML_TAG_START', 0);\n\tconst end_index = get_comment_idx(nodes, 'HTML_TAG_END', start_index + 1);\n\tif (start_index === -1 || end_index === -1) {\n\t\treturn new HtmlTagHydration(is_svg);\n\t}\n\n\tinit_claim_info(nodes);\n\tconst html_tag_nodes = nodes.splice(start_index, end_index - start_index + 1);\n\tdetach(html_tag_nodes[0]);\n\tdetach(html_tag_nodes[html_tag_nodes.length - 1]);\n\tconst claimed_nodes = html_tag_nodes.slice(1, html_tag_nodes.length - 1);\n\tif (claimed_nodes.length === 0) {\n\t\treturn new HtmlTagHydration(is_svg);\n\t}\n\tfor (const n of claimed_nodes) {\n\t\tn.claim_order = nodes.claim_info.total_claimed;\n\t\tnodes.claim_info.total_claimed += 1;\n\t}\n\treturn new HtmlTagHydration(is_svg, claimed_nodes);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @returns {void}\n */\nexport function set_data(text, data) {\n\tdata = '' + data;\n\tif (text.data === data) return;\n\ttext.data = /** @type {string} */ (data);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @returns {void}\n */\nexport function set_data_contenteditable(text, data) {\n\tdata = '' + data;\n\tif (text.wholeText === data) return;\n\ttext.data = /** @type {string} */ (data);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @param {string} attr_value\n * @returns {void}\n */\nexport function set_data_maybe_contenteditable(text, data, attr_value) {\n\tif (~contenteditable_truthy_values.indexOf(attr_value)) {\n\t\tset_data_contenteditable(text, data);\n\t} else {\n\t\tset_data(text, data);\n\t}\n}\n\n/**\n * @returns {void} */\nexport function set_input_value(input, value) {\n\tinput.value = value == null ? '' : value;\n}\n\n/**\n * @returns {void} */\nexport function set_input_type(input, type) {\n\ttry {\n\t\tinput.type = type;\n\t} catch (e) {\n\t\t// do nothing\n\t}\n}\n\n/**\n * @returns {void} */\nexport function set_style(node, key, value, important) {\n\tif (value == null) {\n\t\tnode.style.removeProperty(key);\n\t} else {\n\t\tnode.style.setProperty(key, value, important ? 'important' : '');\n\t}\n}\n\n/**\n * @returns {void} */\nexport function select_option(select, value, mounting) {\n\tfor (let i = 0; i < select.options.length; i += 1) {\n\t\tconst option = select.options[i];\n\t\tif (option.__value === value) {\n\t\t\toption.selected = true;\n\t\t\treturn;\n\t\t}\n\t}\n\tif (!mounting || value !== undefined) {\n\t\tselect.selectedIndex = -1; // no option should be selected\n\t}\n}\n\n/**\n * @returns {void} */\nexport function select_options(select, value) {\n\tfor (let i = 0; i < select.options.length; i += 1) {\n\t\tconst option = select.options[i];\n\t\toption.selected = ~value.indexOf(option.__value);\n\t}\n}\n\nexport function select_value(select) {\n\tconst selected_option = select.querySelector(':checked');\n\treturn selected_option && selected_option.__value;\n}\n\nexport function select_multiple_value(select) {\n\treturn [].map.call(select.querySelectorAll(':checked'), (option) => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\n\n/**\n * @type {boolean} */\nlet crossorigin;\n\n/**\n * @returns {boolean} */\nexport function is_crossorigin() {\n\tif (crossorigin === undefined) {\n\t\tcrossorigin = false;\n\t\ttry {\n\t\t\tif (typeof window !== 'undefined' && window.parent) {\n\t\t\t\tvoid window.parent.document;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tcrossorigin = true;\n\t\t}\n\t}\n\treturn crossorigin;\n}\n\n/**\n * @param {HTMLElement} node\n * @param {() => void} fn\n * @returns {() => void}\n */\nexport function add_iframe_resize_listener(node, fn) {\n\tconst computed_style = getComputedStyle(node);\n\tif (computed_style.position === 'static') {\n\t\tnode.style.position = 'relative';\n\t}\n\tconst iframe = element('iframe');\n\tiframe.setAttribute(\n\t\t'style',\n\t\t'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n\t\t\t'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;'\n\t);\n\tiframe.setAttribute('aria-hidden', 'true');\n\tiframe.tabIndex = -1;\n\tconst crossorigin = is_crossorigin();\n\n\t/**\n\t * @type {() => void}\n\t */\n\tlet unsubscribe;\n\tif (crossorigin) {\n\t\tiframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n\t\tunsubscribe = listen(\n\t\t\twindow,\n\t\t\t'message',\n\t\t\t/** @param {MessageEvent} event */ (event) => {\n\t\t\t\tif (event.source === iframe.contentWindow) fn();\n\t\t\t}\n\t\t);\n\t} else {\n\t\tiframe.src = 'about:blank';\n\t\tiframe.onload = () => {\n\t\t\tunsubscribe = listen(iframe.contentWindow, 'resize', fn);\n\t\t\t// make sure an initial resize event is fired _after_ the iframe is loaded (which is asynchronous)\n\t\t\t// see https://github.com/sveltejs/svelte/issues/4233\n\t\t\tfn();\n\t\t};\n\t}\n\tappend(node, iframe);\n\treturn () => {\n\t\tif (crossorigin) {\n\t\t\tunsubscribe();\n\t\t} else if (unsubscribe && iframe.contentWindow) {\n\t\t\tunsubscribe();\n\t\t}\n\t\tdetach(iframe);\n\t};\n}\nexport const resize_observer_content_box = /* @__PURE__ */ new ResizeObserverSingleton({\n\tbox: 'content-box'\n});\nexport const resize_observer_border_box = /* @__PURE__ */ new ResizeObserverSingleton({\n\tbox: 'border-box'\n});\nexport const resize_observer_device_pixel_content_box = /* @__PURE__ */ new ResizeObserverSingleton(\n\t{ box: 'device-pixel-content-box' }\n);\nexport { ResizeObserverSingleton };\n\n/**\n * @returns {void} */\nexport function toggle_class(element, name, toggle) {\n\t// The `!!` is required because an `undefined` flag means flipping the current state.\n\telement.classList.toggle(name, !!toggle);\n}\n\n/**\n * @template T\n * @param {string} type\n * @param {T} [detail]\n * @param {{ bubbles?: boolean, cancelable?: boolean }} [options]\n * @returns {CustomEvent<T>}\n */\nexport function custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {\n\treturn new CustomEvent(type, { detail, bubbles, cancelable });\n}\n\n/**\n * @param {string} selector\n * @param {HTMLElement} parent\n * @returns {ChildNodeArray}\n */\nexport function query_selector_all(selector, parent = document.body) {\n\treturn Array.from(parent.querySelectorAll(selector));\n}\n\n/**\n * @param {string} nodeId\n * @param {HTMLElement} head\n * @returns {any[]}\n */\nexport function head_selector(nodeId, head) {\n\tconst result = [];\n\tlet started = 0;\n\tfor (const node of head.childNodes) {\n\t\tif (node.nodeType === 8 /* comment node */) {\n\t\t\tconst comment = node.textContent.trim();\n\t\t\tif (comment === `HEAD_${nodeId}_END`) {\n\t\t\t\tstarted -= 1;\n\t\t\t\tresult.push(node);\n\t\t\t} else if (comment === `HEAD_${nodeId}_START`) {\n\t\t\t\tstarted += 1;\n\t\t\t\tresult.push(node);\n\t\t\t}\n\t\t} else if (started > 0) {\n\t\t\tresult.push(node);\n\t\t}\n\t}\n\treturn result;\n}\n/** */\nexport class HtmlTag {\n\t/**\n\t * @private\n\t * @default false\n\t */\n\tis_svg = false;\n\t/** parent for creating node */\n\te = undefined;\n\t/** html tag nodes */\n\tn = undefined;\n\t/** target */\n\tt = undefined;\n\t/** anchor */\n\ta = undefined;\n\tconstructor(is_svg = false) {\n\t\tthis.is_svg = is_svg;\n\t\tthis.e = this.n = null;\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tc(html) {\n\t\tthis.h(html);\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @param {HTMLElement | SVGElement} target\n\t * @param {HTMLElement | SVGElement} anchor\n\t * @returns {void}\n\t */\n\tm(html, target, anchor = null) {\n\t\tif (!this.e) {\n\t\t\tif (this.is_svg)\n\t\t\t\tthis.e = svg_element(/** @type {keyof SVGElementTagNameMap} */ (target.nodeName));\n\t\t\t/** #7364  target for <template> may be provided as #document-fragment(11) */ else\n\t\t\t\tthis.e = element(\n\t\t\t\t\t/** @type {keyof HTMLElementTagNameMap} */ (\n\t\t\t\t\t\ttarget.nodeType === 11 ? 'TEMPLATE' : target.nodeName\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\tthis.t =\n\t\t\t\ttarget.tagName !== 'TEMPLATE'\n\t\t\t\t\t? target\n\t\t\t\t\t: /** @type {HTMLTemplateElement} */ (target).content;\n\t\t\tthis.c(html);\n\t\t}\n\t\tthis.i(anchor);\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\th(html) {\n\t\tthis.e.innerHTML = html;\n\t\tthis.n = Array.from(\n\t\t\tthis.e.nodeName === 'TEMPLATE' ? this.e.content.childNodes : this.e.childNodes\n\t\t);\n\t}\n\n\t/**\n\t * @returns {void} */\n\ti(anchor) {\n\t\tfor (let i = 0; i < this.n.length; i += 1) {\n\t\t\tinsert(this.t, this.n[i], anchor);\n\t\t}\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tp(html) {\n\t\tthis.d();\n\t\tthis.h(html);\n\t\tthis.i(this.a);\n\t}\n\n\t/**\n\t * @returns {void} */\n\td() {\n\t\tthis.n.forEach(detach);\n\t}\n}\n\nexport class HtmlTagHydration extends HtmlTag {\n\t/** @type {Element[]} hydration claimed nodes */\n\tl = undefined;\n\n\tconstructor(is_svg = false, claimed_nodes) {\n\t\tsuper(is_svg);\n\t\tthis.e = this.n = null;\n\t\tthis.l = claimed_nodes;\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tc(html) {\n\t\tif (this.l) {\n\t\t\tthis.n = this.l;\n\t\t} else {\n\t\t\tsuper.c(html);\n\t\t}\n\t}\n\n\t/**\n\t * @returns {void} */\n\ti(anchor) {\n\t\tfor (let i = 0; i < this.n.length; i += 1) {\n\t\t\tinsert_hydration(this.t, this.n[i], anchor);\n\t\t}\n\t}\n}\n\n/**\n * @param {NamedNodeMap} attributes\n * @returns {{}}\n */\nexport function attribute_to_object(attributes) {\n\tconst result = {};\n\tfor (const attribute of attributes) {\n\t\tresult[attribute.name] = attribute.value;\n\t}\n\treturn result;\n}\n\nconst escaped = {\n\t'\"': '&quot;',\n\t'&': '&amp;',\n\t'<': '&lt;'\n};\n\nconst regex_attribute_characters_to_escape = /[\"&<]/g;\n\n/**\n * Note that the attribute itself should be surrounded in double quotes\n * @param {any} attribute\n */\nfunction escape_attribute(attribute) {\n\treturn String(attribute).replace(regex_attribute_characters_to_escape, (match) => escaped[match]);\n}\n\n/**\n * @param {Record<string, string>} attributes\n */\nexport function stringify_spread(attributes) {\n\tlet str = ' ';\n\tfor (const key in attributes) {\n\t\tif (attributes[key] != null) {\n\t\t\tstr += `${key}=\"${escape_attribute(attributes[key])}\" `;\n\t\t}\n\t}\n\n\treturn str;\n}\n\n/**\n * @param {HTMLElement} element\n * @returns {{}}\n */\nexport function get_custom_elements_slots(element) {\n\tconst result = {};\n\telement.childNodes.forEach(\n\t\t/** @param {Element} node */ (node) => {\n\t\t\tresult[node.slot || 'default'] = true;\n\t\t}\n\t);\n\treturn result;\n}\n\nexport function construct_svelte_component(component, props) {\n\treturn new component(props);\n}\n\n/**\n * @typedef {Node & {\n * \tclaim_order?: number;\n * \thydrate_init?: true;\n * \tactual_end_child?: NodeEx;\n * \tchildNodes: NodeListOf<NodeEx>;\n * }} NodeEx\n */\n\n/** @typedef {ChildNode & NodeEx} ChildNodeEx */\n\n/** @typedef {NodeEx & { claim_order: number }} NodeEx2 */\n\n/**\n * @typedef {ChildNodeEx[] & {\n * \tclaim_info?: {\n * \t\tlast_index: number;\n * \t\ttotal_claimed: number;\n * \t};\n * }} ChildNodeArray\n */\n","import { append_empty_stylesheet, detach, get_root_for_style } from './dom.js';\nimport { raf } from './environment.js';\n\n// we need to store the information for multiple documents because a Svelte application could also contain iframes\n// https://github.com/sveltejs/svelte/issues/3624\n/** @type {Map<Document | ShadowRoot, import('./private.d.ts').StyleInformation>} */\nconst managed_styles = new Map();\n\nlet active = 0;\n\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\n/**\n * @param {string} str\n * @returns {number}\n */\nfunction hash(str) {\n\tlet hash = 5381;\n\tlet i = str.length;\n\twhile (i--) hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n\treturn hash >>> 0;\n}\n\n/**\n * @param {Document | ShadowRoot} doc\n * @param {Element & ElementCSSInlineStyle} node\n * @returns {{ stylesheet: any; rules: {}; }}\n */\nfunction create_style_information(doc, node) {\n\tconst info = { stylesheet: append_empty_stylesheet(node), rules: {} };\n\tmanaged_styles.set(doc, info);\n\treturn info;\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {number} a\n * @param {number} b\n * @param {number} duration\n * @param {number} delay\n * @param {(t: number) => number} ease\n * @param {(t: number, u: number) => string} fn\n * @param {number} uid\n * @returns {string}\n */\nexport function create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n\tconst step = 16.666 / duration;\n\tlet keyframes = '{\\n';\n\tfor (let p = 0; p <= 1; p += step) {\n\t\tconst t = a + (b - a) * ease(p);\n\t\tkeyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n\t}\n\tconst rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n\tconst name = `__svelte_${hash(rule)}_${uid}`;\n\tconst doc = get_root_for_style(node);\n\tconst { stylesheet, rules } = managed_styles.get(doc) || create_style_information(doc, node);\n\tif (!rules[name]) {\n\t\trules[name] = true;\n\t\tstylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n\t}\n\tconst animation = node.style.animation || '';\n\tnode.style.animation = `${\n\t\tanimation ? `${animation}, ` : ''\n\t}${name} ${duration}ms linear ${delay}ms 1 both`;\n\tactive += 1;\n\treturn name;\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {string} [name]\n * @returns {void}\n */\nexport function delete_rule(node, name) {\n\tconst previous = (node.style.animation || '').split(', ');\n\tconst next = previous.filter(\n\t\tname\n\t\t\t? (anim) => anim.indexOf(name) < 0 // remove specific animation\n\t\t\t: (anim) => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n\t);\n\tconst deleted = previous.length - next.length;\n\tif (deleted) {\n\t\tnode.style.animation = next.join(', ');\n\t\tactive -= deleted;\n\t\tif (!active) clear_rules();\n\t}\n}\n\n/** @returns {void} */\nexport function clear_rules() {\n\traf(() => {\n\t\tif (active) return;\n\t\tmanaged_styles.forEach((info) => {\n\t\t\tconst { ownerNode } = info.stylesheet;\n\t\t\t// there is no ownerNode if it runs on jsdom.\n\t\t\tif (ownerNode) detach(ownerNode);\n\t\t});\n\t\tmanaged_styles.clear();\n\t});\n}\n","import { identity as linear, noop } from './utils.js';\nimport { now } from './environment.js';\nimport { loop } from './loop.js';\nimport { create_rule, delete_rule } from './style_manager.js';\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {import('./private.js').PositionRect} from\n * @param {import('./private.js').AnimationFn} fn\n */\nexport function create_animation(node, from, fn, params) {\n\tif (!from) return noop;\n\tconst to = node.getBoundingClientRect();\n\tif (\n\t\tfrom.left === to.left &&\n\t\tfrom.right === to.right &&\n\t\tfrom.top === to.top &&\n\t\tfrom.bottom === to.bottom\n\t)\n\t\treturn noop;\n\tconst {\n\t\tdelay = 0,\n\t\tduration = 300,\n\t\teasing = linear,\n\t\t// @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n\t\tstart: start_time = now() + delay,\n\t\t// @ts-ignore todo:\n\t\tend = start_time + duration,\n\t\ttick = noop,\n\t\tcss\n\t} = fn(node, { from, to }, params);\n\tlet running = true;\n\tlet started = false;\n\tlet name;\n\t/** @returns {void} */\n\tfunction start() {\n\t\tif (css) {\n\t\t\tname = create_rule(node, 0, 1, duration, delay, easing, css);\n\t\t}\n\t\tif (!delay) {\n\t\t\tstarted = true;\n\t\t}\n\t}\n\t/** @returns {void} */\n\tfunction stop() {\n\t\tif (css) delete_rule(node, name);\n\t\trunning = false;\n\t}\n\tloop((now) => {\n\t\tif (!started && now >= start_time) {\n\t\t\tstarted = true;\n\t\t}\n\t\tif (started && now >= end) {\n\t\t\ttick(1, 0);\n\t\t\tstop();\n\t\t}\n\t\tif (!running) {\n\t\t\treturn false;\n\t\t}\n\t\tif (started) {\n\t\t\tconst p = now - start_time;\n\t\t\tconst t = 0 + 1 * easing(p / duration);\n\t\t\ttick(t, 1 - t);\n\t\t}\n\t\treturn true;\n\t});\n\tstart();\n\ttick(0, 1);\n\treturn stop;\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @returns {void}\n */\nexport function fix_position(node) {\n\tconst style = getComputedStyle(node);\n\tif (style.position !== 'absolute' && style.position !== 'fixed') {\n\t\tconst { width, height } = style;\n\t\tconst a = node.getBoundingClientRect();\n\t\tnode.style.position = 'absolute';\n\t\tnode.style.width = width;\n\t\tnode.style.height = height;\n\t\tadd_transform(node, a);\n\t}\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {import('./private.js').PositionRect} a\n * @returns {void}\n */\nexport function add_transform(node, a) {\n\tconst b = node.getBoundingClientRect();\n\tif (a.left !== b.left || a.top !== b.top) {\n\t\tconst style = getComputedStyle(node);\n\t\tconst transform = style.transform === 'none' ? '' : style.transform;\n\t\tnode.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n\t}\n}\n","import { custom_event } from './dom.js';\n\nexport let current_component;\n\n/** @returns {void} */\nexport function set_current_component(component) {\n\tcurrent_component = component;\n}\n\nexport function get_current_component() {\n\tif (!current_component) throw new Error('Function called outside component initialization');\n\treturn current_component;\n}\n\n/**\n * Schedules a callback to run immediately before the component is updated after any state change.\n *\n * The first time the callback runs will be before the initial `onMount`\n *\n * https://svelte.dev/docs/svelte#beforeupdate\n * @param {() => any} fn\n * @returns {void}\n */\nexport function beforeUpdate(fn) {\n\tget_current_component().$$.before_update.push(fn);\n}\n\n/**\n * The `onMount` function schedules a callback to run as soon as the component has been mounted to the DOM.\n * It must be called during the component's initialisation (but doesn't need to live *inside* the component;\n * it can be called from an external module).\n *\n * If a function is returned _synchronously_ from `onMount`, it will be called when the component is unmounted.\n *\n * `onMount` does not run inside a [server-side component](https://svelte.dev/docs#run-time-server-side-component-api).\n *\n * https://svelte.dev/docs/svelte#onmount\n * @template T\n * @param {() => import('./private.js').NotFunction<T> | Promise<import('./private.js').NotFunction<T>> | (() => any)} fn\n * @returns {void}\n */\nexport function onMount(fn) {\n\tget_current_component().$$.on_mount.push(fn);\n}\n\n/**\n * Schedules a callback to run immediately after the component has been updated.\n *\n * The first time the callback runs will be after the initial `onMount`\n *\n * https://svelte.dev/docs/svelte#afterupdate\n * @param {() => any} fn\n * @returns {void}\n */\nexport function afterUpdate(fn) {\n\tget_current_component().$$.after_update.push(fn);\n}\n\n/**\n * Schedules a callback to run immediately before the component is unmounted.\n *\n * Out of `onMount`, `beforeUpdate`, `afterUpdate` and `onDestroy`, this is the\n * only one that runs inside a server-side component.\n *\n * https://svelte.dev/docs/svelte#ondestroy\n * @param {() => any} fn\n * @returns {void}\n */\nexport function onDestroy(fn) {\n\tget_current_component().$$.on_destroy.push(fn);\n}\n\n/**\n * Creates an event dispatcher that can be used to dispatch [component events](https://svelte.dev/docs#template-syntax-component-directives-on-eventname).\n * Event dispatchers are functions that can take two arguments: `name` and `detail`.\n *\n * Component events created with `createEventDispatcher` create a\n * [CustomEvent](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent).\n * These events do not [bubble](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#Event_bubbling_and_capture).\n * The `detail` argument corresponds to the [CustomEvent.detail](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail)\n * property and can contain any type of data.\n *\n * The event dispatcher can be typed to narrow the allowed event names and the type of the `detail` argument:\n * ```ts\n * const dispatch = createEventDispatcher<{\n *  loaded: never; // does not take a detail argument\n *  change: string; // takes a detail argument of type string, which is required\n *  optional: number | null; // takes an optional detail argument of type number\n * }>();\n * ```\n *\n * https://svelte.dev/docs/svelte#createeventdispatcher\n * @template {Record<string, any>} [EventMap=any]\n * @returns {import('./public.js').EventDispatcher<EventMap>}\n */\nexport function createEventDispatcher() {\n\tconst component = get_current_component();\n\treturn (type, detail, { cancelable = false } = {}) => {\n\t\tconst callbacks = component.$$.callbacks[type];\n\t\tif (callbacks) {\n\t\t\t// TODO are there situations where events could be dispatched\n\t\t\t// in a server (non-DOM) environment?\n\t\t\tconst event = custom_event(/** @type {string} */ (type), detail, { cancelable });\n\t\t\tcallbacks.slice().forEach((fn) => {\n\t\t\t\tfn.call(component, event);\n\t\t\t});\n\t\t\treturn !event.defaultPrevented;\n\t\t}\n\t\treturn true;\n\t};\n}\n\n/**\n * Associates an arbitrary `context` object with the current component and the specified `key`\n * and returns that object. The context is then available to children of the component\n * (including slotted content) with `getContext`.\n *\n * Like lifecycle functions, this must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#setcontext\n * @template T\n * @param {any} key\n * @param {T} context\n * @returns {T}\n */\nexport function setContext(key, context) {\n\tget_current_component().$$.context.set(key, context);\n\treturn context;\n}\n\n/**\n * Retrieves the context that belongs to the closest parent component with the specified `key`.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#getcontext\n * @template T\n * @param {any} key\n * @returns {T}\n */\nexport function getContext(key) {\n\treturn get_current_component().$$.context.get(key);\n}\n\n/**\n * Retrieves the whole context map that belongs to the closest parent component.\n * Must be called during component initialisation. Useful, for example, if you\n * programmatically create a component and want to pass the existing context to it.\n *\n * https://svelte.dev/docs/svelte#getallcontexts\n * @template {Map<any, any>} [T=Map<any, any>]\n * @returns {T}\n */\nexport function getAllContexts() {\n\treturn get_current_component().$$.context;\n}\n\n/**\n * Checks whether a given `key` has been set in the context of a parent component.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#hascontext\n * @param {any} key\n * @returns {boolean}\n */\nexport function hasContext(key) {\n\treturn get_current_component().$$.context.has(key);\n}\n\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\n/**\n * @param component\n * @param event\n * @returns {void}\n */\nexport function bubble(component, event) {\n\tconst callbacks = component.$$.callbacks[event.type];\n\tif (callbacks) {\n\t\t// @ts-ignore\n\t\tcallbacks.slice().forEach((fn) => fn.call(this, event));\n\t}\n}\n","import { run_all } from './utils.js';\nimport { current_component, set_current_component } from './lifecycle.js';\n\nexport const dirty_components = [];\nexport const intros = { enabled: false };\nexport const binding_callbacks = [];\n\nlet render_callbacks = [];\n\nconst flush_callbacks = [];\n\nconst resolved_promise = /* @__PURE__ */ Promise.resolve();\n\nlet update_scheduled = false;\n\n/** @returns {void} */\nexport function schedule_update() {\n\tif (!update_scheduled) {\n\t\tupdate_scheduled = true;\n\t\tresolved_promise.then(flush);\n\t}\n}\n\n/** @returns {Promise<void>} */\nexport function tick() {\n\tschedule_update();\n\treturn resolved_promise;\n}\n\n/** @returns {void} */\nexport function add_render_callback(fn) {\n\trender_callbacks.push(fn);\n}\n\n/** @returns {void} */\nexport function add_flush_callback(fn) {\n\tflush_callbacks.push(fn);\n}\n\n// flush() calls callbacks in this order:\n// 1. All beforeUpdate callbacks, in order: parents before children\n// 2. All bind:this callbacks, in reverse order: children before parents.\n// 3. All afterUpdate callbacks, in order: parents before children. EXCEPT\n//    for afterUpdates called during the initial onMount, which are called in\n//    reverse order: children before parents.\n// Since callbacks might update component values, which could trigger another\n// call to flush(), the following steps guard against this:\n// 1. During beforeUpdate, any updated components will be added to the\n//    dirty_components array and will cause a reentrant call to flush(). Because\n//    the flush index is kept outside the function, the reentrant call will pick\n//    up where the earlier call left off and go through all dirty components. The\n//    current_component value is saved and restored so that the reentrant call will\n//    not interfere with the \"parent\" flush() call.\n// 2. bind:this callbacks cannot trigger new flush() calls.\n// 3. During afterUpdate, any updated components will NOT have their afterUpdate\n//    callback called a second time; the seen_callbacks set, outside the flush()\n//    function, guarantees this behavior.\nconst seen_callbacks = new Set();\n\nlet flushidx = 0; // Do *not* move this inside the flush() function\n\n/** @returns {void} */\nexport function flush() {\n\t// Do not reenter flush while dirty components are updated, as this can\n\t// result in an infinite loop. Instead, let the inner flush handle it.\n\t// Reentrancy is ok afterwards for bindings etc.\n\tif (flushidx !== 0) {\n\t\treturn;\n\t}\n\tconst saved_component = current_component;\n\tdo {\n\t\t// first, call beforeUpdate functions\n\t\t// and update components\n\t\ttry {\n\t\t\twhile (flushidx < dirty_components.length) {\n\t\t\t\tconst component = dirty_components[flushidx];\n\t\t\t\tflushidx++;\n\t\t\t\tset_current_component(component);\n\t\t\t\tupdate(component.$$);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// reset dirty state to not end up in a deadlocked state and then rethrow\n\t\t\tdirty_components.length = 0;\n\t\t\tflushidx = 0;\n\t\t\tthrow e;\n\t\t}\n\t\tset_current_component(null);\n\t\tdirty_components.length = 0;\n\t\tflushidx = 0;\n\t\twhile (binding_callbacks.length) binding_callbacks.pop()();\n\t\t// then, once components are updated, call\n\t\t// afterUpdate functions. This may cause\n\t\t// subsequent updates...\n\t\tfor (let i = 0; i < render_callbacks.length; i += 1) {\n\t\t\tconst callback = render_callbacks[i];\n\t\t\tif (!seen_callbacks.has(callback)) {\n\t\t\t\t// ...so guard against infinite loops\n\t\t\t\tseen_callbacks.add(callback);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t\trender_callbacks.length = 0;\n\t} while (dirty_components.length);\n\twhile (flush_callbacks.length) {\n\t\tflush_callbacks.pop()();\n\t}\n\tupdate_scheduled = false;\n\tseen_callbacks.clear();\n\tset_current_component(saved_component);\n}\n\n/** @returns {void} */\nfunction update($$) {\n\tif ($$.fragment !== null) {\n\t\t$$.update();\n\t\trun_all($$.before_update);\n\t\tconst dirty = $$.dirty;\n\t\t$$.dirty = [-1];\n\t\t$$.fragment && $$.fragment.p($$.ctx, dirty);\n\t\t$$.after_update.forEach(add_render_callback);\n\t}\n}\n\n/**\n * Useful for example to execute remaining `afterUpdate` callbacks before executing `destroy`.\n * @param {Function[]} fns\n * @returns {void}\n */\nexport function flush_render_callbacks(fns) {\n\tconst filtered = [];\n\tconst targets = [];\n\trender_callbacks.forEach((c) => (fns.indexOf(c) === -1 ? filtered.push(c) : targets.push(c)));\n\ttargets.forEach((c) => c());\n\trender_callbacks = filtered;\n}\n","import { identity as linear, is_function, noop, run_all } from './utils.js';\nimport { now } from './environment.js';\nimport { loop } from './loop.js';\nimport { create_rule, delete_rule } from './style_manager.js';\nimport { custom_event } from './dom.js';\nimport { add_render_callback } from './scheduler.js';\n\n/**\n * @type {Promise<void> | null}\n */\nlet promise;\n\n/**\n * @returns {Promise<void>}\n */\nfunction wait() {\n\tif (!promise) {\n\t\tpromise = Promise.resolve();\n\t\tpromise.then(() => {\n\t\t\tpromise = null;\n\t\t});\n\t}\n\treturn promise;\n}\n\n/**\n * @param {Element} node\n * @param {INTRO | OUTRO | boolean} direction\n * @param {'start' | 'end'} kind\n * @returns {void}\n */\nfunction dispatch(node, direction, kind) {\n\tnode.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\n\nconst outroing = new Set();\n\n/**\n * @type {Outro}\n */\nlet outros;\n\n/**\n * @returns {void} */\nexport function group_outros() {\n\toutros = {\n\t\tr: 0,\n\t\tc: [],\n\t\tp: outros // parent group\n\t};\n}\n\n/**\n * @returns {void} */\nexport function check_outros() {\n\tif (!outros.r) {\n\t\trun_all(outros.c);\n\t}\n\toutros = outros.p;\n}\n\n/**\n * @param {import('./private.js').Fragment} block\n * @param {0 | 1} [local]\n * @returns {void}\n */\nexport function transition_in(block, local) {\n\tif (block && block.i) {\n\t\toutroing.delete(block);\n\t\tblock.i(local);\n\t}\n}\n\n/**\n * @param {import('./private.js').Fragment} block\n * @param {0 | 1} local\n * @param {0 | 1} [detach]\n * @param {() => void} [callback]\n * @returns {void}\n */\nexport function transition_out(block, local, detach, callback) {\n\tif (block && block.o) {\n\t\tif (outroing.has(block)) return;\n\t\toutroing.add(block);\n\t\toutros.c.push(() => {\n\t\t\toutroing.delete(block);\n\t\t\tif (callback) {\n\t\t\t\tif (detach) block.d(1);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t});\n\t\tblock.o(local);\n\t} else if (callback) {\n\t\tcallback();\n\t}\n}\n\n/**\n * @type {import('../transition/public.js').TransitionConfig}\n */\nconst null_transition = { duration: 0 };\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @returns {{ start(): void; invalidate(): void; end(): void; }}\n */\nexport function create_in_transition(node, fn, params) {\n\t/**\n\t * @type {TransitionOptions} */\n\tconst options = { direction: 'in' };\n\tlet config = fn(node, params, options);\n\tlet running = false;\n\tlet animation_name;\n\tlet task;\n\tlet uid = 0;\n\n\t/**\n\t * @returns {void} */\n\tfunction cleanup() {\n\t\tif (animation_name) delete_rule(node, animation_name);\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction go() {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\t\tif (css) animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n\t\ttick(0, 1);\n\t\tconst start_time = now() + delay;\n\t\tconst end_time = start_time + duration;\n\t\tif (task) task.abort();\n\t\trunning = true;\n\t\tadd_render_callback(() => dispatch(node, true, 'start'));\n\t\ttask = loop((now) => {\n\t\t\tif (running) {\n\t\t\t\tif (now >= end_time) {\n\t\t\t\t\ttick(1, 0);\n\t\t\t\t\tdispatch(node, true, 'end');\n\t\t\t\t\tcleanup();\n\t\t\t\t\treturn (running = false);\n\t\t\t\t}\n\t\t\t\tif (now >= start_time) {\n\t\t\t\t\tconst t = easing((now - start_time) / duration);\n\t\t\t\t\ttick(t, 1 - t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn running;\n\t\t});\n\t}\n\tlet started = false;\n\treturn {\n\t\tstart() {\n\t\t\tif (started) return;\n\t\t\tstarted = true;\n\t\t\tdelete_rule(node);\n\t\t\tif (is_function(config)) {\n\t\t\t\tconfig = config(options);\n\t\t\t\twait().then(go);\n\t\t\t} else {\n\t\t\t\tgo();\n\t\t\t}\n\t\t},\n\t\tinvalidate() {\n\t\t\tstarted = false;\n\t\t},\n\t\tend() {\n\t\t\tif (running) {\n\t\t\t\tcleanup();\n\t\t\t\trunning = false;\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @returns {{ end(reset: any): void; }}\n */\nexport function create_out_transition(node, fn, params) {\n\t/** @type {TransitionOptions} */\n\tconst options = { direction: 'out' };\n\tlet config = fn(node, params, options);\n\tlet running = true;\n\tlet animation_name;\n\tconst group = outros;\n\tgroup.r += 1;\n\t/** @type {boolean} */\n\tlet original_inert_value;\n\n\t/**\n\t * @returns {void} */\n\tfunction go() {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\n\t\tif (css) animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n\n\t\tconst start_time = now() + delay;\n\t\tconst end_time = start_time + duration;\n\t\tadd_render_callback(() => dispatch(node, false, 'start'));\n\n\t\tif ('inert' in node) {\n\t\t\toriginal_inert_value = /** @type {HTMLElement} */ (node).inert;\n\t\t\tnode.inert = true;\n\t\t}\n\n\t\tloop((now) => {\n\t\t\tif (running) {\n\t\t\t\tif (now >= end_time) {\n\t\t\t\t\ttick(0, 1);\n\t\t\t\t\tdispatch(node, false, 'end');\n\t\t\t\t\tif (!--group.r) {\n\t\t\t\t\t\t// this will result in `end()` being called,\n\t\t\t\t\t\t// so we don't need to clean up here\n\t\t\t\t\t\trun_all(group.c);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (now >= start_time) {\n\t\t\t\t\tconst t = easing((now - start_time) / duration);\n\t\t\t\t\ttick(1 - t, t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn running;\n\t\t});\n\t}\n\n\tif (is_function(config)) {\n\t\twait().then(() => {\n\t\t\t// @ts-ignore\n\t\t\tconfig = config(options);\n\t\t\tgo();\n\t\t});\n\t} else {\n\t\tgo();\n\t}\n\n\treturn {\n\t\tend(reset) {\n\t\t\tif (reset && 'inert' in node) {\n\t\t\t\tnode.inert = original_inert_value;\n\t\t\t}\n\t\t\tif (reset && config.tick) {\n\t\t\t\tconfig.tick(1, 0);\n\t\t\t}\n\t\t\tif (running) {\n\t\t\t\tif (animation_name) delete_rule(node, animation_name);\n\t\t\t\trunning = false;\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @param {boolean} intro\n * @returns {{ run(b: 0 | 1): void; end(): void; }}\n */\nexport function create_bidirectional_transition(node, fn, params, intro) {\n\t/**\n\t * @type {TransitionOptions} */\n\tconst options = { direction: 'both' };\n\tlet config = fn(node, params, options);\n\tlet t = intro ? 0 : 1;\n\n\t/**\n\t * @type {Program | null} */\n\tlet running_program = null;\n\n\t/**\n\t * @type {PendingProgram | null} */\n\tlet pending_program = null;\n\tlet animation_name = null;\n\n\t/** @type {boolean} */\n\tlet original_inert_value;\n\n\t/**\n\t * @returns {void} */\n\tfunction clear_animation() {\n\t\tif (animation_name) delete_rule(node, animation_name);\n\t}\n\n\t/**\n\t * @param {PendingProgram} program\n\t * @param {number} duration\n\t * @returns {Program}\n\t */\n\tfunction init(program, duration) {\n\t\tconst d = /** @type {Program['d']} */ (program.b - t);\n\t\tduration *= Math.abs(d);\n\t\treturn {\n\t\t\ta: t,\n\t\t\tb: program.b,\n\t\t\td,\n\t\t\tduration,\n\t\t\tstart: program.start,\n\t\t\tend: program.start + duration,\n\t\t\tgroup: program.group\n\t\t};\n\t}\n\n\t/**\n\t * @param {INTRO | OUTRO} b\n\t * @returns {void}\n\t */\n\tfunction go(b) {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\n\t\t/**\n\t\t * @type {PendingProgram} */\n\t\tconst program = {\n\t\t\tstart: now() + delay,\n\t\t\tb\n\t\t};\n\n\t\tif (!b) {\n\t\t\t// @ts-ignore todo: improve typings\n\t\t\tprogram.group = outros;\n\t\t\toutros.r += 1;\n\t\t}\n\n\t\tif ('inert' in node) {\n\t\t\tif (b) {\n\t\t\t\tif (original_inert_value !== undefined) {\n\t\t\t\t\t// aborted/reversed outro  restore previous inert value\n\t\t\t\t\tnode.inert = original_inert_value;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toriginal_inert_value = /** @type {HTMLElement} */ (node).inert;\n\t\t\t\tnode.inert = true;\n\t\t\t}\n\t\t}\n\n\t\tif (running_program || pending_program) {\n\t\t\tpending_program = program;\n\t\t} else {\n\t\t\t// if this is an intro, and there's a delay, we need to do\n\t\t\t// an initial tick and/or apply CSS animation immediately\n\t\t\tif (css) {\n\t\t\t\tclear_animation();\n\t\t\t\tanimation_name = create_rule(node, t, b, duration, delay, easing, css);\n\t\t\t}\n\t\t\tif (b) tick(0, 1);\n\t\t\trunning_program = init(program, duration);\n\t\t\tadd_render_callback(() => dispatch(node, b, 'start'));\n\t\t\tloop((now) => {\n\t\t\t\tif (pending_program && now > pending_program.start) {\n\t\t\t\t\trunning_program = init(pending_program, duration);\n\t\t\t\t\tpending_program = null;\n\t\t\t\t\tdispatch(node, running_program.b, 'start');\n\t\t\t\t\tif (css) {\n\t\t\t\t\t\tclear_animation();\n\t\t\t\t\t\tanimation_name = create_rule(\n\t\t\t\t\t\t\tnode,\n\t\t\t\t\t\t\tt,\n\t\t\t\t\t\t\trunning_program.b,\n\t\t\t\t\t\t\trunning_program.duration,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\teasing,\n\t\t\t\t\t\t\tconfig.css\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (running_program) {\n\t\t\t\t\tif (now >= running_program.end) {\n\t\t\t\t\t\ttick((t = running_program.b), 1 - t);\n\t\t\t\t\t\tdispatch(node, running_program.b, 'end');\n\t\t\t\t\t\tif (!pending_program) {\n\t\t\t\t\t\t\t// we're done\n\t\t\t\t\t\t\tif (running_program.b) {\n\t\t\t\t\t\t\t\t// intro  we can tidy up immediately\n\t\t\t\t\t\t\t\tclear_animation();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// outro  needs to be coordinated\n\t\t\t\t\t\t\t\tif (!--running_program.group.r) run_all(running_program.group.c);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trunning_program = null;\n\t\t\t\t\t} else if (now >= running_program.start) {\n\t\t\t\t\t\tconst p = now - running_program.start;\n\t\t\t\t\t\tt = running_program.a + running_program.d * easing(p / running_program.duration);\n\t\t\t\t\t\ttick(t, 1 - t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn !!(running_program || pending_program);\n\t\t\t});\n\t\t}\n\t}\n\treturn {\n\t\trun(b) {\n\t\t\tif (is_function(config)) {\n\t\t\t\twait().then(() => {\n\t\t\t\t\tconst opts = { direction: b ? 'in' : 'out' };\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tconfig = config(opts);\n\t\t\t\t\tgo(b);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tgo(b);\n\t\t\t}\n\t\t},\n\t\tend() {\n\t\t\tclear_animation();\n\t\t\trunning_program = pending_program = null;\n\t\t}\n\t};\n}\n\n/** @typedef {1} INTRO */\n/** @typedef {0} OUTRO */\n/** @typedef {{ direction: 'in' | 'out' | 'both' }} TransitionOptions */\n/** @typedef {(node: Element, params: any, options: TransitionOptions) => import('../transition/public.js').TransitionConfig} TransitionFn */\n\n/**\n * @typedef {Object} Outro\n * @property {number} r\n * @property {Function[]} c\n * @property {Object} p\n */\n\n/**\n * @typedef {Object} PendingProgram\n * @property {number} start\n * @property {INTRO|OUTRO} b\n * @property {Outro} [group]\n */\n\n/**\n * @typedef {Object} Program\n * @property {number} a\n * @property {INTRO|OUTRO} b\n * @property {1|-1} d\n * @property {number} duration\n * @property {number} start\n * @property {number} end\n * @property {Outro} [group]\n */\n","import { transition_in, transition_out } from './transitions.js';\nimport { run_all } from './utils.js';\n\n// general each functions:\n\nexport function ensure_array_like(array_like_or_iterator) {\n\treturn array_like_or_iterator?.length !== undefined\n\t\t? array_like_or_iterator\n\t\t: Array.from(array_like_or_iterator);\n}\n\n// keyed each functions:\n\n/** @returns {void} */\nexport function destroy_block(block, lookup) {\n\tblock.d(1);\n\tlookup.delete(block.key);\n}\n\n/** @returns {void} */\nexport function outro_and_destroy_block(block, lookup) {\n\ttransition_out(block, 1, 1, () => {\n\t\tlookup.delete(block.key);\n\t});\n}\n\n/** @returns {void} */\nexport function fix_and_destroy_block(block, lookup) {\n\tblock.f();\n\tdestroy_block(block, lookup);\n}\n\n/** @returns {void} */\nexport function fix_and_outro_and_destroy_block(block, lookup) {\n\tblock.f();\n\toutro_and_destroy_block(block, lookup);\n}\n\n/** @returns {any[]} */\nexport function update_keyed_each(\n\told_blocks,\n\tdirty,\n\tget_key,\n\tdynamic,\n\tctx,\n\tlist,\n\tlookup,\n\tnode,\n\tdestroy,\n\tcreate_each_block,\n\tnext,\n\tget_context\n) {\n\tlet o = old_blocks.length;\n\tlet n = list.length;\n\tlet i = o;\n\tconst old_indexes = {};\n\twhile (i--) old_indexes[old_blocks[i].key] = i;\n\tconst new_blocks = [];\n\tconst new_lookup = new Map();\n\tconst deltas = new Map();\n\tconst updates = [];\n\ti = n;\n\twhile (i--) {\n\t\tconst child_ctx = get_context(ctx, list, i);\n\t\tconst key = get_key(child_ctx);\n\t\tlet block = lookup.get(key);\n\t\tif (!block) {\n\t\t\tblock = create_each_block(key, child_ctx);\n\t\t\tblock.c();\n\t\t} else if (dynamic) {\n\t\t\t// defer updates until all the DOM shuffling is done\n\t\t\tupdates.push(() => block.p(child_ctx, dirty));\n\t\t}\n\t\tnew_lookup.set(key, (new_blocks[i] = block));\n\t\tif (key in old_indexes) deltas.set(key, Math.abs(i - old_indexes[key]));\n\t}\n\tconst will_move = new Set();\n\tconst did_move = new Set();\n\t/** @returns {void} */\n\tfunction insert(block) {\n\t\ttransition_in(block, 1);\n\t\tblock.m(node, next);\n\t\tlookup.set(block.key, block);\n\t\tnext = block.first;\n\t\tn--;\n\t}\n\twhile (o && n) {\n\t\tconst new_block = new_blocks[n - 1];\n\t\tconst old_block = old_blocks[o - 1];\n\t\tconst new_key = new_block.key;\n\t\tconst old_key = old_block.key;\n\t\tif (new_block === old_block) {\n\t\t\t// do nothing\n\t\t\tnext = new_block.first;\n\t\t\to--;\n\t\t\tn--;\n\t\t} else if (!new_lookup.has(old_key)) {\n\t\t\t// remove old block\n\t\t\tdestroy(old_block, lookup);\n\t\t\to--;\n\t\t} else if (!lookup.has(new_key) || will_move.has(new_key)) {\n\t\t\tinsert(new_block);\n\t\t} else if (did_move.has(old_key)) {\n\t\t\to--;\n\t\t} else if (deltas.get(new_key) > deltas.get(old_key)) {\n\t\t\tdid_move.add(new_key);\n\t\t\tinsert(new_block);\n\t\t} else {\n\t\t\twill_move.add(old_key);\n\t\t\to--;\n\t\t}\n\t}\n\twhile (o--) {\n\t\tconst old_block = old_blocks[o];\n\t\tif (!new_lookup.has(old_block.key)) destroy(old_block, lookup);\n\t}\n\twhile (n) insert(new_blocks[n - 1]);\n\trun_all(updates);\n\treturn new_blocks;\n}\n\n/** @returns {void} */\nexport function validate_each_keys(ctx, list, get_context, get_key) {\n\tconst keys = new Map();\n\tfor (let i = 0; i < list.length; i++) {\n\t\tconst key = get_key(get_context(ctx, list, i));\n\t\tif (keys.has(key)) {\n\t\t\tlet value = '';\n\t\t\ttry {\n\t\t\t\tvalue = `with value '${String(key)}' `;\n\t\t\t} catch (e) {\n\t\t\t\t// can't stringify\n\t\t\t}\n\t\t\tthrow new Error(\n\t\t\t\t`Cannot have duplicate keys in a keyed each: Keys at index ${keys.get(\n\t\t\t\t\tkey\n\t\t\t\t)} and ${i} ${value}are duplicates`\n\t\t\t);\n\t\t}\n\t\tkeys.set(key, i);\n\t}\n}\n","/** @returns {{}} */\nexport function get_spread_update(levels, updates) {\n\tconst update = {};\n\tconst to_null_out = {};\n\tconst accounted_for = { $$scope: 1 };\n\tlet i = levels.length;\n\twhile (i--) {\n\t\tconst o = levels[i];\n\t\tconst n = updates[i];\n\t\tif (n) {\n\t\t\tfor (const key in o) {\n\t\t\t\tif (!(key in n)) to_null_out[key] = 1;\n\t\t\t}\n\t\t\tfor (const key in n) {\n\t\t\t\tif (!accounted_for[key]) {\n\t\t\t\t\tupdate[key] = n[key];\n\t\t\t\t\taccounted_for[key] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlevels[i] = n;\n\t\t} else {\n\t\t\tfor (const key in o) {\n\t\t\t\taccounted_for[key] = 1;\n\t\t\t}\n\t\t}\n\t}\n\tfor (const key in to_null_out) {\n\t\tif (!(key in update)) update[key] = undefined;\n\t}\n\treturn update;\n}\n\nexport function get_spread_object(spread_props) {\n\treturn typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n","import {\n\tadd_render_callback,\n\tflush,\n\tflush_render_callbacks,\n\tschedule_update,\n\tdirty_components\n} from './scheduler.js';\nimport { current_component, set_current_component } from './lifecycle.js';\nimport { blank_object, is_empty, is_function, run, run_all, noop } from './utils.js';\nimport {\n\tchildren,\n\tdetach,\n\tstart_hydrating,\n\tend_hydrating,\n\tget_custom_elements_slots,\n\tinsert,\n\telement,\n\tattr\n} from './dom.js';\nimport { transition_in } from './transitions.js';\n\n/** @returns {void} */\nexport function bind(component, name, callback) {\n\tconst index = component.$$.props[name];\n\tif (index !== undefined) {\n\t\tcomponent.$$.bound[index] = callback;\n\t\tcallback(component.$$.ctx[index]);\n\t}\n}\n\n/** @returns {void} */\nexport function create_component(block) {\n\tblock && block.c();\n}\n\n/** @returns {void} */\nexport function claim_component(block, parent_nodes) {\n\tblock && block.l(parent_nodes);\n}\n\n/** @returns {void} */\nexport function mount_component(component, target, anchor) {\n\tconst { fragment, after_update } = component.$$;\n\tfragment && fragment.m(target, anchor);\n\t// onMount happens before the initial afterUpdate\n\tadd_render_callback(() => {\n\t\tconst new_on_destroy = component.$$.on_mount.map(run).filter(is_function);\n\t\t// if the component was destroyed immediately\n\t\t// it will update the `$$.on_destroy` reference to `null`.\n\t\t// the destructured on_destroy may still reference to the old array\n\t\tif (component.$$.on_destroy) {\n\t\t\tcomponent.$$.on_destroy.push(...new_on_destroy);\n\t\t} else {\n\t\t\t// Edge case - component was destroyed immediately,\n\t\t\t// most likely as a result of a binding initialising\n\t\t\trun_all(new_on_destroy);\n\t\t}\n\t\tcomponent.$$.on_mount = [];\n\t});\n\tafter_update.forEach(add_render_callback);\n}\n\n/** @returns {void} */\nexport function destroy_component(component, detaching) {\n\tconst $$ = component.$$;\n\tif ($$.fragment !== null) {\n\t\tflush_render_callbacks($$.after_update);\n\t\trun_all($$.on_destroy);\n\t\t$$.fragment && $$.fragment.d(detaching);\n\t\t// TODO null out other refs, including component.$$ (but need to\n\t\t// preserve final state?)\n\t\t$$.on_destroy = $$.fragment = null;\n\t\t$$.ctx = [];\n\t}\n}\n\n/** @returns {void} */\nfunction make_dirty(component, i) {\n\tif (component.$$.dirty[0] === -1) {\n\t\tdirty_components.push(component);\n\t\tschedule_update();\n\t\tcomponent.$$.dirty.fill(0);\n\t}\n\tcomponent.$$.dirty[(i / 31) | 0] |= 1 << i % 31;\n}\n\n// TODO: Document the other params\n/**\n * @param {SvelteComponent} component\n * @param {import('./public.js').ComponentConstructorOptions} options\n *\n * @param {import('./utils.js')['not_equal']} not_equal Used to compare props and state values.\n * @param {(target: Element | ShadowRoot) => void} [append_styles] Function that appends styles to the DOM when the component is first initialised.\n * This will be the `add_css` function from the compiled component.\n *\n * @returns {void}\n */\nexport function init(\n\tcomponent,\n\toptions,\n\tinstance,\n\tcreate_fragment,\n\tnot_equal,\n\tprops,\n\tappend_styles = null,\n\tdirty = [-1]\n) {\n\tconst parent_component = current_component;\n\tset_current_component(component);\n\t/** @type {import('./private.js').T$$} */\n\tconst $$ = (component.$$ = {\n\t\tfragment: null,\n\t\tctx: [],\n\t\t// state\n\t\tprops,\n\t\tupdate: noop,\n\t\tnot_equal,\n\t\tbound: blank_object(),\n\t\t// lifecycle\n\t\ton_mount: [],\n\t\ton_destroy: [],\n\t\ton_disconnect: [],\n\t\tbefore_update: [],\n\t\tafter_update: [],\n\t\tcontext: new Map(options.context || (parent_component ? parent_component.$$.context : [])),\n\t\t// everything else\n\t\tcallbacks: blank_object(),\n\t\tdirty,\n\t\tskip_bound: false,\n\t\troot: options.target || parent_component.$$.root\n\t});\n\tappend_styles && append_styles($$.root);\n\tlet ready = false;\n\t$$.ctx = instance\n\t\t? instance(component, options.props || {}, (i, ret, ...rest) => {\n\t\t\t\tconst value = rest.length ? rest[0] : ret;\n\t\t\t\tif ($$.ctx && not_equal($$.ctx[i], ($$.ctx[i] = value))) {\n\t\t\t\t\tif (!$$.skip_bound && $$.bound[i]) $$.bound[i](value);\n\t\t\t\t\tif (ready) make_dirty(component, i);\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t  })\n\t\t: [];\n\t$$.update();\n\tready = true;\n\trun_all($$.before_update);\n\t// `false` as a special case of no DOM component\n\t$$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n\tif (options.target) {\n\t\tif (options.hydrate) {\n\t\t\tstart_hydrating();\n\t\t\t// TODO: what is the correct type here?\n\t\t\t// @ts-expect-error\n\t\t\tconst nodes = children(options.target);\n\t\t\t$$.fragment && $$.fragment.l(nodes);\n\t\t\tnodes.forEach(detach);\n\t\t} else {\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n\t\t\t$$.fragment && $$.fragment.c();\n\t\t}\n\t\tif (options.intro) transition_in(component.$$.fragment);\n\t\tmount_component(component, options.target, options.anchor);\n\t\tend_hydrating();\n\t\tflush();\n\t}\n\tset_current_component(parent_component);\n}\n\nexport let SvelteElement;\n\nif (typeof HTMLElement === 'function') {\n\tSvelteElement = class extends HTMLElement {\n\t\t/** The Svelte component constructor */\n\t\t$$ctor;\n\t\t/** Slots */\n\t\t$$s;\n\t\t/** The Svelte component instance */\n\t\t$$c;\n\t\t/** Whether or not the custom element is connected */\n\t\t$$cn = false;\n\t\t/** Component props data */\n\t\t$$d = {};\n\t\t/** `true` if currently in the process of reflecting component props back to attributes */\n\t\t$$r = false;\n\t\t/** @type {Record<string, CustomElementPropDefinition>} Props definition (name, reflected, type etc) */\n\t\t$$p_d = {};\n\t\t/** @type {Record<string, Function[]>} Event listeners */\n\t\t$$l = {};\n\t\t/** @type {Map<Function, Function>} Event listener unsubscribe functions */\n\t\t$$l_u = new Map();\n\n\t\tconstructor($$componentCtor, $$slots, use_shadow_dom) {\n\t\t\tsuper();\n\t\t\tthis.$$ctor = $$componentCtor;\n\t\t\tthis.$$s = $$slots;\n\t\t\tif (use_shadow_dom) {\n\t\t\t\tthis.attachShadow({ mode: 'open' });\n\t\t\t}\n\t\t}\n\n\t\taddEventListener(type, listener, options) {\n\t\t\t// We can't determine upfront if the event is a custom event or not, so we have to\n\t\t\t// listen to both. If someone uses a custom event with the same name as a regular\n\t\t\t// browser event, this fires twice - we can't avoid that.\n\t\t\tthis.$$l[type] = this.$$l[type] || [];\n\t\t\tthis.$$l[type].push(listener);\n\t\t\tif (this.$$c) {\n\t\t\t\tconst unsub = this.$$c.$on(type, listener);\n\t\t\t\tthis.$$l_u.set(listener, unsub);\n\t\t\t}\n\t\t\tsuper.addEventListener(type, listener, options);\n\t\t}\n\n\t\tremoveEventListener(type, listener, options) {\n\t\t\tsuper.removeEventListener(type, listener, options);\n\t\t\tif (this.$$c) {\n\t\t\t\tconst unsub = this.$$l_u.get(listener);\n\t\t\t\tif (unsub) {\n\t\t\t\t\tunsub();\n\t\t\t\t\tthis.$$l_u.delete(listener);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tasync connectedCallback() {\n\t\t\tthis.$$cn = true;\n\t\t\tif (!this.$$c) {\n\t\t\t\t// We wait one tick to let possible child slot elements be created/mounted\n\t\t\t\tawait Promise.resolve();\n\t\t\t\tif (!this.$$cn || this.$$c) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tfunction create_slot(name) {\n\t\t\t\t\treturn () => {\n\t\t\t\t\t\tlet node;\n\t\t\t\t\t\tconst obj = {\n\t\t\t\t\t\t\tc: function create() {\n\t\t\t\t\t\t\t\tnode = element('slot');\n\t\t\t\t\t\t\t\tif (name !== 'default') {\n\t\t\t\t\t\t\t\t\tattr(node, 'name', name);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t * @param {HTMLElement} target\n\t\t\t\t\t\t\t * @param {HTMLElement} [anchor]\n\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\tm: function mount(target, anchor) {\n\t\t\t\t\t\t\t\tinsert(target, node, anchor);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\td: function destroy(detaching) {\n\t\t\t\t\t\t\t\tif (detaching) {\n\t\t\t\t\t\t\t\t\tdetach(node);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn obj;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tconst $$slots = {};\n\t\t\t\tconst existing_slots = get_custom_elements_slots(this);\n\t\t\t\tfor (const name of this.$$s) {\n\t\t\t\t\tif (name in existing_slots) {\n\t\t\t\t\t\t$$slots[name] = [create_slot(name)];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (const attribute of this.attributes) {\n\t\t\t\t\t// this.$$data takes precedence over this.attributes\n\t\t\t\t\tconst name = this.$$g_p(attribute.name);\n\t\t\t\t\tif (!(name in this.$$d)) {\n\t\t\t\t\t\tthis.$$d[name] = get_custom_element_value(name, attribute.value, this.$$p_d, 'toProp');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Port over props that were set programmatically before ce was initialized\n\t\t\t\tfor (const key in this.$$p_d) {\n\t\t\t\t\tif (!(key in this.$$d) && this[key] !== undefined) {\n\t\t\t\t\t\tthis.$$d[key] = this[key]; // don't transform, these were set through JavaScript\n\t\t\t\t\t\tdelete this[key]; // remove the property that shadows the getter/setter\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.$$c = new this.$$ctor({\n\t\t\t\t\ttarget: this.shadowRoot || this,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...this.$$d,\n\t\t\t\t\t\t$$slots,\n\t\t\t\t\t\t$$scope: {\n\t\t\t\t\t\t\tctx: []\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Reflect component props as attributes\n\t\t\t\tconst reflect_attributes = () => {\n\t\t\t\t\tthis.$$r = true;\n\t\t\t\t\tfor (const key in this.$$p_d) {\n\t\t\t\t\t\tthis.$$d[key] = this.$$c.$$.ctx[this.$$c.$$.props[key]];\n\t\t\t\t\t\tif (this.$$p_d[key].reflect) {\n\t\t\t\t\t\t\tconst attribute_value = get_custom_element_value(\n\t\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t\tthis.$$d[key],\n\t\t\t\t\t\t\t\tthis.$$p_d,\n\t\t\t\t\t\t\t\t'toAttribute'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (attribute_value == null) {\n\t\t\t\t\t\t\t\tthis.removeAttribute(this.$$p_d[key].attribute || key);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.setAttribute(this.$$p_d[key].attribute || key, attribute_value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.$$r = false;\n\t\t\t\t};\n\t\t\t\tthis.$$c.$$.after_update.push(reflect_attributes);\n\t\t\t\treflect_attributes(); // once initially because after_update is added too late for first render\n\n\t\t\t\tfor (const type in this.$$l) {\n\t\t\t\t\tfor (const listener of this.$$l[type]) {\n\t\t\t\t\t\tconst unsub = this.$$c.$on(type, listener);\n\t\t\t\t\t\tthis.$$l_u.set(listener, unsub);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.$$l = {};\n\t\t\t}\n\t\t}\n\n\t\t// We don't need this when working within Svelte code, but for compatibility of people using this outside of Svelte\n\t\t// and setting attributes through setAttribute etc, this is helpful\n\t\tattributeChangedCallback(attr, _oldValue, newValue) {\n\t\t\tif (this.$$r) return;\n\t\t\tattr = this.$$g_p(attr);\n\t\t\tthis.$$d[attr] = get_custom_element_value(attr, newValue, this.$$p_d, 'toProp');\n\t\t\tthis.$$c?.$set({ [attr]: this.$$d[attr] });\n\t\t}\n\n\t\tdisconnectedCallback() {\n\t\t\tthis.$$cn = false;\n\t\t\t// In a microtask, because this could be a move within the DOM\n\t\t\tPromise.resolve().then(() => {\n\t\t\t\tif (!this.$$cn && this.$$c) {\n\t\t\t\t\tthis.$$c.$destroy();\n\t\t\t\t\tthis.$$c = undefined;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t$$g_p(attribute_name) {\n\t\t\treturn (\n\t\t\t\tObject.keys(this.$$p_d).find(\n\t\t\t\t\t(key) =>\n\t\t\t\t\t\tthis.$$p_d[key].attribute === attribute_name ||\n\t\t\t\t\t\t(!this.$$p_d[key].attribute && key.toLowerCase() === attribute_name)\n\t\t\t\t) || attribute_name\n\t\t\t);\n\t\t}\n\t};\n}\n\n/**\n * @param {string} prop\n * @param {any} value\n * @param {Record<string, CustomElementPropDefinition>} props_definition\n * @param {'toAttribute' | 'toProp'} [transform]\n */\nfunction get_custom_element_value(prop, value, props_definition, transform) {\n\tconst type = props_definition[prop]?.type;\n\tvalue = type === 'Boolean' && typeof value !== 'boolean' ? value != null : value;\n\tif (!transform || !props_definition[prop]) {\n\t\treturn value;\n\t} else if (transform === 'toAttribute') {\n\t\tswitch (type) {\n\t\t\tcase 'Object':\n\t\t\tcase 'Array':\n\t\t\t\treturn value == null ? null : JSON.stringify(value);\n\t\t\tcase 'Boolean':\n\t\t\t\treturn value ? '' : null;\n\t\t\tcase 'Number':\n\t\t\t\treturn value == null ? null : value;\n\t\t\tdefault:\n\t\t\t\treturn value;\n\t\t}\n\t} else {\n\t\tswitch (type) {\n\t\t\tcase 'Object':\n\t\t\tcase 'Array':\n\t\t\t\treturn value && JSON.parse(value);\n\t\t\tcase 'Boolean':\n\t\t\t\treturn value; // conversion already handled above\n\t\t\tcase 'Number':\n\t\t\t\treturn value != null ? +value : value;\n\t\t\tdefault:\n\t\t\t\treturn value;\n\t\t}\n\t}\n}\n\n/**\n * @internal\n *\n * Turn a Svelte component into a custom element.\n * @param {import('./public.js').ComponentType} Component  A Svelte component constructor\n * @param {Record<string, CustomElementPropDefinition>} props_definition  The props to observe\n * @param {string[]} slots  The slots to create\n * @param {string[]} accessors  Other accessors besides the ones for props the component has\n * @param {boolean} use_shadow_dom  Whether to use shadow DOM\n * @param {(ce: new () => HTMLElement) => new () => HTMLElement} [extend]\n */\nexport function create_custom_element(\n\tComponent,\n\tprops_definition,\n\tslots,\n\taccessors,\n\tuse_shadow_dom,\n\textend\n) {\n\tlet Class = class extends SvelteElement {\n\t\tconstructor() {\n\t\t\tsuper(Component, slots, use_shadow_dom);\n\t\t\tthis.$$p_d = props_definition;\n\t\t}\n\t\tstatic get observedAttributes() {\n\t\t\treturn Object.keys(props_definition).map((key) =>\n\t\t\t\t(props_definition[key].attribute || key).toLowerCase()\n\t\t\t);\n\t\t}\n\t};\n\tObject.keys(props_definition).forEach((prop) => {\n\t\tObject.defineProperty(Class.prototype, prop, {\n\t\t\tget() {\n\t\t\t\treturn this.$$c && prop in this.$$c ? this.$$c[prop] : this.$$d[prop];\n\t\t\t},\n\t\t\tset(value) {\n\t\t\t\tvalue = get_custom_element_value(prop, value, props_definition);\n\t\t\t\tthis.$$d[prop] = value;\n\t\t\t\tthis.$$c?.$set({ [prop]: value });\n\t\t\t}\n\t\t});\n\t});\n\taccessors.forEach((accessor) => {\n\t\tObject.defineProperty(Class.prototype, accessor, {\n\t\t\tget() {\n\t\t\t\treturn this.$$c?.[accessor];\n\t\t\t}\n\t\t});\n\t});\n\tif (extend) {\n\t\t// @ts-expect-error - assigning here is fine\n\t\tClass = extend(Class);\n\t}\n\tComponent.element = /** @type {any} */ (Class);\n\treturn Class;\n}\n\n/**\n * Base class for Svelte components. Used when dev=false.\n *\n * @template {Record<string, any>} [Props=any]\n * @template {Record<string, any>} [Events=any]\n */\nexport class SvelteComponent {\n\t/**\n\t * ### PRIVATE API\n\t *\n\t * Do not use, may change at any time\n\t *\n\t * @type {any}\n\t */\n\t$$ = undefined;\n\t/**\n\t * ### PRIVATE API\n\t *\n\t * Do not use, may change at any time\n\t *\n\t * @type {any}\n\t */\n\t$$set = undefined;\n\n\t/** @returns {void} */\n\t$destroy() {\n\t\tdestroy_component(this, 1);\n\t\tthis.$destroy = noop;\n\t}\n\n\t/**\n\t * @template {Extract<keyof Events, string>} K\n\t * @param {K} type\n\t * @param {((e: Events[K]) => void) | null | undefined} callback\n\t * @returns {() => void}\n\t */\n\t$on(type, callback) {\n\t\tif (!is_function(callback)) {\n\t\t\treturn noop;\n\t\t}\n\t\tconst callbacks = this.$$.callbacks[type] || (this.$$.callbacks[type] = []);\n\t\tcallbacks.push(callback);\n\t\treturn () => {\n\t\t\tconst index = callbacks.indexOf(callback);\n\t\t\tif (index !== -1) callbacks.splice(index, 1);\n\t\t};\n\t}\n\n\t/**\n\t * @param {Partial<Props>} props\n\t * @returns {void}\n\t */\n\t$set(props) {\n\t\tif (this.$$set && !is_empty(props)) {\n\t\t\tthis.$$.skip_bound = true;\n\t\t\tthis.$$set(props);\n\t\t\tthis.$$.skip_bound = false;\n\t\t}\n\t}\n}\n\n/**\n * @typedef {Object} CustomElementPropDefinition\n * @property {string} [attribute]\n * @property {boolean} [reflect]\n * @property {'String'|'Boolean'|'Number'|'Array'|'Object'} [type]\n */\n","// generated during release, do not modify\n\n/**\n * The current version, as set in package.json.\n *\n * https://svelte.dev/docs/svelte-compiler#svelte-version\n * @type {string}\n */\nexport const VERSION = '4.2.18';\nexport const PUBLIC_VERSION = '4';\n","import { PUBLIC_VERSION } from '../../../shared/version.js';\n\nif (typeof window !== 'undefined')\n\t// @ts-ignore\n\t(window.__svelte || (window.__svelte = { v: new Set() })).v.add(PUBLIC_VERSION);\n","import CONSTANTS from \"../constants/constants.js\";\r\nimport * as Utilities from \"./utilities.js\";\r\n\r\nexport function setupCaches() {\r\n\r\n\tHooks.on(CONSTANTS.HOOKS.PILE.DELETE, (doc) => {\r\n\t\tconst uuid = Utilities.getUuid(doc);\r\n\t\tlet actor = Utilities.getActor(doc);\r\n\t\tif (actor instanceof Actor) {\r\n\t\t\tactor = actor.toObject();\r\n\t\t}\r\n\t\tdeletedActorCache.set(uuid, actor);\r\n\t});\r\n\r\n}\r\n\r\nclass DebouncedCache extends Map {\r\n\r\n\t#debounceClear = {};\r\n\t#timeout = {};\r\n\r\n\tconstructor(timeout = 50) {\r\n\t\tsuper();\r\n\t\tthis.#timeout = timeout;\r\n\t}\r\n\r\n\tset(key, value) {\r\n\t\tthis.#setDebounce(key)\r\n\t\treturn super.set(key, value);\r\n\t}\r\n\r\n\t#setDebounce(key) {\r\n\t\tif (!this.#debounceClear[key]) {\r\n\t\t\tconst self = this;\r\n\t\t\tthis.#debounceClear[key] = foundry.utils.debounce(() => {\r\n\t\t\t\tdelete self.#debounceClear[key];\r\n\t\t\t\tself.delete(key);\r\n\t\t\t}, this.#timeout);\r\n\t\t}\r\n\t\tthis.#debounceClear[key]();\r\n\t}\r\n}\r\n\r\n\r\nexport const deletedActorCache = new DebouncedCache(5000);\r\nexport const cachedActorCurrencies = new DebouncedCache();\r\nexport const cachedCurrenciesInItem = new DebouncedCache();\r\nexport const cachedFilterList = new DebouncedCache();\r\nexport const cachedRequiredPropertiesList = new DebouncedCache();\r\nexport const cachedCurrencyList = new DebouncedCache();\r\n\r\n","import CONSTANTS from \"../constants/constants.js\";\r\nimport * as Utilities from \"./utilities.js\"\r\nimport * as PileUtilities from \"./pile-utilities.js\"\r\nimport { SYSTEMS } from \"../systems.js\";\r\n\r\nexport function getActivePlayers(onlyActive = false) {\r\n\treturn Array.from(game.users).filter(u => (u.active || !onlyActive) && u.character);\r\n}\r\n\r\n/**\r\n * Gets the players that can interact with this item pile\r\n *\r\n * @param {Actor|TokenDocument|String} target\r\n * @returns {Array<User>}\r\n */\r\nexport function getPlayersForItemPile(target) {\r\n\tconst targetActor = Utilities.getActor(target);\r\n\tif (!PileUtilities.isValidItemPile(targetActor)) return [];\r\n\tconst pileData = PileUtilities.getActorFlagData(targetActor);\r\n\treturn getActivePlayers(pileData.activePlayers);\r\n}\r\n\r\n/**\r\n * Gets the characters for each player\r\n *\r\n * @param {Actor|TokenDocument|String} target\r\n * @returns {Array<User>}\r\n */\r\nexport function getCharactersForItemPile(target) {\r\n\treturn getPlayersForItemPile(target).map(player => Utilities.getUserCharacter(player));\r\n}\r\n\r\n/**\r\n * Determines whether a pile can be split\r\n *\r\n * @param target\r\n * @returns {boolean}\r\n */\r\nexport function canItemPileBeSplit(target) {\r\n\tconst pileData = PileUtilities.getActorFlagData(target);\r\n\tconst shareData = getItemPileSharingData(target);\r\n\tconst playerActors = getCharactersForItemPile(target);\r\n\tif (!playerActors.length) return false;\r\n\tconst pileItems = PileUtilities.getActorItems(target);\r\n\tconst items = pileData.shareItemsEnabled ? pileItems : [];\r\n\tconst currencies = pileData.shareCurrenciesEnabled || pileData.splitAllEnabled\r\n\t\t? PileUtilities.getActorCurrencies(target, { secondary: false })\r\n\t\t: [];\r\n\tfor (const item of items) {\r\n\t\tif (playerActors.every(character => getItemSharesLeftForActor(target, item, character, {\r\n\t\t\tshareData,\r\n\t\t\tfloor: true,\r\n\t\t\tplayers: playerActors.length\r\n\t\t}))) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\tif (SYSTEMS.DATA.ITEM_TYPE_HANDLERS) {\r\n\t\tfor (const item of pileItems) {\r\n\t\t\tif (!Utilities.hasItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.HAS_CURRENCY, item.type)) continue;\r\n\t\t\tconst itemCurrencies = PileUtilities.getCurrenciesInItem(item, { forActor: target, secondary: false });\r\n\t\t\tfor (const currency of itemCurrencies) {\r\n\t\t\t\tif (playerActors.every(character => getAttributeSharesLeftForActor(target, currency.path, character, {\r\n\t\t\t\t\tshareData,\r\n\t\t\t\t\tfloor: true,\r\n\t\t\t\t\tplayers: playerActors.length,\r\n\t\t\t\t\tsource: item\r\n\t\t\t\t}))) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tfor (const currency of currencies) {\r\n\t\tif (currency.type === \"item\") {\r\n\t\t\tif (playerActors.every(character => getItemSharesLeftForActor(target, currency.item, character, {\r\n\t\t\t\tshareData,\r\n\t\t\t\tfloor: true,\r\n\t\t\t\tplayers: playerActors.length\r\n\t\t\t}))) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (playerActors.every(character => getAttributeSharesLeftForActor(target, currency.path, character, {\r\n\t\t\t\tshareData,\r\n\t\t\t\tfloor: true,\r\n\t\t\t\tplayers: playerActors.length\r\n\t\t\t}))) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * Retrieves an item pile's sharing data\r\n *\r\n * @param {Actor|TokenDocument|String} target\r\n * @returns {Object}\r\n */\r\nexport function getItemPileSharingData(target) {\r\n\tconst targetActor = Utilities.getActor(target);\r\n\treturn foundry.utils.duplicate(foundry.utils.getProperty(targetActor, CONSTANTS.FLAGS.SHARING) ?? {});\r\n}\r\n\r\n/**\r\n * Updates an item pile's sharing data\r\n *\r\n * @param {Actor|TokenDocument|String} target\r\n * @param {Object} incomingSharingData\r\n * @returns {Promise}\r\n */\r\nexport function updateItemPileSharingData(target, incomingSharingData) {\r\n\tconst targetActor = Utilities.getActor(target);\r\n\tconst currentSharingData = getItemPileSharingData(targetActor);\r\n\tconst newSharingData = foundry.utils.mergeObject(currentSharingData, incomingSharingData);\r\n\treturn targetActor.update({\r\n\t\t[CONSTANTS.FLAGS.SHARING]: newSharingData\r\n\t});\r\n}\r\n\r\n/**\r\n * Clears an item pile's sharing data\r\n *\r\n * @param {Actor|TokenDocument|foundry.abstract.Document|String} target\r\n * @returns {Promise}\r\n */\r\nexport function clearItemPileSharingData(target) {\r\n\tconst targetActor = Utilities.getActor(target);\r\n\treturn targetActor.update({\r\n\t\t[CONSTANTS.FLAGS.SHARING]: null\r\n\t});\r\n}\r\n\r\n/**\r\n * Merges and resolves existing sharing data on a given item pile\r\n *\r\n * @param {String} sourceUuid\r\n * @param {String} targetUuid\r\n * @param {Array<Object>} [items]\r\n * @param {Array<Object>} [attributes]\r\n */\r\nexport async function setItemPileSharingData(sourceUuid, targetUuid, { items = [], attributes = [] } = {}) {\r\n\r\n\tconst sourceActor = Utilities.getActor(sourceUuid);\r\n\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\tconst sourceIsItemPile = PileUtilities.isValidItemPile(sourceActor);\r\n\tconst targetIsItemPile = PileUtilities.isValidItemPile(targetActor);\r\n\r\n\t// If both the source and target are item piles, we want to ignore this execution\r\n\tif (sourceIsItemPile && targetIsItemPile) return;\r\n\r\n\tif (items.length) {\r\n\t\titems = items.map(itemData => {\r\n\t\t\tUtilities.setItemQuantity(itemData.item, Math.abs(itemData.quantity));\r\n\t\t\treturn itemData.item;\r\n\t\t})\r\n\t}\r\n\r\n\tif (!Array.isArray(attributes) && typeof attributes === \"object\") {\r\n\t\tattributes = Object.entries(attributes).map(entry => {\r\n\t\t\treturn {\r\n\t\t\t\tpath: entry[0],\r\n\t\t\t\tquantity: Math.abs(entry[1])\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tif (sourceIsItemPile) {\r\n\r\n\t\tif (PileUtilities.isItemPileEmpty(sourceActor)) {\r\n\t\t\treturn clearItemPileSharingData(sourceActor);\r\n\t\t}\r\n\r\n\t\tconst sharingData = addToItemPileSharingData(sourceActor, targetActor.uuid, { items, attributes });\r\n\t\treturn updateItemPileSharingData(sourceActor, sharingData);\r\n\r\n\t}\r\n\r\n\tconst sharingData = removeFromItemPileSharingData(targetActor, sourceActor.uuid, { items, attributes });\r\n\treturn updateItemPileSharingData(targetActor, sharingData);\r\n\r\n}\r\n\r\nexport function addToItemPileSharingData(itemPile, actorUuid, {\r\n\tsharingData = false,\r\n\titems = [],\r\n\tattributes = []\r\n} = {}) {\r\n\r\n\tconst pileData = PileUtilities.getActorFlagData(itemPile);\r\n\r\n\tconst pileCurrencies = PileUtilities.getActorCurrencies(itemPile, { getAll: true });\r\n\r\n\tconst filteredItems = items.filter(item => !pileCurrencies.some(currency => item.id !== currency.id));\r\n\tconst currencies = items.filter(item => !pileCurrencies.some(currency => item.id === currency.id));\r\n\r\n\tlet pileSharingData = {};\r\n\tif (!sharingData && ((pileData.shareItemsEnabled && filteredItems.length) || (pileData.shareCurrenciesEnabled && (attributes.length || currencies.length)))) {\r\n\t\tpileSharingData = getItemPileSharingData(itemPile);\r\n\t}\r\n\r\n\tif ((pileData.shareItemsEnabled && filteredItems.length) || (pileData.shareCurrenciesEnabled && currencies.length)) {\r\n\r\n\t\tif (!pileSharingData.items) {\r\n\t\t\tpileSharingData.items = [];\r\n\t\t}\r\n\r\n\t\tfor (const item of filteredItems.concat(currencies)) {\r\n\r\n\t\t\tlet existingItem = Utilities.findSimilarItem(pileSharingData.items, item);\r\n\r\n\t\t\tif (!existingItem) {\r\n\t\t\t\tlet itemIndex = pileSharingData.items.push(Utilities.setSimilarityProperties({\r\n\t\t\t\t\tactors: [{ uuid: actorUuid, quantity: 0 }]\r\n\t\t\t\t}, item))\r\n\t\t\t\texistingItem = pileSharingData.items[itemIndex - 1];\r\n\t\t\t} else if (!existingItem.actors) {\r\n\t\t\t\texistingItem.actors = [];\r\n\t\t\t\texistingItem._id = item.id;\r\n\t\t\t}\r\n\r\n\t\t\tlet actorData = existingItem.actors.find(data => data.uuid === actorUuid);\r\n\r\n\t\t\tconst itemQuantity = Utilities.getItemQuantity(item);\r\n\t\t\tif (!actorData) {\r\n\t\t\t\tif (itemQuantity > 0) {\r\n\t\t\t\t\texistingItem.actors.push({ uuid: actorUuid, quantity: itemQuantity })\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tactorData.quantity += itemQuantity;\r\n\t\t\t\tif (actorData.quantity <= 0) {\r\n\t\t\t\t\texistingItem.actors.splice(existingItem.actors.indexOf(actorData), 1);\r\n\t\t\t\t}\r\n\t\t\t\tif (existingItem.actors.length === 0) {\r\n\t\t\t\t\tpileSharingData.items.splice(pileSharingData.items.indexOf(existingItem), 1)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tif (pileData.shareCurrenciesEnabled && attributes.length) {\r\n\r\n\t\tif (!pileSharingData.attributes) {\r\n\t\t\tpileSharingData.attributes = [];\r\n\t\t}\r\n\r\n\t\tfor (const attribute of attributes) {\r\n\r\n\t\t\tlet existingCurrency = pileSharingData.attributes.find(sharingCurrency => sharingCurrency.path === attribute.path);\r\n\r\n\t\t\tif (!existingCurrency) {\r\n\t\t\t\tlet itemIndex = pileSharingData.attributes.push({\r\n\t\t\t\t\tpath: attribute.path,\r\n\t\t\t\t\tactors: [{ uuid: actorUuid, quantity: 0 }]\r\n\t\t\t\t})\r\n\t\t\t\texistingCurrency = pileSharingData.attributes[itemIndex - 1];\r\n\t\t\t} else {\r\n\t\t\t\tif (!existingCurrency.actors) {\r\n\t\t\t\t\texistingCurrency.actors = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet actorData = existingCurrency.actors.find(data => data.uuid === actorUuid);\r\n\r\n\t\t\tif (!actorData) {\r\n\t\t\t\tif (attribute.quantity > 0) {\r\n\t\t\t\t\texistingCurrency.actors.push({ uuid: actorUuid, quantity: attribute.quantity })\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tactorData.quantity += attribute.quantity;\r\n\t\t\t\tif (actorData.quantity <= 0) {\r\n\t\t\t\t\texistingCurrency.actors.splice(existingCurrency.actors.indexOf(actorData), 1);\r\n\t\t\t\t}\r\n\t\t\t\tif (existingCurrency.actors.length === 0) {\r\n\t\t\t\t\tpileSharingData.attributes.splice(pileSharingData.attributes.indexOf(existingCurrency), 1)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\treturn pileSharingData;\r\n\r\n}\r\n\r\nexport function removeFromItemPileSharingData(itemPile, actorUuid, { items = [], attributes = [] } = {}) {\r\n\r\n\titems = items.map(item => {\r\n\t\tUtilities.setItemQuantity(item, Utilities.getItemQuantity(item) * -1)\r\n\t\treturn item;\r\n\t});\r\n\r\n\tattributes = attributes.map(attribute => {\r\n\t\tattribute.quantity = attribute.quantity * -1;\r\n\t\treturn attribute;\r\n\t});\r\n\r\n\treturn addToItemPileSharingData(itemPile, actorUuid, { items, attributes });\r\n\r\n}\r\n\r\nexport function getItemSharesLeftForActor(pile, item, recipient, {\r\n\tcurrentQuantity = null,\r\n\tfloor = null,\r\n\tplayers = null,\r\n\tshareData = null\r\n} = {}) {\r\n\r\n\tif (item instanceof String) {\r\n\t\titem = pile.items.get(item);\r\n\t}\r\n\tlet previouslyTaken = 0;\r\n\tlet recipientUuid = Utilities.getUuid(recipient);\r\n\tcurrentQuantity = currentQuantity ?? Math.abs(Utilities.getItemQuantity(item));\r\n\tlet totalShares = currentQuantity;\r\n\r\n\tshareData = shareData ?? getItemPileSharingData(pile);\r\n\tif (shareData?.items?.length) {\r\n\t\tconst foundItem = Utilities.findSimilarItem(shareData.items, item);\r\n\t\tif (foundItem) {\r\n\t\t\ttotalShares = foundItem.actors.reduce((acc, actor) => acc + actor.quantity, currentQuantity);\r\n\t\t\tconst quantityTakenBefore = foundItem.actors.find(actor => actor.uuid === recipientUuid);\r\n\t\t\tpreviouslyTaken = quantityTakenBefore ? quantityTakenBefore.quantity : 0;\r\n\t\t}\r\n\t}\r\n\r\n\tplayers = players ?? getPlayersForItemPile(pile).length;\r\n\tlet totalActorShare = totalShares / players;\r\n\tif (totalActorShare && !Number.isInteger(totalActorShare) && !floor) {\r\n\t\ttotalActorShare += 1;\r\n\t}\r\n\r\n\treturn Math.max(0, Math.min(currentQuantity, Math.floor(totalActorShare - previouslyTaken)));\r\n\r\n}\r\n\r\nexport function getAttributeSharesLeftForActor(pile, path, recipient, {\r\n\tgetAll = true,\r\n\tfloor = null,\r\n\tplayers = null,\r\n\tshareData = null\r\n} = {}) {\r\n\r\n\tlet previouslyTaken = 0;\r\n\tlet recipientUuid = Utilities.getUuid(recipient);\r\n\tlet currentQuantity = Number(foundry.utils.getProperty(pile, path) ?? 0);\r\n\r\n\tif (getAll && SYSTEMS.DATA.ITEM_TYPE_HANDLERS) {\r\n\t\tconst items = PileUtilities.getActorItems(pile);\r\n\t\tfor (const item of items) {\r\n\t\t\tif (!Utilities.getItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.HAS_CURRENCY, item.type)) continue;\r\n\t\t\tcurrentQuantity += Number(foundry.utils.getProperty(item, path) ?? 0);\r\n\t\t}\r\n\t}\r\n\tlet totalShares = currentQuantity;\r\n\r\n\tshareData = shareData ?? getItemPileSharingData(pile);\r\n\tif (shareData?.attributes?.length) {\r\n\t\tconst existingCurrency = shareData.attributes.find(storedCurrency => storedCurrency.path === path);\r\n\t\tif (existingCurrency) {\r\n\t\t\ttotalShares = existingCurrency.actors.reduce((acc, actor) => acc + actor.quantity, currentQuantity);\r\n\r\n\t\t\tconst quantityTakenBefore = existingCurrency?.actors?.find(actor => actor.uuid === recipientUuid);\r\n\t\t\tpreviouslyTaken = quantityTakenBefore ? quantityTakenBefore.quantity : 0;\r\n\t\t}\r\n\t}\r\n\r\n\tplayers = players ?? getPlayersForItemPile(pile).length;\r\n\tlet totalActorShare = totalShares / players;\r\n\tif (totalActorShare && !Number.isInteger(totalActorShare) && !floor) {\r\n\t\ttotalActorShare += 1;\r\n\t}\r\n\r\n\treturn Math.max(0, Math.min(currentQuantity, Math.floor(totalActorShare - previouslyTaken)));\r\n\r\n}\r\n","function set(obj, key, val) {\n\tif (typeof val.value === 'object') val.value = klona(val.value);\n\tif (!val.enumerable || val.get || val.set || !val.configurable || !val.writable || key === '__proto__') {\n\t\tObject.defineProperty(obj, key, val);\n\t} else obj[key] = val.value;\n}\n\nfunction klona(x) {\n\tif (typeof x !== 'object') return x;\n\n\tvar i=0, k, list, tmp, str=Object.prototype.toString.call(x);\n\n\tif (str === '[object Object]') {\n\t\ttmp = Object.create(x.__proto__ || null);\n\t} else if (str === '[object Array]') {\n\t\ttmp = Array(x.length);\n\t} else if (str === '[object Set]') {\n\t\ttmp = new Set;\n\t\tx.forEach(function (val) {\n\t\t\ttmp.add(klona(val));\n\t\t});\n\t} else if (str === '[object Map]') {\n\t\ttmp = new Map;\n\t\tx.forEach(function (val, key) {\n\t\t\ttmp.set(klona(key), klona(val));\n\t\t});\n\t} else if (str === '[object Date]') {\n\t\ttmp = new Date(+x);\n\t} else if (str === '[object RegExp]') {\n\t\ttmp = new RegExp(x.source, x.flags);\n\t} else if (str === '[object DataView]') {\n\t\ttmp = new x.constructor( klona(x.buffer) );\n\t} else if (str === '[object ArrayBuffer]') {\n\t\ttmp = x.slice(0);\n\t} else if (str.slice(-6) === 'Array]') {\n\t\t// ArrayBuffer.isView(x)\n\t\t// ~> `new` bcuz `Buffer.slice` => ref\n\t\ttmp = new x.constructor(x);\n\t}\n\n\tif (tmp) {\n\t\tfor (list=Object.getOwnPropertySymbols(x); i < list.length; i++) {\n\t\t\tset(tmp, list[i], Object.getOwnPropertyDescriptor(x, list[i]));\n\t\t}\n\n\t\tfor (i=0, list=Object.getOwnPropertyNames(x); i < list.length; i++) {\n\t\t\tif (Object.hasOwnProperty.call(tmp, k=list[i]) && tmp[k] === x[k]) continue;\n\t\t\tset(tmp, k, Object.getOwnPropertyDescriptor(x, k));\n\t\t}\n\t}\n\n\treturn tmp || x;\n}\n\n/**\n * Provides common object manipulation utilities including depth traversal, obtaining accessors, safely setting values /\n * equality tests, and validation.\n */\nconst s_TAG_OBJECT = '[object Object]';\nconst s_TAG_MAP = '[object Map]';\nconst s_TAG_SET = '[object Set]';\nconst s_TAG_STRING = '[object String]';\n/**\n * Freezes all entries traversed that are objects including entries in arrays.\n *\n * @param {object | []}   data - An object or array.\n *\n * @param {Set<string>}   [skipFreezeKeys] - A Set of strings indicating keys of objects to not freeze.\n *\n * @returns {object | []} The frozen object.\n */\nfunction deepFreeze(data, skipFreezeKeys) {\n    /* c8 ignore next 1 */\n    if (typeof data !== 'object') {\n        throw new TypeError(`'data' is not an 'object'.`);\n    }\n    /* c8 ignore next 4 */\n    if (skipFreezeKeys !== void 0 && !(skipFreezeKeys instanceof Set)) {\n        throw new TypeError(`'skipFreezeKeys' is not an 'Set'.`);\n    }\n    return _deepFreeze(data, skipFreezeKeys);\n}\n/**\n * Recursively deep merges all source objects into the target object in place. Like `Object.assign` if you provide `{}`\n * as the target a copy is produced. If the target and source property are object literals they are merged.\n * Deleting keys is supported by specifying a property starting with `-=`.\n *\n * @param {object}      target - Target object.\n *\n * @param {...object}   sourceObj - One or more source objects.\n *\n * @returns {object}    Target object.\n */\nfunction deepMerge(target = {}, ...sourceObj) {\n    if (Object.prototype.toString.call(target) !== s_TAG_OBJECT) {\n        throw new TypeError(`deepMerge error: 'target' is not an 'object'.`);\n    }\n    for (let cntr = 0; cntr < sourceObj.length; cntr++) {\n        if (Object.prototype.toString.call(sourceObj[cntr]) !== s_TAG_OBJECT) {\n            throw new TypeError(`deepMerge error: 'sourceObj[${cntr}]' is not an 'object'.`);\n        }\n    }\n    return _deepMerge(target, ...sourceObj);\n}\n/**\n * Performs a naive depth traversal of an object / array. The data structure _must not_ have circular references.\n * The result of the callback function is used to modify in place the given data.\n *\n * @param {object | []}   data - An object or array.\n *\n * @param {(any) => any}  func - A callback function to process leaf values in children arrays or object members.\n *\n * @param {boolean}       modify - If true then the result of the callback function is used to modify in place\n *                                  the given data.\n *\n * @returns {*} The data object.\n */\nfunction depthTraverse(data, func, modify = false) {\n    /* c8 ignore next 1 */\n    if (typeof data !== 'object') {\n        throw new TypeError(`'data' is not an 'object'.`);\n    }\n    /* c8 ignore next 1 */\n    if (typeof func !== 'function') {\n        throw new TypeError(`'func' is not a 'function'.`);\n    }\n    return _depthTraverse(data, func, modify);\n}\n/**\n * Returns a list of accessor keys by traversing the given object.\n *\n * @param {object}   data - An object to traverse for accessor keys.\n *\n * @returns {string[]} Accessor list.\n */\nfunction getAccessorList(data) {\n    if (typeof data !== 'object') {\n        throw new TypeError(`getAccessorList error: 'data' is not an 'object'.`);\n    }\n    return _getAccessorList(data);\n}\n/**\n * Provides a method to determine if the passed in Svelte component has a getter & setter accessor.\n *\n * @param {object}   object - An object.\n *\n * @param {string}   accessor - Accessor to test.\n *\n * @returns {boolean} Whether the component has the getter and setter for accessor.\n */\nfunction hasAccessor(object, accessor) {\n    if (typeof object !== 'object' || object === null || object === void 0) {\n        return false;\n    }\n    // Check for instance accessor.\n    const iDescriptor = Object.getOwnPropertyDescriptor(object, accessor);\n    if (iDescriptor !== void 0 && iDescriptor.get !== void 0 && iDescriptor.set !== void 0) {\n        return true;\n    }\n    // Walk parent prototype chain. Check for descriptor at each prototype level.\n    for (let o = Object.getPrototypeOf(object); o; o = Object.getPrototypeOf(o)) {\n        const descriptor = Object.getOwnPropertyDescriptor(o, accessor);\n        if (descriptor !== void 0 && descriptor.get !== void 0 && descriptor.set !== void 0) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Provides a method to determine if the passed in Svelte component has a getter accessor.\n *\n * @param {object}   object - An object.\n *\n * @param {string}   accessor - Accessor to test.\n *\n * @returns {boolean} Whether the component has the getter for accessor.\n */\nfunction hasGetter(object, accessor) {\n    if (typeof object !== 'object' || object === null || object === void 0) {\n        return false;\n    }\n    // Check for instance accessor.\n    const iDescriptor = Object.getOwnPropertyDescriptor(object, accessor);\n    if (iDescriptor !== void 0 && iDescriptor.get !== void 0) {\n        return true;\n    }\n    // Walk parent prototype chain. Check for descriptor at each prototype level.\n    for (let o = Object.getPrototypeOf(object); o; o = Object.getPrototypeOf(o)) {\n        const descriptor = Object.getOwnPropertyDescriptor(o, accessor);\n        if (descriptor !== void 0 && descriptor.get !== void 0) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Returns whether the target is or has the given prototype walking up the prototype chain.\n *\n * @param {unknown}  target - Any target to test.\n *\n * @param {new (...args: any[]) => any} Prototype - Prototype function / class constructor to find.\n *\n * @returns {boolean} Target matches prototype.\n */\nfunction hasPrototype(target, Prototype) {\n    /* c8 ignore next */\n    if (typeof target !== 'function') {\n        return false;\n    }\n    if (target === Prototype) {\n        return true;\n    }\n    // Walk parent prototype chain. Check for descriptor at each prototype level.\n    for (let proto = Object.getPrototypeOf(target); proto; proto = Object.getPrototypeOf(proto)) {\n        if (proto === Prototype) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Provides a method to determine if the passed in Svelte component has a setter accessor.\n *\n * @param {object}   object - An object.\n *\n * @param {string}   accessor - Accessor to test.\n *\n * @returns {boolean} Whether the component has the setter for accessor.\n */\nfunction hasSetter(object, accessor) {\n    if (typeof object !== 'object' || object === null || object === void 0) {\n        return false;\n    }\n    // Check for instance accessor.\n    const iDescriptor = Object.getOwnPropertyDescriptor(object, accessor);\n    if (iDescriptor !== void 0 && iDescriptor.set !== void 0) {\n        return true;\n    }\n    // Walk parent prototype chain. Check for descriptor at each prototype level.\n    for (let o = Object.getPrototypeOf(object); o; o = Object.getPrototypeOf(o)) {\n        const descriptor = Object.getOwnPropertyDescriptor(o, accessor);\n        if (descriptor !== void 0 && descriptor.set !== void 0) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Tests for whether an object is async iterable.\n *\n * @param {unknown} value - Any value.\n *\n * @returns {boolean} Whether value is async iterable.\n */\nfunction isAsyncIterable(value) {\n    if (typeof value !== 'object' || value === null || value === void 0) {\n        return false;\n    }\n    return Symbol.asyncIterator in value;\n}\n/**\n * Tests for whether an object is iterable.\n *\n * @param {unknown} value - Any value.\n *\n * @returns {boolean} Whether object is iterable.\n */\nfunction isIterable(value) {\n    if (value === null || value === void 0 || typeof value !== 'object') {\n        return false;\n    }\n    return Symbol.iterator in value;\n}\n/**\n * Tests for whether object is not null and a typeof object.\n *\n * @param {unknown} value - Any value.\n *\n * @returns {boolean} Is it an object.\n */\nfunction isObject(value) {\n    return value !== null && typeof value === 'object' && !Array.isArray(value);\n}\n/**\n * Tests for whether the given value is a plain object.\n *\n * An object is plain if it is created by either: `{}`, `new Object()` or `Object.create(null)`.\n *\n * @param {unknown} value - Any value\n *\n * @returns {boolean} Is it a plain object.\n */\nfunction isPlainObject(value) {\n    if (Object.prototype.toString.call(value) !== s_TAG_OBJECT) {\n        return false;\n    }\n    const prototype = Object.getPrototypeOf(value);\n    return prototype === null || prototype === Object.prototype;\n}\n/**\n * Safely returns keys on an object or an empty array if not an object.\n *\n * @param {object} object - An object.\n *\n * @returns {string[]}  Object keys or empty array.\n */\nfunction objectKeys(object) {\n    return isObject(object) ? Object.keys(object) : [];\n}\n/**\n * Safely returns an objects size. Note for String objects unicode is not taken into consideration.\n *\n * @param {any} object - Any value, but size returned for object / Map / Set / arrays / strings.\n *\n * @returns {number} Size of object.\n */\nfunction objectSize(object) {\n    if (object === void 0 || object === null || typeof object !== 'object') {\n        return 0;\n    }\n    const tag = Object.prototype.toString.call(object);\n    if (tag === s_TAG_MAP || tag === s_TAG_SET) {\n        return object.size;\n    }\n    if (tag === s_TAG_STRING) {\n        return object.length;\n    }\n    return Object.keys(object).length;\n}\n/**\n * Provides a way to safely access an objects data / entries given an accessor string which describes the\n * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n * to walk.\n *\n * @param {object}   data - An object to access entry data.\n *\n * @param {string}   accessor - A string describing the entries to access with keys separated by `.`.\n *\n * @param {any}      [defaultValue] - (Optional) A default value to return if an entry for accessor is not found.\n *\n * @returns {object} The data object.\n */\nfunction safeAccess(data, accessor, defaultValue) {\n    if (typeof data !== 'object') {\n        return defaultValue;\n    }\n    if (typeof accessor !== 'string') {\n        return defaultValue;\n    }\n    const access = accessor.split('.');\n    // Walk through the given object by the accessor indexes.\n    for (let cntr = 0; cntr < access.length; cntr++) {\n        // If the next level of object access is undefined or null then return the empty string.\n        if (typeof data[access[cntr]] === 'undefined' || data[access[cntr]] === null) {\n            return defaultValue;\n        }\n        data = data[access[cntr]];\n    }\n    return data;\n}\n/**\n * Provides a way to safely batch set an objects data / entries given an array of accessor strings which describe the\n * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n * to walk. If value is an object the accessor will be used to access a target value from `value` which is\n * subsequently set to `data` by the given operation. If `value` is not an object it will be used as the target\n * value to set across all accessors.\n *\n * @param {object}   data - An object to access entry data.\n *\n * @param {string[]} accessors - A string describing the entries to access.\n *\n * @param {any}      value - A new value to set if an entry for accessor is found.\n *\n * @param {SafeSetOperation}   [operation='set'] - Operation to perform including: 'add', 'div', 'mult', 'set',\n *        'set-undefined', 'sub'.\n *\n * @param {any}      [defaultAccessValue=0] - A new value to set if an entry for accessor is found.\n *\n * @param {boolean}  [createMissing=true] - If true missing accessor entries will be created as objects automatically.\n */\nfunction safeBatchSet(data, accessors, value, operation = 'set', defaultAccessValue = 0, createMissing = true) {\n    if (typeof data !== 'object') {\n        throw new TypeError(`safeBatchSet Error: 'data' is not an 'object'.`);\n    }\n    if (!Array.isArray(accessors)) {\n        throw new TypeError(`safeBatchSet Error: 'accessors' is not an 'array'.`);\n    }\n    if (typeof value === 'object') {\n        accessors.forEach((accessor) => {\n            const targetValue = safeAccess(value, accessor, defaultAccessValue);\n            safeSet(data, accessor, targetValue, operation, createMissing);\n        });\n    }\n    else {\n        accessors.forEach((accessor) => {\n            safeSet(data, accessor, value, operation, createMissing);\n        });\n    }\n}\n/**\n * Compares a source object and values of entries against a target object. If the entries in the source object match\n * the target object then `true` is returned otherwise `false`. If either object is undefined or null then false\n * is returned.\n *\n * @param {object}   source - Source object.\n *\n * @param {object}   target - Target object.\n *\n * @returns {boolean} True if equal.\n */\nfunction safeEqual(source, target) {\n    if (typeof source === 'undefined' || source === null || typeof target === 'undefined' || target === null) {\n        return false;\n    }\n    const sourceAccessors = getAccessorList(source);\n    for (let cntr = 0; cntr < sourceAccessors.length; cntr++) {\n        const accessor = sourceAccessors[cntr];\n        const sourceObjectValue = safeAccess(source, accessor);\n        const targetObjectValue = safeAccess(target, accessor);\n        if (sourceObjectValue !== targetObjectValue) {\n            return false;\n        }\n    }\n    return true;\n}\n/**\n * Provides a way to safely set an objects data / entries given an accessor string which describes the\n * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n * to walk.\n *\n * @param {object}   data - An object to access entry data.\n *\n * @param {string}   accessor - A string describing the entries to access.\n *\n * @param {any}      value - A new value to set if an entry for accessor is found.\n *\n * @param {SafeSetOperation}   [operation='set'] - Operation to perform including: 'add', 'div', 'mult', 'set',\n *        'set-undefined', 'sub'.\n *\n * @param {boolean}  [createMissing=true] - If true missing accessor entries will be created as objects\n *        automatically.\n *\n * @returns {boolean} True if successful.\n */\nfunction safeSet(data, accessor, value, operation = 'set', createMissing = true) {\n    if (typeof data !== 'object') {\n        throw new TypeError(`safeSet Error: 'data' is not an 'object'.`);\n    }\n    if (typeof accessor !== 'string') {\n        throw new TypeError(`safeSet Error: 'accessor' is not a 'string'.`);\n    }\n    const access = accessor.split('.');\n    // Walk through the given object by the accessor indexes.\n    for (let cntr = 0; cntr < access.length; cntr++) {\n        // If data is an array perform validation that the accessor is a positive integer otherwise quit.\n        if (Array.isArray(data)) {\n            const number = (+access[cntr]);\n            if (!Number.isInteger(number) || number < 0) {\n                return false;\n            }\n        }\n        if (cntr === access.length - 1) {\n            switch (operation) {\n                case 'add':\n                    data[access[cntr]] += value;\n                    break;\n                case 'div':\n                    data[access[cntr]] /= value;\n                    break;\n                case 'mult':\n                    data[access[cntr]] *= value;\n                    break;\n                case 'set':\n                    data[access[cntr]] = value;\n                    break;\n                case 'set-undefined':\n                    if (typeof data[access[cntr]] === 'undefined') {\n                        data[access[cntr]] = value;\n                    }\n                    break;\n                case 'sub':\n                    data[access[cntr]] -= value;\n                    break;\n            }\n        }\n        else {\n            // If createMissing is true and the next level of object access is undefined then create a new object entry.\n            if (createMissing && typeof data[access[cntr]] === 'undefined') {\n                data[access[cntr]] = {};\n            }\n            // Abort if the next level is null or not an object and containing a value.\n            if (data[access[cntr]] === null || typeof data[access[cntr]] !== 'object') {\n                return false;\n            }\n            data = data[access[cntr]];\n        }\n    }\n    return true;\n}\n/**\n * Performs bulk setting of values to the given data object.\n *\n * @param {object}            data - The data object to set data.\n *\n * @param {Record<string, any>}  accessorValues - Object of accessor keys to values to set.\n *\n * @param {SafeSetOperation}  [operation='set'] - Operation to perform including: 'add', 'div', 'mult', 'set', 'sub';\n *        default (`set`).\n *\n * @param {boolean}           [createMissing=true] - If true missing accessor entries will be created as objects\n *        automatically.\n */\nfunction safeSetAll(data, accessorValues, operation = 'set', createMissing = true) {\n    if (typeof data !== 'object') {\n        throw new TypeError(`'data' is not an 'object'.`);\n    }\n    if (typeof accessorValues !== 'object') {\n        throw new TypeError(`'accessorValues' is not an 'object'.`);\n    }\n    for (const accessor of Object.keys(accessorValues)) {\n        if (!Object.prototype.hasOwnProperty.call(accessorValues, accessor)) {\n            continue;\n        }\n        safeSet(data, accessor, accessorValues[accessor], operation, createMissing);\n    }\n}\n/**\n * Performs bulk validation of data given an object, `validationData`, which describes all entries to test.\n *\n * @param {object}                           data - The data object to test.\n *\n * @param {Record<string, ValidationEntry>}  validationData - Key is the accessor / value is a validation entry.\n *\n * @param {string}                           [dataName='data'] - Optional name of data.\n *\n * @returns {boolean} True if validation passes otherwise an exception is thrown.\n */\nfunction validate(data, validationData = {}, dataName = 'data') {\n    if (typeof data !== 'object') {\n        throw new TypeError(`'${dataName}' is not an 'object'.`);\n    }\n    if (typeof validationData !== 'object') {\n        throw new TypeError(`'validationData' is not an 'object'.`);\n    }\n    let result;\n    for (const key of Object.keys(validationData)) {\n        if (!Object.prototype.hasOwnProperty.call(validationData, key)) {\n            continue;\n        }\n        const entry = validationData[key];\n        switch (entry.test) {\n            case 'array':\n                result = validateArray(data, key, entry, dataName);\n                break;\n            case 'entry':\n                result = validateEntry(data, key, entry, dataName);\n                break;\n            case 'entry|array':\n                result = validateEntryOrArray(data, key, entry, dataName);\n                break;\n        }\n    }\n    return result;\n}\n/**\n * Validates all array entries against potential type and expected tests.\n *\n * @param {object}            data - The data object to test.\n *\n * @param {string}            accessor - A string describing the entries to access.\n *\n * @param {ValidationEntry}   entry - Validation entry object\n *\n * @param {string}            [dataName='data'] - Optional name of data.\n *\n * @returns {boolean} True if validation passes otherwise an exception is thrown.\n */\nfunction validateArray(data, accessor, entry, dataName = 'data') {\n    const valEntry = Object.assign({ required: true, error: true }, entry);\n    const dataArray = safeAccess(data, accessor);\n    // A non-required entry is missing so return without validation.\n    if (!valEntry?.required && typeof dataArray === 'undefined') {\n        return true;\n    }\n    if (!Array.isArray(dataArray)) {\n        if (valEntry.error) {\n            throw _validateError(TypeError, `'${dataName}.${accessor}' is not an 'array'.`);\n        }\n        else {\n            return false;\n        }\n    }\n    if (typeof valEntry.type === 'string') {\n        for (let cntr = 0; cntr < dataArray.length; cntr++) {\n            if (!(typeof dataArray[cntr] === valEntry.type)) {\n                if (valEntry.error) {\n                    const dataEntryString = typeof dataArray[cntr] === 'object' ? JSON.stringify(dataArray[cntr]) :\n                        dataArray[cntr];\n                    throw _validateError(TypeError, `'${dataName}.${accessor}[${cntr}]': '${dataEntryString}' is not a '${valEntry.type}'.`);\n                }\n                else {\n                    return false;\n                }\n            }\n        }\n    }\n    // If expected is a function then test all array entries against the test function. If expected is a Set then\n    // test all array entries for inclusion in the set. Otherwise, if expected is a string then test that all array\n    // entries as a `typeof` test against expected.\n    if (Array.isArray(valEntry.expected)) {\n        for (let cntr = 0; cntr < dataArray.length; cntr++) {\n            if (!valEntry.expected.includes(dataArray[cntr])) {\n                if (valEntry.error) {\n                    const dataEntryString = typeof dataArray[cntr] === 'object' ? JSON.stringify(dataArray[cntr]) :\n                        dataArray[cntr];\n                    throw _validateError(Error, `'${dataName}.${accessor}[${cntr}]': '${dataEntryString}' is not an expected value: ${JSON.stringify(valEntry.expected)}.`);\n                }\n                else {\n                    return false;\n                }\n            }\n        }\n    }\n    else if (valEntry.expected instanceof Set) {\n        for (let cntr = 0; cntr < dataArray.length; cntr++) {\n            if (!valEntry.expected.has(dataArray[cntr])) {\n                if (valEntry.error) {\n                    const dataEntryString = typeof dataArray[cntr] === 'object' ? JSON.stringify(dataArray[cntr]) :\n                        dataArray[cntr];\n                    throw _validateError(Error, `'${dataName}.${accessor}[${cntr}]': '${dataEntryString}' is not an expected value: ${JSON.stringify(valEntry.expected)}.`);\n                }\n                else {\n                    return false;\n                }\n            }\n        }\n    }\n    else if (typeof valEntry.expected === 'function') {\n        for (let cntr = 0; cntr < dataArray.length; cntr++) {\n            try {\n                const result = valEntry.expected(dataArray[cntr]);\n                if (typeof result === 'undefined' || !result) {\n                    throw new Error(valEntry.message);\n                }\n            }\n            catch (err) {\n                if (valEntry.error) {\n                    const dataEntryString = typeof dataArray[cntr] === 'object' ? JSON.stringify(dataArray[cntr]) :\n                        dataArray[cntr];\n                    throw _validateError(Error, `'${dataName}.${accessor}[${cntr}]': '${dataEntryString}' failed validation: ${err.message}.`);\n                }\n                else {\n                    return false;\n                }\n            }\n        }\n    }\n    return true;\n}\n/**\n * Validates data entry with a typeof check and potentially tests against the values in any given expected set.\n *\n * @param {object}            data - The object data to validate.\n *\n * @param {string}            accessor - A string describing the entries to access.\n *\n * @param {ValidationEntry}   entry - Validation entry.\n *\n * @param {string}            [dataName='data'] - Optional name of data.\n *\n * @returns {boolean} True if validation passes otherwise an exception is thrown.\n */\nfunction validateEntry(data, accessor, entry, dataName = 'data') {\n    const valEntry = Object.assign({ required: true, error: true }, entry);\n    const dataEntry = safeAccess(data, accessor);\n    // A non-required entry is missing so return without validation.\n    if (!valEntry.required && typeof dataEntry === 'undefined') {\n        return true;\n    }\n    if (valEntry.type && typeof dataEntry !== valEntry.type) {\n        if (valEntry.error) {\n            throw _validateError(TypeError, `'${dataName}.${accessor}' is not a '${valEntry.type}'.`);\n        }\n        else {\n            return false;\n        }\n    }\n    if ((valEntry.expected instanceof Set && !valEntry.expected.has(dataEntry)) ||\n        (Array.isArray(valEntry.expected) && !valEntry.expected.includes(dataEntry))) {\n        if (valEntry.error) {\n            const dataEntryString = typeof dataEntry === 'object' ? JSON.stringify(dataEntry) : dataEntry;\n            throw _validateError(Error, `'${dataName}.${accessor}': '${dataEntryString}' is not an expected value: ${JSON.stringify(valEntry.expected)}.`);\n        }\n        else {\n            return false;\n        }\n    }\n    else if (typeof valEntry.expected === 'function') {\n        try {\n            const result = valEntry.expected(dataEntry);\n            if (typeof result === 'undefined' || !result) {\n                throw new Error(valEntry.message);\n            }\n        }\n        catch (err) {\n            if (valEntry.error) {\n                const dataEntryString = typeof dataEntry === 'object' ? JSON.stringify(dataEntry) : dataEntry;\n                throw _validateError(Error, `'${dataName}.${accessor}': '${dataEntryString}' failed to validate: ${err.message}.`);\n            }\n            else {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n/**\n * Dispatches validation of data entry to string or array validation depending on data entry type.\n *\n * @param {object}            data - The data object to test.\n *\n * @param {string}            accessor - A string describing the entries to access.\n *\n * @param {ValidationEntry}   [entry] - A validation entry.\n *\n * @param {string}            [dataName='data'] - Optional name of data.\n *\n * @returns {boolean} True if validation passes otherwise an exception is thrown.\n */\nfunction validateEntryOrArray(data, accessor, entry, dataName = 'data') {\n    const dataEntry = safeAccess(data, accessor);\n    let result;\n    if (Array.isArray(dataEntry)) {\n        result = validateArray(data, accessor, entry, dataName);\n    }\n    else {\n        result = validateEntry(data, accessor, entry, dataName);\n    }\n    return result;\n}\n// Module private ---------------------------------------------------------------------------------------------------\n/**\n * Private implementation of depth traversal.\n *\n * @param {any}         data - An object or array or any leaf.\n *\n * @param {Set<string>} [skipFreezeKeys] - An array of strings indicating keys of objects to not freeze.\n *\n * @returns {*} The frozen object.\n * @ignore\n * @private\n */\nfunction _deepFreeze(data, skipFreezeKeys) {\n    if (Array.isArray(data)) {\n        for (let cntr = 0; cntr < data.length; cntr++) {\n            _deepFreeze(data[cntr], skipFreezeKeys);\n        }\n    }\n    else if (isObject(data)) {\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key) && !skipFreezeKeys?.has?.(key)) {\n                _deepFreeze(data[key], skipFreezeKeys);\n            }\n        }\n    }\n    return Object.freeze(data);\n}\n/**\n * Internal implementation for `deepMerge`.\n *\n * @param {object}      target - Target object.\n *\n * @param {...object}   sourceObj - One or more source objects.\n *\n * @returns {object}    Target object.\n */\nfunction _deepMerge(target = {}, ...sourceObj) {\n    // Iterate and merge all source objects into target.\n    for (let cntr = 0; cntr < sourceObj.length; cntr++) {\n        const obj = sourceObj[cntr];\n        for (const prop in obj) {\n            if (Object.prototype.hasOwnProperty.call(obj, prop)) {\n                // Handle the special property starting with '-=' to delete keys.\n                if (prop.startsWith('-=')) {\n                    delete target[prop.slice(2)];\n                    continue;\n                }\n                // If target already has prop and both target[prop] and obj[prop] are object literals then merge them\n                // otherwise assign obj[prop] to target[prop].\n                target[prop] = Object.prototype.hasOwnProperty.call(target, prop) && target[prop]?.constructor === Object &&\n                    obj[prop]?.constructor === Object ? _deepMerge({}, target[prop], obj[prop]) : obj[prop];\n            }\n        }\n    }\n    return target;\n}\n/**\n * Private implementation of depth traversal.\n *\n * @param {any}      data - An object, array, or any leaf value\n *\n * @param {Function} func - A callback function to process leaf values in children arrays or object members.\n *\n * @param {boolean}  modify - If true then the result of the callback function is used to modify in place the\n *        given data.\n *\n * @returns {*} The data object.\n * @ignore\n * @private\n */\nfunction _depthTraverse(data, func, modify = false) {\n    if (modify) {\n        if (Array.isArray(data)) {\n            for (let cntr = 0; cntr < data.length; cntr++) {\n                data[cntr] = _depthTraverse(data[cntr], func, modify);\n            }\n        }\n        else if (isObject(data)) {\n            for (const key in data) {\n                if (Object.prototype.hasOwnProperty.call(data, key)) {\n                    data[key] = _depthTraverse(data[key], func, modify);\n                }\n            }\n        }\n        else {\n            data = func(data);\n        }\n    }\n    else {\n        if (Array.isArray(data)) {\n            for (let cntr = 0; cntr < data.length; cntr++) {\n                _depthTraverse(data[cntr], func, modify);\n            }\n        }\n        else if (typeof data === 'object') {\n            for (const key in data) {\n                if (Object.prototype.hasOwnProperty.call(data, key)) {\n                    _depthTraverse(data[key], func, modify);\n                }\n            }\n        }\n        else {\n            func(data);\n        }\n    }\n    return data;\n}\n/**\n * Private implementation of `getAccessorList`.\n *\n * @param {object}   data - An object to traverse.\n *\n * @returns {string[]} Accessor list.\n * @ignore\n * @private\n */\nfunction _getAccessorList(data) {\n    const accessors = [];\n    for (const key in data) {\n        if (Object.prototype.hasOwnProperty.call(data, key)) {\n            if (typeof data[key] === 'object') {\n                const childKeys = _getAccessorList(data[key]);\n                childKeys.forEach((childKey) => {\n                    accessors.push(Array.isArray(childKey) ? `${key}.${childKey.join('.')}` : `${key}.${childKey}`);\n                });\n            }\n            else {\n                accessors.push(key);\n            }\n        }\n    }\n    return accessors;\n}\n/**\n * Creates a new error of type `clazz` adding the field `_objectValidateError` set to true.\n *\n * @param {Error}    clazz - Error class to instantiate.\n *\n * @param {string}   message - An error message.\n *\n * @returns {*} Error of the clazz.\n * @ignore\n * @private\n */\nfunction _validateError(clazz, message = void 0) {\n    const error = new clazz(message);\n    error._objectValidateError = true;\n    return error;\n}\n\nexport { deepFreeze, deepMerge, depthTraverse, getAccessorList, hasAccessor, hasGetter, hasPrototype, hasSetter, isAsyncIterable, isIterable, isObject, isPlainObject, klona, objectKeys, objectSize, safeAccess, safeBatchSet, safeEqual, safeSet, safeSetAll, validate, validateArray, validateEntry, validateEntryOrArray };\n//# sourceMappingURL=index.js.map\n","import { isObject, isIterable } from '@typhonjs-fvtt/runtime/util/object';\n\nfunction isSpace(character) {\n    return character == \" \" || character == \"\\n\" || character == \"\\r\" || character == \"\\t\";\n}\nfunction isQuote(character) {\n    return character == '\"' || character == \"'\";\n}\nconst TAG_START = \"<\";\nconst TAG_END = \">\";\nconst ENCODED_TAG_START = \"&lt;\";\nconst ENCODED_TAG_END = \"&gt;\";\nclass InPlaintextState {\n    constructor(options) {\n        this.options = options;\n    }\n    consume(character, transition) {\n        if (character == TAG_START) {\n            transition(new InTagNameState(this.options));\n            return \"\";\n        }\n        else if (character == TAG_END && this.options.encodePlaintextTagDelimiters) {\n            return ENCODED_TAG_END;\n        }\n        return character;\n    }\n}\nclass InTagNameState {\n    constructor(options) {\n        this.options = options;\n        this.nameBuffer = \"\";\n        this.isClosingTag = false;\n    }\n    consume(character, transition) {\n        if (this.nameBuffer.length == 0) {\n            if (isSpace(character)) {\n                transition(new InPlaintextState(this.options));\n                return ((this.options.encodePlaintextTagDelimiters ? ENCODED_TAG_START : \"<\") +\n                    character);\n            }\n            if (character == \"/\") {\n                this.isClosingTag = true;\n                return \"\";\n            }\n        }\n        if (isSpace(character)) {\n            if (this.isNameBufferAnAllowedTag()) {\n                transition(new InTagState(0 /* TagMode.Allowed */, this.options));\n                return TAG_START + (this.isClosingTag ? \"/\" : \"\") + this.nameBuffer + character;\n            }\n            else {\n                transition(new InTagState(1 /* TagMode.Disallowed */, this.options));\n                return this.options.tagReplacementText;\n            }\n        }\n        if (character == TAG_START) {\n            this.nameBuffer += ENCODED_TAG_START;\n            return \"\";\n        }\n        if (character == TAG_END) {\n            transition(new InPlaintextState(this.options));\n            if (this.isNameBufferAnAllowedTag()) {\n                return TAG_START + (this.isClosingTag ? \"/\" : \"\") + this.nameBuffer + character;\n            }\n            else {\n                return this.options.tagReplacementText;\n            }\n        }\n        if (character == \"-\" && this.nameBuffer == \"!-\") {\n            transition(new InCommentState(this.options));\n            return \"\";\n        }\n        this.nameBuffer += character;\n        return \"\";\n    }\n    isNameBufferAnAllowedTag() {\n        const tagName = this.nameBuffer.toLowerCase();\n        if (this.options.allowedTags) {\n            return this.options.allowedTags.has(tagName);\n        }\n        else if (this.options.disallowedTags) {\n            return !this.options.disallowedTags.has(tagName);\n        }\n        else {\n            return false;\n        }\n    }\n}\nclass InTagState {\n    constructor(mode, options) {\n        this.mode = mode;\n        this.options = options;\n    }\n    consume(character, transition) {\n        if (character == TAG_END) {\n            transition(new InPlaintextState(this.options));\n        }\n        else if (isQuote(character)) {\n            transition(new InQuotedStringInTagState(this.mode, character, this.options));\n        }\n        if (this.mode == 1 /* TagMode.Disallowed */) {\n            return \"\";\n        }\n        if (character == TAG_START) {\n            return ENCODED_TAG_START;\n        }\n        else {\n            return character;\n        }\n    }\n}\nclass InQuotedStringInTagState {\n    constructor(mode, quoteCharacter, options) {\n        this.mode = mode;\n        this.quoteCharacter = quoteCharacter;\n        this.options = options;\n    }\n    consume(character, transition) {\n        if (character == this.quoteCharacter) {\n            transition(new InTagState(this.mode, this.options));\n        }\n        if (this.mode == 1 /* TagMode.Disallowed */) {\n            return \"\";\n        }\n        if (character == TAG_START) {\n            return ENCODED_TAG_START;\n        }\n        else if (character == TAG_END) {\n            return ENCODED_TAG_END;\n        }\n        else {\n            return character;\n        }\n    }\n}\nclass InCommentState {\n    constructor(options) {\n        this.options = options;\n        this.consecutiveHyphens = 0;\n    }\n    consume(character, transition) {\n        if (character == \">\" && this.consecutiveHyphens >= 2) {\n            transition(new InPlaintextState(this.options));\n        }\n        else if (character == \"-\") {\n            this.consecutiveHyphens++;\n        }\n        else {\n            this.consecutiveHyphens = 0;\n        }\n        return \"\";\n    }\n}\n\nconst DefaultStateMachineOptions = {\n    tagReplacementText: \"\",\n    encodePlaintextTagDelimiters: true,\n};\nclass StateMachine {\n    constructor(partialOptions = {}) {\n        this.state = new InPlaintextState(Object.assign(Object.assign({}, DefaultStateMachineOptions), partialOptions));\n        this.transitionFunction = ((next) => {\n            this.state = next;\n        }).bind(this);\n    }\n    consume(text) {\n        let outputBuffer = \"\";\n        for (const character of text) {\n            outputBuffer += this.state.consume(character, this.transitionFunction);\n        }\n        return outputBuffer;\n    }\n}\nfunction striptags(text, options = {}) {\n    return new StateMachine(options).consume(text);\n}\n\n/**\n * Provides several helpful utility methods for accessibility and keyboard navigation.\n */\nclass A11yHelper\n{\n   /**\n    * Apply focus to the HTMLElement targets in a given A11yFocusSource data object. An iterable list `options.focusEl`\n    * can contain HTMLElements or selector strings. If multiple focus targets are provided in a list then the first\n    * valid target found will be focused. If focus target is a string then a lookup via `document.querySelector` is\n    * performed. In this case you should provide a unique selector for the desired focus target.\n    *\n    * Note: The body of this method is postponed to the next clock tick to allow any changes in the DOM to occur that\n    * might alter focus targets before applying.\n    *\n    * @param {A11yFocusSource|{ focusSource: A11yFocusSource }}   options - The focus options instance to apply.\n    */\n   static applyFocusSource(options)\n   {\n      if (!isObject(options)) { return; }\n\n      // Handle the case of receiving an object with embedded `focusSource`.\n      const focusOpts = isObject(options?.focusSource) ? options.focusSource : options;\n\n      setTimeout(() =>\n      {\n         const debug = typeof focusOpts.debug === 'boolean' ? focusOpts.debug : false;\n\n         if (isIterable(focusOpts.focusEl))\n         {\n            if (debug)\n            {\n               console.debug(`A11yHelper.applyFocusSource debug - Attempting to apply focus target: `, focusOpts.focusEl);\n            }\n\n            for (const target of focusOpts.focusEl)\n            {\n               if (target instanceof HTMLElement && target.isConnected)\n               {\n                  target.focus();\n                  if (debug)\n                  {\n                     console.debug(`A11yHelper.applyFocusSource debug - Applied focus to target: `, target);\n                  }\n                  break;\n               }\n               else if (typeof target === 'string')\n               {\n                  const element = document.querySelector(target);\n                  if (element instanceof HTMLElement && element.isConnected)\n                  {\n                     element.focus();\n                     if (debug)\n                     {\n                        console.debug(`A11yHelper.applyFocusSource debug - Applied focus to target: `, element);\n                     }\n                     break;\n                  }\n                  else if (debug)\n                  {\n                     console.debug(`A11yHelper.applyFocusSource debug - Could not query selector: `, target);\n                  }\n               }\n            }\n         }\n         else if (debug)\n         {\n            console.debug(`A11yHelper.applyFocusSource debug - No focus targets defined.`);\n         }\n      }, 0);\n   }\n\n   /**\n    * Returns first focusable element within a specified element.\n    *\n    * @param {HTMLElement|Document} [element=document] - Optional element to start query.\n    *\n    * @param {object} [options] - Optional parameters.\n    *\n    * @param {Iterable<string>} [options.ignoreClasses] - Iterable list of classes to ignore elements.\n    *\n    * @param {Set<HTMLElement>} [options.ignoreElements] - Set of elements to ignore.\n    *\n    * @returns {HTMLElement} First focusable child element\n    */\n   static getFirstFocusableElement(element = document, options)\n   {\n      const focusableElements = this.getFocusableElements(element, options);\n\n      return focusableElements.length > 0 ? focusableElements[0] : void 0;\n   }\n\n   /**\n    * Returns all focusable elements within a specified element.\n    *\n    * @param {HTMLElement|Document} [element=document] Optional element to start query.\n    *\n    * @param {object}            [options] - Optional parameters.\n    *\n    * @param {boolean}           [options.anchorHref=true] - When true anchors must have an HREF.\n    *\n    * @param {Iterable<string>}  [options.ignoreClasses] - Iterable list of classes to ignore elements.\n    *\n    * @param {Set<HTMLElement>}  [options.ignoreElements] - Set of elements to ignore.\n    *\n    * @param {string}            [options.selectors] - Custom list of focusable selectors for `querySelectorAll`.\n    *\n    * @returns {Array<HTMLElement>} Child keyboard focusable\n    */\n   static getFocusableElements(element = document, { anchorHref = true, ignoreClasses, ignoreElements, selectors } = {})\n   {\n      if (!(element instanceof HTMLElement) && !(element instanceof Document))\n      {\n         throw new TypeError(`'element' is not a HTMLElement or Document instance.`);\n      }\n\n      if (typeof anchorHref !== 'boolean')\n      {\n         throw new TypeError(`'anchorHref' is not a boolean.`);\n      }\n\n      if (ignoreClasses !== void 0 && !isIterable(ignoreClasses))\n      {\n         throw new TypeError(`'ignoreClasses' is not an iterable list.`);\n      }\n\n      if (ignoreElements !== void 0 && !(ignoreElements instanceof Set))\n      {\n         throw new TypeError(`'ignoreElements' is not a Set.`);\n      }\n\n      if (selectors !== void 0 && typeof selectors !== 'string')\n      {\n         throw new TypeError(`'selectors' is not a string.`);\n      }\n\n      const selectorQuery = selectors ?? this.#getFocusableSelectors(anchorHref);\n\n      const allElements = [...element.querySelectorAll(selectorQuery)];\n\n      if (ignoreElements && ignoreClasses)\n      {\n         return allElements.filter((el) =>\n         {\n            let hasIgnoreClass = false;\n            for (const ignoreClass of ignoreClasses)\n            {\n               if (el.classList.contains(ignoreClass))\n               {\n                  hasIgnoreClass = true;\n                  break;\n               }\n            }\n\n            return !hasIgnoreClass && !ignoreElements.has(el) && el.style.display !== 'none' &&\n             el.style.visibility !== 'hidden' && !el.hasAttribute('disabled') && !el.hasAttribute('inert') &&\n              el.getAttribute('aria-hidden') !== 'true';\n         });\n      }\n      else if (ignoreClasses)\n      {\n         return allElements.filter((el) =>\n         {\n            let hasIgnoreClass = false;\n            for (const ignoreClass of ignoreClasses)\n            {\n               if (el.classList.contains(ignoreClass))\n               {\n                  hasIgnoreClass = true;\n                  break;\n               }\n            }\n\n            return !hasIgnoreClass && el.style.display !== 'none' && el.style.visibility !== 'hidden' &&\n             !el.hasAttribute('disabled') && !el.hasAttribute('inert') && el.getAttribute('aria-hidden') !== 'true';\n         });\n      }\n      else if (ignoreElements)\n      {\n         return allElements.filter((el) =>\n         {\n            return !ignoreElements.has(el) && el.style.display !== 'none' && el.style.visibility !== 'hidden' &&\n             !el.hasAttribute('disabled') && !el.hasAttribute('inert') && el.getAttribute('aria-hidden') !== 'true';\n         });\n      }\n      else\n      {\n         return allElements.filter((el) =>\n         {\n            return el.style.display !== 'none' && el.style.visibility !== 'hidden' && !el.hasAttribute('disabled') &&\n             !el.hasAttribute('inert') && el.getAttribute('aria-hidden') !== 'true';\n         });\n      }\n   }\n\n   /**\n    * Returns the default focusable selectors query.\n    *\n    * @param {boolean}  [anchorHref=true] - When true anchors must have an HREF.\n    *\n    * @returns {string} Focusable selectors for `querySelectorAll`.\n    */\n   static #getFocusableSelectors(anchorHref = true)\n   {\n      return `button, [contenteditable=\"\"], [contenteditable=\"true\"], details summary:not([tabindex=\"-1\"]), embed, a${\n       anchorHref ? '[href]' : ''}, iframe, object, input:not([type=hidden]), select, textarea, ` +\n        `[tabindex]:not([tabindex=\"-1\"])`;\n   }\n\n   /**\n    * Gets a A11yFocusSource object from the given DOM event allowing for optional X / Y screen space overrides.\n    * Browsers (Firefox / Chrome) forwards a mouse event for the context menu keyboard button. Provides detection of\n    * when the context menu event is from the keyboard. Firefox as of (1/23) does not provide the correct screen space\n    * coordinates, so for keyboard context menu presses coordinates are generated from the centroid point of the\n    * element.\n    *\n    * A default fallback element or selector string may be provided to provide the focus target. If the event comes from\n    * the keyboard however the source focused element is inserted as the target with the fallback value appended to the\n    * list of focus targets. When A11yFocusSource is applied by {@link A11yHelper.applyFocusSource} the target focus\n    * list is iterated through until a connected target is found and focus applied.\n    *\n    * @param {object} options - Options\n    *\n    * @param {KeyboardEvent|MouseEvent}   [options.event] - The source DOM event.\n    *\n    * @param {boolean} [options.debug] - When true {@link A11yHelper.applyFocusSource} logs focus target data.\n    *\n    * @param {HTMLElement|string} [options.focusEl] - A specific HTMLElement or selector string as the focus target.\n    *\n    * @param {number}   [options.x] - Used when an event isn't provided; integer of event source in screen space.\n    *\n    * @param {number}   [options.y] - Used when an event isn't provided; integer of event source in screen space.\n    *\n    * @returns {A11yFocusSource} A A11yFocusSource object.\n    *\n    * @see https://bugzilla.mozilla.org/show_bug.cgi?id=1426671\n    * @see https://bugzilla.mozilla.org/show_bug.cgi?id=314314\n    *\n    * TODO: Evaluate / test against touch input devices.\n    */\n   static getFocusSource({ event, x, y, focusEl, debug = false })\n   {\n      if (focusEl !== void 0 && !(focusEl instanceof HTMLElement) && typeof focusEl !== 'string')\n      {\n         throw new TypeError(\n          `A11yHelper.getFocusSource error: 'focusEl' is not a HTMLElement or string.`);\n      }\n\n      if (debug !== void 0 && typeof debug !== 'boolean')\n      {\n         throw new TypeError(`A11yHelper.getFocusSource error: 'debug' is not a boolean.`);\n      }\n\n      // Handle the case when no event is provided and x, y, or focusEl is explicitly defined.\n      if (event === void 0)\n      {\n         if (typeof x !== 'number')\n         {\n            throw new TypeError(`A11yHelper.getFocusSource error: 'event' not defined and 'x' is not a number.`);\n         }\n\n         if (typeof y !== 'number')\n         {\n            throw new TypeError(`A11yHelper.getFocusSource error: 'event' not defined and 'y' is not a number.`);\n         }\n\n         return {\n            debug,\n            focusEl: focusEl !== void 0 ? [focusEl] : void 0,\n            x,\n            y,\n         };\n      }\n\n      if (!(event instanceof KeyboardEvent) && !(event instanceof MouseEvent))\n      {\n         throw new TypeError(`A11yHelper.getFocusSource error: 'event' is not a KeyboardEvent or MouseEvent.`);\n      }\n\n      if (x !== void 0 && !Number.isInteger(x))\n      {\n         throw new TypeError(`A11yHelper.getFocusSource error: 'x' is not a number.`);\n      }\n\n      if (y !== void 0 && !Number.isInteger(y))\n      {\n         throw new TypeError(`A11yHelper.getFocusSource error: 'y' is not a number.`);\n      }\n\n      /** @type {HTMLElement} */\n      const targetEl = event.target;\n\n      if (!(targetEl instanceof HTMLElement))\n      {\n         throw new TypeError(`A11yHelper.getFocusSource error: 'event.target' is not an HTMLElement.`);\n      }\n\n      const result = { debug };\n\n      if (event instanceof MouseEvent)\n      {\n         // Firefox currently (1/23) does not correctly determine the location of a keyboard originated\n         // context menu location, so calculate position from middle of the event target.\n         // Firefox fires a mouse event for the context menu key.\n         if (event?.button !== 2 && event.type === 'contextmenu')\n         {\n            const rect = targetEl.getBoundingClientRect();\n            result.x = x ?? rect.left + (rect.width / 2);\n            result.y = y ?? rect.top + (rect.height / 2);\n            result.focusEl = focusEl !== void 0 ? [targetEl, focusEl] : [targetEl];\n            result.source = 'keyboard';\n         }\n         else\n         {\n            result.x = x ?? event.pageX;\n            result.y = y ?? event.pageY;\n            result.focusEl = focusEl !== void 0 ? [focusEl] : void 0;\n         }\n      }\n      else\n      {\n         const rect = targetEl.getBoundingClientRect();\n         result.x = x ?? rect.left + (rect.width / 2);\n         result.y = y ?? rect.top + (rect.height / 2);\n         result.focusEl = focusEl !== void 0 ? [targetEl, focusEl] : [targetEl];\n         result.source = 'keyboard';\n      }\n\n      return result;\n   }\n\n   /**\n    * Returns first focusable element within a specified element.\n    *\n    * @param {HTMLElement|Document} [element=document] - Optional element to start query.\n    *\n    * @param {object} [options] - Optional parameters.\n    *\n    * @param {Iterable<string>} [options.ignoreClasses] - Iterable list of classes to ignore elements.\n    *\n    * @param {Set<HTMLElement>} [options.ignoreElements] - Set of elements to ignore.\n    *\n    * @returns {HTMLElement} First focusable child element\n    */\n   static getLastFocusableElement(element = document, options)\n   {\n      const focusableElements = this.getFocusableElements(element, options);\n\n      return focusableElements.length > 0 ? focusableElements[focusableElements.length - 1] : void 0;\n   }\n\n   /**\n    * Tests if the given element is focusable.\n    *\n    * @param {HTMLElement} [el] - Element to test.\n    *\n    * @param {object} [options] - Optional parameters.\n    *\n    * @param {boolean} [options.anchorHref=true] - When true anchors must have an HREF.\n    *\n    * @param {Iterable<string>} [options.ignoreClasses] - Iterable list of classes to ignore elements.\n    *\n    * @returns {boolean} Element is focusable.\n    */\n   static isFocusable(el, { anchorHref = true, ignoreClasses } = {})\n   {\n      if (el === void 0 || el === null || !(el instanceof HTMLElement) || el?.hidden || !el?.isConnected)\n      {\n         return false;\n      }\n\n      if (typeof anchorHref !== 'boolean')\n      {\n         throw new TypeError(`'anchorHref' is not a boolean.`);\n      }\n\n      if (ignoreClasses !== void 0 && !isIterable(ignoreClasses))\n      {\n         throw new TypeError(`'ignoreClasses' is not an iterable list.`);\n      }\n\n      const contenteditableAttr = el.getAttribute('contenteditable');\n      const contenteditableFocusable = typeof contenteditableAttr === 'string' &&\n       (contenteditableAttr === '' || contenteditableAttr === 'true');\n\n      const tabindexAttr = el.getAttribute('tabindex');\n      const tabindexFocusable = typeof tabindexAttr === 'string' && tabindexAttr !== '-1';\n\n      const isAnchor = el instanceof HTMLAnchorElement;\n\n      if (contenteditableFocusable || tabindexFocusable || isAnchor || el instanceof HTMLButtonElement ||\n       el instanceof HTMLDetailsElement || el instanceof HTMLEmbedElement || el instanceof HTMLIFrameElement ||\n        el instanceof HTMLInputElement || el instanceof HTMLObjectElement || el instanceof HTMLSelectElement ||\n         el instanceof HTMLTextAreaElement)\n      {\n         if (isAnchor && anchorHref && typeof el.getAttribute('href') !== 'string')\n         {\n            return false;\n         }\n\n         return el.style.display !== 'none' && el.style.visibility !== 'hidden' && !el.hasAttribute('disabled') &&\n          !el.hasAttribute('inert') && el.getAttribute('aria-hidden') !== 'true';\n      }\n\n      return false;\n   }\n\n   /**\n    * Convenience method to check if the given data is a valid focus source.\n    *\n    * @param {HTMLElement|string}   data - Either an HTMLElement or selector string.\n    *\n    * @returns {boolean} Is valid focus source.\n    */\n   static isFocusSource(data)\n   {\n      return data instanceof HTMLElement || typeof data === 'string';\n   }\n}\n\n/**\n * @typedef {object} A11yFocusSource Provides essential data to return focus to an HTMLElement after a series of UI\n * actions like working with context menus and modal dialogs.\n *\n * @property {boolean} [debug] When true logs to console the actions taken in {@link A11yHelper.applyFocusSource}.\n *\n * @property {Iterable<HTMLElement|string>} [focusEl] List of targets to attempt to focus.\n *\n * @property {string} [source] The source of the event: 'keyboard' for instance.\n *\n * @property {number} [x] Potential X coordinate of initial event.\n *\n * @property {number} [y] Potential Y coordinate of initial event.\n */\n\n/**\n * Provides utility methods for checking browser capabilities.\n *\n * @see https://kilianvalkhof.com/2021/web/detecting-media-query-support-in-css-and-javascript/\n * TODO: perhaps add support for various standard media query checks for level 4 & 5.\n */\nclass BrowserSupports\n{\n   /**\n    * Check for container query support.\n    *\n    * @returns {boolean} True if container queries supported.\n    */\n   static get containerQueries()\n   {\n      return 'container' in document.documentElement.style;\n   }\n}\n\n/**\n * Provides access to the Clipboard API for reading / writing text strings. This requires a secure context.\n *\n * Note: `writeText` will attempt to use the older `execCommand` if available when `navigator.clipboard` is not\n * available.\n */\nclass ClipboardAccess\n{\n   /**\n    * Uses `navigator.clipboard` if available to read text from the clipboard.\n    *\n    * Note: Always returns `undefined` when `navigator.clipboard` is not available or the clipboard contains the\n    * empty string.\n    *\n    * @returns {Promise<string|undefined>} The current clipboard text or undefined.\n    */\n   static async readText()\n   {\n      let result;\n\n      if (globalThis?.navigator?.clipboard)\n      {\n         try\n         {\n            result = await globalThis.navigator.clipboard.readText();\n         }\n         catch (err) { /**/ }\n      }\n\n      return result === '' ? void 0 : result;\n   }\n\n   /**\n    * Uses `navigator.clipboard` if available then falls back to `document.execCommand('copy')` if available to copy\n    * the given text to the clipboard.\n    *\n    * @param {string}   text - Text to copy to the browser clipboard.\n    *\n    * @returns {Promise<boolean>} Copy successful.\n    */\n   static async writeText(text)\n   {\n      if (typeof text !== 'string')\n      {\n         throw new TypeError(`ClipboardAccess.writeText error: 'text' is not a string.`);\n      }\n\n      let success = false;\n\n      if (globalThis?.navigator?.clipboard)\n      {\n         try\n         {\n            await globalThis.navigator.clipboard.writeText(text);\n            success = true;\n         }\n         catch (err) { /**/ }\n      }\n      else if (globalThis?.document?.execCommand instanceof Function)\n      {\n         const textArea = globalThis.document.createElement('textarea');\n\n         // Place in the top-left corner of screen regardless of scroll position.\n         textArea.style.position = 'fixed';\n         textArea.style.top = '0';\n         textArea.style.left = '0';\n\n         // Ensure it has a small width and height. Setting to 1px / 1em\n         // doesn't work as this gives a negative w/h on some browsers.\n         textArea.style.width = '2em';\n         textArea.style.height = '2em';\n\n         // We don't need padding, reducing the size if it does flash render.\n         textArea.style.padding = '0';\n\n         // Clean up any borders.\n         textArea.style.border = 'none';\n         textArea.style.outline = 'none';\n         textArea.style.boxShadow = 'none';\n\n         // Avoid flash of the white box if rendered for any reason.\n         textArea.style.background = 'transparent';\n\n         textArea.value = text;\n\n         globalThis.document.body.appendChild(textArea);\n         textArea.focus();\n         textArea.select();\n\n         try\n         {\n            success = document.execCommand('copy');\n         }\n         catch (err) { /**/ }\n\n         document.body.removeChild(textArea);\n      }\n\n      return success;\n   }\n}\n\n/**\n * Recursive function that finds the closest parent stacking context.\n * See also https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context\n *\n * Original author: Kerry Liu / https://github.com/gwwar\n *\n * @see https://github.com/gwwar/z-context/blob/master/content-script.js\n * @see https://github.com/gwwar/z-context/blob/master/LICENSE\n *\n * @param {Element} node -\n *\n * @returns {StackingContext} The closest parent stacking context\n */\nfunction getStackingContext(node)\n{\n   // the root element (HTML).\n   if (!node || node.nodeName === 'HTML')\n   {\n      return { node: document.documentElement, reason: 'root' };\n   }\n\n   // handle shadow root elements.\n   if (node.nodeName === '#document-fragment')\n   {\n      return getStackingContext(node.host);\n   }\n\n   const computedStyle = globalThis.getComputedStyle(node);\n\n   // position: fixed or sticky.\n   if (computedStyle.position === 'fixed' || computedStyle.position === 'sticky')\n   {\n      return { node, reason: `position: ${computedStyle.position}` };\n   }\n\n   // positioned (absolutely or relatively) with a z-index value other than \"auto\".\n   if (computedStyle.zIndex !== 'auto' && computedStyle.position !== 'static')\n   {\n      return { node, reason: `position: ${computedStyle.position}; z-index: ${computedStyle.zIndex}` };\n   }\n\n   // elements with an opacity value less than 1.\n   if (computedStyle.opacity !== '1')\n   {\n      return { node, reason: `opacity: ${computedStyle.opacity}` };\n   }\n\n   // elements with a transform value other than \"none\".\n   if (computedStyle.transform !== 'none')\n   {\n      return { node, reason: `transform: ${computedStyle.transform}` };\n   }\n\n   // elements with a mix-blend-mode value other than \"normal\".\n   if (computedStyle.mixBlendMode !== 'normal')\n   {\n      return { node, reason: `mixBlendMode: ${computedStyle.mixBlendMode}` };\n   }\n\n   // elements with a filter value other than \"none\".\n   if (computedStyle.filter !== 'none')\n   {\n      return { node, reason: `filter: ${computedStyle.filter}` };\n   }\n\n   // elements with a perspective value other than \"none\".\n   if (computedStyle.perspective !== 'none')\n   {\n      return { node, reason: `perspective: ${computedStyle.perspective}` };\n   }\n\n   // elements with a clip-path value other than \"none\".\n   if (computedStyle.clipPath !== 'none')\n   {\n      return { node, reason: `clip-path: ${computedStyle.clipPath} ` };\n   }\n\n   // elements with a mask value other than \"none\".\n   const mask = computedStyle.mask || computedStyle.webkitMask;\n   if (mask !== 'none' && mask !== undefined)\n   {\n      return { node, reason: `mask:  ${mask}` };\n   }\n\n   // elements with a mask-image value other than \"none\".\n   const maskImage = computedStyle.maskImage || computedStyle.webkitMaskImage;\n   if (maskImage !== 'none' && maskImage !== undefined)\n   {\n      return { node, reason: `mask-image: ${maskImage}` };\n   }\n\n   // elements with a mask-border value other than \"none\".\n   const maskBorder = computedStyle.maskBorder || computedStyle.webkitMaskBorder;\n   if (maskBorder !== 'none' && maskBorder !== undefined)\n   {\n      return { node, reason: `mask-border: ${maskBorder}` };\n   }\n\n   // elements with isolation set to \"isolate\".\n   if (computedStyle.isolation === 'isolate')\n   {\n      return { node, reason: `isolation: ${computedStyle.isolation}` };\n   }\n\n   // transform or opacity in will-change even if you don't specify values for these attributes directly.\n   if (computedStyle.willChange === 'transform' || computedStyle.willChange === 'opacity')\n   {\n      return { node, reason: `willChange: ${computedStyle.willChange}` };\n   }\n\n   // elements with -webkit-overflow-scrolling set to \"touch\".\n   if (computedStyle.webkitOverflowScrolling === 'touch')\n   {\n      return { node, reason: '-webkit-overflow-scrolling: touch' };\n   }\n\n   // an item with a z-index value other than \"auto\".\n   if (computedStyle.zIndex !== 'auto')\n   {\n      const parentStyle = globalThis.getComputedStyle(node.parentNode);\n      // with a flex|inline-flex parent.\n      if (parentStyle.display === 'flex' || parentStyle.display === 'inline-flex')\n      {\n         return { node, reason: `flex-item; z-index: ${computedStyle.zIndex}` };\n         // with a grid parent.\n      }\n      else if (parentStyle.grid !== 'none / none / none / row / auto / auto')\n      {\n         return { node, reason: `child of grid container; z-index: ${computedStyle.zIndex}` };\n      }\n   }\n\n   // contain with a value of layout, or paint, or a composite value that includes either of them\n   const contain = computedStyle.contain;\n   if (['layout', 'paint', 'strict', 'content'].indexOf(contain) > -1 ||\n    contain.indexOf('paint') > -1 ||\n    contain.indexOf('layout') > -1\n   )\n   {\n      return { node, reason: `contain: ${contain}` };\n   }\n\n   return getStackingContext(node.parentNode);\n}\n\n/**\n * @typedef {object} StackingContext\n *\n * @property {Element} node - A DOM Element.\n *\n * @property {string}  reason - Reason for why a stacking context was created.\n */\n\n/**\n * Provides resources for parsing style strings.\n */\nclass StyleParse\n{\n   static #regexPixels = /(\\d+)\\s*px/;\n\n   /**\n    * Parses a pixel string / computed styles. Ex. `100px` returns `100`.\n    *\n    * @param {string}   value - Value to parse.\n    *\n    * @returns {number|undefined} The integer component of a pixel string.\n    */\n   static pixels(value)\n   {\n      if (typeof value !== 'string') { return void 0; }\n\n      const isPixels = this.#regexPixels.test(value);\n      const number = parseInt(value);\n\n      return isPixels && Number.isFinite(number) ? number : void 0;\n   }\n}\n\n/**\n * Provides a managed dynamic style sheet / element useful in configuring global CSS variables. When creating an\n * instance of TJSStyleManager you must provide a \"document key\" / string for the style element added. The style element\n * can be accessed via `document[docKey]`.\n *\n * Instances of TJSStyleManager can also be versioned by supplying a positive integer greater than or equal to `1` via\n * the 'version' option. This version number is assigned to the associated style element. When a TJSStyleManager\n * instance is created and there is an existing instance with a version that is lower than the current instance all CSS\n * rules are removed letting the higher version to take precedence. This isn't a perfect system and requires thoughtful\n * construction of CSS variables exposed, but allows multiple independently compiled TRL packages to load the latest\n * CSS variables. It is recommended to always set `overwrite` option of {@link TJSStyleManager.setProperty} and\n * {@link TJSStyleManager.setProperties} to `false` when loading initial values.\n */\nclass TJSStyleManager\n{\n   /** @type {CSSStyleRule} */\n   #cssRule;\n\n   /** @type {string} */\n   #docKey;\n\n   /** @type {string} */\n   #selector;\n\n   /** @type {HTMLStyleElement} */\n   #styleElement;\n\n   /** @type {number} */\n   #version;\n\n   /**\n    *\n    * @param {object}   opts - Options.\n    *\n    * @param {string}   opts.docKey - Required key providing a link to a specific style sheet element.\n    *\n    * @param {string}   [opts.selector=:root] - Selector element.\n    *\n    * @param {Document} [opts.document] - Target document to load styles into.\n    *\n    * @param {number}   [opts.version] - An integer representing the version / level of styles being managed.\n    */\n   constructor({ docKey, selector = ':root', document = globalThis.document, version } = {})\n   {\n      if (typeof docKey !== 'string') { throw new TypeError(`StyleManager error: 'docKey' is not a string.`); }\n\n      // TODO: Verify 'document' type from Popout FVTT module. For some reason the popout document trips this\n      //  unintentionally.\n      // if (!(document instanceof Document))\n      // {\n      //    throw new TypeError(`TJSStyleManager error: 'document' is not an instance of Document.`);\n      // }\n\n      if (typeof selector !== 'string') { throw new TypeError(`StyleManager error: 'selector' is not a string.`); }\n\n      if (version !== void 0 && !Number.isSafeInteger(version) && version < 1)\n      {\n         throw new TypeError(`StyleManager error: 'version' is defined and is not a positive integer >= 1.`);\n      }\n\n      this.#selector = selector;\n      this.#docKey = docKey;\n      this.#version = version;\n\n      if (document[this.#docKey] === void 0)\n      {\n         this.#styleElement = document.createElement('style');\n\n         document.head.append(this.#styleElement);\n\n         // Set initial style manager version if any supplied.\n         this.#styleElement._STYLE_MANAGER_VERSION = version;\n\n         this.#styleElement.sheet.insertRule(`${selector} {}`, 0);\n\n         this.#cssRule = this.#styleElement.sheet.cssRules[0];\n\n         document[docKey] = this.#styleElement;\n      }\n      else\n      {\n         this.#styleElement = document[docKey];\n         this.#cssRule = this.#styleElement.sheet.cssRules[0];\n\n         if (version)\n         {\n            const existingVersion = this.#styleElement._STYLE_MANAGER_VERSION ?? 0;\n\n            // Remove all existing CSS rules / text if version is greater than existing version.\n            if (version > existingVersion)\n            {\n               this.#cssRule.style.cssText = '';\n            }\n         }\n      }\n   }\n\n   /**\n    * @returns {string} Provides an accessor to get the `cssText` for the style sheet.\n    */\n   get cssText()\n   {\n      return this.#cssRule.style.cssText;\n   }\n\n   /**\n    * @returns {number} Returns the version of this instance.\n    */\n   get version()\n   {\n      return this.#version;\n   }\n\n   /**\n    * Provides a copy constructor to duplicate an existing TJSStyleManager instance into a new document.\n    *\n    * Note: This is used to support the `PopOut` module.\n    *\n    * @param {Document} [document] Target browser document to clone into.\n    *\n    * @returns {TJSStyleManager} New style manager instance.\n    */\n   clone(document = globalThis.document)\n   {\n      const newStyleManager = new TJSStyleManager({\n         selector: this.#selector,\n         docKey: this.#docKey,\n         document,\n         version: this.#version\n      });\n\n      newStyleManager.#cssRule.style.cssText = this.#cssRule.style.cssText;\n\n      return newStyleManager;\n   }\n\n   get()\n   {\n      const cssText = this.#cssRule.style.cssText;\n\n      const result = {};\n\n      if (cssText !== '')\n      {\n         for (const entry of cssText.split(';'))\n         {\n            if (entry !== '')\n            {\n               const values = entry.split(':');\n               result[values[0].trim()] = values[1];\n            }\n         }\n      }\n\n      return result;\n   }\n\n   /**\n    * Gets a particular CSS variable.\n    *\n    * @param {string}   key - CSS variable property key.\n    *\n    * @returns {string} Returns CSS variable value.\n    */\n   getProperty(key)\n   {\n      if (typeof key !== 'string') { throw new TypeError(`StyleManager error: 'key' is not a string.`); }\n\n      return this.#cssRule.style.getPropertyValue(key);\n   }\n\n   /**\n    * Set rules by property / value; useful for CSS variables.\n    *\n    * @param {{ [key: string]: string }}  rules - An object with property / value string pairs to load.\n    *\n    * @param {boolean}                 [overwrite=true] - When true overwrites any existing values.\n    */\n   setProperties(rules, overwrite = true)\n   {\n      if (!isObject(rules)) { throw new TypeError(`StyleManager error: 'rules' is not an object.`); }\n\n      if (typeof overwrite !== 'boolean') { throw new TypeError(`StyleManager error: 'overwrite' is not a boolean.`); }\n\n      if (overwrite)\n      {\n         for (const [key, value] of Object.entries(rules))\n         {\n            this.#cssRule.style.setProperty(key, value);\n         }\n      }\n      else\n      {\n         // Only set property keys for entries that don't have an existing rule set.\n         for (const [key, value] of Object.entries(rules))\n         {\n            if (this.#cssRule.style.getPropertyValue(key) === '')\n            {\n               this.#cssRule.style.setProperty(key, value);\n            }\n         }\n      }\n   }\n\n   /**\n    * Sets a particular property.\n    *\n    * @param {string}   key - CSS variable property key.\n    *\n    * @param {string}   value - CSS variable value.\n    *\n    * @param {boolean}  [overwrite=true] - Overwrite any existing value.\n    */\n   setProperty(key, value, overwrite = true)\n   {\n      if (typeof key !== 'string') { throw new TypeError(`StyleManager error: 'key' is not a string.`); }\n\n      if (typeof value !== 'string') { throw new TypeError(`StyleManager error: 'value' is not a string.`); }\n\n      if (typeof overwrite !== 'boolean') { throw new TypeError(`StyleManager error: 'overwrite' is not a boolean.`); }\n\n      if (overwrite)\n      {\n         this.#cssRule.style.setProperty(key, value);\n      }\n      else\n      {\n         if (this.#cssRule.style.getPropertyValue(key) === '')\n         {\n            this.#cssRule.style.setProperty(key, value);\n         }\n      }\n   }\n\n   /**\n    * Removes the property keys specified. If `keys` is an iterable list then all property keys in the list are removed.\n    *\n    * @param {Iterable<string>} keys - The property keys to remove.\n    */\n   removeProperties(keys)\n   {\n      if (!isIterable(keys)) { throw new TypeError(`StyleManager error: 'keys' is not an iterable list.`); }\n\n      for (const key of keys)\n      {\n         if (typeof key === 'string') { this.#cssRule.style.removeProperty(key); }\n      }\n   }\n\n   /**\n    * Removes a particular CSS variable.\n    *\n    * @param {string}   key - CSS variable property key.\n    *\n    * @returns {string} CSS variable value when removed.\n    */\n   removeProperty(key)\n   {\n      if (typeof key !== 'string') { throw new TypeError(`StyleManager error: 'key' is not a string.`); }\n\n      return this.#cssRule.style.removeProperty(key);\n   }\n}\n\nexport { A11yHelper, BrowserSupports, ClipboardAccess, StyleParse, TJSStyleManager, getStackingContext, striptags };\n//# sourceMappingURL=index.js.map\n","import { TJSStyleManager } from '@typhonjs-fvtt/runtime/util/browser';\n\nexport const cssVariables = new TJSStyleManager({ docKey: '#__trl-root-styles', version: 1 });\n","class Hashing\n{\n   static #regexUuidv = /^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i;\n\n   /**\n    * Provides a solid string hashing algorithm.\n    *\n    * Sourced from: https://stackoverflow.com/a/52171480\n    *\n    * @param {string}   str - String to hash.\n    *\n    * @param {number}   seed - A seed value altering the hash.\n    *\n    * @returns {number} Hash code.\n    */\n   static hashCode(str, seed = 0)\n   {\n      if (typeof str !== 'string') { return 0; }\n\n      let h1 = 0xdeadbeef ^ seed, h2 = 0x41c6ce57 ^ seed;\n\n      for (let ch, i = 0; i < str.length; i++)\n      {\n         ch = str.charCodeAt(i);\n         h1 = Math.imul(h1 ^ ch, 2654435761);\n         h2 = Math.imul(h2 ^ ch, 1597334677);\n      }\n\n      h1 = Math.imul(h1 ^ (h1 >>> 16), 2246822507) ^ Math.imul(h2 ^ (h2 >>> 13), 3266489909);\n      h2 = Math.imul(h2 ^ (h2 >>> 16), 2246822507) ^ Math.imul(h1 ^ (h1 >>> 13), 3266489909);\n\n      return 4294967296 * (2097151 & h2) + (h1 >>> 0);\n   }\n\n   /**\n    * Validates that the given string is formatted as a UUIDv4 string.\n    *\n    * @param {string}   uuid - UUID string to test.\n    *\n    * @returns {boolean} Is UUIDv4 string.\n    */\n   static isUuidv4(uuid)\n   {\n      return this.#regexUuidv.test(uuid);\n   }\n\n   /**\n    * Generates a UUID v4 compliant ID. Please use a complete UUID generation package for guaranteed compliance.\n    *\n    * This code is an evolution of the following Gist.\n    * https://gist.github.com/jed/982883\n    *\n    * There is a public domain / free copy license attached to it that is not a standard OSS license...\n    * https://gist.github.com/jed/982883#file-license-txt\n    *\n    * @returns {string} UUIDv4\n    */\n   static uuidv4()\n   {\n      return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (c) =>\n       (c ^ (globalThis.crypto ?? globalThis.msCrypto).getRandomValues(\n        new Uint8Array(1))[0] & 15 >> c / 4).toString(16));\n   }\n}\n\n/**\n * Provides utility functions for strings.\n */\nclass Strings\n{\n   /**\n    * Escape a given input string prefacing special characters with backslashes for use in a regular expression.\n    *\n    * @param {string}   string - An un-escaped input string.\n    *\n    * @returns {string} The escaped string suitable for use in a regular expression.\n    */\n   static escape(string)\n   {\n      return string.replace(/[-/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n   }\n\n   /**\n    * Normalizes a string.\n    *\n    * @param {string}   string - A string to normalize for comparisons.\n    *\n    * @returns {string} Cleaned string.\n    *\n    * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize\n    */\n   static normalize(string)\n   {\n      return string.trim().normalize('NFD').replace(/[\\x00-\\x1F]/gm, ''); // eslint-disable-line no-control-regex\n   }\n}\n\n/**\n * Provides timing related higher-order functions.\n */\nclass Timing\n{\n   /**\n    * Wraps a callback in a debounced timeout.\n    *\n    * Delay execution of the callback function until the function has not been called for the given delay in milliseconds.\n    *\n    * @param {Function} callback - A function to execute once the debounced threshold has been passed.\n    *\n    * @param {number}   delay - An amount of time in milliseconds to delay.\n    *\n    * @returns {Function} A wrapped function that can be called to debounce execution.\n    */\n   static debounce(callback, delay)\n   {\n      let timeoutId;\n\n      return function(...args)\n      {\n         globalThis.clearTimeout(timeoutId);\n         timeoutId = globalThis.setTimeout(() => { callback.apply(this, args); }, delay);\n      };\n   }\n\n   /**\n    * @param {object}   opts - Optional parameters.\n    *\n    * @param {Function} opts.single - Single click callback.\n    *\n    * @param {Function} opts.double - Double click callback.\n    *\n    * @param {number}   [opts.delay=400] - Double click delay.\n    *\n    * @returns {(event: Event) => void} The gated double-click handler.\n    */\n   static doubleClick({ single, double, delay = 400 })\n   {\n      let clicks = 0;\n      let timeoutId;\n\n      return (event) =>\n      {\n         clicks++;\n\n         if (clicks === 1)\n         {\n            timeoutId = globalThis.setTimeout(() =>\n            {\n               if (typeof single === 'function') { single(event); }\n               clicks = 0;\n            }, delay);\n         }\n         else\n         {\n            globalThis.clearTimeout(timeoutId);\n            if (typeof double === 'function') { double(event); }\n            clicks = 0;\n         }\n      };\n   }\n}\n\nexport { Hashing, Strings, Timing };\n//# sourceMappingURL=index.js.map\n","/**\n * Provides a basic test for a given variable to test if it has the shape of a readable store by having a `subscribe`\n * function.\n *\n * Note: functions are also objects, so test that the variable might be a function w/ a `subscribe` function.\n *\n * @param {*}  store - variable to test that might be a store.\n *\n * @returns {boolean} Whether the variable tested has the shape of a store.\n */\nfunction isReadableStore(store)\n{\n   if (store === null || store === void 0) { return false; }\n\n   switch (typeof store)\n   {\n      case 'function':\n      case 'object':\n         return typeof store.subscribe === 'function';\n   }\n\n   return false;\n}\n\n/**\n * Provides a basic test for a given variable to test if it has the shape of a writable store by having a `subscribe`\n * function and an `update` function.\n *\n * Note: functions are also objects, so test that the variable might be a function w/ a `subscribe` function.\n *\n * @param {*}  store - variable to test that might be a store.\n *\n * @returns {boolean} Whether the variable tested has the shape of a store.\n */\nfunction isUpdatableStore(store)\n{\n   if (store === null || store === void 0) { return false; }\n\n   switch (typeof store)\n   {\n      case 'function':\n      case 'object':\n         return typeof store.subscribe === 'function' && typeof store.update === 'function';\n   }\n\n   return false;\n}\n\n/**\n * Provides a basic test for a given variable to test if it has the shape of a writable store by having a `subscribe`\n * `set`, and `update` functions.\n *\n * Note: functions are also objects, so test that the variable might be a function w/ `subscribe` & `set` functions.\n *\n * @param {*}  store - variable to test that might be a store.\n *\n * @returns {boolean} Whether the variable tested has the shape of a store.\n */\nfunction isWritableStore(store)\n{\n   if (store === null || store === void 0) { return false; }\n\n   switch (typeof store)\n   {\n      case 'function':\n      case 'object':\n         return typeof store.subscribe === 'function' && typeof store.set === 'function';\n   }\n\n   return false;\n}\n\n/**\n * Wraps a writable stores set method invoking a callback after the store is set. This allows hard coupled parent /\n * child relationships between stores to update directly without having to subscribe to the child store. This is a\n * particular powerful pattern when the `setCallback` is a debounced function that syncs a parent store and / or\n * serializes data.\n *\n * Note: Do consider carefully if this is an optimum solution; this is a quick implementation helper, but a better\n * solution is properly managing store relationships through subscription.\n *\n * @template T\n *\n * @param {import('svelte/store').Writable<T>} store - A store to wrap.\n *\n * @param {(store?: import('svelte/store').Writable<T>, value?: T) => void} setCallback - A callback to invoke after\n *        store set.\n *\n * @returns {import('svelte/store').Writable<T>} Wrapped store.\n */\nfunction storeCallback(store, setCallback)\n{\n   if (!isWritableStore(store)) { throw new TypeError(`'store' is not a writable store.`); }\n   if (typeof setCallback !== 'function') { throw new TypeError(`'setCallback' is not a function.`); }\n\n   /** @type {import('svelte/store').Writable<T>} */\n   return {\n      set: (value) =>\n      {\n         store.set(value);\n         setCallback(store, value);\n      },\n\n      subscribe: store.subscribe,\n\n      update: typeof store.update === 'function' ? store.update : void 0\n   };\n}\n\n/**\n * Subscribes to the given store with the update function provided and ignores the first automatic\n * update. All future updates are dispatched to the update function.\n *\n * @param {import('svelte/store').Readable | import('svelte/store').Writable} store -\n *  Store to subscribe to...\n *\n * @param {import('svelte/store').Updater} update - function to receive future updates.\n *\n * @returns {import('svelte/store').Unsubscriber} Store unsubscribe function.\n */\nfunction subscribeIgnoreFirst(store, update)\n{\n   let firedFirst = false;\n\n   return store.subscribe((value) =>\n   {\n      if (!firedFirst)\n      {\n         firedFirst = true;\n      }\n      else\n      {\n         update(value);\n      }\n   });\n}\n\n/**\n * Subscribes to the given store with two update functions provided. The first function is invoked on the initial\n * subscription. All future updates are dispatched to the update function.\n *\n * @param {import('svelte/store').Readable | import('svelte/store').Writable} store -\n *  Store to subscribe to...\n *\n * @param {import('svelte/store').Updater} first - Function to receive first update.\n *\n * @param {import('svelte/store').Updater} update - Function to receive future updates.\n *\n * @returns {import('svelte/store').Unsubscriber} Store unsubscribe function.\n */\nfunction subscribeFirstRest(store, first, update)\n{\n   let firedFirst = false;\n\n   return store.subscribe((value) =>\n   {\n      if (!firedFirst)\n      {\n         firedFirst = true;\n         first(value);\n      }\n      else\n      {\n         update(value);\n      }\n   });\n}\n\nexport { isReadableStore, isUpdatableStore, isWritableStore, storeCallback, subscribeFirstRest, subscribeIgnoreFirst };\n//# sourceMappingURL=index.js.map\n","import { Timing } from '@typhonjs-fvtt/runtime/util';\nimport { isUpdatableStore, isWritableStore } from '@typhonjs-fvtt/runtime/util/store';\nimport { StyleParse } from '@typhonjs-fvtt/runtime/util/browser';\nimport { isObject } from '@typhonjs-fvtt/runtime/util/object';\n\n/**\n * Provides an action to always blur the element when any pointer up event occurs on the element.\n *\n * @param {HTMLElement}   node - The node to handle always blur on pointer up.\n *\n * @returns {import('svelte/action').ActionReturn} Lifecycle functions.\n */\nfunction alwaysBlur(node)\n{\n   /**\n    * Blurs node if active element.\n    */\n   function blurNode()\n   {\n      setTimeout(() => { if (document.activeElement === node) { node.blur(); } }, 0);\n   }\n\n   node.addEventListener('pointerup', blurNode);\n\n   return {\n      destroy: () => node.removeEventListener('pointerup', blurNode)\n   };\n}\n\n/**\n * Provides an action to monitor the given HTMLElement node with `ResizeObserver` posting width / height changes\n * to the target in various ways depending on the shape of the target. The target can be one of the following and the\n * precedence order is listed from top to bottom:\n *\n * - has a `resizeObserved` function as attribute; offset then content width / height are passed as parameters.\n * - has a `setContentBounds` function as attribute; content width / height are passed as parameters.\n * - has a `setDimension` function as attribute; offset width / height are passed as parameters.\n * - target is an object; offset and content width / height attributes directly set on target.\n * - target is a function; the function invoked with offset then content width / height parameters.\n * - has a writable store `resizeObserved` as an attribute; updated with offset & content width / height.\n * - has an object 'stores' that has a writable store `resizeObserved` as an attribute; updated with offset &\n *   content width / height.\n *\n * Note: Svelte currently uses an archaic IFrame based workaround to monitor offset / client width & height changes.\n * A more up to date way to do this is with ResizeObserver. To track when Svelte receives ResizeObserver support\n * monitor this issue: {@link https://github.com/sveltejs/svelte/issues/4233}\n *\n * Can-I-Use: {@link https://caniuse.com/resizeobserver}\n *\n * @param {HTMLElement}          node - The node associated with the action.\n *\n * @param {ResizeObserverTarget} target - An object or function to update with observed width & height changes.\n *\n * @returns {import('svelte/action').ActionReturn<ResizeObserverTarget>} The action lifecycle methods.\n * @see {@link https://github.com/sveltejs/svelte/issues/4233}\n */\nfunction resizeObserver(node, target)\n{\n   ResizeObserverManager.add(node, target);\n\n   return {\n      /**\n       * @param {ResizeObserverTarget} newTarget - An object or function to update with observed width & height changes.\n       */\n      update: (newTarget) =>\n      {\n         ResizeObserverManager.remove(node, target);\n         target = newTarget;\n         ResizeObserverManager.add(node, target);\n      },\n\n      destroy: () =>\n      {\n         ResizeObserverManager.remove(node, target);\n      }\n   };\n}\n\n/**\n * Provides a function that when invoked with an element updates the cached styles for each subscriber of the element.\n *\n * The style attributes cached to calculate offset height / width include border & padding dimensions. You only need\n * to update the cache if you change border or padding attributes of the element.\n *\n * @param {HTMLElement} el - An HTML element.\n */\nresizeObserver.updateCache = function(el)\n{\n   if (!(el instanceof HTMLElement)) { throw new TypeError(`resizeObserverUpdate error: 'el' is not an HTMLElement.`); }\n\n   const subscribers = s_MAP.get(el);\n\n   if (Array.isArray(subscribers))\n   {\n      const computed = globalThis.getComputedStyle(el);\n\n      // Cache styles first from any inline styles then computed styles defaulting to 0 otherwise.\n      // Used to create the offset width & height values from the context box ResizeObserver provides.\n      const borderBottom = StyleParse.pixels(el.style.borderBottom) ?? StyleParse.pixels(computed.borderBottom) ?? 0;\n      const borderLeft = StyleParse.pixels(el.style.borderLeft) ?? StyleParse.pixels(computed.borderLeft) ?? 0;\n      const borderRight = StyleParse.pixels(el.style.borderRight) ?? StyleParse.pixels(computed.borderRight) ?? 0;\n      const borderTop = StyleParse.pixels(el.style.borderTop) ?? StyleParse.pixels(computed.borderTop) ?? 0;\n      const paddingBottom = StyleParse.pixels(el.style.paddingBottom) ?? StyleParse.pixels(computed.paddingBottom) ?? 0;\n      const paddingLeft = StyleParse.pixels(el.style.paddingLeft) ?? StyleParse.pixels(computed.paddingLeft) ?? 0;\n      const paddingRight = StyleParse.pixels(el.style.paddingRight) ?? StyleParse.pixels(computed.paddingRight) ?? 0;\n      const paddingTop = StyleParse.pixels(el.style.paddingTop) ?? StyleParse.pixels(computed.paddingTop) ?? 0;\n\n      const additionalWidth = borderLeft + borderRight + paddingLeft + paddingRight;\n      const additionalHeight = borderTop + borderBottom + paddingTop + paddingBottom;\n\n      for (const subscriber of subscribers)\n      {\n         subscriber.styles.additionalWidth = additionalWidth;\n         subscriber.styles.additionalHeight = additionalHeight;\n         s_UPDATE_SUBSCRIBER(subscriber, subscriber.contentWidth, subscriber.contentHeight);\n      }\n   }\n};\n\n// Below is the static ResizeObserverManager ------------------------------------------------------------------------\n\nconst s_MAP = new Map();\n\n/**\n * Provides a static / single instance of ResizeObserver that can notify listeners in different ways.\n *\n * The action, {@link resizeObserver}, utilizes ResizeObserverManager for automatic registration and removal\n * via Svelte.\n */\nclass ResizeObserverManager\n{\n   /**\n    * Add an HTMLElement and ResizeObserverTarget instance for monitoring. Create cached style attributes for the\n    * given element include border & padding dimensions for offset width / height calculations.\n    *\n    * @param {HTMLElement}    el - The element to observe.\n    *\n    * @param {ResizeObserverTarget} target - A target that contains one of several mechanisms for updating resize data.\n    */\n   static add(el, target)\n   {\n      const updateType = s_GET_UPDATE_TYPE(target);\n\n      if (updateType === 0)\n      {\n         throw new Error(`'target' does not match supported ResizeObserverManager update mechanisms.`);\n      }\n\n      const computed = globalThis.getComputedStyle(el);\n\n      // Cache styles first from any inline styles then computed styles defaulting to 0 otherwise.\n      // Used to create the offset width & height values from the context box ResizeObserver provides.\n      const borderBottom = StyleParse.pixels(el.style.borderBottom) ?? StyleParse.pixels(computed.borderBottom) ?? 0;\n      const borderLeft = StyleParse.pixels(el.style.borderLeft) ?? StyleParse.pixels(computed.borderLeft) ?? 0;\n      const borderRight = StyleParse.pixels(el.style.borderRight) ?? StyleParse.pixels(computed.borderRight) ?? 0;\n      const borderTop = StyleParse.pixels(el.style.borderTop) ?? StyleParse.pixels(computed.borderTop) ?? 0;\n      const paddingBottom = StyleParse.pixels(el.style.paddingBottom) ?? StyleParse.pixels(computed.paddingBottom) ?? 0;\n      const paddingLeft = StyleParse.pixels(el.style.paddingLeft) ?? StyleParse.pixels(computed.paddingLeft) ?? 0;\n      const paddingRight = StyleParse.pixels(el.style.paddingRight) ?? StyleParse.pixels(computed.paddingRight) ?? 0;\n      const paddingTop = StyleParse.pixels(el.style.paddingTop) ?? StyleParse.pixels(computed.paddingTop) ?? 0;\n\n      const data = {\n         updateType,\n         target,\n\n         // Stores most recent contentRect.width and contentRect.height values from ResizeObserver.\n         contentWidth: 0,\n         contentHeight: 0,\n\n         // Convenience data for total border & padding for offset width & height calculations.\n         styles: {\n            additionalWidth: borderLeft + borderRight + paddingLeft + paddingRight,\n            additionalHeight: borderTop + borderBottom + paddingTop + paddingBottom\n         }\n      };\n\n      if (s_MAP.has(el))\n      {\n         const subscribers = s_MAP.get(el);\n         subscribers.push(data);\n      }\n      else\n      {\n         s_MAP.set(el, [data]);\n      }\n\n      s_RESIZE_OBSERVER.observe(el);\n   }\n\n   /**\n    * Removes all targets from monitoring when just an element is provided otherwise removes a specific target\n    * from the monitoring map. If no more targets remain then the element is removed from monitoring.\n    *\n    * @param {HTMLElement}          el - Element to remove from monitoring.\n    *\n    * @param {ResizeObserverTarget} [target] - A specific target to remove from monitoring.\n    */\n   static remove(el, target = void 0)\n   {\n      const subscribers = s_MAP.get(el);\n      if (Array.isArray(subscribers))\n      {\n         const index = subscribers.findIndex((entry) => entry.target === target);\n         if (index >= 0)\n         {\n            // Update target subscriber with undefined values.\n            s_UPDATE_SUBSCRIBER(subscribers[index], void 0, void 0);\n\n            subscribers.splice(index, 1);\n         }\n\n         // Remove element monitoring if last target removed.\n         if (subscribers.length === 0)\n         {\n            s_MAP.delete(el);\n            s_RESIZE_OBSERVER.unobserve(el);\n         }\n      }\n   }\n}\n\n/**\n * Defines the various shape / update type of the given target.\n *\n * @type {Record<string, number>}\n */\nconst s_UPDATE_TYPES = {\n   none: 0,\n   attribute: 1,\n   function: 2,\n   resizeObserved: 3,\n   setContentBounds: 4,\n   setDimension: 5,\n   storeObject: 6,\n   storesObject: 7\n};\n\nconst s_RESIZE_OBSERVER = new ResizeObserver((entries) =>\n{\n   for (const entry of entries)\n   {\n      const subscribers = s_MAP.get(entry?.target);\n\n      if (Array.isArray(subscribers))\n      {\n         const contentWidth = entry.contentRect.width;\n         const contentHeight = entry.contentRect.height;\n\n         for (const subscriber of subscribers)\n         {\n            s_UPDATE_SUBSCRIBER(subscriber, contentWidth, contentHeight);\n         }\n      }\n   }\n});\n\n/**\n * Determines the shape of the target instance regarding valid update mechanisms to set width & height changes.\n *\n * @param {*}  target - The target instance.\n *\n * @returns {number} Update type value.\n */\nfunction s_GET_UPDATE_TYPE(target)\n{\n   if (target?.resizeObserved instanceof Function) { return s_UPDATE_TYPES.resizeObserved; }\n   if (target?.setDimension instanceof Function) { return s_UPDATE_TYPES.setDimension; }\n   if (target?.setContentBounds instanceof Function) { return s_UPDATE_TYPES.setContentBounds; }\n\n   const targetType = typeof target;\n\n   // Does the target have resizeObserved writable store?\n   if (targetType !== null && (targetType === 'object' || targetType === 'function'))\n   {\n      if (isUpdatableStore(target.resizeObserved))\n      {\n         return s_UPDATE_TYPES.storeObject;\n      }\n\n      // Now check for a child stores object which is a common TRL pattern for exposing stores.\n      const stores = target?.stores;\n      if (isObject(stores) || typeof stores === 'function')\n      {\n         if (isUpdatableStore(stores.resizeObserved))\n         {\n            return s_UPDATE_TYPES.storesObject;\n         }\n      }\n   }\n\n   if (targetType !== null && targetType === 'object') { return s_UPDATE_TYPES.attribute; }\n\n   if (targetType === 'function') { return s_UPDATE_TYPES.function; }\n\n   return s_UPDATE_TYPES.none;\n}\n\n/**\n * Updates a subscriber target with given content width & height values. Offset width & height is calculated from\n * the content values + cached styles.\n *\n * @param {object}            subscriber - Internal data about subscriber.\n *\n * @param {number|undefined}  contentWidth - ResizeObserver contentRect.width value or undefined.\n *\n * @param {number|undefined}  contentHeight - ResizeObserver contentRect.height value or undefined.\n */\nfunction s_UPDATE_SUBSCRIBER(subscriber, contentWidth, contentHeight)\n{\n   const styles = subscriber.styles;\n\n   subscriber.contentWidth = contentWidth;\n   subscriber.contentHeight = contentHeight;\n\n   const offsetWidth = Number.isFinite(contentWidth) ? contentWidth + styles.additionalWidth : void 0;\n   const offsetHeight = Number.isFinite(contentHeight) ? contentHeight + styles.additionalHeight : void 0;\n\n   const target = subscriber.target;\n\n   switch (subscriber.updateType)\n   {\n      case s_UPDATE_TYPES.attribute:\n         target.contentWidth = contentWidth;\n         target.contentHeight = contentHeight;\n         target.offsetWidth = offsetWidth;\n         target.offsetHeight = offsetHeight;\n         break;\n\n      case s_UPDATE_TYPES.function:\n         target?.(offsetWidth, offsetHeight, contentWidth, contentHeight);\n         break;\n\n      case s_UPDATE_TYPES.resizeObserved:\n         target.resizeObserved?.(offsetWidth, offsetHeight, contentWidth, contentHeight);\n         break;\n\n      case s_UPDATE_TYPES.setContentBounds:\n         target.setContentBounds?.(contentWidth, contentHeight);\n         break;\n\n      case s_UPDATE_TYPES.setDimension:\n         target.setDimension?.(offsetWidth, offsetHeight);\n         break;\n\n      case s_UPDATE_TYPES.storeObject:\n         target.resizeObserved.update((object) =>\n         {\n            object.contentHeight = contentHeight;\n            object.contentWidth = contentWidth;\n            object.offsetHeight = offsetHeight;\n            object.offsetWidth = offsetWidth;\n\n            return object;\n         });\n         break;\n\n      case s_UPDATE_TYPES.storesObject:\n         target.stores.resizeObserved.update((object) =>\n         {\n            object.contentHeight = contentHeight;\n            object.contentWidth = contentWidth;\n            object.offsetHeight = offsetHeight;\n            object.offsetWidth = offsetWidth;\n\n            return object;\n         });\n         break;\n   }\n}\n\n/**\n * @typedef {(\n *    offsetWidth: number,\n *    offsetHeight: number,\n *    contentWidth: number,\n *    contentHeight: number\n * ) => void } ResizeObserverFunction A function that receives offset / content height & width.\n */\n\n/**\n * @typedef {ResizeObserverObject | ResizeObserverObjectExtended | ResizeObserverFunction} ResizeObserverTarget The\n *          receiving target for observed resize data.\n */\n\n/**\n * @typedef {object} ResizeObserverObject A direct object to update observed resize updates.\n *\n * @property {number} [contentHeight] Direct attribute to store contentHeight.\n *\n * @property {number} [contentWidth] Direct attribute to store contentWidth.\n *\n * @property {number} [offsetHeight] Direct attribute to store offsetHeight.\n *\n * @property {number} [offsetWidth] Direct attribute to store offsetWidth.\n */\n\n/**\n * @typedef {object} ResizeObserverObjectExtended Provides extended attributes supported for observed resize updates.\n *\n * @property {import('svelte/store').Writable<ResizeObserverObject> | ResizeObserverFunction} [resizedObserver] Either\n *           a function or a writable store.\n *\n * @property {(contentWidth: number, contentHeight: number) => void} [setContentBounds] - A function that is invoked\n *           with content width & height changes.\n *\n * @property {(offsetWidth: number, offsetHeight: number) => void} [setDimension] - A function that is invoked with\n *           offset width & height changes.\n *\n * @property {{resizedObserver: import('svelte/store').Writable<ResizeObserverObject>}} [stores] - An object with a\n *           `stores` attribute and subsequent `resizedObserver` writable store.\n */\n\n/**\n * Provides an action to save `scrollTop` of an element with a vertical scrollbar. This action should be used on the\n * scrollable element and must include a writable store that holds the active store for the current `scrollTop` value.\n * You may switch the stores externally and this action will set the `scrollTop` based on the newly set store. This is\n * useful for instance providing a select box that controls the scrollable container.\n *\n * @param {HTMLElement} element - The target scrollable HTML element.\n *\n * @param {import('svelte/store').Writable<number>}   store - A writable store that stores the element scrollTop.\n *\n * @returns {import('svelte/action').ActionReturn<import('svelte/store').Writable<number>>} Lifecycle functions.\n */\nfunction applyScrolltop(element, store)\n{\n   if (!isWritableStore(store))\n   {\n      throw new TypeError(`applyScrolltop error: 'store' must be a writable Svelte store.`);\n   }\n\n   /**\n    * Updates element `scrollTop`.\n    *\n    * @param {number}   value -\n    */\n   function storeUpdate(value)\n   {\n      if (!Number.isFinite(value)) { return; }\n\n      // For some reason for scrollTop to take on first update from a new element setTimeout is necessary.\n      setTimeout(() => element.scrollTop = value, 0);\n   }\n\n   let unsubscribe = store.subscribe(storeUpdate);\n\n   const resizeControl = resizeObserver(element, Timing.debounce(() =>\n   {\n      if (element.isConnected) { store.set(element.scrollTop); }\n   }, 500));\n\n   /**\n    * Save target `scrollTop` to the current set store.\n    *\n    * @param {Event} event -\n    */\n   function onScroll(event)\n   {\n      store.set(event.target.scrollTop);\n   }\n\n   const debounceFn = Timing.debounce((e) => onScroll(e), 500);\n\n   element.addEventListener('scroll', debounceFn);\n\n   return {\n      /**\n       * @param {import('svelte/store').Writable<number>} newStore - A writable store that stores the element scrollTop.\n       */\n      update: (newStore) =>\n      {\n         unsubscribe();\n         store = newStore;\n\n         if (!isWritableStore(store))\n         {\n            throw new TypeError(`applyScrolltop.update error: 'store' must be a writable Svelte store.`);\n         }\n\n         unsubscribe = store.subscribe(storeUpdate);\n      },\n\n      destroy: () =>\n      {\n         element.removeEventListener('scroll', debounceFn);\n         unsubscribe();\n         resizeControl.destroy();\n      }\n   };\n}\n\n/**\n * Provides an action to apply style properties provided as an object.\n *\n * @param {HTMLElement} node - Target element\n *\n * @param {Record<string, string>}  properties - Key / value object of properties to set.\n *\n * @returns {import('svelte/action').ActionReturn<Record<string, string>>} Lifecycle functions.\n */\nfunction applyStyles(node, properties)\n{\n   /** Sets properties on node. */\n   function setProperties()\n   {\n      if (!isObject(properties)) { return; }\n\n      for (const prop of Object.keys(properties))\n      {\n         node.style.setProperty(`${prop}`, properties[prop]);\n      }\n   }\n\n   setProperties();\n\n   return {\n      /**\n       * @param {Record<string, string>}  newProperties - Key / value object of properties to set.\n       */\n      update: (newProperties) =>\n      {\n         properties = newProperties;\n         setProperties();\n      }\n   };\n}\n\n/**\n * Provides an action to blur the element when any pointer down event occurs outside the element. This can be useful\n * for input elements including select to blur / unfocus the element when any pointer down occurs outside the element.\n *\n * @param {HTMLElement}   node - The node to handle automatic blur on focus loss.\n *\n * @returns {import('svelte/action').ActionReturn} Lifecycle functions.\n */\nfunction autoBlur(node)\n{\n   /**\n    * Removes listener on blur.\n    */\n   function onBlur() { document.body.removeEventListener('pointerdown', onPointerDown); }\n\n   /**\n    * Adds listener on focus.\n    */\n   function onFocus() { document.body.addEventListener('pointerdown', onPointerDown); }\n\n   /**\n    * Blur the node if a pointer down event happens outside the node.\n    *\n    * @param {PointerEvent} event -\n    */\n   function onPointerDown(event)\n   {\n      if (event.target === node || node.contains(event.target)) { return; }\n\n      if (document.activeElement === node) { node.blur(); }\n   }\n\n   node.addEventListener('blur', onBlur);\n   node.addEventListener('focus', onFocus);\n\n   return {\n      destroy: () =>\n      {\n         document.body.removeEventListener('pointerdown', onPointerDown);\n         node.removeEventListener('blur', onBlur);\n         node.removeEventListener('focus', onFocus);\n      }\n   };\n}\n\n/**\n * Provides an action to monitor focus state of a given element and set an associated store with current focus state.\n *\n * This action is usable with any writable store.\n *\n * @param {HTMLElement} node - Target element.\n *\n * @param {import('svelte/store').Writable<boolean>}  storeFocused - Update store for focus changes.\n *\n * @returns {import('svelte/action').ActionReturn<import('svelte/store').Writable<boolean>>} Lifecycle functions.\n */\nfunction isFocused(node, storeFocused)\n{\n   let localFocused = false;\n\n   /**\n    * Updates `storeFocused` w/ current focused state.\n    *\n    * @param {boolean}  current - current focused state.\n    */\n   function setFocused(current)\n   {\n      localFocused = current;\n\n      if (isWritableStore(storeFocused)) { storeFocused.set(localFocused); }\n   }\n\n   /**\n    * Focus event listener.\n    */\n   function onFocus()\n   {\n      setFocused(true);\n   }\n\n   /**\n    * Blur event listener.\n    */\n   function onBlur()\n   {\n      setFocused(false);\n   }\n\n   /**\n    * Activate listeners.\n    */\n   function activateListeners()\n   {\n      node.addEventListener('focus', onFocus);\n      node.addEventListener('blur', onBlur);\n   }\n\n   /**\n    * Remove listeners.\n    */\n   function removeListeners()\n   {\n      node.removeEventListener('focus', onFocus);\n      node.removeEventListener('blur', onBlur);\n   }\n\n   activateListeners();\n\n   return {\n      /**\n       * @param {import('svelte/store').Writable<boolean>}  newStoreFocused - Update store for focus changes.\n       */\n      update: (newStoreFocused) =>\n      {\n         storeFocused = newStoreFocused;\n         setFocused(localFocused);\n      },\n\n      destroy: () => removeListeners()\n   };\n}\n\nexport { alwaysBlur, applyScrolltop, applyStyles, autoBlur, isFocused, resizeObserver };\n//# sourceMappingURL=index.js.map\n","/*\nAdapted from https://github.com/mattdesl\nDistributed under MIT License https://github.com/mattdesl/eases/blob/master/LICENSE.md\n*/\nexport { identity as linear } from '../internal/index.js';\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function backInOut(t) {\n\tconst s = 1.70158 * 1.525;\n\tif ((t *= 2) < 1) return 0.5 * (t * t * ((s + 1) * t - s));\n\treturn 0.5 * ((t -= 2) * t * ((s + 1) * t + s) + 2);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function backIn(t) {\n\tconst s = 1.70158;\n\treturn t * t * ((s + 1) * t - s);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function backOut(t) {\n\tconst s = 1.70158;\n\treturn --t * t * ((s + 1) * t + s) + 1;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function bounceOut(t) {\n\tconst a = 4.0 / 11.0;\n\tconst b = 8.0 / 11.0;\n\tconst c = 9.0 / 10.0;\n\tconst ca = 4356.0 / 361.0;\n\tconst cb = 35442.0 / 1805.0;\n\tconst cc = 16061.0 / 1805.0;\n\tconst t2 = t * t;\n\treturn t < a\n\t\t? 7.5625 * t2\n\t\t: t < b\n\t\t? 9.075 * t2 - 9.9 * t + 3.4\n\t\t: t < c\n\t\t? ca * t2 - cb * t + cc\n\t\t: 10.8 * t * t - 20.52 * t + 10.72;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function bounceInOut(t) {\n\treturn t < 0.5 ? 0.5 * (1.0 - bounceOut(1.0 - t * 2.0)) : 0.5 * bounceOut(t * 2.0 - 1.0) + 0.5;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function bounceIn(t) {\n\treturn 1.0 - bounceOut(1.0 - t);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function circInOut(t) {\n\tif ((t *= 2) < 1) return -0.5 * (Math.sqrt(1 - t * t) - 1);\n\treturn 0.5 * (Math.sqrt(1 - (t -= 2) * t) + 1);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function circIn(t) {\n\treturn 1.0 - Math.sqrt(1.0 - t * t);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function circOut(t) {\n\treturn Math.sqrt(1 - --t * t);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function cubicInOut(t) {\n\treturn t < 0.5 ? 4.0 * t * t * t : 0.5 * Math.pow(2.0 * t - 2.0, 3.0) + 1.0;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function cubicIn(t) {\n\treturn t * t * t;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function cubicOut(t) {\n\tconst f = t - 1.0;\n\treturn f * f * f + 1.0;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function elasticInOut(t) {\n\treturn t < 0.5\n\t\t? 0.5 * Math.sin(((+13.0 * Math.PI) / 2) * 2.0 * t) * Math.pow(2.0, 10.0 * (2.0 * t - 1.0))\n\t\t: 0.5 *\n\t\t\t\tMath.sin(((-13.0 * Math.PI) / 2) * (2.0 * t - 1.0 + 1.0)) *\n\t\t\t\tMath.pow(2.0, -10.0 * (2.0 * t - 1.0)) +\n\t\t\t\t1.0;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function elasticIn(t) {\n\treturn Math.sin((13.0 * t * Math.PI) / 2) * Math.pow(2.0, 10.0 * (t - 1.0));\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function elasticOut(t) {\n\treturn Math.sin((-13.0 * (t + 1.0) * Math.PI) / 2) * Math.pow(2.0, -10.0 * t) + 1.0;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function expoInOut(t) {\n\treturn t === 0.0 || t === 1.0\n\t\t? t\n\t\t: t < 0.5\n\t\t? +0.5 * Math.pow(2.0, 20.0 * t - 10.0)\n\t\t: -0.5 * Math.pow(2.0, 10.0 - t * 20.0) + 1.0;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function expoIn(t) {\n\treturn t === 0.0 ? t : Math.pow(2.0, 10.0 * (t - 1.0));\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function expoOut(t) {\n\treturn t === 1.0 ? t : 1.0 - Math.pow(2.0, -10.0 * t);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quadInOut(t) {\n\tt /= 0.5;\n\tif (t < 1) return 0.5 * t * t;\n\tt--;\n\treturn -0.5 * (t * (t - 2) - 1);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quadIn(t) {\n\treturn t * t;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quadOut(t) {\n\treturn -t * (t - 2.0);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quartInOut(t) {\n\treturn t < 0.5 ? +8.0 * Math.pow(t, 4.0) : -8.0 * Math.pow(t - 1.0, 4.0) + 1.0;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quartIn(t) {\n\treturn Math.pow(t, 4.0);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quartOut(t) {\n\treturn Math.pow(t - 1.0, 3.0) * (1.0 - t) + 1.0;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quintInOut(t) {\n\tif ((t *= 2) < 1) return 0.5 * t * t * t * t * t;\n\treturn 0.5 * ((t -= 2) * t * t * t * t + 2);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quintIn(t) {\n\treturn t * t * t * t * t;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quintOut(t) {\n\treturn --t * t * t * t * t + 1;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function sineInOut(t) {\n\treturn -0.5 * (Math.cos(Math.PI * t) - 1);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function sineIn(t) {\n\tconst v = Math.cos(t * Math.PI * 0.5);\n\tif (Math.abs(v) < 1e-14) return 1;\n\telse return 1 - v;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function sineOut(t) {\n\treturn Math.sin((t * Math.PI) / 2);\n}\n","/**\n * Performs linear interpolation between a start & end value by given amount between 0 - 1 inclusive.\n *\n * @param {number}   start - Start value.\n *\n * @param {number}   end - End value.\n *\n * @param {number}   amount - Current amount between 0 - 1 inclusive.\n *\n * @returns {number} Linear interpolated value between start & end.\n */\nfunction lerp(start, end, amount)\n{\n   return (1 - amount) * start + amount * end;\n}\n\nexport { lerp };\n//# sourceMappingURL=index.js.map\n","import { cubicOut, cubicInOut, linear } from '../easing/index.js';\nimport { assign, split_css_unit, is_function } from '../internal/index.js';\n\n/**\n * Animates a `blur` filter alongside an element's opacity.\n *\n * https://svelte.dev/docs/svelte-transition#blur\n * @param {Element} node\n * @param {import('./public').BlurParams} [params]\n * @returns {import('./public').TransitionConfig}\n */\nexport function blur(\n\tnode,\n\t{ delay = 0, duration = 400, easing = cubicInOut, amount = 5, opacity = 0 } = {}\n) {\n\tconst style = getComputedStyle(node);\n\tconst target_opacity = +style.opacity;\n\tconst f = style.filter === 'none' ? '' : style.filter;\n\tconst od = target_opacity * (1 - opacity);\n\tconst [value, unit] = split_css_unit(amount);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (_t, u) => `opacity: ${target_opacity - od * u}; filter: ${f} blur(${u * value}${unit});`\n\t};\n}\n\n/**\n * Animates the opacity of an element from 0 to the current opacity for `in` transitions and from the current opacity to 0 for `out` transitions.\n *\n * https://svelte.dev/docs/svelte-transition#fade\n * @param {Element} node\n * @param {import('./public').FadeParams} [params]\n * @returns {import('./public').TransitionConfig}\n */\nexport function fade(node, { delay = 0, duration = 400, easing = linear } = {}) {\n\tconst o = +getComputedStyle(node).opacity;\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (t) => `opacity: ${t * o}`\n\t};\n}\n\n/**\n * Animates the x and y positions and the opacity of an element. `in` transitions animate from the provided values, passed as parameters to the element's default values. `out` transitions animate from the element's default values to the provided values.\n *\n * https://svelte.dev/docs/svelte-transition#fly\n * @param {Element} node\n * @param {import('./public').FlyParams} [params]\n * @returns {import('./public').TransitionConfig}\n */\nexport function fly(\n\tnode,\n\t{ delay = 0, duration = 400, easing = cubicOut, x = 0, y = 0, opacity = 0 } = {}\n) {\n\tconst style = getComputedStyle(node);\n\tconst target_opacity = +style.opacity;\n\tconst transform = style.transform === 'none' ? '' : style.transform;\n\tconst od = target_opacity * (1 - opacity);\n\tconst [xValue, xUnit] = split_css_unit(x);\n\tconst [yValue, yUnit] = split_css_unit(y);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (t, u) => `\n\t\t\ttransform: ${transform} translate(${(1 - t) * xValue}${xUnit}, ${(1 - t) * yValue}${yUnit});\n\t\t\topacity: ${target_opacity - od * u}`\n\t};\n}\n\n/**\n * Slides an element in and out.\n *\n * https://svelte.dev/docs/svelte-transition#slide\n * @param {Element} node\n * @param {import('./public').SlideParams} [params]\n * @returns {import('./public').TransitionConfig}\n */\nexport function slide(node, { delay = 0, duration = 400, easing = cubicOut, axis = 'y' } = {}) {\n\tconst style = getComputedStyle(node);\n\tconst opacity = +style.opacity;\n\tconst primary_property = axis === 'y' ? 'height' : 'width';\n\tconst primary_property_value = parseFloat(style[primary_property]);\n\tconst secondary_properties = axis === 'y' ? ['top', 'bottom'] : ['left', 'right'];\n\tconst capitalized_secondary_properties = secondary_properties.map(\n\t\t(e) => `${e[0].toUpperCase()}${e.slice(1)}`\n\t);\n\tconst padding_start_value = parseFloat(style[`padding${capitalized_secondary_properties[0]}`]);\n\tconst padding_end_value = parseFloat(style[`padding${capitalized_secondary_properties[1]}`]);\n\tconst margin_start_value = parseFloat(style[`margin${capitalized_secondary_properties[0]}`]);\n\tconst margin_end_value = parseFloat(style[`margin${capitalized_secondary_properties[1]}`]);\n\tconst border_width_start_value = parseFloat(\n\t\tstyle[`border${capitalized_secondary_properties[0]}Width`]\n\t);\n\tconst border_width_end_value = parseFloat(\n\t\tstyle[`border${capitalized_secondary_properties[1]}Width`]\n\t);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (t) =>\n\t\t\t'overflow: hidden;' +\n\t\t\t`opacity: ${Math.min(t * 20, 1) * opacity};` +\n\t\t\t`${primary_property}: ${t * primary_property_value}px;` +\n\t\t\t`padding-${secondary_properties[0]}: ${t * padding_start_value}px;` +\n\t\t\t`padding-${secondary_properties[1]}: ${t * padding_end_value}px;` +\n\t\t\t`margin-${secondary_properties[0]}: ${t * margin_start_value}px;` +\n\t\t\t`margin-${secondary_properties[1]}: ${t * margin_end_value}px;` +\n\t\t\t`border-${secondary_properties[0]}-width: ${t * border_width_start_value}px;` +\n\t\t\t`border-${secondary_properties[1]}-width: ${t * border_width_end_value}px;`\n\t};\n}\n\n/**\n * Animates the opacity and scale of an element. `in` transitions animate from an element's current (default) values to the provided values, passed as parameters. `out` transitions animate from the provided values to an element's default values.\n *\n * https://svelte.dev/docs/svelte-transition#scale\n * @param {Element} node\n * @param {import('./public').ScaleParams} [params]\n * @returns {import('./public').TransitionConfig}\n */\nexport function scale(\n\tnode,\n\t{ delay = 0, duration = 400, easing = cubicOut, start = 0, opacity = 0 } = {}\n) {\n\tconst style = getComputedStyle(node);\n\tconst target_opacity = +style.opacity;\n\tconst transform = style.transform === 'none' ? '' : style.transform;\n\tconst sd = 1 - start;\n\tconst od = target_opacity * (1 - opacity);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (_t, u) => `\n\t\t\ttransform: ${transform} scale(${1 - sd * u});\n\t\t\topacity: ${target_opacity - od * u}\n\t\t`\n\t};\n}\n\n/**\n * Animates the stroke of an SVG element, like a snake in a tube. `in` transitions begin with the path invisible and draw the path to the screen over time. `out` transitions start in a visible state and gradually erase the path. `draw` only works with elements that have a `getTotalLength` method, like `<path>` and `<polyline>`.\n *\n * https://svelte.dev/docs/svelte-transition#draw\n * @param {SVGElement & { getTotalLength(): number }} node\n * @param {import('./public').DrawParams} [params]\n * @returns {import('./public').TransitionConfig}\n */\nexport function draw(node, { delay = 0, speed, duration, easing = cubicInOut } = {}) {\n\tlet len = node.getTotalLength();\n\tconst style = getComputedStyle(node);\n\tif (style.strokeLinecap !== 'butt') {\n\t\tlen += parseInt(style.strokeWidth);\n\t}\n\tif (duration === undefined) {\n\t\tif (speed === undefined) {\n\t\t\tduration = 800;\n\t\t} else {\n\t\t\tduration = len / speed;\n\t\t}\n\t} else if (typeof duration === 'function') {\n\t\tduration = duration(len);\n\t}\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (_, u) => `\n\t\t\tstroke-dasharray: ${len};\n\t\t\tstroke-dashoffset: ${u * len};\n\t\t`\n\t};\n}\n\n/**\n * The `crossfade` function creates a pair of [transitions](https://svelte.dev/docs#template-syntax-element-directives-transition-fn) called `send` and `receive`. When an element is 'sent', it looks for a corresponding element being 'received', and generates a transition that transforms the element to its counterpart's position and fades it out. When an element is 'received', the reverse happens. If there is no counterpart, the `fallback` transition is used.\n *\n * https://svelte.dev/docs/svelte-transition#crossfade\n * @param {import('./public').CrossfadeParams & {\n * \tfallback?: (node: Element, params: import('./public').CrossfadeParams, intro: boolean) => import('./public').TransitionConfig;\n * }} params\n * @returns {[(node: any, params: import('./public').CrossfadeParams & { key: any; }) => () => import('./public').TransitionConfig, (node: any, params: import('./public').CrossfadeParams & { key: any; }) => () => import('./public').TransitionConfig]}\n */\nexport function crossfade({ fallback, ...defaults }) {\n\t/** @type {Map<any, Element>} */\n\tconst to_receive = new Map();\n\t/** @type {Map<any, Element>} */\n\tconst to_send = new Map();\n\t/**\n\t * @param {Element} from_node\n\t * @param {Element} node\n\t * @param {import('./public').CrossfadeParams} params\n\t * @returns {import('./public').TransitionConfig}\n\t */\n\tfunction crossfade(from_node, node, params) {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = (d) => Math.sqrt(d) * 30,\n\t\t\teasing = cubicOut\n\t\t} = assign(assign({}, defaults), params);\n\t\tconst from = from_node.getBoundingClientRect();\n\t\tconst to = node.getBoundingClientRect();\n\t\tconst dx = from.left - to.left;\n\t\tconst dy = from.top - to.top;\n\t\tconst dw = from.width / to.width;\n\t\tconst dh = from.height / to.height;\n\t\tconst d = Math.sqrt(dx * dx + dy * dy);\n\t\tconst style = getComputedStyle(node);\n\t\tconst transform = style.transform === 'none' ? '' : style.transform;\n\t\tconst opacity = +style.opacity;\n\t\treturn {\n\t\t\tdelay,\n\t\t\tduration: is_function(duration) ? duration(d) : duration,\n\t\t\teasing,\n\t\t\tcss: (t, u) => `\n\t\t\t\topacity: ${t * opacity};\n\t\t\t\ttransform-origin: top left;\n\t\t\t\ttransform: ${transform} translate(${u * dx}px,${u * dy}px) scale(${t + (1 - t) * dw}, ${\n\t\t\t\tt + (1 - t) * dh\n\t\t\t});\n\t\t\t`\n\t\t};\n\t}\n\n\t/**\n\t * @param {Map<any, Element>} items\n\t * @param {Map<any, Element>} counterparts\n\t * @param {boolean} intro\n\t * @returns {(node: any, params: import('./public').CrossfadeParams & { key: any; }) => () => import('./public').TransitionConfig}\n\t */\n\tfunction transition(items, counterparts, intro) {\n\t\treturn (node, params) => {\n\t\t\titems.set(params.key, node);\n\t\t\treturn () => {\n\t\t\t\tif (counterparts.has(params.key)) {\n\t\t\t\t\tconst other_node = counterparts.get(params.key);\n\t\t\t\t\tcounterparts.delete(params.key);\n\t\t\t\t\treturn crossfade(other_node, node, params);\n\t\t\t\t}\n\t\t\t\t// if the node is disappearing altogether\n\t\t\t\t// (i.e. wasn't claimed by the other list)\n\t\t\t\t// then we need to supply an outro\n\t\t\t\titems.delete(params.key);\n\t\t\t\treturn fallback && fallback(node, params, intro);\n\t\t\t};\n\t\t};\n\t}\n\treturn [transition(to_send, to_receive, false), transition(to_receive, to_send, true)];\n}\n","import { linear } from 'svelte/easing';\nimport { lerp } from '@typhonjs-fvtt/runtime/math/interpolate';\nimport { fade, slide } from 'svelte/transition';\n\n/**\n * Provides a rotate transition. For options `easing` is applied to the rotate transition. The default easing is\n * linear.\n *\n * Note: that when reversing the transition that time goes from `1 - 0`, so if specific options are applied for\n * rotating out transition then `end` and `initial` are swapped.\n *\n * @param {HTMLElement} node - The transition node.\n *\n * @param {object}      [options] - Optional parameters.\n *\n * @param {number}      [options.delay] - Delay in ms before start of transition.\n *\n * @param {number}      [options.duration] - Total transition length in ms.\n *\n * @param {import('svelte/transition').EasingFunction}   [options.easing=linear] - The easing function to apply to the\n *        rotate transition.\n *\n * @param {number}      [options.end=0] - End rotation in degrees.\n *\n * @param {number}      [options.initial=0] - Initial rotation in degrees.\n *\n * @returns {import('svelte/transition').TransitionConfig} Transition config.\n */\nfunction rotate(node, options)\n{\n   const easingRotate = options.easing ?? linear;\n\n   const initialDeg = options.initial ?? 0;\n   const endDeg = options.end ?? 0;\n\n   return {\n      delay: options.delay ?? 0,\n      duration: options.duration ?? 500,\n      easing: linear,\n      css: (t) =>\n      {\n         const rotateT = easingRotate(t);\n         return `transform: rotate(${lerp(initialDeg, endDeg, rotateT)}deg)`;\n      }\n   };\n}\n\n/**\n * Combines rotate & fade transitions into a single transition. For options `easing` this is applied to both transitions,\n * however if provided `easingRotate` and / or `easingFade` will take precedence. The default easing is linear.\n *\n * Note: that when reversing the transition that time goes from `1 - 0`, so if specific options are applied for\n * rotating out transition then `end` and `initial` are swapped.\n *\n * @param {HTMLElement} node - The transition node.\n *\n * @param {object}      [options] - Optional parameters.\n *\n * @param {number}      [options.delay] - Delay in ms before start of transition.\n *\n * @param {number}      [options.duration] - Total transition length in ms.\n *\n * @param {import('svelte/transition').EasingFunction}   [options.easing=linear] - The easing function to apply to both\n *        slide & fade transitions.\n *\n * @param {import('svelte/transition').EasingFunction}   [options.easingFade=linear] - The easing function to apply to\n *        the fade transition.\n *\n * @param {import('svelte/transition').EasingFunction}   [options.easingRotate=linear] - The easing function to apply\n *        to the rotate transition.\n *\n * @param {number}      [options.end=0] - End rotation in degrees.\n *\n * @param {number}      [options.initial=0] - Initial rotation in degrees.\n *\n * @returns {import('svelte/transition').TransitionConfig} Transition config.\n */\nfunction rotateFade(node, options)\n{\n   const easingFade = options.easingFade || options.easing || linear;\n   const easingRotate = options.easingRotate || options.easing || linear;\n\n   const fadeTransition = fade(node);\n\n   const initialDeg = options.initial ?? 0;\n   const endDeg = options.end ?? 0;\n\n   return {\n      delay: options.delay ?? 0,\n      duration: options.duration ?? 500,\n      easing: linear,\n      css: (t) =>\n      {\n         const fadeT = easingFade(t);\n         const rotateT = easingRotate(t);\n\n         return `transform: rotate(${lerp(initialDeg, endDeg, rotateT)}deg); ${fadeTransition.css(fadeT, 1 - fadeT)}`;\n      }\n   };\n}\n\n/**\n * Combines slide & fade transitions into a single transition. For options `easing` this is applied to both transitions,\n * however if provided `easingSlide` and / or `easingFade` will take precedence. The default easing is linear.\n *\n * @param {HTMLElement} node - The transition node.\n *\n * @param {object}      [options] - Optional parameters.\n *\n * @param {number}      [options.delay] - Delay in ms before start of transition.\n *\n * @param {number}      [options.duration] - Total transition length in ms.\n *\n * @param {import('svelte/transition').EasingFunction}   [options.easing=linear] - The easing function to apply to both\n *        slide & fade transitions.\n *\n * @param {import('svelte/transition').EasingFunction}   [options.easingFade=linear] - The easing function to apply to\n *        the fade transition.\n *\n * @param {import('svelte/transition').EasingFunction}   [options.easingSlide=linear] - The easing function to apply to\n *        the slide transition.\n *\n * @returns {import('svelte/transition').TransitionConfig} Transition config.\n */\nfunction slideFade(node, options)\n{\n   const fadeEasing = options.easingFade || options.easing || linear;\n   const slideEasing = options.easingSlide || options.easing || linear;\n\n   const fadeTransition = fade(node);\n   const slideTransition = slide(node);\n\n   return {\n      delay: options.delay || 0,\n      duration: options.duration || 500,\n      easing: linear,\n      css: (t) =>\n      {\n         const fadeT = fadeEasing(t);\n         const slideT = slideEasing(t);\n         return `${slideTransition.css(slideT, 1 - slideT)}; ${fadeTransition.css(fadeT, 1 - fadeT)}`;\n      }\n   };\n}\n\n/**\n * Converts a Svelte transition to an animation. Both transitions & animations use the same CSS / styles solution and\n * resulting data so wrap the transition function with the signature of an animation.\n *\n * @param {(node: Element, ...rest: any[]) => import('svelte/transition').TransitionConfig} fn -\n *        A Svelte transition function.\n *\n * @returns {(\n *    node: Element,\n *    data: { from: DOMRect, to: DOMRect },\n *    ...rest: any\n * ) => import('svelte/animation').AnimationConfig} - Transition function converted to an animation.\n */\nfunction toAnimation(fn)\n{\n   return (node, animations, ...rest) => fn(node, ...rest);\n}\n\n/**\n * Provides static data useful for handling custom props / options to components that allow dynamic configuration of\n * transitions. This is used in all application shells and components that have configurable transitions.\n *\n * @ignore\n */\nclass TJSDefaultTransition\n{\n   static #options = {};\n\n   static #default = () => void 0;\n\n   /**\n    * @returns {() => undefined} Default empty transition.\n    */\n   static get default() { return this.#default; }\n\n   /**\n    * @returns {{}} Default empty options.\n    */\n   static get options() { return this.#options; }\n}\n\nexport { TJSDefaultTransition, rotate, rotateFade, slideFade, toAnimation };\n//# sourceMappingURL=index.js.map\n","<script>\n   import { createEventDispatcher }    from 'svelte';\n\n   import { applyStyles }              from '@typhonjs-fvtt/runtime/svelte/action/dom';\n   import { TJSDefaultTransition }     from '@typhonjs-fvtt/runtime/svelte/transition';\n   import { isObject }                 from '@typhonjs-fvtt/runtime/util/object';\n\n   /** @type {string} */\n   export let background = '#50505080';\n\n   /** @type {boolean} */\n   export let captureInput = true;\n\n   /**\n    * When true any input fires an event `close:glasspane`.\n    *\n    * @type {boolean}\n    */\n   export let closeOnInput = void 0;\n\n   /** @type {string} */\n   export let id = void 0;\n\n   /** @type {boolean} */\n   export let slotSeparate = void 0;\n\n   /** @type {Record<string, string>} */\n   export let styles = void 0;\n\n   /** @type {number} */\n   export let zIndex = Number.MAX_SAFE_INTEGER;\n\n   const dispatch = createEventDispatcher();\n\n   /** @type {HTMLDivElement} */\n   let backgroundEl, containerEl, glassPaneEl;\n\n   $: slotSeparate = typeof slotSeparate === 'boolean' ? slotSeparate : false;\n\n   // ---------------------------------------------------------------------------------------------------------------\n\n   // The following block is somewhat complex, but allows transition options to be updated reactively during\n   // runtime execution.\n\n   // Exports properties to set a transition w/ in / out options.\n   export let transition = void 0;\n   export let inTransition = void 0;\n   export let outTransition = void 0;\n\n   // Exports properties to set options for any transitions.\n   export let transitionOptions = void 0;\n   export let inTransitionOptions = TJSDefaultTransition.options;\n   export let outTransitionOptions = TJSDefaultTransition.options;\n\n   // Tracks last transition state.\n   let oldTransition = void 0;\n   let oldTransitionOptions = void 0\n\n   // Run this reactive block when the last transition state is not equal to the current state.\n   $: if (oldTransition !== transition)\n   {\n      // If transition is defined and not the default transition then set it to both in and out transition otherwise\n      // set the default transition to both in & out transitions.\n      const newTransition = typeof transition === 'function' ? transition : void 0;\n\n      inTransition = newTransition;\n      outTransition = newTransition;\n\n      oldTransition = newTransition;\n   }\n\n   // Run this reactive block when the last transition options state is not equal to the current options state.\n   $: if (oldTransitionOptions !== transitionOptions)\n   {\n      const newOptions = transitionOptions !== TJSDefaultTransition.options && isObject(transitionOptions) ?\n       transitionOptions : TJSDefaultTransition.options;\n\n      inTransitionOptions = newOptions;\n      outTransitionOptions = newOptions;\n\n      oldTransitionOptions = newOptions;\n   }\n\n   // Handle cases if inTransition is unset; assign noop default transition function.\n   $: if (typeof inTransition !== 'function') { inTransition = void 0; }\n\n   // Handle cases if outTransition is unset; assign noop default transition function.\n   $: if (typeof outTransition !== 'function') { outTransition = void 0; }\n\n   // Handle cases if inTransitionOptions is unset; assign empty default transition options.\n   $: if (!isObject(inTransitionOptions)) { inTransitionOptions = TJSDefaultTransition.options; }\n\n   // Handle cases if outTransitionOptions is unset; assign empty default transition options.\n   $: if (!isObject(outTransitionOptions)) { outTransitionOptions = TJSDefaultTransition.options; }\n\n   // ---------------------------------------------------------------------------------------------------------------\n\n   /**\n    * Swallows / stops propagation for all events where the event target is not contained by the glass pane element.\n    *\n    * @param {Event} event - The event to swallow.\n    */\n   function swallow(event)\n   {\n      const targetEl = event.target;\n\n      if (targetEl !== glassPaneEl && targetEl !== backgroundEl  && targetEl !== containerEl &&\n        glassPaneEl.contains(targetEl))\n      {\n         return;\n      }\n\n      if (captureInput)\n      {\n         event.preventDefault();\n         event.stopImmediatePropagation();\n      }\n\n      if (event?.type === 'pointerdown' && closeOnInput)\n      {\n         dispatch('close:glasspane');\n      }\n   }\n</script>\n\n<!-- Capture all input -->\n<svelte:window\n        on:contextmenu|capture={swallow}\n        on:dblclick|capture={swallow}\n        on:keydown|capture={swallow}\n        on:keyup|capture={swallow}\n        on:mousedown|capture={swallow}\n        on:mousemove|capture={swallow}\n        on:mouseup|capture={swallow}\n        on:pointerdown|capture={swallow}\n        on:pointermove|capture={swallow}\n        on:pointerup|capture={swallow}\n        on:touchend|capture={swallow}\n        on:touchmove|capture={swallow}\n        on:touchstart|capture={swallow}\n        on:wheel|capture={swallow}\n/>\n\n<div id={id}\n     bind:this={glassPaneEl}\n     class=tjs-glass-pane\n     style:z-index={zIndex}>\n\n   {#if slotSeparate}\n      <div class=tjs-glass-pane-background\n           bind:this={backgroundEl}\n           style:background={background}\n           in:inTransition|global={inTransitionOptions}\n           out:outTransition|global={outTransitionOptions}\n           use:applyStyles={styles} />\n\n      <div class=tjs-glass-pane-container bind:this={containerEl}>\n         <slot />\n      </div>\n   {:else}\n      <div class=tjs-glass-pane-background\n           bind:this={backgroundEl}\n           style:background={background}\n           in:inTransition|global={inTransitionOptions}\n           out:outTransition|global={outTransitionOptions}\n           use:applyStyles={styles} >\n         <slot />\n      </div>\n   {/if}\n</div>\n\n<style>\n   .tjs-glass-pane, .tjs-glass-pane-background , .tjs-glass-pane-container {\n      position: absolute;\n      overflow: hidden;\n\n      height: 100%;\n      width: 100%;\n      max-height: 100%;\n      max-width: 100%;\n   }\n</style>\n","import {\n\trun_all,\n\tsubscribe,\n\tnoop,\n\tsafe_not_equal,\n\tis_function,\n\tget_store_value\n} from '../internal/index.js';\n\nconst subscriber_queue = [];\n\n/**\n * Creates a `Readable` store that allows reading by subscription.\n *\n * https://svelte.dev/docs/svelte-store#readable\n * @template T\n * @param {T} [value] initial value\n * @param {import('./public.js').StartStopNotifier<T>} [start]\n * @returns {import('./public.js').Readable<T>}\n */\nexport function readable(value, start) {\n\treturn {\n\t\tsubscribe: writable(value, start).subscribe\n\t};\n}\n\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n *\n * https://svelte.dev/docs/svelte-store#writable\n * @template T\n * @param {T} [value] initial value\n * @param {import('./public.js').StartStopNotifier<T>} [start]\n * @returns {import('./public.js').Writable<T>}\n */\nexport function writable(value, start = noop) {\n\t/** @type {import('./public.js').Unsubscriber} */\n\tlet stop;\n\t/** @type {Set<import('./private.js').SubscribeInvalidateTuple<T>>} */\n\tconst subscribers = new Set();\n\t/** @param {T} new_value\n\t * @returns {void}\n\t */\n\tfunction set(new_value) {\n\t\tif (safe_not_equal(value, new_value)) {\n\t\t\tvalue = new_value;\n\t\t\tif (stop) {\n\t\t\t\t// store is ready\n\t\t\t\tconst run_queue = !subscriber_queue.length;\n\t\t\t\tfor (const subscriber of subscribers) {\n\t\t\t\t\tsubscriber[1]();\n\t\t\t\t\tsubscriber_queue.push(subscriber, value);\n\t\t\t\t}\n\t\t\t\tif (run_queue) {\n\t\t\t\t\tfor (let i = 0; i < subscriber_queue.length; i += 2) {\n\t\t\t\t\t\tsubscriber_queue[i][0](subscriber_queue[i + 1]);\n\t\t\t\t\t}\n\t\t\t\t\tsubscriber_queue.length = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @param {import('./public.js').Updater<T>} fn\n\t * @returns {void}\n\t */\n\tfunction update(fn) {\n\t\tset(fn(value));\n\t}\n\n\t/**\n\t * @param {import('./public.js').Subscriber<T>} run\n\t * @param {import('./private.js').Invalidator<T>} [invalidate]\n\t * @returns {import('./public.js').Unsubscriber}\n\t */\n\tfunction subscribe(run, invalidate = noop) {\n\t\t/** @type {import('./private.js').SubscribeInvalidateTuple<T>} */\n\t\tconst subscriber = [run, invalidate];\n\t\tsubscribers.add(subscriber);\n\t\tif (subscribers.size === 1) {\n\t\t\tstop = start(set, update) || noop;\n\t\t}\n\t\trun(value);\n\t\treturn () => {\n\t\t\tsubscribers.delete(subscriber);\n\t\t\tif (subscribers.size === 0 && stop) {\n\t\t\t\tstop();\n\t\t\t\tstop = null;\n\t\t\t}\n\t\t};\n\t}\n\treturn { set, update, subscribe };\n}\n\n/**\n * Derived value store by synchronizing one or more readable stores and\n * applying an aggregation function over its input values.\n *\n * https://svelte.dev/docs/svelte-store#derived\n * @template {import('./private.js').Stores} S\n * @template T\n * @overload\n * @param {S} stores - input stores\n * @param {(values: import('./private.js').StoresValues<S>, set: (value: T) => void, update: (fn: import('./public.js').Updater<T>) => void) => import('./public.js').Unsubscriber | void} fn - function callback that aggregates the values\n * @param {T} [initial_value] - initial value\n * @returns {import('./public.js').Readable<T>}\n */\n\n/**\n * Derived value store by synchronizing one or more readable stores and\n * applying an aggregation function over its input values.\n *\n * https://svelte.dev/docs/svelte-store#derived\n * @template {import('./private.js').Stores} S\n * @template T\n * @overload\n * @param {S} stores - input stores\n * @param {(values: import('./private.js').StoresValues<S>) => T} fn - function callback that aggregates the values\n * @param {T} [initial_value] - initial value\n * @returns {import('./public.js').Readable<T>}\n */\n\n/**\n * @template {import('./private.js').Stores} S\n * @template T\n * @param {S} stores\n * @param {Function} fn\n * @param {T} [initial_value]\n * @returns {import('./public.js').Readable<T>}\n */\nexport function derived(stores, fn, initial_value) {\n\tconst single = !Array.isArray(stores);\n\t/** @type {Array<import('./public.js').Readable<any>>} */\n\tconst stores_array = single ? [stores] : stores;\n\tif (!stores_array.every(Boolean)) {\n\t\tthrow new Error('derived() expects stores as input, got a falsy value');\n\t}\n\tconst auto = fn.length < 2;\n\treturn readable(initial_value, (set, update) => {\n\t\tlet started = false;\n\t\tconst values = [];\n\t\tlet pending = 0;\n\t\tlet cleanup = noop;\n\t\tconst sync = () => {\n\t\t\tif (pending) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcleanup();\n\t\t\tconst result = fn(single ? values[0] : values, set, update);\n\t\t\tif (auto) {\n\t\t\t\tset(result);\n\t\t\t} else {\n\t\t\t\tcleanup = is_function(result) ? result : noop;\n\t\t\t}\n\t\t};\n\t\tconst unsubscribers = stores_array.map((store, i) =>\n\t\t\tsubscribe(\n\t\t\t\tstore,\n\t\t\t\t(value) => {\n\t\t\t\t\tvalues[i] = value;\n\t\t\t\t\tpending &= ~(1 << i);\n\t\t\t\t\tif (started) {\n\t\t\t\t\t\tsync();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tpending |= 1 << i;\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tstarted = true;\n\t\tsync();\n\t\treturn function stop() {\n\t\t\trun_all(unsubscribers);\n\t\t\tcleanup();\n\t\t\t// We need to set this to false because callbacks can still happen despite having unsubscribed:\n\t\t\t// Callbacks might already be placed in the queue which doesn't know it should no longer\n\t\t\t// invoke this derived store.\n\t\t\tstarted = false;\n\t\t};\n\t});\n}\n\n/**\n * Takes a store and returns a new one derived from the old one that is readable.\n *\n * https://svelte.dev/docs/svelte-store#readonly\n * @template T\n * @param {import('./public.js').Readable<T>} store  - store to make readonly\n * @returns {import('./public.js').Readable<T>}\n */\nexport function readonly(store) {\n\treturn {\n\t\tsubscribe: store.subscribe.bind(store)\n\t};\n}\n\nexport { get_store_value as get };\n","import { writable } from 'svelte/store';\n\n/**\n * Provides the internal context to all application shells.\n */\nexport class AppShellContextInternal\n{\n   /** @type {InternalAppStores} */\n   #stores;\n\n   constructor()\n   {\n      this.#stores = {\n         elementContent: writable(void 0),\n         elementRoot: writable(void 0)\n      };\n\n      Object.freeze(this.#stores);\n      Object.seal(this);\n   }\n\n   /**\n    * @returns {InternalAppStores} The internal context stores for elementContent / elementRoot\n    */\n   get stores()\n   {\n      return this.#stores;\n   }\n}\n\n/**\n * @typedef {object} InternalAppStores\n *\n * @property {import('svelte/store').Writable<HTMLElement>} elementContent The window content element.\n *\n * @property {import('svelte/store').Writable<HTMLElement>} elementRoot The window root element.\n */\n","import { isObject } from '@typhonjs-fvtt/runtime/util/object';\nimport { group_outros, transition_out, check_outros } from 'svelte/internal';\n\n/**\n * Provides basic duck typing to determine if the provided object is a HMR ProxyComponent instance or class.\n *\n * @param {*}  comp - Data to check as a HMR proxy component.\n *\n * @returns {boolean} Whether basic duck typing succeeds.\n */\nfunction isHMRProxy(comp)\n{\n   const instanceName = comp?.constructor?.name;\n   if (typeof instanceName === 'string' && (instanceName.startsWith('Proxy<') || instanceName === 'ProxyComponent'))\n   {\n      return true;\n   }\n\n   const prototypeName = comp?.prototype?.constructor?.name;\n   return typeof prototypeName === 'string' && (prototypeName.startsWith('Proxy<') ||\n    prototypeName === 'ProxyComponent');\n}\n\n/**\n * Provides basic duck typing to determine if the provided function is a constructor function for a Svelte component.\n *\n * @param {*}  comp - Data to check as a Svelte component.\n *\n * @returns {boolean} Whether basic duck typing succeeds.\n */\nfunction isSvelteComponent(comp)\n{\n   if (comp === null || comp === void 0 || typeof comp !== 'function') { return false; }\n\n   // When using Vite in a developer build the SvelteComponent is wrapped in a ProxyComponent class.\n   // This class doesn't define methods on the prototype, so we must check if the constructor name\n   // starts with `Proxy<` as it provides the wrapped component as `Proxy<_wrapped component name_>`.\n   const prototypeName = comp?.prototype?.constructor?.name;\n   if (typeof prototypeName === 'string' && (prototypeName.startsWith('Proxy<') || prototypeName === 'ProxyComponent'))\n   {\n      return true;\n   }\n\n   return typeof window !== 'undefined' ?\n    typeof comp.prototype.$destroy === 'function' && typeof comp.prototype.$on === 'function' : // client-side\n     typeof comp.render === 'function'; // server-side\n}\n\n/**\n * Validates `config` argument whether it is a valid {@link TJSSvelteConfig}.\n *\n * @param {*}  config - The potential config object to validate.\n *\n * @param {boolean}  [raiseException=false] - If validation fails raise an exception.\n *\n * @returns {boolean} Is the config a valid TJSSvelteConfig.\n *\n * @throws {TypeError}  Any validation error when `raiseException` is enabled.\n */\nfunction isTJSSvelteConfig(config, raiseException = false)\n{\n   if (!isObject(config))\n   {\n      if (raiseException) { throw new TypeError(`isTJSSvelteConfig error: 'config' is not an object.`); }\n      return false;\n   }\n\n   if (!isSvelteComponent(config.class))\n   {\n      if (raiseException)\n      {\n         throw new TypeError(`isTJSSvelteConfig error: 'config.class' is not a Svelte component constructor.`);\n      }\n      return false;\n   }\n\n   return true;\n}\n\n/* eslint-disable */  // jsdoc/valid-types doesn't like the Google closure constructor function. TODO: verify in future eslint-plugin-jsdoc version\n/**\n * @typedef {object} TJSSvelteConfig Defines the TRL / client side configuration object to load a Svelte component.\n *\n * @property {({\n *    new(options: import('svelte').ComponentConstructorOptions):\n *     import('svelte').SvelteComponent | import('svelte').SvelteComponentTyped\n * })} class The Svelte component class / constructor function.\n *\n * @property {HTMLElement | ShadowRoot}   [target=document.body] A {@link HTMLElement} or {@link ShadowRoot} to\n * render to. By default, `document.body` is used as the target if not otherwise defined.\n *\n * @property {HTMLElement} [anchor] A child of `target` to render the component immediately before.\n *\n * @property {() => Record<string, *> | Record<string, *>} [props] Props to pass to the component.\n *\n * @property {() => (Record<string, *> | Map<string, *>) | Map<string, *> | Record<string, *>} [context] The root-level\n * context to pass to the component.\n *\n * @property {boolean}  [hydrate] See description in main Svelte docs\n * {@link https://svelte.dev/docs/client-side-component-api#creating-a-component | Creating a component.}\n *\n * @property {boolean} [intro] If true, will play transitions on initial render, rather than waiting for subsequent\n * state changes.\n*/\n/* eslint-enable */\n\n/**\n * Runs outro transition then destroys Svelte component.\n *\n * Workaround for https://github.com/sveltejs/svelte/issues/4056\n *\n * @param {*}  instance - A Svelte component.\n */\nasync function outroAndDestroy(instance)\n{\n   return new Promise((resolve) =>\n   {\n      if (instance.$$.fragment && instance.$$.fragment.o)\n      {\n         group_outros();\n         transition_out(instance.$$.fragment, 0, 0, () =>\n         {\n            instance.$destroy();\n            resolve();\n         });\n         check_outros();\n      }\n      else\n      {\n         instance.$destroy();\n         resolve();\n      }\n   });\n}\n\n/**\n * Parses a TyphonJS Svelte config object ensuring that classes specified are Svelte components and props are set\n * correctly.\n *\n * @param {object}   config - Svelte config object.\n *\n * @param {*}        [thisArg] - `This` reference to set for invoking any props function.\n *\n * @returns {object} The processed Svelte config object.\n */\nfunction parseTJSSvelteConfig(config, thisArg = void 0)\n{\n   if (!isObject(config))\n   {\n      throw new TypeError(`parseSvelteConfig - 'config' is not an object:\\n${JSON.stringify(config)}.`);\n   }\n\n   if (!isSvelteComponent(config.class))\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'class' is not a Svelte component constructor for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   if (config.hydrate !== void 0 && typeof config.hydrate !== 'boolean')\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'hydrate' is not a boolean for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   if (config.intro !== void 0 && typeof config.intro !== 'boolean')\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'intro' is not a boolean for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   if (config.target !== void 0 && typeof config.target !== 'string' && !(config.target instanceof HTMLElement) &&\n    !(config.target instanceof ShadowRoot) && !(config.target instanceof DocumentFragment))\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'target' is not a string, HTMLElement, ShadowRoot, or DocumentFragment for config:\\n${\n        JSON.stringify(config)}.`);\n   }\n\n   if (config.anchor !== void 0 && typeof config.anchor !== 'string' && !(config.anchor instanceof HTMLElement) &&\n    !(config.anchor instanceof ShadowRoot) && !(config.anchor instanceof DocumentFragment))\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'anchor' is not a string, HTMLElement, ShadowRoot, or DocumentFragment for config:\\n${\n        JSON.stringify(config)}.`);\n   }\n\n   if (config.context !== void 0 && typeof config.context !== 'function' && !(config.context instanceof Map) &&\n    !isObject(config.context))\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'context' is not a Map, function or object for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   // Validate extra TyphonJS options --------------------------------------------------------------------------------\n\n   // `selectorTarget` optionally stores a target element found in main element.\n   if (config.selectorTarget !== void 0 && typeof config.selectorTarget !== 'string')\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'selectorTarget' is not a string for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   // `options` stores `injectApp`, `injectEventbus`, and `selectorElement`.\n   if (config.options !== void 0 && !isObject(config.options))\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'options' is not an object for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   // Validate TyphonJS standard options.\n   if (config.options !== void 0)\n   {\n      if (config.options.injectApp !== void 0 && typeof config.options.injectApp !== 'boolean')\n      {\n         throw new TypeError(\n          `parseSvelteConfig - 'options.injectApp' is not a boolean for config:\\n${JSON.stringify(config)}.`);\n      }\n\n      if (config.options.injectEventbus !== void 0 && typeof config.options.injectEventbus !== 'boolean')\n      {\n         throw new TypeError(\n          `parseSvelteConfig - 'options.injectEventbus' is not a boolean for config:\\n${JSON.stringify(config)}.`);\n      }\n\n      // `selectorElement` optionally stores a main element selector to be found in a HTMLElement target.\n      if (config.options.selectorElement !== void 0 && typeof config.options.selectorElement !== 'string')\n      {\n         throw new TypeError(\n          `parseSvelteConfig - 'selectorElement' is not a string for config:\\n${JSON.stringify(config)}.`);\n      }\n   }\n\n   const svelteConfig = { ...config };\n\n   // Delete extra Svelte options.\n   delete svelteConfig.options;\n\n   let externalContext = {};\n\n   // If a context callback function is provided then invoke it with `this` being the Foundry app.\n   // If an object is returned it adds the entries to external context.\n   if (typeof svelteConfig.context === 'function')\n   {\n      const contextFunc = svelteConfig.context;\n      delete svelteConfig.context;\n\n      const result = contextFunc.call(thisArg);\n      if (isObject(result))\n      {\n         externalContext = { ...result };\n      }\n      else\n      {\n         throw new Error(`parseSvelteConfig - 'context' is a function that did not return an object for config:\\n${\n          JSON.stringify(config)}`);\n      }\n   }\n   else if (svelteConfig.context instanceof Map)\n   {\n      externalContext = Object.fromEntries(svelteConfig.context);\n      delete svelteConfig.context;\n   }\n   else if (isObject(svelteConfig.context))\n   {\n      externalContext = svelteConfig.context;\n      delete svelteConfig.context;\n   }\n\n   // If a props is a function then invoke it with `this` being the Foundry app.\n   // If an object is returned set it as the props.\n   svelteConfig.props = s_PROCESS_PROPS(svelteConfig.props, thisArg, config);\n\n   // Process children components attaching to external context.\n   if (Array.isArray(svelteConfig.children))\n   {\n      const children = [];\n\n      for (let cntr = 0; cntr < svelteConfig.children.length; cntr++)\n      {\n         const child = svelteConfig.children[cntr];\n\n         if (!isSvelteComponent(child.class))\n         {\n            throw new Error(`parseSvelteConfig - 'class' is not a Svelte component for child[${cntr}] for config:\\n${\n             JSON.stringify(config)}`);\n         }\n\n         child.props = s_PROCESS_PROPS(child.props, thisArg, config);\n\n         children.push(child);\n      }\n\n      if (children.length > 0)\n      {\n         externalContext.children = children;\n      }\n\n      delete svelteConfig.children;\n   }\n   else if (isObject(svelteConfig.children))\n   {\n      if (!isSvelteComponent(svelteConfig.children.class))\n      {\n         throw new Error(`parseSvelteConfig - 'class' is not a Svelte component for children object for config:\\n${\n          JSON.stringify(config)}`);\n      }\n\n      svelteConfig.children.props = s_PROCESS_PROPS(svelteConfig.children.props, thisArg, config);\n\n      externalContext.children = [svelteConfig.children];\n      delete svelteConfig.children;\n   }\n\n   if (!(svelteConfig.context instanceof Map))\n   {\n      svelteConfig.context = new Map();\n   }\n\n   svelteConfig.context.set('#external', externalContext);\n\n   return svelteConfig;\n}\n\n/**\n * Processes Svelte props. Potentially props can be a function to invoke with `thisArg`.\n *\n * @param {object|Function}   props - Svelte props.\n *\n * @param {*}                 thisArg - `This` reference to set for invoking any props function.\n *\n * @param {object}            config - Svelte config\n *\n * @returns {object|void}     Svelte props.\n */\nfunction s_PROCESS_PROPS(props, thisArg, config)\n{\n   // If a props is a function then invoke it with `this` being the Foundry app.\n   // If an object is returned set it as the props.\n   if (typeof props === 'function')\n   {\n      const result = props.call(thisArg);\n      if (isObject(result))\n      {\n         return result;\n      }\n      else\n      {\n         throw new Error(`parseSvelteConfig - 'props' is a function that did not return an object for config:\\n${\n          JSON.stringify(config)}`);\n      }\n   }\n   else if (isObject(props))\n   {\n      return props;\n   }\n   else if (props !== void 0)\n   {\n      throw new Error(\n       `parseSvelteConfig - 'props' is not a function or an object for config:\\n${JSON.stringify(config)}`);\n   }\n\n   return {};\n}\n\nexport { isHMRProxy, isSvelteComponent, isTJSSvelteConfig, outroAndDestroy, parseTJSSvelteConfig };\n//# sourceMappingURL=index.js.map\n","import { isObject } from '@typhonjs-fvtt/runtime/util/object';\n\n/**\n * A helper to create a set of radio checkbox input elements in a named set.\n * The provided keys are the possible radio values while the provided values are human readable labels.\n *\n * @param {string} name         The radio checkbox field name\n *\n * @param {object} choices      A mapping of radio checkbox values to human readable labels\n *\n * @param {object} options      Options which customize the radio boxes creation\n *\n * @param {string} options.checked    Which key is currently checked?\n *\n * @param {boolean} options.localize  Pass each label through string localization?\n *\n * @returns {string} HTML for radio boxes.\n *\n * @example <caption>The provided input data</caption>\n * let groupName = \"importantChoice\";\n * let choices = {a: \"Choice A\", b: \"Choice B\"};\n * let chosen = \"a\";\n *\n * @example <caption>The template HTML structure</caption>\n * <div class=\"form-group\">\n *   <label>Radio Group Label</label>\n *   <div class=\"form-fields\">\n *     {@html radioBoxes(groupName, choices, { checked: chosen, localize: true})}\n *   </div>\n * </div>\n */\nfunction radioBoxes(name, choices, options)\n{\n   const checked = options['checked'] || null;\n\n   const localize = options['localize'] || false;\n\n   let html = '';\n\n   for (let [key, label] of Object.entries(choices)) // eslint-disable-line prefer-const\n   {\n      if (localize) { label = globalThis.game.i18n.localize(label); }\n      const isChecked = checked === key;\n      html += `<label class=\"checkbox\"><input type=\"radio\" name=\"${name}\" value=\"${key}\" ${isChecked ? \"checked\" : \"\"}> ${label}</label>`;\n   }\n\n   return new globalThis.Handlebars.SafeString(html);\n}\n\n/**\n * Converts the `selectOptions` Handlebars helper to be Svelte compatible. This is useful when initially converting\n * over an app to Svelte and for essential usage to several dialogs that mirror the core Foundry experience. For\n * an example of usage see {@link TJSDocumentOwnership}.\n *\n * A helper to create a set of <option> elements in a <select> block based on a provided dictionary.\n * The provided keys are the option values while the provided values are human-readable labels.\n * This helper supports both single-select and multi-select input fields.\n *\n * @param {object} choices                     A mapping of radio checkbox values to human-readable labels\n *\n * @param {object} options                     Helper options\n *\n * @param {string|string[]} [options.selected] Which key or array of keys that are currently selected?\n *\n * @param {boolean} [options.localize=false]   Pass each label through string localization?\n *\n * @param {string} [options.blank]             Add a blank option as the first option with this label\n *\n * @param {string} [options.nameAttr]          Look up a property in the choice object values to use as the option value\n *\n * @param {string} [options.labelAttr]         Look up a property in the choice object values to use as the option label\n *\n * @param {boolean} [options.inverted=false]   Use the choice object value as the option value, and the key as the label\n *                                             instead of vice-versa\n *\n * @param {boolean} [options.sort=false]       When true sort by label name.\n *\n * @returns {string} The <options> HTML element(s).\n *\n * @example <caption>The provided input data</caption>\n * let choices = {a: 'Choice A', b: 'Choice B'};\n * let value = 'a';\n *\n * @example <caption>The template HTML structure</caption>\n * <select name=\"importantChoice\">\n *   {@html selectOptions(choices { selected: value, localize: true })}\n * </select>\n *\n * @example <caption>The resulting HTML</caption>\n * <select name=\"importantChoice\">\n *   <option value=\"a\" selected>Choice A</option>\n *   <option value=\"b\">Choice B</option>\n * </select>\n *\n * @example <caption>Using inverted</caption>\n * let choices = {'Choice A': 'a', 'Choice B': 'b'};\n * let value = 'a';\n *\n * @example <caption>The template HTML structure</caption>\n * <select name=\"importantChoice\">\n *   {@html selectOptions(choices, { selected: value, inverted: true })}\n * </select>\n *\n * @example <caption>Using nameAttr and labelAttr with objects</caption>\n * let choices = {foo: {key: 'a', label: 'Choice A'}, bar: {key: 'b', label: 'Choice B'}};\n * let value = 'b';\n *\n * @example <caption>The template HTML structure</caption>\n * <select name=\"importantChoice\">\n *   {@html selectOptions(choices, { selected: value, nameAttr: 'key', labelAttr: 'label' })}\n * </select>\n *\n * @example <caption>Using nameAttr and labelAttr with arrays</caption>\n * let choices = [{key: 'a', label: 'Choice A'}, {key: 'b', label: 'Choice B'}];\n * let value = 'b';\n *\n * @example <caption>The template HTML structure</caption>\n * <select name=\"importantChoice\">\n *   {@html selectOptions(choices, { selected: value, nameAttr: 'key', labelAttr: 'label' })}\n * </select>\n */\nfunction selectOptions(choices, options)\n{\n   const { localize = false, blank = null, sort = false, nameAttr, labelAttr, inverted } = options;\n   let { selected = null } = options;\n\n   selected = selected instanceof Array ? selected.map(String) : [String(selected)];\n\n   // Prepare the choices as an array of objects\n   const selectChoices = [];\n\n   if (choices instanceof Array)\n   {\n      for (const choice of choices)\n      {\n         const name = String(choice[nameAttr]);\n         let label = choice[labelAttr];\n         if (localize) { label = globalThis.game.i18n.localize(label); }\n         selectChoices.push({ name, label });\n      }\n   }\n   else\n   {\n      for (const choice of Object.entries(choices))\n      {\n         const [key, value] = inverted ? choice.reverse() : choice;\n         const name = String(nameAttr ? value[nameAttr] : key);\n         let label = labelAttr ? value[labelAttr] : value;\n         if (localize) { label = globalThis.game.i18n.localize(label); }\n         selectChoices.push({ name, label });\n      }\n   }\n\n   // Sort the array of options\n   if (sort) { selectChoices.sort((a, b) => a.label.localeCompare(b.label)); }\n\n   // Prepend a blank option\n   if (blank !== null)\n   {\n      const label = localize ? globalThis.game.i18n.localize(blank) : blank;\n      selectChoices.unshift({ name: '', label });\n   }\n\n   // Create the HTML\n   let html = '';\n   for (const option of selectChoices)\n   {\n      const label = globalThis.Handlebars.escapeExpression(option.label);\n      const isSelected = selected.includes(option.name);\n      html += `<option value=\"${option.name}\" ${isSelected ? \"selected\" : \"\"}>${label}</option>`;\n   }\n\n   return new globalThis.Handlebars.SafeString(html);\n}\n\n/**\n * Localize a string including variable formatting for input arguments. Provide a string ID which defines the localized\n * template. Variables can be included in the template enclosed in braces and will be substituted using those named\n * keys.\n *\n * @param {string}   stringId - The string ID to translate.\n *\n * @param {object}   [data] - Provided input data.\n *\n * @returns {string} The translated and formatted string\n */\nfunction localize(stringId, data)\n{\n   const result = !isObject(data) ? globalThis.game.i18n.localize(stringId) :\n    globalThis.game.i18n.format(stringId, data);\n\n   return result !== void 0 ? result : '';\n}\n\nexport { localize, radioBoxes, selectOptions };\n//# sourceMappingURL=index.js.map\n","import { derived, get } from 'svelte/store';\n\n/**\n * @external Store\n * @see [Svelte stores](https://svelte.dev/docs#component-format-script-4-prefix-stores-with-$-to-access-their-values-store-contract)\n */\n\n/**\n * Create a store similar to [Svelte's `derived`](https://svelte.dev/docs#run-time-svelte-store-writable),\n * but which has its own `set` and `update` methods and can send values back to the origin stores.\n * [Read more...](https://github.com/PixievoltNo1/svelte-writable-derived#default-export-writablederived)\n * \n * @param {Store|Store[]} origins One or more stores to derive from. Same as\n * [`derived`](https://svelte.dev/docs#run-time-svelte-store-writable)'s 1st parameter.\n * @param {!Function} derive The callback to determine the derived value. Same as\n * [`derived`](https://svelte.dev/docs#run-time-svelte-store-writable)'s 2nd parameter.\n * @param {!Function} reflect Called when the derived store gets a new value via its `set` or\n * `update` methods, and determines new values for the origin stores.\n * [Read more...](https://github.com/PixievoltNo1/svelte-writable-derived#new-parameter-reflect)\n * @param [initial] The new store's initial value. Same as\n * [`derived`](https://svelte.dev/docs#run-time-svelte-store-writable)'s 3rd parameter.\n * \n * @returns {Store} A writable store.\n */\nfunction writableDerived(origins, derive, reflect, initial) {\n\tvar childDerivedSetter, originValues, blockNextDerive = false;\n\tvar reflectOldValues = reflect.length >= 2;\n\tvar wrappedDerive = (got, set, update) => {\n\t\tchildDerivedSetter = set;\n\t\tif (reflectOldValues) {\n\t\t\toriginValues = got;\n\t\t}\n\t\tif (!blockNextDerive) {\n\t\t\tlet returned = derive(got, set, update);\n\t\t\tif (derive.length < 2) {\n\t\t\t\tset(returned);\n\t\t\t} else {\n\t\t\t\treturn returned;\n\t\t\t}\n\t\t}\n\t\tblockNextDerive = false;\n\t};\n\tvar childDerived = derived(origins, wrappedDerive, initial);\n\t\n\tvar singleOrigin = !Array.isArray(origins);\n\tfunction doReflect(reflecting) {\n\t\tvar setWith = reflect(reflecting, originValues);\n\t\tif (singleOrigin) {\n\t\t\tblockNextDerive = true;\n\t\t\torigins.set(setWith);\n\t\t} else {\n\t\t\tsetWith.forEach( (value, i) => {\n\t\t\t\tblockNextDerive = true;\n\t\t\t\torigins[i].set(value);\n\t\t\t} );\n\t\t}\n\t\tblockNextDerive = false;\n\t}\n\t\n\tvar tryingSet = false;\n\tfunction update(fn) {\n\t\tvar isUpdated, mutatedBySubscriptions, oldValue, newValue;\n\t\tif (tryingSet) {\n\t\t\tnewValue = fn( get(childDerived) );\n\t\t\tchildDerivedSetter(newValue);\n\t\t\treturn;\n\t\t}\n\t\tvar unsubscribe = childDerived.subscribe( (value) => {\n\t\t\tif (!tryingSet) {\n\t\t\t\toldValue = value;\n\t\t\t} else if (!isUpdated) {\n\t\t\t\tisUpdated = true;\n\t\t\t} else {\n\t\t\t\tmutatedBySubscriptions = true;\n\t\t\t}\n\t\t} );\n\t\tnewValue = fn(oldValue);\n\t\ttryingSet = true;\n\t\tchildDerivedSetter(newValue);\n\t\tunsubscribe();\n\t\ttryingSet = false;\n\t\tif (mutatedBySubscriptions) {\n\t\t\tnewValue = get(childDerived);\n\t\t}\n\t\tif (isUpdated) {\n\t\t\tdoReflect(newValue);\n\t\t}\n\t}\n\treturn {\n\t\tsubscribe: childDerived.subscribe,\n\t\tset(value) { update( () => value ); },\n\t\tupdate,\n\t};\n}\n\n/**\n * Create a store for a property value in an object contained in another store.\n * [Read more...](https://github.com/PixievoltNo1/svelte-writable-derived#named-export-propertystore)\n * \n * @param {Store} origin The store containing the object to get/set from.\n * @param {string|number|symbol|Array<string|number|symbol>} propName The property to get/set, or a path of\n * properties in nested objects.\n *\n * @returns {Store} A writable store.\n */\nfunction propertyStore(origin, propName) {\n\tif (!Array.isArray(propName)) {\n\t\treturn writableDerived(\n\t\t\torigin,\n\t\t\t(object) => object[propName],\n\t\t\t(reflecting, object) => {\n\t\t\t\tobject[propName] = reflecting;\n\t\t\t\treturn object;\n\t\t\t},\n\t\t);\n\t} else {\n\t\tlet props = propName.concat();\n\t\treturn writableDerived(\n\t\t\torigin,\n\t\t\t(value) => {\n\t\t\t\tfor (let i = 0; i < props.length; ++i) {\n\t\t\t\t\tvalue = value[ props[i] ];\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\t(reflecting, object) => {\n\t\t\t\tlet target = object;\n\t\t\t\tfor (let i = 0; i < props.length - 1; ++i) {\n\t\t\t\t\ttarget = target[ props[i] ];\n\t\t\t\t}\n\t\t\t\ttarget[ props[props.length - 1] ] = reflecting;\n\t\t\t\treturn object;\n\t\t\t},\n\t\t);\n\t}\n}\n\nexport { propertyStore, writableDerived };\n//# sourceMappingURL=index.js.map\n","const EPSILON = 0.000001;\n\nconst IDENTITY_2X2 = new Float32Array([\n    1, 0,\n    0, 1\n]);\n/**\n * A 2x2 Matrix\n */\nclass Mat2 extends Float32Array {\n    /**\n     * The number of bytes in a {@link Mat2}.\n     */\n    static BYTE_LENGTH = 4 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Mat2}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 4:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 4);\n                break;\n            case 1:\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([\n                        v, v,\n                        v, v\n                    ]);\n                }\n                else {\n                    super(v, 0, 4);\n                }\n                break;\n            default:\n                super(IDENTITY_2X2);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    /**\n     * A string representation of `this`\n     * Equivalent to `Mat2.str(this);`\n     */\n    get str() {\n        return Mat2.str(this);\n    }\n    //===================\n    // Instance methods\n    //===================\n    /**\n     * Copy the values from another {@link Mat2} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        this.set(a);\n        return this;\n    }\n    /**\n     * Set `this` to the identity matrix\n     * Equivalent to Mat2.identity(this)\n     *\n     * @returns `this`\n     */\n    identity() {\n        this.set(IDENTITY_2X2);\n        return this;\n    }\n    /**\n     * Multiplies this {@link Mat2} against another one\n     * Equivalent to `Mat2.multiply(this, this, b);`\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `this`\n     */\n    multiply(b) {\n        return Mat2.multiply(this, this, b);\n    }\n    /**\n     * Alias for {@link Mat2.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Transpose this {@link Mat2}\n     * Equivalent to `Mat2.transpose(this, this);`\n     *\n     * @returns `this`\n     */\n    transpose() {\n        return Mat2.transpose(this, this);\n    }\n    /**\n     * Inverts this {@link Mat2}\n     * Equivalent to `Mat4.invert(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        return Mat2.invert(this, this);\n    }\n    /**\n     * Scales this {@link Mat2} by the dimensions in the given vec3 not using vectorization\n     * Equivalent to `Mat2.scale(this, this, v);`\n     *\n     * @param v - The {@link Vec2} to scale the matrix by\n     * @returns `this`\n     */\n    scale(v) {\n        return Mat2.scale(this, this, v);\n    }\n    /**\n     * Rotates this {@link Mat2} by the given angle around the given axis\n     * Equivalent to `Mat2.rotate(this, this, rad);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    rotate(rad) {\n        return Mat2.rotate(this, this, rad);\n    }\n    //================\n    // Static methods\n    //================\n    /**\n     * Creates a new, identity {@link Mat2}\n     * @category Static\n     *\n     * @returns A new {@link Mat2}\n     */\n    static create() {\n        return new Mat2();\n    }\n    /**\n     * Creates a new {@link Mat2} initialized with values from an existing matrix\n     * @category Static\n     *\n     * @param a - Matrix to clone\n     * @returns A new {@link Mat2}\n     */\n    static clone(a) {\n        return new Mat2(a);\n    }\n    /**\n     * Copy the values from one {@link Mat2} to another\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - Matrix to copy\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        return out;\n    }\n    /**\n     * Create a new {@link Mat2} with the given values\n     * @category Static\n     *\n     * @param values - Matrix components\n     * @returns A new {@link Mat2}\n     */\n    static fromValues(...values) {\n        return new Mat2(...values);\n    }\n    /**\n     * Set the components of a {@link Mat2} to the given values\n     * @category Static\n     *\n     * @param out - The receiving matrix\n     * @param values - Matrix components\n     * @returns `out`\n     */\n    static set(out, ...values) {\n        out[0] = values[0];\n        out[1] = values[1];\n        out[2] = values[2];\n        out[3] = values[3];\n        return out;\n    }\n    /**\n     * Set a {@link Mat2} to the identity matrix\n     * @category Static\n     *\n     * @param out - The receiving matrix\n     * @returns `out`\n     */\n    static identity(out) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 1;\n        return out;\n    }\n    /**\n     * Transpose the values of a {@link Mat2}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static transpose(out, a) {\n        // If we are transposing ourselves we can skip a few steps but have to cache\n        // some values\n        if (out === a) {\n            let a1 = a[1];\n            out[1] = a[2];\n            out[2] = a1;\n        }\n        else {\n            out[0] = a[0];\n            out[1] = a[2];\n            out[2] = a[1];\n            out[3] = a[3];\n        }\n        return out;\n    }\n    /**\n     * Inverts a {@link Mat2}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static invert(out, a) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        // Calculate the determinant\n        let det = a0 * a3 - a2 * a1;\n        if (!det) {\n            return null;\n        }\n        det = 1.0 / det;\n        out[0] = a3 * det;\n        out[1] = -a1 * det;\n        out[2] = -a2 * det;\n        out[3] = a0 * det;\n        return out;\n    }\n    /**\n     * Calculates the adjugate of a {@link Mat2}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static adjoint(out, a) {\n        // Caching this value is necessary if out == a\n        const a0 = a[0];\n        out[0] = a[3];\n        out[1] = -a[1];\n        out[2] = -a[2];\n        out[3] = a0;\n        return out;\n    }\n    /**\n     * Calculates the determinant of a {@link Mat2}\n     * @category Static\n     *\n     * @param a - the source matrix\n     * @returns determinant of a\n     */\n    static determinant(a) {\n        return a[0] * a[3] - a[2] * a[1];\n    }\n    /**\n     * Adds two {@link Mat2}'s\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        out[3] = a[3] + b[3];\n        return out;\n    }\n    /**\n     * Subtracts matrix b from matrix a\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        out[2] = a[2] - b[2];\n        out[3] = a[3] - b[3];\n        return out;\n    }\n    /**\n     * Alias for {@link Mat2.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return out; }\n    /**\n     * Multiplies two {@link Mat2}s\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        out[0] = a0 * b0 + a2 * b1;\n        out[1] = a1 * b0 + a3 * b1;\n        out[2] = a0 * b2 + a2 * b3;\n        out[3] = a1 * b2 + a3 * b3;\n        return out;\n    }\n    /**\n     * Alias for {@link Mat2.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Rotates a {@link Mat2} by the given angle\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static rotate(out, a, rad) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        out[0] = a0 * c + a2 * s;\n        out[1] = a1 * c + a3 * s;\n        out[2] = a0 * -s + a2 * c;\n        out[3] = a1 * -s + a3 * c;\n        return out;\n    }\n    /**\n     * Scales the {@link Mat2} by the dimensions in the given {@link Vec2}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param v - the {@link Vec2} to scale the matrix by\n     * @returns `out`\n     **/\n    static scale(out, a, v) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const v0 = v[0];\n        const v1 = v[1];\n        out[0] = a0 * v0;\n        out[1] = a1 * v0;\n        out[2] = a2 * v1;\n        out[3] = a3 * v1;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat2} from a given angle around a given axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat2.identity(dest);\n     *     mat2.rotate(dest, dest, rad);\n     * @category Static\n     *\n     * @param out - {@link Mat2} receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static fromRotation(out, rad) {\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        out[0] = c;\n        out[1] = s;\n        out[2] = -s;\n        out[3] = c;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat2} from a vector scaling\n     * This is equivalent to (but much faster than):\n     *\n     *     mat2.identity(dest);\n     *     mat2.scale(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat2} receiving operation result\n     * @param v - Scaling vector\n     * @returns `out`\n     */\n    static fromScaling(out, v) {\n        out[0] = v[0];\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = v[1];\n        return out;\n    }\n    /**\n     * Returns Frobenius norm of a {@link Mat2}\n     * @category Static\n     *\n     * @param a - the matrix to calculate Frobenius norm of\n     * @returns Frobenius norm\n     */\n    static frob(a) {\n        return Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2] + a[3] * a[3]);\n    }\n    /**\n     * Multiply each element of a {@link Mat2} by a scalar.\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param b - amount to scale the matrix's elements by\n     * @returns `out`\n     */\n    static multiplyScalar(out, a, b) {\n        out[0] = a[0] * b;\n        out[1] = a[1] * b;\n        out[2] = a[2] * b;\n        out[3] = a[3] * b;\n        return out;\n    }\n    /**\n     * Adds two {@link Mat2}'s after multiplying each element of the second operand by a scalar value.\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param scale - the amount to scale b's elements by before adding\n     * @returns `out`\n     */\n    static multiplyScalarAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        out[2] = a[2] + b[2] * scale;\n        out[3] = a[3] + b[3] * scale;\n        return out;\n    }\n    /**\n     * Returns L, D and U matrices (Lower triangular, Diagonal and Upper triangular) by factorizing the input matrix\n     * @category Static\n     *\n     * @param L - the lower triangular matrix\n     * @param D - the diagonal matrix\n     * @param U - the upper triangular matrix\n     * @param a - the input matrix to factorize\n     */\n    static LDU(L, D, U, a) {\n        L[2] = a[2] / a[0];\n        U[0] = a[0];\n        U[1] = a[1];\n        U[3] = a[3] - L[2] * U[1];\n        return [L, D, U];\n    }\n    /**\n     * Returns whether or not two {@link Mat2}s have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return (a[0] === b[0] &&\n            a[1] === b[1] &&\n            a[2] === b[2] &&\n            a[3] === b[3]);\n    }\n    /**\n     * Returns whether or not two {@link Mat2}s have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= EPSILON * Math.max(1, Math.abs(a3), Math.abs(b3)));\n    }\n    /**\n     * Returns a string representation of a {@link Mat2}\n     * @category Static\n     *\n     * @param a - matrix to represent as a string\n     * @returns string representation of the matrix\n     */\n    static str(a) {\n        return `Mat2(${a.join(', ')})`;\n    }\n}\n// Instance method alias assignments\nMat2.prototype.mul = Mat2.prototype.multiply;\n// Static method alias assignments\nMat2.mul = Mat2.multiply;\nMat2.sub = Mat2.subtract;\n\nconst IDENTITY_2X3 = new Float32Array([\n    1, 0,\n    0, 1,\n    0, 0,\n]);\n/**\n * A 2x3 Matrix\n */\nclass Mat2d extends Float32Array {\n    /**\n     * The number of bytes in a {@link Mat2d}.\n     */\n    static BYTE_LENGTH = 6 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Mat2}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 6:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 6);\n                break;\n            case 1:\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([\n                        v, v,\n                        v, v,\n                        v, v\n                    ]);\n                }\n                else {\n                    super(v, 0, 6);\n                }\n                break;\n            default:\n                super(IDENTITY_2X3);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    /**\n     * A string representation of `this`\n     * Equivalent to `Mat2d.str(this);`\n     */\n    get str() {\n        return Mat2d.str(this);\n    }\n    //===================\n    // Instances methods\n    //===================\n    /**\n     * Copy the values from another {@link Mat2d} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        this.set(a);\n        return this;\n    }\n    /**\n     * Set `this` to the identity matrix\n     * Equivalent to Mat2d.identity(this)\n     *\n     * @returns `this`\n     */\n    identity() {\n        this.set(IDENTITY_2X3);\n        return this;\n    }\n    /**\n     * Multiplies this {@link Mat2d} against another one\n     * Equivalent to `Mat2d.multiply(this, this, b);`\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `this`\n     */\n    multiply(b) {\n        return Mat2d.multiply(this, this, b);\n    }\n    /**\n     * Alias for {@link Mat2d.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Translate this {@link Mat2d} by the given vector\n     * Equivalent to `Mat2d.translate(this, this, v);`\n     *\n     * @param v - The {@link Vec2} to translate by\n     * @returns `this`\n     */\n    translate(v) {\n        return Mat2d.translate(this, this, v);\n    }\n    /**\n     * Rotates this {@link Mat2d} by the given angle around the given axis\n     * Equivalent to `Mat2d.rotate(this, this, rad);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    rotate(rad) {\n        return Mat2d.rotate(this, this, rad);\n    }\n    /**\n     * Scales this {@link Mat2d} by the dimensions in the given vec3 not using vectorization\n     * Equivalent to `Mat2d.scale(this, this, v);`\n     *\n     * @param v - The {@link Vec2} to scale the matrix by\n     * @returns `this`\n     */\n    scale(v) {\n        return Mat2d.scale(this, this, v);\n    }\n    //================\n    // Static methods\n    //================\n    /**\n     * Creates a new, identity {@link Mat2d}\n     * @category Static\n     *\n     * @returns A new {@link Mat2d}\n     */\n    static create() {\n        return new Mat2d();\n    }\n    /**\n     * Creates a new {@link Mat2d} initialized with values from an existing matrix\n     * @category Static\n     *\n     * @param a - Matrix to clone\n     * @returns A new {@link Mat2d}\n     */\n    static clone(a) {\n        return new Mat2d(a);\n    }\n    /**\n     * Copy the values from one {@link Mat2d} to another\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - Matrix to copy\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        out[4] = a[4];\n        out[5] = a[5];\n        return out;\n    }\n    /**\n     * Create a new {@link Mat2d} with the given values\n     * @category Static\n     *\n     * @param values - Matrix components\n     * @returns A new {@link Mat2d}\n     */\n    static fromValues(...values) {\n        return new Mat2d(...values);\n    }\n    /**\n     * Set the components of a {@link Mat2d} to the given values\n     * @category Static\n     *\n     * @param out - The receiving matrix\n     * @param values - Matrix components\n     * @returns `out`\n     */\n    static set(out, ...values) {\n        out[0] = values[0];\n        out[1] = values[1];\n        out[2] = values[2];\n        out[3] = values[3];\n        out[4] = values[4];\n        out[5] = values[5];\n        return out;\n    }\n    /**\n     * Set a {@link Mat2d} to the identity matrix\n     * @category Static\n     *\n     * @param out - The receiving matrix\n     * @returns `out`\n     */\n    static identity(out) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 1;\n        out[4] = 0;\n        out[5] = 0;\n        return out;\n    }\n    /**\n     * Inverts a {@link Mat2d}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static invert(out, a) {\n        const aa = a[0];\n        const ab = a[1];\n        const ac = a[2];\n        const ad = a[3];\n        const atx = a[4];\n        const aty = a[5];\n        let det = aa * ad - ab * ac;\n        if (!det) {\n            return null;\n        }\n        det = 1.0 / det;\n        out[0] = ad * det;\n        out[1] = -ab * det;\n        out[2] = -ac * det;\n        out[3] = aa * det;\n        out[4] = (ac * aty - ad * atx) * det;\n        out[5] = (ab * atx - aa * aty) * det;\n        return out;\n    }\n    /**\n     * Calculates the determinant of a {@link Mat2d}\n     * @category Static\n     *\n     * @param a - the source matrix\n     * @returns determinant of a\n     */\n    static determinant(a) {\n        return a[0] * a[3] - a[1] * a[2];\n    }\n    /**\n     * Adds two {@link Mat2d}'s\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        out[3] = a[3] + b[3];\n        out[4] = a[4] + b[4];\n        out[5] = a[5] + b[5];\n        return out;\n    }\n    /**\n     * Subtracts matrix b from matrix a\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        out[2] = a[2] - b[2];\n        out[3] = a[3] - b[3];\n        out[4] = a[4] - b[4];\n        out[5] = a[5] - b[5];\n        return out;\n    }\n    /**\n     * Alias for {@link Mat2d.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return out; }\n    /**\n     * Multiplies two {@link Mat2d}s\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        const b4 = b[4];\n        const b5 = b[5];\n        out[0] = a0 * b0 + a2 * b1;\n        out[1] = a1 * b0 + a3 * b1;\n        out[2] = a0 * b2 + a2 * b3;\n        out[3] = a1 * b2 + a3 * b3;\n        out[4] = a0 * b4 + a2 * b5 + a4;\n        out[5] = a1 * b4 + a3 * b5 + a5;\n        return out;\n    }\n    /**\n     * Alias for {@link Mat2d.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Translate a {@link Mat2d} by the given vector\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to translate\n     * @param v - vector to translate by\n     * @returns `out`\n     */\n    static translate(out, a, v) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const v0 = v[0];\n        const v1 = v[1];\n        out[0] = a0;\n        out[1] = a1;\n        out[2] = a2;\n        out[3] = a3;\n        out[4] = a0 * v0 + a2 * v1 + a4;\n        out[5] = a1 * v0 + a3 * v1 + a5;\n        return out;\n    }\n    /**\n     * Rotates a {@link Mat2d} by the given angle\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static rotate(out, a, rad) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        out[0] = a0 * c + a2 * s;\n        out[1] = a1 * c + a3 * s;\n        out[2] = a0 * -s + a2 * c;\n        out[3] = a1 * -s + a3 * c;\n        out[4] = a4;\n        out[5] = a5;\n        return out;\n    }\n    /**\n     * Scales the {@link Mat2d} by the dimensions in the given {@link Vec2}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param v - the {@link Vec2} to scale the matrix by\n     * @returns `out`\n     **/\n    static scale(out, a, v) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const v0 = v[0];\n        const v1 = v[1];\n        out[0] = a0 * v0;\n        out[1] = a1 * v0;\n        out[2] = a2 * v1;\n        out[3] = a3 * v1;\n        out[4] = a4;\n        out[5] = a5;\n        return out;\n    }\n    // TODO: Got to fromRotation\n    /**\n     * Creates a {@link Mat2d} from a vector translation\n     * This is equivalent to (but much faster than):\n     *\n     *     Mat2d.identity(dest);\n     *     Mat2d.translate(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat2d} receiving operation result\n     * @param v - Translation vector\n     * @returns `out`\n     */\n    static fromTranslation(out, v) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 1;\n        out[4] = v[0];\n        out[5] = v[1];\n        return out;\n    }\n    /**\n     * Creates a {@link Mat2d} from a given angle around a given axis\n     * This is equivalent to (but much faster than):\n     *\n     *     Mat2d.identity(dest);\n     *     Mat2d.rotate(dest, dest, rad);\n     * @category Static\n     *\n     * @param out - {@link Mat2d} receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static fromRotation(out, rad) {\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        out[0] = c;\n        out[1] = s;\n        out[2] = -s;\n        out[3] = c;\n        out[4] = 0;\n        out[5] = 0;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat2d} from a vector scaling\n     * This is equivalent to (but much faster than):\n     *\n     *     Mat2d.identity(dest);\n     *     Mat2d.scale(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat2d} receiving operation result\n     * @param v - Scaling vector\n     * @returns `out`\n     */\n    static fromScaling(out, v) {\n        out[0] = v[0];\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = v[1];\n        out[4] = 0;\n        out[5] = 0;\n        return out;\n    }\n    /**\n     * Returns Frobenius norm of a {@link Mat2d}\n     * @category Static\n     *\n     * @param a - the matrix to calculate Frobenius norm of\n     * @returns Frobenius norm\n     */\n    static frob(a) {\n        return Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2] + a[3] * a[3] + a[4] * a[4] + a[5] * a[5] + 1);\n    }\n    /**\n     * Multiply each element of a {@link Mat2d} by a scalar.\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param b - amount to scale the matrix's elements by\n     * @returns `out`\n     */\n    static multiplyScalar(out, a, b) {\n        out[0] = a[0] * b;\n        out[1] = a[1] * b;\n        out[2] = a[2] * b;\n        out[3] = a[3] * b;\n        out[4] = a[4] * b;\n        out[5] = a[5] * b;\n        return out;\n    }\n    /**\n     * Adds two {@link Mat2d}'s after multiplying each element of the second operand by a scalar value.\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param scale - the amount to scale b's elements by before adding\n     * @returns `out`\n     */\n    static multiplyScalarAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        out[2] = a[2] + b[2] * scale;\n        out[3] = a[3] + b[3] * scale;\n        out[4] = a[4] + b[4] * scale;\n        out[5] = a[5] + b[5] * scale;\n        return out;\n    }\n    /**\n     * Returns whether or not two {@link Mat2d}s have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return (a[0] === b[0] &&\n            a[1] === b[1] &&\n            a[2] === b[2] &&\n            a[3] === b[3] &&\n            a[4] === b[4] &&\n            a[5] === b[5]);\n    }\n    /**\n     * Returns whether or not two {@link Mat2d}s have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        const b4 = b[4];\n        const b5 = b[5];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= EPSILON * Math.max(1, Math.abs(a3), Math.abs(b3)) &&\n            Math.abs(a4 - b4) <= EPSILON * Math.max(1, Math.abs(a4), Math.abs(b4)) &&\n            Math.abs(a5 - b5) <= EPSILON * Math.max(1, Math.abs(a5), Math.abs(b5)));\n    }\n    /**\n     * Returns a string representation of a {@link Mat2d}\n     * @category Static\n     *\n     * @param a - matrix to represent as a string\n     * @returns string representation of the matrix\n     */\n    static str(a) {\n        return `Mat2d(${a.join(', ')})`;\n    }\n}\n// Static method alias assignments\nMat2d.mul = Mat2d.multiply;\nMat2d.sub = Mat2d.subtract;\n\nconst IDENTITY_3X3 = new Float32Array([\n    1, 0, 0,\n    0, 1, 0,\n    0, 0, 1,\n]);\n/**\n * A 3x3 Matrix\n */\nclass Mat3 extends Float32Array {\n    /**\n     * The number of bytes in a {@link Mat3}.\n     */\n    static BYTE_LENGTH = 9 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Mat3}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 9:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 9);\n                break;\n            case 1:\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([\n                        v, v, v,\n                        v, v, v,\n                        v, v, v\n                    ]);\n                }\n                else {\n                    super(v, 0, 9);\n                }\n                break;\n            default:\n                super(IDENTITY_3X3);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    /**\n     * A string representation of `this`\n     * Equivalent to `Mat3.str(this);`\n     */\n    get str() {\n        return Mat3.str(this);\n    }\n    //===================\n    // Instance methods\n    //===================\n    /**\n     * Copy the values from another {@link Mat3} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        this.set(a);\n        return this;\n    }\n    /**\n     * Set `this` to the identity matrix\n     * Equivalent to Mat3.identity(this)\n     *\n     * @returns `this`\n     */\n    identity() {\n        this.set(IDENTITY_3X3);\n        return this;\n    }\n    /**\n     * Multiplies this {@link Mat3} against another one\n     * Equivalent to `Mat3.multiply(this, this, b);`\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `this`\n     */\n    multiply(b) {\n        return Mat3.multiply(this, this, b);\n    }\n    /**\n     * Alias for {@link Mat3.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Transpose this {@link Mat3}\n     * Equivalent to `Mat3.transpose(this, this);`\n     *\n     * @returns `this`\n     */\n    transpose() {\n        return Mat3.transpose(this, this);\n    }\n    /**\n     * Inverts this {@link Mat3}\n     * Equivalent to `Mat4.invert(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        return Mat3.invert(this, this);\n    }\n    /**\n     * Translate this {@link Mat3} by the given vector\n     * Equivalent to `Mat3.translate(this, this, v);`\n     *\n     * @param v - The {@link Vec2} to translate by\n     * @returns `this`\n     */\n    translate(v) {\n        return Mat3.translate(this, this, v);\n    }\n    /**\n     * Rotates this {@link Mat3} by the given angle around the given axis\n     * Equivalent to `Mat3.rotate(this, this, rad);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    rotate(rad) {\n        return Mat3.rotate(this, this, rad);\n    }\n    /**\n     * Scales this {@link Mat3} by the dimensions in the given vec3 not using vectorization\n     * Equivalent to `Mat3.scale(this, this, v);`\n     *\n     * @param v - The {@link Vec2} to scale the matrix by\n     * @returns `this`\n     */\n    scale(v) {\n        return Mat3.scale(this, this, v);\n    }\n    //================\n    // Static methods\n    //================\n    /**\n     * Creates a new, identity {@link Mat3}\n     * @category Static\n     *\n     * @returns A new {@link Mat3}\n     */\n    static create() {\n        return new Mat3();\n    }\n    /**\n     * Creates a new {@link Mat3} initialized with values from an existing matrix\n     * @category Static\n     *\n     * @param a - Matrix to clone\n     * @returns A new {@link Mat3}\n     */\n    static clone(a) {\n        return new Mat3(a);\n    }\n    /**\n     * Copy the values from one {@link Mat3} to another\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - Matrix to copy\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        out[4] = a[4];\n        out[5] = a[5];\n        out[6] = a[6];\n        out[7] = a[7];\n        out[8] = a[8];\n        return out;\n    }\n    /**\n     * Create a new {@link Mat3} with the given values\n     * @category Static\n     *\n     * @param values - Matrix components\n     * @returns A new {@link Mat3}\n     */\n    static fromValues(...values) {\n        return new Mat3(...values);\n    }\n    /**\n     * Set the components of a {@link Mat3} to the given values\n     * @category Static\n     *\n     * @param out - The receiving matrix\n     * @param values - Matrix components\n     * @returns `out`\n     */\n    static set(out, ...values) {\n        out[0] = values[0];\n        out[1] = values[1];\n        out[2] = values[2];\n        out[3] = values[3];\n        out[4] = values[4];\n        out[5] = values[5];\n        out[6] = values[6];\n        out[7] = values[7];\n        out[8] = values[8];\n        return out;\n    }\n    /**\n     * Set a {@link Mat3} to the identity matrix\n     * @category Static\n     *\n     * @param out - The receiving matrix\n     * @returns `out`\n     */\n    static identity(out) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 1;\n        out[5] = 0;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 1;\n        return out;\n    }\n    /**\n     * Transpose the values of a {@link Mat3}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static transpose(out, a) {\n        // If we are transposing ourselves we can skip a few steps but have to cache some values\n        if (out === a) {\n            const a01 = a[1], a02 = a[2], a12 = a[5];\n            out[1] = a[3];\n            out[2] = a[6];\n            out[3] = a01;\n            out[5] = a[7];\n            out[6] = a02;\n            out[7] = a12;\n        }\n        else {\n            out[0] = a[0];\n            out[1] = a[3];\n            out[2] = a[6];\n            out[3] = a[1];\n            out[4] = a[4];\n            out[5] = a[7];\n            out[6] = a[2];\n            out[7] = a[5];\n            out[8] = a[8];\n        }\n        return out;\n    }\n    /**\n     * Inverts a {@link Mat3}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static invert(out, a) {\n        const a00 = a[0], a01 = a[1], a02 = a[2];\n        const a10 = a[3], a11 = a[4], a12 = a[5];\n        const a20 = a[6], a21 = a[7], a22 = a[8];\n        const b01 = a22 * a11 - a12 * a21;\n        const b11 = -a22 * a10 + a12 * a20;\n        const b21 = a21 * a10 - a11 * a20;\n        // Calculate the determinant\n        let det = a00 * b01 + a01 * b11 + a02 * b21;\n        if (!det) {\n            return null;\n        }\n        det = 1.0 / det;\n        out[0] = b01 * det;\n        out[1] = (-a22 * a01 + a02 * a21) * det;\n        out[2] = (a12 * a01 - a02 * a11) * det;\n        out[3] = b11 * det;\n        out[4] = (a22 * a00 - a02 * a20) * det;\n        out[5] = (-a12 * a00 + a02 * a10) * det;\n        out[6] = b21 * det;\n        out[7] = (-a21 * a00 + a01 * a20) * det;\n        out[8] = (a11 * a00 - a01 * a10) * det;\n        return out;\n    }\n    /**\n     * Calculates the adjugate of a {@link Mat3}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static adjoint(out, a) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a10 = a[3];\n        const a11 = a[4];\n        const a12 = a[5];\n        const a20 = a[6];\n        const a21 = a[7];\n        const a22 = a[8];\n        out[0] = a11 * a22 - a12 * a21;\n        out[1] = a02 * a21 - a01 * a22;\n        out[2] = a01 * a12 - a02 * a11;\n        out[3] = a12 * a20 - a10 * a22;\n        out[4] = a00 * a22 - a02 * a20;\n        out[5] = a02 * a10 - a00 * a12;\n        out[6] = a10 * a21 - a11 * a20;\n        out[7] = a01 * a20 - a00 * a21;\n        out[8] = a00 * a11 - a01 * a10;\n        return out;\n    }\n    /**\n     * Calculates the determinant of a {@link Mat3}\n     * @category Static\n     *\n     * @param a - the source matrix\n     * @returns determinant of a\n     */\n    static determinant(a) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a10 = a[3];\n        const a11 = a[4];\n        const a12 = a[5];\n        const a20 = a[6];\n        const a21 = a[7];\n        const a22 = a[8];\n        return (a00 * (a22 * a11 - a12 * a21) +\n            a01 * (-a22 * a10 + a12 * a20) +\n            a02 * (a21 * a10 - a11 * a20));\n    }\n    /**\n     * Adds two {@link Mat3}'s\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        out[3] = a[3] + b[3];\n        out[4] = a[4] + b[4];\n        out[5] = a[5] + b[5];\n        out[6] = a[6] + b[6];\n        out[7] = a[7] + b[7];\n        out[8] = a[8] + b[8];\n        return out;\n    }\n    /**\n     * Subtracts matrix b from matrix a\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        out[2] = a[2] - b[2];\n        out[3] = a[3] - b[3];\n        out[4] = a[4] - b[4];\n        out[5] = a[5] - b[5];\n        out[6] = a[6] - b[6];\n        out[7] = a[7] - b[7];\n        out[8] = a[8] - b[8];\n        return out;\n    }\n    /**\n     * Alias for {@link Mat3.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return out; }\n    /**\n     * Multiplies two {@link Mat3}s\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a10 = a[3];\n        const a11 = a[4];\n        const a12 = a[5];\n        const a20 = a[6];\n        const a21 = a[7];\n        const a22 = a[8];\n        let b0 = b[0];\n        let b1 = b[1];\n        let b2 = b[2];\n        out[0] = b0 * a00 + b1 * a10 + b2 * a20;\n        out[1] = b0 * a01 + b1 * a11 + b2 * a21;\n        out[2] = b0 * a02 + b1 * a12 + b2 * a22;\n        b0 = b[3];\n        b1 = b[4];\n        b2 = b[5];\n        out[3] = b0 * a00 + b1 * a10 + b2 * a20;\n        out[4] = b0 * a01 + b1 * a11 + b2 * a21;\n        out[5] = b0 * a02 + b1 * a12 + b2 * a22;\n        b0 = b[6];\n        b1 = b[7];\n        b2 = b[8];\n        out[6] = b0 * a00 + b1 * a10 + b2 * a20;\n        out[7] = b0 * a01 + b1 * a11 + b2 * a21;\n        out[8] = b0 * a02 + b1 * a12 + b2 * a22;\n        return out;\n    }\n    /**\n     * Alias for {@link Mat3.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Translate a {@link Mat3} by the given vector\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to translate\n     * @param v - vector to translate by\n     * @returns `out`\n     */\n    static translate(out, a, v) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a10 = a[3];\n        const a11 = a[4];\n        const a12 = a[5];\n        const a20 = a[6];\n        const a21 = a[7];\n        const a22 = a[8];\n        const x = v[0];\n        const y = v[1];\n        out[0] = a00;\n        out[1] = a01;\n        out[2] = a02;\n        out[3] = a10;\n        out[4] = a11;\n        out[5] = a12;\n        out[6] = x * a00 + y * a10 + a20;\n        out[7] = x * a01 + y * a11 + a21;\n        out[8] = x * a02 + y * a12 + a22;\n        return out;\n    }\n    /**\n     * Rotates a {@link Mat3} by the given angle\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static rotate(out, a, rad) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a10 = a[3];\n        const a11 = a[4];\n        const a12 = a[5];\n        const a20 = a[6];\n        const a21 = a[7];\n        const a22 = a[8];\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        out[0] = c * a00 + s * a10;\n        out[1] = c * a01 + s * a11;\n        out[2] = c * a02 + s * a12;\n        out[3] = c * a10 - s * a00;\n        out[4] = c * a11 - s * a01;\n        out[5] = c * a12 - s * a02;\n        out[6] = a20;\n        out[7] = a21;\n        out[8] = a22;\n        return out;\n    }\n    /**\n     * Scales the {@link Mat3} by the dimensions in the given {@link Vec2}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param v - the {@link Vec2} to scale the matrix by\n     * @returns `out`\n     **/\n    static scale(out, a, v) {\n        const x = v[0];\n        const y = v[1];\n        out[0] = x * a[0];\n        out[1] = x * a[1];\n        out[2] = x * a[2];\n        out[3] = y * a[3];\n        out[4] = y * a[4];\n        out[5] = y * a[5];\n        out[6] = a[6];\n        out[7] = a[7];\n        out[8] = a[8];\n        return out;\n    }\n    /**\n     * Creates a {@link Mat3} from a vector translation\n     * This is equivalent to (but much faster than):\n     *\n     *     mat3.identity(dest);\n     *     mat3.translate(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat3} receiving operation result\n     * @param v - Translation vector\n     * @returns `out`\n     */\n    static fromTranslation(out, v) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 1;\n        out[5] = 0;\n        out[6] = v[0];\n        out[7] = v[1];\n        out[8] = 1;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat3} from a given angle around a given axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat3.identity(dest);\n     *     mat3.rotate(dest, dest, rad);\n     * @category Static\n     *\n     * @param out - {@link Mat3} receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static fromRotation(out, rad) {\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        out[0] = c;\n        out[1] = s;\n        out[2] = 0;\n        out[3] = -s;\n        out[4] = c;\n        out[5] = 0;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 1;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat3} from a vector scaling\n     * This is equivalent to (but much faster than):\n     *\n     *     mat3.identity(dest);\n     *     mat3.scale(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat3} receiving operation result\n     * @param v - Scaling vector\n     * @returns `out`\n     */\n    static fromScaling(out, v) {\n        out[0] = v[0];\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = v[1];\n        out[5] = 0;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 1;\n        return out;\n    }\n    /**\n     * Copies the upper-left 3x3 values of a {@link Mat2d} into the given\n     * {@link Mat3}.\n     * @category Static\n     *\n     * @param out - the receiving 3x3 matrix\n     * @param a - the source 2x3 matrix\n     * @returns `out`\n     */\n    static fromMat2d(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = 0;\n        out[3] = a[2];\n        out[4] = a[3];\n        out[5] = 0;\n        out[6] = a[4];\n        out[7] = a[5];\n        out[8] = 1;\n        return out;\n    }\n    /**\n     * Calculates a {@link Mat3} from the given quaternion\n     *\n     * @param out - {@link Mat3} receiving operation result\n     * @param q - {@link Quat} to create matrix from\n     * @returns `out`\n     */\n    static fromQuat(out, q) {\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const yx = y * x2;\n        const yy = y * y2;\n        const zx = z * x2;\n        const zy = z * y2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        out[0] = 1 - yy - zz;\n        out[3] = yx - wz;\n        out[6] = zx + wy;\n        out[1] = yx + wz;\n        out[4] = 1 - xx - zz;\n        out[7] = zy - wx;\n        out[2] = zx - wy;\n        out[5] = zy + wx;\n        out[8] = 1 - xx - yy;\n        return out;\n    }\n    /**\n     * Copies the upper-left 3x3 values of a {@link Mat4} into the given\n     * {@link Mat3}.\n     * @category Static\n     *\n     * @param out - the receiving 3x3 matrix\n     * @param a - the source 4x4 matrix\n     * @returns `out`\n     */\n    static fromMat4(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[4];\n        out[4] = a[5];\n        out[5] = a[6];\n        out[6] = a[8];\n        out[7] = a[9];\n        out[8] = a[10];\n        return out;\n    }\n    /**\n     * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\n     * @category Static\n     *\n     * @param {mat3} out mat3 receiving operation result\n     * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\n     * @returns `out`\n     */\n    static normalFromMat4(out, a) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a03 = a[3];\n        const a10 = a[4];\n        const a11 = a[5];\n        const a12 = a[6];\n        const a13 = a[7];\n        const a20 = a[8];\n        const a21 = a[9];\n        const a22 = a[10];\n        const a23 = a[11];\n        const a30 = a[12];\n        const a31 = a[13];\n        const a32 = a[14];\n        const a33 = a[15];\n        const b00 = a00 * a11 - a01 * a10;\n        const b01 = a00 * a12 - a02 * a10;\n        const b02 = a00 * a13 - a03 * a10;\n        const b03 = a01 * a12 - a02 * a11;\n        const b04 = a01 * a13 - a03 * a11;\n        const b05 = a02 * a13 - a03 * a12;\n        const b06 = a20 * a31 - a21 * a30;\n        const b07 = a20 * a32 - a22 * a30;\n        const b08 = a20 * a33 - a23 * a30;\n        const b09 = a21 * a32 - a22 * a31;\n        const b10 = a21 * a33 - a23 * a31;\n        const b11 = a22 * a33 - a23 * a32;\n        // Calculate the determinant\n        let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n        if (!det) {\n            return null;\n        }\n        det = 1.0 / det;\n        out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n        out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n        out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n        out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n        out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n        out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n        out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n        out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n        out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n        return out;\n    }\n    /**\n     * Generates a 2D projection matrix with the given bounds\n     * @category Static\n     *\n     * @param out mat3 frustum matrix will be written into\n     * @param width Width of your gl context\n     * @param height Height of gl context\n     * @returns `out`\n     */\n    static projection(out, width, height) {\n        out[0] = 2 / width;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = -2 / height;\n        out[5] = 0;\n        out[6] = -1;\n        out[7] = 1;\n        out[8] = 1;\n        return out;\n    }\n    /**\n     * Returns Frobenius norm of a {@link Mat3}\n     * @category Static\n     *\n     * @param a - the matrix to calculate Frobenius norm of\n     * @returns Frobenius norm\n     */\n    static frob(a) {\n        return Math.sqrt(a[0] * a[0] +\n            a[1] * a[1] +\n            a[2] * a[2] +\n            a[3] * a[3] +\n            a[4] * a[4] +\n            a[5] * a[5] +\n            a[6] * a[6] +\n            a[7] * a[7] +\n            a[8] * a[8]);\n    }\n    /**\n     * Multiply each element of a {@link Mat3} by a scalar.\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param b - amount to scale the matrix's elements by\n     * @returns `out`\n     */\n    static multiplyScalar(out, a, b) {\n        out[0] = a[0] * b;\n        out[1] = a[1] * b;\n        out[2] = a[2] * b;\n        out[3] = a[3] * b;\n        out[4] = a[4] * b;\n        out[5] = a[5] * b;\n        out[6] = a[6] * b;\n        out[7] = a[7] * b;\n        out[8] = a[8] * b;\n        return out;\n    }\n    /**\n     * Adds two {@link Mat3}'s after multiplying each element of the second operand by a scalar value.\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param scale - the amount to scale b's elements by before adding\n     * @returns `out`\n     */\n    static multiplyScalarAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        out[2] = a[2] + b[2] * scale;\n        out[3] = a[3] + b[3] * scale;\n        out[4] = a[4] + b[4] * scale;\n        out[5] = a[5] + b[5] * scale;\n        out[6] = a[6] + b[6] * scale;\n        out[7] = a[7] + b[7] * scale;\n        out[8] = a[8] + b[8] * scale;\n        return out;\n    }\n    /**\n     * Returns whether or not two {@link Mat3}s have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return (a[0] === b[0] &&\n            a[1] === b[1] &&\n            a[2] === b[2] &&\n            a[3] === b[3] &&\n            a[4] === b[4] &&\n            a[5] === b[5] &&\n            a[6] === b[6] &&\n            a[7] === b[7] &&\n            a[8] === b[8]);\n    }\n    /**\n     * Returns whether or not two {@link Mat3}s have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const a6 = a[6];\n        const a7 = a[7];\n        const a8 = a[8];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        const b4 = b[4];\n        const b5 = b[5];\n        const b6 = b[6];\n        const b7 = b[7];\n        const b8 = b[8];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= EPSILON * Math.max(1, Math.abs(a3), Math.abs(b3)) &&\n            Math.abs(a4 - b4) <= EPSILON * Math.max(1, Math.abs(a4), Math.abs(b4)) &&\n            Math.abs(a5 - b5) <= EPSILON * Math.max(1, Math.abs(a5), Math.abs(b5)) &&\n            Math.abs(a6 - b6) <= EPSILON * Math.max(1, Math.abs(a6), Math.abs(b6)) &&\n            Math.abs(a7 - b7) <= EPSILON * Math.max(1, Math.abs(a7), Math.abs(b7)) &&\n            Math.abs(a8 - b8) <= EPSILON * Math.max(1, Math.abs(a8), Math.abs(b8)));\n    }\n    /**\n     * Returns a string representation of a {@link Mat3}\n     * @category Static\n     *\n     * @param a - matrix to represent as a string\n     * @returns string representation of the matrix\n     */\n    static str(a) {\n        return `Mat3(${a.join(', ')})`;\n    }\n}\n// Instance method alias assignments\nMat3.prototype.mul = Mat3.prototype.multiply;\n// Static method alias assignments\nMat3.mul = Mat3.multiply;\nMat3.sub = Mat3.subtract;\n\nconst IDENTITY_4X4 = new Float32Array([\n    1, 0, 0, 0,\n    0, 1, 0, 0,\n    0, 0, 1, 0,\n    0, 0, 0, 1,\n]);\n/**\n * A 4x4 Matrix\n */\nclass Mat4 extends Float32Array {\n    /**\n     * The number of bytes in a {@link Mat4}.\n     */\n    static BYTE_LENGTH = 16 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Mat4}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 16:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 16);\n                break;\n            case 1:\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([\n                        v, v, v, v,\n                        v, v, v, v,\n                        v, v, v, v,\n                        v, v, v, v\n                    ]);\n                }\n                else {\n                    super(v, 0, 16);\n                }\n                break;\n            default:\n                super(IDENTITY_4X4);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    /**\n     * A string representation of `this`\n     * Equivalent to `Mat4.str(this);`\n     */\n    get str() {\n        return Mat4.str(this);\n    }\n    //===================\n    // Instance methods\n    //===================\n    /**\n     * Copy the values from another {@link Mat4} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        this.set(a);\n        return this;\n    }\n    /**\n     * Set `this` to the identity matrix\n     * Equivalent to Mat4.identity(this)\n     *\n     * @returns `this`\n     */\n    identity() {\n        this.set(IDENTITY_4X4);\n        return this;\n    }\n    /**\n     * Multiplies this {@link Mat4} against another one\n     * Equivalent to `Mat4.multiply(this, this, b);`\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `this`\n     */\n    multiply(b) {\n        return Mat4.multiply(this, this, b);\n    }\n    /**\n     * Alias for {@link Mat4.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Transpose this {@link Mat4}\n     * Equivalent to `Mat4.transpose(this, this);`\n     *\n     * @returns `this`\n     */\n    transpose() {\n        return Mat4.transpose(this, this);\n    }\n    /**\n     * Inverts this {@link Mat4}\n     * Equivalent to `Mat4.invert(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        return Mat4.invert(this, this);\n    }\n    /**\n     * Translate this {@link Mat4} by the given vector\n     * Equivalent to `Mat4.translate(this, this, v);`\n     *\n     * @param v - The {@link Vec3} to translate by\n     * @returns `this`\n     */\n    translate(v) {\n        return Mat4.translate(this, this, v);\n    }\n    /**\n     * Rotates this {@link Mat4} by the given angle around the given axis\n     * Equivalent to `Mat4.rotate(this, this, rad, axis);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @param axis - the axis to rotate around\n     * @returns `out`\n     */\n    rotate(rad, axis) {\n        return Mat4.rotate(this, this, rad, axis);\n    }\n    /**\n     * Scales this {@link Mat4} by the dimensions in the given vec3 not using vectorization\n     * Equivalent to `Mat4.scale(this, this, v);`\n     *\n     * @param v - The {@link Vec3} to scale the matrix by\n     * @returns `this`\n     */\n    scale(v) {\n        return Mat4.scale(this, this, v);\n    }\n    /**\n     * Rotates this {@link Mat4} by the given angle around the X axis\n     * Equivalent to `Mat4.rotateX(this, this, rad);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @returns `this`\n     */\n    rotateX(rad) {\n        return Mat4.rotateX(this, this, rad);\n    }\n    /**\n     * Rotates this {@link Mat4} by the given angle around the Y axis\n     * Equivalent to `Mat4.rotateY(this, this, rad);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @returns `this`\n     */\n    rotateY(rad) {\n        return Mat4.rotateY(this, this, rad);\n    }\n    /**\n     * Rotates this {@link Mat4} by the given angle around the Z axis\n     * Equivalent to `Mat4.rotateZ(this, this, rad);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @returns `this`\n     */\n    rotateZ(rad) {\n        return Mat4.rotateZ(this, this, rad);\n    }\n    /**\n     * Generates a perspective projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n     * which matches WebGL/OpenGL's clip volume.\n     * Passing null/undefined/no value for far will generate infinite projection matrix.\n     * Equivalent to `Mat4.perspectiveNO(this, fovy, aspect, near, far);`\n     *\n     * @param fovy - Vertical field of view in radians\n     * @param aspect - Aspect ratio. typically viewport width/height\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum, can be null or Infinity\n     * @returns `this`\n     */\n    perspectiveNO(fovy, aspect, near, far) {\n        return Mat4.perspectiveNO(this, fovy, aspect, near, far);\n    }\n    /**\n     * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n     * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n     * Passing null/undefined/no value for far will generate infinite projection matrix.\n     * Equivalent to `Mat4.perspectiveZO(this, fovy, aspect, near, far);`\n     *\n     * @param fovy - Vertical field of view in radians\n     * @param aspect - Aspect ratio. typically viewport width/height\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum, can be null or Infinity\n     * @returns `this`\n     */\n    perspectiveZO(fovy, aspect, near, far) {\n        return Mat4.perspectiveZO(this, fovy, aspect, near, far);\n    }\n    /**\n     * Generates a orthogonal projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n     * which matches WebGL/OpenGL's clip volume.\n     * Equivalent to `Mat4.orthoNO(this, left, right, bottom, top, near, far);`\n     *\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `this`\n     */\n    orthoNO(left, right, bottom, top, near, far) {\n        return Mat4.orthoNO(this, left, right, bottom, top, near, far);\n    }\n    /**\n     * Generates a orthogonal projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n     * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n     * Equivalent to `Mat4.orthoZO(this, left, right, bottom, top, near, far);`\n     *\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `this`\n     */\n    orthoZO(left, right, bottom, top, near, far) {\n        return Mat4.orthoZO(this, left, right, bottom, top, near, far);\n    }\n    //================\n    // Static methods\n    //================\n    /**\n     * Creates a new, identity {@link Mat4}\n     * @category Static\n     *\n     * @returns A new {@link Mat4}\n     */\n    static create() {\n        return new Mat4();\n    }\n    /**\n     * Creates a new {@link Mat4} initialized with values from an existing matrix\n     * @category Static\n     *\n     * @param a - Matrix to clone\n     * @returns A new {@link Mat4}\n     */\n    static clone(a) {\n        return new Mat4(a);\n    }\n    /**\n     * Copy the values from one {@link Mat4} to another\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - Matrix to copy\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        out[4] = a[4];\n        out[5] = a[5];\n        out[6] = a[6];\n        out[7] = a[7];\n        out[8] = a[8];\n        out[9] = a[9];\n        out[10] = a[10];\n        out[11] = a[11];\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n        return out;\n    }\n    /**\n     * Create a new mat4 with the given values\n     * @category Static\n     *\n     * @param values - Matrix components\n     * @returns A new {@link Mat4}\n     */\n    static fromValues(...values) {\n        return new Mat4(...values);\n    }\n    /**\n     * Set the components of a mat4 to the given values\n     * @category Static\n     *\n     * @param out - The receiving matrix\n     * @param values - Matrix components\n     * @returns `out`\n     */\n    static set(out, ...values) {\n        out[0] = values[0];\n        out[1] = values[1];\n        out[2] = values[2];\n        out[3] = values[3];\n        out[4] = values[4];\n        out[5] = values[5];\n        out[6] = values[6];\n        out[7] = values[7];\n        out[8] = values[8];\n        out[9] = values[9];\n        out[10] = values[10];\n        out[11] = values[11];\n        out[12] = values[12];\n        out[13] = values[13];\n        out[14] = values[14];\n        out[15] = values[15];\n        return out;\n    }\n    /**\n     * Set a {@link Mat4} to the identity matrix\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @returns `out`\n     */\n    static identity(out) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = 1;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = 1;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Transpose the values of a {@link Mat4}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static transpose(out, a) {\n        // If we are transposing ourselves we can skip a few steps but have to cache some values\n        if (out === a) {\n            const a01 = a[1], a02 = a[2], a03 = a[3];\n            const a12 = a[6], a13 = a[7];\n            const a23 = a[11];\n            out[1] = a[4];\n            out[2] = a[8];\n            out[3] = a[12];\n            out[4] = a01;\n            out[6] = a[9];\n            out[7] = a[13];\n            out[8] = a02;\n            out[9] = a12;\n            out[11] = a[14];\n            out[12] = a03;\n            out[13] = a13;\n            out[14] = a23;\n        }\n        else {\n            out[0] = a[0];\n            out[1] = a[4];\n            out[2] = a[8];\n            out[3] = a[12];\n            out[4] = a[1];\n            out[5] = a[5];\n            out[6] = a[9];\n            out[7] = a[13];\n            out[8] = a[2];\n            out[9] = a[6];\n            out[10] = a[10];\n            out[11] = a[14];\n            out[12] = a[3];\n            out[13] = a[7];\n            out[14] = a[11];\n            out[15] = a[15];\n        }\n        return out;\n    }\n    /**\n     * Inverts a {@link Mat4}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static invert(out, a) {\n        const a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\n        const a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\n        const a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\n        const a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n        const b00 = a00 * a11 - a01 * a10;\n        const b01 = a00 * a12 - a02 * a10;\n        const b02 = a00 * a13 - a03 * a10;\n        const b03 = a01 * a12 - a02 * a11;\n        const b04 = a01 * a13 - a03 * a11;\n        const b05 = a02 * a13 - a03 * a12;\n        const b06 = a20 * a31 - a21 * a30;\n        const b07 = a20 * a32 - a22 * a30;\n        const b08 = a20 * a33 - a23 * a30;\n        const b09 = a21 * a32 - a22 * a31;\n        const b10 = a21 * a33 - a23 * a31;\n        const b11 = a22 * a33 - a23 * a32;\n        // Calculate the determinant\n        let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n        if (!det) {\n            return null;\n        }\n        det = 1.0 / det;\n        out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n        out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n        out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n        out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n        out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n        out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n        out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n        out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n        out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n        out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n        out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n        out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n        out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n        out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n        out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n        out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n        return out;\n    }\n    /**\n     * Calculates the adjugate of a {@link Mat4}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static adjoint(out, a) {\n        const a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\n        const a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\n        const a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\n        const a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n        const b00 = a00 * a11 - a01 * a10;\n        const b01 = a00 * a12 - a02 * a10;\n        const b02 = a00 * a13 - a03 * a10;\n        const b03 = a01 * a12 - a02 * a11;\n        const b04 = a01 * a13 - a03 * a11;\n        const b05 = a02 * a13 - a03 * a12;\n        const b06 = a20 * a31 - a21 * a30;\n        const b07 = a20 * a32 - a22 * a30;\n        const b08 = a20 * a33 - a23 * a30;\n        const b09 = a21 * a32 - a22 * a31;\n        const b10 = a21 * a33 - a23 * a31;\n        const b11 = a22 * a33 - a23 * a32;\n        out[0] = a11 * b11 - a12 * b10 + a13 * b09;\n        out[1] = a02 * b10 - a01 * b11 - a03 * b09;\n        out[2] = a31 * b05 - a32 * b04 + a33 * b03;\n        out[3] = a22 * b04 - a21 * b05 - a23 * b03;\n        out[4] = a12 * b08 - a10 * b11 - a13 * b07;\n        out[5] = a00 * b11 - a02 * b08 + a03 * b07;\n        out[6] = a32 * b02 - a30 * b05 - a33 * b01;\n        out[7] = a20 * b05 - a22 * b02 + a23 * b01;\n        out[8] = a10 * b10 - a11 * b08 + a13 * b06;\n        out[9] = a01 * b08 - a00 * b10 - a03 * b06;\n        out[10] = a30 * b04 - a31 * b02 + a33 * b00;\n        out[11] = a21 * b02 - a20 * b04 - a23 * b00;\n        out[12] = a11 * b07 - a10 * b09 - a12 * b06;\n        out[13] = a00 * b09 - a01 * b07 + a02 * b06;\n        out[14] = a31 * b01 - a30 * b03 - a32 * b00;\n        out[15] = a20 * b03 - a21 * b01 + a22 * b00;\n        return out;\n    }\n    /**\n     * Calculates the determinant of a {@link Mat4}\n     * @category Static\n     *\n     * @param a - the source matrix\n     * @returns determinant of a\n     */\n    static determinant(a) {\n        const a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\n        const a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\n        const a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\n        const a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n        const b0 = a00 * a11 - a01 * a10;\n        const b1 = a00 * a12 - a02 * a10;\n        const b2 = a01 * a12 - a02 * a11;\n        const b3 = a20 * a31 - a21 * a30;\n        const b4 = a20 * a32 - a22 * a30;\n        const b5 = a21 * a32 - a22 * a31;\n        const b6 = a00 * b5 - a01 * b4 + a02 * b3;\n        const b7 = a10 * b5 - a11 * b4 + a12 * b3;\n        const b8 = a20 * b2 - a21 * b1 + a22 * b0;\n        const b9 = a30 * b2 - a31 * b1 + a32 * b0;\n        // Calculate the determinant\n        return a13 * b6 - a03 * b7 + a33 * b8 - a23 * b9;\n    }\n    /**\n     * Multiplies two {@link Mat4}s\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a03 = a[3];\n        const a10 = a[4];\n        const a11 = a[5];\n        const a12 = a[6];\n        const a13 = a[7];\n        const a20 = a[8];\n        const a21 = a[9];\n        const a22 = a[10];\n        const a23 = a[11];\n        const a30 = a[12];\n        const a31 = a[13];\n        const a32 = a[14];\n        const a33 = a[15];\n        // Cache only the current line of the second matrix\n        let b0 = b[0];\n        let b1 = b[1];\n        let b2 = b[2];\n        let b3 = b[3];\n        out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n        b0 = b[4];\n        b1 = b[5];\n        b2 = b[6];\n        b3 = b[7];\n        out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n        b0 = b[8];\n        b1 = b[9];\n        b2 = b[10];\n        b3 = b[11];\n        out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n        b0 = b[12];\n        b1 = b[13];\n        b2 = b[14];\n        b3 = b[15];\n        out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n        return out;\n    }\n    /**\n     * Alias for {@link Mat4.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Translate a {@link Mat4} by the given vector\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to translate\n     * @param v - vector to translate by\n     * @returns `out`\n     */\n    static translate(out, a, v) {\n        const x = v[0];\n        const y = v[1];\n        const z = v[2];\n        if (a === out) {\n            out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n            out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n            out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n            out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n        }\n        else {\n            const a00 = a[0];\n            const a01 = a[1];\n            const a02 = a[2];\n            const a03 = a[3];\n            const a10 = a[4];\n            const a11 = a[5];\n            const a12 = a[6];\n            const a13 = a[7];\n            const a20 = a[8];\n            const a21 = a[9];\n            const a22 = a[10];\n            const a23 = a[11];\n            out[0] = a00;\n            out[1] = a01;\n            out[2] = a02;\n            out[3] = a03;\n            out[4] = a10;\n            out[5] = a11;\n            out[6] = a12;\n            out[7] = a13;\n            out[8] = a20;\n            out[9] = a21;\n            out[10] = a22;\n            out[11] = a23;\n            out[12] = a00 * x + a10 * y + a20 * z + a[12];\n            out[13] = a01 * x + a11 * y + a21 * z + a[13];\n            out[14] = a02 * x + a12 * y + a22 * z + a[14];\n            out[15] = a03 * x + a13 * y + a23 * z + a[15];\n        }\n        return out;\n    }\n    /**\n     * Scales the {@link Mat4} by the dimensions in the given {@link Vec3} not using vectorization\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param v - the {@link Vec3} to scale the matrix by\n     * @returns `out`\n     **/\n    static scale(out, a, v) {\n        const x = v[0];\n        const y = v[1];\n        const z = v[2];\n        out[0] = a[0] * x;\n        out[1] = a[1] * x;\n        out[2] = a[2] * x;\n        out[3] = a[3] * x;\n        out[4] = a[4] * y;\n        out[5] = a[5] * y;\n        out[6] = a[6] * y;\n        out[7] = a[7] * y;\n        out[8] = a[8] * z;\n        out[9] = a[9] * z;\n        out[10] = a[10] * z;\n        out[11] = a[11] * z;\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n        return out;\n    }\n    /**\n     * Rotates a {@link Mat4} by the given angle around the given axis\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @param axis - the axis to rotate around\n     * @returns `out`\n     */\n    static rotate(out, a, rad, axis) {\n        let x = axis[0];\n        let y = axis[1];\n        let z = axis[2];\n        let len = Math.sqrt(x * x + y * y + z * z);\n        if (len < EPSILON) {\n            return null;\n        }\n        len = 1 / len;\n        x *= len;\n        y *= len;\n        z *= len;\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        const t = 1 - c;\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a03 = a[3];\n        const a10 = a[4];\n        const a11 = a[5];\n        const a12 = a[6];\n        const a13 = a[7];\n        const a20 = a[8];\n        const a21 = a[9];\n        const a22 = a[10];\n        const a23 = a[11];\n        // Construct the elements of the rotation matrix\n        const b00 = x * x * t + c;\n        const b01 = y * x * t + z * s;\n        const b02 = z * x * t - y * s;\n        const b10 = x * y * t - z * s;\n        const b11 = y * y * t + c;\n        const b12 = z * y * t + x * s;\n        const b20 = x * z * t + y * s;\n        const b21 = y * z * t - x * s;\n        const b22 = z * z * t + c;\n        // Perform rotation-specific matrix multiplication\n        out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n        out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n        out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n        out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n        out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n        out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n        out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n        out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n        out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n        out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n        out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n        out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n        if (a !== out) {\n            // If the source and destination differ, copy the unchanged last row\n            out[12] = a[12];\n            out[13] = a[13];\n            out[14] = a[14];\n            out[15] = a[15];\n        }\n        return out;\n    }\n    /**\n     * Rotates a matrix by the given angle around the X axis\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static rotateX(out, a, rad) {\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n        let a10 = a[4];\n        let a11 = a[5];\n        let a12 = a[6];\n        let a13 = a[7];\n        let a20 = a[8];\n        let a21 = a[9];\n        let a22 = a[10];\n        let a23 = a[11];\n        if (a !== out) {\n            // If the source and destination differ, copy the unchanged rows\n            out[0] = a[0];\n            out[1] = a[1];\n            out[2] = a[2];\n            out[3] = a[3];\n            out[12] = a[12];\n            out[13] = a[13];\n            out[14] = a[14];\n            out[15] = a[15];\n        }\n        // Perform axis-specific matrix multiplication\n        out[4] = a10 * c + a20 * s;\n        out[5] = a11 * c + a21 * s;\n        out[6] = a12 * c + a22 * s;\n        out[7] = a13 * c + a23 * s;\n        out[8] = a20 * c - a10 * s;\n        out[9] = a21 * c - a11 * s;\n        out[10] = a22 * c - a12 * s;\n        out[11] = a23 * c - a13 * s;\n        return out;\n    }\n    /**\n     * Rotates a matrix by the given angle around the Y axis\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static rotateY(out, a, rad) {\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n        let a00 = a[0];\n        let a01 = a[1];\n        let a02 = a[2];\n        let a03 = a[3];\n        let a20 = a[8];\n        let a21 = a[9];\n        let a22 = a[10];\n        let a23 = a[11];\n        if (a !== out) {\n            // If the source and destination differ, copy the unchanged rows\n            out[4] = a[4];\n            out[5] = a[5];\n            out[6] = a[6];\n            out[7] = a[7];\n            out[12] = a[12];\n            out[13] = a[13];\n            out[14] = a[14];\n            out[15] = a[15];\n        }\n        // Perform axis-specific matrix multiplication\n        out[0] = a00 * c - a20 * s;\n        out[1] = a01 * c - a21 * s;\n        out[2] = a02 * c - a22 * s;\n        out[3] = a03 * c - a23 * s;\n        out[8] = a00 * s + a20 * c;\n        out[9] = a01 * s + a21 * c;\n        out[10] = a02 * s + a22 * c;\n        out[11] = a03 * s + a23 * c;\n        return out;\n    }\n    /**\n     * Rotates a matrix by the given angle around the Z axis\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static rotateZ(out, a, rad) {\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n        let a00 = a[0];\n        let a01 = a[1];\n        let a02 = a[2];\n        let a03 = a[3];\n        let a10 = a[4];\n        let a11 = a[5];\n        let a12 = a[6];\n        let a13 = a[7];\n        if (a !== out) {\n            // If the source and destination differ, copy the unchanged last row\n            out[8] = a[8];\n            out[9] = a[9];\n            out[10] = a[10];\n            out[11] = a[11];\n            out[12] = a[12];\n            out[13] = a[13];\n            out[14] = a[14];\n            out[15] = a[15];\n        }\n        // Perform axis-specific matrix multiplication\n        out[0] = a00 * c + a10 * s;\n        out[1] = a01 * c + a11 * s;\n        out[2] = a02 * c + a12 * s;\n        out[3] = a03 * c + a13 * s;\n        out[4] = a10 * c - a00 * s;\n        out[5] = a11 * c - a01 * s;\n        out[6] = a12 * c - a02 * s;\n        out[7] = a13 * c - a03 * s;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat4} from a vector translation\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.translate(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat4} receiving operation result\n     * @param v - Translation vector\n     * @returns `out`\n     */\n    static fromTranslation(out, v) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = 1;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = 1;\n        out[11] = 0;\n        out[12] = v[0];\n        out[13] = v[1];\n        out[14] = v[2];\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat4} from a vector scaling\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.scale(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat4} receiving operation result\n     * @param v - Scaling vector\n     * @returns `out`\n     */\n    static fromScaling(out, v) {\n        out[0] = v[0];\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = v[1];\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = v[2];\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat4} from a given angle around a given axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.rotate(dest, dest, rad, axis);\n     * @category Static\n     *\n     * @param out - {@link Mat4} receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @param axis - the axis to rotate around\n     * @returns `out`\n     */\n    static fromRotation(out, rad, axis) {\n        let x = axis[0];\n        let y = axis[1];\n        let z = axis[2];\n        let len = Math.sqrt(x * x + y * y + z * z);\n        if (len < EPSILON) {\n            return null;\n        }\n        len = 1 / len;\n        x *= len;\n        y *= len;\n        z *= len;\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        const t = 1 - c;\n        // Perform rotation-specific matrix multiplication\n        out[0] = x * x * t + c;\n        out[1] = y * x * t + z * s;\n        out[2] = z * x * t - y * s;\n        out[3] = 0;\n        out[4] = x * y * t - z * s;\n        out[5] = y * y * t + c;\n        out[6] = z * y * t + x * s;\n        out[7] = 0;\n        out[8] = x * z * t + y * s;\n        out[9] = y * z * t - x * s;\n        out[10] = z * z * t + c;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a matrix from the given angle around the X axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.rotateX(dest, dest, rad);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static fromXRotation(out, rad) {\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n        // Perform axis-specific matrix multiplication\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = c;\n        out[6] = s;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = -s;\n        out[10] = c;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a matrix from the given angle around the Y axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.rotateY(dest, dest, rad);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static fromYRotation(out, rad) {\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n        // Perform axis-specific matrix multiplication\n        out[0] = c;\n        out[1] = 0;\n        out[2] = -s;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = 1;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = s;\n        out[9] = 0;\n        out[10] = c;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a matrix from the given angle around the Z axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.rotateZ(dest, dest, rad);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static fromZRotation(out, rad) {\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        // Perform axis-specific matrix multiplication\n        out[0] = c;\n        out[1] = s;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = -s;\n        out[5] = c;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = 1;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a matrix from a quaternion rotation and vector translation\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.translate(dest, vec);\n     *     let quatMat = mat4.create();\n     *     quat4.toMat4(quat, quatMat);\n     *     mat4.multiply(dest, quatMat);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param q - Rotation quaternion\n     * @param v - Translation vector\n     * @returns `out`\n     */\n    static fromRotationTranslation(out, q, v) {\n        // Quaternion math\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const xy = x * y2;\n        const xz = x * z2;\n        const yy = y * y2;\n        const yz = y * z2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        out[0] = 1 - (yy + zz);\n        out[1] = xy + wz;\n        out[2] = xz - wy;\n        out[3] = 0;\n        out[4] = xy - wz;\n        out[5] = 1 - (xx + zz);\n        out[6] = yz + wx;\n        out[7] = 0;\n        out[8] = xz + wy;\n        out[9] = yz - wx;\n        out[10] = 1 - (xx + yy);\n        out[11] = 0;\n        out[12] = v[0];\n        out[13] = v[1];\n        out[14] = v[2];\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Sets a {@link Mat4} from a {@link Quat2}.\n     * @category Static\n     *\n     * @param out - Matrix\n     * @param a - Dual Quaternion\n     * @returns `out`\n     */\n    static fromQuat2(out, a) {\n        let translation = [0, 0, 0];\n        const bx = -a[0];\n        const by = -a[1];\n        const bz = -a[2];\n        const bw = a[3];\n        const ax = a[4];\n        const ay = a[5];\n        const az = a[6];\n        const aw = a[7];\n        let magnitude = bx * bx + by * by + bz * bz + bw * bw;\n        //Only scale if it makes sense\n        if (magnitude > 0) {\n            translation[0] = ((ax * bw + aw * bx + ay * bz - az * by) * 2) / magnitude;\n            translation[1] = ((ay * bw + aw * by + az * bx - ax * bz) * 2) / magnitude;\n            translation[2] = ((az * bw + aw * bz + ax * by - ay * bx) * 2) / magnitude;\n        }\n        else {\n            translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n            translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n            translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n        }\n        Mat4.fromRotationTranslation(out, a, translation);\n        return out;\n    }\n    /**\n     * Returns the translation vector component of a transformation\n     * matrix. If a matrix is built with fromRotationTranslation,\n     * the returned vector will be the same as the translation vector\n     * originally supplied.\n     * @category Static\n     *\n     * @param  {vec3} out Vector to receive translation component\n     * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n     * @return {vec3} out\n     */\n    static getTranslation(out, mat) {\n        out[0] = mat[12];\n        out[1] = mat[13];\n        out[2] = mat[14];\n        return out;\n    }\n    /**\n     * Returns the scaling factor component of a transformation\n     * matrix. If a matrix is built with fromRotationTranslationScale\n     * with a normalized Quaternion paramter, the returned vector will be\n     * the same as the scaling vector\n     * originally supplied.\n     * @category Static\n     *\n     * @param  {vec3} out Vector to receive scaling factor component\n     * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n     * @return {vec3} out\n     */\n    static getScaling(out, mat) {\n        const m11 = mat[0];\n        const m12 = mat[1];\n        const m13 = mat[2];\n        const m21 = mat[4];\n        const m22 = mat[5];\n        const m23 = mat[6];\n        const m31 = mat[8];\n        const m32 = mat[9];\n        const m33 = mat[10];\n        out[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n        out[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n        out[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n        return out;\n    }\n    /**\n     * Returns a quaternion representing the rotational component\n     * of a transformation matrix. If a matrix is built with\n     * fromRotationTranslation, the returned quaternion will be the\n     * same as the quaternion originally supplied.\n     * @category Static\n     *\n     * @param out - Quaternion to receive the rotation component\n     * @param mat - Matrix to be decomposed (input)\n     * @return `out`\n     */\n    static getRotation(out, mat) {\n        Mat4.getScaling(tmpVec3$1, mat);\n        const is1 = 1 / tmpVec3$1[0];\n        const is2 = 1 / tmpVec3$1[1];\n        const is3 = 1 / tmpVec3$1[2];\n        const sm11 = mat[0] * is1;\n        const sm12 = mat[1] * is2;\n        const sm13 = mat[2] * is3;\n        const sm21 = mat[4] * is1;\n        const sm22 = mat[5] * is2;\n        const sm23 = mat[6] * is3;\n        const sm31 = mat[8] * is1;\n        const sm32 = mat[9] * is2;\n        const sm33 = mat[10] * is3;\n        const trace = sm11 + sm22 + sm33;\n        let S = 0;\n        if (trace > 0) {\n            S = Math.sqrt(trace + 1.0) * 2;\n            out[3] = 0.25 * S;\n            out[0] = (sm23 - sm32) / S;\n            out[1] = (sm31 - sm13) / S;\n            out[2] = (sm12 - sm21) / S;\n        }\n        else if (sm11 > sm22 && sm11 > sm33) {\n            S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n            out[3] = (sm23 - sm32) / S;\n            out[0] = 0.25 * S;\n            out[1] = (sm12 + sm21) / S;\n            out[2] = (sm31 + sm13) / S;\n        }\n        else if (sm22 > sm33) {\n            S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n            out[3] = (sm31 - sm13) / S;\n            out[0] = (sm12 + sm21) / S;\n            out[1] = 0.25 * S;\n            out[2] = (sm23 + sm32) / S;\n        }\n        else {\n            S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n            out[3] = (sm12 - sm21) / S;\n            out[0] = (sm31 + sm13) / S;\n            out[1] = (sm23 + sm32) / S;\n            out[2] = 0.25 * S;\n        }\n        return out;\n    }\n    /**\n     * Decomposes a transformation matrix into its rotation, translation\n     * and scale components. Returns only the rotation component\n     * @category Static\n     *\n     * @param out_r - Quaternion to receive the rotation component\n     * @param out_t - Vector to receive the translation vector\n     * @param out_s - Vector to receive the scaling factor\n     * @param mat - Matrix to be decomposed (input)\n     * @returns `out_r`\n     */\n    static decompose(out_r, out_t, out_s, mat) {\n        out_t[0] = mat[12];\n        out_t[1] = mat[13];\n        out_t[2] = mat[14];\n        const m11 = mat[0];\n        const m12 = mat[1];\n        const m13 = mat[2];\n        const m21 = mat[4];\n        const m22 = mat[5];\n        const m23 = mat[6];\n        const m31 = mat[8];\n        const m32 = mat[9];\n        const m33 = mat[10];\n        out_s[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n        out_s[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n        out_s[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n        const is1 = 1 / out_s[0];\n        const is2 = 1 / out_s[1];\n        const is3 = 1 / out_s[2];\n        const sm11 = m11 * is1;\n        const sm12 = m12 * is2;\n        const sm13 = m13 * is3;\n        const sm21 = m21 * is1;\n        const sm22 = m22 * is2;\n        const sm23 = m23 * is3;\n        const sm31 = m31 * is1;\n        const sm32 = m32 * is2;\n        const sm33 = m33 * is3;\n        const trace = sm11 + sm22 + sm33;\n        let S = 0;\n        if (trace > 0) {\n            S = Math.sqrt(trace + 1.0) * 2;\n            out_r[3] = 0.25 * S;\n            out_r[0] = (sm23 - sm32) / S;\n            out_r[1] = (sm31 - sm13) / S;\n            out_r[2] = (sm12 - sm21) / S;\n        }\n        else if (sm11 > sm22 && sm11 > sm33) {\n            S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n            out_r[3] = (sm23 - sm32) / S;\n            out_r[0] = 0.25 * S;\n            out_r[1] = (sm12 + sm21) / S;\n            out_r[2] = (sm31 + sm13) / S;\n        }\n        else if (sm22 > sm33) {\n            S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n            out_r[3] = (sm31 - sm13) / S;\n            out_r[0] = (sm12 + sm21) / S;\n            out_r[1] = 0.25 * S;\n            out_r[2] = (sm23 + sm32) / S;\n        }\n        else {\n            S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n            out_r[3] = (sm12 - sm21) / S;\n            out_r[0] = (sm31 + sm13) / S;\n            out_r[1] = (sm23 + sm32) / S;\n            out_r[2] = 0.25 * S;\n        }\n        return out_r;\n    }\n    /**\n     * Creates a matrix from a quaternion rotation, vector translation and vector scale\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.translate(dest, vec);\n     *     let quatMat = mat4.create();\n     *     quat4.toMat4(quat, quatMat);\n     *     mat4.multiply(dest, quatMat);\n     *     mat4.scale(dest, scale);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param q - Rotation quaternion\n     * @param v - Translation vector\n     * @param s - Scaling vector\n     * @returns `out`\n     */\n    static fromRotationTranslationScale(out, q, v, s) {\n        // Quaternion math\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const xy = x * y2;\n        const xz = x * z2;\n        const yy = y * y2;\n        const yz = y * z2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        const sx = s[0];\n        const sy = s[1];\n        const sz = s[2];\n        out[0] = (1 - (yy + zz)) * sx;\n        out[1] = (xy + wz) * sx;\n        out[2] = (xz - wy) * sx;\n        out[3] = 0;\n        out[4] = (xy - wz) * sy;\n        out[5] = (1 - (xx + zz)) * sy;\n        out[6] = (yz + wx) * sy;\n        out[7] = 0;\n        out[8] = (xz + wy) * sz;\n        out[9] = (yz - wx) * sz;\n        out[10] = (1 - (xx + yy)) * sz;\n        out[11] = 0;\n        out[12] = v[0];\n        out[13] = v[1];\n        out[14] = v[2];\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.translate(dest, vec);\n     *     mat4.translate(dest, origin);\n     *     let quatMat = mat4.create();\n     *     quat4.toMat4(quat, quatMat);\n     *     mat4.multiply(dest, quatMat);\n     *     mat4.scale(dest, scale)\n     *     mat4.translate(dest, negativeOrigin);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param q - Rotation quaternion\n     * @param v - Translation vector\n     * @param s - Scaling vector\n     * @param o - The origin vector around which to scale and rotate\n     * @returns `out`\n     */\n    static fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n        // Quaternion math\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const xy = x * y2;\n        const xz = x * z2;\n        const yy = y * y2;\n        const yz = y * z2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        const sx = s[0];\n        const sy = s[1];\n        const sz = s[2];\n        const ox = o[0];\n        const oy = o[1];\n        const oz = o[2];\n        const out0 = (1 - (yy + zz)) * sx;\n        const out1 = (xy + wz) * sx;\n        const out2 = (xz - wy) * sx;\n        const out4 = (xy - wz) * sy;\n        const out5 = (1 - (xx + zz)) * sy;\n        const out6 = (yz + wx) * sy;\n        const out8 = (xz + wy) * sz;\n        const out9 = (yz - wx) * sz;\n        const out10 = (1 - (xx + yy)) * sz;\n        out[0] = out0;\n        out[1] = out1;\n        out[2] = out2;\n        out[3] = 0;\n        out[4] = out4;\n        out[5] = out5;\n        out[6] = out6;\n        out[7] = 0;\n        out[8] = out8;\n        out[9] = out9;\n        out[10] = out10;\n        out[11] = 0;\n        out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n        out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n        out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Calculates a 4x4 matrix from the given quaternion\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param q - Quaternion to create matrix from\n     * @returns `out`\n     */\n    static fromQuat(out, q) {\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const yx = y * x2;\n        const yy = y * y2;\n        const zx = z * x2;\n        const zy = z * y2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        out[0] = 1 - yy - zz;\n        out[1] = yx + wz;\n        out[2] = zx - wy;\n        out[3] = 0;\n        out[4] = yx - wz;\n        out[5] = 1 - xx - zz;\n        out[6] = zy + wx;\n        out[7] = 0;\n        out[8] = zx + wy;\n        out[9] = zy - wx;\n        out[10] = 1 - xx - yy;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Generates a frustum matrix with the given bounds\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `out`\n     */\n    static frustum(out, left, right, bottom, top, near, far) {\n        const rl = 1 / (right - left);\n        const tb = 1 / (top - bottom);\n        const nf = 1 / (near - far);\n        out[0] = near * 2 * rl;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = near * 2 * tb;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = (right + left) * rl;\n        out[9] = (top + bottom) * tb;\n        out[10] = (far + near) * nf;\n        out[11] = -1;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = far * near * 2 * nf;\n        out[15] = 0;\n        return out;\n    }\n    /**\n     * Generates a perspective projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n     * which matches WebGL/OpenGL's clip volume.\n     * Passing null/undefined/no value for far will generate infinite projection matrix.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param fovy - Vertical field of view in radians\n     * @param aspect - Aspect ratio. typically viewport width/height\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum, can be null or Infinity\n     * @returns `out`\n     */\n    static perspectiveNO(out, fovy, aspect, near, far) {\n        const f = 1.0 / Math.tan(fovy / 2);\n        out[0] = f / aspect;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = f;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[11] = -1;\n        out[12] = 0;\n        out[13] = 0;\n        out[15] = 0;\n        if (far != null && far !== Infinity) {\n            const nf = 1 / (near - far);\n            out[10] = (far + near) * nf;\n            out[14] = 2 * far * near * nf;\n        }\n        else {\n            out[10] = -1;\n            out[14] = -2 * near;\n        }\n        return out;\n    }\n    /**\n     * Alias for {@link Mat4.perspectiveNO}\n     * @category Static\n     * @deprecated Use {@link Mat4.perspectiveNO} or {@link Mat4.perspectiveZO} explicitly\n     */\n    static perspective(out, fovy, aspect, near, far) { return out; }\n    /**\n     * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n     * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n     * Passing null/undefined/no value for far will generate infinite projection matrix.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param fovy - Vertical field of view in radians\n     * @param aspect - Aspect ratio. typically viewport width/height\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum, can be null or Infinity\n     * @returns `out`\n     */\n    static perspectiveZO(out, fovy, aspect, near, far) {\n        const f = 1.0 / Math.tan(fovy / 2);\n        out[0] = f / aspect;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = f;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[11] = -1;\n        out[12] = 0;\n        out[13] = 0;\n        out[15] = 0;\n        if (far != null && far !== Infinity) {\n            const nf = 1 / (near - far);\n            out[10] = far * nf;\n            out[14] = far * near * nf;\n        }\n        else {\n            out[10] = -1;\n            out[14] = -near;\n        }\n        return out;\n    }\n    /**\n     * Generates a perspective projection matrix with the given field of view.\n     * This is primarily useful for generating projection matrices to be used\n     * with the still experiemental WebVR API.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param fov - Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `out`\n     * @deprecated\n     */\n    static perspectiveFromFieldOfView(out, fov, near, far) {\n        const upTan = Math.tan((fov.upDegrees * Math.PI) / 180.0);\n        const downTan = Math.tan((fov.downDegrees * Math.PI) / 180.0);\n        const leftTan = Math.tan((fov.leftDegrees * Math.PI) / 180.0);\n        const rightTan = Math.tan((fov.rightDegrees * Math.PI) / 180.0);\n        const xScale = 2.0 / (leftTan + rightTan);\n        const yScale = 2.0 / (upTan + downTan);\n        out[0] = xScale;\n        out[1] = 0.0;\n        out[2] = 0.0;\n        out[3] = 0.0;\n        out[4] = 0.0;\n        out[5] = yScale;\n        out[6] = 0.0;\n        out[7] = 0.0;\n        out[8] = -((leftTan - rightTan) * xScale * 0.5);\n        out[9] = (upTan - downTan) * yScale * 0.5;\n        out[10] = far / (near - far);\n        out[11] = -1.0;\n        out[12] = 0.0;\n        out[13] = 0.0;\n        out[14] = (far * near) / (near - far);\n        out[15] = 0.0;\n        return out;\n    }\n    /**\n     * Generates a orthogonal projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n     * which matches WebGL/OpenGL's clip volume.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `out`\n     */\n    static orthoNO(out, left, right, bottom, top, near, far) {\n        const lr = 1 / (left - right);\n        const bt = 1 / (bottom - top);\n        const nf = 1 / (near - far);\n        out[0] = -2 * lr;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = -2 * bt;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = 2 * nf;\n        out[11] = 0;\n        out[12] = (left + right) * lr;\n        out[13] = (top + bottom) * bt;\n        out[14] = (far + near) * nf;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Alias for {@link Mat4.orthoNO}\n     * @category Static\n     * @deprecated Use {@link Mat4.orthoNO} or {@link Mat4.orthoZO} explicitly\n     */\n    static ortho(out, left, right, bottom, top, near, far) { return out; }\n    /**\n     * Generates a orthogonal projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n     * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `out`\n     */\n    static orthoZO(out, left, right, bottom, top, near, far) {\n        const lr = 1 / (left - right);\n        const bt = 1 / (bottom - top);\n        const nf = 1 / (near - far);\n        out[0] = -2 * lr;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = -2 * bt;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = nf;\n        out[11] = 0;\n        out[12] = (left + right) * lr;\n        out[13] = (top + bottom) * bt;\n        out[14] = near * nf;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Generates a look-at matrix with the given eye position, focal point, and up axis.\n     * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param eye - Position of the viewer\n     * @param center - Point the viewer is looking at\n     * @param up - vec3 pointing up\n     * @returns `out`\n     */\n    static lookAt(out, eye, center, up) {\n        const eyex = eye[0];\n        const eyey = eye[1];\n        const eyez = eye[2];\n        const upx = up[0];\n        const upy = up[1];\n        const upz = up[2];\n        const centerx = center[0];\n        const centery = center[1];\n        const centerz = center[2];\n        if (Math.abs(eyex - centerx) < EPSILON &&\n            Math.abs(eyey - centery) < EPSILON &&\n            Math.abs(eyez - centerz) < EPSILON) {\n            return Mat4.identity(out);\n        }\n        let z0 = eyex - centerx;\n        let z1 = eyey - centery;\n        let z2 = eyez - centerz;\n        let len = 1 / Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\n        z0 *= len;\n        z1 *= len;\n        z2 *= len;\n        let x0 = upy * z2 - upz * z1;\n        let x1 = upz * z0 - upx * z2;\n        let x2 = upx * z1 - upy * z0;\n        len = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\n        if (!len) {\n            x0 = 0;\n            x1 = 0;\n            x2 = 0;\n        }\n        else {\n            len = 1 / len;\n            x0 *= len;\n            x1 *= len;\n            x2 *= len;\n        }\n        let y0 = z1 * x2 - z2 * x1;\n        let y1 = z2 * x0 - z0 * x2;\n        let y2 = z0 * x1 - z1 * x0;\n        len = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);\n        if (!len) {\n            y0 = 0;\n            y1 = 0;\n            y2 = 0;\n        }\n        else {\n            len = 1 / len;\n            y0 *= len;\n            y1 *= len;\n            y2 *= len;\n        }\n        out[0] = x0;\n        out[1] = y0;\n        out[2] = z0;\n        out[3] = 0;\n        out[4] = x1;\n        out[5] = y1;\n        out[6] = z1;\n        out[7] = 0;\n        out[8] = x2;\n        out[9] = y2;\n        out[10] = z2;\n        out[11] = 0;\n        out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n        out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n        out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Generates a matrix that makes something look at something else.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param eye - Position of the viewer\n     * @param target - Point the viewer is looking at\n     * @param up - vec3 pointing up\n     * @returns `out`\n     */\n    static targetTo(out, eye, target, up) {\n        const eyex = eye[0];\n        const eyey = eye[1];\n        const eyez = eye[2];\n        const upx = up[0];\n        const upy = up[1];\n        const upz = up[2];\n        let z0 = eyex - target[0];\n        let z1 = eyey - target[1];\n        let z2 = eyez - target[2];\n        let len = z0 * z0 + z1 * z1 + z2 * z2;\n        if (len > 0) {\n            len = 1 / Math.sqrt(len);\n            z0 *= len;\n            z1 *= len;\n            z2 *= len;\n        }\n        let x0 = upy * z2 - upz * z1;\n        let x1 = upz * z0 - upx * z2;\n        let x2 = upx * z1 - upy * z0;\n        len = x0 * x0 + x1 * x1 + x2 * x2;\n        if (len > 0) {\n            len = 1 / Math.sqrt(len);\n            x0 *= len;\n            x1 *= len;\n            x2 *= len;\n        }\n        out[0] = x0;\n        out[1] = x1;\n        out[2] = x2;\n        out[3] = 0;\n        out[4] = z1 * x2 - z2 * x1;\n        out[5] = z2 * x0 - z0 * x2;\n        out[6] = z0 * x1 - z1 * x0;\n        out[7] = 0;\n        out[8] = z0;\n        out[9] = z1;\n        out[10] = z2;\n        out[11] = 0;\n        out[12] = eyex;\n        out[13] = eyey;\n        out[14] = eyez;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Returns Frobenius norm of a {@link Mat4}\n     * @category Static\n     *\n     * @param a - the matrix to calculate Frobenius norm of\n     * @returns Frobenius norm\n     */\n    static frob(a) {\n        return Math.sqrt(a[0] * a[0] +\n            a[1] * a[1] +\n            a[2] * a[2] +\n            a[3] * a[3] +\n            a[4] * a[4] +\n            a[5] * a[5] +\n            a[6] * a[6] +\n            a[7] * a[7] +\n            a[8] * a[8] +\n            a[9] * a[9] +\n            a[10] * a[10] +\n            a[11] * a[11] +\n            a[12] * a[12] +\n            a[13] * a[13] +\n            a[14] * a[14] +\n            a[15] * a[15]);\n    }\n    /**\n     * Adds two {@link Mat4}'s\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        out[3] = a[3] + b[3];\n        out[4] = a[4] + b[4];\n        out[5] = a[5] + b[5];\n        out[6] = a[6] + b[6];\n        out[7] = a[7] + b[7];\n        out[8] = a[8] + b[8];\n        out[9] = a[9] + b[9];\n        out[10] = a[10] + b[10];\n        out[11] = a[11] + b[11];\n        out[12] = a[12] + b[12];\n        out[13] = a[13] + b[13];\n        out[14] = a[14] + b[14];\n        out[15] = a[15] + b[15];\n        return out;\n    }\n    /**\n     * Subtracts matrix b from matrix a\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        out[2] = a[2] - b[2];\n        out[3] = a[3] - b[3];\n        out[4] = a[4] - b[4];\n        out[5] = a[5] - b[5];\n        out[6] = a[6] - b[6];\n        out[7] = a[7] - b[7];\n        out[8] = a[8] - b[8];\n        out[9] = a[9] - b[9];\n        out[10] = a[10] - b[10];\n        out[11] = a[11] - b[11];\n        out[12] = a[12] - b[12];\n        out[13] = a[13] - b[13];\n        out[14] = a[14] - b[14];\n        out[15] = a[15] - b[15];\n        return out;\n    }\n    /**\n     * Alias for {@link Mat4.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return out; }\n    /**\n     * Multiply each element of the matrix by a scalar.\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param b - amount to scale the matrix's elements by\n     * @returns `out`\n     */\n    static multiplyScalar(out, a, b) {\n        out[0] = a[0] * b;\n        out[1] = a[1] * b;\n        out[2] = a[2] * b;\n        out[3] = a[3] * b;\n        out[4] = a[4] * b;\n        out[5] = a[5] * b;\n        out[6] = a[6] * b;\n        out[7] = a[7] * b;\n        out[8] = a[8] * b;\n        out[9] = a[9] * b;\n        out[10] = a[10] * b;\n        out[11] = a[11] * b;\n        out[12] = a[12] * b;\n        out[13] = a[13] * b;\n        out[14] = a[14] * b;\n        out[15] = a[15] * b;\n        return out;\n    }\n    /**\n     * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param scale - the amount to scale b's elements by before adding\n     * @returns `out`\n     */\n    static multiplyScalarAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        out[2] = a[2] + b[2] * scale;\n        out[3] = a[3] + b[3] * scale;\n        out[4] = a[4] + b[4] * scale;\n        out[5] = a[5] + b[5] * scale;\n        out[6] = a[6] + b[6] * scale;\n        out[7] = a[7] + b[7] * scale;\n        out[8] = a[8] + b[8] * scale;\n        out[9] = a[9] + b[9] * scale;\n        out[10] = a[10] + b[10] * scale;\n        out[11] = a[11] + b[11] * scale;\n        out[12] = a[12] + b[12] * scale;\n        out[13] = a[13] + b[13] * scale;\n        out[14] = a[14] + b[14] * scale;\n        out[15] = a[15] + b[15] * scale;\n        return out;\n    }\n    /**\n     * Returns whether or not two {@link Mat4}s have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return (a[0] === b[0] &&\n            a[1] === b[1] &&\n            a[2] === b[2] &&\n            a[3] === b[3] &&\n            a[4] === b[4] &&\n            a[5] === b[5] &&\n            a[6] === b[6] &&\n            a[7] === b[7] &&\n            a[8] === b[8] &&\n            a[9] === b[9] &&\n            a[10] === b[10] &&\n            a[11] === b[11] &&\n            a[12] === b[12] &&\n            a[13] === b[13] &&\n            a[14] === b[14] &&\n            a[15] === b[15]);\n    }\n    /**\n     * Returns whether or not two {@link Mat4}s have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const a6 = a[6];\n        const a7 = a[7];\n        const a8 = a[8];\n        const a9 = a[9];\n        const a10 = a[10];\n        const a11 = a[11];\n        const a12 = a[12];\n        const a13 = a[13];\n        const a14 = a[14];\n        const a15 = a[15];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        const b4 = b[4];\n        const b5 = b[5];\n        const b6 = b[6];\n        const b7 = b[7];\n        const b8 = b[8];\n        const b9 = b[9];\n        const b10 = b[10];\n        const b11 = b[11];\n        const b12 = b[12];\n        const b13 = b[13];\n        const b14 = b[14];\n        const b15 = b[15];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= EPSILON * Math.max(1, Math.abs(a3), Math.abs(b3)) &&\n            Math.abs(a4 - b4) <= EPSILON * Math.max(1, Math.abs(a4), Math.abs(b4)) &&\n            Math.abs(a5 - b5) <= EPSILON * Math.max(1, Math.abs(a5), Math.abs(b5)) &&\n            Math.abs(a6 - b6) <= EPSILON * Math.max(1, Math.abs(a6), Math.abs(b6)) &&\n            Math.abs(a7 - b7) <= EPSILON * Math.max(1, Math.abs(a7), Math.abs(b7)) &&\n            Math.abs(a8 - b8) <= EPSILON * Math.max(1, Math.abs(a8), Math.abs(b8)) &&\n            Math.abs(a9 - b9) <= EPSILON * Math.max(1, Math.abs(a9), Math.abs(b9)) &&\n            Math.abs(a10 - b10) <= EPSILON * Math.max(1, Math.abs(a10), Math.abs(b10)) &&\n            Math.abs(a11 - b11) <= EPSILON * Math.max(1, Math.abs(a11), Math.abs(b11)) &&\n            Math.abs(a12 - b12) <= EPSILON * Math.max(1, Math.abs(a12), Math.abs(b12)) &&\n            Math.abs(a13 - b13) <= EPSILON * Math.max(1, Math.abs(a13), Math.abs(b13)) &&\n            Math.abs(a14 - b14) <= EPSILON * Math.max(1, Math.abs(a14), Math.abs(b14)) &&\n            Math.abs(a15 - b15) <= EPSILON * Math.max(1, Math.abs(a15), Math.abs(b15)));\n    }\n    /**\n     * Returns a string representation of a {@link Mat4}\n     * @category Static\n     *\n     * @param a - matrix to represent as a string\n     * @returns string representation of the matrix\n     */\n    static str(a) {\n        return `Mat4(${a.join(', ')})`;\n    }\n}\n// Temporary variables to prevent repeated allocations in the algorithms above.\nconst tmpVec3$1 = [0, 0, 0];\n// Instance method alias assignments\nMat4.prototype.mul = Mat4.prototype.multiply;\n// Static method alias assignments\nMat4.sub = Mat4.subtract;\nMat4.mul = Mat4.multiply;\nMat4.perspective = Mat4.perspectiveNO;\nMat4.ortho = Mat4.orthoNO;\n\n/**\n * 3 Dimensional Vector\n */\nclass Vec3 extends Float32Array {\n    /**\n    * The number of bytes in a {@link Vec3}.\n    */\n    static BYTE_LENGTH = 3 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n    * Create a {@link Vec3}.\n    */\n    constructor(...values) {\n        switch (values.length) {\n            case 3:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 3);\n                break;\n            case 1: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, v, v]);\n                }\n                else {\n                    super(v, 0, 3);\n                }\n                break;\n            }\n            default:\n                super(3);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    // Getters and setters to make component access read better.\n    // These are likely to be a little bit slower than direct array access.\n    /**\n     * The x component of the vector. Equivalent to `this[0];`\n     * @category Vector components\n     */\n    get x() { return this[0]; }\n    set x(value) { this[0] = value; }\n    /**\n     * The y component of the vector. Equivalent to `this[1];`\n     * @category Vector components\n     */\n    get y() { return this[1]; }\n    set y(value) { this[1] = value; }\n    /**\n     * The z component of the vector. Equivalent to `this[2];`\n     * @category Vector components\n     */\n    get z() { return this[2]; }\n    set z(value) { this[2] = value; }\n    // Alternate set of getters and setters in case this is being used to define\n    // a color.\n    /**\n     * The r component of the vector. Equivalent to `this[0];`\n     * @category Color components\n     */\n    get r() { return this[0]; }\n    set r(value) { this[0] = value; }\n    /**\n     * The g component of the vector. Equivalent to `this[1];`\n     * @category Color components\n     */\n    get g() { return this[1]; }\n    set g(value) { this[1] = value; }\n    /**\n     * The b component of the vector. Equivalent to `this[2];`\n     * @category Color components\n     */\n    get b() { return this[2]; }\n    set b(value) { this[2] = value; }\n    /**\n     * The magnitude (length) of this.\n     * Equivalent to `Vec3.magnitude(this);`\n     *\n     * Magnitude is used because the `length` attribute is already defined by\n     * `Float32Array` to mean the number of elements in the array.\n     */\n    get magnitude() {\n        const x = this[0];\n        const y = this[1];\n        const z = this[2];\n        return Math.sqrt(x * x + y * y + z * z);\n    }\n    /**\n     * Alias for {@link Vec3.magnitude}\n     */\n    get mag() { return this.magnitude; }\n    /**\n     * The squared magnitude (length) of `this`.\n     * Equivalent to `Vec3.squaredMagnitude(this);`\n     */\n    get squaredMagnitude() {\n        const x = this[0];\n        const y = this[1];\n        const z = this[2];\n        return x * x + y * y + z * z;\n    }\n    /**\n     * Alias for {@link Vec3.squaredMagnitude}\n     */\n    get sqrMag() { return this.squaredMagnitude; }\n    /**\n     * A string representation of `this`\n     * Equivalent to `Vec3.str(this);`\n     */\n    get str() {\n        return Vec3.str(this);\n    }\n    //===================\n    // Instances methods\n    //===================\n    /**\n     * Copy the values from another {@link Vec3} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        this.set(a);\n        return this;\n    }\n    /**\n     * Adds a {@link Vec3} to `this`.\n     * Equivalent to `Vec3.add(this, this, b);`\n     *\n     * @param b - The vector to add to `this`\n     * @returns `this`\n     */\n    add(b) {\n        this[0] += b[0];\n        this[1] += b[1];\n        this[2] += b[2];\n        return this;\n    }\n    /**\n     * Subtracts a {@link Vec3} from `this`.\n     * Equivalent to `Vec3.subtract(this, this, b);`\n     *\n     * @param b - The vector to subtract from `this`\n     * @returns `this`\n     */\n    subtract(b) {\n        this[0] -= b[0];\n        this[1] -= b[1];\n        this[2] -= b[2];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec3.subtract}\n     */\n    sub(b) { return this; }\n    /**\n     * Multiplies `this` by a {@link Vec3}.\n     * Equivalent to `Vec3.multiply(this, this, b);`\n     *\n     * @param b - The vector to multiply `this` by\n     * @returns `this`\n     */\n    multiply(b) {\n        this[0] *= b[0];\n        this[1] *= b[1];\n        this[2] *= b[2];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec3.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Divides `this` by a {@link Vec3}.\n     * Equivalent to `Vec3.divide(this, this, b);`\n     *\n     * @param b - The vector to divide `this` by\n     * @returns `this`\n     */\n    divide(b) {\n        this[0] /= b[0];\n        this[1] /= b[1];\n        this[2] /= b[2];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec3.divide}\n     */\n    div(b) { return this; }\n    /**\n     * Scales `this` by a scalar number.\n     * Equivalent to `Vec3.scale(this, this, b);`\n     *\n     * @param b - Amount to scale `this` by\n     * @returns `this`\n     */\n    scale(b) {\n        this[0] *= b;\n        this[1] *= b;\n        this[2] *= b;\n        return this;\n    }\n    /**\n     * Calculates `this` scaled by a scalar value then adds the result to `this`.\n     * Equivalent to `Vec3.scaleAndAdd(this, this, b, scale);`\n     *\n     * @param b - The vector to add to `this`\n     * @param scale - The amount to scale `b` by before adding\n     * @returns `this`\n     */\n    scaleAndAdd(b, scale) {\n        this[0] += b[0] * scale;\n        this[1] += b[1] * scale;\n        this[2] += b[2] * scale;\n        return this;\n    }\n    /**\n     * Calculates the euclidian distance between another {@link Vec3} and `this`.\n     * Equivalent to `Vec3.distance(this, b);`\n     *\n     * @param b - The vector to calculate the distance to\n     * @returns Distance between `this` and `b`\n     */\n    distance(b) {\n        return Vec3.distance(this, b);\n    }\n    /**\n     * Alias for {@link Vec3.distance}\n     */\n    dist(b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between another {@link Vec3} and `this`.\n     * Equivalent to `Vec3.squaredDistance(this, b);`\n     *\n     * @param b The vector to calculate the squared distance to\n     * @returns Squared distance between `this` and `b`\n     */\n    squaredDistance(b) {\n        return Vec3.squaredDistance(this, b);\n    }\n    /**\n     * Alias for {@link Vec3.squaredDistance}\n     */\n    sqrDist(b) { return 0; }\n    /**\n     * Negates the components of `this`.\n     * Equivalent to `Vec3.negate(this, this);`\n     *\n     * @returns `this`\n     */\n    negate() {\n        this[0] *= -1;\n        this[1] *= -1;\n        this[2] *= -1;\n        return this;\n    }\n    /**\n     * Inverts the components of `this`.\n     * Equivalent to `Vec3.inverse(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        this[0] = 1.0 / this[0];\n        this[1] = 1.0 / this[1];\n        this[2] = 1.0 / this[2];\n        return this;\n    }\n    /**\n     * Calculates the dot product of this and another {@link Vec3}.\n     * Equivalent to `Vec3.dot(this, b);`\n     *\n     * @param b - The second operand\n     * @returns Dot product of `this` and `b`\n     */\n    dot(b) {\n        return this[0] * b[0] + this[1] * b[1] + this[2] * b[2];\n    }\n    /**\n     * Normalize `this`.\n     * Equivalent to `Vec3.normalize(this, this);`\n     *\n     * @returns `this`\n     */\n    normalize() {\n        return Vec3.normalize(this, this);\n    }\n    //================\n    // Static methods\n    //================\n    /**\n     * Creates a new, empty vec3\n     * @category Static\n     *\n     * @returns a new 3D vector\n     */\n    static create() {\n        return new Vec3();\n    }\n    /**\n     * Creates a new vec3 initialized with values from an existing vector\n     * @category Static\n     *\n     * @param a - vector to clone\n     * @returns a new 3D vector\n     */\n    static clone(a) {\n        return new Vec3(a);\n    }\n    /**\n     * Calculates the magnitude (length) of a {@link Vec3}\n     * @category Static\n     *\n     * @param a - Vector to calculate magnitude of\n     * @returns Magnitude of a\n     */\n    static magnitude(a) {\n        let x = a[0];\n        let y = a[1];\n        let z = a[2];\n        return Math.sqrt(x * x + y * y + z * z);\n    }\n    /**\n     * Alias for {@link Vec3.magnitude}\n     * @category Static\n     */\n    static mag(a) { return 0; }\n    /**\n     * Alias for {@link Vec3.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec3.magnitude} to avoid conflicts with builtin `length` methods/attribs\n     *\n     * @param a - vector to calculate length of\n     * @returns length of a\n     */\n    // @ts-ignore: Length conflicts with Function.length\n    static length(a) { return 0; }\n    /**\n     * Alias for {@link Vec3.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec3.mag}\n     */\n    static len(a) { return 0; }\n    /**\n     * Creates a new vec3 initialized with the given values\n     * @category Static\n     *\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @returns a new 3D vector\n     */\n    static fromValues(x, y, z) {\n        return new Vec3(x, y, z);\n    }\n    /**\n     * Copy the values from one vec3 to another\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the source vector\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        return out;\n    }\n    /**\n     * Set the components of a vec3 to the given values\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @returns `out`\n     */\n    static set(out, x, y, z) {\n        out[0] = x;\n        out[1] = y;\n        out[2] = z;\n        return out;\n    }\n    /**\n     * Adds two {@link Vec3}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        return out;\n    }\n    /**\n     * Subtracts vector b from vector a\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        out[2] = a[2] - b[2];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec3.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return [0, 0, 0]; }\n    ;\n    /**\n     * Multiplies two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        out[0] = a[0] * b[0];\n        out[1] = a[1] * b[1];\n        out[2] = a[2] * b[2];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec3.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return [0, 0, 0]; }\n    /**\n     * Divides two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static divide(out, a, b) {\n        out[0] = a[0] / b[0];\n        out[1] = a[1] / b[1];\n        out[2] = a[2] / b[2];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec3.divide}\n     * @category Static\n     */\n    static div(out, a, b) { return [0, 0, 0]; }\n    ;\n    /**\n     * Math.ceil the components of a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to ceil\n     * @returns `out`\n     */\n    static ceil(out, a) {\n        out[0] = Math.ceil(a[0]);\n        out[1] = Math.ceil(a[1]);\n        out[2] = Math.ceil(a[2]);\n        return out;\n    }\n    /**\n     * Math.floor the components of a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to floor\n     * @returns `out`\n     */\n    static floor(out, a) {\n        out[0] = Math.floor(a[0]);\n        out[1] = Math.floor(a[1]);\n        out[2] = Math.floor(a[2]);\n        return out;\n    }\n    /**\n     * Returns the minimum of two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static min(out, a, b) {\n        out[0] = Math.min(a[0], b[0]);\n        out[1] = Math.min(a[1], b[1]);\n        out[2] = Math.min(a[2], b[2]);\n        return out;\n    }\n    /**\n     * Returns the maximum of two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static max(out, a, b) {\n        out[0] = Math.max(a[0], b[0]);\n        out[1] = Math.max(a[1], b[1]);\n        out[2] = Math.max(a[2], b[2]);\n        return out;\n    }\n    /**\n     * symmetric round the components of a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to round\n     * @returns `out`\n     */\n    /*static round(out: Vec3Like, a: Readonly<Vec3Like>): Vec3Like {\n      out[0] = glMatrix.round(a[0]);\n      out[1] = glMatrix.round(a[1]);\n      out[2] = glMatrix.round(a[2]);\n      return out;\n    }*/\n    /**\n     * Scales a vec3 by a scalar number\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to scale\n     * @param scale - amount to scale the vector by\n     * @returns `out`\n     */\n    static scale(out, a, scale) {\n        out[0] = a[0] * scale;\n        out[1] = a[1] * scale;\n        out[2] = a[2] * scale;\n        return out;\n    }\n    /**\n     * Adds two vec3's after scaling the second operand by a scalar value\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param scale - the amount to scale b by before adding\n     * @returns `out`\n     */\n    static scaleAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        out[2] = a[2] + b[2] * scale;\n        return out;\n    }\n    /**\n     * Calculates the euclidian distance between two vec3's\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns distance between a and b\n     */\n    static distance(a, b) {\n        const x = b[0] - a[0];\n        const y = b[1] - a[1];\n        const z = b[2] - a[2];\n        return Math.sqrt(x * x + y * y + z * z);\n    }\n    /**\n     * Alias for {@link Vec3.distance}\n     */\n    static dist(a, b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between two vec3's\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns squared distance between a and b\n     */\n    static squaredDistance(a, b) {\n        const x = b[0] - a[0];\n        const y = b[1] - a[1];\n        const z = b[2] - a[2];\n        return x * x + y * y + z * z;\n    }\n    /**\n     * Alias for {@link Vec3.squaredDistance}\n     */\n    static sqrDist(a, b) { return 0; }\n    /**\n     * Calculates the squared length of a vec3\n     * @category Static\n     *\n     * @param a - vector to calculate squared length of\n     * @returns squared length of a\n     */\n    static squaredLength(a) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        return x * x + y * y + z * z;\n    }\n    /**\n     * Alias for {@link Vec3.squaredLength}\n     */\n    static sqrLen(a, b) { return 0; }\n    /**\n     * Negates the components of a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to negate\n     * @returns `out`\n     */\n    static negate(out, a) {\n        out[0] = -a[0];\n        out[1] = -a[1];\n        out[2] = -a[2];\n        return out;\n    }\n    /**\n     * Returns the inverse of the components of a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to invert\n     * @returns `out`\n     */\n    static inverse(out, a) {\n        out[0] = 1.0 / a[0];\n        out[1] = 1.0 / a[1];\n        out[2] = 1.0 / a[2];\n        return out;\n    }\n    /**\n     * Normalize a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to normalize\n     * @returns `out`\n     */\n    static normalize(out, a) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        let len = x * x + y * y + z * z;\n        if (len > 0) {\n            //TODO: evaluate use of glm_invsqrt here?\n            len = 1 / Math.sqrt(len);\n        }\n        out[0] = a[0] * len;\n        out[1] = a[1] * len;\n        out[2] = a[2] * len;\n        return out;\n    }\n    /**\n     * Calculates the dot product of two vec3's\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns dot product of a and b\n     */\n    static dot(a, b) {\n        return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n    }\n    /**\n     * Computes the cross product of two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static cross(out, a, b) {\n        const ax = a[0], ay = a[1], az = a[2];\n        const bx = b[0], by = b[1], bz = b[2];\n        out[0] = ay * bz - az * by;\n        out[1] = az * bx - ax * bz;\n        out[2] = ax * by - ay * bx;\n        return out;\n    }\n    /**\n     * Performs a linear interpolation between two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static lerp(out, a, b, t) {\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        out[0] = ax + t * (b[0] - ax);\n        out[1] = ay + t * (b[1] - ay);\n        out[2] = az + t * (b[2] - az);\n        return out;\n    }\n    /**\n     * Performs a spherical linear interpolation between two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static slerp(out, a, b, t) {\n        const angle = Math.acos(Math.min(Math.max(Vec3.dot(a, b), -1), 1));\n        const sinTotal = Math.sin(angle);\n        const ratioA = Math.sin((1 - t) * angle) / sinTotal;\n        const ratioB = Math.sin(t * angle) / sinTotal;\n        out[0] = ratioA * a[0] + ratioB * b[0];\n        out[1] = ratioA * a[1] + ratioB * b[1];\n        out[2] = ratioA * a[2] + ratioB * b[2];\n        return out;\n    }\n    /**\n     * Performs a hermite interpolation with two control points\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param c - the third operand\n     * @param d - the fourth operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static hermite(out, a, b, c, d, t) {\n        const factorTimes2 = t * t;\n        const factor1 = factorTimes2 * (2 * t - 3) + 1;\n        const factor2 = factorTimes2 * (t - 2) + t;\n        const factor3 = factorTimes2 * (t - 1);\n        const factor4 = factorTimes2 * (3 - 2 * t);\n        out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n        out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n        out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n        return out;\n    }\n    /**\n     * Performs a bezier interpolation with two control points\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param c - the third operand\n     * @param d - the fourth operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static bezier(out, a, b, c, d, t) {\n        const inverseFactor = 1 - t;\n        const inverseFactorTimesTwo = inverseFactor * inverseFactor;\n        const factorTimes2 = t * t;\n        const factor1 = inverseFactorTimesTwo * inverseFactor;\n        const factor2 = 3 * t * inverseFactorTimesTwo;\n        const factor3 = 3 * factorTimes2 * inverseFactor;\n        const factor4 = factorTimes2 * t;\n        out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n        out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n        out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n        return out;\n    }\n    /**\n     * Generates a random vector with the given scale\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param {Number} [scale] Length of the resulting vector. If omitted, a unit vector will be returned\n     * @returns `out`\n     */\n    /*static random(out: Vec3Like, scale) {\n      scale = scale === undefined ? 1.0 : scale;\n  \n      let r = glMatrix.RANDOM() * 2.0 * Math.PI;\n      let z = glMatrix.RANDOM() * 2.0 - 1.0;\n      let zScale = Math.sqrt(1.0 - z * z) * scale;\n  \n      out[0] = Math.cos(r) * zScale;\n      out[1] = Math.sin(r) * zScale;\n      out[2] = z * scale;\n      return out;\n    }*/\n    /**\n     * Transforms the vec3 with a mat4.\n     * 4th vector component is implicitly '1'\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to transform\n     * @param m - matrix to transform with\n     * @returns `out`\n     */\n    static transformMat4(out, a, m) {\n        const x = a[0], y = a[1], z = a[2];\n        const w = (m[3] * x + m[7] * y + m[11] * z + m[15]) || 1.0;\n        out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n        out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n        out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n        return out;\n    }\n    /**\n     * Transforms the vec3 with a mat3.\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to transform\n     * @param m - the 3x3 matrix to transform with\n     * @returns `out`\n     */\n    static transformMat3(out, a, m) {\n        let x = a[0], y = a[1], z = a[2];\n        out[0] = x * m[0] + y * m[3] + z * m[6];\n        out[1] = x * m[1] + y * m[4] + z * m[7];\n        out[2] = x * m[2] + y * m[5] + z * m[8];\n        return out;\n    }\n    /**\n     * Transforms the vec3 with a quat\n     * Can also be used for dual quaternions. (Multiply it with the real part)\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to transform\n     * @param q - quaternion to transform with\n     * @returns `out`\n     */\n    static transformQuat(out, a, q) {\n        // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n        const qx = q[0];\n        const qy = q[1];\n        const qz = q[2];\n        const w2 = q[3] * 2;\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        // var qvec = [qx, qy, qz];\n        // var uv = vec3.cross([], qvec, a);\n        const uvx = (qy * z - qz * y);\n        const uvy = (qz * x - qx * z);\n        const uvz = (qx * y - qy * x);\n        // var uuv = vec3.cross([], qvec, uv);\n        // vec3.scale(uuv, uuv, 2);\n        const uuvx = (qy * uvz - qz * uvy) * 2;\n        const uuvy = (qz * uvx - qx * uvz) * 2;\n        const uuvz = (qx * uvy - qy * uvx) * 2;\n        // vec3.scale(uv, uv, 2 * w);\n        // return vec3.add(out, a, vec3.add(out, uv, uuv));\n        out[0] = x + (uvx * w2) + uuvx;\n        out[1] = y + (uvy * w2) + uuvy;\n        out[2] = z + (uvz * w2) + uuvz;\n        return out;\n    }\n    /**\n     * Rotate a 3D vector around the x-axis\n     * @param out - The receiving vec3\n     * @param a - The vec3 point to rotate\n     * @param b - The origin of the rotation\n     * @param rad - The angle of rotation in radians\n     * @returns `out`\n     */\n    static rotateX(out, a, b, rad) {\n        const by = b[1];\n        const bz = b[2];\n        //Translate point to the origin\n        const py = a[1] - by;\n        const pz = a[2] - bz;\n        //perform rotation\n        //translate to correct position\n        out[0] = a[0];\n        out[1] = (py * Math.cos(rad) - pz * Math.sin(rad)) + by;\n        out[2] = (py * Math.sin(rad) + pz * Math.cos(rad)) + bz;\n        return out;\n    }\n    /**\n     * Rotate a 3D vector around the y-axis\n     * @param out - The receiving vec3\n     * @param a - The vec3 point to rotate\n     * @param b - The origin of the rotation\n     * @param rad - The angle of rotation in radians\n     * @returns `out`\n     */\n    static rotateY(out, a, b, rad) {\n        const bx = b[0];\n        const bz = b[2];\n        //Translate point to the origin\n        const px = a[0] - bx;\n        const pz = a[2] - bz;\n        //perform rotation\n        //translate to correct position\n        out[0] = (pz * Math.sin(rad) + px * Math.cos(rad)) + bx;\n        out[1] = a[1];\n        out[2] = (pz * Math.cos(rad) - px * Math.sin(rad)) + bz;\n        return out;\n    }\n    /**\n     * Rotate a 3D vector around the z-axis\n     * @param out - The receiving vec3\n     * @param a - The vec3 point to rotate\n     * @param b - The origin of the rotation\n     * @param rad - The angle of rotation in radians\n     * @returns `out`\n     */\n    static rotateZ(out, a, b, rad) {\n        const bx = b[0];\n        const by = b[1];\n        //Translate point to the origin\n        const px = a[0] - bx;\n        const py = a[1] - by;\n        //perform rotation\n        //translate to correct position\n        out[0] = (px * Math.cos(rad) - py * Math.sin(rad)) + bx;\n        out[1] = (px * Math.sin(rad) + py * Math.cos(rad)) + by;\n        out[2] = b[2];\n        return out;\n    }\n    /**\n     * Get the angle between two 3D vectors\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns The angle in radians\n     */\n    static angle(a, b) {\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const bx = b[0];\n        const by = b[1];\n        const bz = b[2];\n        const mag = Math.sqrt((ax * ax + ay * ay + az * az) * (bx * bx + by * by + bz * bz));\n        const cosine = mag && Vec3.dot(a, b) / mag;\n        return Math.acos(Math.min(Math.max(cosine, -1), 1));\n    }\n    /**\n     * Set the components of a vec3 to zero\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @returns `out`\n     */\n    static zero(out) {\n        out[0] = 0.0;\n        out[1] = 0.0;\n        out[2] = 0.0;\n        return out;\n    }\n    /**\n     * Returns a string representation of a vector\n     * @category Static\n     *\n     * @param a - vector to represent as a string\n     * @returns string representation of the vector\n     */\n    static str(a) {\n        return `Vec3(${a.join(', ')})`;\n    }\n    /**\n     * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n    }\n    /**\n     * Returns whether or not the vectors have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)));\n    }\n}\n// Instance method alias assignments\nVec3.prototype.sub = Vec3.prototype.subtract;\nVec3.prototype.mul = Vec3.prototype.multiply;\nVec3.prototype.div = Vec3.prototype.divide;\nVec3.prototype.dist = Vec3.prototype.distance;\nVec3.prototype.sqrDist = Vec3.prototype.squaredDistance;\n// Static method alias assignments\nVec3.sub = Vec3.subtract;\nVec3.mul = Vec3.multiply;\nVec3.div = Vec3.divide;\nVec3.dist = Vec3.distance;\nVec3.sqrDist = Vec3.squaredDistance;\nVec3.sqrLen = Vec3.squaredLength;\nVec3.mag = Vec3.magnitude;\nVec3.length = Vec3.magnitude;\nVec3.len = Vec3.magnitude;\n\n/**\n * 4 Dimensional Vector\n */\nclass Vec4 extends Float32Array {\n    /**\n     * The number of bytes in a {@link Vec4}.\n     */\n    static BYTE_LENGTH = 4 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Vec4}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 4:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 4);\n                break;\n            case 1: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, v, v, v]);\n                }\n                else {\n                    super(v, 0, 4);\n                }\n                break;\n            }\n            default:\n                super(4);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    // Getters and setters to make component access read better.\n    // These are likely to be a little bit slower than direct array access.\n    /**\n     * The x component of the vector. Equivalent to `this[0];`\n     * @category Vector components\n     */\n    get x() { return this[0]; }\n    set x(value) { this[0] = value; }\n    /**\n     * The y component of the vector. Equivalent to `this[1];`\n     * @category Vector components\n     */\n    get y() { return this[1]; }\n    set y(value) { this[1] = value; }\n    /**\n     * The z component of the vector. Equivalent to `this[2];`\n     * @category Vector components\n     */\n    get z() { return this[2]; }\n    set z(value) { this[2] = value; }\n    /**\n     * The w component of the vector. Equivalent to `this[3];`\n     * @category Vector components\n     */\n    get w() { return this[3]; }\n    set w(value) { this[3] = value; }\n    // Alternate set of getters and setters in case this is being used to define\n    // a color.\n    /**\n     * The r component of the vector. Equivalent to `this[0];`\n     * @category Color components\n     */\n    get r() { return this[0]; }\n    set r(value) { this[0] = value; }\n    /**\n     * The g component of the vector. Equivalent to `this[1];`\n     * @category Color components\n     */\n    get g() { return this[1]; }\n    set g(value) { this[1] = value; }\n    /**\n     * The b component of the vector. Equivalent to `this[2];`\n     * @category Color components\n     */\n    get b() { return this[2]; }\n    set b(value) { this[2] = value; }\n    /**\n     * The a component of the vector. Equivalent to `this[3];`\n     * @category Color components\n     */\n    get a() { return this[3]; }\n    set a(value) { this[3] = value; }\n    /**\n     * The magnitude (length) of this.\n     * Equivalent to `Vec4.magnitude(this);`\n     *\n     * Magnitude is used because the `length` attribute is already defined by\n     * `Float32Array` to mean the number of elements in the array.\n     */\n    get magnitude() {\n        const x = this[0];\n        const y = this[1];\n        const z = this[2];\n        const w = this[3];\n        return Math.sqrt(x * x + y * y + z * z + w * w);\n    }\n    /**\n     * Alias for {@link Vec4.magnitude}\n     */\n    get mag() { return this.magnitude; }\n    /**\n     * A string representation of `this`\n     * Equivalent to `Vec4.str(this);`\n     */\n    get str() {\n        return Vec4.str(this);\n    }\n    //===================\n    // Instances methods\n    //===================\n    /**\n     * Copy the values from another {@link Vec4} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        super.set(a);\n        return this;\n    }\n    /**\n     * Adds a {@link Vec4} to `this`.\n     * Equivalent to `Vec4.add(this, this, b);`\n     *\n     * @param b - The vector to add to `this`\n     * @returns `this`\n     */\n    add(b) {\n        this[0] += b[0];\n        this[1] += b[1];\n        this[2] += b[2];\n        this[3] += b[3];\n        return this;\n    }\n    /**\n     * Subtracts a {@link Vec4} from `this`.\n     * Equivalent to `Vec4.subtract(this, this, b);`\n     *\n     * @param b - The vector to subtract from `this`\n     * @returns `this`\n     */\n    subtract(b) {\n        this[0] -= b[0];\n        this[1] -= b[1];\n        this[2] -= b[2];\n        this[3] -= b[3];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec4.subtract}\n     */\n    sub(b) { return this; }\n    /**\n     * Multiplies `this` by a {@link Vec4}.\n     * Equivalent to `Vec4.multiply(this, this, b);`\n     *\n     * @param b - The vector to multiply `this` by\n     * @returns `this`\n     */\n    multiply(b) {\n        this[0] *= b[0];\n        this[1] *= b[1];\n        this[2] *= b[2];\n        this[3] *= b[3];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec4.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Divides `this` by a {@link Vec4}.\n     * Equivalent to `Vec4.divide(this, this, b);`\n     *\n     * @param b - The vector to divide `this` by\n     * @returns `this`\n     */\n    divide(b) {\n        this[0] /= b[0];\n        this[1] /= b[1];\n        this[2] /= b[2];\n        this[3] /= b[3];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec4.divide}\n     */\n    div(b) { return this; }\n    /**\n     * Scales `this` by a scalar number.\n     * Equivalent to `Vec4.scale(this, this, b);`\n     *\n     * @param b - Amount to scale `this` by\n     * @returns `this`\n     */\n    scale(b) {\n        this[0] *= b;\n        this[1] *= b;\n        this[2] *= b;\n        this[3] *= b;\n        return this;\n    }\n    /**\n     * Calculates `this` scaled by a scalar value then adds the result to `this`.\n     * Equivalent to `Vec4.scaleAndAdd(this, this, b, scale);`\n     *\n     * @param b - The vector to add to `this`\n     * @param scale - The amount to scale `b` by before adding\n     * @returns `this`\n     */\n    scaleAndAdd(b, scale) {\n        this[0] += b[0] * scale;\n        this[1] += b[1] * scale;\n        this[2] += b[2] * scale;\n        this[3] += b[3] * scale;\n        return this;\n    }\n    /**\n     * Calculates the euclidian distance between another {@link Vec4} and `this`.\n     * Equivalent to `Vec4.distance(this, b);`\n     *\n     * @param b - The vector to calculate the distance to\n     * @returns Distance between `this` and `b`\n     */\n    distance(b) {\n        return Vec4.distance(this, b);\n    }\n    /**\n     * Alias for {@link Vec4.distance}\n     */\n    dist(b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between another {@link Vec4} and `this`.\n     * Equivalent to `Vec4.squaredDistance(this, b);`\n     *\n     * @param b The vector to calculate the squared distance to\n     * @returns Squared distance between `this` and `b`\n     */\n    squaredDistance(b) {\n        return Vec4.squaredDistance(this, b);\n    }\n    /**\n     * Alias for {@link Vec4.squaredDistance}\n     */\n    sqrDist(b) { return 0; }\n    /**\n     * Negates the components of `this`.\n     * Equivalent to `Vec4.negate(this, this);`\n     *\n     * @returns `this`\n     */\n    negate() {\n        this[0] *= -1;\n        this[1] *= -1;\n        this[2] *= -1;\n        this[3] *= -1;\n        return this;\n    }\n    /**\n     * Inverts the components of `this`.\n     * Equivalent to `Vec4.inverse(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        this[0] = 1.0 / this[0];\n        this[1] = 1.0 / this[1];\n        this[2] = 1.0 / this[2];\n        this[3] = 1.0 / this[3];\n        return this;\n    }\n    /**\n     * Calculates the dot product of this and another {@link Vec4}.\n     * Equivalent to `Vec4.dot(this, b);`\n     *\n     * @param b - The second operand\n     * @returns Dot product of `this` and `b`\n     */\n    dot(b) {\n        return this[0] * b[0] + this[1] * b[1] + this[2] * b[2] + this[3] * b[3];\n    }\n    /**\n     * Normalize `this`.\n     * Equivalent to `Vec4.normalize(this, this);`\n     *\n     * @returns `this`\n     */\n    normalize() {\n        return Vec4.normalize(this, this);\n    }\n    //===================\n    // Static methods\n    //===================\n    /**\n     * Creates a new, empty {@link Vec4}\n     * @category Static\n     *\n     * @returns a new 4D vector\n     */\n    static create() {\n        return new Vec4();\n    }\n    /**\n     * Creates a new {@link Vec4} initialized with values from an existing vector\n     * @category Static\n     *\n     * @param a - vector to clone\n     * @returns a new 4D vector\n     */\n    static clone(a) {\n        return new Vec4(a);\n    }\n    /**\n     * Creates a new {@link Vec4} initialized with the given values\n     * @category Static\n     *\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @param w - W component\n     * @returns a new 4D vector\n     */\n    static fromValues(x, y, z, w) {\n        return new Vec4(x, y, z, w);\n    }\n    /**\n     * Copy the values from one {@link Vec4} to another\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the source vector\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        return out;\n    }\n    /**\n     * Set the components of a {@link Vec4} to the given values\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @param w - W component\n     * @returns `out`\n     */\n    static set(out, x, y, z, w) {\n        out[0] = x;\n        out[1] = y;\n        out[2] = z;\n        out[3] = w;\n        return out;\n    }\n    /**\n     * Adds two {@link Vec4}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        out[3] = a[3] + b[3];\n        return out;\n    }\n    /**\n     * Subtracts vector b from vector a\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        out[2] = a[2] - b[2];\n        out[3] = a[3] - b[3];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec4.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return out; }\n    /**\n     * Multiplies two {@link Vec4}'s\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        out[0] = a[0] * b[0];\n        out[1] = a[1] * b[1];\n        out[2] = a[2] * b[2];\n        out[3] = a[3] * b[3];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec4.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Divides two {@link Vec4}'s\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static divide(out, a, b) {\n        out[0] = a[0] / b[0];\n        out[1] = a[1] / b[1];\n        out[2] = a[2] / b[2];\n        out[3] = a[3] / b[3];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec4.divide}\n     * @category Static\n     */\n    static div(out, a, b) { return out; }\n    /**\n     * Math.ceil the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to ceil\n     * @returns `out`\n     */\n    static ceil(out, a) {\n        out[0] = Math.ceil(a[0]);\n        out[1] = Math.ceil(a[1]);\n        out[2] = Math.ceil(a[2]);\n        out[3] = Math.ceil(a[3]);\n        return out;\n    }\n    /**\n     * Math.floor the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to floor\n     * @returns `out`\n     */\n    static floor(out, a) {\n        out[0] = Math.floor(a[0]);\n        out[1] = Math.floor(a[1]);\n        out[2] = Math.floor(a[2]);\n        out[3] = Math.floor(a[3]);\n        return out;\n    }\n    /**\n     * Returns the minimum of two {@link Vec4}'s\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static min(out, a, b) {\n        out[0] = Math.min(a[0], b[0]);\n        out[1] = Math.min(a[1], b[1]);\n        out[2] = Math.min(a[2], b[2]);\n        out[3] = Math.min(a[3], b[3]);\n        return out;\n    }\n    /**\n     * Returns the maximum of two {@link Vec4}'s\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static max(out, a, b) {\n        out[0] = Math.max(a[0], b[0]);\n        out[1] = Math.max(a[1], b[1]);\n        out[2] = Math.max(a[2], b[2]);\n        out[3] = Math.max(a[3], b[3]);\n        return out;\n    }\n    /**\n     * Math.round the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to round\n     * @returns `out`\n     */\n    static round(out, a) {\n        out[0] = Math.round(a[0]);\n        out[1] = Math.round(a[1]);\n        out[2] = Math.round(a[2]);\n        out[3] = Math.round(a[3]);\n        return out;\n    }\n    /**\n     * Scales a {@link Vec4} by a scalar number\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to scale\n     * @param scale - amount to scale the vector by\n     * @returns `out`\n     */\n    static scale(out, a, scale) {\n        out[0] = a[0] * scale;\n        out[1] = a[1] * scale;\n        out[2] = a[2] * scale;\n        out[3] = a[3] * scale;\n        return out;\n    }\n    /**\n     * Adds two {@link Vec4}'s after scaling the second operand by a scalar value\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param scale - the amount to scale b by before adding\n     * @returns `out`\n     */\n    static scaleAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        out[2] = a[2] + b[2] * scale;\n        out[3] = a[3] + b[3] * scale;\n        return out;\n    }\n    /**\n     * Calculates the euclidian distance between two {@link Vec4}'s\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns distance between a and b\n     */\n    static distance(a, b) {\n        const x = b[0] - a[0];\n        const y = b[1] - a[1];\n        const z = b[2] - a[2];\n        const w = b[3] - a[3];\n        return Math.hypot(x, y, z, w);\n    }\n    /**\n     * Alias for {@link Vec4.distance}\n     * @category Static\n     */\n    static dist(a, b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between two {@link Vec4}'s\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns squared distance between a and b\n     */\n    static squaredDistance(a, b) {\n        const x = b[0] - a[0];\n        const y = b[1] - a[1];\n        const z = b[2] - a[2];\n        const w = b[3] - a[3];\n        return x * x + y * y + z * z + w * w;\n    }\n    /**\n     * Alias for {@link Vec4.squaredDistance}\n     * @category Static\n     */\n    static sqrDist(a, b) { return 0; }\n    /**\n     * Calculates the magnitude (length) of a {@link Vec4}\n     * @category Static\n     *\n     * @param a - vector to calculate length of\n     * @returns length of `a`\n     */\n    static magnitude(a) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        const w = a[3];\n        return Math.sqrt(x * x + y * y + z * z + w * w);\n    }\n    /**\n     * Alias for {@link Vec4.magnitude}\n     * @category Static\n     */\n    static mag(a) { return 0; }\n    /**\n     * Alias for {@link Vec4.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec4.magnitude} to avoid conflicts with builtin `length` methods/attribs\n     */\n    // @ts-ignore: Length conflicts with Function.length\n    static length(a) { return 0; }\n    /**\n     * Alias for {@link Vec4.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec4.mag}\n     */\n    static len(a) { return 0; }\n    /**\n     * Calculates the squared length of a {@link Vec4}\n     * @category Static\n     *\n     * @param a - vector to calculate squared length of\n     * @returns squared length of a\n     */\n    static squaredLength(a) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        const w = a[3];\n        return x * x + y * y + z * z + w * w;\n    }\n    /**\n     * Alias for {@link Vec4.squaredLength}\n     * @category Static\n     */\n    static sqrLen(a) { return 0; }\n    /**\n     * Negates the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to negate\n     * @returns `out`\n     */\n    static negate(out, a) {\n        out[0] = -a[0];\n        out[1] = -a[1];\n        out[2] = -a[2];\n        out[3] = -a[3];\n        return out;\n    }\n    /**\n     * Returns the inverse of the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to invert\n     * @returns `out`\n     */\n    static inverse(out, a) {\n        out[0] = 1.0 / a[0];\n        out[1] = 1.0 / a[1];\n        out[2] = 1.0 / a[2];\n        out[3] = 1.0 / a[3];\n        return out;\n    }\n    /**\n     * Normalize a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to normalize\n     * @returns `out`\n     */\n    static normalize(out, a) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        const w = a[3];\n        let len = x * x + y * y + z * z + w * w;\n        if (len > 0) {\n            len = 1 / Math.sqrt(len);\n        }\n        out[0] = x * len;\n        out[1] = y * len;\n        out[2] = z * len;\n        out[3] = w * len;\n        return out;\n    }\n    /**\n     * Calculates the dot product of two {@link Vec4}'s\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns dot product of a and b\n     */\n    static dot(a, b) {\n        return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n    }\n    /**\n     * Returns the cross-product of three vectors in a 4-dimensional space\n     * @category Static\n     *\n     * @param out the receiving vector\n     * @param u - the first vector\n     * @param v - the second vector\n     * @param w - the third vector\n     * @returns result\n     */\n    static cross(out, u, v, w) {\n        const a = v[0] * w[1] - v[1] * w[0];\n        const b = v[0] * w[2] - v[2] * w[0];\n        const c = v[0] * w[3] - v[3] * w[0];\n        const d = v[1] * w[2] - v[2] * w[1];\n        const e = v[1] * w[3] - v[3] * w[1];\n        const f = v[2] * w[3] - v[3] * w[2];\n        const g = u[0];\n        const h = u[1];\n        const i = u[2];\n        const j = u[3];\n        out[0] = h * f - i * e + j * d;\n        out[1] = -(g * f) + i * c - j * b;\n        out[2] = g * e - h * c + j * a;\n        out[3] = -(g * d) + h * b - i * a;\n        return out;\n    }\n    /**\n     * Performs a linear interpolation between two {@link Vec4}'s\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static lerp(out, a, b, t) {\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const aw = a[3];\n        out[0] = ax + t * (b[0] - ax);\n        out[1] = ay + t * (b[1] - ay);\n        out[2] = az + t * (b[2] - az);\n        out[3] = aw + t * (b[3] - aw);\n        return out;\n    }\n    /**\n     * Generates a random vector with the given scale\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param [scale] - Length of the resulting vector. If ommitted, a unit vector will be returned\n     * @returns `out`\n     */\n    /*static random(out: Vec4Like, scale): Vec4Like {\n      scale = scale || 1.0;\n  \n      // Marsaglia, George. Choosing a Point from the Surface of a\n      // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n      // http://projecteuclid.org/euclid.aoms/1177692644;\n      var v1, v2, v3, v4;\n      var s1, s2;\n      do {\n        v1 = glMatrix.RANDOM() * 2 - 1;\n        v2 = glMatrix.RANDOM() * 2 - 1;\n        s1 = v1 * v1 + v2 * v2;\n      } while (s1 >= 1);\n      do {\n        v3 = glMatrix.RANDOM() * 2 - 1;\n        v4 = glMatrix.RANDOM() * 2 - 1;\n        s2 = v3 * v3 + v4 * v4;\n      } while (s2 >= 1);\n  \n      var d = Math.sqrt((1 - s1) / s2);\n      out[0] = scale * v1;\n      out[1] = scale * v2;\n      out[2] = scale * v3 * d;\n      out[3] = scale * v4 * d;\n      return out;\n    }*/\n    /**\n     * Transforms the {@link Vec4} with a {@link Mat4}.\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to transform\n     * @param m - matrix to transform with\n     * @returns `out`\n     */\n    static transformMat4(out, a, m) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        const w = a[3];\n        out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n        out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n        out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n        out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n        return out;\n    }\n    /**\n     * Transforms the {@link Vec4} with a {@link Quat}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to transform\n     * @param q - quaternion to transform with\n     * @returns `out`\n     */\n    static transformQuat(out, a, q) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        const qx = q[0];\n        const qy = q[1];\n        const qz = q[2];\n        const qw = q[3];\n        // calculate quat * vec\n        const ix = qw * x + qy * z - qz * y;\n        const iy = qw * y + qz * x - qx * z;\n        const iz = qw * z + qx * y - qy * x;\n        const iw = -qx * x - qy * y - qz * z;\n        // calculate result * inverse quat\n        out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n        out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n        out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n        out[3] = a[3];\n        return out;\n    }\n    /**\n     * Set the components of a {@link Vec4} to zero\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @returns `out`\n     */\n    static zero(out) {\n        out[0] = 0.0;\n        out[1] = 0.0;\n        out[2] = 0.0;\n        out[3] = 0.0;\n        return out;\n    }\n    /**\n     * Returns a string representation of a {@link Vec4}\n     * @category Static\n     *\n     * @param a - vector to represent as a string\n     * @returns string representation of the vector\n     */\n    static str(a) {\n        return `Vec4(${a.join(', ')})`;\n    }\n    /**\n     * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n    }\n    /**\n     * Returns whether or not the vectors have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)));\n    }\n}\n// Instance method alias assignments\nVec4.prototype.sub = Vec4.prototype.subtract;\nVec4.prototype.mul = Vec4.prototype.multiply;\nVec4.prototype.div = Vec4.prototype.divide;\nVec4.prototype.dist = Vec4.prototype.distance;\nVec4.prototype.sqrDist = Vec4.prototype.squaredDistance;\n// Static method alias assignments\nVec4.sub = Vec4.subtract;\nVec4.mul = Vec4.multiply;\nVec4.div = Vec4.divide;\nVec4.dist = Vec4.distance;\nVec4.sqrDist = Vec4.squaredDistance;\nVec4.sqrLen = Vec4.squaredLength;\nVec4.mag = Vec4.magnitude;\nVec4.length = Vec4.magnitude;\nVec4.len = Vec4.magnitude;\n\n/**\n * Quaternion\n */\nclass Quat extends Float32Array {\n    /**\n     * The number of bytes in a {@link Quat}.\n     */\n    static BYTE_LENGTH = 4 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Quat}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 4:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 4);\n                break;\n            case 1: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, v, v, v]);\n                }\n                else {\n                    super(v, 0, 4);\n                }\n                break;\n            }\n            default:\n                super(4);\n                this[3] = 1;\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    // Getters and setters to make component access read better.\n    // These are likely to be a little bit slower than direct array access.\n    /**\n     * The x component of the quaternion. Equivalent to `this[0];`\n     * @category Quaternion components\n     */\n    get x() { return this[0]; }\n    set x(value) { this[0] = value; }\n    /**\n     * The y component of the quaternion. Equivalent to `this[1];`\n     * @category Quaternion components\n     */\n    get y() { return this[1]; }\n    set y(value) { this[1] = value; }\n    /**\n     * The z component of the quaternion. Equivalent to `this[2];`\n     * @category Quaternion components\n     */\n    get z() { return this[2]; }\n    set z(value) { this[2] = value; }\n    /**\n     * The w component of the quaternion. Equivalent to `this[3];`\n     * @category Quaternion components\n     */\n    get w() { return this[3]; }\n    set w(value) { this[3] = value; }\n    /**\n     * The magnitude (length) of this.\n     * Equivalent to `Quat.magnitude(this);`\n     *\n     * Magnitude is used because the `length` attribute is already defined by\n     * `Float32Array` to mean the number of elements in the array.\n     */\n    get magnitude() {\n        const x = this[0];\n        const y = this[1];\n        const z = this[2];\n        const w = this[3];\n        return Math.sqrt(x * x + y * y + z * z + w * w);\n    }\n    /**\n     * Alias for {@link Quat.magnitude}\n     */\n    get mag() { return this.magnitude; }\n    /**\n     * A string representation of `this`\n     * Equivalent to `Quat.str(this);`\n     */\n    get str() {\n        return Quat.str(this);\n    }\n    //===================\n    // Instances methods\n    //===================\n    /**\n     * Copy the values from another {@link Quat} into `this`.\n     *\n     * @param a the source quaternion\n     * @returns `this`\n     */\n    copy(a) {\n        super.set(a);\n        return this;\n    }\n    /**\n     * Set `this` to the identity quaternion\n     * Equivalent to Quat.identity(this)\n     *\n     * @returns `this`\n     */\n    identity() {\n        this[0] = 0;\n        this[1] = 0;\n        this[2] = 0;\n        this[3] = 1;\n        return this;\n    }\n    /**\n     * Multiplies `this` by a {@link Quat}.\n     * Equivalent to `Quat.multiply(this, this, b);`\n     *\n     * @param b - The vector to multiply `this` by\n     * @returns `this`\n     */\n    multiply(b) {\n        return Quat.multiply(this, this, b);\n    }\n    /**\n     * Alias for {@link Quat.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Rotates `this` by the given angle about the X axis\n     * Equivalent to `Quat.rotateX(this, this, rad);`\n     *\n     * @param rad - angle (in radians) to rotate\n     * @returns `this`\n     */\n    rotateX(rad) {\n        return Quat.rotateX(this, this, rad);\n    }\n    /**\n     * Rotates `this` by the given angle about the Y axis\n     * Equivalent to `Quat.rotateY(this, this, rad);`\n     *\n     * @param rad - angle (in radians) to rotate\n     * @returns `this`\n     */\n    rotateY(rad) {\n        return Quat.rotateY(this, this, rad);\n    }\n    /**\n     * Rotates `this` by the given angle about the Z axis\n     * Equivalent to `Quat.rotateZ(this, this, rad);`\n     *\n     * @param rad - angle (in radians) to rotate\n     * @returns `this`\n     */\n    rotateZ(rad) {\n        return Quat.rotateZ(this, this, rad);\n    }\n    /**\n     * Inverts `this`\n     * Equivalent to `Quat.invert(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        return Quat.invert(this, this);\n    }\n    /**\n     * Scales `this` by a scalar number\n     * Equivalent to `Quat.scale(this, this, scale);`\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to scale\n     * @param scale - amount to scale the vector by\n     * @returns `this`\n     */\n    scale(scale) {\n        this[0] *= scale;\n        this[1] *= scale;\n        this[2] *= scale;\n        this[3] *= scale;\n        return this;\n    }\n    /**\n     * Calculates the dot product of `this` and another {@link Quat}\n     * Equivalent to `Quat.dot(this, b);`\n     *\n     * @param b - the second operand\n     * @returns dot product of `this` and b\n     */\n    dot(b) {\n        return Quat.dot(this, b);\n    }\n    //===================\n    // Static methods\n    //===================\n    /**\n     * Creates a new identity quat\n     * @category Static\n     *\n     * @returns a new quaternion\n     */\n    static create() {\n        return new Quat();\n    }\n    /**\n     * Set a quat to the identity quaternion\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @returns `out`\n     */\n    static identity(out) {\n        out[0] = 0;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 1;\n        return out;\n    }\n    /**\n     * Sets a quat from the given angle and rotation axis,\n     * then returns it.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param axis - the axis around which to rotate\n     * @param rad - the angle in radians\n     * @returns `out`\n     **/\n    static setAxisAngle(out, axis, rad) {\n        rad = rad * 0.5;\n        const s = Math.sin(rad);\n        out[0] = s * axis[0];\n        out[1] = s * axis[1];\n        out[2] = s * axis[2];\n        out[3] = Math.cos(rad);\n        return out;\n    }\n    /**\n     * Gets the rotation axis and angle for a given\n     *  quaternion. If a quaternion is created with\n     *  setAxisAngle, this method will return the same\n     *  values as providied in the original parameter list\n     *  OR functionally equivalent values.\n     * Example: The quaternion formed by axis [0, 0, 1] and\n     *  angle -90 is the same as the quaternion formed by\n     *  [0, 0, 1] and 270. This method favors the latter.\n     * @category Static\n     *\n     * @param out_axis - Vector receiving the axis of rotation\n     * @param q - Quaternion to be decomposed\n     * @return Angle, in radians, of the rotation\n     */\n    static getAxisAngle(out_axis, q) {\n        const rad = Math.acos(q[3]) * 2.0;\n        const s = Math.sin(rad / 2.0);\n        if (s > EPSILON) {\n            out_axis[0] = q[0] / s;\n            out_axis[1] = q[1] / s;\n            out_axis[2] = q[2] / s;\n        }\n        else {\n            // If s is zero, return any axis (no rotation - axis does not matter)\n            out_axis[0] = 1;\n            out_axis[1] = 0;\n            out_axis[2] = 0;\n        }\n        return rad;\n    }\n    /**\n     * Gets the angular distance between two unit quaternions\n     * @category Static\n     *\n     * @param  {ReadonlyQuat} a     Origin unit quaternion\n     * @param  {ReadonlyQuat} b     Destination unit quaternion\n     * @return {Number}     Angle, in radians, between the two quaternions\n     */\n    static getAngle(a, b) {\n        const dotproduct = Quat.dot(a, b);\n        return Math.acos(2 * dotproduct * dotproduct - 1);\n    }\n    /**\n     * Multiplies two quat's\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const aw = a[3];\n        const bx = b[0];\n        const by = b[1];\n        const bz = b[2];\n        const bw = b[3];\n        out[0] = ax * bw + aw * bx + ay * bz - az * by;\n        out[1] = ay * bw + aw * by + az * bx - ax * bz;\n        out[2] = az * bw + aw * bz + ax * by - ay * bx;\n        out[3] = aw * bw - ax * bx - ay * by - az * bz;\n        return out;\n    }\n    /**\n     * Rotates a quaternion by the given angle about the X axis\n     * @category Static\n     *\n     * @param out - quat receiving operation result\n     * @param a - quat to rotate\n     * @param rad - angle (in radians) to rotate\n     * @returns `out`\n     */\n    static rotateX(out, a, rad) {\n        rad *= 0.5;\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const aw = a[3];\n        const bx = Math.sin(rad);\n        const bw = Math.cos(rad);\n        out[0] = ax * bw + aw * bx;\n        out[1] = ay * bw + az * bx;\n        out[2] = az * bw - ay * bx;\n        out[3] = aw * bw - ax * bx;\n        return out;\n    }\n    /**\n     * Rotates a quaternion by the given angle about the Y axis\n     * @category Static\n     *\n     * @param out - quat receiving operation result\n     * @param a - quat to rotate\n     * @param rad - angle (in radians) to rotate\n     * @returns `out`\n     */\n    static rotateY(out, a, rad) {\n        rad *= 0.5;\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const aw = a[3];\n        const by = Math.sin(rad);\n        const bw = Math.cos(rad);\n        out[0] = ax * bw - az * by;\n        out[1] = ay * bw + aw * by;\n        out[2] = az * bw + ax * by;\n        out[3] = aw * bw - ay * by;\n        return out;\n    }\n    /**\n     * Rotates a quaternion by the given angle about the Z axis\n     * @category Static\n     *\n     * @param out - quat receiving operation result\n     * @param a - quat to rotate\n     * @param rad - angle (in radians) to rotate\n     * @returns `out`\n     */\n    static rotateZ(out, a, rad) {\n        rad *= 0.5;\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const aw = a[3];\n        const bz = Math.sin(rad);\n        const bw = Math.cos(rad);\n        out[0] = ax * bw + ay * bz;\n        out[1] = ay * bw - ax * bz;\n        out[2] = az * bw + aw * bz;\n        out[3] = aw * bw - az * bz;\n        return out;\n    }\n    /**\n     * Calculates the W component of a quat from the X, Y, and Z components.\n     * Assumes that quaternion is 1 unit in length.\n     * Any existing W component will be ignored.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - quat to calculate W component of\n     * @returns `out`\n     */\n    static calculateW(out, a) {\n        const x = a[0], y = a[1], z = a[2];\n        out[0] = x;\n        out[1] = y;\n        out[2] = z;\n        out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n        return out;\n    }\n    /**\n     * Calculate the exponential of a unit quaternion.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - quat to calculate the exponential of\n     * @returns `out`\n     */\n    static exp(out, a) {\n        const x = a[0], y = a[1], z = a[2], w = a[3];\n        const r = Math.sqrt(x * x + y * y + z * z);\n        const et = Math.exp(w);\n        const s = r > 0 ? (et * Math.sin(r)) / r : 0;\n        out[0] = x * s;\n        out[1] = y * s;\n        out[2] = z * s;\n        out[3] = et * Math.cos(r);\n        return out;\n    }\n    /**\n     * Calculate the natural logarithm of a unit quaternion.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - quat to calculate the exponential of\n     * @returns `out`\n     */\n    static ln(out, a) {\n        const x = a[0], y = a[1], z = a[2], w = a[3];\n        const r = Math.sqrt(x * x + y * y + z * z);\n        const t = r > 0 ? Math.atan2(r, w) / r : 0;\n        out[0] = x * t;\n        out[1] = y * t;\n        out[2] = z * t;\n        out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\n        return out;\n    }\n    /**\n     * Calculate the scalar power of a unit quaternion.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - quat to calculate the exponential of\n     * @param b - amount to scale the quaternion by\n     * @returns `out`\n     */\n    static pow(out, a, b) {\n        Quat.ln(out, a);\n        Quat.scale(out, out, b);\n        Quat.exp(out, out);\n        return out;\n    }\n    /**\n     * Performs a spherical linear interpolation between two quat\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static slerp(out, a, b, t) {\n        // benchmarks:\n        //    http://jsperf.com/quaternion-slerp-implementations\n        const ax = a[0], ay = a[1], az = a[2], aw = a[3];\n        let bx = b[0], by = b[1], bz = b[2], bw = b[3];\n        let scale0;\n        let scale1;\n        // calc cosine\n        let cosom = ax * bx + ay * by + az * bz + aw * bw;\n        // adjust signs (if necessary)\n        if (cosom < 0.0) {\n            cosom = -cosom;\n            bx = -bx;\n            by = -by;\n            bz = -bz;\n            bw = -bw;\n        }\n        // calculate coefficients\n        if (1.0 - cosom > EPSILON) {\n            // standard case (slerp)\n            const omega = Math.acos(cosom);\n            const sinom = Math.sin(omega);\n            scale0 = Math.sin((1.0 - t) * omega) / sinom;\n            scale1 = Math.sin(t * omega) / sinom;\n        }\n        else {\n            // \"from\" and \"to\" quaternions are very close\n            //  ... so we can do a linear interpolation\n            scale0 = 1.0 - t;\n            scale1 = t;\n        }\n        // calculate final values\n        out[0] = scale0 * ax + scale1 * bx;\n        out[1] = scale0 * ay + scale1 * by;\n        out[2] = scale0 * az + scale1 * bz;\n        out[3] = scale0 * aw + scale1 * bw;\n        return out;\n    }\n    /**\n     * Generates a random unit quaternion\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @returns `out`\n     */\n    /*static random(out: QuatLike): QuatLike {\n      // Implementation of http://planning.cs.uiuc.edu/node198.html\n      // TODO: Calling random 3 times is probably not the fastest solution\n      let u1 = glMatrix.RANDOM();\n      let u2 = glMatrix.RANDOM();\n      let u3 = glMatrix.RANDOM();\n  \n      let sqrt1MinusU1 = Math.sqrt(1 - u1);\n      let sqrtU1 = Math.sqrt(u1);\n  \n      out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n      out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n      out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n      out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n      return out;\n    }*/\n    /**\n     * Calculates the inverse of a quat\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - quat to calculate inverse of\n     * @returns `out`\n     */\n    static invert(out, a) {\n        const a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3];\n        const dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n        const invDot = dot ? 1.0 / dot : 0;\n        // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n        out[0] = -a0 * invDot;\n        out[1] = -a1 * invDot;\n        out[2] = -a2 * invDot;\n        out[3] = a3 * invDot;\n        return out;\n    }\n    /**\n     * Calculates the conjugate of a quat\n     * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - quat to calculate conjugate of\n     * @returns `out`\n     */\n    static conjugate(out, a) {\n        out[0] = -a[0];\n        out[1] = -a[1];\n        out[2] = -a[2];\n        out[3] = a[3];\n        return out;\n    }\n    /**\n     * Creates a quaternion from the given 3x3 rotation matrix.\n     *\n     * NOTE: The resultant quaternion is not normalized, so you should be sure\n     * to renormalize the quaternion yourself where necessary.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param m - rotation matrix\n     * @returns `out`\n     */\n    static fromMat3(out, m) {\n        // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n        // article \"Quaternion Calculus and Fast Animation\".\n        const fTrace = m[0] + m[4] + m[8];\n        let fRoot;\n        if (fTrace > 0.0) {\n            // |w| > 1/2, may as well choose w > 1/2\n            fRoot = Math.sqrt(fTrace + 1.0); // 2w\n            out[3] = 0.5 * fRoot;\n            fRoot = 0.5 / fRoot; // 1/(4w)\n            out[0] = (m[5] - m[7]) * fRoot;\n            out[1] = (m[6] - m[2]) * fRoot;\n            out[2] = (m[1] - m[3]) * fRoot;\n        }\n        else {\n            // |w| <= 1/2\n            let i = 0;\n            if (m[4] > m[0])\n                i = 1;\n            if (m[8] > m[i * 3 + i])\n                i = 2;\n            let j = (i + 1) % 3;\n            let k = (i + 2) % 3;\n            fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n            out[i] = 0.5 * fRoot;\n            fRoot = 0.5 / fRoot;\n            out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n            out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n            out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n        }\n        return out;\n    }\n    /**\n     * Creates a quaternion from the given euler angle x, y, z.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param x - Angle to rotate around X axis in degrees.\n     * @param y - Angle to rotate around Y axis in degrees.\n     * @param z - Angle to rotate around Z axis in degrees.\n     * @returns `out`\n     */\n    static fromEuler(out, x, y, z) {\n        let halfToRad = (0.5 * Math.PI) / 180.0;\n        x *= halfToRad;\n        y *= halfToRad;\n        z *= halfToRad;\n        let sx = Math.sin(x);\n        let cx = Math.cos(x);\n        let sy = Math.sin(y);\n        let cy = Math.cos(y);\n        let sz = Math.sin(z);\n        let cz = Math.cos(z);\n        out[0] = sx * cy * cz - cx * sy * sz;\n        out[1] = cx * sy * cz + sx * cy * sz;\n        out[2] = cx * cy * sz - sx * sy * cz;\n        out[3] = cx * cy * cz + sx * sy * sz;\n        return out;\n    }\n    /**\n     * Returns a string representation of a quatenion\n     * @category Static\n     *\n     * @param a - vector to represent as a string\n     * @returns string representation of the vector\n     */\n    static str(a) {\n        return `Quat(${a.join(', ')})`;\n    }\n    /**\n     * Creates a new quat initialized with values from an existing quaternion\n     * @category Static\n     *\n     * @param a - quaternion to clone\n     * @returns a new quaternion\n     */\n    static clone(a) {\n        return new Quat(a);\n    }\n    /**\n     * Creates a new quat initialized with the given values\n     * @category Static\n     *\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @param w - W component\n     * @returns a new quaternion\n     */\n    static fromValues(x, y, z, w) {\n        return new Quat(x, y, z, w);\n    }\n    /**\n     * Copy the values from one quat to another\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - the source quaternion\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        return out;\n    }\n    /**\n     * Set the components of a {@link Quat} to the given values\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @param w - W component\n     * @returns `out`\n     */\n    static set(out, x, y, z, w) { return out; }\n    /**\n     * Adds two {@link Quat}'s\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static add(out, a, b) { return out; }\n    /**\n     * Alias for {@link Quat.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Scales a quat by a scalar number\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to scale\n     * @param b - amount to scale the vector by\n     * @returns `out`\n     */\n    static scale(out, a, scale) {\n        out[0] = a[0] * scale;\n        out[1] = a[1] * scale;\n        out[2] = a[2] * scale;\n        out[3] = a[3] * scale;\n        return out;\n    }\n    /**\n     * Calculates the dot product of two quat's\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns dot product of a and b\n     */\n    static dot(a, b) {\n        return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n    }\n    /**\n     * Performs a linear interpolation between two quat's\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static lerp(out, a, b, t) { return out; }\n    /**\n     * Calculates the magnitude (length) of a {@link Quat}\n     * @category Static\n     *\n     * @param a - quaternion to calculate length of\n     * @returns length of `a`\n     */\n    static magnitude(a) { return 0; }\n    /**\n     * Alias for {@link Quat.magnitude}\n     * @category Static\n     */\n    static mag(a) { return 0; }\n    /**\n     * Alias for {@link Quat.magnitude}\n     * @category Static\n     * @deprecated Use {@link Quat.magnitude} to avoid conflicts with builtin `length` methods/attribs\n     */\n    // @ts-ignore: Length conflicts with Function.length\n    static length(a) { return 0; }\n    /**\n     * Alias for {@link Quat.magnitude}\n     * @category Static\n     * @deprecated Use {@link Quat.mag}\n     */\n    static len(a) { return 0; }\n    /**\n     * Calculates the squared length of a {@link Quat}\n     * @category Static\n     *\n     * @param a - quaternion to calculate squared length of\n     * @returns squared length of a\n     */\n    static squaredLength(a) { return 0; }\n    /**\n     * Alias for {@link Quat.squaredLength}\n     * @category Static\n     */\n    static sqrLen(a) { return 0; }\n    /**\n     * Normalize a {@link Quat}\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - quaternion to normalize\n     * @returns `out`\n     */\n    static normalize(out, a) { return out; }\n    /**\n     * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first quaternion.\n     * @param b - The second quaternion.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static exactEquals(a, b) { return false; }\n    /**\n     * Returns whether or not the quaternions have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static equals(a, b) { return false; }\n    /**\n     * Sets a quaternion to represent the shortest rotation from one\n     * vector to another.\n     *\n     * Both vectors are assumed to be unit length.\n     * @category Static\n     *\n     * @param out - the receiving quaternion.\n     * @param a - the initial vector\n     * @param b - the destination vector\n     * @returns `out`\n     */\n    static rotationTo(out, a, b) {\n        let dot = Vec3.dot(a, b);\n        if (dot < -0.999999) {\n            Vec3.cross(tmpVec3, xUnitVec3, a);\n            if (Vec3.len(tmpVec3) < 0.000001)\n                Vec3.cross(tmpVec3, yUnitVec3, a);\n            Vec3.normalize(tmpVec3, tmpVec3);\n            Quat.setAxisAngle(out, tmpVec3, Math.PI);\n            return out;\n        }\n        else if (dot > 0.999999) {\n            out[0] = 0;\n            out[1] = 0;\n            out[2] = 0;\n            out[3] = 1;\n            return out;\n        }\n        else {\n            Vec3.cross(tmpVec3, a, b);\n            out[0] = tmpVec3[0];\n            out[1] = tmpVec3[1];\n            out[2] = tmpVec3[2];\n            out[3] = 1 + dot;\n            return Quat.normalize(out, out);\n        }\n    }\n    /**\n     * Performs a spherical linear interpolation with two control points\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param c - the third operand\n     * @param d - the fourth operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static sqlerp(out, a, b, c, d, t) {\n        Quat.slerp(temp1, a, d, t);\n        Quat.slerp(temp2, b, c, t);\n        Quat.slerp(out, temp1, temp2, 2 * t * (1 - t));\n        return out;\n    }\n    /**\n     * Sets the specified quaternion with values corresponding to the given\n     * axes. Each axis is a vec3 and is expected to be unit length and\n     * perpendicular to all other specified axes.\n     * @category Static\n     *\n     * @param out - The receiving quaternion\n     * @param view - the vector representing the viewing direction\n     * @param right - the vector representing the local \"right\" direction\n     * @param up - the vector representing the local \"up\" direction\n     * @returns `out`\n     */\n    static setAxes(out, view, right, up) {\n        tempMat3[0] = right[0];\n        tempMat3[3] = right[1];\n        tempMat3[6] = right[2];\n        tempMat3[1] = up[0];\n        tempMat3[4] = up[1];\n        tempMat3[7] = up[2];\n        tempMat3[2] = -view[0];\n        tempMat3[5] = -view[1];\n        tempMat3[8] = -view[2];\n        return Quat.normalize(out, Quat.fromMat3(out, tempMat3));\n    }\n}\n// Temporary variables to prevent repeated allocations in the algorithms above.\nconst temp1 = [0, 0, 0, 0];\nconst temp2 = [0, 0, 0, 0];\nconst tempMat3 = [0, 0, 0, 0, 0, 0, 0, 0, 0];\nconst tmpVec3 = [0, 0, 0];\nconst xUnitVec3 = [1, 0, 0];\nconst yUnitVec3 = [0, 1, 0];\n// Methods which re-use the Vec4 implementation\nQuat.set = Vec4.set;\nQuat.add = Vec4.add;\nQuat.lerp = Vec4.lerp;\nQuat.normalize = Vec4.normalize;\nQuat.squaredLength = Vec4.squaredLength;\nQuat.sqrLen = Vec4.squaredLength;\nQuat.exactEquals = Vec4.exactEquals;\nQuat.equals = Vec4.equals;\nQuat.magnitude = Vec4.magnitude;\n// Instance method alias assignments\nQuat.prototype.mul = Quat.prototype.multiply;\n// Static method alias assignments\nQuat.mul = Quat.multiply;\nQuat.mag = Quat.magnitude;\nQuat.length = Quat.magnitude;\nQuat.len = Quat.magnitude;\n\n/**\n * Dual Quaternion\n */\nclass Quat2 extends Float32Array {\n    /**\n     * The number of bytes in a {@link Quat}.\n     */\n    static BYTE_LENGTH = 8 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Quat2}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 8:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 8);\n                break;\n            case 1: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, v, v, v, v, v, v, v]);\n                }\n                else {\n                    super(v, 0, 8);\n                }\n                break;\n            }\n            default:\n                super(8);\n                this[3] = 1;\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    /**\n     * A string representation of `this`\n     * Equivalent to `Quat2.str(this);`\n     */\n    get str() {\n        return Quat2.str(this);\n    }\n    //===================\n    // Instances methods\n    //===================\n    /**\n     * Copy the values from another {@link Quat2} into `this`.\n     *\n     * @param a the source dual quaternion\n     * @returns `this`\n     */\n    copy(a) {\n        super.set(a);\n        return this;\n    }\n    //===================\n    // Static methods\n    //===================\n    /**\n     * Creates a new identity {@link Quat2}\n     * @category Static\n     *\n     * @returns a new dual quaternion [real -> rotation, dual -> translation]\n     */\n    static create() {\n        return new Quat2();\n    }\n    /**\n     * Creates a {@link Quat2} quat initialized with values from an existing quaternion\n     * @category Static\n     *\n     * @param a - dual quaternion to clone\n     * @returns a new dual quaternion\n     */\n    static clone(a) {\n        return new Quat2(a);\n    }\n    /**\n     * Creates a new {@link Quat2}  initialized with the given values\n     * @category Static\n     *\n     * @param x1 - 1st X component\n     * @param y1 - 1st Y component\n     * @param z1 - 1st Z component\n     * @param w1 - 1st W component\n     * @param x2 - 2nd X component\n     * @param y2 - 2nd Y component\n     * @param z2 - 2nd Z component\n     * @param w2 - 2nd W component\n     * @returns a new dual quaternion\n     */\n    static fromValues(x1, y1, z1, w1, x2, y2, z2, w2) {\n        return new Quat2(x1, y1, z1, w1, x2, y2, z2, w2);\n    }\n    /**\n     * Creates a new {@link Quat2} from the given values (quat and translation)\n     * @category Static\n     *\n     * @param x1 - X component (rotation)\n     * @param y1 - Y component (rotation)\n     * @param z1 - Z component (rotation)\n     * @param w1 - W component (rotation)\n     * @param x2 - X component (translation)\n     * @param y2 - Y component (translation)\n     * @param z2 - Z component (translation)\n     * @returns a new dual quaternion\n     */\n    static fromRotationTranslationValues(x1, y1, z1, w1, x2, y2, z2) {\n        const ax = x2 * 0.5;\n        const ay = y2 * 0.5;\n        const az = z2 * 0.5;\n        return new Quat2(x1, y1, z1, w1, ax * w1 + ay * z1 - az * y1, ay * w1 + az * x1 - ax * z1, az * w1 + ax * y1 - ay * x1, -ax * x1 - ay * y1 - az * z1);\n    }\n    /**\n     * Sets a {@link Quat2} from a quaternion and a translation\n     * @category Static\n     *\n     * @param out - dual quaternion receiving operation result\n     * @param q - a normalized quaternion\n     * @param t - translation vector\n     * @returns `out`\n     */\n    static fromRotationTranslation(out, q, t) {\n        const ax = t[0] * 0.5;\n        const ay = t[1] * 0.5;\n        const az = t[2] * 0.5;\n        const bx = q[0];\n        const by = q[1];\n        const bz = q[2];\n        const bw = q[3];\n        out[0] = bx;\n        out[1] = by;\n        out[2] = bz;\n        out[3] = bw;\n        out[4] = ax * bw + ay * bz - az * by;\n        out[5] = ay * bw + az * bx - ax * bz;\n        out[6] = az * bw + ax * by - ay * bx;\n        out[7] = -ax * bx - ay * by - az * bz;\n        return out;\n    }\n    /**\n     * Sets a {@link Quat2} from a translation\n     * @category Static\n     *\n     * @param out - dual quaternion receiving operation result\n     * @param t - translation vector\n     * @returns `out`\n     */\n    static fromTranslation(out, t) {\n        out[0] = 0;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 1;\n        out[4] = t[0] * 0.5;\n        out[5] = t[1] * 0.5;\n        out[6] = t[2] * 0.5;\n        out[7] = 0;\n        return out;\n    }\n    /**\n     * Sets a {@link Quat2} from a quaternion\n     * @category Static\n     *\n     * @param out - dual quaternion receiving operation result\n     * @param q - a normalized quaternion\n     * @returns `out`\n     */\n    static fromRotation(out, q) {\n        out[0] = q[0];\n        out[1] = q[1];\n        out[2] = q[2];\n        out[3] = q[3];\n        out[4] = 0;\n        out[5] = 0;\n        out[6] = 0;\n        out[7] = 0;\n        return out;\n    }\n    /**\n     * Sets a {@link Quat2} from a quaternion\n     * @category Static\n     *\n     * @param out - dual quaternion receiving operation result\n     * @param a - the matrix\n     * @returns `out`\n     */\n    static fromMat4(out, a) {\n        Mat4.getRotation(tempQuat, a);\n        Mat4.getTranslation(tempVec3, a);\n        return Quat2.fromRotationTranslation(out, tempQuat, tempVec3);\n    }\n    /**\n     * Copy the values from one {@link Quat2} to another\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the source dual quaternion\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        out[4] = a[4];\n        out[5] = a[5];\n        out[6] = a[6];\n        out[7] = a[7];\n        return out;\n    }\n    /**\n     * Set a {@link Quat2} to the identity dual quaternion\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @returns `out`\n     */\n    static identity(out) {\n        out[0] = 0;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 1;\n        out[4] = 0;\n        out[5] = 0;\n        out[6] = 0;\n        out[7] = 0;\n        return out;\n    }\n    /**\n     * Set the components of a {@link Quat2} to the given values\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param x1 - 1st X component\n     * @param y1 - 1st Y component\n     * @param z1 - 1st Z component\n     * @param w1 - 1st W component\n     * @param x2 - 2nd X component\n     * @param y2 - 2nd Y component\n     * @param z2 - 2nd Z component\n     * @param w2 - 2nd W component\n     * @returns `out`\n     */\n    static set(out, x1, y1, z1, w1, x2, y2, z2, w2) {\n        out[0] = x1;\n        out[1] = y1;\n        out[2] = z1;\n        out[3] = w1;\n        out[4] = x2;\n        out[5] = y2;\n        out[6] = z2;\n        out[7] = w2;\n        return out;\n    }\n    /**\n     * Gets the real part of a dual quat\n     * @category Static\n     *\n     * @param out - real part\n     * @param a - Dual Quaternion\n     * @return `out`\n     */\n    static getReal(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        return out;\n    }\n    ;\n    /**\n     * Gets the dual part of a dual quat\n     * @category Static\n     *\n     * @param out - dual part\n     * @param a - Dual Quaternion\n     * @return `out`\n     */\n    static getDual(out, a) {\n        out[0] = a[4];\n        out[1] = a[5];\n        out[2] = a[6];\n        out[3] = a[7];\n        return out;\n    }\n    /**\n     * Set the real component of a {@link Quat2} to the given quaternion\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - a quaternion representing the real part\n     * @return `out`\n     */\n    static setReal(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        return out;\n    }\n    ;\n    /**\n     * Set the dual component of a {@link Quat2} to the given quaternion\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - a quaternion representing the dual part\n     * @return `out`\n     */\n    static setDual(out, a) {\n        out[4] = a[0];\n        out[5] = a[1];\n        out[6] = a[2];\n        out[7] = a[3];\n        return out;\n    }\n    /**\n     * Gets the translation of a normalized {@link Quat2}\n     * @category Static\n     *\n     * @param out - the receiving translation vector\n     * @param a - Dual Quaternion to be decomposed\n     * @return `out`\n     */\n    static getTranslation(out, a) {\n        const ax = a[4];\n        const ay = a[5];\n        const az = a[6];\n        const aw = a[7];\n        const bx = -a[0];\n        const by = -a[1];\n        const bz = -a[2];\n        const bw = a[3];\n        out[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n        out[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n        out[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n        return out;\n    }\n    /**\n     * Translates a {@link Quat2} by the given vector\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the dual quaternion to translate\n     * @param v - vector to translate by\n     * @returns `out`\n     */\n    static translate(out, a, v) {\n        const ax1 = a[0];\n        const ay1 = a[1];\n        const az1 = a[2];\n        const aw1 = a[3];\n        const bx1 = v[0] * 0.5;\n        const by1 = v[1] * 0.5;\n        const bz1 = v[2] * 0.5;\n        const ax2 = a[4];\n        const ay2 = a[5];\n        const az2 = a[6];\n        const aw2 = a[7];\n        out[0] = ax1;\n        out[1] = ay1;\n        out[2] = az1;\n        out[3] = aw1;\n        out[4] = aw1 * bx1 + ay1 * bz1 - az1 * by1 + ax2;\n        out[5] = aw1 * by1 + az1 * bx1 - ax1 * bz1 + ay2;\n        out[6] = aw1 * bz1 + ax1 * by1 - ay1 * bx1 + az2;\n        out[7] = -ax1 * bx1 - ay1 * by1 - az1 * bz1 + aw2;\n        return out;\n    }\n    /**\n     * Rotates a {@link Quat2} around the X axis\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the dual quaternion to rotate\n     * @param rad - angle (in radians) to rotate\n     * @returns `out`\n     */\n    static rotateX(out, a, rad) {\n        let bx = -a[0];\n        let by = -a[1];\n        let bz = -a[2];\n        let bw = a[3];\n        const ax = a[4];\n        const ay = a[5];\n        const az = a[6];\n        const aw = a[7];\n        const ax1 = ax * bw + aw * bx + ay * bz - az * by;\n        const ay1 = ay * bw + aw * by + az * bx - ax * bz;\n        const az1 = az * bw + aw * bz + ax * by - ay * bx;\n        const aw1 = aw * bw - ax * bx - ay * by - az * bz;\n        Quat.rotateX(out, a, rad);\n        bx = out[0];\n        by = out[1];\n        bz = out[2];\n        bw = out[3];\n        out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n        out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n        out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n        out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n        return out;\n    }\n    /**\n     * Rotates a {@link Quat2} around the Y axis\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the dual quaternion to rotate\n     * @param rad - angle (in radians) to rotate\n     * @returns `out`\n     */\n    static rotateY(out, a, rad) {\n        let bx = -a[0];\n        let by = -a[1];\n        let bz = -a[2];\n        let bw = a[3];\n        const ax = a[4];\n        const ay = a[5];\n        const az = a[6];\n        const aw = a[7];\n        const ax1 = ax * bw + aw * bx + ay * bz - az * by;\n        const ay1 = ay * bw + aw * by + az * bx - ax * bz;\n        const az1 = az * bw + aw * bz + ax * by - ay * bx;\n        const aw1 = aw * bw - ax * bx - ay * by - az * bz;\n        Quat.rotateY(out, a, rad);\n        bx = out[0];\n        by = out[1];\n        bz = out[2];\n        bw = out[3];\n        out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n        out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n        out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n        out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n        return out;\n    }\n    /**\n     * Rotates a {@link Quat2} around the Z axis\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the dual quaternion to rotate\n     * @param rad - angle (in radians) to rotate\n     * @returns `out`\n     */\n    static rotateZ(out, a, rad) {\n        let bx = -a[0];\n        let by = -a[1];\n        let bz = -a[2];\n        let bw = a[3];\n        const ax = a[4];\n        const ay = a[5];\n        const az = a[6];\n        const aw = a[7];\n        const ax1 = ax * bw + aw * bx + ay * bz - az * by;\n        const ay1 = ay * bw + aw * by + az * bx - ax * bz;\n        const az1 = az * bw + aw * bz + ax * by - ay * bx;\n        const aw1 = aw * bw - ax * bx - ay * by - az * bz;\n        Quat.rotateZ(out, a, rad);\n        bx = out[0];\n        by = out[1];\n        bz = out[2];\n        bw = out[3];\n        out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n        out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n        out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n        out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n        return out;\n    }\n    /**\n     * Rotates a {@link Quat2} by a given quaternion (a * q)\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the dual quaternion to rotate\n     * @param q - quaternion to rotate by\n     * @returns `out`\n     */\n    static rotateByQuatAppend(out, a, q) {\n        const qx = q[0];\n        const qy = q[1];\n        const qz = q[2];\n        const qw = q[3];\n        let ax = a[0];\n        let ay = a[1];\n        let az = a[2];\n        let aw = a[3];\n        out[0] = ax * qw + aw * qx + ay * qz - az * qy;\n        out[1] = ay * qw + aw * qy + az * qx - ax * qz;\n        out[2] = az * qw + aw * qz + ax * qy - ay * qx;\n        out[3] = aw * qw - ax * qx - ay * qy - az * qz;\n        ax = a[4];\n        ay = a[5];\n        az = a[6];\n        aw = a[7];\n        out[4] = ax * qw + aw * qx + ay * qz - az * qy;\n        out[5] = ay * qw + aw * qy + az * qx - ax * qz;\n        out[6] = az * qw + aw * qz + ax * qy - ay * qx;\n        out[7] = aw * qw - ax * qx - ay * qy - az * qz;\n        return out;\n    }\n    /**\n     * Rotates a {@link Quat2} by a given quaternion (q * a)\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param q - quaternion to rotate by\n     * @param a - the dual quaternion to rotate\n     * @returns `out`\n     */\n    static rotateByQuatPrepend(out, q, a) {\n        const qx = q[0];\n        const qy = q[1];\n        const qz = q[2];\n        const qw = q[3];\n        let bx = a[0];\n        let by = a[1];\n        let bz = a[2];\n        let bw = a[3];\n        out[0] = qx * bw + qw * bx + qy * bz - qz * by;\n        out[1] = qy * bw + qw * by + qz * bx - qx * bz;\n        out[2] = qz * bw + qw * bz + qx * by - qy * bx;\n        out[3] = qw * bw - qx * bx - qy * by - qz * bz;\n        bx = a[4];\n        by = a[5];\n        bz = a[6];\n        bw = a[7];\n        out[4] = qx * bw + qw * bx + qy * bz - qz * by;\n        out[5] = qy * bw + qw * by + qz * bx - qx * bz;\n        out[6] = qz * bw + qw * bz + qx * by - qy * bx;\n        out[7] = qw * bw - qx * bx - qy * by - qz * bz;\n        return out;\n    }\n    /**\n     * Rotates a {@link Quat2} around a given axis. Does the normalization automatically\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the dual quaternion to rotate\n     * @param axis - the axis to rotate around\n     * @param rad - how far the rotation should be\n     * @returns `out`\n     */\n    static rotateAroundAxis(out, a, axis, rad) {\n        //Special case for rad = 0\n        if (Math.abs(rad) < EPSILON) {\n            return Quat2.copy(out, a);\n        }\n        const axisLength = Math.sqrt(axis[0] * axis[0] + axis[1] * axis[1] + axis[2] * axis[2]);\n        rad = rad * 0.5;\n        const s = Math.sin(rad);\n        const bx = (s * axis[0]) / axisLength;\n        const by = (s * axis[1]) / axisLength;\n        const bz = (s * axis[2]) / axisLength;\n        const bw = Math.cos(rad);\n        const ax1 = a[0];\n        const ay1 = a[1];\n        const az1 = a[2];\n        const aw1 = a[3];\n        out[0] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n        out[1] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n        out[2] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n        out[3] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n        const ax = a[4];\n        const ay = a[5];\n        const az = a[6];\n        const aw = a[7];\n        out[4] = ax * bw + aw * bx + ay * bz - az * by;\n        out[5] = ay * bw + aw * by + az * bx - ax * bz;\n        out[6] = az * bw + aw * bz + ax * by - ay * bx;\n        out[7] = aw * bw - ax * bx - ay * by - az * bz;\n        return out;\n    }\n    /**\n     * Adds two {@link Quat2}s\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        out[3] = a[3] + b[3];\n        out[4] = a[4] + b[4];\n        out[5] = a[5] + b[5];\n        out[6] = a[6] + b[6];\n        out[7] = a[7] + b[7];\n        return out;\n    }\n    /**\n     * Multiplies two {@link Quat2}s\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns {quat2} out\n     */\n    static multiply(out, a, b) {\n        const ax0 = a[0];\n        const ay0 = a[1];\n        const az0 = a[2];\n        const aw0 = a[3];\n        const bx1 = b[4];\n        const by1 = b[5];\n        const bz1 = b[6];\n        const bw1 = b[7];\n        const ax1 = a[4];\n        const ay1 = a[5];\n        const az1 = a[6];\n        const aw1 = a[7];\n        const bx0 = b[0];\n        const by0 = b[1];\n        const bz0 = b[2];\n        const bw0 = b[3];\n        out[0] = ax0 * bw0 + aw0 * bx0 + ay0 * bz0 - az0 * by0;\n        out[1] = ay0 * bw0 + aw0 * by0 + az0 * bx0 - ax0 * bz0;\n        out[2] = az0 * bw0 + aw0 * bz0 + ax0 * by0 - ay0 * bx0;\n        out[3] = aw0 * bw0 - ax0 * bx0 - ay0 * by0 - az0 * bz0;\n        out[4] =\n            ax0 * bw1 +\n                aw0 * bx1 +\n                ay0 * bz1 -\n                az0 * by1 +\n                ax1 * bw0 +\n                aw1 * bx0 +\n                ay1 * bz0 -\n                az1 * by0;\n        out[5] =\n            ay0 * bw1 +\n                aw0 * by1 +\n                az0 * bx1 -\n                ax0 * bz1 +\n                ay1 * bw0 +\n                aw1 * by0 +\n                az1 * bx0 -\n                ax1 * bz0;\n        out[6] =\n            az0 * bw1 +\n                aw0 * bz1 +\n                ax0 * by1 -\n                ay0 * bx1 +\n                az1 * bw0 +\n                aw1 * bz0 +\n                ax1 * by0 -\n                ay1 * bx0;\n        out[7] =\n            aw0 * bw1 -\n                ax0 * bx1 -\n                ay0 * by1 -\n                az0 * bz1 +\n                aw1 * bw0 -\n                ax1 * bx0 -\n                ay1 * by0 -\n                az1 * bz0;\n        return out;\n    }\n    /**\n     * Alias for {@link Quat2.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Scales a {@link Quat2} by a scalar value\n     * @category Static\n     *\n     * @param out - the receiving dual quaterion\n     * @param a - the dual quaternion to scale\n     * @param b - scalar value to scale the dual quaterion by\n     * @returns `out`\n     */\n    static scale(out, a, b) {\n        out[0] = a[0] * b;\n        out[1] = a[1] * b;\n        out[2] = a[2] * b;\n        out[3] = a[3] * b;\n        out[4] = a[4] * b;\n        out[5] = a[5] * b;\n        out[6] = a[6] * b;\n        out[7] = a[7] * b;\n        return out;\n    }\n    /**\n     * Calculates the dot product of two {@link Quat2}s (The dot product of the real parts)\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns dot product of a and b\n     */\n    static dot(a, b) { return 0; }\n    /**\n     * Performs a linear interpolation between two {@link Quat2}s\n     * NOTE: The resulting dual quaternions won't always be normalized (The error is most noticeable when `t = 0.5`)\n     * @category Static\n     *\n     * @param out - the receiving dual quat\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static lerp(out, a, b, t) {\n        const mt = 1 - t;\n        if (Quat2.dot(a, b) < 0)\n            t = -t;\n        out[0] = a[0] * mt + b[0] * t;\n        out[1] = a[1] * mt + b[1] * t;\n        out[2] = a[2] * mt + b[2] * t;\n        out[3] = a[3] * mt + b[3] * t;\n        out[4] = a[4] * mt + b[4] * t;\n        out[5] = a[5] * mt + b[5] * t;\n        out[6] = a[6] * mt + b[6] * t;\n        out[7] = a[7] * mt + b[7] * t;\n        return out;\n    }\n    /**\n     * Calculates the inverse of a {@link Quat2}. If they are normalized, conjugate is cheaper\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - dual quat to calculate inverse of\n     * @returns `out`\n     */\n    static invert(out, a) {\n        const sqlen = Quat2.squaredLength(a);\n        out[0] = -a[0] / sqlen;\n        out[1] = -a[1] / sqlen;\n        out[2] = -a[2] / sqlen;\n        out[3] = a[3] / sqlen;\n        out[4] = -a[4] / sqlen;\n        out[5] = -a[5] / sqlen;\n        out[6] = -a[6] / sqlen;\n        out[7] = a[7] / sqlen;\n        return out;\n    }\n    /**\n     * Calculates the conjugate of a {@link Quat2}\n     * If the dual quaternion is normalized, this function is faster than {@link Quat2.invert} and produces the same result.\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - dual quaternion to calculate conjugate of\n     * @returns `out`\n     */\n    static conjugate(out, a) {\n        out[0] = -a[0];\n        out[1] = -a[1];\n        out[2] = -a[2];\n        out[3] = a[3];\n        out[4] = -a[4];\n        out[5] = -a[5];\n        out[6] = -a[6];\n        out[7] = a[7];\n        return out;\n    }\n    /**\n     * Calculates the magnitude (length) of a {@link Quat2}\n     * @category Static\n     *\n     * @param a - dual quaternion to calculate length of\n     * @returns length of `a`\n     */\n    static magnitude(a) { return 0; }\n    /**\n     * Alias for {@link Quat2.magnitude}\n     * @category Static\n     */\n    static mag(a) { return 0; }\n    /**\n     * Alias for {@link Quat2.magnitude}\n     * @category Static\n     * @deprecated Use {@link Quat2.magnitude} to avoid conflicts with builtin `length` methods/attribs\n     */\n    // @ts-ignore: Length conflicts with Function.length\n    static length(a) { return 0; }\n    /**\n     * Alias for {@link Quat2.magnitude}\n     * @category Static\n     * @deprecated Use {@link Quat2.mag}\n     */\n    static len(a) { return 0; }\n    /**\n     * Calculates the squared length of a {@link Quat2}\n     * @category Static\n     *\n     * @param a - dual quaternion to calculate squared length of\n     * @returns squared length of a\n     */\n    static squaredLength(a) { return 0; }\n    /**\n     * Alias for {@link Quat2.squaredLength}\n     * @category Static\n     */\n    static sqrLen(a) { return 0; }\n    /**\n     * Normalize a {@link Quat2}\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - dual quaternion to normalize\n     * @returns `out`\n     */\n    static normalize(out, a) {\n        let magnitude = Quat2.squaredLength(a);\n        if (magnitude > 0) {\n            magnitude = Math.sqrt(magnitude);\n            const a0 = a[0] / magnitude;\n            const a1 = a[1] / magnitude;\n            const a2 = a[2] / magnitude;\n            const a3 = a[3] / magnitude;\n            const b0 = a[4];\n            const b1 = a[5];\n            const b2 = a[6];\n            const b3 = a[7];\n            const a_dot_b = a0 * b0 + a1 * b1 + a2 * b2 + a3 * b3;\n            out[0] = a0;\n            out[1] = a1;\n            out[2] = a2;\n            out[3] = a3;\n            out[4] = (b0 - a0 * a_dot_b) / magnitude;\n            out[5] = (b1 - a1 * a_dot_b) / magnitude;\n            out[6] = (b2 - a2 * a_dot_b) / magnitude;\n            out[7] = (b3 - a3 * a_dot_b) / magnitude;\n        }\n        return out;\n    }\n    /**\n     * Returns a string representation of a {@link Quat2}\n     * @category Static\n     *\n     * @param a - dual quaternion to represent as a string\n     * @returns string representation of the vector\n     */\n    static str(a) {\n        return `Quat2(${a.join(', ')})`;\n    }\n    /**\n     * Returns whether or not the {@link Quat2}s have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first dual quaternion.\n     * @param b - The second dual quaternion.\n     * @returns True if the dual quaternions are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return (a[0] === b[0] &&\n            a[1] === b[1] &&\n            a[2] === b[2] &&\n            a[3] === b[3] &&\n            a[4] === b[4] &&\n            a[5] === b[5] &&\n            a[6] === b[6] &&\n            a[7] === b[7]);\n    }\n    /**\n     * Returns whether or not the {@link Quat2}s have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first dual quaternion.\n     * @param b - The second dual quaternion.\n     * @returns True if the dual quaternions are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const a6 = a[6];\n        const a7 = a[7];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        const b4 = b[4];\n        const b5 = b[5];\n        const b6 = b[6];\n        const b7 = b[7];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) &&\n            Math.abs(a4 - b4) <= EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) &&\n            Math.abs(a5 - b5) <= EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) &&\n            Math.abs(a6 - b6) <= EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) &&\n            Math.abs(a7 - b7) <= EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)));\n    }\n}\n// Temporary variables to prevent repeated allocations in the algorithms above.\nconst tempQuat = [0, 0, 0, 0];\nconst tempVec3 = [0, 0, 0];\n// Methods which re-use the Quat implementation\n// @ts-ignore\nQuat2.dot = Quat.dot;\n// @ts-ignore\nQuat2.squaredLength = Quat.squaredLength;\n// @ts-ignore\nQuat2.sqrLen = Quat.squaredLength;\n// @ts-ignore\nQuat2.mag = Quat.magnitude;\n// @ts-ignore\nQuat2.length = Quat.magnitude;\n// @ts-ignore\nQuat2.len = Quat.magnitude;\n// Static method alias assignments\nQuat2.mul = Quat2.multiply;\n\n/**\n * 2 Dimensional Vector\n */\nclass Vec2 extends Float32Array {\n    /**\n     * The number of bytes in a {@link Vec2}.\n     */\n    static BYTE_LENGTH = 2 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Vec2}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 2: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, values[1]]);\n                }\n                else {\n                    super(v, values[1], 2);\n                }\n                break;\n            }\n            case 1: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, v]);\n                }\n                else {\n                    super(v, 0, 2);\n                }\n                break;\n            }\n            default:\n                super(2);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    // Getters and setters to make component access read better.\n    // These are likely to be a little bit slower than direct array access.\n    /**\n     * The x component of the vector. Equivalent to `this[0];`\n     * @category Vector components\n     */\n    get x() { return this[0]; }\n    set x(value) { this[0] = value; }\n    /**\n     * The y component of the vector. Equivalent to `this[1];`\n     * @category Vector components\n     */\n    get y() { return this[1]; }\n    set y(value) { this[1] = value; }\n    // Alternate set of getters and setters in case this is being used to define\n    // a color.\n    /**\n     * The r component of the vector. Equivalent to `this[0];`\n     * @category Color components\n     */\n    get r() { return this[0]; }\n    set r(value) { this[0] = value; }\n    /**\n     * The g component of the vector. Equivalent to `this[1];`\n     * @category Color components\n     */\n    get g() { return this[1]; }\n    set g(value) { this[1] = value; }\n    /**\n     * The magnitude (length) of this.\n     * Equivalent to `Vec2.magnitude(this);`\n     *\n     * Magnitude is used because the `length` attribute is already defined by\n     * `Float32Array` to mean the number of elements in the array.\n     */\n    get magnitude() {\n        return Math.hypot(this[0], this[1]);\n    }\n    /**\n     * Alias for {@link Vec2.magnitude}\n     */\n    get mag() { return this.magnitude; }\n    /**\n     * The squared magnitude (length) of `this`.\n     * Equivalent to `Vec2.squaredMagnitude(this);`\n     */\n    get squaredMagnitude() {\n        const x = this[0];\n        const y = this[1];\n        return x * x + y * y;\n    }\n    /**\n     * Alias for {@link Vec2.squaredMagnitude}\n     */\n    get sqrMag() { return this.squaredMagnitude; }\n    /**\n     * A string representation of `this`\n     * Equivalent to `Vec2.str(this);`\n     */\n    get str() {\n        return Vec2.str(this);\n    }\n    //===================\n    // Instances methods\n    //===================\n    /**\n     * Copy the values from another {@link Vec2} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        this.set(a);\n        return this;\n    }\n    // Instead of zero(), use a.fill(0) for instances;\n    /**\n     * Adds a {@link Vec2} to `this`.\n     * Equivalent to `Vec2.add(this, this, b);`\n     *\n     * @param b - The vector to add to `this`\n     * @returns `this`\n     */\n    add(b) {\n        this[0] += b[0];\n        this[1] += b[1];\n        return this;\n    }\n    /**\n     * Subtracts a {@link Vec2} from `this`.\n     * Equivalent to `Vec2.subtract(this, this, b);`\n     *\n     * @param b - The vector to subtract from `this`\n     * @returns `this`\n     */\n    subtract(b) {\n        this[0] -= b[0];\n        this[1] -= b[1];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec2.subtract}\n     */\n    sub(b) { return this; }\n    /**\n     * Multiplies `this` by a {@link Vec2}.\n     * Equivalent to `Vec2.multiply(this, this, b);`\n     *\n     * @param b - The vector to multiply `this` by\n     * @returns `this`\n     */\n    multiply(b) {\n        this[0] *= b[0];\n        this[1] *= b[1];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec2.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Divides `this` by a {@link Vec2}.\n     * Equivalent to `Vec2.divide(this, this, b);`\n     *\n     * @param b - The vector to divide `this` by\n     * @returns {Vec2} `this`\n     */\n    divide(b) {\n        this[0] /= b[0];\n        this[1] /= b[1];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec2.divide}\n     */\n    div(b) { return this; }\n    /**\n     * Scales `this` by a scalar number.\n     * Equivalent to `Vec2.scale(this, this, b);`\n     *\n     * @param b - Amount to scale `this` by\n     * @returns `this`\n     */\n    scale(b) {\n        this[0] *= b;\n        this[1] *= b;\n        return this;\n    }\n    /**\n     * Calculates `this` scaled by a scalar value then adds the result to `this`.\n     * Equivalent to `Vec2.scaleAndAdd(this, this, b, scale);`\n     *\n     * @param b - The vector to add to `this`\n     * @param scale - The amount to scale `b` by before adding\n     * @returns `this`\n     */\n    scaleAndAdd(b, scale) {\n        this[0] += b[0] * scale;\n        this[1] += b[1] * scale;\n        return this;\n    }\n    /**\n     * Calculates the euclidian distance between another {@link Vec2} and `this`.\n     * Equivalent to `Vec2.distance(this, b);`\n     *\n     * @param b - The vector to calculate the distance to\n     * @returns Distance between `this` and `b`\n     */\n    distance(b) {\n        return Vec2.distance(this, b);\n    }\n    /**\n     * Alias for {@link Vec2.distance}\n     */\n    dist(b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between another {@link Vec2} and `this`.\n     * Equivalent to `Vec2.squaredDistance(this, b);`\n     *\n     * @param b The vector to calculate the squared distance to\n     * @returns Squared distance between `this` and `b`\n     */\n    squaredDistance(b) {\n        return Vec2.squaredDistance(this, b);\n    }\n    /**\n     * Alias for {@link Vec2.squaredDistance}\n     */\n    sqrDist(b) { return 0; }\n    /**\n     * Negates the components of `this`.\n     * Equivalent to `Vec2.negate(this, this);`\n     *\n     * @returns `this`\n     */\n    negate() {\n        this[0] *= -1;\n        this[1] *= -1;\n        return this;\n    }\n    /**\n     * Inverts the components of `this`.\n     * Equivalent to `Vec2.inverse(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        this[0] = 1.0 / this[0];\n        this[1] = 1.0 / this[1];\n        return this;\n    }\n    /**\n     * Calculates the dot product of this and another {@link Vec2}.\n     * Equivalent to `Vec2.dot(this, b);`\n     *\n     * @param b - The second operand\n     * @returns Dot product of `this` and `b`\n     */\n    dot(b) {\n        return this[0] * b[0] + this[1] * b[1];\n    }\n    /**\n     * Normalize `this`.\n     * Equivalent to `Vec2.normalize(this, this);`\n     *\n     * @returns `this`\n     */\n    normalize() {\n        return Vec2.normalize(this, this);\n    }\n    //================\n    // Static methods\n    //================\n    /**\n     * Creates a new, empty {@link Vec2}\n     * @category Static\n     *\n     * @returns A new 2D vector\n     */\n    static create() {\n        return new Vec2();\n    }\n    /**\n     * Creates a new {@link Vec2} initialized with values from an existing vector\n     * @category Static\n     *\n     * @param a - Vector to clone\n     * @returns A new 2D vector\n     */\n    static clone(a) {\n        return new Vec2(a);\n    }\n    /**\n     * Creates a new {@link Vec2} initialized with the given values\n     * @category Static\n     *\n     * @param x - X component\n     * @param y - Y component\n     * @returns A new 2D vector\n     */\n    static fromValues(x, y) {\n        return new Vec2(x, y);\n    }\n    /**\n     * Copy the values from one {@link Vec2} to another\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - The source vector\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        return out;\n    }\n    /**\n     * Set the components of a {@link Vec2} to the given values\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param x - X component\n     * @param y - Y component\n     * @returns `out`\n     */\n    static set(out, x, y) {\n        out[0] = x;\n        out[1] = y;\n        return out;\n    }\n    /**\n     * Adds two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        return out;\n    }\n    /**\n     * Subtracts vector b from vector a\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec2.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return [0, 0]; }\n    /**\n     * Multiplies two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        out[0] = a[0] * b[0];\n        out[1] = a[1] * b[1];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec2.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return [0, 0]; }\n    /**\n     * Divides two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static divide(out, a, b) {\n        out[0] = a[0] / b[0];\n        out[1] = a[1] / b[1];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec2.divide}\n     * @category Static\n     */\n    static div(out, a, b) { return [0, 0]; }\n    /**\n     * Math.ceil the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to ceil\n     * @returns `out`\n     */\n    static ceil(out, a) {\n        out[0] = Math.ceil(a[0]);\n        out[1] = Math.ceil(a[1]);\n        return out;\n    }\n    /**\n     * Math.floor the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to floor\n     * @returns `out`\n     */\n    static floor(out, a) {\n        out[0] = Math.floor(a[0]);\n        out[1] = Math.floor(a[1]);\n        return out;\n    }\n    /**\n     * Returns the minimum of two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static min(out, a, b) {\n        out[0] = Math.min(a[0], b[0]);\n        out[1] = Math.min(a[1], b[1]);\n        return out;\n    }\n    /**\n     * Returns the maximum of two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static max(out, a, b) {\n        out[0] = Math.max(a[0], b[0]);\n        out[1] = Math.max(a[1], b[1]);\n        return out;\n    }\n    /**\n     * Math.round the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to round\n     * @returns `out`\n     */\n    static round(out, a) {\n        out[0] = Math.round(a[0]);\n        out[1] = Math.round(a[1]);\n        return out;\n    }\n    /**\n     * Scales a {@link Vec2} by a scalar number\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The vector to scale\n     * @param b - Amount to scale the vector by\n     * @returns `out`\n     */\n    static scale(out, a, b) {\n        out[0] = a[0] * b;\n        out[1] = a[1] * b;\n        return out;\n    }\n    /**\n     * Adds two Vec2's after scaling the second operand by a scalar value\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @param scale - The amount to scale b by before adding\n     * @returns `out`\n     */\n    static scaleAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        return out;\n    }\n    /**\n     * Calculates the euclidian distance between two {@link Vec2}s\n     * @category Static\n     *\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns distance between `a` and `b`\n     */\n    static distance(a, b) {\n        return Math.hypot(b[0] - a[0], b[1] - a[1]);\n    }\n    /**\n     * Alias for {@link Vec2.distance}\n     * @category Static\n     */\n    static dist(a, b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between two {@link Vec2}s\n     * @category Static\n     *\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns Squared distance between `a` and `b`\n     */\n    static squaredDistance(a, b) {\n        const x = b[0] - a[0];\n        const y = b[1] - a[1];\n        return x * x + y * y;\n    }\n    /**\n     * Alias for {@link Vec2.distance}\n     * @category Static\n     */\n    static sqrDist(a, b) { return 0; }\n    /**\n     * Calculates the magnitude (length) of a {@link Vec2}\n     * @category Static\n     *\n     * @param a - Vector to calculate magnitude of\n     * @returns Magnitude of a\n     */\n    static magnitude(a) {\n        let x = a[0];\n        let y = a[1];\n        return Math.sqrt(x * x + y * y);\n    }\n    /**\n     * Alias for {@link Vec2.magnitude}\n     * @category Static\n     */\n    static mag(a) { return 0; }\n    /**\n     * Alias for {@link Vec2.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec2.magnitude} to avoid conflicts with builtin `length` methods/attribs\n     *\n     * @param a - vector to calculate length of\n     * @returns length of a\n     */\n    // @ts-ignore: Length conflicts with Function.length\n    static length(a) { return 0; }\n    /**\n     * Alias for {@link Vec2.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec2.mag}\n     */\n    static len(a) { return 0; }\n    /**\n     * Calculates the squared length of a {@link Vec2}\n     * @category Static\n     *\n     * @param a - Vector to calculate squared length of\n     * @returns Squared length of a\n     */\n    static squaredLength(a) {\n        const x = a[0];\n        const y = a[1];\n        return x * x + y * y;\n    }\n    /**\n     * Alias for {@link Vec2.squaredLength}\n     */\n    static sqrLen(a, b) { return 0; }\n    /**\n     * Negates the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to negate\n     * @returns `out`\n     */\n    static negate(out, a) {\n        out[0] = -a[0];\n        out[1] = -a[1];\n        return out;\n    }\n    /**\n     * Returns the inverse of the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to invert\n     * @returns `out`\n     */\n    static inverse(out, a) {\n        out[0] = 1.0 / a[0];\n        out[1] = 1.0 / a[1];\n        return out;\n    }\n    /**\n     * Normalize a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to normalize\n     * @returns `out`\n     */\n    static normalize(out, a) {\n        const x = a[0];\n        const y = a[1];\n        let len = x * x + y * y;\n        if (len > 0) {\n            //TODO: evaluate use of glm_invsqrt here?\n            len = 1 / Math.sqrt(len);\n        }\n        out[0] = a[0] * len;\n        out[1] = a[1] * len;\n        return out;\n    }\n    /**\n     * Calculates the dot product of two {@link Vec2}s\n     * @category Static\n     *\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns Dot product of `a` and `b`\n     */\n    static dot(a, b) {\n        return a[0] * b[0] + a[1] * b[1];\n    }\n    /**\n     * Computes the cross product of two {@link Vec2}s\n     * Note that the cross product must by definition produce a 3D vector.\n     * For this reason there is also not instance equivalent for this function.\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static cross(out, a, b) {\n        const z = a[0] * b[1] - a[1] * b[0];\n        out[0] = out[1] = 0;\n        out[2] = z;\n        return out;\n    }\n    /**\n     * Performs a linear interpolation between two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @param t - Interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static lerp(out, a, b, t) {\n        const ax = a[0];\n        const ay = a[1];\n        out[0] = ax + t * (b[0] - ax);\n        out[1] = ay + t * (b[1] - ay);\n        return out;\n    }\n    /**\n     * Transforms the {@link Vec2} with a {@link Mat2}\n     *\n     * @param out - The receiving vector\n     * @param a - The vector to transform\n     * @param m - Matrix to transform with\n     * @returns `out`\n     */\n    static transformMat2(out, a, m) {\n        const x = a[0];\n        const y = a[1];\n        out[0] = m[0] * x + m[2] * y;\n        out[1] = m[1] * x + m[3] * y;\n        return out;\n    }\n    /**\n     * Transforms the {@link Vec2} with a {@link Mat2d}\n     *\n     * @param out - The receiving vector\n     * @param a - The vector to transform\n     * @param m - Matrix to transform with\n     * @returns `out`\n     */\n    static transformMat2d(out, a, m) {\n        const x = a[0];\n        const y = a[1];\n        out[0] = m[0] * x + m[2] * y + m[4];\n        out[1] = m[1] * x + m[3] * y + m[5];\n        return out;\n    }\n    /**\n     * Transforms the {@link Vec2} with a {@link Mat3}\n     * 3rd vector component is implicitly '1'\n     *\n     * @param out - The receiving vector\n     * @param a - The vector to transform\n     * @param m - Matrix to transform with\n     * @returns `out`\n     */\n    static transformMat3(out, a, m) {\n        const x = a[0];\n        const y = a[1];\n        out[0] = m[0] * x + m[3] * y + m[6];\n        out[1] = m[1] * x + m[4] * y + m[7];\n        return out;\n    }\n    /**\n     * Transforms the {@link Vec2} with a {@link Mat4}\n     * 3rd vector component is implicitly '0'\n     * 4th vector component is implicitly '1'\n     *\n     * @param out - The receiving vector\n     * @param a - The vector to transform\n     * @param m - Matrix to transform with\n     * @returns `out`\n     */\n    static transformMat4(out, a, m) {\n        const x = a[0];\n        const y = a[1];\n        out[0] = m[0] * x + m[4] * y + m[12];\n        out[1] = m[1] * x + m[5] * y + m[13];\n        return out;\n    }\n    /**\n     * Rotate a 2D vector\n     * @category Static\n     *\n     * @param out - The receiving {@link Vec2}\n     * @param a - The {@link Vec2} point to rotate\n     * @param b - The origin of the rotation\n     * @param rad - The angle of rotation in radians\n     * @returns `out`\n     */\n    static rotate(out, a, b, rad) {\n        //Translate point to the origin\n        const p0 = a[0] - b[0];\n        const p1 = a[1] - b[1];\n        const sinC = Math.sin(rad);\n        const cosC = Math.cos(rad);\n        //perform rotation and translate to correct position\n        out[0] = p0 * cosC - p1 * sinC + b[0];\n        out[1] = p0 * sinC + p1 * cosC + b[1];\n        return out;\n    }\n    /**\n     * Get the angle between two 2D vectors\n     * @category Static\n     *\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns The angle in radians\n     */\n    static angle(a, b) {\n        const x1 = a[0];\n        const y1 = a[1];\n        const x2 = b[0];\n        const y2 = b[1];\n        // mag is the product of the magnitudes of a and b\n        const mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2);\n        // mag &&.. short circuits if mag == 0\n        const cosine = mag && (x1 * x2 + y1 * y2) / mag;\n        // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n        return Math.acos(Math.min(Math.max(cosine, -1), 1));\n    }\n    /**\n     * Set the components of a {@link Vec2} to zero\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @returns `out`\n     */\n    static zero(out) {\n        out[0] = 0.0;\n        out[1] = 0.0;\n        return out;\n    }\n    /**\n     * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns `true` if the vectors components are ===, `false` otherwise.\n     */\n    static exactEquals(a, b) {\n        return a[0] === b[0] && a[1] === b[1];\n    }\n    /**\n     * Returns whether or not the vectors have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns `true` if the vectors are approximately equal, `false` otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const b0 = b[0];\n        const b1 = b[1];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)));\n    }\n    /**\n     * Returns a string representation of a vector\n     * @category Static\n     *\n     * @param a - Vector to represent as a string\n     * @returns String representation of the vector\n     */\n    static str(a) {\n        return `Vec2(${a.join(', ')})`;\n    }\n}\n// Instance method alias assignments\nVec2.prototype.sub = Vec2.prototype.subtract;\nVec2.prototype.mul = Vec2.prototype.multiply;\nVec2.prototype.div = Vec2.prototype.divide;\nVec2.prototype.dist = Vec2.prototype.distance;\nVec2.prototype.sqrDist = Vec2.prototype.squaredDistance;\n// Static method alias assignments\nVec2.sub = Vec2.subtract;\nVec2.mul = Vec2.multiply;\nVec2.div = Vec2.divide;\nVec2.dist = Vec2.distance;\nVec2.sqrDist = Vec2.squaredDistance;\nVec2.sqrLen = Vec2.squaredLength;\nVec2.mag = Vec2.magnitude;\nVec2.length = Vec2.magnitude;\nVec2.len = Vec2.magnitude;\n\n// The contents of the following section are autogenerated by scripts/gen-swizzle.js and should\n// not be modified by hand.\n// [Swizzle Autogen]\nconst VEC2_SWIZZLES = ['xx', 'xy', 'yx', 'yy', 'xxx', 'xxy', 'xyx', 'xyy', 'yxx', 'yxy', 'yyx', 'yyy', 'xxxx', 'xxxy', 'xxyx', 'xxyy', 'xyxx', 'xyxy', 'xyyx', 'xyyy', 'yxxx', 'yxxy', 'yxyx', 'yxyy', 'yyxx', 'yyxy', 'yyyx', 'yyyy', 'rr', 'rg', 'gr', 'gg', 'rrr', 'rrg', 'rgr', 'rgg', 'grr', 'grg', 'ggr', 'ggg', 'rrrr', 'rrrg', 'rrgr', 'rrgg', 'rgrr', 'rgrg', 'rggr', 'rggg', 'grrr', 'grrg', 'grgr', 'grgg', 'ggrr', 'ggrg', 'gggr', 'gggg'];\nconst VEC3_SWIZZLES = ['xz', 'yz', 'zx', 'zy', 'zz', 'xxz', 'xyz', 'xzx', 'xzy', 'xzz', 'yxz', 'yyz', 'yzx', 'yzy', 'yzz', 'zxx', 'zxy', 'zxz', 'zyx', 'zyy', 'zyz', 'zzx', 'zzy', 'zzz', 'xxxz', 'xxyz', 'xxzx', 'xxzy', 'xxzz', 'xyxz', 'xyyz', 'xyzx', 'xyzy', 'xyzz', 'xzxx', 'xzxy', 'xzxz', 'xzyx', 'xzyy', 'xzyz', 'xzzx', 'xzzy', 'xzzz', 'yxxz', 'yxyz', 'yxzx', 'yxzy', 'yxzz', 'yyxz', 'yyyz', 'yyzx', 'yyzy', 'yyzz', 'yzxx', 'yzxy', 'yzxz', 'yzyx', 'yzyy', 'yzyz', 'yzzx', 'yzzy', 'yzzz', 'zxxx', 'zxxy', 'zxxz', 'zxyx', 'zxyy', 'zxyz', 'zxzx', 'zxzy', 'zxzz', 'zyxx', 'zyxy', 'zyxz', 'zyyx', 'zyyy', 'zyyz', 'zyzx', 'zyzy', 'zyzz', 'zzxx', 'zzxy', 'zzxz', 'zzyx', 'zzyy', 'zzyz', 'zzzx', 'zzzy', 'zzzz', 'rb', 'gb', 'br', 'bg', 'bb', 'rrb', 'rgb', 'rbr', 'rbg', 'rbb', 'grb', 'ggb', 'gbr', 'gbg', 'gbb', 'brr', 'brg', 'brb', 'bgr', 'bgg', 'bgb', 'bbr', 'bbg', 'bbb', 'rrrb', 'rrgb', 'rrbr', 'rrbg', 'rrbb', 'rgrb', 'rggb', 'rgbr', 'rgbg', 'rgbb', 'rbrr', 'rbrg', 'rbrb', 'rbgr', 'rbgg', 'rbgb', 'rbbr', 'rbbg', 'rbbb', 'grrb', 'grgb', 'grbr', 'grbg', 'grbb', 'ggrb', 'gggb', 'ggbr', 'ggbg', 'ggbb', 'gbrr', 'gbrg', 'gbrb', 'gbgr', 'gbgg', 'gbgb', 'gbbr', 'gbbg', 'gbbb', 'brrr', 'brrg', 'brrb', 'brgr', 'brgg', 'brgb', 'brbr', 'brbg', 'brbb', 'bgrr', 'bgrg', 'bgrb', 'bggr', 'bggg', 'bggb', 'bgbr', 'bgbg', 'bgbb', 'bbrr', 'bbrg', 'bbrb', 'bbgr', 'bbgg', 'bbgb', 'bbbr', 'bbbg', 'bbbb'];\nconst VEC4_SWIZZLES = ['xw', 'yw', 'zw', 'wx', 'wy', 'wz', 'ww', 'xxw', 'xyw', 'xzw', 'xwx', 'xwy', 'xwz', 'xww', 'yxw', 'yyw', 'yzw', 'ywx', 'ywy', 'ywz', 'yww', 'zxw', 'zyw', 'zzw', 'zwx', 'zwy', 'zwz', 'zww', 'wxx', 'wxy', 'wxz', 'wxw', 'wyx', 'wyy', 'wyz', 'wyw', 'wzx', 'wzy', 'wzz', 'wzw', 'wwx', 'wwy', 'wwz', 'www', 'xxxw', 'xxyw', 'xxzw', 'xxwx', 'xxwy', 'xxwz', 'xxww', 'xyxw', 'xyyw', 'xyzw', 'xywx', 'xywy', 'xywz', 'xyww', 'xzxw', 'xzyw', 'xzzw', 'xzwx', 'xzwy', 'xzwz', 'xzww', 'xwxx', 'xwxy', 'xwxz', 'xwxw', 'xwyx', 'xwyy', 'xwyz', 'xwyw', 'xwzx', 'xwzy', 'xwzz', 'xwzw', 'xwwx', 'xwwy', 'xwwz', 'xwww', 'yxxw', 'yxyw', 'yxzw', 'yxwx', 'yxwy', 'yxwz', 'yxww', 'yyxw', 'yyyw', 'yyzw', 'yywx', 'yywy', 'yywz', 'yyww', 'yzxw', 'yzyw', 'yzzw', 'yzwx', 'yzwy', 'yzwz', 'yzww', 'ywxx', 'ywxy', 'ywxz', 'ywxw', 'ywyx', 'ywyy', 'ywyz', 'ywyw', 'ywzx', 'ywzy', 'ywzz', 'ywzw', 'ywwx', 'ywwy', 'ywwz', 'ywww', 'zxxw', 'zxyw', 'zxzw', 'zxwx', 'zxwy', 'zxwz', 'zxww', 'zyxw', 'zyyw', 'zyzw', 'zywx', 'zywy', 'zywz', 'zyww', 'zzxw', 'zzyw', 'zzzw', 'zzwx', 'zzwy', 'zzwz', 'zzww', 'zwxx', 'zwxy', 'zwxz', 'zwxw', 'zwyx', 'zwyy', 'zwyz', 'zwyw', 'zwzx', 'zwzy', 'zwzz', 'zwzw', 'zwwx', 'zwwy', 'zwwz', 'zwww', 'wxxx', 'wxxy', 'wxxz', 'wxxw', 'wxyx', 'wxyy', 'wxyz', 'wxyw', 'wxzx', 'wxzy', 'wxzz', 'wxzw', 'wxwx', 'wxwy', 'wxwz', 'wxww', 'wyxx', 'wyxy', 'wyxz', 'wyxw', 'wyyx', 'wyyy', 'wyyz', 'wyyw', 'wyzx', 'wyzy', 'wyzz', 'wyzw', 'wywx', 'wywy', 'wywz', 'wyww', 'wzxx', 'wzxy', 'wzxz', 'wzxw', 'wzyx', 'wzyy', 'wzyz', 'wzyw', 'wzzx', 'wzzy', 'wzzz', 'wzzw', 'wzwx', 'wzwy', 'wzwz', 'wzww', 'wwxx', 'wwxy', 'wwxz', 'wwxw', 'wwyx', 'wwyy', 'wwyz', 'wwyw', 'wwzx', 'wwzy', 'wwzz', 'wwzw', 'wwwx', 'wwwy', 'wwwz', 'wwww', 'ra', 'ga', 'ba', 'ar', 'ag', 'ab', 'aa', 'rra', 'rga', 'rba', 'rar', 'rag', 'rab', 'raa', 'gra', 'gga', 'gba', 'gar', 'gag', 'gab', 'gaa', 'bra', 'bga', 'bba', 'bar', 'bag', 'bab', 'baa', 'arr', 'arg', 'arb', 'ara', 'agr', 'agg', 'agb', 'aga', 'abr', 'abg', 'abb', 'aba', 'aar', 'aag', 'aab', 'aaa', 'rrra', 'rrga', 'rrba', 'rrar', 'rrag', 'rrab', 'rraa', 'rgra', 'rgga', 'rgba', 'rgar', 'rgag', 'rgab', 'rgaa', 'rbra', 'rbga', 'rbba', 'rbar', 'rbag', 'rbab', 'rbaa', 'rarr', 'rarg', 'rarb', 'rara', 'ragr', 'ragg', 'ragb', 'raga', 'rabr', 'rabg', 'rabb', 'raba', 'raar', 'raag', 'raab', 'raaa', 'grra', 'grga', 'grba', 'grar', 'grag', 'grab', 'graa', 'ggra', 'ggga', 'ggba', 'ggar', 'ggag', 'ggab', 'ggaa', 'gbra', 'gbga', 'gbba', 'gbar', 'gbag', 'gbab', 'gbaa', 'garr', 'garg', 'garb', 'gara', 'gagr', 'gagg', 'gagb', 'gaga', 'gabr', 'gabg', 'gabb', 'gaba', 'gaar', 'gaag', 'gaab', 'gaaa', 'brra', 'brga', 'brba', 'brar', 'brag', 'brab', 'braa', 'bgra', 'bgga', 'bgba', 'bgar', 'bgag', 'bgab', 'bgaa', 'bbra', 'bbga', 'bbba', 'bbar', 'bbag', 'bbab', 'bbaa', 'barr', 'barg', 'barb', 'bara', 'bagr', 'bagg', 'bagb', 'baga', 'babr', 'babg', 'babb', 'baba', 'baar', 'baag', 'baab', 'baaa', 'arrr', 'arrg', 'arrb', 'arra', 'argr', 'argg', 'argb', 'arga', 'arbr', 'arbg', 'arbb', 'arba', 'arar', 'arag', 'arab', 'araa', 'agrr', 'agrg', 'agrb', 'agra', 'aggr', 'aggg', 'aggb', 'agga', 'agbr', 'agbg', 'agbb', 'agba', 'agar', 'agag', 'agab', 'agaa', 'abrr', 'abrg', 'abrb', 'abra', 'abgr', 'abgg', 'abgb', 'abga', 'abbr', 'abbg', 'abbb', 'abba', 'abar', 'abag', 'abab', 'abaa', 'aarr', 'aarg', 'aarb', 'aara', 'aagr', 'aagg', 'aagb', 'aaga', 'aabr', 'aabg', 'aabb', 'aaba', 'aaar', 'aaag', 'aaab', 'aaaa'];\n// [/Swizzle Autogen]\nconst SWIZZLE_INDEX = {\n    x: 0, r: 0,\n    y: 1, g: 1,\n    z: 2, b: 2,\n    w: 3, a: 3,\n};\nfunction getSwizzleImpl(swizzle) {\n    switch (swizzle.length) {\n        case 2:\n            return function () { return new Vec2(this[SWIZZLE_INDEX[swizzle[0]]], this[SWIZZLE_INDEX[swizzle[1]]]); };\n        case 3:\n            return function () { return new Vec3(this[SWIZZLE_INDEX[swizzle[0]]], this[SWIZZLE_INDEX[swizzle[1]]], this[SWIZZLE_INDEX[swizzle[2]]]); };\n        case 4:\n            return function () { return new Vec4(this[SWIZZLE_INDEX[swizzle[0]]], this[SWIZZLE_INDEX[swizzle[1]]], this[SWIZZLE_INDEX[swizzle[2]]], this[SWIZZLE_INDEX[swizzle[3]]]); };\n    }\n}\nlet swizzlesEnabled = false;\n/**\n * Enables Swizzle operations on {@link Vec2}, {@link Vec3}, and {@link Vec4} types.\n *\n * Swizzle operations are performed by using the `.` operator in conjunction with any combination\n * of between two to four component names, either from the set `xyzw` or `rgbw` (though not intermixed).\n * They return a new vector with the same number of components as specified in the swizzle attribute.\n *\n * @example\n * ```js\n * import { Vec3, EnableSwizzles } from 'gl-matrix';\n *\n * EnableSwizzles();\n *\n * let v = new Vec3(0, 1, 2);\n *\n * v.yx // returns new Vec2(1, 0);\n * v.xzy // returns new Vec3(0, 2, 1);\n * v.zyxz // returns new Vec4(2, 1, 0, 2);\n *\n * v.rgb // returns new Vec3(0, 1, 2);\n * v.rbg // returns new Vec3(0, 2, 1);\n * v.gg // returns new Vec2(1, 1);\n * ```\n */\nfunction EnableSwizzles() {\n    if (swizzlesEnabled) {\n        return;\n    }\n    for (const swizzle of VEC2_SWIZZLES) {\n        const impl = getSwizzleImpl(swizzle);\n        Object.defineProperty(Vec2.prototype, swizzle, {\n            get: impl\n        });\n        Object.defineProperty(Vec3.prototype, swizzle, {\n            get: impl\n        });\n        Object.defineProperty(Vec4.prototype, swizzle, {\n            get: impl\n        });\n    }\n    for (const swizzle of VEC3_SWIZZLES) {\n        const impl = getSwizzleImpl(swizzle);\n        Object.defineProperty(Vec3.prototype, swizzle, {\n            get: impl\n        });\n        Object.defineProperty(Vec4.prototype, swizzle, {\n            get: impl\n        });\n    }\n    for (const swizzle of VEC4_SWIZZLES) {\n        const impl = getSwizzleImpl(swizzle);\n        Object.defineProperty(Vec4.prototype, swizzle, {\n            get: impl\n        });\n    }\n    swizzlesEnabled = true;\n}\n\nexport { EnableSwizzles, Mat2, Mat2d, Mat3, Mat4, Quat, Quat2, Vec2, Vec3, Vec4 };\n//# sourceMappingURL=index.js.map\n","/**\n * Awaits `requestAnimationFrame` calls by the counter specified. This allows asynchronous applications for direct /\n * inline style modification amongst other direct animation techniques.\n *\n * @param {number}   [cntr=1] - A positive integer greater than 0 for amount of requestAnimationFrames to wait.\n *\n * @returns {Promise<number>} Returns current time equivalent to `performance.now()`.\n */\nasync function nextAnimationFrame(cntr = 1)\n{\n   if (!Number.isInteger(cntr) || cntr < 1)\n   {\n      throw new TypeError(`nextAnimationFrame error: 'cntr' must be a positive integer greater than 0.`);\n   }\n\n   let currentTime = performance.now();\n   for (;--cntr >= 0;)\n   {\n      currentTime = await new Promise((resolve) => requestAnimationFrame(resolve));\n   }\n\n   return currentTime;\n}\n\nexport { nextAnimationFrame };\n//# sourceMappingURL=index.js.map\n","/**\n * Clamps a value between min / max values.\n *\n * @param {number}   value - Value to clamp.\n *\n * @param {number}   min - Minimum value.\n *\n * @param {number}   max - Maximum value.\n *\n * @returns {number} Clamped value.\n */\nfunction clamp(value = 0, min = 0, max = 0)\n{\n   return Math.min(Math.max(value, min), max);\n}\n\n/**\n * Converts the given number from degrees to radians.\n *\n * @param {number}   deg - Degree number to convert\n *\n * @returns {number} Degree as radians.\n */\nfunction degToRad(deg)\n{\n   return deg * (Math.PI / 180.0);\n}\n\n/**\n * Converts the given number from radians to degrees.\n *\n * @param {number}   rad - Radian number to convert.\n *\n * @returns {number} Degree as radians.\n */\nfunction radToDeg(rad)\n{\n   return rad * (180.0 / Math.PI);\n}\n\nexport { clamp, degToRad, radToDeg };\n//# sourceMappingURL=index.js.map\n","import { propertyStore } from '@typhonjs-fvtt/runtime/svelte/store/writable-derived';\nimport { isObject, isPlainObject, isIterable, hasSetter } from '@typhonjs-fvtt/runtime/util/object';\nimport { subscribeIgnoreFirst } from '@typhonjs-fvtt/runtime/util/store';\nimport { cubicOut, linear } from 'svelte/easing';\nimport { lerp } from '@typhonjs-fvtt/runtime/math/interpolate';\nimport { writable } from 'svelte/store';\nimport { StyleParse } from '@typhonjs-fvtt/runtime/util/browser';\nimport { Mat4, Vec3 } from '@typhonjs-fvtt/runtime/math/gl-matrix';\nimport { nextAnimationFrame } from '@typhonjs-fvtt/runtime/util/animate';\nimport { degToRad, clamp } from '@typhonjs-fvtt/runtime/math/util';\n\n/**\n * Provides a TJSBasicAnimation implementation for TJSPosition animation.\n */\nclass AnimationControl\n{\n   /** @type {object} */\n   #animationData;\n\n   /** @type {Promise<void>} */\n   #finishedPromise;\n\n   #willFinish;\n\n   /**\n    * Defines a static empty / void animation control.\n    *\n    * @type {AnimationControl}\n    */\n   static #voidControl = new AnimationControl(null);\n\n   /**\n    * Provides a static void / undefined AnimationControl that is automatically resolved.\n    *\n    * @returns {AnimationControl} Void AnimationControl\n    */\n   static get voidControl() { return this.#voidControl; }\n\n   /**\n    * @param {object|null} [animationData] - Animation data from {@link AnimationAPI}.\n    *\n    * @param {boolean}     [willFinish] - Promise that tracks animation finished state.\n    */\n   constructor(animationData, willFinish = false)\n   {\n      this.#animationData = animationData;\n      this.#willFinish = willFinish;\n\n      // Set this control to animation data.\n      if (isObject(animationData)) { animationData.control = this; }\n   }\n\n   /**\n    * Get a promise that resolves when animation is finished.\n    *\n    * @returns {Promise<void>}\n    */\n   get finished()\n   {\n      if (!(this.#finishedPromise instanceof Promise))\n      {\n         this.#finishedPromise = this.#willFinish ? new Promise((resolve) => this.#animationData.resolve = resolve) :\n          Promise.resolve();\n      }\n\n      return this.#finishedPromise;\n   }\n\n   /**\n    * Returns whether this animation is currently active / animating.\n    *\n    * Note: a delayed animation may not be started / active yet. Use {@link AnimationControl.isFinished} to determine\n    * if an animation is actually finished.\n    *\n    * @returns {boolean} Animation active state.\n    */\n   get isActive() { return this.#animationData.active; }\n\n   /**\n    * Returns whether this animation is completely finished.\n    *\n    * @returns {boolean} Animation finished state.\n    */\n   get isFinished() { return this.#animationData.finished; }\n\n   /**\n    * Cancels the animation.\n    */\n   cancel()\n   {\n      const animationData = this.#animationData;\n\n      if (animationData === null || animationData === void 0) { return; }\n\n      // Set cancelled state to true and this animation data instance will be removed from AnimationManager on next\n      // update.\n      animationData.cancelled = true;\n   }\n}\n\n/**\n * Provides animation management and scheduling allowing all TJSPosition instances to utilize one micro-task.\n */\nclass AnimationManager\n{\n   /**\n    * @type {object[]}\n    */\n   static activeList = [];\n\n   /**\n    * @type {object[]}\n    */\n   static newList = [];\n\n   /**\n    * @type {number}\n    */\n   static current;\n\n   /**\n    * Add animation data.\n    *\n    * @param {object}   data -\n    */\n   static add(data)\n   {\n      const now = performance.now();\n\n      // Offset start time by delta between last rAF time. This allows continuous tween cycles to appear naturally as\n      // starting from the instant they are added to the AnimationManager. This is what makes `draggable` smooth when\n      // easing is enabled.\n      data.start = now + (AnimationManager.current - now);\n\n      AnimationManager.newList.push(data);\n   }\n\n   /**\n    * Manage all animation\n    */\n   static animate()\n   {\n      const current = AnimationManager.current = performance.now();\n\n      // Early out of the rAF callback when there are no current animations.\n      if (AnimationManager.activeList.length === 0 && AnimationManager.newList.length === 0)\n      {\n         globalThis.requestAnimationFrame(AnimationManager.animate);\n         return;\n      }\n\n      if (AnimationManager.newList.length)\n      {\n         // Process new data\n         for (let cntr = AnimationManager.newList.length; --cntr >= 0;)\n         {\n            const data = AnimationManager.newList[cntr];\n\n            // If animation instance has been cancelled before start then remove it from new list and cleanup.\n            if (data.cancelled)\n            {\n               AnimationManager.newList.splice(cntr, 1);\n               data.cleanup(data);\n            }\n\n            // If data is active then process it now. Delayed animations start with `active` false.\n            if (data.active)\n            {\n               // Remove from new list and add to active list.\n               AnimationManager.newList.splice(cntr, 1);\n               AnimationManager.activeList.push(data);\n            }\n         }\n      }\n\n      // Process active animations.\n      for (let cntr = AnimationManager.activeList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.activeList[cntr];\n\n         // Remove any animations that have been canceled.\n         // Ensure that the element is still connected otherwise remove it from active list and continue.\n         if (data.cancelled || (data.el !== void 0 && !data.el.isConnected))\n         {\n            AnimationManager.activeList.splice(cntr, 1);\n            data.cleanup(data);\n            continue;\n         }\n\n         data.current = current - data.start;\n\n         // Remove this animation instance if current animating time exceeds duration.\n         if (data.current >= data.duration)\n         {\n            // Prepare final update with end position data.\n            for (let dataCntr = data.keys.length; --dataCntr >= 0;)\n            {\n               const key = data.keys[dataCntr];\n               data.newData[key] = data.destination[key];\n            }\n\n            data.position.set(data.newData);\n\n            AnimationManager.activeList.splice(cntr, 1);\n            data.cleanup(data);\n\n            continue;\n         }\n\n         // Apply easing to create an eased time.\n         const easedTime = data.ease(data.current / data.duration);\n\n         for (let dataCntr = data.keys.length; --dataCntr >= 0;)\n         {\n            const key = data.keys[dataCntr];\n            data.newData[key] = data.interpolate(data.initial[key], data.destination[key], easedTime);\n         }\n\n         data.position.set(data.newData);\n      }\n\n      globalThis.requestAnimationFrame(AnimationManager.animate);\n   }\n\n   /**\n    * Cancels all animations for given TJSPosition instance.\n    *\n    * @param {import('../').TJSPosition} position - TJSPosition instance.\n    */\n   static cancel(position)\n   {\n      for (let cntr = AnimationManager.activeList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.activeList[cntr];\n         if (data.position === position)\n         {\n            AnimationManager.activeList.splice(cntr, 1);\n            data.cancelled = true;\n            data.cleanup(data);\n         }\n      }\n\n      for (let cntr = AnimationManager.newList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.newList[cntr];\n         if (data.position === position)\n         {\n            AnimationManager.newList.splice(cntr, 1);\n            data.cancelled = true;\n            data.cleanup(data);\n         }\n      }\n   }\n\n   /**\n    * Cancels all active and delayed animations.\n    */\n   static cancelAll()\n   {\n      for (let cntr = AnimationManager.activeList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.activeList[cntr];\n         data.cancelled = true;\n         data.cleanup(data);\n      }\n\n      for (let cntr = AnimationManager.newList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.newList[cntr];\n         data.cancelled = true;\n         data.cleanup(data);\n      }\n\n      AnimationManager.activeList.length = 0;\n      AnimationManager.newList.length = 0;\n   }\n\n   /**\n    * Gets all {@link AnimationControl} instances for a given TJSPosition instance.\n    *\n    * @param {import('../index.js').TJSPosition} position - TJSPosition instance.\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation[]} All scheduled AnimationControl instances for the\n    *          given TJSPosition instance.\n    */\n   static getScheduled(position)\n   {\n      const results = [];\n\n      for (let cntr = AnimationManager.activeList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.activeList[cntr];\n         if (data.position === position)\n         {\n            results.push(data.control);\n         }\n      }\n\n      for (let cntr = AnimationManager.newList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.newList[cntr];\n         if (data.position === position)\n         {\n            results.push(data.control);\n         }\n      }\n\n      return results;\n   }\n}\n\n// Start animation manager immediately. It constantly is running in background.\nAnimationManager.animate();\n\n/**\n * Stores the TJSPositionData properties that can be animated.\n *\n * @type {Set<string>}\n */\nconst animateKeys = new Set([\n   // Main keys\n   'left', 'top', 'maxWidth', 'maxHeight', 'minWidth', 'minHeight', 'width', 'height',\n   'rotateX', 'rotateY', 'rotateZ', 'scale', 'translateX', 'translateY', 'translateZ', 'zIndex',\n\n   // Aliases\n   'rotation'\n]);\n\n/**\n * Defines the keys of TJSPositionData that are transform keys.\n *\n * @type {string[]}\n */\nconst transformKeys = ['rotateX', 'rotateY', 'rotateZ', 'scale', 'translateX', 'translateY', 'translateZ'];\n\nObject.freeze(transformKeys);\n\n/**\n * Parses a relative value string in the form of '+=', '-=', or '*=' and float / numeric value. IE '+=0.2'.\n *\n * @type {RegExp}\n */\nconst relativeRegex = /^([-+*])=(-?[\\d]*\\.?[\\d]+)$/;\n\n/**\n * Provides numeric defaults for all parameters. This is used by {@link TJSPosition.get} to optionally\n * provide numeric defaults.\n *\n * @type {{rotation: number, scale: number, minWidth: null, minHeight: null, translateZ: number, top: number, left: number, maxHeight: null, translateY: number, translateX: number, width: number, transformOrigin: null, rotateX: number, rotateY: number, height: number, maxWidth: null, zIndex: null, rotateZ: number}}\n */\nconst numericDefaults = {\n   // Other keys\n   height: 0,\n   left: 0,\n   maxHeight: null,\n   maxWidth: null,\n   minHeight: null,\n   minWidth: null,\n   top: 0,\n   transformOrigin: null,\n   width: 0,\n   zIndex: null,\n\n   rotateX: 0,\n   rotateY: 0,\n   rotateZ: 0,\n   scale: 1,\n   translateX: 0,\n   translateY: 0,\n   translateZ: 0,\n\n   rotation: 0\n};\n\nObject.freeze(numericDefaults);\n\n/**\n * Sets numeric defaults for a {@link TJSPositionData} like object.\n *\n * @param {object}   data - A TJSPositionData like object.\n */\nfunction setNumericDefaults(data)\n{\n   // Transform keys\n   if (data.rotateX === null) { data.rotateX = 0; }\n   if (data.rotateY === null) { data.rotateY = 0; }\n   if (data.rotateZ === null) { data.rotateZ = 0; }\n   if (data.translateX === null) { data.translateX = 0; }\n   if (data.translateY === null) { data.translateY = 0; }\n   if (data.translateZ === null) { data.translateZ = 0; }\n   if (data.scale === null) { data.scale = 1; }\n\n   // Aliases\n   if (data.rotation === null) { data.rotation = 0; }\n}\n\n/**\n * Defines bitwise keys for transforms used in {@link TJSTransforms.getMat4}.\n *\n * @type {object}\n */\nconst transformKeysBitwise = {\n   rotateX: 1,\n   rotateY: 2,\n   rotateZ: 4,\n   scale: 8,\n   translateX: 16,\n   translateY: 32,\n   translateZ: 64\n};\n\nObject.freeze(transformKeysBitwise);\n\n/**\n * Defines the default transform origin.\n *\n * @type {string}\n */\nconst transformOriginDefault = 'top left';\n\n/**\n * Defines the valid transform origins.\n *\n * @type {string[]}\n */\nconst transformOrigins = ['top left', 'top center', 'top right', 'center left', 'center', 'center right', 'bottom left',\n 'bottom center', 'bottom right'];\n\nObject.freeze(transformOrigins);\n\n/**\n * Converts any relative string values for animatable keys to actual updates performed against current data.\n *\n * @param {import('./').TJSPositionDataExtended}    positionData - position data.\n *\n * @param {import('./').TJSPosition | import('./').TJSPositionData}   position - The source position instance.\n */\nfunction convertRelative(positionData, position)\n{\n   for (const key in positionData)\n   {\n      // Key is animatable / numeric.\n      if (animateKeys.has(key))\n      {\n         const value = positionData[key];\n\n         if (typeof value !== 'string') { continue; }\n\n         // Ignore 'auto' and 'inherit' string values.\n         if (value === 'auto' || value === 'inherit') { continue; }\n\n         const regexResults = relativeRegex.exec(value);\n\n         if (!regexResults)\n         {\n            throw new Error(\n             `convertRelative error: malformed relative key (${key}) with value (${value})`);\n         }\n\n         const current = position[key];\n\n         switch (regexResults[1])\n         {\n            case '-':\n               positionData[key] = current - parseFloat(regexResults[2]);\n               break;\n\n            case '+':\n               positionData[key] = current + parseFloat(regexResults[2]);\n               break;\n\n            case '*':\n               positionData[key] = current * parseFloat(regexResults[2]);\n               break;\n         }\n      }\n   }\n}\n\nclass AnimationAPI\n{\n   /** @type {import('../').TJSPositionData} */\n   #data;\n\n   /** @type {import('../').TJSPosition} */\n   #position;\n\n   /**\n    * Tracks the number of animation control instances that are active.\n    *\n    * @type {number}\n    */\n   #instanceCount = 0;\n\n   /**\n    * Provides a bound function to pass as data to AnimationManager to invoke `AnimationAPI.#cleanupInstance`.\n    *\n    * @type {Function}\n    */\n   #cleanup;\n\n   /**\n    * @param {import('../index.js').TJSPosition}       position -\n    *\n    * @param {import('../index.js').TJSPositionData}   data -\n    */\n   constructor(position, data)\n   {\n      this.#position = position;\n      this.#data = data;\n\n      this.#cleanup = this.#cleanupInstance.bind(this);\n   }\n\n   /**\n    * Returns whether there are scheduled animations whether active or delayed for this TJSPosition.\n    *\n    * @returns {boolean} Are there active animation instances.\n    */\n   get isScheduled()\n   {\n      return this.#instanceCount > 0;\n   }\n\n   /**\n    * Adds / schedules an animation w/ the AnimationManager. This contains the final steps common to all tweens.\n    *\n    * @param {object}      initial -\n    *\n    * @param {object}      destination -\n    *\n    * @param {number}      duration -\n    *\n    * @param {HTMLElement} el -\n    *\n    * @param {number}      delay -\n    *\n    * @param {Function}    ease -\n    *\n    * @param {Function}    interpolate -\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation} The associated animation control.\n    */\n   #addAnimation(initial, destination, duration, el, delay, ease, interpolate)\n   {\n      // Set initial data for transform values that are often null by default.\n      setNumericDefaults(initial);\n      setNumericDefaults(destination);\n\n      // Reject all initial data that is not a number.\n      for (const key in initial)\n      {\n         if (!Number.isFinite(initial[key])) { delete initial[key]; }\n      }\n\n      const keys = Object.keys(initial);\n      const newData = Object.assign({ immediateElementUpdate: true }, initial);\n\n      // Nothing to animate, so return now.\n      if (keys.length === 0) { return AnimationControl.voidControl; }\n\n      const animationData = {\n         active: true,\n         cleanup: this.#cleanup,\n         cancelled: false,\n         control: void 0,\n         current: 0,\n         destination,\n         duration: duration * 1000, // Internally the AnimationManager works in ms.\n         ease,\n         el,\n         finished: false,\n         initial,\n         interpolate,\n         keys,\n         newData,\n         position: this.#position,\n         resolve: void 0,\n         start: void 0\n      };\n\n      if (delay > 0)\n      {\n         animationData.active = false;\n\n         // Delay w/ setTimeout and schedule w/ AnimationManager if not already canceled\n         setTimeout(() =>\n         {\n            if (!animationData.cancelled)\n            {\n               animationData.active = true;\n\n               const now = performance.now();\n\n               // Offset start time by delta between last rAF time. This allows a delayed tween to start from the\n               // precise delayed time.\n               animationData.start = now + (AnimationManager.current - now);\n            }\n         }, delay * 1000);\n      }\n\n      // Schedule immediately w/ AnimationManager\n      this.#instanceCount++;\n      AnimationManager.add(animationData);\n\n      // Create animation control\n      return new AnimationControl(animationData, true);\n   }\n\n   /**\n    * Cancels all animation instances for this TJSPosition instance.\n    */\n   cancel()\n   {\n      AnimationManager.cancel(this.#position);\n   }\n\n   /**\n    * Cleans up an animation instance.\n    *\n    * @param {object}   data - Animation data for an animation instance.\n    */\n   #cleanupInstance(data)\n   {\n      this.#instanceCount--;\n\n      data.active = false;\n      data.finished = true;\n\n      if (typeof data.resolve === 'function') { data.resolve(data.cancelled); }\n   }\n\n   /**\n    * Returns all currently scheduled AnimationControl instances for this TJSPosition instance.\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation[]} All currently scheduled animation controls for\n    *          this TJSPosition instance.\n    */\n   getScheduled()\n   {\n      return AnimationManager.getScheduled(this.#position);\n   }\n\n   /**\n    * Provides a tween from given position data to the current position.\n    *\n    * @param {import('../index.js').TJSPositionDataExtended} fromData - The starting position.\n    *\n    * @param {object}         [opts] - Optional parameters.\n    *\n    * @param {number}         [opts.delay=0] - Delay in seconds before animation starts.\n    *\n    * @param {number}         [opts.duration=1] - Duration in seconds.\n    *\n    * @param {Function}       [opts.ease=cubicOut] - Easing function.\n    *\n    * @param {Function}       [opts.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation}  A control object that can cancel animation and\n    *          provides a `finished` Promise.\n    */\n   from(fromData, { delay = 0, duration = 1, ease = cubicOut, interpolate = lerp } = {})\n   {\n      if (!isObject(fromData))\n      {\n         throw new TypeError(`AnimationAPI.from error: 'fromData' is not an object.`);\n      }\n\n      const position = this.#position;\n      const parent = position.parent;\n\n      // Early out if the application is not positionable.\n      if (parent !== void 0 && typeof parent?.options?.positionable === 'boolean' && !parent?.options?.positionable)\n      {\n         return AnimationControl.voidControl;\n      }\n\n      // Cache any target element allowing AnimationManager to stop animation if it becomes disconnected from DOM.\n      const targetEl = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n      const el = targetEl instanceof HTMLElement && targetEl.isConnected ? targetEl : void 0;\n\n      if (!Number.isFinite(delay) || delay < 0)\n      {\n         throw new TypeError(`AnimationAPI.from error: 'delay' is not a positive number.`);\n      }\n\n      if (!Number.isFinite(duration) || duration < 0)\n      {\n         throw new TypeError(`AnimationAPI.from error: 'duration' is not a positive number.`);\n      }\n\n      if (typeof ease !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.from error: 'ease' is not a function.`);\n      }\n\n      if (typeof interpolate !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.from error: 'interpolate' is not a function.`);\n      }\n\n      const initial = {};\n      const destination = {};\n\n      const data = this.#data;\n\n      // Set initial data if the key / data is defined and the end position is not equal to current data.\n      for (const key in fromData)\n      {\n         if (data[key] !== void 0 && fromData[key] !== data[key])\n         {\n            initial[key] = fromData[key];\n            destination[key] = data[key];\n         }\n      }\n\n      convertRelative(initial, data);\n\n      return this.#addAnimation(initial, destination, duration, el, delay, ease, interpolate);\n   }\n\n   /**\n    * Provides a tween from given position data to the current position.\n    *\n    * @param {import('../index.js').TJSPositionDataExtended} fromData - The starting position.\n    *\n    * @param {import('../index.js').TJSPositionDataExtended} toData - The ending position.\n    *\n    * @param {object}         [opts] - Optional parameters.\n    *\n    * @param {number}         [opts.delay=0] - Delay in seconds before animation starts.\n    *\n    * @param {number}         [opts.duration=1] - Duration in seconds.\n    *\n    * @param {Function}       [opts.ease=cubicOut] - Easing function.\n    *\n    * @param {Function}       [opts.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation}  A control object that can cancel animation and\n    *          provides a `finished` Promise.\n    */\n   fromTo(fromData, toData, { delay = 0, duration = 1, ease = cubicOut, interpolate = lerp } = {})\n   {\n      if (!isObject(fromData))\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'fromData' is not an object.`);\n      }\n\n      if (!isObject(toData))\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'toData' is not an object.`);\n      }\n\n      const parent = this.#position.parent;\n\n      // Early out if the application is not positionable.\n      if (parent !== void 0 && typeof parent?.options?.positionable === 'boolean' && !parent?.options?.positionable)\n      {\n         return AnimationControl.voidControl;\n      }\n\n      // Cache any target element allowing AnimationManager to stop animation if it becomes disconnected from DOM.\n      const targetEl = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n      const el = targetEl instanceof HTMLElement && targetEl.isConnected ? targetEl : void 0;\n\n      if (!Number.isFinite(delay) || delay < 0)\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'delay' is not a positive number.`);\n      }\n\n      if (!Number.isFinite(duration) || duration < 0)\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'duration' is not a positive number.`);\n      }\n\n      if (typeof ease !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'ease' is not a function.`);\n      }\n\n      if (typeof interpolate !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'interpolate' is not a function.`);\n      }\n\n      const initial = {};\n      const destination = {};\n\n      const data = this.#data;\n\n      // Set initial data if the key / data is defined and the end position is not equal to current data.\n      for (const key in fromData)\n      {\n         if (toData[key] === void 0)\n         {\n            console.warn(\n             `AnimationAPI.fromTo warning: key ('${key}') from 'fromData' missing in 'toData'; skipping this key.`);\n            continue;\n         }\n\n         if (data[key] !== void 0)\n         {\n            initial[key] = fromData[key];\n            destination[key] = toData[key];\n         }\n      }\n\n      convertRelative(initial, data);\n      convertRelative(destination, data);\n\n      return this.#addAnimation(initial, destination, duration, el, delay, ease, interpolate);\n   }\n\n   /**\n    * Provides a tween to given position data from the current position.\n    *\n    * @param {import('../index.js').TJSPositionDataExtended} toData - The destination position.\n    *\n    * @param {object}         [opts] - Optional parameters.\n    *\n    * @param {number}         [opts.delay=0] - Delay in seconds before animation starts.\n    *\n    * @param {number}         [opts.duration=1] - Duration in seconds.\n    *\n    * @param {Function}       [opts.ease=cubicOut] - Easing function.\n    *\n    * @param {Function}       [opts.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation}  A control object that can cancel animation and\n    *          provides a `finished` Promise.\n    */\n   to(toData, { delay = 0, duration = 1, ease = cubicOut, interpolate = lerp } = {})\n   {\n      if (!isObject(toData))\n      {\n         throw new TypeError(`AnimationAPI.to error: 'toData' is not an object.`);\n      }\n\n      const parent = this.#position.parent;\n\n      // Early out if the application is not positionable.\n      if (parent !== void 0 && typeof parent?.options?.positionable === 'boolean' && !parent?.options?.positionable)\n      {\n         return AnimationControl.voidControl;\n      }\n\n      // Cache any target element allowing AnimationManager to stop animation if it becomes disconnected from DOM.\n      const targetEl = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n      const el = targetEl instanceof HTMLElement && targetEl.isConnected ? targetEl : void 0;\n\n      if (!Number.isFinite(delay) || delay < 0)\n      {\n         throw new TypeError(`AnimationAPI.to error: 'delay' is not a positive number.`);\n      }\n\n      if (!Number.isFinite(duration) || duration < 0)\n      {\n         throw new TypeError(`AnimationAPI.to error: 'duration' is not a positive number.`);\n      }\n\n      if (typeof ease !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.to error: 'ease' is not a function.`);\n      }\n\n      if (typeof interpolate !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.to error: 'interpolate' is not a function.`);\n      }\n\n      const initial = {};\n      const destination = {};\n\n      const data = this.#data;\n\n      // Set initial data if the key / data is defined and the end position is not equal to current data.\n      for (const key in toData)\n      {\n         if (data[key] !== void 0 && toData[key] !== data[key])\n         {\n            destination[key] = toData[key];\n            initial[key] = data[key];\n         }\n      }\n\n      convertRelative(destination, data);\n\n      return this.#addAnimation(initial, destination, duration, el, delay, ease, interpolate);\n   }\n\n   /**\n    * Returns a function that provides an optimized way to constantly update a to-tween.\n    *\n    * @param {Iterable<string>}  keys - The keys for quickTo.\n    *\n    * @param {object}            [opts] - Optional parameters.\n    *\n    * @param {number}            [opts.duration=1] - Duration in seconds.\n    *\n    * @param {Function}          [opts.ease=cubicOut] - Easing function.\n    *\n    * @param {Function}          [opts.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {import('../index.js').quickToCallback} quick-to tween function.\n    */\n   quickTo(keys, { duration = 1, ease = cubicOut, interpolate = lerp } = {})\n   {\n      if (!isIterable(keys))\n      {\n         throw new TypeError(`AnimationAPI.quickTo error: 'keys' is not an iterable list.`);\n      }\n\n      const parent = this.#position.parent;\n\n      // Early out if the application is not positionable.\n      if (parent !== void 0 && typeof parent?.options?.positionable === 'boolean' && !parent?.options?.positionable)\n      {\n         throw new Error(`AnimationAPI.quickTo error: 'parent' is not positionable.`);\n      }\n\n      if (!Number.isFinite(duration) || duration < 0)\n      {\n         throw new TypeError(`AnimationAPI.quickTo error: 'duration' is not a positive number.`);\n      }\n\n      if (typeof ease !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.quickTo error: 'ease' is not a function.`);\n      }\n\n      if (typeof interpolate !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.quickTo error: 'interpolate' is not a function.`);\n      }\n\n      const initial = {};\n      const destination = {};\n\n      const data = this.#data;\n\n      // Set initial data if the key / data is defined and the end position is not equal to current data.\n      for (const key of keys)\n      {\n         if (typeof key !== 'string')\n         {\n            throw new TypeError(`AnimationAPI.quickTo error: key is not a string.`);\n         }\n\n         if (!animateKeys.has(key))\n         {\n            throw new Error(`AnimationAPI.quickTo error: key ('${key}') is not animatable.`);\n         }\n\n         if (data[key] !== void 0)\n         {\n            destination[key] = data[key];\n            initial[key] = data[key];\n         }\n      }\n\n      const keysArray = [...keys];\n\n      Object.freeze(keysArray);\n\n      const newData = Object.assign({ immediateElementUpdate: true }, initial);\n\n      const animationData = {\n         active: true,\n         cleanup: this.#cleanup,\n         cancelled: false,\n         control: void 0,\n         current: 0,\n         destination,\n         duration: duration * 1000, // Internally the AnimationManager works in ms.\n         ease,\n         el: void 0,\n         finished: true, // Note: start in finished state to add to AnimationManager on first callback.\n         initial,\n         interpolate,\n         keys,\n         newData,\n         position: this.#position,\n         resolve: void 0,\n         start: void 0\n      };\n\n      const quickToCB = (...args) =>\n      {\n         const argsLength = args.length;\n\n         if (argsLength === 0) { return; }\n\n         for (let cntr = keysArray.length; --cntr >= 0;)\n         {\n            const key = keysArray[cntr];\n            if (data[key] !== void 0) { initial[key] = data[key]; }\n         }\n\n         // Handle case where the first arg is an object. Update all quickTo keys from data contained in the object.\n         if (isObject(args[0]))\n         {\n            const objData = args[0];\n\n            for (const key in objData)\n            {\n               if (destination[key] !== void 0) { destination[key] = objData[key]; }\n            }\n         }\n         else // Assign each variable argument to the key specified in the initial `keys` array above.\n         {\n            for (let cntr = 0; cntr < argsLength && cntr < keysArray.length; cntr++)\n            {\n               const key = keysArray[cntr];\n               if (destination[key] !== void 0) { destination[key] = args[cntr]; }\n            }\n         }\n\n         convertRelative(destination, data);\n\n         // Set initial data for transform values that are often null by default.\n         setNumericDefaults(initial);\n         setNumericDefaults(destination);\n\n         // Set target element to animation data to track if it is removed from the DOM hence ending the animation.\n         const targetEl = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n         animationData.el = targetEl instanceof HTMLElement && targetEl.isConnected ? targetEl : void 0;\n\n         // Reschedule the quickTo animation with AnimationManager as it is finished.\n         if (animationData.finished)\n         {\n            animationData.finished = false;\n            animationData.active = true;\n            animationData.current = 0;\n\n            this.#instanceCount++;\n            AnimationManager.add(animationData);\n         }\n         else // QuickTo animation is currently scheduled w/ AnimationManager so reset start and current time.\n         {\n            const now = performance.now();\n\n            // Offset start time by delta between last rAF time. This allows a delayed tween to start from the\n            // precise delayed time.\n            animationData.start = now + (AnimationManager.current - now);\n            animationData.current = 0;\n         }\n      };\n\n      quickToCB.keys = keysArray;\n\n      /**\n       * Sets options of quickTo tween.\n       *\n       * @param {object}            [opts] - Optional parameters.\n       *\n       * @param {number}            [opts.duration] - Duration in seconds.\n       *\n       * @param {Function}          [opts.ease] - Easing function.\n       *\n       * @param {Function}          [opts.interpolate] - Interpolation function.\n       *\n       * @returns {import('../').quickToCallback} The quickTo callback.\n       */\n      quickToCB.options = ({ duration, ease, interpolate } = {}) => // eslint-disable-line no-shadow\n      {\n         if (duration !== void 0 && (!Number.isFinite(duration) || duration < 0))\n         {\n            throw new TypeError(`AnimationAPI.quickTo.options error: 'duration' is not a positive number.`);\n         }\n\n         if (ease !== void 0 && typeof ease !== 'function')\n         {\n            throw new TypeError(`AnimationAPI.quickTo.options error: 'ease' is not a function.`);\n         }\n\n         if (interpolate !== void 0 && typeof interpolate !== 'function')\n         {\n            throw new TypeError(`AnimationAPI.quickTo.options error: 'interpolate' is not a function.`);\n         }\n\n         if (duration >= 0) { animationData.duration = duration * 1000; }\n         if (ease) { animationData.ease = ease; }\n         if (interpolate) { animationData.interpolate = interpolate; }\n\n         return quickToCB;\n      };\n\n      return quickToCB;\n   }\n}\n\n/**\n * Provides a TJSBasicAnimation implementation for a TJSPosition animation for a group of TJSPosition instances.\n */\nclass AnimationGroupControl\n{\n   /** @type {import('./AnimationControl').AnimationControl[]} */\n   #animationControls;\n\n   /** @type {Promise<Awaited<unknown>[]>} */\n   #finishedPromise;\n\n   /**\n    * Defines a static empty / void animation control.\n    *\n    * @type {AnimationGroupControl}\n    */\n   static #voidControl = new AnimationGroupControl(null);\n\n   /**\n    * Provides a static void / undefined AnimationGroupControl that is automatically resolved.\n    *\n    * @returns {AnimationGroupControl} Void AnimationGroupControl\n    */\n   static get voidControl() { return this.#voidControl; }\n\n   /**\n    * @param {import('./AnimationControl').AnimationControl[]} animationControls - An array of AnimationControl\n    *        instances.\n    */\n   constructor(animationControls)\n   {\n      this.#animationControls = animationControls;\n   }\n\n   /**\n    * Get a promise that resolves when all animations are finished.\n    *\n    * @returns {Promise<Awaited<unknown>[]>|Promise<void>} Finished Promise for all animations.\n    */\n   get finished()\n   {\n      const animationControls = this.#animationControls;\n\n      if (animationControls === null || animationControls === void 0) { return Promise.resolve(); }\n\n      if (!(this.#finishedPromise instanceof Promise))\n      {\n         const promises = [];\n         for (let cntr = animationControls.length; --cntr >= 0;)\n         {\n            promises.push(animationControls[cntr].finished);\n         }\n\n         this.#finishedPromise = Promise.all(promises);\n      }\n\n      return this.#finishedPromise;\n   }\n\n   /**\n    * Returns whether there are active animation instances for this group.\n    *\n    * Note: a delayed animation may not be started / active yet. Use {@link AnimationGroupControl.isFinished} to\n    * determine if all animations in the group are finished.\n    *\n    * @returns {boolean} Are there active animation instances.\n    */\n   get isActive()\n   {\n      const animationControls = this.#animationControls;\n\n      if (animationControls === null || animationControls === void 0) { return false; }\n\n      for (let cntr = animationControls.length; --cntr >= 0;)\n      {\n         if (animationControls[cntr].isActive) { return true; }\n      }\n\n      return false;\n   }\n\n   /**\n    * Returns whether all animations in the group are finished.\n    *\n    * @returns {boolean} Are all animation instances finished.\n    */\n   get isFinished()\n   {\n      const animationControls = this.#animationControls;\n\n      if (animationControls === null || animationControls === void 0) { return true; }\n\n      for (let cntr = animationControls.length; --cntr >= 0;)\n      {\n         if (!animationControls[cntr].isFinished) { return false; }\n      }\n\n      return false;\n   }\n\n   /**\n    * Cancels the all animations.\n    */\n   cancel()\n   {\n      const animationControls = this.#animationControls;\n\n      if (animationControls === null || animationControls === void 0) { return; }\n\n      for (let cntr = this.#animationControls.length; --cntr >= 0;)\n      {\n         this.#animationControls[cntr].cancel();\n      }\n   }\n}\n\n/**\n * Provides a public API for grouping multiple {@link TJSPosition} animations together with the\n * AnimationManager.\n *\n * Note: To remove cyclic dependencies as this class provides the TJSPosition static / group Animation API `instanceof`\n * checks are not done against TJSPosition. Instead, a check for the animate property being an instanceof\n * {@link AnimationAPI} is performed in {@link AnimationGroupAPI.#isPosition}.\n *\n * @see AnimationAPI\n */\nclass AnimationGroupAPI\n{\n   /**\n    * Checks of the given object is a TJSPosition instance by checking for AnimationAPI.\n    *\n    * @param {*}  object - Any data.\n    *\n    * @returns {boolean} Is TJSPosition.\n    */\n   static #isPosition(object)\n   {\n      return isObject(object) && object.animate instanceof AnimationAPI;\n   }\n\n   /**\n    * Cancels any animation for given TJSPosition data.\n    *\n    * @param {import('../').TJSPosition | {position: import('../').TJSPosition} | Iterable<import('../').TJSPosition> | Iterable<{position: import('../').TJSPosition}>} position -\n    */\n   static cancel(position)\n   {\n      if (isIterable(position))\n      {\n         let index = -1;\n\n         for (const entry of position)\n         {\n            index++;\n\n            const actualPosition = this.#isPosition(entry) ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.cancel warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            AnimationManager.cancel(actualPosition);\n         }\n      }\n      else\n      {\n         const actualPosition = this.#isPosition(position) ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.cancel warning: No Position instance found.`);\n            return;\n         }\n\n         AnimationManager.cancel(actualPosition);\n      }\n   }\n\n   /**\n    * Cancels all TJSPosition animation.\n    */\n   static cancelAll() { AnimationManager.cancelAll(); }\n\n   /**\n    * Gets all animation controls for the given position data.\n    *\n    * @param {import('../').TJSPosition | {position: import('../').TJSPosition} | Iterable<import('../').TJSPosition> | Iterable<{position: import('../').TJSPosition}>} position -\n    *\n    * @returns {{ position: import('../').TJSPosition, data: object | void, controls: import('./AnimationControl').AnimationControl[]}[]} Results array.\n    */\n   static getScheduled(position)\n   {\n      const results = [];\n\n      if (isIterable(position))\n      {\n         let index = -1;\n\n         for (const entry of position)\n         {\n            index++;\n\n            const isPosition = this.#isPosition(entry);\n            const actualPosition = isPosition ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.getScheduled warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            const controls = AnimationManager.getScheduled(actualPosition);\n\n            results.push({ position: actualPosition, data: isPosition ? void 0 : entry, controls });\n         }\n      }\n      else\n      {\n         const isPosition = this.#isPosition(position);\n         const actualPosition = isPosition ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.getScheduled warning: No Position instance found.`);\n            return results;\n         }\n\n         const controls = AnimationManager.getScheduled(actualPosition);\n\n         results.push({ position: actualPosition, data: isPosition ? void 0 : position, controls });\n      }\n\n      return results;\n   }\n\n   /**\n    * Provides the `from` animation tween for one or more TJSPosition instances as a group.\n    *\n    * @param {import('../').TJSPosition | {position: import('../').TJSPosition} | Iterable<import('../').TJSPosition> | Iterable<{position: import('../').TJSPosition}>} position -\n    *\n    * @param {object|Function}   fromData -\n    *\n    * @param {object|Function}   options -\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation} Basic animation control.\n    */\n   static from(position, fromData, options)\n   {\n      if (!isObject(fromData) && typeof fromData !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.from error: 'fromData' is not an object or function.`);\n      }\n\n      if (options !== void 0 && !isObject(options) && typeof options !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.from error: 'options' is not an object or function.`);\n      }\n\n      /**\n       * @type {import('./AnimationControl').AnimationControl[]}\n       */\n      const animationControls = [];\n\n      let index = -1;\n      let callbackOptions;\n\n      const hasDataCallback = typeof fromData === 'function';\n      const hasOptionCallback = typeof options === 'function';\n      const hasCallback = hasDataCallback || hasOptionCallback;\n\n      if (hasCallback) { callbackOptions = { index, position: void 0, data: void 0 }; }\n\n      let actualFromData = fromData;\n      let actualOptions = options;\n\n      if (isIterable(position))\n      {\n         for (const entry of position)\n         {\n            index++;\n\n            const isPosition = this.#isPosition(entry);\n            const actualPosition = isPosition ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.from warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            if (hasCallback)\n            {\n               callbackOptions.index = index;\n               callbackOptions.position = position;\n               callbackOptions.data = isPosition ? void 0 : entry;\n            }\n\n            if (hasDataCallback)\n            {\n               actualFromData = fromData(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualFromData === null || actualFromData === void 0) { continue; }\n\n               if (!isObject(actualFromData))\n               {\n                  throw new TypeError(`AnimationGroupAPI.from error: fromData callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            if (hasOptionCallback)\n            {\n               actualOptions = options(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualOptions === null || actualOptions === void 0) { continue; }\n\n               if (!isObject(actualOptions))\n               {\n                  throw new TypeError(`AnimationGroupAPI.from error: options callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            animationControls.push(actualPosition.animate.from(actualFromData, actualOptions));\n         }\n      }\n      else\n      {\n         const isPosition = this.#isPosition(position);\n         const actualPosition = isPosition ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.from warning: No Position instance found.`);\n            return AnimationGroupControl.voidControl;\n         }\n\n         if (hasCallback)\n         {\n            callbackOptions.index = 0;\n            callbackOptions.position = position;\n            callbackOptions.data = isPosition ? void 0 : position;\n         }\n\n         if (hasDataCallback)\n         {\n            actualFromData = fromData(callbackOptions);\n\n            if (!isObject(actualFromData))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.from error: fromData callback function failed to return an object.`);\n            }\n         }\n\n         if (hasOptionCallback)\n         {\n            actualOptions = options(callbackOptions);\n\n            if (!isObject(actualOptions))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.from error: options callback function failed to return an object.`);\n            }\n         }\n\n         animationControls.push(actualPosition.animate.from(actualFromData, actualOptions));\n      }\n\n      return new AnimationGroupControl(animationControls);\n   }\n\n   /**\n    * Provides the `fromTo` animation tween for one or more TJSPosition instances as a group.\n    *\n    * @param {import('../').TJSPosition | {position: import('../').TJSPosition} | Iterable<import('../').TJSPosition> | Iterable<{position: import('../').TJSPosition}>} position -\n    *\n    * @param {object|Function}   fromData -\n    *\n    * @param {object|Function}   toData -\n    *\n    * @param {object|Function}   options -\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation} Basic animation control.\n    */\n   static fromTo(position, fromData, toData, options)\n   {\n      if (!isObject(fromData) && typeof fromData !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.fromTo error: 'fromData' is not an object or function.`);\n      }\n\n      if (!isObject(toData) && typeof toData !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.fromTo error: 'toData' is not an object or function.`);\n      }\n\n      if (options !== void 0 && !isObject(options) && typeof options !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.fromTo error: 'options' is not an object or function.`);\n      }\n\n      /**\n       * @type {import('./AnimationControl').AnimationControl[]}\n       */\n      const animationControls = [];\n\n      let index = -1;\n      let callbackOptions;\n\n      const hasFromCallback = typeof fromData === 'function';\n      const hasToCallback = typeof toData === 'function';\n      const hasOptionCallback = typeof options === 'function';\n      const hasCallback = hasFromCallback || hasToCallback || hasOptionCallback;\n\n      if (hasCallback) { callbackOptions = { index, position: void 0, data: void 0 }; }\n\n      let actualFromData = fromData;\n      let actualToData = toData;\n      let actualOptions = options;\n\n      if (isIterable(position))\n      {\n         for (const entry of position)\n         {\n            index++;\n\n            const isPosition = this.#isPosition(entry);\n            const actualPosition = isPosition ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.fromTo warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            if (hasCallback)\n            {\n               callbackOptions.index = index;\n               callbackOptions.position = position;\n               callbackOptions.data = isPosition ? void 0 : entry;\n            }\n\n            if (hasFromCallback)\n            {\n               actualFromData = fromData(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualFromData === null || actualFromData === void 0) { continue; }\n\n               if (!isObject(actualFromData))\n               {\n                  throw new TypeError(`AnimationGroupAPI.fromTo error: fromData callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            if (hasToCallback)\n            {\n               actualToData = toData(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualToData === null || actualToData === void 0) { continue; }\n\n               if (!isObject(actualToData))\n               {\n                  throw new TypeError(`AnimationGroupAPI.fromTo error: toData callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            if (hasOptionCallback)\n            {\n               actualOptions = options(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualOptions === null || actualOptions === void 0) { continue; }\n\n               if (!isObject(actualOptions))\n               {\n                  throw new TypeError(`AnimationGroupAPI.fromTo error: options callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            animationControls.push(actualPosition.animate.fromTo(actualFromData, actualToData, actualOptions));\n         }\n      }\n      else\n      {\n         const isPosition = this.#isPosition(position);\n         const actualPosition = isPosition ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.fromTo warning: No Position instance found.`);\n            return AnimationGroupControl.voidControl;\n         }\n\n         if (hasCallback)\n         {\n            callbackOptions.index = 0;\n            callbackOptions.position = position;\n            callbackOptions.data = isPosition ? void 0 : position;\n         }\n\n         if (hasFromCallback)\n         {\n            actualFromData = fromData(callbackOptions);\n\n            if (!isObject(actualFromData))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.fromTo error: fromData callback function failed to return an object.`);\n            }\n         }\n\n         if (hasToCallback)\n         {\n            actualToData = toData(callbackOptions);\n\n            if (!isObject(actualToData))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.fromTo error: toData callback function failed to return an object.`);\n            }\n         }\n\n         if (hasOptionCallback)\n         {\n            actualOptions = options(callbackOptions);\n\n            if (!isObject(actualOptions))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.fromTo error: options callback function failed to return an object.`);\n            }\n         }\n\n         animationControls.push(actualPosition.animate.fromTo(actualFromData, actualToData, actualOptions));\n      }\n\n      return new AnimationGroupControl(animationControls);\n   }\n\n   /**\n    * Provides the `to` animation tween for one or more TJSPosition instances as a group.\n    *\n    * @param {import('../').TJSPosition | {position: import('../').TJSPosition} | Iterable<import('../').TJSPosition> | Iterable<{position: import('../').TJSPosition}>} position -\n    *\n    * @param {object|Function}   toData -\n    *\n    * @param {object|Function}   options -\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation} Basic animation control.\n    */\n   static to(position, toData, options)\n   {\n      if (!isObject(toData) && typeof toData !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.to error: 'toData' is not an object or function.`);\n      }\n\n      if (options !== void 0 && !isObject(options) && typeof options !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.to error: 'options' is not an object or function.`);\n      }\n\n      /**\n       * @type {import('./AnimationControl').AnimationControl[]}\n       */\n      const animationControls = [];\n\n      let index = -1;\n      let callbackOptions;\n\n      const hasDataCallback = typeof toData === 'function';\n      const hasOptionCallback = typeof options === 'function';\n      const hasCallback = hasDataCallback || hasOptionCallback;\n\n      if (hasCallback) { callbackOptions = { index, position: void 0, data: void 0 }; }\n\n      let actualToData = toData;\n      let actualOptions = options;\n\n      if (isIterable(position))\n      {\n         for (const entry of position)\n         {\n            index++;\n\n            const isPosition = this.#isPosition(entry);\n            const actualPosition = isPosition ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.to warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            if (hasCallback)\n            {\n               callbackOptions.index = index;\n               callbackOptions.position = position;\n               callbackOptions.data = isPosition ? void 0 : entry;\n            }\n\n            if (hasDataCallback)\n            {\n               actualToData = toData(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualToData === null || actualToData === void 0) { continue; }\n\n               if (!isObject(actualToData))\n               {\n                  throw new TypeError(`AnimationGroupAPI.to error: toData callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            if (hasOptionCallback)\n            {\n               actualOptions = options(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualOptions === null || actualOptions === void 0) { continue; }\n\n               if (!isObject(actualOptions))\n               {\n                  throw new TypeError(`AnimationGroupAPI.to error: options callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            animationControls.push(actualPosition.animate.to(actualToData, actualOptions));\n         }\n      }\n      else\n      {\n         const isPosition = this.#isPosition(position);\n         const actualPosition = isPosition ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.to warning: No Position instance found.`);\n            return AnimationGroupControl.voidControl;\n         }\n\n         if (hasCallback)\n         {\n            callbackOptions.index = 0;\n            callbackOptions.position = position;\n            callbackOptions.data = isPosition ? void 0 : position;\n         }\n\n         if (hasDataCallback)\n         {\n            actualToData = toData(callbackOptions);\n\n            if (!isObject(actualToData))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.to error: toData callback function failed to return an object.`);\n            }\n         }\n\n         if (hasOptionCallback)\n         {\n            actualOptions = options(callbackOptions);\n\n            if (!isObject(actualOptions))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.to error: options callback function failed to return an object.`);\n            }\n         }\n\n         animationControls.push(actualPosition.animate.to(actualToData, actualOptions));\n      }\n\n      return new AnimationGroupControl(animationControls);\n   }\n\n   /**\n    * Provides the `to` animation tween for one or more TJSPosition instances as a group.\n    *\n    * @param {import('../').TJSPosition | {position: import('../').TJSPosition} | Iterable<import('../').TJSPosition> | Iterable<{position: import('../').TJSPosition}>} position -\n    *\n    * @param {Iterable<string>}  keys -\n    *\n    * @param {object|Function}   options -\n    *\n    * @returns {import('../').quickToCallback} Basic animation control.\n    */\n   static quickTo(position, keys, options)\n   {\n      if (!isIterable(keys))\n      {\n         throw new TypeError(`AnimationGroupAPI.quickTo error: 'keys' is not an iterable list.`);\n      }\n\n      if (options !== void 0 && !isObject(options) && typeof options !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.quickTo error: 'options' is not an object or function.`);\n      }\n\n      /**\n       * @type {import('../').quickToCallback[]}\n       */\n      const quickToCallbacks = [];\n\n      let index = -1;\n\n      const hasOptionCallback = typeof options === 'function';\n\n      const callbackOptions = { index, position: void 0, data: void 0 };\n\n      let actualOptions = options;\n\n      if (isIterable(position))\n      {\n         for (const entry of position)\n         {\n            index++;\n\n            const isPosition = this.#isPosition(entry);\n            const actualPosition = isPosition ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.quickTo warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            callbackOptions.index = index;\n            callbackOptions.position = position;\n            callbackOptions.data = isPosition ? void 0 : entry;\n\n            if (hasOptionCallback)\n            {\n               actualOptions = options(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualOptions === null || actualOptions === void 0) { continue; }\n\n               if (!isObject(actualOptions))\n               {\n                  throw new TypeError(`AnimationGroupAPI.quickTo error: options callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            quickToCallbacks.push(actualPosition.animate.quickTo(keys, actualOptions));\n         }\n      }\n      else\n      {\n         const isPosition = this.#isPosition(position);\n         const actualPosition = isPosition ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.quickTo warning: No Position instance found.`);\n            return () => null;\n         }\n\n         callbackOptions.index = 0;\n         callbackOptions.position = position;\n         callbackOptions.data = isPosition ? void 0 : position;\n\n         if (hasOptionCallback)\n         {\n            actualOptions = options(callbackOptions);\n\n            if (!isObject(actualOptions))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.quickTo error: options callback function failed to return an object.`);\n            }\n         }\n\n         quickToCallbacks.push(actualPosition.animate.quickTo(keys, actualOptions));\n      }\n\n      const keysArray = [...keys];\n\n      Object.freeze(keysArray);\n\n      const quickToCB = (...args) =>\n      {\n         const argsLength = args.length;\n\n         if (argsLength === 0) { return; }\n\n         if (typeof args[0] === 'function')\n         {\n            const dataCallback = args[0];\n\n            index = -1;\n            let cntr = 0;\n\n            if (isIterable(position))\n            {\n               for (const entry of position)\n               {\n                  index++;\n\n                  const isPosition = this.#isPosition(entry);\n                  const actualPosition = isPosition ? entry : entry.position;\n\n                  if (!this.#isPosition(actualPosition)) { continue; }\n\n                  callbackOptions.index = index;\n                  callbackOptions.position = position;\n                  callbackOptions.data = isPosition ? void 0 : entry;\n\n                  const toData = dataCallback(callbackOptions);\n\n                  // Returned data from callback is null / undefined, so skip this position instance.\n                  if (toData === null || toData === void 0) { continue; }\n\n                  /**\n                   * @type {boolean}\n                   */\n                  const toDataIterable = isIterable(toData);\n\n                  if (!Number.isFinite(toData) && !toDataIterable && !isObject(toData))\n                  {\n                     throw new TypeError(`AnimationGroupAPI.quickTo error: toData callback function iteration(${\n                      index}) failed to return a finite number, iterable list, or object.`);\n                  }\n\n                  if (toDataIterable)\n                  {\n                     quickToCallbacks[cntr++](...toData);\n                  }\n                  else\n                  {\n                     quickToCallbacks[cntr++](toData);\n                  }\n               }\n            }\n            else\n            {\n               const isPosition = this.#isPosition(position);\n               const actualPosition = isPosition ? position : position.position;\n\n               if (!this.#isPosition(actualPosition)) { return; }\n\n               callbackOptions.index = 0;\n               callbackOptions.position = position;\n               callbackOptions.data = isPosition ? void 0 : position;\n\n               const toData = dataCallback(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (toData === null || toData === void 0) { return; }\n\n               const toDataIterable = isIterable(toData);\n\n               if (!Number.isFinite(toData) && !toDataIterable && !isObject(toData))\n               {\n                  throw new TypeError(`AnimationGroupAPI.quickTo error: toData callback function iteration(${\n                   index}) failed to return a finite number, iterable list, or object.`);\n               }\n\n               if (toDataIterable)\n               {\n                  quickToCallbacks[cntr++](...toData);\n               }\n               else\n               {\n                  quickToCallbacks[cntr++](toData);\n               }\n            }\n         }\n         else\n         {\n            for (let cntr = quickToCallbacks.length; --cntr >= 0;)\n            {\n               quickToCallbacks[cntr](...args);\n            }\n         }\n      };\n\n      quickToCB.keys = keysArray;\n\n      /**\n       * Sets options of quickTo tween.\n       *\n       * @param {object|Function}   [options] - Optional parameters.\n       *\n       * @param {number}            [options.duration] - Duration in seconds.\n       *\n       * @param {Function}          [options.ease] - Easing function.\n       *\n       * @param {Function}          [options.interpolate] - Interpolation function.\n       *\n       * @returns {import('../').quickToCallback} The quickTo callback.\n       */\n      quickToCB.options = (options) => // eslint-disable-line no-shadow\n      {\n         if (options !== void 0 && !isObject(options) && typeof options !== 'function')\n         {\n            throw new TypeError(`AnimationGroupAPI.quickTo error: 'options' is not an object or function.`);\n         }\n\n         // Set options object for each quickTo callback.\n         if (isObject(options))\n         {\n            for (let cntr = quickToCallbacks.length; --cntr >= 0;) { quickToCallbacks[cntr].options(options); }\n         }\n         else if (typeof options === 'function')\n         {\n            if (isIterable(position))\n            {\n               index = -1;\n               let cntr = 0;\n\n               for (const entry of position)\n               {\n                  index++;\n\n                  const isPosition = this.#isPosition(entry);\n                  const actualPosition = isPosition ? entry : entry.position;\n\n                  if (!this.#isPosition(actualPosition))\n                  {\n                     console.warn(\n                      `AnimationGroupAPI.quickTo.options warning: No Position instance found at index: ${index}.`);\n                     continue;\n                  }\n\n                  callbackOptions.index = index;\n                  callbackOptions.position = position;\n                  callbackOptions.data = isPosition ? void 0 : entry;\n\n                  actualOptions = options(callbackOptions);\n\n                  // Returned data from callback is null / undefined, so skip this position instance.\n                  if (actualOptions === null || actualOptions === void 0) { continue; }\n\n                  if (!isObject(actualOptions))\n                  {\n                     throw new TypeError(\n                      `AnimationGroupAPI.quickTo.options error: options callback function iteration(${\n                       index}) failed to return an object.`);\n                  }\n\n                  quickToCallbacks[cntr++].options(actualOptions);\n               }\n            }\n            else\n            {\n               const isPosition = this.#isPosition(position);\n               const actualPosition = isPosition ? position : position.position;\n\n               if (!this.#isPosition(actualPosition))\n               {\n                  console.warn(`AnimationGroupAPI.quickTo.options warning: No Position instance found.`);\n                  return quickToCB;\n               }\n\n               callbackOptions.index = 0;\n               callbackOptions.position = position;\n               callbackOptions.data = isPosition ? void 0 : position;\n\n               actualOptions = options(callbackOptions);\n\n               if (!isObject(actualOptions))\n               {\n                  throw new TypeError(\n                   `AnimationGroupAPI.quickTo error: options callback function failed to return an object.`);\n               }\n\n               quickToCallbacks[0].options(actualOptions);\n            }\n         }\n\n         return quickToCB;\n      };\n\n      return quickToCB;\n   }\n}\n\n/**\n * Provides a {@link TJSPositionInitialHelper} implementation to center to element being positioned.\n */\nclass Centered\n{\n   /**\n    * @type {HTMLElement}\n    */\n   #element;\n\n   /**\n    * Provides a manual setting of the element height. As things go `offsetHeight` causes a browser layout and is not\n    * performance oriented. If manually set this height is used instead of `offsetHeight`.\n    *\n    * @type {number}\n    */\n   #height;\n\n   /**\n    * Set from an optional value in the constructor to lock accessors preventing modification.\n    */\n   #lock;\n\n   /**\n    * Provides a manual setting of the element width. As things go `offsetWidth` causes a browser layout and is not\n    * performance oriented. If manually set this width is used instead of `offsetWidth`.\n    *\n    * @type {number}\n    */\n   #width;\n\n   /**\n    * @param {object}      [options] - Initial options.\n    *\n    * @param {HTMLElement} [options.element] - Target element.\n    *\n    * @param {boolean}     [options.lock=false] - Lock parameters from being set.\n    *\n    * @param {number}      [options.width] - Manual width.\n    *\n    * @param {number}      [options.height] - Manual height.\n    */\n   constructor({ element, lock = false, width, height } = {})\n   {\n      this.element = element;\n      this.width = width;\n      this.height = height;\n\n      this.#lock = typeof lock === 'boolean' ? lock : false;\n   }\n\n   /**\n    * @returns {HTMLElement|undefined|null} Target element.\n    */\n   get element() { return this.#element; }\n\n   /**\n    * @returns {number} Get manual height.\n    */\n   get height() { return this.#height; }\n\n   /**\n    * @returns {number} Get manual width.\n    */\n   get width() { return this.#width; }\n\n   /**\n    * @param {HTMLElement|undefined|null} element - Set target element.\n    */\n   set element(element)\n   {\n      if (this.#lock) { return; }\n\n      if (element === void 0  || element === null || element instanceof HTMLElement)\n      {\n         this.#element = element;\n      }\n      else\n      {\n         throw new TypeError(`'element' is not a HTMLElement, undefined, or null.`);\n      }\n   }\n\n   /**\n    * @param {number}   height - Set manual height.\n    */\n   set height(height)\n   {\n      if (this.#lock) { return; }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   /**\n    * @param {number}   width - Set manual width.\n    */\n   set width(width)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n   }\n\n   /**\n    * Set manual width & height.\n    *\n    * @param {number}   width - New manual width.\n    *\n    * @param {number}   height - New manual height.\n    */\n   setDimension(width, height)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   /**\n    * Get the left constraint based on any manual target values or the browser inner width.\n    *\n    * @param {number}   width - Target width.\n    *\n    * @returns {number} Calculated left constraint.\n    */\n   getLeft(width)\n   {\n      // Determine containing bounds from manual values; or any element; lastly the browser width / height.\n      const boundsWidth = this.#width ?? this.#element?.offsetWidth ?? globalThis.innerWidth;\n\n      return (boundsWidth - width) / 2;\n   }\n\n   /**\n    * Get the top constraint based on any manual target values or the browser inner height.\n    *\n    * @param {number}   height - Target height.\n    *\n    * @returns {number} Calculated top constraint.\n    */\n   getTop(height)\n   {\n      const boundsHeight = this.#height ?? this.#element?.offsetHeight ?? globalThis.innerHeight;\n\n      return (boundsHeight - height) / 2;\n   }\n}\n\nclass PositionChangeSet\n{\n   constructor()\n   {\n      this.left = false;\n      this.top = false;\n      this.width = false;\n      this.height = false;\n      this.maxHeight = false;\n      this.maxWidth = false;\n      this.minHeight = false;\n      this.minWidth = false;\n      this.zIndex = false;\n      this.transform = false;\n      this.transformOrigin = false;\n   }\n\n   hasChange()\n   {\n      return this.left || this.top || this.width || this.height || this.maxHeight || this.maxWidth || this.minHeight ||\n       this.minWidth || this.zIndex || this.transform || this.transformOrigin;\n   }\n\n   set(value)\n   {\n      this.left = value;\n      this.top = value;\n      this.width = value;\n      this.height = value;\n      this.maxHeight = value;\n      this.maxWidth = value;\n      this.minHeight = value;\n      this.minWidth = value;\n      this.zIndex = value;\n      this.transform = value;\n      this.transformOrigin = value;\n   }\n}\n\n/**\n * Defines stored positional data.\n */\nclass TJSPositionData\n{\n   constructor({ height = null, left = null, maxHeight = null, maxWidth = null, minHeight = null, minWidth = null,\n    rotateX = null, rotateY = null, rotateZ = null, scale = null, translateX = null, translateY = null,\n     translateZ = null, top = null, transformOrigin = null, width = null, zIndex = null } = {})\n   {\n      /**\n       * @type {number|'auto'|'inherit'|null}\n       */\n      this.height = height;\n\n      /**\n       * @type {number|null}\n       */\n      this.left = left;\n\n      /**\n       * @type {number|null}\n       */\n      this.maxHeight = maxHeight;\n\n      /**\n       * @type {number|null}\n       */\n      this.maxWidth = maxWidth;\n\n      /**\n       * @type {number|null}\n       */\n      this.minHeight = minHeight;\n\n      /**\n       * @type {number|null}\n       */\n      this.minWidth = minWidth;\n\n      /**\n       * @type {number|null}\n       */\n      this.rotateX = rotateX;\n\n      /**\n       * @type {number|null}\n       */\n      this.rotateY = rotateY;\n\n      /**\n       * @type {number|null}\n       */\n      this.rotateZ = rotateZ;\n\n      /**\n       * @type {number|null}\n       */\n      this.scale = scale;\n\n      /**\n       * @type {number|null}\n       */\n      this.top = top;\n\n      /**\n       * @type {string|null}\n       */\n      this.transformOrigin = transformOrigin;\n\n      /**\n       * @type {number|null}\n       */\n      this.translateX = translateX;\n\n      /**\n       * @type {number|null}\n       */\n      this.translateY = translateY;\n\n      /**\n       * @type {number|null}\n       */\n      this.translateZ = translateZ;\n\n      /**\n       * @type {number|'auto'|'inherit'|null}\n       */\n      this.width = width;\n\n      /**\n       * @type {number|null}\n       */\n      this.zIndex = zIndex;\n\n      Object.seal(this);\n   }\n\n   /**\n    * Copies given data to this instance.\n    *\n    * @param {TJSPositionData}   data - Copy from this instance.\n    *\n    * @returns {TJSPositionData} This instance.\n    */\n   copy(data)\n   {\n      this.height = data.height;\n      this.left = data.left;\n      this.maxHeight = data.maxHeight;\n      this.maxWidth = data.maxWidth;\n      this.minHeight = data.minHeight;\n      this.minWidth = data.minWidth;\n      this.rotateX = data.rotateX;\n      this.rotateY = data.rotateY;\n      this.rotateZ = data.rotateZ;\n      this.scale = data.scale;\n      this.top = data.top;\n      this.transformOrigin = data.transformOrigin;\n      this.translateX = data.translateX;\n      this.translateY = data.translateY;\n      this.translateZ = data.translateZ;\n      this.width = data.width;\n      this.zIndex = data.zIndex;\n\n      return this;\n   }\n}\n\nclass PositionStateAPI\n{\n   /** @type {import('./TJSPositionData').TJSPositionData} */\n   #data;\n\n   /**\n    * @type {Map<string, import('./').TJSPositionDataExtended>}\n    */\n   #dataSaved = new Map();\n\n   /** @type {import('./').TJSPosition} */\n   #position;\n\n   /** @type {import('./transform').TJSTransforms} */\n   #transforms;\n\n   constructor(position, data, transforms)\n   {\n      this.#position = position;\n      this.#data = data;\n      this.#transforms = transforms;\n   }\n\n   /**\n    * Returns any stored save state by name.\n    *\n    * @param {object}   options - Options\n    *\n    * @param {string}   options.name - Saved data set name.\n    *\n    * @returns {import('./').TJSPositionDataExtended} The saved data set.\n    */\n   get({ name })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`Position - getSave error: 'name' is not a string.`); }\n\n      return this.#dataSaved.get(name);\n   }\n\n   /**\n    * Returns any associated default data.\n    *\n    * @returns {import('./').TJSPositionDataExtended} Associated default data.\n    */\n   getDefault()\n   {\n      return this.#dataSaved.get('#defaultData');\n   }\n\n   /**\n    * Removes and returns any position state by name.\n    *\n    * @param {object}   options - Options.\n    *\n    * @param {string}   options.name - Name to remove and retrieve.\n    *\n    * @returns {import('./').TJSPositionDataExtended} Saved position data.\n    */\n   remove({ name })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`Position - remove: 'name' is not a string.`); }\n\n      const data = this.#dataSaved.get(name);\n      this.#dataSaved.delete(name);\n\n      return data;\n   }\n\n   /**\n    * Resets data to default values and invokes set.\n    *\n    * @param {object}   [opts] - Optional parameters.\n    *\n    * @param {boolean}  [opts.keepZIndex=false] - When true keeps current z-index.\n    *\n    * @param {boolean}  [opts.invokeSet=true] - When true invokes set method.\n    *\n    * @returns {boolean} Operation successful.\n    */\n   reset({ keepZIndex = false, invokeSet = true } = {})\n   {\n      const defaultData = this.#dataSaved.get('#defaultData');\n\n      // Quit early if there is no saved default data.\n      if (!isObject(defaultData)) { return false; }\n\n      // Cancel all animations for TJSPosition if there are currently any scheduled.\n      if (this.#position.animate.isScheduled)\n      {\n         this.#position.animate.cancel();\n      }\n\n      const zIndex = this.#position.zIndex;\n\n      const data = Object.assign({}, defaultData);\n\n      if (keepZIndex) { data.zIndex = zIndex; }\n\n      // Reset the transform data.\n      this.#transforms.reset(data);\n\n      // If current minimized invoke `maximize`.\n      if (this.#position.parent?.reactive?.minimized)\n      {\n         this.#position.parent?.maximize?.({ animate: false, duration: 0 });\n      }\n\n      // Note next clock tick scheduling.\n      if (invokeSet) { setTimeout(() => this.#position.set(data), 0); }\n\n      return true;\n   }\n\n   /**\n    * Restores a saved positional state returning the data. Several optional parameters are available\n    * to control whether the restore action occurs silently (no store / inline styles updates), animates\n-   * to the stored data, or simply sets the stored data. Restoring via {@link AnimationAPI.to}\n    * allows specification of the duration, easing, and interpolate functions along with configuring a Promise to be\n    * returned if awaiting the end of the animation.\n    *\n    * @param {object}            params - Parameters\n    *\n    * @param {string}            params.name - Saved data set name.\n    *\n    * @param {boolean}           [params.remove=false] - Remove data set.\n    *\n    * @param {Iterable<string>}  [params.properties] - Specific properties to set / animate.\n    *\n    * @param {boolean}           [params.silent] - Set position data directly; no store or style updates.\n    *\n    * @param {boolean}           [params.async=false] - If animating return a Promise that resolves with any saved data.\n    *\n    * @param {boolean}           [params.animateTo=false] - Animate to restore data.\n    *\n    * @param {number}            [params.duration=0.1] - Duration in seconds.\n    *\n    * @param {Function}          [params.ease=linear] - Easing function.\n    *\n    * @param {Function}          [params.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {import('./').TJSPositionDataExtended | Promise<import('./').TJSPositionDataExtended>} Saved position\n    *          data.\n    */\n   restore({ name, remove = false, properties, silent = false, async = false, animateTo = false, duration = 0.1,\n    ease = linear, interpolate = lerp })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`Position - restore error: 'name' is not a string.`); }\n\n      const dataSaved = this.#dataSaved.get(name);\n\n      if (dataSaved)\n      {\n         if (remove) { this.#dataSaved.delete(name); }\n\n         let data = dataSaved;\n\n         if (isIterable(properties))\n         {\n            data = {};\n            for (const property of properties) { data[property] = dataSaved[property]; }\n         }\n\n         // Update data directly with no store or inline style updates.\n         if (silent)\n         {\n            for (const property in data) { this.#data[property] = data[property]; }\n            return dataSaved;\n         }\n         else if (animateTo)  // Animate to saved data.\n         {\n            // Provide special handling to potentially change transform origin as this parameter is not animated.\n            if (data.transformOrigin !== this.#position.transformOrigin)\n            {\n               this.#position.transformOrigin = data.transformOrigin;\n            }\n\n            // Return a Promise with saved data that resolves after animation ends.\n            if (async)\n            {\n               return this.#position.animate.to(data, { duration, ease, interpolate }).finished.then(() => dataSaved);\n            }\n            else  // Animate synchronously.\n            {\n               this.#position.animate.to(data, { duration, ease, interpolate });\n            }\n         }\n         else\n         {\n            // Default options is to set data for an immediate update.\n            this.#position.set(data);\n         }\n      }\n\n      return dataSaved;\n   }\n\n   /**\n    * Saves current position state with the opportunity to add extra data to the saved state.\n    *\n    * @param {object}   opts - Options.\n    *\n    * @param {string}   opts.name - name to index this saved data.\n    *\n    * @param {...*}     [opts.extra] - Extra data to add to saved data.\n    *\n    * @returns {import('./').TJSPositionData} Current position data\n    */\n   save({ name, ...extra })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`Position - save error: 'name' is not a string.`); }\n\n      const data = this.#position.get(extra);\n\n      this.#dataSaved.set(name, data);\n\n      return data;\n   }\n\n   /**\n    * Directly sets a position state.\n    *\n    * @param {object}   opts - Options.\n    *\n    * @param {string}   opts.name - name to index this saved data.\n    *\n    * @param {...*}     [opts.data] - TJSPosition data to set.\n    */\n   set({ name, ...data })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`Position - set error: 'name' is not a string.`); }\n\n      this.#dataSaved.set(name, data);\n   }\n}\n\nclass StyleCache\n{\n   constructor()\n   {\n      /** @type {HTMLElement|undefined} */\n      this.el = void 0;\n\n      /** @type {CSSStyleDeclaration} */\n      this.computed = void 0;\n\n      /** @type {number|undefined} */\n      this.marginLeft = void 0;\n\n      /** @type {number|undefined} */\n      this.marginTop = void 0;\n\n      /** @type {number|undefined} */\n      this.maxHeight = void 0;\n\n      /** @type {number|undefined} */\n      this.maxWidth = void 0;\n\n      /** @type {number|undefined} */\n      this.minHeight = void 0;\n\n      /** @type {number|undefined} */\n      this.minWidth = void 0;\n\n      /** @type {boolean} */\n      this.hasWillChange = false;\n\n      /**\n       * @type {import('./').ResizeObserverData}\n       */\n      this.resizeObserved = {\n         contentHeight: void 0,\n         contentWidth: void 0,\n         offsetHeight: void 0,\n         offsetWidth: void 0\n      };\n\n      /**\n       * Provides a writable store to track offset & content width / height from an associated `resizeObserver` action.\n       *\n       * @type {import('svelte/store').Writable<import('./').ResizeObserverData>}\n       */\n      const storeResizeObserved = writable(this.resizeObserved);\n\n      this.stores = {\n         element: writable(this.el),\n         resizeContentHeight: propertyStore(storeResizeObserved, 'contentHeight'),\n         resizeContentWidth: propertyStore(storeResizeObserved, 'contentWidth'),\n         resizeObserved: storeResizeObserved,\n         resizeOffsetHeight: propertyStore(storeResizeObserved, 'offsetHeight'),\n         resizeOffsetWidth: propertyStore(storeResizeObserved, 'offsetWidth')\n      };\n   }\n\n   /**\n    * Returns the cached offsetHeight from any attached `resizeObserver` action otherwise gets the offsetHeight from\n    * the element directly. The more optimized path is using `resizeObserver` as getting it from the element\n    * directly is more expensive and alters the execution order of an animation frame.\n    *\n    * @returns {number} The element offsetHeight.\n    */\n   get offsetHeight()\n   {\n      if (this.el instanceof HTMLElement)\n      {\n         return this.resizeObserved.offsetHeight !== void 0 ? this.resizeObserved.offsetHeight : this.el.offsetHeight;\n      }\n\n      throw new Error(`StyleCache - get offsetHeight error: no element assigned.`);\n   }\n\n   /**\n    * Returns the cached offsetWidth from any attached `resizeObserver` action otherwise gets the offsetWidth from\n    * the element directly. The more optimized path is using `resizeObserver` as getting it from the element\n    * directly is more expensive and alters the execution order of an animation frame.\n    *\n    * @returns {number} The element offsetHeight.\n    */\n   get offsetWidth()\n   {\n      if (this.el instanceof HTMLElement)\n      {\n         return this.resizeObserved.offsetWidth !== void 0 ? this.resizeObserved.offsetWidth : this.el.offsetWidth;\n      }\n\n      throw new Error(`StyleCache - get offsetWidth error: no element assigned.`);\n   }\n\n   /**\n    * @param {HTMLElement} el -\n    *\n    * @returns {boolean} Does element match cached element.\n    */\n   hasData(el) { return this.el === el; }\n\n   /**\n    * Resets the style cache.\n    */\n   reset()\n   {\n      // Remove will-change inline style from previous element if it is still connected.\n      if (this.el instanceof HTMLElement && this.el.isConnected && !this.hasWillChange)\n      {\n         this.el.style.willChange = null;\n      }\n\n      this.el = void 0;\n      this.computed = void 0;\n      this.marginLeft = void 0;\n      this.marginTop = void 0;\n      this.maxHeight = void 0;\n      this.maxWidth = void 0;\n      this.minHeight = void 0;\n      this.minWidth = void 0;\n\n      this.hasWillChange = false;\n\n      // Silently reset `resizedObserved`; With proper usage the `resizeObserver` action issues an update on removal.\n      this.resizeObserved.contentHeight = void 0;\n      this.resizeObserved.contentWidth = void 0;\n      this.resizeObserved.offsetHeight = void 0;\n      this.resizeObserved.offsetWidth = void 0;\n\n      // Reset the tracked element this TJSPosition instance is modifying.\n      this.stores.element.set(void 0);\n   }\n\n   /**\n    * Updates the style cache with new data from the given element.\n    *\n    * @param {HTMLElement} el - An HTML element.\n    */\n   update(el)\n   {\n      this.el = el;\n\n      this.computed = globalThis.getComputedStyle(el);\n\n      this.marginLeft = StyleParse.pixels(el.style.marginLeft) ?? StyleParse.pixels(this.computed.marginLeft);\n      this.marginTop = StyleParse.pixels(el.style.marginTop) ?? StyleParse.pixels(this.computed.marginTop);\n      this.maxHeight = StyleParse.pixels(el.style.maxHeight) ?? StyleParse.pixels(this.computed.maxHeight);\n      this.maxWidth = StyleParse.pixels(el.style.maxWidth) ?? StyleParse.pixels(this.computed.maxWidth);\n\n      // Note that the computed styles for below will always be 0px / 0 when no style is active.\n      this.minHeight = StyleParse.pixels(el.style.minHeight) ?? StyleParse.pixels(this.computed.minHeight);\n      this.minWidth = StyleParse.pixels(el.style.minWidth) ?? StyleParse.pixels(this.computed.minWidth);\n\n      // Tracks if there already is a will-change property on the inline or computed styles.\n      const willChange = el.style.willChange !== '' ? el.style.willChange : this.computed.willChange;\n\n      this.hasWillChange = willChange !== '' && willChange !== 'auto';\n\n      // Update the tracked element this TJSPosition instance is modifying.\n      this.stores.element.set(el);\n   }\n}\n\n/**\n * Provides the output data for {@link TJSTransforms.getData}.\n */\nclass TJSTransformData\n{\n   constructor()\n   {\n      Object.seal(this);\n   }\n\n   /**\n    * Stores the calculated bounding rectangle.\n    *\n    * @type {DOMRect}\n    */\n   #boundingRect = new DOMRect();\n\n   /**\n    * Stores the individual transformed corner points of the window in screen space clockwise from:\n    * top left -> top right -> bottom right -> bottom left.\n    *\n    * @type {import('#runtime/math/gl-matrix').Vec3[]}\n    */\n   #corners = [Vec3.create(), Vec3.create(), Vec3.create(), Vec3.create()];\n\n   /**\n    * Stores the current gl-matrix Mat4 data.\n    *\n    * @type {import('#runtime/math/gl-matrix').Mat4}\n    */\n   #mat4 = Mat4.create();\n\n   /**\n    * Stores the pre & post origin translations to apply to matrix transforms.\n    *\n    * @type {import('#runtime/math/gl-matrix').Mat4[]}\n    */\n   #originTranslations = [Mat4.create(), Mat4.create()];\n\n   /**\n    * @returns {DOMRect} The bounding rectangle.\n    */\n   get boundingRect() { return this.#boundingRect; }\n\n   /**\n    * @returns {import('#runtime/math/gl-matrix').Vec3[]} The transformed corner points as Vec3 in screen space.\n    */\n   get corners() { return this.#corners; }\n\n   /**\n    * @returns {string} Returns the CSS style string for the transform matrix.\n    */\n   get css() { return `matrix3d(${this.mat4.join(',')})`; }\n\n   /**\n    * @returns {import('#runtime/math/gl-matrix').Mat4} The transform matrix.\n    */\n   get mat4() { return this.#mat4; }\n\n   /**\n    * @returns {import('#runtime/math/gl-matrix').Mat4[]} The pre / post translation matrices for origin translation.\n    */\n   get originTranslations() { return this.#originTranslations; }\n}\n\n/** @type {number[]} */\nconst s_SCALE_VECTOR = [1, 1, 1];\n\n/** @type {number[]} */\nconst s_TRANSLATE_VECTOR = [0, 0, 0];\n\n/** @type {import('#runtime/math/gl-matrix').Mat4} */\nconst s_MAT4_RESULT = Mat4.create();\n\n/** @type {import('#runtime/math/gl-matrix').Mat4} */\nconst s_MAT4_TEMP = Mat4.create();\n\n/** @type {import('#runtime/math/gl-matrix').Vec3} */\nconst s_VEC3_TEMP = Vec3.create();\n\nclass TJSTransforms\n{\n   /**\n    * Stores the transform keys in the order added.\n    *\n    * @type {string[]}\n    */\n   #orderList = [];\n\n   constructor()\n   {\n      this._data = {};\n   }\n\n   /**\n    * @returns {boolean} Whether there are active transforms in local data.\n    */\n   get isActive() { return this.#orderList.length > 0; }\n\n   /**\n    * @returns {number|undefined} Any local rotateX data.\n    */\n   get rotateX() { return this._data.rotateX; }\n\n   /**\n    * @returns {number|undefined} Any local rotateY data.\n    */\n   get rotateY() { return this._data.rotateY; }\n\n   /**\n    * @returns {number|undefined} Any local rotateZ data.\n    */\n   get rotateZ() { return this._data.rotateZ; }\n\n   /**\n    * @returns {number|undefined} Any local rotateZ scale.\n    */\n   get scale() { return this._data.scale; }\n\n   /**\n    * @returns {number|undefined} Any local translateZ data.\n    */\n   get translateX() { return this._data.translateX; }\n\n   /**\n    * @returns {number|undefined} Any local translateZ data.\n    */\n   get translateY() { return this._data.translateY; }\n\n   /**\n    * @returns {number|undefined} Any local translateZ data.\n    */\n   get translateZ() { return this._data.translateZ; }\n\n   /**\n    * Sets the local rotateX data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set rotateX(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.rotateX === void 0) { this.#orderList.push('rotateX'); }\n\n         this._data.rotateX = value;\n      }\n      else\n      {\n         if (this._data.rotateX !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'rotateX');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.rotateX;\n      }\n   }\n\n   /**\n    * Sets the local rotateY data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set rotateY(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.rotateY === void 0) { this.#orderList.push('rotateY'); }\n\n         this._data.rotateY = value;\n      }\n      else\n      {\n         if (this._data.rotateY !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'rotateY');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.rotateY;\n      }\n   }\n\n   /**\n    * Sets the local rotateZ data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set rotateZ(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.rotateZ === void 0) { this.#orderList.push('rotateZ'); }\n\n         this._data.rotateZ = value;\n      }\n\n      else\n      {\n         if (this._data.rotateZ !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'rotateZ');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.rotateZ;\n      }\n   }\n\n   /**\n    * Sets the local scale data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set scale(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.scale === void 0) { this.#orderList.push('scale'); }\n\n         this._data.scale = value;\n      }\n      else\n      {\n         if (this._data.scale !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'scale');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.scale;\n      }\n   }\n\n   /**\n    * Sets the local translateX data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set translateX(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.translateX === void 0) { this.#orderList.push('translateX'); }\n\n         this._data.translateX = value;\n      }\n\n      else\n      {\n         if (this._data.translateX !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'translateX');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.translateX;\n      }\n   }\n\n   /**\n    * Sets the local translateY data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set translateY(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.translateY === void 0) { this.#orderList.push('translateY'); }\n\n         this._data.translateY = value;\n      }\n\n      else\n      {\n         if (this._data.translateY !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'translateY');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.translateY;\n      }\n   }\n\n   /**\n    * Sets the local translateZ data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set translateZ(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.translateZ === void 0) { this.#orderList.push('translateZ'); }\n\n         this._data.translateZ = value;\n      }\n\n      else\n      {\n         if (this._data.translateZ !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'translateZ');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.translateZ;\n      }\n   }\n\n   /**\n    * Returns the matrix3d CSS transform for the given position / transform data.\n    *\n    * @param {object} [data] - Optional position data otherwise use local stored transform data.\n    *\n    * @returns {string} The CSS matrix3d string.\n    */\n   getCSS(data = this._data)\n   {\n      return `matrix3d(${this.getMat4(data, s_MAT4_RESULT).join(',')})`;\n   }\n\n   /**\n    * Returns the matrix3d CSS transform for the given position / transform data.\n    *\n    * @param {object} [data] - Optional position data otherwise use local stored transform data.\n    *\n    * @returns {string} The CSS matrix3d string.\n    */\n   getCSSOrtho(data = this._data)\n   {\n      return `matrix3d(${this.getMat4Ortho(data, s_MAT4_RESULT).join(',')})`;\n   }\n\n   /**\n    * Collects all data including a bounding rect, transform matrix, and points array of the given\n    * {@link TJSPositionData} instance with the applied local transform data.\n    *\n    * @param {import('../').TJSPositionData} position - The position data to process.\n    *\n    * @param {TJSTransformData} [output] - Optional TJSTransformData output instance.\n    *\n    * @param {object} [validationData] - Optional validation data for adjustment parameters.\n    *\n    * @returns {TJSTransformData} The output TJSTransformData instance.\n    */\n   getData(position, output = new TJSTransformData(), validationData = {})\n   {\n      const valWidth = validationData.width ?? 0;\n      const valHeight = validationData.height ?? 0;\n      const valOffsetTop = validationData.offsetTop ?? validationData.marginTop ?? 0;\n      const valOffsetLeft = validationData.offsetLeft ?? validationData.offsetLeft ?? 0;\n\n      position.top += valOffsetTop;\n      position.left += valOffsetLeft;\n\n      const width = Number.isFinite(position.width) ? position.width : valWidth;\n      const height = Number.isFinite(position.height) ? position.height : valHeight;\n\n      const rect = output.corners;\n\n      if (this.hasTransform(position))\n      {\n         rect[0][0] = rect[0][1] = rect[0][2] = 0;\n         rect[1][0] = width;\n         rect[1][1] = rect[1][2] = 0;\n         rect[2][0] = width;\n         rect[2][1] = height;\n         rect[2][2] = 0;\n         rect[3][0] = 0;\n         rect[3][1] = height;\n         rect[3][2] = 0;\n\n         const matrix = this.getMat4(position, output.mat4);\n\n         const translate = s_GET_ORIGIN_TRANSLATION(position.transformOrigin, width, height, output.originTranslations);\n\n         if (transformOriginDefault === position.transformOrigin)\n         {\n            Vec3.transformMat4(rect[0], rect[0], matrix);\n            Vec3.transformMat4(rect[1], rect[1], matrix);\n            Vec3.transformMat4(rect[2], rect[2], matrix);\n            Vec3.transformMat4(rect[3], rect[3], matrix);\n         }\n         else\n         {\n            Vec3.transformMat4(rect[0], rect[0], translate[0]);\n            Vec3.transformMat4(rect[0], rect[0], matrix);\n            Vec3.transformMat4(rect[0], rect[0], translate[1]);\n\n            Vec3.transformMat4(rect[1], rect[1], translate[0]);\n            Vec3.transformMat4(rect[1], rect[1], matrix);\n            Vec3.transformMat4(rect[1], rect[1], translate[1]);\n\n            Vec3.transformMat4(rect[2], rect[2], translate[0]);\n            Vec3.transformMat4(rect[2], rect[2], matrix);\n            Vec3.transformMat4(rect[2], rect[2], translate[1]);\n\n            Vec3.transformMat4(rect[3], rect[3], translate[0]);\n            Vec3.transformMat4(rect[3], rect[3], matrix);\n            Vec3.transformMat4(rect[3], rect[3], translate[1]);\n         }\n\n         rect[0][0] = position.left + rect[0][0];\n         rect[0][1] = position.top + rect[0][1];\n         rect[1][0] = position.left + rect[1][0];\n         rect[1][1] = position.top + rect[1][1];\n         rect[2][0] = position.left + rect[2][0];\n         rect[2][1] = position.top + rect[2][1];\n         rect[3][0] = position.left + rect[3][0];\n         rect[3][1] = position.top + rect[3][1];\n      }\n      else\n      {\n         rect[0][0] = position.left;\n         rect[0][1] = position.top;\n         rect[1][0] = position.left + width;\n         rect[1][1] = position.top;\n         rect[2][0] = position.left + width;\n         rect[2][1] = position.top + height;\n         rect[3][0] = position.left;\n         rect[3][1] = position.top + height;\n\n         Mat4.identity(output.mat4);\n      }\n\n      let maxX = Number.MIN_SAFE_INTEGER;\n      let maxY = Number.MIN_SAFE_INTEGER;\n      let minX = Number.MAX_SAFE_INTEGER;\n      let minY = Number.MAX_SAFE_INTEGER;\n\n      for (let cntr = 4; --cntr >= 0;)\n      {\n         if (rect[cntr][0] > maxX) { maxX = rect[cntr][0]; }\n         if (rect[cntr][0] < minX) { minX = rect[cntr][0]; }\n         if (rect[cntr][1] > maxY) { maxY = rect[cntr][1]; }\n         if (rect[cntr][1] < minY) { minY = rect[cntr][1]; }\n      }\n\n      const boundingRect = output.boundingRect;\n      boundingRect.x = minX;\n      boundingRect.y = minY;\n      boundingRect.width = maxX - minX;\n      boundingRect.height = maxY - minY;\n\n      position.top -= valOffsetTop;\n      position.left -= valOffsetLeft;\n\n      return output;\n   }\n\n   /**\n    * Creates a transform matrix based on local data applied in order it was added.\n    *\n    * If no data object is provided then the source is the local transform data. If another data object is supplied\n    * then the stored local transform order is applied then all remaining transform keys are applied. This allows the\n    * construction of a transform matrix in advance of setting local data and is useful in collision detection.\n    *\n    * @param {object}   [data] - TJSPositionData instance or local transform data.\n    *\n    * @param {import('#runtime/math/gl-matrix').Mat4}  [output] - The output mat4 instance.\n    *\n    * @returns {import('#runtime/math/gl-matrix').Mat4} Transform matrix.\n    */\n   getMat4(data = this._data, output = Mat4.create())\n   {\n      const matrix = Mat4.identity(output);\n\n      // Bitwise tracks applied transform keys from local transform data.\n      let seenKeys = 0;\n\n      const orderList = this.#orderList;\n\n      // First apply ordered transforms from local transform data.\n      for (let cntr = 0; cntr < orderList.length; cntr++)\n      {\n         const key = orderList[cntr];\n\n         switch (key)\n         {\n            case 'rotateX':\n               seenKeys |= transformKeysBitwise.rotateX;\n               Mat4.multiply(matrix, matrix, Mat4.fromXRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n\n            case 'rotateY':\n               seenKeys |= transformKeysBitwise.rotateY;\n               Mat4.multiply(matrix, matrix, Mat4.fromYRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n\n            case 'rotateZ':\n               seenKeys |= transformKeysBitwise.rotateZ;\n               Mat4.multiply(matrix, matrix, Mat4.fromZRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n\n            case 'scale':\n               seenKeys |= transformKeysBitwise.scale;\n               s_SCALE_VECTOR[0] = s_SCALE_VECTOR[1] = data[key];\n               Mat4.multiply(matrix, matrix, Mat4.fromScaling(s_MAT4_TEMP, s_SCALE_VECTOR));\n               break;\n\n            case 'translateX':\n               seenKeys |= transformKeysBitwise.translateX;\n               s_TRANSLATE_VECTOR[0] = data.translateX;\n               s_TRANSLATE_VECTOR[1] = 0;\n               s_TRANSLATE_VECTOR[2] = 0;\n               Mat4.multiply(matrix, matrix, Mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n               break;\n\n            case 'translateY':\n               seenKeys |= transformKeysBitwise.translateY;\n               s_TRANSLATE_VECTOR[0] = 0;\n               s_TRANSLATE_VECTOR[1] = data.translateY;\n               s_TRANSLATE_VECTOR[2] = 0;\n               Mat4.multiply(matrix, matrix, Mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n               break;\n\n            case 'translateZ':\n               seenKeys |= transformKeysBitwise.translateZ;\n               s_TRANSLATE_VECTOR[0] = 0;\n               s_TRANSLATE_VECTOR[1] = 0;\n               s_TRANSLATE_VECTOR[2] = data.translateZ;\n               Mat4.multiply(matrix, matrix, Mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n               break;\n         }\n      }\n\n      // Now apply any new keys not set in local transform data that have not been applied yet.\n      if (data !== this._data)\n      {\n         for (let cntr = 0; cntr < transformKeys.length; cntr++)\n         {\n            const key = transformKeys[cntr];\n\n            // Reject bad / no data or if the key has already been applied.\n            if (data[key] === null || (seenKeys & transformKeysBitwise[key]) > 0) { continue; }\n\n            switch (key)\n            {\n               case 'rotateX':\n                  Mat4.multiply(matrix, matrix, Mat4.fromXRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n\n               case 'rotateY':\n                  Mat4.multiply(matrix, matrix, Mat4.fromYRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n\n               case 'rotateZ':\n                  Mat4.multiply(matrix, matrix, Mat4.fromZRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n\n               case 'scale':\n                  s_SCALE_VECTOR[0] = s_SCALE_VECTOR[1] = data[key];\n                  Mat4.multiply(matrix, matrix, Mat4.fromScaling(s_MAT4_TEMP, s_SCALE_VECTOR));\n                  break;\n\n               case 'translateX':\n                  s_TRANSLATE_VECTOR[0] = data[key];\n                  s_TRANSLATE_VECTOR[1] = 0;\n                  s_TRANSLATE_VECTOR[2] = 0;\n                  Mat4.multiply(matrix, matrix, Mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n                  break;\n\n               case 'translateY':\n                  s_TRANSLATE_VECTOR[0] = 0;\n                  s_TRANSLATE_VECTOR[1] = data[key];\n                  s_TRANSLATE_VECTOR[2] = 0;\n                  Mat4.multiply(matrix, matrix, Mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n                  break;\n\n               case 'translateZ':\n                  s_TRANSLATE_VECTOR[0] = 0;\n                  s_TRANSLATE_VECTOR[1] = 0;\n                  s_TRANSLATE_VECTOR[2] = data[key];\n                  Mat4.multiply(matrix, matrix, Mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n                  break;\n            }\n         }\n      }\n\n      return matrix;\n   }\n\n   /**\n    * Provides an orthographic enhancement to convert left / top positional data to a translate operation.\n    *\n    * This transform matrix takes into account that the remaining operations are , but adds any left / top attributes from passed in data to\n    * translate X / Y.\n    *\n    * If no data object is provided then the source is the local transform data. If another data object is supplied\n    * then the stored local transform order is applied then all remaining transform keys are applied. This allows the\n    * construction of a transform matrix in advance of setting local data and is useful in collision detection.\n    *\n    * @param {object}   [data] - TJSPositionData instance or local transform data.\n    *\n    * @param {import('#runtime/math/gl-matrix').Mat4}  [output] - The output mat4 instance.\n    *\n    * @returns {import('#runtime/math/gl-matrix').Mat4} Transform matrix.\n    */\n   getMat4Ortho(data = this._data, output = Mat4.create())\n   {\n      const matrix = Mat4.identity(output);\n\n      // Attempt to retrieve values from passed in data otherwise default to 0.\n      // Always perform the translation last regardless of order added to local transform data.\n      // Add data.left to translateX and data.top to translateY.\n      s_TRANSLATE_VECTOR[0] = (data.left ?? 0) + (data.translateX ?? 0);\n      s_TRANSLATE_VECTOR[1] = (data.top ?? 0) + (data.translateY ?? 0);\n      s_TRANSLATE_VECTOR[2] = data.translateZ ?? 0;\n      Mat4.multiply(matrix, matrix, Mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n\n      // Scale can also be applied out of order.\n      if (data.scale !== null)\n      {\n         s_SCALE_VECTOR[0] = s_SCALE_VECTOR[1] = data.scale;\n         Mat4.multiply(matrix, matrix, Mat4.fromScaling(s_MAT4_TEMP, s_SCALE_VECTOR));\n      }\n\n      // Early out if there is not rotation data.\n      if (data.rotateX === null && data.rotateY === null && data.rotateZ === null) { return matrix; }\n\n      // Rotation transforms must be applied in the order they are added.\n\n      // Bitwise tracks applied transform keys from local transform data.\n      let seenKeys = 0;\n\n      const orderList = this.#orderList;\n\n      // First apply ordered transforms from local transform data.\n      for (let cntr = 0; cntr < orderList.length; cntr++)\n      {\n         const key = orderList[cntr];\n\n         switch (key)\n         {\n            case 'rotateX':\n               seenKeys |= transformKeysBitwise.rotateX;\n               Mat4.multiply(matrix, matrix, Mat4.fromXRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n\n            case 'rotateY':\n               seenKeys |= transformKeysBitwise.rotateY;\n               Mat4.multiply(matrix, matrix, Mat4.fromYRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n\n            case 'rotateZ':\n               seenKeys |= transformKeysBitwise.rotateZ;\n               Mat4.multiply(matrix, matrix, Mat4.fromZRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n         }\n      }\n\n      // Now apply any new keys not set in local transform data that have not been applied yet.\n      if (data !== this._data)\n      {\n         for (let cntr = 0; cntr < transformKeys.length; cntr++)\n         {\n            const key = transformKeys[cntr];\n\n            // Reject bad / no data or if the key has already been applied.\n            if (data[key] === null || (seenKeys & transformKeysBitwise[key]) > 0) { continue; }\n\n            switch (key)\n            {\n               case 'rotateX':\n                  Mat4.multiply(matrix, matrix, Mat4.fromXRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n\n               case 'rotateY':\n                  Mat4.multiply(matrix, matrix, Mat4.fromYRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n\n               case 'rotateZ':\n                  Mat4.multiply(matrix, matrix, Mat4.fromZRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n            }\n         }\n      }\n\n      return matrix;\n   }\n\n   /**\n    * Tests an object if it contains transform keys and the values are finite numbers.\n    *\n    * @param {object} data - An object to test for transform data.\n    *\n    * @returns {boolean} Whether the given TJSPositionData has transforms.\n    */\n   hasTransform(data)\n   {\n      for (const key of transformKeys)\n      {\n         if (Number.isFinite(data[key])) { return true; }\n      }\n\n      return false;\n   }\n\n   /**\n    * Resets internal data from the given object containing valid transform keys.\n    *\n    * @param {object}   data - An object with transform data.\n    */\n   reset(data)\n   {\n      for (const key in data)\n      {\n         if (transformKeys.includes(key))\n         {\n            if (Number.isFinite(data[key]))\n            {\n               this._data[key] = data[key];\n            }\n            else\n            {\n               const index = this.#orderList.findIndex((entry) => entry === key);\n               if (index >= 0) { this.#orderList.splice(index, 1); }\n\n               delete this._data[key];\n            }\n         }\n      }\n   }\n}\n\n/**\n * Returns the translations necessary to translate a matrix operation based on the `transformOrigin` parameter of the\n * given position instance. The first entry / index 0 is the pre-translation and last entry / index 1 is the post-\n * translation.\n *\n * This method is used internally, but may be useful if you need the origin translation matrices to transform\n * bespoke points based on any `transformOrigin` set in {@link TJSPositionData}.\n *\n * @param {string}   transformOrigin - The transform origin attribute from TJSPositionData.\n *\n * @param {number}   width - The TJSPositionData width or validation data width when 'auto'.\n *\n * @param {number}   height - The TJSPositionData height or validation data height when 'auto'.\n *\n * @param {import('#runtime/math/gl-matrix').Mat4[]}   output - Output Mat4 array.\n *\n * @returns {import('#runtime/math/gl-matrix').Mat4[]} Output Mat4 array.\n */\nfunction s_GET_ORIGIN_TRANSLATION(transformOrigin, width, height, output)\n{\n   const vector = s_VEC3_TEMP;\n\n   switch (transformOrigin)\n   {\n      case 'top left':\n         vector[0] = vector[1] = 0;\n         Mat4.fromTranslation(output[0], vector);\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'top center':\n         vector[0] = -width * 0.5;\n         vector[1] = 0;\n         Mat4.fromTranslation(output[0], vector);\n         vector[0] = width * 0.5;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'top right':\n         vector[0] = -width;\n         vector[1] = 0;\n         Mat4.fromTranslation(output[0], vector);\n         vector[0] = width;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'center left':\n         vector[0] = 0;\n         vector[1] = -height * 0.5;\n         Mat4.fromTranslation(output[0], vector);\n         vector[1] = height * 0.5;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      // By default, null / no transform is 'center'.\n      case null:\n      case 'center':\n         vector[0] = -width * 0.5;\n         vector[1] = -height * 0.5;\n         Mat4.fromTranslation(output[0], vector);\n         vector[0] = width * 0.5;\n         vector[1] = height * 0.5;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'center right':\n         vector[0] = -width;\n         vector[1] = -height * 0.5;\n         Mat4.fromTranslation(output[0], vector);\n         vector[0] = width;\n         vector[1] = height * 0.5;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'bottom left':\n         vector[0] = 0;\n         vector[1] = -height;\n         Mat4.fromTranslation(output[0], vector);\n         vector[1] = height;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'bottom center':\n         vector[0] = -width * 0.5;\n         vector[1] = -height;\n         Mat4.fromTranslation(output[0], vector);\n         vector[0] = width * 0.5;\n         vector[1] = height;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'bottom right':\n         vector[0] = -width;\n         vector[1] = -height;\n         Mat4.fromTranslation(output[0], vector);\n         vector[0] = width;\n         vector[1] = height;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      // No valid transform origin parameter; set identity.\n      default:\n         Mat4.identity(output[0]);\n         Mat4.identity(output[1]);\n         break;\n   }\n\n   return output;\n}\n\n/**\n * Provides the storage and sequencing of managed position validators. Each validator added may be a bespoke function or\n * a {@link ValidatorData} object containing an `id`, `validator`, and `weight` attributes; `validator` is\n * the only required attribute.\n *\n * The `id` attribute can be anything that creates a unique ID for the validator; recommended strings or numbers. This\n * allows validators to be removed by ID easily.\n *\n * The `weight` attribute is a number between 0 and 1 inclusive that allows validators to be added in a\n * predictable order which is especially handy if they are manipulated at runtime. A lower weighted validator always\n * runs before a higher weighted validator. If no weight is specified the default of '1' is assigned and it is appended\n * to the end of the validators list.\n *\n * This class forms the public API which is accessible from the `.validators` getter in the main TJSPosition instance.\n * ```\n * const position = new TJSPosition(<TJSPositionData>);\n * position.validators.add(...);\n * position.validators.clear();\n * position.validators.length;\n * position.validators.remove(...);\n * position.validators.removeBy(...);\n * position.validators.removeById(...);\n * ```\n */\nclass AdapterValidators\n{\n   /** @type {boolean} */\n   #enabled = true;\n\n   /**\n    * @type {import('../').ValidatorData[]}\n    */\n   #validatorData;\n\n   #mapUnsubscribe = new Map();\n\n   /**\n    * @returns {[AdapterValidators, import('../').ValidatorData[]]} Returns this and internal storage for validator\n    *          adapter.\n    */\n   constructor()\n   {\n      this.#validatorData = [];\n\n      Object.seal(this);\n\n      return [this, this.#validatorData];\n   }\n\n   /**\n    * @returns {boolean} Returns the enabled state.s\n    */\n   get enabled() { return this.#enabled; }\n\n   /**\n    * @returns {number} Returns the length of the validators array.\n    */\n   get length() { return this.#validatorData.length; }\n\n   /**\n    * @param {boolean}  enabled - Sets enabled state.\n    */\n   set enabled(enabled)\n   {\n      if (typeof enabled !== 'boolean') { throw new TypeError(`'enabled' is not a boolean.`); }\n\n      this.#enabled = enabled;\n   }\n\n   /**\n    * Provides an iterator for validators.\n    *\n    * @yields {import('../').ValidatorData}\n    */\n   *[Symbol.iterator]()\n   {\n      if (this.#validatorData.length === 0) { return; }\n\n      for (const entry of this.#validatorData)\n      {\n         yield { ...entry };\n      }\n   }\n\n   /**\n    * @param {...(import('../').ValidatorFn | import('../').ValidatorData)}   validators -\n    */\n   add(...validators)\n   {\n      /**\n       * Tracks the number of validators added that have subscriber functionality.\n       *\n       * @type {number}\n       */\n      // let subscribeCount = 0;  // TODO: Currently unused\n\n      for (const validator of validators)\n      {\n         const validatorType = typeof validator;\n\n         if ((validatorType !== 'function' && validatorType !== 'object') || validator === null)\n         {\n            throw new TypeError(`AdapterValidator error: 'validator' is not a function or object.`);\n         }\n\n         let data = void 0;\n         let subscribeFn = void 0;\n\n         switch (validatorType)\n         {\n            case 'function':\n               data = {\n                  id: void 0,\n                  validator,\n                  weight: 1\n               };\n\n               subscribeFn = validator.subscribe;\n               break;\n\n            case 'object':\n               if (typeof validator.validator !== 'function')\n               {\n                  throw new TypeError(`AdapterValidator error: 'validator' attribute is not a function.`);\n               }\n\n               if (validator.weight !== void 0 && typeof validator.weight !== 'number' ||\n                (validator.weight < 0 || validator.weight > 1))\n               {\n                  throw new TypeError(\n                   `AdapterValidator error: 'weight' attribute is not a number between '0 - 1' inclusive.`);\n               }\n\n               data = {\n                  id: validator.id !== void 0 ? validator.id : void 0,\n                  validator: validator.validator.bind(validator),\n                  weight: validator.weight || 1,\n                  instance: validator\n               };\n\n               subscribeFn = validator.validator.subscribe ?? validator.subscribe;\n               break;\n         }\n\n         // Find the index to insert where data.weight is less than existing values weight.\n         const index = this.#validatorData.findIndex((value) =>\n         {\n            return data.weight < value.weight;\n         });\n\n         // If an index was found insert at that location.\n         if (index >= 0)\n         {\n            this.#validatorData.splice(index, 0, data);\n         }\n         else // push to end of validators.\n         {\n            this.#validatorData.push(data);\n         }\n\n         if (typeof subscribeFn === 'function')\n         {\n            // TODO: consider how to handle validator updates.\n            const unsubscribe = subscribeFn();\n\n            // Ensure that unsubscribe is a function.\n            if (typeof unsubscribe !== 'function')\n            {\n               throw new TypeError(\n                'AdapterValidator error: Filter has subscribe function, but no unsubscribe function is returned.');\n            }\n\n            // Ensure that the same validator is not subscribed to multiple times.\n            if (this.#mapUnsubscribe.has(data.validator))\n            {\n               throw new Error(\n                'AdapterValidator error: Filter added already has an unsubscribe function registered.');\n            }\n\n            this.#mapUnsubscribe.set(data.validator, unsubscribe);\n            // subscribeCount++;  // TODO: Currently unused\n         }\n      }\n\n      // Filters with subscriber functionality are assumed to immediately invoke the `subscribe` callback. If the\n      // subscriber count is less than the amount of validators added then automatically trigger an index update\n      // manually.\n      // TODO: handle validator updates.\n      // if (subscribeCount < validators.length) { this.#indexUpdate(); }\n   }\n\n   clear()\n   {\n      this.#validatorData.length = 0;\n\n      // Unsubscribe from all validators with subscription support.\n      for (const unsubscribe of this.#mapUnsubscribe.values())\n      {\n         unsubscribe();\n      }\n\n      this.#mapUnsubscribe.clear();\n\n      // TODO: handle validator updates.\n      // this.#indexUpdate();\n   }\n\n   /**\n    * @param {...(import('../').ValidatorFn | import('../').ValidatorData)}   validators -\n    */\n   remove(...validators)\n   {\n      const length = this.#validatorData.length;\n\n      if (length === 0) { return; }\n\n      for (const data of validators)\n      {\n         // Handle the case that the validator may either be a function or a validator entry / object.\n         const actualValidator = typeof data === 'function' ? data : isObject(data) ? data.validator : void 0;\n\n         if (!actualValidator) { continue; }\n\n         for (let cntr = this.#validatorData.length; --cntr >= 0;)\n         {\n            if (this.#validatorData[cntr].validator === actualValidator)\n            {\n               this.#validatorData.splice(cntr, 1);\n\n               // Invoke any unsubscribe function for given validator then remove from tracking.\n               let unsubscribe = void 0;\n               if (typeof (unsubscribe = this.#mapUnsubscribe.get(actualValidator)) === 'function')\n               {\n                  unsubscribe();\n                  this.#mapUnsubscribe.delete(actualValidator);\n               }\n            }\n         }\n      }\n\n      // Update the index a validator was removed.\n      // TODO: handle validator updates.\n      // if (length !== this.#validatorData.length) { this.#indexUpdate(); }\n   }\n\n   /**\n    * Remove validators by the provided callback. The callback takes 3 parameters: `id`, `validator`, and `weight`.\n    * Any truthy value returned will remove that validator.\n    *\n    * @param {function(*, import('../').ValidatorFn, number): boolean} callback - Callback function to evaluate each\n    *        validator entry.\n    */\n   removeBy(callback)\n   {\n      const length = this.#validatorData.length;\n\n      if (length === 0) { return; }\n\n      if (typeof callback !== 'function')\n      {\n         throw new TypeError(`AdapterValidator error: 'callback' is not a function.`);\n      }\n\n      this.#validatorData = this.#validatorData.filter((data) =>\n      {\n         const remove = callback.call(callback, { ...data });\n\n         if (remove)\n         {\n            let unsubscribe;\n            if (typeof (unsubscribe = this.#mapUnsubscribe.get(data.validator)) === 'function')\n            {\n               unsubscribe();\n               this.#mapUnsubscribe.delete(data.validator);\n            }\n         }\n\n         // Reverse remove boolean to properly validator / remove this validator.\n         return !remove;\n      });\n\n      // TODO: handle validator updates.\n      // if (length !== this.#validatorData.length) { this.#indexUpdate(); }\n   }\n\n   removeById(...ids)\n   {\n      const length = this.#validatorData.length;\n\n      if (length === 0) { return; }\n\n      this.#validatorData = this.#validatorData.filter((data) =>\n      {\n         let remove = false;\n\n         for (const id of ids) { remove |= data.id === id; }\n\n         // If not keeping invoke any unsubscribe function for given validator then remove from tracking.\n         if (remove)\n         {\n            let unsubscribe;\n            if (typeof (unsubscribe = this.#mapUnsubscribe.get(data.validator)) === 'function')\n            {\n               unsubscribe();\n               this.#mapUnsubscribe.delete(data.validator);\n            }\n         }\n\n         return !remove; // Swap here to actually remove the item via array validator method.\n      });\n\n      // TODO: handle validator updates.\n      // if (length !== this.#validatorData.length) { this.#indexUpdate(); }\n   }\n}\n\nclass BasicBounds\n{\n   /**\n    * When true constrains the min / max width or height to element.\n    *\n    * @type {boolean}\n    */\n   #constrain;\n\n   /**\n    * @type {HTMLElement}\n    */\n   #element;\n\n   /**\n    * When true the validator is active.\n    *\n    * @type {boolean}\n    */\n   #enabled;\n\n   /**\n    * Provides a manual setting of the element height. As things go `offsetHeight` causes a browser layout and is not\n    * performance oriented. If manually set this height is used instead of `offsetHeight`.\n    *\n    * @type {number}\n    */\n   #height;\n\n   /**\n    * Set from an optional value in the constructor to lock accessors preventing modification.\n    */\n   #lock;\n\n   /**\n    * Provides a manual setting of the element width. As things go `offsetWidth` causes a browser layout and is not\n    * performance oriented. If manually set this width is used instead of `offsetWidth`.\n    *\n    * @type {number}\n    */\n   #width;\n\n   constructor({ constrain = true, element, enabled = true, lock = false, width, height } = {})\n   {\n      this.element = element;\n      this.constrain = constrain;\n      this.enabled = enabled;\n      this.width = width;\n      this.height = height;\n\n      this.#lock = typeof lock === 'boolean' ? lock : false;\n   }\n\n   get constrain() { return this.#constrain; }\n\n   get element() { return this.#element; }\n\n   get enabled() { return this.#enabled; }\n\n   get height() { return this.#height; }\n\n   get width() { return this.#width; }\n\n   set constrain(constrain)\n   {\n      if (this.#lock) { return; }\n\n      if (typeof constrain !== 'boolean') { throw new TypeError(`'constrain' is not a boolean.`); }\n\n      this.#constrain = constrain;\n   }\n\n   set element(element)\n   {\n      if (this.#lock) { return; }\n\n      if (element === void 0  || element === null || element instanceof HTMLElement)\n      {\n         this.#element = element;\n      }\n      else\n      {\n         throw new TypeError(`'element' is not a HTMLElement, undefined, or null.`);\n      }\n   }\n\n   set enabled(enabled)\n   {\n      if (this.#lock) { return; }\n\n      if (typeof enabled !== 'boolean') { throw new TypeError(`'enabled' is not a boolean.`); }\n\n      this.#enabled = enabled;\n   }\n\n   set height(height)\n   {\n      if (this.#lock) { return; }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   set width(width)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n   }\n\n   setDimension(width, height)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   /**\n    * Provides a validator that respects transforms in positional data constraining the position to within the target\n    * elements bounds.\n    *\n    * @param {import('../').ValidationData}   valData - The associated validation data for position updates.\n    *\n    * @returns {import('../').TJSPositionData} Potentially adjusted position data.\n    */\n   validator(valData)\n   {\n      // Early out if element is undefined or local enabled state is false.\n      if (!this.#enabled) { return valData.position; }\n\n      // Determine containing bounds from manual values; or any element; lastly the browser width / height.\n      const boundsWidth = this.#width ?? this.#element?.offsetWidth ?? globalThis.innerWidth;\n      const boundsHeight = this.#height ?? this.#element?.offsetHeight ?? globalThis.innerHeight;\n\n      if (typeof valData.position.width === 'number')\n      {\n         const maxW = valData.maxWidth ?? (this.#constrain ? boundsWidth : Number.MAX_SAFE_INTEGER);\n         valData.position.width = valData.width = clamp(valData.position.width, valData.minWidth, maxW);\n\n         if ((valData.width + valData.position.left + valData.marginLeft) > boundsWidth)\n         {\n            valData.position.left = boundsWidth - valData.width - valData.marginLeft;\n         }\n      }\n\n      if (typeof valData.position.height === 'number')\n      {\n         const maxH = valData.maxHeight ?? (this.#constrain ? boundsHeight : Number.MAX_SAFE_INTEGER);\n         valData.position.height = valData.height = clamp(valData.position.height, valData.minHeight, maxH);\n\n         if ((valData.height + valData.position.top + valData.marginTop) > boundsHeight)\n         {\n            valData.position.top = boundsHeight - valData.height - valData.marginTop;\n         }\n      }\n\n      const maxL = Math.max(boundsWidth - valData.width - valData.marginLeft, 0);\n      valData.position.left = Math.round(clamp(valData.position.left, 0, maxL));\n\n      const maxT = Math.max(boundsHeight - valData.height - valData.marginTop, 0);\n      valData.position.top = Math.round(clamp(valData.position.top, 0, maxT));\n\n      return valData.position;\n   }\n}\n\nconst s_TRANSFORM_DATA = new TJSTransformData();\n\nclass TransformBounds\n{\n   /**\n    * When true constrains the min / max width or height to element.\n    *\n    * @type {boolean}\n    */\n   #constrain;\n\n   /**\n    * @type {HTMLElement}\n    */\n   #element;\n\n   /**\n    * When true the validator is active.\n    *\n    * @type {boolean}\n    */\n   #enabled;\n\n   /**\n    * Provides a manual setting of the element height. As things go `offsetHeight` causes a browser layout and is not\n    * performance oriented. If manually set this height is used instead of `offsetHeight`.\n    *\n    * @type {number}\n    */\n   #height;\n\n   /**\n    * Set from an optional value in the constructor to lock accessors preventing modification.\n    */\n   #lock;\n\n   /**\n    * Provides a manual setting of the element width. As things go `offsetWidth` causes a browser layout and is not\n    * performance oriented. If manually set this width is used instead of `offsetWidth`.\n    *\n    * @type {number}\n    */\n   #width;\n\n   constructor({ constrain = true, element, enabled = true, lock = false, width, height } = {})\n   {\n      this.element = element;\n      this.constrain = constrain;\n      this.enabled = enabled;\n      this.width = width;\n      this.height = height;\n\n      this.#lock = typeof lock === 'boolean' ? lock : false;\n   }\n\n   get constrain() { return this.#constrain; }\n\n   get element() { return this.#element; }\n\n   get enabled() { return this.#enabled; }\n\n   get height() { return this.#height; }\n\n   get width() { return this.#width; }\n\n   set constrain(constrain)\n   {\n      if (this.#lock) { return; }\n\n      if (typeof constrain !== 'boolean') { throw new TypeError(`'constrain' is not a boolean.`); }\n\n      this.#constrain = constrain;\n   }\n\n   set element(element)\n   {\n      if (this.#lock) { return; }\n\n      if (element === void 0 || element === null || element instanceof HTMLElement)\n      {\n         this.#element = element;\n      }\n      else\n      {\n         throw new TypeError(`'element' is not a HTMLElement, undefined, or null.`);\n      }\n   }\n\n   set enabled(enabled)\n   {\n      if (this.#lock) { return; }\n\n      if (typeof enabled !== 'boolean') { throw new TypeError(`'enabled' is not a boolean.`); }\n\n      this.#enabled = enabled;\n   }\n\n   set height(height)\n   {\n      if (this.#lock) { return; }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   set width(width)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n   }\n\n   setDimension(width, height)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   /**\n    * Provides a validator that respects transforms in positional data constraining the position to within the target\n    * elements bounds.\n    *\n    * @param {import('../').ValidationData}   valData - The associated validation data for position updates.\n    *\n    * @returns {import('../').TJSPositionData} Potentially adjusted position data.\n    */\n   validator(valData)\n   {\n      // Early out if element is undefined or local enabled state is false.\n      if (!this.#enabled) { return valData.position; }\n\n      // Determine containing bounds from manual values; or any element; lastly the browser width / height.\n      const boundsWidth = this.#width ?? this.#element?.offsetWidth ?? globalThis.innerWidth;\n      const boundsHeight = this.#height ?? this.#element?.offsetHeight ?? globalThis.innerHeight;\n\n      // Ensure min / max width constraints when position width is a number; not 'auto' or 'inherit'. If constrain is\n      // true cap width bounds.\n      if (typeof valData.position.width === 'number')\n      {\n         const maxW = valData.maxWidth ?? (this.#constrain ? boundsWidth : Number.MAX_SAFE_INTEGER);\n         valData.position.width = clamp(valData.width, valData.minWidth, maxW);\n      }\n\n      // Ensure min / max height constraints when position height is a number; not 'auto' or 'inherit'. If constrain\n      // is true cap height bounds.\n      if (typeof valData.position.height === 'number')\n      {\n         const maxH = valData.maxHeight ?? (this.#constrain ? boundsHeight : Number.MAX_SAFE_INTEGER);\n         valData.position.height = clamp(valData.height, valData.minHeight, maxH);\n      }\n\n      // Get transform data. First set constraints including any margin top / left as offsets and width / height. Used\n      // when position width / height is 'auto'.\n      const data = valData.transforms.getData(valData.position, s_TRANSFORM_DATA, valData);\n\n      // Check the bounding rectangle against browser height / width. Adjust position based on how far the overlap of\n      // the bounding rect is outside the bounds height / width. The order below matters as the constraints are top /\n      // left oriented, so perform those checks last.\n\n      const initialX = data.boundingRect.x;\n      const initialY = data.boundingRect.y;\n\n      if (data.boundingRect.bottom + valData.marginTop > boundsHeight)\n      {\n         data.boundingRect.y += boundsHeight - data.boundingRect.bottom - valData.marginTop;\n      }\n\n      if (data.boundingRect.right + valData.marginLeft > boundsWidth)\n      {\n         data.boundingRect.x += boundsWidth - data.boundingRect.right - valData.marginLeft;\n      }\n\n      if (data.boundingRect.top - valData.marginTop < 0)\n      {\n         data.boundingRect.y += Math.abs(data.boundingRect.top - valData.marginTop);\n      }\n\n      if (data.boundingRect.left - valData.marginLeft < 0)\n      {\n         data.boundingRect.x += Math.abs(data.boundingRect.left - valData.marginLeft);\n      }\n\n      valData.position.left -= initialX - data.boundingRect.x;\n      valData.position.top -= initialY - data.boundingRect.y;\n\n      return valData.position;\n   }\n}\n\nclass UpdateElementData\n{\n   constructor()\n   {\n      /**\n       * Stores the private data from TJSPosition.\n       *\n       * @type {TJSPositionData}\n       */\n      this.data = void 0;\n\n      /**\n       * Provides a copy of local data sent to subscribers.\n       *\n       * @type {TJSPositionData}\n       */\n      this.dataSubscribers = new TJSPositionData();\n\n      /**\n       * Stores the current dimension data used for the readable `dimension` store.\n       *\n       * @type {{width: number | 'auto', height: number | 'auto'}}\n       */\n      this.dimensionData = { width: 0, height: 0 };\n\n      /**\n       * @type {import('../PositionChangeSet').PositionChangeSet}\n       */\n      this.changeSet = void 0;\n\n      /**\n       * @type {import('../').TJSPositionOptions}\n       */\n      this.options = void 0;\n\n      /**\n       * Stores if this TJSPosition / update data is queued for update.\n       *\n       * @type {boolean}\n       */\n      this.queued = false;\n\n      /**\n       * @type {import('../StyleCache').StyleCache}\n       */\n      this.styleCache = void 0;\n\n      /**\n       * @type {import('../transform').TJSTransforms}\n       */\n      this.transforms = void 0;\n\n      /**\n       * Stores the current transform data used for the readable `transform` store. It is only active when there are\n       * subscribers to the store or calculateTransform options is true.\n       *\n       * @type {TJSTransformData}\n       */\n      this.transformData = new TJSTransformData();\n\n      /**\n       * @type {(function(TJSPositionData): void)[]}\n       */\n      this.subscriptions = void 0;\n\n      /**\n       * @type {import('svelte/store').Writable<{width: (number|\"auto\"), height: (number|\"auto\")}>}\n       */\n      this.storeDimension = writable(this.dimensionData);\n\n      // When there are subscribers set option to calculate transform updates; set to false when no subscribers.\n\n      /**\n       * @type {import('svelte/store').Writable<TJSTransformData>}\n       */\n      this.storeTransform = writable(this.transformData, () =>\n      {\n         this.options.transformSubscribed = true;\n         return () => this.options.transformSubscribed = false;\n      });\n\n      /**\n       * Stores the queued state for update element processing.\n       *\n       * @type {boolean}\n       */\n      this.queued = false;\n\n      // Seal data backing readable stores.\n      Object.seal(this.dimensionData);\n   }\n}\n\n/**\n * Decouples updates to any parent target HTMLElement inline styles. Invoke\n * {@link TJSPosition.elementUpdated} to await on the returned promise that is resolved with the current\n * render time via `nextAnimationFrame` / `requestAnimationFrame`. This allows the underlying data model to be updated\n * immediately while updates to the element are in sync with the browser and potentially in the future be further\n * throttled.\n *\n * @param {HTMLElement} el - The target HTMLElement.\n */\nclass UpdateElementManager\n{\n   static list = [];\n   static listCntr = 0;\n\n   static updatePromise;\n\n   static get promise() { return this.updatePromise; }\n\n   /**\n    * Potentially adds the given element and internal updateData instance to the list.\n    *\n    * @param {HTMLElement}       el - An HTMLElement instance.\n    *\n    * @param {import('./UpdateElementData').UpdateElementData} updateData - An UpdateElementData instance.\n    *\n    * @returns {Promise<number>} The unified next frame update promise. Returns `currentTime`.\n    */\n   static add(el, updateData)\n   {\n      if (this.listCntr < this.list.length)\n      {\n         const entry = this.list[this.listCntr];\n         entry[0] = el;\n         entry[1] = updateData;\n      }\n      else\n      {\n         this.list.push([el, updateData]);\n      }\n\n      this.listCntr++;\n      updateData.queued = true;\n\n      if (!this.updatePromise) { this.updatePromise = this.wait(); }\n\n      return this.updatePromise;\n   }\n\n   /**\n    * Await on `nextAnimationFrame` and iterate over list map invoking callback functions.\n    *\n    * @returns {Promise<number>} The next frame Promise / currentTime from nextAnimationFrame.\n    */\n   static async wait()\n   {\n      // Await the next animation frame. In the future this can be extended to multiple frames to divide update rate.\n      const currentTime = await nextAnimationFrame();\n\n      this.updatePromise = void 0;\n\n      for (let cntr = this.listCntr; --cntr >= 0;)\n      {\n         // Obtain data for entry.\n         const entry = this.list[cntr];\n         const el = entry[0];\n         const updateData = entry[1];\n\n         // Clear entry data.\n         entry[0] = void 0;\n         entry[1] = void 0;\n\n         // Reset queued state.\n         updateData.queued = false;\n\n         // Early out if the element is no longer connected to the DOM / shadow root.\n         // if (!el.isConnected || !updateData.changeSet.hasChange()) { continue; }\n         if (!el.isConnected) { continue; }\n\n         if (updateData.options.ortho)\n         {\n            s_UPDATE_ELEMENT_ORTHO(el, updateData);\n         }\n         else\n         {\n            s_UPDATE_ELEMENT(el, updateData);\n         }\n\n         // If calculate transform options is enabled then update the transform data and set the readable store.\n         if (updateData.options.calculateTransform || updateData.options.transformSubscribed)\n         {\n            s_UPDATE_TRANSFORM(el, updateData);\n         }\n\n         // Update all subscribers with changed data.\n         this.updateSubscribers(updateData);\n      }\n\n      this.listCntr = 0;\n\n      return currentTime;\n   }\n\n   /**\n    * Potentially immediately updates the given element.\n    *\n    * @param {HTMLElement}       el - An HTMLElement instance.\n    *\n    * @param {import('./UpdateElementData').UpdateElementData} updateData - An UpdateElementData instance.\n    */\n   static immediate(el, updateData)\n   {\n      // Early out if the element is no longer connected to the DOM / shadow root.\n      // if (!el.isConnected || !updateData.changeSet.hasChange()) { continue; }\n      if (!el.isConnected) { return; }\n\n      if (updateData.options.ortho)\n      {\n         s_UPDATE_ELEMENT_ORTHO(el, updateData);\n      }\n      else\n      {\n         s_UPDATE_ELEMENT(el, updateData);\n      }\n\n      // If calculate transform options is enabled then update the transform data and set the readable store.\n      if (updateData.options.calculateTransform || updateData.options.transformSubscribed)\n      {\n         s_UPDATE_TRANSFORM(el, updateData);\n      }\n\n      // Update all subscribers with changed data.\n      this.updateSubscribers(updateData);\n   }\n\n   /**\n    * @param {import('./UpdateElementData').UpdateElementData} updateData - Data change set.\n    */\n   static updateSubscribers(updateData)\n   {\n      const data = updateData.data;\n      const changeSet = updateData.changeSet;\n\n      if (!changeSet.hasChange()) { return; }\n\n      // Make a copy of the data.\n      const output = updateData.dataSubscribers.copy(data);\n\n      const subscriptions = updateData.subscriptions;\n\n      // Early out if there are no subscribers.\n      if (subscriptions.length > 0)\n      {\n         for (let cntr = 0; cntr < subscriptions.length; cntr++) { subscriptions[cntr](output); }\n      }\n\n      // Update dimension data if width / height has changed.\n      if (changeSet.width || changeSet.height)\n      {\n         updateData.dimensionData.width = data.width;\n         updateData.dimensionData.height = data.height;\n         updateData.storeDimension.set(updateData.dimensionData);\n      }\n\n      changeSet.set(false);\n   }\n}\n\n/**\n * Decouples updates to any parent target HTMLElement inline styles. Invoke\n * {@link TJSPosition.elementUpdated} to await on the returned promise that is resolved with the current\n * render time via `nextAnimationFrame` / `requestAnimationFrame`. This allows the underlying data model to be updated\n * immediately while updates to the element are in sync with the browser and potentially in the future be further\n * throttled.\n *\n * @param {HTMLElement} el - The target HTMLElement.\n *\n * @param {import('./UpdateElementData').UpdateElementData} updateData - Update data.\n */\nfunction s_UPDATE_ELEMENT(el, updateData)\n{\n   const changeSet = updateData.changeSet;\n   const data = updateData.data;\n\n   if (changeSet.left)\n   {\n      el.style.left = `${data.left}px`;\n   }\n\n   if (changeSet.top)\n   {\n      el.style.top = `${data.top}px`;\n   }\n\n   if (changeSet.zIndex)\n   {\n      el.style.zIndex = typeof data.zIndex === 'number' ? `${data.zIndex}` : null;\n   }\n\n   if (changeSet.width)\n   {\n      el.style.width = typeof data.width === 'number' ? `${data.width}px` : data.width;\n   }\n\n   if (changeSet.height)\n   {\n      el.style.height = typeof data.height === 'number' ? `${data.height}px` : data.height;\n   }\n\n   if (changeSet.transformOrigin)\n   {\n      el.style.transformOrigin = data.transformOrigin;\n   }\n\n   // Update all transforms in order added to transforms object.\n   if (changeSet.transform)\n   {\n      el.style.transform = updateData.transforms.isActive ? updateData.transforms.getCSS() : null;\n   }\n}\n\n/**\n * Decouples updates to any parent target HTMLElement inline styles. Invoke\n * {@link TJSPosition.elementUpdated} to await on the returned promise that is resolved with the current\n * render time via `nextAnimationFrame` / `requestAnimationFrame`. This allows the underlying data model to be updated\n * immediately while updates to the element are in sync with the browser and potentially in the future be further\n * throttled.\n *\n * @param {HTMLElement} el - The target HTMLElement.\n *\n * @param {import('./UpdateElementData').UpdateElementData} updateData - Update data.\n */\nfunction s_UPDATE_ELEMENT_ORTHO(el, updateData)\n{\n   const changeSet = updateData.changeSet;\n   const data = updateData.data;\n\n   if (changeSet.zIndex)\n   {\n      el.style.zIndex = typeof data.zIndex === 'number' ? `${data.zIndex}` : null;\n   }\n\n   if (changeSet.width)\n   {\n      el.style.width = typeof data.width === 'number' ? `${data.width}px` : data.width;\n   }\n\n   if (changeSet.height)\n   {\n      el.style.height = typeof data.height === 'number' ? `${data.height}px` : data.height;\n   }\n\n   if (changeSet.transformOrigin)\n   {\n      el.style.transformOrigin = data.transformOrigin;\n   }\n\n   // Update all transforms in order added to transforms object.\n   if (changeSet.left || changeSet.top || changeSet.transform)\n   {\n      el.style.transform = updateData.transforms.getCSSOrtho(data);\n   }\n}\n\n/**\n * Updates the applied transform data and sets the readble `transform` store.\n *\n * @param {HTMLElement} el - The target HTMLElement.\n *\n * @param {import('./UpdateElementData').UpdateElementData} updateData - Update element data.\n */\nfunction s_UPDATE_TRANSFORM(el, updateData)\n{\n   s_VALIDATION_DATA$1.height = updateData.data.height !== 'auto' ? updateData.data.height :\n    updateData.styleCache.offsetHeight;\n\n   s_VALIDATION_DATA$1.width = updateData.data.width !== 'auto' ? updateData.data.width :\n    updateData.styleCache.offsetWidth;\n\n   s_VALIDATION_DATA$1.marginLeft = updateData.styleCache.marginLeft;\n\n   s_VALIDATION_DATA$1.marginTop = updateData.styleCache.marginTop;\n\n   // Get transform data. First set constraints including any margin top / left as offsets and width / height. Used\n   // when position width / height is 'auto'.\n   updateData.transforms.getData(updateData.data, updateData.transformData, s_VALIDATION_DATA$1);\n\n   updateData.storeTransform.set(updateData.transformData);\n}\n\nconst s_VALIDATION_DATA$1 = {\n   height: void 0,\n   width: void 0,\n   marginLeft: void 0,\n   marginTop: void 0\n};\n\n/**\n * Provides a store for position following the subscriber protocol in addition to providing individual writable derived\n * stores for each independent variable.\n */\nclass TJSPosition\n{\n   /**\n    * @type {{browserCentered: Centered, Centered: Centered}}\n    */\n   static #positionInitial = {\n      browserCentered: new Centered({ lock: true }),\n      Centered\n   };\n\n   /**\n    * @type {{TransformBounds: TransformBounds, BasicBounds: BasicBounds, basicWindow: BasicBounds, transformWindow: TransformBounds}}\n    */\n   static #positionValidators = {\n      basicWindow: new BasicBounds({ lock: true }),\n      BasicBounds,\n      transformWindow: new TransformBounds({ lock: true }),\n      TransformBounds\n   };\n\n   /**\n    * @type {TJSPositionData}\n    */\n   #data = new TJSPositionData();\n\n   /**\n    * Provides the animation API.\n    *\n    * @type {AnimationAPI}\n    */\n   #animate = new AnimationAPI(this, this.#data);\n\n   /**\n    * Provides a way to turn on / off the position handling.\n    *\n    * @type {boolean}\n    */\n   #enabled = true;\n\n   /**\n    * Stores ongoing options that are set in the constructor or by transform store subscription.\n    *\n    * @type {import('./').TJSPositionOptions}\n    */\n   #options = {\n      calculateTransform: false,\n      initialHelper: void 0,\n      ortho: true,\n      transformSubscribed: false\n   };\n\n   /**\n    * The associated parent for positional data tracking. Used in validators.\n    *\n    * @type {import('./').TJSPositionParent}\n    */\n   #parent;\n\n   /**\n    * Stores the style attributes that changed on update.\n    *\n    * @type {PositionChangeSet}\n    */\n   #positionChangeSet = new PositionChangeSet();\n\n   /**\n    * @type {import('./').TJSPositionStores}\n    */\n   #stores;\n\n   /**\n    * Stores an instance of the computer styles for the target element.\n    *\n    * @type {StyleCache}\n    */\n   #styleCache;\n\n   /**\n    * Stores the subscribers.\n    *\n    * @type {import('svelte/store').Subscriber<TJSPositionData>[]}\n    */\n   #subscriptions = [];\n\n   /**\n    * @type {TJSTransforms}\n    */\n   #transforms = new TJSTransforms();\n\n   /**\n    * @type {UpdateElementData}\n    */\n   #updateElementData;\n\n   /**\n    * Stores the UpdateElementManager wait promise.\n    *\n    * @type {Promise}\n    */\n   #updateElementPromise;\n\n   /**\n    * @type {AdapterValidators}\n    */\n   #validators;\n\n   /**\n    * @type {import('./').ValidatorData[]}\n    */\n   #validatorData;\n\n   /**\n    * @type {PositionStateAPI}\n    */\n   #state = new PositionStateAPI(this, this.#data, this.#transforms);\n\n   /**\n    * @returns {AnimationGroupAPI} Public Animation API.\n    */\n   static get Animate() { return AnimationGroupAPI; }\n\n   /**\n    * @returns {{browserCentered: Centered, Centered: Centered}} TJSPosition initial API.\n    */\n   static get Initial() { return this.#positionInitial; }\n\n   /**\n    * Returns TJSTransformData class / constructor.\n    *\n    * @returns {TJSTransformData} TJSTransformData class / constructor.\n    */\n   static get TransformData() { return TJSTransformData; }\n\n   /**\n    * Returns default validators.\n    *\n    * Note: `basicWindow` and `BasicBounds` will eventually be removed.\n    *\n    * @returns {{TransformBounds: TransformBounds, BasicBounds: BasicBounds, basicWindow: BasicBounds, transformWindow: TransformBounds}}\n    * Available validators.\n    */\n   static get Validators() { return this.#positionValidators; }\n\n   /**\n    * Returns a duplicate of a given position instance copying any options and validators.\n    *\n    * // TODO: Consider more safety over options processing.\n    *\n    * @param {TJSPosition}          position - A position instance.\n    *\n    * @param {import('./').TJSPositionOptions}   options - TJSPosition options.\n    *\n    * @returns {TJSPosition} A duplicate position instance.\n    */\n   static duplicate(position, options)\n   {\n      if (!(position instanceof TJSPosition)) { throw new TypeError(`'position' is not an instance of Position.`); }\n\n      const newPosition = new TJSPosition(options);\n\n      newPosition.#options = Object.assign({}, position.#options, options);\n      newPosition.#validators.add(...position.#validators);\n\n      newPosition.set(position.#data);\n\n      return newPosition;\n   }\n\n   /**\n    * @param {import('./').TJSPositionParent | import('./').TJSPositionOptionsAll}   [parent] - A\n    *        potential parent element or object w/ `elementTarget` getter. May also be the TJSPositionOptions object\n    *        w/ 1 argument.\n    *\n    * @param {import('./').TJSPositionOptionsAll}   [options] - Default values.\n    */\n   constructor(parent, options)\n   {\n      // Test if `parent` is a plain object; if so treat as options object.\n      if (isPlainObject(parent))\n      {\n         options = parent;\n      }\n      else\n      {\n         this.#parent = parent;\n      }\n\n      const data = this.#data;\n      const transforms = this.#transforms;\n\n      this.#styleCache = new StyleCache();\n\n      const updateData = new UpdateElementData();\n\n      updateData.changeSet = this.#positionChangeSet;\n      updateData.data = this.#data;\n      updateData.options = this.#options;\n      updateData.styleCache = this.#styleCache;\n      updateData.subscriptions = this.#subscriptions;\n      updateData.transforms = this.#transforms;\n\n      this.#updateElementData = updateData;\n\n      if (isObject(options))\n      {\n         // Set TJSPosition options\n         if (typeof options.calculateTransform === 'boolean')\n         {\n            this.#options.calculateTransform = options.calculateTransform;\n         }\n\n         if (typeof options.ortho === 'boolean')\n         {\n            this.#options.ortho = options.ortho;\n         }\n\n         // Set default values from options.\n\n         if (Number.isFinite(options.height) || options.height === 'auto' || options.height === 'inherit' ||\n          options.height === null)\n         {\n            data.height = updateData.dimensionData.height = typeof options.height === 'number' ?\n             Math.round(options.height) : options.height;\n         }\n\n         if (Number.isFinite(options.left) || options.left === null)\n         {\n            data.left = typeof options.left === 'number' ? Math.round(options.left) : options.left;\n         }\n\n         if (Number.isFinite(options.maxHeight) || options.maxHeight === null)\n         {\n            data.maxHeight = typeof options.maxHeight === 'number' ? Math.round(options.maxHeight) : options.maxHeight;\n         }\n\n         if (Number.isFinite(options.maxWidth) || options.maxWidth === null)\n         {\n            data.maxWidth = typeof options.maxWidth === 'number' ? Math.round(options.maxWidth) : options.maxWidth;\n         }\n\n         if (Number.isFinite(options.minHeight) || options.minHeight === null)\n         {\n            data.minHeight = typeof options.minHeight === 'number' ? Math.round(options.minHeight) : options.minHeight;\n         }\n\n         if (Number.isFinite(options.minWidth) || options.minWidth === null)\n         {\n            data.minWidth = typeof options.minWidth === 'number' ? Math.round(options.minWidth) : options.minWidth;\n         }\n\n         if (Number.isFinite(options.rotateX) || options.rotateX === null)\n         {\n            transforms.rotateX = data.rotateX = options.rotateX;\n         }\n\n         if (Number.isFinite(options.rotateY) || options.rotateY === null)\n         {\n            transforms.rotateY = data.rotateY = options.rotateY;\n         }\n\n         if (Number.isFinite(options.rotateZ) || options.rotateZ === null)\n         {\n            transforms.rotateZ = data.rotateZ = options.rotateZ;\n         }\n\n         if (Number.isFinite(options.scale) || options.scale === null)\n         {\n            transforms.scale = data.scale = options.scale;\n         }\n\n         if (Number.isFinite(options.top) || options.top === null)\n         {\n            data.top = typeof options.top === 'number' ? Math.round(options.top) : options.top;\n         }\n\n         if (typeof options.transformOrigin === 'string' || options.transformOrigin === null)\n         {\n            data.transformOrigin = transformOrigins.includes(options.transformOrigin) ?\n             options.transformOrigin : null;\n         }\n\n         if (Number.isFinite(options.translateX) || options.translateX === null)\n         {\n            transforms.translateX = data.translateX = options.translateX;\n         }\n\n         if (Number.isFinite(options.translateY) || options.translateY === null)\n         {\n            transforms.translateY = data.translateY = options.translateY;\n         }\n\n         if (Number.isFinite(options.translateZ) || options.translateZ === null)\n         {\n            transforms.translateZ = data.translateZ = options.translateZ;\n         }\n\n         if (Number.isFinite(options.width) || options.width === 'auto' || options.width === 'inherit' ||\n          options.width === null)\n         {\n            data.width = updateData.dimensionData.width = typeof options.width === 'number' ?\n             Math.round(options.width) : options.width;\n         }\n\n         if (Number.isFinite(options.zIndex) || options.zIndex === null)\n         {\n            data.zIndex = typeof options.zIndex === 'number' ? Math.round(options.zIndex) : options.zIndex;\n         }\n      }\n\n      this.#stores = {\n         // The main properties for manipulating TJSPosition.\n         height: propertyStore(this, 'height'),\n         left: propertyStore(this, 'left'),\n         rotateX: propertyStore(this, 'rotateX'),\n         rotateY: propertyStore(this, 'rotateY'),\n         rotateZ: propertyStore(this, 'rotateZ'),\n         scale: propertyStore(this, 'scale'),\n         top: propertyStore(this, 'top'),\n         transformOrigin: propertyStore(this, 'transformOrigin'),\n         translateX: propertyStore(this, 'translateX'),\n         translateY: propertyStore(this, 'translateY'),\n         translateZ: propertyStore(this, 'translateZ'),\n         width: propertyStore(this, 'width'),\n         zIndex: propertyStore(this, 'zIndex'),\n\n         // Stores that control validation when width / height is not `auto`.\n         maxHeight: propertyStore(this, 'maxHeight'),\n         maxWidth: propertyStore(this, 'maxWidth'),\n         minHeight: propertyStore(this, 'minHeight'),\n         minWidth: propertyStore(this, 'minWidth'),\n\n         // Readable stores based on updates or from resize observer changes.\n         dimension: { subscribe: updateData.storeDimension.subscribe },\n         element: { subscribe: this.#styleCache.stores.element.subscribe },\n         resizeContentHeight: { subscribe: this.#styleCache.stores.resizeContentHeight.subscribe },\n         resizeContentWidth: { subscribe: this.#styleCache.stores.resizeContentWidth.subscribe },\n         resizeOffsetHeight: { subscribe: this.#styleCache.stores.resizeOffsetHeight.subscribe },\n         resizeOffsetWidth: { subscribe: this.#styleCache.stores.resizeOffsetWidth.subscribe },\n         transform: { subscribe: updateData.storeTransform.subscribe },\n\n         // Protected store that should only be set by resizeObserver action.\n         resizeObserved: this.#styleCache.stores.resizeObserved,\n      };\n\n      // When resize change from any applied resizeObserver action automatically set data for new validation run.\n      // A resizeObserver prop should be set to true for ApplicationShell components or usage of resizeObserver action\n      // to monitor for changes. This should only be used on elements that have 'auto' for width or height.\n      subscribeIgnoreFirst(this.#stores.resizeObserved, (resizeData) =>\n      {\n         const parent = this.#parent;\n         const el = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n\n         // Only invoke set if there is a target element and the resize data has a valid offset width & height.\n         if (el instanceof HTMLElement && Number.isFinite(resizeData?.offsetWidth) &&\n          Number.isFinite(resizeData?.offsetHeight))\n         {\n            this.set(data);\n         }\n      });\n\n      this.#stores.transformOrigin.values = transformOrigins;\n\n      [this.#validators, this.#validatorData] = new AdapterValidators();\n\n      if (options?.initial || options?.positionInitial)\n      {\n         const initialHelper = options.initial ?? options.positionInitial;\n\n         if (typeof initialHelper?.getLeft !== 'function' || typeof initialHelper?.getTop !== 'function')\n         {\n            throw new Error(\n             `'options.initial' position helper does not contain 'getLeft' and / or 'getTop' functions.`);\n         }\n\n         this.#options.initialHelper = options.initial;\n      }\n\n      if (options?.validator)\n      {\n         if (isIterable(options?.validator)) { this.validators.add(...options.validator); }\n         else { this.validators.add(options.validator); }\n      }\n   }\n\n   /**\n    * Returns the animation API.\n    *\n    * @returns {AnimationAPI} Animation API.\n    */\n   get animate()\n   {\n      return this.#animate;\n   }\n\n   /**\n    * Returns the dimension data for the readable store.\n    *\n    * @returns {{width: number | 'auto', height: number | 'auto'}} Dimension data.\n    */\n   get dimension()\n   {\n      return this.#updateElementData.dimensionData;\n   }\n\n   /**\n    * Returns the enabled state.\n    *\n    * @returns {boolean} Enabled state.\n    */\n   get enabled()\n   {\n      return this.#enabled;\n   }\n\n   /**\n    * Returns the current HTMLElement being positioned.\n    *\n    * @returns {HTMLElement|undefined} Current HTMLElement being positioned.\n    */\n   get element()\n   {\n      return this.#styleCache.el;\n   }\n\n   /**\n    * Returns a promise that is resolved on the next element update with the time of the update.\n    *\n    * @returns {Promise<number>} Promise resolved on element update.\n    */\n   get elementUpdated()\n   {\n      return this.#updateElementPromise;\n   }\n\n   /**\n    * Returns the associated {@link TJSPositionParent} instance.\n    *\n    * @returns {import('./').TJSPositionParent} The TJSPositionParent instance.\n    */\n   get parent() { return this.#parent; }\n\n   /**\n    * Returns the state API.\n    *\n    * @returns {import('./PositionStateAPI').PositionStateAPI} TJSPosition state API.\n    */\n   get state() { return this.#state; }\n\n   /**\n    * Returns the derived writable stores for individual data variables.\n    *\n    * @returns {import('./').TJSPositionStores} Derived / writable stores.\n    */\n   get stores() { return this.#stores; }\n\n   /**\n    * Returns the transform data for the readable store.\n    *\n    * @returns {TJSTransformData} Transform Data.\n    */\n   get transform()\n   {\n      return this.#updateElementData.transformData;\n   }\n\n   /**\n    * Returns the validators.\n    *\n    * @returns {AdapterValidators} validators.\n    */\n   get validators() { return this.#validators; }\n\n   /**\n    * Sets the enabled state.\n    *\n    * @param {boolean}  enabled - New enabled state.\n    */\n   set enabled(enabled)\n   {\n      if (typeof enabled !== 'boolean')\n      {\n         throw new TypeError(`'enabled' is not a boolean.`);\n      }\n\n      this.#enabled = enabled;\n   }\n\n   /**\n    * Sets the associated {@link TJSPositionParent} instance. Resets the style cache and default data.\n    *\n    * @param {import('./').TJSPositionParent} parent - A TJSPositionParent instance.\n    */\n   set parent(parent)\n   {\n      if (parent !== void 0 && !(parent instanceof HTMLElement) && !isObject(parent))\n      {\n         throw new TypeError(`'parent' is not an HTMLElement, object, or undefined.`);\n      }\n\n      this.#parent = parent;\n\n      // Reset any stored default data & the style cache.\n      this.#state.remove({ name: '#defaultData' });\n      this.#styleCache.reset();\n\n      // If a parent is defined then invoke set to update any parent element.\n      if (parent) { this.set(this.#data); }\n   }\n\n// Data accessors ----------------------------------------------------------------------------------------------------\n\n   /**\n    * @returns {number|'auto'|'inherit'|null} height\n    */\n   get height() { return this.#data.height; }\n\n   /**\n    * @returns {number|null} left\n    */\n   get left() { return this.#data.left; }\n\n   /**\n    * @returns {number|null} maxHeight\n    */\n   get maxHeight() { return this.#data.maxHeight; }\n\n   /**\n    * @returns {number|null} maxWidth\n    */\n   get maxWidth() { return this.#data.maxWidth; }\n\n   /**\n    * @returns {number|null} minHeight\n    */\n   get minHeight() { return this.#data.minHeight; }\n\n   /**\n    * @returns {number|null} minWidth\n    */\n   get minWidth() { return this.#data.minWidth; }\n\n   /**\n    * @returns {number|null} rotateX\n    */\n   get rotateX() { return this.#data.rotateX; }\n\n   /**\n    * @returns {number|null} rotateY\n    */\n   get rotateY() { return this.#data.rotateY; }\n\n   /**\n    * @returns {number|null} rotateZ\n    */\n   get rotateZ() { return this.#data.rotateZ; }\n\n   /**\n    * @returns {number|null} alias for rotateZ\n    */\n   get rotation() { return this.#data.rotateZ; }\n\n   /**\n    * @returns {number|null} scale\n    */\n   get scale() { return this.#data.scale; }\n\n   /**\n    * @returns {number|null} top\n    */\n   get top() { return this.#data.top; }\n\n   /**\n    * @returns {import('./').TJSTransformOrigin} transformOrigin\n    */\n   get transformOrigin() { return this.#data.transformOrigin; }\n\n   /**\n    * @returns {number|null} translateX\n    */\n   get translateX() { return this.#data.translateX; }\n\n   /**\n    * @returns {number|null} translateY\n    */\n   get translateY() { return this.#data.translateY; }\n\n   /**\n    * @returns {number|null} translateZ\n    */\n   get translateZ() { return this.#data.translateZ; }\n\n   /**\n    * @returns {number|'auto'|'inherit'|null} width\n    */\n   get width() { return this.#data.width; }\n\n   /**\n    * @returns {number|null} z-index\n    */\n   get zIndex() { return this.#data.zIndex; }\n\n   /**\n    * @param {number|string|null} height -\n    */\n   set height(height)\n   {\n      this.#stores.height.set(height);\n   }\n\n   /**\n    * @param {number|string|null} left -\n    */\n   set left(left)\n   {\n      this.#stores.left.set(left);\n   }\n\n   /**\n    * @param {number|string|null} maxHeight -\n    */\n   set maxHeight(maxHeight)\n   {\n      this.#stores.maxHeight.set(maxHeight);\n   }\n\n   /**\n    * @param {number|string|null} maxWidth -\n    */\n   set maxWidth(maxWidth)\n   {\n      this.#stores.maxWidth.set(maxWidth);\n   }\n\n   /**\n    * @param {number|string|null} minHeight -\n    */\n   set minHeight(minHeight)\n   {\n      this.#stores.minHeight.set(minHeight);\n   }\n\n   /**\n    * @param {number|string|null} minWidth -\n    */\n   set minWidth(minWidth)\n   {\n      this.#stores.minWidth.set(minWidth);\n   }\n\n   /**\n    * @param {number|string|null} rotateX -\n    */\n   set rotateX(rotateX)\n   {\n      this.#stores.rotateX.set(rotateX);\n   }\n\n   /**\n    * @param {number|string|null} rotateY -\n    */\n   set rotateY(rotateY)\n   {\n      this.#stores.rotateY.set(rotateY);\n   }\n\n   /**\n    * @param {number|string|null} rotateZ -\n    */\n   set rotateZ(rotateZ)\n   {\n      this.#stores.rotateZ.set(rotateZ);\n   }\n\n   /**\n    * @param {number|string|null} rotateZ - alias for rotateZ\n    */\n   set rotation(rotateZ)\n   {\n      this.#stores.rotateZ.set(rotateZ);\n   }\n\n   /**\n    * @param {number|string|null} scale -\n    */\n   set scale(scale)\n   {\n      this.#stores.scale.set(scale);\n   }\n\n   /**\n    * @param {number|string|null} top -\n    */\n   set top(top)\n   {\n      this.#stores.top.set(top);\n   }\n\n   /**\n    * @param {import('./').TJSTransformOrigin} transformOrigin -\n    */\n   set transformOrigin(transformOrigin)\n   {\n      if (transformOrigins.includes(transformOrigin)) { this.#stores.transformOrigin.set(transformOrigin); }\n   }\n\n   /**\n    * @param {number|string|null} translateX -\n    */\n   set translateX(translateX)\n   {\n      this.#stores.translateX.set(translateX);\n   }\n\n   /**\n    * @param {number|string|null} translateY -\n    */\n   set translateY(translateY)\n   {\n      this.#stores.translateY.set(translateY);\n   }\n\n   /**\n    * @param {number|string|null} translateZ -\n    */\n   set translateZ(translateZ)\n   {\n      this.#stores.translateZ.set(translateZ);\n   }\n\n   /**\n    * @param {number|string|null} width -\n    */\n   set width(width)\n   {\n      this.#stores.width.set(width);\n   }\n\n   /**\n    * @param {number|string|null} zIndex -\n    */\n   set zIndex(zIndex)\n   {\n      this.#stores.zIndex.set(zIndex);\n   }\n\n   /**\n    * Assigns current position to object passed into method.\n    *\n    * @param {object|TJSPositionData}  [position] - Target to assign current position data.\n    *\n    * @param {import('./').TJSPositionGetOptions}   [options] - Defines options for specific keys and substituting null\n    *        for numeric default values.\n    *\n    * @returns {TJSPositionData} Passed in object with current position data.\n    */\n   get(position = {}, options)\n   {\n      const keys = options?.keys;\n      const excludeKeys = options?.exclude;\n      const numeric = options?.numeric ?? false;\n\n      if (isIterable(keys))\n      {\n         // Replace any null values potentially with numeric default values.\n         if (numeric)\n         {\n            for (const key of keys) { position[key] = this[key] ?? numericDefaults[key]; }\n         }\n         else // Accept current values.\n         {\n            for (const key of keys) { position[key] = this[key]; }\n         }\n\n         // Remove any excluded keys.\n         if (isIterable(excludeKeys))\n         {\n            for (const key of excludeKeys) { delete position[key]; }\n         }\n\n         return position;\n      }\n      else\n      {\n         const data = Object.assign(position, this.#data);\n\n         // Remove any excluded keys.\n         if (isIterable(excludeKeys))\n         {\n            for (const key of excludeKeys) { delete data[key]; }\n         }\n\n         // Potentially set numeric defaults.\n         if (numeric) { setNumericDefaults(data); }\n\n         return data;\n      }\n   }\n\n   /**\n    * @returns {TJSPositionData} Current position data.\n    */\n   toJSON()\n   {\n      return Object.assign({}, this.#data);\n   }\n\n   /**\n    * All calculation and updates of position are implemented in {@link TJSPosition}. This allows position to be fully\n    * reactive and in control of updating inline styles for the application.\n    *\n    * Note: the logic for updating position is improved and changes a few aspects from the default\n    * {@link globalThis.Application.setPosition}. The gate on `popOut` is removed, so to ensure no positional\n    * application occurs popOut applications can set `this.options.positionable` to false ensuring no positional inline\n    * styles are applied.\n    *\n    * The initial set call on an application with a target element will always set width / height as this is\n    * necessary for correct calculations.\n    *\n    * When a target element is present updated styles are applied after validation. To modify the behavior of set\n    * implement one or more validator functions and add them from the application via\n    * `this.position.validators.add(<Function>)`.\n    *\n    * Updates to any target element are decoupled from the underlying TJSPosition data. This method returns this instance\n    * that you can then await on the target element inline style update by using {@link TJSPosition.elementUpdated}.\n    *\n    * @param {import('./').TJSPositionDataExtended} [position] - TJSPosition data to set.\n    *\n    * @returns {TJSPosition} This TJSPosition instance.\n    */\n   set(position = {})\n   {\n      if (!isObject(position)) { throw new TypeError(`Position - set error: 'position' is not an object.`); }\n\n      const parent = this.#parent;\n\n      // An early out to prevent `set` from taking effect if not enabled.\n      if (!this.#enabled)\n      {\n         return this;\n      }\n\n      // An early out to prevent `set` from taking effect if options `positionable` is false.\n      if (parent !== void 0 && typeof parent?.options?.positionable === 'boolean' && !parent?.options?.positionable)\n      {\n         return this;\n      }\n\n      // Callers can specify to immediately update an associated element. This is useful if set is called from\n      // requestAnimationFrame / rAF. Library integrations like GSAP invoke set from rAF.\n      const immediateElementUpdate = position.immediateElementUpdate === true;\n\n      const data = this.#data;\n      const transforms = this.#transforms;\n\n      // Find the target HTML element and verify that it is connected storing it in `el`.\n      const targetEl = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n      const el = targetEl instanceof HTMLElement && targetEl.isConnected ? targetEl : void 0;\n\n      const changeSet = this.#positionChangeSet;\n      const styleCache = this.#styleCache;\n\n      if (el)\n      {\n         // Cache the computed styles of the element.\n         if (!styleCache.hasData(el))\n         {\n            styleCache.update(el);\n\n            // Add will-change property if not already set in inline or computed styles.\n            if (!styleCache.hasWillChange)\n            ;\n\n            // Update all properties / clear queued state.\n            changeSet.set(true);\n            this.#updateElementData.queued = false;\n         }\n\n         // Converts any relative string position data to numeric inputs.\n         convertRelative(position, this);\n\n         position = this.#updatePosition(position, parent, el, styleCache);\n\n         // Check if a validator cancelled the update.\n         if (position === null) { return this; }\n      }\n\n      if (Number.isFinite(position.left))\n      {\n         position.left = Math.round(position.left);\n\n         if (data.left !== position.left) { data.left = position.left; changeSet.left = true; }\n      }\n\n      if (Number.isFinite(position.top))\n      {\n         position.top = Math.round(position.top);\n\n         if (data.top !== position.top) { data.top = position.top; changeSet.top = true; }\n      }\n\n      if (Number.isFinite(position.maxHeight) || position.maxHeight === null)\n      {\n         position.maxHeight = typeof position.maxHeight === 'number' ? Math.round(position.maxHeight) : null;\n\n         if (data.maxHeight !== position.maxHeight) { data.maxHeight = position.maxHeight; changeSet.maxHeight = true; }\n      }\n\n      if (Number.isFinite(position.maxWidth) || position.maxWidth === null)\n      {\n         position.maxWidth = typeof position.maxWidth === 'number' ? Math.round(position.maxWidth) : null;\n\n         if (data.maxWidth !== position.maxWidth) { data.maxWidth = position.maxWidth; changeSet.maxWidth = true; }\n      }\n\n      if (Number.isFinite(position.minHeight) || position.minHeight === null)\n      {\n         position.minHeight = typeof position.minHeight === 'number' ? Math.round(position.minHeight) : null;\n\n         if (data.minHeight !== position.minHeight) { data.minHeight = position.minHeight; changeSet.minHeight = true; }\n      }\n\n      if (Number.isFinite(position.minWidth) || position.minWidth === null)\n      {\n         position.minWidth = typeof position.minWidth === 'number' ? Math.round(position.minWidth) : null;\n\n         if (data.minWidth !== position.minWidth) { data.minWidth = position.minWidth; changeSet.minWidth = true; }\n      }\n\n      if (Number.isFinite(position.rotateX) || position.rotateX === null)\n      {\n         if (data.rotateX !== position.rotateX)\n         {\n            data.rotateX = transforms.rotateX = position.rotateX;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.rotateY) || position.rotateY === null)\n      {\n         if (data.rotateY !== position.rotateY)\n         {\n            data.rotateY = transforms.rotateY = position.rotateY;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.rotateZ) || position.rotateZ === null)\n      {\n         if (data.rotateZ !== position.rotateZ)\n         {\n            data.rotateZ = transforms.rotateZ = position.rotateZ;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.scale) || position.scale === null)\n      {\n         position.scale = typeof position.scale === 'number' ? Math.max(0, Math.min(position.scale, 1000)) : null;\n\n         if (data.scale !== position.scale)\n         {\n            data.scale = transforms.scale = position.scale;\n            changeSet.transform = true;\n         }\n      }\n\n      if ((typeof position.transformOrigin === 'string' && transformOrigins.includes(\n       position.transformOrigin)) || position.transformOrigin === null)\n      {\n         if (data.transformOrigin !== position.transformOrigin)\n         {\n            data.transformOrigin = position.transformOrigin;\n            changeSet.transformOrigin = true;\n         }\n      }\n\n      if (Number.isFinite(position.translateX) || position.translateX === null)\n      {\n         if (data.translateX !== position.translateX)\n         {\n            data.translateX = transforms.translateX = position.translateX;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.translateY) || position.translateY === null)\n      {\n         if (data.translateY !== position.translateY)\n         {\n            data.translateY = transforms.translateY = position.translateY;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.translateZ) || position.translateZ === null)\n      {\n         if (data.translateZ !== position.translateZ)\n         {\n            data.translateZ = transforms.translateZ = position.translateZ;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.zIndex))\n      {\n         position.zIndex = Math.round(position.zIndex);\n\n         if (data.zIndex !== position.zIndex) { data.zIndex = position.zIndex; changeSet.zIndex = true; }\n      }\n\n      if (Number.isFinite(position.width) || position.width === 'auto' || position.width === 'inherit' ||\n       position.width === null)\n      {\n         position.width = typeof position.width === 'number' ? Math.round(position.width) : position.width;\n\n         if (data.width !== position.width) { data.width = position.width; changeSet.width = true; }\n      }\n\n      if (Number.isFinite(position.height) || position.height === 'auto' || position.height === 'inherit' ||\n       position.height === null)\n      {\n         position.height = typeof position.height === 'number' ? Math.round(position.height) : position.height;\n\n         if (data.height !== position.height) { data.height = position.height; changeSet.height = true; }\n      }\n\n      if (el)\n      {\n         const defaultData = this.#state.getDefault();\n\n         // Set default data after first set operation that has a target element.\n         if (!isObject(defaultData)) { this.#state.save({ name: '#defaultData', ...Object.assign({}, data) }); }\n\n         // If `immediateElementUpdate` is true in position data passed to `set` then update the element immediately.\n         // This is for rAF based library integrations like GSAP.\n         if (immediateElementUpdate)\n         {\n            UpdateElementManager.immediate(el, this.#updateElementData);\n            this.#updateElementPromise = Promise.resolve(performance.now());\n         }\n         // Else if not queued then queue an update for the next rAF callback.\n         else if (!this.#updateElementData.queued)\n         {\n            this.#updateElementPromise = UpdateElementManager.add(el, this.#updateElementData);\n         }\n      }\n      else\n      {\n         // Notify main store subscribers.\n         UpdateElementManager.updateSubscribers(this.#updateElementData);\n      }\n\n      return this;\n   }\n\n   /**\n    * @param {import('svelte/store').Subscriber<TJSPositionData>} handler - Callback function that is invoked on\n    *        update / changes. Receives a copy of the TJSPositionData.\n    *\n    * @returns {import('svelte/store').Unsubscriber} Unsubscribe function.\n    */\n   subscribe(handler)\n   {\n      this.#subscriptions.push(handler); // add handler to the array of subscribers\n\n      handler(Object.assign({}, this.#data));                     // call handler with current value\n\n      // Return unsubscribe function.\n      return () =>\n      {\n         const index = this.#subscriptions.findIndex((sub) => sub === handler);\n         if (index >= 0) { this.#subscriptions.splice(index, 1); }\n      };\n   }\n\n   /**\n    * @param {import('./').TJSPositionDataExtended} opts -\n    *\n    * @param {number|null} opts.left -\n    *\n    * @param {number|null} opts.top -\n    *\n    * @param {number|null} opts.maxHeight -\n    *\n    * @param {number|null} opts.maxWidth -\n    *\n    * @param {number|null} opts.minHeight -\n    *\n    * @param {number|null} opts.minWidth -\n    *\n    * @param {number|'auto'|null} opts.width -\n    *\n    * @param {number|'auto'|null} opts.height -\n    *\n    * @param {number|null} opts.rotateX -\n    *\n    * @param {number|null} opts.rotateY -\n    *\n    * @param {number|null} opts.rotateZ -\n    *\n    * @param {number|null} opts.scale -\n    *\n    * @param {string} opts.transformOrigin -\n    *\n    * @param {number|null} opts.translateX -\n    *\n    * @param {number|null} opts.translateY -\n    *\n    * @param {number|null} opts.translateZ -\n    *\n    * @param {number|null} opts.zIndex -\n    *\n    * @param {number|null} opts.rotation - alias for rotateZ\n    *\n    * @param {*} opts.rest -\n    *\n    * @param {object} parent -\n    *\n    * @param {HTMLElement} el -\n    *\n    * @param {StyleCache} styleCache -\n    *\n    * @returns {null|TJSPositionData} Updated position data or null if validation fails.\n    */\n   #updatePosition({\n      // Directly supported parameters\n      left, top, maxWidth, maxHeight, minWidth, minHeight, width, height, rotateX, rotateY, rotateZ, scale,\n       transformOrigin, translateX, translateY, translateZ, zIndex,\n\n      // Aliased parameters\n      rotation,\n\n      ...rest\n   } = {}, parent, el, styleCache)\n   {\n      let currentPosition = s_DATA_UPDATE.copy(this.#data);\n\n      // Update width if an explicit value is passed, or if no width value is set on the element.\n      if (el.style.width === '' || width !== void 0)\n      {\n         if (width === 'auto' || (currentPosition.width === 'auto' && width !== null))\n         {\n            currentPosition.width = 'auto';\n            width = styleCache.offsetWidth;\n         }\n         else if (width === 'inherit' || (currentPosition.width === 'inherit' && width !== null))\n         {\n            currentPosition.width = 'inherit';\n            width = styleCache.offsetWidth;\n         }\n         else\n         {\n            const newWidth = Number.isFinite(width) ? width : currentPosition.width;\n            currentPosition.width = width = Number.isFinite(newWidth) ? Math.round(newWidth) : styleCache.offsetWidth;\n         }\n      }\n      else\n      {\n         width = Number.isFinite(currentPosition.width) ? currentPosition.width : styleCache.offsetWidth;\n      }\n\n      // Update height if an explicit value is passed, or if no height value is set on the element.\n      if (el.style.height === '' || height !== void 0)\n      {\n         if (height === 'auto' || (currentPosition.height === 'auto' && height !== null))\n         {\n            currentPosition.height = 'auto';\n            height = styleCache.offsetHeight;\n         }\n         else if (height === 'inherit' || (currentPosition.height === 'inherit' && height !== null))\n         {\n            currentPosition.height = 'inherit';\n            height = styleCache.offsetHeight;\n         }\n         else\n         {\n            const newHeight = Number.isFinite(height) ? height : currentPosition.height;\n            currentPosition.height = height = Number.isFinite(newHeight) ? Math.round(newHeight) :\n             styleCache.offsetHeight;\n         }\n      }\n      else\n      {\n         height = Number.isFinite(currentPosition.height) ? currentPosition.height : styleCache.offsetHeight;\n      }\n\n      // Update left\n      if (Number.isFinite(left))\n      {\n         currentPosition.left = left;\n      }\n      else if (!Number.isFinite(currentPosition.left))\n      {\n         // Potentially use any initial position helper if available or set to 0.\n         currentPosition.left = typeof this.#options.initialHelper?.getLeft === 'function' ?\n          this.#options.initialHelper.getLeft(width) : 0;\n      }\n\n      // Update top\n      if (Number.isFinite(top))\n      {\n         currentPosition.top = top;\n      }\n      else if (!Number.isFinite(currentPosition.top))\n      {\n         // Potentially use any initial position helper if available or set to 0.\n         currentPosition.top = typeof this.#options.initialHelper?.getTop === 'function' ?\n          this.#options.initialHelper.getTop(height) : 0;\n      }\n\n      if (Number.isFinite(maxHeight) || maxHeight === null)\n      {\n         currentPosition.maxHeight = Number.isFinite(maxHeight) ? Math.round(maxHeight) : null;\n      }\n\n      if (Number.isFinite(maxWidth) || maxWidth === null)\n      {\n         currentPosition.maxWidth = Number.isFinite(maxWidth) ? Math.round(maxWidth) : null;\n      }\n\n      if (Number.isFinite(minHeight) || minHeight === null)\n      {\n         currentPosition.minHeight = Number.isFinite(minHeight) ? Math.round(minHeight) : null;\n      }\n\n      if (Number.isFinite(minWidth) || minWidth === null)\n      {\n         currentPosition.minWidth = Number.isFinite(minWidth) ? Math.round(minWidth) : null;\n      }\n\n      // Update rotate X/Y/Z, scale, z-index\n      if (Number.isFinite(rotateX) || rotateX === null) { currentPosition.rotateX = rotateX; }\n      if (Number.isFinite(rotateY) || rotateY === null) { currentPosition.rotateY = rotateY; }\n\n      // Handle alias for rotateZ. First check if `rotateZ` is valid and different from the current value. Next check if\n      // `rotation` is valid and use it for `rotateZ`.\n      if (rotateZ !== currentPosition.rotateZ && (Number.isFinite(rotateZ) || rotateZ === null))\n      {\n         currentPosition.rotateZ = rotateZ;\n      }\n      else if (rotation !== currentPosition.rotateZ && (Number.isFinite(rotation) || rotation === null))\n      {\n         currentPosition.rotateZ = rotation;\n      }\n\n      if (Number.isFinite(translateX) || translateX === null) { currentPosition.translateX = translateX; }\n      if (Number.isFinite(translateY) || translateY === null) { currentPosition.translateY = translateY; }\n      if (Number.isFinite(translateZ) || translateZ === null) { currentPosition.translateZ = translateZ; }\n\n      if (Number.isFinite(scale) || scale === null)\n      {\n         currentPosition.scale = typeof scale === 'number' ? Math.max(0, Math.min(scale, 1000)) : null;\n      }\n\n      if (typeof transformOrigin === 'string' || transformOrigin === null)\n      {\n         currentPosition.transformOrigin = transformOrigins.includes(transformOrigin) ? transformOrigin :\n          null;\n      }\n\n      if (Number.isFinite(zIndex) || zIndex === null)\n      {\n         currentPosition.zIndex = typeof zIndex === 'number' ? Math.round(zIndex) : zIndex;\n      }\n\n      const validatorData = this.#validatorData;\n\n      // If there are any validators allow them to potentially modify position data or reject the update.\n      if (this.#validators.enabled && validatorData.length)\n      {\n         s_VALIDATION_DATA.parent = parent;\n\n         s_VALIDATION_DATA.el = el;\n\n         s_VALIDATION_DATA.computed = styleCache.computed;\n\n         s_VALIDATION_DATA.transforms = this.#transforms;\n\n         s_VALIDATION_DATA.height = height;\n\n         s_VALIDATION_DATA.width = width;\n\n         s_VALIDATION_DATA.marginLeft = styleCache.marginLeft;\n\n         s_VALIDATION_DATA.marginTop = styleCache.marginTop;\n\n         s_VALIDATION_DATA.maxHeight = styleCache.maxHeight ?? currentPosition.maxHeight;\n\n         s_VALIDATION_DATA.maxWidth = styleCache.maxWidth ?? currentPosition.maxWidth;\n\n         // Given a parent w/ reactive state and is minimized ignore styleCache min-width/height.\n         const isMinimized = parent?.reactive?.minimized ?? false;\n\n         // Note the use of || for accessing the style cache as the left hand is ignored w/ falsy values such as '0'.\n         s_VALIDATION_DATA.minHeight = isMinimized ? currentPosition.minHeight ?? 0 :\n          styleCache.minHeight || (currentPosition.minHeight ?? 0);\n\n         s_VALIDATION_DATA.minWidth = isMinimized ? currentPosition.minWidth ?? 0 :\n          styleCache.minWidth || (currentPosition.minWidth ?? 0);\n\n         for (let cntr = 0; cntr < validatorData.length; cntr++)\n         {\n            s_VALIDATION_DATA.position = currentPosition;\n            s_VALIDATION_DATA.rest = rest;\n            currentPosition = validatorData[cntr].validator(s_VALIDATION_DATA);\n\n            if (currentPosition === null) { return null; }\n         }\n      }\n\n      // Return the updated position object.\n      return currentPosition;\n   }\n}\n\nconst s_DATA_UPDATE = new TJSPositionData();\n\n/**\n * @type {import('./').ValidationData}\n */\nconst s_VALIDATION_DATA = {\n   position: void 0,\n   parent: void 0,\n   el: void 0,\n   computed: void 0,\n   transforms: void 0,\n   height: void 0,\n   width: void 0,\n   marginLeft: void 0,\n   marginTop: void 0,\n   maxHeight: void 0,\n   maxWidth: void 0,\n   minHeight: void 0,\n   minWidth: void 0,\n   rest: void 0\n};\n\nObject.seal(s_VALIDATION_DATA);\n\n/**\n * Provides an action to apply a TJSPosition instance to a HTMLElement and invoke `position.parent`\n *\n * @param {HTMLElement}       node - The node associated with the action.\n *\n * @param {import('..').TJSPosition}   position - A position instance.\n *\n * @returns {import('svelte/action').ActionReturn<import('..').TJSPosition>} The action lifecycle methods.\n */\nfunction applyPosition(node, position)\n{\n   if (hasSetter(position, 'parent')) { position.parent = node; }\n\n   return {\n      update: (newPosition) =>\n      {\n         // Sanity case to short circuit update if positions are the same instance.\n         if (newPosition === position && newPosition.parent === position.parent) { return; }\n\n         if (hasSetter(position, 'parent')) { position.parent = void 0; }\n\n         position = newPosition;\n\n         if (hasSetter(position, 'parent')) { position.parent = node; }\n      },\n\n      destroy: () => { if (hasSetter(position, 'parent')) { position.parent = void 0; } }\n   };\n}\n\n/**\n * Provides an action to enable pointer dragging of an HTMLElement and invoke `position.set` on a given\n * {@link TJSPosition} instance provided. When the attached boolean store state changes the draggable\n * action is enabled or disabled.\n *\n * @param {HTMLElement}       node - The node associated with the action.\n *\n * @param {object}            params - Required parameters.\n *\n * @param {import('..').TJSPosition}   params.position - A position instance.\n *\n * @param {boolean}           [params.active=true] - A boolean value; attached to a readable store.\n *\n * @param {number}            [params.button=0] - MouseEvent button; {@link https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button}.\n *\n * @param {import('svelte/store').Writable<boolean>} [params.storeDragging] - A writable store that tracks \"dragging\"\n *        state.\n *\n * @param {boolean}           [params.ease=true] - When true easing is enabled.\n *\n * @param {object}            [params.easeOptions] - Gsap `to / `quickTo` vars object.\n *\n * @param {Iterable<string>}  [params.hasTargetClassList] - When defined any event targets that have a class in this\n *        list are allowed.\n *\n * @param {Iterable<string>}  [params.ignoreTargetClassList] - When defined any event targets that have a class in this\n *        list are ignored.\n *\n * @returns {import('svelte/action').ActionReturn<Record<string, any>>} Lifecycle functions.\n */\nfunction draggable(node, { position, active = true, button = 0, storeDragging = void 0, ease = false,\n easeOptions = { duration: 0.1, ease: cubicOut }, hasTargetClassList, ignoreTargetClassList })\n{\n   if (hasTargetClassList !== void 0 && !isIterable(hasTargetClassList))\n   {\n      throw new TypeError(`'hasTargetClassList' is not iterable.`);\n   }\n\n   if (ignoreTargetClassList !== void 0 && !isIterable(ignoreTargetClassList))\n   {\n      throw new TypeError(`'ignoreTargetClassList' is not iterable.`);\n   }\n\n   /**\n    * Used for direct call to `position.set`.\n    *\n    * @type {{top: number, left: number}}\n    */\n   const positionData = { left: 0, top: 0 };\n\n   /**\n    * Duplicate the app / Positionable starting position to track differences.\n    *\n    * @type {object}\n    */\n   let initialPosition = null;\n\n   /**\n    * Stores the initial X / Y on drag down.\n    *\n    * @type {object}\n    */\n   let initialDragPoint = {};\n\n   /**\n    * Stores the current dragging state and gates the move pointer as the dragging store is not\n    * set until the first pointer move.\n    *\n    * @type {boolean}\n    */\n   let dragging = false;\n\n   /**\n    * Stores the quickTo callback to use for optimized tweening when easing is enabled.\n    *\n    * @type {import('#runtime/svelte/store/position').quickToCallback}\n    */\n   let quickTo = position.animate.quickTo(['top', 'left'], easeOptions);\n\n   /**\n    * Remember event handlers associated with this action, so they may be later unregistered.\n    *\n    *  @type {{ [key: string]: [string, Function, boolean] }}\n    */\n   const handlers = {\n      dragDown: ['pointerdown', onDragPointerDown, false],\n      dragMove: ['pointermove', onDragPointerChange, false],\n      dragUp: ['pointerup', onDragPointerUp, false]\n   };\n\n   /**\n    * Activates listeners.\n    */\n   function activateListeners()\n   {\n      // Drag handlers\n      node.addEventListener(...handlers.dragDown);\n      node.classList.add('draggable');\n   }\n\n   /**\n    * Removes listeners.\n    */\n   function removeListeners()\n   {\n      if (typeof storeDragging?.set === 'function') { storeDragging.set(false); }\n\n      // Drag handlers\n      node.removeEventListener(...handlers.dragDown);\n      node.removeEventListener(...handlers.dragMove);\n      node.removeEventListener(...handlers.dragUp);\n      node.classList.remove('draggable');\n   }\n\n   if (active)\n   {\n      activateListeners();\n   }\n\n   /**\n    * Handle the initial pointer down that activates dragging behavior for the positionable.\n    *\n    * @param {PointerEvent} event - The pointer down event.\n    */\n   function onDragPointerDown(event)\n   {\n      if (event.button !== button || !event.isPrimary) { return; }\n\n      // Do not process if the position system is not enabled.\n      if (!position.enabled) { return; }\n\n      // Potentially ignore this event if `ignoreTargetClassList` is defined and the `event.target` has a matching\n      // class.\n      if (ignoreTargetClassList !== void 0 && event.target instanceof HTMLElement)\n      {\n         for (const targetClass of ignoreTargetClassList)\n         {\n            if (event.target.classList.contains(targetClass)) { return; }\n         }\n      }\n\n      // Potentially ignore this event if `hasTargetClassList` is defined and the `event.target` does not have any\n      // matching class from the list.\n      if (hasTargetClassList !== void 0 && event.target instanceof HTMLElement)\n      {\n         let foundTarget = false;\n\n         for (const targetClass of hasTargetClassList)\n         {\n            if (event.target.classList.contains(targetClass))\n            {\n               foundTarget = true;\n               break;\n            }\n         }\n\n         if (!foundTarget) { return; }\n      }\n\n      event.preventDefault();\n\n      dragging = false;\n\n      // Record initial position.\n      initialPosition = position.get();\n      initialDragPoint = { x: event.clientX, y: event.clientY };\n\n      // Add move and pointer up handlers.\n      node.addEventListener(...handlers.dragMove);\n      node.addEventListener(...handlers.dragUp);\n\n      node.setPointerCapture(event.pointerId);\n   }\n\n   /**\n    * Move the positionable.\n    *\n    * @param {PointerEvent} event - The pointer move event.\n    */\n   function onDragPointerChange(event)\n   {\n      // See chorded button presses for pointer events:\n      // https://www.w3.org/TR/pointerevents3/#chorded-button-interactions\n      // TODO: Support different button configurations for PointerEvents.\n      if ((event.buttons & 1) === 0)\n      {\n         onDragPointerUp(event);\n         return;\n      }\n\n      if (event.button !== -1 || !event.isPrimary) { return; }\n\n      event.preventDefault();\n\n      // Only set store dragging on first move event.\n      if (!dragging && typeof storeDragging?.set === 'function')\n      {\n         dragging = true;\n         storeDragging.set(true);\n      }\n\n      /** @type {number} */\n      const newLeft = initialPosition.left + (event.clientX - initialDragPoint.x);\n      /** @type {number} */\n      const newTop = initialPosition.top + (event.clientY - initialDragPoint.y);\n\n      if (ease)\n      {\n         quickTo(newTop, newLeft);\n      }\n      else\n      {\n         positionData.left = newLeft;\n         positionData.top = newTop;\n\n         position.set(positionData);\n      }\n   }\n\n   /**\n    * Finish dragging and set the final position and removing listeners.\n    *\n    * @param {PointerEvent} event - The pointer up event.\n    */\n   function onDragPointerUp(event)\n   {\n      event.preventDefault();\n\n      dragging = false;\n      if (typeof storeDragging?.set === 'function') { storeDragging.set(false); }\n\n      node.removeEventListener(...handlers.dragMove);\n      node.removeEventListener(...handlers.dragUp);\n   }\n\n   return {\n      // The default of active being true won't automatically add listeners twice.\n      update: (options) =>\n      {\n         if (typeof options.active === 'boolean')\n         {\n            active = options.active;\n            if (active) { activateListeners(); }\n            else { removeListeners(); }\n         }\n\n         if (typeof options.button === 'number')\n         {\n            button = options.button;\n         }\n\n         if (options.position !== void 0 && options.position !== position)\n         {\n            position = options.position;\n            quickTo = position.animate.quickTo(['top', 'left'], easeOptions);\n         }\n\n         if (typeof options.ease === 'boolean') { ease = options.ease; }\n\n         if (isObject(options.easeOptions))\n         {\n            easeOptions = options.easeOptions;\n            quickTo.options(easeOptions);\n         }\n\n         if (options.hasTargetClassList !== void 0)\n         {\n            if (!isIterable(options.hasTargetClassList))\n            {\n               throw new TypeError(`'hasTargetClassList' is not iterable.`);\n            }\n            else\n            {\n               hasTargetClassList = options.hasTargetClassList;\n            }\n         }\n\n         if (options.ignoreTargetClassList !== void 0)\n         {\n            if (!isIterable(options.ignoreTargetClassList))\n            {\n               throw new TypeError(`'ignoreTargetClassList' is not iterable.`);\n            }\n            else\n            {\n               ignoreTargetClassList = options.ignoreTargetClassList;\n            }\n         }\n      },\n\n      destroy: () => removeListeners()\n   };\n}\n\nclass DraggableOptions\n{\n   #ease = false;\n\n   /**\n    * @type {{ duration: number, ease: (t: number) => number | string }}\n    */\n   #easeOptions = { duration: 0.1, ease: cubicOut };\n\n   /**\n    * Stores the subscribers.\n    *\n    * @type {import('svelte/store').Subscriber<DraggableOptions>[]}\n    */\n   #subscriptions = [];\n\n   /**\n    *\n    * @param {object} [opts] - Optional parameters.\n    *\n    * @param {boolean}  [opts.ease] -\n    *\n    * @param {object}   [opts.easeOptions] -\n    */\n   constructor({ ease, easeOptions } = {})\n   {\n      // Define the following getters directly on this instance and make them enumerable. This allows them to be\n      // picked up w/ `Object.assign`.\n      Object.defineProperty(this, 'ease', {\n         get: () => { return this.#ease; },\n         set: (newEase) =>\n         {\n            if (typeof newEase !== 'boolean') { throw new TypeError(`'ease' is not a boolean.`); }\n\n            this.#ease = newEase;\n            this.#updateSubscribers();\n         },\n         enumerable: true\n      });\n\n      Object.defineProperty(this, 'easeOptions', {\n         get: () => { return this.#easeOptions; },\n         set: (newEaseOptions) =>\n         {\n            if (!isObject(newEaseOptions))\n            {\n               throw new TypeError(`'easeOptions' is not an object.`);\n            }\n\n            if (newEaseOptions.duration !== void 0)\n            {\n               if (!Number.isFinite(newEaseOptions.duration))\n               {\n                  throw new TypeError(`'easeOptions.duration' is not a finite number.`);\n               }\n\n               if (newEaseOptions.duration < 0) { throw new Error(`'easeOptions.duration' is less than 0.`); }\n\n               this.#easeOptions.duration = newEaseOptions.duration;\n            }\n\n            if (newEaseOptions.ease !== void 0)\n            {\n               if (typeof newEaseOptions.ease !== 'function' && typeof newEaseOptions.ease !== 'string')\n               {\n                  throw new TypeError(`'easeOptions.ease' is not a function or string.`);\n               }\n\n               this.#easeOptions.ease = newEaseOptions.ease;\n            }\n\n            this.#updateSubscribers();\n         },\n         enumerable: true\n      });\n\n      // Set default options.\n      if (ease !== void 0) { this.ease = ease; }\n      if (easeOptions !== void 0) { this.easeOptions = easeOptions; }\n   }\n\n\n   /**\n    * @returns {number} Get ease duration\n    */\n   get easeDuration() { return this.#easeOptions.duration; }\n\n   /**\n    * @returns {string|Function} Get easing function value.\n    */\n   get easeValue() { return this.#easeOptions.ease; }\n\n\n   /**\n    * @param {number}   duration - Set ease duration.\n    */\n   set easeDuration(duration)\n   {\n      if (!Number.isFinite(duration))\n      {\n         throw new TypeError(`'duration' is not a finite number.`);\n      }\n\n      if (duration < 0) { throw new Error(`'duration' is less than 0.`); }\n\n      this.#easeOptions.duration = duration;\n      this.#updateSubscribers();\n   }\n\n   /**\n    * @param {string|Function} value - Get easing function value.\n    */\n   set easeValue(value)\n   {\n      if (typeof value !== 'function' && typeof value !== 'string')\n      {\n         throw new TypeError(`'value' is not a function or string.`);\n      }\n\n      this.#easeOptions.ease = value;\n      this.#updateSubscribers();\n   }\n\n   /**\n    * Resets all options data to default values.\n    */\n   reset()\n   {\n      this.#ease = false;\n      this.#easeOptions = { duration: 0.1, ease: cubicOut };\n      this.#updateSubscribers();\n   }\n\n   /**\n    * Resets easing options to default values.\n    */\n   resetEase()\n   {\n      this.#easeOptions = { duration: 0.1, ease: cubicOut };\n      this.#updateSubscribers();\n   }\n\n   /**\n    *\n    * @param {import('svelte/store').Subscriber<DraggableOptions>} handler - Callback function that is invoked on\n    *        update / changes. Receives the DraggableOptions object / instance.\n    *\n    * @returns {import('svelte/store').Unsubscriber} Unsubscribe function.\n    */\n   subscribe(handler)\n   {\n      this.#subscriptions.push(handler); // add handler to the array of subscribers\n\n      handler(this);                     // call handler with current value\n\n      // Return unsubscribe function.\n      return () =>\n      {\n         const index = this.#subscriptions.findIndex((sub) => sub === handler);\n         if (index >= 0) { this.#subscriptions.splice(index, 1); }\n      };\n   }\n\n   #updateSubscribers()\n   {\n      const subscriptions = this.#subscriptions;\n\n      // Early out if there are no subscribers.\n      if (subscriptions.length > 0)\n      {\n         for (let cntr = 0; cntr < subscriptions.length; cntr++) { subscriptions[cntr](this); }\n      }\n   }\n}\n\n/**\n * Define a function to get a DraggableOptions instance.\n *\n * @param {{ ease?: boolean, easeOptions?: object }} options - Draggable options.\n *\n * @returns {DraggableOptions} A new options instance.\n */\ndraggable.options = (options) => new DraggableOptions(options);\n\nexport { TJSPosition, TJSPositionData, applyPosition, draggable };\n//# sourceMappingURL=index.js.map\n","<script>\n   /**\n    * Provides an app header button conforming to the Foundry {@link ApplicationHeaderButton} type. Additionally, a\n    * `title` field is supported to give a tool tip for the button. For backward compatibility `onclick` is supported,\n    * but for uniformity across TRL defining an `onPress` function is recommended. If defined it is invoked when\n    * the button is clicked or `Enter` key pressed and state is updated accordingly.\n    *\n    * TRL also supports the following extra button data:\n    * - {keyCode='Enter'}           keyCode: A string conforming to `KeyboardEvent.code` to activate `onPress` callback.\n    * - {keepMinimized=false}       keepMinimized: When true the button is not removed when app minimized.\n    * - {Function}                  onContextMenu: Invoked when right mouse button or contextmenu key is pressed.\n    * - {Function}                  onPress: Invoked when left mouse button or `keyCode` key is pressed.\n    * - {Record<string, string>}    styles: Additional inline styles to apply to button.\n    * - {string}                    title: Tooltip title.\n    */\n   import { applyStyles }   from '@typhonjs-fvtt/runtime/svelte/action/dom';\n   import { isObject }      from '@typhonjs-fvtt/runtime/util/object';\n\n   import { localize }      from '@typhonjs-fvtt/runtime/svelte/helper';\n\n   export let button = void 0;\n\n   const s_REGEX_HTML = /^\\s*<.*>$/;\n\n   $: title = isObject(button) && typeof button.title === 'string' ? localize(button.title) : '';\n\n   // Handle icon and treat bare strings as the icon class; otherwise assume the icon is fully formed HTML.\n   $: icon = isObject(button) && typeof button.icon !== 'string' ? void 0 : s_REGEX_HTML.test(button.icon) ?\n    button.icon : `<i class=\"${button.icon}\" title=\"${title}\"></i>`;\n\n   $: label = isObject(button) && typeof button.label === 'string' ? localize(button.label) : void 0;\n\n   $: keepMinimized = isObject(button) && typeof button.keepMinimized === 'boolean' ? button.keepMinimized : false;\n\n   $: keyCode = isObject(button) && typeof button.keyCode === 'string' ? button.keyCode : 'Enter';\n\n   $: styles = isObject(button) && isObject(button.styles) ? button.styles : void 0;\n\n   function onClick(event)\n   {\n      // Accept `onPress or `onclick` as the function / data to invoke.\n      const invoke = button?.onPress ?? button?.onclick;\n\n      if (typeof invoke === 'function')\n      {\n         invoke.call(button, event);\n         button = button; // This provides a reactive update if button data changes.\n      }\n   }\n\n   function onContextMenu(event)\n   {\n      // Accept `onContextMenu` as the function / data to invoke.\n      const invoke = button?.onContextMenu;\n\n      if (typeof invoke === 'function')\n      {\n         invoke.call(button, event);\n         button = button; // This provides a reactive update if button data changes.\n      }\n   }\n\n   /**\n    * Consume / stop propagation of key down when key codes match.\n    *\n    * @param {KeyboardEvent}    event -\n    */\n   function onKeydown(event)\n   {\n      if (event.code === keyCode)\n      {\n         event.preventDefault();\n         event.stopPropagation();\n      }\n   }\n\n   /**\n    * Handle press event if key codes match.\n    *\n    * @param {KeyboardEvent}    event -\n    */\n   function onKeyup(event)\n   {\n      if (event.code === keyCode)\n      {\n         const invoke = button.onPress ?? button.onclick;\n\n         if (typeof invoke === 'function')\n         {\n            invoke.call(button, event);\n            button = button; // This provides a reactive update if button data changes.\n         }\n\n         event.preventDefault();\n         event.stopPropagation();\n      }\n   }\n</script>\n\n<svelte:options accessors={true}/>\n\n<!-- svelte-ignore a11y-missing-attribute -->\n<a on:click|preventDefault|stopPropagation={onClick}\n   on:contextmenu|preventDefault|stopPropagation={onContextMenu}\n   on:keydown={onKeydown}\n   on:keyup={onKeyup}\n   use:applyStyles={styles}\n   class=\"header-button {button.class}\"\n   class:keep-minimized={keepMinimized}\n   aria-label={label}\n   tabindex=0\n   role=button>\n    {@html icon}{#if label}<span class:has-icon={icon !== void 0}>{label}</span>{/if}\n</a>\n\n<style>\n   a {\n      padding: var(--tjs-app-header-button-padding, 0 3px);\n   }\n\n   a :global(i) {\n      padding: var(--tjs-app-header-button-icon-padding, 0);\n   }\n\n   a:hover {\n      text-shadow: var(--tjs-app-header-button-text-shadow-hover, var(--tjs-default-text-shadow-focus-hover, inherit));\n   }\n\n   a:focus-visible {\n      box-shadow: var(--tjs-app-header-button-box-shadow-focus-visible, var(--tjs-default-box-shadow-focus-visible));\n      outline: var(--tjs-app-header-button-outline-focus-visible, var(--tjs-default-outline-focus-visible, revert));\n      transition: var(--tjs-app-header-button-transition-focus-visible, var(--tjs-default-transition-focus-visible));\n      text-shadow: var(--tjs-app-header-button-text-shadow-focus-visible, var(--tjs-default-text-shadow-focus-hover, inherit));\n   }\n\n   span {\n      padding: var(--tjs-app-header-button-label-padding, 0);\n   }\n\n   span.has-icon {\n      padding: var(--tjs-app-header-button-label-padding, 0 0 0 3px);\n   }\n</style>\n","<script>\n   import { getContext }            from 'svelte';\n   import { cubicOut }              from 'svelte/easing';\n\n   import { isSvelteComponent }     from '@typhonjs-fvtt/runtime/svelte/util';\n   import { isObject }              from '@typhonjs-fvtt/runtime/util/object';\n\n   import { localize }              from '@typhonjs-fvtt/runtime/svelte/helper';\n\n   import {\n      draggable as dragDefault }    from '@typhonjs-fvtt/runtime/svelte/store/position';\n\n   import TJSHeaderButton           from './TJSHeaderButton.svelte';\n\n   export let draggable = void 0;\n   export let draggableOptions = void 0;\n\n   const { application } = getContext('#external');\n\n   // Focus related app options stores.\n   const { focusAuto, focusKeep } = application.reactive.storeAppOptions;\n\n   const { elementRoot } = getContext('#internal').stores;\n\n   const storeTitle = application.reactive.storeAppOptions.title;\n   const storeDraggable = application.reactive.storeAppOptions.draggable;\n   const storeDragging = application.reactive.storeUIState.dragging;\n   const storeHeaderButtons = application.reactive.storeUIState.headerButtons;\n   const storeHeaderIcon = application.reactive.storeAppOptions.headerIcon;\n   const storeHeaderNoTitleMinimized = application.reactive.storeAppOptions.headerNoTitleMinimized;\n   const storeMinimizable = application.reactive.storeAppOptions.minimizable;\n   const storeMinimized = application.reactive.storeUIState.minimized;\n\n   // These classes in the window header allow dragging.\n   const s_DRAG_TARGET_CLASSLIST = Object.freeze(['tjs-app-icon', 'tjs-window-header-spacer',\n    'window-header', 'window-title']);\n\n   let dragOptions;\n\n   $: draggable = typeof draggable === 'function' ? draggable : dragDefault;\n\n   // Combines external options with defaults for TJSApplicationHeader. By default, easing is turned on w/ duration of\n   // 0.08 seconds and cubicOut, but can be overridden by any provided `draggableOptions`. `position`, `active`, and\n   // `storeDragging` are always overridden by application position / stores.\n   $: dragOptions = Object.assign({}, { ease: true, easeOptions: { duration: 0.06, ease: cubicOut } },\n    isObject(draggableOptions) ? draggableOptions : {}, { position: application.position, active:\n     $storeDraggable, storeDragging, hasTargetClassList: s_DRAG_TARGET_CLASSLIST });\n\n   let displayHeaderTitle;\n\n   $: displayHeaderTitle = $storeHeaderNoTitleMinimized && $storeMinimized ? 'none' : null;\n\n   let buttonsLeft;\n   let buttonsRight;\n\n   $:\n   {\n      buttonsLeft = [];\n      buttonsRight = [];\n\n      for (const button of $storeHeaderButtons)\n      {\n         const buttonsList = typeof button?.alignLeft === 'boolean' && button?.alignLeft ? buttonsLeft : buttonsRight;\n\n         // If the button is a Svelte component set it as the class otherwise use `TJSHeaderButton` w/ button as props.\n         buttonsList.push(isSvelteComponent(button) ? { class: button, props: {} } :\n          { class: TJSHeaderButton, props: { button } });\n      }\n   }\n\n   function minimizable(node, booleanStore)\n   {\n      const callback = (event) =>\n      {\n         // Only toggle minimize state if window title or header is the event target. Also allow toggle state if the\n         // event target has 'keep-minimized' class.\n         if (event.target.classList.contains('window-title') || event.target.classList.contains('window-header') ||\n           event.target.classList.contains('keep-minimized'))\n         {\n            application._onToggleMinimize(event);\n         }\n      }\n\n      function activateListeners() { node.addEventListener('dblclick', callback); }\n      function removeListeners() { node.removeEventListener('dblclick', callback); }\n\n      if (booleanStore) { activateListeners(); }\n\n      return {\n         update: (booleanStore) =>  // eslint-disable-line no-shadow\n         {\n            if (booleanStore) { activateListeners(); }\n            else { removeListeners(); }\n         },\n\n         destroy: () => removeListeners()\n      };\n   }\n\n   /**\n    * Explicitly focus `elementRoot` if pointer event is not consumed by header buttons / components. This allows\n    * keyboard tab navigation to select header buttons.\n    *\n    * Note: if `focusKeep` app option store is set to true `elementRoot` is only focused if the current browser wide\n    * active element is not contained inside the app element.\n    */\n   function onPointerdown(event)\n   {\n      const rootEl = $elementRoot;\n\n      if ($focusAuto && rootEl instanceof HTMLElement && rootEl?.isConnected)\n      {\n         if ($focusKeep)\n         {\n            const focusOutside = document.activeElement instanceof HTMLElement &&\n             !rootEl.contains(document.activeElement);\n\n            // Only focus the content element if the active element is outside the app; maintaining internal focused\n            // element.\n            if (focusOutside)\n            {\n               rootEl.focus();\n            }\n            else\n            {\n               event.preventDefault();\n            }\n         }\n         else\n         {\n            rootEl.focus();\n         }\n      }\n   }\n</script>\n\n{#key draggable}\n   <header class=\"window-header flexrow\"\n           use:draggable={dragOptions}\n           use:minimizable={$storeMinimizable}\n           on:pointerdown={onPointerdown}>\n      {#if typeof $storeHeaderIcon === 'string'}\n         <img class=\"tjs-app-icon keep-minimized\" src={$storeHeaderIcon} alt=icon>\n      {/if}\n      <h4 class=window-title style:display={displayHeaderTitle}>\n         {localize($storeTitle)}\n      </h4>\n      {#each buttonsLeft as button}\n         <svelte:component this={button.class} {...button.props} />\n      {/each}\n      <span class=\"tjs-window-header-spacer keep-minimized\" />\n      {#each buttonsRight as button}\n         <svelte:component this={button.class} {...button.props} />\n      {/each}\n   </header>\n{/key}\n\n<style>\n   /**\n    * Provides a zero space element that expands to the right creating the gap between window title and left aligned\n    * buttons and right aligned buttons. Note the use of a negative left margin to remove the gap between elements.\n    */\n   .tjs-window-header-spacer {\n      flex: 0;\n      margin-left: calc(-1 * var(--tjs-app-header-gap, 5px));\n      margin-right: auto;\n   }\n\n   .window-header {\n      flex: var(--tjs-app-header-flex, 0 0 30px);\n      gap: var(--tjs-app-header-gap, 5px);\n      padding: var(--tjs-app-header-padding, 0 4px);\n   }\n\n   .window-header .tjs-app-icon {\n      align-self: center;\n      border-radius: var(--tjs-app-header-icon-border-radius, 4px);\n      flex: 0 0 var(--tjs-app-header-icon-width, 24px);\n      height: var(--tjs-app-header-icon-height, 24px);\n   }\n\n   .window-title {\n      gap: var(--tjs-app-header-gap, 5px);\n      max-width: fit-content;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n   }\n</style>\n","<script>\n   import { A11yHelper }    from '@typhonjs-fvtt/runtime/util/browser';\n\n   /** @type {HTMLElement} */\n   export let elementRoot = void 0;\n\n   /** @type {boolean} */\n   export let enabled = true;\n\n   let ignoreElements, wrapEl;\n\n   $: if (wrapEl) { ignoreElements = new Set([wrapEl]); }\n\n   function onFocus()\n   {\n      // Early out if not enabled.\n      if (!enabled) { return; }\n\n      if (elementRoot instanceof HTMLElement)\n      {\n         const firstFocusEl = A11yHelper.getFirstFocusableElement(elementRoot, ignoreElements);\n\n         if (firstFocusEl instanceof HTMLElement && firstFocusEl !== wrapEl)\n         {\n            firstFocusEl.focus();\n         }\n         else\n         {\n            // No focus target found, so focus elementRoot.\n            elementRoot.focus();\n         }\n      }\n   }\n</script>\n\n<!-- svelte-ignore a11y-no-noninteractive-tabindex -->\n<div bind:this={wrapEl} class=tjs-focus-wrap tabindex=0 on:focus={onFocus} />\n\n<style>\n    div {\n        width: 0;\n        height: 0;\n        flex: 0;\n    }\n\n    div:focus {\n        outline: none;\n    }\n</style>\n","<script>\n   import { getContext }         from 'svelte';\n\n   export let isResizable = false;\n\n   const application = getContext('#external').application;\n\n   // Allows retrieval of the element root at runtime.\n   const storeElementRoot = getContext('#internal').stores.elementRoot;\n\n   const storeResizable = application.reactive.storeAppOptions.resizable;\n\n   const storeMinimized = application.reactive.storeUIState.minimized;\n   const storeResizing = application.reactive.storeUIState.resizing;\n\n   let elementResize;\n\n   $: if (elementResize)\n   {\n      // Instead of creating a derived store it is easier to use isResizable and the minimized store below.\n      elementResize.style.display = isResizable && !$storeMinimized ? 'block' : 'none';\n\n      // Add / remove `resizable` class from element root.\n      const elementRoot = $storeElementRoot;\n      if (elementRoot) { elementRoot.classList[isResizable ? 'add' : 'remove']('resizable'); }\n   }\n\n   /**\n    * Provides an action to handle resizing the application shell based on the resizable app option.\n    *\n    * @param {HTMLElement}       node - The node associated with the action.\n    *\n    * @param {object}            [opts] - Optional parameters.\n    *\n    * @param {boolean}           [opts.active=true] - A boolean value; attached to a readable store.\n    *\n    * @param {Writable<boolean>} [opts.storeResizing] - A writable store that tracks \"resizing\" state.\n    *\n    * @returns {{update: Function, destroy: Function}} The action lifecycle methods.\n    */\n   function resizable(node, { active = true, storeResizing = void 0 } = {})\n   {\n      /**\n       * Duplicate the app / Positionable starting position to track differences.\n       *\n       * @type {object}\n       */\n      let position = null;\n\n      /**\n       * Stores the initial X / Y on drag down.\n       *\n       * @type {object}\n       */\n      let initialPosition = {};\n\n      /**\n       * Stores the current resizing state and gates the move pointer as the resizing store is not\n       * set until the first pointer move.\n       *\n       * @type {boolean}\n       */\n      let resizing = false;\n\n      /**\n       * Remember event handlers associated with this action so they may be later unregistered.\n       *\n       * @type {Object}\n       */\n      const handlers = {\n         resizeDown: ['pointerdown', (e) => onResizePointerDown(e), false],\n         resizeMove: ['pointermove', (e) => onResizePointerMove(e), false],\n         resizeUp: ['pointerup', (e) => onResizePointerUp(e), false]\n      };\n\n      /**\n       * Activates listeners.\n       */\n      function activateListeners()\n      {\n         // Resize handlers\n         node.addEventListener(...handlers.resizeDown);\n\n         isResizable = true;\n\n         node.style.display = 'block';\n      }\n\n      /**\n       * Removes listeners.\n       */\n      function removeListeners()\n      {\n         if (typeof storeResizing?.set === 'function') { storeResizing.set(false); }\n\n         // Resize handlers\n         node.removeEventListener(...handlers.resizeDown);\n         node.removeEventListener(...handlers.resizeMove);\n         node.removeEventListener(...handlers.resizeUp);\n\n         node.style.display = 'none';\n\n         isResizable = false;\n      }\n\n      // On mount if resizable is true then activate listeners otherwise set element display to `none`.\n      if (active)\n      {\n         activateListeners();\n      }\n      else\n      {\n         node.style.display = 'none';\n      }\n\n      /**\n       * Handle the initial pointer down that activates resizing capture.\n       */\n      function onResizePointerDown(event)\n      {\n         event.preventDefault();\n\n         resizing = false;\n\n         // Record initial position\n         position = application.position.get();\n\n         if (position.height === 'auto') { position.height = $storeElementRoot.clientHeight; }\n         if (position.width === 'auto') { position.width = $storeElementRoot.clientWidth; }\n\n         initialPosition = { x: event.clientX, y: event.clientY };\n\n         // Add temporary handlers\n         node.addEventListener(...handlers.resizeMove);\n         node.addEventListener(...handlers.resizeUp);\n\n         node.setPointerCapture(event.pointerId);\n      }\n\n      /**\n       * Sets the width / height of the positionable application.\n       */\n      function onResizePointerMove(event)\n      {\n         event.preventDefault();\n\n         if (!resizing && typeof storeResizing?.set === 'function')\n         {\n            resizing = true;\n            storeResizing.set(true);\n         }\n\n         application.position.set({\n            width: position.width + (event.clientX - initialPosition.x),\n            height: position.height + (event.clientY - initialPosition.y)\n         });\n      }\n\n      /**\n       * Conclude the dragging behavior when the pointer is released setting the final position and\n       * removing listeners.\n       */\n      function onResizePointerUp(event)\n      {\n         resizing = false;\n         if (typeof storeResizing?.set === 'function') { storeResizing.set(false); }\n\n         event.preventDefault();\n         node.removeEventListener(...handlers.resizeMove);\n         node.removeEventListener(...handlers.resizeUp);\n\n         // TODO: Direct Foundry API access.\n         application?._onResize?.(event);\n      }\n\n      return {\n         update: ({ active }) =>  // eslint-disable-line no-shadow\n         {\n            if (active) { activateListeners(); }\n            else { removeListeners(); }\n         },\n\n         destroy: () => removeListeners()\n      };\n   }\n\n</script>\n\n<div class=\"window-resizable-handle\"\n     use:resizable={{active: $storeResizable, storeResizing}}\n     bind:this={elementResize}>\n   <i class=\"fas fa-arrows-alt-h\"></i>\n</div>\n\n<style>\n   .window-resizable-handle {\n      display: block;\n      position: absolute;\n      width: var(--tjs-app-resizable-handle-width, 20px);\n      height: var(--tjs-app-resizable-handle-height, 20px);\n      top: var(--tjs-app-resizable-handle-top, unset);\n      bottom: var(--tjs-app-resizable-handle-bottom, -1px);\n      right: var(--tjs-app-resizable-handle-right, 0);\n      left: var(--tjs-app-resizable-handle-left, unset);\n      background: var(--tjs-app-resizable-handle-background, #444);\n      border: var(--tjs-app-resizable-handle-border, 1px solid #111);\n      border-radius: var(--tjs-app-resizable-handle-border-radius, 4px 0 0 0);\n      padding: var(--tjs-app-resizable-handle-padding, 2px);\n   }\n\n   .fa-arrows-alt-h {\n      color: var(--tjs-app-resizable-handle-icon-color, #f0f0e0);\n      transform: var(--tjs-app-resizable-handle-icon-transform, rotate(45deg));\n   }\n</style>\n","<script>\n   /**\n    * Provides an application shell is a main top level slotted component that provides a reactive\n    * outer wrapper and header bar for the main content component.\n    */\n\n   import {\n      getContext,\n      onMount,\n      setContext }                     from 'svelte';\n\n   import {\n      applyStyles,\n      resizeObserver }                 from '@typhonjs-fvtt/runtime/svelte/action/dom';\n\n   import { TJSDefaultTransition }     from '@typhonjs-fvtt/runtime/svelte/transition';\n   import { A11yHelper }               from '@typhonjs-fvtt/runtime/util/browser';\n   import { isObject }                 from '@typhonjs-fvtt/runtime/util/object';\n\n   import { AppShellContextInternal }  from './AppShellContextInternal.js';\n   import TJSApplicationHeader         from './TJSApplicationHeader.svelte';\n   import TJSFocusWrap                 from './TJSFocusWrap.svelte';\n   import ResizableHandle              from './ResizableHandle.svelte';\n\n   // Bound to the content and root elements. Can be used by parent components. SvelteApplication will also\n   // use 'elementRoot' to set the element of the Application. You can also provide `elementContent` and\n   // `elementTarget`. Please see SvelteApplication lifecycle documentation.\n   export let elementContent = void 0;\n   export let elementRoot = void 0;\n\n   // Allows custom draggable implementations to be forwarded to TJSApplicationHeader.\n   export let draggable = void 0;\n   export let draggableOptions = void 0;\n\n   // The children array can be specified by a parent via prop or is read below from the external context.\n   // export let children = void 0;\n\n   // Explicit style overrides for the main app and content elements. Uses action `applyStyles`.\n   export let stylesApp = void 0;\n   export let stylesContent = void 0;\n\n   // If a parent component binds and sets `appOffsetHeight` to true then a resizeObserver action is enabled on the\n   // outer application `div`. Additionally, the SvelteApplication position resizeObserved store is updated.\n   export let appOffsetHeight = false;\n   export let appOffsetWidth = false;\n\n   // Set to `resizeObserver` if either of the above props are truthy otherwise a null operation.\n   const appResizeObserver = !!appOffsetHeight || !!appOffsetWidth ? resizeObserver : () => null;\n\n   // If a parent component binds and sets `contentOffsetHeight` or `contentOffsetWidth` to true then a\n   // resizeObserver action is enabled on the content `section`.\n   export let contentOffsetHeight = false;\n   export let contentOffsetWidth = false;\n\n   // Set to `resizeObserver` if either of the above props are truthy otherwise a null operation.\n   const contentResizeObserver = !!contentOffsetHeight || !!contentOffsetWidth ? resizeObserver : () => null;\n\n   // Provides the internal context for data / stores of the application shell.\n   const internal = new AppShellContextInternal();\n\n   // Provides options to `A11yHelper.getFocusableElements` to ignore TJSFocusWrap by CSS class.\n   const s_IGNORE_CLASSES = { ignoreClasses: ['tjs-focus-wrap'] };\n\n   // Internal context for `elementContent` / `elementRoot` stores.\n   setContext('#internal', internal);\n\n   // Only update the `elementContent` store if the new `elementContent` is not null or undefined.\n   $: if (elementContent !== void 0 && elementContent !== null)\n   {\n      getContext('#internal').stores.elementContent.set(elementContent);\n   }\n\n   // Only update the `elementRoot` store if the new `elementRoot` is not null or undefined.\n   $: if (elementRoot !== void 0 && elementRoot !== null)\n   {\n      getContext('#internal').stores.elementRoot.set(elementRoot);\n   }\n\n   // Store application reference.\n   const { application } = getContext('#external');\n\n   // Focus related app options stores.\n   const { focusAuto, focusKeep, focusTrap } = application.reactive.storeAppOptions;\n\n   const { minimized } = application.reactive.storeUIState;\n\n   let focusWrapEnabled;\n\n   // Enable TJSFocusWrap component when focus trapping app option is true and app is not minimized.\n   $: focusWrapEnabled = $focusAuto && $focusTrap && !$minimized;\n\n   // ---------------------------------------------------------------------------------------------------------------\n\n   // The following block is somewhat complex, but allows transition options to be updated reactively during\n   // runtime execution.\n\n   // Exports properties to set a transition w/ in / out options.\n   export let transition = TJSDefaultTransition.default;\n   export let inTransition = TJSDefaultTransition.default;\n   export let outTransition = TJSDefaultTransition.default;\n\n   // Exports properties to set options for any transitions.\n   export let transitionOptions = void 0;\n   export let inTransitionOptions = TJSDefaultTransition.options;\n   export let outTransitionOptions = TJSDefaultTransition.options;\n\n   // Tracks last transition state.\n   let oldTransition = TJSDefaultTransition.default;\n   let oldTransitionOptions = void 0\n\n   // Run this reactive block when the last transition state is not equal to the current state.\n   $: if (oldTransition !== transition)\n   {\n      // If transition is defined and not the default transition then set it to both in and out transition otherwise\n      // set the default transition to both in & out transitions.\n      const newTransition = typeof transition === 'function' ? transition : TJSDefaultTransition.default;\n\n      inTransition = newTransition;\n      outTransition = newTransition;\n\n      oldTransition = newTransition;\n   }\n\n   // Run this reactive block when the last transition options state is not equal to the current options state.\n   $: if (oldTransitionOptions !== transitionOptions)\n   {\n      const newOptions = transitionOptions !== TJSDefaultTransition.options && isObject(transitionOptions) ?\n       transitionOptions : TJSDefaultTransition.options;\n\n      inTransitionOptions = newOptions;\n      outTransitionOptions = newOptions;\n\n      oldTransitionOptions = newOptions;\n   }\n\n   // Handle cases if inTransition is unset; assign noop default transition function.\n   $: if (typeof inTransition !== 'function') { inTransition = TJSDefaultTransition.default; }\n\n   $:\n   {\n      // Handle cases if outTransition is unset; assign noop default transition function.\n      if (typeof outTransition !== 'function') { outTransition = TJSDefaultTransition.default; }\n\n      // Set close animation to `false` / not run when an out transition is defined.\n      const defaultCloseAnimation = application?.options?.defaultCloseAnimation;\n      if (typeof defaultCloseAnimation === 'boolean' && defaultCloseAnimation &&\n       outTransition !== TJSDefaultTransition.default)\n      {\n         application.options.defaultCloseAnimation = false;\n      }\n   }\n\n   // Handle cases if inTransitionOptions is unset; assign empty default transition options.\n   $: if (!isObject(inTransitionOptions)) { inTransitionOptions = TJSDefaultTransition.options; }\n\n   // Handle cases if outTransitionOptions is unset; assign empty default transition options.\n   $: if (!isObject(outTransitionOptions)) { outTransitionOptions = TJSDefaultTransition.options; }\n\n   // ---------------------------------------------------------------------------------------------------------------\n\n   // Focus `elementRoot` on mount to allow keyboard tab navigation of header buttons.\n   onMount(() => elementRoot.focus());\n\n   // ---------------------------------------------------------------------------------------------------------------\n\n   /**\n    * Provides a handler for the custom `close:popup` event fired by `svelte-standard` components like TJSMenu. The\n    * intention is to handle focus management of a component that is no longer connected in the DOM. If a target element\n    * that is the source of the close event is attached attempt to resolve internal focus to the application.\n    *\n    * @param {CustomEvent}  event - A custom event for `close:popup`.\n    */\n   function onClosePopup(event)\n   {\n      // Early out as automatic focus management is not enabled.\n      if (!$focusAuto) { return; }\n\n      const targetEl = event?.detail?.target;\n\n      // Early out if there is no target element.\n      if (!(targetEl instanceof HTMLElement)) { return; }\n\n      // Early out if the target element is focusable as it will gain focus naturally.\n      if (A11yHelper.isFocusable(targetEl)) { return; }\n\n      const elementRootContains = elementRoot.contains(targetEl);\n\n      // First check for if the target is elementRoot or elementContent then fallback to contains checks.\n      if (targetEl === elementRoot)\n      {\n         elementRoot.focus();\n      }\n      else if (targetEl === elementContent)\n      {\n         elementContent.focus();\n      }\n      else if (elementRootContains)\n      {\n         if (elementContent.contains(targetEl))\n         {\n            elementContent.focus();\n         }\n         else\n         {\n            elementRoot.focus();\n         }\n      }\n   }\n\n   /**\n    * Provides focus cycling inside the application capturing `<Shift-Tab>` and if `elementRoot` or `firstFocusEl` is\n    * the actively focused element then last focusable element is focused skipping `TJSFocusWrap`.\n    *\n    * Also, if a popout app all key down events will bring this application to the top such that when focus is trapped\n    * the app is top most.\n    *\n    * @param {KeyboardEvent} event - Keyboard Event.\n    */\n   function onKeydown(event)\n   {\n      // TODO: Note this handling is specifically for Foundry v11+ as the platform KeyboardManager uses\n      // `document.querySelector(':focus')` to short circuit keyboard handling internally to KeyboardManager.\n      // ApplicationShell manages containing focus programmatically and this prevents the Foundry KeyboardManager from\n      // activating. We need to check if this key event target is currently the `elementRoot` or `elementContent` and\n      // the event matches any KeyboardManager actions and if so blur current focus.\n      if ((event.target === elementRoot || event.target === elementContent) &&\n       KeyboardManager && KeyboardManager?._getMatchingActions?.(\n        KeyboardManager?.getKeyboardEventContext?.(event))?.length)\n      {\n         event.target?.blur();\n         return;\n      }\n\n      if (focusWrapEnabled && event.shiftKey && event.code === 'Tab')\n      {\n         // Collect all focusable elements from `elementRoot` and ignore TJSFocusWrap.\n         const allFocusable = A11yHelper.getFocusableElements(elementRoot, s_IGNORE_CLASSES);\n\n         // Find first and last focusable elements.\n         const firstFocusEl = allFocusable.length > 0 ? allFocusable[0] : void 0;\n         const lastFocusEl = allFocusable.length > 0 ? allFocusable[allFocusable.length - 1] : void 0;\n\n         // Only cycle focus to the last keyboard focusable app element if `elementRoot` or first focusable element\n         // is the active element.\n         if (elementRoot === document.activeElement || firstFocusEl === document.activeElement)\n         {\n            if (lastFocusEl instanceof HTMLElement && firstFocusEl !== lastFocusEl) { lastFocusEl.focus(); }\n\n            event.preventDefault();\n            event.stopPropagation();\n         }\n      }\n\n      // Make sure this application is top most when it receives keyboard events.\n      if (typeof application?.options?.popOut === 'boolean' && application.options.popOut &&\n       application !== globalThis.ui?.activeWindow)\n      {\n         application.bringToTop.call(application);\n      }\n   }\n\n   /**\n    * If the application is a popOut application then when clicked bring to top if not already the Foundry\n    * `activeWindow`.\n    */\n   function onPointerdownApp()\n   {\n      if (typeof application?.options?.popOut === 'boolean' && application.options.popOut &&\n       application !== globalThis.ui?.activeWindow)\n      {\n         application.bringToTop.call(application);\n      }\n   }\n\n   /**\n    * Focus `elementContent` if the event target is not focusable and `focusAuto` is enabled.\n    *\n    * Note: `focusAuto` is an app option store. This check is a bit tricky as `section.window-content` has a tabindex\n    * of '-1', so it is focusable manually.\n    */\n   function onPointerdownContent(event)\n   {\n      const focusable = A11yHelper.isFocusable(event.target);\n\n      if (!focusable && $focusAuto)\n      {\n         if ($focusKeep)\n         {\n            const focusOutside = document.activeElement instanceof HTMLElement &&\n             !elementRoot.contains(document.activeElement);\n\n            // Only focus the content element if the active element is outside the app; maintaining internal focused\n            // element.\n            if (focusOutside)\n            {\n               elementContent.focus();\n            }\n            else\n            {\n               event.preventDefault();\n            }\n         }\n         else\n         {\n            elementContent.focus();\n         }\n      }\n   }\n\n   /**\n    * Callback for content resizeObserver action. This is enabled when contentOffsetHeight or contentOffsetWidth is\n    * bound.\n    *\n    * @param {number}   offsetWidth - Observed offsetWidth.\n    *\n    * @param {number}   offsetHeight - Observed offsetHeight\n    */\n   function resizeObservedContent(offsetWidth, offsetHeight)\n   {\n      contentOffsetWidth = offsetWidth;\n      contentOffsetHeight = offsetHeight;\n   }\n\n   /**\n    * Callback for app resizeObserver action. This is enabled when appOffsetHeight or appOffsetWidth is\n    * bound. Additionally, the Application position resizeObserved store is updated.\n    *\n    * @param {number}   contentWidth - Observed contentWidth.\n    * @param {number}   contentHeight - Observed contentHeight\n    * @param {number}   offsetWidth - Observed offsetWidth.\n    * @param {number}   offsetHeight - Observed offsetHeight\n    */\n   function resizeObservedApp(offsetWidth, offsetHeight, contentWidth, contentHeight)\n   {\n      application.position.stores.resizeObserved.update((object) =>\n      {\n         object.contentWidth = contentWidth;\n         object.contentHeight = contentHeight;\n         object.offsetWidth = offsetWidth;\n         object.offsetHeight = offsetHeight;\n\n         return object;\n      });\n\n      appOffsetHeight = offsetHeight;\n      appOffsetWidth = offsetWidth;\n   }\n\n   /**\n    * Transitions can cause side effects. Work around this issue by using an if conditional.\n    * Due to timing issues and the onDestroy / outro transitions can cause elementRoot / elementContent to be set to\n    * null when swapped dynamically. There is a feature request to allow transition functions to be undefined:\n    *\n    * @see: https://github.com/sveltejs/svelte/issues/6942\n    */\n</script>\n\n<svelte:options accessors={true}/>\n\n{#if inTransition !== TJSDefaultTransition.default || outTransition !== TJSDefaultTransition.default}\n   <!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\n   <div id={application.id}\n        class=\"app window-app {application.options.classes.join(' ')}\"\n        data-appid={application.appId}\n        bind:this={elementRoot}\n        in:inTransition|global={inTransitionOptions}\n        out:outTransition|global={outTransitionOptions}\n        on:close:popup|preventDefault|stopPropagation={onClosePopup}\n        on:keydown|capture={onKeydown}\n        on:pointerdown={onPointerdownApp}\n        use:applyStyles={stylesApp}\n        use:appResizeObserver={resizeObservedApp}\n        role=application\n        tabindex=-1>\n      <TJSApplicationHeader {draggable} {draggableOptions} />\n      <section class=window-content\n               bind:this={elementContent}\n               on:pointerdown={onPointerdownContent}\n               use:applyStyles={stylesContent}\n               use:contentResizeObserver={resizeObservedContent}\n               tabindex=-1>\n         <slot />\n      </section>\n      <ResizableHandle />\n      <TJSFocusWrap {elementRoot} />\n   </div>\n{:else}\n   <!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\n   <div id={application.id}\n        class=\"app window-app {application.options.classes.join(' ')}\"\n        data-appid={application.appId}\n        bind:this={elementRoot}\n        on:close:popup|preventDefault|stopPropagation={onClosePopup}\n        on:keydown|capture={onKeydown}\n        on:pointerdown={onPointerdownApp}\n        use:applyStyles={stylesApp}\n        use:appResizeObserver={resizeObservedApp}\n        role=application\n        tabindex=-1>\n      <TJSApplicationHeader {draggable} {draggableOptions} />\n      <section class=window-content\n               bind:this={elementContent}\n               on:pointerdown={onPointerdownContent}\n               use:applyStyles={stylesContent}\n               use:contentResizeObserver={resizeObservedContent}\n               tabindex=-1>\n         <slot />\n      </section>\n      <ResizableHandle />\n      <TJSFocusWrap {elementRoot} enabled={focusWrapEnabled} />\n   </div>\n{/if}\n\n<style>\n   /* Note: this is different than stock Foundry and allows rounded corners from .app core styles */\n   .window-app {\n      overflow: var(--tjs-app-overflow, hidden);\n   }\n\n   .window-app:focus-visible {\n      outline: var(--tjs-app-outline-focus-visible, var(--tjs-default-a11y-outline-focus-visible, 2px solid transparent));\n   }\n\n   .window-content:focus-visible {\n      outline: var(--tjs-app-content-outline-focus-visible, var(--tjs-default-a11y-outline-focus-visible, 2px solid transparent));\n   }\n\n   /* Override Foundry default; adjust --tjs-app-header-gap to change gap size */\n   .window-app :global(.window-header a) {\n      flex: none;\n      margin: 0;\n   }\n\n   /* Override Foundry default; See TJSHeaderButton for CSS variables */\n   .window-app :global(.window-header i[class^=fa]) {\n      margin: 0\n   }\n</style>\n","<script>\n   /**\n    * TODO: Documentation!\n    */\n   import {\n      getContext,\n      onDestroy,\n      onMount }               from 'svelte';\n\n   import { applyStyles }     from '@typhonjs-fvtt/runtime/svelte/action/dom';\n\n   import {\n      isSvelteComponent,\n      parseTJSSvelteConfig }  from '@typhonjs-fvtt/runtime/svelte/util';\n\n   import { A11yHelper }      from '@typhonjs-fvtt/runtime/util/browser';\n   import { isObject }        from '@typhonjs-fvtt/runtime/util/object';\n\n   import { localize }        from '@typhonjs-fvtt/runtime/svelte/helper';\n\n   export let data = void 0;\n   export let preventDefault = false;\n   export let stopPropagation = false;\n\n   export let dialogComponent = void 0;\n\n   const s_REGEX_HTML = /^\\s*<.*>$/;\n\n   let buttons;\n\n   /** @type {HTMLDivElement} */\n   let contentEl;\n\n   /** @type {HTMLDivElement} */\n   let buttonsEl;\n\n   let content = void 0;\n   let dialogClass;\n   let dialogProps = {};\n\n   let { elementRoot } = getContext('#internal').stores;\n\n   let { application } = getContext('#external');\n\n   let managedPromise = getContext('#managedPromise');\n\n   let currentButtonId = data.default;\n\n   // Remove key listeners from elementRoot.\n   onDestroy(() =>\n   {\n      const rootEl = $elementRoot;\n      if (rootEl instanceof HTMLElement)\n      {\n         rootEl.removeEventListener('keydown', onKeydown)\n         rootEl.removeEventListener('keyup', onKeyup)\n      }\n   })\n\n   // If `focusFirst` is true then focus first focusable element iin dialog content.\n   onMount(() =>\n   {\n      if (focusFirst)\n      {\n         const focusEl = A11yHelper.getFirstFocusableElement(contentEl);\n\n         if (focusEl instanceof HTMLElement)\n         {\n            // Focus on next tick to allow application / dialog to mount to bypass ApplicationShell onMount focus\n            // handling.\n            setTimeout(() => focusEl.focus(), 0);\n         }\n      }\n   });\n\n   // Add key listeners to elementRoot when it is bound.\n   $: if ($elementRoot)\n   {\n      const rootEl = $elementRoot;\n      if (rootEl instanceof HTMLElement)\n      {\n         rootEl.addEventListener('keydown', onKeydown)\n         rootEl.addEventListener('keyup', onKeyup)\n      }\n   }\n\n   // Automatically close the dialog on button click handler completion.\n   $: autoClose = typeof data.autoClose === 'boolean' ? data.autoClose : true;\n\n   // When true the first focusable element that isn't a button is focused.\n   $: focusFirst = typeof data.focusFirst === 'boolean' ? data.focusFirst : false;\n\n   // Focus current button when `buttonsEl` is bound.\n   $: if (!focusFirst && buttonsEl instanceof HTMLElement)\n   {\n      const buttonEl = buttonsEl.querySelector(`.${currentButtonId}`);\n      if (buttonEl instanceof HTMLElement) { buttonEl.focus(); }\n   }\n\n   // When false the dialog does not automatically close when button selected.\n   $: resolveId = typeof data.resolveId === 'boolean' ? data.resolveId : false;\n\n   // If `data.buttons` is not an object then set an empty array otherwise reduce the button data.\n   $:\n   {\n      buttons = !isObject(data.buttons) ? [] : Object.keys(data.buttons).reduce((array, key) =>\n      {\n         const b = data.buttons[key];\n\n         // Handle icon and treat bare strings as the icon class; otherwise assume the icon is fully formed HTML.\n         const icon = typeof b.icon !== 'string' ? void 0 : s_REGEX_HTML.test(b.icon) ? b.icon :\n          `<i class=\"${b.icon}\"></i>`;\n\n         const autoClose = typeof b.autoClose === 'boolean' ? b.autoClose : true;\n\n         const disabled = typeof b.disabled === 'boolean' ? b.disabled : false;\n\n         const label = typeof b.label === 'string' ? `${icon !== void 0 ? ' ' : ''}${localize(b.label)}` : '';\n\n         const title = typeof b.title === 'string' ? localize(b.title) : void 0;\n\n         // Test any condition supplied otherwise default to true.\n         const condition = typeof b.condition === 'function' ? b.condition.call(b) : b.condition ?? true;\n\n         if (condition) { array.push({ ...b, id: key, autoClose, icon, label, title, disabled }); }\n\n         return array;\n      }, []);\n   }\n\n   /**\n    * This reactivity block will trigger on arrow left / right key presses _and_ when buttons change. It is OK for it to\n    * trigger on both.\n    */\n   $: if (!buttons.find((button) => button.id === currentButtonId)) { currentButtonId = void 0; }\n\n   $: if (content !== data.content) // Only update the content if it has changed.\n   {\n      content = data.content;\n\n      try\n      {\n         if (isSvelteComponent(content))\n         {\n            dialogClass = content;\n            dialogProps = {};\n         }\n         else if (isObject(content))\n         {\n            const svelteConfig = parseTJSSvelteConfig(content, application);\n            dialogClass = svelteConfig.class;\n            dialogProps = svelteConfig.props ?? {};\n\n            // Check for any children parsed and added to the external context.\n            const children = svelteConfig?.context?.get('external')?.children;\n\n            // If so add to dialogProps.\n            if (Array.isArray(children)) { dialogProps.children = children; }\n         }\n         else\n         {\n            dialogClass = void 0;\n            dialogProps = {};\n         }\n      }\n      catch (err)\n      {\n         dialogClass = void 0;\n         dialogProps = {};\n\n         content = err.message;\n         console.error(err);\n      }\n   }\n\n   /**\n    * Handle button click.\n    *\n    * @param {object}   button - button data.\n    *\n    * TODO: When app eventbus is available send event for UI notification instead of Foundry API usage.\n    *\n    * @returns {*}\n    */\n   function onClick(button)\n   {\n      try\n      {\n         let result = void 0;\n\n         const callback = button?.onPress;\n\n         switch (typeof callback)\n         {\n            case 'function':\n               // Pass back the TJSDialog instance.\n               result = callback(application);\n               break;\n\n            case 'string':\n               // Attempt lookup by function name in dialog instance component.\n               if (dialogComponent !== void 0 && typeof dialogComponent[callback] === 'function')\n               {\n                  result = dialogComponent[callback](application);\n               }\n               else\n               {\n                  if (dialogComponent === void 0)\n                  {\n                     console.warn(`[TRL] TJSDialog warning: 'onPress' defined as a string with no associated ` +\n                      `content Svelte component.`);\n                  }\n                  else if (typeof dialogComponent?.[callback] !== 'function')\n                  {\n                     console.warn(`[TRL] TJSDialog warning: The content Svelte component does not contain an ` +\n                      `associated function '${callback}'. Did you remember to add ` +\n                       `'<svelte:options accessors={true} />' and export the function?`);\n                  }\n               }\n               break;\n         }\n\n         // By default, both 'button.autoClose' & autoClose are true, so skip auto-closing when either is false.\n         if (button.autoClose && autoClose)\n         {\n            // If `resolveId` dialog option is true and current result is undefined then set result to the button ID.\n            if (resolveId && result === void 0) { result = button.id; }\n\n            managedPromise.resolve(result);\n         }\n      }\n      catch(err)\n      {\n         const notifyError = typeof data.notifyError === 'boolean' ? data.notifyError : true;\n         if (notifyError)\n         {\n            // TODO: When app eventbus is available send event for UI notification instead of Foundry API usage.\n            globalThis.ui.notifications.error(err, { console: false });\n         }\n\n         // Attempt to first reject the error with any current managed Promise otherwise rethrow error.\n         if (!managedPromise.reject(err)) { throw err; }\n      }\n      finally\n      {\n         // By default, both 'button.autoClose' & autoClose are true, so skip auto-closing when either is false.\n         if (button.autoClose && autoClose) { application.close(); }\n      }\n   }\n\n   /**\n    * Handles key down events for stopping propagation for arrow keys. Also handles tab / focus traversal with a timeout\n    * to update `currentButtonId` on the next clock tick comparing against `document.activeElement`.\n    *\n    * @param {KeyboardEvent}  event - A KeyboardEvent.\n    */\n   function onKeydown(event)\n   {\n      switch (event.code)\n      {\n         case 'ArrowLeft':\n         case 'ArrowRight':\n         case 'Enter':\n            event.stopPropagation();\n            break;\n\n         case 'Tab':\n            event.stopPropagation();\n\n            // Check `activeElement` on next tick to potentially update `currentButtonId` from tab / keyboard\n            // navigation.\n            setTimeout(() =>\n            {\n               const activeElement = document.activeElement;\n               if (activeElement instanceof HTMLElement && buttonsEl instanceof HTMLElement &&\n                buttonsEl.contains(activeElement))\n               {\n                  // Find class that isn't `dialog-button` or `default` and is a key in `data.buttons`.\n                  for (let cntr = 0; cntr < activeElement.classList.length; cntr++)\n                  {\n                     const item = activeElement.classList.item(cntr);\n                     if (item !== 'dialog-button' && item !== 'default' && typeof data.buttons[item] !== void 0)\n                     {\n                        currentButtonId = item;\n                        break;\n                     }\n                  }\n               }\n            }, 0);\n            break;\n\n         default:\n            if (preventDefault) { event.preventDefault(); }\n            if (stopPropagation) { event.stopPropagation(); }\n            break;\n      }\n   }\n\n   /**\n    * Handles key up events for arrow key button navigation.\n    *\n    * @param {KeyboardEvent}  event - A KeyboardEvent.\n    */\n   function onKeyup(event)\n   {\n      switch (event.code)\n      {\n         case 'ArrowLeft':\n         {\n            event.preventDefault();\n            event.stopPropagation();\n\n            const activeEl = document.activeElement;\n\n            if (buttonsEl instanceof HTMLElement)\n            {\n               // Only advance button via arrow key if a button is already focused.\n               if (activeEl instanceof HTMLElement && buttonsEl.contains(activeEl))\n               {\n                  const currentIndex = buttons.findIndex((button) => button.id === currentButtonId);\n                  if (buttons.length && currentIndex > 0) { currentButtonId = buttons[currentIndex - 1].id; }\n               }\n\n               const buttonEl = buttonsEl.querySelector(`.${currentButtonId}`);\n               if (buttonEl instanceof HTMLElement) { buttonEl.focus(); }\n            }\n            break;\n         }\n\n         case 'ArrowRight':\n         {\n            event.preventDefault();\n            event.stopPropagation();\n\n            const activeEl = document.activeElement;\n\n            if (buttonsEl instanceof HTMLElement)\n            {\n               // Only advance button via arrow key if a button is already focused  or there is no current button ID\n               if (activeEl instanceof HTMLElement && (buttonsEl.contains(activeEl) || currentButtonId === void 0))\n               {\n                  const currentIndex = buttons.findIndex((button) => button.id === currentButtonId);\n                  if (buttons.length && currentIndex < buttons.length - 1) { currentButtonId = buttons[currentIndex + 1].id; }\n               }\n\n               const buttonEl = buttonsEl.querySelector(`.${currentButtonId}`);\n               if (buttonEl instanceof HTMLElement) { buttonEl.focus(); }\n            }\n            break;\n         }\n\n         case 'Enter':\n            event.preventDefault();\n            event.stopPropagation();\n            break;\n\n         default:\n            if (preventDefault) { event.preventDefault(); }\n            if (stopPropagation) { event.stopPropagation(); }\n            break;\n      }\n   }\n</script>\n\n<main>\n   <div bind:this={contentEl} class=dialog-content>\n      {#if typeof content === 'string'}\n         {@html content}\n      {:else if dialogClass}\n         <svelte:component bind:this={dialogComponent} this={dialogClass} {...dialogProps} />\n      {/if}\n   </div>\n\n   {#if buttons.length}\n   <div bind:this={buttonsEl} class=\"dialog-buttons tjs-dialog-buttons\">\n      {#each buttons as button (button.id)}\n      <button class=\"dialog-button tjs-dialog-button {button.id}\"\n              on:click|preventDefault|stopPropagation={() => onClick(button)}\n              on:focus={() => currentButtonId = button.id}\n              disabled={button.disabled}\n              use:applyStyles={button.styles}>\n         <span title={button.title}>{#if button.icon}{@html button.icon}{/if}{button.label}</span>\n      </button>\n      {/each}\n   </div>\n   {/if}\n</main>\n\n<style>\n   .dialog-buttons {\n      padding-top: 8px;\n   }\n\n   .tjs-dialog-button:hover {\n      box-shadow: var(--tjs-dialog-button-box-shadow-focus-hover, var(--tjs-default-box-shadow-focus-hover));\n      outline: var(--tjs-dialog-button-outline-focus-hover, var(--tjs-default-outline-focus-hover, revert));\n      transition: var(--tjs-dialog-button-transition-focus-hover, var(--tjs-default-transition-focus-hover));\n      text-shadow: var(--tjs-dialog-button-text-shadow-focus-hover, var(--tjs-default-text-shadow-focus-hover, inherit));\n   }\n\n   .tjs-dialog-button:focus-visible {\n      box-shadow: var(--tjs-dialog-button-box-shadow-focus-visible, var(--tjs-default-box-shadow-focus-visible));\n      outline: var(--tjs-dialog-button-outline-focus-visible, var(--tjs-default-outline-focus-visible, revert));\n      transition: var(--tjs-dialog-button-transition-focus-visible, var(--tjs-default-transition-focus-visible));\n      text-shadow: var(--tjs-dialog-button-text-shadow-focus-visible, var(--tjs-default-text-shadow-focus-hover, inherit));\n   }\n</style>\n","<script>\n   import {\n      getContext,\n      onDestroy,\n      onMount,\n      setContext }         from 'svelte';\n\n   import { writable }     from 'svelte/store';\n\n   import { fade }         from 'svelte/transition';\n\n   import {\n      isObject,\n      klona }              from '@typhonjs-fvtt/runtime/util/object';\n\n   import ApplicationShell from '../application/ApplicationShell.svelte';\n   import DialogContent    from './DialogContent.svelte';\n   import TJSGlassPane     from '../TJSGlassPane.svelte';\n\n   // ApplicationShell contract.\n   export let elementContent = void 0;\n   export let elementRoot = void 0;\n\n   // The dialog data.\n   export let data = {};\n\n   export let dialogComponent = void 0;\n\n   export let managedPromise = void 0;\n\n   const application = getContext('#external').application;\n\n   const dialogOptions = writable({});\n\n   setContext('#managedPromise', managedPromise);\n   setContext('#dialogOptions', dialogOptions);\n\n   const s_MODAL_TRANSITION = fade;\n   const s_MODAL_TRANSITION_OPTIONS = { duration: 200 };\n   const s_MODAL_BACKGROUND = '#50505080'\n\n   let modal = void 0;\n\n   // Stores props for the ApplicationShell.\n   const appProps = {\n      // Stores any transition functions.\n      transition: void 0,\n      inTransition: void 0,\n      outTransition: void 0,\n\n      // Stores properties to set for options for any transitions.\n      transitionOptions: void 0,\n      inTransitionOptions: void 0,\n      outTransitionOptions: void 0,\n\n      // Stores any style overrides for application shell.\n      stylesApp: void 0,\n      stylesContent: void 0\n   }\n\n   const modalProps = {\n      // Background CSS style string.\n      background: void 0,\n      slotSeparate: void 0,\n      styles: void 0,\n\n      // Close modal on glasspane input.\n      closeOnInput: void 0,\n\n      // Stores any transition functions.\n      transition: void 0,\n      inTransition: void 0,\n      outTransition: void 0,\n\n      // Stores properties to set for options for any transitions.\n      transitionOptions: void 0,\n      inTransitionOptions: void 0,\n      outTransitionOptions: void 0,\n   }\n\n   let zIndex = void 0;\n\n   // Only set modal once on mount. You can't change between a modal an non-modal dialog during runtime.\n   if (modal === void 0) { modal = typeof data?.modal === 'boolean' ? data.modal : false; }\n\n   // Special modal handling -----------------------------------------------------------------------------------------\n\n   if (modal)\n   {\n      // Add a capture listener on window keydown to act before any other event listener.\n      onDestroy(() => window.removeEventListener('keydown', onKeydownModal, { capture: true }));\n      onMount(() => window.addEventListener('keydown', onKeydownModal, { capture: true }));\n   }\n   else\n   {\n      // Add a listener on document keydown to act before or equal with other event listeners.\n      onDestroy(() => document.removeEventListener('keydown', onKeydown));\n      onMount(() => document.addEventListener('keydown', onKeydown));\n   }\n\n   // Aria Attributes ------------------------------------------------------------------------------------------------\n\n   $: if (elementRoot instanceof HTMLElement)\n   {\n      elementRoot.setAttribute('role', 'dialog');\n\n      if (modal) { elementRoot.setAttribute('aria-modal', 'true'); }\n   }\n\n   // SvelteApplication options --------------------------------------------------------------------------------------\n\n   // Retrieve values from the DialogData object and also potentially set any SvelteApplication accessors.\n   // Explicit checks are performed against existing local variables as the only externally reactive variable is `data`.\n   // All of the checks below trigger when there are any external changes to the `data` prop.\n   // Prevent any unnecessary changing of local & `application` variables unless actual changes occur.\n\n   $: if (isObject(data))\n   {\n      // Update internal dialog options store / context with a clone of`data`.\n      dialogOptions.set(klona(data));\n\n      const newZIndex = Number.isInteger(data.zIndex) || data.zIndex === null ? data.zIndex :\n       modal ? Number.MAX_SAFE_INTEGER : Number.MAX_SAFE_INTEGER - 1\n      if (zIndex !== newZIndex) { zIndex = newZIndex; }\n\n      // Update the main foundry options when data changes. Perform explicit checks against existing data in `application`.\n      const newDraggable = typeof data.draggable === 'boolean' ? data.draggable : void 0;\n      if (newDraggable !== void 0 && application.reactive.draggable !== newDraggable)\n      {\n         application.reactive.draggable = newDraggable;\n      }\n\n      const newFocusAuto = typeof data.focusAuto === 'boolean' ? data.focusAuto : void 0;\n      if (newFocusAuto !== void 0 && application.reactive.focusAuto !== newFocusAuto)\n      {\n         application.reactive.focusAuto = newFocusAuto;\n      }\n\n      const newFocusKeep = typeof data.focusKeep === 'boolean' ? data.focusKeep : void 0;\n      if (newFocusKeep !== void 0 && application.reactive.focusKeep !== newFocusKeep)\n      {\n         application.reactive.focusKeep = newFocusKeep;\n      }\n\n      const newFocusTrap = typeof data.focusTrap === 'boolean' ? data.focusTrap : void 0;\n      if (newFocusTrap !== void 0 && application.reactive.focusTrap !== newFocusTrap)\n      {\n         application.reactive.focusTrap = newFocusTrap;\n      }\n\n      const newMinimizable = typeof data.minimizable === 'boolean' ? data.minimizable : void 0;\n      if (newMinimizable !== void 0 && application.reactive.minimizable !== newMinimizable)\n      {\n         application.reactive.minimizable = newMinimizable;\n      }\n\n      const newResizable = typeof data.resizable === 'boolean' ? data.resizable : void 0;\n      if (newResizable !== void 0 && application.reactive.resizable !== newResizable)\n      {\n         application.reactive.resizable = newResizable;\n      }\n\n      // Note application.title from Application localizes `options.title`, so compare with `application.options.title`.\n      const newTitle = data.title ?? 'Dialog';\n      if (newTitle !== application?.options?.title) { application.reactive.title = newTitle; }\n\n      if (application.position.zIndex !== zIndex) { application.position.zIndex = zIndex; }\n   }\n\n   // ApplicationShell transition options ----------------------------------------------------------------------------\n\n   $: if (isObject(data?.transition))\n   {\n      // Store data.transitions to shorten statements below.\n      const d = data.transition;\n\n      if (d?.transition !== appProps.transition) { appProps.transition = d.transition; }\n      if (d?.inTransition !== appProps.inTransition) { appProps.inTransition = d.inTransition; }\n      if (d?.outTransition !== appProps.outTransition) { appProps.outTransition = d.outTransition; }\n      if (d?.transitionOptions !== appProps.transitionOptions) { appProps.transitionOptions = d.transitionOptions; }\n\n      if (d?.inTransitionOptions !== appProps.inTransitionOptions)\n      {\n         appProps.inTransitionOptions = d.inTransitionOptions;\n      }\n\n      if (d?.outTransitionOptions !== appProps.outTransitionOptions)\n      {\n         appProps.outTransitionOptions = d.outTransitionOptions;\n      }\n   }\n\n   // Modal options --------------------------------------------------------------------------------------------------\n\n   $:\n   {\n      const newModalBackground = typeof data?.modalOptions?.background === 'string' ? data.modalOptions.background :\n       s_MODAL_BACKGROUND;\n\n      if (newModalBackground !== modalProps.background) { modalProps.background = newModalBackground; }\n   }\n\n   $:\n   {\n      const newModalSlotSeparate = typeof data?.modalOptions?.slotSeparate === 'boolean' ?\n       data.modalOptions.slotSeparate : void 0;\n\n      if (newModalSlotSeparate !== modalProps.slotSeparate) { modalProps.slotSeparate = newModalSlotSeparate; }\n   }\n\n   $:\n   {\n      const newModalStyles = isObject(data?.modalOptions?.styles) ? data.modalOptions.styles : void 0;\n\n      if (newModalStyles !== modalProps.styles) { modalProps.styles = newModalStyles; }\n   }\n\n   $:\n   {\n      const newModalCloseOnInput = typeof data?.modalOptions?.closeOnInput === 'boolean' ?\n       data.modalOptions.closeOnInput : void 0;\n\n      if (newModalCloseOnInput !== modalProps.closeOnInput) { modalProps.closeOnInput = newModalCloseOnInput; }\n   }\n\n   $: if (isObject(data?.modalOptions?.transition))\n   {\n      // Store data.transitions to shorten statements below.\n      const d = data.modalOptions.transition;\n\n      if (d?.transition !== modalProps.transition)\n      {\n         modalProps.transition = typeof d?.transition === 'function' ? d.transition : s_MODAL_TRANSITION;\n      }\n\n      if (d?.inTransition !== modalProps.inTransition) { modalProps.inTransition = d.inTransition; }\n      if (d?.outTransition !== modalProps.outTransition) { modalProps.outTransition = d.outTransition; }\n\n      // Provide default transition options if not defined.\n      if (d?.transitionOptions !== modalProps.transitionOptions)\n      {\n         modalProps.transitionOptions = isObject(d?.transitionOptions) ? d.transitionOptions :\n          s_MODAL_TRANSITION_OPTIONS;\n      }\n\n      if (d?.inTransitionOptions !== modalProps.inTransitionOptions)\n      {\n         modalProps.inTransitionOptions = d.inTransitionOptions;\n      }\n\n      if (d?.outTransitionOptions !== modalProps.outTransitionOptions)\n      {\n         modalProps.outTransitionOptions = d.outTransitionOptions;\n      }\n   }\n   else  // Provide a fallback / default glass pane transition when `data.modalOptions.transition` is not defined.\n   {\n      const newModalTransition = typeof data?.modalOptions?.transition?.transition === 'function' ?\n       data.modalOptions.transition.transition : s_MODAL_TRANSITION;\n\n      if (newModalTransition !== modalProps.transition) { modalProps.transition = newModalTransition; }\n\n      const newModalTransitionOptions = isObject(data?.modalOptions?.transitionOptions) ?\n       data.modalOptions.transitionOptions : s_MODAL_TRANSITION_OPTIONS;\n\n      if (newModalTransitionOptions !== modalProps.transitionOptions)\n      {\n         modalProps.transitionOptions = newModalTransitionOptions;\n      }\n   }\n\n   /**\n    * Handles closing all open TJSDialog instances when <Esc> key is pressed.\n    *\n    * @param {KeyboardEvent}  event - A KeyboardEvent.\n    */\n   function onKeydown(event)\n   {\n      if (event.code === 'Escape')\n      {\n         event.preventDefault();\n         event.stopPropagation();\n         application.close();\n      }\n   }\n\n   /**\n    * Handles closing any modal window and is assigned to `window` with capture acting before any other browser wide\n    * event listeners stopping immediate propagation.\n    *\n    * @param {KeyboardEvent}  event - A KeyboardEvent.\n    */\n   function onKeydownModal(event)\n   {\n      if (event.code === 'Escape')\n      {\n         event.preventDefault();\n         event.stopImmediatePropagation();\n         application.close();\n      }\n   }\n</script>\n\n<svelte:options accessors={true}/>\n\n{#if modal}\n   <TJSGlassPane id={`${application.id}-glasspane`} {...modalProps} {zIndex} on:close:glasspane={() => application.close()}>\n      <ApplicationShell bind:elementRoot bind:elementContent {...appProps} appOffsetHeight={true}>\n         <DialogContent bind:dialogComponent {data} stopPropagation={true} />\n      </ApplicationShell>\n   </TJSGlassPane>\n{:else}\n   <ApplicationShell bind:elementRoot bind:elementContent {...appProps} appOffsetHeight={true}>\n      <DialogContent bind:dialogComponent {data} />\n   </ApplicationShell>\n{/if}\n","import { cssVariables } from './cssVariables.js';\n\nexport { default as TJSComponentShell }   from './TJSComponentShell.svelte';\nexport { default as TJSContainer }        from './TJSContainer.svelte';\nexport { default as TJSGlassPane }        from './TJSGlassPane.svelte';\nexport *                                  from './application/index.js';\nexport *                                  from './dialog/index.js';\n\n/**\n * Provides default CSS variables for core components.\n */\ncssVariables.setProperties({\n   // Anchor text shadow / header buttons\n   '--tjs-default-text-shadow-focus-hover': '0 0 8px var(--color-shadow-primary)',\n\n   // TJSApplicationShell app background.\n   '--tjs-app-background': `url(\"${globalThis.foundry.utils.getRoute('/ui/denim075.png')}\")`,\n}, false);\n","<script>\r\n\r\n\texport let value;\r\n\texport let min = 0;\r\n\texport let max = 200;\r\n\texport let maxInput = Infinity;\r\n\texport let step = 1;\r\n\texport let divideBy = 100;\r\n\r\n\tlet displayValue = value * divideBy;\r\n\r\n\t$: {\r\n\t\tvalue = displayValue / divideBy;\r\n\t}\r\n\r\n</script>\r\n\r\n<div class=\"slider-group\" style={$$props.style}>\r\n\t<input bind:value=\"{displayValue}\" {max} {min} {step} type=\"range\"/>\r\n\t<input bind:value=\"{displayValue}\" max={maxInput} {min} required {step} type=\"number\"/>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .slider-group {\r\n    display: flex;\r\n    align-items: center;\r\n    flex: 3;\r\n\r\n    input[type=\"range\"] {\r\n      flex: 3;\r\n    }\r\n\r\n    input[type=\"number\"] {\r\n      flex: 0 1 40px;\r\n      margin-left: 1rem;\r\n      height: 20px;\r\n      font-size: 0.8rem;\r\n    }\r\n  }\r\n\r\n</style>\r\n","<script>\n\timport { getContext } from \"svelte\";\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\n\timport * as Utilities from \"../../../helpers/utilities.js\";\n\timport * as PileUtilities from \"../../../helpers/pile-utilities.js\";\n\timport { localize } from \"#runtime/svelte/helper\";\n\timport SliderInput from \"../../components/SliderInput.svelte\";\n\n\tconst { application } = getContext('#external');\n\n\texport let item;\n\texport let elementRoot;\n\texport let target = false;\n\n\tconst unlimitedQuantity = application.options?.unlimitedQuantity ?? false;\n\n\tlet form;\n\tlet quantity = 1;\n\n\tconst itemQuantity = Utilities.getItemQuantity(item);\n\tconst sliderQuantity = itemQuantity + (application.options?.quantityAdjustment ?? 0);\n\tconst canItemStack = PileUtilities.canItemStack(item, target);\n\n\tfunction requestSubmit() {\n\t\tform.requestSubmit();\n\t}\n\n\tfunction submit() {\n\t\tapplication.options.resolve(quantity);\n\t\tapplication.close();\n\t}\n\n</script>\n\n<svelte:options accessors={true}/>\n\n<ApplicationShell bind:elementRoot>\n\t<form autocomplete=\"off\" bind:this={form} class=\"item-piles-flexcol\" on:submit|once|preventDefault={submit}\n\t      style=\"padding:0.5rem;\">\n\n\t\t<h3 style=\"text-align: center;\">\n\t\t\t{localize(`ITEM-PILES.Applications.${application.options.localizationTitle}.Header`, {\n\t\t\t\titem_name: item.name\n\t\t\t})}\n\t\t</h3>\n\n\t\t{#if target}\n\n\t\t\t<p class=\"item-piles-text-center\">\n\t\t\t\t{localize(`ITEM-PILES.Applications.${application.options.localizationTitle}.Content`, {\n\t\t\t\t\ttarget_name: target.name\n\t\t\t\t})}\n\t\t\t</p>\n\n\t\t{/if}\n\n\t\t{#if (itemQuantity > 1 || unlimitedQuantity) && canItemStack}\n\n\t\t\t<div class=\"form-group item-piles-text-center\">\n\t\t\t\t<label>{localize(`ITEM-PILES.Applications.${application.options.localizationTitle}.${unlimitedQuantity ? \"ContentInfiniteQuantity\" : \"ContentMultipleQuantity\"}`, {\n\t\t\t\t\ttarget_name: target?.name ?? \"\",\n\t\t\t\t\tquantity: itemQuantity,\n\t\t\t\t\titemName: item.name\n\t\t\t\t})}</label>\n\t\t\t</div>\n\t\t\t{#if unlimitedQuantity}\n\t\t\t\t<input type=\"number\" min=\"1\" bind:value={quantity}/>\n\t\t\t{:else}\n\t\t\t\t<SliderInput min={1} max={sliderQuantity} maxInput={sliderQuantity} divideBy={1} bind:value={quantity}/>\n\t\t\t{/if}\n\t\t{/if}\n\n\t\t<footer class=\"sheet-footer item-piles-flexrow\" style=\"margin-top: 1rem;\">\n\t\t\t{#if target}\n\t\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\n\t\t\t\t\t<i class=\"fas fa-download\"></i>\n\t\t\t\t\t{localize(`ITEM-PILES.Applications.${application.options.localizationTitle}.Submit`)}\n\t\t\t\t</button>\n\t\t\t{:else}\n\t\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\n\t\t\t\t\t<i class=\"fas fa-box\"></i>\n\t\t\t\t\t{localize(`ITEM-PILES.Applications.${application.options.localizationTitle}.SubmitNoTarget`)}\n\t\t\t\t</button>\n\t\t\t{/if}\n\t\t\t<button on:click={() => { application.close() }} type=\"button\">\n\t\t\t\t<i class=\"fas fa-times\"></i>\n\t\t\t\t{localize(\"Cancel\")}\n\t\t\t</button>\n\t\t</footer>\n\n\t</form>\n</ApplicationShell>\n","import { linear }             from 'svelte/easing';\n\nimport { lerp }               from '@typhonjs-fvtt/runtime/math/interpolate';\nimport { isObject }           from '@typhonjs-fvtt/runtime/util/object';\n\n/**\n * @template T\n *\n * Provides the ability the save / restore application state for positional and UI state such as minimized status.\n *\n * You can restore a saved state with animation; please see the options of {@link ApplicationState.restore}.\n */\nexport class ApplicationState\n{\n   /** @type {T} */\n   #application;\n\n   /** @type {Map<string, ApplicationStateData>} */\n   #dataSaved = new Map();\n\n   /**\n    * @param {T}   application - The application.\n    */\n   constructor(application)\n   {\n      this.#application = application;\n\n      Object.seal(this);\n   }\n\n   /**\n    * Returns current application state along with any extra data passed into method.\n    *\n    * @param {object} [extra] - Extra data to add to application state.\n    *\n    * @returns {ApplicationStateData} Passed in object with current application state.\n    */\n   get(extra = {})\n   {\n      return Object.assign(extra, {\n         position: this.#application?.position?.get(),\n         beforeMinimized: this.#application?.position?.state.get({ name: '#beforeMinimized' }),\n         options: Object.assign({}, this.#application?.options),\n         ui: { minimized: this.#application?.reactive?.minimized }\n      });\n   }\n\n   /**\n    * Returns any stored save state by name.\n    *\n    * @param {object}   options - Options.\n    *\n    * @param {string}   options.name - Saved data set name.\n    *\n    * @returns {ApplicationStateData} The saved data set.\n    */\n   getSave({ name })\n   {\n      if (typeof name !== 'string')\n      {\n         throw new TypeError(`ApplicationState - getSave error: 'name' is not a string.`);\n      }\n\n      return this.#dataSaved.get(name);\n   }\n\n   /**\n    * Removes and returns any application state by name.\n    *\n    * @param {object}   options - Options.\n    *\n    * @param {string}   options.name - Name to remove and retrieve.\n    *\n    * @returns {ApplicationStateData} Saved application data.\n    */\n   remove({ name })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`ApplicationState - remove: 'name' is not a string.`); }\n\n      const data = this.#dataSaved.get(name);\n      this.#dataSaved.delete(name);\n\n      return data;\n   }\n\n   /**\n    * Restores a saved application state returning the data. Several optional parameters are available\n    * to control whether the restore action occurs silently (no store / inline styles updates), animates\n    * to the stored data, or simply sets the stored data. Restoring via {@link AnimationAPI.to} allows\n    * specification of the duration, easing, and interpolate functions along with configuring a Promise to be\n    * returned if awaiting the end of the animation.\n    *\n    * @param {object}            params - Parameters\n    *\n    * @param {string}            params.name - Saved data set name.\n    *\n    * @param {boolean}           [params.remove=false] - Remove data set.\n    *\n    * @param {boolean}           [params.async=false] - If animating return a Promise that resolves with any saved data.\n    *\n    * @param {boolean}           [params.animateTo=false] - Animate to restore data.\n    *\n    * @param {number}            [params.duration=0.1] - Duration in seconds.\n    *\n    * @param {Function}          [params.ease=linear] - Easing function.\n    *\n    * @param {Function}          [params.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {ApplicationStateData|Promise<ApplicationStateData>} Saved application data.\n    */\n   restore({ name, remove = false, async = false, animateTo = false, duration = 0.1, ease = linear,\n    interpolate = lerp })\n   {\n      if (typeof name !== 'string')\n      {\n         throw new TypeError(`ApplicationState - restore error: 'name' is not a string.`);\n      }\n\n      const dataSaved = this.#dataSaved.get(name);\n\n      if (dataSaved)\n      {\n         if (remove) { this.#dataSaved.delete(name); }\n\n         if (async)\n         {\n            return this.set(dataSaved, { async, animateTo, duration, ease, interpolate }).then(() => dataSaved);\n         }\n         else\n         {\n            this.set(dataSaved, { async, animateTo, duration, ease, interpolate });\n         }\n      }\n\n      return dataSaved;\n   }\n\n   /**\n    * Saves current application state with the opportunity to add extra data to the saved state.\n    *\n    * @param {object}   options - Options.\n    *\n    * @param {string}   options.name - name to index this saved data.\n    *\n    * @param {...*}     [options.extra] - Extra data to add to saved data.\n    *\n    * @returns {ApplicationStateData} Current application data\n    */\n   save({ name, ...extra })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`ApplicationState - save error: 'name' is not a string.`); }\n\n      const data = this.get(extra);\n\n      this.#dataSaved.set(name, data);\n\n      return data;\n   }\n\n   /**\n    * Restores a saved application state returning the data. Several optional parameters are available\n    * to control whether the restore action occurs silently (no store / inline styles updates), animates\n    * to the stored data, or simply sets the stored data. Restoring via {@link AnimationAPI.to} allows\n    * specification of the duration, easing, and interpolate functions along with configuring a Promise to be\n    * returned if awaiting the end of the animation.\n    *\n    * Note: If serializing application state any minimized apps will use the before minimized state on initial render\n    * of the app as it is currently not possible to render apps with Foundry VTT core API in the minimized state.\n    *\n    * TODO: THIS METHOD NEEDS TO BE REFACTORED WHEN TRL IS MADE INTO A STANDALONE FRAMEWORK.\n    *\n    * @param {ApplicationStateData}   data - Saved data set name.\n    *\n    * @param {object}            [opts] - Optional parameters\n    *\n    * @param {boolean}           [opts.async=false] - If animating return a Promise that resolves with any saved data.\n    *\n    * @param {boolean}           [opts.animateTo=false] - Animate to restore data.\n    *\n    * @param {number}            [opts.duration=0.1] - Duration in seconds.\n    *\n    * @param {Function}          [opts.ease=linear] - Easing function.\n    *\n    * @param {Function}          [opts.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {T | Promise<T>} When synchronous the application or Promise when animating resolving with application.\n    */\n   set(data, { async = false, animateTo = false, duration = 0.1, ease = linear, interpolate = lerp } = {})\n   {\n      if (!isObject(data))\n      {\n         throw new TypeError(`ApplicationState - restore error: 'data' is not an object.`);\n      }\n\n      const application = this.#application;\n\n      if (!isObject(data?.position))\n      {\n         console.warn(`ApplicationState.set warning: 'data.position' is not an object.`);\n         return application;\n      }\n\n      // TODO: TAKE NOTE THAT WE ARE ACCESSING A FOUNDRY APP v1 GETTER HERE TO DETERMINE IF APPLICATION IS RENDERED.\n      // TODO: THIS NEEDS TO BE REFACTORED WHEN CONVERTING TRL TO A GENERIC FRAMEWORK.\n      const rendered = application.rendered;\n\n      if (animateTo && !rendered)\n      {\n         console.warn(`ApplicationState.set warning: Application is not rendered and 'animateTo' is true.`);\n         return application;\n      }\n\n      // Update data directly with no store or inline style updates.\n      if (animateTo)  // Animate to saved data.\n      {\n         // Provide special handling to potentially change transform origin as this parameter is not animated.\n         if (data.position.transformOrigin !== application.position.transformOrigin)\n         {\n            application.position.transformOrigin = data.position.transformOrigin;\n         }\n\n         if (isObject(data?.ui))\n         {\n            const minimized = typeof data.ui?.minimized === 'boolean' ? data.ui.minimized : false;\n\n            if (application?.reactive?.minimized && !minimized)\n            {\n               application.maximize({ animate: false, duration: 0 });\n            }\n         }\n\n         const promise = application.position.animate.to(data.position,\n          { duration, ease, interpolate }).finished.then((cancelled) =>\n         {\n            if (cancelled) { return application; }\n\n            // Merge in saved options to application.\n            if (isObject(data?.options))\n            {\n               application?.reactive.mergeOptions(data.options);\n            }\n\n            if (isObject(data?.ui))\n            {\n               const minimized = typeof data.ui?.minimized === 'boolean' ? data.ui.minimized : false;\n\n               // Application is currently minimized and stored state is not, so reset minimized state without\n               // animation.\n               if (!application?.reactive?.minimized && minimized)\n               {\n                  application.minimize({ animate: false, duration: 0 });\n               }\n            }\n\n            if (isObject(data?.beforeMinimized))\n            {\n               application.position.state.set({ name: '#beforeMinimized', ...data.beforeMinimized });\n            }\n\n            return application;\n         });\n\n         // Return a Promise with the application that resolves after animation ends.\n         if (async) { return promise; }\n      }\n      else\n      {\n         if (rendered)\n         {\n            // Merge in saved options to application.\n            if (isObject(data?.options))\n            {\n               application?.reactive.mergeOptions(data.options);\n            }\n\n            if (isObject(data?.ui))\n            {\n               const minimized = typeof data.ui?.minimized === 'boolean' ? data.ui.minimized : false;\n\n               // Application is currently minimized and stored state is not, so reset minimized state without\n               // animation.\n               if (application?.reactive?.minimized && !minimized)\n               {\n                  application.maximize({ animate: false, duration: 0 });\n               }\n               else if (!application?.reactive?.minimized && minimized)\n               {\n                  application.minimize({ animate: false, duration });\n               }\n            }\n\n            if (isObject(data?.beforeMinimized))\n            {\n               application.position.state.set({ name: '#beforeMinimized', ...data.beforeMinimized });\n            }\n\n            // Default options is to set data for an immediate update.\n            application.position.set(data.position);\n         }\n         else\n         {\n            // When not rendered set position to the 'beforeMinimized' data if it exists otherwise set w/ 'position'.\n            // Currently, w/ Foundry core Application API it is impossible to initially render an app in the minimized\n            // state.\n\n            let positionData = data.position;\n\n            if (isObject(data.beforeMinimized))\n            {\n               // Take before minimized data.\n               positionData = data.beforeMinimized;\n\n               // Apply position left / top to before minimized data. This covers the case when an app is minimized,\n               // but then moved. This allows restoration of the before minimized parameters w/ the last position\n               // location.\n               positionData.left = data.position.left;\n               positionData.top = data.position.top;\n            }\n\n            application.position.set(positionData);\n         }\n      }\n\n      return application;\n   }\n}\n\n/**\n * @typedef {object} ApplicationStateData\n *\n * @property {import('@typhonjs-fvtt/runtime/svelte/store/position').TJSPositionDataExtended}   position Application position.\n *\n * @property {object}         beforeMinimized Any application saved position state for #beforeMinimized\n *\n * @property {object}         options Application options.\n *\n * @property {object}         ui Application UI state.\n */\n","/**\n * Provides a mechanism to retrieve and query all mounted Svelte components including the main application shell.\n */\nexport class GetSvelteData\n{\n   /** @type {import('./types').MountedAppShell[] | null[]} */\n   #applicationShellHolder;\n\n   /** @type {import('./types').SvelteData[]} */\n   #svelteData;\n\n   /**\n    * Keep a direct reference to the SvelteData array in an associated {@link SvelteApplication}.\n    *\n    * @param {import('./types').MountedAppShell[] | null[]}  applicationShellHolder - A reference to the\n    *        MountedAppShell array.\n    *\n    * @param {import('./types').SvelteData[]}  svelteData - A reference to the SvelteData array of mounted components.\n    */\n   constructor(applicationShellHolder, svelteData)\n   {\n      this.#applicationShellHolder = applicationShellHolder;\n      this.#svelteData = svelteData;\n   }\n\n   /**\n    * Returns any mounted {@link MountedAppShell}.\n    *\n    * @returns {import('./types').MountedAppShell | null} Any mounted application shell.\n    */\n   get applicationShell() { return this.#applicationShellHolder[0]; }\n\n   /**\n    * Returns the indexed Svelte component.\n    *\n    * @param {number}   index -\n    *\n    * @returns {object} The loaded Svelte component.\n    */\n   component(index)\n   {\n      const data = this.#svelteData[index];\n      return data?.component ?? void 0;\n   }\n\n   /**\n    * Returns the Svelte component entries iterator.\n    *\n    * @returns {IterableIterator<[number, import('svelte').SvelteComponent]>} Svelte component entries iterator.\n    * @yields\n    */\n   *componentEntries()\n   {\n      for (let cntr = 0; cntr < this.#svelteData.length; cntr++)\n      {\n         yield [cntr, this.#svelteData[cntr].component];\n      }\n   }\n\n   /**\n    * Returns the Svelte component values iterator.\n    *\n    * @returns {IterableIterator<import('svelte').SvelteComponent>} Svelte component values iterator.\n    * @yields\n    */\n   *componentValues()\n   {\n      for (let cntr = 0; cntr < this.#svelteData.length; cntr++)\n      {\n         yield this.#svelteData[cntr].component;\n      }\n   }\n\n   /**\n    * Returns the indexed SvelteData entry.\n    *\n    * @param {number}   index - The index of SvelteData instance to retrieve.\n    *\n    * @returns {import('./types').SvelteData} The loaded Svelte config + component.\n    */\n   data(index)\n   {\n      return this.#svelteData[index];\n   }\n\n   /**\n    * Returns the {@link SvelteData} instance for a given component.\n    *\n    * @param {import('svelte').SvelteComponent} component - Svelte component.\n    *\n    * @returns {import('./types').SvelteData} -  The loaded Svelte config + component.\n    */\n   dataByComponent(component)\n   {\n      for (const data of this.#svelteData)\n      {\n         if (data.component === component) { return data; }\n      }\n\n      return void 0;\n   }\n\n   /**\n    * Returns the SvelteData entries iterator.\n    *\n    * @returns {IterableIterator<[number, import('./types').SvelteData]>} SvelteData entries iterator.\n    */\n   dataEntries()\n   {\n      return this.#svelteData.entries();\n   }\n\n   /**\n    * Returns the SvelteData values iterator.\n    *\n    * @returns {IterableIterator<import('./types').SvelteData>} SvelteData values iterator.\n    */\n   dataValues()\n   {\n      return this.#svelteData.values();\n   }\n\n   /**\n    * Returns the length of the mounted Svelte component list.\n    *\n    * @returns {number} Length of mounted Svelte component list.\n    */\n   get length()\n   {\n      return this.#svelteData.length;\n   }\n}\n","import { writable, get } from 'svelte/store';\n\n/**\n * Generates derived, readable, writable helper functions wrapping the given Storage API provided with any additional\n * customization for data serialization. By default, JSON serialization is used.\n *\n * @param {object}   opts - Generator options.\n *\n * @param {Storage}  storage - The web storage source.\n *\n * @param {(value: any, ...rest: any[]) => string}  [opts.serialize] - Replace with custom serialization;\n *        default: `JSON.stringify`.\n *\n * @param {(value: string, ...rest: any[]) => any}  [opts.deserialize] - Replace with custom deserialization;\n *        default: `JSON.parse`.\n *\n * @returns {StorageStores} A complete set of store helper functions and associated storage API instance and\n *          serialization strategy.\n */\nfunction storeGenerator({ storage, serialize = JSON.stringify, deserialize = JSON.parse }) {\n    function isSimpleDeriver(deriver) {\n        return deriver.length < 2;\n    }\n    function storageReadable(key, value, start) {\n        return {\n            subscribe: storageWritable(key, value, start).subscribe\n        };\n    }\n    function storageWritable(key, value, start) {\n        function wrap_start(ogSet) {\n            return start(function wrap_set(new_value) {\n                if (storage) {\n                    storage.setItem(key, serialize(new_value));\n                }\n                return ogSet(new_value);\n            }, function wrap_update(fn) {\n                set(fn(get(ogStore)));\n            });\n        }\n        if (storage) {\n            const storageValue = storage.getItem(key);\n            try {\n                if (storageValue) {\n                    value = deserialize(storageValue);\n                }\n            }\n            catch (err) { /**/ }\n            storage.setItem(key, serialize(value));\n        }\n        const ogStore = writable(value, start ? wrap_start : void 0);\n        function set(new_value) {\n            if (storage) {\n                storage.setItem(key, serialize(new_value));\n            }\n            ogStore.set(new_value);\n        }\n        function update(fn) {\n            set(fn(get(ogStore)));\n        }\n        function subscribe(run, invalidate) {\n            return ogStore.subscribe(run, invalidate);\n        }\n        return { set, update, subscribe };\n    }\n    function storageDerived(key, stores, fn, initial_value) {\n        const single = !Array.isArray(stores);\n        const stores_array = single ? [stores] : stores;\n        if (storage && storage.getItem(key)) {\n            try {\n                initial_value = deserialize(storage.getItem(key));\n            }\n            catch (err) { /**/ }\n        }\n        return storageReadable(key, initial_value, (set, update) => {\n            let inited = false;\n            const values = [];\n            let pending = 0;\n            let cleanup;\n            const sync = () => {\n                if (pending) {\n                    return;\n                }\n                cleanup?.();\n                const input = single ? values[0] : values;\n                if (isSimpleDeriver(fn)) {\n                    set(fn(input));\n                }\n                else {\n                    const result = fn(input, set, update);\n                    if (typeof result === 'function') {\n                        cleanup = result;\n                    }\n                }\n            };\n            const unsubscribers = stores_array.map((store, i) => store.subscribe((value) => {\n                values[i] = value;\n                pending &= ~(1 << i);\n                if (inited) {\n                    sync();\n                }\n            }, () => { pending |= (1 << i); }));\n            inited = true;\n            sync();\n            return function stop() {\n                // Equivalent to run_all from Svelte internals.\n                unsubscribers.forEach((unsubscriber) => unsubscriber());\n                cleanup?.();\n            };\n        });\n    }\n    return {\n        readable: storageReadable,\n        writable: storageWritable,\n        derived: storageDerived,\n        storage,\n        serialize,\n        deserialize\n    };\n}\n\n/**\n * Provides all Storage API enabled `localStorage` store helper functions. Data is serialized as JSON.\n */\nconst localStores = storeGenerator({ storage: globalThis?.localStorage });\n/**\n * Provides the Storage API enabled derived `localStorage` store helper function. Data is serialized as JSON.\n */\nlocalStores.derived;\n/**\n * Provides the Storage API enabled readable `localStorage` store helper function. Data is serialized as JSON.\n */\nlocalStores.readable;\n/**\n * Provides the Storage API enabled writable `localStorage` store helper function. Data is serialized as JSON.\n */\nlocalStores.writable;\n\n/**\n * Provides all Storage API enabled `sessionStorage` store helper functions. Data is serialized as JSON.\n */\nconst sessionStores = storeGenerator({ storage: globalThis?.sessionStorage });\n/**\n * Provides the Storage API enabled derived `sessionStorage` store helper function. Data is serialized as JSON.\n */\nsessionStores.derived;\n/**\n * Provides the Storage API enabled readable `sessionStorage` store helper function. Data is serialized as JSON.\n */\nsessionStores.readable;\n/**\n * Provides the Storage API enabled writable `sessionStorage` store helper function. Data is serialized as JSON.\n */\nsessionStores.writable;\n\n/**\n * Provides the base Storage API store manager. It is recommended to use {@link TJSLocalStorage} &\n * {@link TJSSessionStorage} for standard browser local and session storage use cases. TJSWebStorage exists\n * to provide additional customization options for custom Storage API compatible storage instances and custom\n * serialization configuration.\n */\nclass TJSWebStorage\n{\n   /** @type {import('./').StorageStores} */\n   #storageStores;\n\n   /**\n    * @type {(Map<string, {\n    *    store: import('svelte/store').Writable,\n    *    deserialize?: (value: string, ...rest: any[]) => any,\n    *    serialize?: (value: any, ...rest: any[]) => string\n    * }>)}\n    */\n   #stores = new Map();\n\n   /**\n    * @param {import('./').StorageStores} storageStores - Provides a complete set of\n    *        storage API store helper functions and the associated storage API instance and serializations strategy.\n    */\n   constructor(storageStores)\n   {\n      this.#storageStores = storageStores;\n   }\n\n\n   /**\n    * @param {string}   key - Storage key.\n    *\n    * @returns {(value: string, ...rest: any[]) => any} Deserialize function.\n    */\n   #getDeserialize(key)\n   {\n      return this.#stores.get(key)?.deserialize ?? this.#storageStores.deserialize;\n   }\n\n\n   /**\n    * @param {string}   key - Storage key.\n    *\n    * @returns {(value: any, ...rest: any[]) => string} Serialize function.\n    */\n   #getSerialize(key)\n   {\n      return this.#stores.get(key)?.serialize ?? this.#storageStores.serialize;\n   }\n\n   /**\n    * Creates a new store for the given key.\n    *\n    * @template T\n    *\n    * @param {string}   key - Key to lookup in stores map.\n    *\n    * @param {T}        [defaultValue] - A default value to set for the store.\n    *\n    * @param {import('./').StorageStores} [storageStores] - Additional store creation options.\n    *\n    * @returns {import('svelte/store').Writable<T>} The new store.\n    */\n   #createStore(key, defaultValue = void 0, storageStores)\n   {\n      try\n      {\n         const value = this.#storageStores.storage.getItem(key);\n         if (value !== null)\n         {\n            const deserialize = storageStores?.deserialize ?? this.#storageStores.deserialize;\n            defaultValue = deserialize(value);\n         }\n      }\n      catch (err) { /**/ }\n\n      const writable = storageStores?.writable ?? this.#storageStores.writable;\n\n      return writable(key, defaultValue);\n   }\n\n   /**\n    * Gets a store from the `stores` Map or creates a new store for the key and a given default value.\n    *\n    * @template T\n    *\n    * @param {string}   key - Key to lookup in stores map.\n    *\n    * @param {T}        [defaultValue] - A default value to set for the store.\n    *\n    * @param {import('./').StorageStores} [storageStores] - Additional store creation options.\n    *\n    * @returns {import('svelte/store').Writable<T>} The store for the given key.\n    */\n   #getStore(key, defaultValue = void 0, storageStores)\n   {\n      const storeEntry = this.#stores.get(key);\n      if (storeEntry) { return storeEntry.store; }\n\n      const store = this.#createStore(key, defaultValue, storageStores);\n\n      // Set any key specific storage helper details.\n      this.#stores.set(key, {\n         store,\n         deserialize: storageStores?.deserialize,\n         serialize: storageStores?.serialize\n      });\n\n      return store;\n   }\n\n   /**\n    * Get value from the storage API.\n    *\n    * @param {string}   key - Key to lookup in storage API.\n    *\n    * @param {*}        [defaultValue] - A default value to return if key not present in session storage.\n    *\n    * @returns {*} Value from session storage or if not defined any default value provided.\n    */\n   getItem(key, defaultValue)\n   {\n      let value = defaultValue;\n\n      const storageValue = this.#storageStores.storage.getItem(key);\n\n      if (storageValue !== null)\n      {\n         try\n         {\n            value = this.#getDeserialize(key)(storageValue);\n         }\n         catch (err)\n         {\n            value = defaultValue;\n         }\n      }\n      else if (defaultValue !== void 0)\n      {\n         try\n         {\n            const newValue = this.#getSerialize(key)(defaultValue);\n\n            // If there is no existing storage value and defaultValue is defined the storage value needs to be set.\n            this.#storageStores.storage.setItem(key, newValue);\n         }\n         catch (err) { /* */ }\n      }\n\n      return value;\n   }\n\n   /**\n    * Returns the backing Svelte store for the given key; potentially sets a default value if the key\n    * is not already set.\n    *\n    * @template T\n    *\n    * @param {string}   key - Key to lookup in storage API.\n    *\n    * @param {T}        [defaultValue] - A default value to return if key not present in session storage.\n    *\n    * @param {import('./').StorageStores} [storageStores] - Additional store creation options.\n    *\n    * @returns {import('svelte/store').Writable<T>} The Svelte store for this key.\n    */\n   getStore(key, defaultValue, storageStores)\n   {\n      return this.#getStore(key, defaultValue, storageStores);\n   }\n\n   /**\n    * Sets the value for the given key in storage API.\n    *\n    * @param {string}   key - Key to lookup in storage API.\n    *\n    * @param {*}        value - A value to set for this key.\n    */\n   setItem(key, value)\n   {\n      const store = this.#getStore(key);\n      store.set(value);\n   }\n\n   /**\n    * Convenience method to swap a boolean value stored in storage API.\n    *\n    * @param {string}   key - Key to lookup in storage API.\n    *\n    * @param {boolean}  [defaultValue] - A default value to return if key not present in session storage.\n    *\n    * @returns {boolean} The boolean swap for the given key.\n    */\n   swapItemBoolean(key, defaultValue)\n   {\n      const store = this.#getStore(key, defaultValue);\n\n      let currentValue = false;\n\n      try\n      {\n         currentValue = !!this.#getDeserialize(key)(this.#storageStores.storage.getItem(key));\n      }\n      catch (err) { /**/ }\n\n      const newValue = typeof currentValue === 'boolean' ? !currentValue : false;\n\n      store.set(newValue);\n      return newValue;\n   }\n}\n\n/**\n * Provides a {@link TJSWebStorage} instance for standard browser local storage use cases.\n */\nclass TJSLocalStorage extends TJSWebStorage\n{\n   constructor()\n   {\n      super(localStores);\n   }\n}\n\n/**\n * Provides a {@link TJSWebStorage} instance for standard browser session storage use cases.\n */\nclass TJSSessionStorage extends TJSWebStorage\n{\n   constructor()\n   {\n      super(sessionStores);\n   }\n}\n\nexport { TJSLocalStorage, TJSSessionStorage, TJSWebStorage, localStores, sessionStores, storeGenerator };\n//# sourceMappingURL=index.js.map\n","import { derived, writable }     from 'svelte/store';\n\nimport {\n   TJSSessionStorage,\n   TJSWebStorage }               from '@typhonjs-fvtt/runtime/svelte/store/web-storage';\n\nimport { propertyStore }         from '@typhonjs-fvtt/runtime/svelte/store/writable-derived';\n\nimport {\n   deepMerge,\n   safeAccess,\n   safeSet }                     from '@typhonjs-fvtt/runtime/util/object';\n\nimport { subscribeIgnoreFirst }  from '@typhonjs-fvtt/runtime/util/store';\n\n/**\n * Contains the reactive functionality / Svelte stores associated with SvelteApplication and retrievable by\n * {@link SvelteApplication.reactive}.\n *\n * There are several reactive getters for UI state such and for two-way bindings / stores see\n * {@link SvelteReactive.storeUIState}:\n * - {@link SvelteReactive.dragging}\n * - {@link SvelteReactive.minimized}\n * - {@link SvelteReactive.resizing}\n *\n * There are also reactive getters / setters for {@link SvelteApplicationOptions} and Foundry\n * {@link ApplicationOptions}. You can use the following as one way bindings and update the associated stores. For\n * two-way bindings / stores see {@link SvelteReactive.storeAppOptions}.\n *\n * - {@link SvelteReactive.draggable}\n * - {@link SvelteReactive.focusAuto}\n * - {@link SvelteReactive.focusKeep}\n * - {@link SvelteReactive.focusTrap}\n * - {@link SvelteReactive.headerButtonNoClose}\n * - {@link SvelteReactive.headerButtonNoLabel}\n * - {@link SvelteReactive.headerIcon}\n * - {@link SvelteReactive.headerNoTitleMinimized}\n * - {@link SvelteReactive.minimizable}\n * - {@link SvelteReactive.popOut}\n * - {@link SvelteReactive.positionable}\n * - {@link SvelteReactive.resizable}\n * - {@link SvelteReactive.title}\n *\n * An instance of TJSWebStorage (session) / TJSSessionStorage is accessible via {@link SvelteReactive.sessionStorage}.\n * Optionally you can pass in an existing TJSWebStorage instance that can be shared across multiple SvelteApplications\n * by setting {@link SvelteApplicationOptions.sessionStorage}.\n *\n * -------------------------------------------------------------------------------------------------------------------\n *\n * This API is not sealed, and it is recommended that you extend it with accessors to get / set data that is reactive\n * in your application. An example of setting an exported prop `document` from the main mounted application shell.\n *\n * @example\n * import { hasSetter } from '@typhonjs-fvtt/runtime/svelte/util';\n *\n * // Note: make a normal comment.\n * //  * @member {object} document - Adds accessors to SvelteReactive to get / set the document associated with\n * //  *                             Document with the mounted application shell Svelte component.\n * //  *\n * //  * @memberof SvelteReactive#\n * //  *\n * Object.defineProperty(this.reactive, 'document', {\n *    get: () => this.svelte?.applicationShell?.document,\n *    set: (document) =>\n *    {\n *       const component = this.svelte?.applicationShell;\n *       if (hasSetter(component, 'document')) { component.document = document; }\n *    }\n * });\n */\nexport class SvelteReactive\n{\n   /**\n    * @type {import('../SvelteApplication').SvelteApplication}\n    */\n   #application;\n\n   /**\n    * @type {boolean}\n    */\n   #initialized = false;\n\n   /** @type {import('@typhonjs-fvtt/runtime/svelte/store/web-storage').TJSWebStorage} */\n   #sessionStorage;\n\n   /**\n    * The Application option store which is injected into mounted Svelte component context under the `external` key.\n    *\n    * @type {import('./types').StoreAppOptions}\n    */\n   #storeAppOptions;\n\n   /**\n    * Stores the update function for `#storeAppOptions`.\n    *\n    * @type {(this: void, updater: import('svelte/store').Updater<object>) => void}\n    */\n   #storeAppOptionsUpdate;\n\n   /**\n    * Stores the UI state data to make it accessible via getters.\n    *\n    * @type {object}\n    */\n   #dataUIState;\n\n   /**\n    * The UI option store which is injected into mounted Svelte component context under the `external` key.\n    *\n    * @type {import('./types').StoreUIOptions}\n    */\n   #storeUIState;\n\n   /**\n    * Stores the update function for `#storeUIState`.\n    *\n    * @type {(this: void, updater: import('svelte/store').Updater<object>) => void}\n    */\n   #storeUIStateUpdate;\n\n   /**\n    * Stores the unsubscribe functions from local store subscriptions.\n    *\n    * @type {import('svelte/store').Unsubscriber[]}\n    */\n   #storeUnsubscribe = [];\n\n   /**\n    * @param {import('../SvelteApplication').SvelteApplication} application - The host Foundry application.\n    */\n   constructor(application)\n   {\n      this.#application = application;\n      const optionsSessionStorage = application?.options?.sessionStorage;\n\n      if (optionsSessionStorage !== void 0 && !(optionsSessionStorage instanceof TJSWebStorage))\n      {\n         throw new TypeError(`'options.sessionStorage' is not an instance of TJSWebStorage.`);\n      }\n\n      // If no external web storage API instance is available then create a TJSSessionStorage instance.\n      this.#sessionStorage = optionsSessionStorage !== void 0 ? optionsSessionStorage : new TJSSessionStorage();\n   }\n\n   /**\n    * Initializes reactive support. Package private for internal use.\n    *\n    * @returns {SvelteReactiveStores | undefined} Internal methods to interact with Svelte stores.\n    * @package\n    * @internal\n    */\n   initialize()\n   {\n      if (this.#initialized) { return; }\n\n      this.#initialized = true;\n\n      this.#storesInitialize();\n\n      return {\n         appOptionsUpdate: this.#storeAppOptionsUpdate,\n         uiStateUpdate: this.#storeUIStateUpdate,\n         subscribe: this.#storesSubscribe.bind(this),\n         unsubscribe: this.#storesUnsubscribe.bind(this)\n      };\n   }\n\n// Store getters -----------------------------------------------------------------------------------------------------\n\n   /**\n    * @returns {import('@typhonjs-fvtt/runtime/svelte/store/web-storage').TJSWebStorage} Returns TJSWebStorage (session) instance.\n    */\n   get sessionStorage()\n   {\n      return this.#sessionStorage;\n   }\n\n   /**\n    * Returns the store for app options.\n    *\n    * @returns {import('./types').StoreAppOptions} App options store.\n    */\n   get storeAppOptions() { return this.#storeAppOptions; }\n\n   /**\n    * Returns the store for UI options.\n    *\n    * @returns {import('./types').StoreUIOptions} UI options store.\n    */\n   get storeUIState() { return this.#storeUIState; }\n\n// Only reactive getters ---------------------------------------------------------------------------------------------\n\n   /**\n    * Returns the current dragging UI state.\n    *\n    * @returns {boolean} Dragging UI state.\n    */\n   get dragging() { return this.#dataUIState.dragging; }\n\n   /**\n    * Returns the current minimized UI state.\n    *\n    * @returns {boolean} Minimized UI state.\n    */\n   get minimized() { return this.#dataUIState.minimized; }\n\n   /**\n    * Returns the current resizing UI state.\n    *\n    * @returns {boolean} Resizing UI state.\n    */\n   get resizing() { return this.#dataUIState.resizing; }\n\n// Reactive getter / setters -----------------------------------------------------------------------------------------\n\n   /**\n    * Returns the draggable app option.\n    *\n    * @returns {boolean} Draggable app option.\n    */\n   get draggable() { return this.#application?.options?.draggable; }\n\n   /**\n    * Returns the focusAuto app option.\n    *\n    * @returns {boolean} When true auto-management of app focus is enabled.\n    */\n   get focusAuto() { return this.#application?.options?.focusAuto; }\n\n   /**\n    * Returns the focusKeep app option.\n    *\n    * @returns {boolean} When `focusAuto` and `focusKeep` is true; keeps internal focus.\n    */\n   get focusKeep() { return this.#application?.options?.focusKeep; }\n\n   /**\n    * Returns the focusTrap app option.\n    *\n    * @returns {boolean} When true focus trapping / wrapping is enabled keeping focus inside app.\n    */\n   get focusTrap() { return this.#application?.options?.focusTrap; }\n\n   /**\n    * Returns the headerButtonNoClose app option.\n    *\n    * @returns {boolean} Remove the close the button in header app option.\n    */\n   get headerButtonNoClose() { return this.#application?.options?.headerButtonNoClose; }\n\n   /**\n    * Returns the headerButtonNoLabel app option.\n    *\n    * @returns {boolean} Remove the labels from buttons in header app option.\n    */\n   get headerButtonNoLabel() { return this.#application?.options?.headerButtonNoLabel; }\n\n   /**\n    * Returns the headerIcon app option.\n    *\n    * @returns {string|void} URL for header app icon.\n    */\n   get headerIcon() { return this.#application?.options?.headerIcon; }\n\n   /**\n    * Returns the headerNoTitleMinimized app option.\n    *\n    * @returns {boolean} When true removes the header title when minimized.\n    */\n   get headerNoTitleMinimized() { return this.#application?.options?.headerNoTitleMinimized; }\n\n   /**\n    * Returns the minimizable app option.\n    *\n    * @returns {boolean} Minimizable app option.\n    */\n   get minimizable() { return this.#application?.options?.minimizable; }\n\n   /**\n    * Returns the Foundry popOut state; {@link Application.popOut}\n    *\n    * @returns {boolean} Positionable app option.\n    */\n   get popOut() { return this.#application.popOut; }\n\n   /**\n    * Returns the positionable app option; {@link SvelteApplicationOptions.positionable}\n    *\n    * @returns {boolean} Positionable app option.\n    */\n   get positionable() { return this.#application?.options?.positionable; }\n\n   /**\n    * Returns the resizable option.\n    *\n    * @returns {boolean} Resizable app option.\n    */\n   get resizable() { return this.#application?.options?.resizable; }\n\n   /**\n    * Returns the title accessor from the parent Application class; {@link Application.title}\n    * TODO: Application v2; note that super.title localizes `this.options.title`; IMHO it shouldn't.\n    *\n    * @returns {string} Title.\n    */\n   get title() { return this.#application.title; }\n\n   /**\n    * Sets `this.options.draggable` which is reactive for application shells.\n    *\n    * @param {boolean}  draggable - Sets the draggable option.\n    */\n   set draggable(draggable)\n   {\n      if (typeof draggable === 'boolean') { this.setOptions('draggable', draggable); }\n   }\n\n   /**\n    * Sets `this.options.focusAuto` which is reactive for application shells.\n    *\n    * @param {boolean}  focusAuto - Sets the focusAuto option.\n    */\n   set focusAuto(focusAuto)\n   {\n      if (typeof focusAuto === 'boolean') { this.setOptions('focusAuto', focusAuto); }\n   }\n\n   /**\n    * Sets `this.options.focusKeep` which is reactive for application shells.\n    *\n    * @param {boolean}  focusKeep - Sets the focusKeep option.\n    */\n   set focusKeep(focusKeep)\n   {\n      if (typeof focusKeep === 'boolean') { this.setOptions('focusKeep', focusKeep); }\n   }\n\n   /**\n    * Sets `this.options.focusTrap` which is reactive for application shells.\n    *\n    * @param {boolean}  focusTrap - Sets the focusTrap option.\n    */\n   set focusTrap(focusTrap)\n   {\n      if (typeof focusTrap === 'boolean') { this.setOptions('focusTrap', focusTrap); }\n   }\n\n   /**\n    * Sets `this.options.headerButtonNoClose` which is reactive for application shells.\n    *\n    * @param {boolean}  headerButtonNoClose - Sets the headerButtonNoClose option.\n    */\n   set headerButtonNoClose(headerButtonNoClose)\n   {\n      if (typeof headerButtonNoClose === 'boolean') { this.setOptions('headerButtonNoClose', headerButtonNoClose); }\n   }\n\n   /**\n    * Sets `this.options.headerButtonNoLabel` which is reactive for application shells.\n    *\n    * @param {boolean}  headerButtonNoLabel - Sets the headerButtonNoLabel option.\n    */\n   set headerButtonNoLabel(headerButtonNoLabel)\n   {\n      if (typeof headerButtonNoLabel === 'boolean') { this.setOptions('headerButtonNoLabel', headerButtonNoLabel); }\n   }\n\n   /**\n    * Sets `this.options.headerIcon` which is reactive for application shells.\n    *\n    * @param {string | undefined}  headerIcon - Sets the headerButtonNoLabel option.\n    */\n   set headerIcon(headerIcon)\n   {\n      if (headerIcon === void 0 || typeof headerIcon === 'string') { this.setOptions('headerIcon', headerIcon); }\n   }\n\n   /**\n    * Sets `this.options.headerNoTitleMinimized` which is reactive for application shells.\n    *\n    * @param {boolean}  headerNoTitleMinimized - Sets the headerNoTitleMinimized option.\n    */\n   set headerNoTitleMinimized(headerNoTitleMinimized)\n   {\n      if (typeof headerNoTitleMinimized === 'boolean')\n      {\n         this.setOptions('headerNoTitleMinimized', headerNoTitleMinimized);\n      }\n   }\n\n   /**\n    * Sets `this.options.minimizable` which is reactive for application shells that are also pop out.\n    *\n    * @param {boolean}  minimizable - Sets the minimizable option.\n    */\n   set minimizable(minimizable)\n   {\n      if (typeof minimizable === 'boolean') { this.setOptions('minimizable', minimizable); }\n   }\n\n   /**\n    * Sets `this.options.popOut` which is reactive for application shells. This will add / remove this application\n    * from `ui.windows`.\n    *\n    * @param {boolean}  popOut - Sets the popOut option.\n    */\n   set popOut(popOut)\n   {\n      if (typeof popOut === 'boolean') { this.setOptions('popOut', popOut); }\n   }\n\n   /**\n    * Sets `this.options.positionable` enabling / disabling {@link SvelteApplication.position}.\n    *\n    * @param {boolean}  positionable - Sets the positionable option.\n    */\n   set positionable(positionable)\n   {\n      if (typeof positionable === 'boolean') { this.setOptions('positionable', positionable); }\n   }\n\n   /**\n    * Sets `this.options.resizable` which is reactive for application shells.\n    *\n    * @param {boolean}  resizable - Sets the resizable option.\n    */\n   set resizable(resizable)\n   {\n      if (typeof resizable === 'boolean') { this.setOptions('resizable', resizable); }\n   }\n\n   /**\n    * Sets `this.options.title` which is reactive for application shells.\n    *\n    * Note: Will set empty string if title is undefined or null.\n    *\n    * @param {string | undefined | null}   title - Application title; will be localized, so a translation key is fine.\n    */\n   set title(title)\n   {\n      if (typeof title === 'string')\n      {\n         this.setOptions('title', title);\n      }\n      else if (title === void 0 || title === null)\n      {\n         this.setOptions('title', '');\n      }\n   }\n\n   // Reactive Options API -------------------------------------------------------------------------------------------\n\n   /**\n    * Provides a way to safely get this applications options given an accessor string which describes the\n    * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n    * to walk.\n    *\n    * // TODO DOCUMENT the accessor in more detail.\n    *\n    * @param {string}   accessor - The path / key to set. You can set multiple levels.\n    *\n    * @param {*}        [defaultValue] - A default value returned if the accessor is not found.\n    *\n    * @returns {*} Value at the accessor.\n    */\n   getOptions(accessor, defaultValue)\n   {\n      return safeAccess(this.#application.options, accessor, defaultValue);\n   }\n\n   /**\n    * Provides a way to merge `options` into this applications options and update the appOptions store.\n    *\n    * @param {object}   options - The options object to merge with `this.options`.\n    */\n   mergeOptions(options)\n   {\n      this.#storeAppOptionsUpdate((instanceOptions) => deepMerge(instanceOptions, options));\n   }\n\n   /**\n    * Provides a way to safely set this applications options given an accessor string which describes the\n    * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n    * to walk.\n    *\n    * Additionally if an application shell Svelte component is mounted and exports the `appOptions` property then\n    * the application options is set to `appOptions` potentially updating the application shell / Svelte component.\n    *\n    * // TODO DOCUMENT the accessor in more detail.\n    *\n    * @param {string}   accessor - The path / key to set. You can set multiple levels.\n    *\n    * @param {any}      value - Value to set.\n    */\n   setOptions(accessor, value)\n   {\n      const success = safeSet(this.#application.options, accessor, value);\n\n      // If `this.options` modified then update the app options store.\n      if (success)\n      {\n         this.#storeAppOptionsUpdate(() => this.#application.options);\n      }\n   }\n\n   /**\n    * Initializes the Svelte stores and derived stores for the application options and UI state.\n    *\n    * While writable stores are created the update method is stored in private variables locally and derived Readable\n    * stores are provided for essential options which are commonly used.\n    *\n    * These stores are injected into all Svelte components mounted under the `external` context: `storeAppOptions` and\n    * `storeUIState`.\n    */\n   #storesInitialize()\n   {\n      const writableAppOptions = writable(this.#application.options);\n\n      // Keep the update function locally, but make the store essentially readable.\n      this.#storeAppOptionsUpdate = writableAppOptions.update;\n\n      /**\n       * Create custom store. The main subscribe method for all app options changes is provided along with derived\n       * writable stores for all reactive options.\n       *\n       * @type {import('./types').StoreAppOptions}\n       */\n      const storeAppOptions = {\n         subscribe: writableAppOptions.subscribe,\n\n         draggable: propertyStore(writableAppOptions, 'draggable'),\n         focusAuto: propertyStore(writableAppOptions, 'focusAuto'),\n         focusKeep: propertyStore(writableAppOptions, 'focusKeep'),\n         focusTrap: propertyStore(writableAppOptions, 'focusTrap'),\n         headerButtonNoClose: propertyStore(writableAppOptions, 'headerButtonNoClose'),\n         headerButtonNoLabel: propertyStore(writableAppOptions, 'headerButtonNoLabel'),\n         headerIcon: propertyStore(writableAppOptions, 'headerIcon'),\n         headerNoTitleMinimized: propertyStore(writableAppOptions, 'headerNoTitleMinimized'),\n         minimizable: propertyStore(writableAppOptions, 'minimizable'),\n         popOut: propertyStore(writableAppOptions, 'popOut'),\n         positionable: propertyStore(writableAppOptions, 'positionable'),\n         resizable: propertyStore(writableAppOptions, 'resizable'),\n         title: propertyStore(writableAppOptions, 'title')\n      };\n\n      Object.freeze(storeAppOptions);\n\n      this.#storeAppOptions = storeAppOptions;\n\n      this.#dataUIState = {\n         dragging: false,\n         headerButtons: [],\n         minimized: this.#application._minimized,\n         resizing: false\n      };\n\n      // Create a store for UI state data.\n      const writableUIOptions = writable(this.#dataUIState);\n\n      // Keep the update function locally, but make the store essentially readable.\n      this.#storeUIStateUpdate = writableUIOptions.update;\n\n      /**\n       * @type {import('./types').StoreUIOptions}\n       */\n      const storeUIState = {\n         subscribe: writableUIOptions.subscribe,\n\n         dragging: propertyStore(writableUIOptions, 'dragging'),\n         headerButtons: derived(writableUIOptions, ($options, set) => set($options.headerButtons)),\n         minimized: derived(writableUIOptions, ($options, set) => set($options.minimized)),\n         resizing: propertyStore(writableUIOptions, 'resizing')\n      };\n\n      Object.freeze(storeUIState);\n\n      // Initialize the store with options set in the Application constructor.\n      this.#storeUIState = storeUIState;\n   }\n\n   /**\n    * Registers local store subscriptions for app options. `popOut` controls registering this app with `ui.windows`.\n    *\n    * @see SvelteApplication._injectHTML\n    */\n   #storesSubscribe()\n   {\n      // Register local subscriptions.\n\n      // Handles updating header buttons to add / remove the close button.\n      this.#storeUnsubscribe.push(subscribeIgnoreFirst(this.#storeAppOptions.headerButtonNoClose, (value) =>\n      {\n         this.updateHeaderButtons({ headerButtonNoClose: value });\n      }));\n\n      // Handles updating header buttons to add / remove button labels.\n      this.#storeUnsubscribe.push(subscribeIgnoreFirst(this.#storeAppOptions.headerButtonNoLabel, (value) =>\n      {\n         this.updateHeaderButtons({ headerButtonNoLabel: value });\n      }));\n\n      // Handles adding / removing this application from `ui.windows` when popOut changes.\n      this.#storeUnsubscribe.push(subscribeIgnoreFirst(this.#storeAppOptions.popOut, (value) =>\n      {\n         if (value && this.#application.rendered)\n         {\n            globalThis.ui.windows[this.#application.appId] = this.#application;\n         }\n         else\n         {\n            delete globalThis.ui.windows[this.#application.appId];\n         }\n      }));\n   }\n\n   /**\n    * Unsubscribes from any locally monitored stores.\n    *\n    * @see SvelteApplication.close\n    */\n   #storesUnsubscribe()\n   {\n      this.#storeUnsubscribe.forEach((unsubscribe) => unsubscribe());\n      this.#storeUnsubscribe = [];\n   }\n\n   /**\n    * Updates the UI Options store with the current header buttons. You may dynamically add / remove header buttons\n    * if using an application shell Svelte component. In either overriding `_getHeaderButtons` or responding to the\n    * Hooks fired return a new button array and the uiOptions store is updated and the application shell will render\n    * the new buttons.\n    *\n    * Optionally you can set in the SvelteApplication app options {@link SvelteApplicationOptions.headerButtonNoClose}\n    * to remove the close button and {@link SvelteApplicationOptions.headerButtonNoLabel} to true and labels will be\n    * removed from the header buttons.\n    *\n    * @param {object} [opts] - Optional parameters (for internal use)\n    *\n    * @param {boolean} [opts.headerButtonNoClose] - The value for `headerButtonNoClose`.\n    *\n    * @param {boolean} [opts.headerButtonNoLabel] - The value for `headerButtonNoLabel`.\n    */\n   updateHeaderButtons({ headerButtonNoClose = this.#application.options.headerButtonNoClose,\n    headerButtonNoLabel = this.#application.options.headerButtonNoLabel } = {})\n   {\n      let buttons = this.#application._getHeaderButtons();\n\n      // Remove close button if this.options.headerButtonNoClose is true;\n      if (typeof headerButtonNoClose === 'boolean' && headerButtonNoClose)\n      {\n         buttons = buttons.filter((button) => button.class !== 'close');\n      }\n\n      // Remove labels if this.options.headerButtonNoLabel is true;\n      if (typeof headerButtonNoLabel === 'boolean' && headerButtonNoLabel)\n      {\n         for (const button of buttons) { button.label = void 0; }\n      }\n\n      this.#storeUIStateUpdate((options) =>\n      {\n         options.headerButtons = buttons;\n         return options;\n      });\n   }\n}\n\n/**\n * @typedef {object} SvelteReactiveStores\n *\n * @property {(this: void, updater: import('svelte/store').Updater<object>) => void} appOptionsUpdate Update function\n * for app options store.\n *\n * @property {Function} subscribe Subscribes to local stores.\n *\n * @property {(this: void, updater: import('svelte/store').Updater<object>) => void} uiStateUpdate Update function\n * for UI state stores.\n *\n * @property {Function} unsubscribe Unsubscribes from local stores.\n */\n","/**\n * Defines the application shell contract. If Svelte components export getter / setters for the following properties\n * then that component is considered an application shell.\n *\n * @type {string[]}\n */\nconst applicationShellContract = ['elementRoot'];\n\nObject.freeze(applicationShellContract);\n\nexport { applicationShellContract };\n","import { applicationShellContract } from './applicationShellContract.js';\n\n/**\n * Provides a method to determine if the passed in object / Svelte component follows the application shell contract.\n * This involves ensuring that the accessors defined in `applicationShellContract`.\n *\n * Note: A caveat is that when using Vite in a developer build components are wrapped in a proxy / ProxyComponent that\n * defines instance accessors versus on the prototype, so the check below ensures that all accessors in the contract are\n * either available on the prototype or directly on the instance.\n *\n * @param {*}  component - Object / component to test.\n *\n * @returns {boolean} Whether the component is a ApplicationShell or TJSApplicationShell.\n */\nexport function isApplicationShell(component)\n{\n   if (component === null || component === void 0) { return false; }\n\n   let compHasContract = true;\n   let protoHasContract = true;\n\n   // Check for accessors on the instance.\n   for (const accessor of applicationShellContract)\n   {\n      const descriptor = Object.getOwnPropertyDescriptor(component, accessor);\n      if (descriptor === void 0 || descriptor.get === void 0 || descriptor.set === void 0) { compHasContract = false; }\n   }\n\n   // Get the prototype which is the parent SvelteComponent that has any getter / setters.\n   const prototype = Object.getPrototypeOf(component);\n\n   // Verify the application shell contract. If the accessors (getters / setters) are defined for\n   // `applicationShellContract`.\n   for (const accessor of applicationShellContract)\n   {\n      const descriptor = Object.getOwnPropertyDescriptor(prototype, accessor);\n      if (descriptor === void 0 || descriptor.get === void 0 || descriptor.set === void 0) { protoHasContract = false; }\n   }\n\n   return compHasContract || protoHasContract;\n}\n","import { parseTJSSvelteConfig }  from '@typhonjs-fvtt/runtime/svelte/util';\n\nimport { isApplicationShell }    from './isApplicationShell.js';\n\nimport { isObject }              from '@typhonjs-fvtt/runtime/util/object';\n\n/**\n * Instantiates and attaches a Svelte component to the main inserted HTML.\n *\n * @param {object}            [opts] - Optional parameters.\n *\n * @param {object}            [opts.app] - The target application\n *\n * @param {HTMLElement}       [opts.template] - Any HTML template.\n *\n * @param {import('@typhonjs-fvtt/runtime/svelte/util').TJSSvelteConfig}  [opts.config] - Svelte component options\n *\n * @param {Function}          [opts.elementRootUpdate] - A callback to assign to the external context.\n *\n * @returns {import('@typhonjs-fvtt/runtime/svelte/application').SvelteData} The config + instantiated Svelte component.\n */\nexport function loadSvelteConfig({ app, template, config, elementRootUpdate } = {})\n{\n   const svelteOptions = isObject(config.options) ? config.options : {};\n\n   let target;\n\n   // A specific HTMLElement to append Svelte component.\n   if (config.target instanceof HTMLElement)\n   {\n      target = config.target;\n   }\n   // A string target defines a selector to find in existing HTML.\n   else if (template instanceof HTMLElement && typeof config.target === 'string')\n   {\n      target = template.querySelector(config.target);\n   }\n   else                                            // No target defined, create a document fragment.\n   {\n      target = document.createDocumentFragment();\n   }\n\n   if (target === void 0)\n   {\n      console.log(\n       `%c[TRL] loadSvelteConfig error - could not find target selector, '${config.target}', for config:\\n`,\n       'background: rgb(57,34,34)', config);\n\n      throw new Error();\n   }\n\n   const NewSvelteComponent = config.class;\n\n   const svelteConfig = parseTJSSvelteConfig({ ...config, target }, app);\n\n   const externalContext = svelteConfig.context.get('#external');\n\n   // Inject the Foundry application instance and `elementRootUpdate` to the external context.\n   externalContext.application = app;\n   externalContext.elementRootUpdate = elementRootUpdate;\n   externalContext.sessionStorage = app.reactive.sessionStorage;\n\n   let eventbus;\n\n   // Potentially inject any TyphonJS eventbus and track the proxy in the SvelteData instance.\n   if (isObject(app._eventbus) && typeof app._eventbus.createProxy === 'function')\n   {\n      eventbus = app._eventbus.createProxy();\n      externalContext.eventbus = eventbus;\n   }\n\n   // Seal external context so that it can't be extended.\n   Object.seal(externalContext);\n\n   // TODO: Remove deprecation warning in the future -----------------------------------------------------------------\n\n   svelteConfig.context.set('external', new Proxy({}, {\n      get(targetUnused, prop)\n      {\n         console.warn(`[TRL] Deprecation warning: Please change getContext('external') to getContext('#external').`);\n         return externalContext[prop];\n      }\n   }));\n\n   // TODO: Remove deprecation warning in the future -----------------------------------------------------------------\n\n   // Create the Svelte component.\n   /**\n    * @type {import('svelte').SvelteComponent}\n    */\n   const component = new NewSvelteComponent(svelteConfig);\n\n   // Set any eventbus to the config.\n   svelteConfig.eventbus = eventbus;\n\n   /**\n    * @type {HTMLElement}\n    */\n   let element;\n\n   // We can directly get the root element from components which follow the application store contract.\n   if (isApplicationShell(component))\n   {\n      element = component.elementRoot;\n   }\n\n   // Detect if target is a synthesized DocumentFragment with a child element. Child elements will be present\n   // if the Svelte component mounts and renders initial content into the document fragment.\n   if (target instanceof DocumentFragment && target.firstElementChild)\n   {\n      if (element === void 0) { element = target.firstElementChild; }\n      template.append(target);\n   }\n   else if (config.target instanceof HTMLElement && element === void 0)\n   {\n      if (config.target instanceof HTMLElement && typeof svelteOptions.selectorElement !== 'string')\n      {\n         console.log(\n          `%c[TRL] loadSvelteConfig error - HTMLElement target with no 'selectorElement' defined.\\n` +\n          `\\nNote: If configuring an application shell and directly targeting a HTMLElement did you bind an` +\n          `'elementRoot' and include '<svelte:options accessors={true}/>'?\\n` +\n          `\\nOffending config:\\n`, 'background: rgb(57,34,34)', config);\n\n         throw new Error();\n      }\n\n      // The target is an HTMLElement so find the Application element from `selectorElement` option.\n      element = target.querySelector(svelteOptions.selectorElement);\n\n      if (element === null || element === void 0)\n      {\n         console.log(\n          `%c[TRL] loadSvelteConfig error - HTMLElement target with 'selectorElement', '${\n           svelteOptions.selectorElement}', not found for config:\\n`,\n          'background: rgb(57,34,34)', config);\n\n         throw new Error();\n      }\n   }\n\n   // If the configuration / original target is an HTML element then do not inject HTML.\n   const injectHTML = !(config.target instanceof HTMLElement);\n\n   return { config: svelteConfig, component, element, injectHTML };\n}\n","/**\n * Provides an index of all visible rendered {@link SvelteApplication} instances in a given Svelte runtime. This allows\n * bulk operations to be performed across all apps.\n */\nexport class TJSAppIndex\n{\n   /**\n    * Stores all visible / rendered apps.\n    *\n    * @type {Map<string, import('@typhonjs-fvtt/runtime/svelte/application').SvelteApplication>}\n    */\n   static #visibleApps = new Map();\n\n   /**\n    * Adds a SvelteApplication to all visible apps tracked.\n    *\n    * @param {import('@typhonjs-fvtt/runtime/svelte/application').SvelteApplication} app - A SvelteApplication\n    *\n    * @package\n    */\n   static add(app)\n   {\n      this.#visibleApps.set(app.id, app);\n   }\n\n   /**\n    * Removes a SvelteApplication from all visible apps tracked.\n    *\n    * @param {import('@typhonjs-fvtt/runtime/svelte/application').SvelteApplication} app - A SvelteApplication\n    *\n    * @package\n    */\n   static delete(app)\n   {\n      this.#visibleApps.delete(app.id);\n   }\n\n   /**\n    * Gets a particular app by ID.\n    *\n    * @param {string}   key - App ID.\n    *\n    * @returns {import('@typhonjs-fvtt/runtime/svelte/application').SvelteApplication} Associated app.\n    */\n   static get(key)\n   {\n      return this.#visibleApps.get(key);\n   }\n\n   /**\n    * Returns whether an associated app by ID is being tracked.\n    *\n    * @param {string}   key - App ID.\n    *\n    * @returns {boolean} The given App ID is visible.\n    */\n   static has(key)\n   {\n      return this.#visibleApps.has(key);\n   }\n\n   /**\n    * @returns {IterableIterator<string>} All visible app IDs.\n    */\n   static keys()\n   {\n      return this.#visibleApps.keys();\n   }\n\n   /**\n    * @returns {IterableIterator<import('@typhonjs-fvtt/runtime/svelte/application').SvelteApplication>} All visible apps.\n    */\n   static values()\n   {\n      return this.#visibleApps.values();\n   }\n}\n","import { TJSPosition }  from '@typhonjs-fvtt/runtime/svelte/store/position';\n\nimport {\n   isHMRProxy,\n   outroAndDestroy }    from '@typhonjs-fvtt/runtime/svelte/util';\n\nimport { A11yHelper }   from '@typhonjs-fvtt/runtime/util/browser';\n\nimport {\n   deepMerge,\n   hasGetter,\n   isIterable,\n   isObject }           from '@typhonjs-fvtt/runtime/util/object';\n\nimport {\n   ApplicationState,\n   GetSvelteData,\n   loadSvelteConfig,\n   isApplicationShell,\n   SvelteReactive,\n   TJSAppIndex }        from './internal/index.js';\n\n/**\n * Provides a Svelte aware extension to the Foundry {@link Application} class to manage the app lifecycle\n * appropriately. You can declaratively load one or more components from `defaultOptions` using a\n * {@link TJSSvelteConfig} object in the SvelteApplicationOptions `options` {@link SvelteApplicationOptions.svelte}\n * property.\n */\nexport class SvelteApplication extends Application\n{\n   /**\n    * Stores the first mounted component which follows the application shell contract.\n    *\n    * @type {import('./internal/state-svelte/types').MountedAppShell[]|null[]} Application shell.\n    */\n   #applicationShellHolder = [null];\n\n   /**\n    * Stores and manages application state for saving / restoring / serializing.\n    *\n    * @type {ApplicationState<SvelteApplication>}\n    */\n   #applicationState;\n\n   /**\n    * Stores the target element which may not necessarily be the main element.\n    *\n    * @type {HTMLElement}\n    */\n   #elementTarget = null;\n\n   /**\n    * Stores the content element which is set for application shells.\n    *\n    * @type {HTMLElement}\n    */\n   #elementContent = null;\n\n   /**\n    * Stores initial z-index from `_renderOuter` to set to target element / Svelte component.\n    *\n    * @type {number}\n    */\n   #initialZIndex = 95;\n\n   /**\n    * Stores on mount state which is checked in _render to trigger onSvelteMount callback.\n    *\n    * @type {boolean}\n    */\n   #onMount = false;\n\n   /**\n    * The position store.\n    *\n    * @type {TJSPosition}\n    */\n   #position;\n\n   /**\n    * Contains the Svelte stores and reactive accessors.\n    *\n    * @type {SvelteReactive}\n    */\n   #reactive;\n\n   /**\n    * Stores SvelteData entries with instantiated Svelte components.\n    *\n    * @type {import('./internal/state-svelte/types').SvelteData[]}\n    */\n   #svelteData = [];\n\n   /**\n    * Provides a helper class that combines multiple methods for interacting with the mounted components tracked in\n    * #svelteData.\n    *\n    * @type {GetSvelteData}\n    */\n   #getSvelteData = new GetSvelteData(this.#applicationShellHolder, this.#svelteData);\n\n   /**\n    * Contains methods to interact with the Svelte stores.\n    *\n    * @type {import('./internal/state-reactive/SvelteReactive').SvelteReactiveStores}\n    */\n   #stores;\n\n   /**\n    * @param {import('@typhonjs-fvtt/runtime/svelte/application').SvelteApplicationOptions} options - The options for the application.\n    *\n    * @inheritDoc\n    */\n   constructor(options = {})\n   {\n      super(options);\n\n      /** @type {ApplicationState<SvelteApplication>} */\n      this.#applicationState = new ApplicationState(this);\n\n      // Initialize TJSPosition with the position object set by Application.\n      this.#position = new TJSPosition(this, {\n         ...this.position,\n         ...this.options,\n         initial: this.options.positionInitial,\n         ortho: this.options.positionOrtho,\n         validator: this.options.positionValidator\n      });\n\n      // Remove old position field.\n      delete this.position;\n\n      /**\n       * Define accessors to retrieve TJSPosition by `this.position`.\n       *\n       * @member {TJSPosition} position - Adds accessors to SvelteApplication to get / set the position data.\n       *\n       * @memberof SvelteApplication#\n       */\n      Object.defineProperty(this, 'position', {\n         get: () => this.#position,\n         set: (position) => { if (isObject(position)) { this.#position.set(position); } }\n      });\n\n      this.#reactive = new SvelteReactive(this);\n\n      this.#stores = this.#reactive.initialize();\n   }\n\n   /**\n    * Specifies the default options that SvelteApplication supports.\n    *\n    * @returns {import('@typhonjs-fvtt/runtime/svelte/application').SvelteApplicationOptions} options - Application options.\n    * @see https://foundryvtt.com/api/interfaces/client.ApplicationOptions.html\n    *\n    * @internal\n    */\n   static get defaultOptions()\n   {\n      return deepMerge(super.defaultOptions, {\n         defaultCloseAnimation: true,     // If false the default slide close animation is not run.\n         draggable: true,                 // If true then application shells are draggable.\n         focusAuto: true,                 // When true auto-management of app focus is enabled.\n         focusKeep: false,                // When `focusAuto` and `focusKeep` is true; keeps internal focus.\n         focusSource: void 0,             // Stores any A11yFocusSource data that is applied when app is closed.\n         focusTrap: true,                 // When true focus trapping / wrapping is enabled keeping focus inside app.\n         headerButtonNoClose: false,      // If true then the close header button is removed.\n         headerButtonNoLabel: false,      // If true then header button labels are removed for application shells.\n         headerIcon: void 0,              // Sets a header icon given an image URL.\n         headerNoTitleMinimized: false,   // If true then header title is hidden when application is minimized.\n         minHeight: MIN_WINDOW_HEIGHT,    // Assigned to position. Number specifying minimum window height.\n         minWidth: MIN_WINDOW_WIDTH,      // Assigned to position. Number specifying minimum window width.\n         positionable: true,              // If false then `position.set` does not take effect.\n         positionInitial: TJSPosition.Initial.browserCentered,      // A helper for initial position placement.\n         positionOrtho: true,             // When true TJSPosition is optimized for orthographic use.\n         positionValidator: TJSPosition.Validators.transformWindow, // A function providing the default validator.\n         sessionStorage: void 0,          // An instance of TJSWebStorage (session) to share across SvelteApplications.\n         svelte: void 0,                  // A Svelte configuration object.\n         transformOrigin: 'top left'      // By default, 'top / left' respects rotation when minimizing.\n      });\n   }\n\n   /**\n    * Returns the content element if an application shell is mounted.\n    *\n    * @returns {HTMLElement} Content element.\n    */\n   get elementContent() { return this.#elementContent; }\n\n   /**\n    * Returns the target element or main element if no target defined.\n    *\n    * @returns {HTMLElement} Target element.\n    */\n   get elementTarget() { return this.#elementTarget; }\n\n   /**\n    * Returns the reactive accessors & Svelte stores for SvelteApplication.\n    *\n    * @returns {import('./internal/state-reactive/types').SvelteReactive} The reactive accessors & Svelte stores.\n    */\n   get reactive() { return this.#reactive; }\n\n   /**\n    * Returns the application state manager.\n    *\n    * @returns {import('./internal/state-app/types').ApplicationState<SvelteApplication>} The application state manager.\n    */\n   get state() { return this.#applicationState; }\n\n   /**\n    * Returns the Svelte helper class w/ various methods to access mounted Svelte components.\n    *\n    * @returns {import('./internal/state-svelte/types').GetSvelteData} GetSvelteData\n    */\n   get svelte() { return this.#getSvelteData; }\n\n   /**\n    * In this case of when a template is defined in app options `html` references the inner HTML / template. However,\n    * to activate classic v1 tabs for a Svelte component the element target is passed as an array simulating JQuery as\n    * the element is retrieved immediately and the core listeners use standard DOM queries.\n    *\n    * @protected\n    * @ignore\n    * @internal\n    */\n   _activateCoreListeners(html)\n   {\n      super._activateCoreListeners(typeof this.options.template === 'string' ? html :\n       [this.popOut ? this.#elementTarget?.firstChild : this.#elementTarget]);\n   }\n\n   /**\n    * Provide an override to set this application as the active window regardless of z-index. Changes behaviour from\n    * Foundry core. This is important / used for instance in dialog key handling for left / right button selection.\n    *\n    * @param {object} [opts] - Optional parameters.\n    *\n    * @param {boolean} [opts.force=false] - Force bring to top; will increment z-index by popOut order.\n    *\n    * @ignore\n    * @internal\n    */\n   bringToTop({ force = false } = {})\n   {\n      if (force || this.popOut) { super.bringToTop(); }\n\n      // If the activeElement is not `document.body` and not contained in this app via elementTarget then blur the\n      // current active element and make `document.body`focused. This allows <esc> key to close all open apps / windows.\n      if (document.activeElement !== document.body && !this.elementTarget.contains(document.activeElement))\n      {\n         // Blur current active element.\n         if (document.activeElement instanceof HTMLElement) { document.activeElement.blur(); }\n\n         // Make document body focused.\n         document.body.focus();\n      }\n\n      globalThis.ui.activeWindow = this;\n   }\n\n   /**\n    * Note: This method is fully overridden and duplicated as Svelte components need to be destroyed manually and the\n    * best visual result is to destroy them after the default slide up animation occurs, but before the element\n    * is removed from the DOM.\n    *\n    * If you destroy the Svelte components before the slide up animation the Svelte elements are removed immediately\n    * from the DOM. The purpose of overriding ensures the slide up animation is always completed before\n    * the Svelte components are destroyed and then the element is removed from the DOM.\n    *\n    * Close the application and un-register references to it within UI mappings.\n    * This function returns a Promise which resolves once the window closing animation concludes\n    *\n    * @param {object}   [options] - Optional parameters.\n    *\n    * @param {boolean}  [options.force] - Force close regardless of render state.\n    *\n    * @returns {Promise<void>}    A Promise which resolves once the application is closed.\n    *\n    * @ignore\n    * @internal\n    */\n   async close(options = {})\n   {\n      const states = Application.RENDER_STATES;\n      if (!options.force && ![states.RENDERED, states.ERROR].includes(this._state)) { return; }\n\n      // Unsubscribe from any local stores.\n      this.#stores.unsubscribe();\n\n      /**\n       * @ignore\n       * @internal\n       */\n      this._state = states.CLOSING;\n\n      /**\n       * Get the element.\n       *\n       * @type {HTMLElement}\n       */\n      const el = this.#elementTarget;\n      if (!el) { return this._state = states.CLOSED; }\n\n      // Make any window content overflow hidden to avoid any scrollbars appearing in default or Svelte outro\n      // transitions.\n      const content = el.querySelector('.window-content');\n      if (content)\n      {\n         content.style.overflow = 'hidden';\n\n         // Set all children of content to overflow hidden as if there is going to be additional scrolling elements\n         // they are likely one level deep.\n         for (let cntr = content.children.length; --cntr >= 0;)\n         {\n            content.children[cntr].style.overflow = 'hidden';\n         }\n      }\n\n      // Dispatch Hooks for closing the base and subclass applications\n      for (const cls of this.constructor._getInheritanceChain())\n      {\n         /**\n          * A hook event that fires whenever this Application is closed.\n          *\n          * Note: JQuery wrapping as Foundry event arguments uses JQuery.\n          */\n         Hooks.call(`close${cls.name}`, this, $(el));\n      }\n\n      // If options `defaultCloseAnimation` is false then do not execute the standard slide up animation.\n      // This allows Svelte components to provide any out transition. Application shells will automatically set\n      // `defaultCloseAnimation` based on any out transition set or unset.\n      const animate = typeof this.options.defaultCloseAnimation === 'boolean' ? this.options.defaultCloseAnimation :\n       true;\n\n      if (animate)\n      {\n         // Set min height for full slide.\n         el.style.minHeight = '0';\n\n         const { paddingBottom, paddingTop } = globalThis.getComputedStyle(el);\n\n         // Slide-up application.\n         await el.animate([\n            { maxHeight: `${el.clientHeight}px`, paddingTop, paddingBottom },\n            { maxHeight: 0, paddingTop: 0, paddingBottom: 0 }\n         ], { duration: 250, easing: 'ease-in', fill: 'forwards' }).finished;\n      }\n\n      // Stores the Promises returned from running outro transitions and destroying each Svelte component.\n      const svelteDestroyPromises = [];\n\n      // Manually invoke the destroy callbacks for all Svelte components.\n      for (const entry of this.#svelteData)\n      {\n         // Use `outroAndDestroy` to run outro transitions before destroying.\n         svelteDestroyPromises.push(outroAndDestroy(entry.component));\n\n         // If any proxy eventbus has been added then remove all event registrations from the component.\n         const eventbus = entry.config.eventbus;\n         if (isObject(eventbus) && typeof eventbus.off === 'function')\n         {\n            eventbus.off();\n            entry.config.eventbus = void 0;\n         }\n      }\n\n      // Await all Svelte components to destroy.\n      await Promise.all(svelteDestroyPromises);\n\n      // Remove from all visible apps tracked.\n      TJSAppIndex.delete(this);\n\n      // Reset SvelteData like this to maintain reference to GetSvelteData / `this.svelte`.\n      this.#svelteData.length = 0;\n\n      // Remove element from the DOM. Most SvelteComponents have already removed it.\n      el.remove();\n\n      // Silently restore any width / height state before minimized as applicable.\n      this.position.state.restore({\n         name: '#beforeMinimized',\n         properties: ['width', 'height'],\n         silent: true,\n         remove: true\n      });\n\n      // Clean up data\n      this.#applicationShellHolder[0] = null;\n\n      /**\n       * @ignore\n       * @internal\n       */\n      this._element = null;\n      this.#elementContent = null;\n      this.#elementTarget = null;\n\n      delete globalThis.ui.windows[this.appId];\n\n      /**\n       * @ignore\n       * @internal\n       */\n      this._minimized = false;\n\n      /**\n       * @ignore\n       * @internal\n       */\n      this._scrollPositions = null;\n\n      /**\n       * @ignore\n       * @internal\n       */\n      this._state = states.CLOSED;\n\n      this.#onMount = false;\n\n      // Update the minimized UI store state.\n      this.#stores.uiStateUpdate((storeOptions) => deepMerge(storeOptions, { minimized: this._minimized }));\n\n      // Apply any stored focus options and then remove them from options.\n      A11yHelper.applyFocusSource(this.options.focusSource);\n\n      delete this.options.focusSource;\n   }\n\n   /**\n    * Inject the Svelte components defined in `this.options.svelte`. The Svelte component can attach to the existing\n    * pop-out of Application or provide no template and render into a document fragment which is then attached to the\n    * DOM.\n    *\n    * @protected\n    * @ignore\n    * @internal\n    */\n   _injectHTML(html)\n   {\n      if (this.popOut && html.length === 0 && isIterable(this.options.svelte))\n      {\n         throw new Error(\n          'SvelteApplication - _injectHTML - A popout app with no template can only support one Svelte component.');\n      }\n\n      // Make sure the store is updated with the latest header buttons. Also allows filtering buttons before display.\n      this.reactive.updateHeaderButtons();\n\n      // Create a function to generate a callback for Svelte components to invoke to update the tracked elements for\n      // application shells in the rare cases that the main element root changes. The update is only trigged on\n      // successive changes of `elementRoot`. Returns a boolean to indicate the element roots are updated.\n      const elementRootUpdate = () =>\n      {\n         let cntr = 0;\n\n         return (elementRoot) =>\n         {\n            if (elementRoot !== null && elementRoot !== void 0 && cntr++ > 0)\n            {\n               this.#updateApplicationShell();\n               return true;\n            }\n\n            return false;\n         };\n      };\n\n      if (isIterable(this.options.svelte))\n      {\n         for (const svelteConfig of this.options.svelte)\n         {\n            const svelteData = loadSvelteConfig({\n               app: this,\n               template: html[0],\n               config: svelteConfig,\n               elementRootUpdate\n            });\n\n            if (isApplicationShell(svelteData.component))\n            {\n               if (this.svelte.applicationShell !== null)\n               {\n                  throw new Error(\n                   `SvelteApplication - _injectHTML - An application shell is already mounted; offending config:\n                    ${JSON.stringify(svelteConfig)}`);\n               }\n\n               this.#applicationShellHolder[0] = svelteData.component;\n\n               // If Vite / HMR / svelte_hmr is enabled then add a hook to receive callbacks when the ProxyComponent\n               // refreshes. Update the element root accordingly and force an update to TJSPosition.\n               // See this issue for info about `on_hmr`:\n               // https://github.com/sveltejs/svelte-hmr/issues/57\n               if (isHMRProxy(svelteData.component) && Array.isArray(svelteData.component?.$$?.on_hmr))\n               {\n                  svelteData.component.$$.on_hmr.push(() => () => this.#updateApplicationShell());\n               }\n            }\n\n            this.#svelteData.push(svelteData);\n         }\n      }\n      else if (isObject(this.options.svelte))\n      {\n         const svelteData = loadSvelteConfig({\n            app: this,\n            template: html[0],\n            config: this.options.svelte,\n            elementRootUpdate\n         });\n\n         if (isApplicationShell(svelteData.component))\n         {\n            // A sanity check as shouldn't hit this case as only one component is being mounted.\n            if (this.svelte.applicationShell !== null)\n            {\n               throw new Error(\n                `SvelteApplication - _injectHTML - An application shell is already mounted; offending config:\n                 ${JSON.stringify(this.options.svelte)}`);\n            }\n\n            this.#applicationShellHolder[0] = svelteData.component;\n\n            // If Vite / HMR / svelte_hmr is enabled then add a hook to receive callbacks when the ProxyComponent\n            // refreshes. Update the element root accordingly and force an update to TJSPosition.\n            // See this issue for info about `on_hmr`:\n            // https://github.com/sveltejs/svelte-hmr/issues/57\n            if (isHMRProxy(svelteData.component) && Array.isArray(svelteData.component?.$$?.on_hmr))\n            {\n               svelteData.component.$$.on_hmr.push(() => () => this.#updateApplicationShell());\n            }\n         }\n\n         this.#svelteData.push(svelteData);\n      }\n\n      // Detect if this is a synthesized DocumentFragment.\n      const isDocumentFragment = html.length && html[0] instanceof DocumentFragment;\n\n      // If any of the Svelte components mounted directly targets an HTMLElement then do not inject HTML.\n      let injectHTML = true;\n      for (const svelteData of this.#svelteData)\n      {\n         if (!svelteData.injectHTML) { injectHTML = false; break; }\n      }\n      if (injectHTML) { super._injectHTML(html); }\n\n      if (this.svelte.applicationShell !== null)\n      {\n         this._element = $(this.svelte.applicationShell.elementRoot);\n\n         // Detect if the application shell exports an `elementContent` accessor.\n         this.#elementContent = hasGetter(this.svelte.applicationShell, 'elementContent') ?\n          this.svelte.applicationShell.elementContent : null;\n\n         // Detect if the application shell exports an `elementTarget` accessor.\n         this.#elementTarget = hasGetter(this.svelte.applicationShell, 'elementTarget') ?\n          this.svelte.applicationShell.elementTarget : null;\n      }\n      else if (isDocumentFragment) // Set the element of the app to the first child element in order of Svelte components mounted.\n      {\n         for (const svelteData of this.#svelteData)\n         {\n            if (svelteData.element instanceof HTMLElement)\n            {\n               this._element = $(svelteData.element);\n               break;\n            }\n         }\n      }\n\n      // Potentially retrieve a specific target element if `selectorTarget` is defined otherwise make the target the\n      // main element.\n      if (this.#elementTarget === null)\n      {\n         this.#elementTarget = typeof this.options.selectorTarget === 'string' ?\n          this._element[0].querySelector(this.options.selectorTarget) : this._element[0];\n      }\n\n      if (this.#elementTarget === null || this.#elementTarget === void 0)\n      {\n         throw new Error(`SvelteApplication - _injectHTML: Target element '${this.options.selectorTarget}' not found.`);\n      }\n\n      // The initial zIndex may be set in application options or for popOut applications is stored by `_renderOuter`\n      // in `this.#initialZIndex`.\n      if (typeof this.options.positionable === 'boolean' && this.options.positionable)\n      {\n         this.#elementTarget.style.zIndex = typeof this.options.zIndex === 'number' ? this.options.zIndex :\n          this.#initialZIndex ?? 95;\n      }\n\n      // Subscribe to local store handling.\n      this.#stores.subscribe();\n   }\n\n   /**\n    * Provides a mechanism to update the UI options store for maximized.\n    *\n    * Note: the sanity check is duplicated from {@link Application.maximize} the store is updated _before_\n    * performing the rest of animations. This allows application shells to remove / show any resize handlers\n    * correctly. Extra constraint data is stored in a saved position state in {@link SvelteApplication.minimize}\n    * to animate the content area.\n    *\n    * @param {object}   [opts] - Optional parameters.\n    *\n    * @param {boolean}  [opts.animate=true] - When true perform default maximizing animation.\n    *\n    * @param {number}   [opts.duration=0.1] - Controls content area animation duration in seconds.\n    */\n   async maximize({ animate = true, duration = 0.1 } = {})\n   {\n      if (!this.popOut || [false, null].includes(this._minimized)) { return; }\n\n      this._minimized = null;\n\n      const durationMS = duration * 1000; // For WAAPI.\n\n      // Get content\n      const element = this.elementTarget;\n      const header = element.querySelector('.window-header');\n      const content = element.querySelector('.window-content');\n\n      // Get the complete position before minimized. Used to reset min width & height to initial values later.\n      const positionBefore = this.position.state.get({ name: '#beforeMinimized' });\n\n      // First animate / restore width / async.\n      if (animate)\n      {\n         await this.position.state.restore({\n            name: '#beforeMinimized',\n            async: true,\n            animateTo: true,\n            properties: ['width'],\n            duration: 0.1\n         });\n      }\n\n      element.classList.remove('minimized');\n\n      // Reset display none on all children of header.\n      for (let cntr = header.children.length; --cntr >= 0;) { header.children[cntr].style.display = null; }\n\n      content.style.display = null;\n\n      let constraints;\n\n      if (animate)\n      {\n         // Next animate / restore height synchronously and remove key. Retrieve constraints data for slide up animation\n         // below.\n         ({ constraints } = this.position.state.restore({\n            name: '#beforeMinimized',\n            animateTo: true,\n            properties: ['height'],\n            remove: true,\n            duration\n         }));\n      }\n      else\n      {\n         ({ constraints } = this.position.state.remove({ name: '#beforeMinimized' }));\n      }\n\n      // Slide down content with stored constraints.\n      await content.animate([\n         { maxHeight: 0, paddingTop: 0, paddingBottom: 0, offset: 0 },\n         { ...constraints, offset: 1 },\n         { maxHeight: '100%', offset: 1 },\n      ], { duration: durationMS, fill: 'forwards' }).finished; // WAAPI in ms.\n\n      // Restore previous min width & height from saved data, app options, or default Foundry values.\n      this.position.set({\n         minHeight: positionBefore.minHeight ?? this.options?.minHeight ?? MIN_WINDOW_HEIGHT,\n         minWidth: positionBefore.minWidth ?? this.options?.minWidth ?? MIN_WINDOW_WIDTH,\n      });\n\n      // Remove inline styles that override any styles assigned to the app.\n      element.style.minWidth = null;\n      element.style.minHeight = null;\n\n      this._minimized = false;\n\n      // Using a 50ms timeout prevents any instantaneous display of scrollbars with the above maximize animation.\n      setTimeout(() =>\n      {\n         content.style.overflow = null;\n\n         // Reset all children of content removing overflow hidden.\n         for (let cntr = content.children.length; --cntr >= 0;)\n         {\n            content.children[cntr].style.overflow = null;\n         }\n      }, 50);\n\n      this.#stores.uiStateUpdate((options) => deepMerge(options, { minimized: false }));\n   }\n\n   /**\n    * Provides a mechanism to update the UI options store for minimized.\n    *\n    * Note: the sanity check is duplicated from {@link Application.minimize} the store is updated _before_\n    * performing the rest of animations. This allows application shells to remove / show any resize handlers\n    * correctly. Extra constraint data is stored in a saved position state in {@link SvelteApplication.minimize}\n    * to animate the content area.\n    *\n    * @param {object}   [opts] - Optional parameters\n    *\n    * @param {boolean}  [opts.animate=true] - When true perform default minimizing animation.\n    *\n    * @param {number}   [opts.duration=0.1] - Controls content area animation duration in seconds.\n    */\n   async minimize({ animate = true, duration = 0.1 } = {})\n   {\n      if (!this.rendered || !this.popOut || [true, null].includes(this._minimized)) { return; }\n\n      this.#stores.uiStateUpdate((options) => deepMerge(options, { minimized: true }));\n\n      this._minimized = null;\n\n      const durationMS = duration * 1000; // For WAAPI.\n\n      const element = this.elementTarget;\n\n      // Get content\n      const header = element.querySelector('.window-header');\n      const content = element.querySelector('.window-content');\n\n      // Save current max / min height & width.\n      const beforeMinWidth = this.position.minWidth;\n      const beforeMinHeight = this.position.minHeight;\n\n      // Set minimized min width & height for header bar.\n      this.position.set({ minWidth: 100, minHeight: 30 });\n\n      // Also set inline styles to override any styles scoped to the app.\n      element.style.minWidth = '100px';\n      element.style.minHeight = '30px';\n\n      if (content)\n      {\n         content.style.overflow = 'hidden';\n\n         // Set all children of content to overflow hidden as if there is going to be additional scrolling elements\n         // they are likely one level deep.\n         for (let cntr = content.children.length; --cntr >= 0;)\n         {\n            content.children[cntr].style.overflow = 'hidden';\n         }\n      }\n\n      const { paddingBottom, paddingTop } = globalThis.getComputedStyle(content);\n\n      // Extra data that is saved with the current position. Used during `maximize`.\n      const constraints = {\n         maxHeight: `${content.clientHeight}px`,\n         paddingTop,\n         paddingBottom\n      };\n\n      // Slide-up content\n      if (animate)\n      {\n         const animation = content.animate([\n            constraints,\n            { maxHeight: 0, paddingTop: 0, paddingBottom: 0 }\n         ], { duration: durationMS, fill: 'forwards' }); // WAAPI in ms.\n\n         // Set display style to none when animation finishes.\n         animation.finished.then(() => content.style.display = 'none');\n      }\n      else\n      {\n         setTimeout(() => content.style.display = 'none', durationMS);\n      }\n\n      // Save current position state and add the constraint data to use in `maximize`.\n      const saved = this.position.state.save({ name: '#beforeMinimized', constraints });\n\n      // Set the initial before min width & height.\n      saved.minWidth = beforeMinWidth;\n      saved.minHeight = beforeMinHeight;\n\n      const headerOffsetHeight = header.offsetHeight;\n\n      // minHeight needs to be adjusted to header height.\n      this.position.minHeight = headerOffsetHeight;\n\n      if (animate)\n      {\n         // First await animation of height upward.\n         await this.position.animate.to({ height: headerOffsetHeight }, { duration }).finished;\n      }\n\n      // Set all header buttons besides close and the window title to display none.\n      for (let cntr = header.children.length; --cntr >= 0;)\n      {\n         const className = header.children[cntr].className;\n\n         if (className.includes('window-title') || className.includes('close')) { continue; }\n\n         // v10+ of Foundry core styles automatically hides anything besides the window title and close button, so\n         // explicitly set display to block.\n         if (className.includes('keep-minimized'))\n         {\n            header.children[cntr].style.display = 'block';\n            continue;\n         }\n\n         header.children[cntr].style.display = 'none';\n      }\n\n      if (animate)\n      {\n         // Await animation of width to the left / minimum width.\n         await this.position.animate.to({ width: MIN_WINDOW_WIDTH }, { duration: 0.1 }).finished;\n      }\n\n      element.classList.add('minimized');\n\n      this._minimized = true;\n   }\n\n   /**\n    * Provides a callback after all Svelte components are initialized.\n    *\n    * @param {import('./internal/state-svelte/types').MountedAppShell} [mountedAppShell] - The mounted app shell\n    *        elements.\n    */\n   onSvelteMount(mountedAppShell) {} // eslint-disable-line no-unused-vars\n\n   /**\n    * Provides a callback after the main application shell is remounted. This may occur during HMR / hot module\n    * replacement or directly invoked from the `elementRootUpdate` callback passed to the application shell component\n    * context.\n    *\n    * @param {import('./internal/state-svelte/types').MountedAppShell} [mountedAppShell] - The mounted app shell\n    *        elements.\n    */\n   onSvelteRemount(mountedAppShell) {} // eslint-disable-line no-unused-vars\n\n   /**\n    * Override replacing HTML as Svelte components control the rendering process. Only potentially change the outer\n    * application frame / title for pop-out applications.\n    *\n    * @protected\n    * @ignore\n    * @internal\n    */\n   _replaceHTML(element, html)  // eslint-disable-line no-unused-vars\n   {\n      if (!element.length) { return; }\n\n      this.reactive.updateHeaderButtons();\n   }\n\n   /**\n    * Provides an override verifying that a new Application being rendered for the first time doesn't have a\n    * corresponding DOM element already loaded. This is a check that only occurs when `this._state` is\n    * `Application.RENDER_STATES.NONE`. It is useful in particular when SvelteApplication has a static ID\n    * explicitly set in `this.options.id` and long intro / outro transitions are assigned. If a new application\n    * sharing this static ID attempts to open / render for the first time while an existing DOM element sharing\n    * this static ID exists then the initial render is cancelled below rather than crashing later in the render\n    * cycle {@link TJSPosition.set}.\n    *\n    * @protected\n    * @ignore\n    * @internal\n    */\n   async _render(force = false, options = {})\n   {\n      // Store any focusSource instance.\n      if (isObject(options?.focusSource)) { this.options.focusSource = options.focusSource; }\n\n      if (this._state === Application.RENDER_STATES.NONE &&\n       document.querySelector(`#${this.id}`) instanceof HTMLElement)\n      {\n         console.warn(`SvelteApplication - _render: A DOM element already exists for CSS ID '${this.id\n         }'. Cancelling initial render for new application with appId '${this.appId}'.`);\n\n         return;\n      }\n\n      await super._render(force, options);\n\n      // Handle the same render exclusion tests that reject a render in Application.\n\n      // Do not render under certain conditions.\n      if ([Application.RENDER_STATES.CLOSING, Application.RENDER_STATES.RENDERING].includes(this._state)) { return; }\n\n      // Applications which are not currently rendered must be forced.\n      if (!force && (this._state <= Application.RENDER_STATES.NONE)) { return; }\n\n      // It is necessary to directly invoke `position.set` as TJSPosition uses accessors and is not a bare object, so\n      // the merging that occurs is `Application._render` does not take effect.\n      if (!this._minimized) { this.#position.set(options); }\n\n      if (!this.#onMount)\n      {\n         // Add to visible apps tracked.\n         TJSAppIndex.add(this);\n\n         this.onSvelteMount({ element: this._element[0], elementContent: this.#elementContent, elementTarget:\n          this.#elementTarget });\n\n         this.#onMount = true;\n      }\n   }\n\n   /**\n    * Render the inner application content. Only render a template if one is defined otherwise provide an empty\n    * JQuery element per the core Foundry API.\n    *\n    * @protected\n    * @ignore\n    * @internal\n    */\n   async _renderInner(data)\n   {\n      const html = typeof this.template === 'string' ? await renderTemplate(this.template, data) :\n       document.createDocumentFragment();\n\n      return $(html);\n   }\n\n   /**\n    * Stores the initial z-index set in `_renderOuter` which is used in `_injectHTML` to set the target element\n    * z-index after the Svelte component is mounted.\n    *\n    * @protected\n    * @ignore\n    * @internal\n    */\n   async _renderOuter()\n   {\n      const html = await super._renderOuter();\n      this.#initialZIndex = html[0].style.zIndex;\n      return html;\n   }\n\n   /**\n    * All calculation and updates of position are implemented in {@link TJSPosition.set}. This allows position to be fully\n    * reactive and in control of updating inline styles for the application.\n    *\n    * This method remains for backward compatibility with Foundry. If you have a custom override quite likely you need\n    * to update to using the {@link TJSPosition.validators} functionality.\n    *\n    * @param {import('@typhonjs-fvtt/runtime/svelte/store/position').TJSPositionDataExtended}   [position] - TJSPosition data.\n    *\n    * @returns {TJSPosition} The updated position object for the application containing the new values.\n    * @ignore\n    */\n   setPosition(position)\n   {\n      return this.position.set(position);\n   }\n\n   /**\n    * This method is invoked by the `elementRootUpdate` callback that is added to the external context passed to\n    * Svelte components. When invoked it updates the local element roots tracked by SvelteApplication.\n    *\n    * This method may also be invoked by HMR / hot module replacement via `svelte-hmr`.\n    */\n   #updateApplicationShell()\n   {\n      const applicationShell = this.svelte.applicationShell;\n\n      if (applicationShell !== null)\n      {\n         this._element = $(applicationShell.elementRoot);\n\n         // Detect if the application shell exports an `elementContent` accessor.\n         this.#elementContent = hasGetter(applicationShell, 'elementContent') ?\n          applicationShell.elementContent : null;\n\n         // Detect if the application shell exports an `elementTarget` accessor.\n         this.#elementTarget = hasGetter(applicationShell, 'elementTarget') ?\n          applicationShell.elementTarget : null;\n\n         if (this.#elementTarget === null)\n         {\n            this.#elementTarget = typeof this.options.selectorTarget === 'string' ?\n             this._element[0].querySelector(this.options.selectorTarget) : this._element[0];\n         }\n\n         // The initial zIndex may be set in application options or for popOut applications is stored by `_renderOuter`\n         // in `this.#initialZIndex`.\n         if (typeof this.options.positionable === 'boolean' && this.options.positionable)\n         {\n            this.#elementTarget.style.zIndex = typeof this.options.zIndex === 'number' ? this.options.zIndex :\n             this.#initialZIndex ?? 95;\n\n            super.bringToTop();\n\n            // Ensure that new root element has inline position styles set.\n            this.position.set(this.position.get());\n         }\n\n         super._activateCoreListeners([this.popOut ? this.#elementTarget?.firstChild : this.#elementTarget]);\n\n         this.onSvelteRemount({ element: this._element[0], elementContent: this.#elementContent, elementTarget:\n          this.#elementTarget });\n      }\n   }\n}\n","/**\n * Provides management of a single Promise that can be shared and accessed across JS & Svelte components. This allows a\n * Promise to be created and managed as part of the TRL application lifecycle and accessed safely in various control\n * flow scenarios. When resolution of the current managed Promise starts further interaction is prevented.\n *\n * Note: to enable debugging / log statements set the static `logging` variable to true.\n */\nclass ManagedPromise\n{\n   /** @type {boolean} */\n   static #logging = false;\n\n   /** @type {{ isProcessing?: boolean, promise?: Promise, reject: Function, resolve: Function }} */\n   #current;\n\n   /**\n    * @returns {boolean} Whether global logging is enabled.\n    */\n   static get logging()\n   {\n      return this.#logging;\n   }\n\n   /**\n    * @returns {boolean} Whether there is an active managed Promise.\n    */\n   get isActive()\n   {\n      return this.#current !== void 0;\n   }\n\n   /**\n    * @returns {boolean} Whether there is an active managed Promise and resolution is currently being processed.\n    */\n   get isProcessing()\n   {\n      return this.#current !== void 0 ? this.#current.isProcessing : false;\n   }\n\n   /**\n    * Sets global logging enabled state.\n    *\n    * @param {boolean}  logging - New logging enabled state.\n    */\n   static set logging(logging)\n   {\n      if (typeof logging !== 'boolean')\n      {\n         throw new TypeError(`[TRL] ManagedPromise.logging error: 'logging' is not a boolean.`);\n      }\n\n      this.#logging = logging;\n   }\n\n   // ----------------------------------------------------------------------------------------------------------------\n\n   /**\n    * Resolves any current Promise with undefined and creates a new current Promise.\n    *\n    * @template T\n    *\n    * @param {object} opts - Options.\n    *\n    * @param {boolean}  [opts.reuse=false] - When true if there is an existing live Promise it is returned immediately.\n    *\n    * @returns {Promise<T>} The new current managed Promise.\n    */\n   create({ reuse = false } = {})\n   {\n      if (typeof reuse !== 'boolean')\n      {\n         throw new TypeError(`[TRL] ManagedPromise.create error: 'reuse' is not a boolean.`);\n      }\n\n      if (reuse && this.#current !== void 0 && this.#current.promise instanceof Promise)\n      {\n         if (ManagedPromise.#logging)\n         {\n            console.warn(`[TRL] ManagedPromise.create info: Reusing / returning existing managed Promise.`);\n         }\n\n         return this.#current.promise;\n      }\n\n      if (this.#current !== void 0)\n      {\n         if (ManagedPromise.#logging)\n         {\n            console.warn(\n             `[TRL] ManagedPromise.create info: Creating a new Promise and resolving existing immediately.`);\n         }\n\n         this.#current.resolve(void 0);\n         this.#current = void 0;\n      }\n\n      const promise = new Promise((resolve, reject) =>\n      {\n         this.#current = {\n            isProcessing: false,\n            reject,\n            resolve\n         };\n      });\n\n      this.#current.promise = promise;\n\n      return promise;\n   }\n\n   /**\n    * Gets the current Promise if any.\n    *\n    * @returns {Promise<any>} Current Promise.\n    */\n   get()\n   {\n      return this.#current ? this.#current.promise : void 0;\n   }\n\n   /**\n    * Rejects the current Promise if applicable.\n    *\n    * @param {*}  [result] - Result to reject.\n    *\n    * @returns {boolean} Was the promise rejected.\n    */\n   reject(result = void 0)\n   {\n      // Early out as Promise resolution is currently processing.\n      if (this.#current !== void 0 && this.#current.isProcessing)\n      {\n         if (ManagedPromise.#logging)\n         {\n            console.warn(`[TRL] ManagedPromise.reject info: Currently processing promise.`);\n         }\n\n         return true;\n      }\n\n      if (this.#current !== void 0)\n      {\n         this.#current.isProcessing = true;\n\n         if (result instanceof Promise)\n         {\n            result.then((value) =>\n            {\n               this.#current.reject(value);\n               this.#current = void 0;\n            }).catch((err) =>\n            {\n               this.#current.reject(err);\n               this.#current = void 0;\n            });\n         }\n         else\n         {\n            this.#current.reject(result);\n            this.#current = void 0;\n         }\n\n         return true;\n      }\n      else\n      {\n         if (ManagedPromise.#logging)\n         {\n            console.warn(`[TRL] ManagedPromise.reject warning: No current managed Promise to reject.`);\n         }\n\n         return false;\n      }\n   }\n\n   /**\n    * Resolves the current Promise if applicable.\n    *\n    * @param {*}  [result] - Result to resolve.\n    *\n    * @returns {boolean} Was the promise resolved.\n    */\n   resolve(result = void 0)\n   {\n      // Early out as Promise resolution is currently processing.\n      if (this.#current !== void 0 && this.#current.isProcessing)\n      {\n         if (ManagedPromise.#logging)\n         {\n            console.warn(`[TRL] ManagedPromise.resolve info: Currently processing promise.`);\n         }\n\n         return true;\n      }\n\n      if (this.#current !== void 0)\n      {\n         if (result instanceof Promise)\n         {\n            this.#current.isProcessing = true;\n\n            result.then((value) =>\n            {\n               this.#current.resolve(value);\n               this.#current = void 0;\n            }).catch((err) =>\n            {\n               this.#current.reject(err);\n               this.#current = void 0;\n            });\n         }\n         else\n         {\n            this.#current.resolve(result);\n            this.#current = void 0;\n         }\n\n         return true;\n      }\n      else\n      {\n         if (ManagedPromise.#logging)\n         {\n            console.warn(`[TRL] ManagedPromise.resolve warning: No current managed Promise to resolve.`);\n         }\n\n         return false;\n      }\n   }\n}\n\nexport { ManagedPromise };\n//# sourceMappingURL=index.js.map\n","import {\n   deepMerge,\n   isObject,\n   safeAccess,\n   safeSet }   from '@typhonjs-fvtt/runtime/util/object';\n\n/**\n * Provides storage for all dialog options through individual accessors and `get`, `merge`, `replace` and `set` methods\n * that safely access and update data changed to the mounted DialogShell component reactively.\n */\nexport class TJSDialogData\n{\n   /**\n    * @type {import('../../index.js').SvelteApplication}\n    */\n   #application;\n\n   /**\n    * Stores the dialog options data.\n    *\n    * @type {import('./types').TJSDialogOptions}\n    */\n   #internal = {};\n\n   /**\n    * @param {import('../../index.js').SvelteApplication} application - The host Foundry application.\n    */\n   constructor(application)\n   {\n      this.#application = application;\n   }\n\n   /**\n    * @returns {Record<string, import('./types').TJSDialogButtonData>} The dialog button configuration.\n    */\n   get buttons()\n   {\n      return this.#internal.buttons;\n   }\n\n   /**\n    * Set the dialog button configuration.\n    *\n    * @param {string} buttons - New dialog button configuration.\n    */\n   set buttons(buttons)\n   {\n      this.#internal.buttons = buttons;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {import('@typhonjs-fvtt/runtime/svelte/util').TJSSvelteConfig | string} The Svelte configuration object or HTML string\n    *          content.\n    */\n   get content()\n   {\n      return this.#internal.content;\n   }\n\n   /**\n    * Set the Svelte configuration object or HTML string content.\n    *\n    * @param {import('@typhonjs-fvtt/runtime/svelte/util').TJSSvelteConfig | string} content - New Svelte configuration object or\n    *        HTML string content.\n    */\n   set content(content)\n   {\n      this.#internal.content = content;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {string} The default button ID to focus initially.\n    */\n   get default()\n   {\n      return this.#internal.default;\n   }\n\n   /**\n    * Set the default button ID to focus initially.\n    *\n    * @param {string} newDefault - New default button ID to focus initially.\n    */\n   set default(newDefault)\n   {\n      this.#internal.default = newDefault;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {boolean} The dialog draggable state; draggable when true.\n    */\n   get draggable()\n   {\n      return this.#internal.draggable;\n   }\n\n   /**\n    * Set the dialog state; draggable when true.\n    *\n    * @param {boolean} draggable - New dialog draggable state; draggable when true.\n    */\n   set draggable(draggable)\n   {\n      this.#internal.draggable = draggable;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {boolean} When true auto-management of app focus is enabled.\n    */\n   get focusAuto()\n   {\n      return this.#internal.focusAuto;\n   }\n\n   /**\n    * Set the dialog auto-management of app focus.\n    *\n    * @param {boolean} focusAuto - New dialog auto-management of app focus.\n    */\n   set focusAuto(focusAuto)\n   {\n      this.#internal.focusAuto = focusAuto;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {boolean} When true the first focusable element that isn't a button is focused.\n    */\n   get focusFirst()\n   {\n      return this.#internal.focusFirst;\n   }\n\n   /**\n    * Set the dialog first focusable element state.\n    *\n    * @param {boolean} focusFirst - New dialog first focusable element state.\n    */\n   set focusFirst(focusFirst)\n   {\n      this.#internal.focusFirst = focusFirst;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {boolean} When `focusAuto` and `focusKeep` is true; keeps internal focus.\n    */\n   get focusKeep()\n   {\n      return this.#internal.focusKeep;\n   }\n\n   /**\n    * Set the dialog `focusKeep` state. When `focusAuto` and `focusKeep` is true; keeps internal focus.\n    *\n    * @param {boolean} focusKeep - New dialog `focusKeep` state.\n    */\n   set focusKeep(focusKeep)\n   {\n      this.#internal.focusKeep = focusKeep;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {boolean} When true the dialog is minimizable.\n    */\n   get minimizable()\n   {\n      return this.#internal.minimizable;\n   }\n\n   /**\n    * Set the dialog `minimizable` state. When true the dialog is minimizable.\n    *\n    * @param {boolean} minimizable - New dialog `minimizable` state.\n    */\n   set minimizable(minimizable)\n   {\n      this.#internal.minimizable = minimizable;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {boolean} When true a modal dialog is displayed.\n    */\n   get modal()\n   {\n      return this.#internal.modal;\n   }\n\n   /**\n    * Set the dialog `modal` state. When true a modal dialog is displayed.\n    *\n    * @param {boolean} modal - New dialog `modal` state.\n    */\n   set modal(modal)\n   {\n      this.#internal.modal = modal;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {import('./types').TJSDialogModalOptions} Additional options for modal dialog display.\n    */\n   get modalOptions()\n   {\n      return this.#internal.modalOptions;\n   }\n\n   /**\n    * Set additional options for modal dialog display.\n    *\n    * @param {import('./types').TJSDialogModalOptions} modalOptions - New additional options for modal dialog display.\n    */\n   set modalOptions(modalOptions)\n   {\n      this.#internal.modalOptions = modalOptions;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {boolean} When true and an error is raised in dialog callback functions post a UI error notification.\n    */\n   get notifyError()\n   {\n      return this.#internal.notifyError;\n   }\n\n   /**\n    * Set the dialog `notifyError` state. When true and an error is raised in dialog callback functions post a UI error\n    * notification.\n    *\n    * @param {boolean} notifyError - New dialog `notifyError` state.\n    */\n   set notifyError(notifyError)\n   {\n      this.#internal.notifyError = notifyError;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {string | ((application: import('../../index.js').TJSDialog) => any)} Callback invoked when dialog is\n    *          closed; no button option selected. When defined as a string any matching function by name exported from\n    *          content Svelte component is invoked.\n    */\n   get onClose()\n   {\n      return this.#internal.onClose;\n   }\n\n   /**\n    * Set callback invoked when dialog is closed; no button option selected. When defined as a string any matching\n    * function by name exported from content Svelte component is invoked..\n    *\n    * @param {string | ((application: import('../../index.js').TJSDialog) => any)} onClose - New dialog `onClose` state.\n    */\n   set onClose(onClose)\n   {\n      this.#internal.onClose = onClose;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {boolean} Dialog `rejectClose` state. When true and a Promise has been created by {@link TJSDialog.wait}\n    *          and the Promise is not in the process of being resolved or rejected on close of the dialog any `onClose`\n    *          function is invoked and any result that is undefined will cause the Promise to then be rejected..\n    */\n   get rejectClose()\n   {\n      return this.#internal.rejectClose;\n   }\n\n   /**\n    * Set the dialog `rejectClose` state.\n    *\n    * @param {boolean} rejectClose - New dialog `rejectClose` state.\n    */\n   set rejectClose(rejectClose)\n   {\n      this.#internal.rejectClose = rejectClose;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {boolean} When true the dialog is resizable.\n    */\n   get resizable()\n   {\n      return this.#internal.resizable;\n   }\n\n   /**\n    * Set the dialog `resizable` state. When true the dialog is resizable.\n    *\n    * @param {boolean} resizable - New dialog `resizable` state.\n    */\n   set resizable(resizable)\n   {\n      this.#internal.resizable = resizable;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {boolean} When true and resolving any Promises and there are undefined results from any button callbacks\n    *          the button ID is resolved.\n    */\n   get resolveId()\n   {\n      return this.#internal.resolveId;\n   }\n\n   /**\n    * Set the dialog `resolveId` state. When true and resolving any Promises and there are undefined results from any\n    * button callbacks the button ID is resolved.\n    *\n    * @param {boolean} resolveId - New dialog `resolveId` state.\n    */\n   set resolveId(resolveId)\n   {\n      this.#internal.resolveId = resolveId;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {string} The dialog window title.\n    */\n   get title()\n   {\n      return this.#internal.title;\n   }\n\n   /**\n    * Set the dialog window title.\n    *\n    * @param {string} title - New dialog window title.\n    */\n   set title(title)\n   {\n      this.#internal.title = title;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {import('./types').TJSDialogTransitionOptions} Transition options for the dialog.\n    */\n   get transition()\n   {\n      return this.#internal.transition;\n   }\n\n   /**\n    * Set transition options for the dialog.\n    *\n    * @param {import('./types').TJSDialogTransitionOptions} transition - New transition options for the dialog.\n    */\n   set transition(transition)\n   {\n      this.#internal.transition = transition;\n      this.#updateComponent();\n   }\n\n   /**\n    * @returns {number | null} A specific z-index for the dialog. Pass null for the dialog to act like other\n    *          applications in regard bringing to top when activated.\n    */\n   get zIndex()\n   {\n      return this.#internal.zIndex;\n   }\n\n   /**\n    * Set specific z-index for the dialog.\n    *\n    * @param {number | null} zIndex - New z-index for the dialog.\n    */\n   set zIndex(zIndex)\n   {\n      this.#internal.zIndex = zIndex;\n      this.#updateComponent();\n   }\n\n   /**\n    * Provides a way to safely get this dialogs data given an accessor string which describes the\n    * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n    * to walk.\n    *\n    * @param {string}   accessor - The path / key to set. You can set multiple levels.\n    *\n    * @param {any}      [defaultValue] - A default value returned if the accessor is not found.\n    *\n    * @returns {any} Value at the accessor.\n    */\n   get(accessor, defaultValue)\n   {\n      return safeAccess(this.#internal, accessor, defaultValue);\n   }\n\n   /**\n    * @param {import('./types').TJSDialogOptions} data - Merge provided data object into Dialog data.\n    */\n   merge(data)\n   {\n      deepMerge(this.#internal, data);\n      this.#updateComponent();\n   }\n\n   /**\n    * Sets the dialog data; this is reactive.\n    *\n    * @param {import('./types').TJSDialogOptions}   data - Dialog data.\n    */\n   replace(data)\n   {\n      if (!isObject(data)) { throw new TypeError(`TJSDialogData replace error: 'data' is not an object'.`); }\n\n      this.#internal = {};\n\n      // Merge new data and perform a reactive update.\n      this.merge(data);\n   }\n\n   /**\n    * Provides a way to safely set this dialogs data given an accessor string which describes the\n    * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n    * to walk.\n    *\n    * Automatically the dialog data will be updated in the associated DialogShell Svelte component.\n    *\n    * @param {string}   accessor - The path / key to set. You can set multiple levels.\n    *\n    * @param {any}      value - Value to set.\n    *\n    * @returns {boolean} True if successful.\n    */\n   set(accessor, value)\n   {\n      const success = safeSet(this.#internal, accessor, value);\n\n      // If `this.#internal` modified then update the app options store.\n      if (success) { this.#updateComponent(); }\n\n      return success;\n   }\n\n   /**\n    * Updates the data in the Svelte dialog component.\n    */\n   #updateComponent()\n   {\n      const component = this.#application.svelte.component(0);\n      if (component?.data) { component.data = this.#internal; }\n   }\n}\n","import { DialogShell }        from '@typhonjs-fvtt/runtime/svelte/component/core';\n\nimport { ManagedPromise }     from '@typhonjs-fvtt/runtime/util/async';\n\nimport {\n   deepMerge,\n   isObject }                 from '@typhonjs-fvtt/runtime/util/object';\n\nimport { TJSDialogData }      from './internal/state-dialog/index.js';\nimport { SvelteApplication }  from './SvelteApplication.js';\n\n/**\n * Provides a reactive dialog implementation configured from a unique dialog options object. The dialog features a\n * bottom button bar for user selection.\n *\n * A glasspane / modal option with various styling and transition capabilities is available when setting `modal: true`.\n *\n * Most importantly the `content` attribute of dialog data can be a Svelte component configuration object to render\n * your custom component as the dialog content. When using a Svelte component as the content you can assign a string\n * to the various `on<XXX>` dialog callbacks and an exported function from your component will be invoked to handle the\n * button callback. All dialog button callbacks and `onClose` callback receive a single argument which is the dialog /\n * application instance.\n *\n * When making a form with form validation or other dialog that you don't want to close immediately on button press you\n * can set `autoClose: false`, however you are 100% in control of resolving any Promise callbacks from button presses\n * and also closing the application. Each button can also be configured with `autoClose: false` in the button data.\n *\n * There is a handy Promise management capability to track a single Promise for the lifetime of a dialog available\n * at {@link TJSDialog.managedPromise}. By default when the user closes the dialog / application any managed Promise is\n * resolved with `null`. The managed Promise is available in any Svelte content component by using\n * `const managedPromise = getContext('#managedPromise')`. When handling any custom resolution particularly when\n * setting `autoClose: false` for a given button you are 100% in control of resolving or rejecting asynchronous data to\n * return from the dialog.\n *\n * To create and wait upon a managed promise for asynchronous return results use the static or member variation of\n * {@link TJSDialog.wait}.\n *\n * Please refer to {@link TJSDialogOptions} for the various options used to construct the dialog.\n *\n * There are a couple of static helper methods to quickly create standard dialogs such as a 'yes' / 'no' confirmation\n * dialog with {@link TJSDialog.confirm} and an 'ok' single button dialog with {@link TJSDialog.prompt}.\n *\n * TODO: document all extended dialog data parameters such as transition options / modal transitions.\n */\nexport class TJSDialog extends SvelteApplication\n{\n   /** @type {TJSDialogData} */\n   #data;\n\n   /** @type {ManagedPromise} */\n   #managedPromise;\n\n   /**\n    * @param {import('./internal/state-dialog/types').TJSDialogOptions}           data - Dialog options.\n    *\n    * @param {import('./').SvelteApplicationOptions}   [options] - SvelteApplication options.\n    */\n   constructor(data, options = {})\n   {\n      super(options);\n\n      this.#managedPromise = new ManagedPromise();\n\n      this.#data = new TJSDialogData(this);\n      this.#data.replace(data);\n\n      /**\n       * @member {object} dialogComponent - A getter to SvelteData to retrieve any mounted Svelte component as the\n       *                                    dialog content.\n       *\n       * @memberof GetSvelteData#\n       * @readonly\n       */\n      Object.defineProperty(this.svelte, 'dialogComponent', {\n         get: () => this.svelte?.applicationShell?.dialogComponent,\n      });\n   }\n\n   /**\n    * Default options for TJSDialog. Provides a default width and setting `height` to `auto` to always display dialog\n    * content even if it changes. The default `DialogShell` / `svelte` options should not be changed and instead mount\n    * the dialog content component by supplying a Svelte configuration object to dialog data `content` field.\n    *\n    * @returns {import('./').SvelteApplicationOptions} Default options\n    */\n   static get defaultOptions()\n   {\n      return deepMerge(super.defaultOptions, {\n         classes: ['dialog', 'tjs-dialog'],\n         width: 400,\n         height: 'auto',\n         svelte: {\n            class: DialogShell,\n            intro: true,\n            target: document.body,\n            props: function() // `this` is the TJSDialog instance when invoked.\n            {\n               return {\n                  data: this.#data,\n                  managedPromise: this.#managedPromise\n               };\n            }\n         }\n      });\n   }\n\n   /**\n    * Returns the dialog data.\n    *\n    * @returns {import('./internal/state-dialog/types').TJSDialogData} Dialog data.\n    */\n   get data() { return this.#data; }\n\n   /**\n    * @returns {import('@typhonjs-fvtt/runtime/util/async').ManagedPromise} Returns the managed promise.\n    */\n   get managedPromise() { return this.#managedPromise; }\n\n   /**\n    * Close the dialog and un-register references to it within UI mappings.\n    * This function returns a Promise which resolves once the window closing animation concludes.\n    *\n    * @param {object}   [options] - Optional parameters.\n    *\n    * @param {boolean}  [options.force] - Force close regardless of render state.\n    *\n    * @returns {Promise<void>} A Promise which resolves once the application is closed with the callback value or\n    *                          `true`.\n    */\n   async close(options)\n   {\n      try\n      {\n         // Note: When handling a managed promise if a button selection has already been made the managed promise is\n         // already processing and the resolution below is skipped.\n         if (this.#managedPromise.isActive && !this.#managedPromise.isProcessing)\n         {\n            const result = TJSDialog.#invokeFn(this.#data.onClose, this, null);\n            const rejectClose = typeof this.#data.rejectClose === 'boolean' ? this.#data.rejectClose : false;\n\n            if (rejectClose && result === null)\n            {\n               this.#managedPromise.reject(new Error('TJSDialog was closed without a choice being made.'));\n            }\n            else\n            {\n               this.#managedPromise.resolve(result);\n            }\n         }\n      }\n      catch (err)\n      {\n         const notifyError = typeof this.#data.notifyError === 'boolean' ? this.#data.notifyError : true;\n         if (notifyError)\n         {\n            // TODO: When app eventbus is available send event for UI notification instead of Foundry API usage.\n            globalThis.ui.notifications.error(err, { console: false });\n         }\n\n         // If there is a managed Promise reject it or re-throw error.\n         if (!this.#managedPromise.reject(err)) { throw err; }\n      }\n      finally\n      {\n         await super.close(options);\n      }\n   }\n\n   /**\n    * Brings to top or renders this dialog returning a Promise that is resolved any button pressed or when the dialog\n    * is closed.\n    *\n    * Creates an anonymous data defined TJSDialog returning a Promise that can be awaited upon for the user to make a\n    * choice.\n    *\n    * Note: `null` is returned if the dialog is closed without a user making a choice.\n    *\n    * @template T\n    *\n    * @param {object}   [options] - Options.\n    *\n    * @param {boolean}  [options.reuse=false] - When true if there is an existing managed Promise this allows multiple\n    *        sources to await on the same result.\n    *\n    * @returns {Promise<T>} A promise for dialog resolution.\n    */\n   async wait(options)\n   {\n      // TODO: Direct usage of Foundry core Application API.\n      if (this.rendered)\n      {\n         this.bringToTop();\n      }\n      else\n      {\n         this.render(true, { focus: true });\n      }\n\n      // Return a managed Promise which is automatically resolved on button press via `DialogContent` component or when\n      // the dialog is closed.\n      return this.#managedPromise.create(options);\n   }\n\n   // ---------------------------------------------------------------------------------------------------------------\n\n   /**\n    * A helper factory method to create simple confirmation dialog windows which consist of simple yes / no prompts.\n    * If you require more flexibility, a custom TJSDialog instance is preferred. The default focused button is 'yes'.\n    * You can change the default focused button by setting `default` to `yes` or `no`.\n    *\n    * @template T\n    *\n    * @param {import('./internal/state-dialog/types').TJSDialogOptions & {\n    *    onYes?: string|((application: TJSDialog) => any),\n    *    onNo?: string|((application: TJSDialog) => any)\n    * }} [data] - Confirm dialog options.\n    *\n    * @param {string|((application: TJSDialog) => any)} [data.onYes] - Callback function upon `yes`; may be an async\n    *        function. When defined as a string any matching function by name exported from content Svelte component is\n    *        invoked.\n    *\n    * @param {string|((application: TJSDialog) => any)} [data.onNo] - Callback function upon `no`; may be an async\n    *        function. When defined as a string any matching function by name exported from content Svelte component is\n    *        invoked.\n    *\n    * @param {import('./').SvelteApplicationOptions}  [options]  SvelteApplication options passed to the TJSDialog\n    *        constructor.\n    *\n    * @returns {Promise<T>} A promise which resolves with result of yes / no callbacks or true / false.\n    *\n    * @example\n    * const result = await TJSDialog.confirm({\n    *  title: 'A Yes or No Question',\n    *  content: '<p>Choose wisely.</p>',\n    *  onYes: () => 'YES Result'\n    *  onNo: () => 'NO Result'\n    * });\n    *\n    * // Logs 'YES result', 'NO Result', or null if the user closed the dialog without making a selection.\n    * console.log(result);\n    */\n   static async confirm({ onYes, onNo, ...data } = {}, options = {})\n   {\n      // Allow overwriting of default icon and labels.\n      const mergedButtons = deepMerge({\n         yes: {\n            icon: 'fas fa-check',\n            label: 'Yes'\n         },\n         no: {\n            icon: 'fas fa-times',\n            label: 'No',\n         }\n      }, data.buttons ?? {});\n\n      return this.wait({\n         ...data,\n         buttons: deepMerge(mergedButtons, {\n            yes: {\n               onPress: (application) => this.#invokeFn(onYes, application, true)\n            },\n            no: {\n               onPress: (application) => this.#invokeFn(onNo, application, false)\n            }\n         }),\n         default: data.default ?? 'yes'\n      }, options);\n   }\n\n   /**\n    * A helper method to invoke a callback function directly or lookup an exported function with the same name from any\n    * content Svelte component to invoke. This is used internally to apply default values for `confirm` and `prompt`.\n    *\n    * @param {string|((application: TJSDialog) => any)} callback - Callback function to invoke; may be an async\n    *        function. When defined as a string any matching function by name exported from content Svelte component is\n    *        invoked.\n    *\n    * @param {TJSDialog} application - TJSDialog instance passed to callback.\n    *\n    * @param {*} [defaultResult] - An optional default result to return; undefined if not specified.\n    *\n    * @returns {*} Result.\n    *\n    * @internal\n    */\n   static #invokeFn(callback, application, defaultResult = void 0)\n   {\n      let result = defaultResult;\n\n      switch (typeof callback)\n      {\n         case 'function':\n            // Pass the dialog instance to the callback.\n            result = callback(application);\n            break;\n\n         case 'string':\n         {\n            const dialogComponent = application?.svelte?.dialogComponent;\n\n            // Attempt lookup by function name in dialog instance component.\n            if (dialogComponent !== void 0 && typeof dialogComponent?.[callback] === 'function')\n            {\n               result = dialogComponent?.[callback](application);\n            }\n            else\n            {\n               if (dialogComponent === void 0)\n               {\n                  console.warn(`[TRL] TJSDialog warning: 'onPress' defined as a string with no ` +\n                   `associated content Svelte component.`);\n               }\n               else if (typeof dialogComponent?.[callback] !== 'function')\n               {\n                  console.warn(`[TRL] TJSDialog warning: The content Svelte component does not contain ` +\n                   `an associated function '${callback}'. Did you remember to add ` +\n                   `'<svelte:options accessors={true} />' and export the function?`);\n               }\n            }\n            break;\n         }\n      }\n\n      return result;\n   }\n\n   /**\n    * A helper factory method to display a basic \"prompt\" style TJSDialog with a single button.\n    *\n    * @template T\n    *\n    * @param {import('./internal/state-dialog/types').TJSDialogOptions & {\n    *    onOk?: string|((application: TJSDialog) => any),\n    *    label?: string,\n    *    icon?: string\n    * }} [data] - Prompt dialog options that includes any TJSDialog options along with the following optional fields:\n    *\n    * @param {string|((application: TJSDialog) => any)} [data.onOk] - Callback function upon `ok`; may be an async\n    *        function. When defined as a string any matching function by name exported from content Svelte component is\n    *        invoked.\n    *\n    * @param {string}   [data.label] - The OK prompt button text.\n    *\n    * @param {string}   [data.icon=\"fas fa-check\"] - Set another icon besides `fas fa-check` for button.\n    *\n    * @param {import('./').SvelteApplicationOptions}  [options]  SvelteApplication options passed to the TJSDialog\n    *        constructor.\n    *\n    * @returns {Promise<T>} The returned value from the provided callback function or `true` if the button\n    *          is pressed.\n    *\n    * @example\n    * const result = await TJSDialog.prompt({\n    *  title: 'Are you OK?',\n    *  content: '<p>Are you OK?.</p>',\n    *  label: 'Feeling Fine!'\n    *  onOk: () => 'OK'\n    * });\n    *\n    * // Logs 'OK' or null if the user closed the dialog without making a selection.\n    * console.log(result);\n    */\n   static async prompt({ onOk, label, icon = 'fas fa-check', ...data } = {}, options = {})\n   {\n      return this.wait({\n         ...data,\n         buttons: {\n            ok: {\n               icon,\n               label,\n               onPress: (application) => this.#invokeFn(onOk, application, true)\n            }\n         },\n         default: 'ok'\n      }, options);\n   }\n\n   /**\n    * Creates an anonymous data defined TJSDialog returning a Promise that can be awaited upon for the user to make a\n    * choice.\n    *\n    * Note: By default `null` is returned if the dialog is closed without a user making a choice.\n    *\n    * @template T\n    *\n    * @param {import('./internal/state-dialog/types').TJSDialogOptions}  data - Dialog data passed to the TJSDialog constructor.\n    *\n    * @param {import('./').SvelteApplicationOptions}  [options]  SvelteApplication options passed to the TJSDialog\n    *        constructor.\n    *\n    * @returns {Promise<T>} A Promise that resolves to the chosen result.\n    */\n   static async wait(data, options = {})\n   {\n      if (!isObject(data)) { throw new TypeError(`TJSDialog.wait error: 'data' is not an object'.`); }\n\n      // Instantiate and render the dialog.\n      return new this({ ...data }, options).wait();\n   }\n}\n","import { SvelteApplication } from './SvelteApplication.js';\nimport { TJSAppIndex }       from './internal/index.js';\n\nexport * from './SvelteApplication.js';\nexport * from './TJSDialog.js';\n\n// Handle `hotReload` Foundry hook when running the Vite dev server. -------------------------------------------------\n\nif (import.meta.hot)\n{\n   Hooks.on('hotReload', (data) =>\n   {\n      // Only handle JSON hot reload presumably specified in package manifest for language translation files.\n      if (data?.extension === 'json')\n      {\n         // Postpone until next clock tick to allow Foundry to update localization first.\n         setTimeout(() =>\n         {\n            for (const app of TJSAppIndex.values())\n            {\n               const appShell = app.svelte.applicationShell;\n\n               // Retrieve the original `svelte-hmr` instrumented HMR component / not the proxy.\n               const hmrComponent = appShell?.$$?.hmr_cmp;\n\n               if (appShell && typeof hmrComponent?.$replace === 'function')\n               {\n                  const svelteData = app.svelte.dataByComponent(appShell);\n                  if (svelteData)\n                  {\n                     try\n                     {\n                        // Replace with self; this will invoke `on_hmr` callback in associated SvelteApplication.\n                        hmrComponent.$replace(hmrComponent.constructor, {\n                           target: svelteData.config.target,\n                           anchor: svelteData.config.anchor,\n                           preserveLocalState: true,\n                           conservative: true\n                        });\n                     }\n                     catch (error)\n                     {\n                        const name = hmrComponent?.constructor?.name ?? 'Unknown';\n                        console.error(`TyphonJS Runtime Library error; Could not hot reload component: '${name}'`);\n                        console.error(error);\n                     }\n                  }\n               }\n            }\n         }, 0);\n      }\n\n      return true;\n   });\n}\n\n// Handle `PopOut!` module hooks to allow applications to popout to their own browser window -------------------------\n\nHooks.on('PopOut:loading', (app) =>\n{\n   if (app instanceof SvelteApplication) { app.position.enabled = false; }\n});\n\nHooks.on('PopOut:popin', (app) =>\n{\n   if (app instanceof SvelteApplication) { app.position.enabled = true; }\n});\n\nHooks.on('PopOut:close', (app) =>\n{\n   if (app instanceof SvelteApplication) { app.position.enabled = true; }\n});\n\n// From: SvelteApplication.js ----------------------------------------------------------------------------------------\n\n/**\n * @typedef {object} SvelteApplicationOptions Options for SvelteApplication. Note: that this extends the Foundry\n * {@link ApplicationOptions}.\n *\n * @property {boolean}  [defaultCloseAnimation=true] If false the default slide close animation is not run.\n *\n * @property {boolean}  [draggable=true] If true then application shells are draggable.\n *\n * @property {boolean}  [focusAuto=true] When true auto-management of app focus is enabled.\n *\n * @property {boolean}  [focusKeep=false] When `focusAuto` and `focusKeep` is true; keeps internal focus.\n *\n * @property {import('@typhonjs-fvtt/runtime/util/browser').A11yFocusSource}   [focusSource] - Defines A11yHelper focus source to\n *           apply when application closes.\n *\n * @property {boolean}  [focusTrap=true] When true focus trapping / wrapping is enabled keeping focus inside app.\n *\n * @property {boolean}  [headerButtonNoClose=false] If true then the close header button is removed.\n *\n * @property {boolean}  [headerButtonNoLabel=false] If true then header button labels are removed.\n *\n * @property {string}   [headerIcon] Sets a header icon given an image URL.\n *\n * @property {boolean}  [headerNoTitleMinimized=false] If true then header title is hidden when minimized.\n *\n * @property {number}   [minHeight=MIN_WINDOW_HEIGHT] Assigned to position. Number specifying minimum\n *           window height.\n *\n * @property {number}   [minWidth=MIN_WINDOW_WIDTH] Assigned to position. Number specifying minimum\n *           window width.\n *\n * @property {boolean}  [positionable=true] If false then `position.set` does not take effect.\n *\n * @property {import('@typhonjs-fvtt/runtime/svelte/store/position').TJSPositionInitialHelper}   [positionInitial] A helper for\n *           initial position placement.\n *\n * @property {boolean}  [positionOrtho=true] When true TJSPosition is optimized for orthographic use.\n *\n * @property {import('@typhonjs-fvtt/runtime/svelte/store/position').TJSPositionValidatorOptions}   [positionValidator] A validator\n *           function or data or list of validators.\n *\n * @property {import('@typhonjs-fvtt/runtime/svelte/store/web-storage').TJSWebStorage}   [sessionStorage] An instance of\n *           TJSWebStorage (session) to share across SvelteApplications.\n *\n * @property {import('@typhonjs-fvtt/runtime/svelte/util').TJSSvelteConfig}   [svelte] A Svelte configuration object defining\n *           the main component.\n *\n * @property {import('@typhonjs-fvtt/runtime/svelte/store/position').TJSTransformOrigin}   [transformOrigin='top left'] By default,\n *           'top / left' respects rotation when minimizing.\n */\n","import DropItemDialogShell from \"./drop-item-dialog-shell.svelte\";\r\nimport { SvelteApplication } from '#runtime/svelte/application';\r\nimport { getActiveApps } from \"../../../helpers/helpers\";\r\n\r\nexport default class DropItemDialog extends SvelteApplication {\r\n\r\n\t/**\r\n\t *\r\n\t * @param item\r\n\t * @param target\r\n\t * @param options\r\n\t */\r\n\tconstructor(item, target, options = {\r\n\t\tlocalizationTitle: \"DropItem\"\r\n\t}) {\r\n\t\tconst id = item.id + (target ? \"-\" + target.id : \"\");\r\n\t\tsuper({\r\n\t\t\ttitle: game.i18n.localize(`ITEM-PILES.Applications.${options.localizationTitle}.Title`),\r\n\t\t\tid: `item-pile-drop-item-${id}-${foundry.utils.randomID()}`,\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: DropItemDialogShell,\r\n\t\t\t\ttarget: document.body,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\titem,\r\n\t\t\t\t\ttarget\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclose: () => this.options.resolve?.(null),\r\n\t\t\t...options\r\n\t\t});\r\n\t\tthis.item = item;\r\n\t\tthis.target = target;\r\n\t}\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\twidth: 430,\r\n\t\t\theight: \"auto\",\r\n\t\t\tclasses: [\"item-piles-app\"]\r\n\t\t})\r\n\t}\r\n\r\n\tstatic getActiveApps(item, target) {\r\n\t\tconst id = item.id + (target ? \"-\" + target.id : \"\");\r\n\t\treturn getActiveApps(`item-pile-drop-item-${id}`);\r\n\t}\r\n\r\n\tstatic async show(item, target, options = {}) {\r\n\t\tif (!options?.localizationTitle) {\r\n\t\t\toptions.localizationTitle = \"DropItem\";\r\n\t\t}\r\n\t\tconst apps = this.getActiveApps(item, target);\r\n\t\tif (apps.length) {\r\n\t\t\tfor (let app of apps) {\r\n\t\t\t\tapp.render(false, { focus: true });\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\toptions.resolve = resolve;\r\n\t\t\tnew this(item, target, options).render(true, { focus: true });\r\n\t\t})\r\n\t}\r\n\r\n}\r\n","<script>\r\n\r\n\timport { fade } from 'svelte/transition';\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport CONSTANTS from \"../../constants/constants.js\";\r\n\r\n\texport let store;\r\n\texport let entry;\r\n\texport let currency = false;\r\n\r\n\tconst name = entry.name;\r\n\tconst img = entry.img;\r\n\tconst rarityColor = entry.rarityColor;\r\n\tconst quantityLeft = entry.quantityLeft;\r\n\tconst quantity = entry.quantity;\r\n\tconst currentQuantity = entry.currentQuantity;\r\n\tconst pileData = store.pileData;\r\n\r\n\t$: canInspectItems = entry.item && ($pileData.canInspectItems || store.actor.isOwner);\r\n\r\n\tconst editQuantities = store.editQuantities;\r\n\r\n\tfunction dragStart(event) {\r\n\t\tconst data = {\r\n\t\t\ttype: \"Item\",\r\n\t\t\tuuid: entry.item.uuid\r\n\t\t};\r\n\t\tHooks.callAll(CONSTANTS.HOOKS.DRAG_DOCUMENT, data)\r\n\t\tevent.dataTransfer.setData('text/plain', JSON.stringify(data));\r\n\t}\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow item-piles-item-row\"\r\n     class:item-piles-disabled={!$editQuantities && (!$quantityLeft || !$quantity)}\r\n     draggable={!!entry.item}\r\n     on:dragstart={(event) => { dragStart(event) }}\r\n     transition:fade={{duration: 250}}>\r\n\r\n\t<div class=\"item-piles-img-container\">\r\n\t\t<img class=\"item-piles-img\" src=\"{$img}\"/>\r\n\t</div>\r\n\r\n\t<div class=\"item-piles-name\">\r\n\t\t<div class=\"item-piles-name-container\">\r\n\t\t\t<p class:item-piles-clickable-link=\"{canInspectItems}\"\r\n\t\t\t   on:click={() => { entry.preview() }}\r\n\t\t\t   style=\"color: {$rarityColor || 'inherit'};\"\r\n\t\t\t>\r\n\t\t\t\t{$name}\r\n\t\t\t</p>\r\n\t\t\t{#if !$editQuantities && (entry.canStack || !entry.id) && ($pileData.shareCurrenciesEnabled || !currency)}\r\n\t\t\t\t<span class=\"item-piles-small-text\">(x{$quantity})</span>\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t{#if entry.canStack || !entry.id}\r\n\r\n\t\t<div class=\"item-piles-quantity-container\" style=\"flex:2.5;\">\r\n\r\n\t\t\t{#if $editQuantities}\r\n\r\n\t\t\t\t<div class=\"item-piles-quantity-input-container\">\r\n\t\t\t\t\t<input class=\"item-piles-quantity\" type=\"number\" min=\"0\" bind:value=\"{$quantity}\"\r\n\t\t\t\t\t       draggable=\"true\" on:dragstart|stopPropagation|preventDefault/>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t{:else}\r\n\r\n\t\t\t\t{#if $quantityLeft && $quantity}\r\n\t\t\t\t\t<div class=\"item-piles-quantity-input-container\">\r\n\t\t\t\t\t\t<input class=\"item-piles-quantity\" type=\"number\" min=\"1\" bind:value=\"{$currentQuantity}\"\r\n\t\t\t\t\t\t       max=\"{$quantity}\" disabled=\"{!$quantity}\"/>\r\n\r\n\t\t\t\t\t\t<span class=\"item-piles-input-divider\" class:item-piles-text-right={!store.recipient}>\r\n               / {$quantityLeft}\r\n            </span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{:else}\r\n          <span>\r\n            {localize(`ITEM-PILES.Inspect.${entry.toShare && $quantity ? \"NoShareLeft\" : \"NoneLeft\"}`)}\r\n          </span>\r\n\t\t\t\t{/if}\r\n\t\t\t{/if}\r\n\r\n\t\t</div>\r\n\r\n\t{/if}\r\n\r\n\t{#if !$editQuantities}\r\n\r\n\t\t<button\r\n\t\t\ton:click={() => { entry.take() }}\r\n\t\t\tclass=\"item-piles-item-take-button\"\r\n\t\t\ttype=\"button\"\r\n\t\t\tdisabled={!$quantityLeft || !$quantity}>\r\n\t\t\t{localize(\"ITEM-PILES.Inspect.Take\")}\r\n\t\t</button>\r\n\r\n\t{:else if !entry.canStack && !entry.isCurrency}\r\n\r\n\t\t<button\r\n\t\t\ton:click={() => { entry.remove() }}\r\n\t\t\tclass=\"item-piles-item-take-button\"\r\n\t\t\ttype=\"button\"\r\n\t\t\tdisabled={!$quantityLeft}>\r\n\t\t\t{localize(\"Remove\")}\r\n\t\t</button>\r\n\r\n\t{/if}\r\n\r\n\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n</style>\r\n","<script>\r\n\timport ListEntry from \"./ListEntry.svelte\";\r\n\r\n\texport let item;\r\n\texport let store;\r\n\texport let index;\r\n\r\n\tconst subItems = item.subItems;\r\n\r\n</script>\r\n\r\n{#if index !== 0}\r\n\t<div class=\"item-piles-item-divider\"></div>\r\n{/if}\r\n<ListEntry bind:entry={item} {store}/>\r\n{#if $subItems.length}\r\n\t<div class=\"item-piles-item-sublist\">\r\n\t\t{#each $subItems as subItem (subItem.identifier)}\r\n\t\t\t<div class=\"item-piles-tree-branch-right-arm\"></div>\r\n\t\t\t<ListEntry {store} bind:entry={subItem}/>\r\n\t\t{/each}\r\n\t</div>\r\n{/if}\r\n","<script>\r\n\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { fade } from 'svelte/transition';\r\n\timport ListGroupEntry from \"./ListGroupEntry.svelte\";\r\n\r\n\texport let store;\r\n\tconst items = store.items;\r\n\tconst numItems = store.numItems;\r\n\r\n</script>\r\n\r\n\r\n{#if $numItems > 0}\r\n\t<div in:fade|local={{duration: 150}}>\r\n\r\n\t\t<div class=\"item-piles-flexrow\"><h3>{localize(\"ITEM-PILES.Items\")}</h3></div>\r\n\r\n\t\t{#each $items as item, index (item.identifier)}\r\n\t\t\t<ListGroupEntry {item} {index} {store}/>\r\n\t\t{/each}\r\n\r\n\t</div>\r\n\r\n{/if}\r\n","<script>\r\n\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport ListEntry from \"./ListEntry.svelte\";\r\n\r\n\texport let store;\r\n\tconst currencies = store.currencies;\r\n\tconst numItems = store.numItems;\r\n\tconst numCurrencies = store.numCurrencies;\r\n\tconst editQuantities = store.editQuantities;\r\n\r\n</script>\r\n\r\n<div>\r\n\r\n\t<div class=\"item-piles-flexrow\">\r\n\t\t{#if $numCurrencies > 0}\r\n\t\t\t<h3>{localize(\"ITEM-PILES.Currencies\")}:</h3>\r\n\t\t{/if}\r\n\t\t<a class=\"item-piles-clickable item-piles-text-right item-piles-small-text item-piles-middle\"\r\n\t\t   on:click={() => store.addCurrency(store.recipient)}>\r\n\t\t\t<i class=\"fas fa-plus\"></i> {localize(\"ITEM-PILES.Inspect.AddCurrency\")}\r\n\t\t</a>\r\n\t</div>\r\n\t{#if $numCurrencies > 0}\r\n\t\t<div>\r\n\t\t\t{#each $currencies as currency, index (currency.identifier)}\r\n\t\t\t\t<ListEntry {store} bind:entry={currency} currency/>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\t{/if}\r\n\r\n</div>\r\n","<script>\r\n\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport * as Utilities from \"../../helpers/utilities.js\";\r\n\r\n\texport let store;\r\n\texport let localization = \"ITEM-PILES.Inspect.AsActor\";\r\n\texport let style = \"text-align: center; flex: 0 1 auto; height: 27px;\";\r\n\r\n\tlet editQuantities = store.editQuantities;\r\n\r\n\tlet changingActor = false;\r\n\tlet playerActors = game.actors.filter(actor => actor.isOwner && actor !== store.actor && actor.prototypeToken.actorLink);\r\n\tlet recipientUuid = Utilities.getUuid(store.recipient);\r\n\tconst recipientDoc = store.recipientDocument;\r\n\r\n\t$: {\r\n\t\t$recipientDoc;\r\n\t\tif (!changingActor) {\r\n\t\t\trecipientUuid = store.recipient ? Utilities.getUuid(store.recipient) : false;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction changeRecipientActor() {\r\n\t\tconst newRecipient = playerActors.find(actor => Utilities.getUuid(actor) === recipientUuid);\r\n\t\tchangingActor = false;\r\n\t\tif (recipientUuid === store.recipient.uuid) return;\r\n\t\tstore.updateRecipient(newRecipient)\r\n\t}\r\n\r\n</script>\r\n\r\n{#if $editQuantities}\r\n\t<div {style}>{localize(\"ITEM-PILES.Inspect.Owner\")}</div>\r\n{:else}\r\n\t<div {style}>\r\n\t\t{#if !changingActor}\r\n\t\t\t{localize(localization, { actorName: $recipientDoc.name })}\r\n\t\t{/if}\r\n\t\t{#if playerActors.length > 1}\r\n\t\t\t{#if !changingActor}\r\n\t\t\t\t<a class='item-piles-highlight' on:click={() => { changingActor = true }} class:active={!changingActor}>\r\n\t\t\t\t\t{localize(\"ITEM-PILES.Inspect.Change\")}\r\n\t\t\t\t</a>\r\n\t\t\t{:else}\r\n\t\t\t\t<select\r\n\t\t\t\t\tclass=\"item-piles-change-actor-select\"\r\n\t\t\t\t\tbind:value={recipientUuid}\r\n\t\t\t\t\ton:change={changeRecipientActor}\r\n\t\t\t\t\tclass:active={changingActor}\r\n\t\t\t\t\tstyle=\"height:auto;\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{#each playerActors as actor, index (index)}\r\n\t\t\t\t\t\t<option value=\"{Utilities.getUuid(actor.uuid)}\">{actor.name}</option>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</select>\r\n\t\t\t{/if}\r\n\t\t{/if}\r\n\t</div>\r\n{/if}\r\n","import { writable, get } from 'svelte/store';\nimport { Strings } from '@typhonjs-fvtt/runtime/util';\nimport { isIterable, safeAccess } from '@typhonjs-fvtt/runtime/util/object';\nimport { isWritableStore } from '@typhonjs-fvtt/runtime/util/store';\n\nclass DynReducerUtils {\n    /**\n     * Checks for array equality between two arrays of numbers.\n     *\n     * @param a - Array A\n     *\n     * @param b - Array B\n     *\n     * @returns Arrays are equal.\n     */\n    static arrayEquals(a, b) {\n        if (a === b) {\n            return true;\n        }\n        if (a === null || b === null) {\n            return false;\n        }\n        /* c8 ignore next */\n        if (a.length !== b.length) {\n            return false;\n        }\n        for (let cntr = a.length; --cntr >= 0;) {\n            /* c8 ignore next */\n            if (a[cntr] !== b[cntr]) {\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Provides a solid string hashing algorithm.\n     *\n     * Sourced from: https://stackoverflow.com/a/52171480\n     *\n     * @param str - String to hash.\n     *\n     * @param seed - A seed value altering the hash.\n     *\n     * @returns Hash code.\n     */\n    static hashString(str, seed = 0) {\n        let h1 = 0xdeadbeef ^ seed, h2 = 0x41c6ce57 ^ seed;\n        for (let ch, i = 0; i < str.length; i++) {\n            ch = str.charCodeAt(i);\n            h1 = Math.imul(h1 ^ ch, 2654435761);\n            h2 = Math.imul(h2 ^ ch, 1597334677);\n        }\n        h1 = Math.imul(h1 ^ (h1 >>> 16), 2246822507) ^ Math.imul(h2 ^ (h2 >>> 13), 3266489909);\n        h2 = Math.imul(h2 ^ (h2 >>> 16), 2246822507) ^ Math.imul(h1 ^ (h1 >>> 13), 3266489909);\n        return 4294967296 * (2097151 & h2) + (h1 >>> 0);\n    }\n    /**\n     * Converts an unknown value for hashing purposes in {@link AdapterIndexer.calcHashUpdate}.\n     *\n     * Currently objects / Map w/ object keys is not supported. Potentially can include `object-hash` to handle this\n     * case, but it is not common to use objects as keys in Maps.\n     *\n     * @param value - An unknown value to convert to a number.\n     */\n    static hashUnknown(value) {\n        if (value === null || value === void 0) {\n            return 0;\n        }\n        let result = 0;\n        switch (typeof value) {\n            case 'boolean':\n                result = value ? 1 : 0;\n                break;\n            case 'bigint':\n                result = Number(BigInt.asIntN(64, value));\n                break;\n            case 'function':\n                result = this.hashString(value.name);\n                break;\n            case 'number':\n                result = Number.isFinite(value) ? value : 0;\n                break;\n            case 'object':\n                // TODO: consider hashing an object IE `object-hash` and convert to number.\n                break;\n            case 'string':\n                result = this.hashString(value);\n                break;\n            case 'symbol':\n                result = this.hashString(Symbol.keyFor(value));\n                break;\n        }\n        return result;\n    }\n    /**\n     * @param target -\n     *\n     * @param Prototype -\n     *\n     * @returns target constructor function has Prototype.\n     */\n    static hasPrototype(target, Prototype) {\n        /* c8 ignore next */\n        if (typeof target !== 'function') {\n            return false;\n        }\n        if (target === Prototype) {\n            return true;\n        }\n        // Walk parent prototype chain. Check for descriptor at each prototype level.\n        for (let proto = Object.getPrototypeOf(target); proto; proto = Object.getPrototypeOf(proto)) {\n            if (proto === Prototype) {\n                return true;\n            }\n        }\n        return false;\n    }\n    /**\n     * Provides a utility method to determine if the given data is iterable / implements iterator protocol.\n     *\n     * @param data - Data to verify as iterable.\n     *\n     * @returns Is data iterable.\n     */\n    static isIterable(data) {\n        return data !== null && data !== void 0 && typeof data === 'object' &&\n            typeof data[Symbol.iterator] === 'function';\n    }\n}\n\n/**\n * Provides the `derived` API for all dynamic reducers.\n */\nclass AdapterDerived {\n    #hostData;\n    #DerivedReducerCtor;\n    #parentIndex;\n    #derived = new Map();\n    #destroyed = false;\n    /**\n     * @param hostData - Hosted data structure.\n     *\n     * @param parentIndex - Any associated parent index API.\n     *\n     * @param DerivedReducerCtor - The default derived reducer constructor function.\n     */\n    constructor(hostData, parentIndex, DerivedReducerCtor) {\n        this.#hostData = hostData;\n        this.#parentIndex = parentIndex;\n        this.#DerivedReducerCtor = DerivedReducerCtor;\n        Object.freeze(this);\n    }\n    /**\n     * Creates a new derived reducer.\n     *\n     * @param options - Options defining the new derived reducer.\n     *\n     * @returns Newly created derived reducer.\n     */\n    create(options) {\n        if (this.#destroyed) {\n            throw Error(`AdapterDerived.create error: this instance has been destroyed.`);\n        }\n        let name;\n        let rest = {};\n        let ctor;\n        const DerivedReducerCtor = this.#DerivedReducerCtor;\n        if (typeof options === 'string') {\n            name = options;\n            ctor = DerivedReducerCtor;\n        }\n        else if (typeof options === 'function' && DynReducerUtils.hasPrototype(options, DerivedReducerCtor)) {\n            ctor = options;\n        }\n        else if (typeof options === 'object' && options !== null) {\n            ({ name, ctor = DerivedReducerCtor, ...rest } = options);\n        }\n        else {\n            throw new TypeError(`AdapterDerived.create error: 'options' does not conform to allowed parameters.`);\n        }\n        if (!DynReducerUtils.hasPrototype(ctor, DerivedReducerCtor)) {\n            throw new TypeError(`AdapterDerived.create error: 'ctor' is not a '${DerivedReducerCtor?.name}'.`);\n        }\n        name = name ?? ctor?.name;\n        if (typeof name !== 'string') {\n            throw new TypeError(`AdapterDerived.create error: 'name' is not a string.`);\n        }\n        const derivedReducer = new ctor(this.#hostData, this.#parentIndex, rest);\n        this.#derived.set(name, derivedReducer);\n        return derivedReducer;\n    }\n    /**\n     * Removes all derived reducers and associated subscriptions.\n     */\n    clear() {\n        if (this.#destroyed) {\n            return;\n        }\n        for (const reducer of this.#derived.values()) {\n            reducer.destroy();\n        }\n        this.#derived.clear();\n    }\n    /**\n     * Deletes and destroys a derived reducer by name.\n     *\n     * @param name - Name of the derived reducer.\n     */\n    delete(name) {\n        if (this.#destroyed) {\n            throw Error(`AdapterDerived.delete error: this instance has been destroyed.`);\n        }\n        const reducer = this.#derived.get(name);\n        if (reducer) {\n            reducer.destroy();\n        }\n        return this.#derived.delete(name);\n    }\n    /**\n     * Removes all derived reducers, subscriptions, and cleans up all resources.\n     */\n    destroy() {\n        if (this.#destroyed) {\n            return;\n        }\n        this.clear();\n        this.#hostData = [null];\n        this.#parentIndex = null;\n        this.#destroyed = true;\n    }\n    /**\n     * Returns an existing derived reducer.\n     *\n     * @param name - Name of derived reducer.\n     */\n    get(name) {\n        if (this.#destroyed) {\n            throw Error(`AdapterDerived.get error: this instance has been destroyed.`);\n        }\n        return this.#derived.get(name);\n    }\n    /**\n     * Updates all managed derived reducer indexes.\n     *\n     * @param [force] - Force an update to subscribers.\n     */\n    update(force = false) {\n        if (this.#destroyed) {\n            return;\n        }\n        for (const reducer of this.#derived.values()) {\n            reducer.index.update(force);\n        }\n    }\n}\n\n/**\n * Provides the storage and sequencing of managed filters. Each filter added may be a bespoke function or a\n * {@link DynDataFilter} object containing an `id`, `filter`, and `weight` attributes; `filter` is the only required\n * attribute.\n *\n * The `id` attribute can be anything that creates a unique ID for the filter; recommended strings or numbers. This\n * allows filters to be removed by ID easily.\n *\n * The `weight` attribute is a number between 0 and 1 inclusive that allows filters to be added in a\n * predictable order which is especially handy if they are manipulated at runtime. A lower weighted filter always runs\n * before a higher weighted filter. For speed and efficiency always set the heavier / more inclusive filter with a\n * lower weight; an example of this is a keyword / name that will filter out many entries making any further filtering\n * faster. If no weight is specified the default of '1' is assigned and it is appended to the end of the filters list.\n *\n * This class forms the public API which is accessible from the `.filters` getter in the main reducer implementation.\n * ```\n * const dynArray = new DynArrayReducer([...]);\n * dynArray.filters.add(...);\n * dynArray.filters.clear();\n * dynArray.filters.length;\n * dynArray.filters.remove(...);\n * dynArray.filters.removeBy(...);\n * dynArray.filters.removeById(...);\n * ```\n */\nclass AdapterFilters {\n    #filtersData;\n    #indexUpdate;\n    #mapUnsubscribe = new Map();\n    /**\n     * @param indexUpdate - update function for the indexer.\n     *\n     * @param filtersAdapter - Stores the filter function data.\n     */\n    constructor(indexUpdate, filtersAdapter) {\n        this.#indexUpdate = indexUpdate;\n        this.#filtersData = filtersAdapter;\n        Object.freeze(this);\n    }\n    /**\n     * @returns Returns the length of the filter data.\n     */\n    get length() { return this.#filtersData.filters.length; }\n    /**\n     * Provides an iterator for filters.\n     *\n     * @yields {DataFilter<T>}\n     */\n    *[Symbol.iterator]() {\n        if (this.#filtersData.filters.length === 0) {\n            return;\n        }\n        for (const entry of this.#filtersData.filters) {\n            yield { ...entry };\n        }\n    }\n    /**\n     * @param filters -\n     */\n    add(...filters) {\n        /**\n         * Tracks the number of filters added that have subscriber functionality.\n         */\n        let subscribeCount = 0;\n        for (const filter of filters) {\n            const filterType = typeof filter;\n            if (filterType !== 'function' && (filterType !== 'object' || filter === null)) {\n                throw new TypeError(`AdapterFilters error: 'filter' is not a function or object.`);\n            }\n            let data = void 0;\n            let subscribeFn = void 0;\n            if (filterType === 'function') {\n                data = {\n                    id: void 0,\n                    filter,\n                    weight: 1\n                };\n                subscribeFn = filter.subscribe;\n            }\n            else if (filterType === 'object') {\n                if ('filter' in filter) {\n                    if (typeof filter.filter !== 'function') {\n                        throw new TypeError(`AdapterFilters error: 'filter' attribute is not a function.`);\n                    }\n                    if (filter.weight !== void 0 && typeof filter.weight !== 'number' ||\n                        (filter.weight < 0 || filter.weight > 1)) {\n                        throw new TypeError(`AdapterFilters error: 'weight' attribute is not a number between '0 - 1' inclusive.`);\n                    }\n                    data = {\n                        id: filter.id !== void 0 ? filter.id : void 0,\n                        filter: filter.filter,\n                        weight: filter.weight || 1\n                    };\n                    subscribeFn = filter.filter.subscribe ?? filter.subscribe;\n                }\n                else {\n                    throw new TypeError(`AdapterFilters error: 'filter' attribute is not a function.`);\n                }\n            }\n            // Find the index to insert where data.weight is less than existing values weight.\n            const index = this.#filtersData.filters.findIndex((value) => {\n                return data.weight < value.weight;\n            });\n            // If an index was found insert at that location.\n            if (index >= 0) {\n                this.#filtersData.filters.splice(index, 0, data);\n            }\n            else // push to end of filters.\n             {\n                this.#filtersData.filters.push(data);\n            }\n            if (typeof subscribeFn === 'function') {\n                const unsubscribe = subscribeFn(this.#indexUpdate);\n                // Ensure that unsubscribe is a function.\n                if (typeof unsubscribe !== 'function') {\n                    throw new TypeError('AdapterFilters error: Filter has subscribe function, but no unsubscribe function is returned.');\n                }\n                // Ensure that the same filter is not subscribed to multiple times.\n                if (this.#mapUnsubscribe.has(data.filter)) {\n                    throw new Error('AdapterFilters error: Filter added already has an unsubscribe function registered.');\n                }\n                this.#mapUnsubscribe.set(data.filter, unsubscribe);\n                subscribeCount++;\n            }\n        }\n        // Filters with subscriber functionality are assumed to immediately invoke the `subscribe` callback. If the\n        // subscriber count is less than the amount of filters added then automatically trigger an index update manually.\n        if (subscribeCount < filters.length) {\n            this.#indexUpdate();\n        }\n    }\n    /**\n     * Clears and removes all filters.\n     */\n    clear() {\n        this.#filtersData.filters.length = 0;\n        // Unsubscribe from all filters with subscription support.\n        for (const unsubscribe of this.#mapUnsubscribe.values()) {\n            unsubscribe();\n        }\n        this.#mapUnsubscribe.clear();\n        this.#indexUpdate();\n    }\n    /**\n     * @param filters -\n     */\n    remove(...filters) {\n        const length = this.#filtersData.filters.length;\n        if (length === 0) {\n            return;\n        }\n        for (const data of filters) {\n            // Handle the case that the filter may either be a function or a filter entry / object.\n            const actualFilter = typeof data === 'function' ? data : data !== null && typeof data === 'object' ?\n                data.filter : void 0;\n            if (!actualFilter) {\n                continue;\n            }\n            for (let cntr = this.#filtersData.filters.length; --cntr >= 0;) {\n                if (this.#filtersData.filters[cntr].filter === actualFilter) {\n                    this.#filtersData.filters.splice(cntr, 1);\n                    // Invoke any unsubscribe function for given filter then remove from tracking.\n                    let unsubscribe = void 0;\n                    if (typeof (unsubscribe = this.#mapUnsubscribe.get(actualFilter)) === 'function') {\n                        unsubscribe();\n                        this.#mapUnsubscribe.delete(actualFilter);\n                    }\n                }\n            }\n        }\n        // Update the index a filter was removed.\n        if (length !== this.#filtersData.filters.length) {\n            this.#indexUpdate();\n        }\n    }\n    /**\n     * Remove filters by the provided callback. The callback takes 3 parameters: `id`, `filter`, and `weight`.\n     * Any truthy value returned will remove that filter.\n     *\n     * @param callback - Callback function to evaluate each filter entry.\n     */\n    removeBy(callback) {\n        const length = this.#filtersData.filters.length;\n        if (length === 0) {\n            return;\n        }\n        if (typeof callback !== 'function') {\n            throw new TypeError(`AdapterFilters error: 'callback' is not a function.`);\n        }\n        this.#filtersData.filters = this.#filtersData.filters.filter((data) => {\n            const remove = callback.call(callback, { ...data });\n            if (remove) {\n                let unsubscribe;\n                if (typeof (unsubscribe = this.#mapUnsubscribe.get(data.filter)) === 'function') {\n                    unsubscribe();\n                    this.#mapUnsubscribe.delete(data.filter);\n                }\n            }\n            // Reverse remove boolean to properly filter / remove this filter.\n            return !remove;\n        });\n        if (length !== this.#filtersData.filters.length) {\n            this.#indexUpdate();\n        }\n    }\n    /**\n     * @param ids - Removes filters by ID.\n     */\n    removeById(...ids) {\n        const length = this.#filtersData.filters.length;\n        if (length === 0) {\n            return;\n        }\n        this.#filtersData.filters = this.#filtersData.filters.filter((data) => {\n            let remove = 0;\n            for (const id of ids) {\n                remove |= (data.id === id ? 1 : 0);\n            }\n            // If not keeping invoke any unsubscribe function for given filter then remove from tracking.\n            if (!!remove) {\n                let unsubscribe;\n                if (typeof (unsubscribe = this.#mapUnsubscribe.get(data.filter)) === 'function') {\n                    unsubscribe();\n                    this.#mapUnsubscribe.delete(data.filter);\n                }\n            }\n            return !remove; // Swap here to actually remove the item via array filter method.\n        });\n        if (length !== this.#filtersData.filters.length) {\n            this.#indexUpdate();\n        }\n    }\n}\n\n/**\n * Provides construction and management of indexed data when there are parent indexes or filter / sort functions\n * applied.\n */\nclass AdapterIndexer {\n    derivedAdapter;\n    filtersData;\n    hostData;\n    hostUpdate;\n    indexData;\n    sortData;\n    sortFn;\n    destroyed = false;\n    /**\n     * @param hostData - Hosted data structure.\n     *\n     * @param hostUpdate - Host update function invoked on index updates.\n     *\n     * @param [parentIndexer] - Any associated parent index API.\n     *\n     * @returns Indexer adapter instance.\n     */\n    constructor(hostData, hostUpdate, parentIndexer) {\n        this.hostData = hostData;\n        this.hostUpdate = hostUpdate;\n        this.indexData = { index: null, hash: null, reversed: false, parent: parentIndexer };\n    }\n    /**\n     * @returns Returns whether the index is active.\n     */\n    get active() {\n        return this.filtersData.filters.length > 0 || this.sortData.compareFn !== null ||\n            this.indexData.parent?.active === true;\n    }\n    /**\n     * @returns Returns length of reduced index.\n     */\n    get length() {\n        return this.indexData.index ? this.indexData.index.length : 0;\n    }\n    /* c8 ignore start */\n    /**\n     * @returns Returns reversed state.\n     */\n    get reversed() { return this.indexData.reversed; }\n    /* c8 ignore end */\n    /**\n     * @param reversed - New reversed state.\n     */\n    set reversed(reversed) { this.indexData.reversed = reversed; }\n    // -------------------------------------------------------------------------------------------------------------------\n    /**\n     * Calculates a new hash value for the new index array if any. If the new index array is null then the hash value\n     * is set to null. Set calculated new hash value to the index adapter hash value.\n     *\n     * After hash generation compare old and new hash values and perform an update if they are different. If they are\n     * equal check for array equality between the old and new index array and perform an update if they are not equal.\n     *\n     * @param oldIndex - Old index array.\n     *\n     * @param oldHash - Old index hash value.\n     *\n     * @param [force=false] - When true forces an update to subscribers.\n     */\n    calcHashUpdate(oldIndex, oldHash, force = false) {\n        // Use force if a boolean otherwise default to false.\n        const actualForce = typeof force === 'boolean' ? force : /* c8 ignore next */ false;\n        let newHash = null;\n        const newIndex = this.indexData.index;\n        if (newIndex) {\n            for (let cntr = newIndex.length; --cntr >= 0;) {\n                newHash ^= DynReducerUtils.hashUnknown(newIndex[cntr]) + 0x9e3779b9 + (newHash << 6) + (newHash >> 2);\n            }\n        }\n        this.indexData.hash = newHash;\n        if (actualForce || (oldHash === newHash ? !DynReducerUtils.arrayEquals(oldIndex, newIndex) : true)) {\n            this.hostUpdate();\n        }\n    }\n    /**\n     * Destroys all resources.\n     */\n    destroy() {\n        if (this.destroyed) {\n            return;\n        }\n        this.indexData.index = null;\n        this.indexData.hash = null;\n        this.indexData.reversed = null;\n        this.indexData.parent = null;\n        this.destroyed = true;\n    }\n    /**\n     * Store associated filter and sort data that are constructed after the indexer.\n     *\n     * @param filtersData - Associated AdapterFilters instance.\n     *\n     * @param sortData - Associated AdapterSort instance.\n     *\n     * @param derivedAdapter - Associated AdapterDerived instance.\n     */\n    initAdapters(filtersData, sortData, derivedAdapter) {\n        this.filtersData = filtersData;\n        this.sortData = sortData;\n        this.derivedAdapter = derivedAdapter;\n        this.sortFn = this.createSortFn();\n    }\n}\n\n/**\n * Provides the storage and sequencing of a managed sort function. The sort function set may be a bespoke function or a\n * {@link DynDataSort} object containing an `compare`, and `subscribe` attributes; `compare` is the only required\n * attribute.\n *\n * Note: You can set a compare function that also has a subscribe function attached as the `subscribe` attribute.\n * If a subscribe function is provided the sort function can notify any updates that may change sort order and this\n * triggers an index update.\n *\n * This class forms the public API which is accessible from the `.sort` getter in the main reducer implementation.\n * ```\n * const dynArray = new DynArrayReducer([...]);\n * dynArray.sort.clear();\n * dynArray.sort.set(...);\n * ```\n */\nclass AdapterSort {\n    #sortData;\n    #indexUpdate;\n    #unsubscribe;\n    /**\n     * @param indexUpdate - Function to update indexer.\n     *\n     * @param sortData - Storage for compare function.\n     */\n    constructor(indexUpdate, sortData) {\n        this.#indexUpdate = indexUpdate;\n        this.#sortData = sortData;\n        Object.freeze(this);\n    }\n    /**\n     * Clears & removes any assigned sort function and triggers an index update.\n     */\n    clear() {\n        const oldCompareFn = this.#sortData.compareFn;\n        this.#sortData.compareFn = null;\n        if (typeof this.#unsubscribe === 'function') {\n            this.#unsubscribe();\n            this.#unsubscribe = void 0;\n        }\n        // Only update index if an old compare function is set.\n        if (typeof oldCompareFn === 'function') {\n            this.#indexUpdate();\n        }\n    }\n    /**\n     * @param data - A callback function that compares two values. Return > 0 to sort b before a;\n     * < 0 to sort a before b; or 0 to keep original order of a & b.\n     *\n     * Note: You can set a compare function that also has a subscribe function attached as the `subscribe` attribute.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort#parameters\n     */\n    set(data) {\n        if (typeof this.#unsubscribe === 'function') {\n            this.#unsubscribe();\n            this.#unsubscribe = void 0;\n        }\n        let compareFn = void 0;\n        let subscribeFn = void 0;\n        switch (typeof data) {\n            case 'function':\n                compareFn = data;\n                subscribeFn = data.subscribe;\n                break;\n            case 'object':\n                // Early out if data is null / noop.\n                if (data === null) {\n                    break;\n                }\n                if (typeof data.compare !== 'function') {\n                    throw new TypeError(`AdapterSort error: 'compare' attribute is not a function.`);\n                }\n                compareFn = data.compare;\n                subscribeFn = data.compare.subscribe ?? data.subscribe;\n                break;\n        }\n        if (typeof compareFn === 'function') {\n            this.#sortData.compareFn = compareFn;\n        }\n        else {\n            const oldCompareFn = this.#sortData.compareFn;\n            this.#sortData.compareFn = null;\n            // Update index if the old compare function exists.\n            if (typeof oldCompareFn === 'function') {\n                this.#indexUpdate();\n            }\n            return;\n        }\n        if (typeof subscribeFn === 'function') {\n            this.#unsubscribe = subscribeFn(this.#indexUpdate);\n            // Ensure that unsubscribe is a function.\n            if (typeof this.#unsubscribe !== 'function') {\n                throw new Error(`AdapterSort error: sort has 'subscribe' function, but no 'unsubscribe' function is returned.`);\n            }\n        }\n        else {\n            // A sort function with subscriber functionality are assumed to immediately invoke the `subscribe` callback.\n            // Only manually update the index if there is no subscriber functionality.\n            this.#indexUpdate();\n        }\n    }\n}\n\n/**\n * Provides the public API for accessing the index API.\n *\n * This class forms the public API which is accessible from the `.index` getter in the main reducer implementation.\n * ```\n * const dynArray = new DynArrayReducer([...]);\n * dynArray.index.active;\n * dynArray.index.hash;\n * dynArray.index.length;\n * dynArray.index.update(...);\n * ```\n */\nclass IndexerAPI {\n    #indexData;\n    /**\n     * Provides a getter to determine if the index is active.\n     */\n    active;\n    /**\n     * Provides length of reduced / indexed elements.\n     */\n    length;\n    /**\n     * Manually invoke an update of the index.\n     *\n     * @param force - Force update to any subscribers.\n     */\n    update;\n    constructor(adapterIndexer) {\n        this.#indexData = adapterIndexer.indexData;\n        this.update = adapterIndexer.update.bind(adapterIndexer);\n        // Defines getters on the public API to get the index hash, active state, and index length.\n        Object.defineProperties(this, {\n            active: { get: () => adapterIndexer.active },\n            length: { get: () => adapterIndexer.length }\n        });\n        Object.freeze(this);\n    }\n    /**\n     * - Current hash value of the index.\n     */\n    get hash() {\n        return this.#indexData.hash;\n    }\n    /**\n     * Provides an iterator over the index array.\n     *\n     * @yields {K}\n     */\n    *[Symbol.iterator]() {\n        const indexData = this.#indexData;\n        if (!indexData.index) {\n            return;\n        }\n        const reversed = indexData.reversed;\n        const length = indexData.index.length;\n        if (reversed) {\n            for (let cntr = length; --cntr >= 0;) {\n                yield indexData.index[cntr];\n            }\n        }\n        else {\n            for (let cntr = 0; cntr < length; cntr++) {\n                yield indexData.index[cntr];\n            }\n        }\n    }\n}\n\n/**\n * Provides the public API for derived reducers. There are several ways to create a derived reducer from utilizing the\n * default implementation or passing in a constructor function / class for a custom derived reducer.\n *\n * This class forms the public API which is accessible from the `.derived` getter in the main reducer implementation.\n * ```\n * const dynArray = new DynArrayReducer([...]);\n * dynArray.derived.clear();\n * dynArray.derived.create(...);\n * dynArray.derived.delete(...);\n * dynArray.derived.destroy();\n * dynArray.derived.get(...);\n * ```\n */\nclass DerivedAPI {\n    /**\n     * Removes all derived reducers and associated subscriptions.\n     */\n    clear;\n    /**\n     * @param options - Options for creating a reducer.\n     *\n     * @returns Newly created derived reducer.\n     */\n    create;\n    /**\n     * Deletes and destroys a derived reducer.\n     *\n     * @param name - Name of the derived reducer\n     */\n    delete;\n    /**\n     * Removes all derived reducers, associated subscriptions, and cleans up all resources.\n     */\n    destroy;\n    /**\n     * Returns an existing derived reducer.\n     *\n     * @param name - Name of derived reducer.\n     */\n    get;\n    constructor(adapterDerived) {\n        this.clear = adapterDerived.clear.bind(adapterDerived);\n        this.create = adapterDerived.create.bind(adapterDerived);\n        this.delete = adapterDerived.delete.bind(adapterDerived);\n        this.destroy = adapterDerived.destroy.bind(adapterDerived);\n        this.get = adapterDerived.get.bind(adapterDerived);\n        Object.freeze(this);\n    }\n}\n\n/**\n */\nlet Indexer$1 = class Indexer extends AdapterIndexer {\n    /**\n     * @inheritDoc\n     */\n    createSortFn() {\n        return (a, b) => this.sortData.compareFn(this.hostData[0][a], this.hostData[0][b]);\n    }\n    /**\n     * Provides the custom filter / reduce step that is ~25-40% faster than implementing with `Array.reduce`.\n     *\n     * Note: Other loop unrolling techniques like Duff's Device gave a slight faster lower bound on large data sets,\n     * but the maintenance factor is not worth the extra complication.\n     *\n     * @returns New filtered index array.\n     */\n    reduceImpl() {\n        const data = [];\n        const array = this.hostData[0];\n        if (!array) {\n            return data;\n        }\n        const filters = this.filtersData.filters;\n        let include = true;\n        const parentIndex = this.indexData.parent;\n        // Source index data is coming from an active parent index.\n        if (DynReducerUtils.isIterable(parentIndex) && parentIndex.active) {\n            for (const adjustedIndex of parentIndex) {\n                const value = array[adjustedIndex];\n                include = true;\n                for (let filCntr = 0, filLength = filters.length; filCntr < filLength; filCntr++) {\n                    if (!filters[filCntr].filter(value)) {\n                        include = false;\n                        break;\n                    }\n                }\n                if (include) {\n                    data.push(adjustedIndex);\n                }\n            }\n        }\n        else {\n            for (let cntr = 0, length = array.length; cntr < length; cntr++) {\n                include = true;\n                for (let filCntr = 0, filLength = filters.length; filCntr < filLength; filCntr++) {\n                    if (!filters[filCntr].filter(array[cntr])) {\n                        include = false;\n                        break;\n                    }\n                }\n                if (include) {\n                    data.push(cntr);\n                }\n            }\n        }\n        return data;\n    }\n    /**\n     * Update the reducer indexes. If there are changes subscribers are notified. If data order is changed externally\n     * pass in true to force an update to subscribers.\n     *\n     * @param [force=false] - When true forces an update to subscribers.\n     */\n    update(force = false) {\n        if (this.destroyed) {\n            return;\n        }\n        const oldIndex = this.indexData.index;\n        const oldHash = this.indexData.hash;\n        const array = this.hostData[0];\n        const parentIndex = this.indexData.parent;\n        // Clear index if there are no filters and no sort function or the index length doesn't match the item length.\n        if ((this.filtersData.filters.length === 0 && !this.sortData.compareFn) ||\n            (this.indexData.index && array?.length !== this.indexData.index.length)) {\n            this.indexData.index = null;\n        }\n        // If there are filters build new index.\n        if (this.filtersData.filters.length > 0) {\n            this.indexData.index = this.reduceImpl();\n        }\n        // If the index isn't built yet and there is an active parent index then create it from the parent.\n        if (!this.indexData.index && parentIndex?.active) {\n            this.indexData.index = [...parentIndex];\n        }\n        if (this.sortData.compareFn && Array.isArray(array)) {\n            // If there is no index then create one with keys matching host item length.\n            if (!this.indexData.index) {\n                this.indexData.index = [...Array(array.length).keys()];\n            }\n            this.indexData.index.sort(this.sortFn);\n        }\n        this.calcHashUpdate(oldIndex, oldHash, force);\n        // Update all derived reducers.\n        this.derivedAdapter?.update(force);\n    }\n};\n\n/**\n * Provides the base implementation derived reducer for arrays / DynArrayReducer.\n */\nclass DynArrayReducerDerived {\n    #array;\n    #derived;\n    #derivedPublicAPI;\n    #filters;\n    #filtersData = { filters: [] };\n    #index;\n    #indexPublicAPI;\n    #reversed = false;\n    #sort;\n    #sortData = { compareFn: null };\n    #subscriptions = [];\n    #destroyed = false;\n    /**\n     * @param array - Data host array.\n     *\n     * @param parentIndex - Parent indexer.\n     *\n     * @param options - Any filters and sort functions to apply.\n     */\n    constructor(array, parentIndex, options) {\n        this.#array = array;\n        this.#index = new Indexer$1(this.#array, this.#updateSubscribers.bind(this), parentIndex);\n        this.#indexPublicAPI = new IndexerAPI(this.#index);\n        this.#filters = new AdapterFilters(this.#indexPublicAPI.update, this.#filtersData);\n        this.#sort = new AdapterSort(this.#indexPublicAPI.update, this.#sortData);\n        this.#derived = new AdapterDerived(this.#array, this.#indexPublicAPI, DynArrayReducerDerived);\n        this.#derivedPublicAPI = new DerivedAPI(this.#derived);\n        this.#index.initAdapters(this.#filtersData, this.#sortData, this.#derived);\n        let filters = void 0;\n        let sort = void 0;\n        if (options !== void 0 && ('filters' in options || 'sort' in options)) {\n            if (options.filters !== void 0) {\n                if (DynReducerUtils.isIterable(options.filters)) {\n                    filters = options.filters;\n                }\n                else {\n                    throw new TypeError(`DerivedArrayReducer error (DataDerivedOptions): 'filters' attribute is not iterable.`);\n                }\n            }\n            if (options.sort !== void 0) {\n                if (typeof options.sort === 'function') {\n                    sort = options.sort;\n                }\n                else if (typeof options.sort === 'object' && options.sort !== null) {\n                    sort = options.sort;\n                }\n                else {\n                    throw new TypeError(`DerivedArrayReducer error (DataDerivedOptions): 'sort' attribute is not a function or object.`);\n                }\n            }\n        }\n        // Add any filters and sort function defined by DataDynArray.\n        if (filters) {\n            this.filters.add(...filters);\n        }\n        if (sort) {\n            this.sort.set(sort);\n        }\n        // Invoke an custom initialization for child classes.\n        this.initialize();\n    }\n    /**\n     * Returns the internal data of this instance. Be careful!\n     *\n     * Note: if an array is set as initial data then that array is used as the internal data. If any changes are\n     * performed to the data externally do invoke {@link IndexerAPI.update} with `true` to recalculate the index and\n     * notify all subscribers.\n     *\n     * @returns The internal data.\n     */\n    get data() { return this.#array[0]; }\n    /**\n     * @returns Derived public API.\n     */\n    get derived() { return this.#derivedPublicAPI; }\n    /**\n     * @returns The filters adapter.\n     */\n    get filters() { return this.#filters; }\n    /**\n     * Returns the Indexer public API.\n     *\n     * @returns Indexer API - is also iterable.\n     */\n    get index() { return this.#indexPublicAPI; }\n    /**\n     * Returns whether this derived reducer is destroyed.\n     */\n    get destroyed() { return this.#destroyed; }\n    /**\n     * @returns Main data / items length or indexed length.\n     */\n    get length() {\n        const array = this.#array[0];\n        return this.#index.active ? this.index.length :\n            array ? array.length : 0;\n    }\n    /**\n     * @returns Gets current reversed state.\n     */\n    get reversed() { return this.#reversed; }\n    /**\n     * @returns The sort adapter.\n     */\n    get sort() { return this.#sort; }\n    /**\n     * Sets reversed state and notifies subscribers.\n     *\n     * @param reversed - New reversed state.\n     */\n    set reversed(reversed) {\n        if (typeof reversed !== 'boolean') {\n            throw new TypeError(`DerivedArrayReducer.reversed error: 'reversed' is not a boolean.`);\n        }\n        this.#reversed = reversed;\n        this.#index.reversed = reversed;\n        // Recalculate index and force an update to any subscribers.\n        this.index.update(true);\n    }\n    /**\n     * Removes all derived reducers, subscriptions, and cleans up all resources.\n     */\n    destroy() {\n        this.#destroyed = true;\n        // Remove any external data reference and perform a final update.\n        this.#array = [null];\n        this.#index.update(true);\n        // Remove all subscriptions.\n        this.#subscriptions.length = 0;\n        this.#derived.destroy();\n        this.#index.destroy();\n        this.#filters.clear();\n        this.#sort.clear();\n    }\n    /**\n     * Provides a callback for custom derived reducers to initialize any data / custom configuration. This allows\n     * child classes to avoid implementing the constructor.\n     *\n     * @protected\n     */\n    initialize() { }\n    /**\n     * Provides an iterator for data stored in DerivedArrayReducer.\n     *\n     * @yields {T}\n     */\n    *[Symbol.iterator]() {\n        const array = this.#array[0];\n        if (this.#destroyed || array === null || array?.length === 0) {\n            return;\n        }\n        if (this.#index.active) {\n            for (const entry of this.index) {\n                yield array[entry];\n            }\n        }\n        else {\n            if (this.reversed) {\n                for (let cntr = array.length; --cntr >= 0;) {\n                    yield array[cntr];\n                }\n            }\n            else {\n                for (let cntr = 0; cntr < array.length; cntr++) {\n                    yield array[cntr];\n                }\n            }\n        }\n    }\n    // -------------------------------------------------------------------------------------------------------------------\n    /**\n     * Subscribe to this DerivedArrayReducer.\n     *\n     * @param handler - Callback function that is invoked on update / changes. Receives `this` reference.\n     *\n     * @returns Unsubscribe function.\n     */\n    subscribe(handler) {\n        this.#subscriptions.push(handler); // add handler to the array of subscribers\n        handler(this); // call handler with current value\n        // Return unsubscribe function.\n        return () => {\n            const index = this.#subscriptions.findIndex((sub) => sub === handler);\n            if (index >= 0) {\n                this.#subscriptions.splice(index, 1);\n            }\n        };\n    }\n    /**\n     * Updates subscribers on changes.\n     */\n    #updateSubscribers() {\n        for (let cntr = 0; cntr < this.#subscriptions.length; cntr++) {\n            this.#subscriptions[cntr](this);\n        }\n    }\n}\n\n/**\n * Provides a managed array with non-destructive reducing / filtering / sorting capabilities with subscription /\n * Svelte store support.\n */\nclass DynArrayReducer {\n    #array = [null];\n    #derived;\n    #derivedPublicAPI;\n    #filters;\n    #filtersData = { filters: [] };\n    #index;\n    #indexPublicAPI;\n    #reversed = false;\n    #sort;\n    #sortData = { compareFn: null };\n    #subscriptions = [];\n    #destroyed = false;\n    /**\n     * Initializes DynArrayReducer. Any iterable is supported for initial data. Take note that if `data` is an array it\n     * will be used as the host array and not copied. All non-array iterables otherwise create a new array / copy.\n     *\n     * @param [data] - Data iterable to store if array or copy otherwise.\n     */\n    constructor(data) {\n        let dataIterable = void 0;\n        let filters = void 0;\n        let sort = void 0;\n        if (data === null) {\n            throw new TypeError(`DynArrayReducer error: 'data' is not iterable.`);\n        }\n        if (data !== void 0 && typeof data !== 'object' && !DynReducerUtils.isIterable(data)) {\n            throw new TypeError(`DynArrayReducer error: 'data' is not iterable.`);\n        }\n        if (data !== void 0 && Symbol.iterator in data) {\n            dataIterable = data;\n        }\n        else if (data !== void 0 && ('data' in data || 'filters' in data || 'sort' in data)) {\n            if (data.data !== void 0 && !DynReducerUtils.isIterable(data.data)) {\n                throw new TypeError(`DynArrayReducer error (DataDynArray): 'data' attribute is not iterable.`);\n            }\n            dataIterable = data.data;\n            if (data.filters !== void 0) {\n                if (DynReducerUtils.isIterable(data.filters)) {\n                    filters = data.filters;\n                }\n                else {\n                    throw new TypeError(`DynArrayReducer error (DataDynArray): 'filters' attribute is not iterable.`);\n                }\n            }\n            if (data.sort !== void 0) {\n                if (typeof data.sort === 'function') {\n                    sort = data.sort;\n                }\n                else if (typeof data.sort === 'object' && data.sort !== null) {\n                    sort = data.sort;\n                }\n                else {\n                    throw new TypeError(`DynArrayReducer error (DataDynArray): 'sort' attribute is not a function or object.`);\n                }\n            }\n        }\n        // In the case of the main data being an array directly use the array otherwise create a copy.\n        if (dataIterable) {\n            this.#array[0] = Array.isArray(dataIterable) ? dataIterable : [...dataIterable];\n        }\n        this.#index = new Indexer$1(this.#array, this.#updateSubscribers.bind(this));\n        this.#indexPublicAPI = new IndexerAPI(this.#index);\n        this.#filters = new AdapterFilters(this.#indexPublicAPI.update, this.#filtersData);\n        this.#sort = new AdapterSort(this.#indexPublicAPI.update, this.#sortData);\n        this.#derived = new AdapterDerived(this.#array, this.#indexPublicAPI, DynArrayReducerDerived);\n        this.#derivedPublicAPI = new DerivedAPI(this.#derived);\n        this.#index.initAdapters(this.#filtersData, this.#sortData, this.#derived);\n        // Add any filters and sort function defined by DataDynArray.\n        if (filters) {\n            this.filters.add(...filters);\n        }\n        if (sort) {\n            this.sort.set(sort);\n        }\n        // Invoke an custom initialization for child classes.\n        this.initialize();\n    }\n    /**\n     * Returns the internal data of this instance. Be careful!\n     *\n     * Note: if an array is set as initial data then that array is used as the internal data. If any changes are\n     * performed to the data externally do invoke {@link AdapterIndexer.index.update} with `true` to recalculate the\n     * index and notify all subscribers.\n     *\n     * @returns The internal data.\n     */\n    get data() { return this.#array[0]; }\n    /**\n     * @returns Derived public API.\n     */\n    get derived() { return this.#derivedPublicAPI; }\n    /**\n     * @returns The filters adapter.\n     */\n    get filters() { return this.#filters; }\n    /**\n     * @returns Returns the Indexer public API.\n     */\n    get index() { return this.#indexPublicAPI; }\n    /**\n     * Returns whether this instance is destroyed.\n     */\n    get destroyed() { return this.#destroyed; }\n    /**\n     * Gets the main data / items length.\n     *\n     * @returns {number} Main data / items length.\n     */\n    get length() {\n        const array = this.#array[0];\n        return this.#index.active ? this.#indexPublicAPI.length :\n            array ? array.length : 0;\n    }\n    /**\n     * Gets current reversed state.\n     *\n     * @returns {boolean} Reversed state.\n     */\n    get reversed() { return this.#reversed; }\n    /**\n     * @returns The sort adapter.\n     */\n    get sort() { return this.#sort; }\n    /**\n     * Sets reversed state and notifies subscribers.\n     *\n     * @param reversed - New reversed state.\n     */\n    set reversed(reversed) {\n        if (typeof reversed !== 'boolean') {\n            throw new TypeError(`DynArrayReducer.reversed error: 'reversed' is not a boolean.`);\n        }\n        this.#reversed = reversed;\n        this.#index.reversed = reversed;\n        // Recalculate index and force an update to any subscribers.\n        this.index.update(true);\n    }\n    /**\n     * Removes all derived reducers, subscriptions, and cleans up all resources.\n     */\n    destroy() {\n        if (this.#destroyed) {\n            return;\n        }\n        this.#destroyed = true;\n        this.#derived.destroy();\n        // Set the backing data to null and provide a final update.\n        this.#array = [null];\n        this.index.update(true);\n        // Remove all subscriptions.\n        this.#subscriptions.length = 0;\n        this.#index.destroy();\n        this.#filters.clear();\n        this.#sort.clear();\n    }\n    /**\n     * Provides a callback for custom reducers to initialize any data / custom configuration. This allows\n     * child classes to avoid implementing the constructor.\n     *\n     * @protected\n     */\n    initialize() { }\n    /**\n     * Removes internal data and pushes new data. This does not destroy any initial array set to internal data unless\n     * `replace` is set to true.\n     *\n     * @param data - New data to set to internal data.\n     *\n     * @param replace=false - New data to set to internal data.\n     */\n    setData(data, replace = false) {\n        if (data !== null && !DynReducerUtils.isIterable(data)) {\n            throw new TypeError(`DynArrayReducer.setData error: 'data' is not iterable.`);\n        }\n        if (typeof replace !== 'boolean') {\n            throw new TypeError(`DynArrayReducer.setData error: 'replace' is not a boolean.`);\n        }\n        const array = this.#array[0];\n        // If the array isn't defined or 'replace' is true then replace internal data with new array or create an array\n        // from an iterable.\n        if (!Array.isArray(array) || replace) {\n            if (data) {\n                this.#array[0] = Array.isArray(data) ? data : [...data];\n            }\n        }\n        else {\n            if (data) {\n                // Remove all entries in internal data. This will not replace any initially set array.\n                array.length = 0;\n                // Add all new data.\n                array.push(...data);\n            }\n            else {\n                this.#array[0] = null;\n            }\n        }\n        // Recalculate index and force an update to any subscribers.\n        this.index.update(true);\n    }\n    /**\n     * Add a subscriber to this DynArrayReducer instance.\n     *\n     * @param handler - Callback function that is invoked on update / changes. Receives `this` reference.\n     *\n     * @returns Unsubscribe function.\n     */\n    subscribe(handler) {\n        this.#subscriptions.push(handler); // add handler to the array of subscribers\n        handler(this); // call handler with current value\n        // Return unsubscribe function.\n        return () => {\n            const index = this.#subscriptions.findIndex((sub) => sub === handler);\n            if (index >= 0) {\n                this.#subscriptions.splice(index, 1);\n            }\n        };\n    }\n    /**\n     * Updates subscribers on changes.\n     */\n    #updateSubscribers() {\n        for (let cntr = 0; cntr < this.#subscriptions.length; cntr++) {\n            this.#subscriptions[cntr](this);\n        }\n    }\n    /**\n     * Provides an iterator for data stored in DynArrayReducer.\n     *\n     * @yields {T}\n     */\n    *[Symbol.iterator]() {\n        const array = this.#array[0];\n        if (this.#destroyed || array === null || array?.length === 0) {\n            return;\n        }\n        if (this.#index.active) {\n            for (const entry of this.index) {\n                yield array[entry];\n            }\n        }\n        else {\n            if (this.reversed) {\n                for (let cntr = array.length; --cntr >= 0;) {\n                    yield array[cntr];\n                }\n            }\n            else {\n                for (let cntr = 0; cntr < array.length; cntr++) {\n                    yield array[cntr];\n                }\n            }\n        }\n    }\n}\n\n/**\n */\nclass Indexer extends AdapterIndexer {\n    /**\n     * @inheritDoc\n     */\n    createSortFn() {\n        return (a, b) => this.sortData.compareFn(this.hostData[0].get(a), this.hostData[0].get(b));\n    }\n    /**\n     * Provides the custom filter / reduce step that is ~25-40% faster than implementing with `Array.reduce`.\n     *\n     * Note: Other loop unrolling techniques like Duff's Device gave a slight faster lower bound on large data sets,\n     * but the maintenance factor is not worth the extra complication.\n     *\n     * @returns New filtered index array.\n     */\n    reduceImpl() {\n        const data = [];\n        const map = this.hostData[0];\n        if (!map) {\n            return data;\n        }\n        const filters = this.filtersData.filters;\n        let include = true;\n        const parentIndex = this.indexData.parent;\n        // Source index data is coming from an active parent index.\n        if (DynReducerUtils.isIterable(parentIndex) && parentIndex.active) {\n            for (const key of parentIndex) {\n                const value = map.get(key);\n                include = true;\n                for (let filCntr = 0, filLength = filters.length; filCntr < filLength; filCntr++) {\n                    if (!filters[filCntr].filter(value)) {\n                        include = false;\n                        break;\n                    }\n                }\n                if (include) {\n                    data.push(key);\n                }\n            }\n        }\n        else {\n            for (const key of map.keys()) {\n                include = true;\n                const value = map.get(key);\n                for (let filCntr = 0, filLength = filters.length; filCntr < filLength; filCntr++) {\n                    if (!filters[filCntr].filter(value)) {\n                        include = false;\n                        break;\n                    }\n                }\n                if (include) {\n                    data.push(key);\n                }\n            }\n        }\n        return data;\n    }\n    /**\n     * Update the reducer indexes. If there are changes subscribers are notified. If data order is changed externally\n     * pass in true to force an update to subscribers.\n     *\n     * @param [force=false] - When true forces an update to subscribers.\n     */\n    update(force = false) {\n        if (this.destroyed) {\n            return;\n        }\n        const oldIndex = this.indexData.index;\n        const oldHash = this.indexData.hash;\n        const map = this.hostData[0];\n        const parentIndex = this.indexData.parent;\n        // Clear index if there are no filters and no sort function or the index length doesn't match the item length.\n        if ((this.filtersData.filters.length === 0 && !this.sortData.compareFn) ||\n            (this.indexData.index && map?.size !== this.indexData.index.length)) {\n            this.indexData.index = null;\n        }\n        // If there are filters build new index.\n        if (this.filtersData.filters.length > 0) {\n            this.indexData.index = this.reduceImpl();\n        }\n        // If the index isn't built yet and there is an active parent index then create it from the parent.\n        if (!this.indexData.index && parentIndex?.active) {\n            this.indexData.index = [...parentIndex];\n        }\n        if (this.sortData.compareFn && map instanceof Map) {\n            // If there is no index then create one with keys matching host item length.\n            if (!this.indexData.index) {\n                this.indexData.index = this.indexData.index = [...map.keys()];\n            }\n            this.indexData.index.sort(this.sortFn);\n        }\n        this.calcHashUpdate(oldIndex, oldHash, force);\n        // Update all derived reducers.\n        this.derivedAdapter?.update(force);\n    }\n}\n\n/**\n * Provides the base implementation derived reducer for arrays / DynArrayReducer.\n */\nclass DynMapReducerDerived {\n    #map;\n    #derived;\n    #derivedPublicAPI;\n    #filters;\n    #filtersData = { filters: [] };\n    #index;\n    #indexPublicAPI;\n    #reversed = false;\n    #sort;\n    #sortData = { compareFn: null };\n    #subscriptions = [];\n    #destroyed = false;\n    /**\n     * @param map - Data host Map.\n     *\n     * @param parentIndex - Parent indexer.\n     *\n     * @param options - Any filters and sort functions to apply.\n     */\n    constructor(map, parentIndex, options) {\n        this.#map = map;\n        this.#index = new Indexer(this.#map, this.#updateSubscribers.bind(this), parentIndex);\n        this.#indexPublicAPI = new IndexerAPI(this.#index);\n        this.#filters = new AdapterFilters(this.#indexPublicAPI.update, this.#filtersData);\n        this.#sort = new AdapterSort(this.#indexPublicAPI.update, this.#sortData);\n        this.#derived = new AdapterDerived(this.#map, this.#indexPublicAPI, DynMapReducerDerived);\n        this.#derivedPublicAPI = new DerivedAPI(this.#derived);\n        this.#index.initAdapters(this.#filtersData, this.#sortData, this.#derived);\n        let filters = void 0;\n        let sort = void 0;\n        if (options !== void 0 && ('filters' in options || 'sort' in options)) {\n            if (options.filters !== void 0) {\n                if (DynReducerUtils.isIterable(options.filters)) {\n                    filters = options.filters;\n                }\n                else {\n                    throw new TypeError(`DerivedMapReducer error (DataDerivedOptions): 'filters' attribute is not iterable.`);\n                }\n            }\n            if (options.sort !== void 0) {\n                if (typeof options.sort === 'function') {\n                    sort = options.sort;\n                }\n                else if (typeof options.sort === 'object' && options.sort !== null) {\n                    sort = options.sort;\n                }\n                else {\n                    throw new TypeError(`DerivedMapReducer error (DataDerivedOptions): 'sort' attribute is not a function or object.`);\n                }\n            }\n        }\n        // Add any filters and sort function defined by DataDynArray.\n        if (filters) {\n            this.filters.add(...filters);\n        }\n        if (sort) {\n            this.sort.set(sort);\n        }\n        // Invoke an custom initialization for child classes.\n        this.initialize();\n    }\n    /**\n     * Returns the internal data of this instance. Be careful!\n     *\n     * Note: The returned map is the same map set by the main reducer. If any changes are performed to the data\n     * externally do invoke {@link IndexerAPI.update} with `true` to recalculate the index and notify all subscribers.\n     *\n     * @returns The internal data.\n     */\n    get data() { return this.#map[0]; }\n    /**\n     * @returns Derived public API.\n     */\n    get derived() { return this.#derivedPublicAPI; }\n    /**\n     * @returns The filters adapter.\n     */\n    get filters() { return this.#filters; }\n    /**\n     * Returns the Indexer public API.\n     *\n     * @returns Indexer API - is also iterable.\n     */\n    get index() { return this.#indexPublicAPI; }\n    /**\n     * Returns whether this derived reducer is destroyed.\n     */\n    get destroyed() { return this.#destroyed; }\n    /**\n     * @returns Main data / items length or indexed length.\n     */\n    get length() {\n        const map = this.#map[0];\n        return this.#index.active ? this.index.length :\n            map ? map.size : 0;\n    }\n    /**\n     * @returns Gets current reversed state.\n     */\n    get reversed() { return this.#reversed; }\n    /**\n     * @returns The sort adapter.\n     */\n    get sort() { return this.#sort; }\n    /**\n     * Sets reversed state and notifies subscribers.\n     *\n     * @param reversed - New reversed state.\n     */\n    set reversed(reversed) {\n        if (typeof reversed !== 'boolean') {\n            throw new TypeError(`DerivedMapReducer.reversed error: 'reversed' is not a boolean.`);\n        }\n        this.#reversed = reversed;\n        this.#index.reversed = reversed;\n        // Recalculate index and force an update to any subscribers.\n        this.index.update(true);\n    }\n    /**\n     * Removes all derived reducers, subscriptions, and cleans up all resources.\n     */\n    destroy() {\n        this.#destroyed = true;\n        // Remove any external data reference and perform a final update.\n        this.#map = [null];\n        this.#index.update(true);\n        // Remove all subscriptions.\n        this.#subscriptions.length = 0;\n        this.#derived.destroy();\n        this.#index.destroy();\n        this.#filters.clear();\n        this.#sort.clear();\n    }\n    /**\n     * Provides a callback for custom derived reducers to initialize any data / custom configuration. This allows\n     * child classes to avoid implementing the constructor.\n     *\n     * @protected\n     */\n    initialize() { }\n    /**\n     * Provides an iterator for data stored in DerivedMapReducer.\n     *\n     * @yields {T}\n     */\n    *[Symbol.iterator]() {\n        const map = this.#map[0];\n        if (this.#destroyed || map === null || map?.size === 0) {\n            return;\n        }\n        if (this.#index.active) {\n            for (const key of this.index) {\n                yield map.get(key);\n            }\n        }\n        else {\n            if (this.reversed) {\n                // TODO: Not efficient due to creating temporary values array.\n                const values = [...map.values()];\n                for (let cntr = values.length; --cntr >= 0;) {\n                    yield values[cntr];\n                }\n            }\n            else {\n                for (const value of map.values()) {\n                    yield value;\n                }\n            }\n        }\n    }\n    // -------------------------------------------------------------------------------------------------------------------\n    /**\n     * Subscribe to this DerivedMapReducer.\n     *\n     * @param handler - Callback function that is invoked on update / changes. Receives `this` reference.\n     *\n     * @returns Unsubscribe function.\n     */\n    subscribe(handler) {\n        this.#subscriptions.push(handler); // add handler to the array of subscribers\n        handler(this); // call handler with current value\n        // Return unsubscribe function.\n        return () => {\n            const index = this.#subscriptions.findIndex((sub) => sub === handler);\n            if (index >= 0) {\n                this.#subscriptions.splice(index, 1);\n            }\n        };\n    }\n    /**\n     * Updates subscribers on changes.\n     */\n    #updateSubscribers() {\n        for (let cntr = 0; cntr < this.#subscriptions.length; cntr++) {\n            this.#subscriptions[cntr](this);\n        }\n    }\n}\n\n/**\n * Provides a managed Map with non-destructive reducing / filtering / sorting capabilities with subscription /\n * Svelte store support.\n */\nclass DynMapReducer {\n    #map = [null];\n    #derived;\n    #derivedPublicAPI;\n    #filters;\n    #filtersData = { filters: [] };\n    #index;\n    #indexPublicAPI;\n    #reversed = false;\n    #sort;\n    #sortData = { compareFn: null };\n    #subscriptions = [];\n    #destroyed = false;\n    /**\n     * Initializes DynMapReducer. Any iterable is supported for initial data. Take note that if `data` is an array it\n     * will be used as the host array and not copied. All non-array iterables otherwise create a new array / copy.\n     *\n     * @param [data] - Data iterable to store if array or copy otherwise.\n     */\n    constructor(data) {\n        let dataMap = void 0;\n        let filters = void 0;\n        let sort = void 0;\n        if (data === null) {\n            throw new TypeError(`DynMapReducer error: 'data' is not an object or Map.`);\n        }\n        if (data !== void 0 && typeof data !== 'object' && !(data instanceof Map)) {\n            throw new TypeError(`DynMapReducer error: 'data' is not an object or Map.`);\n        }\n        if (data !== void 0 && data instanceof Map) {\n            dataMap = data;\n        }\n        else if (data !== void 0 && ('data' in data || 'filters' in data || 'sort' in data)) {\n            if (data.data !== void 0 && !(data.data instanceof Map)) {\n                throw new TypeError(`DynMapReducer error (DataDynMap): 'data' attribute is not a Map.`);\n            }\n            dataMap = data.data;\n            if (data.filters !== void 0) {\n                if (DynReducerUtils.isIterable(data.filters)) {\n                    filters = data.filters;\n                }\n                else {\n                    throw new TypeError(`DynMapReducer error (DataDynMap): 'filters' attribute is not iterable.`);\n                }\n            }\n            if (data.sort !== void 0) {\n                if (typeof data.sort === 'function') {\n                    sort = data.sort;\n                }\n                else if (typeof data.sort === 'object' && data.sort !== null) {\n                    sort = data.sort;\n                }\n                else {\n                    throw new TypeError(`DynMapReducer error (DataDynMap): 'sort' attribute is not a function or object.`);\n                }\n            }\n        }\n        // In the case of the main data being an array directly use the array otherwise create a copy.\n        if (dataMap) {\n            this.#map[0] = dataMap;\n        }\n        this.#index = new Indexer(this.#map, this.#updateSubscribers.bind(this));\n        this.#indexPublicAPI = new IndexerAPI(this.#index);\n        this.#filters = new AdapterFilters(this.#indexPublicAPI.update, this.#filtersData);\n        this.#sort = new AdapterSort(this.#indexPublicAPI.update, this.#sortData);\n        this.#derived = new AdapterDerived(this.#map, this.#indexPublicAPI, DynMapReducerDerived);\n        this.#derivedPublicAPI = new DerivedAPI(this.#derived);\n        this.#index.initAdapters(this.#filtersData, this.#sortData, this.#derived);\n        // Add any filters and sort function defined by DataDynMap.\n        if (filters) {\n            this.filters.add(...filters);\n        }\n        if (sort) {\n            this.sort.set(sort);\n        }\n        // Invoke an custom initialization for child classes.\n        this.initialize();\n    }\n    /**\n     * Returns the internal data of this instance. Be careful!\n     *\n     * Note: When a map is set as data then that map is used as the internal data. If any changes are\n     * performed to the data externally do invoke {@link AdapterIndexer.index.update} with `true` to recalculate the\n     * index and notify all subscribers.\n     *\n     * @returns The internal data.\n     */\n    get data() { return this.#map[0]; }\n    /**\n     * @returns Derived public API.\n     */\n    get derived() { return this.#derivedPublicAPI; }\n    /**\n     * @returns The filters adapter.\n     */\n    get filters() { return this.#filters; }\n    /**\n     * @returns Returns the Indexer public API.\n     */\n    get index() { return this.#indexPublicAPI; }\n    /**\n     * Returns whether this instance is destroyed.\n     */\n    get destroyed() { return this.#destroyed; }\n    /**\n     * Gets the main data / items length.\n     *\n     * @returns {number} Main data / items length.\n     */\n    get length() {\n        const map = this.#map[0];\n        return this.#index.active ? this.#indexPublicAPI.length :\n            map ? map.size : 0;\n    }\n    /**\n     * Gets current reversed state.\n     *\n     * @returns {boolean} Reversed state.\n     */\n    get reversed() { return this.#reversed; }\n    /**\n     * @returns The sort adapter.\n     */\n    get sort() { return this.#sort; }\n    /**\n     * Sets reversed state and notifies subscribers.\n     *\n     * @param reversed - New reversed state.\n     */\n    set reversed(reversed) {\n        if (typeof reversed !== 'boolean') {\n            throw new TypeError(`DynMapReducer.reversed error: 'reversed' is not a boolean.`);\n        }\n        this.#reversed = reversed;\n        this.#index.reversed = reversed;\n        // Recalculate index and force an update to any subscribers.\n        this.index.update(true);\n    }\n    /**\n     * Removes all derived reducers, subscriptions, and cleans up all resources.\n     */\n    destroy() {\n        if (this.#destroyed) {\n            return;\n        }\n        this.#destroyed = true;\n        this.#derived.destroy();\n        // Set the backing data to null and provide a final update.\n        this.#map = [null];\n        this.index.update(true);\n        // Remove all subscriptions.\n        this.#subscriptions.length = 0;\n        this.#index.destroy();\n        this.#filters.clear();\n        this.#sort.clear();\n    }\n    /**\n     * Provides a callback for custom reducers to initialize any data / custom configuration. This allows\n     * child classes to avoid implementing the constructor.\n     *\n     * @protected\n     */\n    initialize() { }\n    /**\n     * Removes internal data and pushes new data. This does not destroy any initial array set to internal data unless\n     * `replace` is set to true.\n     *\n     * @param data - New data to set to internal data.\n     *\n     * @param replace=false - New data to set to internal data.\n     */\n    setData(data, replace = false) {\n        if (data !== null && !(data instanceof Map)) {\n            throw new TypeError(`DynMapReducer.setData error: 'data' is not iterable.`);\n        }\n        if (typeof replace !== 'boolean') {\n            throw new TypeError(`DynMapReducer.setData error: 'replace' is not a boolean.`);\n        }\n        const map = this.#map[0];\n        // If the array isn't defined or 'replace' is true then replace internal data with new array or create an array\n        // from an iterable.\n        if (!(map instanceof Map) || replace) {\n            this.#map[0] = data instanceof Map ? data : null;\n        }\n        else if (data instanceof Map && map instanceof Map) {\n            // Create a set of all current entry IDs.\n            const removeKeySet = new Set(map.keys());\n            for (const key of data.keys()) {\n                map.set(key, data.get(key));\n                if (removeKeySet.has(key)) {\n                    removeKeySet.delete(key);\n                }\n            }\n            // Remove entries that are no longer in data.\n            for (const key of removeKeySet) {\n                map.delete(key);\n            }\n        }\n        else if (data === null) {\n            this.#map[0] = null;\n        }\n        // Recalculate index and force an update to any subscribers.\n        this.index.update(true);\n    }\n    /**\n     * Add a subscriber to this DynMapReducer instance.\n     *\n     * @param handler - Callback function that is invoked on update / changes. Receives `this` reference.\n     *\n     * @returns Unsubscribe function.\n     */\n    subscribe(handler) {\n        this.#subscriptions.push(handler); // add handler to the array of subscribers\n        handler(this); // call handler with current value\n        // Return unsubscribe function.\n        return () => {\n            const index = this.#subscriptions.findIndex((sub) => sub === handler);\n            if (index >= 0) {\n                this.#subscriptions.splice(index, 1);\n            }\n        };\n    }\n    /**\n     * Updates subscribers on changes.\n     */\n    #updateSubscribers() {\n        for (let cntr = 0; cntr < this.#subscriptions.length; cntr++) {\n            this.#subscriptions[cntr](this);\n        }\n    }\n    /**\n     * Provides an iterator for data stored in DynMapReducer.\n     *\n     * @yields {T}\n     */\n    *[Symbol.iterator]() {\n        const map = this.#map[0];\n        if (this.#destroyed || map === null || map?.size === 0) {\n            return;\n        }\n        if (this.#index.active) {\n            for (const key of this.index) {\n                yield map.get(key);\n            }\n        }\n        else {\n            if (this.reversed) {\n                // TODO: Not efficient due to creating temporary values array.\n                const values = [...map.values()];\n                for (let cntr = values.length; --cntr >= 0;) {\n                    yield values[cntr];\n                }\n            }\n            else {\n                for (const value of map.values()) {\n                    yield value;\n                }\n            }\n        }\n    }\n}\n\n/**\n * Creates a filter function to compare objects by a give property key against a regex test. The returned function\n * is also a writable Svelte store that builds a regex from the stores value.\n *\n * This filter function can be used w/ a dynamic reducer and bound as a store to input elements.\n *\n * @param {string|Iterable<string>}   accessors - Property key / accessors to lookup key to compare. To access deeper\n *        entries into the object format the accessor string with `.` between entries to walk.\n *\n * @param {object}   [opts] - Optional parameters.\n *\n * @param {boolean}  [opts.accessWarn=false] - When true warnings will be posted if accessor not retrieved.\n  *\n * @param {boolean}  [opts.caseSensitive=false] - When true regex test is case-sensitive.\n *\n * @param {import('svelte/store').Writable<string>}  [opts.store] - Use the provided store to instead of creating\n *        a default writable store.\n *\n * @returns {((data: object) => boolean) & import('svelte/store').Writable<string>} The query string filter.\n */\nfunction regexObjectQuery(accessors, { accessWarn = false, caseSensitive = false, store } = {})\n{\n   let keyword = '';\n   let regex;\n\n   if (store !== void 0 && !isWritableStore(store))\n   {\n      throw new TypeError(`createObjectQuery error: 'store' is not a writable store.`);\n   }\n\n   const storeKeyword = store ? store : writable(keyword);\n\n   // If an existing store is provided then set initial values.\n   if (store)\n   {\n      const current = get(store);\n\n      if (typeof current === 'string')\n      {\n         keyword = Strings.normalize(current);\n         regex = new RegExp(Strings.escape(keyword), caseSensitive ? '' : 'i');\n      }\n      else\n      {\n         store.set(keyword);\n      }\n   }\n\n   /**\n    * If there is no filter keyword / regex then do not filter otherwise filter based on the regex\n    * created from the search input element.\n    *\n    * @param {object} data - Data object to test against regex.\n    *\n    * @returns {boolean} AnimationStore filter state.\n    */\n   function filterQuery(data)\n   {\n      if (keyword === '' || !regex) { return true; }\n\n      if (isIterable(accessors))\n      {\n         for (const accessor of accessors)\n         {\n            const value = safeAccess(data, accessor);\n            if (typeof value !== 'string')\n            {\n               if (accessWarn)\n               {\n                  console.warn(`regexObjectQuery warning: could not access string data from '${accessor}'.`);\n               }\n\n               continue;\n            }\n\n            if (regex.test(Strings.normalize(value))) { return true; }\n         }\n\n         return false;\n      }\n      else\n      {\n         const value = safeAccess(data, accessors);\n\n         if (typeof value !== 'string')\n         {\n            if (accessWarn)\n            {\n               console.warn(`regexObjectQuery warning: could not access string data from '${accessors}'.`);\n            }\n\n            return false;\n         }\n\n         return regex.test(Strings.normalize(value));\n      }\n   }\n\n   /**\n    * Create a custom store that changes when the search keyword changes.\n    *\n    * @param {(string) => void} handler - A callback function that accepts strings.\n    *\n    * @returns {import('svelte/store').Unsubscriber} Store unsubscribe function.\n    */\n   filterQuery.subscribe = (handler) =>\n   {\n      return storeKeyword.subscribe(handler);\n   };\n\n   /**\n    * Set\n    *\n    * @param {string}   value - A new value for the keyword / regex test.\n    */\n   filterQuery.set = (value) =>\n   {\n      if (typeof value === 'string')\n      {\n         keyword = Strings.normalize(value);\n         regex = new RegExp(Strings.escape(keyword), caseSensitive ? '' : 'i');\n         storeKeyword.set(keyword);\n      }\n   };\n\n   return filterQuery;\n}\n\nconst filters = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    regexObjectQuery: regexObjectQuery\n});\n\n/**\n * Provides helper functions to create dynamic store driven filters and sort functions for dynamic reducers. The\n * returned functions are also Svelte stores and can be added to a reducer as well as used as a store.\n */\nclass DynReducerHelper\n{\n   /**\n    * Returns the following filter functions:\n    * - regexObjectQuery(accessors, options); suitable for object reducers matching one or more property keys /\n    *   accessors against the store value as a regex. To access deeper entries into the object format the accessor\n    *   string with `.` between entries to walk. Optional parameters include logging access warnings, case sensitivity,\n    *   and passing in an existing store.\n    *\n    * @returns {{\n    *    regexObjectQuery: (accessors: string|Iterable<string>, options?: {accessWarn?: boolean, caseSensitive?: boolean, store?: import('svelte/store').Writable<string>}) => (((data: {}) => boolean) & import('svelte/store').Writable<string>)\n    * }} All available filters.\n    */\n   static get filters() { return filters; }\n}\n\nexport { DynArrayReducer, DynArrayReducerDerived, DynMapReducer, DynMapReducerDerived, DynReducerHelper };\n//# sourceMappingURL=index.js.map\n","import { Hashing } from '@typhonjs-fvtt/runtime/util';\nimport { isPlainObject, isObject, hasPrototype } from '@typhonjs-fvtt/runtime/util/object';\nimport { DynMapReducer } from '@typhonjs-fvtt/runtime/svelte/store/reducer';\n\n/**\n * Provides management of reactive embedded collections.\n *\n * TODO: Consider subscribing to TJSDocument rather than exposing {@link EmbeddedStoreManager.handleDocChange} and\n * {@link EmbeddedStoreManager.handleUpdate}\n */\nclass EmbeddedStoreManager\n{\n   /**\n    * RegExp for detecting CRUD updates for renderContext.\n    *\n    * @type {RegExp}\n    */\n   static #renderContextRegex = /(?<action>create|delete|update)(?<sep>\\.?)(?<name>\\w+)/;\n\n   /**\n    * @type {Map<string, EmbeddedCollectionData<any>>}\n    */\n   #name = new Map();\n\n   /**\n    * @type {foundry.abstract.Document[]}\n    */\n   #document;\n\n   /**\n    * @type {Map<string, string>}\n    */\n   #collectionToDocName = new Map();\n\n   /**\n    * @type {Set<string>}\n    */\n   #embeddedNames = new Set();\n\n   /**\n    * @param {foundry.abstract.Document[]} document - The associated document holder.\n    */\n   constructor(document)\n   {\n      this.#document = document;\n\n      this.handleDocChange();\n\n      Object.seal(this);\n   }\n\n   /**\n    * @template [T=import('./types').NamedDocumentConstructor]\n    *\n    * @param {T} FoundryDoc - A Foundry document class / constructor.\n    *\n    * @param {import('#runtime/svelte/store/reducer').DynOptionsMapCreate<string, T>} options - DynMapReducer\n    *        creation options.\n    *\n    * @returns {import('#runtime/svelte/store/reducer').DynMapReducer<string, T>} DynMapReducer instance.\n    */\n   create(FoundryDoc, options)\n   {\n      const docName = FoundryDoc?.documentName;\n\n      if (typeof docName !== 'string')\n      {\n         throw new TypeError(\n          `EmbeddedStoreManager.create error: 'FoundryDoc' does not have a valid 'documentName' property.`);\n      }\n\n      /** @type {foundry.abstract.Document} */\n      const doc = this.#document[0];\n\n      let collection = null;\n\n      if (doc)\n      {\n         try\n         {\n            collection = doc.getEmbeddedCollection(docName);\n         }\n         catch (err)\n         {\n            console.warn(`EmbeddedStoreManager.create error: No valid embedded collection for: ${docName}`);\n         }\n      }\n\n      let embeddedData;\n\n      if (!this.#name.has(docName))\n      {\n         embeddedData = {\n            collection,\n            stores: new Map()\n         };\n\n         this.#name.set(docName, embeddedData);\n      }\n      else\n      {\n         embeddedData = this.#name.get(docName);\n      }\n\n      /** @type {string} */\n      let name;\n\n      /** @type {import('#runtime/svelte/store/reducer').DynDataOptions<T>} */\n      let rest = {};\n\n      /** @type {import('#runtime/svelte/store/reducer').IDynMapReducerCtor<string, T>} */\n      let ctor;\n\n      if (typeof options === 'string')\n      {\n         name = options;\n         ctor = DynMapReducer;\n      }\n      else if (typeof options === 'function' && hasPrototype(options, DynMapReducer))\n      {\n         ctor = options;\n      }\n      else if (isObject(options))\n      {\n         ({ name, ctor = DynMapReducer, ...rest } = options);\n      }\n      else\n      {\n         throw new TypeError(`EmbeddedStoreManager.create error: 'options' does not conform to allowed parameters.`);\n      }\n\n      if (!hasPrototype(ctor, DynMapReducer))\n      {\n         throw new TypeError(`EmbeddedStoreManager.create error: 'ctor' is not a 'DynMapReducer'.`);\n      }\n\n      name = name ?? ctor?.name;\n\n      if (typeof name !== 'string')\n      {\n         throw new TypeError(`EmbeddedStoreManager.create error: 'name' is not a string.`);\n      }\n\n      if (embeddedData.stores.has(name))\n      {\n         return embeddedData.stores.get(name);\n      }\n      else\n      {\n         const storeOptions = collection ? { data: collection, ...rest } : { ...rest };\n         const store = new ctor(storeOptions);\n         embeddedData.stores.set(name, store);\n         return store;\n      }\n   }\n\n   /**\n    * @template [T=import('./types').NamedDocumentConstructor]\n    *\n    * Destroys and removes embedded collection stores. Invoking this method with no parameters destroys all stores.\n    * Invoking with an embedded name destroys all stores for that particular collection. If you provide an embedded and\n    * store name just that particular store is destroyed and removed.\n    *\n    * @param {T}   [FoundryDoc] - A Foundry document class / constructor.\n    *\n    * @param {string}   [storeName] - Specific store name.\n    *\n    * @returns {boolean} One or more stores destroyed?\n    */\n   destroy(FoundryDoc, storeName)\n   {\n      let count = 0;\n\n      // Destroy all embedded stores\n      if (FoundryDoc === void 0)\n      {\n         for (const embeddedData of this.#name.values())\n         {\n            embeddedData.collection = null;\n            for (const store of embeddedData.stores.values())\n            {\n               store.destroy();\n               count++;\n            }\n         }\n\n         this.#name.clear();\n      }\n      else\n      {\n         const docName = FoundryDoc?.documentName;\n\n         if (typeof docName !== 'string')\n         {\n            throw new TypeError(\n             `EmbeddedStoreManager.delete error: 'FoundryDoc' does not have a valid 'documentName' property.`);\n         }\n\n         if (storeName === void 0)\n         {\n            const embeddedData = this.#name.get(docName);\n            if (embeddedData)\n            {\n               embeddedData.collection = null;\n               for (const store of embeddedData.stores.values())\n               {\n                  store.destroy();\n                  count++;\n               }\n            }\n\n            this.#name.delete(docName);\n         }\n         else if (storeName === 'string')\n         {\n            const embeddedData = this.#name.get(docName);\n            if (embeddedData)\n            {\n               const store = embeddedData.stores.get(storeName);\n               if (store)\n               {\n                  store.destroy();\n                  count++;\n               }\n            }\n         }\n      }\n\n      return count > 0;\n   }\n\n   /**\n    * @template [T=import('./types').NamedDocumentConstructor]\n    *\n    * @param {T} FoundryDoc - A Foundry document class / constructor.\n    *\n    * @param {string} storeName - Name of the embedded collection to retrieve.\n    *\n    * @returns {import('#runtime/svelte/store/reducer').DynMapReducer<string, InstanceType<T>>} DynMapReducer\n    *          instance.\n    */\n   get(FoundryDoc, storeName)\n   {\n      const docName = FoundryDoc?.documentName;\n\n      if (typeof docName !== 'string')\n      {\n         throw new TypeError(\n          `EmbeddedStoreManager.get error: 'FoundryDoc' does not have a valid 'documentName' property.`);\n      }\n\n      if (!this.#name.has(docName)) { return void 0; }\n\n      return this.#name.get(docName).stores.get(storeName);\n   }\n\n   /**\n    * Updates all existing embedded collection stores with the associated embedded collection\n    */\n   handleDocChange()\n   {\n      const doc = this.#document[0];\n\n      if (doc instanceof globalThis.foundry.abstract.Document)\n      {\n         const existingEmbeddedNames = new Set(this.#name.keys());\n\n         /** @type {[string, string][]} */\n         const embeddedNames = Object.entries(doc.constructor?.metadata?.embedded ?? []);\n\n         this.#collectionToDocName.clear();\n\n         // Remove all previously stored embedded name CRUD keys.\n         this.#embeddedNames.clear();\n\n         for (const [docName, collectionName] of embeddedNames)\n         {\n            // Remove processed embedded doc name from existingEmbeddedNames set.\n            existingEmbeddedNames.delete(docName);\n\n            // Update CRUD keys for v10.\n            this.#embeddedNames.add(`create${docName}`);\n            this.#embeddedNames.add(`delete${docName}`);\n            this.#embeddedNames.add(`update${docName}`);\n\n            // Update CRUD keys for v11.\n            this.#embeddedNames.add(`create.${collectionName}`);\n            this.#embeddedNames.add(`delete.${collectionName}`);\n            this.#embeddedNames.add(`update.${collectionName}`);\n\n            // Update CRUD keys for v12.\n            this.#embeddedNames.add(`create${collectionName}`);\n            this.#embeddedNames.add(`delete${collectionName}`);\n            this.#embeddedNames.add(`update${collectionName}`);\n\n            // v10 collection to doc name lookup.\n            this.#collectionToDocName.set(docName, docName);\n            this.#collectionToDocName.set(collectionName, docName);\n\n            let collection = null;\n\n            try\n            {\n               // Update any existing stores with the actual collection.\n               collection = doc.getEmbeddedCollection(docName);\n            }\n            catch (err)\n            {\n               console.warn(`EmbeddedStoreManager.handleDocUpdate error: No valid embedded collection for: ${docName}`);\n            }\n\n            // Update EmbeddedData for new collection.\n            const embeddedData = this.#name.get(docName);\n            if (embeddedData)\n            {\n               embeddedData.collection = collection;\n\n               // Update all existing stores.\n               for (const store of embeddedData.stores.values()) { store.setData(collection, true); }\n            }\n         }\n\n         // Update all existing embedded collections with null data that aren't processed above.\n         for (const embeddedName of existingEmbeddedNames)\n         {\n            const embeddedData = this.#name.get(embeddedName);\n            if (embeddedData)\n            {\n               embeddedData.collection = null;\n\n               for (const store of embeddedData.stores.values()) { store.setData(null, true); }\n            }\n         }\n      }\n      else // Reset all embedded reducer stores to null data.\n      {\n         this.#collectionToDocName.clear();\n         this.#embeddedNames.clear();\n\n         for (const embeddedData of this.#name.values())\n         {\n            embeddedData.collection = null;\n\n            for (const store of embeddedData.stores.values()) { store.setData(null, true); }\n         }\n      }\n   }\n\n   /**\n    * Handles updates to embedded stores parsing the render context for valid embedded store types.\n    *\n    * On create, delete, update parse the type being modified then force index updates for the embedded type.\n    *\n    * @param {string}   renderContext - render context update from document.\n    */\n   handleUpdate(renderContext)\n   {\n      if (!this.#embeddedNames.has(renderContext)) { return; }\n\n      const match = EmbeddedStoreManager.#renderContextRegex.exec(renderContext);\n\n      if (match)\n      {\n         const docOrCollectionName = match.groups.name;\n         const embeddedName = this.#collectionToDocName.get(docOrCollectionName);\n\n         if (!this.#name.has(embeddedName)) { return; }\n\n         for (const store of this.#name.get(embeddedName).stores.values())\n         {\n            store.index.update(true);\n         }\n      }\n   }\n}\n\n/**\n * @template T\n *\n * @typedef {object} EmbeddedCollectionData\n *\n * @property {foundry.abstract.Collection} collection -\n *\n * @property {Map<string, import('#runtime/svelte/store/reducer').DynMapReducer<string, T>>} stores -\n */\n\n/**\n * @template [T=globalThis.foundry.abstract.Document]\n *\n * Provides a wrapper implementing the Svelte store / subscriber protocol around any Document / ClientMixinDocument.\n * This makes documents reactive in a Svelte component, but otherwise provides subscriber functionality external to\n * Svelte.\n */\nclass TJSDocument\n{\n   /**\n    * @type {T[]}\n    */\n   #document = [void 0];\n\n   /**\n    * @type {EmbeddedStoreManager}\n    */\n   #embeddedStoreManager;\n\n   /**\n    * @type {import('./types').EmbeddedAPI}\n    */\n   #embeddedAPI;\n\n   /**\n    * @type {string}\n    */\n   #uuidv4;\n\n   /**\n    * @type {TJSDocumentOptions}\n    */\n   #options = { delete: void 0, preDelete: void 0 };\n\n   /**\n    * @type {((value: T, updateOptions?: TJSDocumentUpdateOptions) => void)[]}\n    */\n   #subscriptions = [];\n\n   /**\n    * @type {TJSDocumentUpdateOptions}\n    */\n   #updateOptions;\n\n   /**\n    * @param {T | TJSDocumentOptions}  [document] - Document to wrap or TJSDocumentOptions.\n    *\n    * @param {TJSDocumentOptions}      [options] - TJSDocument options.\n    */\n   constructor(document, options = {})\n   {\n      this.#uuidv4 = `tjs-document-${Hashing.uuidv4()}`;\n\n      if (isPlainObject(document)) // Handle case when only options are passed into ctor.\n      {\n         this.setOptions(document);\n      }\n      else\n      {\n         this.setOptions(options);\n         this.set(document);\n      }\n   }\n\n   /**\n    * @returns {import('./types').EmbeddedAPI} Embedded store manager.\n    */\n   get embedded()\n   {\n      if (!this.#embeddedAPI)\n      {\n         this.#embeddedStoreManager = new EmbeddedStoreManager(this.#document);\n\n         /** @type {import('./types').EmbeddedAPI} */\n         this.#embeddedAPI = {\n            create: (doc, options) => this.#embeddedStoreManager.create(doc, options),\n            destroy: (doc, storeName) => this.#embeddedStoreManager.destroy(doc, storeName),\n            get: (doc, storeName) => this.#embeddedStoreManager.get(doc, storeName)\n         };\n      }\n\n      return this.#embeddedAPI;\n   }\n\n   /**\n    * Returns the options passed on last update.\n    *\n    * @returns {TJSDocumentUpdateOptions} Last update options.\n    */\n   get updateOptions() { return this.#updateOptions ?? {}; }\n\n   /**\n    * Returns the UUID assigned to this store.\n    *\n    * @returns {string} UUID\n    */\n   get uuidv4() { return this.#uuidv4; }\n\n   /**\n    * Handles cleanup when the document is deleted. Invoking any optional delete function set in the constructor.\n    *\n    * @returns {Promise<void>}\n    */\n   async #deleted()\n   {\n      const doc = this.#document[0];\n\n      // Check to see if the document is still in the associated collection to determine if actually deleted.\n      if (doc instanceof globalThis.foundry.abstract.Document && !doc?.collection?.has(doc.id))\n      {\n         delete doc?.apps[this.#uuidv4];\n         this.#setDocument(void 0);\n\n         if (typeof this.#options.preDelete === 'function')\n         {\n            await this.#options.preDelete(doc);\n         }\n\n         this.#updateSubscribers(false, { action: 'delete', data: void 0 });\n\n         if (typeof this.#options.delete === 'function')\n         {\n            await this.#options.delete(doc);\n         }\n\n         this.#updateOptions = void 0;\n      }\n   }\n\n   /**\n    * Completely removes all internal subscribers, any optional delete callback, and unregisters from the\n    * ClientDocumentMixin `apps` tracking object.\n    */\n   destroy()\n   {\n      const doc = this.#document[0];\n\n      if (this.#embeddedStoreManager)\n      {\n         this.#embeddedStoreManager.destroy();\n         this.#embeddedStoreManager = void 0;\n         this.#embeddedAPI = void 0;\n      }\n\n      if (doc instanceof globalThis.foundry.abstract.Document)\n      {\n         delete doc?.apps[this.#uuidv4];\n         this.#setDocument(void 0);\n      }\n\n      this.#options.delete = void 0;\n      this.#subscriptions.length = 0;\n   }\n\n   /**\n    * @param {boolean}  [force] - unused - signature from Foundry render function.\n    *\n    * @param {object}   [options] - Options from render call; will have document update context.\n    */\n   #updateSubscribers(force = false, options = {}) // eslint-disable-line no-unused-vars\n   {\n      this.#updateOptions = options;\n\n      const doc = this.#document[0];\n\n      for (let cntr = 0; cntr < this.#subscriptions.length; cntr++) { this.#subscriptions[cntr](doc, options); }\n\n      if (this.#embeddedStoreManager)\n      {\n         this.#embeddedStoreManager.handleUpdate(options.renderContext);\n      }\n   }\n\n   /**\n    * @returns {T} Current document\n    */\n   get() { return this.#document[0]; }\n\n   /**\n    * Attempts to create a Foundry UUID from standard drop data. This may not work for all systems.\n    *\n    * @param {object}   data - Drop transfer data.\n    *\n    * @param {object}   [opts] - Optional parameters.\n    *\n    * @param {boolean}  [opts.actor=true] - Accept actor owned documents.\n    *\n    * @param {boolean}  [opts.compendium=true] - Accept compendium documents.\n    *\n    * @param {boolean}  [opts.world=true] - Accept world documents.\n    *\n    * @param {string[]|undefined}   [opts.types] - Require the `data.type` to match entry in `types`.\n    *\n    * @returns {string|undefined} Foundry UUID for drop data.\n    */\n   static getUUIDFromDataTransfer(data, { actor = true, compendium = true, world = true, types = void 0 } = {})\n   {\n      if (!isObject(data)) { return void 0; }\n      if (Array.isArray(types) && !types.includes(data.type)) { return void 0; }\n\n      let uuid = void 0;\n\n      if (typeof data.uuid === 'string') // v10 and above provides a full UUID.\n      {\n         const isCompendium = data.uuid.startsWith('Compendium');\n\n         if (isCompendium && compendium)\n         {\n            uuid = data.uuid;\n         }\n         else if (world)\n         {\n            uuid = data.uuid;\n         }\n      }\n      else // v9 and below parsing.\n      {\n         if (actor && world && data.actorId && data.type)\n         {\n            uuid = `Actor.${data.actorId}.${data.type}.${data.data._id}`;\n         }\n         else if (typeof data.id === 'string') // v9 and below uses `id`\n         {\n            if (compendium && typeof data.pack === 'string')\n            {\n               uuid = `Compendium.${data.pack}.${data.id}`;\n            }\n            else if (world)\n            {\n               uuid = `${data.type}.${data.id}`;\n            }\n         }\n      }\n\n      return uuid;\n   }\n\n\n   /**\n    * @param {T | undefined}  document - New document to set.\n    *\n    * @param {TJSDocumentUpdateOptions}   [options] - New document update options to set.\n    */\n   set(document, options = {})\n   {\n      if (this.#document[0])\n      {\n         delete this.#document[0].apps[this.#uuidv4];\n      }\n\n      if (document !== void 0 && !(document instanceof globalThis.foundry.abstract.Document))\n      {\n         throw new TypeError(`TJSDocument set error: 'document' is not a valid Document or undefined.`);\n      }\n\n      if (!isObject(options))\n      {\n         throw new TypeError(`TJSDocument set error: 'options' is not an object.`);\n      }\n\n      if (document instanceof globalThis.foundry.abstract.Document)\n      {\n         document.apps[this.#uuidv4] = {\n            close: this.#deleted.bind(this),\n            render: this.#updateSubscribers.bind(this)\n         };\n      }\n\n      this.#setDocument(document);\n      this.#updateOptions = options;\n      this.#updateSubscribers();\n   }\n\n   /**\n    *\n    * @param {T | undefined} doc -\n    */\n   #setDocument(doc)\n   {\n      this.#document[0] = doc;\n\n      if (this.#embeddedStoreManager) { this.#embeddedStoreManager.handleDocChange(); }\n   }\n\n   /**\n    * Potentially sets new document from data transfer object.\n    *\n    * @param {object}   data - Document transfer data.\n    *\n    * @param {{ actor?: boolean, compendium?: boolean, world?: boolean, types?: string[] } & TJSDocumentOptions}   [options] - Optional\n    *        parameters.\n    *\n    * @returns {Promise<boolean>} Returns true if new document set from data transfer blob.\n    */\n   async setFromDataTransfer(data, options)\n   {\n      return this.setFromUUID(TJSDocument.getUUIDFromDataTransfer(data, options), options);\n   }\n\n   /**\n    * Sets the document by Foundry UUID performing a lookup and setting the document if found.\n    *\n    * @param {string}   uuid - A Foundry UUID to lookup.\n    *\n    * @param {TJSDocumentOptions}   [options] - New document update options to set.\n    *\n    * @returns {Promise<boolean>} True if successfully set document from UUID.\n    */\n   async setFromUUID(uuid, options = {})\n   {\n      if (typeof uuid !== 'string' || uuid.length === 0) { return false; }\n\n      try\n      {\n         const doc = await globalThis.fromUuid(uuid);\n\n         if (doc)\n         {\n            this.set(doc, options);\n            return true;\n         }\n      }\n      catch (err) { /**/ }\n\n      return false;\n   }\n\n   /**\n    * Sets options for this document wrapper / store.\n    *\n    * @param {TJSDocumentOptions}   options - Options for TJSDocument.\n    */\n   setOptions(options)\n   {\n      if (!isObject(options))\n      {\n         throw new TypeError(`TJSDocument error: 'options' is not a plain object.`);\n      }\n\n      // Verify valid values -------------\n\n      if (options.delete !== void 0 && typeof options.delete !== 'function')\n      {\n         throw new TypeError(`TJSDocument error: 'delete' attribute in options is not a function.`);\n      }\n\n      if (options.preDelete !== void 0 && typeof options.preDelete !== 'function')\n      {\n         throw new TypeError(`TJSDocument error: 'preDelete' attribute in options is not a function.`);\n      }\n\n      // Set any valid values -------------\n\n      if (options.delete === void 0 || typeof options.delete === 'function')\n      {\n         this.#options.delete = options.delete;\n      }\n\n      if (options.preDelete === void 0 || typeof options.preDelete === 'function')\n      {\n         this.#options.preDelete = options.preDelete;\n      }\n   }\n\n   /**\n    * @param {(value: T, updateOptions?: TJSDocumentUpdateOptions) => void} handler - Callback function that is\n    * invoked on update / changes.\n    *\n    * @returns {import('svelte/store').Unsubscriber} Unsubscribe function.\n    */\n   subscribe(handler)\n   {\n      this.#subscriptions.push(handler);           // Add handler to the array of subscribers.\n\n      const updateOptions = { action: 'subscribe', data: void 0 };\n\n      handler(this.#document[0], updateOptions);      // Call handler with current value and update options.\n\n      // Return unsubscribe function.\n      return () =>\n      {\n         const index = this.#subscriptions.findIndex((sub) => sub === handler);\n         if (index >= 0) { this.#subscriptions.splice(index, 1); }\n      };\n   }\n}\n\n/**\n * @typedef {object} TJSDocumentOptions\n *\n * @property {(doc: globalThis.foundry.abstract.Document) => void} [delete] Optional post delete function to invoke when\n * document is deleted _after_ subscribers have been notified.\n *\n * @property {(doc: globalThis.foundry.abstract.Document) => void} [preDelete] Optional pre delete function to invoke\n * when document is deleted _before_ subscribers are notified.\n */\n\n/**\n * @typedef TJSDocumentUpdateOptions Provides data regarding the latest document change.\n *\n * @property {string}   [action] The update action. Useful for filtering.\n *\n * @property {string}   [renderContext] The update action. Useful for filtering.\n *\n * @property {object[]|string[]} [data] Foundry data associated with document changes.\n */\n\n/**\n * Provides a wrapper implementing the Svelte store / subscriber protocol around any DocumentCollection. This makes\n * document collections reactive in a Svelte component, but otherwise provides subscriber functionality external to\n * Svelte.\n *\n * @template [T=DocumentCollection]\n */\nclass TJSDocumentCollection\n{\n   #collection;\n   #collectionCallback;\n   #uuid;\n\n   /**\n    * @type {TJSDocumentCollectionOptions}\n    */\n   #options = { delete: void 0, preDelete: void 0 };\n\n   /**\n    * @type {((value: T, updateOptions?: TJSDocumentCollectionUpdateOptions<T>) => void)[]}\n    */\n   #subscriptions = [];\n\n   /**\n    * @type {TJSDocumentCollectionUpdateOptions<T>}\n    */\n   #updateOptions;\n\n   /**\n    * @param {T | TJSDocumentCollectionOptions}   [collection] - Collection to wrap or TJSDocumentCollectionOptions.\n    *\n    * @param {TJSDocumentCollectionOptions}     [options] - TJSDocumentCollection options.\n    */\n   constructor(collection, options = {})\n   {\n      this.#uuid = `tjs-collection-${Hashing.uuidv4()}`;\n\n      if (isPlainObject(collection)) // Handle case when only options are passed into ctor.\n      {\n         this.setOptions(collection);\n      }\n      else\n      {\n         this.setOptions(options);\n         this.set(collection);\n      }\n   }\n\n   /**\n    * Returns the options passed on last update.\n    *\n    * @returns {TJSDocumentCollectionUpdateOptions<T>} Last update options.\n    */\n   get updateOptions() { return this.#updateOptions ?? {}; }\n\n   /**\n    * Returns the UUID assigned to this store.\n    *\n    * @returns {string} UUID\n    */\n   get uuid() { return this.#uuid; }\n\n   /**\n    * Handles cleanup when the collection is deleted. Invoking any optional delete function set in the constructor.\n    *\n    * @returns {Promise<void>}\n    */\n   async #deleted()\n   {\n      const collection = this.#collection;\n\n      if (collection instanceof DocumentCollection)\n      {\n         const index = collection?.apps?.findIndex((sub) => sub === this.#collectionCallback);\n         if (index >= 0) { collection?.apps?.splice(index, 1); }\n\n         this.#collection = void 0;\n      }\n\n      if (typeof this.#options.preDelete === 'function')\n      {\n         await this.#options.preDelete(collection);\n      }\n\n      this.#notify(false, { action: 'delete', documentType: collection.documentName, documents: [], data: [] });\n\n      if (typeof this.#options.delete === 'function')\n      {\n         await this.#options.delete(collection);\n      }\n\n      this.#updateOptions = void 0;\n   }\n\n   /**\n    * Completely removes all internal subscribers, any optional delete callback, and unregisters from the\n    * DocumentCollection `apps` tracking array.\n    */\n   destroy()\n   {\n      const collection = this.#collection;\n\n      if (collection instanceof DocumentCollection)\n      {\n         const index = collection?.apps?.findIndex((sub) => sub === this.#collectionCallback);\n         if (index >= 0) { collection?.apps?.splice(index, 1); }\n\n         this.#collection = void 0;\n      }\n\n      this.#options.delete = void 0;\n      this.#subscriptions.length = 0;\n   }\n\n   /**\n    * @param {boolean}  [force] - unused - signature from Foundry render function.\n    *\n    * @param {object}   [options] - Options from render call; will have collection update context.\n    */\n   #notify(force = false, options = {}) // eslint-disable-line no-unused-vars\n   {\n      this.#updateOptions = options;\n\n      // Subscriptions are stored locally as on the browser Babel is still used for private class fields / Babel\n      // support until 2023. IE not doing this will require several extra method calls otherwise.\n      const subscriptions = this.#subscriptions;\n      const collection = this.#collection;\n\n      for (let cntr = 0; cntr < subscriptions.length; cntr++) { subscriptions[cntr](collection, options); }\n   }\n\n   /**\n    * @returns {T} Current collection\n    */\n   get() { return this.#collection; }\n\n   /**\n    * @param {T | undefined}  collection - New collection to set.\n    *\n    * @param {object}         [options] - New collection update options to set.\n    */\n   set(collection, options = {})\n   {\n      if (this.#collection)\n      {\n         const index = this.#collection.apps.findIndex((sub) => sub === this.#collectionCallback);\n         if (index >= 0) { this.#collection.apps.splice(index, 1); }\n\n         this.#collectionCallback = void 0;\n      }\n\n      if (collection !== void 0 && !(collection instanceof DocumentCollection))\n      {\n         throw new TypeError(\n          `TJSDocumentCollection set error: 'collection' is not a valid DocumentCollection or undefined.`);\n      }\n\n      if (!isObject(options))\n      {\n         throw new TypeError(`TJSDocument set error: 'options' is not an object.`);\n      }\n\n      if (collection instanceof DocumentCollection)\n      {\n         this.#collectionCallback = {\n            close: this.#deleted.bind(this),\n            render: this.#notify.bind(this)\n         };\n\n         collection?.apps?.push(this.#collectionCallback);\n      }\n\n      this.#collection = collection;\n      this.#updateOptions = options;\n      this.#notify();\n   }\n\n   /**\n    * Sets options for this collection wrapper / store.\n    *\n    * @param {TJSDocumentCollectionOptions}   options - Options for TJSDocumentCollection.\n    */\n   setOptions(options)\n   {\n      if (!isObject(options))\n      {\n         throw new TypeError(`TJSDocumentCollection error: 'options' is not an object.`);\n      }\n\n      // Verify valid values -------------\n\n      if (options.delete !== void 0 && typeof options.delete !== 'function')\n      {\n         throw new TypeError(`TJSDocumentCollection error: 'delete' attribute in options is not a function.`);\n      }\n\n      if (options.preDelete !== void 0 && typeof options.preDelete !== 'function')\n      {\n         throw new TypeError(`TJSDocumentCollection error: 'preDelete' attribute in options is not a function.`);\n      }\n\n      // Set any valid values -------------\n\n      if (options.delete === void 0 || typeof options.delete === 'function')\n      {\n         this.#options.delete = options.delete;\n      }\n\n      if (options.preDelete === void 0 || typeof options.preDelete === 'function')\n      {\n         this.#options.preDelete = options.preDelete;\n      }\n   }\n\n   /**\n    * @param {(value: T, updateOptions?: TJSDocumentCollectionUpdateOptions<T>) => void} handler - Callback function\n    * that is invoked on update / changes.\n    *\n    * @returns {import('svelte/store').Unsubscriber} Unsubscribe function.\n    */\n   subscribe(handler)\n   {\n      this.#subscriptions.push(handler);              // Add handler to the array of subscribers.\n\n      const collection = this.#collection;\n\n      const documentType = collection?.documentName ?? void 0;\n\n      const updateOptions = { action: 'subscribe', documentType, documents: [], data: [] };\n\n      handler(collection, updateOptions);  // Call handler with current value and update options.\n\n      // Return unsubscribe function.\n      return () =>\n      {\n         const index = this.#subscriptions.findIndex((sub) => sub === handler);\n         if (index >= 0) { this.#subscriptions.splice(index, 1); }\n      };\n   }\n}\n\nexport { TJSDocument, TJSDocumentCollection };\n//# sourceMappingURL=index.js.map\n","import * as Helpers from \"../helpers/helpers.js\";\r\n\r\nexport default class BasePlugin {\r\n\r\n\tinvalidVersionError = \"\"\r\n\tminVersionError = \"\"\r\n\r\n\tconstructor(pluginName, minVersion, invalidVersion) {\r\n\t\tthis.pluginName = pluginName;\r\n\t\tthis.minVersion = minVersion;\r\n\t\tthis.invalidVersion = invalidVersion;\r\n\t\tthis.initialized = false;\r\n\t\tthis.initialize();\r\n\t}\r\n\r\n\tinitialize() {\r\n\r\n\t\tif (!game.modules.get(this.pluginName)?.active) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (game.modules.get(this.pluginName).version === this.invalidVersion) {\r\n\t\t\tif (this.invalidVersionError) {\r\n\t\t\t\tthrow Helpers.custom_error(this.invalidVersionError);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (foundry.utils.isNewerVersion(this.minVersion, game.modules.get(this.pluginName).version)) {\r\n\t\t\tif (this.minVersionError) {\r\n\t\t\t\tthrow Helpers.custom_error(this.minVersionError);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.registerHooks();\r\n\r\n\t\tthis.initialized = true;\r\n\r\n\t}\r\n\r\n\tregisterHooks() {\r\n\r\n\t}\r\n\r\n}\r\n","import * as Utilities from \"./utilities.js\";\r\nimport * as PileUtilities from \"./pile-utilities.js\";\r\nimport ItemPileSocket from \"../socket.js\";\r\nimport PrivateAPI from \"../API/private-api.js\";\r\nimport { SYSTEMS } from \"../systems.js\";\r\nimport CONSTANTS from \"../constants/constants.js\";\r\n\r\nexport default class Transaction {\r\n\r\n\tconstructor(document) {\r\n\t\tthis.document = document;\r\n\t\tthis.documentFlags = PileUtilities.getActorFlagData(this.document);\r\n\t\tthis.itemsToCreate = [];\r\n\t\tthis.itemUpdates = {};\r\n\t\tthis.itemsToUpdate = [];\r\n\t\tthis.itemsToDelete = [];\r\n\t\tthis.itemsToForceDelete = new Set();\r\n\t\tthis.itemsToNotDelete = new Set();\r\n\t\tthis.documentChanges = {};\r\n\t\tthis.attributeDeltas = new Map();\r\n\t\tthis.attributeTypeMap = new Map();\r\n\t\tthis.itemDeltas = new Map();\r\n\t\tthis.itemTypeMap = new Map();\r\n\t\tthis.itemFlagMap = new Map();\r\n\t\tthis.preCommitted = false;\r\n\t}\r\n\r\n\tasync appendItemChanges(items, {\r\n\t\tset = false, remove = false, type = \"item\", keepIfZero = false\r\n\t} = {}) {\r\n\r\n\t\tfor (let data of items) {\r\n\r\n\t\t\tlet item = data.item ?? data;\r\n\r\n\t\t\ttype = PileUtilities.isItemCurrency(item) ? \"currency\" : type;\r\n\r\n\t\t\tlet flags = data.flags ?? false;\r\n\t\t\tlet itemData = item instanceof Item ? item.toObject() : foundry.utils.deepClone(item);\r\n\t\t\tif (SYSTEMS.DATA.ITEM_TRANSFORMER && !remove) {\r\n\t\t\t\titemData = await SYSTEMS.DATA.ITEM_TRANSFORMER(itemData);\r\n\t\t\t}\r\n\t\t\tconst incomingQuantity = set\r\n\t\t\t\t? Math.abs(data.quantity ?? Utilities.getItemQuantity(itemData))\r\n\t\t\t\t: Math.abs(data.quantity ?? Utilities.getItemQuantity(itemData)) * (remove ? -1 : 1);\r\n\r\n\t\t\tlet itemId = itemData._id ?? itemData.id;\r\n\t\t\tlet documentHasItem = false;\r\n\t\t\tlet documentExistingItem = false;\r\n\t\t\tif (this.documentFlags.type === CONSTANTS.PILE_TYPES.VAULT && type !== \"currency\" && !remove) {\r\n\t\t\t\tconst documentExistingItems = Utilities.findSimilarItem(this.document.items, itemData, {\r\n\t\t\t\t\treturnOne: false\r\n\t\t\t\t});\r\n\t\t\t\tdocumentExistingItem = documentExistingItems.find(item => {\r\n\t\t\t\t\treturn PileUtilities.canItemStack(item, this.document) && (\r\n\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\tfoundry.utils.getProperty(itemData, CONSTANTS.FLAGS.ITEM + \".x\") === undefined\r\n\t\t\t\t\t\t\t&&\r\n\t\t\t\t\t\t\tfoundry.utils.getProperty(itemData, CONSTANTS.FLAGS.ITEM + \".y\") === undefined\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t||\r\n\t\t\t\t\t\tPileUtilities.areItemsColliding(item, itemData)\r\n\t\t\t\t\t)\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tdocumentHasItem = this.document.items.get(itemId);\r\n\t\t\t\tdocumentExistingItem = documentHasItem || Utilities.findSimilarItem(this.document.items, itemData);\r\n\t\t\t}\r\n\r\n\t\t\tconst canItemStack = PileUtilities.canItemStack(documentExistingItem || itemData, this.document);\r\n\r\n\t\t\tif (remove && (keepIfZero || type === \"currency\")) {\r\n\t\t\t\tthis.itemsToNotDelete.add(item.id);\r\n\t\t\t}\r\n\r\n\t\t\tif (flags) {\r\n\t\t\t\tthis.itemFlagMap.set(itemId, flags);\r\n\t\t\t}\r\n\r\n\t\t\tif (documentExistingItem) {\r\n\r\n\t\t\t\tconst itemQuantity = Utilities.getItemQuantity(documentExistingItem);\r\n\r\n\t\t\t\tif (itemQuantity > 1 || canItemStack) {\r\n\r\n\t\t\t\t\tconst newQuantity = itemQuantity + incomingQuantity;\r\n\r\n\t\t\t\t\tconst existingItemUpdate = remove\r\n\t\t\t\t\t\t? this.itemsToUpdate.find(item => item._id === itemId)\r\n\t\t\t\t\t\t: Utilities.findSimilarItem(this.itemsToUpdate, itemData);\r\n\r\n\t\t\t\t\tif (existingItemUpdate) {\r\n\t\t\t\t\t\tUtilities.setItemQuantity(existingItemUpdate, newQuantity);\r\n\t\t\t\t\t\tif (keepIfZero && type !== \"currency\") {\r\n\t\t\t\t\t\t\tfoundry.utils.setProperty(existingItemUpdate, CONSTANTS.FLAGS.ITEM + \".notForSale\", newQuantity === 0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst update = Utilities.setItemQuantity(documentExistingItem.toObject(), newQuantity);\r\n\t\t\t\t\t\tif (keepIfZero && type !== \"currency\") {\r\n\t\t\t\t\t\t\tfoundry.utils.setProperty(update, CONSTANTS.FLAGS.ITEM + \".notForSale\", newQuantity === 0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.itemTypeMap.set(documentExistingItem.id, type)\r\n\t\t\t\t\t\tthis.itemsToUpdate.push(update);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.itemDeltas.set(documentExistingItem.id, (this.itemDeltas.has(documentExistingItem.id) ? this.itemDeltas.get(documentExistingItem.id) : 0) + incomingQuantity);\r\n\r\n\t\t\t\t} else if (remove) {\r\n\r\n\t\t\t\t\tthis.itemsToForceDelete.add(documentExistingItem.id);\r\n\t\t\t\t\tthis.itemDeltas.set(documentExistingItem.id, (this.itemDeltas.has(documentExistingItem.id) ? this.itemDeltas.get(documentExistingItem.id) : 0) + incomingQuantity);\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif (!itemData._id) {\r\n\t\t\t\t\t\titemData._id = foundry.utils.randomID();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tUtilities.setItemQuantity(itemData, incomingQuantity);\r\n\t\t\t\t\tthis.itemsToCreate.push(itemData);\r\n\t\t\t\t\tthis.itemTypeMap.set(itemData._id, type)\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\t\t\t\tconst existingItemCreation = Utilities.findSimilarItem(this.itemsToCreate, itemData);\r\n\t\t\t\tif (existingItemCreation && canItemStack) {\r\n\t\t\t\t\tconst newQuantity = Utilities.getItemQuantity(existingItemCreation) + incomingQuantity;\r\n\t\t\t\t\tUtilities.setItemQuantity(existingItemCreation, newQuantity);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!itemData._id) {\r\n\t\t\t\t\t\titemData._id = foundry.utils.randomID();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tUtilities.setItemQuantity(itemData, incomingQuantity);\r\n\t\t\t\t\tthis.itemsToCreate.push(itemData);\r\n\t\t\t\t\tthis.itemTypeMap.set(itemData._id, type)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tasync appendDocumentChanges(attributes, {\r\n\t\tset = false, remove = false, type = \"attribute\", onlyDelta = false\r\n\t} = {}) {\r\n\t\tif (!Array.isArray(attributes)) {\r\n\t\t\tattributes = Object.entries(attributes).map(entry => ({ path: entry[0], quantity: entry[1] }));\r\n\t\t}\r\n\t\tthis.documentChanges = attributes.reduce((acc, attribute) => {\r\n\t\t\tconst incomingQuantity = Math.abs(attribute.quantity) * (remove ? -1 : 1);\r\n\t\t\tacc[attribute.path] = acc[attribute.path] ?? Number(foundry.utils.getProperty(this.document, attribute.path) ?? 0);\r\n\t\t\tif (set) {\r\n\t\t\t\tif (!onlyDelta) {\r\n\t\t\t\t\tacc[attribute.path] = incomingQuantity\r\n\t\t\t\t}\r\n\t\t\t\tthis.attributeDeltas.set(attribute.path, (this.attributeDeltas.has(attribute.path) ? this.attributeDeltas.get(attribute.path) : acc[attribute.path]) + incomingQuantity);\r\n\t\t\t} else {\r\n\t\t\t\tif (!onlyDelta) {\r\n\t\t\t\t\tacc[attribute.path] += incomingQuantity\r\n\t\t\t\t}\r\n\t\t\t\tthis.attributeDeltas.set(attribute.path, (this.attributeDeltas.has(attribute.path) ? this.attributeDeltas.get(attribute.path) : 0) + incomingQuantity);\r\n\t\t\t}\r\n\t\t\tthis.attributeTypeMap.set(attribute.path, type)\r\n\t\t\treturn acc;\r\n\t\t}, this.documentChanges);\r\n\t}\r\n\r\n\tasync appendEmbeddedChanges(item, attributes, {\r\n\t\tset = false, remove = false, type = \"attribute\", onlyDelta = false\r\n\t} = {}) {\r\n\r\n\t\tif (!Array.isArray(attributes)) {\r\n\t\t\tattributes = Object.entries(attributes).map(entry => ({ path: entry[0], quantity: entry[1] }));\r\n\t\t}\r\n\r\n\t\tthis.itemUpdates = attributes.reduce((acc, attribute) => {\r\n\t\t\tconst incomingQuantity = Math.abs(attribute.quantity) * (remove ? -1 : 1);\r\n\r\n\t\t\tacc[item.id] = {\r\n\t\t\t\t[attribute.path]: acc[item.id]?.[attribute.path] ?? Number(foundry.utils.getProperty(item, attribute.path) ?? 0)\r\n\t\t\t};\r\n\r\n\t\t\tif (set) {\r\n\t\t\t\tif (!onlyDelta) {\r\n\t\t\t\t\tacc[item.id][attribute.path] = incomingQuantity;\r\n\t\t\t\t}\r\n\t\t\t\tthis.attributeDeltas.set(attribute.path, this.attributeDeltas.has(attribute.path)\r\n\t\t\t\t\t? this.attributeDeltas.get(attribute.path)\r\n\t\t\t\t\t: foundry.utils.getProperty(acc[item.id], attribute.path) + incomingQuantity\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tif (!onlyDelta) {\r\n\t\t\t\t\tacc[item.id][attribute.path] = acc[item.id][attribute.path] + incomingQuantity;\r\n\t\t\t\t}\r\n\t\t\t\tthis.attributeDeltas.set(attribute.path, (this.attributeDeltas.has(attribute.path) ? this.attributeDeltas.get(attribute.path) : 0) + incomingQuantity);\r\n\t\t\t}\r\n\r\n\t\t\treturn acc;\r\n\t\t}, this.itemUpdates);\r\n\r\n\t}\r\n\r\n\tprepare() {\r\n\r\n\t\tthis.documentChanges = Object.fromEntries(Object.entries(this.documentChanges).filter(entry => {\r\n\t\t\tif (this.attributeDeltas.get(entry[0]) === 0) {\r\n\t\t\t\tthis.attributeDeltas.delete(entry[0]);\r\n\t\t\t}\r\n\t\t\treturn Number(foundry.utils.getProperty(this.document, entry[0])) !== entry[1];\r\n\t\t}))\r\n\r\n\t\tthis.itemsToCreate = this.itemsToCreate.filter(item => {\r\n\t\t\treturn !PileUtilities.canItemStack(item, this.document) || Utilities.getItemQuantity(item) > 0 || this.itemTypeMap.get(item._id) === \"currency\"\r\n\t\t}).map(item => {\r\n\t\t\tconst flagData = PileUtilities.getItemFlagData(item);\r\n\t\t\tUtilities.deleteProperty(item, CONSTANTS.FLAGS.ITEM);\r\n\t\t\tfoundry.utils.setProperty(item, CONSTANTS.FLAGS.ITEM, PileUtilities.cleanItemFlagData(flagData));\r\n\t\t\treturn item;\r\n\t\t});\r\n\r\n\t\tthis.itemsToCreate = Utilities.ensureValidIds(this.document, this.itemsToCreate);\r\n\r\n\t\tthis.itemsToDelete = this.itemsToUpdate.filter(item => {\r\n\t\t\treturn Utilities.getItemQuantity(item) <= 0 && this.itemTypeMap.get(item._id) !== \"currency\";\r\n\t\t}).map(item => item._id).concat(Array.from(this.itemsToForceDelete));\r\n\r\n\t\tfor (const itemId of this.itemsToDelete) {\r\n\t\t\tif (this.itemsToNotDelete.has(itemId)) {\r\n\t\t\t\tthis.itemsToDelete.splice(this.itemsToDelete.indexOf(itemId), 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.itemDeltas = Array.from(this.itemDeltas).map(([id, quantity]) => {\r\n\t\t\tconst item = this.document.items.get(id).toObject();\r\n\t\t\tconst existingFlagData = PileUtilities.getItemFlagData(item);\r\n\t\t\tconst newFlagData = this.itemFlagMap.get(id) ?? {};\r\n\t\t\tUtilities.deleteProperty(item, CONSTANTS.FLAGS.ITEM);\r\n\t\t\tfoundry.utils.setProperty(item, CONSTANTS.FLAGS.ITEM, foundry.utils.mergeObject(existingFlagData, PileUtilities.cleanItemFlagData(newFlagData)));\r\n\t\t\tconst type = this.itemTypeMap.get(id);\r\n\t\t\tUtilities.setItemQuantity(item, quantity, true);\r\n\t\t\treturn { item, quantity, type };\r\n\t\t}).filter(delta => delta.quantity);\r\n\r\n\t\tthis.itemsToUpdate = this.itemsToUpdate\r\n\t\t\t.filter(item => Utilities.getItemQuantity(item) > 0 || this.itemsToNotDelete.has(item._id) || this.itemTypeMap.get(item._id) === \"currency\")\r\n\t\t\t.filter(itemData => {\r\n\t\t\t\tconst item = this.document.items.get(itemData._id)\r\n\t\t\t\treturn Utilities.getItemQuantity(item) !== Utilities.getItemQuantity(itemData);\r\n\t\t\t});\r\n\r\n\t\tObject.entries(this.itemUpdates).forEach(([id, update]) => {\r\n\t\t\tupdate[\"_id\"] = id;\r\n\t\t\tconst existingUpdateIndex = this.itemsToUpdate.findIndex(existingUpdate => existingUpdate[\"_id\"] === update[\"_id\"]);\r\n\t\t\tif (existingUpdateIndex > -1) {\r\n\t\t\t\tthis.itemsToUpdate[existingUpdateIndex] = foundry.utils.mergeObject(this.itemsToUpdate[existingUpdateIndex], update);\r\n\t\t\t} else {\r\n\t\t\t\tthis.itemsToUpdate.push(update);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.attributeDeltas = Object.fromEntries(this.attributeDeltas);\r\n\t\tthis.preCommitted = true;\r\n\t\treturn {\r\n\t\t\tdocumentChanges: this.documentChanges,\r\n\t\t\titemsToCreate: this.itemsToCreate,\r\n\t\t\titemsToDelete: this.itemsToDelete,\r\n\t\t\titemsToUpdate: this.itemsToUpdate,\r\n\t\t\tattributeDeltas: this.attributeDeltas,\r\n\t\t\titemDeltas: this.itemDeltas\r\n\t\t}\r\n\t}\r\n\r\n\tasync commit() {\r\n\r\n\t\tif (!this.preCommitted) {\r\n\t\t\tthis.prepare();\r\n\t\t}\r\n\r\n\t\tlet itemsCreated;\r\n\t\tconst documentUuid = Utilities.getUuid(this.document);\r\n\t\tif (this.document.isOwner) {\r\n\t\t\titemsCreated = await PrivateAPI._commitDocumentChanges(documentUuid, {\r\n\t\t\t\tdocumentChanges: this.documentChanges,\r\n\t\t\t\titemsToUpdate: this.itemsToUpdate,\r\n\t\t\t\titemsToDelete: this.itemsToDelete,\r\n\t\t\t\titemsToCreate: this.itemsToCreate\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\titemsCreated = await ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.COMMIT_DOCUMENT_CHANGES, documentUuid, {\r\n\t\t\t\tdocumentChanges: this.documentChanges,\r\n\t\t\t\titemsToUpdate: this.itemsToUpdate,\r\n\t\t\t\titemsToDelete: this.itemsToDelete,\r\n\t\t\t\titemsToCreate: this.itemsToCreate\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tattributeDeltas: this.attributeDeltas, itemDeltas: this.itemDeltas.concat(itemsCreated.map(item => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\titem, quantity: PileUtilities.canItemStack(item) ? Utilities.getItemQuantity(item) : 1\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\t\t}\r\n\t}\r\n}\r\n","import BasePlugin from \"./base-plugin.js\";\r\nimport ItemPileStore from \"../stores/item-pile-store.js\";\r\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\r\nimport CONSTANTS from \"../constants/constants.js\";\r\nimport Transaction from \"../helpers/transaction.js\";\r\nimport { debug, isResponsibleGM } from \"../helpers/helpers.js\";\r\n\r\nlet previousState;\r\n\r\nexport default class SimpleCalendarPlugin extends BasePlugin {\r\n\r\n\tinvalidVersionError = \"Simple Calendar version 1.3.75 is installed, but Item Piles requires version 2.0.0 or above. The author made a mistake, and you will need to reinstall the Simple Calendar module.\";\r\n\tminVersionError = \"Simple Calendar is out of date to be compatible with Item Piles, please update as soon as possible.\";\r\n\r\n\tregisterHooks() {\r\n\t\tpreviousState = {\r\n\t\t\tdateTime: window.SimpleCalendar.api.currentDateTime(),\r\n\t\t\tweekday: window.SimpleCalendar.api.getCurrentWeekday(),\r\n\t\t\ttimestamp: window.SimpleCalendar.api.dateToTimestamp({})\r\n\t\t}\r\n\t\tpreviousState.time = Number(previousState.dateTime.hour.toString() + \".\" + previousState.dateTime.minute.toString());\r\n\r\n\t\tHooks.on(\"updateWorldTime\", async () => {\r\n\t\t\tItemPileStore.notifyAllOfChanges(\"updateOpenCloseStatus\");\r\n\t\t\tif (!isResponsibleGM()) return;\r\n\t\t\tthis.handleTimePassed();\r\n\t\t});\r\n\r\n\t\tconst debounceCollectAllMerchants = foundry.utils.debounce(() => {\r\n\t\t\tthis.collectAllMerchants();\r\n\t\t}, 1000);\r\n\r\n\t\tHooks.on(\"updateActor\", () => {\r\n\t\t\tdebounceCollectAllMerchants();\r\n\t\t})\r\n\r\n\t\tHooks.on(\"updateToken\", () => {\r\n\t\t\tdebounceCollectAllMerchants();\r\n\t\t})\r\n\r\n\t\tthis.collectAllMerchants();\r\n\r\n\t}\r\n\r\n\tcollectAllMerchants() {\r\n\t\tthis.actors = PileUtilities.getItemPileActors((actor) => {\r\n\t\t\treturn PileUtilities.isItemPileMerchant(actor);\r\n\t\t});\r\n\r\n\t\tconst { validTokensOnScenes } = PileUtilities.getItemPileTokens((token) => {\r\n\t\t\treturn PileUtilities.isItemPileMerchant(token);\r\n\t\t});\r\n\t\tthis.validTokensOnScenes = validTokensOnScenes;\r\n\t}\r\n\r\n\thandleTimePassed() {\r\n\r\n\t\tconst newState = {\r\n\t\t\tdateTime: window.SimpleCalendar.api.currentDateTime(),\r\n\t\t\tweekday: window.SimpleCalendar.api.getCurrentWeekday(),\r\n\t\t\ttimestamp: window.SimpleCalendar.api.dateToTimestamp({})\r\n\t\t}\r\n\t\tnewState.time = Number(newState.dateTime.hour.toString() + \".\" + newState.dateTime.minute.toString());\r\n\r\n\t\tconst prevMinute = Math.floor(previousState.timestamp / 60);\r\n\t\tconst newMinute = Math.floor(newState.timestamp / 60);\r\n\t\tif (prevMinute === newMinute) {\r\n\t\t\tpreviousState = newState;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tdebug(\"Running handleTimePassed\");\r\n\r\n\t\tconst currentCalendar = window.SimpleCalendar.api.getCurrentCalendar();\r\n\t\tconst numWeekdays = currentCalendar.weekdays.length;\r\n\r\n\t\tconst notes = window.SimpleCalendar.api.getNotes()\r\n\t\t\t.filter(note => foundry.utils.getProperty(note, \"flags.foundryvtt-simple-calendar.noteData.categories\")?.length)\r\n\t\t\t.map(note => {\r\n\t\t\t\tconst flags = foundry.utils.getProperty(note, \"flags.foundryvtt-simple-calendar.noteData\");\r\n\t\t\t\tlet timestampData = {\r\n\t\t\t\t\tyear: flags.startDate.year,\r\n\t\t\t\t\tmonth: flags.startDate.month,\r\n\t\t\t\t\tday: flags.startDate.day,\r\n\t\t\t\t\thour: flags.allDay ? 0 : flags.startDate.hour,\r\n\t\t\t\t\tminute: flags.allDay ? 0 : flags.startDate.minute,\r\n\t\t\t\t\tseconds: flags.allDay ? 0 : flags.startDate.seconds,\r\n\t\t\t\t};\r\n\t\t\t\tswitch (flags?.repeats) {\r\n\t\t\t\t\tcase window.SimpleCalendar.api.NoteRepeat.Weekly:\r\n\t\t\t\t\t\tconst noteWeekDay = window.SimpleCalendar.api.timestampToDate(window.SimpleCalendar.api.dateToTimestamp(timestampData)).dayOfTheWeek - 1;\r\n\t\t\t\t\t\tconst currentWeekDay = window.SimpleCalendar.api.timestampToDate(newState.timestamp).dayOfTheWeek - 1;\r\n\t\t\t\t\t\tlet weekdayCountDifference = currentWeekDay - noteWeekDay;\r\n\t\t\t\t\t\tif (weekdayCountDifference < 0) {\r\n\t\t\t\t\t\t\tweekdayCountDifference += numWeekdays\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttimestampData.year = newState.dateTime.year;\r\n\t\t\t\t\t\ttimestampData.month = newState.dateTime.month;\r\n\t\t\t\t\t\ttimestampData.day = newState.dateTime.day;\r\n\t\t\t\t\t\tconst weekInSeconds = SimpleCalendar.api.timestampPlusInterval(0, { day: 1 }) * weekdayCountDifference;\r\n\t\t\t\t\t\tconst timestamp = window.SimpleCalendar.api.dateToTimestamp(timestampData) - weekInSeconds;\r\n\t\t\t\t\t\ttimestampData.day = window.SimpleCalendar.api.timestampToDate(timestamp).day;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase window.SimpleCalendar.api.NoteRepeat.Monthly:\r\n\t\t\t\t\t\ttimestampData.year = newState.dateTime.year;\r\n\t\t\t\t\t\ttimestampData.month = newState.dateTime.month;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase window.SimpleCalendar.api.NoteRepeat.Yearly:\r\n\t\t\t\t\t\ttimestampData.year = newState.dateTime.year;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\treturn {\r\n\t\t\t\t\tdocument: note,\r\n\t\t\t\t\tflags,\r\n\t\t\t\t\tdateTime: timestampData,\r\n\t\t\t\t\ttimestamp: window.SimpleCalendar.api.dateToTimestamp(timestampData)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.filter(note => {\r\n\t\t\t\treturn note.timestamp > previousState.timestamp && note.timestamp <= newState.timestamp;\r\n\t\t\t});\r\n\r\n\t\tconst categories = new Set(notes.map(note => note.flags?.categories ?? []).deepFlatten());\r\n\r\n\t\tthis.hideMerchantTokens();\r\n\t\tthis.refreshMerchantInventories(newState, previousState, categories, notes);\r\n\r\n\t\tpreviousState = newState;\r\n\r\n\t}\r\n\r\n\tasync hideMerchantTokens() {\r\n\r\n\t\tconst actors = this.actors.filter((actor) => {\r\n\t\t\tconst pileData = PileUtilities.getActorFlagData(actor);\r\n\t\t\treturn pileData.hideTokenWhenClosed;\r\n\t\t});\r\n\r\n\t\tconst validTokensOnScenes = actors.map(actor => actor.getActiveTokens())\r\n\t\t\t.deepFlatten()\r\n\t\t\t.reduce((acc, token) => {\r\n\t\t\t\tconst tokenDocument = token.document;\r\n\t\t\t\tconst sceneId = tokenDocument.parent.id;\r\n\t\t\t\tif (!acc[sceneId]) acc[sceneId] = [];\r\n\t\t\t\tacc[sceneId].push(tokenDocument);\r\n\t\t\t\treturn acc;\r\n\t\t\t}, {});\r\n\r\n\t\tthis.validTokensOnScenes.filter((token) => {\r\n\t\t\tconst pileData = PileUtilities.getActorFlagData(token);\r\n\t\t\treturn pileData.hideTokenWhenClosed;\r\n\t\t}).forEach(([sceneId, token]) => {\r\n\t\t\tif (validTokensOnScenes[sceneId].length) {\r\n\t\t\t\tif (!validTokensOnScenes[sceneId].find(t => t === token)) return;\r\n\t\t\t\tvalidTokensOnScenes[sceneId].push(token)\r\n\t\t\t} else {\r\n\t\t\t\tvalidTokensOnScenes[sceneId] = [token]\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tfor (const [sceneId, tokens] of Object.entries(validTokensOnScenes)) {\r\n\t\t\tconst scene = game.scenes.get(sceneId);\r\n\t\t\tconst updates = Object.values(tokens.reduce((acc, token) => {\r\n\t\t\t\tif (!acc[token.id]) {\r\n\t\t\t\t\tacc[token.id] = {\r\n\t\t\t\t\t\t_id: token.id,\r\n\t\t\t\t\t\thidden: PileUtilities.isMerchantClosed(token)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn acc;\r\n\t\t\t}, {}));\r\n\t\t\tif (updates.length) {\r\n\t\t\t\tdebug(`Hid ${updates.length} merchant tokens on ${scene.name}`);\r\n\t\t\t\tawait scene.updateEmbeddedDocuments(\"Token\", updates, { animate: false });\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tasync refreshMerchantInventories(newState, previousState, categories, notes) {\r\n\r\n\t\tconst actors = this.actors.filter((actor) => {\r\n\t\t\tconst flags = PileUtilities.getActorFlagData(actor);\r\n\t\t\treturn merchantRefreshFilter(flags, newState, previousState, categories);\r\n\t\t});\r\n\r\n\t\tconst validTokensOnScenes = this.validTokensOnScenes.map(([scene, tokens]) => {\r\n\t\t\treturn [scene, tokens.filter(token => {\r\n\t\t\t\tconst flags = PileUtilities.getActorFlagData(token);\r\n\t\t\t\treturn merchantRefreshFilter(flags, newState, previousState, categories);\r\n\t\t\t})]\r\n\t\t}).filter(([_, tokens]) => tokens.length);\r\n\r\n\t\tif (actors.length) debug(`Refreshing ${actors.length} merchant inventories`);\r\n\t\tfor (const actor of actors) {\r\n\t\t\tawait this.refreshActorItems(actor, notes);\r\n\t\t}\r\n\r\n\t\tfor (const [sceneId, tokens] of validTokensOnScenes) {\r\n\t\t\tconst scene = game.scenes.get(sceneId);\r\n\t\t\tif (tokens.length) debug(`Refreshing ${tokens.length} merchant inventories on scene ${scene.name}`);\r\n\t\t\tfor (const token of tokens) {\r\n\t\t\t\tawait this.refreshActorItems(token.actor, notes);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tasync refreshActorItems(actor, notes) {\r\n\r\n\t\tconst actorTransaction = new Transaction(actor);\r\n\r\n\t\tconst actorItems = game.itempiles.API.getActorItems(actor);\r\n\t\tconst newActorItems = await PileUtilities.rollMerchantTables({ actor });\r\n\r\n\t\tawait actorTransaction.appendItemChanges(actorItems.filter(item => {\r\n\t\t\tconst itemFlags = PileUtilities.getItemFlagData(item);\r\n\t\t\treturn !itemFlags.keepOnMerchant && !itemFlags.keepIfZero;\r\n\t\t}), { remove: true });\r\n\r\n\t\tawait actorTransaction.appendItemChanges(actorItems.filter(item => {\r\n\t\t\tconst itemFlags = PileUtilities.getItemFlagData(item);\r\n\t\t\treturn !itemFlags.keepOnMerchant && itemFlags.keepIfZero;\r\n\t\t}), { remove: true, keepIfZero: true });\r\n\r\n\t\tawait actorTransaction.appendItemChanges(newActorItems.map(entry => ({\r\n\t\t\titem: entry.item, quantity: entry.quantity, flags: entry.flags\r\n\t\t})));\r\n\r\n\t\tconst commit = actorTransaction.prepare();\r\n\r\n\t\tconst result = Hooks.call(CONSTANTS.HOOKS.PILE.PRE_REFRESH_INVENTORY, actor, commit, notes)\r\n\t\tif (result === false) return;\r\n\r\n\t\tawait actorTransaction.commit();\r\n\r\n\t}\r\n}\r\n\r\nfunction merchantRefreshFilter(flags, newState, previousState, categories) {\r\n\r\n\tconst openTimesEnabled = flags.openTimes.enabled;\r\n\tconst openTimes = flags.openTimes.open;\r\n\tconst closeTimes = flags.openTimes.close;\r\n\r\n\tconst openHour = openTimesEnabled ? openTimes.hour : 0;\r\n\tconst openMinute = openTimesEnabled ? openTimes.minute : 0;\r\n\tconst closeHour = openTimesEnabled ? closeTimes.hour : 0;\r\n\tconst closeMinute = openTimesEnabled ? closeTimes.minute : 0;\r\n\r\n\tconst openingTime = Number(openHour.toString() + \".\" + openMinute.toString());\r\n\tconst closingTime = Number(closeHour.toString() + \".\" + closeMinute.toString());\r\n\r\n\tconst wasOpen = openingTime > closingTime\r\n\t\t? (previousState.time >= openingTime || previousState.time <= closingTime)\r\n\t\t: (previousState.time >= openingTime && previousState.time <= closingTime);\r\n\r\n\tconst isOpen = openingTime > closingTime\r\n\t\t? (newState.time >= openingTime || newState.time <= closingTime)\r\n\t\t: (newState.time >= openingTime && newState.time <= closingTime);\r\n\r\n\tconst dayLength = SimpleCalendar.api.timestampPlusInterval(0, { day: 1 });\r\n\tconst daysPassed = Math.floor((newState.timestamp - previousState.timestamp) / dayLength);\r\n\r\n\tconst allWeekdays = new Set(window.SimpleCalendar.api.getAllWeekdays());\r\n\r\n\tconst shouldRefreshOnCurrentWeekday = flags.refreshItemsDays.includes(newState.weekday);\r\n\tconst shouldRefreshPastWeekday = flags.refreshItemsDays.length > 0 && daysPassed >= allWeekdays.size;\r\n\r\n\treturn (flags.refreshItemsOnOpen && !wasOpen && isOpen && openTimesEnabled)\r\n\t\t|| shouldRefreshPastWeekday\r\n\t\t|| shouldRefreshOnCurrentWeekday\r\n\t\t|| categories.intersection(new Set(flags.refreshItemsHolidays)).size > 0;\r\n\r\n}\r\n","import BasePlugin from \"./base-plugin.js\";\r\nimport PrivateAPI from \"../API/private-api.js\";\r\n\r\nexport default class Levels3dPreview extends BasePlugin {\r\n\r\n\tregisterHooks() {\r\n\r\n\t\tHooks.on(\"3DCanvasConfig\", (config) => {\r\n\t\t\tconfig.INTERACTIONS.dropFunctions.Item = async function (event, data) {\r\n\t\t\t\tcanvas.tokens.activate();\r\n\t\t\t\treturn PrivateAPI._dropData(canvas, data);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n}\r\n","import BasePlugin from \"./base-plugin.js\";\r\n\r\nexport default class RarityColors extends BasePlugin {\r\n\r\n\tminVersionError = \"Rarity Colors is out of date to be compatible with Item Piles, please update to 0.3.6 soon as possible.\";\r\n\r\n\tgetItemColor(item) {\r\n\r\n\t\tif (game.system.id !== \"dnd5e\") return false;\r\n\r\n\t\tif (!game.modules.get(this.pluginName)?.api?.getColorFromItem) return false;\r\n\r\n\t\ttry {\r\n\t\t\treturn game.modules.get(this.pluginName)?.api?.getColorFromItem(item);\r\n\t\t} catch (err) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n","import SimpleCalendarPlugin from \"./simple-calendar.js\";\r\nimport Levels3dPreview from \"./levels-3d-preview.js\";\r\nimport RarityColors from \"./rarity-colors.js\";\r\n\r\nexport const Plugins = {\r\n\t\"foundryvtt-simple-calendar\": {\r\n\t\ton: \"ready\",\r\n\t\tdata: null,\r\n\t\tclass: SimpleCalendarPlugin,\r\n\t\tminVersion: \"2.0.0\",\r\n\t\tinvalidVersion: \"v1.3.75\"\r\n\t},\r\n\t\"levels-3d-preview\": {\r\n\t\ton: \"init\",\r\n\t\tdata: null,\r\n\t\tclass: Levels3dPreview,\r\n\t\tminVersion: \"4.9.6\"\r\n\t},\r\n\t\"rarity-colors\": {\r\n\t\ton: \"init\",\r\n\t\tdata: null,\r\n\t\tclass: RarityColors,\r\n\t\tminVersion: \"0.3.6\"\r\n\t}\r\n}\r\n\r\nexport function setupPlugins(hook) {\r\n\tfor (const [plugin, pluginData] of Object.entries(Plugins).filter(e => e[1].on === hook)) {\r\n\t\tif (!game.modules.get(plugin)?.active) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tpluginData.data = new pluginData.class(plugin, pluginData.minVersion, pluginData?.invalidVersion);\r\n\t}\r\n}\r\n","import SETTINGS from \"../constants/settings.js\";\r\nimport { getSetting } from \"./helpers.js\";\r\n\r\nconst PACK_ID = `world.item-piles-item-backup-do-not-delete`;\r\n\r\nconst COMPENDIUM_CACHE = {};\r\n\r\nexport async function initializeCompendiumCache() {\r\n\r\n\tHooks.on(\"updateItem\", async (item) => {\r\n\t\tif (!item?.pack || !item?.pack.startsWith(PACK_ID)) return;\r\n\t\tCOMPENDIUM_CACHE[item.uuid] = item.toObject();\r\n\t});\r\n\r\n\tconst pack = game.packs.get(PACK_ID);\r\n\tif (pack) {\r\n\t\tfor (const index of pack.index) {\r\n\t\t\tconst item = await pack.getDocument(index._id);\r\n\t\t\tCOMPENDIUM_CACHE[item.uuid] = item.toObject();\r\n\t\t}\r\n\t}\r\n\r\n\tsetTimeout(async () => {\r\n\t\tawait updateCache();\r\n\t\tHooks.on(\"updateCompendium\", updateCache);\r\n\t}, 250);\r\n\r\n}\r\n\r\nasync function updateCache() {\r\n\tconst currencies = getSetting(SETTINGS.CURRENCIES);\r\n\tconst secondaryCurrencies = getSetting(SETTINGS.SECONDARY_CURRENCIES);\r\n\tfor (const currency of currencies.concat(secondaryCurrencies)) {\r\n\t\tif (currency.type !== \"item\") continue;\r\n\t\tif (currency.data.uuid) {\r\n\t\t\tCOMPENDIUM_CACHE[currency.data?.uuid] = (await fromUuid(currency.data.uuid)).toObject();\r\n\t\t} else if (currency.data.item) {\r\n\t\t\tconst item = await findOrCreateItemInCompendium(currency.data.item)\r\n\t\t\tCOMPENDIUM_CACHE[item.uuid] = item.toObject();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport async function getItemCompendium() {\r\n\treturn game.packs.get(PACK_ID) || await CompendiumCollection.createCompendium({\r\n\t\tlabel: `Item Piles: Item Backup (DO NOT DELETE)`,\r\n\t\tid: PACK_ID,\r\n\t\tprivate: true,\r\n\t\ttype: \"Item\"\r\n\t});\r\n}\r\n\r\nexport async function addItemsToCompendium(items) {\r\n\treturn Item.createDocuments(items, { pack: PACK_ID });\r\n}\r\n\r\nexport async function findSimilarItemInCompendium(itemToFind) {\r\n\tconst pack = await getItemCompendium();\r\n\tconst item = game.packs.get(PACK_ID).index.find(compendiumItem => {\r\n\t\treturn compendiumItem.name === itemToFind.name\r\n\t\t\t&& compendiumItem.type === itemToFind.type;\r\n\t});\r\n\treturn (item?._id ? pack.getDocument(item._id) : false);\r\n}\r\n\r\nexport function getItemFromCache(uuid) {\r\n\treturn COMPENDIUM_CACHE[uuid] ?? false;\r\n}\r\n\r\nexport async function findOrCreateItemInCompendium(itemData) {\r\n\tlet compendiumItem = await findSimilarItemInCompendium(itemData);\r\n\tif (!compendiumItem) {\r\n\t\tcompendiumItem = (await addItemsToCompendium([itemData]))[0];\r\n\t}\r\n\tCOMPENDIUM_CACHE[compendiumItem.uuid] = itemData;\r\n\treturn compendiumItem;\r\n}\r\n\r\nexport function findSimilarItemInCompendiumSync(itemToFind) {\r\n\treturn Object.values(COMPENDIUM_CACHE).find(compendiumItem => {\r\n\t\treturn compendiumItem.name === itemToFind.name\r\n\t\t\t&& compendiumItem.type === itemToFind.type;\r\n\t}) ?? false;\r\n}\r\n","import { get, writable } from \"svelte/store\";\nimport * as Utilities from \"../helpers/utilities.js\";\nimport { TJSDocument } from \"#runtime/svelte/store/fvtt/document\";\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\nimport * as SharingUtilities from \"../helpers/sharing-utilities.js\";\nimport CONSTANTS from \"../constants/constants.js\";\nimport { Plugins } from \"../plugins/main.js\";\nimport { SYSTEMS } from \"../systems.js\";\nimport * as CompendiumUtilities from \"../helpers/compendium-utilities.js\";\n\nclass PileBaseItem {\n\n\tconstructor(store, data, isCurrency = false, isSecondaryCurrency = false, parent = false) {\n\t\tthis.store = store;\n\t\tthis.parent = parent?.item || store.actor;\n\t\tthis.parentDoc = parent?.itemDocument || store.document;\n\t\tthis.subscriptions = [];\n\t\tthis.isCurrency = isCurrency;\n\t\tthis.isSecondaryCurrency = isSecondaryCurrency;\n\t\tthis.setup(data);\n\t}\n\n\tsetupStores() {\n\t\tthis.category = writable({ service: false, type: \"\", label: \"\" });\n\t\tthis.quantity = writable(1);\n\t\tthis.currentQuantity = writable(1);\n\t\tthis.quantityLeft = writable(1);\n\t\tthis.filtered = writable(true);\n\t\tthis.presentFromTheStart = writable(false);\n\t\tthis.rarityColor = writable(false);\n\t\tthis.containerID = writable(\"\");\n\t\tthis.subItems = writable([]);\n\t}\n\n\tsetupSubscriptions() {\n\t\t// Higher order implementation\n\t}\n\n\tsetup(data) {\n\t\tthis.unsubscribe();\n\t\tthis.setupStores(data);\n\t\tthis.setupSubscriptions(data);\n\t}\n\n\tsubscribeTo(target, callback) {\n\t\tthis.subscriptions.push(target.subscribe(callback));\n\t}\n\n\tunsubscribe() {\n\t\tthis.subscriptions.forEach(unsubscribe => unsubscribe());\n\t\tthis.subscriptions = [];\n\t}\n\n\tpreview() {\n\t}\n}\n\nexport class PileItem extends PileBaseItem {\n\n\tsetupStores(item) {\n\t\tsuper.setupStores();\n\t\tthis.item = item;\n\t\tthis.itemDocument = new TJSDocument(this.item);\n\t\tthis.canStack = PileUtilities.canItemStack(this.item, this.actor);\n\t\tthis.presentFromTheStart.set(Utilities.getItemQuantity(this.item) > 0 || !this.canStack);\n\t\tthis.quantity.set(this.canStack ? Utilities.getItemQuantity(this.item) : 1);\n\t\tthis.currentQuantity.set(Math.min(get(this.currentQuantity), get(this.quantityLeft), get(this.quantity)));\n\t\tthis.id = this.item.id;\n\t\tthis.type = this.item.type;\n\t\tconst itemData = CompendiumUtilities.findSimilarItemInCompendiumSync(this.item);\n\t\tthis.name = writable(itemData?.name ?? this.item.name);\n\t\tthis.img = writable(itemData?.img ?? this.item.img);\n\t\tthis.abbreviation = writable(\"\");\n\t\tthis.identifier = foundry.utils.randomID();\n\t\tthis.itemFlagData = writable(PileUtilities.getItemFlagData(this.item));\n\t}\n\n\tsetupSubscriptions() {\n\t\tsuper.setupSubscriptions()\n\n\t\tthis.subscribeTo(this.store.pileData, () => {\n\t\t\tthis.setupProperties();\n\t\t});\n\t\tthis.subscribeTo(this.store.pileCurrencies, () => {\n\t\t\tthis.setupProperties();\n\t\t});\n\n\t\tthis.subscribeTo(this.store.shareData, () => {\n\t\t\tif (!this.toShare) {\n\t\t\t\tthis.quantityLeft.set(get(this.quantity));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst quantityLeft = SharingUtilities.getItemSharesLeftForActor(this.store.actor, this.item, this.store.recipient);\n\t\t\tthis.quantityLeft.set(quantityLeft);\n\t\t});\n\n\t\tthis.subscribeTo(this.itemDocument, () => {\n\t\t\tconst updateData = this.itemDocument.updateOptions;\n\t\t\tconst renderData = updateData?.renderData ?? updateData?.data ?? {};\n\t\t\tconst itemData = CompendiumUtilities.findSimilarItemInCompendiumSync(this.item);\n\t\t\tthis.name.set(itemData?.name ?? this.item.name);\n\t\t\tthis.img.set(itemData?.img ?? this.item.img);\n\t\t\tthis.similarities = Utilities.setSimilarityProperties({}, this.item);\n\t\t\tif (PileUtilities.canItemStack(this.item, this.store.actor) && Utilities.hasItemQuantity(renderData)) {\n\t\t\t\tthis.quantity.set(Utilities.getItemQuantity(renderData));\n\t\t\t\tconst quantity = Math.min(get(this.currentQuantity), get(this.quantityLeft), get(this.quantity));\n\t\t\t\tthis.currentQuantity.set(quantity);\n\t\t\t}\n\t\t\tif (foundry.utils.hasProperty(renderData, CONSTANTS.FLAGS.ITEM)) {\n\t\t\t\tthis.itemFlagData.set(PileUtilities.getItemFlagData(this.item));\n\t\t\t\tthis.updateCategory();\n\t\t\t\tthis.store.refreshItems();\n\t\t\t}\n\t\t\tif (Plugins[\"rarity-colors\"].data) {\n\t\t\t\tthis.rarityColor.set(Plugins[\"rarity-colors\"].data.getItemColor(this.item));\n\t\t\t}\n\t\t\tif (Utilities.hasItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.IS_CONTAINED)) {\n\t\t\t\tthis.containerID.set(Utilities.getItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.IS_CONTAINED)({ item: this.item }));\n\t\t\t}\n\t\t\tif (!foundry.utils.isEmpty(renderData) && Utilities.hasItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.HAS_CURRENCY, this.item.type)) {\n\t\t\t\tthis.store.populateItems();\n\t\t\t\tthis.store.refreshItems();\n\t\t\t}\n\t\t});\n\n\t\tthis.updateCategory();\n\n\t\tthis.subscribeTo(this.quantity, this.filter.bind(this));\n\t\tthis.subscribeTo(this.store.search, this.filter.bind(this));\n\t\tthis.subscribeTo(this.category, this.filter.bind(this));\n\t}\n\n\tsetupProperties() {\n\t\tconst actorIsItemPile = PileUtilities.isValidItemPile(this.store.actor, get(this.store.pileData));\n\t\tconst pileActor = actorIsItemPile ? this.store.actor : this.store.recipient;\n\t\tconst pileActorData = actorIsItemPile ? this.store.pileData : this.store.recipientPileData;\n\t\tconst pileCurrencies = actorIsItemPile ? get(this.store.pileCurrencies) : get(this.store.recipientCurrencies);\n\t\tthis.isCurrency = PileUtilities.isItemCurrency(this.item, {\n\t\t\ttarget: pileActor,\n\t\t\tactorCurrencies: pileCurrencies\n\t\t});\n\t\tconst currency = this.isCurrency ? PileUtilities.getItemCurrencyData(this.item, {\n\t\t\ttarget: pileActor,\n\t\t\tactorCurrencies: pileCurrencies\n\t\t}) : {};\n\t\tthis.isSecondaryCurrency = !!currency?.secondary;\n\t\tthis.abbreviation.set(currency?.abbreviation ?? \"\");\n\t\tthis.similarities = Utilities.setSimilarityProperties({}, this.item);\n\t\tthis.name.set(this.isCurrency ? currency.name : this.item.name);\n\t\tthis.img.set(this.isCurrency ? currency.img : this.item.img);\n\t\tthis.toShare = this.isCurrency\n\t\t\t? get(pileActorData).shareCurrenciesEnabled && !!this.store.recipient\n\t\t\t: get(pileActorData).shareItemsEnabled && !!this.store.recipient;\n\t}\n\n\tupdateCategory() {\n\t\tconst pileData = get(this.store.pileData);\n\t\tconst itemFlagData = get(this.itemFlagData);\n\t\tthis.category.update(cat => {\n\t\t\tcat.service = itemFlagData?.isService;\n\t\t\tif (itemFlagData.customCategory) {\n\t\t\t\tcat.type = itemFlagData.customCategory.toLowerCase();\n\t\t\t\tcat.label = itemFlagData.customCategory;\n\t\t\t} else if (cat.service && pileData.enabled && pileData.type === CONSTANTS.PILE_TYPES.MERCHANT) {\n\t\t\t\tcat.type = \"item-piles-service\";\n\t\t\t\tcat.label = \"ITEM-PILES.Merchant.Service\";\n\t\t\t} else {\n\t\t\t\tcat.type = this.type;\n\t\t\t\tcat.label = CONFIG.Item.typeLabels[this.type];\n\t\t\t}\n\t\t\treturn cat;\n\t\t});\n\t}\n\n\tfilter() {\n\t\tconst name = get(this.name).trim();\n\t\tconst search = get(this.store.search).trim();\n\t\tconst presentFromTheStart = get(this.presentFromTheStart);\n\t\tconst quantity = get(this.quantity);\n\t\tif (quantity === 0 && !presentFromTheStart) {\n\t\t\tthis.filtered.set(true);\n\t\t} else if (search) {\n\t\t\tconst nameIsInSearchQuery = name.toLowerCase().includes(search.toLowerCase());\n\t\t\tconst subItemNamesMatchQuery = get(this.subItems).some(item => get(item.filtered));\n\t\t\tthis.filtered.set(!(nameIsInSearchQuery || subItemNamesMatchQuery));\n\t\t} else {\n\t\t\tthis.filtered.set(!presentFromTheStart && quantity === 0);\n\t\t}\n\t}\n\n\ttake() {\n\t\tconst quantity = Math.min(get(this.currentQuantity), get(this.quantityLeft));\n\t\tif (!quantity) return;\n\t\treturn game.itempiles.API.transferItems(\n\t\t\tthis.store.actor,\n\t\t\tthis.store.recipient,\n\t\t\t[{ _id: this.id, quantity }],\n\t\t\t{ interactionId: this.store.interactionId }\n\t\t);\n\t}\n\n\tasync remove() {\n\t\treturn game.itempiles.API.removeItems(this.store.actor, [this.id]);\n\t}\n\n\tasync updateQuantity(quantity, add = false) {\n\t\tlet total = typeof quantity === \"string\" ? (await new Roll(quantity).evaluate({ allowInteractive: false })).total : quantity;\n\t\tif (add) {\n\t\t\ttotal += get(this.quantity);\n\t\t}\n\t\tthis.quantity.set(total);\n\t\treturn this.item.update(Utilities.setItemQuantity({}, total));\n\t}\n\n\tasync updateFlags() {\n\t\tawait PileUtilities.updateItemData(this.item, {\n\t\t\tflags: get(this.itemFlagData)\n\t\t});\n\t}\n\n\tpreview() {\n\t\tconst pileData = get(this.store.pileData);\n\t\tif (!pileData.canInspectItems && !game.user.isGM) return;\n\t\tif (SYSTEMS.DATA?.PREVIEW_ITEM_TRANSFORMER) {\n\t\t\tif (!SYSTEMS.DATA?.PREVIEW_ITEM_TRANSFORMER(this.item)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif (game.user.isGM || this.item.ownership[game.user.id] === 3) {\n\t\t\treturn this.item.sheet.render(true);\n\t\t}\n\t\tconst itemData = this.item.toObject();\n\t\titemData.ownership[game.user.id] = 1;\n\t\tconst newItem = new Item.implementation(itemData);\n\t\tconst cls = newItem._getSheetClass();\n\t\tconst sheet = new cls(newItem, { editable: false });\n\t\treturn sheet._render(true);\n\t}\n}\n\nexport class PileAttribute extends PileBaseItem {\n\n\tsetupStores(attribute) {\n\t\tsuper.setupStores();\n\t\tthis.attribute = attribute;\n\t\tthis.path = this.attribute.path;\n\t\tthis.name = writable(this.attribute.name);\n\t\tthis.img = writable(this.attribute.img);\n\t\tthis.abbreviation = writable(this.attribute.abbreviation);\n\t\tthis.identifier = foundry.utils.randomID();\n\t\tconst startingQuantity = Number(foundry.utils.getProperty(this.parent, this.path) ?? 0);\n\t\tthis.presentFromTheStart.set(startingQuantity > 0);\n\t\tthis.quantity.set(startingQuantity);\n\t\tthis.currentQuantity.set(Math.min(get(this.currentQuantity), get(this.quantityLeft), get(this.quantity)));\n\t\tthis.category.set({ type: \"currency\", label: \"ITEM-PILES.Currency\" });\n\t}\n\n\tsetupSubscriptions() {\n\t\tsuper.setupSubscriptions();\n\n\t\tthis.subscribeTo(this.store.pileData, this.setupProperties.bind(this));\n\n\t\tthis.subscribeTo(this.store.shareData, (val) => {\n\t\t\tconst quantity = get(this.quantity);\n\t\t\tif (!this.toShare) {\n\t\t\t\tthis.quantityLeft.set(quantity);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst quantityLeft = SharingUtilities.getAttributeSharesLeftForActor(this.store.actor, this.path, this.store.recipient);\n\t\t\tthis.quantityLeft.set(Math.min(quantity, quantityLeft));\n\t\t});\n\n\t\tthis.subscribeTo(this.parentDoc, () => {\n\t\t\tconst updateData = this.parentDoc.updateOptions;\n\t\t\tconst renderData = updateData?.renderData ?? updateData?.data ?? {};\n\t\t\tthis.path = this.attribute.path;\n\t\t\tthis.name.set(this.attribute.name);\n\t\t\tthis.img.set(this.attribute.img);\n\t\t\tif (foundry.utils.hasProperty(renderData, this.path)) {\n\t\t\t\tconst newQuantity = Number(foundry.utils.getProperty(renderData, this.path) ?? 0);\n\t\t\t\tthis.quantity.set(newQuantity);\n\t\t\t\tif (!this.toShare) {\n\t\t\t\t\tthis.quantityLeft.set(newQuantity);\n\t\t\t\t} else {\n\t\t\t\t\tconst quantityLeft = SharingUtilities.getAttributeSharesLeftForActor(this.store.actor, this.path, this.store.recipient);\n\t\t\t\t\tthis.quantityLeft.set(Math.min(newQuantity, quantityLeft));\n\t\t\t\t}\n\t\t\t\tthis.currentQuantity.set(Math.min(get(this.currentQuantity), get(this.quantityLeft), newQuantity));\n\t\t\t\tthis.store.refreshItems();\n\t\t\t}\n\t\t});\n\n\t\tthis.subscribeTo(this.quantity, this.filter.bind(this));\n\t\tthis.subscribeTo(this.store.search, this.filter.bind(this));\n\t}\n\n\tsetupProperties() {\n\t\tthis.toShare = get(this.store.pileData).shareCurrenciesEnabled && !!this.store.recipient;\n\t}\n\n\tfilter() {\n\t\tconst name = get(this.name);\n\t\tconst search = get(this.store.search);\n\t\tconst presentFromTheStart = get(this.presentFromTheStart);\n\t\tconst quantity = get(this.quantity);\n\t\tif (quantity === 0 && !presentFromTheStart) {\n\t\t\tthis.filtered.set(true);\n\t\t} else if (search) {\n\t\t\tconst nameIsInSearchQuery = name.toLowerCase().includes(search.toLowerCase());\n\t\t\tconst subItemNamesMatchQuery = get(this.subItems).some(item => get(item.filtered));\n\t\t\tthis.filtered.set(!(nameIsInSearchQuery || subItemNamesMatchQuery));\n\t\t} else {\n\t\t\tthis.filtered.set(!presentFromTheStart && quantity === 0);\n\t\t}\n\t}\n\n\ttake() {\n\t\tconst quantity = Math.min(get(this.currentQuantity), get(this.quantityLeft));\n\t\treturn game.itempiles.API.transferAttributes(\n\t\t\tthis.parent,\n\t\t\tthis.store.recipient,\n\t\t\t{ [this.path]: quantity },\n\t\t\t{ interactionId: this.store.interactionId }\n\t\t);\n\t}\n\n\tupdateQuantity() {\n\t\treturn this.parent.update({\n\t\t\t[this.path]: get(this.quantity)\n\t\t});\n\t}\n\n}\n","<script>\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\n\timport { localize } from '#runtime/svelte/helper';\n\timport { getContext } from \"svelte\";\n\timport * as PileUtilities from \"../../../helpers/pile-utilities.js\";\n\timport { abbreviateNumbers } from \"../../../helpers/helpers.js\";\n\n\tconst { application } = getContext('#external');\n\n\texport let sourceActor;\n\texport let targetActor;\n\texport let localization;\n\texport let settings;\n\texport let elementRoot;\n\n\tconst targetCurrencyData = PileUtilities.getCurrencyList(targetActor);\n\n\tconst currencies = PileUtilities.getActorCurrencies(sourceActor, {\n\t\tcurrencyList: targetCurrencyData.currencies,\n\t\tgetAll: settings?.unlimitedCurrencies\n\t});\n\n\tconst existingCurrencies = settings.existingCurrencies ?? PileUtilities.getActorCurrencies(sourceActor, {\n\t\tcurrencyList: targetCurrencyData.currencies\n\t});\n\n\tlet attributes = currencies.filter(entry => entry.type === \"attribute\")\n\t\t.map(currency => {\n\t\t\tcurrency.currentQuantity = 0;\n\t\t\treturn currency;\n\t\t});\n\n\tif (settings?.unlimitedCurrencies) {\n\t\tattributes.forEach(currency => {\n\t\t\tconst existingCurrency = existingCurrencies.find(existingCurrency => existingCurrency.name === currency.name && existingCurrency.img === currency.img);\n\t\t\tif (existingCurrency) {\n\t\t\t\tcurrency.currentQuantity = existingCurrency.quantity;\n\t\t\t}\n\t\t});\n\t}\n\n\tlet items = currencies.filter(entry => entry.type !== \"attribute\")\n\t\t.map(currency => {\n\t\t\tcurrency.create = !existingCurrencies.some(existingCurrency => existingCurrency.name === currency.name && existingCurrency.img === currency.img);\n\t\t\tcurrency.id = currency.id ?? foundry.utils.randomID();\n\t\t\tcurrency.currentQuantity = 0;\n\t\t\treturn currency;\n\t\t});\n\n\tif (settings?.unlimitedCurrencies) {\n\t\titems.forEach(currency => {\n\t\t\tconst existingCurrency = existingCurrencies.find(existingCurrency => existingCurrency.name === currency.name && existingCurrency.img === currency.img);\n\t\t\tif (existingCurrency) {\n\t\t\t\tcurrency.currentQuantity = existingCurrency.quantity;\n\t\t\t}\n\t\t});\n\t}\n\n\n\tlet form;\n\n\tfunction requestSubmit() {\n\t\tform.requestSubmit();\n\t}\n\n\tfunction submit() {\n\n\t\tconst itemsToUpdate = items\n\t\t\t.filter(item => (settings.unlimitedCurrencies || item.currentQuantity) && !item.create)\n\t\t\t.map(item => {\n\t\t\t\treturn {\n\t\t\t\t\t_id: item.id,\n\t\t\t\t\tquantity: settings.getUpdates && item.quantity\n\t\t\t\t\t\t? item.currentQuantity - item.quantity\n\t\t\t\t\t\t: item.currentQuantity\n\t\t\t\t}\n\t\t\t});\n\n\t\tconst itemsToCreate = items\n\t\t\t.filter(item => item.currentQuantity && item.create)\n\t\t\t.map(item => ({\n\t\t\t\titem: item.data.item,\n\t\t\t\tquantity: settings.unlimitedCurrencies ? item.currentQuantity : Math.max(0, Math.min(item.quantity, item.currentQuantity))\n\t\t\t}))\n\n\t\tapplication.options.resolve({\n\t\t\tattributes: Object.fromEntries(attributes\n\t\t\t\t.filter(attribute => settings.unlimitedCurrencies || attribute.currentQuantity)\n\t\t\t\t.map(attribute => [attribute.path, settings.unlimitedCurrencies ? attribute.currentQuantity : Math.max(0, Math.min(attribute.quantity, attribute.currentQuantity))])\n\t\t\t),\n\t\t\titems: itemsToUpdate.concat(itemsToCreate)\n\t\t});\n\t\tapplication.close();\n\t}\n\n</script>\n\n<svelte:options accessors={true}/>\n\n<ApplicationShell bind:elementRoot>\n\n\t<form autocomplete=\"off\" bind:this={form} class=\"item-piles-flexcol\" on:submit|once|preventDefault={submit}\n\t      style=\"padding:0.5rem;\">\n\n\t\t{#if attributes.length || items.length}\n\n\t\t\t<p style=\"text-align: center; margin: 0;\" class=\"item-piles-bottom-divider\">\n\t\t\t\t{settings?.content ?? localize(`ITEM-PILES.Applications.${localization}.Content`)}\n\t\t\t</p>\n\n\t\t\t{#each attributes.filter(currency => !currency.secondary) as attribute, index (attribute.path)}\n\t\t\t\t<div class=\"form-group item-piles-slider-group item-piles-odd-color\">\n\t\t\t\t\t<div class=\"item-piles-img-container\">\n\t\t\t\t\t\t<img class=\"item-piles-img\" src=\"{attribute.img}\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"item-piles-name item-piles-text\">\n\t\t\t\t\t\t<div>{attribute.name}</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if settings?.unlimitedCurrencies}\n\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 2; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t       bind:value={attribute.currentQuantity}/>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<input class=\"item-piles-range-slider\" style=\"flex: 5;\" type=\"range\" min=\"0\" max=\"{attribute.quantity}\"\n\t\t\t\t\t\t       bind:value={attribute.currentQuantity}/>\n\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 2; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t       bind:value={attribute.currentQuantity}\n\t\t\t\t\t\t       on:click={() => {\n                        attribute.currentQuantity = Math.max(0, Math.min(attribute.quantity, attribute.currentQuantity));\n                   }}/>\n\t\t\t\t\t\t<div style=\"flex:0 1 50px; margin: 0 5px;\">/ {abbreviateNumbers(attribute.quantity)}</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t{/each}\n\n\t\t\t{#each items.filter(currency => !currency.secondary) as item, index (item.id)}\n\t\t\t\t<div class=\"form-group item-piles-slider-group item-piles-odd-color\">\n\t\t\t\t\t<div class=\"item-piles-img-container\">\n\t\t\t\t\t\t<img class=\"item-piles-img\" src=\"{item.img}\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"item-piles-name item-piles-text\">\n\t\t\t\t\t\t<div>{item.name}</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if settings?.unlimitedCurrencies}\n\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 2; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t       bind:value={item.currentQuantity}/>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<input class=\"item-piles-range-slider\" style=\"flex: 5;\" type=\"range\" min=\"0\" max=\"{item.quantity}\"\n\t\t\t\t\t\t       bind:value={item.currentQuantity}/>\n\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 1.5; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t       bind:value={item.currentQuantity}\n\t\t\t\t\t\t       on:click={() => {\n                        item.currentQuantity = Math.max(0, Math.min(item.quantity, item.currentQuantity));\n                   }}/>\n\t\t\t\t\t\t<div style=\"flex:0 1 50px; margin: 0 5px;\">/ {abbreviateNumbers(item.quantity)}</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t{/each}\n\n\t\t\t{#if attributes.filter(currency => currency.secondary).length || items.filter(currency => currency.secondary).length}\n\n\t\t\t\t<div class=\"item-piles-top-divider\"></div>\n\n\t\t\t\t{#each attributes.filter(currency => currency.secondary) as attribute, index (attribute.path)}\n\t\t\t\t\t<div class=\"form-group item-piles-slider-group item-piles-odd-color\">\n\t\t\t\t\t\t<div class=\"item-piles-img-container\">\n\t\t\t\t\t\t\t<img class=\"item-piles-img\" src=\"{attribute.img}\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"item-piles-name item-piles-text\">\n\t\t\t\t\t\t\t<div>{attribute.name}</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{#if settings?.unlimitedCurrencies}\n\t\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 2; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t\t       bind:value={attribute.currentQuantity}/>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<input class=\"item-piles-range-slider\" style=\"flex: 5;\" type=\"range\" min=\"0\" max=\"{attribute.quantity}\"\n\t\t\t\t\t\t\t       bind:value={attribute.currentQuantity}/>\n\t\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 2; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t\t       bind:value={attribute.currentQuantity}\n\t\t\t\t\t\t\t       on:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tattribute.currentQuantity = Math.max(0, Math.min(attribute.quantity, attribute.currentQuantity));\n\t\t\t\t\t\t\t\t\t\t }}/>\n\t\t\t\t\t\t\t<div style=\"flex:0 1 50px; margin: 0 5px;\">/ {abbreviateNumbers(attribute.quantity)}</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t{/each}\n\n\t\t\t\t{#each items.filter(currency => currency.secondary) as item, index (item.id)}\n\t\t\t\t\t<div class=\"form-group item-piles-slider-group item-piles-odd-color\">\n\t\t\t\t\t\t<div class=\"item-piles-img-container\">\n\t\t\t\t\t\t\t<img class=\"item-piles-img\" src=\"{item.img}\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"item-piles-name item-piles-text\">\n\t\t\t\t\t\t\t<div>{item.name}</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{#if settings?.unlimitedCurrencies}\n\t\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 2; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t\t       bind:value={item.currentQuantity}/>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<input class=\"item-piles-range-slider\" style=\"flex: 5;\" type=\"range\" min=\"0\" max=\"{item.quantity}\"\n\t\t\t\t\t\t\t       bind:value={item.currentQuantity}/>\n\t\t\t\t\t\t\t<input class=\"item-piles-range-input\" style=\"flex: 1.5; margin-left:1rem;\" type=\"number\"\n\t\t\t\t\t\t\t       bind:value={item.currentQuantity}\n\t\t\t\t\t\t\t       on:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\titem.currentQuantity = Math.max(0, Math.min(item.quantity, item.currentQuantity));\n\t\t\t\t\t\t\t\t\t\t }}/>\n\t\t\t\t\t\t\t<div style=\"flex:0 1 50px; margin: 0 5px;\">/ {abbreviateNumbers(item.quantity)}</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t{/each}\n\n\t\t\t{/if}\n\n\t\t{:else}\n\n\t\t\t<p style=\"text-align: center;\">\n\t\t\t\t{localize(`ITEM-PILES.Applications.${localization}.NoCurrency`, { actor_name: sourceActor.name })}\n\t\t\t</p>\n\n\t\t{/if}\n\n\t\t<footer class=\"sheet-footer item-piles-flexrow\" style=\"margin-top: 1rem;\">\n\t\t\t{#if attributes.length || items.length}\n\t\t\t\t<button type=\"button\" on:click|once={requestSubmit}>\n\t\t\t\t\t<i class=\"fas fa-download\"></i>\n\t\t\t\t\t{localize(settings?.button ?? `ITEM-PILES.Applications.${localization}.Submit`)}\n\t\t\t\t</button>\n\t\t\t{/if}\n\n\t\t\t<button on:click|once={() => { application.close() }} type=\"button\">\n\t\t\t\t<i class=\"fas fa-times\"></i>\n\t\t\t\t{localize(\"Cancel\")}\n\t\t\t</button>\n\t\t</footer>\n\n\t</form>\n\n</ApplicationShell>\n","import DropCurrencyDialogShell from \"./drop-currency-dialog-shell.svelte\";\r\nimport { SvelteApplication } from '#runtime/svelte/application';\r\nimport { getActiveApps } from \"../../../helpers/helpers\";\r\n\r\nexport default class DropCurrencyDialog extends SvelteApplication {\r\n\r\n\t/**\r\n\t *\r\n\t * @param sourceActor\r\n\t * @param targetActor\r\n\t * @param settings\r\n\t * @param options\r\n\t */\r\n\tconstructor(sourceActor, targetActor, settings = {}, options = {}) {\r\n\t\tconst localization = settings.localization || \"DropCurrencies\";\r\n\t\tconst id = sourceActor ? (sourceActor.id + (targetActor ? \"-\" + targetActor.id : \"\")) : \"\";\r\n\t\tsuper({\r\n\t\t\tid: `item-pile-drop-currency-${id}-${foundry.utils.randomID()}`,\r\n\t\t\ttitle: settings.title ?? game.i18n.localize(`ITEM-PILES.Applications.${localization}.Title`),\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: DropCurrencyDialogShell,\r\n\t\t\t\ttarget: document.body,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\tsourceActor,\r\n\t\t\t\t\ttargetActor,\r\n\t\t\t\t\tlocalization,\r\n\t\t\t\t\tsettings\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclose: () => this.options.resolve?.(null),\r\n\t\t\t...options\r\n\t\t})\r\n\t}\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\twidth: 430,\r\n\t\t\theight: \"auto\",\r\n\t\t\tclasses: [\"item-piles-app\"]\r\n\t\t})\r\n\t}\r\n\r\n\tstatic getActiveApps(sourceActor, targetActor) {\r\n\t\tconst id = sourceActor ? (sourceActor.id + (targetActor ? \"-\" + targetActor.id : \"\")) : \"\";\r\n\t\treturn getActiveApps(`item-pile-drop-currency-${id}`);\r\n\t}\r\n\r\n\tstatic async show(sourceActor, targetActor, settings = {}, options = {}) {\r\n\t\tif (sourceActor) {\r\n\t\t\tconst apps = this.getActiveApps(sourceActor, targetActor);\r\n\t\t\tif (apps.length) {\r\n\t\t\t\tfor (let app of apps) {\r\n\t\t\t\t\tapp.render(false, { focus: true });\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\toptions.resolve = resolve;\r\n\t\t\tnew this(sourceActor, targetActor, settings, options).render(true, { focus: true });\r\n\t\t})\r\n\t}\r\n\r\n}\r\n","import { get, writable } from \"svelte/store\";\nimport { TJSDocument } from \"#runtime/svelte/store/fvtt/document\";\nimport CONSTANTS from \"../constants/constants.js\";\nimport * as Utilities from \"../helpers/utilities.js\";\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\nimport * as SharingUtilities from \"../helpers/sharing-utilities.js\";\nimport * as Helpers from \"../helpers/helpers.js\";\nimport { InterfaceTracker } from \"../socket.js\";\nimport { PileAttribute, PileItem } from \"./pile-item.js\";\nimport DropCurrencyDialog from \"../applications/dialogs/drop-currency-dialog/drop-currency-dialog.js\";\nimport { SYSTEMS } from \"../systems.js\";\n\nconst __STORES__ = new Map();\n\nexport default class ItemPileStore {\n\n\tconstructor(application, source, recipient = false, { recipientPileData = false } = {}) {\n\n\t\tthis.subscriptions = [];\n\n\t\tthis.interactionId = foundry.utils.randomID();\n\t\tthis.application = application;\n\n\t\tthis.uuid = Utilities.getUuid(source);\n\t\tthis.actor = Utilities.getActor(source);\n\t\tthis.document = new TJSDocument(this.actor);\n\n\t\tthis.recipient = recipient ? Utilities.getActor(recipient) : false;\n\t\tthis.recipientDocument = recipient ? new TJSDocument(this.recipient) : new TJSDocument();\n\t\tthis.recipientPileData = writable(recipientPileData);\n\n\t\tthis.pileData = writable({});\n\t\tthis.shareData = writable({});\n\n\t\tthis.recipientPileData = writable({})\n\t\tthis.recipientShareData = writable({});\n\n\t\tthis.deleted = writable(false);\n\n\t\tthis.search = writable(\"\");\n\t\tthis.editQuantities = writable(true);\n\n\t\tthis.allItems = writable([]);\n\t\tthis.attributes = writable([]);\n\n\t\tthis.items = writable([]);\n\t\tthis.visibleItems = writable([]);\n\n\t\tthis.pileCurrencies = writable([]);\n\t\tthis.recipientCurrencies = writable([]);\n\n\t\tthis.currencies = writable([]);\n\t\tthis.allCurrencies = writable([]);\n\n\t\tthis.itemsPerCategory = writable({});\n\t\tthis.categories = writable([]);\n\t\tthis.itemCategories = writable([]);\n\n\t\tthis.numItems = writable(0);\n\t\tthis.numCurrencies = writable(0);\n\n\t\tthis.name = writable(\"\");\n\t\tthis.img = writable(\"\");\n\n\t\t__STORES__.set(this.uuid, this);\n\n\t}\n\n\tget ItemClass() {\n\t\treturn PileItem;\n\t};\n\n\tget AttributeClass() {\n\t\treturn PileAttribute;\n\t};\n\n\tget searchDelay() {\n\t\treturn 200;\n\t}\n\n\tstatic make(...args) {\n\t\tconst store = new this(...args)\n\t\tstore.setupStores();\n\t\tstore.setupSubscriptions();\n\t\treturn store;\n\t}\n\n\tstatic getStore(actor) {\n\t\tconst uuid = Utilities.getUuid(actor);\n\t\treturn __STORES__.get(uuid);\n\t}\n\n\tstatic notifyChanges(event, actor, ...args) {\n\t\tconst store = this.getStore(actor);\n\t\tif (store) {\n\t\t\tstore[event](...args);\n\t\t}\n\t}\n\n\tstatic notifyAllOfChanges(event, ...args) {\n\t\tfor (const store of __STORES__.values()) {\n\t\t\tif (store[event]) {\n\t\t\t\tstore[event](...args);\n\t\t\t}\n\t\t}\n\t}\n\n\tsetupStores() {\n\n\t\tthis.pileData.set(PileUtilities.getActorFlagData(this.actor));\n\t\tthis.shareData.set(SharingUtilities.getItemPileSharingData(this.actor));\n\n\t\tthis.recipientPileData.set(this.recipient ? PileUtilities.getActorFlagData(this.recipient) : {});\n\t\tthis.recipientShareData.set(this.recipient ? SharingUtilities.getItemPileSharingData(this.recipient) : {});\n\n\t\tthis.deleted.set(false);\n\n\t\tthis.search.set(\"\");\n\t\tthis.editQuantities.set(!this.recipient);\n\n\t\tthis.allItems.set([]);\n\t\tthis.attributes.set([]);\n\n\t\tthis.items.set([]);\n\t\tthis.visibleItems.set([]);\n\n\t\tthis.pileCurrencies.set(PileUtilities.getActorCurrencies(this.actor, { getAll: true }));\n\t\tthis.recipientCurrencies.set(this.recipient ? PileUtilities.getActorCurrencies(this.recipient, { getAll: true }) : []);\n\n\t\tthis.currencies.set([]);\n\t\tthis.allCurrencies.set([]);\n\n\t\tthis.itemsPerCategory.set({});\n\t\tthis.categories.set([]);\n\t\tthis.itemCategories.set([]);\n\n\t\tthis.numItems.set(0);\n\t\tthis.numCurrencies.set(0);\n\n\t\tthis.name.set(\"\");\n\t\tthis.img.set(\"\");\n\n\t}\n\n\tgetActorImage() {\n\t\treturn this.actor.img;\n\t}\n\n\tsetupSubscriptions() {\n\n\t\tthis.subscribeTo(this.document, () => {\n\t\t\tconst updateData = this.document.updateOptions;\n\t\t\tconst renderData = updateData?.renderData ?? updateData?.data ?? {};\n\t\t\tif (foundry.utils.hasProperty(renderData, CONSTANTS.FLAGS.SHARING)) {\n\t\t\t\tthis.shareData.set(SharingUtilities.getItemPileSharingData(this.actor));\n\t\t\t\tthis.refreshItems();\n\t\t\t}\n\t\t\tif (foundry.utils.hasProperty(renderData, CONSTANTS.FLAGS.PILE)) {\n\t\t\t\tthis.pileData.set(PileUtilities.getActorFlagData(this.actor));\n\t\t\t\tthis.pileCurrencies.set(PileUtilities.getActorCurrencies(this.actor, { getAll: true }));\n\t\t\t\tthis.refreshItems();\n\t\t\t}\n\t\t\tthis.name.set(this.actor.name);\n\t\t\tthis.img.set(this.getActorImage());\n\t\t});\n\n\t\tif (this.recipientDocument) {\n\t\t\tthis.subscribeTo(this.recipientDocument, () => {\n\t\t\t\tconst updateData = this.document.updateOptions;\n\t\t\t\tconst renderData = updateData?.renderData ?? updateData?.data ?? {};\n\t\t\t\tif (foundry.utils.hasProperty(renderData, CONSTANTS.FLAGS.SHARING)) {\n\t\t\t\t\tthis.recipientShareData.set(SharingUtilities.getItemPileSharingData(this.recipient));\n\t\t\t\t\tthis.refreshItems();\n\t\t\t\t}\n\t\t\t\tif (foundry.utils.hasProperty(renderData, CONSTANTS.FLAGS.PILE)) {\n\t\t\t\t\tthis.recipientPileData.set(PileUtilities.getActorFlagData(this.recipient));\n\t\t\t\t\tthis.recipientCurrencies.set(PileUtilities.getActorCurrencies(this.recipient, { getAll: true }));\n\t\t\t\t\tthis.refreshItems();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.subscribeTo(this.allItems, () => {\n\t\t\tthis.refreshItems();\n\t\t});\n\t\tthis.subscribeTo(this.attributes, () => {\n\t\t\tthis.refreshItems();\n\t\t});\n\n\t\tconst filterDebounce = foundry.utils.debounce(() => {\n\t\t\tthis.refreshItems();\n\t\t}, this.searchDelay);\n\t\tthis.subscribeTo(this.search, (val) => {\n\t\t\tfilterDebounce()\n\t\t});\n\n\t\tthis.populateItems();\n\n\t}\n\n\tpopulateItems() {\n\n\t\tconst items = get(this.allItems);\n\t\tconst attributes = get(this.attributes);\n\n\t\tconst pileData = PileUtilities.isValidItemPile(this.actor) || !this.recipient ? get(this.pileData) : get(this.recipientPileData);\n\n\t\tconst pileItems = PileUtilities.getActorItems(this.actor, { itemFilters: pileData.overrideItemFilters });\n\n\t\tpileItems.forEach(item => {\n\t\t\tif (items.some(existingItem => existingItem.item === item)) return;\n\t\t\titems.push(new this.ItemClass(this, item));\n\t\t});\n\n\t\tif (SYSTEMS.DATA.ITEM_TYPE_HANDLERS) {\n\n\t\t\tconst groupedItems = items.filter(item => {\n\t\t\t\treturn Utilities.hasItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.HAS_CURRENCY, item.type);\n\t\t\t});\n\n\t\t\tgroupedItems.forEach((containerPileItem) => {\n\t\t\t\tPileUtilities.getCurrenciesInItem(containerPileItem.item, {\n\t\t\t\t\tforActor: this.recipient,\n\t\t\t\t\tgetAll: false\n\t\t\t\t}).forEach(currency => {\n\t\t\t\t\tif (currency.type !== \"item\") {\n\t\t\t\t\t\tif (attributes.some(existingAttribute => existingAttribute.path === currency.path && existingAttribute.parent === containerPileItem.item)) return;\n\t\t\t\t\t\tconst currencyPileItem = new this.AttributeClass(this, currency, true, !!currency?.secondary, containerPileItem)\n\t\t\t\t\t\tcurrencyPileItem.containerID.set(containerPileItem.item.id);\n\t\t\t\t\t\tattributes.push(currencyPileItem);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t}\n\n\t\tPileUtilities.getActorCurrencies(this.actor, { forActor: this.recipient, getAll: true }).forEach(currency => {\n\t\t\tif (currency.type === \"item\") {\n\t\t\t\tif (!currency.item) return;\n\t\t\t\tif (items.some(existingItem => existingItem.item === currency.item)) return;\n\t\t\t\titems.push(new this.ItemClass(this, currency.item, true, !!currency?.secondary));\n\t\t\t} else {\n\t\t\t\tif (attributes.some(existingAttribute => existingAttribute.path === currency.path)) return;\n\t\t\t\tattributes.push(new this.AttributeClass(this, currency, true, !!currency?.secondary));\n\t\t\t}\n\t\t});\n\n\t\tthis.allItems.set(items);\n\t\tthis.attributes.set(attributes);\n\n\t}\n\n\tupdateUnlinkedToken() {\n\t\tthis.pileData.set(PileUtilities.getActorFlagData(this.actor));\n\t\tthis.shareData.set(SharingUtilities.getItemPileSharingData(this.actor));\n\t\tthis.refreshItems();\n\t}\n\n\tupdateSource(newSource) {\n\t\tthis.uuid = Utilities.getUuid(newSource);\n\t\tthis.actor = Utilities.getActor(newSource);\n\t\tthis.document.set(this.actor);\n\t\t__STORES__.set(this.uuid, this);\n\t\tthis.unsubscribe();\n\t\tthis.setupStores();\n\t\tthis.setupSubscriptions();\n\t}\n\n\tupdateRecipient(newRecipient) {\n\t\tthis.recipient = newRecipient;\n\t\tthis.recipientDocument.set(this.recipient);\n\t\tthis.unsubscribe();\n\t\tthis.setupStores();\n\t\tthis.setupSubscriptions();\n\t}\n\n\tvisibleItemFilterFunction(entry, actorIsMerchant, pileData, recipientPileData) {\n\t\tconst itemFlagData = entry.itemFlagData ? get(entry.itemFlagData) : {};\n\t\treturn !entry.isCurrency\n\t\t\t&& (this.actor.isOwner || !actorIsMerchant || !itemFlagData?.hidden);\n\t}\n\n\titemSortFunction(a, b, inverse) {\n\t\treturn (b.item.name > a.item.name ? -1 : 1) * (inverse ? -1 : 1);\n\t}\n\n\trefreshItems() {\n\t\tconst allItems = get(this.allItems);\n\t\tconst allAttributes = get(this.attributes);\n\t\tconst pileData = get(this.pileData);\n\t\tconst recipientPileData = this.recipient ? PileUtilities.getActorFlagData(this.recipient) : {}\n\t\tconst actorIsMerchant = PileUtilities.isItemPileMerchant(this.actor, pileData);\n\n\t\tconst groupedItems = allItems\n\t\t\t.map(item => {\n\t\t\t\titem.subItems.set([]);\n\t\t\t\treturn item;\n\t\t\t})\n\t\t\t.reduce((acc, item) => {\n\t\t\t\tconst containerID = get(item.containerID);\n\t\t\t\tif (containerID) {\n\t\t\t\t\tconst container = allItems.find(pileItem => pileItem.id === containerID);\n\t\t\t\t\tif (container) {\n\t\t\t\t\t\tcontainer.subItems.update(subItems => {\n\t\t\t\t\t\t\tsubItems.push(item);\n\t\t\t\t\t\t\treturn subItems;\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn acc;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tacc.push(item);\n\t\t\t\treturn acc;\n\t\t\t}, []);\n\n\t\tconst groupedAttributes = allAttributes\n\t\t\t.reduce((acc, item) => {\n\t\t\t\tconst containerID = get(item.containerID);\n\t\t\t\tif (containerID) {\n\t\t\t\t\tconst container = allItems.find(pileItem => pileItem.id === containerID)\n\t\t\t\t\tif (container) {\n\t\t\t\t\t\tcontainer.subItems.update(subItems => {\n\t\t\t\t\t\t\tsubItems.push(item);\n\t\t\t\t\t\t\tsubItems.sort((a, b) => {\n\t\t\t\t\t\t\t\tif (a?.attribute?.exchangeRate && b?.attribute?.exchangeRate) {\n\t\t\t\t\t\t\t\t\treturn (b?.attribute?.exchangeRate ?? 0) - (a?.attribute?.exchangeRate ?? 0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn (get(b.name) > get(a.name) ? -1 : 1);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\treturn subItems;\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn acc;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tacc.push(item);\n\t\t\t\treturn acc;\n\t\t\t}, []);\n\n\t\tconst visibleItems = groupedItems.filter(entry => this.visibleItemFilterFunction(entry, actorIsMerchant, pileData, recipientPileData));\n\t\tconst itemCurrencies = groupedItems.filter(entry => entry.isCurrency && !entry.isSecondaryCurrency);\n\t\tconst secondaryItemCurrencies = groupedItems.filter(entry => entry.isSecondaryCurrency);\n\n\t\tthis.visibleItems.set(visibleItems);\n\n\t\tconst items = visibleItems.filter(entry => !get(entry.filtered));\n\n\t\tthis.numItems.set(items.filter(entry => get(entry.quantity) > 0).length);\n\t\tthis.items.set(items.sort((a, b) => this.itemSortFunction(a, b)));\n\n\t\tconst currencies = groupedAttributes.filter(entry => !entry.isSecondaryCurrency).concat(itemCurrencies);\n\t\tconst secondaryCurrencies = groupedAttributes.filter(entry => entry.isSecondaryCurrency).concat(secondaryItemCurrencies);\n\n\t\tthis.numCurrencies.set(currencies.concat(secondaryCurrencies).filter(entry => get(entry.quantity) > 0).length);\n\n\t\tthis.currencies.set(currencies.concat(secondaryCurrencies).filter(entry => !get(entry.filtered)));\n\t\tthis.allCurrencies.set(currencies.concat(secondaryCurrencies));\n\n\t\tthis.itemCategories.set(Object.values(visibleItems.reduce((acc, item) => {\n\t\t\tconst category = get(item.category);\n\t\t\tif (!acc[category.type]) {\n\t\t\t\tacc[category.type] = { ...category };\n\t\t\t}\n\t\t\treturn acc;\n\t\t}, {})).sort((a, b) => a.label < b.label ? -1 : 1));\n\n\t\tconst itemsPerCategory = items\n\t\t\t.reduce((acc, item) => {\n\t\t\t\tconst category = get(item.category);\n\t\t\t\tif (!acc[category.type]) {\n\t\t\t\t\tacc[category.type] = {\n\t\t\t\t\t\tservice: category.service,\n\t\t\t\t\t\ttype: category.type,\n\t\t\t\t\t\tlabel: category.label,\n\t\t\t\t\t\titems: []\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tacc[category.type].items.push(item);\n\t\t\t\treturn acc;\n\t\t\t}, {})\n\n\t\tObject.values(itemsPerCategory).forEach(category => category.items.sort((a, b) => {\n\t\t\treturn a.item.name < b.item.name ? -1 : 1;\n\t\t}));\n\n\t\tthis.itemsPerCategory.set(itemsPerCategory);\n\n\t\tthis.categories.set(Object.values(itemsPerCategory).map(category => {\n\t\t\treturn {\n\t\t\t\tservice: category.service,\n\t\t\t\tlabel: category.label,\n\t\t\t\ttype: category.type\n\t\t\t}\n\t\t}).sort((a, b) => a.label < b.label ? -1 : 1));\n\t}\n\n\tcreateItem(item) {\n\t\tif (PileUtilities.isItemInvalid(this.actor, item)) return;\n\t\tconst items = get(this.allItems);\n\t\tconst deletedItems = items\n\t\t\t.filter(item => item.id === null)\n\t\t\t.map(item => ({\n\t\t\t\tpileItem: item,\n\t\t\t\t...item.similarities\n\t\t\t}));\n\t\tconst previouslyDeletedItem = Utilities.findSimilarItem(deletedItems, item);\n\t\tif (previouslyDeletedItem) {\n\t\t\tpreviouslyDeletedItem.pileItem.setup(item);\n\t\t} else {\n\t\t\titems.push(new this.ItemClass(this, item));\n\t\t}\n\t\tthis.allItems.set(items);\n\t}\n\n\tdeleteItem(item) {\n\t\tif (PileUtilities.isItemInvalid(this.actor, item)) return;\n\t\tconst items = get(this.allItems);\n\t\tconst pileItem = items.find(pileItem => pileItem.id === item.id);\n\t\tif (!pileItem) return;\n\t\tif (get(this.editQuantities) || !InterfaceTracker.isOpened(this.application.id)) {\n\t\t\titems.splice(items.indexOf(pileItem), 1);\n\t\t\tthis.allItems.set(items);\n\t\t} else {\n\t\t\tpileItem.id = null;\n\t\t\tpileItem.quantity.set(0);\n\t\t\tpileItem.quantityLeft.set(0);\n\t\t}\n\t\tpileItem.unsubscribe();\n\t}\n\n\tgetSimilarItem(item) {\n\t\tconst items = get(this.allItems).map(item => item.item);\n\t\treturn Utilities.findSimilarItem(items, item, get(this.pileData));\n\t}\n\n\tdelete() {\n\t\tthis.deleted.set(true);\n\t}\n\n\tasync update() {\n\n\t\tconst itemsToUpdate = [];\n\t\tconst itemsToDelete = [];\n\t\tconst attributesToUpdate = {};\n\n\t\tconst items = get(this.allItems).filter(item => item.id);\n\t\tfor (let item of items) {\n\t\t\tconst itemQuantity = get(item.quantity);\n\t\t\tif (itemQuantity === 0) {\n\t\t\t\titemsToDelete.push(item.id);\n\t\t\t} else {\n\t\t\t\tif (PileUtilities.canItemStack(item.item, this.actor)) {\n\t\t\t\t\titemsToUpdate.push(Utilities.setItemQuantity({ _id: item.id }, itemQuantity));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst attributes = get(this.attributes);\n\t\tfor (let attribute of attributes) {\n\t\t\tattributesToUpdate[attribute.path] = get(attribute.quantity);\n\t\t}\n\n\t\tconst pileSharingData = SharingUtilities.getItemPileSharingData(this.actor);\n\n\t\tawait this.actor.update(attributesToUpdate);\n\t\tif (pileSharingData?.currencies) {\n\t\t\tpileSharingData.currencies = pileSharingData.currencies.map(currency => {\n\t\t\t\tif (attributesToUpdate[currency.path] !== undefined) {\n\t\t\t\t\tcurrency.actors = currency.actors.map(actor => {\n\t\t\t\t\t\tactor.quantity = Math.max(0, Math.min(actor.quantity, attributesToUpdate[currency.path]));\n\t\t\t\t\t\treturn actor;\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\treturn currency;\n\t\t\t})\n\t\t}\n\n\t\tawait this.actor.updateEmbeddedDocuments(\"Item\", itemsToUpdate);\n\t\tawait this.actor.deleteEmbeddedDocuments(\"Item\", itemsToDelete);\n\t\tif (pileSharingData?.items) {\n\t\t\tpileSharingData.items = pileSharingData.items.map(item => {\n\t\t\t\tconst sharingItem = itemsToUpdate.find(item => item._id === item.id);\n\t\t\t\tif (sharingItem) {\n\t\t\t\t\titem.actors = item.actors.map(actor => {\n\t\t\t\t\t\tactor.quantity = Math.max(0, Math.min(actor.quantity, sharingItem.quantity));\n\t\t\t\t\t\treturn actor;\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\treturn item;\n\t\t\t})\n\t\t}\n\n\t\tawait SharingUtilities.updateItemPileSharingData(this.actor, pileSharingData);\n\n\t\tthis.refreshItems();\n\n\t\tHelpers.custom_notify(game.i18n.localize(\"ITEM-PILES.Notifications.UpdateItemPileSuccess\"));\n\n\t}\n\n\tasync depositCurrency() {\n\t\tconst result = await DropCurrencyDialog.show(this.recipient, this.actor, { localization: \"DepositCurrencies\" });\n\t\treturn this._addCurrency(result, this.recipient, this.actor);\n\t}\n\n\tasync withdrawCurrency() {\n\t\tconst result = await DropCurrencyDialog.show(this.actor, this.recipient, { localization: \"WithdrawCurrencies\" });\n\t\treturn this._addCurrency(result, this.actor, this.recipient);\n\t}\n\n\tasync addCurrency(recipient = false) {\n\t\tconst source = recipient || this.actor;\n\t\tconst target = recipient ? this.actor : false;\n\t\tconst result = await DropCurrencyDialog.show(source, target, {\n\t\t\tlocalization: !target ? \"EditCurrencies\" : false,\n\t\t\tunlimitedCurrencies: !target && game.user.isGM,\n\t\t\texistingCurrencies: PileUtilities.getActorCurrencies(source, { combine: true }),\n\t\t\tgetUpdates: !target\n\t\t});\n\t\treturn this._addCurrency(result, source, target);\n\t}\n\n\tasync _addCurrency(currencies, source, target = false) {\n\n\t\tif (!currencies) return;\n\n\t\tif (!target) {\n\n\t\t\tif (!game.user.isGM) return;\n\n\t\t\tif (!foundry.utils.isEmpty(currencies.attributes)) {\n\t\t\t\tawait game.itempiles.API.setAttributes(source, currencies.attributes, { interactionId: this.interactionId })\n\t\t\t}\n\t\t\tif (currencies.items.length) {\n\t\t\t\tconst itemsToAdd = currencies.items.filter(currency => currency.quantity > 0);\n\t\t\t\tconst itemsToRemove = currencies.items.filter(currency => currency.quantity < 0);\n\t\t\t\tawait game.itempiles.API.addItems(source, itemsToAdd, { interactionId: this.interactionId })\n\t\t\t\tawait game.itempiles.API.removeItems(source, itemsToRemove, { interactionId: this.interactionId })\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif (!foundry.utils.isEmpty(currencies.attributes)) {\n\t\t\t\tawait game.itempiles.API.transferAttributes(source, target, currencies.attributes, { interactionId: this.interactionId })\n\t\t\t}\n\t\t\tif (currencies.items.length) {\n\t\t\t\tawait game.itempiles.API.transferItems(source, target, currencies.items, { interactionId: this.interactionId })\n\t\t\t}\n\t\t}\n\n\t}\n\n\ttakeAll() {\n\t\tgame.itempiles.API.transferEverything(\n\t\t\tthis.actor,\n\t\t\tthis.recipient,\n\t\t\t{ interactionId: this.interactionId }\n\t\t);\n\t}\n\n\tsplitAll() {\n\t\treturn game.itempiles.API.splitItemPileContents(this.actor, { instigator: this.recipient });\n\t}\n\n\tcloseContainer() {\n\t\tif (!InterfaceTracker.isOpened(this.application.id)) {\n\t\t\treturn game.itempiles.API.closeItemPile(this.actor, this.recipient);\n\t\t}\n\t}\n\n\tsubscribeTo(target, callback) {\n\t\tthis.subscriptions.push(target.subscribe(callback));\n\t}\n\n\tunsubscribe() {\n\t\tthis.subscriptions.forEach(unsubscribe => unsubscribe());\n\t\tthis.subscriptions = [];\n\t}\n\n\tonDestroy() {\n\t\tthis.unsubscribe();\n\t\t__STORES__.delete(this.uuid);\n\t}\n}\n","<script>\r\n\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { fade } from 'svelte/transition';\r\n\timport ListGroupEntry from \"./ListGroupEntry.svelte\";\r\n\r\n\texport let store;\r\n\tconst numItems = store.numItems;\r\n\tconst categories = store.categories;\r\n\tconst itemsPerCategory = store.itemsPerCategory;\r\n\r\n</script>\r\n\r\n\r\n{#if $numItems > 0}\r\n\r\n\t<div in:fade|local={{duration: 150}}>\r\n\r\n\t\t{#each $categories as category (category.type)}\r\n\t\t\t<div class=\"item-group-type item-piles-flexrow\">\r\n\t\t\t\t<h3>{localize(category.label)}</h3>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"item-piles-items-list\">\r\n\t\t\t\t{#each $itemsPerCategory[category.type].items as item, index (item.identifier)}\r\n\t\t\t\t\t<ListGroupEntry {item} {index} {store}/>\r\n\t\t\t\t{/each}\r\n\t\t\t</div>\r\n\t\t{/each}\r\n\r\n\t</div>\r\n\r\n{/if}\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-group-type {\r\n    border-bottom: 1px solid rgba(0, 0, 0, 0.2);\r\n    margin: 0.5rem 0 0.25rem 0;\r\n    padding-right: 10px;\r\n    height: 1.5rem;\r\n    align-items: center;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\timport { getContext, onDestroy } from 'svelte';\r\n\timport { fade } from 'svelte/transition';\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { ApplicationShell } from '#runtime/svelte/component/core';\r\n\r\n\timport ItemList from \"./ItemList.svelte\";\r\n\timport CurrencyList from \"./CurrencyList.svelte\";\r\n\timport ActorPicker from \"../components/ActorPicker.svelte\";\r\n\r\n\timport * as SharingUtilities from \"../../helpers/sharing-utilities.js\";\r\n\timport * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n\timport PrivateAPI from \"../../API/private-api.js\";\r\n\timport ItemPileStore from \"../../stores/item-pile-store.js\";\r\n\timport CategorizedItemList from \"./CategorizedItemList.svelte\";\r\n\timport * as Helpers from \"../../helpers/helpers.js\";\r\n\timport { getSourceActorFromDropData } from \"../../helpers/utilities.js\";\r\n\timport { isItemValidBasedOnProperties } from \"../../helpers/pile-utilities.js\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let elementRoot;\r\n\texport let actor;\r\n\texport let recipient;\r\n\r\n\texport let store = ItemPileStore.make(application, actor, recipient);\r\n\r\n\t// Stores\r\n\tlet canBeSplit = false;\r\n\tlet num_players = 0;\r\n\tlet searchStore = store.search;\r\n\tlet editQuantities = store.editQuantities;\r\n\tlet pileData = store.pileData;\r\n\tlet deleted = store.deleted;\r\n\r\n\tconst items = store.allItems;\r\n\tconst currencies = store.currencies;\r\n\tconst numItems = store.numItems;\r\n\tconst shareData = store.shareData;\r\n\tconst numCurrencies = store.numCurrencies;\r\n\r\n\t$: isPileEmpty = $numItems === 0 && $numCurrencies === 0;\r\n\t$: hasItems = $numItems > 0;\r\n\t$: showSearchBar = $items.length >= 8;\r\n\t$: isContainer = PileUtilities.isItemPileContainer(actor, $pileData)\r\n\t$: {\r\n\t\t$shareData;\r\n\t\t$items;\r\n\t\t$currencies;\r\n\t\tcanBeSplit = SharingUtilities.canItemPileBeSplit(actor);\r\n\t\tnum_players = SharingUtilities.getPlayersForItemPile(actor).length;\r\n\t}\r\n\r\n\tasync function dropData(event) {\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\tlet data;\r\n\t\ttry {\r\n\t\t\tdata = JSON.parse(event.dataTransfer.getData('text/plain'));\r\n\t\t} catch (err) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (data.type === \"Actor\" && game.user.isGM) {\r\n\t\t\tconst newRecipient = data.uuid ? (await fromUuid(data.uuid)) : game.actors.get(data.id);\r\n\t\t\treturn store.updateRecipient(newRecipient)\r\n\t\t}\r\n\r\n\t\tif (data.type !== \"Item\") {\r\n\t\t\tHelpers.custom_warning(localize(\"ITEM-PILES.Warnings.DroppedIsNotItem\", { type: data.type }), true)\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst item = await Item.implementation.fromDropData(data);\r\n\t\tconst itemData = item.toObject();\r\n\r\n\t\tif (!itemData) {\r\n\t\t\tconsole.error(data);\r\n\t\t\tthrow Helpers.custom_error(\"Something went wrong when dropping this item!\")\r\n\t\t}\r\n\r\n\t\tif (!isItemValidBasedOnProperties(this.actor, itemData) && !game.user.isGM) {\r\n\t\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.VaultInvalidItemDropped\"), true)\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst source = getSourceActorFromDropData(data);\r\n\r\n\t\treturn PrivateAPI._dropItem({\r\n\t\t\tsource: source,\r\n\t\t\ttarget: store.actor,\r\n\t\t\titemData: {\r\n\t\t\t\titem: itemData, quantity: 1, uuid: data.uuid\r\n\t\t\t},\r\n\t\t\tskipCheck: true\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tfunction preventDefaultGM(event) {\r\n\t\tif (game.user.isGM) return;\r\n\t\tevent.preventDefault();\r\n\t}\r\n\r\n\tfunction preventDefault(event) {\r\n\t\tevent.preventDefault();\r\n\t}\r\n\r\n\tlet itemListElement;\r\n\tlet scrolled = false;\r\n\r\n\tfunction evaluateShadow() {\r\n\t\tscrolled = itemListElement.scrollTop > 20;\r\n\t}\r\n\r\n\tonDestroy(() => {\r\n\t\tstore.onDestroy();\r\n\t});\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<main in:fade={{duration: 500}}>\r\n\r\n\t\t<div class=\"item-piles-item-drop-container\" on:dragover={preventDefault} on:dragstart={preventDefaultGM}\r\n\t\t     on:drop={dropData}>\r\n\r\n\t\t\t{#if $deleted}\r\n\t\t\t\t<p style=\"text-align: center; flex: 0 1 auto;\">\r\n\t\t\t\t\t{localize(\"ITEM-PILES.Inspect.Destroyed\")}\r\n\t\t\t\t</p>\r\n\t\t\t{:else}\r\n\r\n\t\t\t\t<ActorPicker {store}/>\r\n\r\n\t\t\t\t{#if showSearchBar}\r\n\t\t\t\t\t<div class=\"form-group item-piles-flexrow item-piles-top-divider item-piles-bottom-divider\"\r\n\t\t\t\t\t     style=\"margin-bottom: 0.5rem; align-items: center;\" transition:fade={{duration: 250}}>\r\n\t\t\t\t\t\t<label style=\"flex:0 1 auto; margin-right: 5px;\">Search:</label>\r\n\t\t\t\t\t\t<input type=\"text\" bind:value={$searchStore}>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if isPileEmpty}\r\n\t\t\t\t\t<p class=\"item-piles-top-divider\" style=\"text-align: center; flex: 0 1 auto;\">\r\n\t\t\t\t\t\t{localize(\"ITEM-PILES.Inspect.Empty\")}\r\n\t\t\t\t\t</p>\r\n\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t<div class=\"item-piles-items-list\" bind:this={itemListElement} on:scroll={evaluateShadow}>\r\n\r\n\t\t\t\t\t{#if scrolled}\r\n\t\t\t\t\t\t<div class=\"item-pile-shadow scroll-shadow-top\" transition:fade={{duration:300}}></div>\r\n\t\t\t\t\t\t<div></div>\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t{#if $pileData.displayItemTypes}\r\n\t\t\t\t\t\t<CategorizedItemList {store}/>\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t<ItemList {store}/>\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t{#if hasItems}\r\n\t\t\t\t\t\t<hr>\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t<CurrencyList {store}/>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t{/if}\r\n\r\n\t\t\t<footer class=\"sheet-footer item-piles-flexrow item-piles-top-divider\">\r\n\t\t\t\t{#if editQuantities && !$deleted}\r\n\t\t\t\t\t<button type=\"button\" on:click={() => { store.update() }}>\r\n\t\t\t\t\t\t<i class=\"fas fa-save\"></i> {localize(\"ITEM-PILES.Applications.ItemPileConfig.Update\")}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if $pileData.splitAllEnabled && !$deleted}\r\n\t\t\t\t\t<button type=\"button\" on:click={() => { store.splitAll() }} disabled=\"{isPileEmpty || !canBeSplit}\"\r\n\t\t\t\t\t        data-tooltip={num_players === 0 && !isPileEmpty ? localize(\"ITEM-PILES.Inspect.SplitNoPlayers\") : \"\"}>\r\n\t\t\t\t\t\t<i class=\"fas fa-handshake\"></i>\r\n\t\t\t\t\t\t{#if $pileData.shareItemsEnabled}\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Inspect.SplitAll\", { num_players })}\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Inspect.SplitCurrencies\", { num_players })}\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if store.recipient && $pileData.takeAllEnabled && !$deleted}\r\n\t\t\t\t\t<button type=\"submit\" on:click={() => { store.takeAll() }} disabled=\"{isPileEmpty}\">\r\n\t\t\t\t\t\t<i class=\"fas fa-fist-raised\"></i> {localize(\"ITEM-PILES.Inspect.TakeAll\")}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if isContainer && !application.options.remote && !$deleted}\r\n\t\t\t\t\t<button type=\"submit\" on:click={() => { store.closeContainer(); application.close(); }}>\r\n\t\t\t\t\t\t<i class=\"fas fa-box\"></i> {localize(\"ITEM-PILES.Inspect.Close\")}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t<button on:click={() => { application.close() }} type=\"submit\">\r\n\t\t\t\t\t<i class=\"fas fa-sign-out-alt\"></i> {localize(\"ITEM-PILES.Inspect.Leave\")}\r\n\t\t\t\t</button>\r\n\t\t\t</footer>\r\n\r\n\t\t</div>\r\n\r\n\t</main>\r\n\r\n</ApplicationShell>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-items-list {\r\n    max-height: 500px;\r\n    overflow-y: auto;\r\n    display: block;\r\n    padding-right: 5px;\r\n\r\n    .item-pile-shadow {\r\n\r\n      position: absolute;\r\n      width: calc(100% - 1rem);\r\n      height: 50px;\r\n      z-index: 25;\r\n      pointer-events: none;\r\n      border-radius: 5px;\r\n\r\n      &.scroll-shadow-top {\r\n        box-shadow: inset 0px 22px 15px -14px rgba(0, 0, 0, 0.5);\r\n      }\r\n\r\n    }\r\n\r\n    .item-piles-add-currency {\r\n      margin-right: 5px;\r\n      flex: 0 1 auto;\r\n      vertical-align: middle;\r\n    }\r\n\r\n  }\r\n\r\n  #item-piles-preview-container {\r\n\r\n    position: absolute;\r\n    display: inline-block;\r\n\r\n    #item-piles-preview-image {\r\n      border: 0;\r\n      width: 300px;\r\n      border-radius: 1rem;\r\n      box-shadow: rgba(0, 0, 0, 0.25) 0px 54px 55px, rgba(0, 0, 0, 0.12) 0px -12px 30px, rgba(0, 0, 0, 0.12) 0px 4px 6px, rgba(0, 0, 0, 0.17) 0px 12px 13px, rgba(0, 0, 0, 0.09) 0px -3px 5px;\r\n    }\r\n  }\r\n\r\n  .hidden {\r\n    display: none;\r\n  }\r\n\r\n  .item-piles-img-container {\r\n    min-height: 25px;\r\n    max-width: 25px;\r\n    max-height: 25px;\r\n    margin: 2px;\r\n  }\r\n</style>\r\n","<script>\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\r\n\texport let activeTab;\r\n\texport let tabs;\r\n\texport let underscore = false;\r\n\texport let separateElements = false;\r\n\r\n\tfunction clicked(tab) {\r\n\t\tactiveTab = tab.value;\r\n\t\tif (tab.callback) {\r\n\t\t\ttab.callback(tab);\r\n\t\t}\r\n\t}\r\n\r\n</script>\r\n\r\n<nav class=\"tabs\" data-group=\"primary\" style={$$props.style}>\r\n\t{#each tabs.filter(tab => !tab.hidden) as tab, index (tab.value)}\r\n\t\t{#if separateElements && index > 0}\r\n\t\t\t<div style=\"border-right: 1px solid rgba(0,0,0,0.5); margin: 0 10px;\"></div>\r\n\t\t{/if}\r\n\t\t<div on:click={() => { clicked(tab) }}\r\n\t\t     class=\"item item-piles-flexrow item-piles-clickable-link\"\r\n\t\t     class:underscore={underscore}\r\n\t\t     class:active={activeTab === tab.value}\r\n\t\t     data-tab=\"rest\">\r\n\t\t\t{#if tab.icon} <i class=\"icon {tab.icon}\"></i> {/if}\r\n\t\t\t{localize(tab.label)}\r\n\t\t\t{#if tab.highlight}\r\n\t\t\t\t<div class=\"blob\"><i class=\"fas fa-exclamation\"></i></div>\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\t{/each}\r\n</nav>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .tabs {\r\n    border-bottom: 1px solid rgba(0, 0, 0, 0.25);\r\n    margin-bottom: 0.5rem;\r\n    padding-bottom: 0.5rem;\r\n  }\r\n\r\n  .item {\r\n    display: flex;\r\n    flex-direction: row;\r\n    align-items: center;\r\n    border-bottom: 2px solid transparent;\r\n\r\n    &.active {\r\n      text-shadow: 0 0 10px var(--item-piles-shadow-primary);\r\n\r\n      &.underscore {\r\n        text-shadow: none;\r\n        border-bottom: 2px solid rgba(125, 0, 0, 0.5);\r\n      }\r\n    }\r\n  }\r\n\r\n  .icon {\r\n    margin-right: 0.25rem;\r\n  }\r\n\r\n</style>\r\n","import { isObject } from '@typhonjs-fvtt/runtime/util/object';\n\n/**\r\n * Provides a helper class to determine the version of the Foundry platform starting a version `9`.\r\n *\r\n * Note: You must use any of these utility methods after the Foundry `init` hook.\r\n */\r\nclass FVTTVersion\r\n{\r\n   static #regexMajorVersion = /(\\d+)\\./;\r\n\r\n   /**\r\n    * Returns true when Foundry is at least the specific major version number provided.\r\n    *\r\n    * @param {number}   version - Major version to check against.\r\n    *\r\n    * @returns {boolean} Foundry version is at least the major version specified.\r\n    */\r\n   static isAtLeast(version)\r\n   {\r\n      if (!Number.isInteger(version) && version < 9)\r\n      {\r\n         throw new TypeError(`'version' is not a positive integer greater than or equals '9'.`);\r\n      }\r\n\r\n      return !globalThis.foundry.utils.isNewerVersion(version, globalThis.game.version ??\r\n       globalThis.game?.data?.version);\r\n   }\r\n\r\n   /**\r\n    * Returns true when Foundry is between the min / max major version numbers provided.\r\n    *\r\n    * @param {number}   min - Major minimum version to check against.\r\n    *\r\n    * @param {number}   max - Major maximum version to check against.\r\n    *\r\n    * @returns {boolean} Foundry version is at least the major version specified.\r\n    */\r\n   static isBetween(min, max)\r\n   {\r\n      if (!Number.isInteger(min) && min < 9)\r\n      {\r\n         throw new TypeError(\r\n          `FVTTVersion.isBetween error: 'min' is not a positive integer greater than or equals '9'.`);\r\n      }\r\n\r\n      if (!Number.isInteger(max) && max < 9)\r\n      {\r\n         throw new TypeError(\r\n          `FVTTVersion.isBetween error: 'max' is not a positive integer greater than or equals '9'.`);\r\n      }\r\n\r\n      if (min > max)\r\n      {\r\n         throw new TypeError(`FVTTVersion.isBetween error: 'min' is greater than 'max'.`);\r\n      }\r\n\r\n      const match = this.#regexMajorVersion.exec(globalThis.game.version ?? globalThis.game?.data?.version);\r\n      if (!match)\r\n      {\r\n         throw new Error(`FVTTVersion.isBetween error: Could not parse 'globalThis.game.version'.`);\r\n      }\r\n\r\n      const version = parseInt(match[1], 10);\r\n\r\n      return version >= min && version <= max;\r\n   }\r\n}\n\n/**\r\n * Loads FVTT core fonts supporting `FontConfig` on Foundry v10+.\r\n *\r\n * Note: This class contains code modified from Foundry VTT core client code. There are only so many ways to process\r\n * core Foundry data structures correctly.\r\n */\r\nclass FontManager\r\n{\r\n   /**\r\n    * Collect all the font definitions and combine them.\r\n    *\r\n    * @returns { {[key: string]: globalThis.FontFamilyDefinition}[] } Core font definitions.\r\n    */\r\n   static getCoreDefinitions()\r\n   {\r\n      /** @type { {[key: string]: globalThis.FontFamilyDefinition}[] } */\r\n      const fonts = [];\r\n\r\n      if (FVTTVersion.isAtLeast(10))\r\n      {\r\n         let legacyFamilies;\r\n\r\n         /**\r\n          * @deprecated since v10, so check that it exists.\r\n          */\r\n         if (Array.isArray(globalThis.CONFIG?._fontFamilies))\r\n         {\r\n            legacyFamilies = globalThis.CONFIG._fontFamilies.reduce((obj, f) =>\r\n            {\r\n               obj[f] = { editor: true, fonts: [] };\r\n               return obj;\r\n            }, {});\r\n         }\r\n\r\n         if (Array.isArray(globalThis.CONFIG?.fontDefinitions))\r\n         {\r\n            fonts.push(globalThis.foundry.utils.duplicate(globalThis.CONFIG.fontDefinitions));\r\n         }\r\n\r\n         const coreFonts = globalThis.game?.settings.get('core', 'fonts');\r\n         if (Array.isArray(coreFonts))\r\n         {\r\n            fonts.push(globalThis.foundry.utils.duplicate(coreFonts));\r\n         }\r\n\r\n         if (legacyFamilies) { fonts.push(legacyFamilies); }\r\n      }\r\n      else\r\n      {\r\n         if (Array.isArray(globalThis.CONFIG?.fontFamilies))\r\n         {\r\n            // Handle v9 and below legacy font families.\r\n            const legacyFamilies = globalThis.CONFIG.fontFamilies.reduce((obj, f) =>\r\n            {\r\n               obj[f] = { editor: true, fonts: [] };\r\n               return obj;\r\n            }, {});\r\n\r\n            fonts.push(legacyFamilies);\r\n         }\r\n      }\r\n\r\n      FontManager.removeDuplicateDefinitions(fonts);\r\n\r\n      return fonts;\r\n   }\r\n\r\n   /**\r\n    * Load a font definition.\r\n    *\r\n    * @param {string}               fontSpecification - The font specification.\r\n    *\r\n    * @param {string}               family - The font family name (case-sensitive).\r\n    *\r\n    * @param {globalThis.FontFamilyDefinition} definition - The font family definition.\r\n    *\r\n    * @param {Document}             document - Target Document to load font into.\r\n    *\r\n    * @returns {Promise<boolean>} Returns true if the font was successfully loaded.\r\n    */\r\n   static async #loadFont(fontSpecification, family, definition, document)\r\n   {\r\n      try\r\n      {\r\n         for (const fontEntry of definition.fonts)\r\n         {\r\n            // Collect URLs from FontDefinition.\r\n            const urls = fontEntry.urls.map((url) => `url(\"${url}\")`).join(', ');\r\n\r\n            // Note: 'font' contains 'FontFaceDescriptors' data.\r\n            const fontFace = new FontFace(family, urls, fontEntry);\r\n            await fontFace.load();\r\n\r\n            document.fonts.add(fontFace);\r\n         }\r\n\r\n         await document.fonts.load(fontSpecification);\r\n      }\r\n      catch (err)\r\n      {\r\n         console.warn(`Font family \"${family}\" failed to load: `, err);\r\n         return false;\r\n      }\r\n\r\n      if (!document.fonts.check(fontSpecification))\r\n      {\r\n         console.warn(`Font family \"${family}\" failed to load.`);\r\n         return false;\r\n      }\r\n\r\n      return true;\r\n   }\r\n\r\n   /**\r\n    * Ensure that fonts have loaded and are ready for use.\r\n    * Enforce a maximum timeout in milliseconds.\r\n    * Proceed after that point even if fonts are not yet available.\r\n    *\r\n    * @param {object} [opts] - Optional parameters.\r\n    *\r\n    * @param {number} [opts.ms=4500] - The maximum time to spend loading fonts before proceeding.\r\n    *\r\n    * @param {Document} [opts.document] - The target document to load the fonts into.\r\n    *\r\n    * @param {boolean} [opts.editor=true] - When true verifies the `editor` field of {@link FontFamilyDefinition}.\r\n    *\r\n    * @param {(\r\n    *    {[key: string]: globalThis.FontFamilyDefinition}[] |\r\n    *    {[key: string]: globalThis.FontFamilyDefinition}\r\n    * )} [opts.fonts] - A custom set of font family definitions to load. If not defined the core font family definitions\r\n    *    are loaded.\r\n    *\r\n    * @returns {Promise<void>}\r\n    */\r\n   static async loadFonts({ ms = 4500, document = globalThis.document, editor = true, fonts } = {})\r\n   {\r\n      // TODO sanity checks\r\n\r\n      const allFonts = fonts ? Array.isArray(fonts) ? fonts : [fonts] : this.getCoreDefinitions();\r\n\r\n      const promises = [];\r\n\r\n      for (const definitions of allFonts)\r\n      {\r\n         if (isObject(definitions))\r\n         {\r\n            for (const [family, definition] of Object.entries(definitions))\r\n            {\r\n               // Don't load a font that is not marked to be used in the editor.\r\n               if (editor && (typeof definition.editor !== 'boolean' || !definition.editor)) { continue; }\r\n\r\n               const fontSpecification = `1rem \"${family}\"`;\r\n\r\n               // Early out if the font is already loaded.\r\n               if (document.fonts.check(fontSpecification)) { continue; }\r\n\r\n               promises.push(this.#loadFont(fontSpecification, family, definition, document));\r\n            }\r\n         }\r\n      }\r\n\r\n      const timeout = new Promise((resolve) => setTimeout(resolve, ms));\r\n      const ready = Promise.all(promises).then(() => document.fonts.ready);\r\n\r\n      return Promise.race([ready, timeout]);\r\n   }\r\n\r\n   /**\r\n    * Removes duplicate font definitions.\r\n    *\r\n    * @param { {[key: string]: globalThis.FontFamilyDefinition}[] }  fonts - An array of FontFamilyDefinition objects\r\n    *        to process.\r\n    *\r\n    * @returns { {[key: string]: globalThis.FontFamilyDefinition}[] } Filtered font definitions.\r\n    */\r\n   static removeDuplicateDefinitions(fonts)\r\n   {\r\n      if (!Array.isArray(fonts))\r\n      {\r\n         throw new TypeError(`FontManager.removeDuplicateDefinitions error: 'fonts' is not an array.`);\r\n      }\r\n\r\n      const familySet = new Set();\r\n\r\n      for (const definitions of fonts)\r\n      {\r\n         if (!isObject(definitions))\r\n         {\r\n            throw new TypeError(`FontManager.removeDuplicateDefinitions error: 'definitions' is not an object.`);\r\n         }\r\n\r\n         for (const family of Object.keys(definitions))\r\n         {\r\n            // Remove duplicate from current definitions set.\r\n            if (familySet.has(family))\r\n            {\r\n               delete definitions[family];\r\n            }\r\n            else\r\n            {\r\n               familySet.add(family);\r\n            }\r\n         }\r\n      }\r\n\r\n      return fonts;\r\n   }\r\n}\n\n/**\r\n * Parses the core Foundry style sheet creating an indexed object of properties by selector.\r\n */\r\nclass FoundryStyles\r\n{\r\n   static #sheet = void 0;\r\n\r\n   /** @type {Map<string, {[key: string]: string}>} */\r\n   static #sheetMap = new Map();\r\n\r\n   static #initialized = false;\r\n\r\n   /**\r\n    * Called once on initialization / first usage. Parses the core foundry style sheet.\r\n    */\r\n   static #initialize()\r\n   {\r\n      this.#initialized = true;\r\n\r\n      const styleSheets = Array.from(document.styleSheets).filter((entry) => entry.href !== null);\r\n\r\n      let sheet;\r\n\r\n      const foundryStyleSheet = globalThis.foundry.utils.getRoute('/css/style.css');\r\n\r\n      // Find the core Foundry stylesheet.\r\n      for (const styleSheet of styleSheets)\r\n      {\r\n         let url;\r\n\r\n         try\r\n         {\r\n            url = new URL(styleSheet.href);\r\n         }\r\n         catch (err) { continue; }\r\n\r\n         if (typeof url.pathname === 'string' && url.pathname === foundryStyleSheet)\r\n         {\r\n            this.#sheet = sheet = styleSheet;\r\n            break;\r\n         }\r\n      }\r\n\r\n      // Quit now if the Foundry style sheet was not found.\r\n      if (!sheet) { return; }\r\n\r\n      // Parse each CSSStyleRule and build the map of selectors to parsed properties.\r\n      for (const rule of sheet.cssRules)\r\n      {\r\n         if (!(rule instanceof CSSStyleRule)) { continue; }\r\n\r\n         const obj = {};\r\n\r\n         // Parse `cssText` into an object of properties & values.\r\n         for (const entry of rule.style.cssText.split(';'))\r\n         {\r\n            const parts = entry.split(':');\r\n\r\n            // Sanity check.\r\n            if (parts.length < 2) { continue; }\r\n\r\n            obj[parts[0].trim()] = parts[1].trim();\r\n         }\r\n\r\n         this.#sheetMap.set(rule.selectorText, obj);\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Gets the properties object associated with the selector. Try and use a direct match otherwise all keys\r\n    * are iterated to find a selector string that includes the `selector`.\r\n    *\r\n    * @param {string}   selector - Selector to find.\r\n    *\r\n    * @returns { {[key: string]: string} } Properties object.\r\n    */\r\n   static getProperties(selector)\r\n   {\r\n      if (!this.#initialized) { this.#initialize(); }\r\n\r\n      // If there is a direct selector match then return a value immediately.\r\n      if (this.#sheetMap.has(selector))\r\n      {\r\n         return this.#sheetMap.get(selector);\r\n      }\r\n\r\n      for (const key of this.#sheetMap.keys())\r\n      {\r\n         if (key.includes(selector)) { return this.#sheetMap.get(key); }\r\n      }\r\n\r\n      return void 0;\r\n   }\r\n\r\n   /**\r\n    * Gets a specific property value from the given `selector` and `property` key. Try and use a direct selector\r\n    * match otherwise all keys are iterated to find a selector string that includes `selector`.\r\n    *\r\n    * @param {string}   selector - Selector to find.\r\n    *\r\n    * @param {string}   property - Specific property to locate.\r\n    *\r\n    * @returns {string|undefined} Property value.\r\n    */\r\n   static getProperty(selector, property)\r\n   {\r\n      if (!this.#initialized) { this.#initialize(); }\r\n\r\n      // If there is a direct selector match then return a value immediately.\r\n      if (this.#sheetMap.has(selector))\r\n      {\r\n         const data = this.#sheetMap.get(selector);\r\n         return isObject(data) && property in data ? data[property] : void 0;\r\n      }\r\n\r\n      for (const key of this.#sheetMap.keys())\r\n      {\r\n         if (key.includes(selector))\r\n         {\r\n            const data = this.#sheetMap.get(key);\r\n            if (isObject(data) && property in data) { return data[property]; }\r\n         }\r\n      }\r\n\r\n      return void 0;\r\n   }\r\n}\n\nexport { FVTTVersion, FontManager, FoundryStyles };\n//# sourceMappingURL=index.js.map\n","import { TJSStyleManager } from '@typhonjs-fvtt/runtime/util/browser';\r\n\r\nexport const cssVariables = new TJSStyleManager({ docKey: '#__tjs-root-styles', version: 1 });\r\n","import { clamp } from '@typhonjs-fvtt/runtime/math/util';\n\n/**\r\n * Provides helper utilities to manipulate the PM editor view for various options from TJSProseMirror component.\r\n */\r\nclass PMImpl\r\n{\r\n   /**\r\n    * Handles `options.initialSelection`: Sets the initial cursor / selection range to the start, end, or selects\r\n    * all text.\r\n    *\r\n    * @param {globalThis.EditorView}  view - PM editor view.\r\n    *\r\n    * @param {object}  options - TJSProseMirror options.\r\n    */\r\n   static setInitialSelection(view, options)\r\n   {\r\n      const tr = view.state.tr;\r\n      const doc = tr.doc;\r\n\r\n      const initialSelection = options.initialSelection;\r\n\r\n      const type = initialSelection === 'all' || initialSelection === 'end' || initialSelection === 'start' ?\r\n       initialSelection : 'start';\r\n\r\n      const minPos = globalThis.ProseMirror.TextSelection.atStart(doc).from;\r\n      const maxPos = globalThis.ProseMirror.TextSelection.atEnd(doc).to;\r\n\r\n      let transaction;\r\n\r\n      switch (type)\r\n      {\r\n         case 'all':\r\n         {\r\n            const resolvedFrom = clamp(0, minPos, maxPos);\r\n            const resolvedEnd = clamp(doc.content.size, minPos, maxPos);\r\n            transaction = tr.setSelection(globalThis.ProseMirror.TextSelection.create(doc, resolvedFrom, resolvedEnd));\r\n            break;\r\n         }\r\n\r\n         case 'end':\r\n         {\r\n            const resolvedFrom = clamp(doc.content.size, minPos, maxPos);\r\n            const resolvedEnd = clamp(doc.content.size, minPos, maxPos);\r\n            transaction = tr.setSelection(globalThis.ProseMirror.TextSelection.create(doc, resolvedFrom, resolvedEnd));\r\n            break;\r\n         }\r\n\r\n         case 'start':\r\n         {\r\n            const resolvedFrom = clamp(0, minPos, maxPos);\r\n            const resolvedEnd = clamp(0, minPos, maxPos);\r\n            transaction = tr.setSelection(globalThis.ProseMirror.TextSelection.create(doc, resolvedFrom, resolvedEnd));\r\n            break;\r\n         }\r\n      }\r\n\r\n      if (transaction)\r\n      {\r\n         transaction.scrollIntoView();\r\n\r\n         view.dispatch(transaction);\r\n      }\r\n   }\r\n}\n\nexport { PMImpl };\n//# sourceMappingURL=index.js.map\n","// Protect for absent global `ProseMirror` on Foundry v9.\r\nconst ProseMirrorKeyMaps = globalThis.ProseMirror ? globalThis.ProseMirror.ProseMirrorKeyMaps : class {};\r\n\r\n/**\r\n * Provides an additional key mapping to `Escape` to destroy / cancel the active editor.\r\n */\r\nclass TJSKeyMaps extends ProseMirrorKeyMaps\r\n{\r\n   /** @type {Function} */\r\n   #onQuit;\r\n\r\n   /**\r\n    * @param {globalThis.Schema}   schema - The ProseMirror schema to build keymaps for.\r\n    *\r\n    * @param {object}   [options] - Additional options to configure the plugin's behaviour.\r\n    *\r\n    * @param {Function} [options.onSave] - A function to call when Ctrl+S is pressed.\r\n    *\r\n    * @param {Function} [options.onQuit] - A function to call when Ctrl+Q is pressed.\r\n    */\r\n   constructor(schema, options)\r\n   {\r\n      super(schema, options);\r\n\r\n      if (typeof options.onQuit === 'function') { this.#onQuit = options.onQuit; }\r\n   }\r\n\r\n   // eslint-disable-next jsdoc/check-types\r\n   /**\r\n    * Swaps the Foundry default `Escape` / selectParentNode to `Mod-p` and enables `onQuit` function for `Escape`.\r\n    *\r\n    * @returns { {[key: string]: globalThis.ProseMirrorCommand} } ProseMirror keymap data.\r\n    */\r\n   buildMapping()\r\n   {\r\n      const mapping = super.buildMapping();\r\n\r\n      // Add onQuit callback if defined.\r\n      if (this.#onQuit)\r\n      {\r\n         // Swap Foundry core mapping for `Escape` / selectParentNode to `Mod-p`.\r\n         if (mapping['Escape']) { mapping['Mod-p'] = mapping['Escape']; }\r\n\r\n         mapping['Escape'] = () => this.#onQuit();\r\n      }\r\n\r\n      return mapping;\r\n   }\r\n}\n\n// Protect for absent global `ProseMirror` on Foundry v9.\r\nconst Plugin = globalThis.ProseMirror ? globalThis.ProseMirror.Plugin : class {};\r\n\r\n/**\r\n * A ProseMirror plugin to transform pasted text that is a raw document UUID into a document link suitable for\r\n * `TextEditor.enrichHTML`.\r\n */\r\nclass TJSPasteUUID\r\n{\r\n   /**\r\n    * Defines a regex to check for the shape of a raw Foundry document UUID.\r\n    *\r\n    * @type {RegExp}\r\n    */\r\n   static #s_UUID_REGEX = /(\\.).*([a-zA-Z0-9]{16})/;\r\n\r\n   /**\r\n    * @returns {Plugin<any>} PM Plugin.\r\n    */\r\n   static build()\r\n   {\r\n      const instance = new this();\r\n      return new Plugin({\r\n         // key: new PluginKey('tjsPasteRawUUID'), // TODO: Add back when exported by Foundry / ProseMirror bundle.\r\n         props: {\r\n            transformPastedText: (text) => instance.#transformUUID(text)\r\n         }\r\n      });\r\n   }\r\n\r\n   /**\r\n    * Transforms pasted text. Check if pasted test matches the shape of a raw UUID. If so do a lookup and if a\r\n    * document is retrieved transform it to a document link.\r\n    *\r\n    * @param {string}   text - pasted text to transform.\r\n    *\r\n    * @returns {string} Potentially transformed pasted text.\r\n    */\r\n   #transformUUID(text)\r\n   {\r\n      if (typeof text === 'string')\r\n      {\r\n         if (TJSPasteUUID.#s_UUID_REGEX.test(text))\r\n         {\r\n            const uuidDoc = globalThis.fromUuidSync(text);\r\n            if (uuidDoc)\r\n            {\r\n               text = `@UUID[${text}]{${typeof uuidDoc.name === 'string' ? uuidDoc.name : 'Unknown'}}`;\r\n            }\r\n         }\r\n      }\r\n\r\n      return text;\r\n   }\r\n}\n\nexport { TJSKeyMaps, TJSPasteUUID };\n//# sourceMappingURL=index.js.map\n","<script>\r\n   /**\r\n    * Provides a reactive wrapper for Foundry ProseMirror editor support. Allows editing Foundry document data or\r\n    * directly from content prop. Automatic HTML enrichment occurs for the content when saved.\r\n    *\r\n    * There are no required props, but the following are available to set.\r\n    * `content` - Provides an initial content string; you can bind to `content` from a parent component to get reactive\r\n    *             updates when `content` changes. Two-way binding.\r\n    *\r\n    * `enrichedContent` - Provides the enriched content via {@link TextEditor.enrichHTML} when `content` changes.\r\n    *             You can bind to `enrichedContent` from a parent component to get reactive updates though it is not\r\n    *             recommended to change `enrichedContent` externally. One-way binding.\r\n    *\r\n    * `options` - Defines the options object for this component and passed on to the Foundry TinyMCE support.\r\n    *             Please review all the options defined below {@link TJSProseMirrorOptions}.\r\n    *\r\n    *\r\n    * Notable options passed onto Foundry ProseMirror support.\r\n    * ---------------------------------\r\n    *\r\n    * `options.collaborate` - [boolean: false] When a `document` and `fieldName` is provided set this to true to enable\r\n    *                         collaborative editing.\r\n    *\r\n    * `options.plugins` - [object] An additional set of ProseMirror plugins to load.\r\n    *\r\n    *\r\n    * Events: There are three events fired when the editor is canceled, saved, and started.\r\n    * ---------------------------------\r\n    * `editor:cancel` - Fired when editing is canceled by a user action or reactive response to document changes.\r\n    *\r\n    * `editor:document:deleted` - Fired when the edited document is deleted. Access the document from\r\n    *                             `event.detail.document`.\r\n    *\r\n    * `editor:enrichedContent` - Fired when content is enriched. Access enriched content from\r\n    *                            `event.detail.enrichedContent`.\r\n    *\r\n    * `editor:save` - Fired when editing is saved. Access the content from `event.detail.content`.\r\n    *\r\n    * `editor:start` - Fired when editing is started.\r\n    *\r\n    * The following CSS variables control the associated styles with the default values.\r\n    *\r\n    * `.editor` HTMLDivElement:\r\n    * ---------------------------------\r\n    * --tjs-editor-background - none\r\n    * --tjs-editor-border - none\r\n    * --tjs-editor-border-radius - 0\r\n    * --tjs-editor-height - 100%\r\n    * --tjs-editor-margin - 0\r\n    * --tjs-editor-overflow - auto\r\n    * --tjs-editor-transition\r\n    * --tjs-editor-width - 100%\r\n    *\r\n    * `.editor` HTMLDivElement; properties available when activated:\r\n    * ---------------------------------\r\n    * --tjs-editor-active-box-shadow, unset; Foundry default: 0 0 5px var(--color-shadow-primary)\r\n    * --tjs-editor-active-outline - unset\r\n    * --tjs-editor-active-overflow - unset; When inactive the editor overflow is auto; when active overflow is unset.\r\n    *\r\n    * `.editor` HTMLDivElement; properties available when inactive, but manually focused:\r\n    * ---------------------------------\r\n    * --tjs-editor-inactive-box-shadow-focus-visible - fallback: --tjs-default-box-shadow-focus-visible\r\n    * --tjs-editor-inactive-outline-focus-visible - fallback: --tjs-default-outline-focus-visible; default: revert\r\n    * --tjs-editor-inactive-transition-focus-visible - fallback: --tjs-default-transition-focus-visible\r\n    *\r\n    * `.editor` HTMLDivElement; properties available when inactive, but hovered:\r\n    * ---------------------------------\r\n    * --tjs-editor-inactive-cursor-hover - text\r\n    * --tjs-editor-inactive-box-shadow-hover - unset\r\n    * --tjs-editor-inactive-outline-hover - unset\r\n    * --tjs-editor-inactive-user-select-hover - text\r\n    *\r\n    * `.editor-content` HTMLDivElement; when editing - the content overflow is set to auto:\r\n    * ---------------------------------\r\n    * --tjs-editor-content-overflow - auto\r\n    * --tjs-editor-content-padding - 0 0 0 0.25em\r\n    *\r\n    * `.editor-container` HTMLDivElement; when editing - removes default margins.\r\n    * ---------------------------------\r\n    * --tjs-editor-container-margin - 0\r\n    *\r\n    * .editor-edit; Defines the position of the edit button from top / right absolute positioning:\r\n    * ---------------------------------\r\n    * --tjs-editor-edit-button-right - 5px\r\n    * --tjs-editor-edit-button-top - 0\r\n    *\r\n    * .editor-menu; Defines the toolbar / menu.\r\n    * ---------------------------------\r\n    * --tjs-editor-toolbar-background - rgba(0, 0, 0, 0.1)\r\n    * --tjs-editor-toolbar-border-radius - 6px\r\n    * --tjs-editor-toolbar-box-shadow - 0 2px 2px -2px rgb(34 47 62 / 10%), 0 8px 8px -4px rgb(34 47 62 / 7%)\r\n    * --tjs-editor-toolbar-padding - 2px 0\r\n    * --tjs-editor-toolbar-width - 100%\r\n    */\r\n\r\n   /**\r\n    * @typedef {object} TJSProseMirrorOptions\r\n    *\r\n    * @property {boolean}   [button=true] Provides an edit button to start editing. When button is false editing is\r\n    * always enabled.\r\n    *\r\n    * @property {string[]}  [classes] An array of strings to add to the `.editor` element classes. This allows easier\r\n    * setting of CSS variables across a range of various editor components.\r\n    *\r\n    * @property {boolean}   [clickToEdit=false] When true the edit button is not shown and a click on the editor\r\n    * content initializes the editor.\r\n    *\r\n    * @property {boolean}   [collaborate=false] Enables ProseMirror collaboration; requires a document to be set.\r\n    *\r\n    * @property {foundry.abstract.Document}   [document] Set to a Foundry document to load and save content from it.\r\n    * Requires `fieldName` to be set.\r\n    *\r\n    * @property {{ sanitizeWithVideo: function }}   [DOMPurify] The DOMPurify export from\r\n    * `@typhonjs-fvtt/runtime/security/client/dompurify`. Sanitizes content client side. Note: TinyMCE already does essential\r\n    * `<script>` sanitization, so this is just an extra option that is available as an extra precaution.\r\n    *\r\n    * @property {boolean}   [editable=true] Prevents editing and hides button. When set to false any active editor\r\n    * is cancelled.\r\n    *\r\n    * @property {boolean}   [enrichContent=true] When set to false content won't be enriched by `TextEditor.enrichHTML`.\r\n    *\r\n    * @property {string}    [fieldName] A field name to load and save to / from associated document. IE `a.b.c`.\r\n    *\r\n    * @property {'all'|'end'|'start'}   [initialSelection='start'] Initial selection range; 'all', 'end' or 'start'.\r\n    *\r\n    * @property {string}    [keyCode='Enter'] Defines the key event code to activate the editor when focused.\r\n    *\r\n    * @property {Object<string, string>}   [styles] Additional CSS property names and values to set as inline styles.\r\n    * This is useful for dynamically overriding any built in styles and in particular setting CSS variables supported.\r\n    */\r\n\r\n   /**\r\n    * The following options that both {@link TJSTinyMCE} and {@link TJSContentEdit} support likely won't be implemented\r\n    * for the ProseMirror component as they involve significant effort in modifying ProseMirror which is not trivial at\r\n    * all without potentially weeks of work or entirely replacing the built-in Foundry ProseMirror toolbar / support.\r\n    *\r\n    * // @property {Object<FontFamilyDefinition>}    [fonts] An additional object defining module / custom fonts to\r\n    * // load specific to this editor.\r\n    *\r\n    * // @property {number}    [maxCharacterLength] When defined as an integer greater than 0 this limits the max\r\n    * // characters that can be entered.\r\n    *\r\n    * // @property {boolean}   [preventEnterKey=false] When true this prevents enter key from creating a new line /\r\n    * // paragraph.\r\n    *\r\n    * // @property {boolean}   [preventPaste=false] Prevents pasting content into the editor.\r\n    *\r\n    * // @property {boolean}   [saveOnBlur=false] When true any loss of focus / blur from the editor saves the editor\r\n    * // state.\r\n    *\r\n    * // @property {boolean}   [saveOnEnterKey=false] When true saves the editor state when the enter key is pressed.\r\n    * // This is useful when configuring the editor for single line entry.\r\n    */\r\n\r\n   /**\r\n    * @typedef {object} PMEditorExtra Defines extra data passed to TJSEditorOptions ProseMirror plugin.\r\n    *\r\n    * @property {string} initialSelectionDefault The default value if `options.initialSelection is not defined.\r\n    */\r\n\r\n   import {\r\n      createEventDispatcher,\r\n      onDestroy,\r\n      onMount,\r\n      tick\r\n   }                        from 'svelte';\r\n\r\n   import { applyStyles }   from '@typhonjs-fvtt/runtime/svelte/action/dom';\r\n   import { TJSDocument }   from '@typhonjs-fvtt/runtime/svelte/store/fvtt/document';\r\n   import { isObject }      from '@typhonjs-fvtt/runtime/util/object';\r\n\r\n   import { PMImpl }        from '@typhonjs-fvtt/svelte-standard/prosemirror';\r\n   import * as Plugins  \tfrom '@typhonjs-fvtt/svelte-standard/prosemirror/plugins';\r\n\r\n   /** @type {string} */\r\n   export let content = '';\r\n\r\n   /** @type {string} */\r\n   export let enrichedContent = '';\r\n\r\n   /**\r\n    * Provides the options object that can be reactively updated. See documentation above.\r\n    *\r\n    * @type {TJSProseMirrorOptions}\r\n    */\r\n   export let options = {};\r\n\r\n   const dispatch = createEventDispatcher();\r\n\r\n   // Provides reactive updates for any associated Foundry document.\r\n   const doc = new TJSDocument({ delete: onDocumentDeleted });\r\n\r\n   /** @type {boolean} */\r\n   let clickToEdit;\r\n\r\n   /** @type {boolean} */\r\n   let editable = true;\r\n\r\n   /** @type {HTMLDivElement} */\r\n   let editorContentEl;\r\n\r\n   /** @type {ProseMirrorEditor} */\r\n   let editor;\r\n\r\n   /** @type {boolean} */\r\n   let editorActive = false;\r\n\r\n   /** @type {boolean} */\r\n   let editorButton;\r\n\r\n   /** @type {HTMLDivElement} */\r\n   let editorEl;\r\n\r\n   /** @type {string} */\r\n   let keyCode;\r\n\r\n   /** @type {boolean} */\r\n   let keyFocused = false;\r\n\r\n   /**\r\n    * Respond to changes in `options.editable`.\r\n    */\r\n   $:\r\n   {\r\n      editable = typeof options.editable === 'boolean' ? options.editable : true;\r\n      if (!editable) { destroyEditor(); }\r\n   }\r\n\r\n   /**\r\n    * When `options.editable` & `options.clickToEdit` is true and the editor is not active enable clickToEdit.\r\n    */\r\n   $: clickToEdit = !editorActive && editable &&\r\n    (typeof options.clickToEdit === 'boolean' ? options.clickToEdit : false);\r\n\r\n   /**\r\n    * When `options.button` & `options.editable` is true and the editor is not active and `clickToEdit` is false\r\n    * enable the edit button.\r\n    */\r\n   $: editorButton = !editorActive && editable && (typeof options.button === 'boolean' ? options.button : true) &&\r\n    !clickToEdit;\r\n\r\n   /**\r\n    * Allows another KeyboardEvent.code to be used to activate the editor.\r\n    */\r\n   $: keyCode = typeof options.keyCode === 'string' ? options.keyCode : 'Enter';\r\n\r\n   /**\r\n    * Respond to changes in `options.document`\r\n    */\r\n   $: if (options.document !== void 0)\r\n   {\r\n      if (!(options.document instanceof globalThis.foundry.abstract.Document))\r\n      {\r\n         throw new TypeError(`TJSProseMirror error: 'options.document' is not a Foundry document.`);\r\n      }\r\n\r\n      if (typeof options.fieldName !== 'string')\r\n      {\r\n         throw new TypeError(\r\n          `TJSProseMirror error: 'options.document' is defined, but 'options.fieldName' is not a string.`);\r\n      }\r\n\r\n      // Remove any existing editor if document changes.\r\n      if (options.document !== $doc)\r\n      {\r\n         enrichedContent = '';\r\n         content = '';\r\n         destroyEditor();\r\n      }\r\n\r\n      doc.set(options.document);\r\n   }\r\n   else\r\n   {\r\n      // Remove any existing editor if there was a document set, but now it is removed.\r\n      if ($doc)\r\n      {\r\n         enrichedContent = '';\r\n         content = '';\r\n\r\n         destroyEditor();\r\n\r\n         doc.set(void 0);\r\n      }\r\n   }\r\n\r\n   // If there is a valid document then retrieve content from `fieldName` otherwise use `content` string.\r\n   $:\r\n   {\r\n      content = $doc !== void 0 ? globalThis.foundry.utils.getProperty($doc, options.fieldName) :\r\n       typeof content === 'string' ? content : '';\r\n\r\n      // Avoid double trigger of reactive statement as enriching content is async.\r\n      onContentChanged(content, typeof options.enrichContent === 'boolean' ? options.enrichContent : true);\r\n   }\r\n\r\n   onDestroy(() =>\r\n   {\r\n      // Handle the case when the component is destroyed / IE application closed, but the editor isn't saved.\r\n      if (editorActive)\r\n      {\r\n         saveEditor({ remove: typeof options.button === 'boolean' ? options.button : true });\r\n      }\r\n      else\r\n      {\r\n         destroyEditor();\r\n      }\r\n   });\r\n\r\n   /**\r\n    * If `options.editable` is true and `options.button` && `options.clickToEdit` is false then start the editor on\r\n    * mount.\r\n    */\r\n   onMount(() => { if (editable && !editorButton && !clickToEdit) { initEditor(); } });\r\n\r\n   /**\r\n    * Destroys any active editor.\r\n    */\r\n   function destroyEditor(fireCancel = true)\r\n   {\r\n      if (editor)\r\n      {\r\n         editor.destroy();\r\n         editor = void 0;\r\n\r\n         // Post on next micro-task to allow any event propagation for `Escape` key to trigger first.\r\n         setTimeout(() => { editorActive = false; }, 0);\r\n\r\n         // If the editor was initialized by keyboard action then focus it after a short delay to allow the template\r\n         // to update.\r\n         if (keyFocused)\r\n         {\r\n            keyFocused = false;\r\n\r\n            setTimeout(() =>\r\n            {\r\n               if (editorEl instanceof HTMLElement && editorEl?.isConnected) { editorEl.focus(); }\r\n            }, 100);\r\n         }\r\n\r\n         if (fireCancel) { dispatch('editor:cancel'); }\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Initializes editor.\r\n    *\r\n    * @returns {Promise<void>}\r\n    */\r\n   async function initEditor()\r\n   {\r\n      // If editor button is enabled then remove the menu / editing interface on save.\r\n      const remove = typeof options.button === 'boolean' ? options.button : true;\r\n\r\n      const editorOptions = {\r\n         ...options,\r\n\r\n         plugins: {\r\n            ...ProseMirror.defaultPlugins,\r\n\r\n            menu: ProseMirror.ProseMirrorMenu.build(ProseMirror.defaultSchema, {\r\n               destroyOnSave: remove,\r\n               onSave: () => saveEditor({ remove })\r\n            }),\r\n\r\n            keyMaps: Plugins.TJSKeyMaps.build(ProseMirror.defaultSchema, {\r\n               onSave: () => saveEditor({ remove }),\r\n               onQuit: () => destroyEditor()\r\n            }),\r\n\r\n            tjsPasteRawUUID: Plugins.TJSPasteUUID.build(),\r\n\r\n            ...(isObject(options.plugins) ? options.plugins : {})\r\n         }\r\n      };\r\n\r\n      editorActive = true;\r\n\r\n      // Editor is now active; wait until the template updates w/ new bound `editorContentEl`.\r\n      await tick();\r\n\r\n      editor = await ProseMirrorEditor.create(editorContentEl, content, editorOptions);\r\n\r\n      // `.editor-container` div is added automatically; add inline style to set margin to 0.\r\n      const containerEl = editorEl.querySelector('.editor-container');\r\n      if (containerEl) { containerEl.style = 'margin: var(--tjs-editor-container-margin, 0)'; }\r\n\r\n      editor.view.focus();\r\n\r\n      PMImpl.setInitialSelection(editor.view, options);\r\n\r\n      dispatch('editor:start');\r\n   }\r\n\r\n   /**\r\n    * Potentially handles initializing the editor when it is not active and `options.clickToEdit` is true.\r\n    *\r\n    * @param {MouseEvent}   event -\r\n    */\r\n   function onClick(event)\r\n   {\r\n      if (!editorActive && clickToEdit) { initEditor(); }\r\n   }\r\n\r\n   /**\r\n    * Separated into a standalone method so applying async value to enriched content doesn't double trigger a reactive\r\n    * statement twice.\r\n    *\r\n    * @param {string}   content - Content prop.\r\n    *\r\n    * @param {boolean}  enrichContent - `options.enrichContent` or default of `true.\r\n    *\r\n    * @returns {Promise<void>}\r\n    */\r\n   async function onContentChanged(content, enrichContent)\r\n   {\r\n      if (typeof content === 'string')\r\n      {\r\n         if (enrichContent)\r\n         {\r\n            enrichedContent = await TextEditor.enrichHTML(content, { async: true, secrets: globalThis.game.user.isGM });\r\n         }\r\n         else\r\n         {\r\n            enrichedContent = content;\r\n         }\r\n      }\r\n      else\r\n      {\r\n         enrichedContent = '';\r\n      }\r\n\r\n      dispatch('editor:enrichedContent', { enrichedContent });\r\n   }\r\n\r\n   /**\r\n    * Handles cleaning up the editor state after any associated document has been deleted.\r\n    *\r\n    * @param {foundry.abstract.Document} document - The deleted document.\r\n    */\r\n   function onDocumentDeleted(document)\r\n   {\r\n      options.document = void 0;\r\n\r\n      destroyEditor();\r\n\r\n      dispatch('editor:document:deleted', { document });\r\n\r\n      content = '';\r\n      enrichedContent = '';\r\n   }\r\n\r\n   /**\r\n    * Prevents `Escape` key or `Ctrl-s` from propagating when the editor is active preventing the app from being closed.\r\n    * The `Escape` key is used to close the active editor first. Foundry by default when `Ctrl-s` is pressed as of v10\r\n    * scrolls the canvas down which is undesired when saving an editor as well.\r\n    *\r\n    * @param {KeyboardEvent}    event - A keyboard event from `.editor`.\r\n    */\r\n   function onKeydown(event)\r\n   {\r\n      if (editorActive)\r\n      {\r\n         if (event.code === 'Escape' || (event.code === 'KeyS' && (event.ctrlKey || event.metaKey)))\r\n         {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n         }\r\n      }\r\n      else\r\n      {\r\n         if (event.code === keyCode)\r\n         {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n         }\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Handle activating the editor if key codes match.\r\n    *\r\n    * @param {KeyboardEvent}    event - A KeyboardEvent.\r\n    */\r\n   function onKeyup(event)\r\n   {\r\n      if (event.code === keyCode)\r\n      {\r\n         if (!editorActive)\r\n         {\r\n            keyFocused = true;\r\n            initEditor();\r\n         }\r\n\r\n         event.preventDefault();\r\n         event.stopPropagation();\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Saves the editor contents to the associated document or updates content directly.\r\n    *\r\n    * @param {object}   [opts] - Optional parameters.\r\n    *\r\n    * @param {boolean}  [opts.remove=true] - Removes the editor.\r\n    */\r\n   function saveEditor({ remove = true } = {})\r\n   {\r\n      if (editor)\r\n      {\r\n         if (editor.isDirty())\r\n         {\r\n            let data = ProseMirror.dom.serializeString(editor.view.state.doc);\r\n\r\n            // Perform client side sanitization if DOMPurify is available in options.\r\n            // ProseMirror does essential `<script>` based sanitization, so this is just an extra option to provide\r\n            // specific sanitization.\r\n            if (options?.DOMPurify && typeof options?.DOMPurify?.sanitizeWithVideo === 'function')\r\n            {\r\n               data = options.DOMPurify.sanitizeWithVideo(data);\r\n            }\r\n\r\n            // Save to document if available\r\n            if ($doc && options.fieldName)\r\n            {\r\n               $doc.update({ [options.fieldName]: data })\r\n            }\r\n            else // Otherwise save to content.\r\n            {\r\n               content = data;\r\n            }\r\n\r\n            dispatch('editor:save', { content: data });\r\n         }\r\n\r\n         // Remove the editor\r\n         if (remove) { destroyEditor(false); }\r\n      }\r\n   }\r\n</script>\r\n\r\n<div bind:this={editorEl}\r\n     class=\"editor prosemirror tjs-editor {Array.isArray(options.classes) ? options.classes.join(' ') : ''}\"\r\n     class:click-to-edit={clickToEdit}\r\n     class:editor-active={editorActive}\r\n     use:applyStyles={options.styles}\r\n     on:click={onClick}\r\n     on:keydown={onKeydown}\r\n     on:keyup={onKeyup}\r\n     role=textbox\r\n     tabindex=0>\r\n    {#if editorButton}\r\n        <!-- svelte-ignore a11y-missing-attribute a11y-click-events-have-key-events -->\r\n        <a class=editor-edit on:click={() => initEditor()} role=button tabindex=-1><i class=\"fas fa-edit\"></i></a>\r\n    {/if}\r\n    {#if editorActive}\r\n        <div bind:this={editorContentEl} class=editor-content />\r\n    {:else}\r\n        <div class=editor-enriched>\r\n            {@html enrichedContent}\r\n        </div>\r\n    {/if}\r\n</div>\r\n\r\n<style>\r\n    .editor {\r\n        background: var(--tjs-editor-background, none);\r\n        border: var(--tjs-editor-border, none);\r\n        border-radius: var(--tjs-editor-border-radius, 0);\r\n        height: var(--tjs-editor-height, 100%);\r\n        margin: var(--tjs-editor-margin, 0);\r\n        outline-offset: var(--tjs-editor-outline-offset, 0.25em);\r\n        overflow: var(--tjs-editor-overflow, auto);\r\n        transition: var(--tjs-editor-transition);\r\n        width: var(--tjs-editor-width, 100%);\r\n\r\n        /* For Firefox. */\r\n        scrollbar-width: thin;\r\n    }\r\n\r\n    /**\r\n     * This class is added to editor when `editorActive` is true and unsets overflow allowing content to be scrollable\r\n     * keeping the menu bar always visible at the top of the component.\r\n     */\r\n    .editor-active {\r\n        box-shadow: var(--tjs-editor-active-box-shadow);\r\n        outline: var(--tjs-editor-active-outline);\r\n        overflow: var(--tjs-editor-active-overflow, unset);\r\n    }\r\n\r\n    /**\r\n     * Defines cursor and box-shadow / outline when the editor is inactive and hovered.\r\n     */\r\n    .tjs-editor:not(.editor-active):focus-visible {\r\n        box-shadow: var(--tjs-editor-inactive-box-shadow-focus-visible, var(--tjs-default-box-shadow-focus-visible));\r\n        outline: var(--tjs-editor-inactive-outline-focus-visible, var(--tjs-default-outline-focus-visible, revert));\r\n        transition: var(--tjs-editor-inactive-transition-focus-visible, var(--tjs-default-transition-focus-visible));\r\n    }\r\n\r\n    /**\r\n     * Defines cursor and box-shadow / outline when the editor is inactive and hovered, but not manually focused.\r\n     */\r\n    .tjs-editor:not(.editor-active):not(:focus-visible):hover {\r\n        box-shadow: var(--tjs-editor-inactive-box-shadow-hover);\r\n        outline: var(--tjs-editor-inactive-outline-hover);\r\n    }\r\n\r\n    /**\r\n     * Defines user-select when the editor is inactive and hovered.\r\n     */\r\n    .tjs-editor:not(.editor-active):hover {\r\n        user-select: var(--tjs-editor-inactive-user-select-hover, text);\r\n    }\r\n\r\n    /**\r\n     * Defines cursor when the editor is not active, but configured for click to edit. Give the user some indication\r\n     * via showing the text cursor across the whole editor element.\r\n     */\r\n    .tjs-editor.click-to-edit:not(.editor-active):hover {\r\n        cursor: var(--tjs-editor-inactive-cursor-hover, text);\r\n    }\r\n\r\n    .editor-content {\r\n        overflow: var(--tjs-editor-content-overflow, auto);\r\n        padding: var(--tjs-editor-content-padding, 0 0 0 0.25em);\r\n\r\n        /* For Firefox. */\r\n        scrollbar-width: thin;\r\n    }\r\n\r\n    .editor-edit {\r\n        right: var(--tjs-editor-edit-button-right, 5px);\r\n        top: var(--tjs-editor-edit-button-top, 0);\r\n    }\r\n\r\n    .editor-enriched {\r\n        padding: var(--tjs-editor-content-padding, 0 0 0 0.25em);\r\n    }\r\n\r\n    /* Controls whether the editor content text is selectable when the editor is inactive. */\r\n    .tjs-editor:not(.editor-active) .editor-enriched {\r\n        user-select: var(--tjs-editor-inactive-user-select-hover, text);\r\n    }\r\n\r\n    /* Don't add an initial margin top to first paragraph element in `.editor-content`. */\r\n    .tjs-editor .editor-container .editor-content :global(p:first-of-type) {\r\n        margin-top: 0;\r\n    }\r\n\r\n    .tjs-editor .editor-enriched :global(p:first-of-type) {\r\n        margin-top: 0;\r\n    }\r\n\r\n    /* Provides global styles scoped to `.tjs-editor` for dynamic `.editor-menu` element */\r\n    .tjs-editor :global(.editor-menu) {\r\n        background: var(--tjs-editor-toolbar-background, rgba(0, 0, 0, 0.1));\r\n        border-radius: var(--tjs-editor-toolbar-border-radius, 6px);\r\n        box-shadow: var(--tjs-editor-toolbar-box-shadow, 0 2px 2px -2px rgb(34 47 62 / 10%), 0 8px 8px -4px rgb(34 47 62 / 7%));\r\n        margin-bottom: 0.25em;\r\n        padding: var(--tjs-editor-toolbar-padding, 2px 0);\r\n        width: var(--tjs-editor-toolbar-width, 100%);\r\n\r\n        transition: box-shadow 500ms ease-in-out;\r\n    }\r\n\r\n    /* Removes the awkward 1rem padding from core */\r\n    .tjs-editor.prosemirror.editing-source :global(textarea) {\r\n        padding: 0;\r\n    }\r\n</style>\r\n","<script>\r\n   /**\r\n    * --tjs-toggle-label-background\r\n    * --tjs-toggle-label-background-focus-visible\r\n    * --tjs-toggle-label-background-hover\r\n    * --tjs-toggle-label-background-selected\r\n    * --tjs-toggle-label-border\r\n    * --tjs-toggle-label-border-radius\r\n    * --tjs-toggle-label-box-shadow-focus-visible - fallback: --tjs-default-box-shadow-focus-visible\r\n    * --tjs-toggle-label-font-size - inherit\r\n    * --tjs-toggle-label-font-weight - inherit\r\n    * --tjs-toggle-label-font-family - inherit\r\n    * --tjs-toggle-label-overflow - hidden\r\n    * --tjs-toggle-label-padding - 0\r\n    * --tjs-toggle-label-text-shadow-focus - undefined; default: --tjs-default-text-shadow-focus-hover\r\n    * --tjs-toggle-label-text-shadow-hover - undefined; default: --tjs-default-text-shadow-focus-hover\r\n    * --tjs-toggle-label-text-shadow-selected - undefined; default: --tjs-default-text-shadow-focus-hover\r\n    * --tjs-toggle-label-transition - global default: 'background 0.2s ease-in-out'\r\n    * --tjs-toggle-label-transition-focus-visible - fallback: --tjs-default-transition-focus-visible\r\n    */\r\n   import { createEventDispatcher } from 'svelte';\r\n\r\n   import { applyStyles }        from '@typhonjs-fvtt/runtime/svelte/action/dom';\r\n   import { localize }           from '@typhonjs-fvtt/runtime/svelte/helper';\r\n   import { isSvelteComponent }  from '@typhonjs-fvtt/runtime/svelte/util';\r\n   import { isObject }           from '@typhonjs-fvtt/runtime/util/object';\r\n   import { isWritableStore }    from '@typhonjs-fvtt/runtime/util/store';\r\n\r\n   export let label = void 0;\r\n   export let text = void 0;\r\n   export let comp = void 0;\r\n   export let title = void 0;\r\n   export let titleSelected = void 0;\r\n   export let store = void 0;\r\n   export let styles = void 0;\r\n   export let efx = void 0;\r\n   export let keyCode = void 0;\r\n   export let onPress = void 0;\r\n   export let onClose = void 0;\r\n   export let onContextMenu = void 0;\r\n   export let onClickPropagate = void 0;\r\n\r\n   const dispatch = createEventDispatcher();\r\n\r\n   $: text = isObject(label) && typeof label.text === 'string' ? label.text :\r\n    typeof text === 'string' ? text : void 0;\r\n   $: comp = isObject(label) && isSvelteComponent(label.comp) ? label.comp :\r\n    isSvelteComponent(comp) ? comp : void 0;\r\n   $: title = isObject(label) && typeof label.title === 'string' ? label.title :\r\n    typeof title === 'string' ? title : '';\r\n   $: titleSelected = isObject(label) && typeof label.titleSelected === 'string' ? label.titleSelected :\r\n    typeof titleSelected === 'string' ? titleSelected : '';\r\n   $: store = isObject(label) && isWritableStore(label.store) ? label.store : isWritableStore(store) ?\r\n    store : void 0;\r\n   $: styles = isObject(label) && isObject(label.styles) ? label.styles :\r\n    isObject(styles) ? styles : void 0;\r\n   $: efx = isObject(label) && typeof label.efx === 'function' ? label.efx :\r\n    typeof efx === 'function' ? efx : () => {};\r\n   $: keyCode = isObject(label) && typeof label.keyCode === 'string' ? label.keyCode :\r\n    typeof keyCode === 'string' ? keyCode : 'Enter';\r\n\r\n   $: onPress = isObject(label) && typeof label.onPress === 'function' ? label.onPress :\r\n    typeof onPress === 'function' ? onPress : void 0;\r\n   $: onClose = isObject(label) && typeof label.onClose === 'function' ? label.onClose :\r\n    typeof onClose === 'function' ? onClose : void 0;\r\n   $: onContextMenu = isObject(label) && typeof label.onContextMenu === 'function' ? label.onContextMenu :\r\n    typeof onContextMenu === 'function' ? onContextMenu : void 0;\r\n\r\n   $: onClickPropagate = isObject(label) && typeof label.onClickPropagate === 'boolean' ? label.onClickPropagate :\r\n    typeof onClickPropagate === 'boolean' ? onClickPropagate : false;\r\n\r\n   let spanEl;\r\n   let selected = false;\r\n\r\n   $: if (store) { selected = $store; }\r\n\r\n   // Chose the current title when `selected` changes; if there is no `titleSelected` fallback to `title`.\r\n   $: titleCurrent = selected && titleSelected !== '' ? titleSelected : title\r\n\r\n   /**\r\n    * Handle click event.\r\n    *\r\n    * @param {MouseEvent}    event -\r\n    */\r\n   function onClick(event)\r\n   {\r\n      selected = !selected;\r\n      if (store) { store.set(selected); }\r\n\r\n      if (typeof onPress === 'function') { onPress(selected); }\r\n\r\n      dispatch('press', { selected });\r\n\r\n      if (!onClickPropagate)\r\n      {\r\n         event.preventDefault();\r\n         event.stopPropagation();\r\n      }\r\n   }\r\n\r\n   /**\r\n    * In this case we can't set pointer-events: none for the div due to the slotted component, so process clicks on the\r\n    * div in respect to onClickPropagate.\r\n    *\r\n    * @param {MouseEvent} event -\r\n    */\r\n   function onClickDiv(event)\r\n   {\r\n      if (!onClickPropagate)\r\n      {\r\n         event.preventDefault();\r\n         event.stopPropagation();\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Handles `close:popup` event from any children components like TJSMenu.\r\n    */\r\n   function onClosePopup(event)\r\n   {\r\n      selected = false;\r\n      if (store) { store.set(false); }\r\n\r\n      if (typeof onClose === 'function') { onClose(selected); }\r\n\r\n      // The close event was triggered from a key press, so focus the anchor element / button.\r\n      if (typeof event?.detail?.keyboardFocus === 'boolean' && event.detail.keyboardFocus && spanEl?.isConnected)\r\n      {\r\n         spanEl.focus();\r\n\r\n         event.stopPropagation();\r\n         event.preventDefault();\r\n      }\r\n   }\r\n\r\n   /**\r\n    * @param {MouseEvent}   event -\r\n    */\r\n   function onContextMenuPress(event)\r\n   {\r\n      if (typeof onContextMenu === 'function') { onContextMenu(); }\r\n\r\n      if (!onClickPropagate)\r\n      {\r\n         event.preventDefault();\r\n         event.stopPropagation();\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Consume / stop propagation of key down when key codes match.\r\n    *\r\n    * @param {KeyboardEvent}    event -\r\n    */\r\n   function onKeydown(event)\r\n   {\r\n      if (event.code === keyCode)\r\n      {\r\n         event.preventDefault();\r\n         event.stopPropagation();\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Handle press event if key codes match.\r\n    *\r\n    * @param {KeyboardEvent}    event -\r\n    */\r\n   function onKeyup(event)\r\n   {\r\n      if (event.code === keyCode)\r\n      {\r\n         selected = !selected;\r\n         if (store) { store.set(selected); }\r\n\r\n         if (typeof onPress === 'function') { onPress(selected); }\r\n\r\n         dispatch('press', { selected });\r\n\r\n         event.preventDefault();\r\n         event.stopPropagation();\r\n      }\r\n   }\r\n</script>\r\n\r\n<!-- svelte-ignore a11y-click-events-have-key-events a11y-no-static-element-interactions -->\r\n<div class=tjs-toggle-label\r\n     on:click={onClickDiv}\r\n     on:close:popup={onClosePopup}\r\n     title={localize(titleCurrent)}\r\n     use:applyStyles={styles}>\r\n   <slot name=outer />\r\n   <span bind:this={spanEl}\r\n         class:selected\r\n         on:click={onClick}\r\n         on:contextmenu={onContextMenuPress}\r\n         on:keydown={onKeydown}\r\n         on:keyup={onKeyup}\r\n         on:click\r\n         on:contextmenu\r\n         role=button\r\n         tabindex=0\r\n         use:efx>\r\n      <slot name=left />\r\n      {#if comp}\r\n         <svelte:component this={comp}/>\r\n      {:else if typeof text === 'string'}\r\n         <!-- svelte-ignore a11y-missing-attribute -->\r\n         <a role=presentation>{localize(text)}</a>\r\n      {/if}\r\n      <slot name=right />\r\n   </span>\r\n   {#if selected}\r\n      <slot/>\r\n   {/if}\r\n</div>\r\n\r\n<style>\r\n   div {\r\n      display: block;\r\n      position: relative;\r\n   }\r\n\r\n   span {\r\n      position: relative;\r\n\r\n      display: flex;\r\n      justify-content: var(--tjs-toggle-label-justify-content, center);\r\n      align-items: var(--tjs-toggle-label-align-items, center);\r\n\r\n      pointer-events: initial;\r\n\r\n      width: 100%;\r\n      height: 100%;\r\n\r\n      background: var(--tjs-toggle-label-background);\r\n      border: var(--tjs-toggle-label-border, none);\r\n      border-radius: var(--tjs-toggle-label-border-radius);\r\n      font-size: var(--tjs-toggle-label-font-size, inherit);\r\n      font-weight: var(--tjs-toggle-label-font-weight, inherit);\r\n      font-family: var(--tjs-toggle-label-font-family, inherit);\r\n      overflow: var(--tjs-toggle-label-overflow, hidden);\r\n      padding: var(--tjs-toggle-label-padding, 0 0.25em);\r\n      transform-style: preserve-3d;\r\n      transition: var(--tjs-toggle-label-transition, background 0.2s ease-in-out);\r\n   }\r\n\r\n   span:focus {\r\n      background: var(--tjs-toggle-label-background-focus);\r\n      text-shadow: var(--tjs-toggle-label-text-shadow-focus, var(--tjs-default-text-shadow-focus-hover));\r\n   }\r\n\r\n   span:focus-visible {\r\n      background: var(--tjs-toggle-label-background-focus-visible);\r\n      box-shadow: var(--tjs-toggle-label-box-shadow-focus-visible, var(--tjs-default-box-shadow-focus-visible));\r\n      outline: var(--tjs-toggle-label-outline-focus-visible, var(--tjs-default-outline-focus-visible, revert));\r\n      transition: var(--tjs-toggle-label-transition-focus-visible, var(--tjs-default-transition-focus-visible));\r\n   }\r\n\r\n   span:hover {\r\n      background: var(--tjs-toggle-label-background-hover);\r\n      text-shadow: var(--tjs-toggle-label-text-shadow-hover, var(--tjs-default-text-shadow-focus-hover));\r\n   }\r\n\r\n   span.selected {\r\n      background: var(--tjs-toggle-label-background-selected);\r\n      text-shadow: var(--tjs-toggle-label-text-shadow-selected, var(--tjs-default-text-shadow-focus-hover));\r\n   }\r\n</style>\r\n","<script>\r\n   /**\r\n    * TJSMenu provides a menu component that can be slotted into toggle components like TJSToggleIconButton and\r\n    * TJSToggleLabel.\r\n    *\r\n    * TJSMenu supports a flexible data driven way to construct the menu items. Depending on the item data that is passed\r\n    * into the menu you can define 4 types of items: 'icon / label', 'image / label', 'class / Svelte component', and\r\n    * 'separator / hr'. TJSMenu also accepts a main slot allowing the entire menu contents to be replaced with a custom\r\n    * component as well as named slots `before` and `after` which place named components before or after the main menu\r\n    * data driven items.\r\n    *\r\n    * ----------------------------------------------------------------------------------------------------------------\r\n    * Exported props include:\r\n    * `menu` ({@link TJSMenuData}): An object defining all properties of a menu including potentially data driven\r\n    * minimal Svelte configuration objects (`slotAfter`, `slotBefore`, and `slotDefault`) providing default\r\n    * component implementations.\r\n    *\r\n    * Or in lieu of passing the folder object you can assign these props directly:\r\n    * `items`: An iterable list of {@link TJSMenuItemData}; defines data driven menu items.\r\n    * `offset`: Optional X / Y offsets for the menu display.\r\n    * `styles`: Styles to be applied inline via `applyStyles` action.\r\n    * `efx`: Currently unused; for any future action effects.\r\n    * `keyCode`: The key code to activate menu items.\r\n    * `transitionOptions`: Custom transition options for duration and easing function.\r\n    *\r\n    * ----------------------------------------------------------------------------------------------------------------\r\n    * Events: There is a single that is fired and bubbled up through parent elements:\r\n    *\r\n    * `close:popup` - A CustomEvent fired when the menu closes allowing any parent components to update state. The\r\n    *                 `detail` data may have two optional fields of data including `keyboardFocus` / boolean if the\r\n    *                 close action originated from keyboard navigation and the other is `target` / HTMLElement that is\r\n    *                 the original event target for the close action.\r\n    *\r\n    * ----------------------------------------------------------------------------------------------------------------\r\n    * Styling: To style this component use `.tjs-menu` as the base selector.\r\n    *\r\n    * There are several local CSS variables that you can use to change the appearance dynamically. Either use\r\n    * CSS props or pass in a `styles` object w/ key / value props to set to the details. The default fallback variables\r\n    * target both TJSMenu and TJSContextMenu. The few `popup` defaults target first level overlaid components inside an\r\n    * application.\r\n    *\r\n    * The following CSS variables are supported, but not defined by default.\r\n    * --tjs-menu-background - fallback: --tjs-default-menu-background; fallback: --tjs-default-popup-background; default: #23221d\r\n    * --tjs-menu-border - fallback: --tjs-default-popup-border; default: 1px solid #000\r\n    * --tjs-menu-border-radius - fallback: --tjs-default-popup-border-radius; default: 5px\r\n    * --tjs-menu-box-shadow - fallback: --tjs-default-popup-box-shadow; default: 0 0 2px #000\r\n    * --tjs-menu-primary-color - fallback: --tjs-default-menu-primary-color; fallback: --tjs-default-popup-primary-color; default: #b5b3a4\r\n    * --tjs-menu-max-width - fallback: --tjs-default-menu-max-width; default: 360px\r\n    * --tjs-menu-min-width - fallback: --tjs-default-menu-min-width; default: 20px\r\n    * --tjs-menu-z-index - fallback: --tjs-default-popup-z-index; default: 100\r\n    *\r\n    * The following CSS variables define attributes for the data driven menu items.\r\n    *\r\n    * All menu items:\r\n    * --tjs-menu-item-line-height - fallback: --tjs-default-menu-item-line-height; default: 2em\r\n    * --tjs-menu-item-padding - fallback: --tjs-default-menu-item-padding; default: 0 0.5em 0 0\r\n    *\r\n    * Icon / Image menu items (considered a button item):\r\n    * --tjs-menu-item-button-gap - fallback: --tjs-default-menu-item-button-gap; default: 0.25em\r\n    * --tjs-menu-item-highlight-color - fallback: --tjs-default-menu-highlight-color; fallback: --tjs-default-popup-highlight-color; default: #f0f0e0\r\n    * --tjs-menu-item-text-shadow-focus-hover - fallback: --tjs-default-text-shadow-focus-hover; default: 0 0 8px red\r\n    *\r\n    * Specific targeting for the label of button items (allows control of wrapping / set `white-space` to `nowrap`):\r\n    * --tjs-menu-item-label-overflow - fallback: --tjs-default-menu-item-label-overflow; default: hidden\r\n    * --tjs-menu-item-label-text-overflow - fallback: --tjs-default-menu-item-label-text-overflow; default: ellipsis\r\n    * --tjs-menu-item-label-white-space - fallback: --tjs-default-menu-item-label-white-space; default: undefined\r\n    *\r\n    * Icon menu item:\r\n    * --tjs-menu-item-icon-width - fallback: --tjs-default-menu-item-icon-width; default: 1.25em\r\n    *\r\n    * Image menu item:\r\n    * --tjs-menu-item-image-width - fallback: --tjs-default-menu-item-image-width; default: 1.25em\r\n    * --tjs-menu-item-image-height - fallback: --tjs-default-menu-item-image-height; default: 1.25em\r\n    *\r\n    * Separator / HR:\r\n    * --tjs-menu-hr-margin - fallback: --tjs-default-hr-margin; default: 0 0.25em\r\n    * --tjs-menu-hr-border-top - fallback: --tjs-default-hr-border-top; default: 1px solid #555\r\n    * --tjs-menu-hr-border-bottom - fallback: --tjs-default-hr-border-bottom; default: 1px solid #444\r\n    *\r\n    * The following CSS variables define the keyboard / a11y focus indicator for menu items:\r\n    * --tjs-menu-focus-indicator-align-self - fallback: --tjs-default-focus-indicator-align-self; default: stretch\r\n    * --tjs-menu-focus-indicator-background - fallback: --tjs-default-focus-indicator-background; default: white\r\n    * --tjs-menu-focus-indicator-border - fallback: --tjs-default-focus-indicator-border; default: undefined\r\n    * --tjs-menu-focus-indicator-border-radius - fallback: --tjs-default-focus-indicator-border-radius; default: 0.1em\r\n    * --tjs-menu-focus-indicator-height - fallback: --tjs-default-focus-indicator-height; default: undefined\r\n    * --tjs-menu-focus-indicator-width - fallback: --tjs-default-focus-indicator-width; default: 0.25em\r\n    * --tjs-menu-focus-indicator-transition - fallback: --tjs-default-focus-indicator-transition\r\n    */\r\n\r\n   import { onMount }            from 'svelte';\r\n\r\n   import { quintOut }           from 'svelte/easing';\r\n\r\n   import { applyStyles }        from '@typhonjs-fvtt/runtime/svelte/action/dom';\r\n   import { localize }           from '@typhonjs-fvtt/runtime/svelte/helper';\r\n   import { slideFade }          from '@typhonjs-fvtt/runtime/svelte/transition';\r\n\r\n   import { isSvelteComponent }  from '@typhonjs-fvtt/runtime/svelte/util';\r\n\r\n   import {\r\n      getStackingContext,\r\n      A11yHelper }               from '@typhonjs-fvtt/runtime/util/browser';\r\n\r\n   import {\r\n      isIterable,\r\n      isObject }                 from '@typhonjs-fvtt/runtime/util/object';\r\n\r\n   import { TJSFocusWrap }       from '@typhonjs-fvtt/runtime/svelte/component/core';\r\n\r\n   /** @type {TJSMenuData} */\r\n   export let menu = void 0;\r\n\r\n   /** @type {Iterable<TJSMenuItemData>} */\r\n   export let items = void 0;\r\n\r\n   /** @type {HTMLElement|string} */\r\n   export let focusEl = void 0;\r\n\r\n   /** @type {{ x?: number, y?: number }} */\r\n   export let offset = void 0;\r\n\r\n   /** @type {Record<string, string>} */\r\n   export let styles = void 0;\r\n\r\n   /** @type {Function} */\r\n   export let efx = void 0;\r\n\r\n   /** @type {string} */\r\n   export let keyCode = void 0;\r\n\r\n   /** @type {{ duration: number, easing: Function }} */\r\n   export let transitionOptions = void 0;\r\n\r\n   const s_DEFAULT_OFFSET = { x: 0, y: 0 };\r\n\r\n   // Provides options to `A11yHelper.getFocusableElements` to ignore TJSFocusWrap by CSS class.\r\n   const s_IGNORE_CLASSES = { ignoreClasses: ['tjs-focus-wrap'] };\r\n\r\n   /** @type {Iterable<TJSMenuItemData>} */\r\n   let allItems;\r\n\r\n   $: {\r\n      const tempList = isObject(menu) && isIterable(menu.items) ? menu.items :\r\n       isIterable(items) ? items : [];\r\n\r\n      const tempItems = [];\r\n\r\n      let cntr = -1;\r\n\r\n      for (const item of tempList)\r\n      {\r\n         cntr++;\r\n         if (!isObject(item)) { throw new TypeError(`TJSMenu error: 'item[${cntr}]' is not an object.`); }\r\n\r\n         // Filter items for any condition that prevents display.\r\n         if (typeof item.condition === 'function' && !item.condition()) { continue; }\r\n         if (typeof item.condition === 'boolean' && !item.condition) { continue; }\r\n\r\n         let type;\r\n\r\n         if (isSvelteComponent(item.class)) { type = 'class'; }\r\n         else if (typeof item.icon === 'string') { type = 'icon'; }\r\n         else if (typeof item.image === 'string') { type = 'image'; }\r\n         else if (typeof item.separator === 'string')\r\n         {\r\n            if (item.separator !== 'hr')\r\n            {\r\n               throw new Error (\r\n                `TJSMenu error: 'item[${cntr}]' has unknown separator type; only 'hr' is currently supported.`)\r\n            }\r\n\r\n            type = 'separator-hr';\r\n         }\r\n\r\n         if (type === void 0) { throw new TypeError(`TJSMenu error: Unknown type for 'item[${cntr}]'.`); }\r\n\r\n         tempItems.push({ ...item, '#type': type });\r\n      }\r\n\r\n      allItems = tempItems;\r\n   }\r\n\r\n   $: focusEl = isObject(menu) && A11yHelper.isFocusSource(menu.focusEl) ? menu.focusEl :\r\n    A11yHelper.isFocusSource(focusEl) ? focusEl : void 0;\r\n\r\n   $: offset = isObject(menu) && isObject(menu.offset) ? menu.offset :\r\n    isObject(offset) ? offset : s_DEFAULT_OFFSET;\r\n\r\n   $: styles = isObject(menu) && isObject(menu.styles) ? menu.styles :\r\n    isObject(styles) ? styles : void 0;\r\n\r\n   $: efx = isObject(menu) && typeof menu.efx === 'function' ? menu.efx :\r\n    typeof efx === 'function' ? efx : () => {};\r\n\r\n   $: keyCode = isObject(menu) && typeof menu.keyCode === 'string' ? menu.keyCode :\r\n    typeof keyCode === 'string' ? keyCode : 'Enter';\r\n\r\n   $: transitionOptions = isObject(menu) && isObject(menu.transitionOptions) ? menu.transitionOptions :\r\n     isObject(transitionOptions) ? transitionOptions : { duration: 200, easing: quintOut };\r\n\r\n   // Bound to the nav element / menu.\r\n   let menuEl;\r\n\r\n   // Stores if this context menu is closed.\r\n   let closed = false;\r\n\r\n   // Stores any associated `focusSource` options to pass to menu callbacks when menu was activated by keys.\r\n   let focusOptions = void 0;\r\n\r\n   // Stores if menu has keyboard focus; detected on mount, when tab navigation occurs, and used to set `keyboardFocus`\r\n   // for close event.\r\n   let hasKeyboardFocus = false;\r\n\r\n   // ----------------------------------------------------------------------------------------------------------------\r\n\r\n   onMount(() =>\r\n   {\r\n      const activeEl = document.activeElement;\r\n      const parentEl = menuEl.parentElement;\r\n\r\n      // Determine if the parent element to the menu contains the active element and that it is explicitly focused\r\n      // via `:focus-visible` / keyboard navigation. If so then explicitly focus the first menu item possible.\r\n      if (parentEl instanceof HTMLElement && activeEl instanceof HTMLElement && parentEl.contains(activeEl) &&\r\n        activeEl.matches(':focus-visible'))\r\n      {\r\n         const firstFocusEl = A11yHelper.getFirstFocusableElement(menuEl);\r\n\r\n         if (firstFocusEl instanceof HTMLElement && !firstFocusEl.classList.contains('tjs-focus-wrap'))\r\n         {\r\n            firstFocusEl.focus();\r\n            hasKeyboardFocus = true;\r\n         }\r\n         else\r\n         {\r\n            // Silently focus the menu element so that keyboard handling functions.\r\n            menuEl.focus();\r\n         }\r\n\r\n         // Menu opened by keyboard navigation; set focus source to activeEl and pass to menu item callbacks.\r\n         focusOptions = {\r\n            focusSource: {\r\n               focusEl: [activeEl]\r\n            }\r\n         };\r\n\r\n         // Append any optional focus source from `focusEl` prop.\r\n         if (focusEl) { focusOptions.focusSource.focusEl.push(focusEl); }\r\n      }\r\n      else\r\n      {\r\n         // Silently focus the menu element so that keyboard handling functions.\r\n         menuEl.focus();\r\n\r\n         // Create focus source from optional `focusEl` prop.\r\n         if (focusEl)\r\n         {\r\n            focusOptions = {\r\n               focusSource: {\r\n                  focusEl: [focusEl]\r\n               }\r\n            };\r\n         }\r\n      }\r\n   });\r\n\r\n   // ----------------------------------------------------------------------------------------------------------------\r\n\r\n   /**\r\n    * Provides a custom transform allowing inspection of the element to change positioning styles based on the\r\n    * height / width of the element and the containing stacking context element. This allows the menu to expand left or\r\n    * right when the menu exceeds the bounds of the containing stacking context element.\r\n    *\r\n    * @param {HTMLElement} node - nav element.\r\n    *\r\n    * @returns {object} Transition object.\r\n    */\r\n   function animate(node)\r\n   {\r\n      const result = getStackingContext(node.parentElement);\r\n\r\n      if (!(result?.node instanceof HTMLElement))\r\n      {\r\n         console.warn(`'TJSMenu.animate warning: Could not locate parent stacking context element.`);\r\n         return;\r\n      }\r\n\r\n      const stackingContextRect = result?.node.getBoundingClientRect();\r\n      const stackingContextRight = stackingContextRect.x + stackingContextRect.width;\r\n\r\n      const nodeRect = node.getBoundingClientRect();\r\n      const parentRect = node.parentElement.getBoundingClientRect();\r\n\r\n      const adjustedOffset = {...s_DEFAULT_OFFSET, ...offset};\r\n\r\n      node.style.top = `${adjustedOffset.y + parentRect.height}px`;\r\n\r\n      // Check to make sure that the menu width does not exceed the right side of the stacking context element.\r\n      // If not open to the right.\r\n      if (parentRect.x + nodeRect.width < stackingContextRight)\r\n      {\r\n         node.style.left = `${adjustedOffset.x}px`;\r\n         node.style.removeProperty('right');\r\n      }\r\n      else // Open left.\r\n      {\r\n         node.style.right = `${adjustedOffset.x}px`;\r\n         node.style.removeProperty('left');\r\n      }\r\n\r\n      return slideFade(node, transitionOptions);\r\n   }\r\n\r\n   /**\r\n    * Invokes a function on click of a menu item then fires the `close` event and automatically runs the outro\r\n    * transition and destroys the component.\r\n    *\r\n    * @param {TJSMenuItemData} [item] - Menu item data.\r\n    */\r\n   function onClick(item)\r\n   {\r\n      const callback = item?.onPress;\r\n\r\n      if (typeof callback === 'function') { callback(item, focusOptions); }\r\n\r\n      if (!closed)\r\n      {\r\n         closed = true;\r\n         menuEl.dispatchEvent(new CustomEvent('close:popup', { bubbles: true, cancelable: true }));\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Determines if a pointer event is pressed outside the menu which closes the menu. Use a bubbling custom event\r\n    * `close:popup` and attach the original target. The TRL application shells will respond to this event to handle\r\n    * any additional automatic focus management.\r\n    *\r\n    * @param {PointerEvent}   event - Pointer event from document body click.\r\n    */\r\n   async function onClose(event)\r\n   {\r\n      // Early out if the pointer down is inside the menu element.\r\n      if (event.target === menuEl || menuEl.contains(event.target)) { return; }\r\n\r\n      if (event.target === menuEl.parentElement || menuEl.parentElement.contains(event.target)) { return; }\r\n\r\n      if (!closed)\r\n      {\r\n         closed = true;\r\n\r\n         menuEl.dispatchEvent(new CustomEvent('close:popup', {\r\n            bubbles: true,\r\n            cancelable: true,\r\n            detail: { target: event.target }\r\n         }));\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Handle key commands for closing the menu ('Esc') and reverse focus cycling via 'Shift-Tab'. Also stop propagation\r\n    * for the key code assigned for menu item selection ('Enter').\r\n    *\r\n    * @param {KeyboardEvent}  event - KeyboardEvent.\r\n    */\r\n   function onKeydownMenu(event)\r\n   {\r\n      // Handle menu item keyCode selection.\r\n      if (event.code === keyCode)\r\n      {\r\n         event.stopPropagation();\r\n         return;\r\n      }\r\n\r\n      switch(event.code)\r\n      {\r\n         case 'Tab':\r\n            event.stopPropagation();\r\n\r\n            // Handle reverse focus cycling with `<Shift-Tab>`.\r\n            if (event.shiftKey)\r\n            {\r\n               // Collect all focusable elements from `elementRoot` and ignore TJSFocusWrap.\r\n               const allFocusable = A11yHelper.getFocusableElements(menuEl, s_IGNORE_CLASSES);\r\n\r\n               // Find first and last focusable elements.\r\n               const firstFocusEl = allFocusable.length > 0 ? allFocusable[0] : void 0;\r\n               const lastFocusEl = allFocusable.length > 0 ? allFocusable[allFocusable.length - 1] : void 0;\r\n\r\n               // Only cycle focus to the last keyboard focusable app element if `elementRoot` or first focusable\r\n               // element is the active element.\r\n               if (menuEl === document.activeElement || firstFocusEl === document.activeElement)\r\n               {\r\n                  if (lastFocusEl instanceof HTMLElement && firstFocusEl !== lastFocusEl) { lastFocusEl.focus(); }\r\n\r\n                  event.preventDefault();\r\n               }\r\n            }\r\n\r\n            break;\r\n\r\n         default:\r\n            // Any other key stop propagation preventing any global key handlers from responding.\r\n            event.stopPropagation();\r\n            break;\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Handle key commands for closing the menu ('Esc') and reverse focus cycling via 'Shift-Tab'. Also stop propagation\r\n    * for the key code assigned for menu item selection ('Enter').\r\n    *\r\n    * @param {KeyboardEvent}  event - KeyboardEvent.\r\n    */\r\n   function onKeyupMenu(event)\r\n   {\r\n      switch (event.code)\r\n      {\r\n         case 'Escape':\r\n            if (!closed)\r\n            {\r\n               closed = true;\r\n               menuEl.dispatchEvent(new CustomEvent('close:popup',\r\n                { bubbles: true, cancelable: true, detail: { keyboardFocus: hasKeyboardFocus } }));\r\n            }\r\n\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            break;\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Handle key presses on menu items.\r\n    *\r\n    * @param {KeyboardEvent}     event - KeyboardEvent.\r\n    *\r\n    * @param {TJSMenuItemData}   [item] - Menu item data.\r\n    */\r\n   function onKeyupItem(event, item)\r\n   {\r\n      if (event.code === keyCode)\r\n      {\r\n         const callback = item?.onPress;\r\n\r\n         if (typeof callback === 'function') { callback(item, focusOptions); }\r\n\r\n         if (!closed)\r\n         {\r\n            closed = true;\r\n\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n\r\n            menuEl.dispatchEvent(new CustomEvent('close:popup',\r\n             { bubbles: true, cancelable: true, detail: { keyboardFocus: hasKeyboardFocus } }));\r\n         }\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Closes menu when browser window is blurred.\r\n    */\r\n   function onWindowBlur()\r\n   {\r\n      if (!closed)\r\n      {\r\n         closed = true;\r\n         menuEl.dispatchEvent(new CustomEvent('close:popup', { bubbles: true, cancelable: true }));\r\n      }\r\n   }\r\n</script>\r\n\r\n<!-- bind to `document.body` to receive pointer down & scroll wheel events to close the menu. -->\r\n<svelte:body on:pointerdown={onClose} on:wheel={onClose}/>\r\n\r\n<!-- bind to 'window' to close menu when browser window is blurred. -->\r\n<svelte:window on:blur={onWindowBlur}/>\r\n\r\n<!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\r\n<nav class=tjs-menu\r\n     bind:this={menuEl}\r\n     on:click|preventDefault|stopPropagation={() => null}\r\n     on:keydown|stopPropagation={onKeydownMenu}\r\n     on:keyup|preventDefault|stopPropagation={onKeyupMenu}\r\n     on:pointerdown|stopPropagation={() => null}\r\n     on:pointerup|stopPropagation={() => null}\r\n     transition:animate|global\r\n     use:applyStyles={styles}\r\n     use:efx\r\n     tabindex=-1\r\n   >\r\n\r\n   <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\r\n   <ol class=tjs-menu-items role=menu>\r\n      <!-- TJSMenu supports hosting a slot for menu content -->\r\n      <slot>\r\n         {#if isSvelteComponent(menu?.slotDefault?.class)}\r\n            <svelte:component this={menu.slotDefault.class} {...(isObject(menu?.slotDefault?.props) ? menu.slotDefault.props : {})} />\r\n         {/if}\r\n      </slot>\r\n\r\n      {#if $$slots.before}\r\n         <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\r\n         <li class=tjs-menu-item\r\n             on:click={() => onClick()}\r\n             on:keyup={(event) => onKeyupItem(event)}\r\n             role=menuitem\r\n             tabindex=0>\r\n            <span class=tjs-menu-focus-indicator />\r\n            <slot name=before />\r\n         </li>\r\n      {/if}\r\n      {#each allItems as item}\r\n         {#if item['#type'] === 'class'}\r\n            <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\r\n            <li class=tjs-menu-item\r\n                on:click={() => onClick(item)}\r\n                on:keyup={(event) => onKeyupItem(event, item)}\r\n                role=menuitem\r\n                tabindex=0>\r\n               <span class=tjs-menu-focus-indicator />\r\n               <svelte:component this={item.class} {...(isObject(item.props) ? item.props : {})} />\r\n            </li>\r\n         {:else if item['#type'] === 'icon'}\r\n            <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\r\n            <li class=\"tjs-menu-item tjs-menu-item-button\"\r\n                 on:click={() => onClick(item)}\r\n                 on:keyup={(event) => onKeyupItem(event, item)}\r\n                 role=menuitem\r\n                 tabindex=0>\r\n               <span class=tjs-menu-focus-indicator />\r\n               <i class={item.icon}></i>\r\n               <span class=tjs-menu-item-label>{localize(item.label)}</span>\r\n            </li>\r\n         {:else if item['#type'] === 'image'}\r\n            <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\r\n            <li class=\"tjs-menu-item tjs-menu-item-button\"\r\n                 on:click={() => onClick(item)}\r\n                 on:keyup={(event) => onKeyupItem(event, item)}\r\n                 role=menuitem\r\n                 tabindex=0>\r\n               <span class=tjs-menu-focus-indicator />\r\n               <img src={item.image} alt={item.imageAlt}>\r\n               <span class=tjs-menu-item-label>{localize(item.label)}</span>\r\n            </li>\r\n         {:else if item['#type'] === 'separator-hr'}\r\n            <hr>\r\n         {/if}\r\n      {/each}\r\n      {#if $$slots.after}\r\n         <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\r\n         <li class=tjs-menu-item\r\n             on:click={() => onClick()}\r\n             on:keyup={(event) => onKeyupItem(event)}\r\n             role=menuitem\r\n             tabindex=0>\r\n            <span class=tjs-menu-focus-indicator />\r\n            <slot name=after />\r\n         </li>\r\n      {/if}\r\n   </ol>\r\n   <TJSFocusWrap elementRoot={menuEl} />\r\n</nav>\r\n\r\n<style>\r\n   .tjs-menu {\r\n      position: absolute;\r\n      width: max-content;\r\n      height: max-content;\r\n      overflow: hidden;\r\n\r\n      background: var(--tjs-menu-background, var(--tjs-default-menu-background, var(--tjs-default-popup-background, #23221d)));\r\n      border: var(--tjs-menu-border, var(--tjs-default-popup-border, 1px solid #000));\r\n      border-radius: var(--tjs-menu-border-radius, var(--tjs-default-popup-border-radius, 5px));\r\n      box-shadow: var(--tjs-menu-box-shadow, var(--tjs-default-popup-box-shadow, 0 0 2px #000));\r\n      color: var(--tjs-menu-primary-color, var(--tjs-default-menu-primary-color, var(--tjs-default-popup-primary-color, #b5b3a4)));\r\n      max-width: var(--tjs-menu-max-width, var(--tjs-default-menu-max-width, 360px));\r\n      min-width: var(--tjs-menu-min-width, var(--tjs-default-menu-min-width, 20px));\r\n\r\n      text-align: start;\r\n\r\n      /* Defines z-index in local stacking context */\r\n      z-index: var(--tjs-menu-z-index, var(--tjs-default-popup-z-index, 100));\r\n   }\r\n\r\n   .tjs-menu:focus-visible {\r\n      outline: var(--tjs-default-a11y-outline-focus-visible, 2px solid transparent);\r\n   }\r\n\r\n   .tjs-menu-items {\r\n      margin: 0;\r\n      padding: 0;\r\n   }\r\n\r\n   .tjs-menu-items hr {\r\n      margin-block-start: 0;\r\n      margin-block-end: 0;\r\n      margin: var(--tjs-menu-hr-margin, var(--tjs-default-hr-margin, 0 0.25em));\r\n      border-top: var(--tjs-menu-hr-border-top, var(--tjs-default-hr-border-top, 1px solid #555));\r\n      border-bottom: var(--tjs-menu-hr-border-bottom, var(--tjs-default-hr-border-bottom, 1px solid #444));\r\n   }\r\n\r\n   .tjs-menu-item {\r\n      display: flex;\r\n      align-items: center;\r\n      line-height: var(--tjs-menu-item-line-height, var(--tjs-default-menu-item-line-height, 2em));\r\n      padding: var(--tjs-menu-item-padding, var(--tjs-default-menu-item-padding, 0 0.5em 0 0));\r\n   }\r\n\r\n   /* Disable default outline for focus visible / within */\r\n   .tjs-menu-item:focus-within, .tjs-menu-item:focus-visible {\r\n      outline: none;\r\n   }\r\n\r\n   .tjs-menu-item i {\r\n      text-align: center;\r\n      width: var(--tjs-menu-item-icon-width, var(--tjs-default-menu-item-icon-width, 1.25em));\r\n   }\r\n\r\n   .tjs-menu-item img {\r\n      width: var(--tjs-menu-item-image-width, var(--tjs-default-menu-item-image-width, 1.25em));\r\n      height: var(--tjs-menu-item-image-height, var(--tjs-default-menu-item-image-height, 1.25em));\r\n   }\r\n\r\n   .tjs-menu-item-button {\r\n      gap: var(--tjs-menu-item-button-gap, var(--tjs-default-menu-item-button-gap, 0.25em));\r\n   }\r\n\r\n   .tjs-menu-item-button:hover {\r\n      color: var(--tjs-menu-item-highlight-color, var(--tjs-default-menu-highlight-color, var(--tjs-default-popup-highlight-color, #f0f0e0)));\r\n      text-shadow: var(--tjs-menu-item-text-shadow-focus-hover, var(--tjs-default-text-shadow-focus-hover, 0 0 8px red));\r\n   }\r\n\r\n   .tjs-menu-item-button:focus-visible {\r\n      color: var(--tjs-menu-item-highlight-color, var(--tjs-default-menu-highlight-color, var(--tjs-default-popup-highlight-color, #f0f0e0)));\r\n      text-shadow: var(--tjs-menu-item-text-shadow-focus-hover, var(--tjs-default-text-shadow-focus-hover, 0 0 8px red));\r\n   }\r\n\r\n   .tjs-menu-focus-indicator {\r\n      align-self: var(--tjs-menu-focus-indicator-align-self, var(--tjs-default-focus-indicator-align-self, stretch));\r\n      border: var(--tjs-menu-focus-indicator-border, var(--tjs-default-focus-indicator-border));\r\n      border-radius: var(--tjs-menu-focus-indicator-border-radius, var(--tjs-default-focus-indicator-border-radius, 0.1em));\r\n      height: var(--tjs-menu-focus-indicator-height, var(--tjs-default-focus-indicator-height));\r\n      width: var(--tjs-menu-focus-indicator-width, var(--tjs-default-focus-indicator-width, 0.25em));\r\n      transition: var(--tjs-menu-focus-indicator-transition, var(--tjs-default-focus-indicator-transition));\r\n   }\r\n\r\n   /* Enable focus indicator for focus-within */\r\n   /* Note: the use of `has` pseudo-selector that requires a child with :focus-visible */\r\n   .tjs-menu-item:focus-within:has(:focus-visible) .tjs-menu-focus-indicator {\r\n      background: var(--tjs-menu-focus-indicator-background, var(--tjs-default-focus-indicator-background, white));\r\n   }\r\n\r\n   /* Fallback for browsers that don't support 'has'; any user interaction including mouse will trigger */\r\n   @supports not (selector(:has(*))) {\r\n      .tjs-menu-item:focus-within .tjs-menu-focus-indicator {\r\n         background: var(--tjs-menu-focus-indicator-background, var(--tjs-default-focus-indicator-background, white));\r\n      }\r\n   }\r\n\r\n   /* Enable focus indicator for focus visible */\r\n   .tjs-menu-item:focus-visible .tjs-menu-focus-indicator {\r\n      background: var(--tjs-menu-focus-indicator-background, var(--tjs-default-focus-indicator-background, white));\r\n   }\r\n\r\n   .tjs-menu-item-label {\r\n      overflow: var(--tjs-menu-item-label-overflow, var(--tjs-default-menu-item-label-overflow, hidden));\r\n      text-overflow: var(--tjs-menu-item-label-text-overflow, var(--tjs-default-menu-item-label-text-overflow, ellipsis));\r\n      white-space: var(--tjs-menu-item-label-white-space, var(--tjs-default-menu-item-label-white-space));\r\n   }\r\n</style>\r\n","<script>\r\n   /**\r\n    * TJSContextMenuImpl provides a context menu implementation component that is not meant to be directly used as it is\r\n    * controlled as a single browser wide context menu from {@link TJSContextMenu} that is imported via:\r\n    * `import { TJSContextMenu } from '@typhonjs-fvtt/svelte-standard/application';` The front end for TJSContextMenuImpl processes data and\r\n    * invokes / manages a single context menu.\r\n    *\r\n    * TJSContextMenuImpl supports a flexible data driven way to construct the menu items with the same format as\r\n    * {@link TJSMenu}. Depending on the item data that is passed into the menu you can define 4 types of items:\r\n    * 'icon / label', 'image / label', 'class / Svelte component', and 'separator / hr'. The main difference is that\r\n    * TJSContextMenu does not support default or named slots.\r\n    *\r\n    * ----------------------------------------------------------------------------------------------------------------\r\n    * Exported props include:\r\n    * `menu` ({@link TJSMenuData}): An object defining all properties of a menu.\r\n    *\r\n    * Or in lieu of passing the folder object you can assign these props directly:\r\n    * `items`: An iterable list of {@link TJSContextMenuItemData}; defines data driven menu items.\r\n    * `styles`: Styles to be applied inline via `applyStyles` action.\r\n    * `efx`: Currently unused; for any future action effects.\r\n    * `keyCode`: The key code to activate menu items.\r\n    * `focusSource`: A `A11yFocusSource` object containing the target element to return focus to on close.\r\n    * `transitionOptions`: Custom transition options for duration and easing function.\r\n    *\r\n    * ----------------------------------------------------------------------------------------------------------------\r\n    * Events: There is a single that is fired and _not_ bubbled up through parent elements:\r\n    * `close`- Fired when the menu closes allowing {@link TJSContextMenu} to clean up resources.\r\n    *\r\n    * ----------------------------------------------------------------------------------------------------------------\r\n    * Styling: To style this component use `.tjs-context-menu` as the base selector.\r\n    *\r\n    * There are several local CSS variables that you can use to change the appearance dynamically. Either use\r\n    * CSS props or pass in a `styles` object w/ key / value props to set to the details. The default fallback variables\r\n    * target both TJSMenu and TJSContextMenu. The few `popover` defaults target components that independently pop over\r\n    * other elements browser wide.\r\n    *\r\n    * The following CSS variables are supported, but not defined by default.\r\n    * --tjs-context-menu-background - fallback: --tjs-default-menu-background; fallback: --tjs-default-popup-background; default: #23221d\r\n    * --tjs-context-menu-border - fallback: --tjs-default-popup-border; default: 1px solid #000\r\n    * --tjs-context-menu-border-radius - fallback: --tjs-default-popup-border-radius; default: 5px\r\n    * --tjs-context-menu-box-shadow - fallback: --tjs-default-popup-box-shadow; default: 0 0 2px #000\r\n    * --tjs-context-menu-primary-color - fallback: --tjs-default-menu-primary-color; fallback: --tjs-default-popup-primary-color; default: #b5b3a4\r\n    * --tjs-context-menu-max-width - fallback: --tjs-default-menu-max-width; default: 360px\r\n    * --tjs-context-menu-min-width - fallback: --tjs-default-menu-min-width; default: 20px\r\n    *\r\n    * The following CSS variables define attributes for the data driven menu items.\r\n    *\r\n    * All menu items:\r\n    * --tjs-context-menu-item-line-height - fallback: --tjs-default-menu-item-line-height; default: 2em\r\n    * --tjs-context-menu-item-padding - fallback: --tjs-default-menu-item-padding; default: 0 0.5em 0 0\r\n    *\r\n    * Icon / Image menu items (considered a button item):\r\n    * --tjs-context-menu-item-button-gap - fallback: --tjs-default-menu-item-button-gap; default: 0.25em\r\n    * --tjs-context-menu-item-highlight-color - fallback: --tjs-default-menu-highlight-color; fallback: --tjs-default-popup-highlight-color; default: #f0f0e0\r\n    * --tjs-context-menu-item-text-shadow-focus-hover - fallback: --tjs-default-text-shadow-focus-hover; default: 0 0 8px red\r\n    *\r\n    * Specific targeting for the label of button items (allows control of wrapping / set `white-space` to `nowrap`):\r\n    * --tjs-context-menu-item-label-overflow - fallback: --tjs-default-menu-item-label-overflow; default: hidden\r\n    * --tjs-context-menu-item-label-text-overflow - fallback: --tjs-default-menu-item-label-text-overflow; default: ellipsis\r\n    * --tjs-context-menu-item-label-white-space - fallback: --tjs-default-menu-item-label-white-space; default: undefined\r\n    *\r\n    * Icon menu item:\r\n    * --tjs-context-menu-item-icon-width - fallback: --tjs-default-menu-item-icon-width; default: 1.25em\r\n    *\r\n    * Image menu item:\r\n    * --tjs-context-menu-item-image-width - fallback: --tjs-default-menu-item-image-width; default: 1.25em\r\n    * --tjs-context-menu-item-image-height - fallback: --tjs-default-menu-item-image-height; default: 1.25em\r\n    *\r\n    * Separator / HR:\r\n    * --tjs-context-menu-hr-margin - fallback: --tjs-default-hr-margin; default: 0 0.25em\r\n    * --tjs-context-menu-hr-border-top - fallback: --tjs-default-hr-border-top; default: 1px solid #555\r\n    * --tjs-context-menu-hr-border-bottom - fallback: --tjs-default-hr-border-bottom; default: 1px solid #444\r\n    *\r\n    * The following CSS variables define the keyboard / a11y focus indicator for menu items:\r\n    * --tjs-context-menu-focus-indicator-align-self - fallback: --tjs-default-focus-indicator-align-self; default: stretch\r\n    * --tjs-context-menu-focus-indicator-background - fallback: --tjs-default-focus-indicator-background; default: white\r\n    * --tjs-context-menu-focus-indicator-border - fallback: --tjs-default-focus-indicator-border; default: undefined\r\n    * --tjs-context-menu-focus-indicator-border-radius - fallback: --tjs-default-focus-indicator-border-radius; default: 0.1em\r\n    * --tjs-context-menu-focus-indicator-height - fallback: --tjs-default-focus-indicator-height; default: undefined\r\n    * --tjs-context-menu-focus-indicator-width - fallback: --tjs-default-focus-indicator-width; default: 0.25em\r\n    * --tjs-menu-focus-indicator-transition - fallback: --tjs-default-focus-indicator-transition\r\n    */\r\n\r\n   import {\r\n      createEventDispatcher,\r\n      onMount }                     from 'svelte';\r\n\r\n   import { current_component }     from 'svelte/internal';\r\n\r\n   import { applyStyles }           from '@typhonjs-fvtt/runtime/svelte/action/dom';\r\n   import { localize }              from '@typhonjs-fvtt/runtime/svelte/helper';\r\n   import { slideFade }             from '@typhonjs-fvtt/runtime/svelte/transition';\r\n\r\n   import { outroAndDestroy }       from '@typhonjs-fvtt/runtime/svelte/util';\r\n\r\n   import { A11yHelper }            from '@typhonjs-fvtt/runtime/util/browser';\r\n\r\n   import { isObject }              from '@typhonjs-fvtt/runtime/util/object';\r\n\r\n   import { TJSFocusWrap }          from '@typhonjs-fvtt/runtime/svelte/component/core';\r\n\r\n   export let menu = void 0;\r\n\r\n   export let id = '';\r\n\r\n   export let x = 0;\r\n\r\n   export let y = 0;\r\n\r\n   export let items = [];\r\n\r\n   export let zIndex = Number.MAX_SAFE_INTEGER - 100;\r\n\r\n   /** @type {Record<string, string>} */\r\n   export let styles = void 0;\r\n\r\n   /** @type {string} */\r\n   export let keyCode = void 0;\r\n\r\n   export let focusSource = void 0;\r\n\r\n   /** @type {{ duration: number, easing: Function }} */\r\n   export let transitionOptions = void 0;\r\n\r\n   $: styles = isObject(menu) && isObject(menu.styles) ? menu.styles :\r\n    isObject(styles) ? styles : void 0;\r\n\r\n   $: keyCode = isObject(menu) && typeof menu.keyCode === 'string' ? menu.keyCode :\r\n    typeof keyCode === 'string' ? keyCode : 'Enter';\r\n\r\n   // Provides options to `A11yHelper.getFocusableElements` to ignore TJSFocusWrap by CSS class.\r\n   const s_IGNORE_CLASSES = { ignoreClasses: ['tjs-focus-wrap'] };\r\n\r\n   // Store this component reference.\r\n   const local = current_component;\r\n\r\n   // Dispatches `close` event.\r\n   const dispatch = createEventDispatcher();\r\n\r\n   // Bound to the nav element / menu.\r\n   let menuEl;\r\n\r\n   // Stores if this context menu is closed.\r\n   let closed = false;\r\n\r\n   // Stores if menu has keyboard focus; detected on mount, when tab navigation occurs, and used to set `keypress` for\r\n   // close event.\r\n   // let hasKeyboardFocus = false;\r\n\r\n   // ----------------------------------------------------------------------------------------------------------------\r\n\r\n   onMount(() =>\r\n   {\r\n      const keyboardFocus = focusSource?.source === 'keyboard';\r\n\r\n      // If the focus options designate that the source of the context menu came from the keyboard then focus the first\r\n      // menu item on mount.\r\n      if (keyboardFocus)\r\n      {\r\n         const firstFocusEl = A11yHelper.getFirstFocusableElement(menuEl);\r\n         if (firstFocusEl instanceof HTMLElement && !firstFocusEl.classList.contains('tjs-focus-wrap'))\r\n         {\r\n            firstFocusEl.focus();\r\n         }\r\n         else\r\n         {\r\n            // Silently focus the menu element so that keyboard handling functions.\r\n            menuEl.focus();\r\n         }\r\n      }\r\n      else\r\n      {\r\n         // Silently focus the menu element so that keyboard handling functions.\r\n         menuEl.focus();\r\n      }\r\n   });\r\n\r\n   // ----------------------------------------------------------------------------------------------------------------\r\n\r\n   /**\r\n    * Provides a custom animate callback allowing inspection of the element to change positioning styles based on the\r\n    * height / width of the element and `document.body`. This allows the context menu to expand up when the menu\r\n    * is outside the height bound of `document.body` and expand to the left if width is greater than `document.body`.\r\n    *\r\n    * @param {HTMLElement} node - nav element.\r\n    *\r\n    * @returns {object} Transition object.\r\n    */\r\n   function animate(node)\r\n   {\r\n      const expandUp = y + node.clientHeight > document.body.clientHeight\r\n      const expandLeft = x + node.clientWidth > document.body.clientWidth\r\n\r\n      node.style.top = expandUp ? null : `${y}px`;\r\n      node.style.bottom = expandUp ? `${document.body.clientHeight - y}px` : null;\r\n\r\n      node.style.left = expandLeft ? null : `${x}px`;\r\n      node.style.right = expandLeft ? `${document.body.clientWidth - x}px` : null;\r\n\r\n      return slideFade(node, transitionOptions);\r\n   }\r\n\r\n   /**\r\n    * Invokes a function on click of a menu item then fires the `close` event and automatically runs the outro\r\n    * transition and destroys the component.\r\n    *\r\n    * @param {object} item - Function to invoke on click.\r\n    */\r\n   function onClick(item)\r\n   {\r\n      const callback = item?.onPress;\r\n\r\n      if (typeof callback === 'function')\r\n      {\r\n         callback(item, { focusSource });\r\n      }\r\n      else\r\n      {\r\n         A11yHelper.applyFocusSource(focusSource)\r\n         focusSource = void 0;\r\n      }\r\n\r\n      if (!closed)\r\n      {\r\n         dispatch('close');\r\n         closed = true;\r\n         outroAndDestroy(local);\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Determines if a pointer pressed to the document body closes the context menu. If the click occurs outside the\r\n    * context menu then fire the `close` event and run the outro transition then destroy the component.\r\n    *\r\n    * @param {PointerEvent|MouseEvent}  event - Pointer or mouse event from document body click / scroll wheel.\r\n    *\r\n    * @param {boolean}                  [isWheel=false] - True when scroll wheel; do not perform 2nd early out test.\r\n    */\r\n   function onClose(event, isWheel = false)\r\n   {\r\n      // Early out if the pointer down is inside the menu element.\r\n      if (event.target === menuEl || menuEl.contains(event.target)) { return; }\r\n\r\n      // Early out if the event page X / Y is the same as this context menu.\r\n      if (!isWheel && Math.floor(event.pageX) === x && Math.floor(event.pageY) === y) { return; }\r\n\r\n      if (!closed)\r\n      {\r\n         dispatch('close');\r\n         closed = true;\r\n         outroAndDestroy(local);\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Handle key commands for closing the menu ('Esc') and reverse focus cycling via 'Shift-Tab'. Also stop propagation\r\n    * for the key code assigned for menu item selection ('Enter').\r\n    *\r\n    * @param {KeyboardEvent}  event - KeyboardEvent.\r\n    */\r\n   function onKeydownMenu(event)\r\n   {\r\n      // Handle menu item keyCode selection.\r\n      if (event.code === keyCode)\r\n      {\r\n         event.stopPropagation();\r\n         return;\r\n      }\r\n\r\n      switch (event.code)\r\n      {\r\n         case 'Tab':\r\n            event.stopPropagation();\r\n\r\n            // Handle reverse focus cycling with `<Shift-Tab>`.\r\n            if (event.shiftKey)\r\n            {\r\n               // Collect all focusable elements from `elementRoot` and ignore TJSFocusWrap.\r\n               const allFocusable = A11yHelper.getFocusableElements(menuEl, s_IGNORE_CLASSES);\r\n\r\n               // Find first and last focusable elements.\r\n               const firstFocusEl = allFocusable.length > 0 ? allFocusable[0] : void 0;\r\n               const lastFocusEl = allFocusable.length > 0 ? allFocusable[allFocusable.length - 1] : void 0;\r\n\r\n               // Only cycle focus to the last keyboard focusable app element if `elementRoot` or first focusable\r\n               // element is the active element.\r\n               if (menuEl === document.activeElement || firstFocusEl === document.activeElement)\r\n               {\r\n                  if (lastFocusEl instanceof HTMLElement && firstFocusEl !== lastFocusEl) { lastFocusEl.focus(); }\r\n\r\n                  event.preventDefault();\r\n               }\r\n            }\r\n\r\n            break;\r\n\r\n         default:\r\n            // Any other key stop propagation preventing any global key handlers from responding.\r\n            event.stopPropagation();\r\n            break;\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Handle key commands for closing the menu ('Esc') and reverse focus cycling via 'Shift-Tab'. Also stop propagation\r\n    * for the key code assigned for menu item selection ('Enter').\r\n    *\r\n    * @param {KeyboardEvent}  event - KeyboardEvent.\r\n    */\r\n   function onKeyupMenu(event)\r\n   {\r\n      switch (event.code)\r\n      {\r\n         case 'ContextMenu':\r\n         case 'Escape':\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n\r\n            if (!closed)\r\n            {\r\n               closed = true;\r\n               dispatch('close');\r\n               outroAndDestroy(local);\r\n\r\n               A11yHelper.applyFocusSource(focusSource)\r\n               focusSource = void 0;\r\n            }\r\n            break;\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Handle key presses on menu items.\r\n    *\r\n    * @param {KeyboardEvent}     event - KeyboardEvent.\r\n    *\r\n    * @param {TJSMenuItemData}   item - Menu item data.\r\n    */\r\n   function onKeyupItem(event, item)\r\n   {\r\n      if (event.code === keyCode)\r\n      {\r\n         if (!closed)\r\n         {\r\n            closed = true;\r\n            dispatch('close');\r\n            outroAndDestroy(local);\r\n\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n         }\r\n\r\n         const callback = item?.onPress;\r\n         if (typeof callback === 'function')\r\n         {\r\n            callback(item, { focusSource });\r\n         }\r\n         else\r\n         {\r\n            A11yHelper.applyFocusSource(focusSource)\r\n            focusSource = void 0;\r\n         }\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Closes context menu when browser window is blurred.\r\n    */\r\n   function onWindowBlur()\r\n   {\r\n      if (!closed)\r\n      {\r\n         dispatch('close');\r\n         closed = true;\r\n         outroAndDestroy(local);\r\n\r\n         A11yHelper.applyFocusSource(focusSource)\r\n         focusSource = void 0;\r\n      }\r\n   }\r\n</script>\r\n\r\n<!-- bind to `document.body` to receive pointer down & scroll wheel events to close the context menu. -->\r\n<svelte:body on:pointerdown={onClose} on:wheel={(event) => onClose(event, true)}/>\r\n\r\n<!-- bind to 'window' to close context menu when browser window is blurred. -->\r\n<svelte:window on:blur={onWindowBlur}/>\r\n\r\n<!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\r\n<nav id={id}\r\n     class=tjs-context-menu\r\n     bind:this={menuEl}\r\n     on:click|preventDefault|stopPropagation={() => null}\r\n     on:keydown|stopPropagation={onKeydownMenu}\r\n     on:keyup|preventDefault|stopPropagation={onKeyupMenu}\r\n     style:z-index={zIndex}\r\n     transition:animate|global\r\n     use:applyStyles={styles}\r\n     tabindex=-1>\r\n\r\n    <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\r\n    <ol class=tjs-context-menu-items role=menu>\r\n        {#each items as item}\r\n            {#if item['#type'] === 'class'}\r\n                <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\r\n                <li class=tjs-context-menu-item\r\n                    on:click={() => onClick(item)}\r\n                    on:keyup={(event) => onKeyupItem(event, item)}\r\n                    role=menuitem\r\n                    tabindex=0>\r\n                    <span class=tjs-context-menu-focus-indicator />\r\n                    <svelte:component this={item.class} {...(isObject(item.props) ? item.props : {})} />\r\n                </li>\r\n            {:else if item['#type'] === 'icon'}\r\n                <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\r\n                <li class=\"tjs-context-menu-item tjs-context-menu-item-button\"\r\n                    on:click={() => onClick(item)}\r\n                    on:keyup={(event) => onKeyupItem(event, item)}\r\n                    role=menuitem\r\n                    tabindex=0>\r\n                    <span class=tjs-context-menu-focus-indicator />\r\n                    <i class={item.icon}></i>\r\n                    <span class=tjs-context-menu-item-label>{localize(item.label)}</span>\r\n                </li>\r\n            {:else if item['#type'] === 'image'}\r\n                <!-- svelte-ignore a11y-no-noninteractive-element-to-interactive-role -->\r\n                <li class=\"tjs-context-menu-item tjs-context-menu-item-button\"\r\n                    on:click={() => onClick(item)}\r\n                    on:keyup={(event) => onKeyupItem(event, item)}\r\n                    role=menuitem\r\n                    tabindex=0>\r\n                    <span class=tjs-context-menu-focus-indicator />\r\n                    <img src={item.image} alt={item.imageAlt}>\r\n                    <span class=tjs-context-menu-item-label>{localize(item.label)}</span>\r\n                </li>\r\n            {:else if item['#type'] === 'separator-hr'}\r\n                <hr>\r\n            {/if}\r\n        {/each}\r\n    </ol>\r\n    <TJSFocusWrap elementRoot={menuEl} />\r\n</nav>\r\n\r\n<style>\r\n    .tjs-context-menu {\r\n        position: fixed;\r\n        width: fit-content;\r\n        height: max-content;\r\n        overflow: hidden;\r\n\r\n        background: var(--tjs-context-menu-background, var(--tjs-default-menu-background, var(--tjs-default-popup-background, #23221d)));\r\n        border: var(--tjs-context-menu-border, var(--tjs-default-popover-border, 1px solid #000));\r\n        border-radius: var(--tjs-context-menu-border-radius, var(--tjs-default-popover-border-radius, 5px));\r\n        box-shadow: var(--tjs-context-menu-box-shadow, var(--tjs-default-popover-box-shadow, 0 0 10px #000));\r\n        color: var(--tjs-context-menu-primary-color, var(--tjs-default-menu-primary-color, var(--tjs-default-popup-primary-color, #b5b3a4)));\r\n        max-width: var(--tjs-context-menu-max-width, var(--tjs-default-menu-max-width, 360px));\r\n        min-width: var(--tjs-context-menu-min-width, var(--tjs-default-menu-min-width, 20px));\r\n\r\n        text-align: start;\r\n    }\r\n\r\n    .tjs-context-menu:focus-visible {\r\n        outline: var(--tjs-default-a11y-outline-focus-visible, 2px solid transparent);\r\n    }\r\n\r\n    .tjs-context-menu-items {\r\n        list-style: none;\r\n        margin: 0;\r\n        padding: 0;\r\n    }\r\n\r\n    .tjs-context-menu-items hr {\r\n        margin-block-start: 0;\r\n        margin-block-end: 0;\r\n        margin: var(--tjs-context-menu-hr-margin, var(--tjs-default-hr-margin, 0 0.25em));\r\n        border-top: var(--tjs-context-menu-hr-border-top, var(--tjs-default-hr-border-top, 1px solid #555));\r\n        border-bottom: var(--tjs-context-menu-hr-border-bottom, var(--tjs-default-hr-border-bottom, 1px solid #444));\r\n    }\r\n\r\n    .tjs-context-menu-item {\r\n        display: flex;\r\n        align-items: center;\r\n        line-height: var(--tjs-context-menu-item-line-height, var(--tjs-default-menu-item-line-height, 2em));\r\n        padding: var(--tjs-context-menu-item-padding, var(--tjs-default-menu-item-padding, 0 0.5em 0 0));\r\n    }\r\n\r\n    /* Disable default outline for focus visible / within */\r\n    .tjs-context-menu-item:focus-within, .tjs-context-menu-item:focus-visible {\r\n        outline: var(--tjs-default-a11y-outline-focus-visible, 2px solid transparent);\r\n    }\r\n\r\n    .tjs-context-menu-item i {\r\n        text-align: center;\r\n        width: var(--tjs-context-menu-item-icon-width, var(--tjs-default-menu-item-icon-width, 1.25em));\r\n    }\r\n\r\n    .tjs-context-menu-item img {\r\n        width: var(--tjs-context-menu-item-image-width, var(--tjs-default-menu-item-image-width, 1.25em));\r\n        height: var(--tjs-context-menu-item-image-height, var(--tjs-default-menu-item-image-height, 1.25em));\r\n    }\r\n\r\n    .tjs-context-menu-item-button {\r\n        gap: var(--tjs-context-menu-item-button-gap, var(--tjs-default-menu-item-button-gap, 0.25em));\r\n    }\r\n\r\n    .tjs-context-menu-item-button:hover {\r\n        color: var(--tjs-context-menu-item-highlight-color, var(--tjs-default-menu-highlight-color, var(--tjs-default-popup-highlight-color, #f0f0e0)));\r\n        text-shadow: var(--tjs-context-menu-item-text-shadow-focus-hover, var(--tjs-default-text-shadow-focus-hover, 0 0 8px red));\r\n    }\r\n\r\n    .tjs-context-menu-item-button:focus-visible {\r\n        color: var(--tjs-context-menu-item-highlight-color, var(--tjs-default-menu-highlight-color, var(--tjs-default-popup-highlight-color, #f0f0e0)));\r\n        text-shadow: var(--tjs-context-menu-item-text-shadow-focus-hover, var(--tjs-default-text-shadow-focus-hover, 0 0 8px red));\r\n    }\r\n\r\n    .tjs-context-menu-focus-indicator {\r\n        align-self: var(--tjs-context-menu-focus-indicator-align-self, var(--tjs-default-focus-indicator-align-self, stretch));\r\n        border: var(--tjs-context-menu-focus-indicator-border, var(--tjs-default-focus-indicator-border));\r\n        border-radius: var(--tjs-context-menu-focus-indicator-border-radius, var(--tjs-default-focus-indicator-border-radius, 0.1em));\r\n        height: var(--tjs-context-menu-focus-indicator-height, var(--tjs-default-focus-indicator-height));\r\n        width: var(--tjs-context-menu-focus-indicator-width, var(--tjs-default-focus-indicator-width, 0.25em));\r\n        transition: var(--tjs-context-menu-focus-indicator-transition, var(--tjs-default-focus-indicator-transition));\r\n    }\r\n\r\n    .tjs-context-menu-item:focus-visible .tjs-context-menu-focus-indicator {\r\n        background: var(--tjs-context-menu-focus-indicator-background, var(--tjs-default-focus-indicator-background, white));\r\n    }\r\n\r\n    /* Enable focus indicator for focus-within */\r\n    /* Note: the use of `has` pseudo-selector that requires a child with :focus-visible */\r\n    .tjs-context-menu-item:focus-within:has(:focus-visible) .tjs-context-menu-focus-indicator {\r\n        background: var(--tjs-context-menu-focus-indicator-background, var(--tjs-default-focus-indicator-background, white));\r\n    }\r\n\r\n    /* Fallback for browsers that don't support 'has'; any user interaction including mouse will trigger */\r\n    @supports not (selector(:has(*))) {\r\n        .tjs-context-menu-item:focus-within .tjs-context-menu-focus-indicator {\r\n            background: var(--tjs-context-menu-focus-indicator-background, var(--tjs-default-focus-indicator-background, white));\r\n        }\r\n    }\r\n\r\n    .tjs-context-menu-item-label {\r\n        overflow: var(--tjs-context-menu-item-label-overflow, var(--tjs-default-menu-item-label-overflow, hidden));\r\n        text-overflow: var(--tjs-context-menu-item-label-text-overflow, var(--tjs-default-menu-item-label-text-overflow, ellipsis));\r\n        white-space: var(--tjs-context-menu-item-label-white-space, var(--tjs-default-menu-item-label-white-space));\r\n    }\r\n</style>\r\n","import { SvelteApplication }  from '@typhonjs-fvtt/runtime/svelte/application';\r\nimport { isObject }           from '@typhonjs-fvtt/runtime/util/object';\r\n\r\nimport { FoundryStyles }      from '@typhonjs-fvtt/svelte-standard/fvtt';\r\n\r\nimport { cssVariables }       from '../internal/index.js';     // TODO: Figure out better build to use #internal again.\r\n\r\nexport * from './button/index.js';\r\nexport * from './color/index.js';\r\nexport * from './container/index.js';\r\nexport * from './editor/index.js';\r\nexport * from './folder/index.js';\r\nexport * from './form/index.js';\r\nexport * from './label/index.js';\r\nexport * from './layers/index.js';\r\nexport * from './menu/index.js';\r\nexport * from './settings/index.js';\r\n\r\n// -------------------------------------------------------------------------------------------------------------------\r\n\r\n/**\r\n * Assign all TyphonJS thematic CSS variables.\r\n */\r\n\r\ncssVariables.setProperties({\r\n   // For components w/ transparent background checkered pattern.\r\n   '--tjs-checkerboard-background-dark': 'rgb(205, 205, 205)',\r\n   '--tjs-checkerboard-background-10': `url('data:image/svg+xml;utf8,<svg preserveAspectRatio=\"none\"  viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\"><rect x=\"0\" y=\"0\" width=\"5\" height=\"5\" fill=\"transparent\" /><rect x=\"5\" y=\"5\" width=\"5\" height=\"5\" fill=\"transparent\" /><rect x=\"5\" y=\"0\" width=\"5\" height=\"5\" fill=\"white\" /><rect x=\"0\" y=\"5\" width=\"5\" height=\"5\" fill=\"white\" /></svg>') 0 0 / 10px 10px, var(--tjs-checkerboard-background-dark, rgb(205, 205, 205))`\r\n}, false);\r\n\r\n// -------------------------------------------------------------------------------------------------------------------\r\n\r\n/**\r\n * Assign all TyphonJS CSS variables to Foundry defaults.\r\n */\r\n\r\ncssVariables.setProperties({\r\n   '--tjs-action-ripple-background': 'rgba(0, 0, 0, 0.35)'\r\n}, false);\r\n\r\n// -------------------------------------------------------------------------------------------------------------------\r\n\r\ncssVariables.setProperties({\r\n   '--tjs-icon-button-background-hover': 'rgba(0, 0, 0, 0.10)',\r\n   '--tjs-icon-button-background-selected': 'rgba(0, 0, 0, 0.20)',\r\n}, false);\r\n\r\n{\r\n   /**\r\n    * All input related components including: TJSSelect,\r\n    */\r\n   const props = FoundryStyles.getProperties('input[type=\"text\"], input[type=\"number\"]');\r\n\r\n   if (isObject(props))\r\n   {\r\n      cssVariables.setProperties({\r\n         '--tjs-input-background': 'background' in props ? props.background : 'rgba(0, 0, 0, 0.05)',\r\n         '--tjs-input-border': 'border' in props ? props.border : '1px solid var(--color-border-light-tertiary)',\r\n         '--tjs-input-border-radius': 'border-radius' in props ? props['border-radius'] : '3px',\r\n         '--tjs-input-height': 'height' in props ? props.height : 'var(--form-field-height)',\r\n         '--tjs-input-min-width': 'min-width' in props ? props['min-width'] : '20px',\r\n         '--tjs-input-padding': 'padding' in props ? props['padding'] : '1px 3px',\r\n         '--tjs-input-width': 'width' in props ? props.width : 'calc(100% - 2px)',\r\n\r\n         // Set default values that are only to be referenced and not set.\r\n         '--_tjs-default-input-height': 'height' in props ? props.height : 'var(--form-field-height)',\r\n\r\n         // Set directly / no lookup:\r\n         '--tjs-input-border-color': 'var(--color-border-light-tertiary)',\r\n      }, false);\r\n   }\r\n}\r\n\r\ncssVariables.setProperties({\r\n   // `popup` is for components that are slightly elevated, but connected to an application;\r\n   // see: TJSMenu / TJSContextMenu / TJSColordPicker\r\n   '--tjs-default-popup-background': 'var(--color-text-dark-header, #23221d)',\r\n   '--tjs-default-popup-border': '1px solid var(--color-border-dark, #000)',\r\n   '--tjs-default-popup-box-shadow': '0 0 2px var(--color-shadow-dark, #000)',\r\n   '--tjs-default-popup-primary-color': 'var(--color-text-light-primary, #b5b3a4)',\r\n   '--tjs-default-popup-highlight-color': 'var(--color-text-light-highlight, #f0f0e0)',\r\n\r\n   // `popover` is for components that are elevated and independent; see: TJSContextMenu\r\n   '--tjs-default-popover-border': '1px solid var(--color-border-dark, #000)',\r\n   '--tjs-default-popover-box-shadow': '0 0 10px var(--color-shadow-dark, #000)',\r\n}, false);\r\n\r\n// Handle `PopOut!` module hooks to allow applications to popout to their own browser window -------------------------\r\n\r\nHooks.on('PopOut:loading', (app, popout) =>\r\n{\r\n   if (app instanceof SvelteApplication)\r\n   {\r\n      // Clone and load `svelte-standard` CSS variables into new window document.\r\n      popout.document.addEventListener('DOMContentLoaded', () => cssVariables.clone(popout.document));\r\n   }\r\n});\r\n","<script>\r\n\r\n\timport { writable } from \"svelte/store\";\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { TJSMenu, TJSToggleLabel } from '#standard/component';\r\n\r\n\texport let item;\r\n\texport let standalone = false;\r\n\r\n\tlet labelText = \"\";\r\n\r\n\tconst prices = item.prices;\r\n\tconst itemFlagData = item.itemFlagData;\r\n\tconst selectedPriceGroup = item.selectedPriceGroup;\r\n\tconst priceSelector = standalone ? writable(\"\") : item.store.priceSelector;\r\n\r\n\t$: cantAfford = $prices.length > 0 && !$prices[$selectedPriceGroup]?.maxQuantity && item.store.recipient && !standalone;\r\n\t$: cantAffordMultiplePrices = cantAfford && !$prices.filter(group => group.maxQuantity).length;\r\n\t$: labelText = (standalone && $prices.length > 1 ? \"<i class=\\\"fas fa-edit\\\"></i> \" : \"\")\r\n\t\t+ ($prices[$selectedPriceGroup]?.free\r\n\t\t\t\t? localize(\"ITEM-PILES.Merchant.ItemFree\")\r\n\t\t\t\t: $prices[$selectedPriceGroup]?.basePriceString\r\n\t\t);\r\n\r\n</script>\r\n\r\n<div class=\"price-container\">\r\n\t{#if $prices.length > 1}\r\n\t\t<TJSToggleLabel>\r\n\t\t\t<div slot=left\r\n\t\t\t     class:multiple-prices={$prices.length > 1 && !standalone}\r\n\t\t\t     class:cant-afford={cantAfford}\r\n\t\t\t     class:cant-afford-multiple-prices={cantAffordMultiplePrices}\r\n\t\t\t     class:item-piles-clickable-link={$prices.length > 1}>\r\n\t\t\t\t<small>{@html labelText}</small>\r\n\t\t\t</div>\r\n\t\t\t<TJSMenu offset={{y: 4}}>\r\n\t\t\t\t<div class=\"price-list\">\r\n\t\t\t\t\t{#each $prices as priceGroup, index (index)}\r\n\t\t\t\t\t\t<div class=\"price-group\" class:selected={$selectedPriceGroup === index}>\r\n\t\t\t\t\t\t\t{#each priceGroup.prices.filter(price => price.cost) as price (price.id)}\r\n\t\t\t\t\t\t\t\t<div class=\"price-group-container\"\r\n\t\t\t\t\t\t\t\t     on:click={() => {\r\n                         $selectedPriceGroup = index;\r\n                         $priceSelector = \"\";\r\n                       }}\r\n\t\t\t\t\t\t\t\t     class:cant-afford={!priceGroup.maxQuantity && item.store.recipient}>\r\n\t\t\t\t\t\t\t\t\t<div class=\"item-piles-img-container\"\r\n\t\t\t\t\t\t\t\t\t     class:not-for-sale={!price.maxQuantity && item.store.recipient}>\r\n\t\t\t\t\t\t\t\t\t\t<img class=\"item-piles-img\" src=\"{price.img}\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"item-piles-name item-piles-text\">\r\n\t\t\t\t\t\t\t\t\t\t<small>{price.baseCost + (priceGroup.prices.length === 0 && price.percent ? \"%\" : \"\")} {price.name}</small>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</div>\r\n\t\t\t</TJSMenu>\r\n\t\t</TJSToggleLabel>\r\n\t{:else}\r\n\t\t<small class:cant-afford={cantAfford}>{@html labelText}</small>\r\n\t{/if}\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .price-container {\r\n    align-items: center;\r\n    position: relative;\r\n    --tjs-label-justify-content: flex-start;\r\n    --tjs-label-overflow: visible;\r\n    --tjs-menu-primary-color: black;\r\n    --tjs-menu-color: black;\r\n    --tjs-menu-border: 1px solid #444;\r\n    --tjs-menu-box-shadow: 0 6px 9px -1px rgba(0, 0, 0, 0.5);\r\n    display: flex;\r\n    justify-content: center;\r\n    height: 100%;\r\n\r\n    small {\r\n      padding-left: 2px;\r\n    }\r\n\r\n    span {\r\n      justify-content: flex-start;\r\n    }\r\n\r\n    .cant-afford {\r\n      opacity: 0.5;\r\n    }\r\n\r\n    .multiple-prices {\r\n      overflow: visible;\r\n    }\r\n\r\n    .multiple-prices::before,\r\n    .multiple-prices::after {\r\n      content: '';\r\n      position: absolute;\r\n      top: -0.2rem;\r\n      left: -0.2rem;\r\n      border-color: transparent;\r\n      border-style: solid;\r\n    }\r\n\r\n    .multiple-prices::after {\r\n      border-width: 0.3rem;\r\n      border-right-color: #3ead2c;\r\n      transform: rotate(45deg);\r\n    }\r\n\r\n    .cant-afford-multiple-prices::after {\r\n      border-right-color: #cf5234;\r\n    }\r\n\r\n  }\r\n</style>\r\n","<script>\n\timport { localize } from '#runtime/svelte/helper';\n\timport { getContext } from \"svelte\";\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\n\timport { get } from \"svelte/store\";\n\timport * as PileUtilities from \"../../../helpers/pile-utilities.js\";\n\timport PriceSelector from \"../../components/PriceSelector.svelte\";\n\n\tconst { application } = getContext('#external');\n\n\texport let item;\n\texport let seller;\n\texport let buyer;\n\texport let settings;\n\texport let elementRoot;\n\texport let store = item.store;\n\n\tconst itemNameStore = item.name;\n\tconst itemImg = item.img;\n\tconst itemInfiniteQuantity = item.infiniteQuantity;\n\tconst itemRarityColor = item.rarityColor;\n\tconst itemFlagData = item.itemFlagData;\n\tconst quantityToBuy = item.quantityToBuy;\n\tconst itemMaxQuantityStore = item.quantity;\n\tconst itemQuantityForPriceStore = item.quantityForPrice;\n\tconst prices = item.prices;\n\n\tconst sellerPileData = store.pileData;\n\tconst buyerPileData = store.recipientPileData;\n\n\tlet maxItemPurchaseQuantity;\n\tlet currentQuantityToBuy;\n\n\tconst selectedPriceGroup = item.selectedPriceGroup;\n\t$: {\n\t\t$selectedPriceGroup;\n\t\tcurrentQuantityToBuy = 1;\n\t\t$quantityToBuy = 1;\n\t}\n\n\tlet paymentData = {};\n\t$: {\n\t\tpaymentData = PileUtilities.getPaymentData({\n\t\t\tpurchaseData: [{\n\t\t\t\titem: item.item,\n\t\t\t\tquantity: $quantityToBuy,\n\t\t\t\tpaymentIndex: $selectedPriceGroup\n\t\t\t}],\n\t\t\tseller,\n\t\t\tbuyer,\n\t\t\tsellerFlagData: $sellerPileData,\n\t\t\tbuyerFlagData: $buyerPileData,\n\t\t});\n\t}\n\n\t$: maxSellerItemQuantity = $itemInfiniteQuantity ? Infinity : Math.ceil($itemMaxQuantityStore / $itemQuantityForPriceStore);\n\t$: maxItemQuantity = $prices[$selectedPriceGroup]?.maxQuantity ?? Infinity;\n\t$: maxItemPurchaseQuantity = Math.min(maxItemQuantity, maxSellerItemQuantity);\n\t$: itemName = localize($itemNameStore) + ($itemQuantityForPriceStore > 1 ? ` (${$itemQuantityForPriceStore})` : \"\");\n\n\tlet submitted = false;\n\tasync function submit() {\n\t\tif(submitted) return;\n\t\tsubmitted = true;\n\t\tconst result = await game.itempiles.API.tradeItems(seller, buyer, [{\n\t\t\titem: item.item,\n\t\t\tpaymentIndex: get(selectedPriceGroup),\n\t\t\tquantity: get(quantityToBuy),\n\t\t}], {\n\t\t\tinteractionId: store.interactionId\n\t\t});\n\t\tif(!result){\n\t\t\tsubmitted = false;\n\t\t\treturn;\n\t\t}\n\t\tapplication.options.resolve();\n\t\tapplication.close();\n\t}\n\n</script>\n\n<svelte:options accessors={true}/>\n\n<ApplicationShell bind:elementRoot>\n\t<div>\n\n\t\t<div style=\"display: grid; grid-template-columns: 1fr 0.75fr; margin-bottom: 0.5rem;\">\n\t\t\t<div style=\"display:flex; align-items: center; font-size:1rem; grid-row: 1;\">\n\t\t\t\t<div class=\"item-piles-img-container\" style=\"margin-right: 0.25rem;\">\n\t\t\t\t\t<img class=\"item-piles-img\" src={$itemImg}/>\n\t\t\t\t</div>\n\t\t\t\t<span style=\"color: {$itemRarityColor || 'inherit'};\">{itemName}</span>\n\t\t\t</div>\n\n\t\t\t<div\n\t\t\t\tstyle=\"display:flex; justify-content:flex-end; align-items: center; text-align: right;\">\n\t\t\t\t{#if paymentData.canBuy}\n\t\t\t\t\t<div style=\"display: flex; flex-direction: column; align-items: flex-end; margin-right: 0.5rem;\">\n\t\t\t\t\t\t<small>{localize(\"ITEM-PILES.Applications.TradeMerchantItem.Quantity\")}</small>\n\t\t\t\t\t\t<small style=\"font-style:italic;\">\n\t\t\t\t\t\t\t({localize(\"ITEM-PILES.Applications.TradeMerchantItem.MaxQuantity\", {\n\t\t\t\t\t\t\tquantity: maxItemPurchaseQuantity\n\t\t\t\t\t\t})})\n\t\t\t\t\t\t</small>\n\t\t\t\t\t</div>\n\t\t\t\t\t<input style=\"max-width: 40px; max-height: 24px;\" type=\"number\" bind:value={currentQuantityToBuy} on:change={(evt) => {\n            $quantityToBuy = Math.max(1, Math.min(currentQuantityToBuy, maxItemPurchaseQuantity));\n            currentQuantityToBuy = $quantityToBuy;\n          }}/>\n\t\t\t\t{:else}\n\t\t\t\t\t<small>\n\t\t\t\t\t\t{#each paymentData.reason ?? [] as reason}\n\t\t\t\t\t\t\t<p style=\"margin:0;\">{localize(...reason)}</p>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</small>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t\t<div style=\"margin-top: 0.25rem; display: flex; align-items: flex-start;\">\n\t\t\t\t<PriceSelector {item} standalone/>\n\t\t\t</div>\n\t\t\t<div style=\"margin-right: 0.25rem; text-align: right;\">\n\t\t\t\t{#if paymentData.canBuy && $quantityToBuy > 1 && paymentData.primary}\n\t\t\t\t\t<small>{paymentData.basePriceString}</small>\n\t\t\t\t\t<!-- `ITEM-PILES.Applications.TradeMerchantItem.${settings.selling ? \"They\" : \"You\"}CantAfford` -->\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"item-piles-bottom-divider\" style=\"display: grid; grid-template-columns: auto auto;\">\n\n\t\t\t<strong class=\"item-piles-bottom-divider\" style=\"margin-bottom:0.25rem; padding-bottom:0.25rem;\">\n\t\t\t\t{localize(\"ITEM-PILES.Applications.TradeMerchantItem.\" + (settings.selling ? \"YouReceive\" : \"YouPay\"))}:\n\t\t\t</strong>\n\n\t\t\t<strong class=\"item-piles-bottom-divider item-piles-text-right\"\n\t\t\t        style=\"margin-bottom:0.25rem; padding-bottom:0.25rem;\">\n\t\t\t\t{localize(\"ITEM-PILES.Applications.TradeMerchantItem.\" + (settings.selling ? \"TheyReceive\" : \"YouReceive\"))}:\n\t\t\t</strong>\n\n\t\t\t<div>\n\t\t\t\t{#each paymentData.finalPrices as price}\n\t\t\t\t\t{#if price.quantity}\n\t\t\t\t\t\t<div style=\"display:flex; align-items: center;\">\n\t\t\t\t\t\t\t<div class=\"item-piles-img-container\" style=\"margin-right: 0.25rem;\">\n\t\t\t\t\t\t\t\t<img class=\"item-piles-img\" src={price.img}/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span>{price.quantity} {localize(price.name)}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t{/each}\n\t\t\t</div>\n\n\t\t\t<div style=\"display:flex; flex-direction: column; align-items: flex-end;\">\n\t\t\t\t{#each paymentData.buyerReceive as price}\n\t\t\t\t\t<div style=\"display:flex; align-items: center;\">\n\t\t\t\t\t\t<span>{price.quantity > 1 ? price.quantity + \" \" : \"\"}{price.name}</span>\n\t\t\t\t\t\t<div class=\"item-piles-img-container\" style=\"margin-left: 0.25rem;\">\n\t\t\t\t\t\t\t<img class=\"item-piles-img\" src={price.img}/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{/each}\n\t\t\t\t{#if paymentData.buyerChange.length}\n          <span class=\"item-piles-small-text item-piles-text-right\" style=\"margin-right: 0.25rem; margin-top: 0.5rem;\">\n            {localize(\"ITEM-PILES.Applications.TradeMerchantItem.Change\")}:\n          </span>\n\t\t\t\t\t{#each paymentData.buyerChange as change}\n\t\t\t\t\t\t{#if change.quantity}\n\t\t\t\t\t\t\t<div style=\"display:flex; align-items: center;\">\n\t\t\t\t\t\t\t\t<span>{change.quantity} {localize(change.name)}</span>\n\t\t\t\t\t\t\t\t<div class=\"item-piles-img-container\" style=\"margin-left: 0.25rem;\">\n\t\t\t\t\t\t\t\t\t<img class=\"item-piles-img\" src={change.img}/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t{/each}\n\t\t\t\t{/if}\n\t\t\t</div>\n\n\t\t</div>\n\n\t\t<footer class=\"sheet-footer item-piles-flexrow\">\n\t\t\t<button disabled={!paymentData.canBuy} on:click={ () => { submit() } } type=\"button\">\n\t\t\t\t{#if settings.selling}\n\t\t\t\t\t<i class=\"fas fa-hand-holding-usd\"></i> {localize(\"ITEM-PILES.Applications.TradeMerchantItem.SellItem\")}\n\t\t\t\t{:else}\n\t\t\t\t\t<i class=\"fas fa-shopping-cart\"></i> {localize(\"ITEM-PILES.Applications.TradeMerchantItem.BuyItem\")}\n\t\t\t\t{/if}\n\t\t\t</button>\n\n\t\t\t<button on:click|once={() => { application.close() }} type=\"button\">\n\t\t\t\t<i class=\"fas fa-times\"></i>\n\t\t\t\t{localize(\"Cancel\")}\n\t\t\t</button>\n\t\t</footer>\n\n\t</div>\n\n</ApplicationShell>\n\n<style lang=\"scss\">\n\n  .highlight {\n    box-shadow: inset 0 0 13px 5px rgba(255, 117, 0, 0.73);\n  }\n\n</style>\n","import TradeMerchantItemDialogShell from \"./trade-merchant-item-dialog-shell.svelte\";\r\nimport { SvelteApplication } from '#runtime/svelte/application';\r\nimport { get } from \"svelte/store\";\r\nimport { getActiveApps } from \"../../../helpers/helpers\";\r\n\r\nexport default class TradeMerchantItemDialog extends SvelteApplication {\r\n\r\n\t/**\r\n\t *\r\n\t * @param item\r\n\t * @param seller\r\n\t * @param buyer\r\n\t * @param settings\r\n\t * @param options\r\n\t */\r\n\tconstructor(item, seller, buyer, settings = {}, options = {}) {\r\n\t\tsuper({\r\n\t\t\tid: `item-pile-buy-item-dialog-${item.id}-${seller.id}-${buyer.id}-${foundry.utils.randomID()}`,\r\n\t\t\ttitle: game.i18n.format(\"ITEM-PILES.Applications.TradeMerchantItem.Title\", { item_name: get(item.name) }),\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: TradeMerchantItemDialogShell,\r\n\t\t\t\ttarget: document.body,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\titem,\r\n\t\t\t\t\tseller,\r\n\t\t\t\t\tbuyer,\r\n\t\t\t\t\tsettings\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclose: () => this.options.resolve?.(null),\r\n\t\t\t...options\r\n\t\t});\r\n\t}\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\twidth: 330,\r\n\t\t\theight: \"auto\",\r\n\t\t\tclasses: [\"item-piles-app\"]\r\n\t\t})\r\n\t}\r\n\r\n\tstatic getActiveApps(id) {\r\n\t\treturn getActiveApps(`item-pile-buy-item-dialog-${id}`);\r\n\t}\r\n\r\n\tstatic async show(item, seller, buyer, settings = {}, options = {}) {\r\n\t\tconst apps = this.getActiveApps(item.id + \"-\" + seller.id + \"-\" + buyer.id);\r\n\t\tif (apps.length) {\r\n\t\t\tfor (let app of apps) {\r\n\t\t\t\tapp.render(false, { focus: true });\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\toptions.resolve = resolve;\r\n\t\t\tnew this(item, seller, buyer, settings, options).render(true, { focus: true });\r\n\t\t})\r\n\t}\r\n\r\n}\r\n","<script>\r\n\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\r\n\texport let item;\r\n\texport let data;\r\n\r\n\tconst doc = item.itemDocument;\r\n\r\n\tlet text;\r\n\r\n\t$: value = data.path ? foundry.utils.getProperty($doc, data.path) ?? \"\" : \"\";\r\n\t$: {\r\n\t\tlet localized = localize(`${data.mapping?.[value] ?? value}`);\r\n\t\ttext = data.formatting ? data.formatting.replace(\"{#}\", localized) : localized;\r\n\t}\r\n\r\n</script>\r\n\r\n<div>\r\n\t<span>{@html text}</span>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  div {\r\n    padding: 0 10px;\r\n    text-align: center;\r\n    height: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    flex: 1;\r\n    font-size: smaller;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\r\n\texport let item;\r\n\texport let showX = false;\r\n\r\n\tconst store = item.store;\r\n\tconst displayQuantityStore = item.displayQuantity;\r\n\tconst infiniteQuantityStore = item.infiniteQuantity;\r\n\tconst quantityStore = item.quantity;\r\n\r\n\tlet showEditQuantity = false;\r\n\t$: editQuantity = $quantityStore;\r\n\r\n</script>\r\n\r\n<div>\r\n\t{#if $displayQuantityStore && item.canStack}\r\n\t\t{#if $infiniteQuantityStore}\r\n\t\t\t<span></span>\r\n\t\t{:else if showEditQuantity}\r\n\t\t\t<input\r\n\t\t\t\tstyle=\"height: 18px; max-width: 35px;\"\r\n\t\t\t\ttype=\"text\"\r\n\t\t\t\tbind:value={editQuantity}\r\n\t\t\t\tautofocus\r\n\t\t\t\ton:change={() => {\r\n              showEditQuantity = false;\r\n              item.updateQuantity(editQuantity);\r\n            }}\r\n\t\t\t\ton:keydown={(evt) => {\r\n              if (evt.key === \"Enter\") showEditQuantity = false;\r\n            }}\r\n\t\t\t/>\r\n\t\t{:else if !showEditQuantity}\r\n        <span\r\n\t        class:item-piles-clickable-link={game.user.isGM}\r\n\t        on:click={() => {\r\n            if (game.user.isGM) showEditQuantity = true;\r\n          }}>{showX ? \"x\" : \"\"}{$quantityStore}</span\r\n        >\r\n\t\t{/if}\r\n\t{/if}\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n  div {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    padding: 0 10px;\r\n    text-align: center;\r\n    min-height: 28px;\r\n    height: 100%;\r\n  }\r\n</style>\r\n","<script>\r\n\r\n\timport QuantityColumn from \"./QuantityColumn.svelte\";\r\n\r\n\texport let item;\r\n\texport let showQuantity = false;\r\n\r\n\tconst itemNameStore = item.name;\r\n\tconst itemImage = item.img;\r\n\tconst itemRarityColor = item.rarityColor;\r\n\tconst itemQuantityForPrice = item.quantityForPrice;\r\n\r\n\tconst store = item.store;\r\n\tconst pileData = store.pileData;\r\n\tconst quantityStore = item.quantity;\r\n\tconst itemFlagDataStore = item.itemFlagData;\r\n\r\n\t$: itemName = $itemNameStore + ($itemQuantityForPrice > 1 ? ` (${$itemQuantityForPrice})` : \"\");\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-merchant-item-container\"\r\n     class:merchant-item-hidden={$itemFlagDataStore.hidden}>\r\n\r\n\t<div\r\n\t\tclass=\"item-piles-img-container\"\r\n\t\tclass:not-for-sale={$itemFlagDataStore.notForSale || !$quantityStore}\r\n\t\tdata-fast-tooltip={$itemFlagDataStore.notForSale ? \"Not for sale\" : \"\"}\r\n\t>\r\n\t\t<img class=\"item-piles-img\" src={$itemImage}/>\r\n\t</div>\r\n\r\n\t<div class=\"item-piles-name item-piles-text\">\r\n\t\t<div class=\"item-piles-name-container\">\r\n\t\t\t<span style=\"color: {$itemRarityColor || 'inherit'};\">\r\n\t\t\t\t{#if $pileData.canInspectItems || game.user.isGM}\r\n\t\t\t\t\t<a class=\"item-piles-clickable\" on:click={() => { item.preview() }}>\r\n\t\t\t\t\t\t{itemName}\r\n\t\t\t\t\t</a>\r\n\t\t\t\t{:else}\r\n\t\t\t\t\t{itemName}\r\n\t\t\t\t{/if}\r\n\t\t\t</span>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t{#if showQuantity}\r\n\t\t<div class=\"item-piles-quantity-container\">\r\n\t\t\t<QuantityColumn {item} showX/>\r\n\t\t</div>\r\n\t{/if}\r\n\r\n\t<slot name=\"right\"/>\r\n\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-merchant-item-container {\r\n    display: flex;\r\n    border-top-left-radius: 5px;\r\n    border-bottom-left-radius: 5px;\r\n  }\r\n\r\n  .merchant-item-hidden > * {\r\n    font-style: italic;\r\n    opacity: 0.5;\r\n  }\r\n\r\n  .item-piles-name {\r\n    flex: 0 1 auto;\r\n  }\r\n\r\n  .item-piles-quantity-container {\r\n    flex: 1;\r\n  }\r\n\r\n</style>\r\n","import { TJSDocument } from \"#runtime/svelte/store/fvtt/document\";\nimport { get, writable } from \"svelte/store\";\nimport CONSTANTS from \"../../constants/constants.js\";\nimport * as PileUtilities from \"../../helpers/pile-utilities.js\";\nimport { getItemCost } from \"../../helpers/utilities.js\";\n\nconst existingStores = new Map();\n\nexport default class ItemPriceStore {\n\n\tconstructor(item) {\n\n\t\tthis.item = item;\n\t\tthis.itemDoc = new TJSDocument(this.item);\n\n\t\tconst quantityForPriceProp = game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE;\n\n\t\tthis.price = writable(0);\n\t\tthis.quantityForPrice = writable(foundry.utils.getProperty(item, quantityForPriceProp) ?? 1);\n\n\t\tconst data = PileUtilities.getItemFlagData(this.item);\n\n\t\tdata.prices.forEach(group => {\n\t\t\tgroup.forEach(price => {\n\t\t\t\tif (!price.id) {\n\t\t\t\t\tprice.id = foundry.utils.randomID();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.data = writable(data);\n\n\t\tthis.itemDoc.subscribe((item, changes) => {\n\t\t\tconst { data } = changes;\n\t\t\tif (foundry.utils.hasProperty(data, CONSTANTS.FLAGS.ITEM)) {\n\t\t\t\tconst newData = foundry.utils.getProperty(data, CONSTANTS.FLAGS.ITEM);\n\t\t\t\tconst oldData = get(this.data);\n\t\t\t\tthis.data.set(foundry.utils.mergeObject(oldData, newData));\n\t\t\t}\n\t\t\tthis.price.set(getItemCost(this.item));\n\t\t\tconst quantityForPriceProp = game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE;\n\t\t\tif (quantityForPriceProp && foundry.utils.hasProperty(data, quantityForPriceProp)) {\n\t\t\t\tthis.quantityForPrice.set(foundry.utils.getProperty(item, quantityForPriceProp))\n\t\t\t}\n\t\t});\n\n\t}\n\n\tstatic make(item) {\n\t\tif (existingStores.has(item.id)) {\n\t\t\treturn existingStores.get(item.id);\n\t\t}\n\t\treturn new this(item);\n\t}\n\n\taddPurchaseGroup() {\n\t\tthis.data.update(data => {\n\t\t\tdata.prices.push([]);\n\t\t\treturn data;\n\t\t})\n\t}\n\n\tremovePurchaseGroup(groupIndex) {\n\t\tthis.data.update(data => {\n\t\t\tdata.prices.splice(groupIndex, 1);\n\t\t\treturn data;\n\t\t})\n\t}\n\n\taddSellGroup() {\n\t\tthis.data.update(data => {\n\t\t\tdata.sellPrices.push([]);\n\t\t\treturn data;\n\t\t})\n\t}\n\n\tremoveSellGroup(groupIndex) {\n\t\tthis.data.update(data => {\n\t\t\tdata.sellPrices.splice(groupIndex, 1);\n\t\t\treturn data;\n\t\t})\n\t}\n\n\texport() {\n\t\tconst data = {\n\t\t\tdata: {\n\t\t\t\t[game.itempiles.API.ITEM_PRICE_ATTRIBUTE]: get(this.price),\n\t\t\t},\n\t\t\tflags: get(this.data)\n\t\t};\n\t\tif (game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE) {\n\t\t\tdata[\"data\"][game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE] = get(this.quantityForPrice);\n\t\t}\n\t\treturn data;\n\t}\n\n}\n","<script>\r\n\texport let value;\r\n\texport let type;\r\n\texport let placeholder = \"\";\r\n\texport let showImage = false;\r\n\texport let showInput = true;\r\n\r\n\tlet filePicker = false;\r\n\r\n\tfunction handleClick() {\r\n\t\tif (!filePicker) {\r\n\t\t\tfilePicker = new FilePicker({\r\n\t\t\t\ttype: type,\r\n\t\t\t\tcurrent: value,\r\n\t\t\t\tcallback: path => {\r\n\t\t\t\t\tvalue = path;\r\n\t\t\t\t\tfilePicker = false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfilePicker.render(true, { focus: true });\r\n\t}\r\n\r\n</script>\r\n\r\n<div>\r\n\t{#if showImage}\r\n\t\t<div class=\"item-piles-img-container\">\r\n\t\t\t<img class=\"item-piles-img\" src={value}/>\r\n\t\t</div>\r\n\t{/if}\r\n\t{#if showInput}\r\n\t\t<input type=\"text\" placeholder=\"{placeholder}\" bind:value=\"{value}\"/>\r\n\t{/if}\r\n\t<button on:click={handleClick} type=\"button\"><i class=\"fas fa-file-import\"></i></button>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  div {\r\n    width: 100%;\r\n    display: inline-flex;\r\n    flex-direction: row;\r\n    align-items: center;\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem !important;\r\n      flex: 0;\r\n    }\r\n  }\r\n\r\n</style>\r\n","import { cubicOut } from '../easing/index.js';\nimport { is_function } from '../internal/index.js';\n\n/**\n * The flip function calculates the start and end position of an element and animates between them, translating the x and y values.\n * `flip` stands for [First, Last, Invert, Play](https://aerotwist.com/blog/flip-your-animations/).\n *\n * https://svelte.dev/docs/svelte-animate#flip\n * @param {Element} node\n * @param {{ from: DOMRect; to: DOMRect }} fromTo\n * @param {import('./public.js').FlipParams} params\n * @returns {import('./public.js').AnimationConfig}\n */\nexport function flip(node, { from, to }, params = {}) {\n\tconst style = getComputedStyle(node);\n\tconst transform = style.transform === 'none' ? '' : style.transform;\n\tconst [ox, oy] = style.transformOrigin.split(' ').map(parseFloat);\n\tconst dx = from.left + (from.width * ox) / to.width - (to.left + ox);\n\tconst dy = from.top + (from.height * oy) / to.height - (to.top + oy);\n\tconst { delay = 0, duration = (d) => Math.sqrt(d) * 120, easing = cubicOut } = params;\n\treturn {\n\t\tdelay,\n\t\tduration: is_function(duration) ? duration(Math.sqrt(dx * dx + dy * dy)) : duration,\n\t\teasing,\n\t\tcss: (t, u) => {\n\t\t\tconst x = u * dx;\n\t\t\tconst y = u * dy;\n\t\t\tconst sx = t + (u * from.width) / to.width;\n\t\t\tconst sy = t + (u * from.height) / to.height;\n\t\t\treturn `transform: ${transform} translate(${x}px, ${y}px) scale(${sx}, ${sy});`;\n\t\t}\n\t};\n}\n","// external events\nconst FINALIZE_EVENT_NAME = \"finalize\";\nconst CONSIDER_EVENT_NAME = \"consider\";\n\n/**\n * @typedef {Object} Info\n * @property {string} trigger\n * @property {string} id\n * @property {string} source\n * @param {Node} el\n * @param {Array} items\n * @param {Info} info\n */\nexport function dispatchFinalizeEvent(el, items, info) {\n    el.dispatchEvent(\n        new CustomEvent(FINALIZE_EVENT_NAME, {\n            detail: {items, info}\n        })\n    );\n}\n\n/**\n * Dispatches a consider event\n * @param {Node} el\n * @param {Array} items\n * @param {Info} info\n */\nexport function dispatchConsiderEvent(el, items, info) {\n    el.dispatchEvent(\n        new CustomEvent(CONSIDER_EVENT_NAME, {\n            detail: {items, info}\n        })\n    );\n}\n\n// internal events\nexport const DRAGGED_ENTERED_EVENT_NAME = \"draggedEntered\";\nexport const DRAGGED_LEFT_EVENT_NAME = \"draggedLeft\";\nexport const DRAGGED_OVER_INDEX_EVENT_NAME = \"draggedOverIndex\";\nexport const DRAGGED_LEFT_DOCUMENT_EVENT_NAME = \"draggedLeftDocument\";\n\nexport const DRAGGED_LEFT_TYPES = {\n    LEFT_FOR_ANOTHER: \"leftForAnother\",\n    OUTSIDE_OF_ANY: \"outsideOfAny\"\n};\n\nexport function dispatchDraggedElementEnteredContainer(containerEl, indexObj, draggedEl) {\n    containerEl.dispatchEvent(\n        new CustomEvent(DRAGGED_ENTERED_EVENT_NAME, {\n            detail: {indexObj, draggedEl}\n        })\n    );\n}\n\n/**\n * @param containerEl - the dropzone the element left\n * @param draggedEl - the dragged element\n * @param theOtherDz - the new dropzone the element entered\n */\nexport function dispatchDraggedElementLeftContainerForAnother(containerEl, draggedEl, theOtherDz) {\n    containerEl.dispatchEvent(\n        new CustomEvent(DRAGGED_LEFT_EVENT_NAME, {\n            detail: {draggedEl, type: DRAGGED_LEFT_TYPES.LEFT_FOR_ANOTHER, theOtherDz}\n        })\n    );\n}\n\nexport function dispatchDraggedElementLeftContainerForNone(containerEl, draggedEl) {\n    containerEl.dispatchEvent(\n        new CustomEvent(DRAGGED_LEFT_EVENT_NAME, {\n            detail: {draggedEl, type: DRAGGED_LEFT_TYPES.OUTSIDE_OF_ANY}\n        })\n    );\n}\nexport function dispatchDraggedElementIsOverIndex(containerEl, indexObj, draggedEl) {\n    containerEl.dispatchEvent(\n        new CustomEvent(DRAGGED_OVER_INDEX_EVENT_NAME, {\n            detail: {indexObj, draggedEl}\n        })\n    );\n}\nexport function dispatchDraggedLeftDocument(draggedEl) {\n    window.dispatchEvent(\n        new CustomEvent(DRAGGED_LEFT_DOCUMENT_EVENT_NAME, {\n            detail: {draggedEl}\n        })\n    );\n}\n","import {DRAGGED_ENTERED_EVENT_NAME, DRAGGED_LEFT_EVENT_NAME, DRAGGED_OVER_INDEX_EVENT_NAME} from \"./helpers/dispatcher\";\n\nexport const TRIGGERS = {\n    DRAG_STARTED: \"dragStarted\",\n    DRAGGED_ENTERED: DRAGGED_ENTERED_EVENT_NAME,\n    DRAGGED_ENTERED_ANOTHER: \"dragEnteredAnother\",\n    DRAGGED_OVER_INDEX: DRAGGED_OVER_INDEX_EVENT_NAME,\n    DRAGGED_LEFT: DRAGGED_LEFT_EVENT_NAME,\n    DRAGGED_LEFT_ALL: \"draggedLeftAll\",\n    DROPPED_INTO_ZONE: \"droppedIntoZone\",\n    DROPPED_INTO_ANOTHER: \"droppedIntoAnother\",\n    DROPPED_OUTSIDE_OF_ANY: \"droppedOutsideOfAny\",\n    DRAG_STOPPED: \"dragStopped\"\n};\n\nexport const SOURCES = {\n    POINTER: \"pointer\",\n    KEYBOARD: \"keyboard\"\n};\n\nexport const SHADOW_ITEM_MARKER_PROPERTY_NAME = \"isDndShadowItem\";\nexport const SHADOW_ELEMENT_ATTRIBUTE_NAME = \"data-is-dnd-shadow-item-internal\";\nexport const SHADOW_ELEMENT_HINT_ATTRIBUTE_NAME = \"data-is-dnd-shadow-item-hint\";\nexport const SHADOW_PLACEHOLDER_ITEM_ID = \"id:dnd-shadow-placeholder-0000\";\nexport const DRAGGED_ELEMENT_ID = \"dnd-action-dragged-el\";\n\nexport let ITEM_ID_KEY = \"id\";\nlet activeDndZoneCount = 0;\nexport function incrementActiveDropZoneCount() {\n    activeDndZoneCount++;\n}\nexport function decrementActiveDropZoneCount() {\n    if (activeDndZoneCount === 0) {\n        throw new Error(\"Bug! trying to decrement when there are no dropzones\");\n    }\n    activeDndZoneCount--;\n}\n\n/**\n * Allows using another key instead of \"id\" in the items data. This is global and applies to all dndzones.\n * Has to be called when there are no rendered dndzones whatsoever.\n * @param {String} newKeyName\n * @throws {Error} if it was called when there are rendered dndzones or if it is given the wrong type (not a string)\n */\nexport function overrideItemIdKeyNameBeforeInitialisingDndZones(newKeyName) {\n    if (activeDndZoneCount > 0) {\n        throw new Error(\"can only override the id key before initialising any dndzone\");\n    }\n    if (typeof newKeyName !== \"string\") {\n        throw new Error(\"item id key has to be a string\");\n    }\n    printDebug(() => [\"overriding item id key name\", newKeyName]);\n    ITEM_ID_KEY = newKeyName;\n}\n\nexport const isOnServer = typeof window === \"undefined\";\n\nexport let printDebug = () => {};\n\n/**\n * Allows the user to show/hide console debug output\n * * @param {boolean} isDebug\n */\nexport function setDebugMode(isDebug) {\n    if (isDebug) {\n        printDebug = (generateMessage, logFunction = console.debug) => {\n            const message = generateMessage();\n            if (Array.isArray(message)) {\n                logFunction(...message);\n            } else {\n                logFunction(message);\n            }\n        };\n    } else {\n        printDebug = () => {};\n    }\n}\n","// This is based off https://stackoverflow.com/questions/27745438/how-to-compute-getboundingclientrect-without-considering-transforms/57876601#57876601\n// It removes the transforms that are potentially applied by the flip animations\n/**\n * Gets the bounding rect but removes transforms (ex: flip animation)\n * @param {HTMLElement} el\n * @return {{top: number, left: number, bottom: number, right: number}}\n */\nexport function getBoundingRectNoTransforms(el) {\n    let ta;\n    const rect = el.getBoundingClientRect();\n    const style = getComputedStyle(el);\n    const tx = style.transform;\n\n    if (tx) {\n        let sx, sy, dx, dy;\n        if (tx.startsWith(\"matrix3d(\")) {\n            ta = tx.slice(9, -1).split(/, /);\n            sx = +ta[0];\n            sy = +ta[5];\n            dx = +ta[12];\n            dy = +ta[13];\n        } else if (tx.startsWith(\"matrix(\")) {\n            ta = tx.slice(7, -1).split(/, /);\n            sx = +ta[0];\n            sy = +ta[3];\n            dx = +ta[4];\n            dy = +ta[5];\n        } else {\n            return rect;\n        }\n\n        const to = style.transformOrigin;\n        const x = rect.x - dx - (1 - sx) * parseFloat(to);\n        const y = rect.y - dy - (1 - sy) * parseFloat(to.slice(to.indexOf(\" \") + 1));\n        const w = sx ? rect.width / sx : el.offsetWidth;\n        const h = sy ? rect.height / sy : el.offsetHeight;\n        return {\n            x: x,\n            y: y,\n            width: w,\n            height: h,\n            top: y,\n            right: x + w,\n            bottom: y + h,\n            left: x\n        };\n    } else {\n        return rect;\n    }\n}\n\n/**\n * Gets the absolute bounding rect (accounts for the window's scroll position and removes transforms)\n * @param {HTMLElement} el\n * @return {{top: number, left: number, bottom: number, right: number}}\n */\nexport function getAbsoluteRectNoTransforms(el) {\n    const rect = getBoundingRectNoTransforms(el);\n    return {\n        top: rect.top + window.scrollY,\n        bottom: rect.bottom + window.scrollY,\n        left: rect.left + window.scrollX,\n        right: rect.right + window.scrollX\n    };\n}\n\n/**\n * Gets the absolute bounding rect (accounts for the window's scroll position)\n * @param {HTMLElement} el\n * @return {{top: number, left: number, bottom: number, right: number}}\n */\nexport function getAbsoluteRect(el) {\n    const rect = el.getBoundingClientRect();\n    return {\n        top: rect.top + window.scrollY,\n        bottom: rect.bottom + window.scrollY,\n        left: rect.left + window.scrollX,\n        right: rect.right + window.scrollX\n    };\n}\n\n/**\n * finds the center :)\n * @typedef {Object} Rect\n * @property {number} top\n * @property {number} bottom\n * @property {number} left\n * @property {number} right\n * @param {Rect} rect\n * @return {{x: number, y: number}}\n */\nexport function findCenter(rect) {\n    return {\n        x: (rect.left + rect.right) / 2,\n        y: (rect.top + rect.bottom) / 2\n    };\n}\n\n/**\n * @typedef {Object} Point\n * @property {number} x\n * @property {number} y\n * @param {Point} pointA\n * @param {Point} pointB\n * @return {number}\n */\nfunction calcDistance(pointA, pointB) {\n    return Math.sqrt(Math.pow(pointA.x - pointB.x, 2) + Math.pow(pointA.y - pointB.y, 2));\n}\n\n/**\n * @param {Point} point\n * @param {Rect} rect\n * @return {boolean|boolean}\n */\nexport function isPointInsideRect(point, rect) {\n    return point.y <= rect.bottom && point.y >= rect.top && point.x >= rect.left && point.x <= rect.right;\n}\n\n/**\n * find the absolute coordinates of the center of a dom element\n * @param el {HTMLElement}\n * @returns {{x: number, y: number}}\n */\nexport function findCenterOfElement(el) {\n    return findCenter(getAbsoluteRect(el));\n}\n\n/**\n * @param {HTMLElement} elA\n * @param {HTMLElement} elB\n * @return {boolean}\n */\nexport function isCenterOfAInsideB(elA, elB) {\n    const centerOfA = findCenterOfElement(elA);\n    const rectOfB = getAbsoluteRectNoTransforms(elB);\n    return isPointInsideRect(centerOfA, rectOfB);\n}\n\n/**\n * @param {HTMLElement|ChildNode} elA\n * @param {HTMLElement|ChildNode} elB\n * @return {number}\n */\nexport function calcDistanceBetweenCenters(elA, elB) {\n    const centerOfA = findCenterOfElement(elA);\n    const centerOfB = findCenterOfElement(elB);\n    return calcDistance(centerOfA, centerOfB);\n}\n\n/**\n * @param {HTMLElement} el - the element to check\n * @returns {boolean} - true if the element in its entirety is off-screen including the scrollable area (the normal dom events look at the mouse rather than the element)\n */\nexport function isElementOffDocument(el) {\n    const rect = getAbsoluteRect(el);\n    return rect.right < 0 || rect.left > document.documentElement.scrollWidth || rect.bottom < 0 || rect.top > document.documentElement.scrollHeight;\n}\n","import {isCenterOfAInsideB, calcDistanceBetweenCenters, getAbsoluteRectNoTransforms, isPointInsideRect, findCenterOfElement} from \"./intersection\";\nimport {printDebug, SHADOW_ELEMENT_ATTRIBUTE_NAME} from \"../constants\";\n\nlet dzToShadowIndexToRect;\n\n/**\n * Resets the cache that allows for smarter \"would be index\" resolution. Should be called after every drag operation\n */\nexport function resetIndexesCache() {\n    printDebug(() => \"resetting indexes cache\");\n    dzToShadowIndexToRect = new Map();\n}\nresetIndexesCache();\n\n/**\n * Caches the coordinates of the shadow element when it's in a certain index in a certain dropzone.\n * Helpful in order to determine \"would be index\" more effectively\n * @param {HTMLElement} dz\n * @return {number} - the shadow element index\n */\nfunction cacheShadowRect(dz) {\n    const shadowElIndex = Array.from(dz.children).findIndex(child => child.getAttribute(SHADOW_ELEMENT_ATTRIBUTE_NAME));\n    if (shadowElIndex >= 0) {\n        if (!dzToShadowIndexToRect.has(dz)) {\n            dzToShadowIndexToRect.set(dz, new Map());\n        }\n        dzToShadowIndexToRect.get(dz).set(shadowElIndex, getAbsoluteRectNoTransforms(dz.children[shadowElIndex]));\n        return shadowElIndex;\n    }\n    return undefined;\n}\n\n/**\n * @typedef {Object} Index\n * @property {number} index - the would be index\n * @property {boolean} isProximityBased - false if the element is actually over the index, true if it is not over it but this index is the closest\n */\n/**\n * Find the index for the dragged element in the list it is dragged over\n * @param {HTMLElement} floatingAboveEl\n * @param {HTMLElement} collectionBelowEl\n * @returns {Index|null} -  if the element is over the container the Index object otherwise null\n */\nexport function findWouldBeIndex(floatingAboveEl, collectionBelowEl) {\n    if (!isCenterOfAInsideB(floatingAboveEl, collectionBelowEl)) {\n        return null;\n    }\n    const children = collectionBelowEl.children;\n    // the container is empty, floating element should be the first\n    if (children.length === 0) {\n        return {index: 0, isProximityBased: true};\n    }\n    const shadowElIndex = cacheShadowRect(collectionBelowEl);\n\n    // the search could be more efficient but keeping it simple for now\n    // a possible improvement: pass in the lastIndex it was found in and check there first, then expand from there\n    for (let i = 0; i < children.length; i++) {\n        if (isCenterOfAInsideB(floatingAboveEl, children[i])) {\n            const cachedShadowRect = dzToShadowIndexToRect.has(collectionBelowEl) && dzToShadowIndexToRect.get(collectionBelowEl).get(i);\n            if (cachedShadowRect) {\n                if (!isPointInsideRect(findCenterOfElement(floatingAboveEl), cachedShadowRect)) {\n                    return {index: shadowElIndex, isProximityBased: false};\n                }\n            }\n            return {index: i, isProximityBased: false};\n        }\n    }\n    // this can happen if there is space around the children so the floating element has\n    //entered the container but not any of the children, in this case we will find the nearest child\n    let minDistanceSoFar = Number.MAX_VALUE;\n    let indexOfMin = undefined;\n    // we are checking all of them because we don't know whether we are dealing with a horizontal or vertical container and where the floating element entered from\n    for (let i = 0; i < children.length; i++) {\n        const distance = calcDistanceBetweenCenters(floatingAboveEl, children[i]);\n        if (distance < minDistanceSoFar) {\n            minDistanceSoFar = distance;\n            indexOfMin = i;\n        }\n    }\n    return {index: indexOfMin, isProximityBased: true};\n}\n","/**\n * @param {Object} object\n * @return {string}\n */\nexport function toString(object) {\n    return JSON.stringify(object, null, 2);\n}\n\n/**\n * Finds the depth of the given node in the DOM tree\n * @param {HTMLElement} node\n * @return {number} - the depth of the node\n */\nexport function getDepth(node) {\n    if (!node) {\n        throw new Error(\"cannot get depth of a falsy node\");\n    }\n    return _getDepth(node, 0);\n}\nfunction _getDepth(node, countSoFar = 0) {\n    if (!node.parentElement) {\n        return countSoFar - 1;\n    }\n    return _getDepth(node.parentElement, countSoFar + 1);\n}\n\n/**\n * A simple util to shallow compare objects quickly, it doesn't validate the arguments so pass objects in\n * @param {Object} objA\n * @param {Object} objB\n * @return {boolean} - true if objA and objB are shallow equal\n */\nexport function areObjectsShallowEqual(objA, objB) {\n    if (Object.keys(objA).length !== Object.keys(objB).length) {\n        return false;\n    }\n    for (const keyA in objA) {\n        if (!{}.hasOwnProperty.call(objB, keyA) || objB[keyA] !== objA[keyA]) {\n            return false;\n        }\n    }\n    return true;\n}\n\n/**\n * Shallow compares two arrays\n * @param arrA\n * @param arrB\n * @return {boolean} - whether the arrays are shallow equal\n */\nexport function areArraysShallowEqualSameOrder(arrA, arrB) {\n    if (arrA.length !== arrB.length) {\n        return false;\n    }\n    for (let i = 0; i < arrA.length; i++) {\n        if (arrA[i] !== arrB[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n","import {findWouldBeIndex, resetIndexesCache} from \"./listUtil\";\nimport {findCenterOfElement, isElementOffDocument} from \"./intersection\";\nimport {\n    dispatchDraggedElementEnteredContainer,\n    dispatchDraggedElementLeftContainerForAnother,\n    dispatchDraggedElementLeftContainerForNone,\n    dispatchDraggedLeftDocument,\n    dispatchDraggedElementIsOverIndex\n} from \"./dispatcher\";\nimport {getDepth} from \"./util\";\nimport {printDebug} from \"../constants\";\n\nconst INTERVAL_MS = 200;\nconst TOLERANCE_PX = 10;\nlet next;\n\n/**\n * Tracks the dragged elements and performs the side effects when it is dragged over a drop zone (basically dispatching custom-events scrolling)\n * @param {Set<HTMLElement>} dropZones\n * @param {HTMLElement} draggedEl\n * @param {number} [intervalMs = INTERVAL_MS]\n * @param {MultiScroller} multiScroller\n */\nexport function observe(draggedEl, dropZones, intervalMs = INTERVAL_MS, multiScroller) {\n    // initialization\n    let lastDropZoneFound;\n    let lastIndexFound;\n    let lastIsDraggedInADropZone = false;\n    let lastCentrePositionOfDragged;\n    // We are sorting to make sure that in case of nested zones of the same type the one \"on top\" is considered first\n    const dropZonesFromDeepToShallow = Array.from(dropZones).sort((dz1, dz2) => getDepth(dz2) - getDepth(dz1));\n\n    /**\n     * The main function in this module. Tracks where everything is/ should be a take the actions\n     */\n    function andNow() {\n        const currentCenterOfDragged = findCenterOfElement(draggedEl);\n        const scrolled = multiScroller.multiScrollIfNeeded();\n        // we only want to make a new decision after the element was moved a bit to prevent flickering\n        if (\n            !scrolled &&\n            lastCentrePositionOfDragged &&\n            Math.abs(lastCentrePositionOfDragged.x - currentCenterOfDragged.x) < TOLERANCE_PX &&\n            Math.abs(lastCentrePositionOfDragged.y - currentCenterOfDragged.y) < TOLERANCE_PX\n        ) {\n            next = window.setTimeout(andNow, intervalMs);\n            return;\n        }\n        if (isElementOffDocument(draggedEl)) {\n            printDebug(() => \"off document\");\n            dispatchDraggedLeftDocument(draggedEl);\n            return;\n        }\n\n        lastCentrePositionOfDragged = currentCenterOfDragged;\n        // this is a simple algorithm, potential improvement: first look at lastDropZoneFound\n        let isDraggedInADropZone = false;\n        for (const dz of dropZonesFromDeepToShallow) {\n            if (scrolled) resetIndexesCache();\n            const indexObj = findWouldBeIndex(draggedEl, dz);\n            if (indexObj === null) {\n                // it is not inside\n                continue;\n            }\n            const {index} = indexObj;\n            isDraggedInADropZone = true;\n            // the element is over a container\n            if (dz !== lastDropZoneFound) {\n                lastDropZoneFound && dispatchDraggedElementLeftContainerForAnother(lastDropZoneFound, draggedEl, dz);\n                dispatchDraggedElementEnteredContainer(dz, indexObj, draggedEl);\n                lastDropZoneFound = dz;\n            } else if (index !== lastIndexFound) {\n                dispatchDraggedElementIsOverIndex(dz, indexObj, draggedEl);\n                lastIndexFound = index;\n            }\n            // we handle looping with the 'continue' statement above\n            break;\n        }\n        // the first time the dragged element is not in any dropzone we need to notify the last dropzone it was in\n        if (!isDraggedInADropZone && lastIsDraggedInADropZone && lastDropZoneFound) {\n            dispatchDraggedElementLeftContainerForNone(lastDropZoneFound, draggedEl);\n            lastDropZoneFound = undefined;\n            lastIndexFound = undefined;\n            lastIsDraggedInADropZone = false;\n        } else {\n            lastIsDraggedInADropZone = true;\n        }\n        next = window.setTimeout(andNow, intervalMs);\n    }\n    andNow();\n}\n\n// assumption - we can only observe one dragged element at a time, this could be changed in the future\nexport function unobserve() {\n    printDebug(() => \"unobserving\");\n    clearTimeout(next);\n    resetIndexesCache();\n}\n","import {isPointInsideRect} from \"./intersection\";\nconst SCROLL_ZONE_PX = 30;\n\n/**\n * Will make a scroller that can scroll any element given to it in any direction\n * @returns {{scrollIfNeeded: function(Point, HTMLElement): boolean, resetScrolling: function(void):void}}\n */\nexport function makeScroller() {\n    let scrollingInfo;\n    function resetScrolling() {\n        scrollingInfo = {directionObj: undefined, stepPx: 0};\n    }\n    resetScrolling();\n    // directionObj {x: 0|1|-1, y:0|1|-1} - 1 means down in y and right in x\n    function scrollContainer(containerEl) {\n        const {directionObj, stepPx} = scrollingInfo;\n        if (directionObj) {\n            containerEl.scrollBy(directionObj.x * stepPx, directionObj.y * stepPx);\n            window.requestAnimationFrame(() => scrollContainer(containerEl));\n        }\n    }\n    function calcScrollStepPx(distancePx) {\n        return SCROLL_ZONE_PX - distancePx;\n    }\n\n    /**\n     * @param {Point} pointer - the pointer will be used to decide in which direction to scroll\n     * @param {HTMLElement} elementToScroll - the scroll container\n     * If the pointer is next to the sides of the element to scroll, will trigger scrolling\n     * Can be called repeatedly with updated pointer and elementToScroll values without issues\n     * @return {boolean} - true if scrolling was needed\n     */\n    function scrollIfNeeded(pointer, elementToScroll) {\n        if (!elementToScroll) {\n            return false;\n        }\n        const distances = calcInnerDistancesBetweenPointAndSidesOfElement(pointer, elementToScroll);\n        const isAlreadyScrolling = !!scrollingInfo.directionObj;\n        if (distances === null) {\n            if (isAlreadyScrolling) resetScrolling();\n            return false;\n        }\n        let [scrollingVertically, scrollingHorizontally] = [false, false];\n        // vertical\n        if (elementToScroll.scrollHeight > elementToScroll.clientHeight) {\n            if (distances.bottom < SCROLL_ZONE_PX) {\n                scrollingVertically = true;\n                scrollingInfo.directionObj = {x: 0, y: 1};\n                scrollingInfo.stepPx = calcScrollStepPx(distances.bottom);\n            } else if (distances.top < SCROLL_ZONE_PX) {\n                scrollingVertically = true;\n                scrollingInfo.directionObj = {x: 0, y: -1};\n                scrollingInfo.stepPx = calcScrollStepPx(distances.top);\n            }\n            if (!isAlreadyScrolling && scrollingVertically) {\n                scrollContainer(elementToScroll);\n                return true;\n            }\n        }\n        // horizontal\n        if (elementToScroll.scrollWidth > elementToScroll.clientWidth) {\n            if (distances.right < SCROLL_ZONE_PX) {\n                scrollingHorizontally = true;\n                scrollingInfo.directionObj = {x: 1, y: 0};\n                scrollingInfo.stepPx = calcScrollStepPx(distances.right);\n            } else if (distances.left < SCROLL_ZONE_PX) {\n                scrollingHorizontally = true;\n                scrollingInfo.directionObj = {x: -1, y: 0};\n                scrollingInfo.stepPx = calcScrollStepPx(distances.left);\n            }\n            if (!isAlreadyScrolling && scrollingHorizontally) {\n                scrollContainer(elementToScroll);\n                return true;\n            }\n        }\n        resetScrolling();\n        return false;\n    }\n\n    return {\n        scrollIfNeeded,\n        resetScrolling\n    };\n}\n\n/**\n * If the point is inside the element returns its distances from the sides, otherwise returns null\n * @param {Point} point\n * @param {HTMLElement} el\n * @return {null|{top: number, left: number, bottom: number, right: number}}\n */\nfunction calcInnerDistancesBetweenPointAndSidesOfElement(point, el) {\n    // Even if the scrolling element is small it acts as a scroller for the viewport\n    const rect =\n        el === document.scrollingElement\n            ? {\n                  top: 0,\n                  bottom: window.innerHeight,\n                  left: 0,\n                  right: window.innerWidth\n              }\n            : el.getBoundingClientRect();\n    if (!isPointInsideRect(point, rect)) {\n        return null;\n    }\n    return {\n        top: point.y - rect.top,\n        bottom: rect.bottom - point.y,\n        left: point.x - rect.left,\n        right: rect.right - point.x\n    };\n}\n","import {makeScroller} from \"./scroller\";\nimport {printDebug} from \"../constants\";\nimport {getDepth} from \"./util\";\nimport {isPointInsideRect} from \"./intersection\";\n\n/**\n @typedef {Object} MultiScroller\n @property {function():boolean} multiScrollIfNeeded - call this on every \"tick\" to scroll containers if needed, returns true if anything was scrolled\n/**\n * Creates a scroller than can scroll any of the provided containers or any of their scrollable parents (including the document's scrolling element)\n * @param {HTMLElement[]} baseElementsForScrolling\n * @param {function():Point} getPointerPosition\n * @return {MultiScroller}\n */\nexport function createMultiScroller(baseElementsForScrolling = [], getPointerPosition) {\n    printDebug(() => \"creating multi-scroller\");\n    const scrollingContainersSet = findRelevantScrollContainers(baseElementsForScrolling);\n    const scrollingContainersDeepToShallow = Array.from(scrollingContainersSet).sort((dz1, dz2) => getDepth(dz2) - getDepth(dz1));\n    const {scrollIfNeeded, resetScrolling} = makeScroller();\n\n    /**\n     * @return {boolean} - was any container scrolled\n     */\n    function tick() {\n        const mousePosition = getPointerPosition();\n        if (!mousePosition || !scrollingContainersDeepToShallow) {\n            return false;\n        }\n        const scrollContainersUnderCursor = scrollingContainersDeepToShallow.filter(\n            el => isPointInsideRect(mousePosition, el.getBoundingClientRect()) || el === document.scrollingElement\n        );\n        for (let i = 0; i < scrollContainersUnderCursor.length; i++) {\n            const scrolled = scrollIfNeeded(mousePosition, scrollContainersUnderCursor[i]);\n            if (scrolled) {\n                return true;\n            }\n        }\n        return false;\n    }\n    return {\n        multiScrollIfNeeded: scrollingContainersSet.size > 0 ? tick : () => false,\n        destroy: () => resetScrolling()\n    };\n}\n\n// internal utils\nfunction findScrollableParents(element) {\n    if (!element) {\n        return [];\n    }\n    const scrollableContainers = [];\n    let parent = element;\n    while (parent) {\n        const {overflow} = window.getComputedStyle(parent);\n        if (overflow.split(\" \").some(o => o.includes(\"auto\") || o.includes(\"scroll\"))) {\n            scrollableContainers.push(parent);\n        }\n        parent = parent.parentElement;\n    }\n    return scrollableContainers;\n}\nfunction findRelevantScrollContainers(dropZones) {\n    const scrollingContainers = new Set();\n    for (let dz of dropZones) {\n        findScrollableParents(dz).forEach(container => scrollingContainers.add(container));\n    }\n    // The scrolling element might have overflow visible and still be scrollable\n    if (\n        document.scrollingElement.scrollHeight > document.scrollingElement.clientHeight ||\n        document.scrollingElement.scrollWidth > document.scrollingElement.clientHeight\n    ) {\n        scrollingContainers.add(document.scrollingElement);\n    }\n    return scrollingContainers;\n}\n","/**\n * Fixes svelte issue when cloning node containing (or being) <select> which will loose it's value.\n * Since svelte manages select value internally.\n * @see https://github.com/sveltejs/svelte/issues/6717\n * @see https://github.com/isaacHagoel/svelte-dnd-action/issues/306\n *\n * @param {HTMLElement} el\n * @returns\n */\nexport function svelteNodeClone(el) {\n    const cloned = el.cloneNode(true);\n\n    const values = [];\n    const elIsSelect = el.tagName === \"SELECT\";\n    const selects = elIsSelect ? [el] : [...el.querySelectorAll(\"select\")];\n    for (const select of selects) {\n        values.push(select.value);\n    }\n\n    if (selects.length > 0) {\n        const clonedSelects = elIsSelect ? [cloned] : [...cloned.querySelectorAll(\"select\")];\n        for (let i = 0; i < clonedSelects.length; i++) {\n            const select = clonedSelects[i];\n            const value = values[i];\n            const optionEl = select.querySelector(`option[value=\"${value}\"`);\n            if (optionEl) {\n                optionEl.setAttribute(\"selected\", true);\n            }\n        }\n    }\n\n    const elIsCanvas = el.tagName === \"CANVAS\";\n    const canvases = elIsCanvas ? [el] : [...el.querySelectorAll(\"canvas\")];\n    if (canvases.length > 0) {\n        const clonedCanvases = elIsCanvas ? [cloned] : [...cloned.querySelectorAll(\"canvas\")];\n        for (let i = 0; i < clonedCanvases.length; i++) {\n            const canvas = canvases[i];\n            const clonedCanvas = clonedCanvases[i];\n            clonedCanvas.width = canvas.width;\n            clonedCanvas.height = canvas.height;\n            if (canvas.width > 0 && canvas.height > 0) {\n                clonedCanvas.getContext(\"2d\").drawImage(canvas, 0, 0);\n            }\n        }\n    }\n\n    return cloned;\n}\n","/**\n * @type {{USE_COMPUTED_STYLE_INSTEAD_OF_BOUNDING_RECT: string}}\n */\nexport const FEATURE_FLAG_NAMES = Object.freeze({\n    // This flag exists as a workaround for issue 454 (basically a browser bug) - seems like these rect values take time to update when in grid layout. Setting it to true can cause strange behaviour in the REPL for non-grid zones, see issue 470\n    USE_COMPUTED_STYLE_INSTEAD_OF_BOUNDING_RECT: \"USE_COMPUTED_STYLE_INSTEAD_OF_BOUNDING_RECT\"\n});\n\nconst featureFlagsMap = {\n    [FEATURE_FLAG_NAMES.USE_COMPUTED_STYLE_INSTEAD_OF_BOUNDING_RECT]: false\n};\n\n/**\n * @param {FEATURE_FLAG_NAMES} flagName\n * @param {boolean} flagValue\n */\nexport function setFeatureFlag(flagName, flagValue) {\n    if (!FEATURE_FLAG_NAMES[flagName])\n        throw new Error(`Can't set non existing feature flag ${flagName}! Supported flags: ${Object.keys(FEATURE_FLAG_NAMES)}`);\n    featureFlagsMap[flagName] = !!flagValue;\n}\n\n/**\n *\n * @param {FEATURE_FLAG_NAMES} flagName\n * @return {boolean}\n */\nexport function getFeatureFlag(flagName) {\n    if (!FEATURE_FLAG_NAMES[flagName])\n        throw new Error(`Can't get non existing feature flag ${flagName}! Supported flags: ${Object.keys(FEATURE_FLAG_NAMES)}`);\n    return featureFlagsMap[flagName];\n}\n","import {SHADOW_ELEMENT_ATTRIBUTE_NAME, DRAGGED_ELEMENT_ID} from \"../constants\";\nimport {findCenter} from \"./intersection\";\nimport {svelteNodeClone} from \"./svelteNodeClone\";\nimport {getFeatureFlag, FEATURE_FLAG_NAMES} from \"../featureFlags\";\n\nconst TRANSITION_DURATION_SECONDS = 0.2;\n\n/**\n * private helper function - creates a transition string for a property\n * @param {string} property\n * @return {string} - the transition string\n */\nfunction trs(property) {\n    return `${property} ${TRANSITION_DURATION_SECONDS}s ease`;\n}\n/**\n * clones the given element and applies proper styles and transitions to the dragged element\n * @param {HTMLElement} originalElement\n * @param {Point} [positionCenterOnXY]\n * @return {Node} - the cloned, styled element\n */\nexport function createDraggedElementFrom(originalElement, positionCenterOnXY) {\n    const rect = originalElement.getBoundingClientRect();\n    const draggedEl = svelteNodeClone(originalElement);\n    copyStylesFromTo(originalElement, draggedEl);\n    draggedEl.id = DRAGGED_ELEMENT_ID;\n    draggedEl.style.position = \"fixed\";\n    let elTopPx = rect.top;\n    let elLeftPx = rect.left;\n    draggedEl.style.top = `${elTopPx}px`;\n    draggedEl.style.left = `${elLeftPx}px`;\n    if (positionCenterOnXY) {\n        const center = findCenter(rect);\n        elTopPx -= center.y - positionCenterOnXY.y;\n        elLeftPx -= center.x - positionCenterOnXY.x;\n        window.setTimeout(() => {\n            draggedEl.style.top = `${elTopPx}px`;\n            draggedEl.style.left = `${elLeftPx}px`;\n        }, 0);\n    }\n    draggedEl.style.margin = \"0\";\n    // we can't have relative or automatic height and width or it will break the illusion\n    draggedEl.style.boxSizing = \"border-box\";\n    draggedEl.style.height = `${rect.height}px`;\n    draggedEl.style.width = `${rect.width}px`;\n    draggedEl.style.transition = `${trs(\"top\")}, ${trs(\"left\")}, ${trs(\"background-color\")}, ${trs(\"opacity\")}, ${trs(\"color\")} `;\n    // this is a workaround for a strange browser bug that causes the right border to disappear when all the transitions are added at the same time\n    window.setTimeout(() => (draggedEl.style.transition += `, ${trs(\"width\")}, ${trs(\"height\")}`), 0);\n    draggedEl.style.zIndex = \"9999\";\n    draggedEl.style.cursor = \"grabbing\";\n\n    return draggedEl;\n}\n\n/**\n * styles the dragged element to a 'dropped' state\n * @param {HTMLElement} draggedEl\n */\nexport function moveDraggedElementToWasDroppedState(draggedEl) {\n    draggedEl.style.cursor = \"grab\";\n}\n\n/**\n * Morphs the dragged element style, maintains the mouse pointer within the element\n * @param {HTMLElement} draggedEl\n * @param {HTMLElement} copyFromEl - the element the dragged element should look like, typically the shadow element\n * @param {number} currentMouseX\n * @param {number} currentMouseY\n */\nexport function morphDraggedElementToBeLike(draggedEl, copyFromEl, currentMouseX, currentMouseY) {\n    copyStylesFromTo(copyFromEl, draggedEl);\n    const newRect = copyFromEl.getBoundingClientRect();\n    const draggedElRect = draggedEl.getBoundingClientRect();\n    const widthChange = newRect.width - draggedElRect.width;\n    const heightChange = newRect.height - draggedElRect.height;\n    if (widthChange || heightChange) {\n        const relativeDistanceOfMousePointerFromDraggedSides = {\n            left: (currentMouseX - draggedElRect.left) / draggedElRect.width,\n            top: (currentMouseY - draggedElRect.top) / draggedElRect.height\n        };\n        if (!getFeatureFlag(FEATURE_FLAG_NAMES.USE_COMPUTED_STYLE_INSTEAD_OF_BOUNDING_RECT)) {\n            draggedEl.style.height = `${newRect.height}px`;\n            draggedEl.style.width = `${newRect.width}px`;\n        }\n        draggedEl.style.left = `${parseFloat(draggedEl.style.left) - relativeDistanceOfMousePointerFromDraggedSides.left * widthChange}px`;\n        draggedEl.style.top = `${parseFloat(draggedEl.style.top) - relativeDistanceOfMousePointerFromDraggedSides.top * heightChange}px`;\n    }\n}\n\n/**\n * @param {HTMLElement} copyFromEl\n * @param {HTMLElement} copyToEl\n */\nfunction copyStylesFromTo(copyFromEl, copyToEl) {\n    const computedStyle = window.getComputedStyle(copyFromEl);\n    Array.from(computedStyle)\n        .filter(\n            s =>\n                s.startsWith(\"background\") ||\n                s.startsWith(\"padding\") ||\n                s.startsWith(\"font\") ||\n                s.startsWith(\"text\") ||\n                s.startsWith(\"align\") ||\n                s.startsWith(\"justify\") ||\n                s.startsWith(\"display\") ||\n                s.startsWith(\"flex\") ||\n                s.startsWith(\"border\") ||\n                s === \"opacity\" ||\n                s === \"color\" ||\n                s === \"list-style-type\" ||\n                // copying with and height to make up for rect update timing issues in some browsers\n                (getFeatureFlag(FEATURE_FLAG_NAMES.USE_COMPUTED_STYLE_INSTEAD_OF_BOUNDING_RECT) && (s === \"width\" || s === \"height\"))\n        )\n        .forEach(s => copyToEl.style.setProperty(s, computedStyle.getPropertyValue(s), computedStyle.getPropertyPriority(s)));\n}\n\n/**\n * makes the element compatible with being draggable\n * @param {HTMLElement} draggableEl\n * @param {boolean} dragDisabled\n */\nexport function styleDraggable(draggableEl, dragDisabled) {\n    draggableEl.draggable = false;\n    draggableEl.ondragstart = () => false;\n    if (!dragDisabled) {\n        draggableEl.style.userSelect = \"none\";\n        draggableEl.style.WebkitUserSelect = \"none\";\n        draggableEl.style.cursor = \"grab\";\n    } else {\n        draggableEl.style.userSelect = \"\";\n        draggableEl.style.WebkitUserSelect = \"\";\n        draggableEl.style.cursor = \"\";\n    }\n}\n\n/**\n * Hides the provided element so that it can stay in the dom without interrupting\n * @param {HTMLElement} dragTarget\n */\nexport function hideElement(dragTarget) {\n    dragTarget.style.display = \"none\";\n    dragTarget.style.position = \"fixed\";\n    dragTarget.style.zIndex = \"-5\";\n}\n\n/**\n * styles the shadow element\n * @param {HTMLElement} shadowEl\n */\nexport function decorateShadowEl(shadowEl) {\n    shadowEl.style.visibility = \"hidden\";\n    shadowEl.setAttribute(SHADOW_ELEMENT_ATTRIBUTE_NAME, \"true\");\n}\n\n/**\n * undo the styles the shadow element\n * @param {HTMLElement} shadowEl\n */\nexport function unDecorateShadowElement(shadowEl) {\n    shadowEl.style.visibility = \"\";\n    shadowEl.removeAttribute(SHADOW_ELEMENT_ATTRIBUTE_NAME);\n}\n\n/**\n * will mark the given dropzones as visually active\n * @param {Array<HTMLElement>} dropZones\n * @param {Function} getStyles - maps a dropzone to a styles object (so the styles can be removed)\n * @param {Function} getClasses - maps a dropzone to a classList\n */\nexport function styleActiveDropZones(dropZones, getStyles = () => {}, getClasses = () => []) {\n    dropZones.forEach(dz => {\n        const styles = getStyles(dz);\n        Object.keys(styles).forEach(style => {\n            dz.style[style] = styles[style];\n        });\n        getClasses(dz).forEach(c => dz.classList.add(c));\n    });\n}\n\n/**\n * will remove the 'active' styling from given dropzones\n * @param {Array<HTMLElement>} dropZones\n * @param {Function} getStyles - maps a dropzone to a styles object\n * @param {Function} getClasses - maps a dropzone to a classList\n */\nexport function styleInactiveDropZones(dropZones, getStyles = () => {}, getClasses = () => []) {\n    dropZones.forEach(dz => {\n        const styles = getStyles(dz);\n        Object.keys(styles).forEach(style => {\n            dz.style[style] = \"\";\n        });\n        getClasses(dz).forEach(c => dz.classList.contains(c) && dz.classList.remove(c));\n    });\n}\n\n/**\n * will prevent the provided element from shrinking by setting its minWidth and minHeight to the current width and height values\n * @param {HTMLElement} el\n * @return {function(): void} - run this function to undo the operation and restore the original values\n */\nexport function preventShrinking(el) {\n    const originalMinHeight = el.style.minHeight;\n    el.style.minHeight = window.getComputedStyle(el).getPropertyValue(\"height\");\n    const originalMinWidth = el.style.minWidth;\n    el.style.minWidth = window.getComputedStyle(el).getPropertyValue(\"width\");\n    return function undo() {\n        el.style.minHeight = originalMinHeight;\n        el.style.minWidth = originalMinWidth;\n    };\n}\n","import {\n    decrementActiveDropZoneCount,\n    incrementActiveDropZoneCount,\n    ITEM_ID_KEY,\n    printDebug,\n    SHADOW_ITEM_MARKER_PROPERTY_NAME,\n    SHADOW_PLACEHOLDER_ITEM_ID,\n    SOURCES,\n    TRIGGERS\n} from \"./constants\";\nimport {observe, unobserve} from \"./helpers/observer\";\nimport {createMultiScroller} from \"./helpers/multiScroller\";\nimport {\n    createDraggedElementFrom,\n    decorateShadowEl,\n    hideElement,\n    morphDraggedElementToBeLike,\n    moveDraggedElementToWasDroppedState,\n    preventShrinking,\n    styleActiveDropZones,\n    styleDraggable,\n    styleInactiveDropZones,\n    unDecorateShadowElement\n} from \"./helpers/styler\";\nimport {\n    dispatchConsiderEvent,\n    dispatchFinalizeEvent,\n    DRAGGED_ENTERED_EVENT_NAME,\n    DRAGGED_LEFT_DOCUMENT_EVENT_NAME,\n    DRAGGED_LEFT_EVENT_NAME,\n    DRAGGED_LEFT_TYPES,\n    DRAGGED_OVER_INDEX_EVENT_NAME\n} from \"./helpers/dispatcher\";\nimport {areArraysShallowEqualSameOrder, areObjectsShallowEqual, toString} from \"./helpers/util\";\nimport {getBoundingRectNoTransforms} from \"./helpers/intersection\";\n\nconst DEFAULT_DROP_ZONE_TYPE = \"--any--\";\nconst MIN_OBSERVATION_INTERVAL_MS = 100;\nconst DISABLED_OBSERVATION_INTERVAL_MS = 20;\nconst MIN_MOVEMENT_BEFORE_DRAG_START_PX = 3;\nconst DEFAULT_DROP_TARGET_STYLE = {\n    outline: \"rgba(255, 255, 102, 0.7) solid 2px\"\n};\nconst ORIGINAL_DRAGGED_ITEM_MARKER_ATTRIBUTE = \"data-is-dnd-original-dragged-item\";\n\nlet originalDragTarget;\nlet draggedEl;\nlet draggedElData;\nlet draggedElType;\nlet originDropZone;\nlet originIndex;\nlet shadowElData;\nlet shadowElDropZone;\nlet dragStartMousePosition;\nlet currentMousePosition;\nlet isWorkingOnPreviousDrag = false;\nlet finalizingPreviousDrag = false;\nlet unlockOriginDzMinDimensions;\nlet isDraggedOutsideOfAnyDz = false;\nlet scheduledForRemovalAfterDrop = [];\nlet multiScroller;\n\n// a map from type to a set of drop-zones\nconst typeToDropZones = new Map();\n// important - this is needed because otherwise the config that would be used for everyone is the config of the element that created the event listeners\nconst dzToConfig = new Map();\n// this is needed in order to be able to cleanup old listeners and avoid stale closures issues (as the listener is defined within each zone)\nconst elToMouseDownListener = new WeakMap();\n\n/* drop-zones registration management */\nfunction registerDropZone(dropZoneEl, type) {\n    printDebug(() => \"registering drop-zone if absent\");\n    if (!typeToDropZones.has(type)) {\n        typeToDropZones.set(type, new Set());\n    }\n    if (!typeToDropZones.get(type).has(dropZoneEl)) {\n        typeToDropZones.get(type).add(dropZoneEl);\n        incrementActiveDropZoneCount();\n    }\n}\nfunction unregisterDropZone(dropZoneEl, type) {\n    typeToDropZones.get(type).delete(dropZoneEl);\n    decrementActiveDropZoneCount();\n    if (typeToDropZones.get(type).size === 0) {\n        typeToDropZones.delete(type);\n    }\n}\n\n/* functions to manage observing the dragged element and trigger custom drag-events */\nfunction watchDraggedElement() {\n    printDebug(() => \"watching dragged element\");\n    const dropZones = typeToDropZones.get(draggedElType);\n\n    for (const dz of dropZones) {\n        dz.addEventListener(DRAGGED_ENTERED_EVENT_NAME, handleDraggedEntered);\n        dz.addEventListener(DRAGGED_LEFT_EVENT_NAME, handleDraggedLeft);\n        dz.addEventListener(DRAGGED_OVER_INDEX_EVENT_NAME, handleDraggedIsOverIndex);\n    }\n    window.addEventListener(DRAGGED_LEFT_DOCUMENT_EVENT_NAME, handleDrop);\n\n    // it is important that we don't have an interval that is faster than the flip duration because it can cause elements to jump bach and forth\n    const setIntervalMs = Math.max(...Array.from(dropZones.keys()).map(dz => dzToConfig.get(dz).dropAnimationDurationMs));\n    const observationIntervalMs = setIntervalMs === 0 ? DISABLED_OBSERVATION_INTERVAL_MS : Math.max(setIntervalMs, MIN_OBSERVATION_INTERVAL_MS); // if setIntervalMs is 0 it goes to 20, otherwise it is max between it and min observation.\n    multiScroller = createMultiScroller(dropZones, () => currentMousePosition);\n    observe(draggedEl, dropZones, observationIntervalMs * 1.07, multiScroller);\n}\nfunction unWatchDraggedElement() {\n    printDebug(() => \"unwatching dragged element\");\n    const dropZones = typeToDropZones.get(draggedElType);\n    for (const dz of dropZones) {\n        dz.removeEventListener(DRAGGED_ENTERED_EVENT_NAME, handleDraggedEntered);\n        dz.removeEventListener(DRAGGED_LEFT_EVENT_NAME, handleDraggedLeft);\n        dz.removeEventListener(DRAGGED_OVER_INDEX_EVENT_NAME, handleDraggedIsOverIndex);\n    }\n    window.removeEventListener(DRAGGED_LEFT_DOCUMENT_EVENT_NAME, handleDrop);\n    multiScroller.destroy();\n    multiScroller = undefined;\n    unobserve();\n}\n\nfunction findShadowElementIdx(items) {\n    return items.findIndex(item => !!item[SHADOW_ITEM_MARKER_PROPERTY_NAME]);\n}\nfunction createShadowElData(draggedElData) {\n    return {...draggedElData, [SHADOW_ITEM_MARKER_PROPERTY_NAME]: true, [ITEM_ID_KEY]: SHADOW_PLACEHOLDER_ITEM_ID};\n}\n\n/* custom drag-events handlers */\nfunction handleDraggedEntered(e) {\n    printDebug(() => [\"dragged entered\", e.currentTarget, e.detail]);\n    let {items, dropFromOthersDisabled} = dzToConfig.get(e.currentTarget);\n    if (dropFromOthersDisabled && e.currentTarget !== originDropZone) {\n        printDebug(() => \"ignoring dragged entered because drop is currently disabled\");\n        return;\n    }\n    isDraggedOutsideOfAnyDz = false;\n    // this deals with another race condition. in rare occasions (super rapid operations) the list hasn't updated yet\n    items = items.filter(item => item[ITEM_ID_KEY] !== shadowElData[ITEM_ID_KEY]);\n    printDebug(() => `dragged entered items ${toString(items)}`);\n\n    if (originDropZone !== e.currentTarget) {\n        const originZoneItems = dzToConfig.get(originDropZone).items;\n        const newOriginZoneItems = originZoneItems.filter(item => !item[SHADOW_ITEM_MARKER_PROPERTY_NAME]);\n        dispatchConsiderEvent(originDropZone, newOriginZoneItems, {\n            trigger: TRIGGERS.DRAGGED_ENTERED_ANOTHER,\n            id: draggedElData[ITEM_ID_KEY],\n            source: SOURCES.POINTER\n        });\n    }\n    const {index, isProximityBased} = e.detail.indexObj;\n    const shadowElIdx = isProximityBased && index === e.currentTarget.children.length - 1 ? index + 1 : index;\n    shadowElDropZone = e.currentTarget;\n    items.splice(shadowElIdx, 0, shadowElData);\n    dispatchConsiderEvent(e.currentTarget, items, {trigger: TRIGGERS.DRAGGED_ENTERED, id: draggedElData[ITEM_ID_KEY], source: SOURCES.POINTER});\n}\n\nfunction handleDraggedLeft(e) {\n    // dealing with a rare race condition on extremely rapid clicking and dropping\n    if (!isWorkingOnPreviousDrag) return;\n    printDebug(() => [\"dragged left\", e.currentTarget, e.detail]);\n    const {items: originalItems, dropFromOthersDisabled} = dzToConfig.get(e.currentTarget);\n    if (dropFromOthersDisabled && e.currentTarget !== originDropZone && e.currentTarget !== shadowElDropZone) {\n        printDebug(() => \"drop is currently disabled\");\n        return;\n    }\n    const items = [...originalItems];\n    const shadowElIdx = findShadowElementIdx(items);\n    if (shadowElIdx !== -1) {\n        items.splice(shadowElIdx, 1);\n    }\n    const origShadowDz = shadowElDropZone;\n    shadowElDropZone = undefined;\n    const {type, theOtherDz} = e.detail;\n    if (\n        type === DRAGGED_LEFT_TYPES.OUTSIDE_OF_ANY ||\n        (type === DRAGGED_LEFT_TYPES.LEFT_FOR_ANOTHER && theOtherDz !== originDropZone && dzToConfig.get(theOtherDz).dropFromOthersDisabled)\n    ) {\n        printDebug(() => \"dragged left all, putting shadow element back in the origin dz\");\n        isDraggedOutsideOfAnyDz = true;\n        shadowElDropZone = originDropZone;\n        // if the last zone it left is the origin dz, we will put it back into items (which we just removed it from)\n        const originZoneItems = origShadowDz === originDropZone ? items : [...dzToConfig.get(originDropZone).items];\n        originZoneItems.splice(originIndex, 0, shadowElData);\n        dispatchConsiderEvent(originDropZone, originZoneItems, {\n            trigger: TRIGGERS.DRAGGED_LEFT_ALL,\n            id: draggedElData[ITEM_ID_KEY],\n            source: SOURCES.POINTER\n        });\n    }\n    // for the origin dz, when the dragged is outside of any, this will be fired in addition to the previous. this is for simplicity\n    dispatchConsiderEvent(e.currentTarget, items, {\n        trigger: TRIGGERS.DRAGGED_LEFT,\n        id: draggedElData[ITEM_ID_KEY],\n        source: SOURCES.POINTER\n    });\n}\nfunction handleDraggedIsOverIndex(e) {\n    printDebug(() => [\"dragged is over index\", e.currentTarget, e.detail]);\n    const {items: originalItems, dropFromOthersDisabled} = dzToConfig.get(e.currentTarget);\n    if (dropFromOthersDisabled && e.currentTarget !== originDropZone) {\n        printDebug(() => \"drop is currently disabled\");\n        return;\n    }\n    const items = [...originalItems];\n    isDraggedOutsideOfAnyDz = false;\n    const {index} = e.detail.indexObj;\n    const shadowElIdx = findShadowElementIdx(items);\n    if (shadowElIdx !== -1) {\n        items.splice(shadowElIdx, 1);\n    }\n    items.splice(index, 0, shadowElData);\n    dispatchConsiderEvent(e.currentTarget, items, {trigger: TRIGGERS.DRAGGED_OVER_INDEX, id: draggedElData[ITEM_ID_KEY], source: SOURCES.POINTER});\n}\n\n// Global mouse/touch-events handlers\nfunction handleMouseMove(e) {\n    e.preventDefault();\n    const c = e.touches ? e.touches[0] : e;\n    currentMousePosition = {x: c.clientX, y: c.clientY};\n    draggedEl.style.transform = `translate3d(${currentMousePosition.x - dragStartMousePosition.x}px, ${\n        currentMousePosition.y - dragStartMousePosition.y\n    }px, 0)`;\n}\n\nfunction handleDrop() {\n    printDebug(() => \"dropped\");\n    finalizingPreviousDrag = true;\n    // cleanup\n    window.removeEventListener(\"mousemove\", handleMouseMove);\n    window.removeEventListener(\"touchmove\", handleMouseMove);\n    window.removeEventListener(\"mouseup\", handleDrop);\n    window.removeEventListener(\"touchend\", handleDrop);\n    unWatchDraggedElement();\n    moveDraggedElementToWasDroppedState(draggedEl);\n\n    if (!shadowElDropZone) {\n        printDebug(() => \"element was dropped right after it left origin but before entering somewhere else\");\n        shadowElDropZone = originDropZone;\n    }\n    printDebug(() => [\"dropped in dz\", shadowElDropZone]);\n    let {items, type} = dzToConfig.get(shadowElDropZone);\n    styleInactiveDropZones(\n        typeToDropZones.get(type),\n        dz => dzToConfig.get(dz).dropTargetStyle,\n        dz => dzToConfig.get(dz).dropTargetClasses\n    );\n    let shadowElIdx = findShadowElementIdx(items);\n    // the handler might remove the shadow element, ex: dragula like copy on drag\n    if (shadowElIdx === -1) {\n        if (shadowElDropZone === originDropZone) {\n            shadowElIdx = originIndex;\n        }\n    }\n\n    items = items.map(item => (item[SHADOW_ITEM_MARKER_PROPERTY_NAME] ? draggedElData : item));\n    function finalizeWithinZone() {\n        unlockOriginDzMinDimensions();\n        dispatchFinalizeEvent(shadowElDropZone, items, {\n            trigger: isDraggedOutsideOfAnyDz ? TRIGGERS.DROPPED_OUTSIDE_OF_ANY : TRIGGERS.DROPPED_INTO_ZONE,\n            id: draggedElData[ITEM_ID_KEY],\n            source: SOURCES.POINTER\n        });\n        if (shadowElDropZone !== originDropZone) {\n            // letting the origin drop zone know the element was permanently taken away\n            dispatchFinalizeEvent(originDropZone, dzToConfig.get(originDropZone).items, {\n                trigger: TRIGGERS.DROPPED_INTO_ANOTHER,\n                id: draggedElData[ITEM_ID_KEY],\n                source: SOURCES.POINTER\n            });\n        }\n        if (shadowElIdx !== -1) unDecorateShadowElement(shadowElDropZone.children[shadowElIdx]);\n        cleanupPostDrop();\n    }\n    animateDraggedToFinalPosition(shadowElIdx, finalizeWithinZone);\n}\n\n// helper function for handleDrop\nfunction animateDraggedToFinalPosition(shadowElIdx, callback) {\n    const shadowElRect =\n        shadowElIdx > -1 ? getBoundingRectNoTransforms(shadowElDropZone.children[shadowElIdx]) : getBoundingRectNoTransforms(shadowElDropZone);\n    const newTransform = {\n        x: shadowElRect.left - parseFloat(draggedEl.style.left),\n        y: shadowElRect.top - parseFloat(draggedEl.style.top)\n    };\n    const {dropAnimationDurationMs} = dzToConfig.get(shadowElDropZone);\n    const transition = `transform ${dropAnimationDurationMs}ms ease`;\n    draggedEl.style.transition = draggedEl.style.transition ? draggedEl.style.transition + \",\" + transition : transition;\n    draggedEl.style.transform = `translate3d(${newTransform.x}px, ${newTransform.y}px, 0)`;\n    window.setTimeout(callback, dropAnimationDurationMs);\n}\n\nfunction scheduleDZForRemovalAfterDrop(dz, destroy) {\n    scheduledForRemovalAfterDrop.push({dz, destroy});\n    window.requestAnimationFrame(() => {\n        hideElement(dz);\n        document.body.appendChild(dz);\n    });\n}\n/* cleanup */\nfunction cleanupPostDrop() {\n    draggedEl.remove();\n    originalDragTarget.remove();\n    if (scheduledForRemovalAfterDrop.length) {\n        printDebug(() => [\"will destroy zones that were removed during drag\", scheduledForRemovalAfterDrop]);\n        scheduledForRemovalAfterDrop.forEach(({dz, destroy}) => {\n            destroy();\n            dz.remove();\n        });\n        scheduledForRemovalAfterDrop = [];\n    }\n    draggedEl = undefined;\n    originalDragTarget = undefined;\n    draggedElData = undefined;\n    draggedElType = undefined;\n    originDropZone = undefined;\n    originIndex = undefined;\n    shadowElData = undefined;\n    shadowElDropZone = undefined;\n    dragStartMousePosition = undefined;\n    currentMousePosition = undefined;\n    isWorkingOnPreviousDrag = false;\n    finalizingPreviousDrag = false;\n    unlockOriginDzMinDimensions = undefined;\n    isDraggedOutsideOfAnyDz = false;\n}\n\nexport function dndzone(node, options) {\n    let initialized = false;\n    const config = {\n        items: undefined,\n        type: undefined,\n        flipDurationMs: 0,\n        dragDisabled: false,\n        morphDisabled: false,\n        dropFromOthersDisabled: false,\n        dropTargetStyle: DEFAULT_DROP_TARGET_STYLE,\n        dropTargetClasses: [],\n        transformDraggedElement: () => {},\n        centreDraggedOnCursor: false\n    };\n    printDebug(() => [`dndzone good to go options: ${toString(options)}, config: ${toString(config)}`, {node}]);\n    let elToIdx = new Map();\n\n    function addMaybeListeners() {\n        window.addEventListener(\"mousemove\", handleMouseMoveMaybeDragStart, {passive: false});\n        window.addEventListener(\"touchmove\", handleMouseMoveMaybeDragStart, {passive: false, capture: false});\n        window.addEventListener(\"mouseup\", handleFalseAlarm, {passive: false});\n        window.addEventListener(\"touchend\", handleFalseAlarm, {passive: false});\n    }\n    function removeMaybeListeners() {\n        window.removeEventListener(\"mousemove\", handleMouseMoveMaybeDragStart);\n        window.removeEventListener(\"touchmove\", handleMouseMoveMaybeDragStart);\n        window.removeEventListener(\"mouseup\", handleFalseAlarm);\n        window.removeEventListener(\"touchend\", handleFalseAlarm);\n    }\n    function handleFalseAlarm(e) {\n        removeMaybeListeners();\n        originalDragTarget = undefined;\n        dragStartMousePosition = undefined;\n        currentMousePosition = undefined;\n\n        // dragging initiated by touch events prevents onclick from initially firing\n        if (e.type === \"touchend\") {\n            e.target.click();\n        }\n    }\n\n    function handleMouseMoveMaybeDragStart(e) {\n        e.preventDefault();\n        const c = e.touches ? e.touches[0] : e;\n        currentMousePosition = {x: c.clientX, y: c.clientY};\n        if (\n            Math.abs(currentMousePosition.x - dragStartMousePosition.x) >= MIN_MOVEMENT_BEFORE_DRAG_START_PX ||\n            Math.abs(currentMousePosition.y - dragStartMousePosition.y) >= MIN_MOVEMENT_BEFORE_DRAG_START_PX\n        ) {\n            removeMaybeListeners();\n            handleDragStart();\n        }\n    }\n    function handleMouseDown(e) {\n        // on safari clicking on a select element doesn't fire mouseup at the end of the click and in general this makes more sense\n        if (e.target !== e.currentTarget && (e.target.value !== undefined || e.target.isContentEditable)) {\n            printDebug(() => \"won't initiate drag on a nested input element\");\n            return;\n        }\n        // prevents responding to any button but left click which equals 0 (which is falsy)\n        if (e.button) {\n            printDebug(() => `ignoring none left click button: ${e.button}`);\n            return;\n        }\n        if (isWorkingOnPreviousDrag) {\n            printDebug(() => \"cannot start a new drag before finalizing previous one\");\n            return;\n        }\n        e.preventDefault();\n        e.stopPropagation();\n        const c = e.touches ? e.touches[0] : e;\n        dragStartMousePosition = {x: c.clientX, y: c.clientY};\n        currentMousePosition = {...dragStartMousePosition};\n        originalDragTarget = e.currentTarget;\n        addMaybeListeners();\n    }\n\n    function handleDragStart() {\n        printDebug(() => [`drag start config: ${toString(config)}`, originalDragTarget]);\n        isWorkingOnPreviousDrag = true;\n\n        // initialising globals\n        const currentIdx = elToIdx.get(originalDragTarget);\n        originIndex = currentIdx;\n        originDropZone = originalDragTarget.parentElement;\n        /** @type {ShadowRoot | HTMLDocument | Element } */\n        const rootNode = originDropZone.closest(\"dialog\") || originDropZone.getRootNode();\n        const originDropZoneRoot = rootNode.body || rootNode;\n        const {items: originalItems, type, centreDraggedOnCursor} = config;\n        const items = [...originalItems];\n        draggedElData = items[currentIdx];\n        draggedElType = type;\n        shadowElData = createShadowElData(draggedElData);\n\n        // creating the draggable element\n        draggedEl = createDraggedElementFrom(originalDragTarget, centreDraggedOnCursor && currentMousePosition);\n        originalDragTarget.setAttribute(ORIGINAL_DRAGGED_ITEM_MARKER_ATTRIBUTE, true);\n\n        // We will keep the original dom node in the dom because touch events keep firing on it, we want to re-add it after the framework removes it\n        function keepOriginalElementInDom() {\n            if (!draggedEl.parentElement) {\n                originDropZoneRoot.appendChild(draggedEl);\n                // to prevent the outline from disappearing\n                draggedEl.focus();\n                watchDraggedElement();\n                hideElement(originalDragTarget);\n                originDropZoneRoot.appendChild(originalDragTarget);\n                // after the removal of the original element we can give the shadow element the original item id so that the host zone can find it and render it correctly if it does lookups by id\n                shadowElData[ITEM_ID_KEY] = draggedElData[ITEM_ID_KEY];\n            } else {\n                window.requestAnimationFrame(keepOriginalElementInDom);\n            }\n        }\n        window.requestAnimationFrame(keepOriginalElementInDom);\n\n        styleActiveDropZones(\n            Array.from(typeToDropZones.get(config.type)).filter(dz => dz === originDropZone || !dzToConfig.get(dz).dropFromOthersDisabled),\n            dz => dzToConfig.get(dz).dropTargetStyle,\n            dz => dzToConfig.get(dz).dropTargetClasses\n        );\n\n        // removing the original element by removing its data entry\n        items.splice(currentIdx, 1, shadowElData);\n        unlockOriginDzMinDimensions = preventShrinking(originDropZone);\n\n        dispatchConsiderEvent(originDropZone, items, {trigger: TRIGGERS.DRAG_STARTED, id: draggedElData[ITEM_ID_KEY], source: SOURCES.POINTER});\n\n        // handing over to global handlers - starting to watch the element\n        window.addEventListener(\"mousemove\", handleMouseMove, {passive: false});\n        window.addEventListener(\"touchmove\", handleMouseMove, {passive: false, capture: false});\n        window.addEventListener(\"mouseup\", handleDrop, {passive: false});\n        window.addEventListener(\"touchend\", handleDrop, {passive: false});\n    }\n\n    function configure({\n        items = undefined,\n        flipDurationMs: dropAnimationDurationMs = 0,\n        type: newType = DEFAULT_DROP_ZONE_TYPE,\n        dragDisabled = false,\n        morphDisabled = false,\n        dropFromOthersDisabled = false,\n        dropTargetStyle = DEFAULT_DROP_TARGET_STYLE,\n        dropTargetClasses = [],\n        transformDraggedElement = () => {},\n        centreDraggedOnCursor = false\n    }) {\n        config.dropAnimationDurationMs = dropAnimationDurationMs;\n        if (config.type && newType !== config.type) {\n            unregisterDropZone(node, config.type);\n        }\n        config.type = newType;\n        config.items = [...items];\n        config.dragDisabled = dragDisabled;\n        config.morphDisabled = morphDisabled;\n        config.transformDraggedElement = transformDraggedElement;\n        config.centreDraggedOnCursor = centreDraggedOnCursor;\n\n        // realtime update for dropTargetStyle\n        if (\n            initialized &&\n            isWorkingOnPreviousDrag &&\n            !finalizingPreviousDrag &&\n            (!areObjectsShallowEqual(dropTargetStyle, config.dropTargetStyle) ||\n                !areArraysShallowEqualSameOrder(dropTargetClasses, config.dropTargetClasses))\n        ) {\n            styleInactiveDropZones(\n                [node],\n                () => config.dropTargetStyle,\n                () => dropTargetClasses\n            );\n            styleActiveDropZones(\n                [node],\n                () => dropTargetStyle,\n                () => dropTargetClasses\n            );\n        }\n        config.dropTargetStyle = dropTargetStyle;\n        config.dropTargetClasses = [...dropTargetClasses];\n\n        // realtime update for dropFromOthersDisabled\n        function getConfigProp(dz, propName) {\n            return dzToConfig.get(dz) ? dzToConfig.get(dz)[propName] : config[propName];\n        }\n        if (initialized && isWorkingOnPreviousDrag && config.dropFromOthersDisabled !== dropFromOthersDisabled) {\n            if (dropFromOthersDisabled) {\n                styleInactiveDropZones(\n                    [node],\n                    dz => getConfigProp(dz, \"dropTargetStyle\"),\n                    dz => getConfigProp(dz, \"dropTargetClasses\")\n                );\n            } else {\n                styleActiveDropZones(\n                    [node],\n                    dz => getConfigProp(dz, \"dropTargetStyle\"),\n                    dz => getConfigProp(dz, \"dropTargetClasses\")\n                );\n            }\n        }\n        config.dropFromOthersDisabled = dropFromOthersDisabled;\n\n        dzToConfig.set(node, config);\n        registerDropZone(node, newType);\n        const shadowElIdx = findShadowElementIdx(config.items);\n        for (let idx = 0; idx < node.children.length; idx++) {\n            const draggableEl = node.children[idx];\n            styleDraggable(draggableEl, dragDisabled);\n            if (idx === shadowElIdx) {\n                if (!morphDisabled) {\n                    morphDraggedElementToBeLike(draggedEl, draggableEl, currentMousePosition.x, currentMousePosition.y);\n                }\n                config.transformDraggedElement(draggedEl, draggedElData, idx);\n                decorateShadowEl(draggableEl);\n                continue;\n            }\n            draggableEl.removeEventListener(\"mousedown\", elToMouseDownListener.get(draggableEl));\n            draggableEl.removeEventListener(\"touchstart\", elToMouseDownListener.get(draggableEl));\n            if (!dragDisabled) {\n                draggableEl.addEventListener(\"mousedown\", handleMouseDown);\n                draggableEl.addEventListener(\"touchstart\", handleMouseDown);\n                elToMouseDownListener.set(draggableEl, handleMouseDown);\n            }\n            // updating the idx\n            elToIdx.set(draggableEl, idx);\n\n            if (!initialized) {\n                initialized = true;\n            }\n        }\n    }\n    configure(options);\n\n    return {\n        update: newOptions => {\n            printDebug(() => `pointer dndzone will update newOptions: ${toString(newOptions)}`);\n            configure(newOptions);\n        },\n        destroy: () => {\n            function destroyDz() {\n                printDebug(() => \"pointer dndzone will destroy\");\n                unregisterDropZone(node, dzToConfig.get(node).type);\n                dzToConfig.delete(node);\n            }\n            if (isWorkingOnPreviousDrag && !node.closest(`[${ORIGINAL_DRAGGED_ITEM_MARKER_ATTRIBUTE}]`)) {\n                printDebug(() => \"pointer dndzone will be scheduled for destruction\");\n                scheduleDZForRemovalAfterDrop(node, destroyDz);\n            } else {\n                destroyDz();\n            }\n        }\n    };\n}\n","import {isOnServer} from \"../constants\";\n\nconst INSTRUCTION_IDs = {\n    DND_ZONE_ACTIVE: \"dnd-zone-active\",\n    DND_ZONE_DRAG_DISABLED: \"dnd-zone-drag-disabled\"\n};\nconst ID_TO_INSTRUCTION = {\n    [INSTRUCTION_IDs.DND_ZONE_ACTIVE]: \"Tab to one the items and press space-bar or enter to start dragging it\",\n    [INSTRUCTION_IDs.DND_ZONE_DRAG_DISABLED]: \"This is a disabled drag and drop list\"\n};\n\nconst ALERT_DIV_ID = \"dnd-action-aria-alert\";\nlet alertsDiv;\n\nfunction initAriaOnBrowser() {\n    if (alertsDiv) {\n        // it is already initialized\n        return;\n    }\n    // setting the dynamic alerts\n    alertsDiv = document.createElement(\"div\");\n    (function initAlertsDiv() {\n        alertsDiv.id = ALERT_DIV_ID;\n        // tab index -1 makes the alert be read twice on chrome for some reason\n        //alertsDiv.tabIndex = -1;\n        alertsDiv.style.position = \"fixed\";\n        alertsDiv.style.bottom = \"0\";\n        alertsDiv.style.left = \"0\";\n        alertsDiv.style.zIndex = \"-5\";\n        alertsDiv.style.opacity = \"0\";\n        alertsDiv.style.height = \"0\";\n        alertsDiv.style.width = \"0\";\n        alertsDiv.setAttribute(\"role\", \"alert\");\n    })();\n    document.body.prepend(alertsDiv);\n\n    // setting the instructions\n    Object.entries(ID_TO_INSTRUCTION).forEach(([id, txt]) => document.body.prepend(instructionToHiddenDiv(id, txt)));\n}\n\n/**\n * Initializes the static aria instructions so they can be attached to zones\n * @return {{DND_ZONE_ACTIVE: string, DND_ZONE_DRAG_DISABLED: string} | null} - the IDs for static aria instruction (to be used via aria-describedby) or null on the server\n */\nexport function initAria() {\n    if (isOnServer) return null;\n    if (document.readyState === \"complete\") {\n        initAriaOnBrowser();\n    } else {\n        window.addEventListener(\"DOMContentLoaded\", initAriaOnBrowser);\n    }\n    return {...INSTRUCTION_IDs};\n}\n\n/**\n * Removes all the artifacts (dom elements) added by this module\n */\nexport function destroyAria() {\n    if (isOnServer || !alertsDiv) return;\n    Object.keys(ID_TO_INSTRUCTION).forEach(id => document.getElementById(id)?.remove());\n    alertsDiv.remove();\n    alertsDiv = undefined;\n}\n\nfunction instructionToHiddenDiv(id, txt) {\n    const div = document.createElement(\"div\");\n    div.id = id;\n    div.innerHTML = `<p>${txt}</p>`;\n    div.style.display = \"none\";\n    div.style.position = \"fixed\";\n    div.style.zIndex = \"-5\";\n    return div;\n}\n\n/**\n * Will make the screen reader alert the provided text to the user\n * @param {string} txt\n */\nexport function alertToScreenReader(txt) {\n    if (isOnServer) return;\n    if (!alertsDiv) {\n        initAriaOnBrowser();\n    }\n    alertsDiv.innerHTML = \"\";\n    const alertText = document.createTextNode(txt);\n    alertsDiv.appendChild(alertText);\n    // this is needed for Safari\n    alertsDiv.style.display = \"none\";\n    alertsDiv.style.display = \"inline\";\n}\n","import {decrementActiveDropZoneCount, incrementActiveDropZoneCount, ITEM_ID_KEY, SOURCES, TRIGGERS} from \"./constants\";\nimport {styleActiveDropZones, styleInactiveDropZones} from \"./helpers/styler\";\nimport {dispatchConsiderEvent, dispatchFinalizeEvent} from \"./helpers/dispatcher\";\nimport {initAria, alertToScreenReader, destroyAria} from \"./helpers/aria\";\nimport {toString} from \"./helpers/util\";\nimport {printDebug} from \"./constants\";\n\nconst DEFAULT_DROP_ZONE_TYPE = \"--any--\";\nconst DEFAULT_DROP_TARGET_STYLE = {\n    outline: \"rgba(255, 255, 102, 0.7) solid 2px\"\n};\n\nlet isDragging = false;\nlet draggedItemType;\nlet focusedDz;\nlet focusedDzLabel = \"\";\nlet focusedItem;\nlet focusedItemId;\nlet focusedItemLabel = \"\";\nconst allDragTargets = new WeakSet();\nconst elToKeyDownListeners = new WeakMap();\nconst elToFocusListeners = new WeakMap();\nconst dzToHandles = new Map();\nconst dzToConfig = new Map();\nconst typeToDropZones = new Map();\n\n/* TODO (potentially)\n * what's the deal with the black border of voice-reader not following focus?\n * maybe keep focus on the last dragged item upon drop?\n */\n\nlet INSTRUCTION_IDs;\n\n/* drop-zones registration management */\nfunction registerDropZone(dropZoneEl, type) {\n    printDebug(() => \"registering drop-zone if absent\");\n    if (typeToDropZones.size === 0) {\n        printDebug(() => \"adding global keydown and click handlers\");\n        INSTRUCTION_IDs = initAria();\n        window.addEventListener(\"keydown\", globalKeyDownHandler);\n        window.addEventListener(\"click\", globalClickHandler);\n    }\n    if (!typeToDropZones.has(type)) {\n        typeToDropZones.set(type, new Set());\n    }\n    if (!typeToDropZones.get(type).has(dropZoneEl)) {\n        typeToDropZones.get(type).add(dropZoneEl);\n        incrementActiveDropZoneCount();\n    }\n}\nfunction unregisterDropZone(dropZoneEl, type) {\n    printDebug(() => \"unregistering drop-zone\");\n    if (focusedDz === dropZoneEl) {\n        handleDrop();\n    }\n    typeToDropZones.get(type).delete(dropZoneEl);\n    decrementActiveDropZoneCount();\n    if (typeToDropZones.get(type).size === 0) {\n        typeToDropZones.delete(type);\n    }\n    if (typeToDropZones.size === 0) {\n        printDebug(() => \"removing global keydown and click handlers\");\n        window.removeEventListener(\"keydown\", globalKeyDownHandler);\n        window.removeEventListener(\"click\", globalClickHandler);\n        INSTRUCTION_IDs = undefined;\n        destroyAria();\n    }\n}\n\nfunction globalKeyDownHandler(e) {\n    if (!isDragging) return;\n    switch (e.key) {\n        case \"Escape\": {\n            handleDrop();\n            break;\n        }\n    }\n}\n\nfunction globalClickHandler() {\n    if (!isDragging) return;\n    if (!allDragTargets.has(document.activeElement)) {\n        printDebug(() => \"clicked outside of any draggable\");\n        handleDrop();\n    }\n}\n\nfunction handleZoneFocus(e) {\n    printDebug(() => \"zone focus\");\n    if (!isDragging) return;\n    const newlyFocusedDz = e.currentTarget;\n    if (newlyFocusedDz === focusedDz) return;\n\n    focusedDzLabel = newlyFocusedDz.getAttribute(\"aria-label\") || \"\";\n    const {items: originItems} = dzToConfig.get(focusedDz);\n    const originItem = originItems.find(item => item[ITEM_ID_KEY] === focusedItemId);\n    const originIdx = originItems.indexOf(originItem);\n    const itemToMove = originItems.splice(originIdx, 1)[0];\n    const {items: targetItems, autoAriaDisabled} = dzToConfig.get(newlyFocusedDz);\n    if (\n        newlyFocusedDz.getBoundingClientRect().top < focusedDz.getBoundingClientRect().top ||\n        newlyFocusedDz.getBoundingClientRect().left < focusedDz.getBoundingClientRect().left\n    ) {\n        targetItems.push(itemToMove);\n        if (!autoAriaDisabled) {\n            alertToScreenReader(`Moved item ${focusedItemLabel} to the end of the list ${focusedDzLabel}`);\n        }\n    } else {\n        targetItems.unshift(itemToMove);\n        if (!autoAriaDisabled) {\n            alertToScreenReader(`Moved item ${focusedItemLabel} to the beginning of the list ${focusedDzLabel}`);\n        }\n    }\n    const dzFrom = focusedDz;\n    dispatchFinalizeEvent(dzFrom, originItems, {trigger: TRIGGERS.DROPPED_INTO_ANOTHER, id: focusedItemId, source: SOURCES.KEYBOARD});\n    dispatchFinalizeEvent(newlyFocusedDz, targetItems, {trigger: TRIGGERS.DROPPED_INTO_ZONE, id: focusedItemId, source: SOURCES.KEYBOARD});\n    focusedDz = newlyFocusedDz;\n}\n\nfunction triggerAllDzsUpdate() {\n    dzToHandles.forEach(({update}, dz) => update(dzToConfig.get(dz)));\n}\n\nfunction handleDrop(dispatchConsider = true) {\n    printDebug(() => \"drop\");\n    if (!dzToConfig.get(focusedDz).autoAriaDisabled) {\n        alertToScreenReader(`Stopped dragging item ${focusedItemLabel}`);\n    }\n    if (allDragTargets.has(document.activeElement)) {\n        document.activeElement.blur();\n    }\n    if (dispatchConsider) {\n        dispatchConsiderEvent(focusedDz, dzToConfig.get(focusedDz).items, {\n            trigger: TRIGGERS.DRAG_STOPPED,\n            id: focusedItemId,\n            source: SOURCES.KEYBOARD\n        });\n    }\n    styleInactiveDropZones(\n        typeToDropZones.get(draggedItemType),\n        dz => dzToConfig.get(dz).dropTargetStyle,\n        dz => dzToConfig.get(dz).dropTargetClasses\n    );\n    focusedItem = null;\n    focusedItemId = null;\n    focusedItemLabel = \"\";\n    draggedItemType = null;\n    focusedDz = null;\n    focusedDzLabel = \"\";\n    isDragging = false;\n    triggerAllDzsUpdate();\n}\n//////\nexport function dndzone(node, options) {\n    const config = {\n        items: undefined,\n        type: undefined,\n        dragDisabled: false,\n        zoneTabIndex: 0,\n        zoneItemTabIndex: 0,\n        dropFromOthersDisabled: false,\n        dropTargetStyle: DEFAULT_DROP_TARGET_STYLE,\n        dropTargetClasses: [],\n        autoAriaDisabled: false\n    };\n\n    function swap(arr, i, j) {\n        if (arr.length <= 1) return;\n        arr.splice(j, 1, arr.splice(i, 1, arr[j])[0]);\n    }\n\n    function handleKeyDown(e) {\n        printDebug(() => [\"handling key down\", e.key]);\n        switch (e.key) {\n            case \"Enter\":\n            case \" \": {\n                // we don't want to affect nested input elements or clickable elements\n                if ((e.target.disabled !== undefined || e.target.href || e.target.isContentEditable) && !allDragTargets.has(e.target)) {\n                    return;\n                }\n                e.preventDefault(); // preventing scrolling on spacebar\n                e.stopPropagation();\n                if (isDragging) {\n                    // TODO - should this trigger a drop? only here or in general (as in when hitting space or enter outside of any zone)?\n                    handleDrop();\n                } else {\n                    // drag start\n                    handleDragStart(e);\n                }\n                break;\n            }\n            case \"ArrowDown\":\n            case \"ArrowRight\": {\n                if (!isDragging) return;\n                e.preventDefault(); // prevent scrolling\n                e.stopPropagation();\n                const {items} = dzToConfig.get(node);\n                const children = Array.from(node.children);\n                const idx = children.indexOf(e.currentTarget);\n                printDebug(() => [\"arrow down\", idx]);\n                if (idx < children.length - 1) {\n                    if (!config.autoAriaDisabled) {\n                        alertToScreenReader(`Moved item ${focusedItemLabel} to position ${idx + 2} in the list ${focusedDzLabel}`);\n                    }\n                    swap(items, idx, idx + 1);\n                    dispatchFinalizeEvent(node, items, {trigger: TRIGGERS.DROPPED_INTO_ZONE, id: focusedItemId, source: SOURCES.KEYBOARD});\n                }\n                break;\n            }\n            case \"ArrowUp\":\n            case \"ArrowLeft\": {\n                if (!isDragging) return;\n                e.preventDefault(); // prevent scrolling\n                e.stopPropagation();\n                const {items} = dzToConfig.get(node);\n                const children = Array.from(node.children);\n                const idx = children.indexOf(e.currentTarget);\n                printDebug(() => [\"arrow up\", idx]);\n                if (idx > 0) {\n                    if (!config.autoAriaDisabled) {\n                        alertToScreenReader(`Moved item ${focusedItemLabel} to position ${idx} in the list ${focusedDzLabel}`);\n                    }\n                    swap(items, idx, idx - 1);\n                    dispatchFinalizeEvent(node, items, {trigger: TRIGGERS.DROPPED_INTO_ZONE, id: focusedItemId, source: SOURCES.KEYBOARD});\n                }\n                break;\n            }\n        }\n    }\n    function handleDragStart(e) {\n        printDebug(() => \"drag start\");\n        setCurrentFocusedItem(e.currentTarget);\n        focusedDz = node;\n        draggedItemType = config.type;\n        isDragging = true;\n        const dropTargets = Array.from(typeToDropZones.get(config.type)).filter(dz => dz === focusedDz || !dzToConfig.get(dz).dropFromOthersDisabled);\n        styleActiveDropZones(\n            dropTargets,\n            dz => dzToConfig.get(dz).dropTargetStyle,\n            dz => dzToConfig.get(dz).dropTargetClasses\n        );\n        if (!config.autoAriaDisabled) {\n            let msg = `Started dragging item ${focusedItemLabel}. Use the arrow keys to move it within its list ${focusedDzLabel}`;\n            if (dropTargets.length > 1) {\n                msg += `, or tab to another list in order to move the item into it`;\n            }\n            alertToScreenReader(msg);\n        }\n        dispatchConsiderEvent(node, dzToConfig.get(node).items, {trigger: TRIGGERS.DRAG_STARTED, id: focusedItemId, source: SOURCES.KEYBOARD});\n        triggerAllDzsUpdate();\n    }\n\n    function handleClick(e) {\n        if (!isDragging) return;\n        if (e.currentTarget === focusedItem) return;\n        e.stopPropagation();\n        handleDrop(false);\n        handleDragStart(e);\n    }\n    function setCurrentFocusedItem(draggableEl) {\n        const {items} = dzToConfig.get(node);\n        const children = Array.from(node.children);\n        const focusedItemIdx = children.indexOf(draggableEl);\n        focusedItem = draggableEl;\n        focusedItem.tabIndex = config.zoneItemTabIndex;\n        focusedItemId = items[focusedItemIdx][ITEM_ID_KEY];\n        focusedItemLabel = children[focusedItemIdx].getAttribute(\"aria-label\") || \"\";\n    }\n\n    function configure({\n        items = [],\n        type: newType = DEFAULT_DROP_ZONE_TYPE,\n        dragDisabled = false,\n        zoneTabIndex = 0,\n        zoneItemTabIndex = 0,\n        dropFromOthersDisabled = false,\n        dropTargetStyle = DEFAULT_DROP_TARGET_STYLE,\n        dropTargetClasses = [],\n        autoAriaDisabled = false\n    }) {\n        config.items = [...items];\n        config.dragDisabled = dragDisabled;\n        config.dropFromOthersDisabled = dropFromOthersDisabled;\n        config.zoneTabIndex = zoneTabIndex;\n        config.zoneItemTabIndex = zoneItemTabIndex;\n        config.dropTargetStyle = dropTargetStyle;\n        config.dropTargetClasses = dropTargetClasses;\n        config.autoAriaDisabled = autoAriaDisabled;\n        if (config.type && newType !== config.type) {\n            unregisterDropZone(node, config.type);\n        }\n        config.type = newType;\n        registerDropZone(node, newType);\n        if (!autoAriaDisabled) {\n            node.setAttribute(\"aria-disabled\", dragDisabled);\n            node.setAttribute(\"role\", \"list\");\n            node.setAttribute(\"aria-describedby\", dragDisabled ? INSTRUCTION_IDs.DND_ZONE_DRAG_DISABLED : INSTRUCTION_IDs.DND_ZONE_ACTIVE);\n        }\n        dzToConfig.set(node, config);\n\n        if (isDragging) {\n            node.tabIndex =\n                node === focusedDz ||\n                focusedItem.contains(node) ||\n                config.dropFromOthersDisabled ||\n                (focusedDz && config.type !== dzToConfig.get(focusedDz).type)\n                    ? -1\n                    : 0;\n        } else {\n            node.tabIndex = config.zoneTabIndex;\n        }\n\n        node.addEventListener(\"focus\", handleZoneFocus);\n\n        for (let i = 0; i < node.children.length; i++) {\n            const draggableEl = node.children[i];\n            allDragTargets.add(draggableEl);\n            draggableEl.tabIndex = isDragging ? -1 : config.zoneItemTabIndex;\n            if (!autoAriaDisabled) {\n                draggableEl.setAttribute(\"role\", \"listitem\");\n            }\n            draggableEl.removeEventListener(\"keydown\", elToKeyDownListeners.get(draggableEl));\n            draggableEl.removeEventListener(\"click\", elToFocusListeners.get(draggableEl));\n            if (!dragDisabled) {\n                draggableEl.addEventListener(\"keydown\", handleKeyDown);\n                elToKeyDownListeners.set(draggableEl, handleKeyDown);\n                draggableEl.addEventListener(\"click\", handleClick);\n                elToFocusListeners.set(draggableEl, handleClick);\n            }\n            if (isDragging && config.items[i][ITEM_ID_KEY] === focusedItemId) {\n                printDebug(() => [\"focusing on\", {i, focusedItemId}]);\n                // if it is a nested dropzone, it was re-rendered and we need to refresh our pointer\n                focusedItem = draggableEl;\n                focusedItem.tabIndex = config.zoneItemTabIndex;\n                // without this the element loses focus if it moves backwards in the list\n                draggableEl.focus();\n            }\n        }\n    }\n    configure(options);\n\n    const handles = {\n        update: newOptions => {\n            printDebug(() => `keyboard dndzone will update newOptions: ${toString(newOptions)}`);\n            configure(newOptions);\n        },\n        destroy: () => {\n            printDebug(() => \"keyboard dndzone will destroy\");\n            unregisterDropZone(node, config.type);\n            dzToConfig.delete(node);\n            dzToHandles.delete(node);\n        }\n    };\n    dzToHandles.set(node, handles);\n    return handles;\n}\n","import {dndzone as pointerDndZone} from \"./pointerAction\";\nimport {dndzone as keyboardDndZone} from \"./keyboardAction\";\nimport {ITEM_ID_KEY, SHADOW_ELEMENT_HINT_ATTRIBUTE_NAME} from \"./constants\";\nimport {toString} from \"./helpers/util\";\n\n/**\n * A custom action to turn any container to a dnd zone and all of its direct children to draggables\n * Supports mouse, touch and keyboard interactions.\n * Dispatches two events that the container is expected to react to by modifying its list of items,\n * which will then feed back in to this action via the update function\n *\n * @typedef {object} Options\n * @property {array} items - the list of items that was used to generate the children of the given node (the list used in the #each block\n * @property {string} [type] - the type of the dnd zone. children dragged from here can only be dropped in other zones of the same type, default to a base type\n * @property {number} [flipDurationMs] - if the list animated using flip (recommended), specifies the flip duration such that everything syncs with it without conflict, defaults to zero\n * @property {boolean} [dragDisabled]\n * @property {boolean} [morphDisabled] - whether dragged element should morph to zone dimensions\n * @property {boolean} [dropFromOthersDisabled]\n * @property {number} [zoneTabIndex] - set the tabindex of the list container when not dragging\n * @property {number} [zoneItemTabIndex] - set the tabindex of the list container items when not dragging\n * @property {object} [dropTargetStyle]\n * @property {string[]} [dropTargetClasses]\n * @property {function} [transformDraggedElement]\n * @param {HTMLElement} node - the element to enhance\n * @param {Options} options\n * @return {{update: function, destroy: function}}\n */\nexport function dndzone(node, options) {\n    if (shouldIgnoreZone(node)) {\n        return {\n            update: () => {},\n            destroy: () => {}\n        };\n    }\n    validateOptions(options);\n    const pointerZone = pointerDndZone(node, options);\n    const keyboardZone = keyboardDndZone(node, options);\n    return {\n        update: newOptions => {\n            validateOptions(newOptions);\n            pointerZone.update(newOptions);\n            keyboardZone.update(newOptions);\n        },\n        destroy: () => {\n            pointerZone.destroy();\n            keyboardZone.destroy();\n        }\n    };\n}\n\n/**\n * If the user marked something in the ancestry of our node as shadow element, we can ignore it\n * We need the user to mark it for us because svelte updates the action from deep to shallow (but renders top down)\n * @param {HTMLElement} node\n * @return {boolean}\n */\nfunction shouldIgnoreZone(node) {\n    return !!node.closest(`[${SHADOW_ELEMENT_HINT_ATTRIBUTE_NAME}=\"true\"]`);\n}\n\nfunction validateOptions(options) {\n    /*eslint-disable*/\n    const {\n        items,\n        flipDurationMs,\n        type,\n        dragDisabled,\n        morphDisabled,\n        dropFromOthersDisabled,\n        zoneTabIndex,\n        zoneItemTabIndex,\n        dropTargetStyle,\n        dropTargetClasses,\n        transformDraggedElement,\n        autoAriaDisabled,\n        centreDraggedOnCursor,\n        ...rest\n    } = options;\n    /*eslint-enable*/\n    if (Object.keys(rest).length > 0) {\n        console.warn(`dndzone will ignore unknown options`, rest);\n    }\n    if (!items) {\n        throw new Error(\"no 'items' key provided to dndzone\");\n    }\n    const itemWithMissingId = items.find(item => !{}.hasOwnProperty.call(item, ITEM_ID_KEY));\n    if (itemWithMissingId) {\n        throw new Error(`missing '${ITEM_ID_KEY}' property for item ${toString(itemWithMissingId)}`);\n    }\n    if (dropTargetClasses && !Array.isArray(dropTargetClasses)) {\n        throw new Error(`dropTargetClasses should be an array but instead it is a ${typeof dropTargetClasses}, ${toString(dropTargetClasses)}`);\n    }\n    if (zoneTabIndex && !isInt(zoneTabIndex)) {\n        throw new Error(`zoneTabIndex should be a number but instead it is a ${typeof zoneTabIndex}, ${toString(zoneTabIndex)}`);\n    }\n    if (zoneItemTabIndex && !isInt(zoneItemTabIndex)) {\n        throw new Error(`zoneItemTabIndex should be a number but instead it is a ${typeof zoneItemTabIndex}, ${toString(zoneItemTabIndex)}`);\n    }\n}\n\nfunction isInt(value) {\n    return (\n        !isNaN(value) &&\n        (function (x) {\n            return (x | 0) === x;\n        })(parseFloat(value))\n    );\n}\n","<script>\r\n\r\n\texport let callback;\r\n\texport let isHovering;\r\n\texport let active = true;\r\n\texport let enterCallback = () => {\r\n\t};\r\n\texport let overCallback = () => {\r\n\t};\r\n\texport let leaveCallback = () => {\r\n\t};\r\n\r\n\tfunction dropData(event, ...args) {\r\n\t\tif (!active) return;\r\n\t\tcounter = 0;\r\n\t\tlet data;\r\n\t\ttry {\r\n\t\t\tdata = JSON.parse(event.dataTransfer.getData('text/plain'));\r\n\t\t} catch (err) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tcallback(data, event, ...args);\r\n\t}\r\n\r\n\tlet counter = 0;\r\n\r\n\tfunction enter(event) {\r\n\t\tif (!active) return;\r\n\t\tcounter++;\r\n\t\tif (counter === 1) {\r\n\t\t\tenterCallback(event);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction leave(event) {\r\n\t\tif (!active) return;\r\n\t\tcounter--;\r\n\t\tif (counter === 0) {\r\n\t\t\tleaveCallback(event);\r\n\t\t}\r\n\t}\r\n\r\n\t$: isHovering = counter > 0;\r\n\r\n</script>\r\n\r\n<div\r\n\tclass={$$props.class}\r\n\ton:dragenter={enter}\r\n\ton:dragleave={leave}\r\n\ton:dragover={overCallback}\r\n\ton:dragstart|preventDefault\r\n\ton:drop|preventDefault={dropData}\r\n\tstyle={$$props.style}\r\n>\r\n\t<slot/>\r\n</div>\r\n","<script>\n\timport { localize } from '#runtime/svelte/helper';\n\timport FilePicker from \"./FilePicker.svelte\";\n\timport { flip } from \"svelte/animate\";\n\timport { dndzone, SOURCES, TRIGGERS } from 'svelte-dnd-action';\n\timport DropZone from \"./DropZone.svelte\";\n\timport * as Helpers from \"../../helpers/helpers.js\";\n\timport { getSetting } from \"../../helpers/helpers.js\";\n\timport * as Utilities from \"../../helpers/utilities.js\";\n\timport SETTINGS from \"../../constants/settings.js\";\n\timport { getActorFlagData } from \"../../helpers/pile-utilities.js\";\n\timport * as CompendiumUtilities from \"../../helpers/compendium-utilities.js\";\n\n\texport let prices;\n\texport let item;\n\texport let remove = false;\n\texport let presets = true;\n\n\tlet currencies = getSetting(SETTINGS.CURRENCIES);\n\tlet secondaryCurrencies = getSetting(SETTINGS.SECONDARY_CURRENCIES);\n\tif (item?.parent) {\n\t\tconst flags = getActorFlagData(item?.parent)\n\t\tif (flags.overrideCurrencies) {\n\t\t\tcurrencies = flags.overrideCurrencies;\n\t\t}\n\t\tif (flags.overrideSecondaryCurrencies) {\n\t\t\tsecondaryCurrencies = flags.overrideSecondaryCurrencies;\n\t\t}\n\t}\n\n\tlet presetPrices = currencies\n\t\t.concat(secondaryCurrencies)\n\t\t.map(currency => {\n\t\t\treturn {\n\t\t\t\tid: foundry.utils.randomID(),\n\t\t\t\tquantity: 1,\n\t\t\t\tfixed: true,\n\t\t\t\tpercent: false,\n\t\t\t\t...currency,\n\t\t\t}\n\t\t})\n\t\t.concat(getSetting(SETTINGS.PRICE_PRESETS));\n\n\tlet isHovering = false;\n\tlet flipDurationMs = 200;\n\tlet dragDisabled = true;\n\tlet selectedPreset = \"\";\n\n\tfunction removeEntry(index) {\n\t\tprices.splice(index, 1);\n\t\tprices = prices;\n\t}\n\n\tfunction addAttribute() {\n\t\tprices = [...prices, {\n\t\t\tid: foundry.utils.randomID(),\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"New Attribute\",\n\t\t\timg: \"\",\n\t\t\tabbreviation: \"{#}N\",\n\t\t\tdata: {\n\t\t\t\tpath: \"\"\n\t\t\t},\n\t\t\tquantity: 1,\n\t\t\tfixed: true,\n\t\t\tpercent: false\n\t\t}];\n\t}\n\n\tfunction addPreset(index) {\n\t\tconst preset = foundry.utils.duplicate(presetPrices[index]);\n\t\tpreset.id = foundry.utils.randomID();\n\t\tprices = [...prices, preset];\n\t}\n\n\tasync function dropData(data) {\n\n\t\tif (!data.type) {\n\t\t\tthrow Helpers.custom_error(\"Something went wrong when dropping this item!\")\n\t\t}\n\n\t\tif (data.type !== \"Item\") {\n\t\t\tthrow Helpers.custom_error(\"You must drop an item, not \" + data.type.toLowerCase() + \"!\")\n\t\t}\n\n\t\tlet uuid = false;\n\t\tif (data.pack) {\n\t\t\tuuid = \"Compendium\" + data.pack + \".\" + data.id;\n\t\t}\n\n\t\tlet item = await Item.implementation.fromDropData(data);\n\t\tlet itemData = item.toObject();\n\n\t\tif (!itemData) {\n\t\t\tconsole.error(data);\n\t\t\tthrow Helpers.custom_error(\"Something went wrong when dropping this item!\")\n\t\t}\n\n\t\tconst itemCurrencies = prices.map(entry => entry.data?.item ?? {});\n\t\tconst foundItem = Utilities.findSimilarItem(itemCurrencies, itemData);\n\n\t\tif (!uuid) {\n\t\t\tuuid = (await CompendiumUtilities.findOrCreateItemInCompendium(itemData)).uuid;\n\t\t}\n\n\t\tif (foundItem) {\n\t\t\tconst index = itemCurrencies.indexOf(foundItem);\n\t\t\tprices[index].data = {\n\t\t\t\tuuid,\n\t\t\t}\n\t\t\tHelpers.custom_notify(`Updated item data for ${localize(prices[index].name)} (item name ${itemData.name})`)\n\t\t} else {\n\t\t\tprices = [...prices, {\n\t\t\t\tid: foundry.utils.randomID(),\n\t\t\t\ttype: \"item\",\n\t\t\t\tname: itemData.name,\n\t\t\t\timg: itemData.img,\n\t\t\t\tabbreviation: \"{#} \" + itemData.name,\n\t\t\t\tdata: {\n\t\t\t\t\tuuid,\n\t\t\t\t},\n\t\t\t\tquantity: 1,\n\t\t\t\tfixed: true,\n\t\t\t\tpercent: false\n\t\t\t}];\n\t\t}\n\t}\n\n\tasync function editItem(index) {\n\t\tconst data = prices[index].data;\n\t\tlet item = await fromUuid(data.uuid);\n\t\titem.sheet.render(true);\n\t}\n\n\tfunction handleConsider(e) {\n\t\tconst { items: newItems, info: { source, trigger } } = e.detail;\n\t\tprices = newItems;\n\t\t// Ensure dragging is stopped on drag finish via keyboard\n\t\tif (source === SOURCES.KEYBOARD && trigger === TRIGGERS.DRAG_STOPPED) {\n\t\t\tdragDisabled = true;\n\t\t}\n\t}\n\n\tfunction handleFinalize(e) {\n\t\tconst { items: newItems, info: { source } } = e.detail;\n\t\tprices = newItems;\n\t\t// Ensure dragging is stopped on drag finish via pointer (mouse, touch)\n\t\tif (source === SOURCES.POINTER) {\n\t\t\tdragDisabled = true;\n\t\t}\n\t}\n\n\tfunction startDrag(e) {\n\t\t// preventing default to prevent lag on touch devices (because of the browser checking for screen scrolling)\n\t\te.preventDefault();\n\t\tdragDisabled = false;\n\t}\n\n\tfunction handleKeyDown(e) {\n\t\tif ((e.key === \"Enter\" || e.key === \" \") && dragDisabled) dragDisabled = false;\n\t}\n\n</script>\n\n\n<DropZone bind:isHovering={isHovering} callback={dropData}>\n\t<div class=\"table-container item-piles-top-divider\">\n\t\t<div class=\"item-piles-sortable-list-columns header\">\n\t\t\t<div></div>\n\t\t\t<div>{localize(\"ITEM-PILES.General.Name\")}</div>\n\t\t\t<div>{localize(\"ITEM-PILES.General.Cost\")}</div>\n\t\t\t<div>{localize(\"ITEM-PILES.General.Fixed\")}</div>\n\t\t\t<div>%</div>\n\t\t\t<div>{localize(\"ITEM-PILES.General.Short\")}</div>\n\t\t\t<div>{localize(\"ITEM-PILES.General.Icon\")}</div>\n\t\t\t<div>{localize(\"ITEM-PILES.General.Data\")}</div>\n\t\t\t<div>\n\t\t\t\t{#if remove}\n\t\t\t\t\t<a class=\"item-piles-clickable-red\" on:click={() => remove()}><i class=\"fas fa-times\"></i></a>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t\t<section\n\t\t\ton:consider=\"{handleConsider}\"\n\t\t\ton:finalize=\"{handleFinalize}\"\n\t\t\tuse:dndzone=\"{{ items: prices, dragDisabled, flipDurationMs }}\"\n\t\t>\n\t\t\t{#if isHovering}\n\t\t\t\t<div class=\"drop-to-add\">Drop to add</div>\n\t\t\t{/if}\n\t\t\t{#each prices as price, index (price.id)}\n\t\t\t\t<div class=\"item-piles-sortable-list-columns item-piles-sortable-list-entry item-piles-even-color\"\n\t\t\t\t     animate:flip=\"{{ duration: flipDurationMs }}\">\n\t\t\t\t\t<div tabIndex={dragDisabled? 0 : -1}\n\t\t\t\t\t     aria-label=\"drag-handle\"\n\t\t\t\t\t     style={dragDisabled ? 'cursor: grab' : 'cursor: grabbing'}\n\t\t\t\t\t     on:mousedown={startDrag}\n\t\t\t\t\t     on:touchstart={startDrag}\n\t\t\t\t\t     on:keydown={handleKeyDown}\n\t\t\t\t\t><i class=\"fas fa-bars\"></i></div>\n\t\t\t\t\t<div><input type=\"text\" bind:value={price.name}/></div>\n\t\t\t\t\t<div><input type=\"number\" bind:value={price.quantity}/></div>\n\t\t\t\t\t<div><input type=\"checkbox\" bind:checked={price.fixed} min=\"0\"\n\t\t\t\t\t            max=\"{price.percent ? 100 : 1000000000000000}\"/></div>\n\t\t\t\t\t<div><input type=\"checkbox\" bind:checked={price.percent}/></div>\n\t\t\t\t\t<div><input type=\"text\" bind:value={price.abbreviation}/></div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<FilePicker type=\"imagevideo\" showImage={true} showInput={false} bind:value={price.img}/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{#if price.type === \"attribute\"}\n\t\t\t\t\t\t\t<input type=\"text\" bind:value={price.data.path} placeholder=\"system.attributes.hp.value\"/>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<button type=\"button\" on:click={() => editItem(index)}>\n\t\t\t\t\t\t\t\t<i class=\"fas fa-eye\"></i> View item\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<button type=\"button\" on:click={() => removeEntry(index)}><i class=\"fas fa-times\"></i></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/each}\n\t\t\t<div class=\"item-piles-sortable-list-columns\" style=\"margin-top: 0.5rem;\">\n\t\t\t\t<div class=\"full-span\">\n\t\t\t\t\t<a class:invisible={isHovering} on:click={() => addAttribute()}>\n\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.DropMeClickMe\")}\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t\t{#if presetPrices.length && presets}\n\t\t\t\t\t<div class=\"full-span\" style=\"margin-top:0.5rem;\">\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tstyle=\"margin-right:0.25rem;\">{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.PricePreset\")}</span>\n\t\t\t\t\t\t<select class=\"price-preset-selector\" bind:value={selectedPreset}\n\t\t\t\t\t\t        on:change={() => { addPreset(selectedPreset); selectedPreset = \"\"; }}>\n\t\t\t\t\t\t\t<option value=\"\">{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.SelectPreset\")}</option>\n\t\t\t\t\t\t\t{#each presetPrices as price, index (index)}\n\t\t\t\t\t\t\t\t<option value={index}>{localize(price.name)}</option>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</section>\n\t</div>\n</DropZone>\n\n<style lang=\"scss\">\n\n  .price-preset-selector {\n    height: 20px;\n    font-size: 0.8rem;\n  }\n\n  .item-piles-sortable-list-columns {\n    grid-template-columns: 28px 1.1fr 35px 28px 28px 0.5fr 60px 1fr 28px;\n    min-height: 30px;\n  }\n\n  .item-piles-sortable-list-entry {\n    border: 1px solid rgba(0, 0, 0, 0.2);\n    border-radius: 4px;\n  }\n\n  .item-piles-even-color {\n    &:nth-child(even) {\n      background-color: #e5e5d6;\n    }\n\n    &:nth-child(odd) {\n      background-color: #f8f8e7;\n    }\n  }\n\n  .invisible {\n    opacity: 0;\n  }\n\n  .table-container {\n    position: relative;\n  }\n\n  .drop-to-add {\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    left: 0;\n    border-radius: 5px;\n    box-shadow: inset 0 0 15px 5px rgb(0, 0, 0, 0.5);\n    background-color: rgba(255, 255, 255, 0.75);\n    z-index: 100000;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-size: 1.5rem;\n    overflow: hidden;\n  }\n\n  .full-span {\n    grid-column: 1/-1;\n  }\n\n</style>\n","<script>\r\n\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\timport { custom_notify } from \"../../helpers/helpers.js\";\r\n\timport { writable } from \"svelte/store\";\r\n\r\n\texport let macro;\r\n\r\n\tlet macros = writable([]);\r\n\r\n\tconst id = foundry.utils.randomID() + \"-list\";\r\n\r\n\tfunction filterMacros() {\r\n\r\n\t\tlet allResults = Array.from(game.macros)\r\n\t\t\t.map(m => ({\r\n\t\t\t\tid: m.id,\r\n\t\t\t\tname: m.name\r\n\t\t\t}));\r\n\r\n\t\tconst compendiums = Array.from(game.packs)\r\n\t\t\t.filter(pack => pack.documentName === \"Macro\")\r\n\t\t\t.map(pack => ({\r\n\t\t\t\tid: pack.metadata.id,\r\n\t\t\t\tname: \"Compendium.\" + pack.metadata.id\r\n\t\t\t}))\r\n\r\n\t\tallResults = allResults.concat(compendiums);\r\n\r\n\t\tallResults = allResults.filter(m => {\r\n\t\t\treturn m.name.toLowerCase().includes(macro.toLowerCase()) || !macro\r\n\t\t})\r\n\r\n\t\tif (macro.startsWith(\"Compendium.\") && allResults.length === 1) {\r\n\t\t\tallResults = Array.from(game.packs.get(allResults[0].id).index).map(m => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tid: allResults[0].id + \".\" + m._id,\r\n\t\t\t\t\tname: allResults[0].name + \".\" + m.name\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tmacros.set(allResults);\r\n\r\n\t}\r\n\r\n\tasync function openMacro() {\r\n\r\n\t\t// Credit to Otigon, Zhell, Gazkhan and MrVauxs for the code in this section\r\n\t\tif (macro.startsWith(\"Compendium\")) {\r\n\t\t\tlet packArray = macro.split(\".\");\r\n\t\t\tlet pack = game.packs.get(`${packArray[1]}.${packArray[2]}`);\r\n\t\t\tif (!pack) {\r\n\t\t\t\tcustom_notify(`Compendium ${packArray[1]}.${packArray[2]} was not found`);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet macroFilter = pack.index.filter((m) => m.name === packArray[3]);\r\n\t\t\tif (!macroFilter.length) {\r\n\t\t\t\tcustom_notify(`A macro named ${packArray[3]} was not found in Compendium ${packArray[1]}.${packArray[2]}`);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet macroDocument = await pack.getDocument(macroFilter[0]._id);\r\n\t\t\tmacroDocument.sheet.render(true);\r\n\t\t} else {\r\n\t\t\tif (!macro) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet getTest = game.macros.getName(macro);\r\n\t\t\tif (!getTest) {\r\n\t\t\t\tcustom_notify(`Could not find the macro named ${macro}`);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tgame.macros.getName(macro).sheet.render(true);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfilterMacros();\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow\">\r\n\t<input bind:value={macro}\r\n\t       list={id}\r\n\t       on:change={() => { filterMacros() }}\r\n\t       on:keyup={() => { filterMacros() }}\r\n\t       placeholder={localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.MacroPlaceholder\")}\r\n\t       style=\"flex:1; margin-right:5px;\"\r\n\t       type=\"text\"\r\n\t/>\r\n\t<datalist id={id}>\r\n\t\t{#each $macros as m (m.id)}\r\n\t\t\t<option value={m.name}>{m.text ?? \"\"}</option>\r\n\t\t{/each}\r\n\t</datalist>\r\n\t<i\r\n\t\tclass=\"fas fa-edit item-piles-clickable-link\"\r\n\t\tdata-fast-tooltip=\"Open Macro\"\r\n\t\ton:click={() => openMacro()}\r\n\t\tstyle=\"margin-top: 5px; font-size: 1rem; flex:0;\"\r\n\t></i>\r\n</div>\r\n","<script>\r\n\r\n\timport { writable } from \"svelte/store\";\r\n\timport * as Helpers from \"../../helpers/helpers.js\";\r\n\timport { openEditor } from \"../../helpers/helpers.js\";\r\n\timport SETTINGS from \"../../constants/settings.js\";\r\n\r\n\texport let value;\r\n\texport let placeholder = \"\";\r\n\r\n\tasync function showCustomItemCategoryEditor() {\r\n\t\topenEditor(SETTINGS.CUSTOM_ITEM_CATEGORIES).then((result) => {\r\n\t\t\tHelpers.setSetting(SETTINGS.CUSTOM_ITEM_CATEGORIES, Array.from(new Set(result)));\r\n\t\t\tcurrentCustomCategories.set(Helpers.getSetting(SETTINGS.CUSTOM_ITEM_CATEGORIES));\r\n\t\t})\r\n\t}\r\n\r\n\tlet currentCustomCategories = writable(Array.from(new Set(Helpers.getSetting(SETTINGS.CUSTOM_ITEM_CATEGORIES))));\r\n\r\n\tconst id = foundry.utils.randomID();\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow\" style=\"align-items: center;\">\r\n\t<input bind:value list={\"item-editor-list-\"+id} placeholder={placeholder} type=\"text\"/>\r\n\t<a on:click={() => showCustomItemCategoryEditor()} style=\"flex: 0; margin: 0 0.5rem;\"><i\r\n\t\tclass=\"fas fa-cog\"></i></a>\r\n\t{#if $currentCustomCategories.length}\r\n\t\t<datalist id={\"item-editor-list-\"+id}>\r\n\t\t\t{#each $currentCustomCategories as category}\r\n\t\t\t\t<option>{category}</option>\r\n\t\t\t{/each}\r\n\t\t</datalist>\r\n\t{/if}\r\n</div>\r\n","<script>\r\n\timport { getContext } from 'svelte';\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport * as Helpers from \"../../helpers/helpers.js\";\r\n\timport * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n\timport ItemPriceStore from \"./ItemPriceStore.js\";\r\n\timport Tabs from \"../components/Tabs.svelte\";\r\n\timport PriceList from \"../components/PriceList.svelte\";\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\timport MacroSelector from \"../components/MacroSelector.svelte\";\r\n\timport { get, writable } from \"svelte/store\";\r\n\timport SETTINGS from \"../../constants/settings.js\";\r\n\timport CustomCategoryInput from \"../components/CustomCategoryInput.svelte\";\r\n\timport FilePicker from \"../components/FilePicker.svelte\";\r\n\timport SliderInput from \"../components/SliderInput.svelte\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let item;\r\n\texport let elementRoot;\r\n\r\n\tlet store = ItemPriceStore.make(item);\r\n\r\n\tlet currentCustomCategories = writable(Array.from(new Set(Helpers.getSetting(SETTINGS.CUSTOM_ITEM_CATEGORIES))));\r\n\r\n\tconst flagDataStore = store.data;\r\n\tlet price = store.price;\r\n\tlet quantityForPrice = store.quantityForPrice;\r\n\tlet oldPrice = get(price);\r\n\r\n\t$: itemFlagData = $flagDataStore;\r\n\r\n\tlet form;\r\n\r\n\tasync function updateSettings() {\r\n\t\tconst flagData = store.export();\r\n\t\tif (flagData.flags.customCategory) {\r\n\t\t\tlet customCategories = get(currentCustomCategories);\r\n\t\t\tcustomCategories.push(flagData.flags.customCategory)\r\n\t\t\tawait Helpers.setSetting(SETTINGS.CUSTOM_ITEM_CATEGORIES, Array.from(new Set(customCategories)));\r\n\t\t}\r\n\t\tawait PileUtilities.updateItemData(item, flagData);\r\n\t\tapplication.options.resolve();\r\n\t\tapplication.close();\r\n\t}\r\n\r\n\texport function requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n\tlet activeTab = \"general\";\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form autocomplete=off bind:this={form} class=\"item-piles-config-container\" on:submit|preventDefault={updateSettings}>\r\n\r\n\t\t<Tabs bind:activeTab tabs={[\r\n    { value: \"general\", label: localize(\"ITEM-PILES.Applications.ItemEditor.General\") },\r\n    { value: \"price\", label: localize(\"ITEM-PILES.Applications.ItemEditor.Price\") },\r\n    { value: \"vault\", label: localize(\"ITEM-PILES.Applications.ItemEditor.Vault\") }\r\n  ]}/>\r\n\r\n\t\t<section class=\"item-piles-tab-body\">\r\n\r\n\t\t\t<div class=\"item-piles-tab\">\r\n\r\n\t\t\t\t{#if activeTab === 'general'}\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.CustomCategory\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.CustomCategoryExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<div style=\"flex: 4;\">\r\n\t\t\t\t\t\t\t<CustomCategoryInput bind:value={itemFlagData.customCategory} placeholder={item.type}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.Hidden\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.HiddenExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.hidden}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.CanStack\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.CanStackExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<select style=\"flex: 0 1 auto;\" bind:value={itemFlagData.canStack}>\r\n\t\t\t\t\t\t\t<option value=\"default\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.CanStackDefault\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t<option value=\"yes\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.CanStackYes\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t<option value=\"no\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.CanStackNo\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.NotForSale\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.NotForSaleExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.notForSale}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.CantBeSoldToMerchants\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.CantBeSoldToMerchantsExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.cantBeSoldToMerchants}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.InfiniteQuantity\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.InfiniteQuantityExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<select style=\"flex: 0 1 auto;\" bind:value={itemFlagData.infiniteQuantity}>\r\n\t\t\t\t\t\t\t<option value=\"default\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.InfiniteQuantityDefault\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t<option value=\"yes\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.InfiniteQuantityYes\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t<option value=\"no\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.InfiniteQuantityNo\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.KeepZero\")}</span>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.KeepZeroExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.keepZeroQuantity}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.KeepOnMerchant\")}</span>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.KeepOnMerchantExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.keepOnMerchant}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.DisplayQuantity\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.DisplayQuantityExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<select style=\"flex: 0 1 auto;\" bind:value={itemFlagData.displayQuantity}>\r\n\t\t\t\t\t\t\t<option value=\"default\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.DisplayQuantityDefault\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t<option value=\"yes\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.DisplayQuantityYes\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t<option value=\"no\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.GeneralTab.DisplayQuantityNo\")}\r\n\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.Service\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.ServiceExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.isService}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.PurchaseMacro\")}</span>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.PurchaseMacroExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<MacroSelector bind:macro={itemFlagData.macro}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if activeTab === 'price'}\r\n\r\n\t\t\t\t\t{#if game.system.id !== \"pf2e\"}\r\n\t\t\t\t\t\t{#if game.system.id !== \"wfrp4e\"}\r\n\t\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.BasePrice\")}<br>\r\n\t\t\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.BasePriceExplanation\")}</p>\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t<input type=\"text\" bind:value={$price} on:change={() => {\r\n                const forceNumber = game.system.id === \"dnd5e\";\r\n\t\t\t\t\t\t\t\tconst isPriceNumber = !isNaN(Number($price));\r\n                $price = isPriceNumber || forceNumber\r\n                \t? Math.max(0, isPriceNumber ? Number($price) : oldPrice)\r\n                \t: $price;\r\n                oldPrice = $price;\r\n              }}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.QuantityForPrice\")}<br>\r\n\t\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.QuantityForPriceExplanation\")}</p>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<input type=\"number\" bind:value={$quantityForPrice}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t<div class=\"form-group slider-group\">\r\n\t\t\t\t\t\t<label style=\"flex:3;\">\r\n\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemEditor.VaultTab.PriceModifierTitle\")}</span>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.VaultTab.PriceModifierExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group slider-group\">\r\n\t\t\t\t\t\t<label style=\"flex:3;\">\r\n\t\t\t\t\t\t\t<!-- I know, this is a merchant localization, but there's no change to these -->\r\n\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.BuyPriceModifier\")}</span>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<SliderInput bind:value={itemFlagData.buyPriceModifier} style=\"flex:4;\"/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group slider-group\">\r\n\t\t\t\t\t\t<label style=\"flex:3;\">\r\n\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.SellPriceModifier\")}</span>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<SliderInput bind:value={itemFlagData.sellPriceModifier} style=\"flex:4;\"/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.Free\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.FreeExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.free}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.DisableNormalCost\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.DisableNormalCostExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.disableNormalCost}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.PurchaseOptionsAsSellOption\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.PurchaseOptionsAsSellOptionExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.purchaseOptionsAsSellOption}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.PurchaseOptions\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.PurchaseOptionsExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\r\n\t\t\t\t\t\t<button type=\"button\" on:click={() => { store.addPurchaseGroup() }}>\r\n\t\t\t\t\t\t\t<i class=\"fas fa-plus\"></i>\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.AddPurchaseOption\")}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{#if itemFlagData.prices.length}\r\n\t\t\t\t\t\t{#each itemFlagData.prices as prices, groupIndex (groupIndex)}\r\n\t\t\t\t\t\t\t<PriceList {item} bind:prices={prices} remove={() => { store.removePurchaseGroup(groupIndex) }}/>\r\n\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.SellOptions\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.SellOptionsExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\r\n\t\t\t\t\t\t<button type=\"button\" on:click={() => { store.addSellGroup() }}>\r\n\t\t\t\t\t\t\t<i class=\"fas fa-plus\"></i>\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.PriceTab.AddSellOption\")}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{#if itemFlagData.sellPrices.length}\r\n\t\t\t\t\t\t{#each itemFlagData.sellPrices as prices, groupIndex (groupIndex)}\r\n\t\t\t\t\t\t\t<PriceList {item} bind:prices={prices} remove={() => { store.removeSellGroup(groupIndex) }}/>\r\n\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if activeTab === 'vault'}\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:6;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.VaultTab.GridSize\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.VaultTab.GridSizeExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<div class=\"item-piles-grid-columns\" style=\"flex: 3;\">\r\n\t\t\t\t\t\t\t<div style=\"text-align: center; font-size: 0.7rem;\">\r\n\t\t\t\t\t\t\t\t<i>{localize(\"ITEM-PILES.Applications.ItemEditor.VaultTab.GridWidth\")}</i>\r\n\t\t\t\t\t\t\t\t<i>{localize(\"ITEM-PILES.Applications.ItemEditor.VaultTab.GridHeight\")}</i>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div style=\"align-items: center;\">\r\n\t\t\t\t\t\t\t\t<input style=\"text-align: right;\" type=\"number\" placeholder=\"Enter a number...\"\r\n\t\t\t\t\t\t\t\t       bind:value={itemFlagData.width}/>\r\n\t\t\t\t\t\t\t\t<span style=\"flex: 0;\">x</span>\r\n\t\t\t\t\t\t\t\t<input type=\"number\" placeholder=\"Enter a number...\" bind:value={itemFlagData.height}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.VaultTab.VaultImage\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.VaultTab.VaultImageExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<div class=\"form-fields\">\r\n\t\t\t\t\t\t\t<FilePicker bind:value={itemFlagData.vaultImage} placeholder=\"path/image.png\" type=\"imagevideo\"/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.VaultTab.VaultImageRotated\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.VaultTab.VaultImageRotatedExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<div class=\"form-fields\">\r\n\t\t\t\t\t\t\t<FilePicker bind:value={itemFlagData.vaultImageFlipped} placeholder=\"path/image.png\" type=\"imagevideo\"/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemEditor.VaultTab.VaultExpander\")}<br>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.VaultTab.VaultExpanderExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={itemFlagData.vaultExpander}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:6;\">\r\n\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemEditor.VaultTab.ExpandColumnsRows\")}</span>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemEditor.VaultTab.ExpandColumnsRowsExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<div class=\"item-piles-grid-columns\" style=\"flex: 3;\">\r\n\t\t\t\t\t\t\t<div style=\"text-align: center; font-size: 0.7rem;\">\r\n\t\t\t\t\t\t\t\t<i>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Columns\")}</i>\r\n\t\t\t\t\t\t\t\t<i>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Rows\")}</i>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div style=\"align-items: center;\">\r\n\t\t\t\t\t\t\t\t<input style=\"text-align: right;\" type=\"number\" placeholder=\"Enter a number...\"\r\n\t\t\t\t\t\t\t\t       bind:value={itemFlagData.addsCols}/>\r\n\t\t\t\t\t\t\t\t<span style=\"flex: 0;\">x</span>\r\n\t\t\t\t\t\t\t\t<input type=\"number\" placeholder=\"Enter a number...\" bind:value={itemFlagData.addsRows}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t</div>\r\n\r\n\t\t</section>\r\n\r\n\t\t<footer>\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"ITEM-PILES.Applications.ItemEditor.Update\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={() => { application.close(); }} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .tab {\r\n    max-height: 500px;\r\n    overflow-y: auto;\r\n    overflow-x: hidden;\r\n  }\r\n\r\n  table {\r\n\r\n    td {\r\n      vertical-align: middle;\r\n    }\r\n\r\n    tr {\r\n\r\n      &.is-active {\r\n        background-color: #3273dc;\r\n        color: #fff;\r\n      }\r\n\r\n      &.is-dragging {\r\n        background-color: rgba(50, 220, 132, 0.55);\r\n        color: #fff;\r\n      }\r\n    }\r\n\r\n    .small {\r\n      width: 26px;\r\n    }\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem;\r\n      flex: 0;\r\n      text-align: center;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n    }\r\n\r\n    a {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n  .item-piles-grid-columns {\r\n    display: flex;\r\n    flex-direction: column;\r\n\r\n    & > div {\r\n      display: flex;\r\n      flex-direction: row;\r\n      align-items: center;\r\n\r\n      & > * {\r\n        flex: 1;\r\n        margin: 0 0.25rem;\r\n      }\r\n\r\n      & > span {\r\n        flex: 0;\r\n      }\r\n    }\r\n  }\r\n\r\n</style>\r\n","import ItemEditorShell from './item-editor-shell.svelte';\r\nimport { SvelteApplication } from '#runtime/svelte/application';\r\nimport { getActiveApps } from '../../helpers/helpers';\r\n\r\nexport default class ItemEditor extends SvelteApplication {\r\n\r\n\tconstructor(item = false, options) {\r\n\t\tlet title = game.i18n.format(\"ITEM-PILES.Applications.ItemEditor.Title\", { item_name: item.name })\r\n\t\tif (options.extraTitle) title += options.extraTitle;\r\n\t\tsuper({\r\n\t\t\tid: `item-pile-item-editor-${item.id}${item.parent ? \"-\" + item.parent.id : \"\"}-${foundry.utils.randomID()}`,\r\n\t\t\ttitle,\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: ItemEditorShell,\r\n\t\t\t\ttarget: document.body,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\titem\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclose: () => this.options.resolve(null),\r\n\t\t\t...options\r\n\t\t});\r\n\t}\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\twidth: 500,\r\n\t\t\theight: \"auto\",\r\n\t\t\tclasses: [\"item-piles-app\", \"item-piles-item-app\"]\r\n\t\t})\r\n\t}\r\n\r\n\tstatic getActiveApp(item) {\r\n\t\treturn getActiveApps(`item-pile-item-editor-${item.id}${item.parent ? \"-\" + item.parent.id : \"\"}`, true);\r\n\t}\r\n\r\n\tstatic async show(item = false, options = {}, dialogData = {}) {\r\n\t\tconst app = this.getActiveApp(item);\r\n\t\tif (app) return app.render(false, { focus: true });\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\toptions.resolve = resolve;\r\n\t\t\tnew this(item, options, dialogData).render(true, { focus: true });\r\n\t\t})\r\n\t}\r\n}\r\n","<script>\r\n\r\n\timport ItemEditor from \"../../item-editor/item-editor.js\";\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\r\n\texport let item;\r\n\r\n\tconst itemName = item.name;\r\n\tconst itemImage = item.img;\r\n\tconst quantity = item.quantity;\r\n\tconst store = item.store;\r\n\tconst isMerchant = store.isMerchant;\r\n\r\n\tconst itemFlagDataStore = item.itemFlagData;\r\n\r\n\tconst displayControlButtons = item.store.actor.isOwner;\r\n\tconst displayBuyButton = !!item.store.recipient;\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow sidebar-buttons\">\r\n\t{#if displayControlButtons && isMerchant}\r\n\t\t{#if game.user.isGM}\r\n        <span class=\"item-piles-clickable-link\" on:click={() => { ItemEditor.show(item.item); }}>\r\n          <i class=\"fas fa-cog\"></i>\r\n        </span>\r\n\t\t{/if}\r\n\t\t<span class=\"item-piles-clickable-link\"\r\n\t\t      on:click={() => { item.toggleProperty(\"hidden\"); }}>\r\n        <i class=\"fas\" class:fa-eye={!$itemFlagDataStore.hidden} class:fa-eye-slash={$itemFlagDataStore.hidden}></i>\r\n      </span>\r\n\t\t<span class=\"item-piles-clickable-link\"\r\n\t\t      on:click={() => { item.toggleProperty(\"notForSale\"); }}>\r\n        <i class=\"fas\" class:fa-store={!$itemFlagDataStore.notForSale}\r\n           class:fa-store-slash={$itemFlagDataStore.notForSale}></i>\r\n      </span>\r\n\t{/if}\r\n\t{#if displayBuyButton}\r\n\t\t{#if isMerchant}\r\n      <span\r\n\t      class:item-piles-clickable-link={!$itemFlagDataStore.notForSale || game.user.isGM}\r\n\t      class:item-piles-clickable-link-disabled={$quantity <= 0 || ($itemFlagDataStore.notForSale && !game.user.isGM)}\r\n\t      class:buy-button={displayControlButtons}\r\n\t      on:click={() => {\r\n              if($quantity <= 0 || ($itemFlagDataStore.notForSale && !game.user.isGM)) return;\r\n              store.tradeItem(item)\r\n            }}>\r\n        <i class=\"fas fa-shopping-cart\"></i>\r\n\t      {#if !displayControlButtons} {localize(\"ITEM-PILES.Merchant.Buy\")}{/if}\r\n      </span>\r\n\t\t{:else}\r\n      <span\r\n\t      style=\"margin-left: 0.25rem;\"\r\n\t      class:item-piles-clickable-link={$quantity > 0 && !$itemFlagDataStore.cantBeSoldToMerchants}\r\n\t      class:item-piles-clickable-link-disabled={$quantity <= 0 || $itemFlagDataStore.cantBeSoldToMerchants}\r\n\t      on:click={() => {\r\n              if(($quantity <= 0 || $itemFlagDataStore.cantBeSoldToMerchants)) return;\r\n              store.tradeItem(item, true)\r\n            }}>\r\n        <i class=\"fas fa-hand-holding-usd\"></i> {localize(\"ITEM-PILES.Merchant.Sell\")}\r\n      </span>\r\n\t\t{/if}\r\n\t{/if}\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n\r\n  .sidebar-buttons {\r\n    flex: 0 1 auto;\r\n    align-items: center;\r\n    justify-content: flex-end;\r\n    text-align: right;\r\n    height: 100%;\r\n    border-top-right-radius: 5px;\r\n    border-bottom-right-radius: 5px;\r\n\r\n    & > span {\r\n      flex: 0 1 auto;\r\n      margin-right: 0.25rem;\r\n      min-width: 17.5px;\r\n    }\r\n\r\n    .buy-button {\r\n      padding-left: 0.25rem;\r\n      border-left: 1px solid rgba(0, 0, 0, 0.5)\r\n    }\r\n  }\r\n\r\n</style>\r\n","import { get, writable } from \"svelte/store\";\nimport { localize } from \"#runtime/svelte/helper\";\nimport { PileItem } from \"./pile-item.js\";\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\nimport CONSTANTS from \"../constants/constants.js\";\nimport * as Helpers from \"../helpers/helpers.js\";\nimport { isResponsibleGM } from \"../helpers/helpers.js\";\nimport TradeMerchantItemDialog from \"../applications/dialogs/trade-merchant-item-dialog/trade-merchant-item-dialog.js\";\nimport * as Utilities from \"../helpers/utilities.js\";\nimport ItemPileStore from \"./item-pile-store.js\";\nimport CustomColumn from \"../applications/merchant-app/components/CustomColumn.svelte\";\nimport ItemEntry from \"../applications/merchant-app/components/ItemEntry.svelte\";\nimport QuantityColumn from \"../applications/merchant-app/components/QuantityColumn.svelte\";\nimport PriceSelector from \"../applications/components/PriceSelector.svelte\";\nimport EntryButtons from \"../applications/merchant-app/components/EntryButtons.svelte\";\n\nexport default class MerchantStore extends ItemPileStore {\n\n\tconstructor(...args) {\n\t\tsuper(...args);\n\t\tthis.services = writable({});\n\t\tthis.editPrices = writable(false);\n\t\tthis.typeFilter = writable(\"all\");\n\t\tthis.sortType = writable(0);\n\t\tthis.priceModifiersPerType = writable({});\n\t\tthis.priceModifiersForActor = writable({});\n\t\tthis.priceSelector = writable(\"\");\n\t\tthis.closed = writable(false);\n\t\tthis.itemColumns = writable([]);\n\t\tthis.sortTypes = writable([]);\n\t\tthis.inverseSort = writable(false);\n\t\tthis.isMerchant = false;\n\t\tthis.log = writable([]);\n\t\tthis.visibleLogItems = writable(20);\n\t\tthis.logSearch = writable(\"\");\n\t}\n\n\tget ItemClass() {\n\t\treturn PileMerchantItem;\n\t}\n\n\tsetupStores() {\n\t\tsuper.setupStores();\n\t\tthis.services.set({});\n\t\tthis.editPrices.set(false);\n\t\tthis.typeFilter.set(\"all\");\n\t\tthis.sortType.set(0);\n\t\tthis.priceModifiersPerType.set({});\n\t\tthis.priceModifiersForActor.set({});\n\t\tthis.priceSelector.set(\"\");\n\t\tthis.closed.set(false);\n\t\tthis.itemColumns.set([]);\n\t\tthis.sortTypes.set([]);\n\t\tthis.inverseSort.set(false);\n\t\tthis.isMerchant = false;\n\t\tthis.log.set([]);\n\t\tthis.visibleLogItems.set(20);\n\t\tthis.logSearch.set(\"\");\n\t}\n\n\tgetActorImage() {\n\t\tconst pileData = get(this.pileData);\n\t\treturn pileData?.merchantImage || this.actor.img;\n\t}\n\n\tsetupSubscriptions() {\n\n\t\tlet setup = false;\n\t\tsuper.setupSubscriptions();\n\t\tthis.subscribeTo(this.document, () => {\n\t\t\tif (!setup) return;\n\t\t\tthis.processLogEntries();\n\t\t});\n\t\tthis.subscribeTo(this.pileData, (pileData) => {\n\t\t\tthis.isMerchant = PileUtilities.isItemPileMerchant(this.actor, pileData);\n\t\t\tthis.setupColumns(pileData);\n\t\t\tif (!setup) return;\n\t\t\tthis.updatePriceModifiers();\n\t\t\tthis.updateOpenCloseStatus();\n\t\t});\n\t\tif (this.recipientDocument) {\n\t\t\tthis.subscribeTo(this.recipientPileData, (pileData) => {\n\t\t\t\tif (PileUtilities.isItemPileMerchant(this.recipient, pileData)) {\n\t\t\t\t\tthis.setupColumns(pileData);\n\t\t\t\t}\n\t\t\t\tif (!setup) return;\n\t\t\t\tthis.updatePriceModifiers();\n\t\t\t});\n\t\t\tthis.subscribeTo(this.recipientDocument, () => {\n\t\t\t\tif (!setup) return;\n\t\t\t\tthis.refreshItemPrices();\n\t\t\t})\n\t\t}\n\t\tthis.subscribeTo(this.typeFilter, (val) => {\n\t\t\tif (!setup) return;\n\t\t\tthis.refreshItems()\n\t\t});\n\t\tthis.subscribeTo(this.sortType, (val) => {\n\t\t\tif (!setup) return;\n\t\t\tthis.refreshItems();\n\t\t})\n\t\tthis.subscribeTo(this.inverseSort, (val) => {\n\t\t\tif (!setup) return;\n\t\t\tthis.refreshItems();\n\t\t})\n\t\tthis.subscribeTo(this.logSearch, () => {\n\t\t\tif (!setup) return;\n\t\t\tthis.filterLogEntries();\n\t\t})\n\t\tsetup = true;\n\t\tthis.updatePriceModifiers();\n\t\tthis.updateOpenCloseStatus();\n\t\tthis.refreshItems();\n\t\tthis.processLogEntries();\n\t}\n\n\tsetupColumns(pileData) {\n\t\tconst merchantColumns = Array.isArray(pileData?.merchantColumns) ? pileData.merchantColumns : [];\n\t\tconst customColumns = foundry.utils.deepClone(merchantColumns)\n\t\t\t.filter(column => {\n\t\t\t\treturn this.isMerchant ? (column?.buying ?? true) : (column?.selling ?? true);\n\t\t\t})\n\t\t\t.map(column => ({\n\t\t\t\tlabel: localize(column.label), component: CustomColumn, data: column, sortMethod: (a, b, inverse) => {\n\t\t\t\t\tconst path = column.path;\n\t\t\t\t\tconst AProp = foundry.utils.getProperty(b.item, path);\n\t\t\t\t\tconst BProp = foundry.utils.getProperty(a.item, path);\n\t\t\t\t\tif (!column?.mapping?.[AProp] || !column?.mapping?.[BProp]) {\n\t\t\t\t\t\treturn (AProp > BProp ? 1 : -1) * (inverse ? -1 : 1);\n\t\t\t\t\t}\n\t\t\t\t\tconst keys = Object.keys(column.mapping);\n\t\t\t\t\treturn (keys.indexOf(AProp) - keys.indexOf(BProp)) * (inverse ? -1 : 1);\n\t\t\t\t}\n\t\t\t}));\n\n\t\tconst columns = [];\n\n\t\tcolumns.push({\n\t\t\tlabel: \"Type\", component: ItemEntry\n\t\t});\n\n\t\tif (pileData.displayQuantity !== \"alwaysno\") {\n\t\t\tcolumns.push({\n\t\t\t\tlabel: \"Quantity\", component: QuantityColumn, sortMethod: (a, b, inverse) => {\n\t\t\t\t\treturn (get(b.quantity) - get(a.quantity)) * (inverse ? -1 : 1);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tcolumns.push(...customColumns)\n\t\tcolumns.push({\n\t\t\tlabel: \"Price\", component: PriceSelector, sortMethod: (a, b, inverse) => {\n\t\t\t\tconst APrice = get(a.prices).find(price => price.primary);\n\t\t\t\tconst BPrice = get(b.prices).find(price => price.primary);\n\t\t\t\tif (!APrice) return 1;\n\t\t\t\tif (!BPrice) return -1;\n\t\t\t\treturn (BPrice.totalCost - APrice.totalCost) * (inverse ? -1 : 1);\n\t\t\t}\n\t\t})\n\t\tcolumns.push({\n\t\t\tlabel: false, component: EntryButtons\n\t\t});\n\n\t\tthis.itemColumns.set(columns);\n\n\t\tconst sortTypes = columns.filter(col => col.label);\n\n\t\tsortTypes.splice(1, 0, { label: \"Name\" });\n\n\t\tthis.sortTypes.set(sortTypes)\n\n\t}\n\n\trefreshItemPrices() {\n\t\tconst pileData = get(this.pileData);\n\t\tconst recipientPileData = get(this.recipientPileData);\n\t\tget(this.allItems).forEach(item => {\n\t\t\titem.refreshPriceData(pileData, recipientPileData);\n\t\t});\n\t}\n\n\tvisibleItemFilterFunction(entry, actorIsMerchant, pileData, recipientPileData) {\n\t\tconst itemIsFree = !!get(entry.prices).find(price => price.free);\n\t\tconst itemIsContained = get(entry.containerID);\n\t\treturn super.visibleItemFilterFunction(entry, actorIsMerchant, pileData, recipientPileData)\n\t\t\t&& !itemIsContained\n\t\t\t&& (\n\t\t\t\tactorIsMerchant\n\t\t\t\t\t? !(pileData?.hideItemsWithZeroCost && itemIsFree)\n\t\t\t\t\t: !(recipientPileData?.hideItemsWithZeroCost && itemIsFree) && PileUtilities.isItemValidBasedOnProperties(this.recipient, entry.item)\n\t\t\t);\n\t}\n\n\titemSortFunction(a, b) {\n\t\tconst sortType = get(this.sortType);\n\t\tconst inverse = get(this.inverseSort);\n\t\tif (sortType <= 1) {\n\t\t\treturn super.itemSortFunction(a, b, inverse);\n\t\t}\n\t\tconst selectedSortType = get(this.sortTypes)[sortType];\n\t\treturn selectedSortType?.sortMethod(a, b, inverse, selectedSortType);\n\t}\n\n\tcreateItem(item) {\n\t\tif (PileUtilities.isItemInvalid(this.actor, item)) return;\n\t\tthis.allItems.update(items => {\n\t\t\tconst itemClass = new this.ItemClass(this, item);\n\t\t\titemClass.refreshPriceData();\n\t\t\titems.push(itemClass);\n\t\t\treturn items;\n\t\t})\n\t\tthis.refreshItems();\n\t}\n\n\tdeleteItem(item) {\n\t\tif (PileUtilities.isItemInvalid(this.actor, item)) return;\n\t\tlet refresh = false;\n\t\tthis.allItems.update(items => {\n\t\t\tconst pileItem = items.find(pileItem => pileItem.id === item.id);\n\t\t\tif (!pileItem) return items;\n\t\t\trefresh = true;\n\t\t\tpileItem.unsubscribe();\n\t\t\titems.splice(items.indexOf(pileItem), 1);\n\t\t\treturn items;\n\t\t});\n\t\tif (!refresh) return;\n\t\tthis.refreshItems();\n\t}\n\n\tupdatePriceModifiers() {\n\t\tlet pileData = get(this.pileData);\n\t\tlet change = false;\n\t\tif (pileData.itemTypePriceModifiers && typeof pileData.itemTypePriceModifiers === \"object\") {\n\t\t\tchange = true;\n\t\t\tthis.priceModifiersPerType.set((pileData.itemTypePriceModifiers ?? {}).reduce((acc, priceData) => {\n\t\t\t\tacc[priceData.category.toLowerCase() || priceData.type] = priceData;\n\t\t\t\treturn acc;\n\t\t\t}, {}));\n\t\t}\n\t\tif (this.recipient && pileData.actorPriceModifiers && Array.isArray(pileData.actorPriceModifiers)) {\n\t\t\tchange = true;\n\t\t\tconst recipientUuid = Utilities.getUuid(this.recipient);\n\t\t\tconst actorSpecificModifiers = pileData.actorPriceModifiers?.find(data => data.actorUuid === recipientUuid);\n\t\t\tif (actorSpecificModifiers) {\n\t\t\t\tthis.priceModifiersForActor.set(actorSpecificModifiers);\n\t\t\t}\n\t\t}\n\t\tif (change) {\n\t\t\tthis.refreshItemPrices();\n\t\t}\n\t}\n\n\taddOverrideTypePrice(type) {\n\t\tconst pileData = get(this.pileData);\n\t\tconst custom = Object.keys(CONFIG.Item.typeLabels).indexOf(type) === -1;\n\t\tpileData.itemTypePriceModifiers.push({\n\t\t\tcategory: custom ? type : \"\",\n\t\t\ttype: custom ? \"custom\" : type,\n\t\t\toverride: false,\n\t\t\tbuyPriceModifier: 1,\n\t\t\tsellPriceModifier: 1\n\t\t})\n\t\tthis.pileData.set(pileData);\n\t}\n\n\tremoveOverrideTypePrice(type) {\n\t\tconst pileData = get(this.pileData);\n\t\tconst priceMods = pileData.itemTypePriceModifiers;\n\t\tconst typeEntry = priceMods.find(entry => entry.type === type);\n\t\tpriceMods.splice(priceMods.indexOf(typeEntry), 1);\n\t\tthis.pileData.set(pileData);\n\t}\n\n\tasync update() {\n\t\tconst pileData = get(this.pileData);\n\t\tconst priceModPerType = get(this.priceModifiersPerType);\n\t\tpileData.itemTypePriceModifiers = Object.values(priceModPerType);\n\t\tawait PileUtilities.updateItemPileData(this.actor, pileData);\n\t\tHelpers.custom_notify(localize(\"ITEM-PILES.Notifications.UpdateMerchantSuccess\"));\n\t}\n\n\ttradeItem(pileItem, selling) {\n\t\tif (get(pileItem.itemFlagData).notForSale && !game.user.isGM) return;\n\t\tTradeMerchantItemDialog.show(pileItem, this.actor, this.recipient, { selling });\n\t}\n\n\tasync updateOpenCloseStatus() {\n\t\tconst pileData = get(this.pileData);\n\t\tif (pileData.openTimes.status === \"auto\") {\n\t\t\tif (game.modules.get('foundryvtt-simple-calendar')?.active && pileData.openTimes.enabled) {\n\t\t\t\tconst isClosed = PileUtilities.isMerchantClosed(this.actor, { pileData });\n\t\t\t\tthis.closed.set(isClosed);\n\t\t\t} else if (isResponsibleGM()) {\n\t\t\t\tpileData.openTimes.status = \"open\";\n\t\t\t\tawait PileUtilities.updateItemPileData(this.actor, pileData);\n\t\t\t}\n\t\t} else if (!pileData.openTimes.status.startsWith(\"auto\")) {\n\t\t\tthis.closed.set(pileData.openTimes.status === \"closed\");\n\t\t}\n\t}\n\n\tasync setOpenStatus(status) {\n\t\tconst pileData = get(this.pileData);\n\t\tpileData.openTimes.status = status;\n\t\tawait PileUtilities.updateItemPileData(this.actor, pileData);\n\t}\n\n\tprocessLogEntries() {\n\n\t\t//const pileData = get(this.pileData);\n\t\tconst logEntries = PileUtilities.getActorLog(this.actor);\n\n\t\tlogEntries.sort((a, b) => b.date - a.date);\n\n\t\tlogEntries.forEach(log => {\n\n\t\t\tlet instigator;\n\t\t\tif (log.actor !== undefined) {\n\t\t\t\tinstigator = game.i18n.format(\"ITEM-PILES.Merchant.LogUserActor\", {\n\t\t\t\t\tactor_name: log.actor || \"Unknown character\", user_name: game.users.get(log.user)?.name ?? \"unknown user\",\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tinstigator = game.users.get(log.user)?.name ?? \"unknown user\";\n\t\t\t}\n\n\t\t\tif (log.property) {\n\n\t\t\t\tconst properties = {\n\t\t\t\t\t\"notForSale\": [\"ITEM-PILES.Merchant.LogSetNotForSale\", \"ITEM-PILES.Merchant.LogSetForSale\"],\n\t\t\t\t\t\"hidden\": [\"ITEM-PILES.Merchant.LogSetHidden\", \"ITEM-PILES.Merchant.LogSetVisible\"]\n\t\t\t\t}\n\n\t\t\t\tlog.text = localize(properties[log.property][Number(log.value)], { instigator, item: log.item });\n\n\t\t\t\tlog.class = log.value ? \"item-piles-log-positive\" : \"item-piles-log-negative\";\n\n\t\t\t} else if (log.sold !== undefined) {\n\n\t\t\t\tconst quantity = Math.abs(log.qty) > 1 ? game.i18n.format(\"ITEM-PILES.Merchant.LogQuantity\", { quantity: Math.abs(log.qty) }) : \"\";\n\n\t\t\t\tconst action = localize(\"ITEM-PILES.Merchant.\" + (log.sold ? \"LogSold\" : \"LogBought\"));\n\n\t\t\t\tlog.text = localize(\"ITEM-PILES.Merchant.LogTransaction\", {\n\t\t\t\t\tinstigator, quantity, item: `<strong>${log.item}</strong>`, action: `<span>${action}</span>`, price: log.price\n\t\t\t\t});\n\n\t\t\t\tlog.class = log.sold ? \"item-piles-log-sold\" : \"item-piles-log-bought\";\n\n\t\t\t} else {\n\n\t\t\t\tlog.text = localize(\"ITEM-PILES.Merchant.LogSetQuantity\", {\n\t\t\t\t\tinstigator, quantity: Math.abs(log.qty), item: `<strong>${log.item}</strong>`\n\t\t\t\t});\n\n\t\t\t\tlog.class = \"item-piles-log-other\";\n\n\t\t\t}\n\n\t\t\tlog.visible = true;\n\n\t\t});\n\n\t\tthis.log.set(logEntries);\n\n\t\tthis.filterLogEntries()\n\n\t}\n\n\tfilterLogEntries() {\n\t\tconst search = get(this.logSearch).toLowerCase();\n\t\tconst regex = new RegExp(search, \"g\");\n\t\tthis.log.update((logs) => {\n\t\t\tfor (let log of logs) {\n\t\t\t\tlog.visible = log.text.toLowerCase().search(regex) !== -1;\n\t\t\t}\n\t\t\treturn logs;\n\t\t})\n\t}\n\n}\n\nclass PileMerchantItem extends PileItem {\n\n\tsetupStores(...args) {\n\t\tsuper.setupStores(...args);\n\t\tthis.prices = writable([]);\n\t\tthis.displayQuantity = writable(false);\n\t\tthis.selectedPriceGroup = writable(-1);\n\t\tthis.quantityToBuy = writable(1);\n\t\tthis.quantityForPrice = writable(1);\n\t\tthis.infiniteQuantity = writable(false);\n\t\tthis.isService = false;\n\t}\n\n\tsetupSubscriptions() {\n\t\tlet setup = false;\n\t\tsuper.setupSubscriptions();\n\t\tthis.subscribeTo(this.store.pileData, () => {\n\t\t\tif (!setup) return;\n\t\t\tthis.refreshPriceData();\n\t\t\tthis.refreshDisplayQuantity();\n\t\t});\n\t\tif (this.store.recipient) {\n\t\t\tthis.subscribeTo(this.store.recipientPileData, () => {\n\t\t\t\tif (!setup) return\n\t\t\t\tthis.refreshPriceData();\n\t\t\t\tthis.refreshDisplayQuantity();\n\t\t\t});\n\t\t}\n\t\tthis.subscribeTo(this.quantityToBuy, () => {\n\t\t\tif (!setup) return;\n\t\t\tthis.refreshPriceData();\n\t\t});\n\t\tthis.subscribeTo(this.itemDocument, () => {\n\t\t\tif (!setup) return;\n\t\t\tthis.refreshPriceData();\n\t\t\tthis.store.refreshItems();\n\t\t});\n\t\tthis.subscribeTo(this.store.typeFilter, () => {\n\t\t\tif (!setup) return;\n\t\t\tthis.filter()\n\t\t});\n\t\tthis.subscribeTo(this.itemFlagData, (flagData) => {\n\t\t\tthis.isService = flagData.isService;\n\t\t\tif (!setup) return;\n\t\t\tthis.refreshPriceData();\n\t\t\tthis.refreshDisplayQuantity();\n\t\t});\n\t\tthis.refreshDisplayQuantity();\n\t\tsetup = true;\n\t}\n\n\trefreshDisplayQuantity() {\n\n\t\tconst pileData = get(this.store.pileData);\n\t\tconst itemFlagData = get(this.itemFlagData);\n\t\tconst isMerchant = PileUtilities.isItemPileMerchant(this.store.actor, pileData)\n\n\t\tconst merchantDisplayQuantity = pileData.displayQuantity;\n\t\tconst itemFlagDataQuantity = itemFlagData.displayQuantity;\n\n\t\tconst itemInfiniteQuantity = {\n\t\t\t\"default\": pileData.infiniteQuantity, \"yes\": true, \"no\": false\n\t\t}[isMerchant ? (itemFlagData.infiniteQuantity ?? \"default\") : \"no\"];\n\n\t\tthis.infiniteQuantity.set(itemInfiniteQuantity)\n\n\t\tif (itemFlagDataQuantity === \"always\") {\n\t\t\treturn this.displayQuantity.set(true);\n\t\t}\n\n\t\tconst itemDisplayQuantity = {\n\t\t\t\"default\": merchantDisplayQuantity === \"yes\", \"yes\": true, \"no\": false\n\t\t}[itemFlagDataQuantity ?? \"default\"];\n\n\t\tif (merchantDisplayQuantity.startsWith(\"always\")) {\n\t\t\treturn this.displayQuantity.set(merchantDisplayQuantity.endsWith(\"yes\"));\n\t\t}\n\n\t\tthis.displayQuantity.set(itemDisplayQuantity);\n\n\t}\n\n\trefreshPriceData(sellerFlagData, buyerFlagData) {\n\n\t\tconst quantityToBuy = get(this.quantityToBuy);\n\t\tconst itemFlagData = get(this.itemFlagData);\n\t\tsellerFlagData = sellerFlagData ?? get(this.store.pileData);\n\t\tbuyerFlagData = buyerFlagData ?? get(this.store.recipientPileData);\n\t\tconst priceData = PileUtilities.getPriceData({\n\t\t\titem: this.item,\n\t\t\tseller: this.store.actor,\n\t\t\tbuyer: this.store.recipient,\n\t\t\tsellerFlagData,\n\t\t\tbuyerFlagData,\n\t\t\titemFlagData,\n\t\t\tquantity: quantityToBuy\n\t\t});\n\n\t\tlet selectedPriceGroup = get(this.selectedPriceGroup);\n\t\tif (selectedPriceGroup === -1) {\n\t\t\tselectedPriceGroup = Math.max(0, priceData.findIndex(price => price.maxQuantity));\n\t\t\tthis.selectedPriceGroup.set(selectedPriceGroup)\n\t\t}\n\n\t\tthis.prices.set(priceData);\n\n\t\tthis.quantityForPrice.set(game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE ? foundry.utils.getProperty(this.item, game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE) ?? 1 : 1);\n\n\t}\n\n\tfilter() {\n\t\tconst name = get(this.name).trim();\n\t\tconst type = get(this.category).type;\n\t\tconst search = get(this.store.search).trim();\n\t\tconst typeFilter = get(this.store.typeFilter);\n\t\tconst searchFiltered = !name.toLowerCase().includes(search.toLowerCase());\n\t\tconst typeFiltered = typeFilter !== \"all\" && typeFilter.toLowerCase() !== type.toLowerCase();\n\t\tthis.filtered.set(searchFiltered || typeFiltered);\n\t}\n\n\tasync toggleProperty(property) {\n\n\t\tthis.itemFlagData.update((data) => {\n\t\t\tdata[property] = !data[property]\n\t\t\treturn data;\n\t\t});\n\n\t\tconst itemFlagData = get(this.itemFlagData);\n\n\t\tawait PileUtilities.updateItemData(this.item, { flags: itemFlagData });\n\n\t\tconst pileFlagData = get(this.store.pileData);\n\t\tif (pileFlagData.logMerchantActivity) {\n\t\t\tawait PileUtilities.updateMerchantLog(this.store.actor, {\n\t\t\t\ttype: \"event\", user: game.user.id, item: this.item.name, property, value: !itemFlagData[property]\n\t\t\t});\n\t\t}\n\t}\n\n\tasync updateQuantity(quantity) {\n\t\tconst pileFlagData = get(this.store.pileData);\n\t\tconst itemFlagData = get(this.itemFlagData);\n\t\tconst roll = await new Roll(quantity).evaluate({ allowInteractive: false });\n\t\tthis.quantity.set(roll.total);\n\t\tconst baseData = {};\n\t\tif (itemFlagData.isService || pileFlagData.keepZeroQuantity || itemFlagData.keepZeroQuantity) {\n\t\t\tbaseData[CONSTANTS.FLAGS.ITEM + \".notForSale\"] = roll.total <= 0;\n\t\t}\n\t\tif (pileFlagData.logMerchantActivity) {\n\t\t\tPileUtilities.updateMerchantLog(this.store.actor, {\n\t\t\t\ttype: \"event\", user: game.user.id, item: this.item.name, qty: roll.total\n\t\t\t});\n\t\t}\n\t\treturn await this.item.update(Utilities.setItemQuantity(baseData, roll.total));\n\t}\n\n}\n","<script>\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { getContext } from \"svelte\";\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\timport { TJSProseMirror } from '#standard/component';\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let text;\r\n\texport let elementRoot;\r\n\r\n\tconst options = application.options;\r\n\r\n\tconst originalText = text;\r\n\r\n\tlet form;\r\n\r\n\tfunction requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n\tfunction submit() {\r\n\t\tapplication.options.resolve(text);\r\n\t\tapplication.close();\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\t<form autocomplete=\"off\" bind:this={form} class=\"item-piles-flexcol\" on:submit|once|preventDefault={submit}\r\n\t      style=\"padding:0.5rem;\">\r\n\r\n\t\t<TJSProseMirror\r\n\t\t\tbind:content={text}\r\n\t\t/>\r\n\r\n\t\t<footer class=\"sheet-footer item-piles-flexrow\" style=\"margin-top: 1rem; flex: 0;\">\r\n\t\t\t<button disabled={originalText === text} on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"fas fa-download\"></i>\r\n\t\t\t\t{localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click={() => { application.close() }} type=\"button\">\r\n\t\t\t\t<i class=\"fas fa-times\"></i>\r\n\t\t\t\t{localize(\"Cancel\")}\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n","import { SvelteApplication } from \"#runtime/svelte/application\";\r\nimport { getActiveApps } from \"../../../helpers/helpers\";\r\nimport TextEditorDialogShell from \"./text-editor-dialog-shell.svelte\";\r\n\r\nexport default class TextEditorDialog extends SvelteApplication {\r\n\r\n\tconstructor(text, options) {\r\n\t\tsuper({\r\n\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Dialogs.TextEditor.Title\"),\r\n\t\t\tid: `item-piles-text-editor${options?.id ? \"-\" + options.id : \"\"}-${foundry.utils.randomID()}`,\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: TextEditorDialogShell,\r\n\t\t\t\ttarget: document.body,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\ttext\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclose: () => this.options.resolve?.(null),\r\n\t\t\t...options\r\n\t\t});\r\n\t}\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\twidth: 550,\r\n\t\t\theight: 450,\r\n\t\t\tclasses: [\"item-piles-app\"],\r\n\t\t\tresizable: true\r\n\t\t})\r\n\t}\r\n\r\n\tstatic getActiveApps(id) {\r\n\t\treturn getActiveApps(`item-pile-text-editor-${id}`);\r\n\t}\r\n\r\n\tstatic async show(text, options = {}) {\r\n\t\tconst apps = options.id ? this.getActiveApps(options.id) : [];\r\n\t\tif (apps.length) {\r\n\t\t\tfor (let app of apps) {\r\n\t\t\t\tapp.render(false, { focus: true });\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\toptions.resolve = resolve;\r\n\t\t\tnew this(text, options).render(true, { focus: true });\r\n\t\t})\r\n\t}\r\n\r\n}\r\n","<script>\r\n\r\n\timport Tabs from \"../components/Tabs.svelte\";\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\timport SliderInput from \"../components/SliderInput.svelte\";\r\n\timport TextEditorDialog from \"../dialogs/text-editor-dialog/text-editor-dialog.js\";\r\n\timport { TJSProseMirror } from \"#standard/component\";\r\n\r\n\texport let store;\r\n\r\n\tconst merchantImg = store.img;\r\n\tconst pileDataStore = store.pileData;\r\n\tconst editPrices = store.editPrices;\r\n\r\n\tlet tabs = [];\r\n\tlet description;\r\n\tlet activeSidebarTab = false;\r\n\t$: {\r\n\t\tdescription = $pileDataStore.description;\r\n\t}\r\n\t$: {\r\n\t\ttabs = [\r\n\t\t\t{\r\n\t\t\t\tvalue: 'description',\r\n\t\t\t\tlabel: `ITEM-PILES.Merchant.Description`,\r\n\t\t\t\thidden: !game.user.isGM && !description\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalue: 'settings',\r\n\t\t\t\tlabel: `ITEM-PILES.Merchant.Settings`,\r\n\t\t\t\thidden: !game.user.isGM\r\n\t\t\t},\r\n\t\t];\r\n\t\tactiveSidebarTab = activeSidebarTab || tabs.find(tab => !tab.hidden)?.value;\r\n\t}\r\n\r\n\tfunction showDescriptionEditor() {\r\n\t\treturn TextEditorDialog.show(description, { id: \"item-pile-text-editor-\" + store.actor.id }).then((result) => {\r\n\t\t\tstore.pileData.update((pileData) => {\r\n\t\t\t\tpileData.description = result || \"\";\r\n\t\t\t\treturn pileData;\r\n\t\t\t});\r\n\t\t\tstore.update();\r\n\t\t});\r\n\t}\r\n\r\n</script>\r\n\r\n<div class=\"merchant-left-pane item-piles-flexcol\">\r\n\r\n\t<div class=\"item-piles-bottom-divider\">\r\n\t\t<div class=\"merchant-img\">\r\n\t\t\t<img src=\"{ $merchantImg }\">\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t{#if activeSidebarTab}\r\n\r\n\t\t<Tabs style=\"flex: 0 1 auto;\" {tabs} bind:activeTab={activeSidebarTab}/>\r\n\r\n\t\t<section class=\"tab-body item-piles-sections\" style=\"overflow-y:auto;\">\r\n\r\n\t\t\t{#if activeSidebarTab === 'description'}\r\n\t\t\t\t<div class=\"tab merchant-description\" style=\"padding:0;\">\r\n\t\t\t\t\t<TJSProseMirror\r\n\t\t\t\t\t\tcontent={description}\r\n\t\t\t\t\t\toptions={{ editable: false, secrets: game.user.isGM }}\r\n\t\t\t\t\t\tstyle={{\"display\": \"block\"}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{#if game.user.isGM && !description}\r\n\t\t\t\t\t\t<button type=\"button\"\r\n\t\t\t\t\t\t        style=\"flex:1;\"\r\n\t\t\t\t\t\t        on:click={() => { showDescriptionEditor() }}\r\n\t\t\t\t\t\t>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.EditDescription\")}</button>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\r\n\t\t\t{#if activeSidebarTab === 'settings'}\r\n\t\t\t\t<div class=\"tab merchant-settings\">\r\n\r\n\t\t\t\t\t<div class=\"setting-container item-piles-config-container\">\r\n\r\n\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t<label style=\"flex:3;\">\r\n\t\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.PurchaseOnly\")}</span>\r\n\t\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.PurchaseOnlyExplanation\")}</p>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={$pileDataStore.purchaseOnly}/>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t<label style=\"flex:3;\">\r\n\t\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.HideNewItems\")}</span>\r\n\t\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.HideNewItemsExplanation\")}</p>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={$pileDataStore.hideNewItems}/>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t<label style=\"flex:3;\">\r\n\t\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Merchant.EditTypePrices\")}</span>\r\n\t\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Merchant.EditTypePricesExplanation\")}</p>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={$editPrices}/>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"form-group slider-group item-piles-flexcol\">\r\n\t\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.BuyPriceModifier\")}\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<SliderInput bind:value={$pileDataStore.buyPriceModifier}/>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"form-group slider-group item-piles-flexcol\">\r\n\t\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.SellPriceModifier\")}\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<SliderInput style=\"flex:4;\" bind:value={$pileDataStore.sellPriceModifier}/>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<button type=\"button\" class=\"update-button\" on:click={() => { store.update(); }}>\r\n\t\t\t\t\t\t<i class=\"fas fa-download\"></i> Update\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\r\n\t\t</section>\r\n\r\n\t{/if}\r\n\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .merchant-left-pane {\r\n\r\n    flex: 0 1 35%;\r\n    padding-right: 0.25rem;\r\n    margin-right: 0.25rem;\r\n    border-right: 1px solid rgba(0, 0, 0, 0.5);\r\n    max-height: 100%;\r\n    max-width: 300px;\r\n    min-width: 250px;\r\n    overflow-y: hidden;\r\n\r\n    section {\r\n      padding: 0.25rem;\r\n    }\r\n\r\n    .merchant-img {\r\n      position: relative;\r\n      flex: 0 1 auto;\r\n      border-radius: 5px;\r\n\r\n      img {\r\n        width: 100%;\r\n        height: auto;\r\n        border: 0;\r\n        border-radius: 3px;\r\n        z-index: 1;\r\n      }\r\n\r\n    }\r\n\r\n    .merchant-description {\r\n      position: relative;\r\n      padding: 0.25rem;\r\n\r\n      .prosemirror {\r\n        display: block;\r\n      }\r\n    }\r\n\r\n    .merchant-settings {\r\n      position: relative;\r\n      height: calc(100% - 37px);\r\n\r\n\r\n      .setting-container {\r\n        overflow: hidden auto;\r\n        top: 0;\r\n        bottom: 0;\r\n        position: absolute;\r\n        padding: 0 0.25rem;\r\n\r\n        .form-group {\r\n          clear: both;\r\n          display: flex;\r\n          flex-wrap: wrap;\r\n          margin: 3px 0;\r\n\r\n          &.item-piles-flexcol {\r\n            align-items: flex-start;\r\n          }\r\n        }\r\n      }\r\n\r\n      .update-button {\r\n        position: absolute;\r\n        bottom: -37px;\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n</style>\r\n","<script>\n\timport { fade } from 'svelte/transition';\n\n\texport let item;\n\texport let index;\n\texport let columns;\n\n\tconst itemName = item.name;\n\tconst itemImage = item.img;\n\n\tconst store = item.store;\n\tconst itemStore = item.itemDocument;\n\tconst pileData = store.pileData;\n\tconst displayQuantityStore = item.displayQuantity;\n\tconst quantityStore = item.quantity;\n\tconst itemFlagDataStore = item.itemFlagData;\n\n\t$: itemFlagData = $itemFlagDataStore;\n\t$: displayQuantity = $displayQuantityStore;\n\t$: quantity = $quantityStore;\n\t$: editQuantity = $quantityStore;\n\tlet showEditQuantity = false;\n\n\tconst displayControlButtons = store.actor.isOwner;\n\tconst displayBuyButton = !!store.recipient;\n\n</script>\n\n<div class=\"item-piles-flexrow item-piles-item-row\"\n     class:item-piles-child-even-color={index%2===0}\n     class:item-piles-child-odd-color={index%2===1}\n     class:merchant-item-hidden={itemFlagData.hidden}\n     style=\"flex: 1 0 auto;\"\n     transition:fade|local={{duration: 250}}>\n\n\t{#each columns as column}\n\t\t{#if column?.data}\n\t\t\t<svelte:component this={column.component} {item} data={column.data}/>\n\t\t{:else}\n\t\t\t<svelte:component this={column.component} {item}/>\n\t\t{/if}\n\t{/each}\n\n</div>\n\n\n<style lang=\"scss\">\n\n\n  .item-piles-item-row:global(.item-piles-child-even-color > *) {\n    background-color: var(--item-piles-even-color);\n  }\n\n  .item-piles-item-row:global(.item-piles-child-odd-color > *) {\n    background-color: var(--item-piles-odd-color);\n  }\n\n  .item-piles-item-row {\n    margin: 0;\n    overflow: visible;\n    display: contents;\n\n    & > * {\n      padding: 0 10px;\n      text-align: center;\n      height: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      flex: 1;\n    }\n\n    &.merchant-item-hidden > * {\n      font-style: italic;\n      opacity: 0.5;\n    }\n\n    .item-piles-text {\n      font-size: inherit;\n    }\n\n    .item-piles-img-container {\n      min-width: 20px;\n      max-height: 20px;\n      margin: 2px;\n      flex: 1 0 auto;\n\n      overflow: hidden;\n      border-radius: 4px;\n      border: 1px solid black;\n      align-self: center;\n    }\n\n    .item-piles-name-container {\n      line-height: 1.6;\n    }\n\n  }\n\n</style>\n","<script>\r\n\r\n\timport SliderInput from \"../../components/SliderInput.svelte\";\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\r\n\texport let store;\r\n\texport let category;\r\n\r\n\tconst pileData = store.pileData;\r\n\tconst searchStore = store.search;\r\n\tconst visibleItemsStore = store.visibleItems;\r\n\tconst itemsPerCategoryStore = store.itemsPerCategory;\r\n\tconst categoryStore = store.categories;\r\n\tconst priceModifiersPerType = store.priceModifiersPerType;\r\n\tconst itemCategoriesStore = store.itemCategories;\r\n\tconst typeFilterStore = store.typeFilter;\r\n\tconst editPrices = store.editPrices;\r\n\tconst columns = store.itemColumns;\r\n\r\n\t$: colSpan = $editPrices ? $columns.length + 1 : 1;\r\n\t$: type = category.type === \"custom\" ? category.label.toLowerCase() : category.type;\r\n\r\n</script>\r\n\r\n<div class=\"merchant-item-group-type item-piles-flexrow\" style=\"grid-column: 1/{colSpan};\">\r\n\t<h3>{localize(category.label)}</h3>\r\n\t{#if $editPrices}\r\n\t\t<div class=\"price-header\" style=\"font-size: 0.75rem;\">\r\n\t\t\t{#if $priceModifiersPerType[type]}\r\n\t\t\t\t{localize(\"ITEM-PILES.Merchant.Override\")}:\r\n\t\t\t\t<input type=\"checkbox\" bind:checked={$priceModifiersPerType[type].override}>\r\n\t\t\t\t<SliderInput bind:value={$priceModifiersPerType[type].buyPriceModifier}/>\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\t\t<div style=\"flex: 0 1 auto\">\r\n\t\t\t{#if $priceModifiersPerType[type]}\r\n\t\t\t\t<i class=\"fas fa-times item-piles-clickable-red\"\r\n\t\t\t\t   on:click={() => { store.removeOverrideTypePrice(type) }}></i>\r\n\t\t\t{:else}\r\n\t\t\t\t<i class=\"fas fa-plus item-piles-clickable-green\"\r\n\t\t\t\t   on:click={() => { store.addOverrideTypePrice(type) }}></i>\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\t{/if}\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .merchant-item-group-type {\r\n    align-items: center;\r\n    height: 1.5rem;\r\n    margin-top: 10px;\r\n    margin-bottom: 5px;\r\n    border-bottom: 1px solid rgba(0, 0, 0, 0.2);\r\n\r\n    h3 {\r\n      margin: 0;\r\n      flex: 1 0 auto;\r\n    }\r\n\r\n    .price-header {\r\n      flex: 0 1 calc(50% - 10px);\r\n      padding-right: 10px;\r\n      justify-content: center;\r\n      display: flex;\r\n      align-items: center;\r\n\r\n      input[type=\"checkbox\"] {\r\n        height: 15px;\r\n      }\r\n    }\r\n  }\r\n</style>\r\n","<script>\r\n\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\timport MerchantItemEntry from \"./MerchantItemEntry.svelte\";\r\n\timport CategoryHeader from \"./components/CategoryHeader.svelte\";\r\n\timport { get } from \"svelte/store\";\r\n\r\n\texport let store;\r\n\texport let noItemsLabel = \"ITEM-PILES.Merchant.NoItemsForSale\";\r\n\texport let services = false;\r\n\r\n\tconst searchStore = store.search;\r\n\tconst visibleItemsStore = store.visibleItems;\r\n\tconst itemsPerCategoryStore = store.itemsPerCategory;\r\n\tconst categoryStore = store.categories;\r\n\tconst itemCategoriesStore = store.itemCategories;\r\n\tconst typeFilterStore = store.typeFilter;\r\n\tconst sortTypesStore = store.sortTypes;\r\n\tconst sortTypeStore = store.sortType;\r\n\tconst inverseSortStore = store.inverseSort;\r\n\tconst editPrices = store.editPrices;\r\n\tconst itemColumns = store.itemColumns;\r\n\r\n\t$: categoryDropDown = $itemCategoriesStore.filter(category => category.service === services);\r\n\t$: categories = $categoryStore.filter(category => category.service === services);\r\n\t$: items = $visibleItemsStore.filter(item => Boolean(get(item.itemFlagData)?.isService) === services)\r\n\t$: visibleItems = $visibleItemsStore.filter(item => Boolean(get(item.itemFlagData)?.isService) === services)\r\n\r\n\tlet columns = [];\r\n\t$: {\r\n\t\tcolumns = [\r\n\t\t\t{\r\n\t\t\t\tlabel: \"Name\",\r\n\t\t\t\tcomponent: CategoryHeader\r\n\t\t\t},\r\n\t\t\t...$itemColumns.slice(1)\r\n\t\t]\r\n\t}\r\n\r\n</script>\r\n<div class=\"item-piles-flexrow\">\r\n\t<input bind:value={$searchStore} placeholder=\"Type to search...\" type=\"text\">\r\n\t{#if categoryDropDown.length > 1}\r\n\t\t<select style=\"flex:0 1 auto; margin-left: 0.4rem; height: 26px;\" bind:value={$typeFilterStore}>\r\n\t\t\t<option value=\"all\">{localize(\"ITEM-PILES.Merchant.AllTypes\")}</option>\r\n\t\t\t{#each categoryDropDown as category (category.type)}\r\n\t\t\t\t<option value={category.type}>{localize(category.label)}</option>\r\n\t\t\t{/each}\r\n\t\t</select>\r\n\t{/if}\r\n\t<select bind:value={$sortTypeStore} style=\"flex:0 1 auto; margin-left: 0.4rem; height: 26px;\">\r\n\t\t{#each $sortTypesStore as column, index}\r\n\t\t\t<option value={index}>{localize(\"ITEM-PILES.Merchant.SortBy\")} {localize(column.label)}</option>\r\n\t\t{/each}\r\n\t</select>\r\n</div>\r\n\r\n<div class=\"item-piles-items-list\" style=\"grid-template-columns: auto repeat({columns.length-1}, max-content);\">\r\n\r\n\t{#if $sortTypeStore === 0 || $editPrices}\r\n\r\n\t\t{#each categories as category, index (category.type)}\r\n\r\n\t\t\t<div class=\"item-piles-item-list-header\">\r\n\t\t\t\t{#each columns as column, columnIndex}\r\n\t\t\t\t\t{#if columnIndex === 0}\r\n\t\t\t\t\t\t<CategoryHeader {store} {category}/>\r\n\t\t\t\t\t{:else if column.label && columnIndex > 0 && index === 0 && !$editPrices}\r\n\t\t\t\t\t\t<div class=\"item-piles-small-text\">\r\n\t\t\t\t\t\t\t<a on:click={() => {\r\n              $inverseSortStore = $sortTypeStore === columnIndex+1 ? !$inverseSortStore : false;\r\n              $sortTypeStore = columnIndex+1;\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t{@html column.label}\r\n\t\t\t\t\t\t\t\t<i class=\"fas\"\r\n\t\t\t\t\t\t\t\t   class:fa-chevron-down={!$inverseSortStore && $sortTypeStore === columnIndex+1}\r\n\t\t\t\t\t\t\t\t   class:fa-chevron-up={$inverseSortStore && $sortTypeStore === columnIndex+1}\r\n\t\t\t\t\t\t\t\t></i>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{:else if !$editPrices}\r\n\t\t\t\t\t\t<div></div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t{/each}\r\n\t\t\t</div>\r\n\t\t\t{#each $itemsPerCategoryStore[category.type].items as item, itemIndex (item.id)}\r\n\t\t\t\t<MerchantItemEntry {item} index={itemIndex} columns={$itemColumns}/>\r\n\t\t\t{/each}\r\n\r\n\t\t{/each}\r\n\r\n\t{:else}\r\n\r\n\t\t<div class=\"item-piles-item-list-header\">\r\n\t\t\t{#each columns as column, columnIndex}\r\n\t\t\t\t{#if column.label}\r\n\t\t\t\t\t<div class=\"item-piles-small-text\" class:item-piles-merchant-first-label={!columnIndex}>\r\n\t\t\t\t\t\t<a on:click={() => {\r\n              $inverseSortStore = $sortTypeStore === columnIndex + 1 ? !$inverseSortStore : false;\r\n              $sortTypeStore = columnIndex + 1;\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t{@html column.label}\r\n\t\t\t\t\t\t\t<i class=\"fas\"\r\n\t\t\t\t\t\t\t   class:fa-chevron-down={!$inverseSortStore && $sortTypeStore === columnIndex+1}\r\n\t\t\t\t\t\t\t   class:fa-chevron-up={$inverseSortStore && $sortTypeStore === columnIndex+1}\r\n\t\t\t\t\t\t\t></i>\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{:else}\r\n\t\t\t\t\t<div></div>\r\n\t\t\t\t{/if}\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\t\t{#each items as item, itemIndex (item.id)}\r\n\t\t\t<MerchantItemEntry {item} index={itemIndex} columns={$itemColumns}/>\r\n\t\t{/each}\r\n\r\n\t{/if}\r\n\r\n\t{#if !$categoryStore.length}\r\n\r\n\t\t<div style=\"height: calc(100% - 51px);\" class=\"item-piles-flexcol align-center-col\">\r\n\r\n    <span class=\"align-center-row\" style=\"font-size:1.25rem; opacity: 0.8;\">\r\n      {#if visibleItems.length}\r\n        {localize(\"ITEM-PILES.Merchant.NoMatchFound\")}\r\n      {:else}\r\n        {localize(noItemsLabel)}\r\n      {/if}\r\n    </span>\r\n\r\n\t\t</div>\r\n\r\n\t{/if}\r\n\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-items-list {\r\n    display: grid;\r\n    overflow-y: scroll;\r\n    padding-right: 5px;\r\n    align-items: center;\r\n    height: calc(100% - 31px);\r\n    margin-top: 5px;\r\n    align-content: flex-start;\r\n  }\r\n\r\n  .item-piles-item-list-header {\r\n    display: contents;\r\n\r\n    & > * {\r\n      height: 1.5rem;\r\n      margin-top: 10px;\r\n      margin-bottom: 5px;\r\n      border-bottom: 1px solid rgba(0, 0, 0, 0.2);\r\n      padding: 0 5px;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n    }\r\n  }\r\n\r\n  .item-piles-merchant-first-label {\r\n    justify-content: flex-start;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\r\n\texport let icon = \"fas fa-exclamation-triangle\";\r\n\texport let header = \"Item Piles\";\r\n\texport let content;\r\n\r\n</script>\r\n\r\n\r\n<div>\r\n\r\n\t{#if icon}\r\n\t\t<p class=\"header-icon\"><i class=\"{icon}\"></i></p>\r\n\t{/if}\r\n\t{#if header}\r\n\t\t<p class=\"header\"><strong>{header}</strong></p>\r\n\t{/if}\r\n\t{#if Array.isArray(content)}\r\n\t\t{#each content as part}\r\n\t\t\t<p>{@html part}</p>\r\n\t\t{/each}\r\n\t{:else}\r\n\t\t<p>{@html content}</p>\r\n\t{/if}\r\n\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  div {\r\n\r\n    margin-bottom: 0.5rem;\r\n    font-size: 0.9rem;\r\n    text-align: center;\r\n\r\n    .header-icon {\r\n      font-size: 3rem;\r\n      margin: 0;\r\n    }\r\n\r\n    .header {\r\n      margin-bottom: 0.5rem;\r\n      font-size: 1.2rem;\r\n    }\r\n\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\timport { get, writable } from \"svelte/store\";\r\n\timport { onDestroy } from \"svelte\";\r\n\timport { TJSDialog } from \"#runtime/svelte/application\";\r\n\timport CustomDialog from \"../components/CustomDialog.svelte\";\r\n\timport ItemEntry from \"./components/ItemEntry.svelte\";\r\n\timport * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n\timport { getSetting } from \"../../helpers/helpers\";\r\n\timport { slide } from \"svelte/transition\";\r\n\timport { quintOut } from \"svelte/easing\";\r\n\timport SETTINGS from \"../../constants/settings\";\r\n\timport CustomCategoryInput from \"../components/CustomCategoryInput.svelte\";\r\n\r\n\texport let store;\r\n\r\n\tlet tables = writable(getTables());\r\n\r\n\tlet populationTables = writable((get(store.pileData).tablesForPopulate ?? [])\r\n\t\t.map(t => {\r\n\t\t\tif (t.id) {\r\n\t\t\t\tt.uuid = game.tables.get(t.id).uuid;\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\tuuid: t.uuid,\r\n\t\t\t\taddAll: t.addAll ?? false,\r\n\t\t\t\topen: false,\r\n\t\t\t\ttimesToRoll: t.timesToRoll ?? \"1d4\",\r\n\t\t\t\titems: t.items ?? {},\r\n\t\t\t\tcustomCategory: t.customCategory ?? \"\",\r\n\t\t\t};\r\n\t\t}));\r\n\r\n\tlet timesRolled = \"\";\r\n\tlet keepRolled = false;\r\n\r\n\tlet itemStore = store.items;\r\n\r\n\t$: currentItems = $itemStore.sort((a, b) => {\r\n\t\treturn a.item.name < b.item.name ? -1 : 1;\r\n\t}).filter(item => !item.isService);\r\n\r\n\t$: currentServices = $itemStore.sort((a, b) => {\r\n\t\treturn a.item.name < b.item.name ? -1 : 1;\r\n\t}).filter(item => item.isService);\r\n\r\n\t$: {\r\n\t\tdebounceSave($populationTables, $tables)\r\n\t}\r\n\r\n\tconst debounceSave = foundry.utils.debounce((popTables, actualTables) => {\r\n\t\tconst pileData = foundry.utils.deepClone(get(store.pileData));\r\n\t\tpileData.tablesForPopulate = popTables\r\n\t\t\t.filter((t) => actualTables[t.uuid])\r\n\t\t\t.map((t) => ({\r\n\t\t\t\tuuid: t.uuid, addAll: t.addAll, items: t.items, timesToRoll: t.timesToRoll, customCategory: t.customCategory\r\n\t\t\t}));\r\n\t\tPileUtilities.updateItemPileData(store.actor, pileData);\r\n\t}, 200);\r\n\r\n\tlet selectableTables = [];\r\n\tlet selectedTable = \"\";\r\n\t$: {\r\n\t\tselectableTables = Object.entries($tables).filter(entry => !$populationTables.some(table => table.uuid === entry[0]));\r\n\t\tconst tableSet = new Set(selectableTables.map(e => e[0]));\r\n\t\tselectedTable = tableSet.has(selectedTable) ? selectedTable : tableSet.first();\r\n\t}\r\n\r\n\tlet itemsRolled = writable([]);\r\n\r\n\tfunction recurseThroughFoldersForTables(folderId) {\r\n\t\tconst folder = game.folders.find(f => f.type === \"RollTable\" && f.id === folderId);\r\n\t\tlet folders = [folder.id];\r\n\t\tfor (const child of folder.children) {\r\n\t\t\tfolders = folders.concat(recurseThroughFoldersForTables(child.folder.id))\r\n\t\t}\r\n\t\treturn folders;\r\n\t}\r\n\r\n\tfunction getTables() {\r\n\t\tlet tables = Array.from(game.tables);\r\n\t\tconst folderId = getSetting(SETTINGS.POPULATION_TABLES_FOLDER);\r\n\t\tif (\r\n\t\t\tfolderId !== \"root\" && game.folders.find((f) => f.type === \"RollTable\" && f.id === folderId)\r\n\t\t) {\r\n\t\t\tconst folderIds = recurseThroughFoldersForTables(folderId)\r\n\t\t\ttables = tables.filter((t) => folderIds.includes(t.folder?.id));\r\n\t\t}\r\n\r\n\t\tconst mappedTables = {};\r\n\t\tfor (const table of tables) {\r\n\t\t\tmappedTables[table.uuid] = {\r\n\t\t\t\tname: table.name,\r\n\t\t\t\titems: Array.from(table.collections.results)\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn mappedTables;\r\n\t}\r\n\r\n\tasync function rollAllTables() {\r\n\t\tif (!keepRolled) {\r\n\t\t\titemsRolled.set([]);\r\n\t\t}\r\n\t\tfor (const table of $populationTables) {\r\n\t\t\ttable.open = false;\r\n\t\t\tawait evaluateTable(table, true);\r\n\t\t}\r\n\t\ttimesRolled = $itemsRolled.reduce((total, item) => {\r\n\t\t\treturn total + item.quantity;\r\n\t\t}, 0);\r\n\t}\r\n\r\n\tasync function evaluateTable(table, keepRolledItems) {\r\n\r\n\t\tconst rollableTable = await fromUuid(table.uuid);\r\n\t\tif (!rollableTable) return;\r\n\r\n\t\tif (!keepRolledItems) {\r\n\t\t\titemsRolled.set([]);\r\n\t\t}\r\n\r\n\t\tconst newItems = await PileUtilities.rollMerchantTables({ tableData: [table] });\r\n\r\n\t\tconst processedItems = newItems.map(itemData => {\r\n\t\t\tconst prices = game.itempiles.API.getPricesForItem(itemData.item, {\r\n\t\t\t\tseller: store.actor,\r\n\t\t\t});\r\n\t\t\titemData.price = prices[0]?.free ? localize(\"ITEM-PILES.Merchant.ItemFree\") : prices[0]?.priceString;\r\n\t\t\treturn itemData;\r\n\t\t});\r\n\r\n\t\titemsRolled.update((items) => {\r\n\t\t\tprocessedItems.forEach((newItem) => {\r\n\t\t\t\tconst existingItem = items.find(\r\n\t\t\t\t\t(item) => item.documentId === newItem.documentId\r\n\t\t\t\t);\r\n\t\t\t\tif (existingItem) {\r\n\t\t\t\t\texistingItem.quantity += newItem.quantity;\r\n\t\t\t\t} else {\r\n\t\t\t\t\titems.push(newItem);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\titems.sort((a, b) => {\r\n\t\t\t\treturn a.text < b.text ? -1 : 1;\r\n\t\t\t});\r\n\t\t\treturn items;\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tasync function addItem(itemToAdd) {\r\n\t\tawait game.itempiles.API.addItems(store.actor, [itemToAdd].map(entry => ({\r\n\t\t\titem: entry.item,\r\n\t\t\tquantity: entry.quantity,\r\n\t\t\tflags: entry.flags\r\n\t\t})));\r\n\t\tremoveItem(itemToAdd);\r\n\t}\r\n\r\n\tfunction removeItem(itemToRemove) {\r\n\t\titemsRolled.update((items) => {\r\n\t\t\tconst existingItemIndex = items.findIndex(\r\n\t\t\t\t(item) => item.documentId === itemToRemove.documentId\r\n\t\t\t);\r\n\t\t\titems.splice(existingItemIndex, 1);\r\n\t\t\treturn items;\r\n\t\t});\r\n\t}\r\n\r\n\tasync function addAllItems() {\r\n\t\tconst itemsToAdd = get(itemsRolled).map(entry => ({\r\n\t\t\titem: entry.item,\r\n\t\t\tquantity: entry.quantity,\r\n\t\t\tflags: entry.flags\r\n\t\t}));\r\n\t\tawait game.itempiles.API.addItems(store.actor, itemsToAdd);\r\n\t\titemsRolled.set([]);\r\n\t}\r\n\r\n\tasync function clearAllItems(services = false) {\r\n\t\tconst localization = services ? \"Services\" : \"Items\";\r\n\t\tconst doContinue = await TJSDialog.confirm({\r\n\t\t\ttitle: \"Item Piles - \" + localize(`ITEM-PILES.Dialogs.ClearAll${localization}.Title`),\r\n\t\t\tcontent: {\r\n\t\t\t\tclass: CustomDialog,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\ticon: \"fas fa-exclamation-triangle\",\r\n\t\t\t\t\tcontent: localize(`ITEM-PILES.Dialogs.ClearAll${localization}.Content`),\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tmodal: true,\r\n\t\t\tdraggable: false,\r\n\t\t\toptions: {\r\n\t\t\t\theight: \"auto\",\r\n\t\t\t\theaderButtonNoClose: true,\r\n\t\t\t},\r\n\t\t});\r\n\t\tif (!doContinue) return false;\r\n\t\tawait game.itempiles.API.removeItems(store.actor, game.itempiles.API.getActorItems(store.actor)\r\n\t\t\t.filter(item => {\r\n\t\t\t\tconst itemFlags = PileUtilities.getItemFlagData(item);\r\n\t\t\t\treturn services === itemFlags.isService && !itemFlags.keepOnMerchant && !itemFlags.keepIfZero;\r\n\t\t\t}));\r\n\t}\r\n\r\n\tasync function previewItem(itemData) {\r\n\t\titemData.item?.sheet?.render(true);\r\n\t}\r\n\r\n\tasync function removeAddedItem(itemToRemove) {\r\n\t\tstore.actor.deleteEmbeddedDocuments(\"Item\", [itemToRemove.item.id]);\r\n\t}\r\n\r\n\tfunction addTable() {\r\n\t\tpopulationTables.update((tabs) => {\r\n\t\t\ttabs.push({\r\n\t\t\t\tuuid: selectedTable,\r\n\t\t\t\taddAll: false,\r\n\t\t\t\topen: false,\r\n\t\t\t\ttimesToRoll: \"1d4-1\",\r\n\t\t\t\tcustomCategory: \"\",\r\n\t\t\t\titems: {}\r\n\t\t\t});\r\n\t\t\treturn tabs;\r\n\t\t});\r\n\t}\r\n\r\n\tasync function removeTable(tableUuid) {\r\n\r\n\t\tconst table = get(tables)[tableUuid];\r\n\r\n\t\tconst doContinue = await TJSDialog.confirm({\r\n\t\t\ttitle: \"Item Piles - \" + game.i18n.localize(\"ITEM-PILES.Dialogs.RemoveMerchantTable.Title\"),\r\n\t\t\tcontent: {\r\n\t\t\t\tclass: CustomDialog,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\theader: game.i18n.localize(\"ITEM-PILES.Dialogs.RemoveMerchantTable.Title\"),\r\n\t\t\t\t\tcontent: game.i18n.format(\"ITEM-PILES.Dialogs.RemoveMerchantTable.Content\", { table_name: table.name }),\r\n\t\t\t\t\ticon: \"fas fa-exclamation-triangle\"\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmodal: true,\r\n\t\t\tdraggable: false,\r\n\t\t\trejectClose: false,\r\n\t\t\tdefaultYes: true,\r\n\t\t\toptions: {\r\n\t\t\t\theight: \"auto\"\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (!doContinue) return;\r\n\r\n\t\tpopulationTables.update((tabs) => {\r\n\t\t\treturn tabs.filter((t) => t.uuid !== tableUuid);\r\n\t\t});\r\n\t}\r\n\r\n\tlet createId = Hooks.on(\"createRollTable\", () => {\r\n\t\ttables.set(getTables());\r\n\t});\r\n\tlet deleteId = Hooks.on(\"deleteRollTable\", () => {\r\n\t\ttables.update(() => {\r\n\t\t\tconst newTables = getTables();\r\n\t\t\tpopulationTables.update(values => values.filter((t) => newTables[t.uuid]));\r\n\t\t\treturn newTables;\r\n\t\t});\r\n\t});\r\n\r\n\tonDestroy(() => {\r\n\t\tHooks.off(\"createRollTable\", createId);\r\n\t\tHooks.off(\"deleteRollTable\", deleteId);\r\n\t});\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow\" style=\"height:100%;\">\r\n\t<div style=\"margin-right:0.5rem; max-width: 50%; max-height:100%; overflow-y:scroll;\">\r\n\t\t{#if !(currentItems.length + currentServices.length)}\r\n\t\t\t<div class=\"item-piles-populate-header\">\r\n\t\t\t\t{localize(\"ITEM-PILES.Merchant.BuyNoItems\")}\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\r\n\t\t{#if currentServices.length}\r\n\t\t\t<div class=\"item-piles-populate-header\">\r\n\t\t\t\t{localize(\"ITEM-PILES.Merchant.CurrentServices\")}\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\r\n\t\t{#each currentServices as item (item.id)}\r\n\t\t\t<div\r\n\t\t\t\tclass=\"item-piles-flexrow item-piles-item-row item-piles-even-color\"\r\n\t\t\t>\r\n\t\t\t\t<ItemEntry {item} showQuantity={true}>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tslot=\"right\"\r\n\t\t\t\t\t\tclass=\"item-piles-rolled-item-button\"\r\n\t\t\t\t\t\tstyle=\"color:red;\"\r\n\t\t\t\t\t\ton:click={() => removeAddedItem(item)}\r\n\t\t\t\t\t\tdata-fast-tooltip={localize(\"ITEM-PILES.Merchant.RemoveItem\")}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i class=\"fas fa-trash\"/>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</ItemEntry>\r\n\t\t\t</div>\r\n\t\t{/each}\r\n\r\n\t\t{#if currentServices.length}\r\n\t\t\t<button class=\"item-piles-button\" style=\"margin:5px 0;\" on:click={() => clearAllItems(true)}>\r\n\t\t\t\t<i class=\"fas fa-trash\"/>\r\n\t\t\t\t{localize(\"ITEM-PILES.Merchant.ClearAllServices\")}\r\n\t\t\t</button>\r\n\t\t{/if}\r\n\r\n\t\t{#if currentItems.length}\r\n\t\t\t<div class=\"item-piles-populate-header\">\r\n\t\t\t\t{localize(\"ITEM-PILES.Merchant.CurrentItems\")}\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\r\n\t\t{#each currentItems as item (item.id)}\r\n\t\t\t<div\r\n\t\t\t\tclass=\"item-piles-flexrow item-piles-item-row item-piles-even-color\"\r\n\t\t\t>\r\n\t\t\t\t<ItemEntry {item} showQuantity={true}>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tslot=\"right\"\r\n\t\t\t\t\t\tclass=\"item-piles-rolled-item-button\"\r\n\t\t\t\t\t\tstyle=\"color:red;\"\r\n\t\t\t\t\t\ton:click={() => removeAddedItem(item)}\r\n\t\t\t\t\t\tdata-fast-tooltip={localize(\"ITEM-PILES.Merchant.RemoveItem\")}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i class=\"fas fa-trash\"/>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</ItemEntry>\r\n\t\t\t</div>\r\n\t\t{/each}\r\n\r\n\t\t{#if currentItems.length}\r\n\t\t\t<button class=\"item-piles-button\" style=\"margin:5px 0;\" on:click={() => clearAllItems()}>\r\n\t\t\t\t<i class=\"fas fa-trash\"/>\r\n\t\t\t\t{localize(\"ITEM-PILES.Merchant.ClearAllItems\")}\r\n\t\t\t</button>\r\n\t\t{/if}\r\n\t</div>\r\n\r\n\t<div style=\"padding-right:0.25rem; max-width: 50%; max-height:100%; overflow-y:scroll;\">\r\n\r\n\t\t<div class=\"item-piles-populate-header\">\r\n\t\t\t<span style=\"flex:1 0 auto;\">{localize(\"ITEM-PILES.Merchant.RollableTables\")}</span>\r\n\t\t\t<button on:click={() => { rollAllTables() }}\r\n\t\t\t        style=\"height: 20px; line-height: inherit; font-size: 0.75rem; flex:1 0 auto; margin:0;\">\r\n\t\t\t\t<i class=\"fas fa-dice-d20\"></i> {localize(\"ITEM-PILES.Merchant.RollAllTables\")}\r\n\t\t\t</button>\r\n\t\t</div>\r\n\r\n\t\t{#each $populationTables.filter(table => $tables[table.uuid]) as table}\r\n\t\t\t<div class=\"item-piles-item-row item-piles-even-color\"\r\n\t\t\t     style=\"min-height: 28px; padding: 3px 3px 3px 5px;\">\r\n\t\t\t\t<div class=\"item-piles-flexrow\" style=\"align-items: center;\">\r\n\t\t\t\t\t<div style=\"max-width: 100%; overflow: hidden; text-overflow: ellipsis;\">\r\n\t\t\t\t\t\t<strong style=\"max-width:100%; word-break: break-all;\">{$tables[table.uuid].name}</strong>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<button class=\"item-piles-rolled-item-button\"\r\n\t\t\t\t\t        on:click={() => { removeTable(table.uuid) }}\r\n\t\t\t\t\t        data-fast-tooltip={localize(\"ITEM-PILES.Merchant.ToolTipRemoveTable\")}\r\n\t\t\t\t\t        data-fast-tooltip-direction={TooltipManager.TOOLTIP_DIRECTIONS.UP}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i class=\"fas fa-trash\" style=\"color:#de0e0e;\"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button class=\"item-piles-rolled-item-button\"\r\n\t\t\t\t\t        on:click={() => { table.open = !table.open; }}\r\n\t\t\t\t\t        data-fast-tooltip={localize(\"ITEM-PILES.Merchant.TooltipConfigureTable\")}\r\n\t\t\t\t\t        data-fast-tooltip-direction={TooltipManager.TOOLTIP_DIRECTIONS.UP}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i class=\"fas fa-cog\"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button class=\"item-piles-rolled-item-button\"\r\n\t\t\t\t\t        on:click={() => { table.open = false; evaluateTable(table, keepRolled); }}\r\n\t\t\t\t\t        data-fast-tooltip={localize(\"ITEM-PILES.Merchant.TooltipRollTable\")}\r\n\t\t\t\t\t        data-fast-tooltip-direction={TooltipManager.TOOLTIP_DIRECTIONS.UP}\r\n\t\t\t\t\t        style=\"margin-right:0;\">\r\n\t\t\t\t\t\t<i class=\"fas fa-dice-d20\"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t\t{#if table.open}\r\n\t\t\t\t\t<div class=\"item-piles-flexcol\" style=\"margin-top:5px;\"\r\n\t\t\t\t\t     transition:slide={{ duration: 200, easing: quintOut }}>\r\n\t\t\t\t\t\t<div class=\"item-piles-flexrow\" style=\"align-items: center; margin-bottom: 0.25rem;\">\r\n\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\tstyle=\"margin-right:5px;\">{localize(\"ITEM-PILES.Merchant.TableCustomCategory\")}</label>\r\n\t\t\t\t\t\t\t<CustomCategoryInput bind:value={table.customCategory}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"item-piles-flexrow\">\r\n\t\t\t\t\t\t\t<div class=\"item-piles-flexrow\" style=\"align-items: center; flex:0 1 auto; min-height:26px;\">\r\n\t\t\t\t\t\t\t\t<label style=\"flex:0 1 auto; margin-right:5px;\"\r\n\t\t\t\t\t\t\t\t       for={\"table-id-\"+table.uuid}>{localize(\"ITEM-PILES.Merchant.TableAddAllItems\")}</label>\r\n\t\t\t\t\t\t\t\t<input style=\"width:15px; height:15px; margin:0; flex:0;\" id={\"table-id-\"+table.uuid}\r\n\t\t\t\t\t\t\t\t       bind:checked={table.addAll}\r\n\t\t\t\t\t\t\t\t       on:change={() => {\r\n                           if(!table.addAll) return;\r\n                           table.items = Object.fromEntries($tables[table.uuid].items.map(item => [item.id, \"1d4\"]));\r\n                         }}\r\n\t\t\t\t\t\t\t\t       type=\"checkbox\"/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{#if !table.addAll}\r\n\t\t\t\t\t\t\t\t<div class=\"item-piles-flexrow item-piles-item-row\" style=\"align-items: center; flex:1;\">\r\n\t\t\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"margin-right:5px; text-align: right;\">{localize(\"ITEM-PILES.Merchant.TableTimesToRoll\")}</label>\r\n\t\t\t\t\t\t\t\t\t<input type=\"text\" placeholder=\"2d6+4\" bind:value={table.timesToRoll}\r\n\t\t\t\t\t\t\t\t\t       style=\"height:20px; margin: 3px; max-width: 50px; font-size: 0.75rem;\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{#if table.addAll}\r\n\t\t\t\t\t\t\t{#each $tables[table.uuid].items as item (item.id)}\r\n\t\t\t\t\t\t\t\t<div class=\"item-piles-flexrow item-piles-item-row item-piles-odd-color\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"item-piles-img-container\">\r\n\t\t\t\t\t\t\t\t\t\t<img class=\"item-piles-img\" src={item.img}/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"item-piles-name item-piles-text\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"item-piles-name-container\">\r\n\t\t\t\t\t\t\t\t\t\t\t<a class=\"item-piles-clickable\" on:click={() => previewItem(item)}>{item.text}</a>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"item-piles-quantity-container\" style=\"flex:0 1 75px;\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"item-piles-quantity-input-container\">\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"item-piles-quantity\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={(table?.items?.[item.id] ?? \"1d4\")}\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:change={(event) => {\r\n                            table.items[item.id] = event.target.value;\r\n                          }}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\t\t{/each}\r\n\r\n\t\t<div class=\"item-piles-flexrow\" style=\"margin-top: 0.5rem; flex-wrap:nowrap;\">\r\n\r\n\t\t\t<select bind:value={selectedTable} style=\"max-width: calc(100% - 81px);\">\r\n\t\t\t\t{#each selectableTables as [tableUuid, table] (tableUuid)}\r\n\t\t\t\t\t<option value={tableUuid}>{table.name}</option>\r\n\t\t\t\t{/each}\r\n\t\t\t\t{#if foundry.utils.isEmpty($tables)}\r\n\t\t\t\t\t<option value=\"\">\r\n\t\t\t\t\t\t{localize(\"ITEM-PILES.Merchant.NoRollTables\")}\r\n\t\t\t\t\t</option>\r\n\t\t\t\t{/if}\r\n\t\t\t</select>\r\n\r\n\t\t\t<button class=\"item-piles-button\" on:click={() => addTable()} style=\"max-width:80px; min-width:80px;\">\r\n\t\t\t\t{localize(\"ITEM-PILES.Merchant.AddTable\")}\r\n\t\t\t</button>\r\n\r\n\t\t</div>\r\n\r\n\t\t<hr style=\"margin:5px 0;\"/>\r\n\r\n\t\t<div class=\"item-piles-flexrow item-piles-roll-header\">\r\n\t\t\t<label>\r\n\t\t\t\t{localize(\r\n\t\t\t\t\ttimesRolled && $itemsRolled.length\r\n\t\t\t\t\t\t? \"ITEM-PILES.Merchant.RolledTimes\"\r\n\t\t\t\t\t\t: \"ITEM-PILES.Merchant.ClickRoll\",\r\n\t\t\t\t\t{ rolls: timesRolled }\r\n\t\t\t\t)}\r\n\t\t\t</label>\r\n\r\n\t\t\t<div class=\"item-piles-flexrow item-piles-keep-rolled\">\r\n\t\t\t\t<label>{localize(\"ITEM-PILES.Merchant.KeepRolled\")}</label>\r\n\t\t\t\t<input bind:checked={keepRolled} type=\"checkbox\"/>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t{#if $itemsRolled.length}\r\n\t\t\t{#each $itemsRolled as item (item.documentId)}\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"item-piles-flexrow item-piles-item-row item-piles-even-color\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclass=\"item-piles-rolled-item-button\"\r\n\t\t\t\t\t\ton:click={() => addItem(item)}\r\n\t\t\t\t\t\tdata-fast-tooltip={localize(\"ITEM-PILES.Merchant.AddItem\")}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i class=\"fas fa-arrow-left\"/>\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t<div class=\"item-piles-img-container\">\r\n\t\t\t\t\t\t<img class=\"item-piles-img\" src={item.img}/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"item-piles-name\">\r\n\t\t\t\t\t\t<div class=\"item-piles-name-container\">\r\n\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\tclass=\"item-piles-clickable\"\r\n\t\t\t\t\t\t\t\ton:click={(_) => previewItem(item)}>{item.text}</a\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"item-piles-quantity-container\">\r\n\t\t\t\t\t\t{#if item.price}\r\n\t\t\t\t\t\t\t<small style=\"white-space: nowrap;\">{item.price}</small>\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclass=\"fas fa-times\"\r\n\t\t\t\t\t\t\t\tstyle=\"color: #555; font-size: 0.75rem; opacity: 0.75;\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t<div class=\"item-piles-quantity-input-container\">\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\tclass=\"item-piles-quantity\"\r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\tbind:value={item.quantity}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclass=\"item-piles-rolled-item-button\"\r\n\t\t\t\t\t\tstyle=\"color:red;\"\r\n\t\t\t\t\t\ton:click={() => removeItem(item)}\r\n\t\t\t\t\t\tdata-fast-tooltip={localize(\"ITEM-PILES.Merchant.RemoveItem\")}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i class=\"fas fa-trash\"/>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\r\n\t\t\t<div class=\"item-piles-flexrow\" style=\"margin:5px 0;\">\r\n\r\n\t\t\t\t<button class=\"item-piles-button\" on:click={() => addAllItems()}>\r\n\t\t\t\t\t{localize(\"ITEM-PILES.Merchant.AddAll\")}\r\n\t\t\t\t\t<i class=\"fas fa-arrow-left\"/>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<button class=\"item-piles-button\"\r\n\t\t\t\t        style=\"color:red; max-width:30px;\"\r\n\t\t\t\t        on:click={() => { $itemsRolled = []; }}\r\n\t\t\t\t        data-fast-tooltip={localize(\"ITEM-PILES.Merchant.ToolTipRemoveAllRolledItems\")}>\r\n\t\t\t\t\t<i class=\"fas fa-trash\"/>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\r\n\t</div>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-populate {\r\n\r\n    &-header {\r\n      display: grid;\r\n      grid-template-columns: 1fr auto;\r\n      column-gap: 5px;\r\n      align-items: center;\r\n      min-height: 20px;\r\n      margin: 0.125rem 0 0.5rem 0;\r\n    }\r\n  }\r\n\r\n  .item-piles-roll-header {\r\n    margin-bottom: 0.5rem;\r\n    align-items: center;\r\n  }\r\n\r\n  .item-piles-keep-rolled {\r\n    align-items: center;\r\n    justify-content: flex-end;\r\n    font-size: 0.75rem;\r\n    text-align: right;\r\n    flex: 0 1 auto;\r\n\r\n    input {\r\n      height: 14px;\r\n    }\r\n  }\r\n\r\n  .item-piles-name {\r\n    flex: 1 0 auto;\r\n  }\r\n\r\n  .item-piles-quantity-container {\r\n    flex: 0 1 50px;\r\n    gap: 4px;\r\n  }\r\n\r\n  .item-piles-button {\r\n    height: 27px;\r\n    line-height: inherit;\r\n\r\n    /* alignt icons */\r\n    flex-direction: row;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    gap: 0.25rem;\r\n  }\r\n\r\n  .item-piles-rolled-item-button {\r\n    min-height: 22px;\r\n    min-width: 22px;\r\n    margin: 2px;\r\n    font-size: 0.65rem;\r\n    padding: 0.25rem;\r\n    flex: 0;\r\n    line-height: inherit;\r\n\r\n    i {\r\n      margin: 0;\r\n    }\r\n  }\r\n\r\n  .fix-height-checkbox {\r\n    height: 20px;\r\n  }\r\n\r\n  .item-piles-header-button {\r\n    min-width: 30px;\r\n    height: 30px;\r\n    text-align: center;\r\n    padding: 0;\r\n    margin: 0;\r\n  }\r\n\r\n  .item-piles-remove-button {\r\n    font-size: 0.75rem;\r\n    width: 30px;\r\n    height: 30px;\r\n    align-items: center;\r\n    display: flex;\r\n    justify-content: center;\r\n\r\n    color: red;\r\n\r\n    &[disabled] {\r\n      color: gray;\r\n    }\r\n  }\r\n\r\n  .item-piles-quantity-input-container {\r\n    min-width: 40px;\r\n  }\r\n</style>\r\n\r\n","<script>\n\n\timport * as Helpers from \"../../helpers/helpers.js\"\n\n\texport let currency;\n\texport let options;\n\n\tlet name = currency.name;\n\tlet img = currency.img;\n\tlet abbreviation = currency.abbreviation;\n\tlet quantity = currency.quantity;\n\n\tlet text = \"\";\n\t$: {\n\t\tlet number = options.abbreviateNumbers ? Helpers.abbreviateNumbers($quantity) : $quantity;\n\t\tif ($abbreviation) {\n\t\t\tif (options.abbreviations) {\n\t\t\t\ttext = $abbreviation.replace(\"{#}\", number);\n\t\t\t} else {\n\t\t\t\ttext = number;\n\t\t\t}\n\t\t} else {\n\t\t\ttext = `${$name} (x${$quantity})`;\n\t\t}\n\t}\n\n</script>\n\n<div class=\"item-piles-flexrow{options.reverse ? '-reverse' : ''} item-piles-item-row\" data-fast-tooltip={$name}\n     data-fast-tooltip-activation-speed=\"0\" data-fast-tooltip-deactivation-speed=\"0\" style=\"flex:0 1 auto;\">\n\n\t<div class=\"item-piles-img-container\"\n\t     style=\"min-height: {options.imgSize}px; min-width: {options.imgSize}px; max-width: {options.imgSize}px; max-height: {options.imgSize}px;\">\n\t\t<img class=\"item-piles-img\" src=\"{$img}\"/>\n\t</div>\n\n\t<div class=\"item-piles-name item-piles-text\" style=\"flex:0 1 auto; margin: 0 0.25rem;\">\n\t\t<div class=\"item-piles-name-container\">\n\t\t\t{text}\n\t\t</div>\n\t</div>\n\n</div>\n","<script>\r\n\r\n\timport CurrencyListEntry from \"./CurrencyListEntry.svelte\";\r\n\r\n\texport let currencies;\r\n\texport let options = {};\r\n\r\n\t$: primary = $currencies.filter(currency => !currency.isSecondaryCurrency);\r\n\t$: secondary = $currencies.filter(currency => currency.isSecondaryCurrency);\r\n\r\n\toptions = foundry.utils.mergeObject({\r\n\t\treverse: false,\r\n\t\tabbreviations: false,\r\n\t\tabbreviateNumbers: false,\r\n\t\timgSize: 24\r\n\t}, options)\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow item-piles-currency-list\" style={$$props.style}>\r\n\r\n\t{#each primary as currency (currency.identifier)}\r\n\t\t<CurrencyListEntry {currency} {options}/>\r\n\t{/each}\r\n\r\n\t{#if secondary.length}\r\n\r\n\t\t<div class=\"item-piles-vertical-divider\"></div>\r\n\r\n\t\t{#each secondary as currency (currency.identifier)}\r\n\t\t\t<CurrencyListEntry {currency} {options}/>\r\n\t\t{/each}\r\n\t{/if}\r\n\r\n\t<slot/>\r\n\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n  .item-piles-vertical-divider {\r\n    min-height: 1rem;\r\n    flex: 0;\r\n    margin: 2px 0.25rem 2px 0;\r\n    min-width: 1px;\r\n    background-color: rgba(0, 0, 0, 0.5);\r\n  }\r\n</style>\r\n","<script>\r\n\r\n\timport CurrencyList from \"../components/CurrencyList.svelte\";\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\timport { writable } from \"svelte/store\";\r\n\r\n\texport let store;\r\n\texport let recipientStore;\r\n\r\n\tlet recipientDocument = writable({});\r\n\tlet currencies = writable([]);\r\n\t$: {\r\n\t\trecipientDocument = recipientStore?.document;\r\n\t\tcurrencies = recipientStore?.allCurrencies;\r\n\t}\r\n\tconst merchantCurrencies = store?.allCurrencies;\r\n\tconst merchantPileData = store.pileData;\r\n\r\n</script>\r\n\r\n{#if recipientStore}\r\n\t<div class=\"item-piles-flexrow merchant-bottom-row\">\r\n\t\t<div style=\"flex: 0 1 auto;\">\r\n\t\t\t{localize(\"ITEM-PILES.Merchant.ShoppingAs\", { actorName: $recipientDocument.name })}\r\n\t\t</div>\r\n\t\t<CurrencyList {currencies}\r\n\t\t              options={{ abbreviations: false, imgSize: 18, abbreviateNumbers: true }}\r\n\t\t              class=\"item-piles-currency-list\"/>\r\n\t</div>\r\n{:else if game.user.isGM && !$merchantPileData.infiniteCurrencies}\r\n\t<div class=\"item-piles-flexrow merchant-bottom-row\">\r\n\t\t<div style=\"flex: 0 1 auto;\">\r\n\t\t\t<a class=\"item-piles-clickable item-piles-text-right item-piles-small-text item-piles-middle\"\r\n\t\t\t   on:click={() => store.addCurrency()}>\r\n\t\t\t\t<i class=\"fas fa-plus\"></i> {localize(\"ITEM-PILES.Inspect.AddCurrency\")}\r\n\t\t\t</a>\r\n\t\t</div>\r\n\t\t<CurrencyList currencies={merchantCurrencies}\r\n\t\t              options={{ abbreviations: false, imgSize: 18, abbreviateNumbers: true }}\r\n\t\t              class=\"item-piles-currency-list\"/>\r\n\t</div>\r\n{/if}\r\n\r\n<style>\r\n    .merchant-bottom-row {\r\n        flex: 0 1 auto;\r\n        align-items: center;\r\n        height: 31px;\r\n    }\r\n</style>\r\n","<script>\r\n\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\timport * as Helpers from \"../../helpers/helpers.js\";\r\n\timport { getContext } from \"svelte\";\r\n\r\n\texport let store;\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\tconst logStore = store.log;\r\n\tconst logSearchStore = store.logSearch;\r\n\tconst visibleLogItems = store.visibleLogItems;\r\n\tconst applicationHeight = application.position.stores.height;\r\n\r\n</script>\r\n\r\n<div class=\"form-group item-piles-flexrow item-piles-bottom-divider\"\r\n     style=\"margin: 0.25rem 0; align-items: center; flex: 0 1 auto;\">\r\n\t<label style=\"flex:0 1 auto; margin-right: 5px;\">{localize(\"ITEM-PILES.Merchant.LogSearch\")}</label>\r\n\t<input bind:value={$logSearchStore} type=\"text\">\r\n</div>\r\n\r\n<div class=\"item-piles-merchant-log\"\r\n     style=\"max-height: {$applicationHeight-130}px; overflow-y: scroll; font-size: 0.75rem; padding-right: 0.5rem;\">\r\n\r\n\t{#each $logStore.slice(0, $visibleLogItems).filter(log => log.visible) as log, index (index)}\r\n\t\t<div class={log.class}>\r\n\t\t\t{@html log.text} - {Helpers.timeSince(log.date)} ago\r\n\t\t</div>\r\n\t{/each}\r\n\r\n\t{#if $logStore.length > $visibleLogItems}\r\n\t\t<div class=\"item-piles-top-divider\" style=\"text-align: center;\">\r\n\t\t\t<a on:click={() => { $visibleLogItems += 20; }}><i>Load more transactions ({$visibleLogItems}\r\n\t\t\t\t/ {$logStore.length})...</i></a>\r\n\t\t</div>\r\n\t{/if}\r\n\r\n</div>\r\n","<script>\r\n\r\n\timport MerchantItemTab from \"./MerchantItemTab.svelte\";\r\n\timport MerchantPopulateItemsTab from \"./MerchantPopulateItemsTab.svelte\";\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\timport MerchantFooter from \"./MerchantFooter.svelte\";\r\n\timport { writable } from \"svelte/store\";\r\n\timport MerchantActivityLog from \"./MerchantActivityLog.svelte\";\r\n\r\n\texport let store;\r\n\texport let recipientStore;\r\n\texport let activeTab;\r\n\r\n\tlet categories = store.categories;\r\n\r\n\tlet closed = store.closed;\r\n\r\n\tconst currencies = recipientStore?.allCurrencies || writable([]);\r\n\r\n</script>\r\n\r\n<div class=\"merchant-right-pane item-piles-flexcol\">\r\n\r\n\t<div class=\"merchant-tabbed-center\"\r\n\t     style=\"flex: 1; max-height: calc(100% - {recipientStore && $currencies.length ? '34px' : '0px'})\">\r\n\r\n\t\t{#if $closed && !game.user.isGM}\r\n\t\t\t<div style=\"display: grid; place-items: center; height:100%;\">\r\n\t\t\t\t<span>{localize(\"ITEM-PILES.Merchant.MerchantClosed\")}</span>\r\n\t\t\t</div>\r\n\t\t{:else if $activeTab === \"buy\"}\r\n\t\t\t<MerchantItemTab {store} noItemsLabel=\"ITEM-PILES.Merchant.NoItemsForSale\"/>\r\n\t\t{:else if $activeTab === \"services\" }\r\n\t\t\t<MerchantItemTab {store} services={true}/>\r\n\t\t{:else if $activeTab === \"sell\"}\r\n\t\t\t<MerchantItemTab store={recipientStore} noItemsLabel=\"ITEM-PILES.Merchant.NoItemsToSell\"/>\r\n\t\t{:else if $activeTab === \"tables\"}\r\n\t\t\t<MerchantPopulateItemsTab {store}/>\r\n\t\t{:else if $activeTab === \"log\"}\r\n\t\t\t<MerchantActivityLog {store}/>\r\n\t\t{/if}\r\n\r\n\t</div>\r\n\r\n\t<MerchantFooter {recipientStore} {store}/>\r\n\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .merchant-right-pane {\r\n    flex: 1;\r\n    max-height: 100%;\r\n    overflow: hidden;\r\n    padding-left: 0.25rem;\r\n  }\r\n\r\n  .merchant-tabbed-center {\r\n    overflow: hidden;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\r\n\texport let store;\r\n\r\n\tconst pileDataStore = store.pileData;\r\n\tconst merchantName = store.name;\r\n\tconst closed = store.closed;\r\n\r\n\tlet openTimeText = \"\";\r\n\r\n\tconst aboutTimeEnabled = game.modules.get('foundryvtt-simple-calendar')?.active || false;\r\n\r\n\t$: open = $pileDataStore.openTimes.enabled ? $pileDataStore.openTimes?.open : false;\r\n\t$: close = $pileDataStore.openTimes.enabled ? $pileDataStore.openTimes?.close : false;\r\n\r\n\t$: {\r\n\t\tif ($pileDataStore.openTimes.enabled) {\r\n\t\t\tlet openText = `${open.hour.toString().padStart(2, \"0\")}:${open.minute.toString().padStart(2, \"0\")}`;\r\n\t\t\tlet closeText = `${close.hour.toString().padStart(2, \"0\")}:${close.minute.toString().padStart(2, \"0\")}`;\r\n\t\t\topenTimeText = `${openText} - ${closeText}`;\r\n\t\t}\r\n\t}\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow merchant-top-bar item-piles-bottom-divider\">\r\n\t<div class=\"merchant-name\">{$merchantName}</div>\r\n\t<div class=\"opening-hours item-piles-flexcol\">\r\n\t\t{#if $pileDataStore.openTimes.enabled}\r\n      <span>\r\n        {localize(\"ITEM-PILES.Merchant.OpenTimes\")}\r\n      </span>\r\n\t\t\t<span style=\"font-style: italic;\">\r\n        {#if game.user.isGM}\r\n          {#if aboutTimeEnabled && $pileDataStore.openTimes.status !== \"auto\"}\r\n          <a class=\"item-piles-right-divider\" on:click={() => { store.setOpenStatus(\"auto\"); }}>\r\n            <i class=\"fas fa-clock\"></i>\r\n\t          {localize(`ITEM-PILES.Merchant.OpenCloseAuto`)}\r\n          </a>\r\n          {/if}\r\n\t        <a class=\"item-piles-right-divider\" on:click={() => { store.setOpenStatus($closed ? \"open\" : \"closed\"); }}>\r\n            <i class=\"fas\" class:fa-door-open={!$closed} class:fa-door-closed={$closed}></i>\r\n\t\t        {localize(`ITEM-PILES.Merchant.${!$closed ? \"Open\" : \"Closed\"}`)}\r\n          </a>\r\n        {/if}\r\n\t\t\t\t{openTimeText}\r\n      </span>\r\n\t\t{:else if game.user.isGM}\r\n\t\t\t<a style=\"flex:0;\" on:click={() => { store.setOpenStatus($closed ? \"open\" : \"closed\"); }}>\r\n\t\t\t\t<i class=\"fas\" class:fa-door-open={!$closed} class:fa-door-closed={$closed}></i>\r\n\t\t\t\t{localize(`ITEM-PILES.Merchant.${!$closed ? \"Open\" : \"Closed\"}`)}\r\n\t\t\t</a>\r\n\t\t{/if}\r\n\t</div>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .merchant-top-bar {\r\n\r\n    flex: 0 1 auto;\r\n\r\n    .opening-hours {\r\n      text-align: right;\r\n      flex: 0 1 auto;\r\n      justify-content: center;\r\n\r\n      .item-piles-right-divider {\r\n        margin-right: 0.25rem;\r\n        padding-right: 0.5rem;\r\n        border-right: 1px solid rgba(0, 0, 0, 0.5);\r\n      }\r\n    }\r\n\r\n    .merchant-name {\r\n      font-size: 2em;\r\n    }\r\n\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\timport { getContext, onDestroy } from 'svelte';\r\n\timport { ApplicationShell } from '#runtime/svelte/component/core';\r\n\timport MerchantStore from \"../../stores/merchant-store.js\";\r\n\timport * as Helpers from \"../../helpers/helpers.js\";\r\n\timport * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n\timport DropZone from \"../components/DropZone.svelte\";\r\n\timport MerchantLeftPane from \"./MerchantLeftPane.svelte\";\r\n\timport MerchantRightPane from \"./MerchantRightPane.svelte\";\r\n\timport MerchantTopBar from \"./MerchantTopBar.svelte\";\r\n\timport Tabs from \"../components/Tabs.svelte\";\r\n\timport { get, writable } from \"svelte/store\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let elementRoot;\r\n\r\n\texport let merchant;\r\n\texport let recipient;\r\n\r\n\texport let store = MerchantStore.make(application, merchant, recipient);\r\n\texport let recipientStore = recipient ? MerchantStore.make(application, recipient, merchant, { recipientPileData: store.pileData }) : false;\r\n\r\n\tlet pileData = store.pileData;\r\n\r\n\tonDestroy(() => {\r\n\t\tstore.onDestroy();\r\n\t\tif (recipientStore) recipientStore.onDestroy();\r\n\t});\r\n\r\n\tlet priceSelector = store.priceSelector;\r\n\tlet categories = store.categories;\r\n\tlet visibleItems = store.visibleItems;\r\n\r\n\tasync function dropData(data) {\r\n\r\n\t\tif (!game.user.isGM) return;\r\n\r\n\t\tif (!data.type) {\r\n\t\t\tthrow Helpers.custom_error(\"Something went wrong when dropping this item!\")\r\n\t\t}\r\n\r\n\t\tif (data.type === \"Actor\") {\r\n\t\t\tconst newRecipient = data.uuid ? (await fromUuid(data.uuid)) : game.actors.get(data.id);\r\n\t\t\tstore.updateRecipient(newRecipient);\r\n\t\t\tif (recipientStore) {\r\n\t\t\t\treturn recipientStore.updateSource(newRecipient);\r\n\t\t\t}\r\n\t\t\trecipientStore = MerchantStore.make(application, newRecipient, merchant, { recipientPileData: store.pileData });\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (data.type !== \"Item\") {\r\n\t\t\tthrow Helpers.custom_error(\"You must drop an item, not \" + data.type.toLowerCase() + \"!\")\r\n\t\t}\r\n\r\n\t\tconst item = await Item.implementation.fromDropData(data);\r\n\t\tconst validItem = await PileUtilities.checkItemType(merchant, item, {\r\n\t\t\terrorText: \"ITEM-PILES.Errors.DisallowedItemTrade\",\r\n\t\t\twarningTitle: \"ITEM-PILES.Dialogs.TypeWarning.Title\",\r\n\t\t\twarningContent: \"ITEM-PILES.Dialogs.TypeWarning.TradeContent\"\r\n\t\t});\r\n\t\tif (!validItem) return;\r\n\r\n\t\treturn game.itempiles.API.addItems(merchant, [{\r\n\t\t\titem: validItem,\r\n\t\t\tquantity: 1\r\n\t\t}]);\r\n\r\n\t}\r\n\r\n\tconst activeTab = writable(\"buy\");\r\n\r\n\tlet tabs;\r\n\t$: {\r\n\t\tconst hasItems = $visibleItems.some(item => !get(item.category).service)\r\n\t\tconst hasServices = $visibleItems.some(item => get(item.category).service)\r\n\t\tconst canSell = !$pileData.purchaseOnly && recipientStore;\r\n\t\tconst showBuy = hasItems || (!hasItems && !hasServices && !canSell)\r\n\t\ttabs = [\r\n\t\t\t{\r\n\t\t\t\tvalue: 'buy',\r\n\t\t\t\tlabel: game.i18n.localize('ITEM-PILES.Merchant.BuyItems'),\r\n\t\t\t\thidden: !showBuy\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalue: 'services',\r\n\t\t\t\tlabel: game.i18n.localize('ITEM-PILES.Merchant.BuyServices'),\r\n\t\t\t\thidden: !hasServices\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalue: 'sell',\r\n\t\t\t\tlabel: game.i18n.localize('ITEM-PILES.Merchant.SellItems'),\r\n\t\t\t\thidden: !canSell\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalue: 'tables',\r\n\t\t\t\tlabel: game.i18n.localize('ITEM-PILES.Merchant.PopulateItems'),\r\n\t\t\t\thidden: !game.user.isGM\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalue: 'log',\r\n\t\t\t\tlabel: game.i18n.localize('ITEM-PILES.Merchant.Log'),\r\n\t\t\t\thidden: !merchant.isOwner || !$pileData.logMerchantActivity\r\n\t\t\t},\r\n\t\t];\r\n\t\tif (tabs.find(tab => tab.value === $activeTab).hidden) {\r\n\t\t\t$activeTab = tabs.find(tab => !tab.hidden).value;\r\n\t\t}\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<svelte:window on:click={() => { $priceSelector = \"\"; }}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\t<DropZone callback={dropData} style=\"display: flex; flex-direction: column; height: 100%;\">\r\n\t\t<MerchantTopBar {store}/>\r\n\t\t<Tabs bind:activeTab={$activeTab}\r\n\t\t      bind:tabs=\"{tabs}\"\r\n\t\t      separateElements\r\n\t\t      style=\"flex: 0 1 auto; font-size: 1.1rem; justify-content: flex-start;\"\r\n\t\t      underscore\r\n\t\t/>\r\n\t\t<div class=\"item-piles-flexrow item-pile-merchant-content\">\r\n\t\t\t{#if $activeTab !== \"tables\"}\r\n\t\t\t\t<MerchantLeftPane {store}/>\r\n\t\t\t{/if}\r\n\t\t\t<MerchantRightPane {activeTab} {recipientStore} {store}/>\r\n\t\t</div>\r\n\t</DropZone>\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .hidden {\r\n    display: none;\r\n  }\r\n\r\n  .item-pile-merchant-content {\r\n\r\n    flex: 1;\r\n    max-height: calc(100% - 84px);\r\n\r\n  }\r\n\r\n\r\n</style>\r\n","<script>\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\n\timport { localize } from '#runtime/svelte/helper';\n\timport { getContext } from \"svelte\";\n\timport { getUserCharacter } from \"../../../helpers/utilities.js\";\n\n\tconst { application } = getContext('#external');\n\n\texport let elementRoot;\n\n\tlet form;\n\n\tgetUserCharacter()\n\n\tconst users = game.users\n\t\t.filter(u => u.active && (getUserCharacter(u) || u.isGM) && !(application.options.excludeSelf && u === game.user))\n\t\t.map(u => ({\n\t\t\tid: u.id,\n\t\t\tname: u.name,\n\t\t\tselected: true\n\t\t}));\n\n\tfunction requestSubmit() {\n\t\tform.requestSubmit();\n\t}\n\n\tfunction submit() {\n\t\tconst finalUsers = users.filter(user => user.selected).map(user => user.id);\n\t\tapplication.options.resolve(finalUsers);\n\t\tapplication.close();\n\t}\n\n</script>\n\n<svelte:options accessors={true}/>\n\n<ApplicationShell bind:elementRoot>\n\n\t<form autocomplete=\"off\" bind:this={form} class=\"item-piles-flexcol\" on:submit|once|preventDefault={submit}\n\t      style=\"padding:0.5rem;\">\n\n\t\t<p style=\"margin-top: 0;text-align: center;\">\n\t\t\t<strong>{localize(\"ITEM-PILES.Dialogs.UserSelect.Content\")}</strong>\n\t\t</p>\n\n\t\t<div style=\"display:grid; grid-template-columns: auto 25px;\">\n\n\t\t\t{#each users as user (user.id)}\n\n\t\t\t\t<div class=\"item-piles-flexrow\" style=\"align-items: center;\">\n\t\t\t\t\t<label for={\"item-piles-user-\" + user.id} class=\"item-piles-clickable\">{user.name}</label>\n\t\t\t\t</div>\n\t\t\t\t<input id={\"item-piles-user-\" + user.id} type=\"checkbox\" bind:checked={user.selected}/>\n\n\t\t\t{/each}\n\n\t\t</div>\n\n\t\t<footer class=\"sheet-footer item-piles-flexrow\" style=\"margin-top: 1rem;\">\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\n\t\t\t\t<i class=\"fas fa-check\"></i>\n\t\t\t\t{localize(\"Okay\")}\n\t\t\t</button>\n\t\t</footer>\n\n\t</form>\n\n</ApplicationShell>\n","import UserSelectDialogShell from \"./user-select-dialog-shell.svelte\";\r\nimport { SvelteApplication } from '#runtime/svelte/application';\r\n\r\nexport default class UserSelectDialog extends SvelteApplication {\r\n\r\n\t/**\r\n\t * @param options\r\n\t */\r\n\tconstructor(options = {}) {\r\n\t\tsuper({\r\n\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Dialogs.UserSelect.Title\"),\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: UserSelectDialogShell,\r\n\t\t\t\ttarget: document.body,\r\n\t\t\t},\r\n\t\t\tclose: () => this.options.resolve?.(null),\r\n\t\t\t...options\r\n\t\t})\r\n\t}\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\twidth: 200,\r\n\t\t\theight: \"auto\",\r\n\t\t\tclasses: [\"item-piles-app\"]\r\n\t\t})\r\n\t}\r\n\r\n\tstatic async show(options = {}) {\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\toptions.resolve = resolve;\r\n\t\t\tnew this(options).render(true, { focus: true });\r\n\t\t})\r\n\t}\r\n\r\n}\r\n","import { SvelteApplication } from '#runtime/svelte/application';\r\nimport ItemPileConfig from \"../item-pile-config/item-pile-config\";\r\nimport MerchantAppShell from \"./merchant-app-shell.svelte\";\r\nimport * as Helpers from \"../../helpers/helpers.js\";\r\nimport UserSelectDialog from \"../dialogs/user-select-dialog/user-select-dialog.js\";\r\nimport SETTINGS from \"../../constants/settings.js\";\r\nimport CONSTANTS from \"../../constants/constants.js\";\r\nimport * as Utilities from \"../../helpers/utilities.js\";\r\n\r\nexport default class MerchantApp extends SvelteApplication {\r\n\r\n\tconstructor(merchant, recipient = false, options = {}, dialogData = {}) {\r\n\t\tsuper({\r\n\t\t\ttitle: `Merchant: ${merchant.name}`,\r\n\t\t\tid: `item-pile-merchant-${merchant.id}-${foundry.utils.randomID()}`,\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: MerchantAppShell,\r\n\t\t\t\ttarget: document.body,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\tmerchant,\r\n\t\t\t\t\trecipient\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tzIndex: 100,\r\n\t\t\t...options\r\n\t\t}, dialogData);\r\n\t\tthis.merchant = merchant;\r\n\t\tthis.recipient = recipient;\r\n\t\tHelpers.hooks.callAll(CONSTANTS.HOOKS.OPEN_INTERFACE, this, merchant, recipient, options, dialogData);\r\n\t}\r\n\r\n\t/** @inheritdoc */\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\tclasses: [\"app window-app sheet\", \"item-piles-merchant-sheet\", \"item-piles\", \"item-piles-app\"],\r\n\t\t\twidth: 800,\r\n\t\t\theight: 700,\r\n\t\t\tcloseOnSubmit: false,\r\n\t\t\tresizable: true\r\n\t\t});\r\n\t}\r\n\r\n\tstatic getActiveApp(source) {\r\n\t\treturn Helpers.getActiveApps(`item-pile-merchant-${source.id}`, true);\r\n\t}\r\n\r\n\tstatic async show(merchant, recipient = false, options = {}, dialogData = {}) {\r\n\t\tconst merchantActor = Utilities.getActor(merchant);\r\n\t\tconst recipientActor = Utilities.getActor(recipient);\r\n\t\tconst result = Helpers.hooks.call(CONSTANTS.HOOKS.PRE_OPEN_INTERFACE, merchantActor, recipientActor, options, dialogData);\r\n\t\tif (result === false) return;\r\n\t\tconst app = this.getActiveApp(merchant);\r\n\t\tif (app) return app.render(false, { focus: true });\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\toptions.resolve = resolve;\r\n\t\t\tnew this(merchant, recipientActor, options, dialogData).render(true, { focus: true, bypassItemPiles: true });\r\n\t\t})\r\n\t}\r\n\r\n\trefreshItems() {\r\n\t\tthis.svelte.applicationShell.store.refreshItems();\r\n\t}\r\n\r\n\t/** @override */\r\n\t_getHeaderButtons() {\r\n\t\tlet buttons = super._getHeaderButtons();\r\n\t\tconst newButtons = [];\r\n\r\n\t\tif (this.merchant.isOwner) {\r\n\t\t\tnewButtons.push(\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.Inspect.OpenSheet\" : \"\",\r\n\t\t\t\t\tclass: \"item-piles-open-actor-sheet\",\r\n\t\t\t\t\ticon: \"fas fa-user\",\r\n\t\t\t\t\tonclick: () => {\r\n\t\t\t\t\t\tthis.merchant.sheet.render(true, { focus: true, bypassItemPiles: true });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\tif (game.user.isGM) {\r\n\t\t\tnewButtons.push(\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.ContextMenu.ShowToPlayers\" : \"\",\r\n\t\t\t\t\tclass: \"item-piles-show-to-players\",\r\n\t\t\t\t\ticon: \"fas fa-eye\",\r\n\t\t\t\t\tonclick: async (event) => {\r\n\t\t\t\t\t\tconst activeUsers = Array.from(game.users).filter(u => u.active && u !== game.user).map(u => u.id);\r\n\t\t\t\t\t\tif (!activeUsers.length) {\r\n\t\t\t\t\t\t\treturn Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.NoPlayersActive\"), true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst users = event.altKey ? activeUsers : await UserSelectDialog.show({ excludeSelf: true });\r\n\t\t\t\t\t\tif (!users || !users.length) return;\r\n\t\t\t\t\t\tHelpers.custom_notify(game.i18n.format(\"ITEM-PILES.Notifications.ShownToPlayers\", { actor_name: this.merchant.name }))\r\n\t\t\t\t\t\treturn game.itempiles.API.renderItemPileInterface(this.merchant, {\r\n\t\t\t\t\t\t\tuserIds: users,\r\n\t\t\t\t\t\t\tuseDefaultCharacter: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.HUD.Configure\" : \"\",\r\n\t\t\t\t\tclass: \"item-piles-configure-pile\",\r\n\t\t\t\t\ticon: \"fas fa-box-open\",\r\n\t\t\t\t\tonclick: () => {\r\n\t\t\t\t\t\tItemPileConfig.show(this.merchant);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn newButtons.concat(buttons);\r\n\t}\r\n\r\n\tasync close(options) {\r\n\t\tconst result = Helpers.hooks.call(CONSTANTS.HOOKS.PRE_CLOSE_INTERFACE, this, this.merchant, this.recipient);\r\n\t\tif (result === false) return;\r\n\t\tfor (const app of Object.values(ui.windows)) {\r\n\t\t\tif (app !== this && this.svelte.applicationShell.store === app?.svelte?.applicationShell?.store) {\r\n\t\t\t\tapp.close();\r\n\t\t\t}\r\n\t\t}\r\n\t\tHelpers.hooks.callAll(CONSTANTS.HOOKS.CLOSE_INTERFACE, this, this.merchant, this.recipient);\r\n\t\treturn super.close(options);\r\n\t}\r\n\r\n}\r\n","import { SvelteApplication } from '@typhonjs-fvtt/runtime/svelte/application';\nimport { parseTJSSvelteConfig, isSvelteComponent } from '@typhonjs-fvtt/runtime/svelte/util';\nimport { ManagedPromise } from '@typhonjs-fvtt/runtime/util/async';\nimport { StyleParse, A11yHelper } from '@typhonjs-fvtt/runtime/util/browser';\nimport { isObject, hasPrototype, isIterable } from '@typhonjs-fvtt/runtime/util/object';\nimport { FVTTSidebarPopout, FVTTSidebarTab, FVTTSidebarWrapper } from '@typhonjs-fvtt/svelte-standard/component/fvtt';\nimport { TJSContextMenuImpl } from '@typhonjs-fvtt/svelte-standard/component';\n\n/**\r\n * Provides the ability to mount and control Svelte component based sidebar panels & tabs in the Foundry sidebar.\r\n *\r\n * The nice aspect about FVTTSidebarControl is that all you have to provide is the sidebar component and the rest is\r\n * handled for you including automatically widening the width of the sidebar to fit the new sidebar tab. Also by default\r\n * an adhoc SvelteApplication is configured to display the sidebar when popped out automatically without the need to\r\n * associate an app instance.\r\n *\r\n * -------------------------------------------------------------------------------------------------------------------\r\n *\r\n * To add a new sidebar tab schedule one or more invocations of {@link FVTTSidebarControl.add} in a `setup` hook. You\r\n * must add all sidebars in the `setup` hook before the main Foundry sidebar renders. Please review all the expanded\r\n * options available in the configuration object passed to the `add` method. At minimum, you need to provide a unique\r\n * `id`, `icon`, and `svelte` configuration object. You almost always will want to provide `beforeId` referencing\r\n * another existing sidebar tab ID to place the tab button before. If undefined the tab is inserted at the end of\r\n * the sidebar tabs. The default Foundry sidebar tab IDs from left to right are: 'chat', 'combat', 'scenes', 'actors',\r\n * 'items', 'journal', 'tables', 'cards', 'playlists', 'compendium', and 'settings'.\r\n *\r\n * -------------------------------------------------------------------------------------------------------------------\r\n *\r\n * Optionally:\r\n * - You can define the `icon` as a Svelte configuration object to load an interactive component instead of\r\n * using a FontAwesome icon. This allows you to dynamically show state similar to the chat log sidebar when activity\r\n * occurs or for other purposes.\r\n *\r\n * - You can provide `popoutOptions` overriding the default options passed to the default adhoc SvelteApplication\r\n * rendered for the popout.\r\n *\r\n * - You can provide a class that extends from SvelteApplication as `popoutApplication` to provide a fully customized\r\n * popout sidebar that you fully control.\r\n *\r\n * -------------------------------------------------------------------------------------------------------------------\r\n *\r\n * There is a method to remove an existing stock Foundry sidebar {@link FVTTSidebarControl.remove}. It takes\r\n * an `id` field that must be one of the existing Foundry sidebar IDs to remove: chat', 'combat', 'scenes',\r\n * 'actors', 'items', 'journal', 'tables', 'cards', 'playlists', 'compendium', and 'settings'.\r\n *\r\n * -------------------------------------------------------------------------------------------------------------------\r\n *\r\n * There is a method to replace an existing stock Foundry sidebar {@link FVTTSidebarControl.replace}. It takes\r\n * the same data as the `add` method, but `id` must be one of the existing Foundry sidebar IDs to replace: chat',\r\n * 'combat', 'scenes', 'actors', 'items', 'journal', 'tables', 'cards', 'playlists', 'compendium', and 'settings'.\r\n *\r\n * Both the `add` and `replace` methods have a data field `mergeAppImpl` that provides the base implementation for the\r\n * added / replaced object instance assigned to `globalThis.ui.<SIDEBAR APP ID>`. When replacing Foundry core sidebar\r\n * panels like the {@link CombatTracker} there is additional API that you must handle found in the given core\r\n * sidebar app implementation. It is recommended that you implement this API as part of the control / model code passed\r\n * to the Svelte sidebar component and also set to `mergeAppImpl`.\r\n *\r\n * -------------------------------------------------------------------------------------------------------------------\r\n *\r\n * The {@link FVTTSidebarControl.get} method allows you to retrieve the associated {@link FVTTSidebarEntry} for a given\r\n * sidebar by ID allowing access to the configuration data, popout app, and wrapper components that mount the sidebar.\r\n *\r\n * The {@link FVTTSidebarControl.wait} returns a Promise that is resolved after all sidebars have been initialized.\r\n * allowing handling any special setup as necessary.\r\n *\r\n * -------------------------------------------------------------------------------------------------------------------\r\n *\r\n * @example Minimal setup\r\n *\r\n * Hooks.once('setup', () =>\r\n * {\r\n *    FVTTSidebarControl.add({\r\n *       beforeId: 'items',               // Place new tab before the 'items' tab.\r\n *       id: 'test',                      // A unique CSS ID.\r\n *       icon: 'fas fa-dice-d10',         // FontAwesome icon.\r\n *       condition: () => game.user.isGM, // Optional boolean / function to conditionally run the sidebar action.\r\n *       title: 'Test Directory',         // Title of popout sidebar app; can be language string.\r\n *       tooltip: 'Tests',                // Tooltip for sidebar tab.\r\n *       svelte: {                        // A Svelte configuration object.\r\n *          class: TestTab                // A Svelte component.\r\n *       }\r\n *    });\r\n * });\r\n */\r\nclass FVTTSidebarControl\r\n{\r\n   /**\r\n    * @type {object[]}\r\n    */\r\n   static #initData = [];\r\n\r\n   static #initPromise = new ManagedPromise();\r\n\r\n   /**\r\n    * @type {Map<string, FVTTSidebarEntry>}\r\n    */\r\n   static #sidebars = new Map();\r\n\r\n   /**\r\n    * Adds a new Svelte powered sidebar tab / panel.\r\n    *\r\n    * @param {FVTTSidebarAddData}   sidebarData - The configuration object for a Svelte sidebar,\r\n    */\r\n   static add(sidebarData)\r\n   {\r\n      try\r\n      {\r\n         if (!isObject(sidebarData))\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.add error: 'sidebarData' is not an object.`);\r\n         }\r\n\r\n         if (typeof sidebarData.id !== 'string')\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.add error: 'sidebarData.id' is not a string.`);\r\n         }\r\n\r\n         if (typeof sidebarData.icon !== 'string' && !isObject(sidebarData.icon))\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.add error: 'sidebarData.icon' is not a string or object.`);\r\n         }\r\n\r\n         if (sidebarData.beforeId !== void 0 && typeof sidebarData.beforeId !== 'string')\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.add error: 'sidebarData.beforeId' is not a string.`);\r\n         }\r\n\r\n         if (sidebarData.condition !== void 0 && typeof sidebarData.condition !== 'boolean' &&\r\n          typeof sidebarData.condition !== 'function')\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.replace error: 'sidebarData.condition' is not a boolean or function.`);\r\n         }\r\n\r\n         if (sidebarData.mergeAppImpl !== void 0 && !isObject(sidebarData.mergeAppImpl))\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.add error: 'sidebarData.mergeAppImpl' is not an object.`);\r\n         }\r\n\r\n         if (sidebarData.popoutApplication !== void 0 && !hasPrototype(sidebarData.popoutApplication, SvelteApplication))\r\n         {\r\n            throw new TypeError(\r\n             `FVTTSidebarControl.add error: 'sidebarData.popoutApplication' is not a SvelteApplication.`);\r\n         }\r\n\r\n         if (sidebarData.popoutOptions !== void 0 && !isObject(sidebarData.popoutOptions))\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.add error: 'sidebarData.popoutOptions' is not an object.`);\r\n         }\r\n\r\n         if (sidebarData.title !== void 0 && typeof sidebarData.title !== 'string')\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.add error: 'sidebarData.title' is not a string.`);\r\n         }\r\n\r\n         if (sidebarData.tooltip !== void 0 && typeof sidebarData.tooltip !== 'string')\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.add error: 'sidebarData.tooltip' is not a string.`);\r\n         }\r\n\r\n         let svelteConfig;\r\n\r\n         try\r\n         {\r\n            svelteConfig = parseTJSSvelteConfig(sidebarData.svelte);\r\n         }\r\n         catch (err)\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.add error parsing 'sidebarData.svelte'; ${err.message}`);\r\n         }\r\n\r\n         // Parse any icon defined as a Svelte configuration object.\r\n\r\n         let iconSvelteConfig;\r\n\r\n         if (isObject(sidebarData.icon))\r\n         {\r\n            try\r\n            {\r\n               iconSvelteConfig = parseTJSSvelteConfig(sidebarData.icon);\r\n            }\r\n            catch (err)\r\n            {\r\n               throw new TypeError(`FVTTSidebarControl.add error parsing 'sidebarData.icon'; ${err.message}`);\r\n            }\r\n         }\r\n\r\n         if (this.#initData.length === 0)\r\n         {\r\n            this.#initPromise.create();\r\n\r\n            Hooks.once('renderSidebar', () => this.#initialize());\r\n         }\r\n\r\n         const sidebar = {\r\n            ...sidebarData,\r\n            svelteConfig,\r\n            iconSvelteConfig,\r\n            action: 'add'\r\n         };\r\n\r\n         // Defines the default options to use when `popoutApplication` is not defined.\r\n         sidebar.popoutOptions = {\r\n            // Default SvelteApplication options.\r\n            id: `${sidebarData.id}-popout`,\r\n            title: sidebarData.title ?? sidebarData.tooltip,\r\n            classes: ['tab', 'sidebar-tab', 'sidebar-popout'],\r\n            height: 'auto',\r\n            width: 300,\r\n            svelte: {\r\n               class: FVTTSidebarPopout,\r\n               target: document.body,\r\n               props: {\r\n                  sidebarData: sidebar\r\n               }\r\n            },\r\n\r\n            // Allow overriding of SvelteApplication options.\r\n            ...(sidebarData.popoutOptions ?? {})\r\n         };\r\n\r\n         this.#initData.push(sidebar);\r\n      }\r\n      catch (err)\r\n      {\r\n         console.error(err);\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Initializes all sidebars registered after the initial Foundry Sidebar app has been rendered.\r\n    */\r\n   static #initialize()\r\n   {\r\n      // Retrieve Foundry sidebar and sidebar tabs elements.\r\n      const sidebarEl = document.querySelector('#sidebar');\r\n      const tabsEl = document.querySelector('#sidebar-tabs');\r\n\r\n      if (!(sidebarEl instanceof HTMLElement))\r\n      {\r\n         throw new TypeError(\r\n          `FVTTSidebarControl.#initialize error - Could not locate sidebar with '#sidebar' selector.`);\r\n      }\r\n\r\n      if (!(tabsEl instanceof HTMLElement))\r\n      {\r\n         throw new TypeError(\r\n          `FVTTSidebarControl.#initialize error - Could not locate sidebar tabs with '#sidebar-tabs' selector.`);\r\n      }\r\n\r\n      /**\r\n       * Stores data used for adding / replacing sidebars.\r\n       *\r\n       * @type {{tabsEl: HTMLElement, sidebarEl: HTMLElement, initialSidebarWidth: number, addedSidebarWidth: number}}\r\n       */\r\n      const data = {\r\n         sidebarEl,\r\n         tabsEl,\r\n         initialSidebarWidth: StyleParse.pixels(globalThis?.getComputedStyle(sidebarEl)?.width),\r\n         addedSidebarWidth: 0\r\n      };\r\n\r\n      for (const sidebarData of this.#initData)\r\n      {\r\n         // Handle optional `condition` field potentially skipping the current sidebar action.\r\n         if (sidebarData.condition !== void 0)\r\n         {\r\n            if (typeof sidebarData.condition === 'boolean' && !sidebarData.condition) { continue; }\r\n            else if (typeof sidebarData.condition === 'function' && !sidebarData.condition()) { continue; }\r\n         }\r\n\r\n         try\r\n         {\r\n            switch (sidebarData.action)\r\n            {\r\n               case 'add':\r\n                  this.#sidebarAdd(data, sidebarData);\r\n                  break;\r\n\r\n               case 'remove':\r\n                  this.#sidebarRemove(data, sidebarData);\r\n                  break;\r\n\r\n               case 'replace':\r\n                  this.#sidebarReplace(data, sidebarData);\r\n                  break;\r\n            }\r\n         }\r\n         catch (err)\r\n         {\r\n            console.error(err);\r\n         }\r\n      }\r\n\r\n      // Set the Foundry CSS variable controlling the sidebar element width w/ the additional sidebar tab buttons\r\n      // cumulative width.\r\n      document.querySelector(':root').style.setProperty('--sidebar-width',\r\n       `${data.initialSidebarWidth + data.addedSidebarWidth}px`);\r\n\r\n      this.#initPromise.resolve(this);\r\n   }\r\n\r\n   /**\r\n    * Returns a loaded and configured sidebar entry by ID.\r\n    *\r\n    * @param {string}   id - The ID of the sidebar to retrieve.\r\n    *\r\n    * @returns {FVTTSidebarEntry} The sidebar entry.\r\n    */\r\n   static get(id)\r\n   {\r\n      return this.#sidebars.get(id);\r\n   }\r\n\r\n   /**\r\n    * Removes an existing sidebar tab / panel.\r\n    *\r\n    * @param {FVTTSidebarRemoveData}   sidebarData - The configuration object to remove a Svelte sidebar.\r\n    */\r\n   static remove(sidebarData)\r\n   {\r\n      try\r\n      {\r\n         if (!isObject(sidebarData))\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.remove error: 'sidebarData' is not an object.`);\r\n         }\r\n\r\n         if (typeof sidebarData.id !== 'string')\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.remove error: 'sidebarData.id' is not a string.`);\r\n         }\r\n\r\n         if (sidebarData.condition !== void 0 && typeof sidebarData.condition !== 'boolean' &&\r\n          typeof sidebarData.condition !== 'function')\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.replace error: 'sidebarData.condition' is not a boolean or function.`);\r\n         }\r\n\r\n         // Verify that there is an entry for `sidebarData.id` defined in 'CONFIG.ui` indicating that the ID\r\n         // is available to remove.\r\n         if (CONFIG.ui[sidebarData.id] === void 0)\r\n         {\r\n            throw new Error(`FVTTSidebarControl.remove error - 'sidebarData.id' (${\r\n             sidebarData.id}) not found in 'CONFIG.ui'.`);\r\n         }\r\n\r\n         // Remove existing Application reference for `sidebarData.id`.\r\n         // delete CONFIG.ui[sidebarData.id];\r\n\r\n         if (this.#initData.length === 0)\r\n         {\r\n            this.#initPromise.create();\r\n\r\n            Hooks.once('renderSidebar', () => this.#initialize());\r\n         }\r\n\r\n         const sidebar = {\r\n            ...sidebarData,\r\n            action: 'remove'\r\n         };\r\n\r\n         this.#initData.push(sidebar);\r\n      }\r\n      catch (err)\r\n      {\r\n         console.error(err);\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Replaces an existing sidebar tab / panel with a new Svelte powered sidebar.\r\n    *\r\n    * @param {FVTTSidebarReplaceData}   sidebarData - The configuration object to replace a core sidebar with a Svelte\r\n    *        sidebar.\r\n    */\r\n   static replace(sidebarData)\r\n   {\r\n      try\r\n      {\r\n         if (!isObject(sidebarData))\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.replace error: 'sidebarData' is not an object.`);\r\n         }\r\n\r\n         if (typeof sidebarData.icon !== 'string' && !isObject(sidebarData.icon))\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.replace error: 'sidebarData.icon' is not a string or object.`);\r\n         }\r\n\r\n         if (typeof sidebarData.id !== 'string')\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.replace error: 'sidebarData.id' is not a string.`);\r\n         }\r\n\r\n         if (sidebarData.condition !== void 0 && typeof sidebarData.condition !== 'boolean' &&\r\n          typeof sidebarData.condition !== 'function')\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.replace error: 'sidebarData.condition' is not a boolean or function.`);\r\n         }\r\n\r\n         if (sidebarData.mergeAppImpl !== void 0 && !isObject(sidebarData.mergeAppImpl))\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.replace error: 'sidebarData.mergeAppImpl' is not an object.`);\r\n         }\r\n\r\n         if (sidebarData.popoutApplication !== void 0 && !hasPrototype(sidebarData.popoutApplication, SvelteApplication))\r\n         {\r\n            throw new TypeError(\r\n             `FVTTSidebarControl.replace error: 'sidebarData.popoutApplication' is not a SvelteApplication.`);\r\n         }\r\n\r\n         if (sidebarData.popoutOptions !== void 0 && !isObject(sidebarData.popoutOptions))\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.replace error: 'sidebarData.popoutOptions' is not an object.`);\r\n         }\r\n\r\n         if (sidebarData.title !== void 0 && typeof sidebarData.title !== 'string')\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.replace error: 'sidebarData.title' is not a string.`);\r\n         }\r\n\r\n         if (sidebarData.tooltip !== void 0 && typeof sidebarData.tooltip !== 'string')\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.replace error: 'sidebarData.tooltip' is not a string.`);\r\n         }\r\n\r\n         // Verify that there is an entry for `sidebarData.id` defined in 'CONFIG.ui` indicating that the ID\r\n         // is available to replace.\r\n         if (CONFIG.ui[sidebarData.id] === void 0)\r\n         {\r\n            throw new Error(`FVTTSidebarControl.replace error - 'sidebarData.id' (${\r\n             sidebarData.id}) not found in 'CONFIG.ui'.`);\r\n         }\r\n\r\n         let svelteConfig;\r\n\r\n         try\r\n         {\r\n            svelteConfig = parseTJSSvelteConfig(sidebarData.svelte);\r\n         }\r\n         catch (err)\r\n         {\r\n            throw new TypeError(`FVTTSidebarControl.replace error parsing 'sidebarData.svelte'; ${err.message}`);\r\n         }\r\n\r\n         // Parse any icon defined as a Svelte configuration object.\r\n\r\n         let iconSvelteConfig;\r\n\r\n         if (isObject(sidebarData.icon))\r\n         {\r\n            try\r\n            {\r\n               iconSvelteConfig = parseTJSSvelteConfig(sidebarData.icon);\r\n            }\r\n            catch (err)\r\n            {\r\n               throw new TypeError(`FVTTSidebarControl.replace error parsing 'sidebarData.icon'; ${err.message}`);\r\n            }\r\n         }\r\n\r\n         if (this.#initData.length === 0)\r\n         {\r\n            this.#initPromise.create();\r\n\r\n            Hooks.once('renderSidebar', () => this.#initialize());\r\n         }\r\n\r\n         const sidebar = {\r\n            ...sidebarData,\r\n            svelteConfig,\r\n            iconSvelteConfig,\r\n            action: 'replace'\r\n         };\r\n\r\n         // Defines the default options to use when `popoutApplication` is not defined.\r\n         sidebar.popoutOptions = {\r\n            // Default SvelteApplication options.\r\n            id: `${sidebarData.id}-popout`,\r\n            title: sidebarData.title ?? sidebarData.tooltip,\r\n            classes: ['tab', 'sidebar-tab', 'sidebar-popout'],\r\n            height: 'auto',\r\n            width: 300,\r\n            svelte: {\r\n               class: FVTTSidebarPopout,\r\n               target: document.body,\r\n               props: {\r\n                  sidebarData: sidebar\r\n               }\r\n            },\r\n\r\n            // Allow overriding of SvelteApplication options.\r\n            ...(sidebarData.popoutOptions ?? {})\r\n         };\r\n\r\n         this.#initData.push(sidebar);\r\n      }\r\n      catch (err)\r\n      {\r\n         console.error(err);\r\n      }\r\n   }\r\n\r\n   /**\r\n    * Handles adding the new Svelte sidebar tab / panel.\r\n    *\r\n    * @param {object}   data - Data for tracking sidebar changes.\r\n    *\r\n    * @param {object}   sidebarData - Sidebar data to add.\r\n    */\r\n   static #sidebarAdd(data, sidebarData)\r\n   {\r\n      // Verify if new sidebar ID is not already defined in 'globalThis.ui` indicating that the ID is taken.\r\n      if (globalThis.ui[sidebarData.id] !== void 0)\r\n      {\r\n         throw new Error(`FVTTSidebarControl.#sidebarAdd error - 'sidebarData.id' (${\r\n          sidebarData.id}) is already in use in 'globalThis.ui'.`);\r\n      }\r\n\r\n      let anchorButtonEl;\r\n\r\n      // Attempt to find the `beforeId` tab to set as the before anchor when mounting new sidebar button.\r\n      if (sidebarData.beforeId)\r\n      {\r\n         anchorButtonEl = data.tabsEl.querySelector(`[data-tab=${sidebarData.beforeId}]`);\r\n\r\n         if (!(anchorButtonEl instanceof HTMLElement))\r\n         {\r\n            throw new TypeError(\r\n             `FVTTSidebarControl.#sidebarAdd error - Could not locate sidebar tab for 'sidebarData.beforeId': ${\r\n              sidebarData.beforeId}.`);\r\n         }\r\n      }\r\n\r\n      const sidebarTab = new FVTTSidebarTab({\r\n         target: data.tabsEl,\r\n         anchor: anchorButtonEl,\r\n         props: {\r\n            sidebarData\r\n         }\r\n      });\r\n\r\n      // Get width of the tab to increase sidebar element width CSS var.\r\n      data.addedSidebarWidth += StyleParse.pixels(globalThis.getComputedStyle(sidebarTab.anchorEl).width);\r\n\r\n      // -------------------\r\n\r\n      let anchorSectionEl;\r\n\r\n      // Attempt to find the `beforeId` tab to set as the before anchor when mounting new sidebar.\r\n      if (sidebarData.beforeId)\r\n      {\r\n         // At this moment the core sidebar apps are not rendered yet so are `template` and `section` elements. Also\r\n         // Check for `section` elements in case of indexing by another Svelte sidebar added prior.\r\n         anchorSectionEl = data.sidebarEl.querySelector(`template[data-tab=${sidebarData.beforeId}]`) ??\r\n          data.sidebarEl.querySelector(`section[data-tab=${sidebarData.beforeId}]`);\r\n\r\n         if (!(anchorSectionEl instanceof HTMLElement))\r\n         {\r\n            throw new TypeError(\r\n             `FVTTSidebarControl.#sidebarAdd error - Could not locate sidebar for 'sidebarData.beforeId': ${\r\n              sidebarData.beforeId}.`);\r\n         }\r\n      }\r\n\r\n      // Note: The new sidebar tab section is added at the end of the `section` elements and this is fine.\r\n      const sidebarWrapper = new FVTTSidebarWrapper({\r\n         target: data.sidebarEl,\r\n         anchor: anchorSectionEl,\r\n         props: {\r\n            sidebarData\r\n         }\r\n      });\r\n\r\n      /** @type {FVTTSidebarEntry} */\r\n      const sidebarEntry = {\r\n         data: sidebarData,\r\n         popout: sidebarData.popoutApplication !== void 0 ? new sidebarData.popoutApplication() :\r\n          new SvelteApplication(sidebarData.popoutOptions),\r\n         tab: sidebarTab,\r\n         wrapper: sidebarWrapper\r\n      };\r\n\r\n      Object.freeze(sidebarEntry);\r\n\r\n      // Fake the bare minimum API necessary for a Foundry sidebar tab which is added to `globalThis.ui`.\r\n      globalThis.ui[`${sidebarData.id}`] = Object.assign(sidebarData.mergeAppImpl ?? {}, {\r\n         /**\r\n          * Provides an accessor to retrieve the popout application as a sanity case.\r\n          *\r\n          * @returns {SvelteApplication} The popout application.\r\n          * @protected\r\n          */\r\n         get _popout()\r\n         {\r\n            return sidebarEntry?.popout;\r\n         },\r\n\r\n         /**\r\n          * Renders the popout application and is invoked by {@link Sidebar} when the sidebar tab is right-clicked.\r\n          *\r\n          * @returns {SvelteApplication} Popout application.\r\n          */\r\n         renderPopout: () => sidebarEntry?.popout?.render?.(true, { focus: true }),\r\n\r\n         /**\r\n          * No-op; added as sanity measure.\r\n          */\r\n         render() {}\r\n      });\r\n\r\n      this.#sidebars.set(sidebarData.id, sidebarEntry);\r\n   }\r\n\r\n   /**\r\n    * Handles removing an existing sidebar.\r\n    *\r\n    * @param {object}   data - Data for tracking sidebar changes.\r\n    *\r\n    * @param {object}   sidebarData - Sidebar data to remove.\r\n    */\r\n   static #sidebarRemove(data, sidebarData)\r\n   {\r\n      // Remove specific sidebar app from Foundry core Sidebar class. This prevents rendering of that sidebar and\r\n      // must be removed here after the `condition` check in #initialize.\r\n      delete globalThis.ui?.sidebar?.tabs[sidebarData.id];\r\n\r\n      // Attempt to find the `id` tab to set as the before anchor when mounting new sidebar button.\r\n      const anchorButtonEl = data.tabsEl.querySelector(`[data-tab=${sidebarData.id}]`);\r\n\r\n      if (!(anchorButtonEl instanceof HTMLElement))\r\n      {\r\n         throw new TypeError(\r\n          `FVTTSidebarControl.#sidebarRemove error - Could not locate sidebar tab for 'sidebarData.id': ${\r\n           sidebarData.id}.`);\r\n      }\r\n\r\n      // Remove width of the old replaced tab width.\r\n      data.addedSidebarWidth -= StyleParse.pixels(globalThis.getComputedStyle(anchorButtonEl).width);\r\n\r\n      // -------------------\r\n\r\n      // Attempt to find the existing `id` panel.\r\n      const anchorSectionEl = data.sidebarEl.querySelector(`template[data-tab=${sidebarData.id}]`) ??\r\n       data.sidebarEl.querySelector(`section[data-tab=${sidebarData.id}]`);\r\n\r\n      if (!(anchorSectionEl instanceof HTMLElement))\r\n      {\r\n         throw new TypeError(\r\n          `FVTTSidebarControl.#sidebarRemove error - Could not locate sidebar for 'sidebarData.id': ${\r\n           sidebarData.id}.`);\r\n      }\r\n\r\n      // Remove old sidebar tab / panel.\r\n      anchorButtonEl.remove();\r\n      anchorSectionEl.remove();\r\n   }\r\n\r\n   /**\r\n    * Handles replacing an existing sidebar with a new Svelte sidebar tab / panel.\r\n    *\r\n    * @param {object}   data - Data for tracking sidebar changes.\r\n    *\r\n    * @param {object}   sidebarData - Sidebar data to replace.\r\n    */\r\n   static #sidebarReplace(data, sidebarData)\r\n   {\r\n      // Remove specific sidebar app from Foundry core Sidebar class. This prevents rendering of that sidebar and\r\n      // must be removed here after the `condition` check in #initialize.\r\n      delete globalThis.ui?.sidebar?.tabs[sidebarData.id];\r\n\r\n      // Attempt to find the `id` tab to set as the before anchor when mounting new sidebar button.\r\n      const anchorButtonEl = data.tabsEl.querySelector(`[data-tab=${sidebarData.id}]`);\r\n\r\n      if (!(anchorButtonEl instanceof HTMLElement))\r\n      {\r\n         throw new TypeError(\r\n          `FVTTSidebarControl.#sidebarReplace error - Could not locate sidebar tab for 'sidebarData.id': ${\r\n           sidebarData.id}.`);\r\n      }\r\n\r\n      const sidebarTab = new FVTTSidebarTab({\r\n         target: data.tabsEl,\r\n         anchor: anchorButtonEl,\r\n         props: {\r\n            sidebarData\r\n         }\r\n      });\r\n\r\n      // Remove width of the old replaced tab width.\r\n      data.addedSidebarWidth -= StyleParse.pixels(globalThis.getComputedStyle(anchorButtonEl).width);\r\n\r\n      // Get width of the tab to increase sidebar element width CSS var.\r\n      data.addedSidebarWidth += StyleParse.pixels(globalThis.getComputedStyle(sidebarTab.anchorEl).width);\r\n\r\n      // -------------------\r\n\r\n      // Attempt to find the `id` tab to set as the before anchor when mounting new sidebar.\r\n      // At this moment the core sidebar apps are not rendered yet so are `template` and `section` elements. Also\r\n      // Check for `section` elements in case of indexing by another Svelte sidebar added prior.\r\n      const anchorSectionEl = data.sidebarEl.querySelector(`template[data-tab=${sidebarData.id}]`) ??\r\n       data.sidebarEl.querySelector(`section[data-tab=${sidebarData.id}]`);\r\n\r\n      if (!(anchorSectionEl instanceof HTMLElement))\r\n      {\r\n         throw new TypeError(\r\n          `FVTTSidebarControl.#sidebarReplace error - Could not locate sidebar for 'sidebarData.id': ${\r\n           sidebarData.id}.`);\r\n      }\r\n\r\n      // Note: The new sidebar tab section is added at the end of the `section` elements and this is fine.\r\n      const sidebarWrapper = new FVTTSidebarWrapper({\r\n         target: data.sidebarEl,\r\n         anchor: anchorSectionEl,\r\n         props: {\r\n            sidebarData\r\n         }\r\n      });\r\n\r\n      /** @type {FVTTSidebarEntry} */\r\n      const sidebarEntry = {\r\n         data: sidebarData,\r\n         popout: sidebarData.popoutApplication !== void 0 ? new sidebarData.popoutApplication() :\r\n          new SvelteApplication(sidebarData.popoutOptions),\r\n         tab: sidebarTab,\r\n         wrapper: sidebarWrapper\r\n      };\r\n\r\n      Object.freeze(sidebarEntry);\r\n\r\n      // Fake the bare minimum API necessary for a Foundry sidebar tab which is added to `globalThis.ui`.\r\n      globalThis.ui[`${sidebarData.id}`] = Object.assign(sidebarData.mergeAppImpl ?? {}, {\r\n         /**\r\n          * Provides an accessor to retrieve the popout application as a sanity case.\r\n          *\r\n          * @returns {SvelteApplication} The popout application.\r\n          * @protected\r\n          */\r\n         get _popout()\r\n         {\r\n            return sidebarEntry?.popout;\r\n         },\r\n\r\n         /**\r\n          * Renders the popout application and is invoked by {@link Sidebar} when the sidebar tab is right-clicked.\r\n          *\r\n          * @returns {SvelteApplication} Popout application.\r\n          */\r\n         renderPopout: () => sidebarEntry?.popout?.render?.(true, { focus: true }),\r\n\r\n         /**\r\n          * No-op; added as sanity measure.\r\n          */\r\n         render() {}\r\n      });\r\n\r\n      // Remove old sidebar tab / panel.\r\n      anchorButtonEl.remove();\r\n      anchorSectionEl.remove();\r\n\r\n      this.#sidebars.set(sidebarData.id, sidebarEntry);\r\n   }\r\n\r\n   /**\r\n    * Provides a Promise that is resolved after all added sidebars are initialized. This is useful when additional\r\n    * setup or configuration of sidebars needs to be performed after sidebar initialization.\r\n    *\r\n    * @returns {Promise} Initialization Promise.\r\n    */\r\n   static wait()\r\n   {\r\n      return this.#initPromise.get();\r\n   }\r\n}\r\n\r\n/**\r\n * @typedef {object} FVTTSidebarAddData The configuration object to add a Svelte sidebar.\r\n *\r\n * @property {string}   id The unique Sidebar ID / name. Used for CSS ID and retrieving the sidebar.\r\n *\r\n * @property {string|import('#runtime/svelte/util').TJSSvelteConfig}  icon The FontAwesome icon css classes\r\n * _or_ a Svelte configuration object to load a custom Svelte component to use as the \"icon\".\r\n *\r\n * @property {import('#runtime/svelte/util').TJSSvelteConfig}   svelte A Svelte configuration object.\r\n *\r\n * @property {string}   [beforeId] The ID for the tab to place the new sidebar before. This must be an\r\n * existing sidebar tab ID. THe stock Foundry sidebar tab IDs from left to right are:\r\n *\r\n * @property {boolean | (() => boolean)}  [condition] A boolean value or function to invoke that returns a\r\n * boolean value to control sidebar replacement. This is executed in the `renderSidebar` callback\r\n * internally.\r\n *\r\n * @property {object}   [mergeAppImpl] Provides a custom base implementation for the object instance\r\n * for this sidebar app stored in `globalThis.ui.<SIDEBAR ID>`.\r\n *\r\n * @property {import('#runtime/svelte/application').SvelteApplication}   [popoutApplication] Provides a custom\r\n * SvelteApplication class to instantiate for the popout sidebar.\r\n *\r\n * @property {object}   [popoutOptions] Provides SvelteApplication options overrides for the default popout sidebar.\r\n *\r\n * @property {string}   [title] The popout application title text or i18n lang key.\r\n *\r\n * @property {string}   [tooltip] The sidebar tab tooltip text or i18n lang key.\r\n */\r\n\r\n/**\r\n * @typedef {object} FVTTSidebarRemoveData\r\n *\r\n * @property {string}   id The ID for the sidebar tab to remove. This must be an existing sidebar tab ID.\r\n *\r\n * @property {boolean | (() => boolean)}   [condition] A boolean value or function to invoke that returns a boolean\r\n * value to control sidebar replacement. This is executed in the `renderSidebar` callback internally.\r\n */\r\n\r\n/**\r\n * @typedef {object} FVTTSidebarReplaceData The configuration object to replace a core sidebar with a Svelte sidebar.\r\n *\r\n * @property {string|import('#runtime/svelte/util').TJSSvelteConfig}  icon The FontAwesome icon css classes _or_ a\r\n * Svelte configuration object to load a custom Svelte component to use as the \"icon\".\r\n *\r\n * @property {string}   id The ID for the sidebar to replace. This must be an existing sidebar tab ID.\r\n *\r\n * @property {import('#runtime/svelte/util').TJSSvelteConfig}   svelte A Svelte configuration object.\r\n *\r\n * @property {boolean | (() => boolean)}   [condition] A boolean value or function to invoke that returns a boolean\r\n * value to control sidebar replacement. This is executed in the `renderSidebar` callback internally.\r\n *\r\n * @property {object}   [mergeAppImpl] Provides a custom base implementation for the object instance for this sidebar\r\n * app stored in `globalThis.ui.<SIDEBAR ID>`.\r\n *\r\n * @property {import('#runtime/svelte/application').SvelteApplication}   [popoutApplication] Provides a custom\r\n * SvelteApplication class to instantiate for the popout sidebar.\r\n *\r\n * @property {object}   [popoutOptions] Provides SvelteApplication options overrides for the default popout sidebar.\r\n *\r\n * @property {string}   [title] The popout application title text or i18n lang key.\r\n *\r\n * @property {string}   [tooltip] The sidebar tab tooltip text or i18n lang key.\r\n */\r\n\r\n/**\r\n * @typedef {object} FVTTSidebarEntry\r\n *\r\n * @property {FVTTSidebarAddData | FVTTSidebarRemoveData | FVTTSidebarReplaceData} data The sidebar data that\r\n * configures a Svelte sidebar.\r\n *\r\n * @property {import('#runtime/svelte/application').SvelteApplication}  popout The sidebar popout application.\r\n *\r\n * @property {import('svelte').SvelteComponent} tab The tab wrapper component.\r\n *\r\n * @property {import('svelte').SvelteComponent} wrapper The sidebar wrapper component.\r\n */\n\n/**\r\n * Provides and manages browser window wide context menu functionality. The best way to create a context menu is to\r\n * attach the source KeyboardEvent or MouseEvent / PointerEvent as data in {@link TJSContextMenu.create}. This allows\r\n * proper keyboard handling across browsers supporting the context menu key. A A11yFocusSource data object is generated\r\n * which allows tracking of the source element that triggered the context menu allowing focus to return to the source\r\n * when the context menu is closed. This A11yFocusSource object is also forwarded on through the `onPress` callback and\r\n * is intended to be supplied as `SvelteApplication` options particularly for modal dialogs allowing focus to return\r\n * to the original source after the modal dialog is closed.\r\n */\r\nclass TJSContextMenu\r\n{\r\n   /**\r\n    * Stores any active context menu.\r\n    */\r\n   static #contextMenu = void 0;\r\n\r\n   /**\r\n    * Creates and manages a browser wide context menu. The best way to create the context menu is to pass in the source\r\n    * DOM event as it is processed for the location of the context menu to display. Likewise, a A11yFocusSource object\r\n    * is generated that allows focus to be returned to the source location. You may supply a default focus target as a\r\n    * fallback via `focusEl`.\r\n    *\r\n    * @param {object}      opts - Optional parameters.\r\n    *\r\n    * @param {string}      [opts.id] - A custom CSS ID to add to the menu. This allows CSS style targeting.\r\n    *\r\n    * @param {KeyboardEvent|MouseEvent}  [opts.event] - The source MouseEvent or KeyboardEvent.\r\n    *\r\n    * @param {number}      [opts.x] - X position override for the top / left of the menu.\r\n    *\r\n    * @param {number}      [opts.y] - Y position override for the top / left of the menu.\r\n    *\r\n    * @param {Iterable<TJSContextMenuItemData>} [opts.items] - Menu items to display.\r\n    *\r\n    * @param {boolean}     [opts.focusDebug] - When true the associated A11yFocusSource object will log focus target\r\n    *        data when applied.\r\n    *\r\n    * @param {HTMLElement|string} [opts.focusEl] - A specific HTMLElement or selector string as the default focus\r\n    *        target.\r\n    *\r\n    * @param {string}      [opts.keyCode='Enter'] - Key to select menu items.\r\n    *\r\n    * @param {Record<string, string>}  [opts.styles] - Optional inline styles to apply.\r\n    *\r\n    * @param {number}      [opts.zIndex=Number.MAX_SAFE_INTEGER - 100] - Z-index for context menu.\r\n    *\r\n    * @param {number}      [opts.duration] - Transition option for duration of transition.\r\n    *\r\n    * @param {import('svelte/transition').EasingFunction}   [opts.easing] - Transition option for easing function.\r\n    */\r\n   static create({ id = '', event, x, y, items, focusDebug = false, focusEl, keyCode = 'Enter', styles,\r\n    zIndex = Number.MAX_SAFE_INTEGER - 100, duration = 200, easing, } = {})\r\n   {\r\n      if (this.#contextMenu !== void 0) { return; }\r\n\r\n      if (!event && (typeof x !== 'number' || typeof y !== 'number'))\r\n      {\r\n         throw new Error(`TJSContextMenu.create error: No event or absolute X / Y position not defined.`);\r\n      }\r\n\r\n      if (event !== void 0 && !(event instanceof KeyboardEvent) && !(event instanceof MouseEvent))\r\n      {\r\n         throw new TypeError(`TJSContextMenu.create error: 'event' is not a KeyboardEvent or MouseEvent.`);\r\n      }\r\n\r\n      const focusSource = A11yHelper.getFocusSource({ event, x, y, focusEl, debug: focusDebug });\r\n\r\n      // Create the new context menu with the last click x / y point.\r\n      this.#contextMenu = new TJSContextMenuImpl({\r\n         target: document.body,\r\n         intro: true,\r\n         props: {\r\n            id,\r\n            x: focusSource.x,\r\n            y: focusSource.y,\r\n            items: this.#processItems(items),\r\n            focusSource,\r\n            keyCode,\r\n            styles,\r\n            transitionOptions: { duration, easing },\r\n            zIndex\r\n         }\r\n      });\r\n\r\n      // Register an event listener to remove any active context menu if closed from a menu selection or pointer\r\n      // down event to `document.body`.\r\n      this.#contextMenu.$on('close', () => { this.#contextMenu = void 0; });\r\n   }\r\n\r\n   /**\r\n    * Processes menu item data for conditions and evaluating the type of menu item.\r\n    *\r\n    * @param {Iterable<TJSContextMenuItemData>} items - Menu item data.\r\n    *\r\n    * @returns {object[]} Processed menu items.\r\n    */\r\n   static #processItems(items)\r\n   {\r\n      if (!isIterable(items)) { throw new TypeError(`TJSContextMenu error: 'items' is not an iterable list.`); }\r\n\r\n      const tempList = items;\r\n      const tempItems = [];\r\n\r\n      let cntr = -1;\r\n\r\n      for (const item of tempList)\r\n      {\r\n         cntr++;\r\n         if (!isObject(item)) { throw new TypeError(`TJSContextMenu error: 'item[${cntr}]' is not an object.`); }\r\n\r\n         // Filter items for any condition that prevents display.\r\n         if (typeof item.condition === 'function' && !item.condition()) { continue; }\r\n         if (typeof item.condition === 'boolean' && !item.condition) { continue; }\r\n\r\n         let type;\r\n\r\n         if (isSvelteComponent(item.class)) { type = 'class'; }\r\n         else if (typeof item.icon === 'string') { type = 'icon'; }\r\n         else if (typeof item.image === 'string') { type = 'image'; }\r\n         else if (typeof item.separator === 'string')\r\n         {\r\n            if (item.separator !== 'hr')\r\n            {\r\n               throw new Error(\r\n                `TJSContextMenu error: 'item[${cntr}]' has unknown separator type; only 'hr' is currently supported.`);\r\n            }\r\n\r\n            type = 'separator-hr';\r\n         }\r\n\r\n         if (type === void 0) { throw new TypeError(`TJSContextMenu error: Unknown type for 'item[${cntr}]'.`); }\r\n\r\n         tempItems.push({ ...item, '#type': type });\r\n      }\r\n\r\n      return tempItems;\r\n   }\r\n}\r\n\r\n/**\r\n * @typedef {object} TJSContextMenuItemData Defines a menu item entry. Depending on the item data that is passed\r\n * into the menu you can define 4 types of items: 'icon / label', 'image / label', 'class / Svelte component', and\r\n * 'separator / hr'. A single callback function `onPress` is supported.\r\n *\r\n * @property {(item: TJSContextMenuItemData, object) => void} [onPress] A callback function that receives the selected\r\n * item data and an object containing the A11yFocusSource data that can be passed to any Application / particularly\r\n * modal dialogs returning focus when closed.\r\n *\r\n * @property {boolean|(() => boolean)} [condition] If a boolean and false or a function that invoked returns a falsy\r\n * value this item is not added.\r\n *\r\n * @property {Function} [class] A Svelte component class.\r\n *\r\n * @property {object} [props] An object passed on as props for any Svelte component.\r\n *\r\n *\r\n * @property {string} [icon] A string containing icon classes.\r\n *\r\n *\r\n * @property {string} [image] An image icon path.\r\n *\r\n * @property {string} [imageAlt] An image 'alt' text description.\r\n *\r\n *\r\n * @property {string} [label] A text string that is passed through localization.\r\n *\r\n * @property {'hr'} [separator] A menu item separator; only 'hr' supported.\r\n */\n\nexport { FVTTSidebarControl, TJSContextMenu };\n//# sourceMappingURL=index.js.map\n","import { clamp } from \"../../../helpers/helpers.js\";\nimport { get } from \"svelte/store\";\n\nexport function isItemColliding(item, otherItem) {\n\tconst transform = item.transform?.subscribe ? get(item.transform) : item.transform;\n\tconst otherTransform = otherItem.transform?.subscribe ? get(otherItem.transform) : otherItem.transform;\n\treturn (\n\t\titem.id !== otherItem.id &&\n\t\ttransform.x + (transform.w - 1) >= otherTransform.x &&\n\t\ttransform.y + (transform.h - 1) >= otherTransform.y &&\n\t\ttransform.x <= otherTransform.x + (otherTransform.w - 1) &&\n\t\ttransform.y <= otherTransform.y + (otherTransform.h - 1)\n\t);\n}\n\nexport function getCollisions(originalItem, items) {\n\treturn items.filter((item) => {\n\t\treturn isItemColliding(originalItem, item)\n\t});\n}\n\nexport function coordinate2position(coordinate, cellSize, gap) {\n\treturn coordinate * cellSize + (coordinate + 1) * gap;\n}\n\nexport function coordinate2size(coordinate, cellSize, gap) {\n\treturn coordinate * cellSize + (coordinate - 1) * gap;\n}\n\nexport function position2coordinate(position, cellSize, size, gap) {\n\treturn Math.round(position / (cellSize + gap));\n}\n\nexport function snapOnMove(left, top, transform, options, doClamp = true) {\n\tconst { gridSize, gap, enabledCols, enabledRows } = options;\n\tconst { w, h } = transform;\n\n\tconst width = w * gridSize;\n\tconst height = h * gridSize;\n\n\tconst x = position2coordinate(left, gridSize, width, gap);\n\tconst y = position2coordinate(top, gridSize, height, gap);\n\n\treturn {\n\t\tx: doClamp ? clamp(x, 0, enabledCols - w) : x,\n\t\ty: doClamp ? clamp(y, 0, enabledRows - h) : y\n\t};\n}\n\nexport function calcPosition(transform, options) {\n\tconst { gridSize, gap } = options;\n\treturn {\n\t\t...transform,\n\t\tleft: coordinate2position(transform.x, gridSize, gap),\n\t\ttop: coordinate2position(transform.y, gridSize, gap),\n\t\twidth: coordinate2size(transform.w, gridSize, gap),\n\t\theight: coordinate2size(transform.h, gridSize, gap)\n\t};\n}\n\nexport function swapItemTransform(originalTransform, finalTransform, transform) {\n\n\tconst newTransform = { ...transform };\n\n\tconst shouldFlip = originalTransform.flipped !== finalTransform.flipped;\n\tconst delta = {\n\t\tx: newTransform.x - finalTransform.x,\n\t\ty: newTransform.y - finalTransform.y,\n\t}\n\tif (shouldFlip) {\n\n\t\tif (!originalTransform.flipped && finalTransform.flipped) {\n\t\t\tdelta.x -= finalTransform.w;\n\t\t\tdelta.x += newTransform.w;\n\t\t\tconst { x, y } = delta;\n\t\t\tdelta.x = y;\n\t\t\tdelta.y = x * -1;\n\t\t} else if (originalTransform.flipped && !finalTransform.flipped) {\n\t\t\tdelta.y -= finalTransform.h;\n\t\t\tdelta.y += newTransform.h;\n\t\t\tconst { x, y } = delta;\n\t\t\tdelta.x = y * -1;\n\t\t\tdelta.y = x;\n\t\t}\n\n\t\tconst { w, h } = newTransform;\n\t\tnewTransform.w = shouldFlip ? h : w;\n\t\tnewTransform.h = shouldFlip ? w : h;\n\t\tnewTransform.flipped = shouldFlip ? !newTransform.flipped : newTransform.flipped;\n\n\t}\n\n\tnewTransform.x = originalTransform.x + delta.x;\n\tnewTransform.y = originalTransform.y + delta.y;\n\n\treturn newTransform;\n\n}\n\nexport function isPlacementValid(item, collisions, items, options) {\n\tif (!collisions.length) return true;\n\n\tconst finalTransform = foundry.utils.deepClone(get(item.transform));\n\tconst origItemTransform = foundry.utils.deepClone(get(item.item.transform));\n\n\tconst newItemPlacement = {\n\t\tid: item.id,\n\t\ttransform: finalTransform\n\t};\n\n\tconst itemWithinBounds = (finalTransform.x + (finalTransform.w - 1)) < options.enabledCols\n\t\t&& (finalTransform.y + (finalTransform.h - 1)) < options.enabledRows\n\t\t&& (finalTransform.x) >= 0\n\t\t&& (finalTransform.y) >= 0;\n\n\tif (!itemWithinBounds) return false;\n\n\tconst assumedCollisionMovement = collisions.map(collision => {\n\t\tconst collisionTransform = foundry.utils.deepClone(get(collision.transform));\n\t\treturn {\n\t\t\tid: collision.id,\n\t\t\ttransform: swapItemTransform(origItemTransform, finalTransform, collisionTransform)\n\t\t};\n\t});\n\n\tif (!assumedCollisionMovement.every(entry => {\n\t\treturn entry\n\t\t\t&& (entry.transform.x + (entry.transform.w - 1)) < options.enabledCols\n\t\t\t&& (entry.transform.y + (entry.transform.h - 1)) < options.enabledRows\n\t\t\t&& (entry.transform.x) >= 0\n\t\t\t&& (entry.transform.y) >= 0\n\t})) return false;\n\n\tconst itemsSansCollisions = items.filter(i => {\n\t\treturn i.id !== item.id && !assumedCollisionMovement.some(coll => coll.id === i.id);\n\t}).concat([newItemPlacement])\n\n\treturn assumedCollisionMovement.every(movedBox => {\n\t\treturn !getCollisions(movedBox, itemsSansCollisions).length;\n\t});\n}\n","<script>\n\n\timport { createEventDispatcher } from 'svelte';\n\timport { get } from 'svelte/store';\n\timport { styleFromObject } from '../../../helpers/helpers.js';\n\timport {\n\t\tcalcPosition,\n\t\tcoordinate2size,\n\t\tgetCollisions,\n\t\tisPlacementValid,\n\t\tsnapOnMove,\n\t\tswapItemTransform\n\t} from './grid-utils.js';\n\n\texport let item;\n\texport let options;\n\texport let items;\n\texport let gridContainer;\n\n\tconst dispatch = createEventDispatcher();\n\n\tlet itemRef = HTMLElement;\n\tlet dragged = false;\n\tconst transformStore = item.transform;\n\tconst previewTransform = item.ghostTransform;\n\tconst activeStore = item.active;\n\n\t$: active = $activeStore;\n\t$: transform = $transformStore;\n\t$: gridTransform = calcPosition($transformStore, options);\n\t$: ghostGridTransform = calcPosition({\n\t\t...snapOnMove($previewTransform.left, $previewTransform.top, $previewTransform, options, false),\n\t\tw: $previewTransform.w,\n\t\th: $previewTransform.h,\n\t}, options);\n\t$: {\n\t\tif (!$activeStore) collisions = [];\n\t}\n\n\tlet classes = \"\";\n\t$: {\n\t\tclasses = \"\";\n\t\tclasses += \" \" + options.hoverClass;\n\t\tclasses += (options.highlightItems && item.highlight ? \" \" + options.highlightClass : \"\")\n\t\tclasses += (options.highlightItems && !item.highlight ? \" \" + options.dimClass : \"\")\n\t}\n\n\t$: style = styleFromObject({\n\t\t\"position\": \"absolute\",\n\t\t\"left\": gridTransform.left + \"px\",\n\t\t\"top\": gridTransform.top + \"px\",\n\t\t\"width\": gridTransform.width + \"px\",\n\t\t\"height\": gridTransform.height + \"px\",\n\t\t\"cursor\": 'move'\n\t});\n\n\t$: ghostStyle = styleFromObject({\n\t\t\"position\": \"absolute\",\n\t\t\"left\": ghostGridTransform.left + \"px\",\n\t\t\"top\": ghostGridTransform.top + \"px\",\n\t\t\"width\": ghostGridTransform.width + \"px\",\n\t\t\"height\": ghostGridTransform.height + \"px\",\n\t\t\"opacity\": \"0.75\",\n\t\t\"z-index\": \"5\"\n\t});\n\n\tlet splitting = false;\n\tlet validPlacement = false;\n\tlet collisions = [];\n\tlet pointerOffset = { left: 0, top: 0 };\n\n\tfunction doubleClick(event) {\n\t\tif (event.button !== 0) return;\n\t\tdispatch(\"itemdoubleclick\", { item });\n\t}\n\n\tfunction moveStart(event) {\n\n\t\tif (event.button === 2) {\n\t\t\treturn rightClick(event);\n\t\t}\n\n\t\tif (!options.canOrganize) return;\n\n\t\t// If not left mouse, skip\n\t\tif (event.button !== 0) return;\n\n\t\tif (event.pointerId) {\n\t\t\titemRef.setPointerCapture(event.pointerId);\n\t\t}\n\n\t\tenableMoveEvents(event);\n\n\t\tdispatch(\"itembegindrag\", {\n\t\t\titem,\n\t\t\ttarget: itemRef,\n\t\t\tx: event.pageX - pointerOffset.internalLeft,\n\t\t\ty: event.pageY - pointerOffset.internalTop\n\t\t});\n\n\t\tdragged = true;\n\n\t\tmove(event);\n\n\t}\n\n\tfunction splitStart(event) {\n\n\t\tsplitting = true;\n\n\t\tenableMoveEvents(event);\n\n\t}\n\n\tfunction enableMoveEvents(event) {\n\n\t\t// Get offset for pointer within the grid item\n\t\tpointerOffset = {\n\t\t\tleft: event.pageX - gridTransform.left,\n\t\t\ttop: event.pageY - gridTransform.top,\n\t\t\tinternalLeft: event.offsetX,\n\t\t\tinternalTop: event.offsetY\n\t\t};\n\n\t\t$previewTransform = $transformStore;\n\n\t\t// Setup events for when item is moved and dropped\n\t\twindow.addEventListener('pointermove', move, { passive: false });\n\t\twindow.addEventListener('pointerup', moveEnd, { passive: false });\n\t\twindow.addEventListener('touchmove', move, { passive: false });\n\t\twindow.addEventListener('touchend', moveEnd, { passive: false });\n\n\t}\n\n\tlet lastMoveEvent = false;\n\n\tfunction move(event) {\n\n\t\tif (!event && lastMoveEvent) event = lastMoveEvent;\n\t\tif (event) lastMoveEvent = event;\n\t\tif (!event) return;\n\n\t\tconst { pageX, pageY } = (event.type === \"touchmove\" ? event.changedTouches[0] : event);\n\n\t\tlet outOfBounds = false;\n\n\t\tpreviewTransform.update(data => {\n\n\t\t\tconst unsnappedData = calcPosition(data, options);\n\n\t\t\tconst { left, top, outOfBounds } = constrainToContainer(\n\t\t\t\tpageX - pointerOffset.left,\n\t\t\t\tpageY - pointerOffset.top,\n\t\t\t\tunsnappedData.width,\n\t\t\t\tunsnappedData.height\n\t\t\t);\n\n\t\t\tactiveStore.set(!outOfBounds);\n\n\t\t\tdispatch(\"itemmove\", {\n\t\t\t\tx: pageX - pointerOffset.internalLeft,\n\t\t\t\ty: pageY - pointerOffset.internalTop\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\t...data,\n\t\t\t\t...snapOnMove(left, top, unsnappedData, options),\n\t\t\t\tleft,\n\t\t\t\ttop\n\t\t\t};\n\t\t});\n\n\t\tcollisions = getCollisions({ id: item.id, transform: previewTransform }, items);\n\t\tif (!splitting) {\n\t\t\tvalidPlacement = !outOfBounds && isPlacementValid({\n\t\t\t\tid: item.id,\n\t\t\t\titem: item,\n\t\t\t\ttransform: previewTransform\n\t\t\t}, collisions, items, options);\n\t\t\tfor (const otherItem of items) {\n\t\t\t\tif (otherItem.id === item.id) continue;\n\t\t\t\tconst isActive = collisions.indexOf(otherItem) > -1;\n\t\t\t\totherItem.active.set(isActive);\n\t\t\t\tif (isActive) {\n\t\t\t\t\totherItem.ghostTransform.update(() => {\n\t\t\t\t\t\treturn calcPosition(swapItemTransform(transform, get(previewTransform), get(otherItem.transform)), options);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tactiveStore.set(!collisions.length);\n\t\t}\n\t}\n\n\tfunction constrainToContainer(left, top, width, height) {\n\n\t\tconst parentRect = gridContainer.getBoundingClientRect();\n\t\tconst relativeRect = {\n\t\t\tleft: (parentRect.left - parentRect.x),\n\t\t\ttop: (parentRect.top - parentRect.y),\n\t\t\tright: (parentRect.right - parentRect.x),\n\t\t\tbottom: (parentRect.bottom - parentRect.y),\n\t\t}\n\n\t\tconst outOfBounds = (left < relativeRect.left && left < (relativeRect.left - width / 2))\n\t\t\t|| (top < relativeRect.top && top < (relativeRect.top - height / 2))\n\t\t\t|| ((left + width) > relativeRect.right && (left + width) > (relativeRect.right + width / 2))\n\t\t\t|| ((top + height) > relativeRect.bottom && (top + height) > (relativeRect.bottom + height / 2));\n\n\t\tif (left < relativeRect.left) {\n\t\t\tleft = relativeRect.left;\n\t\t}\n\t\tif (top < relativeRect.top) {\n\t\t\ttop = relativeRect.top;\n\t\t}\n\t\tif ((left + width) > relativeRect.right) {\n\t\t\tleft = relativeRect.right - width;\n\t\t}\n\t\tif ((top + height) > relativeRect.bottom) {\n\t\t\ttop = relativeRect.bottom - height;\n\t\t}\n\n\t\treturn { left, top, outOfBounds };\n\n\t}\n\n\tfunction moveEnd(event) {\n\n\t\twindow.removeEventListener('pointermove', move);\n\t\twindow.removeEventListener('pointerup', moveEnd);\n\t\twindow.removeEventListener('touchmove', move);\n\t\twindow.removeEventListener('touchend', moveEnd);\n\n\t\tconst origItemTransform = get(transformStore);\n\t\tconst finalTransform = get(previewTransform);\n\n\t\tconst { pageX, pageY } = (event.type === \"touchmove\" ? event.changedTouches[0] : event);\n\n\t\tif (event.button === 2) {\n\t\t\tdispatch(\"itemstopdrag\", { cancelled: true });\n\t\t\tactiveStore.set(false);\n\t\t} else {\n\t\t\tdispatch(\"itemstopdrag\", {\n\t\t\t\titem,\n\t\t\t\toutOfBounds: !active,\n\t\t\t\tx: pageX,\n\t\t\t\ty: pageY,\n\t\t\t\tgridX: finalTransform.x,\n\t\t\t\tgridY: finalTransform.y,\n\t\t\t\tsplitting\n\t\t\t})\n\t\t}\n\n\t\tdragged = false;\n\n\t\tif (!active) return;\n\n\t\tfor (const otherItem of items) {\n\t\t\totherItem.active.set(false);\n\t\t}\n\n\t\tif (splitting) {\n\t\t\tsplitting = false;\n\t\t\treturn;\n\t\t}\n\n\t\tif (foundry.utils.isEmpty(finalTransform)\n\t\t\t|| (finalTransform.x === transform.x && finalTransform.y === transform.y && finalTransform.w === transform.w && finalTransform.h === transform.h)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!validPlacement) return;\n\n\t\tvalidPlacement = false;\n\n\t\tif (collisions.length) {\n\n\t\t\tif (item.item.areItemsSimilar(collisions[0].item) && !globalThis.keyboard.downKeys.has(\"ControlLeft\")) {\n\t\t\t\treturn collisions[0].item.merge(item.item);\n\t\t\t}\n\n\t\t\tfor (const collision of collisions) {\n\t\t\t\tcollision.transform.update(trans => {\n\t\t\t\t\treturn swapItemTransform(origItemTransform, finalTransform, trans);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\ttransformStore.update(trans => {\n\t\t\ttrans.x = finalTransform.x;\n\t\t\ttrans.y = finalTransform.y;\n\t\t\ttrans.w = finalTransform.w;\n\t\t\ttrans.h = finalTransform.h;\n\t\t\ttrans.flipped = finalTransform.flipped;\n\t\t\treturn trans;\n\t\t});\n\n\t\tdispatch(\"itemchange\", { items: collisions.concat([item]) });\n\n\t}\n\n\tfunction hoverOver() {\n\t\tconst { x, y } = itemRef.getBoundingClientRect();\n\t\tdispatch(\"itemhover\", {\n\t\t\titem,\n\t\t\ttarget: itemRef,\n\t\t\tx: x + Math.floor(options.gridSize / 2),\n\t\t\ty: y + Math.floor(options.gridSize / 2)\n\t\t});\n\t}\n\n\tfunction hoverLeave() {\n\t\tconst { x, y } = itemRef.getBoundingClientRect();\n\t\tdispatch(\"itemhoverleave\", {\n\t\t\titem,\n\t\t\ttarget: itemRef,\n\t\t\tx: x + Math.floor(options.gridSize / 2),\n\t\t\ty: y + Math.floor(options.gridSize / 2)\n\t\t});\n\t}\n\n\tfunction rightClick(event) {\n\t\tdispatch(\"itemrightclick\", {\n\t\t\titem,\n\t\t\ttarget: itemRef,\n\t\t\tx: event.pageX,\n\t\t\ty: event.pageY,\n\t\t\tsplitStart,\n\t\t});\n\t}\n\n\t$: itemClass = collisions.length ? (validPlacement ? options.collisionClass : options.invalidCollisionClass) : options.previewClass\n\t$: collisionClass = collisions.length ? (validPlacement ? options.collisionClass : options.invalidCollisionClass) : options.previewClass\n\n\tfunction keydown(event) {\n\t\tif (event.key !== \"r\" || !active || !dragged || (item.item.w === item.item.h)) return;\n\t\tpreviewTransform.update(data => {\n\t\t\tconst { w, h } = data;\n\t\t\tdispatch(\"itemflipped\", {\n\t\t\t\titem,\n\t\t\t\ttarget: itemRef,\n\t\t\t\th: w,\n\t\t\t\tw: h,\n\t\t\t\tflipped: !data.flipped\n\t\t\t});\n\t\t\tconst width = coordinate2size(h / 2, options.gridSize, options.gap);\n\t\t\tconst height = coordinate2size(w / 2, options.gridSize, options.gap);\n\t\t\tpointerOffset.top -= (width - height);\n\t\t\tpointerOffset.left -= (height - width);\n\t\t\treturn {\n\t\t\t\t...data,\n\t\t\t\tw: h,\n\t\t\t\th: w,\n\t\t\t\tflipped: !data.flipped\n\t\t\t}\n\t\t});\n\t\tmove();\n\t}\n\n</script>\n\n<svelte:window on:keydown={keydown}/>\n\n<div\n\tbind:this={itemRef}\n\tclass={classes}\n\ton:dblclick={doubleClick}\n\ton:dragover|preventDefault\n\ton:pointerdown={moveStart}\n\ton:pointerleave={hoverLeave}\n\ton:pointerover={hoverOver}\n\ton:touchstart={moveStart}\n\tstyle={style}\n>\n\t<slot/>\n</div>\n\n{#if active}\n\t<div style={ghostStyle} class={collisionClass}></div>\n\n\t{#if collisions.length}\n\t\t<div style={style} class={itemClass}></div>\n\t{/if}\n{/if}\n","<script>\n\n\timport { createEventDispatcher } from 'svelte';\n\timport { writable } from 'svelte/store';\n\timport { styleFromObject } from '../../../helpers/helpers';\n\timport { calcPosition } from './grid-utils.js';\n\timport GridItem from './GridItem.svelte';\n\n\texport let gridContainer = HTMLDivElement;\n\texport let items = [];\n\texport let dropGhost = false;\n\texport let options = {\n\t\tcols: null,\n\t\trows: null,\n\t\tenabledCols: null,\n\t\tenabledRows: null,\n\t\tgap: 10,\n\t\tgridSize: 50,\n\t\tcanOrganize: false,\n\t\tbackgroundGrid: false,\n\t\tclass: \"\",\n\t\tactiveClass: \"\",\n\t\tpreviewClass: \"\",\n\t\tcollisionClass: \"\",\n\t\tinvalidCollisionClass: \"\",\n\t\thoverClass: \"\",\n\t\thighlightClass: \"\",\n\t\thighlightItems: false\n\t}\n\n\tlet containerHeight = writable(0);\n\tlet containerWidth = writable(0);\n\n\tconst dispatch = createEventDispatcher();\n\n\tfunction itemChangeEvent(event) {\n\t\tdispatch('change', { ...event.detail });\n\t}\n\n\tfunction itemHoverEvent(event) {\n\t\tdispatch('hover', { ...event.detail });\n\t}\n\n\tfunction itemBeginDrag(event) {\n\t\tdispatch('itembegindrag', { ...event.detail });\n\t}\n\n\tfunction itemStopDrag(event) {\n\t\tdispatch('itemstopdrag', { ...event.detail });\n\t}\n\n\tfunction itemMove(event) {\n\t\tdispatch('itemmove', { ...event.detail });\n\t}\n\n\tfunction itemHoverLeaveEvent(event) {\n\t\tdispatch('leave', { ...event.detail });\n\t}\n\n\tfunction itemRightClickEvent(event) {\n\t\tdispatch('rightclick', { ...event.detail });\n\t}\n\n\tfunction itemDoubleClickEvent(event) {\n\t\tdispatch('doubleclick', { ...event.detail });\n\t}\n\n\tfunction itemFlippedEvent(event) {\n\t\tdispatch('itemflipped', { ...event.detail });\n\t}\n\n\t$: $containerWidth = options.cols * (options.gridSize + options.gap) + options.gap;\n\t$: $containerHeight = options.rows * (options.gridSize + options.gap) + options.gap;\n\n\t$: containerStyle = styleFromObject({\n\t\t\"width\": $containerWidth + \"px\",\n\t\t\"height\": $containerHeight + \"px\",\n\t});\n\n\tlet backgroundGridStyle = \"\";\n\t$: backgroundGridStyle = styleFromObject({\n\t\t\"grid-template-columns\": `repeat(${options.cols}, ${options.gridSize + options.gap / 2}px)`,\n\t\t\"grid-template-rows\": `repeat(${options.rows}, ${options.gridSize + options.gap / 2}px)`,\n\t\t\"gap\": `${options.gap / 2}px`,\n\t\t\"top\": `${options.gap / 2}px`\n\t});\n\n</script>\n\n<div class=item-piles-grid-container>\n\n\t<div\n\t\tbind:this={gridContainer}\n\t\tclass=\"item-piles-grid {options.class}\"\n\t\tstyle={containerStyle}\n\t>\n\t\t{#if dropGhost && dropGhost?.active}\n\t\t\t{@const dropElem = calcPosition(dropGhost, options)}\n\t\t\t<div\n\t\t\t\tstyle={`position: absolute; left:${dropElem.left}px; top:${dropElem.top}px;\n        width: ${dropElem.width}px; height: ${dropElem.height}px;`}\n\t\t\t\tclass={options.previewClass}\n\t\t\t/>\n\t\t{/if}\n\t\t{#each items as item (item.id)}\n\t\t\t<GridItem\n\t\t\t\tbind:item={item}\n\t\t\t\tbind:items={items}\n\t\t\t\tbind:options={options}\n\t\t\t\t{gridContainer}\n\t\t\t\ton:itemdoubleclick={itemDoubleClickEvent}\n\t\t\t\ton:itemchange={itemChangeEvent}\n\t\t\t\ton:itemhover={itemHoverEvent}\n\t\t\t\ton:itembegindrag={itemBeginDrag}\n\t\t\t\ton:itemstopdrag={itemStopDrag}\n\t\t\t\ton:itemmove={itemMove}\n\t\t\t\ton:itemhoverleave={itemHoverLeaveEvent}\n\t\t\t\ton:itemrightclick={itemRightClickEvent}\n\t\t\t\ton:itemflipped={itemFlippedEvent}\n\t\t\t>\n\t\t\t\t<slot {item}/>\n\t\t\t</GridItem>\n\t\t{/each}\n\t</div>\n\n\t{#if options.backgroundGrid}\n\n\t\t<div class=\"item-piles-inner-grid\" style={backgroundGridStyle}>\n\t\t\t{#each Array(options.rows) as _, rowIndex (rowIndex)}\n\t\t\t\t{#each Array(options.cols) as _, colIndex (colIndex)}\n\t\t\t\t\t<div class:grid-disabled={colIndex >= options.enabledCols || rowIndex >= options.enabledRows}\n\t\t\t\t\t     style=\"width: {options.gridSize + (options.gap/2)}px; height: {options.gridSize + (options.gap/2)}\">\n\t\t\t\t\t\t<!--{colIndex} {rowIndex}-->\n\t\t\t\t\t</div>\n\t\t\t\t{/each}\n\t\t\t{/each}\n\t\t</div>\n\n\t{/if}\n\n</div>\n\n<style lang=\"scss\">\n\n  .item-piles-grid-container {\n    position: relative;\n    display: flex;\n    justify-content: center;\n  }\n\n  .item-piles-grid {\n    position: relative !important;\n    margin: -2px;\n  }\n\n  .item-piles-inner-grid {\n    display: grid;\n    border-radius: 0.25rem;\n    position: absolute;\n    margin: -1px;\n    pointer-events: none;\n\t  z-index: -1;\n\t  /*color: red;*/\n\n    > div {\n      border-radius: 0.25rem;\n      border: 1px solid rgba(0, 0, 0, 0.25);\n\n      &.grid-disabled {\n        background-color: rgba(0, 0, 0, 0.25);\n      }\n    }\n  }\n\n</style>\n","<script>\n\n\timport CONSTANTS from \"../../constants/constants.js\";\n\timport * as Helpers from \"../../helpers/helpers.js\";\n\timport { getContext, onMount } from \"svelte\";\n\timport { coordinate2size } from \"../components/Grid/grid-utils.js\";\n\n\texport let entry;\n\n\tconst store = getContext(\"store\");\n\tconst gridDataStore = store.gridData;\n\n\t$: gridData = $gridDataStore;\n\n\tconst item = entry.item;\n\tconst doc = item.itemDocument;\n\tconst name = item.name;\n\tconst img = item.img;\n\tconst flagData = item.itemFlagData;\n\tconst quantity = item.quantity;\n\tconst canStack = item.canStack;\n\tconst style = item.style;\n\tconst transform = entry.transform;\n\tlet containerStyle = \"\";\n\n\t$: styling = Helpers.styleFromObject($style);\n\t$: displayImage = ($flagData.flipped ? $flagData.vaultImageFlipped || $flagData.vaultImage : $flagData.vaultImage) || $img;\n\t$: imageChanged($flagData, $transform);\n\t$: {\n\t\t$doc;\n\t\tcallRenderedHook();\n\t}\n\n\tfunction imageChanged(flagData, transform) {\n\t\tif (!flagData.vaultImageFlipped) {\n\t\t\tgetImageDimensions(transform)\n\t\t} else {\n\t\t\tcontainerStyle = \"\"\n\t\t}\n\t}\n\n\tfunction getImageDimensions(transform) {\n\t\tlet { w, h, flipped } = transform;\n\t\tconst width = coordinate2size(!flipped ? w : h, gridData.gridSize, gridData.gap);\n\t\tconst height = coordinate2size(!flipped ? h : w, gridData.gridSize, gridData.gap);\n\t\tcontainerStyle = `transform: rotate(${flipped ? \"90deg\" : \"0deg\"}); min-width: ${width}px; max-width: ${width}px; min-height: ${height}px; max-height: ${height}px;`;\n\t}\n\n\tlet element = false;\n\n\tfunction callRenderedHook() {\n\t\tif (!element) return;\n\t\tHooks.callAll(CONSTANTS.HOOKS.RENDER_VAULT_GRID_ITEM, element, item.item);\n\t}\n\n\tonMount(() => {\n\t\tcallRenderedHook();\n\t});\n\n</script>\n\n<div bind:this={element}\n     class=\"grid-item\"\n     data-fast-tooltip={$name} data-fast-tooltip-activation-speed=\"0\"\n     data-fast-tooltip-deactivation-speed=\"0\"\n>\n\t{#if displayImage}\n\t\t<div class=\"grid-item-image-container\" style={containerStyle}>\n\t\t\t<img class=\"grid-item-image\" src={displayImage}/>\n\t\t</div>\n\t{/if}\n\t{#if styling}\n\t\t<div class=\"grid-item-ghost\" style={styling}></div>\n\t{/if}\n\t{#if canStack && $quantity > 1}\n\t\t<span class=\"grid-item-quantity\">{$quantity}</span>\n\t{/if}\n</div>\n\n<style lang=\"scss\">\n\n  .grid-item {\n    width: 100%;\n    height: 100%;\n    border-radius: 0.25rem;\n    position: relative;\n\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    overflow: hidden;\n    border: 1px solid black;\n\n    .grid-item-image {\n      position: absolute;\n      flex-shrink: 0;\n      border: 0;\n      object-fit: cover;\n      width: 100%;\n      min-height: 100%;\n    }\n\n    .grid-item-image-container {\n      width: 100%;\n      height: 100%;\n      align-items: center;\n      display: flex;\n    }\n\n    .grid-item-quantity {\n      position: absolute;\n      bottom: 0;\n      right: 3px;\n      text-align: right;\n      color: white;\n      text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;\n      pointer-events: none;\n    }\n\n    .grid-item-ghost {\n      position: absolute;\n      width: 100%;\n      height: 100%;\n    }\n  }\n\n</style>\n","import ItemPileStore from \"./item-pile-store.js\";\nimport { get, writable } from \"svelte/store\";\nimport CONSTANTS from \"../constants/constants.js\";\nimport { PileItem } from \"./pile-item.js\";\nimport * as Utilities from \"../helpers/utilities.js\";\nimport PrivateAPI from \"../API/private-api.js\";\nimport ItemPileSocket from \"../socket.js\";\nimport DropItemDialog from \"../applications/dialogs/drop-item-dialog/drop-item-dialog.js\";\nimport { TJSDialog } from \"#runtime/svelte/application\";\nimport CustomDialog from \"../applications/components/CustomDialog.svelte\";\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\nimport * as helpers from \"../helpers/helpers.js\";\nimport * as Helpers from \"../helpers/helpers.js\";\nimport { SYSTEMS } from \"../systems.js\";\nimport { isItemValidBasedOnProperties } from \"../helpers/pile-utilities.js\";\n\nexport class VaultStore extends ItemPileStore {\n\n\tconstructor(...args) {\n\t\tsuper(...args);\n\t\tthis.gridData = writable({});\n\t\tthis.gridItems = writable([]);\n\t\tthis.validGridItems = writable([]);\n\t\tthis.canDepositCurrency = writable(false);\n\t\tthis.canWithdrawCurrency = writable(false);\n\t\tthis.logSearch = writable(\"\");\n\t\tthis.vaultLog = writable([]);\n\t\tthis.visibleLogItems = writable(18);\n\t\tthis.highlightedGridItems = writable([]);\n\t\tthis.vaultExpanderItems = writable([]);\n\t\tthis.dragPosition = writable({ x: 0, y: 0, w: 1, h: 1, active: false, flipped: false });\n\t\tthis.mainContainer = false;\n\t}\n\n\tget searchDelay() {\n\t\treturn 50;\n\t}\n\n\tget ItemClass() {\n\t\treturn VaultItem;\n\t}\n\n\tsetupStores(reset = false) {\n\t\tsuper.setupStores(reset);\n\t\tthis.gridData.set({});\n\t\tthis.gridItems.set([]);\n\t\tthis.validGridItems.set([]);\n\t\tthis.logSearch.set(\"\");\n\t\tthis.vaultLog.set([]);\n\t\tthis.visibleLogItems.set(18);\n\t\tthis.highlightedGridItems.set([]);\n\t\tthis.vaultExpanderItems.set([]);\n\t\tthis.dragPosition.set({ x: 0, y: 0, w: 1, h: 1, active: false, flipped: false });\n\n\t\tthis.refreshGridDebounce = foundry.utils.debounce(() => {\n\t\t\tthis.refreshGrid();\n\t\t}, this.searchDelay);\n\t}\n\n\tsetupSubscriptions() {\n\t\tsuper.setupSubscriptions();\n\t\tthis.subscribeTo(this.pileData, () => {\n\t\t\tthis.refreshAppSize();\n\t\t\tthis.refreshGridDebounce();\n\t\t\tthis.processLogEntries();\n\t\t});\n\n\t\tthis.subscribeTo(this.document, () => {\n\t\t\tconst updateData = this.document.updateOptions;\n\t\t\tconst renderData = updateData?.renderData ?? updateData?.data ?? {};\n\t\t\tif (foundry.utils.hasProperty(renderData, CONSTANTS.FLAGS.LOG)) {\n\t\t\t\tthis.processLogEntries();\n\t\t\t}\n\t\t});\n\n\t\tthis.subscribeTo(this.logSearch, this.filterLogEntries.bind(this));\n\n\t\tthis.refreshGrid();\n\t\tthis.processLogEntries();\n\t}\n\n\tprocessLogEntries() {\n\n\t\tconst pileData = get(this.pileData);\n\t\tconst logEntries = PileUtilities.getActorLog(this.actor);\n\n\t\tlogEntries.map(log => {\n\n\t\t\tlet instigator = log.actor || \"Unknown character\";\n\t\t\tif (pileData.vaultLogType === \"user_actor\") {\n\t\t\t\tinstigator = game.i18n.format(\"ITEM-PILES.Vault.LogUserActor\", {\n\t\t\t\t\tactor_name: log.actor || \"Unknown character\", user_name: game.users.get(log.user)?.name ?? \"unknown user\",\n\t\t\t\t})\n\t\t\t} else if (pileData.vaultLogType === \"user\") {\n\t\t\t\tinstigator = game.users.get(log.user)?.name ?? \"unknown user\";\n\t\t\t}\n\n\t\t\tconst quantity = Math.abs(log.qty) > 1 ? game.i18n.format(\"ITEM-PILES.Vault.LogQuantity\", { quantity: Math.abs(log.qty) }) : \"\";\n\n\t\t\tif (!log.action) {\n\t\t\t\tlog.action = log.qty > 0 ? \"deposited\" : \"withdrew\";\n\t\t\t}\n\n\t\t\tconst action = log.action === \"withdrew\" || log.action === \"deposited\" ? game.i18n.localize(\"ITEM-PILES.Vault.\" + (log.action.slice(0, 1).toUpperCase() + log.action.slice(1))) : log.action;\n\n\t\t\tlog.text = game.i18n.format(\"ITEM-PILES.Vault.LogEntry\", {\n\t\t\t\tinstigator, action: `<span>${action}</span>`, quantity: quantity, item_name: `<strong>${log.name}</strong>`,\n\t\t\t})\n\t\t\tlog.visible = true;\n\n\t\t});\n\n\t\tthis.vaultLog.set(logEntries);\n\n\t\tthis.filterLogEntries()\n\n\t}\n\n\tfilterLogEntries() {\n\t\tconst search = get(this.logSearch).toLowerCase();\n\t\tconst regex = new RegExp(search, \"g\");\n\t\tthis.vaultLog.update((logs) => {\n\t\t\tfor (let log of logs) {\n\t\t\t\tlog.visible = log.text.toLowerCase().search(regex) !== -1;\n\t\t\t}\n\t\t\treturn logs;\n\t\t})\n\t}\n\n\trefreshFreeSpaces() {\n\t\tconst pileData = get(this.pileData);\n\t\tthis.gridData.update(() => {\n\n\t\t\tconst access = PileUtilities.getVaultAccess(this.actor, {\n\t\t\t\tflagData: pileData, hasRecipient: !!this.recipient\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\t...PileUtilities.getVaultGridData(this.actor, { flagData: pileData }), ...access,\n\t\t\t\tcanEditCurrencies: game.user.isGM,\n\t\t\t\tfullAccess: game.user.isGM || Object.values(access).every(Boolean),\n\t\t\t\tgridSize: 40,\n\t\t\t\tgap: 4\n\t\t\t}\n\t\t})\n\t}\n\n\tcanItemsFitWithout(itemToCompare) {\n\n\t\tconst pileData = get(this.pileData);\n\t\tconst items = get(this.validGridItems);\n\t\tconst vaultExpanders = get(this.vaultExpanderItems);\n\n\t\tconst expansions = vaultExpanders.reduce((acc, item) => {\n\t\t\tif (item === itemToCompare) return acc;\n\t\t\tacc.cols += get(item.itemFlagData).addsCols * get(item.quantity);\n\t\t\tacc.rows += get(item.itemFlagData).addsRows * get(item.quantity);\n\t\t\treturn acc;\n\t\t}, {\n\t\t\tcols: pileData.baseExpansionCols ?? 0, rows: pileData.baseExpansionRows ?? 0\n\t\t});\n\n\t\tconst enabledCols = Math.min(pileData.cols, expansions.cols);\n\t\tconst enabledRows = Math.min(pileData.rows, expansions.rows);\n\n\t\tconst enabledSpaces = enabledCols * enabledRows;\n\n\t\treturn enabledSpaces - items.length;\n\n\t}\n\n\tupdateGrid(items) {\n\n\t\tif (!items.length) return;\n\n\t\tconst itemsToUpdate = items.map(item => {\n\t\t\tconst transform = get(item.transform);\n\t\t\treturn {\n\t\t\t\t_id: item.id,\n\t\t\t\t[CONSTANTS.FLAGS.ITEM + \".x\"]: transform.x,\n\t\t\t\t[CONSTANTS.FLAGS.ITEM + \".y\"]: transform.y,\n\t\t\t\t[CONSTANTS.FLAGS.ITEM + \".flipped\"]: transform.flipped,\n\t\t\t}\n\t\t});\n\n\t\thelpers.debug(\"itemsToUpdate\", itemsToUpdate);\n\n\t\tconst actorUuid = Utilities.getUuid(this.actor);\n\t\tif (this.actor.isOwner) {\n\t\t\treturn PrivateAPI._commitDocumentChanges(actorUuid, {\n\t\t\t\titemsToUpdate,\n\t\t\t});\n\t\t}\n\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.COMMIT_DOCUMENT_CHANGES, actorUuid, {\n\t\t\titemsToUpdate,\n\t\t});\n\t}\n\n\trefreshItems() {\n\t\tsuper.refreshItems();\n\t\tconst pileData = get(this.pileData);\n\t\tthis.validGridItems.set(get(this.allItems).filter(entry => {\n\t\t\tconst itemFlagData = get(entry.itemFlagData);\n\t\t\treturn (!pileData.vaultExpansion || !itemFlagData.vaultExpander) && !entry.isCurrency;\n\t\t}));\n\t\tthis.highlightedGridItems.set(get(this.items).filter(entry => {\n\t\t\tconst itemFlagData = get(entry.itemFlagData);\n\t\t\treturn !pileData.vaultExpansion || !itemFlagData.vaultExpander;\n\t\t}).map(item => item.id));\n\t\tthis.vaultExpanderItems.set(get(this.allItems).filter(entry => {\n\t\t\tconst itemFlagData = get(entry.itemFlagData);\n\t\t\treturn !pileData.vaultExpansion || itemFlagData.vaultExpander;\n\t\t}));\n\t\tthis.refreshGridDebounce();\n\t}\n\n\tcreateItem(...args) {\n\t\tsuper.createItem(...args);\n\t\tthis.refreshGrid();\n\t}\n\n\tdeleteItem(...args) {\n\t\tsuper.deleteItem(...args);\n\t\tthis.refreshGrid();\n\t}\n\n\trefreshGrid() {\n\t\tthis.refreshFreeSpaces();\n\t\tthis.gridItems.set(this.placeItemsOnGrid());\n\t}\n\n\tplaceItemsOnGrid() {\n\t\tconst search = get(this.search)\n\t\tconst highlightedItems = get(this.highlightedGridItems);\n\t\tconst gridData = get(this.gridData);\n\t\tconst allItems = [...get(this.validGridItems)];\n\t\tconst existingItems = [];\n\t\tconst invalidItems = [];\n\n\t\tconst grid = Array.from(Array(gridData.enabledCols).keys()).map((_, x) => {\n\t\t\treturn Array.from(Array(gridData.enabledRows).keys()).map((_, y) => {\n\t\t\t\treturn null;\n\t\t\t});\n\t\t});\n\n\t\titemLoop:\n\t\t\tfor (const item of allItems) {\n\n\t\t\t\tfor (let w = 0; w < item.w; w++) {\n\t\t\t\t\tconst x = Math.max(0, Math.min(item.x + w, gridData.enabledCols - 1));\n\t\t\t\t\tfor (let h = 0; h < item.h; h++) {\n\t\t\t\t\t\tconst y = Math.max(0, Math.min(item.y + h, gridData.enabledRows - 1));\n\t\t\t\t\t\tif (grid[x][y]) {\n\t\t\t\t\t\t\tinvalidItems.push(item);\n\t\t\t\t\t\t\tcontinue itemLoop;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor (let w = 0; w < item.w; w++) {\n\t\t\t\t\tconst x = Math.max(0, Math.min(item.x + w, gridData.enabledCols - 1));\n\t\t\t\t\tfor (let h = 0; h < item.h; h++) {\n\t\t\t\t\t\tconst y = Math.max(0, Math.min(item.y + h, gridData.enabledRows - 1));\n\t\t\t\t\t\tgrid[x][y] = item.id;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\texistingItems.push({\n\t\t\t\t\tid: item.id,\n\t\t\t\t\tactive: item.active,\n\t\t\t\t\ttransform: item.transform,\n\t\t\t\t\tghostTransform: item.ghostTransform,\n\t\t\t\t\thighlight: search && highlightedItems.includes(item.id),\n\t\t\t\t\titem,\n\t\t\t\t});\n\n\t\t\t}\n\n\t\thelpers.debug(\"grid\", grid);\n\t\thelpers.debug(\"existingItems\", existingItems);\n\t\thelpers.debug(\"allItems\", allItems);\n\t\thelpers.debug(\"invalidItems\", invalidItems);\n\n\t\tconst itemsToUpdate = invalidItems\n\t\t\t.map(item => {\n\n\t\t\t\tlet freeCells = [];\n\t\t\t\tfor (let x = 0; x < gridData.enabledCols; x++) {\n\t\t\t\t\tfor (let y = 0; y < gridData.enabledRows; y++) {\n\t\t\t\t\t\tif (grid[x][y]) continue;\n\t\t\t\t\t\tfreeCells.push({ x, y });\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst position = PileUtilities.getNewItemsVaultPosition(item.item, { ...gridData, grid, freeCells });\n\t\t\t\tif (!position) return false;\n\t\t\t\tconst itemFlagData = get(item.itemFlagData);\n\t\t\t\tlet { width, height } = PileUtilities.getVaultItemDimensions(item.item, itemFlagData);\n\t\t\t\tfor (let w = 0; w < width; w++) {\n\t\t\t\t\tconst x = Math.max(0, Math.min(position.x + w, gridData.enabledCols - 1));\n\t\t\t\t\tfor (let h = 0; h < height; h++) {\n\t\t\t\t\t\tconst y = Math.max(0, Math.min(position.y + h, gridData.enabledRows - 1));\n\t\t\t\t\t\tgrid[x][y] = item.id;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\titem.transform.update(trans => {\n\t\t\t\t\ttrans.x = position.x;\n\t\t\t\t\ttrans.y = position.y;\n\t\t\t\t\ttrans.flipped = position.flipped;\n\t\t\t\t\treturn trans;\n\t\t\t\t});\n\t\t\t\treturn {\n\t\t\t\t\tid: item.id,\n\t\t\t\t\tactive: item.active,\n\t\t\t\t\ttransform: item.transform,\n\t\t\t\t\tghostTransform: item.ghostTransform,\n\t\t\t\t\thighlight: search && highlightedItems.includes(item.id),\n\t\t\t\t\titem\n\t\t\t\t};\n\t\t\t})\n\t\t\t.filter(Boolean)\n\n\t\tthis.updateGrid(itemsToUpdate)\n\n\t\treturn itemsToUpdate.concat(existingItems);\n\n\t}\n\n\trefreshAppSize() {\n\t\tif (!this.mainContainer) return;\n\t\tconst oldHeight = this.mainContainer.getBoundingClientRect().height;\n\t\tsetTimeout(() => {\n\t\t\tconst newHeight = this.mainContainer.getBoundingClientRect().height - oldHeight;\n\t\t\tthis.application.position.stores.height.update((height) => {\n\t\t\t\treturn height + newHeight;\n\t\t\t});\n\t\t}, 10);\n\t}\n\n\tasync onDropData(data, event, isExpander) {\n\n\t\tlet validPosition = get(this.dragPosition);\n\t\tthis.dragPosition.set({ x: 0, y: 0, w: 1, h: 1, flipped: false, active: false });\n\n\t\tif (data.type === \"Actor\" && game.user.isGM) {\n\t\t\tconst newRecipient = data.uuid ? (await fromUuid(data.uuid)) : game.actors.get(data.id);\n\t\t\tthis.refreshAppSize();\n\t\t\tthis.updateRecipient(newRecipient);\n\t\t\tthis.refreshFreeSpaces();\n\t\t\treturn;\n\t\t}\n\n\t\tif (data.type !== \"Item\") {\n\t\t\tHelpers.custom_warning(game.i18n.format(\"ITEM-PILES.Warnings.DroppedIsNotItem\", { type: data.type }), true)\n\t\t\treturn false;\n\t\t}\n\n\t\tconst item = await Item.implementation.fromDropData(data);\n\n\t\tconst itemData = item.toObject();\n\n\t\tif (!itemData) {\n\t\t\tconsole.error(data);\n\t\t\tthrow Helpers.custom_error(\"Something went wrong when dropping this item!\")\n\t\t}\n\n\t\tif (!isItemValidBasedOnProperties(this.actor, itemData) && !game.user.isGM) {\n\t\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.VaultInvalidItemDropped\"), true)\n\t\t\treturn false;\n\t\t}\n\n\t\tconst source = (data.uuid ? fromUuidSync(data.uuid) : false)?.parent ?? false;\n\t\tconst target = this.actor;\n\n\t\tif (source === target) {\n\t\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.VaultSameItemOrigin\"), true)\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!source && !game.user.isGM) {\n\t\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.VaultNoGmItemSidebar\"), true)\n\t\t\treturn false;\n\t\t}\n\n\t\tconst vaultExpander = foundry.utils.getProperty(itemData, CONSTANTS.FLAGS.ITEM + \".vaultExpander\");\n\n\t\tif (isExpander && !vaultExpander) {\n\t\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.VaultItemNotExpander\"), true)\n\t\t\treturn false;\n\t\t}\n\n\t\tconst similarItem = this.getSimilarItem(itemData);\n\t\tif (!vaultExpander) {\n\t\t\tif (!similarItem || !PileUtilities.canItemStack(item, this.actor)) {\n\t\t\t\tvalidPosition = PileUtilities.canItemFitInVault(itemData, this.actor, { position: validPosition });\n\t\t\t\tif (!validPosition) {\n\t\t\t\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.VaultFull\"), true)\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfoundry.utils.setProperty(itemData, CONSTANTS.FLAGS.ITEM + \".x\", validPosition.x);\n\t\tfoundry.utils.setProperty(itemData, CONSTANTS.FLAGS.ITEM + \".y\", validPosition.y);\n\t\tfoundry.utils.setProperty(itemData, CONSTANTS.FLAGS.ITEM + \".flipped\", validPosition.flipped);\n\n\t\treturn PrivateAPI._depositWithdrawItem({\n\t\t\tsource, target, itemData: {\n\t\t\t\titem: itemData,\n\t\t\t}, gridPosition: validPosition\n\t\t});\n\n\t}\n\n\tasync sortItemsOnGrid(event) {\n\n\t\tconst mergeItems = event.ctrlKey;\n\n\t\tif (mergeItems) {\n\t\t\tconst doMerge = await TJSDialog.confirm({\n\t\t\t\ttitle: \"Item Piles\",\n\t\t\t\tcontent: {\n\t\t\t\t\tclass: CustomDialog,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\theader: game.i18n.localize(\"ITEM-PILES.Dialogs.SortMergeVaultItems.Title\"),\n\t\t\t\t\t\tcontent: game.i18n.localize(\"ITEM-PILES.Dialogs.SortMergeVaultItems.Content\")\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tmodal: true\n\t\t\t});\n\t\t\tif (!doMerge) return;\n\t\t}\n\n\t\tconst gridItems = get(this.gridItems).map(item => item.item).sort((a, b) => {\n\t\t\treturn b.size - a.size;\n\t\t});\n\n\t\tconst items = gridItems.map(item => item.item);\n\n\t\tconst result = PileUtilities.fitItemsIntoVault(items, this.actor, { existingItems: [], mergeItems });\n\n\t\tif (!result) return Helpers.custom_warning(\"ITEM-PILES.Warnings.CantSortVault\", true);\n\n\t\tconst { updates, deletions } = result;\n\n\t\tconst itemUpdates = updates.map(item => ({\n\t\t\t_id: item._id,\n\t\t\t[game.itempiles.API.ITEM_QUANTITY_ATTRIBUTE]: Utilities.getItemQuantity(item),\n\t\t\t[CONSTANTS.FLAGS.ITEM]: PileUtilities.cleanItemFlagData(PileUtilities.getItemFlagData(item))\n\t\t}));\n\n\t\tfor (const gridItem of gridItems) {\n\t\t\tconst update = updates.find(item => item._id === gridItem.id);\n\t\t\tif (!gridItem) continue;\n\t\t\tconst flagData = PileUtilities.getItemFlagData(update);\n\t\t\tgridItem.transform.update(val => {\n\t\t\t\tval.x = flagData.x;\n\t\t\t\tval.y = flagData.y;\n\t\t\t\tval.flipped = flagData.flipped;\n\t\t\t\treturn val;\n\t\t\t});\n\t\t}\n\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.COMMIT_DOCUMENT_CHANGES, this.actor.uuid, {\n\t\t\titemsToUpdate: itemUpdates,\n\t\t\titemsToDelete: deletions\n\t\t});\n\n\t}\n\n}\n\nexport class VaultItem extends PileItem {\n\n\tsetupStores(...args) {\n\t\tsuper.setupStores(...args);\n\t\tthis.transform = writable({\n\t\t\tx: 0, y: 0, w: 1, h: 1, flipped: false\n\t\t});\n\t\tthis.ghostTransform = writable({\n\t\t\tx: 0, y: 0, w: 1, h: 1, flipped: false\n\t\t});\n\t\tthis.active = writable(false);\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t\tthis.w = 1;\n\t\tthis.h = 1;\n\t\tthis.flipped = false;\n\t\tthis.size = 1;\n\t\tthis.style = writable({});\n\t}\n\n\tsetupSubscriptions() {\n\t\tsuper.setupSubscriptions();\n\t\tlet setup = false;\n\t\tthis.subscribeTo(this.itemDocument, () => {\n\t\t\tlet rarityColor = get(this.rarityColor);\n\t\t\tif (rarityColor) {\n\t\t\t\tthis.style.set({ \"box-shadow\": `inset 0px 0px 7px 0px ${rarityColor}` });\n\t\t\t} else {\n\t\t\t\tthis.style.set(SYSTEMS.DATA?.VAULT_STYLES ? SYSTEMS.DATA?.VAULT_STYLES.filter(style => {\n\t\t\t\t\treturn foundry.utils.getProperty(this.item, style.path) === style.value;\n\t\t\t\t}).reduce((acc, style) => {\n\t\t\t\t\treturn foundry.utils.mergeObject(acc, style.styling);\n\t\t\t\t}, {}) : {});\n\t\t\t}\n\t\t});\n\t\tthis.subscribeTo(this.itemFlagData, (data) => {\n\t\t\tif (setup) {\n\t\t\t\thelpers.debug(\"itemFlagData\", data);\n\t\t\t}\n\t\t\tconst { width, height } = PileUtilities.getVaultItemDimensions(this.item, data);\n\t\t\tthis.transform.set({\n\t\t\t\tx: data.x, y: data.y, w: width, h: height, flipped: data.flipped ?? false\n\t\t\t});\n\t\t\tthis.size = Math.max(width, height);\n\t\t});\n\t\tthis.subscribeTo(this.transform, (transform) => {\n\t\t\tif (setup) {\n\t\t\t\thelpers.debug(\"transform\", transform);\n\t\t\t}\n\t\t\tthis.x = transform.x;\n\t\t\tthis.y = transform.y;\n\t\t\tthis.w = transform.w;\n\t\t\tthis.h = transform.h;\n\t\t\tthis.flipped = transform.flipped;\n\t\t});\n\t\tthis.subscribeTo(this.quantity, () => {\n\t\t\tconst itemFlagData = get(this.itemFlagData);\n\t\t\tif (!itemFlagData.vaultExpander) return;\n\t\t\tthis.store.refreshFreeSpaces();\n\t\t\tthis.store.refreshGridDebounce();\n\t\t})\n\t\tsetup = true;\n\t}\n\n\tasync take() {\n\n\t\tconst pileData = get(this.store.pileData);\n\t\tconst itemFlagData = get(this.itemFlagData);\n\n\t\tif (pileData.vaultExpansion && itemFlagData.vaultExpander) {\n\t\t\tconst slotsLeft = this.store.canItemsFitWithout(this);\n\t\t\tif (slotsLeft < 0) {\n\t\t\t\treturn TJSDialog.prompt({\n\t\t\t\t\ttitle: \"Item Piles\", content: {\n\t\t\t\t\t\tclass: CustomDialog, props: {\n\t\t\t\t\t\t\theader: game.i18n.localize(\"ITEM-PILES.Dialogs.CantRemoveVaultExpander.Title\"),\n\t\t\t\t\t\t\tcontent: game.i18n.format(\"ITEM-PILES.Dialogs.CantRemoveVaultExpander.Content\", {\n\t\t\t\t\t\t\t\tnum_items: Math.abs(slotsLeft)\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t}, modal: true\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tlet quantity = get(this.quantity);\n\t\tif (quantity > 1) {\n\t\t\tquantity = await DropItemDialog.show(this.item, this.store.actor, {\n\t\t\t\tlocalizationTitle: \"WithdrawItem\"\n\t\t\t});\n\t\t}\n\t\treturn game.itempiles.API.transferItems(this.store.actor, this.store.recipient, [{\n\t\t\t_id: this.id, quantity\n\t\t}], { interactionId: this.store.interactionId });\n\t}\n\n\tasync split(x, y, flipped) {\n\n\t\tlet quantity = await DropItemDialog.show(this.item, this.store.actor, {\n\t\t\tlocalizationTitle: \"SplitItem\", quantityAdjustment: -1\n\t\t});\n\n\t\tawait game.itempiles.API.removeItems(this.store.actor, [{\n\t\t\t_id: this.id, quantity\n\t\t}], { interactionId: this.store.interactionId });\n\n\t\tconst itemData = this.item.toObject();\n\n\t\tconst flags = PileUtilities.getItemFlagData(this.item);\n\t\titemData._id = foundry.utils.randomID();\n\t\tfoundry.utils.setProperty(flags, \"x\", x);\n\t\tfoundry.utils.setProperty(flags, \"y\", y);\n\t\tfoundry.utils.setProperty(flags, \"flipped\", flipped);\n\t\tfoundry.utils.setProperty(itemData, CONSTANTS.FLAGS.ITEM, flags);\n\n\t\tawait game.itempiles.API.addItems(this.store.actor, [{\n\t\t\titem: itemData, quantity\n\t\t}], { interactionId: this.store.interactionId, skipVaultLogging: true });\n\n\t}\n\n\tasync merge(itemToMerge) {\n\n\t\tconst itemDelta = await game.itempiles.API.removeItems(this.store.actor, [{\n\t\t\t_id: itemToMerge.id\n\t\t}], {\n\t\t\tinteractionId: this.store.interactionId, skipVaultLogging: true\n\t\t});\n\n\t\treturn game.itempiles.API.addItems(this.store.actor, [{\n\t\t\tid: this.id, quantity: Math.abs(itemDelta[0].quantity)\n\t\t}], {\n\t\t\tinteractionId: this.store.interactionId, skipVaultLogging: true\n\t\t})\n\n\t}\n\n\tareItemsSimilar(itemToCompare) {\n\t\treturn !Utilities.areItemsDifferent(this.item, itemToCompare.item) && PileUtilities.canItemStack(itemToCompare.item, this.store.actor);\n\t}\n\n}\n","<script>\r\n\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\r\n\texport let store;\r\n\texport let item;\r\n\r\n\tconst name = item.name;\r\n\tconst img = item.img;\r\n\tconst quantity = item.quantity;\r\n\tconst itemFlagData = item.itemFlagData;\r\n\tconst pileData = store.pileData;\r\n\r\n\tconst editQuantities = store.editQuantities;\r\n\r\n</script>\r\n\r\n<div class=\"item-piles-flexrow item-piles-item-row item-piles-even-color\">\r\n\r\n\t<div class=\"item-piles-img-container\">\r\n\t\t<img class=\"item-piles-img\" src=\"{$img}\"/>\r\n\t</div>\r\n\r\n\t<div class=\"item-piles-name\">\r\n\t\t<div class=\"item-piles-name-container\">\r\n\t\t\t<p>{$name}</p>\r\n\t\t\t{#if !$editQuantities && item.canStack}\r\n\t\t\t\t<span class=\"item-piles-small-text\">(x{$quantity})</span>\r\n\t\t\t{/if}\r\n\t\t\t<span class=\"item-piles-small-text\">\r\n        {($itemFlagData.addsCols ? localize(\"ITEM-PILES.Vault.ExpandsCols\", { cols: $itemFlagData.addsCols }) : \"\")\r\n        + ($itemFlagData.addsCols && $itemFlagData.addsRows ? \", \" : \"\") +\r\n        ($itemFlagData.addsRows ? localize(\"ITEM-PILES.Vault.ExpandsRows\", { rows: $itemFlagData.addsRows }) : \"\")}\r\n      </span>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t{#if !$editQuantities}\r\n\r\n\t\t<button\r\n\t\t\ton:click={() => { item.take() }}\r\n\t\t\tclass=\"item-piles-item-take-button\"\r\n\t\t\ttype=\"button\">\r\n\t\t\t{localize(\"ITEM-PILES.Inspect.Take\")}\r\n\t\t</button>\r\n\r\n\t{:else}\r\n\r\n\t\t<button\r\n\t\t\ton:click={() => { item.remove() }}\r\n\t\t\tclass=\"item-piles-item-take-button\"\r\n\t\t\ttype=\"button\">\r\n\t\t\t{localize(\"Remove\")}\r\n\t\t</button>\r\n\r\n\t{/if}\r\n\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-item-row .item-piles-name {\r\n    flex: 1 0 auto;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\r\n\timport { styleFromObject } from \"../../../helpers/helpers.js\";\r\n\timport { setContext } from \"svelte\";\r\n\r\n\texport let position;\r\n\texport let zIndex;\r\n\texport let style;\r\n\texport let context;\r\n\texport let component;\r\n\texport let componentData;\r\n\r\n\tfor(const [key, ctx] of Object.entries(context)){\r\n\t\tsetContext(key, ctx);\r\n\t}\r\n\r\n\t$: elementStyle = styleFromObject({\r\n\t\t\"left\": $position.x + \"px\",\r\n\t\t\"top\": $position.y + \"px\",\r\n\t\t\"z-index\": zIndex,\r\n\t\t...$style\r\n\t});\r\n\r\n</script>\r\n\r\n\r\n<div class=\"item-piles-floting-element\" style={elementStyle}>\r\n\t<svelte:component {...componentData} this={component}/>\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-floting-element {\r\n    position: fixed;\r\n    pointer-events: none;\r\n    color: red;\r\n  }\r\n\r\n</style>\r\n\r\n","import FloatingElementImpl from \"./FloatingElementImpl.svelte\";\r\nimport { writable } from \"svelte/store\";\r\n\r\nexport class FloatingElement {\r\n\r\n\tstatic id = void 0;\r\n\tstatic element = void 0;\r\n\tstatic positionStore = writable(false);\r\n\tstatic styleStore = writable({});\r\n\r\n\tstatic create({ id, x, y, zIndex = Number.MAX_SAFE_INTEGER - 100, style = {}, context = {}, component, componentData } = {}) {\r\n\r\n\t\tif (this.element) return this.element;\r\n\r\n\t\tthis.positionStore.set({ x, y })\r\n\t\tthis.styleStore.set(style);\r\n\t\tthis.id = id;\r\n\r\n\t\tthis.element = new FloatingElementImpl({\r\n\t\t\ttarget: document.body,\r\n\t\t\tprops: {\r\n\t\t\t\tposition: this.positionStore,\r\n\t\t\t\tstyle: this.styleStore,\r\n\t\t\t\tzIndex,\r\n\t\t\t\tcomponent,\r\n\t\t\t\tcomponentData,\r\n\t\t\t\tcontext\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tstatic destroy() {\r\n\t\tthis.element.$destroy();\r\n\t\tthis.element = void 0;\r\n\t\tthis.id = void 0;\r\n\t\tthis.positionStore.set(false);\r\n\t\tthis.styleStore.set({});\r\n\t}\r\n\r\n\r\n}\r\n","<script>\r\n\timport CONSTANTS from '../../constants/constants.js';\r\n\r\n\timport { getContext, onDestroy, setContext } from 'svelte';\r\n\timport { fade } from 'svelte/transition';\r\n\timport { ApplicationShell } from '#runtime/svelte/component/core';\r\n\timport { TJSContextMenu } from \"#standard/application\";\r\n\timport { get, writable } from 'svelte/store';\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\r\n\timport Grid from '../components/Grid/Grid.svelte';\r\n\timport CurrencyList from '../components/CurrencyList.svelte';\r\n\timport DropZone from '../components/DropZone.svelte';\r\n\timport VaultItemEntry from './VaultItemEntry.svelte';\r\n\r\n\timport { coordinate2size, snapOnMove } from '../components/Grid/grid-utils.js';\r\n\timport * as Helpers from \"../../helpers/helpers.js\";\r\n\timport { isCoordinateWithinPosition } from \"../../helpers/helpers.js\";\r\n\r\n\timport { VaultStore } from \"../../stores/vault-store.js\";\r\n\timport Tabs from \"../components/Tabs.svelte\";\r\n\timport VaultExpanderEntry from \"./VaultExpanderEntry.svelte\";\r\n\timport { FloatingElement } from \"../components/FloatingElement/FloatingElement.js\";\r\n\timport * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let elementRoot;\r\n\texport let actor;\r\n\texport let recipient;\r\n\r\n\texport let store = VaultStore.make(application, actor, recipient);\r\n\r\n\tsetContext(\"store\", store);\r\n\r\n\tconst currencies = store.allCurrencies;\r\n\tconst pileDataStore = store.pileData;\r\n\tconst gridDataStore = store.gridData;\r\n\tconst gridItems = store.gridItems;\r\n\tconst vaultExpanderItems = store.vaultExpanderItems;\r\n\tconst searchStore = store.search;\r\n\tconst logSearchStore = store.logSearch;\r\n\tconst vaultLog = store.vaultLog;\r\n\tconst visibleLogItems = store.visibleLogItems;\r\n\tconst recipientDocument = store.recipientDocument;\r\n\tconst dragPositionStore = store.dragPosition;\r\n\r\n\t$: pileData = $pileDataStore;\r\n\t$: gridData = $gridDataStore;\r\n\r\n\tconst floatingElementPositionStore = FloatingElement.positionStore;\r\n\tlet element;\r\n\r\n\tfunction onDragOverEvent(event) {\r\n\t\tonDragOver(event.clientX, event.clientY, true);\r\n\t}\r\n\r\n\t$: {\r\n\t\tif ($floatingElementPositionStore) {\r\n\t\t\tonDragOver($floatingElementPositionStore?.x + 20, $floatingElementPositionStore?.y + 20);\r\n\t\t} else {\r\n\t\t\tonDragLeave();\r\n\t\t}\r\n\t}\r\n\r\n\tasync function onDragOver(clientX, clientY, offset = false) {\r\n\t\tconst rect = element.getBoundingClientRect();\r\n\t\tif (FloatingElement.id === application.id || !isCoordinateWithinPosition(clientX, clientY, rect)) {\r\n\t\t\treturn onDragLeave();\r\n\t\t}\r\n\t\tdragPositionStore.update(data => {\r\n\t\t\tconst x = (clientX - rect.left) - (offset ? ((gridData.gridSize * data.w) / 2) : gridData.gridSize / 2); //x position within the element.\r\n\t\t\tconst y = (clientY - rect.top) - (offset ? ((gridData.gridSize * data.w) / 2) : gridData.gridSize / 2);  //y position within the element.\r\n\t\t\treturn {\r\n\t\t\t\t...data,\r\n\t\t\t\t...snapOnMove(x, y, { w: data.w, h: data.h }, { ...gridData }),\r\n\t\t\t\tactive: true\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n\tasync function onDragLeave() {\r\n\t\tdragPositionStore.update(data => {\r\n\t\t\treturn { ...data, active: false };\r\n\t\t});\r\n\t}\r\n\r\n\tconst dragHookId = Hooks.on(CONSTANTS.HOOKS.DRAG_DOCUMENT, async (dropData) => {\r\n\t\tif (dropData.type !== \"Item\") return;\r\n\t\tconst item = await Item.implementation.fromDropData(dropData);\r\n\t\tconst flags = PileUtilities.getItemFlagData(item);\r\n\t\tconst { width, height } = PileUtilities.getVaultItemDimensions(item, flags);\r\n\t\tdragPositionStore.update(data => {\r\n\t\t\treturn {\r\n\t\t\t\t...data,\r\n\t\t\t\tw: width,\r\n\t\t\t\th: height,\r\n\t\t\t\tflipped: flags.flipped\r\n\t\t\t}\r\n\t\t});\r\n\t})\r\n\tconst dropHookId = Hooks.on(CONSTANTS.HOOKS.DROP_DOCUMENT, () => {\r\n\t\tdragPositionStore.update(data => {\r\n\t\t\treturn {\r\n\t\t\t\t...data,\r\n\t\t\t\tw: 1,\r\n\t\t\t\th: 1,\r\n\t\t\t\tflipped: false\r\n\t\t\t}\r\n\t\t});\r\n\t})\r\n\r\n\tonDestroy(() => {\r\n\t\tstore.onDestroy();\r\n\t\tHooks.off(CONSTANTS.HOOKS.DRAG_DOCUMENT, dragHookId);\r\n\t\tHooks.off(CONSTANTS.HOOKS.DROP_DOCUMENT, dropHookId);\r\n\t});\r\n\r\n\tfunction doubleClickItem(event) {\r\n\t\tif (!gridData.canWithdrawItems) return;\r\n\t\tevent.detail.item.item.take();\r\n\t}\r\n\r\n\tfunction rightClickItem(event) {\r\n\t\tsetTimeout(() => {\r\n\r\n\t\t\tconst contextMenu = []\r\n\r\n\t\t\tif (gridData.canWithdrawItems) {\r\n\t\t\t\tcontextMenu.push({\r\n\t\t\t\t\ticon: 'fas fa-hand', label: \"Take\", onPress: () => {\r\n\t\t\t\t\t\tevent.detail.item.item.take();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tconst quantity = get(event.detail.item.item.quantity);\r\n\t\t\tconst freeSpacesAfterSplit = gridData.freeSpaces;\r\n\r\n\t\t\tif ((gridData.canDepositItems || game.user.isGM) && event.detail.item.item.canStack && quantity > 1 && freeSpacesAfterSplit) {\r\n\t\t\t\tcontextMenu.push({\r\n\t\t\t\t\ticon: 'fas fa-object-ungroup', label: \"Split\", onPress: () => {\r\n\t\t\t\t\t\tbeginSplitItem(event)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (pileData.canInspectItems || game.user.isGM) {\r\n\t\t\t\tcontextMenu.push({\r\n\t\t\t\t\ticon: 'fas fa-eye', label: \"Inspect\", onPress: () => {\r\n\t\t\t\t\t\tevent.detail.item.item.preview();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tHooks.call(CONSTANTS.HOOKS.PILE.PRE_RIGHT_CLICK_ITEM, event.detail.item.item.item, contextMenu, actor, store.recipient);\r\n\r\n\t\t\tif (!contextMenu.length) return;\r\n\r\n\t\t\tTJSContextMenu.create({\r\n\t\t\t\tx: event.detail.x,\r\n\t\t\t\ty: event.detail.y,\r\n\t\t\t\tzIndex: 1000000000000,\r\n\t\t\t\ttransitionOptions: { duration: 0 },\r\n\t\t\t\titems: contextMenu\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tfunction beginSplitItem(event) {\r\n\r\n\t\tconst { item, splitStart, x, y } = event.detail;\r\n\t\tconst { w, h } = item.item;\r\n\r\n\t\tFloatingElement.create({\r\n\t\t\tid: application.id,\r\n\t\t\tx,\r\n\t\t\ty,\r\n\t\t\tstyle: {\r\n\t\t\t\twidth: coordinate2size(w, gridData.gridSize, gridData.gap) + \"px\",\r\n\t\t\t\theight: coordinate2size(h, gridData.gridSize, gridData.gap) + \"px\",\r\n\t\t\t\topacity: 0.7\r\n\t\t\t},\r\n\t\t\tcomponent: VaultItemEntry,\r\n\t\t\tcomponentData: { entry: item },\r\n\t\t\tcontext: { store }\r\n\t\t});\r\n\r\n\t\tsplitStart({\r\n\t\t\tpageX: x,\r\n\t\t\tpageY: y,\r\n\t\t\toffsetX: Math.floor((gridData.gridSize * w) / 2),\r\n\t\t\toffsetY: Math.floor((gridData.gridSize * h) / 2)\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tfunction itemBeginDrag(event) {\r\n\t\tconst { x, y, item } = event.detail;\r\n\t\tconst { w, h } = item.item;\r\n\t\tFloatingElement.create({\r\n\t\t\tid: application.id,\r\n\t\t\tx,\r\n\t\t\ty,\r\n\t\t\tstyle: {\r\n\t\t\t\twidth: coordinate2size(w, gridData.gridSize, gridData.gap) + \"px\",\r\n\t\t\t\theight: coordinate2size(h, gridData.gridSize, gridData.gap) + \"px\",\r\n\t\t\t\topacity: 0.7,\r\n\t\t\t},\r\n\t\t\tcomponent: VaultItemEntry,\r\n\t\t\tcomponentData: { entry: item },\r\n\t\t\tcontext: { store }\r\n\t\t})\r\n\t\tHooks.callAll(CONSTANTS.HOOKS.DRAG_DOCUMENT, {\r\n\t\t\ttype: \"Item\",\r\n\t\t\tuuid: item.item.item.uuid\r\n\t\t})\r\n\t}\r\n\r\n\tfunction itemStopDrag(event) {\r\n\r\n\t\tif (!FloatingElement.id) return;\r\n\r\n\t\tFloatingElement.destroy();\r\n\r\n\t\tif (event.detail.cancelled) return;\r\n\r\n\t\tconst { item, outOfBounds, x, y, gridX, gridY, splitting } = event.detail;\r\n\r\n\t\tif (splitting) {\r\n\t\t\tif (outOfBounds) return;\r\n\t\t\titem.item.split(gridX, gridY);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!outOfBounds) return;\r\n\r\n\t\tconst hitApps = Object.values(ui.windows)\r\n\t\t\t.sort((a, b) => b.position.zIndex - a.position.zIndex)\r\n\t\t\t.filter(app => isCoordinateWithinPosition(x, y, app.element[0].getBoundingClientRect()));\r\n\r\n\t\tlet dropData = {\r\n\t\t\ttype: \"Item\",\r\n\t\t\tuuid: item.item.item.uuid\r\n\t\t}\r\n\r\n\t\tif (hitApps.length) {\r\n\t\t\tif (hitApps[0] === application) return;\r\n\t\t\tif (hitApps[0].actor) {\r\n\t\t\t\tdropData.target = hitApps[0].actor;\r\n\t\t\t}\r\n\t\t\tif (hitApps[0].onDropData) {\r\n\t\t\t\treturn hitApps[0].onDropData(dropData);\r\n\t\t\t}\r\n\t\t\tif (hitApps[0]._handleDroppedEntry) {\r\n\t\t\t\treturn hitApps[0]._handleDroppedEntry(document.elementFromPoint(x, y), dropData);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst position = Helpers.getCanvasMouse().getLocalPosition(canvas.app.stage);\r\n\t\tdropData.x = position.x;\r\n\t\tdropData.y = position.y;\r\n\r\n\t\tHooks.call(\"dropCanvasData\", canvas, dropData);\r\n\r\n\t}\r\n\r\n\tfunction itemMove(event) {\r\n\t\tif (!FloatingElement.id) return;\r\n\t\tconst { x, y } = event.detail;\r\n\t\tFloatingElement.positionStore.set({ x, y });\r\n\t}\r\n\r\n\tfunction itemFlipped(event) {\r\n\t\tif (!FloatingElement.id) return;\r\n\t\tconst item = event.detail.item.item;\r\n\t\tconst { flipped } = event.detail;\r\n\t\tconst rotation = item.flipped ? (flipped ? \"0deg\" : \"-90deg\") : (flipped ? \"90deg\" : \"0deg\");\r\n\t\tFloatingElement.styleStore.update(style => {\r\n\t\t\treturn foundry.utils.mergeObject(style, {\r\n\t\t\t\t\"transform\": `rotate(${rotation})`,\r\n\t\t\t\t\"transition\": \"transform 150ms\"\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tlet activeTab = writable(\"vault\");\r\n\r\n\tconst applicationHeight = application.position.stores.height;\r\n\tconst applicationWidth = application.position.stores.width;\r\n\tconst defaultWidth = get(application.position.stores.width);\r\n\r\n\t$: {\r\n\t\tif ($activeTab === \"vault\" && $applicationWidth) {\r\n\t\t\tapplication.position.stores.width.set(defaultWidth);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction keydown(event) {\r\n\t\tif (event.key !== \"r\") return;\r\n\t\tdragPositionStore.update(data => {\r\n\t\t\tconst { w, h } = data;\r\n\t\t\tif (data.active && w !== h) {\r\n\t\t\t\tdata.w = h;\r\n\t\t\t\tdata.h = w;\r\n\t\t\t\tdata.flipped = !data.flipped;\r\n\t\t\t}\r\n\t\t\treturn data;\r\n\t\t})\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<svelte:window on:keydown={keydown}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<main bind:this={store.mainContainer} class=\"item-piles-flexcol\" in:fade={{duration: 500}}>\r\n\r\n\t\t{#if gridData.fullAccess && (pileData.vaultExpansion || pileData.logVaultActions)}\r\n\t\t\t<Tabs bind:activeTab={$activeTab} tabs={[\r\n        {\r\n          value: \"vault\",\r\n          label: \"ITEM-PILES.Vault.VaultTab\",\r\n          icon: \"fas fa-vault\",\r\n        },\r\n        {\r\n          value: \"expanders\",\r\n          label: \"ITEM-PILES.Vault.ExpandersTab\",\r\n          icon: \"fas fa-maximize\",\r\n          hidden: !pileData.vaultExpansion || !gridData.fullAccess\r\n        },\r\n        {\r\n          value: \"log\",\r\n          label: \"ITEM-PILES.Vault.LogTab\",\r\n          icon: \"fas fa-note-sticky\",\r\n          hidden: !pileData.logVaultActions || !gridData.fullAccess\r\n        }\r\n      ]} style=\"flex: 0 1 auto; margin-bottom: 0.5rem; padding-bottom: 0.5rem;\"/>\r\n\t\t{/if}\r\n\r\n\t\t{#if $activeTab === \"vault\"}\r\n\r\n\t\t\t<div class=\"form-group item-piles-flexrow item-piles-bottom-divider\"\r\n\t\t\t     style=\"margin: 0.25rem 0; align-items: center; flex: 0 1 auto;\">\r\n\t\t\t\t<label style=\"flex:0 1 auto; margin-right: 5px;\">Search:</label>\r\n\t\t\t\t<input type=\"text\" bind:value={$searchStore}>\r\n\t\t\t</div>\r\n\r\n\t\t\t<DropZone callback={(data) => store.onDropData(data)} overCallback={onDragOverEvent} leaveCallback={onDragLeave}\r\n\t\t\t          style=\"display: flex; flex: 1; justify-content: center; align-items: center;\">\r\n\r\n\t\t\t\t<Grid bind:items={$gridItems}\r\n\t\t\t\t      bind:gridContainer={element}\r\n\t\t\t\t      options={{\r\n              ...gridData,\r\n              class: \"item-piles-grid-background\",\r\n              activeClass: \"item-piles-grid-item-active\",\r\n              previewClass: \"item-piles-grid-item-preview\",\r\n              collisionClass: \"item-piles-grid-item-collision\",\r\n              invalidCollisionClass: \"item-piles-grid-item-invalid-collision\",\r\n              hoverClass: \"item-piles-grid-item-hover\",\r\n              highlightClass: \"item-piles-grid-item-highlight\",\r\n              invalidPlacementClass: \"item-piles-grid-item-invalid\",\r\n              dimClass: \"item-piles-grid-item-dim\",\r\n              backgroundGrid: true,\r\n              highlightItems: !!$searchStore\r\n            }}\r\n\t\t\t\t      dropGhost={$dragPositionStore}\r\n\t\t\t\t      on:change={(event) => store.updateGrid(event.detail.items)}\r\n\t\t\t\t      on:itembegindrag={itemBeginDrag}\r\n\t\t\t\t      on:itemstopdrag={itemStopDrag}\r\n\t\t\t\t      on:itemmove={itemMove}\r\n\t\t\t\t      on:rightclick={rightClickItem}\r\n\t\t\t\t      on:doubleclick={doubleClickItem}\r\n\t\t\t\t      on:itemflipped={itemFlipped}\r\n\t\t\t\t      let:item\r\n\t\t\t\t>\r\n\t\t\t\t\t<VaultItemEntry entry={item}/>\r\n\t\t\t\t</Grid>\r\n\r\n\t\t\t</DropZone>\r\n\r\n\t\t\t{#if $recipientDocument?.name}\r\n\t\t\t\t<div class=\"item-piles-flexrow item-piles-top-divider\" style=\"flex: 0 1 auto; align-items: center;\">\r\n          <span>\r\n            <a on:click={() => {\r\n              const [appPosition, actorPosition] = Helpers.getApplicationPositions(application, store.recipient.sheet);\r\n              application.position.stores.left.set(appPosition.left);\r\n              application.position.stores.top.set(appPosition.top);\r\n              store.recipient.sheet.render(true, actorPosition);\r\n            }}>\r\n              <i class=\"fa-solid fa-suitcase\"></i>\r\n\t            {localize(\"ITEM-PILES.Vault.ViewingAs\", { actor_name: $recipientDocument.name })}\r\n            </a>\r\n          </span>\r\n\t\t\t\t\t{#if gridData.canDepositCurrencies || gridData.canWithdrawCurrencies}\r\n\t\t\t\t\t\t<div style=\"flex:0 1 auto; justify-self: flex-end; display: flex; justify-content: flex-end;\">\r\n\t\t\t\t\t\t\t{#if gridData.canWithdrawCurrencies}\r\n\t\t\t\t\t\t\t\t<button type=\"button\" class=\"item-piles-small-button\" on:click={() => store.withdrawCurrency()}>\r\n\t\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Vault.Withdraw\")}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t{#if gridData.canDepositCurrencies}\r\n\t\t\t\t\t\t\t\t<button type=\"button\" class=\"item-piles-small-button\" on:click={() => store.depositCurrency()}>\r\n\t\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Vault.Deposit\")}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\r\n\t\t\t<div class=\"item-piles-flexrow\" style=\"margin-top: 0.25rem; flex:0 1 auto;\">\r\n\r\n\t\t\t\t{#if gridData.canOrganize}\r\n\t\t\t\t\t<div style=\"flex: 0 1 auto;\">\r\n\t\t\t\t\t\t<button type=\"button\" class=\"item-piles-small-button\" on:click={(event) => store.sortItemsOnGrid(event)}\r\n\t\t\t\t\t\t        data-tooltip={localize(\"ITEM-PILES.Vault.SortItemsTooltip\")}>\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Vault.SortItems\")}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t<CurrencyList {currencies}\r\n\t\t\t\t              options={{ abbreviations: false, imgSize: 18, abbreviateNumbers: true }}\r\n\t\t\t\t              style=\"align-items: center;\">\r\n\t\t\t\t\t{#if gridData.canEditCurrencies}\r\n\t\t\t\t\t\t<a style=\"order: 100; display:flex; flex: 0; margin-left: 0.25rem;\" on:click={() => store.addCurrency()}>\r\n\t\t\t\t\t\t\t<i class=\"fas fa-cog\"></i>\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</CurrencyList>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t{/if}\r\n\r\n\t\t{#if $activeTab === \"expanders\"}\r\n\r\n\t\t\t<DropZone callback={(data, event) => { store.onDropData(data, event, true) }}\r\n\t\t\t          style=\"display: flex; flex-direction: column; flex:1;\">\r\n\r\n\t\t\t\t<div style=\"text-align: center;\" class=\"item-piles-bottom-divider\">\r\n\t\t\t\t\t{@html localize(\"ITEM-PILES.Vault.\" + (\r\n\t\t\t\t\t\tgridData.totalSpaces === gridData.enabledSpaces\r\n\t\t\t\t\t\t\t? \"CapacityFull\"\r\n\t\t\t\t\t\t\t: (gridData.enabledSpaces ? \"CapacityLeft\" : \"NeedsCapacity\")), {\r\n\t\t\t\t\t\ttotal_capacity: `<strong>${gridData.totalSpaces}</strong>`,\r\n\t\t\t\t\t\tcapacity: `<strong>${gridData.enabledSpaces}</strong>`,\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"item-piles-items-list\">\r\n\r\n\t\t\t\t\t{#each $vaultExpanderItems as item (item.id)}\r\n\t\t\t\t\t\t<VaultExpanderEntry {store} bind:item={item}/>\r\n\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{#if !$vaultExpanderItems.length}\r\n\t\t\t\t\t<div style=\"flex: 1 0 auto; display: flex; align-items: center; place-content: center;\">\r\n\t\t\t\t\t\t<i>Drag and drop items to expand spaces</i>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t</DropZone>\r\n\r\n\t\t{/if}\r\n\r\n\t\t{#if $activeTab === \"log\"}\r\n\r\n\t\t\t<div class=\"form-group item-piles-flexrow item-piles-bottom-divider\"\r\n\t\t\t     style=\"margin: 0.25rem 0; align-items: center; flex: 0 1 auto;\">\r\n\t\t\t\t<label style=\"flex:0 1 auto; margin-right: 5px;\">Log search:</label>\r\n\t\t\t\t<input type=\"text\" bind:value={$logSearchStore}>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"item-piles-vault-log\"\r\n\t\t\t     style=\"max-height: {$applicationHeight-130}px; overflow-y: scroll; font-size: 0.75rem; padding-right: 0.5rem;\">\r\n\r\n\t\t\t\t{#each $vaultLog.slice(0, $visibleLogItems).filter(log => log.visible) as log, index (index)}\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass:item-piles-log-deposit={log.action === \"deposited\" || (!log.action && log.qty > 0)}\r\n\t\t\t\t\t\tclass:item-piles-log-withdrawal={log.action === \"withdrew\" || (!log.action && log.qty < 0)}\r\n\t\t\t\t\t\tclass:item-piles-log-other={log.action && log.action !== \"deposited\" && log.action !== \"withdrew\"}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{@html log.text} - {Helpers.timeSince(log.date)} ago\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/each}\r\n\r\n\t\t\t\t{#if $vaultLog.length > $visibleLogItems}\r\n\t\t\t\t\t<div class=\"item-piles-top-divider\" style=\"text-align: center;\">\r\n\t\t\t\t\t\t<a on:click={() => { $visibleLogItems += 20; }}><i>Load more transactions ({$visibleLogItems}\r\n\t\t\t\t\t\t\t/ {$vaultLog.length})...</i></a>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t</div>\r\n\r\n\t\t{/if}\r\n\r\n\t</main>\r\n\r\n</ApplicationShell>\r\n\r\n<style lang=\"scss\">\r\n\r\n  main {\r\n    z-index: 0;\r\n  }\r\n\r\n</style>\r\n","import { SvelteApplication } from '#runtime/svelte/application';\r\nimport VaultShell from \"./vault-shell.svelte\";\r\nimport * as Utilities from \"../../helpers/utilities.js\";\r\nimport ItemPileConfig from \"../item-pile-config/item-pile-config.js\";\r\nimport * as Helpers from \"../../helpers/helpers.js\";\r\nimport UserSelectDialog from \"../dialogs/user-select-dialog/user-select-dialog.js\";\r\nimport SETTINGS from \"../../constants/settings.js\";\r\nimport CONSTANTS from \"../../constants/constants.js\";\r\nimport { getVaultAccess } from \"../../helpers/pile-utilities.js\";\r\n\r\nexport default class VaultApp extends SvelteApplication {\r\n\r\n\t/**\r\n\t *\r\n\t * @param actor\r\n\t * @param recipient\r\n\t * @param options\r\n\t * @param dialogData\r\n\t */\r\n\tconstructor(actor, recipient, options = {}, dialogData = {}) {\r\n\t\tsuper({\r\n\t\t\tid: `item-pile-vault-${actor?.token?.id ?? actor.id}-${foundry.utils.randomID()}`,\r\n\t\t\ttitle: actor.name,\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: VaultShell,\r\n\t\t\t\ttarget: document.body,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\tactor,\r\n\t\t\t\t\trecipient\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tzIndex: 100,\r\n\t\t\t...options\r\n\t\t}, dialogData);\r\n\r\n\t\tthis.actor = actor;\r\n\t\tthis.recipient = recipient;\r\n\r\n\t\tHelpers.hooks.callAll(CONSTANTS.HOOKS.OPEN_INTERFACE, this, actor, recipient, options, dialogData);\r\n\r\n\t}\r\n\r\n\tonDropData(data) {\r\n\t\treturn this.store.onDropData(data);\r\n\t}\r\n\r\n\t/** @inheritdoc */\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\tcloseOnSubmit: false,\r\n\t\t\tclasses: [\"app\", \"window-app\", \"sheet\", \"item-pile-vault\", \"item-piles\", \"item-piles-app\"],\r\n\t\t\tminWidth: 300,\r\n\t\t\tminHeight: 300,\r\n\t\t\tresizable: false\r\n\t\t});\r\n\t}\r\n\r\n\tget store() {\r\n\t\treturn this.svelte.applicationShell.store;\r\n\t}\r\n\r\n\tstatic getActiveApps(source) {\r\n\t\tconst id = typeof source === \"string\" ? source : source?.token?.id ?? source?.id;\r\n\t\treturn Helpers.getActiveApps(`item-pile-vault-${id}`);\r\n\t}\r\n\r\n\tstatic async show(source, recipient = false, options = {}, dialogData = {}) {\r\n\t\tsource = Utilities.getActor(source);\r\n\t\trecipient = Utilities.getActor(recipient);\r\n\t\tconst result = Helpers.hooks.call(CONSTANTS.HOOKS.PRE_OPEN_INTERFACE, source, recipient, options, dialogData);\r\n\t\tif (result === false) return;\r\n\t\tconst access = getVaultAccess(source, { hasRecipient: !!recipient });\r\n\t\tif (!access.canView) {\r\n\t\t\tui.notifications.error(game.i18n.format(recipient\r\n\t\t\t\t? \"ITEM-PILES.Errors.NoVaultAccessActor\"\r\n\t\t\t\t: \"ITEM-PILES.Errors.NoVaultAccess\", {\r\n\t\t\t\tactor_name: recipient?.name ?? \"\"\r\n\t\t\t}));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst apps = this.getActiveApps(source);\r\n\t\tif (apps.length) {\r\n\t\t\tfor (let app of apps) {\r\n\t\t\t\tapp.render(false, { focus: true });\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\toptions.resolve = resolve;\r\n\t\t\tnew this(source, recipient, options, dialogData).render(true, { focus: true });\r\n\t\t})\r\n\t}\r\n\r\n\tasync close(options) {\r\n\t\tconst result = Helpers.hooks.call(CONSTANTS.HOOKS.PRE_CLOSE_INTERFACE, this, this.actor, this.recipient, options);\r\n\t\tif (result === false) return;\r\n\t\tHelpers.hooks.callAll(CONSTANTS.HOOKS.CLOSE_INTERFACE, this, this.actor, this.recipient, options);\r\n\t\treturn super.close(options);\r\n\t}\r\n\r\n\t/* -------------------------------------------- */\r\n\r\n\t/** @override */\r\n\t_getHeaderButtons() {\r\n\t\tlet buttons = super._getHeaderButtons();\r\n\t\tconst canConfigure = game.user.isGM;\r\n\t\tif (canConfigure) {\r\n\t\t\tbuttons = [\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.Inspect.OpenSheet\" : \"\",\r\n\t\t\t\t\tclass: \"item-piles-open-actor-sheet\",\r\n\t\t\t\t\ticon: \"fas fa-user\",\r\n\t\t\t\t\tonclick: () => {\r\n\t\t\t\t\t\tthis.actor.sheet.render(true, { focus: true, bypassItemPiles: true });\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.ContextMenu.ShowToPlayers\" : \"\",\r\n\t\t\t\t\tclass: \"item-piles-show-to-players\",\r\n\t\t\t\t\ticon: \"fas fa-eye\",\r\n\t\t\t\t\tonclick: async (event) => {\r\n\t\t\t\t\t\tconst activeUsers = Array.from(game.users).filter(u => u.active && u !== game.user).map(u => u.id);\r\n\t\t\t\t\t\tif (!activeUsers.length) {\r\n\t\t\t\t\t\t\treturn Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.NoPlayersActive\"), true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst users = event.altKey ? activeUsers : await UserSelectDialog.show({ excludeSelf: true });\r\n\t\t\t\t\t\tif (!users || !users.length) return;\r\n\t\t\t\t\t\tHelpers.custom_notify(game.i18n.format(\"ITEM-PILES.Notifications.ShownToPlayers\", { actor_name: this.actor.name }))\r\n\t\t\t\t\t\treturn game.itempiles.API.renderItemPileInterface(this.actor, {\r\n\t\t\t\t\t\t\tuserIds: users,\r\n\t\t\t\t\t\t\tuseDefaultCharacter: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.HUD.Configure\" : \"\",\r\n\t\t\t\t\tclass: \"item-piles-configure-pile\",\r\n\t\t\t\t\ticon: \"fas fa-box-open\",\r\n\t\t\t\t\tonclick: () => {\r\n\t\t\t\t\t\tItemPileConfig.show(this.actor);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t].concat(buttons);\r\n\t\t}\r\n\t\treturn buttons\r\n\t}\r\n\r\n}\r\n","<script>\r\n\timport FilePicker from \"../../components/FilePicker.svelte\";\r\n\timport DropZone from \"../../components/DropZone.svelte\";\r\n\timport * as Helpers from \"../../../helpers/helpers.js\";\r\n\timport { applyStyles } from '#runtime/svelte/action/dom';\r\n\timport { localize } from \"@typhonjs-fvtt/runtime/svelte/helper\";\r\n\r\n\texport let store;\r\n\r\n\tconst currenciesStore = store.currencies;\r\n\tlet isHovering = false;\r\n\r\n\t$: currencies = $currenciesStore;\r\n\t$: {\r\n\t\t$currenciesStore;\r\n\t\tstore.sortCurrencies();\r\n\t}\r\n\r\n\tasync function dropData(data) {\r\n\r\n\t\tif (!data.type) {\r\n\t\t\tthrow Helpers.custom_error(\"Something went wrong when dropping this item!\")\r\n\t\t}\r\n\r\n\t\tif (data.type !== \"Item\") {\r\n\t\t\tthrow Helpers.custom_error(\"You must drop an item, not \" + data.type.toLowerCase() + \"!\")\r\n\t\t}\r\n\r\n\t\tstore.addItem(data);\r\n\r\n\t}\r\n\r\n\t$: style = {\r\n\t\t\"grid-template-columns\": `${store.secondary ? \"\" : \"28px\"} 1.25fr ${store.secondary ? \"\" : \"60px\"} 0.5fr 60px 1fr 28px`\r\n\t}\r\n\r\n</script>\r\n\r\n<DropZone bind:isHovering={isHovering} callback={dropData}>\r\n\t<div class=\"item-piles-sortable-list-columns header\" use:applyStyles={style}>\r\n\t\t{#if !store.secondary}\r\n\t\t\t<div style=\"justify-content:flex-start;\">{localize(\"ITEM-PILES.General.Primary\")}</div>\r\n\t\t{/if}\r\n\t\t<div>{localize(\"ITEM-PILES.General.Name\")}</div>\r\n\t\t{#if !store.secondary}\r\n\t\t\t<div>{localize(\"ITEM-PILES.General.Exchange\")}</div>\r\n\t\t{/if}\r\n\t\t<div>{localize(\"ITEM-PILES.General.Short\")}</div>\r\n\t\t<div>{localize(\"ITEM-PILES.General.Icon\")}</div>\r\n\t\t<div>{localize(\"ITEM-PILES.General.Data\")}</div>\r\n\t\t<div><a on:click={() => store.addAttribute()}><i class=\"fas fa-plus\"></i></a></div>\r\n\t</div>\r\n\t<div class=\"table-container\">\r\n\t\t{#if isHovering}\r\n\t\t\t<div class=\"drop-to-add\">\r\n\t\t\t\t{localize(\"ITEM-PILES.Applications.CurrenciesEditor.Drop\")}\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\t\t{#if !currencies.length}\r\n\t\t\t<div class=\"item-piles-sortable-list-columns\">\r\n\t\t\t\t<div class=\"full-span\" class:invisible={isHovering}>\r\n\t\t\t\t\t{localize(\"ITEM-PILES.Applications.CurrenciesEditor.CreateNew\")}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\t\t{#each currencies as item, index (item.id)}\r\n\t\t\t<div class=\"item-piles-sortable-list-columns\" use:applyStyles={style}>\r\n\t\t\t\t{#if !store.secondary}\r\n\t\t\t\t\t<div><input type=\"checkbox\" checked={item.primary} on:change={() => store.setPrimary(index)}/></div>\r\n\t\t\t\t{/if}\r\n\t\t\t\t<div><input type=\"text\" bind:value={item.name}/></div>\r\n\t\t\t\t{#if !store.secondary}\r\n\t\t\t\t\t<div><input type=\"number\" step=\"0.000000001\" bind:value={item.exchangeRate}/></div>\r\n\t\t\t\t{/if}\r\n\t\t\t\t<div><input type=\"text\" bind:value={item.abbreviation}/></div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<FilePicker type=\"imagevideo\" showImage={true} showInput={false} bind:value={item.img}/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t{#if item.type === \"attribute\"}\r\n\t\t\t\t\t\t<input type=\"text\" bind:value={item.data.path} placeholder=\"system.attributes.hp.value\"/>\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t<button type=\"button\" on:click={() => store.editItem(index)}>\r\n\t\t\t\t\t\t\t<i class=\"fas fa-eye\"></i> View item\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<button type=\"button\" class=\"delete-button\" on:click={() => store.removeEntry(index)}>\r\n\t\t\t\t\t\t<i class=\"fas fa-times\"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t{/each}\r\n\t</div>\r\n</DropZone>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-sortable-list-columns {\r\n\r\n    .full-span {\r\n      padding: 2rem 1rem;\r\n      grid-column: 1/-1;\r\n      font-size: 1.5rem;\r\n      border-radius: 5px;\r\n      border: 2px dashed rgba(0, 0, 0, 0.35);\r\n    }\r\n  }\r\n\r\n  .invisible {\r\n    opacity: 0;\r\n  }\r\n\r\n  .table-container {\r\n    position: relative;\r\n  }\r\n\r\n  .drop-to-add {\r\n    position: absolute;\r\n    top: 0;\r\n    bottom: 0;\r\n    right: 0;\r\n    left: 0;\r\n    border-radius: 5px;\r\n    box-shadow: inset 0 0 15px 5px rgb(0, 0, 0, 0.5);\r\n    background-color: rgba(255, 255, 255, 0.75);\r\n    z-index: 100000;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    font-size: 2rem;\r\n  }\r\n\r\n</style>\r\n","import { get, writable } from 'svelte/store';\r\nimport * as Utilities from \"../../../helpers/utilities.js\";\r\nimport CONSTANTS from \"../../../constants/constants.js\";\r\nimport * as Helpers from \"../../../helpers/helpers.js\";\r\nimport { localize } from \"#runtime/svelte/helper\";\r\nimport * as CompendiumUtilities from \"../../../helpers/compendium-utilities.js\";\r\n\r\nexport default class CurrencyStore {\r\n\r\n\tconstructor(data, secondary = false) {\r\n\t\tthis.secondary = secondary;\r\n\t\tthis.currencies = writable(data.map((entry, index) => {\r\n\t\t\treturn {\r\n\t\t\t\t...entry,\r\n\t\t\t\tindex,\r\n\t\t\t\tid: entry.data?.path ?? entry.data?._id ?? foundry.utils.randomID()\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\r\n\tsetPrimary(index) {\r\n\t\tif (this.secondary) return;\r\n\t\tthis.currencies.update(currencies => {\r\n\t\t\tcurrencies.forEach((entry, entryIndex) => {\r\n\t\t\t\tentry.primary = entryIndex === index;\r\n\t\t\t});\r\n\t\t\treturn currencies;\r\n\t\t});\r\n\t}\r\n\r\n\tsortCurrencies() {\r\n\t\tif (this.secondary) return;\r\n\t\tthis.currencies.update(currencies => {\r\n\t\t\tcurrencies.sort((a, b) => {\r\n\t\t\t\treturn b.exchangeRate - a.exchangeRate;\r\n\t\t\t});\r\n\t\t\treturn currencies;\r\n\t\t});\r\n\t}\r\n\r\n\taddAttribute() {\r\n\t\tthis.currencies.update(currencies => {\r\n\t\t\tcurrencies.push(foundry.utils.mergeObject({\r\n\t\t\t\ttype: \"attribute\",\r\n\t\t\t\tname: \"New Attribute\",\r\n\t\t\t\timg: \"\",\r\n\t\t\t\tabbreviation: \"{#}N\",\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tpath: \"\"\r\n\t\t\t\t}\r\n\t\t\t}, this.secondary ? {} : {\r\n\t\t\t\tprimary: !currencies.length,\r\n\t\t\t\texchangeRate: 1\r\n\t\t\t}));\r\n\t\t\treturn currencies;\r\n\t\t});\r\n\t}\r\n\r\n\tasync addItem(data) {\r\n\r\n\t\tlet uuid = false;\r\n\t\tif (data.pack) {\r\n\t\t\tuuid = \"Compendium\" + data.pack + \".\" + data.id;\r\n\t\t}\r\n\r\n\t\tlet item = await Item.implementation.fromDropData(data);\r\n\t\tlet itemData = item.toObject();\r\n\r\n\t\tif (!itemData) {\r\n\t\t\tconsole.error(data);\r\n\t\t\tthrow Helpers.custom_error(\"Something went wrong when dropping this item!\")\r\n\t\t}\r\n\r\n\t\tif (!uuid) {\r\n\t\t\tuuid = (await CompendiumUtilities.findOrCreateItemInCompendium(itemData)).uuid;\r\n\t\t}\r\n\r\n\t\tthis.currencies.update(currencies => {\r\n\t\t\tconst itemCurrencies = currencies.map(entry => entry.data?.item ?? {});\r\n\t\t\tconst foundItem = Utilities.findSimilarItem(itemCurrencies, itemData);\r\n\t\t\tif (foundItem) {\r\n\t\t\t\tconst index = itemCurrencies.indexOf(foundItem);\r\n\t\t\t\tcurrencies[index].data = {\r\n\t\t\t\t\tuuid,\r\n\t\t\t\t}\r\n\t\t\t\tHelpers.custom_notify(`Updated item data for ${localize(currencies[index].name)} (item name ${itemData.name})`)\r\n\t\t\t} else {\r\n\t\t\t\tcurrencies.push(foundry.utils.mergeObject({\r\n\t\t\t\t\tid: foundry.utils.randomID(),\r\n\t\t\t\t\ttype: \"item\",\r\n\t\t\t\t\tname: itemData.name,\r\n\t\t\t\t\timg: itemData.img,\r\n\t\t\t\t\tabbreviation: \"{#} \" + itemData.name,\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tuuid\r\n\t\t\t\t\t},\r\n\t\t\t\t}, this.secondary ? {} : {\r\n\t\t\t\t\tprimary: !currencies.length,\r\n\t\t\t\t\texchangeRate: 1\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t\treturn currencies;\r\n\t\t});\r\n\t}\r\n\r\n\tasync editItem(index) {\r\n\t\tconst currencies = get(this.currencies);\r\n\t\tconst data = currencies[index].data;\r\n\t\tlet item;\r\n\t\tif (data.uuid) {\r\n\t\t\titem = await fromUuid(data.uuid);\r\n\t\t} else {\r\n\t\t\tlet itemData = data.item;\r\n\t\t\tif (itemData._id) delete itemData._id;\r\n\t\t\tif (itemData.ownership) delete itemData.ownership;\r\n\t\t\tconst items = Array.from(game.items);\r\n\t\t\titem = Utilities.findSimilarItem(items, itemData);\r\n\t\t\tif (!item) {\r\n\t\t\t\tfoundry.utils.setProperty(itemData, CONSTANTS.FLAGS.TEMPORARY_ITEM, true);\r\n\t\t\t\titem = new Item.implementation(itemData);\r\n\t\t\t\tHelpers.custom_notify(`An item has been created for ${item.name} - drag and drop it into the list to update the stored item data`)\r\n\t\t\t}\r\n\t\t}\r\n\t\titem.sheet.render(true);\r\n\t}\r\n\r\n\tremoveEntry(index) {\r\n\t\tthis.currencies.update(currencies => {\r\n\t\t\tcurrencies.splice(index, 1);\r\n\t\t\treturn currencies;\r\n\t\t})\r\n\t}\r\n\r\n\texport() {\r\n\t\treturn get(this.currencies);\r\n\t}\r\n\r\n}\r\n","<script>\r\n\r\n\timport { ApplicationShell } from '#runtime/svelte/component/core';\r\n\timport { getContext } from 'svelte';\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { getSetting } from \"../../../helpers/helpers.js\";\r\n\timport SETTINGS from \"../../../constants/settings.js\";\r\n\timport CurrencyList from \"./CurrencyList.svelte\";\r\n\timport CurrencyStore from \"./currency-store.js\"\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let data;\r\n\texport let secondary = false\r\n\r\n\texport let elementRoot;\r\n\r\n\tconst store = new CurrencyStore(data || getSetting(SETTINGS.CURRENCIES), secondary);\r\n\r\n\tlet form;\r\n\r\n\tasync function updateSettings() {\r\n\t\tapplication.options.resolve(store.export());\r\n\t\tapplication.close();\r\n\t}\r\n\r\n\texport function requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form autocomplete=off bind:this={form} on:submit|preventDefault={updateSettings}>\r\n\r\n\t\t<p>{localize(`ITEM-PILES.Applications.${secondary ? \"Secondary\" : \"\"}CurrenciesEditor.Explanation`)}</p>\r\n\r\n\t\t<p class=\"small\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.CurrenciesEditor.ExplanationSmallAttributes\")}\r\n\t\t</p>\r\n\r\n\t\t<p class=\"small item-piles-bottom-divider\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.CurrenciesEditor.ExplanationSmallItems\")}\r\n\t\t</p>\r\n\r\n\t\t<CurrencyList {store}/>\r\n\r\n\t\t<footer>\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={() => { application.close(); }} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  form {\r\n    padding: 0 0.25rem;\r\n    position: relative;\r\n  }\r\n\r\n  footer {\r\n    border-top: 1px solid rgba(0, 0, 0, 0.5);\r\n    margin-top: 0.5rem;\r\n    padding-top: 0.5rem;\r\n    display: flex;\r\n  }\r\n\r\n  .small {\r\n    font-size: 0.75rem;\r\n  }\r\n\r\n</style>\r\n","import { SvelteApplication } from '#runtime/svelte/application';\r\nimport { getActiveApps } from \"../../helpers/helpers.js\";\r\n\r\nexport default class Editor extends SvelteApplication {\r\n\r\n\tconstructor(data, options, dialogOptions) {\r\n\t\tsuper({\r\n\t\t\tsvelte: {\r\n\t\t\t\tprops: {\r\n\t\t\t\t\tdata\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t...options\r\n\t\t}, dialogOptions);\r\n\t}\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\twidth: 400,\r\n\t\t\theight: \"auto\",\r\n\t\t\tclasses: [\"item-piles-app\"],\r\n\t\t\tclose: () => this.options.resolve(null),\r\n\t\t\tsvelte: {\r\n\t\t\t\ttarget: document.body,\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tstatic async show(data, options = {}, dialogOptions = {}) {\r\n\t\tconst app = options?.id ? getActiveApps(options?.id, true) : false;\r\n\t\tif (app) return app.render(false, { focus: true });\r\n\t\treturn new Promise(resolve => {\r\n\t\t\toptions.resolve = resolve;\r\n\t\t\treturn new this(data, options, dialogOptions).render(true, { focus: true });\r\n\t\t});\r\n\t}\r\n}\r\n","import CurrenciesEditorShell from './currencies-editor-shell.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport class CurrenciesEditor extends Editor {\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Applications.CurrenciesEditor.Title\"),\r\n\t\t\twidth: 630,\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: CurrenciesEditorShell,\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n\r\nexport class SecondaryCurrenciesEditor extends CurrenciesEditor {\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Applications.SecondaryCurrenciesEditor.Title\"),\r\n\t\t\tsvelte: {\r\n\t\t\t\tprops: {\r\n\t\t\t\t\tsecondary: true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n","<script>\r\n\timport { getContext } from 'svelte';\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\r\n\timport { getSetting } from \"../../../helpers/helpers.js\";\r\n\timport SETTINGS from \"../../../constants/settings.js\";\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\timport { get, writable } from \"svelte/store\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let data;\r\n\texport let elementRoot;\r\n\r\n\tlet form;\r\n\r\n\tconst itemFilters = writable(data ? data : getSetting(SETTINGS.ITEM_FILTERS))\r\n\r\n\tfunction add() {\r\n\t\titemFilters.update(val => {\r\n\t\t\tval.push({ path: \"\", filters: \"\" });\r\n\t\t\treturn val;\r\n\t\t})\r\n\t}\r\n\r\n\tfunction remove(index) {\r\n\t\titemFilters.update(val => {\r\n\t\t\tval.splice(index, 1)\r\n\t\t\treturn val;\r\n\t\t})\r\n\t}\r\n\r\n\tasync function updateSettings() {\r\n\t\tapplication.options.resolve(get(itemFilters));\r\n\t\tapplication.close();\r\n\t}\r\n\r\n\texport function requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form autocomplete=off bind:this={form} on:submit|preventDefault={updateSettings}>\r\n\r\n\t\t<p>{localize(`ITEM-PILES.Applications.${application.options?.localization || \"FilterEditor\"}.Explanation`)}</p>\r\n\r\n\t\t<table>\r\n\t\t\t<tr>\r\n\t\t\t\t<th>{localize(`ITEM-PILES.Applications.${application.options?.localization || \"FilterEditor\"}.Path`)}</th>\r\n\t\t\t\t<th>{localize(`ITEM-PILES.Applications.${application.options?.localization || \"FilterEditor\"}.Filters`)}</th>\r\n\t\t\t\t<th class=\"custom-small\"><a class=\"item-piles-clickable\" on:click={add}><i class=\"fas fa-plus\"></i></a></th>\r\n\t\t\t</tr>\r\n\t\t\t{#each $itemFilters as { path, filters }, index (index)}\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td><input type=\"text\" required placeholder=\"type\" bind:value=\"{path}\"/></td>\r\n\t\t\t\t\t<td><input type=\"text\" required placeholder=\"class, spell, feat\" bind:value=\"{filters}\"/></td>\r\n\t\t\t\t\t<td class=\"custom-small\">\r\n\t\t\t\t\t\t<button type=\"button\" on:click={remove(index)}><i class=\"fas fa-times\"></i></button>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t{/each}\r\n\t\t</table>\r\n\r\n\t\t<footer>\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={() => { application.close(); }} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  table {\r\n    vertical-align: middle;\r\n\r\n    tr {\r\n      border-spacing: 15px;\r\n    }\r\n\r\n    .custom-small {\r\n      width: 26px;\r\n    }\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem;\r\n      text-align: center;\r\n    }\r\n\r\n    a {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n</style>\r\n","import ItemFiltersShell from './item-filters-editor.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class ItemFiltersEditor extends Editor {\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\ttitle: \"ITEM-PILES.Applications.FilterEditor.Title\",\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: ItemFiltersShell,\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n","<script>\r\n\r\n\timport { CurrenciesEditor, SecondaryCurrenciesEditor } from \"../../editors/currencies-editor/currencies-editor.js\";\r\n\timport ItemFiltersEditor from \"../../editors/item-filters-editor/item-filters-editor.js\";\r\n\timport MacroSelector from \"../../components/MacroSelector.svelte\";\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\timport * as Helpers from \"../../../helpers/helpers.js\";\r\n\timport SETTINGS from \"../../../constants/settings.js\";\r\n\timport TextEditorDialog from \"../../dialogs/text-editor-dialog/text-editor-dialog.js\";\r\n\timport { writable } from \"svelte/store\";\r\n\r\n\texport let pileActor;\r\n\texport let pileData;\r\n\texport let pileEnabled;\r\n\r\n\tconst deleteWhenEmptySetting = localize(Helpers.getSetting(SETTINGS.DELETE_EMPTY_PILES) ? \"Yes\" : \"No\");\r\n\r\n\tlet hasOverrideCurrencies = writable(typeof pileData?.overrideCurrencies === \"object\");\r\n\tlet hasOverrideSecondaryCurrencies = writable(typeof pileData?.overrideSecondaryCurrencies === \"object\");\r\n\tlet hasOverrideItemFilters = writable(typeof pileData?.overrideItemFilters === \"object\");\r\n\r\n\t$: {\r\n\t\tif (!$hasOverrideCurrencies) {\r\n\t\t\tpileData.overrideCurrencies = false;\r\n\t\t}\r\n\t}\r\n\t$: {\r\n\t\tif (!$hasOverrideSecondaryCurrencies) {\r\n\t\t\tpileData.overrideSecondaryCurrencies = false;\r\n\t\t}\r\n\t}\r\n\t$: {\r\n\t\tif (!$hasOverrideItemFilters) {\r\n\t\t\tpileData.overrideItemFilters = false;\r\n\t\t}\r\n\t}\r\n\r\n\tasync function showCurrenciesEditor() {\r\n\t\tpileData.overrideCurrencies = pileData?.overrideCurrencies || foundry.utils.deepClone(game.itempiles.API.CURRENCIES);\r\n\t\treturn CurrenciesEditor.show(\r\n\t\t\tpileData.overrideCurrencies,\r\n\t\t\t{\r\n\t\t\t\tid: `currencies-item-pile-config-${pileActor.id}`,\r\n\t\t\t\ttitle: game.i18n.format(\"ITEM-PILES.Applications.CurrenciesEditor.TitleActor\", { actor_name: pileActor.name })\r\n\t\t\t},\r\n\t\t).then((result) => {\r\n\t\t\tpileData.overrideCurrencies = result;\r\n\t\t});\r\n\t}\r\n\r\n\tasync function showSecondaryCurrenciesEditor() {\r\n\t\tpileData.overrideSecondaryCurrencies = pileData?.overrideSecondaryCurrencies || foundry.utils.deepClone(game.itempiles.API.SECONDARY_CURRENCIES);\r\n\t\treturn SecondaryCurrenciesEditor.show(\r\n\t\t\tpileData.overrideSecondaryCurrencies,\r\n\t\t\t{\r\n\t\t\t\tid: `secondary-currencies-item-pile-config-${pileActor.id}`,\r\n\t\t\t\ttitle: game.i18n.format(\"ITEM-PILES.Applications.SecondaryCurrenciesEditor.TitleActor\", { actor_name: pileActor.name })\r\n\t\t\t},\r\n\t\t).then((result) => {\r\n\t\t\tpileData.overrideSecondaryCurrencies = result;\r\n\t\t});\r\n\t}\r\n\r\n\tasync function showItemFiltersEditor() {\r\n\t\tpileData.overrideItemFilters = pileData?.overrideItemFilters || foundry.utils.deepClone(game.itempiles.API.ITEM_FILTERS);\r\n\t\treturn ItemFiltersEditor.show(\r\n\t\t\tpileData.overrideItemFilters,\r\n\t\t\t{\r\n\t\t\t\tid: `item-filters-item-pile-config-${pileActor.id}`,\r\n\t\t\t\ttitle: game.i18n.format(\"ITEM-PILES.Applications.FilterEditor.TitleActor\", { actor_name: pileActor.name })\r\n\t\t\t}\r\n\t\t).then((result) => {\r\n\t\t\tpileData.overrideItemFilters = result;\r\n\t\t});\r\n\t}\r\n\r\n\tasync function showRequiredItemPropertiesEditor() {\r\n\t\treturn ItemFiltersEditor.show(\r\n\t\t\tpileData?.requiredItemProperties,\r\n\t\t\t{\r\n\t\t\t\tid: `required-item-properties-item-pile-config-${pileActor.id}`,\r\n\t\t\t\tlocalization: \"RequiredItemPropertiesEditor\",\r\n\t\t\t\ttitle: game.i18n.format(\"ITEM-PILES.Applications.RequiredItemPropertiesEditor.TitleActor\", { actor_name: pileActor.name }),\r\n\t\t\t},\r\n\t\t).then((result) => {\r\n\t\t\tpileData.requiredItemProperties = result;\r\n\t\t});\r\n\t}\r\n\r\n\tasync function showDescriptionDialog() {\r\n\t\treturn TextEditorDialog.show(pileData.description, { id: \"item-pile-text-editor-\" + pileActor.id }).then((result) => {\r\n\t\t\tpileData.description = result || \"\";\r\n\t\t});\r\n\t}\r\n\r\n</script>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.EnabledPile\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.EnabledPileExplanation\")}</p>\r\n\t</label>\r\n\r\n\t<span class=\"item-piles-flexrow\" style=\"max-width: 100px; justify-content: flex-end; align-items:center;\">\r\n          {#if !$pileEnabled}\r\n            <div style=\"flex:0 1 auto; margin-right: 1rem;\" class=\"blob\"><i class=\"fas fa-exclamation\"></i></div>\r\n          {/if}\r\n\t\t<span style=\"flex:0 1 auto;\"><input bind:checked={$pileEnabled} type=\"checkbox\"/></span>\r\n        </span>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.Distance\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.GridUnits\")}</p>\r\n\t</label>\r\n\t<input bind:value={pileData.distance} placeholder=\"Infinity\" style=\"flex:4;\" type=\"number\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.InspectItems\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.InspectItemsExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.canInspectItems} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.DisplayItemTypes\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.DisplayItemTypesExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.displayItemTypes} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.Macro\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.MacroExplanation\")}</p>\r\n\t</label>\r\n</div>\r\n<div class=\"form-group\">\r\n\t<MacroSelector bind:macro={pileData.macro}/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.DeleteWhenEmpty\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.DeleteWhenEmptyExplanation\")}</p>\r\n\t</label>\r\n\t<select bind:value={pileData.deleteWhenEmpty} style=\"flex:4;\">\r\n\t\t<option\r\n\t\t\tvalue=\"default\">{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.DeleteWhenEmptyDefault\")}\r\n\t\t\t({localize(deleteWhenEmptySetting)})\r\n\t\t</option>\r\n\t\t<option value={true}>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.DeleteWhenEmptyYes\")}</option>\r\n\t\t<option value={false}>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.DeleteWhenEmptyNo\")}</option>\r\n\t</select>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.CanStackItems\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.CanStackItemsExplanation\")}</p>\r\n\t</label>\r\n\t<div class=\"break\"></div>\r\n\t<select bind:value={pileData.canStackItems} style=\"flex:4;\">\r\n\t\t<option value=\"yes\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.CanStackItemsYes\")}\r\n\t\t</option>\r\n\t\t<option value=\"no\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.CanStackItemsNo\")}\r\n\t\t</option>\r\n\t\t<option value=\"alwaysyes\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.CanStackItemsYesAlways\")}\r\n\t\t</option>\r\n\t\t<option value=\"alwaysno\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.CanStackItemsNoAlways\")}\r\n\t\t</option>\r\n\t</select>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.EditDescription\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.EditDescriptionExplanation\")}</p>\r\n\t</label>\r\n</div>\r\n<div class=\"form-group\">\r\n\t<button on:click={() => { showDescriptionDialog() }} style=\"flex:4;\" type=\"button\">\r\n\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.EditDescription\")}\r\n\t</button>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.OverrideCurrencies\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.OverrideCurrenciesExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={$hasOverrideCurrencies} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<button disabled={!$hasOverrideCurrencies} on:click={() => { showCurrenciesEditor() }}\r\n\t        style=\"flex:4;\" type=\"button\">\r\n\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.ConfigureOverrideCurrencies\")}\r\n\t</button>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.OverrideSecondaryCurrencies\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.OverrideSecondaryCurrenciesExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={$hasOverrideSecondaryCurrencies} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<button disabled={!$hasOverrideSecondaryCurrencies} on:click={() => { showSecondaryCurrenciesEditor() }}\r\n\t        style=\"flex:4;\" type=\"button\">\r\n\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.ConfigureOverrideSecondaryCurrencies\")}\r\n\t</button>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.OverrideItemFilters\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.OverrideItemFiltersExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={$hasOverrideItemFilters} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<button disabled={!$hasOverrideItemFilters} on:click={() => { showItemFiltersEditor() }}\r\n\t        style=\"flex:4;\" type=\"button\">\r\n\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.ConfigureOverrideItemFilters\")}\r\n\t</button>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.RequiredItemProperties\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.RequiredItemPropertiesExplanation\")}</p>\r\n\t</label>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<button on:click={() => { showRequiredItemPropertiesEditor() }}\r\n\t        style=\"flex:4;\" type=\"button\">\r\n\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Main.ConfigureRequiredItemProperties\")}\r\n\t</button>\r\n</div>\r\n","<script>\r\n\timport { getContext } from 'svelte';\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport SliderInput from \"../../components/SliderInput.svelte\";\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\timport { get, writable } from \"svelte/store\";\r\n\timport * as Helpers from \"../../../helpers/helpers.js\";\r\n\timport SETTINGS from \"../../../constants/settings.js\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let elementRoot;\r\n\texport let data = [];\r\n\r\n\tconst itemTypePriceModifiers = writable(data);\r\n\r\n\tlet form;\r\n\tlet unusedTypes;\r\n\tlet systemTypes = Object.entries(CONFIG.Item.typeLabels);\r\n\tlet currentCustomCategories = Array.from(new Set(Helpers.getSetting(SETTINGS.CUSTOM_ITEM_CATEGORIES)));\r\n\r\n\t$: {\r\n\t\tconst allTypes = systemTypes.map(([type]) => type).concat(currentCustomCategories).map(type => type.toLowerCase())\r\n\t\tunusedTypes = allTypes.filter(type => {\r\n\t\t\treturn !$itemTypePriceModifiers.some(priceData => priceData.type === type || (priceData.type === \"custom\" && priceData.category === type))\r\n\t\t});\r\n\t}\r\n\r\n\tfunction add() {\r\n\t\tif (!unusedTypes.length) return;\r\n\t\titemTypePriceModifiers.update(val => {\r\n\t\t\tval.push({\r\n\t\t\t\ttype: unusedTypes[0],\r\n\t\t\t\tcategory: \"\",\r\n\t\t\t\toverride: false,\r\n\t\t\t\tbuyPriceModifier: 1,\r\n\t\t\t\tsellPriceModifier: 0.5\r\n\t\t\t});\r\n\t\t\treturn val;\r\n\t\t})\r\n\t}\r\n\r\n\tfunction remove(index) {\r\n\t\titemTypePriceModifiers.update(val => {\r\n\t\t\tval.splice(index, 1);\r\n\t\t\treturn val;\r\n\t\t})\r\n\t}\r\n\r\n\tasync function updateSettings() {\r\n\t\tapplication.options.resolve?.(get(itemTypePriceModifiers));\r\n\t\tapplication.close();\r\n\t}\r\n\r\n\texport function requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\t<form autocomplete=off bind:this={form} on:submit|preventDefault={updateSettings}>\r\n\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemTypePriceModifiersEditor.Explanation\")}</p>\r\n\r\n\t\t<div>\r\n\r\n\t\t\t<table>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<th style=\"width:5%;\">{localize(\"ITEM-PILES.Applications.ItemTypePriceModifiersEditor.Override\")}</th>\r\n\t\t\t\t\t<th style=\"width:20%;\">{localize(\"ITEM-PILES.Applications.ItemTypePriceModifiersEditor.ItemType\")}</th>\r\n\t\t\t\t\t<th style=\"width:35%;\">{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.BuyPriceModifier\")}</th>\r\n\t\t\t\t\t<th style=\"width:35%;\">{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.SellPriceModifier\")}</th>\r\n\t\t\t\t\t<th style=\"width:5%;\">\r\n          <span class:item-piles-clickable-link={unusedTypes.length} on:click={add}>\r\n            <i class=\"fas fa-plus\"></i>\r\n          </span>\r\n\t\t\t\t\t</th>\r\n\t\t\t\t</tr>\r\n\t\t\t\t{#each $itemTypePriceModifiers as priceData, index (index)}\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={priceData.override}>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t\t<select on:change={(e) => {\r\n\t\t\t\t\t\t\t\t\tpriceData.type = e.target.value;\r\n\t\t\t\t\t\t\t\t\tpriceData.category = e.target.value === \"custom\" ? e.target.options[e.target.selectedIndex].text.toLowerCase() : \"\";\r\n\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t<optgroup label=\"System Types\">\r\n\t\t\t\t\t\t\t\t\t\t{#each systemTypes as [itemType, label] (itemType)}\r\n\t\t\t\t\t\t\t\t\t\t\t<option value=\"{itemType}\"\r\n\t\t\t\t\t\t\t\t\t\t\t        selected=\"{priceData.type === itemType}\"\r\n\t\t\t\t\t\t\t\t\t\t\t        disabled=\"{itemType !== priceData.type && !unusedTypes.includes(itemType)}\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{localize(label)}\r\n\t\t\t\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t\t\t\t</optgroup>\r\n\t\t\t\t\t\t\t\t\t{#if currentCustomCategories.length}\r\n\t\t\t\t\t\t\t\t\t\t<optgroup label=\"Custom Categories\">\r\n\t\t\t\t\t\t\t\t\t\t\t{#each currentCustomCategories as customCategory}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"custom\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t        selected=\"{priceData.type === 'custom' && customCategory.toLowerCase() === priceData.category.toLowerCase()}\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t        disabled=\"{customCategory.toLowerCase() !== priceData.category.toLowerCase() && !unusedTypes.includes(customCategory.toLowerCase())}\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{customCategory}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t\t\t\t\t</optgroup>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<div class=\"item-piles-flexrow\" style=\"margin: 0 0.25rem\">\r\n\t\t\t\t\t\t\t\t<SliderInput style=\"flex:4;\" bind:value={priceData.buyPriceModifier}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<div class=\"item-piles-flexrow\" style=\"margin: 0 0.25rem\">\r\n\t\t\t\t\t\t\t\t<SliderInput style=\"flex:4;\" bind:value={priceData.sellPriceModifier}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"small\">\r\n\t\t\t\t\t\t\t<button type=\"button\" on:click={remove(index)}><i class=\"fas fa-times\"></i></button>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t{/each}\r\n\t\t\t</table>\r\n\r\n\t\t</div>\r\n\r\n\t\t<footer>\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={() => { application.close(); }} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .border-highlight {\r\n    padding: 1rem;\r\n    margin: 0.25rem;\r\n    border-radius: 10px;\r\n    border: 2px dashed gray;\r\n  }\r\n\r\n  table {\r\n    vertical-align: middle;\r\n\r\n    tr {\r\n      border-spacing: 15px;\r\n    }\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem;\r\n      flex: 0;\r\n      text-align: center;\r\n    }\r\n\r\n    a {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n</style>\r\n","import ItemTypePriceModifiersShell from './item-type-price-modifiers-editor.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class ItemTypePriceModifiersEditor extends Editor {\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Applications.ItemTypePriceModifiersEditor.Title\"),\r\n\t\t\twidth: 600,\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: ItemTypePriceModifiersShell,\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n","<script>\r\n\timport { getContext } from 'svelte';\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport SliderInput from \"../../components/SliderInput.svelte\";\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\timport { getSourceActorFromDropData, getUuid } from \"../../../helpers/utilities.js\";\r\n\timport { get, writable } from \"svelte/store\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\tlet form;\r\n\r\n\texport let data;\r\n\texport let elementRoot;\r\n\r\n\tconst priceModifiers = writable(data.map(data => {\r\n\t\tdata.actor = globalThis.fromUuidSync(data.actorUuid);\r\n\t\tif (!data.actor) return false;\r\n\t\treturn data;\r\n\t}).filter(Boolean));\r\n\r\n\tfunction remove(index) {\r\n\t\tpriceModifiers.update(val => {\r\n\t\t\tval.splice(index, 1)\r\n\t\t\treturn val;\r\n\t\t})\r\n\t}\r\n\r\n\tasync function updateSettings() {\r\n\t\tlet result = get(priceModifiers);\r\n\t\tresult.forEach(data => {\r\n\t\t\tdata.actorUuid = getUuid(data.actor);\r\n\t\t})\r\n\t\tapplication.options.resolve?.(result);\r\n\t\tapplication.close();\r\n\t}\r\n\r\n\texport function requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n\tasync function dropData(event) {\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\tlet data;\r\n\t\ttry {\r\n\t\t\tdata = JSON.parse(event.dataTransfer.getData('text/plain'));\r\n\t\t} catch (err) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (data.type !== \"Actor\") return;\r\n\r\n\t\tconst actor = getSourceActorFromDropData(data);\r\n\r\n\t\tif (!actor) return;\r\n\r\n\t\tpriceModifiers.update(val => {\r\n\r\n\t\t\tif (val.find(data => data.actor === actor)) return val;\r\n\r\n\t\t\tval.push({\r\n\t\t\t\toverride: false,\r\n\t\t\t\tactor: actor,\r\n\t\t\t\tbuyPriceModifier: 1,\r\n\t\t\t\tsellPriceModifier: 0.5\r\n\t\t\t});\r\n\r\n\t\t\treturn val;\r\n\r\n\t\t})\r\n\t}\r\n\r\n\tfunction preventDefault(event) {\r\n\t\tevent.preventDefault();\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form autocomplete=off bind:this={form} on:submit|preventDefault={updateSettings}>\r\n\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.PriceModifiersEditor.Explanation\")}</p>\r\n\r\n\t\t<div class:border-highlight={!$priceModifiers.length} on:dragover={preventDefault} on:dragstart={preventDefault}\r\n\t\t     on:drop={dropData}>\r\n\r\n\t\t\t{#if $priceModifiers.length}\r\n\t\t\t\t<table>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<th style=\"width:5%;\">{localize(\"ITEM-PILES.Applications.PriceModifiersEditor.Override\")}</th>\r\n\t\t\t\t\t\t<th style=\"width:25%;\">{localize(\"ITEM-PILES.Applications.PriceModifiersEditor.Actor\")}</th>\r\n\t\t\t\t\t\t<th style=\"width:35%;\">{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.BuyPriceModifier\")}</th>\r\n\t\t\t\t\t\t<th style=\"width:35%;\">{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.SellPriceModifier\")}</th>\r\n\t\t\t\t\t\t<th style=\"width:5%;\"></th>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t{#each $priceModifiers as priceData, index (index)}\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={priceData.override}>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t<a class=\"item-piles-actor-name-clickable\"\r\n\t\t\t\t\t\t\t\t   on:click={(priceData.actor.sheet.render(true, { bypassItemPiles: true }))}>{priceData.actor.name}</a>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t<div class=\"item-piles-flexrow\" style=\"margin: 0 0.25rem\">\r\n\t\t\t\t\t\t\t\t\t<SliderInput bind:value={priceData.buyPriceModifier}/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t<div class=\"item-piles-flexrow\" style=\"margin: 0 0.25rem\">\r\n\t\t\t\t\t\t\t\t\t<SliderInput bind:value={priceData.sellPriceModifier}/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t<td class=\"small\">\r\n\t\t\t\t\t\t\t\t<button type=\"button\" on:click={remove(index)}><i class=\"fas fa-times\"></i></button>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</table>\r\n\t\t\t{/if}\r\n\r\n\t\t\t<p class=\"item-piles-text-center\">{localize(\"ITEM-PILES.Applications.PriceModifiersEditor.DragDrop\")}</p>\r\n\r\n\t\t</div>\r\n\r\n\t\t<footer>\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={() => { application.close(); }} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .border-highlight {\r\n    padding: 1rem;\r\n    margin: 0.25rem;\r\n    border-radius: 10px;\r\n    border: 2px dashed gray;\r\n  }\r\n\r\n  table {\r\n    vertical-align: middle;\r\n\r\n    tr {\r\n      border-spacing: 15px;\r\n    }\r\n\r\n    .small {\r\n      width: 26px;\r\n    }\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem;\r\n      flex: 0;\r\n      text-align: center;\r\n    }\r\n\r\n    a {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n</style>\r\n","import PriceModifiersEditorShell from './price-modifiers-editor-shell.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class PriceModifiersEditor extends Editor {\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Applications.PriceModifiersEditor.Title\"),\r\n\t\t\twidth: 600,\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: PriceModifiersEditorShell\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n","<script>\r\n\r\n\timport { getDocumentTemplates } from \"../../helpers/utilities.js\";\r\n\r\n\texport let value = \"\";\r\n\texport let templateType;\r\n\texport let required = false;\r\n\r\n\tconst id = \"property-list-\" + foundry.utils.randomID();\r\n\r\n\tconst templates = getDocumentTemplates(templateType);\r\n\r\n\tconst templateObject = {\r\n\t\tname: \"\",\r\n\t\ttype: \"\",\r\n\t\tsystem: Object.values(templates)\r\n\t\t\t.map(obj => {\r\n\t\t\t\tif (obj['templates']) {\r\n\t\t\t\t\tfor (const template of obj['templates']) {\r\n\t\t\t\t\t\tobj = foundry.utils.mergeObject(obj, templates[\"templates\"][template]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdelete obj['templates'];\r\n\t\t\t\t}\r\n\t\t\t\treturn obj;\r\n\t\t\t})\r\n\t\t\t.reduce((acc, obj) => {\r\n\t\t\t\treturn foundry.utils.mergeObject(acc, obj);\r\n\t\t\t}, {})\r\n\t};\r\n\r\n\tlet suggestions = [];\r\n\t$: {\r\n\t\tlet trimmedValue = value.trim();\r\n\t\tlet options = foundry.utils.getProperty(templateObject, trimmedValue);\r\n\t\tif (!options) {\r\n\t\t\ttrimmedValue = trimmedValue.split(\".\").slice(0, -1).join(\".\")\r\n\t\t\toptions = foundry.utils.getProperty(templateObject, trimmedValue);\r\n\t\t}\r\n\t\tsuggestions = options ? Object.keys(options).map(t => trimmedValue + \".\" + t).sort() : Object.keys(templateObject);\r\n\t}\r\n\r\n</script>\r\n\r\n<input bind:value list={id} required={required} type=\"text\"/>\r\n<datalist id={id}>\r\n\t{#each suggestions as suggestion}\r\n\t\t<option>{suggestion}</option>\r\n\t{/each}\r\n</datalist>\r\n","<script>\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\timport { getContext } from 'svelte';\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { get, writable } from \"svelte/store\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\tlet form;\r\n\r\n\texport let elementRoot;\r\n\texport let data;\r\n\r\n\tconst keyValuePair = application.options?.keyValuePair ?? false;\r\n\tconst stringListStore = writable(data);\r\n\r\n\tfunction add() {\r\n\t\tstringListStore.update(val => {\r\n\t\t\tif (keyValuePair) {\r\n\t\t\t\tval.push([\"\", \"\"]);\r\n\t\t\t} else {\r\n\t\t\t\tval.push(\"\");\r\n\t\t\t}\r\n\t\t\treturn val;\r\n\t\t})\r\n\t}\r\n\r\n\tfunction remove(index) {\r\n\t\tstringListStore.update(val => {\r\n\t\t\tval.splice(index, 1);\r\n\t\t\treturn val;\r\n\t\t})\r\n\t}\r\n\r\n\tasync function updateSettings() {\r\n\t\tapplication.options.resolve(get(stringListStore));\r\n\t\tapplication.close();\r\n\t}\r\n\r\n\texport function requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\t<form autocomplete=off bind:this={form} on:submit|preventDefault={updateSettings}>\r\n\r\n\t\t{#if application.options.content}\r\n\t\t\t<p>{localize(application.options.content)}</p>\r\n\t\t{/if}\r\n\r\n\t\t<table>\r\n\t\t\t<tr>\r\n\t\t\t\t{#if keyValuePair}\r\n\t\t\t\t\t<th>{localize(application.options?.columnKey)}</th>\r\n\t\t\t\t{/if}\r\n\t\t\t\t<th>{localize(application.options?.column)}</th>\r\n\t\t\t\t<th class=\"small\"><a class=\"item-piles-clickable\" on:click={add}><i class=\"fas fa-plus\"></i></a></th>\r\n\t\t\t</tr>\r\n\t\t\t{#if keyValuePair}\r\n\t\t\t\t{#each $stringListStore as [key, path], index (index)}\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td><input type=\"text\" required bind:value=\"{key}\"/></td>\r\n\t\t\t\t\t\t<td><input type=\"text\" bind:value=\"{path}\"/></td>\r\n\t\t\t\t\t\t<td class=\"small\">\r\n\t\t\t\t\t\t\t<button type=\"button\" on:click={remove(index)}><i class=\"fas fa-times\"></i></button>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t{/each}\r\n\t\t\t{:else}\r\n\t\t\t\t{#each $stringListStore as path, index (index)}\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td><input type=\"text\" required bind:value=\"{path}\"/></td>\r\n\t\t\t\t\t\t<td class=\"small\">\r\n\t\t\t\t\t\t\t<button type=\"button\" on:click={remove(index)}><i class=\"fas fa-times\"></i></button>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t{/each}\r\n\t\t\t{/if}\r\n\t\t</table>\r\n\r\n\t\t<footer>\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={() => { application.close(); }} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  table {\r\n    vertical-align: middle;\r\n\r\n    tr {\r\n      border-spacing: 15px;\r\n    }\r\n\r\n    .small {\r\n      width: 26px;\r\n    }\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem;\r\n      flex: 0;\r\n      text-align: center;\r\n    }\r\n\r\n    a {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n</style>\r\n","import StringListEditorShell from './string-list-editor.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class StringListEditor extends Editor {\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: StringListEditorShell\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n","<script>\r\n\timport { getContext } from 'svelte';\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\timport { get, writable } from \"svelte/store\";\r\n\timport PropertyPathInput from \"../../components/PropertyPathInput.svelte\";\r\n\timport StringListEditor from \"../string-list-editor/string-list-editor.js\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\tlet form;\r\n\r\n\texport let data;\r\n\texport let elementRoot;\r\n\r\n\tconst merchantColumns = writable(data);\r\n\r\n\tfunction addColumn() {\r\n\t\tmerchantColumns.update(value => {\r\n\t\t\tvalue.push({\r\n\t\t\t\tlabel: \"\",\r\n\t\t\t\tpath: \"\",\r\n\t\t\t\tformatting: \"{#}\",\r\n\t\t\t\tmapping: {},\r\n\t\t\t\tbuying: true,\r\n\t\t\t\tselling: true\r\n\t\t\t});\r\n\t\t\treturn value;\r\n\t\t});\r\n\t}\r\n\r\n\tfunction removeColumn(index) {\r\n\t\tmerchantColumns.update(value => {\r\n\t\t\tvalue.splice(index, 1)\r\n\t\t\treturn value;\r\n\t\t})\r\n\t}\r\n\r\n\tasync function showMappingEditor(index) {\r\n\t\tconst data = get(merchantColumns)[index];\r\n\t\treturn StringListEditor.show(\r\n\t\t\tObject.entries(data.mapping),\r\n\t\t\t{\r\n\t\t\t\tid: `merchant-columns-mapping-editor-${data.path}`,\r\n\t\t\t\ttitle: localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.MappingTitle\", { label: data.label }),\r\n\t\t\t\tcontent: localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.MappingContent\"),\r\n\t\t\t\tkeyValuePair: true,\r\n\t\t\t}\r\n\t\t).then((result) => {\r\n\t\t\tmerchantColumns.update(value => {\r\n\t\t\t\tvalue[index].mapping = Object.fromEntries(result);\r\n\t\t\t\treturn value;\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n\tasync function updateSettings() {\r\n\t\tapplication.options.resolve(get(merchantColumns));\r\n\t\tapplication.close();\r\n\t}\r\n\r\n\texport function requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form autocomplete=off bind:this={form} on:submit|preventDefault={updateSettings}>\r\n\r\n\t\t<p style=\"text-align: center;\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.Explanation\")}\r\n\t\t</p>\r\n\r\n\t\t<div class=\"form-group item-pile-column-grid item-piles-top-divider\">\r\n\t\t\t<div class=\"item-piles-grid-row-wrapper\">\r\n\t\t\t\t<div style=\"text-align: left;\">\r\n\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.Label\")}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.PropertyPath\")}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.Formatting\")}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.Buying\")}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.Selling\")}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"item-piles-flexcol\"></div>\r\n\t\t\t\t<a on:click={() => addColumn()} style=\"margin-right: 0.5rem;\">\r\n\t\t\t\t\t<i class=\"fas fa-plus\"></i>\r\n\t\t\t\t</a>\r\n\t\t\t</div>\r\n\r\n\t\t\t{#each $merchantColumns as column, index}\r\n\t\t\t\t<div class=\"item-piles-grid-row-wrapper\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<input type=\"text\" bind:value={column.label} required/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<PropertyPathInput bind:value={column.path} templateType=\"Item\" required/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<input type=\"text\" bind:value={column.formatting} required/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={column.buying}/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={column.selling}/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<button type=\"button\" on:click={() => showMappingEditor(index)} disabled={!column.label || !column.path}>\r\n\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.ConfigureMapping\")}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<a on:click={() => removeColumn(index)} class=\"item-piles-clickable-red\"\r\n\t\t\t\t\t   style=\"margin-right: 0.5rem; text-align: center;\">\r\n\t\t\t\t\t\t<i class=\"fas fa-times\"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\r\n\t\t<footer class=\"item-piles-top-divider\">\r\n\t\t\t<button on:click={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> { localize(\"Save\") }\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={() => { application.close(); }} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-pile-column-grid {\r\n    display: grid;\r\n    grid-template-columns: 1fr 1fr 0.5fr 50px 50px 1fr auto;\r\n    gap: 4px;\r\n\r\n    select {\r\n      width: 100%;\r\n    }\r\n\r\n    .item-piles-grid-row-wrapper {\r\n      display: contents;\r\n      border-bottom: 1px solid rgba(0, 0, 0, 0.5);\r\n\r\n      & > div {\r\n        display: flex;\r\n        justify-content: center;\r\n      }\r\n\r\n      button {\r\n        line-height: 1.3rem;\r\n      }\r\n    }\r\n\r\n    .item-piles-grid-row-wrapper:first-of-type {\r\n      & > div {\r\n        display: block;\r\n        margin-bottom: 0.25rem;\r\n        text-align: center;\r\n\r\n        > div {\r\n          font-size: 0.75rem;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n</style>\r\n","import MerchantColumnsEditorShell from \"./merchant-columns-editor-shell.svelte\";\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class MerchantColumnsEditor extends Editor {\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\ttitle: \"ITEM-PILES.Applications.MerchantColumnsEditor.Title\",\r\n\t\t\twidth: 600,\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: MerchantColumnsEditorShell\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n","<script>\r\n\r\n\timport ItemTypePriceModifiersEditor\r\n\t\tfrom \"../../editors/item-type-price-modifiers-editor/item-type-price-modifiers-editor.js\";\r\n\timport PriceModifiersEditor from \"../../editors/price-modifiers-editor/price-modifiers-editor.js\";\r\n\timport FilePicker from \"../../components/FilePicker.svelte\";\r\n\timport SliderInput from \"../../components/SliderInput.svelte\";\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\timport MerchantColumnsEditor from \"../../editors/merchant-columns-editor/merchant-columns-editor.js\";\r\n\timport { TJSDialog } from \"#runtime/svelte/application\";\r\n\timport CustomDialog from \"../../components/CustomDialog.svelte\";\r\n\timport * as PileUtilities from \"../../../helpers/pile-utilities.js\";\r\n\r\n\texport let pileData;\r\n\texport let pileActor;\r\n\r\n\tconst simpleCalendarActive = game.modules.get('foundryvtt-simple-calendar')?.active;\r\n\r\n\tconst weekdays = (simpleCalendarActive ? window.SimpleCalendar.api.getAllWeekdays() : []).map(weekday => {\r\n\t\tweekday.selected = pileData.closedDays.includes(weekday.name);\r\n\t\treturn weekday;\r\n\t});\r\n\r\n\tconst refreshItemDays = (simpleCalendarActive ? window.SimpleCalendar.api.getAllWeekdays() : []).map(weekday => {\r\n\t\tweekday.selected = pileData.refreshItemsDays.includes(weekday.name);\r\n\t\treturn weekday;\r\n\t});\r\n\r\n\tpileData.closedDays = pileData.closedDays.filter(closedWeekday => {\r\n\t\treturn weekdays.some(weekday => weekday.name === closedWeekday);\r\n\t});\r\n\r\n\tconst holidays = (simpleCalendarActive ? window.SimpleCalendar.api.getCurrentCalendar().noteCategories : []).map(holiday => {\r\n\t\treturn { name: holiday.name, selected: pileData.closedHolidays.includes(holiday.name) };\r\n\t});\r\n\r\n\tpileData.closedHolidays = pileData.closedHolidays.filter(closedHoliday => {\r\n\t\treturn holidays.some(holiday => holiday.name === closedHoliday);\r\n\t});\r\n\r\n\tconst refreshItemsHolidays = (simpleCalendarActive ? window.SimpleCalendar.api.getCurrentCalendar().noteCategories : []).map(holiday => {\r\n\t\treturn { name: holiday.name, selected: pileData.refreshItemsHolidays.includes(holiday.name) };\r\n\t});\r\n\r\n\tpileData.refreshItemsHolidays = pileData.refreshItemsHolidays.filter(refreshItemsHoliday => {\r\n\t\treturn refreshItemsHolidays.some(holiday => holiday.name === refreshItemsHoliday);\r\n\t});\r\n\r\n\tasync function showItemTypePriceModifiers() {\r\n\t\tconst data = pileData.itemTypePriceModifiers || [];\r\n\t\treturn ItemTypePriceModifiersEditor.show(\r\n\t\t\tdata,\r\n\t\t\t{ id: `item-type-price-modifier-item-pile-config-${pileActor.id}` },\r\n\t\t\t{ title: localize(\"ITEM-PILES.Applications.ItemTypePriceModifiersEditor.TitleActor\", { actor_name: pileActor.name }), }\r\n\t\t).then((result) => {\r\n\t\t\tpileData.itemTypePriceModifiers = result || [];\r\n\t\t});\r\n\t}\r\n\r\n\tasync function showActorPriceModifiers() {\r\n\t\tconst data = pileData.actorPriceModifiers || [];\r\n\t\treturn PriceModifiersEditor.show(\r\n\t\t\tdata,\r\n\t\t\t{ id: `price-modifier-item-pile-config-${pileActor.id}` },\r\n\t\t\t{ title: localize(\"ITEM-PILES.Applications.PriceModifiersEditor.TitleActor\", { actor_name: pileActor.name }), }\r\n\t\t).then((result) => {\r\n\t\t\tpileData.actorPriceModifiers = result || [];\r\n\t\t\tpileData.actorPriceModifiers.forEach(modifier => {\r\n\t\t\t\tif (modifier.actor) {\r\n\t\t\t\t\tdelete modifier['actor'];\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n\tasync function showMerchantColumns() {\r\n\t\tconst data = Array.isArray(pileData.merchantColumns) ? pileData.merchantColumns : [];\r\n\t\treturn MerchantColumnsEditor.show(\r\n\t\t\tdata,\r\n\t\t\t{ id: `merchant-columns-item-pile-config-${pileActor.id}` },\r\n\t\t\t{ title: localize(\"ITEM-PILES.Applications.MerchantColumnsEditor.TitleActor\", { actor_name: pileActor.name }), }\r\n\t\t).then((result) => {\r\n\t\t\tpileData.merchantColumns = Array.isArray(result) ? result : [];\r\n\t\t});\r\n\t}\r\n\r\n\tasync function clearLog() {\r\n\t\tconst doThing = await TJSDialog.confirm({\r\n\t\t\tid: `sharing-dialog-item-pile-config-${pileActor.id}`,\r\n\t\t\ttitle: \"Item Piles - \" + localize(\"ITEM-PILES.Dialogs.ClearMerchantLog.Title\"),\r\n\t\t\tcontent: {\r\n\t\t\t\tclass: CustomDialog,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\theader: localize(\"ITEM-PILES.Dialogs.ClearMerchantLog.Title\"),\r\n\t\t\t\t\tcontent: localize(\"ITEM-PILES.Dialogs.ClearMerchantLog.Content\", { actor_name: pileActor.name })\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tmodal: true\r\n\t\t});\r\n\t\tif (!doThing) return;\r\n\t\treturn PileUtilities.clearActorLog(pileActor);\r\n\t}\r\n\r\n</script>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.MerchantImage\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.MerchantImageExplanation\")}</p>\r\n\t</label>\r\n\t<div class=\"form-fields\">\r\n\t\t<FilePicker bind:value={pileData.merchantImage} placeholder=\"path/image.png\" type=\"imagevideo\"/>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.InfiniteQuantity\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.InfiniteQuantityExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.infiniteQuantity} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.InfiniteCurrency\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.InfiniteCurrencyExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.infiniteCurrencies} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.KeepZero\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.KeepZeroExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.keepZeroQuantity} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.DisplayQuantity\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.DisplayQuantityExplanation\")}</p>\r\n\t</label>\r\n\t<div class=\"break\"></div>\r\n\t<select bind:value={pileData.displayQuantity} style=\"flex:4;\">\r\n\t\t<option value=\"yes\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.DisplayQuantityYes\")}\r\n\t\t</option>\r\n\t\t<option value=\"no\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.DisplayQuantityNo\")}\r\n\t\t</option>\r\n\t\t<option value=\"alwaysyes\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.DisplayQuantityYesAlways\")}\r\n\t\t</option>\r\n\t\t<option value=\"alwaysno\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.DisplayQuantityNoAlways\")}\r\n\t\t</option>\r\n\t</select>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.PurchaseOnly\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.PurchaseOnlyExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.purchaseOnly} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.HideNewItems\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.HideNewItemsExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.hideNewItems} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.HideItemsWithZeroCost\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.HideItemsWithZeroCostExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.hideItemsWithZeroCost} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OnlyAcceptBasePrice\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OnlyAcceptBasePriceExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.onlyAcceptBasePrice} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.LogMerchantActivity\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.LogMerchantActivityExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.logMerchantActivity} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ClearMerchantLog\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ClearMerchantLogExplanation\")}</p>\r\n\t</label>\r\n\t<button on:click={() => clearLog()} style=\"flex:2;\" type=\"button\">\r\n\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ClearMerchantLog\")}\r\n\t</button>\r\n</div>\r\n\r\n<div class=\"form-group slider-group\">\r\n\t<label style=\"flex:3;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.PriceModifierTitle\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.PriceModifierExplanation\")}</p>\r\n\t</label>\r\n</div>\r\n\r\n<div class=\"form-group slider-group\">\r\n\t<label style=\"flex:3;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.BuyPriceModifier\")}</span>\r\n\t</label>\r\n\t<SliderInput bind:value={pileData.buyPriceModifier} style=\"flex:4;\"/>\r\n</div>\r\n\r\n<div class=\"form-group slider-group\">\r\n\t<label style=\"flex:3;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.SellPriceModifier\")}</span>\r\n\t</label>\r\n\t<SliderInput bind:value={pileData.sellPriceModifier} style=\"flex:4;\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<div class=\"item-piles-flexcol\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ItemTypeModifier\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ItemTypeModifiersExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<button on:click={() => { showItemTypePriceModifiers() }} type=\"button\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ConfigureItemTypePriceModifiers\")}\r\n\t\t</button>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<div class=\"item-piles-flexcol\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ActorPriceModifiers\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ActorPriceModifiersExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<button on:click={() => { showActorPriceModifiers() }} type=\"button\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ConfigureActorPriceModifiers\")}\r\n\t\t</button>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<div class=\"item-piles-flexcol\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.MerchantColumns\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.MerchantColumnsExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<button on:click={() => { showMerchantColumns() }} type=\"button\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ConfigureMerchantColumns\")}\r\n\t\t</button>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OpenStatus\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OpenStatusExplanation\")}</p>\r\n\t</label>\r\n\t<div class=\"break\"></div>\r\n\t<select bind:value={pileData.openTimes.status} style=\"flex:4;\">\r\n\t\t<option value=\"open\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OpenStatusOpen\")}\r\n\t\t</option>\r\n\t\t<option value=\"closed\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OpenStatusClosed\")}\r\n\t\t</option>\r\n\t\t{#if simpleCalendarActive && pileData.openTimes.enabled}\r\n\t\t\t<option value=\"auto\">\r\n\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OpenStatusAuto\")}\r\n\t\t\t</option>\r\n\t\t{/if}\r\n\t</select>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.HideTokenWhenClosed\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.HideTokenWhenClosedExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.hideTokenWhenClosed} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OpenTimes\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.OpenTimesExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.openTimes.enabled} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\" class:item-piles-disabled={!pileData.openTimes.enabled}>\r\n\t<div class=\"item-piles-flexcol\" style=\"margin-right:1rem\">\r\n\t\t<label class=\"item-piles-text-center\">\r\n\t\t\tOpen Time:\r\n\t\t</label>\r\n\t\t<div class=\"item-piles-flexrow\">\r\n\t\t\t<input bind:value=\"{pileData.openTimes.open.hour}\" disabled=\"{!pileData.openTimes.enabled}\"\r\n\t\t\t       style=\"text-align: right;\"\r\n\t\t\t       type=\"number\"/>\r\n\t\t\t<span style=\"flex: 0; line-height:1.7; margin: 0 0.25rem;\">:</span>\r\n\t\t\t<input bind:value=\"{pileData.openTimes.open.minute}\" disabled=\"{!pileData.openTimes.enabled}\"\r\n\t\t\t       type=\"number\"/>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class=\"item-piles-flexcol\">\r\n\t\t<label class=\"item-piles-text-center\">\r\n\t\t\tClose Time:\r\n\t\t</label>\r\n\t\t<div class=\"item-piles-flexrow\">\r\n\t\t\t<input bind:value=\"{pileData.openTimes.close.hour}\" disabled=\"{!pileData.openTimes.enabled}\"\r\n\t\t\t       style=\"text-align: right;\"\r\n\t\t\t       type=\"number\"/>\r\n\t\t\t<span style=\"flex: 0; line-height:1.7; margin: 0 0.25rem;\">:</span>\r\n\t\t\t<input bind:value=\"{pileData.openTimes.close.minute}\" disabled=\"{!pileData.openTimes.enabled}\"\r\n\t\t\t       type=\"number\"/>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n{#if simpleCalendarActive}\r\n\r\n\t<div class=\"form-group\" class:item-piles-disabled={!pileData.openTimes.enabled}>\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ClosedDays\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ClosedDaysExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<div class=\"break\"></div>\r\n\t\t<div class=\"item-piles-flexrow\" style=\"text-align: center;\">\r\n\t\t\t{#each weekdays as weekday (weekday.id + \"-weekday-close\")}\r\n\t\t\t\t<div class=\"item-piles-flexcol\" style=\"align-items: center;\">\r\n\t\t\t\t\t<label>{weekday.abbreviation}</label>\r\n\t\t\t\t\t<input type=\"checkbox\"\r\n\t\t\t\t\t       bind:checked={weekday.selected}\r\n\t\t\t\t\t       disabled={!pileData.openTimes.enabled}\r\n\t\t\t\t\t       on:change={() => {\r\n                 let weekdaySet = new Set(pileData.closedDays);\r\n                 if(weekday.selected){\r\n                   weekdaySet.add(weekday.name)\r\n                 }else{\r\n                   weekdaySet.delete(weekday.name)\r\n                 }\r\n                 pileData.closedDays = Array.from(weekdaySet);\r\n               }}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\" class:item-piles-disabled={!pileData.openTimes.enabled}>\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ClosedHolidays\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.ClosedHolidaysExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<div class=\"break\"></div>\r\n\t\t<div style=\"display: grid; grid-template-columns: 1fr 1fr;\">\r\n\t\t\t{#each holidays as holiday, index (holiday.name + \"-\" + index)}\r\n\t\t\t\t<div class=\"item-piles-flexrow\" style=\"flex:0 1 auto;\">\r\n\t\t\t\t\t<input type=\"checkbox\"\r\n\t\t\t\t\t       bind:checked={holiday.selected}\r\n\t\t\t\t\t       disabled={!pileData.openTimes.enabled}\r\n\t\t\t\t\t       on:change={() => {\r\n                 let holidaySet = new Set(pileData.closedHolidays);\r\n                 if(holiday.selected){\r\n                   holidaySet.add(holiday.name)\r\n                 }else{\r\n                   holidaySet.delete(holiday.name)\r\n                 }\r\n                 pileData.closedHolidays = Array.from(holidaySet);\r\n               }}/>\r\n\t\t\t\t\t<label>{holiday.name}</label>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=\"form-group item-piles-top-divider\">\r\n\t\t<label>\r\n\t\t\t<p style=\"color: #c02609;\">\r\n\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.RefreshItemsWarning\")}\r\n\t\t\t</p>\r\n\t\t</label>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\" class:item-piles-disabled={!pileData.openTimes.enabled}>\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.RefreshItemsOnOpen\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.RefreshItemsOnOpenExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<input type=\"checkbox\" bind:checked={pileData.refreshItemsOnOpen} disabled={!pileData.openTimes.enabled}/>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\" class:item-piles-disabled={!pileData.openTimes.enabled}>\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.RefreshItemsDays\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.RefreshItemsDaysExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<div class=\"break\"></div>\r\n\t\t<div class=\"item-piles-flexrow\" style=\"text-align: center;\">\r\n\t\t\t{#each refreshItemDays as weekday (weekday.id + \"-weekday-refresh\")}\r\n\t\t\t\t<div class=\"item-piles-flexcol\" style=\"align-items: center;\">\r\n\t\t\t\t\t<label>{weekday.abbreviation}</label>\r\n\t\t\t\t\t<input type=\"checkbox\"\r\n\t\t\t\t\t       bind:checked={weekday.selected}\r\n\t\t\t\t\t       disabled={!pileData.openTimes.enabled}\r\n\t\t\t\t\t       on:change={() => {\r\n                 let weekdaySet = new Set(pileData.refreshItemsDays);\r\n                 if(weekday.selected){\r\n                   weekdaySet.add(weekday.name)\r\n                 }else{\r\n                   weekdaySet.delete(weekday.name)\r\n                 }\r\n                 pileData.refreshItemsDays = Array.from(weekdaySet);\r\n               }}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\" class:item-piles-disabled={!pileData.openTimes.enabled}>\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.RefreshItemsHolidays\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Merchant.RefreshItemsHolidaysExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<div class=\"break\"></div>\r\n\t\t<div style=\"display: grid; grid-template-columns: 1fr 1fr;\">\r\n\t\t\t{#each refreshItemsHolidays as holiday, index (holiday.name + \"-remove-\" + index)}\r\n\t\t\t\t<div class=\"item-piles-flexrow\" style=\"flex:0 1 auto;\">\r\n\t\t\t\t\t<input type=\"checkbox\"\r\n\t\t\t\t\t       bind:checked={holiday.selected}\r\n\t\t\t\t\t       disabled={!pileData.openTimes.enabled}\r\n\t\t\t\t\t       on:change={() => {\r\n\t\t\t\t\t\t\t\t\t let holidaySet = new Set(pileData.refreshItemsHolidays);\r\n\t\t\t\t\t\t\t\t\t if(holiday.selected){\r\n\t\t\t\t\t\t\t\t\t\t holidaySet.add(holiday.name)\r\n\t\t\t\t\t\t\t\t\t }else{\r\n\t\t\t\t\t\t\t\t\t\t holidaySet.delete(holiday.name)\r\n\t\t\t\t\t\t\t\t\t }\r\n\t\t\t\t\t\t\t\t\t pileData.refreshItemsHolidays = Array.from(holidaySet);\r\n\t\t\t\t\t\t\t\t }}/>\r\n\t\t\t\t\t<label>{holiday.name}</label>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\t</div>\r\n\r\n{/if}\r\n\r\n\r\n<style>\r\n    .form-group {\r\n        border-radius: 5px;\r\n    }\r\n</style>\r\n","<script>\r\n\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\r\n\texport let pileData;\r\n\r\n</script>\r\n\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.SingleItem.DisplayOne\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.SingleItem.DisplayOneExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.displayOne} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"item-pile-display-one-settings\">\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.SingleItem.ItemName\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.SingleItem.ItemNameExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<input bind:checked={pileData.showItemName} type=\"checkbox\"/>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.SingleItem.OverrideScale\")}</span>\r\n\t\t</label>\r\n\t\t<input bind:checked={pileData.overrideSingleItemScale} type=\"checkbox\"/>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\" class:item-piles-disabled={!pileData.overrideSingleItemScale}>\r\n\t\t<label style=\"flex:3;\">\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.SingleItem.Scale\")}</span>\r\n\t\t</label>\r\n\t\t<input bind:value=\"{pileData.singleItemScale}\" class=\"item-piles-scaleRange\"\r\n\t\t       disabled=\"{!pileData.overrideSingleItemScale}\" max=\"3\" min=\"0.2\" step=\"0.01\"\r\n\t\t       style=\"flex:3;\" type=\"range\"/>\r\n\t\t<input bind:value=\"{pileData.singleItemScale}\" class=\"item-piles-scaleInput\"\r\n\t\t       disabled=\"{!pileData.overrideSingleItemScale}\" step=\"0.01\"\r\n\t\t       style=\"flex:0.5; margin-left:1rem;\" type=\"number\"/>\r\n\t</div>\r\n\r\n</div>\r\n","<script>\r\n\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\timport FilePicker from \"../../components/FilePicker.svelte\";\r\n\r\n\texport let pileData;\r\n\r\n</script>\r\n\r\n<div class=\"form-group\">\r\n\t<label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.Closed\")}</label>\r\n\t<input bind:checked={pileData.closed} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.Locked\")}</label>\r\n\t<input bind:checked={pileData.locked} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.ClosedImagePath\")}</label>\r\n\t<div class=\"form-fields\">\r\n\t\t<FilePicker bind:value={pileData.closedImage} placeholder=\"path/image.png\" type=\"imagevideo\"/>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.OpenedImagePath\")}</label>\r\n\t<div class=\"form-fields\">\r\n\t\t<FilePicker bind:value={pileData.openedImage} placeholder=\"path/image.png\" type=\"imagevideo\"/>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.EmptyImagePath\")}</label>\r\n\t<div class=\"form-fields\">\r\n\t\t<FilePicker bind:value={pileData.emptyImage} placeholder=\"path/image.png\" type=\"imagevideo\"/>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.LockedImagePath\")}</label>\r\n\t<div class=\"form-fields\">\r\n\t\t<FilePicker bind:value={pileData.lockedImage} placeholder=\"path/image.png\" type=\"imagevideo\"/>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.CloseSoundPath\")}</label>\r\n\t<div class=\"form-fields\">\r\n\t\t<FilePicker bind:value={pileData.closeSound} placeholder=\"path/sound.wav\" type=\"audio\"/>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.OpenSoundPath\")}</label>\r\n\t<div class=\"form-fields\">\r\n\t\t<FilePicker bind:value={pileData.openSound} placeholder=\"path/sound.wav\" type=\"audio\"/>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Container.LockedSoundPath\")}</label>\r\n\t<div class=\"form-fields\">\r\n\t\t<FilePicker bind:value={pileData.lockedSound} placeholder=\"path/sound.wav\" type=\"audio\"/>\r\n\t</div>\r\n</div>\r\n","<script>\r\n\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\timport { TJSDialog } from \"#runtime/svelte/application\";\r\n\timport CustomDialog from \"../../components/CustomDialog.svelte\";\r\n\timport * as SharingUtilities from \"../../../helpers/sharing-utilities.js\";\r\n\r\n\texport let pileData;\r\n\texport let pileActor;\r\n\r\n\tasync function resetSharingData() {\r\n\t\tconst doThing = await TJSDialog.confirm({\r\n\t\t\tid: `sharing-dialog-item-pile-config-${pileActor.id}`,\r\n\t\t\ttitle: \"Item Piles - \" + game.i18n.localize(\"ITEM-PILES.Dialogs.ResetSharingData.Title\"),\r\n\t\t\tcontent: {\r\n\t\t\t\tclass: CustomDialog,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\theader: game.i18n.localize(\"ITEM-PILES.Dialogs.ResetSharingData.Title\"),\r\n\t\t\t\t\tcontent: game.i18n.localize(\"ITEM-PILES.Dialogs.ResetSharingData.Content\")\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tbuttons: {\r\n\t\t\t\tyes: {\r\n\t\t\t\t\ticon: '<i class=\"fas fa-check\"></i>',\r\n\t\t\t\t\tlabel: game.i18n.localize(\"ITEM-PILES.Dialogs.ResetSharingData.Confirm\"),\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmodal: true\r\n\t\t});\r\n\t\tif (!doThing) return;\r\n\t\treturn SharingUtilities.clearItemPileSharingData(pileActor);\r\n\t}\r\n\r\n</script>\r\n\r\n<details class=\"item-piles-collapsible item-piles-clickable\">\r\n\r\n\t<summary>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.Title\")}</summary>\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.ShareItemsEnabled\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.ShareItemsEnabledExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<input bind:checked={pileData.shareItemsEnabled} type=\"checkbox\"/>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.ShareCurrenciesEnabled\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.ShareCurrenciesEnabledExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<input bind:checked={pileData.shareCurrenciesEnabled} type=\"checkbox\"/>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.TakeAllEnabled\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.TakeAllEnabledExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<input bind:checked={pileData.takeAllEnabled} type=\"checkbox\"/>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.SplitAllEnabled\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.SplitAllEnabledExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<input bind:checked={pileData.splitAllEnabled} type=\"checkbox\"/>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<label>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.InactivePlayers\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.InactivePlayersExplanation\")}</p>\r\n\t\t</label>\r\n\t\t<input bind:checked={pileData.activePlayers} type=\"checkbox\"/>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<label style=\"flex:4;\">\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.ResetSharingData\")}</span>\r\n\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.ResetSharingDataExplanation\")}</p>\r\n\t\t</label>\r\n\t</div>\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<button class=\"item-piles-config-reset-sharing-data\" on:click={() => { resetSharingData() }} style=\"flex:4;\"\r\n\t\t        type=\"button\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Sharing.ResetSharingData\")}\r\n\t\t</button>\r\n\t</div>\r\n\r\n</details>\r\n","<script>\r\n\timport { getContext } from 'svelte';\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\timport { get, writable } from \"svelte/store\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\tlet form;\r\n\r\n\texport let data;\r\n\texport let elementRoot;\r\n\r\n\tconst vaultAccessStore = writable(data.map(access => {\r\n\t\treturn foundry.utils.mergeObject({\r\n\t\t\tview: true,\r\n\t\t\torganize: true,\r\n\t\t\titems: {\r\n\t\t\t\twithdraw: true,\r\n\t\t\t\tdeposit: true\r\n\t\t\t},\r\n\t\t\tcurrencies: {\r\n\t\t\t\twithdraw: true,\r\n\t\t\t\tdeposit: true\r\n\t\t\t}\r\n\t\t}, access)\r\n\t}));\r\n\r\n\tconst validUsers = Array.from(game.users).filter(user => !user.isGM);\r\n\r\n\tconst validActors = Array.from(game.actors).filter(actor => actor.hasPlayerOwner);\r\n\r\n\tconst validDocs = validUsers.concat(validActors).map(document => ({ uuid: document.uuid, document }));\r\n\r\n\t$: validDocuments = validDocs.filter(document => !$vaultAccessStore.some(access => access.uuid === document.uuid))\r\n\t$: validUuids = new Set(validDocuments.map(document => document.uuid));\r\n\r\n\tfunction addAccess() {\r\n\t\tif (!validDocuments.length) return\r\n\t\tvaultAccessStore.update(value => {\r\n\t\t\tvalue.push({\r\n\t\t\t\tuuid: validDocuments[0].uuid,\r\n\t\t\t\tdocument: validDocuments[0].document,\r\n\t\t\t\tview: true,\r\n\t\t\t\torganize: true,\r\n\t\t\t\titems: {\r\n\t\t\t\t\twithdraw: true,\r\n\t\t\t\t\tdeposit: true\r\n\t\t\t\t},\r\n\t\t\t\tcurrencies: {\r\n\t\t\t\t\twithdraw: true,\r\n\t\t\t\t\tdeposit: true\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn value;\r\n\t\t});\r\n\t}\r\n\r\n\tfunction removeAccess(index) {\r\n\t\tvaultAccessStore.update(value => {\r\n\t\t\tvalue.splice(index, 1)\r\n\t\t\treturn value;\r\n\t\t})\r\n\t}\r\n\r\n\tasync function updateSettings() {\r\n\t\tapplication.options.resolve?.(get(vaultAccessStore).map(access => {\r\n\t\t\tdelete access.document;\r\n\t\t\treturn access;\r\n\t\t}));\r\n\t\tapplication.close();\r\n\t}\r\n\r\n\texport function requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n\tfunction preventDefault(event) {\r\n\t\tevent.preventDefault();\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form autocomplete=off bind:this={form} on:submit|preventDefault={updateSettings}>\r\n\r\n\t\t<p style=\"text-align: center;\">\r\n\t\t\t{localize(\"ITEM-PILES.Applications.VaultAccessEditor.Explanation\")}\r\n\t\t</p>\r\n\r\n\t\t<div class=\"form-group item-pile-access-grid\">\r\n\t\t\t<div class=\"item-piles-grid-row-wrapper\">\r\n\t\t\t\t<div style=\"text-align: left;\">\r\n\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.VaultAccessEditor.Character\")}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.VaultAccessEditor.View\")}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.VaultAccessEditor.Organize\")}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\t\t\t\t\t<span>{localize(\"ITEM-PILES.Items\")}</span>\r\n\t\t\t\t\t<div><i>{localize(\"ITEM-PILES.Applications.VaultAccessEditor.Withdraw\")}</i> |\r\n\t\t\t\t\t\t<i>{localize(\"ITEM-PILES.Applications.VaultAccessEditor.Deposit\")}</i></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\t\t\t\t\t<span>{localize(\"ITEM-PILES.Currencies\")}</span>\r\n\t\t\t\t\t<div><i>{localize(\"ITEM-PILES.Applications.VaultAccessEditor.Withdraw\")}</i> |\r\n\t\t\t\t\t\t<i>{localize(\"ITEM-PILES.Applications.VaultAccessEditor.Deposit\")}</i></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<a on:click={() => addAccess()} style=\"margin-right: 0.5rem;\">\r\n\t\t\t\t\t<i class=\"fas fa-plus\"></i>\r\n\t\t\t\t</a>\r\n\t\t\t</div>\r\n\r\n\t\t\t{#each $vaultAccessStore as access, index (access.uuid)}\r\n\t\t\t\t<div class=\"item-piles-grid-row-wrapper\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<select bind:value={access.uuid}>\r\n\t\t\t\t\t\t\t{#each validDocs as document (document.uuid)}\r\n\t\t\t\t\t\t\t\t{#if access.uuid === document.uuid || validUuids.has(document.uuid)}\r\n\t\t\t\t\t\t\t\t\t<option value={document.uuid}>{document.document.name}</option>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div style=\"text-align: center;\">\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={access.view}>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div style=\"text-align: center;\">\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={access.organize}>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div style=\"text-align: center;\">\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={access.items.withdraw}>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={access.items.deposit}>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div style=\"text-align: center;\">\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={access.currencies.withdraw}>\r\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={access.currencies.deposit}>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<a on:click={() => removeAccess(index)} class=\"item-piles-clickable-red\" style=\"margin-right: 0.5rem;\">\r\n\t\t\t\t\t\t<i class=\"fas fa-times\"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\r\n\t\t<footer class=\"item-piles-top-divider\">\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={() => { application.close(); }} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-pile-access-grid {\r\n    display: grid;\r\n    grid-template-columns: 1.5fr 0.5fr 0.5fr 1fr 1fr auto;\r\n    gap: 4px;\r\n\r\n    select {\r\n      width: 100%;\r\n    }\r\n\r\n    .item-piles-grid-row-wrapper {\r\n      display: contents;\r\n      border-bottom: 1px solid rgba(0, 0, 0, 0.5);\r\n    }\r\n\r\n    .item-piles-grid-row-wrapper:first-of-type {\r\n      > div {\r\n        margin-bottom: 0.25rem;\r\n        text-align: center;\r\n\r\n        > div {\r\n          font-size: 0.75rem;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n</style>\r\n","import VaultAccessEditorShell from './vault-access-editor-shell.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class VaultAccessEditor extends Editor {\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\ttitle: \"ITEM-PILES.Applications.VaultAccessEditor.Title\",\r\n\t\t\twidth: 600,\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: VaultAccessEditorShell\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n","<script>\r\n\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\timport VaultAccessEditor from \"../../editors/vault-access-editor/vault-access-editor.js\";\r\n\timport { TJSDialog } from \"#runtime/svelte/application\";\r\n\timport CustomDialog from \"../../components/CustomDialog.svelte\";\r\n\timport * as PileUtilities from \"../../../helpers/pile-utilities.js\";\r\n\timport CONSTANTS from \"../../../constants/constants.js\";\r\n\r\n\texport let pileData;\r\n\texport let pileActor;\r\n\r\n\tasync function showVaultAccessEditor() {\r\n\t\tconst data = pileData.vaultAccess || [];\r\n\t\treturn VaultAccessEditor.show(data, {\r\n\t\t\tid: `vault-access-editor-item-pile-config-${pileActor.id}`,\r\n\t\t\ttitle: localize(\"ITEM-PILES.Applications.VaultAccessEditor.Title\", { actor_name: pileActor.name }),\r\n\t\t}).then((result) => {\r\n\t\t\tpileData.vaultAccess = result || [];\r\n\t\t});\r\n\t}\r\n\r\n\tasync function clearVaultLog() {\r\n\t\tconst doThing = await TJSDialog.confirm({\r\n\t\t\tid: `sharing-dialog-item-pile-config-${pileActor.id}`,\r\n\t\t\ttitle: \"Item Piles - \" + localize(\"ITEM-PILES.Dialogs.ClearVaultLog.Title\"),\r\n\t\t\tcontent: {\r\n\t\t\t\tclass: CustomDialog,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\theader: localize(\"ITEM-PILES.Dialogs.ClearVaultLog.Title\"),\r\n\t\t\t\t\tcontent: localize(\"ITEM-PILES.Dialogs.ClearVaultLog.Content\", { actor_name: pileActor.name })\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tmodal: true\r\n\t\t});\r\n\t\tif (!doThing) return;\r\n\t\treturn PileUtilities.clearActorLog(pileActor);\r\n\t}\r\n\r\n</script>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:6;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Layout\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LayoutExplanation\")}</p>\r\n\t</label>\r\n\t<div class=\"item-piles-grid-columns\" style=\"flex: 3;\">\r\n\t\t<div style=\"text-align: center; font-size: 0.7rem;\">\r\n\t\t\t<i>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Columns\")}</i>\r\n\t\t\t<i>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Rows\")}</i>\r\n\t\t</div>\r\n\t\t<div style=\"align-items: center;\">\r\n\t\t\t<input bind:value={pileData.cols} placeholder=\"Enter a number...\" style=\"text-align: right;\" type=\"number\"/>\r\n\t\t\t<span style=\"flex: 0;\">x</span>\r\n\t\t\t<input bind:value={pileData.rows} placeholder=\"Enter a number...\" type=\"number\"/>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.EnableExpansion\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.EnableExpansionExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.vaultExpansion} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:6;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.BaseExpansion\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.BaseExpansionExplanation\")}</p>\r\n\t</label>\r\n\t<div class=\"item-piles-grid-columns\" style=\"flex: 3;\">\r\n\t\t<div style=\"text-align: center; font-size: 0.7rem;\">\r\n\t\t\t<i>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Columns\")}</i>\r\n\t\t\t<i>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Rows\")}</i>\r\n\t\t</div>\r\n\t\t<div style=\"align-items: center;\">\r\n\t\t\t<input bind:value={pileData.baseExpansionCols} disabled={!pileData.vaultExpansion} placeholder=\"Enter a number...\"\r\n\t\t\t       style=\"text-align: right;\" type=\"number\"/>\r\n\t\t\t<span style=\"flex: 0;\">x</span>\r\n\t\t\t<input bind:value={pileData.baseExpansionRows} disabled={!pileData.vaultExpansion} placeholder=\"Enter a number...\"\r\n\t\t\t       type=\"number\"/>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.RestrictAccess\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.RestrictAccessExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.restrictVaultAccess} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.Access\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.AccessExplanation\")}</p>\r\n\t</label>\r\n\t<button on:click={() => showVaultAccessEditor()} style=\"flex:2;\" type=\"button\">\r\n\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.ManageAccess\")}\r\n\t</button>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LogVaultAccess\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LogVaultAccessExplanation\")}</p>\r\n\t</label>\r\n\t<input bind:checked={pileData.logVaultActions} type=\"checkbox\"/>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label style=\"flex:4;\">\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.ClearVaultLog\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.ClearVaultLogExplanation\")}</p>\r\n\t</label>\r\n\t<button on:click={() => clearVaultLog()} style=\"flex:2;\" type=\"button\">\r\n\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.ClearVaultLog\")}\r\n\t</button>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<label>\r\n\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LoggingFormat\")}</span>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LoggingFormatExplanation\")}</p>\r\n\t</label>\r\n</div>\r\n\r\n<div class=\"form-group\">\r\n\t<select bind:value={pileData.vaultLogType}>\r\n\t\t<option value={CONSTANTS.VAULT_LOGGING_TYPES.USER_ACTOR}>\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LoggingFormatUserActor\")}\r\n\t\t</option>\r\n\t\t<option value={CONSTANTS.VAULT_LOGGING_TYPES.USER}>\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LoggingFormatUser\")}\r\n\t\t</option>\r\n\t\t<option value={CONSTANTS.VAULT_LOGGING_TYPES.ACTOR}>\r\n\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Vault.LoggingFormatActor\")}\r\n\t\t</option>\r\n\t</select>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n  .item-piles-grid-columns {\r\n    display: flex;\r\n    flex-direction: column;\r\n\r\n    & > div {\r\n      display: flex;\r\n      flex-direction: row;\r\n      align-items: center;\r\n\r\n      & > * {\r\n        flex: 1;\r\n        margin: 0 0.25rem;\r\n      }\r\n\r\n      & > span {\r\n        flex: 0;\r\n      }\r\n    }\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\r\n\timport CONSTANTS from \"../../../constants/constants.js\";\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\timport DropZone from \"../../components/DropZone.svelte\";\r\n\r\n\texport let pileData;\r\n\r\n\tconst flags = Object.entries(CONSTANTS.CUSTOM_PILE_TYPES[pileData.type]);\r\n\tfor (const [key, data] of flags) {\r\n\t\tif (pileData[key] === undefined) {\r\n\t\t\tpileData[key] = data.value;\r\n\t\t}\r\n\t}\r\n\r\n\tasync function handleDropData(dropData, key, data) {\r\n\t\tif (!data.type.implementation) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst doc = await data.type.implementation.fromDropData(dropData);\r\n\t\tpileData[key] = {\r\n\t\t\tdata: doc.toObject(),\r\n\t\t\tuuid: dropData.uuid\r\n\t\t}\r\n\t}\r\n\r\n\tasync function previewDocument(key) {\r\n\t\tif (!pileData[key].uuid) return;\r\n\t\tconst doc = fromUuidSync(pileData[key].uuid);\r\n\t\tif (!doc) return;\r\n\t\tdoc.sheet.render(true);\r\n\t}\r\n\r\n</script>\r\n\r\n\r\n{#each Object.entries(CONSTANTS.CUSTOM_PILE_TYPES[pileData.type]) as [key, data] (key)}\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<label style=\"flex:4;\">\r\n\t\t\t<span>{localize(data.title)}</span>\r\n\t\t\t{#if data.label}\r\n\t\t\t\t<p>{localize(data.label)}</p>\r\n\t\t\t{/if}\r\n\t\t</label>\r\n\t\t{#if data.type === String}\r\n\t\t\t{#if data.options}\r\n\t\t\t\t<select bind:value={pileData[key]}>\r\n\t\t\t\t\t{#each Object.entries(data.options) as [key, value]}\r\n\t\t\t\t\t\t<option value={key}>{localize(value)}</option>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</select>\r\n\t\t\t{:else}\r\n\t\t\t\t<input type=\"text\" bind:value={pileData[key]}/>\r\n\t\t\t{/if}\r\n\t\t{:else if data.type === Item || data.type === Actor}\r\n\t\t\t<DropZone callback={(dropData) => handleDropData(dropData, key, data)}>\r\n\t\t\t\t<div class=\"drop-item\">\r\n\t\t\t\t\t<img\r\n\t\t\t\t\t\tsrc={pileData[key]?.data?.img ?? data.type === Actor ? \"icons/svg/cowled.svg.svg\" : \"icons/svg/coins.svg\"}\r\n\t\t\t\t\t\tclass=\"drop-document-custom-image\"/>\r\n\t\t\t\t\t<span class:item-piles-clickable-link={!!pileData[key]?.data}\r\n\t\t\t\t\t      on:click={() => { previewDocument(key); }}>\r\n\t\t\t\t\t\t{pileData[key]?.data?.name ?? `Drop ${data.type.prototype.constructor.name.toLowerCase()} to add`}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t<i\r\n\t\t\t\t\t\ton:click|stopPropagation={() => {\r\n                            delete pileData[key];\r\n                            pileData[key] = false;\r\n                        }}\r\n\t\t\t\t\t\tclass=\"fas fa-times drop-item-remove item-piles-clickable-red item-piles-clickable-link\"\r\n\t\t\t\t\t></i>\r\n\t\t\t\t</div>\r\n\t\t\t</DropZone>\r\n\t\t{:else if data.type === Number}\r\n\t\t\t<input type=\"number\" bind:value={pileData[key]}/>\r\n\t\t{:else if data.type === Boolean}\r\n\t\t\t<input type=\"checkbox\" bind:checked={pileData[key]}/>\r\n\t\t{/if}\r\n\r\n\t</div>\r\n\r\n{/each}\r\n\r\n<style lang=\"scss\">\r\n\r\n  .drop-item {\r\n    display: flex;\r\n    align-items: center;\r\n    border: 1px solid rgba(0, 0, 0, 0.4);\r\n    border-radius: 5px;\r\n    padding: 0.25rem;\r\n    font-size: 0.75rem;\r\n    word-break: break-word;\r\n\r\n    span {\r\n      flex: 1;\r\n    }\r\n\r\n    .drop-document-custom-image {\r\n      max-width: 35px;\r\n      min-width: 35px;\r\n      border: 1px solid rgba(0, 0, 0, 0.4);\r\n      border-radius: 5px;\r\n      margin-right: 0.5rem;\r\n    }\r\n\r\n    .drop-item-remove {\r\n      margin-right: 0.15rem;\r\n    }\r\n  }\r\n</style>\r\n","<script>\r\n\timport { getContext } from 'svelte';\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport CONSTANTS from \"../../constants/constants.js\";\r\n\timport * as Helpers from \"../../helpers/helpers.js\";\r\n\r\n\timport Tabs from \"../components/Tabs.svelte\";\r\n\timport * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\timport { writable } from \"svelte/store\";\r\n\r\n\timport MerchantApp from \"../merchant-app/merchant-app.js\";\r\n\timport ItemPileInventoryApp from \"../item-pile-inventory-app/item-pile-inventory-app.js\";\r\n\timport VaultApp from \"../vault-app/vault-app.js\";\r\n\r\n\timport MainSettings from \"./settings/main.svelte\";\r\n\timport MerchantSettings from \"./settings/merchant.svelte\";\r\n\timport ItemPileSettings from \"./settings/itempile.svelte\";\r\n\timport ContainerSettings from \"./settings/container.svelte\";\r\n\timport SharingSettings from \"./settings/sharing.svelte\";\r\n\timport VaultSettings from \"./settings/vault.svelte\";\r\n\timport CustomSettings from \"./settings/custom.svelte\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let elementRoot;\r\n\texport let pileActor;\r\n\r\n\tlet form;\r\n\r\n\tlet pileData = PileUtilities.getActorFlagData(pileActor, { useDefaults: false });\r\n\tif (foundry.utils.isEmpty(pileData)) {\r\n\t\tpileData = PileUtilities.getPileActorDefaults();\r\n\t} else {\r\n\t\tpileData = PileUtilities.getActorFlagData(pileActor);\r\n\t}\r\n\r\n\tif (typeof pileData?.deleteWhenEmpty === \"boolean\") {\r\n\t\tpileData.deleteWhenEmpty = !!pileData?.deleteWhenEmpty;\r\n\t}\r\n\r\n\tlet pileEnabled = writable(pileData.enabled);\r\n\r\n\t$: pileData.enabled = $pileEnabled;\r\n\r\n\tasync function updateSettings() {\r\n\r\n\t\tlet defaults = foundry.utils.duplicate(CONSTANTS.PILE_DEFAULTS);\r\n\r\n\t\tconst types = [\r\n\t\t\t\"closedImage\",\r\n\t\t\t\"emptyImage\",\r\n\t\t\t\"openedImage\",\r\n\t\t\t\"lockedImage\",\r\n\t\t\t\"closeSound\",\r\n\t\t\t\"openSound\",\r\n\t\t\t\"lockedSound\",\r\n\t\t\t\"unlockedSound\",\r\n\t\t];\r\n\r\n\t\tfor (let type of types) {\r\n\t\t\tif (pileData[type].includes(\"*\")) {\r\n\t\t\t\tpileData[type + \"s\"] = await Helpers.getFiles(pileData[type], { applyWildCard: true, softFail: true });\r\n\t\t\t\tpileData[type + \"s\"] = pileData[type + \"s\"] || [];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst data = foundry.utils.mergeObject(defaults, pileData);\r\n\r\n\t\tdata.deleteWhenEmpty = {\r\n\t\t\t\"default\": \"default\",\r\n\t\t\t\"true\": true,\r\n\t\t\t\"false\": false\r\n\t\t}[data.deleteWhenEmpty];\r\n\r\n\t\tconst currentData = PileUtilities.getActorFlagData(pileActor);\r\n\t\tconst diff = Object.keys(foundry.utils.diffObject(currentData, foundry.utils.deepClone(data)));\r\n\r\n\t\tgame.itempiles.API.updateItemPile(pileActor, data).then(async () => {\r\n\t\t\tif (diff.includes(\"enabled\") || diff.includes(\"type\")) {\r\n\t\t\t\tconst promises = [];\r\n\t\t\t\tlet apps = [];\r\n\t\t\t\tswitch (currentData.type) {\r\n\t\t\t\t\tcase CONSTANTS.PILE_TYPES.MERCHANT:\r\n\t\t\t\t\t\tif (MerchantApp.getActiveApp(pileActor)) {\r\n\t\t\t\t\t\t\tpromises.push(MerchantApp.getActiveApp(pileActor).close());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (MerchantApp.getActiveApp(pileActor)) {\r\n\t\t\t\t\t\t\tpromises.push(MerchantApp.getActiveApp(pileActor).close());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase CONSTANTS.PILE_TYPES.VAULT:\r\n\t\t\t\t\t\tapps = VaultApp.getActiveApps(pileActor)\r\n\t\t\t\t\t\t\t.concat(VaultApp.getActiveApps(pileActor));\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tapps = ItemPileInventoryApp.getActiveApps(pileActor)\r\n\t\t\t\t\t\t\t.concat(ItemPileInventoryApp.getActiveApps(pileActor));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (let app of apps) {\r\n\t\t\t\t\tpromises.push(app.close());\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (promises.length || pileActor?.sheet.rendered) {\r\n\t\t\t\t\tawait Promise.allSettled(promises);\r\n\t\t\t\t\tif (data.enabled) {\r\n\t\t\t\t\t\tpileActor?.sheet.close();\r\n\t\t\t\t\t\tgame.itempiles.API.renderItemPileInterface(pileActor);\r\n\t\t\t\t\t} else if (!data.enabled) {\r\n\t\t\t\t\t\tpileActor?.sheet.render(true, { bypassItemPiles: true });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tapplication.close();\r\n\r\n\t}\r\n\r\n\tfunction requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n\tlet tabs = [];\r\n\t$: {\r\n\t\ttabs = [\r\n\t\t\t{\r\n\t\t\t\tvalue: \"main\",\r\n\t\t\t\tlabel: \"ITEM-PILES.Applications.ItemPileConfig.Main.Title\",\r\n\t\t\t\thighlight: !$pileEnabled\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalue: \"other\",\r\n\t\t\t\tlabel: \"ITEM-PILES.Applications.ItemPileConfig.Other.Title\"\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\r\n\tlet activeTab = \"main\";\r\n\r\n\tconst customTypes = Object.keys(CONSTANTS.CUSTOM_PILE_TYPES);\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form autocomplete=off bind:this={form} class=\"item-piles-config-container\"\r\n\t      on:submit|once|preventDefault={updateSettings}>\r\n\r\n\t\t<Tabs bind:activeTab bind:tabs/>\r\n\r\n\t\t<section class=\"tab-body\">\r\n\r\n\t\t\t<div class=\"tab\">\r\n\r\n\t\t\t\t{#if activeTab === 'main'}\r\n\r\n\t\t\t\t\t<MainSettings bind:pileData {pileActor} {pileEnabled}/>\r\n\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if activeTab === \"other\"}\r\n\r\n\t\t\t\t\t<div class=\"form-group\">\r\n\t\t\t\t\t\t<label style=\"flex:4;\">\r\n\t\t\t\t\t\t\t<span>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Other.Type\")}</span>\r\n\t\t\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.ItemPileConfig.Other.TypeExplanation\")}</p>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<select style=\"flex:4;\" bind:value={pileData.type}>\r\n\t\t\t\t\t\t\t{#each CONSTANTS.DEFAULT_PILE_TYPES as type}\r\n\t\t\t\t\t\t\t\t<option value={type}>\r\n\t\t\t\t\t\t\t\t\t{localize(`ITEM-PILES.Types.${type}`)}\r\n\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t\t{#each customTypes as customType}\r\n\t\t\t\t\t\t\t\t<option value={customType}>\r\n\t\t\t\t\t\t\t\t\t{localize(`ITEM-PILES.Types.${customType}`)}\r\n\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<hr>\r\n\r\n\t\t\t\t\t{#if pileData.type === CONSTANTS.PILE_TYPES.MERCHANT}\r\n\r\n\t\t\t\t\t\t<MerchantSettings bind:pileData {pileActor}/>\r\n\r\n\t\t\t\t\t{:else if pileData.type === CONSTANTS.PILE_TYPES.PILE || pileData.type === CONSTANTS.PILE_TYPES.CONTAINER}\r\n\r\n\t\t\t\t\t\t{#if pileData.type === CONSTANTS.PILE_TYPES.PILE}\r\n\r\n\t\t\t\t\t\t\t<ItemPileSettings bind:pileData/>\r\n\r\n\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t{#if pileData.type === CONSTANTS.PILE_TYPES.CONTAINER}\r\n\r\n\t\t\t\t\t\t\t<ContainerSettings bind:pileData/>\r\n\r\n\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t<hr>\r\n\r\n\t\t\t\t\t\t<SharingSettings bind:pileData {pileActor}/>\r\n\r\n\t\t\t\t\t{:else if pileData.type === CONSTANTS.PILE_TYPES.VAULT}\r\n\r\n\t\t\t\t\t\t<VaultSettings bind:pileData {pileActor}/>\r\n\r\n\t\t\t\t\t{:else if customTypes.includes(pileData.type)}\r\n\r\n\t\t\t\t\t\t<CustomSettings bind:pileData {pileActor}/>\r\n\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t</div>\r\n\r\n\t\t</section>\r\n\r\n\t\t<footer>\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i>\r\n\t\t\t\t{localize(\"ITEM-PILES.Applications.ItemPileConfig.Update\")}\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n","import * as Utilities from \"../../helpers/utilities.js\";\r\nimport { SvelteApplication } from '#runtime/svelte/application';\r\nimport ItemPileConfigShell from './item-pile-config.svelte';\r\nimport { getActiveApps } from \"../../helpers/helpers.js\";\r\n\r\nexport default class ItemPileConfig extends SvelteApplication {\r\n\r\n\tconstructor(pileActor, options = {}) {\r\n\r\n\t\tsuper({\r\n\t\t\tid: `item-pile-config-${pileActor.id}-${foundry.utils.randomID()}`,\r\n\t\t\ttitle: game.i18n.format(\"ITEM-PILES.Applications.ItemPileConfig.Title\", { actor_name: pileActor.name }),\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: ItemPileConfigShell,\r\n\t\t\t\ttarget: document.body,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\tpileActor\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclose: () => this.options.resolve?.(null),\r\n\t\t\t...options\r\n\t\t});\r\n\t}\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\twidth: 430,\r\n\t\t\theight: 627,\r\n\t\t\tclasses: [\"item-piles-config\", \"item-piles-app\"],\r\n\t\t\tresizable: true\r\n\t\t})\r\n\t}\r\n\r\n\tstatic getActiveApp(source) {\r\n\t\treturn getActiveApps(`item-pile-config-${source.id}`, true)\r\n\t}\r\n\r\n\tstatic async show(target, options = {}, dialogData = {}) {\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tconst app = this.getActiveApp(targetActor);\r\n\t\tif (app) return app.render(false, { focus: true });\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\toptions.resolve = resolve;\r\n\t\t\tnew this(targetActor, options, dialogData).render(true);\r\n\t\t})\r\n\t}\r\n\r\n\tasync close(options) {\r\n\t\tObject.values(ui.windows).forEach(app => {\r\n\t\t\tif (app !== this && app.rendered && app.options?.parentApp === this) {\r\n\t\t\t\tapp.close();\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn super.close(options);\r\n\t}\r\n}\r\n","import { SvelteApplication } from '#runtime/svelte/application';\r\nimport ItemPileInventoryShell from \"./item-pile-inventory-shell.svelte\";\r\nimport * as Utilities from \"../../helpers/utilities.js\";\r\nimport ItemPileConfig from \"../item-pile-config/item-pile-config.js\";\r\nimport * as Helpers from \"../../helpers/helpers.js\";\r\nimport UserSelectDialog from \"../dialogs/user-select-dialog/user-select-dialog.js\";\r\nimport SETTINGS from \"../../constants/settings.js\";\r\nimport CONSTANTS from \"../../constants/constants.js\";\r\n\r\nexport default class ItemPileInventoryApp extends SvelteApplication {\r\n\r\n\t/**\r\n\t *\r\n\t * @param actor\r\n\t * @param recipient\r\n\t * @param options\r\n\t * @param dialogData\r\n\t */\r\n\tconstructor(actor, recipient, options = {}, dialogData = {}) {\r\n\t\tsuper({\r\n\t\t\tid: `item-pile-inventory-${actor?.token?.id ?? actor.id}-${foundry.utils.randomID()}`,\r\n\t\t\ttitle: actor.name,\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: ItemPileInventoryShell,\r\n\t\t\t\ttarget: document.body,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\tactor,\r\n\t\t\t\t\trecipient\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tzIndex: 100,\r\n\t\t\t...options\r\n\t\t}, dialogData);\r\n\r\n\t\tthis.actor = actor;\r\n\t\tthis.recipient = recipient;\r\n\r\n\t\tHelpers.hooks.callAll(CONSTANTS.HOOKS.OPEN_INTERFACE, this, actor, recipient, options, dialogData);\r\n\r\n\t}\r\n\r\n\t/** @inheritdoc */\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\tcloseOnSubmit: false,\r\n\t\t\tclasses: [\"app\", \"window-app\", \"sheet\", \"item-pile-inventory\", \"item-piles\", \"item-piles-app\"],\r\n\t\t\twidth: 550,\r\n\t\t\theight: \"auto\",\r\n\t\t});\r\n\t}\r\n\r\n\tstatic getActiveApps(source) {\r\n\t\tconst id = typeof source === \"string\" ? source : source?.token?.id ?? source?.id;\r\n\t\treturn Helpers.getActiveApps(`item-pile-inventory-${id}`);\r\n\t}\r\n\r\n\tstatic async show(source, recipient = false, options = {}, dialogData = {}) {\r\n\t\tsource = Utilities.getActor(source);\r\n\t\trecipient = Utilities.getActor(recipient);\r\n\t\tconst result = Helpers.hooks.call(CONSTANTS.HOOKS.PRE_OPEN_INTERFACE, source, recipient, options, dialogData);\r\n\t\tif (result === false) return;\r\n\t\tconst apps = this.getActiveApps(source);\r\n\t\tif (apps.length) {\r\n\t\t\tfor (let app of apps) {\r\n\t\t\t\tapp.render(false, { focus: true });\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\toptions.resolve = resolve;\r\n\t\t\tnew this(source, recipient, options, dialogData).render(true, { focus: true, bypassItemPiles: true });\r\n\t\t})\r\n\t}\r\n\r\n\tasync close(options) {\r\n\t\tconst result = Helpers.hooks.call(CONSTANTS.HOOKS.PRE_CLOSE_INTERFACE, this, this.actor, this.recipient, options);\r\n\t\tif (result === false) return;\r\n\t\tHelpers.hooks.callAll(CONSTANTS.HOOKS.CLOSE_INTERFACE, this, this.actor, this.recipient, options);\r\n\t\treturn super.close(options);\r\n\t}\r\n\r\n\t/* -------------------------------------------- */\r\n\r\n\t/** @override */\r\n\t_getHeaderButtons() {\r\n\t\tlet buttons = super._getHeaderButtons();\r\n\r\n\t\tconst newButtons = [];\r\n\r\n\t\tif (this.actor.isOwner) {\r\n\t\t\tnewButtons.push({\r\n\t\t\t\t\tlabel: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.Inspect.OpenSheet\" : \"\",\r\n\t\t\t\t\tclass: \"item-piles-open-actor-sheet\",\r\n\t\t\t\t\ticon: \"fas fa-user\",\r\n\t\t\t\t\tonclick: () => {\r\n\t\t\t\t\t\tthis.actor.sheet.render(true, { focus: true, bypassItemPiles: true });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tif (game.user.isGM) {\r\n\t\t\tnewButtons.push({\r\n\t\t\t\t\tlabel: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.ContextMenu.ShowToPlayers\" : \"\",\r\n\t\t\t\t\tclass: \"item-piles-show-to-players\",\r\n\t\t\t\t\ticon: \"fas fa-eye\",\r\n\t\t\t\t\tonclick: async (event) => {\r\n\t\t\t\t\t\tconst activeUsers = Array.from(game.users).filter(u => u.active && u !== game.user).map(u => u.id);\r\n\t\t\t\t\t\tif (!activeUsers.length) {\r\n\t\t\t\t\t\t\treturn Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.NoPlayersActive\"), true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst users = event.altKey ? activeUsers : await UserSelectDialog.show({ excludeSelf: true });\r\n\t\t\t\t\t\tif (!users || !users.length) return;\r\n\t\t\t\t\t\tHelpers.custom_notify(game.i18n.format(\"ITEM-PILES.Notifications.ShownToPlayers\", { actor_name: this.actor.name }))\r\n\t\t\t\t\t\treturn game.itempiles.API.renderItemPileInterface(this.actor, {\r\n\t\t\t\t\t\t\tuserIds: users,\r\n\t\t\t\t\t\t\tuseDefaultCharacter: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? \"ITEM-PILES.HUD.Configure\" : \"\",\r\n\t\t\t\t\tclass: \"item-piles-configure-pile\",\r\n\t\t\t\t\ticon: \"fas fa-box-open\",\r\n\t\t\t\t\tonclick: () => {\r\n\t\t\t\t\t\tItemPileConfig.show(this.actor);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn newButtons.concat(buttons)\r\n\t}\r\n\r\n}\r\n","<script>\r\n\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\r\n\texport let item;\r\n\texport let quantity;\r\n\texport let sourceActor;\r\n\texport let targetActor;\r\n\r\n</script>\r\n\r\n\r\n<div class=\"item-piles-dialog-root\">\r\n\r\n\t<p class=\"header\">\r\n\t\t{localize(\"ITEM-PILES.Dialogs.ReceiveItem.Header\")}\r\n\t</p>\r\n\r\n\t<div class=\"item-piles-give-image-container\">\r\n\t\t<img src=\"{sourceActor.img}\"/>\r\n\t\t<i class=\"fas fa-arrow-right\"></i>\r\n\t\t<img src=\"{targetActor.img}\"/>\r\n\t</div>\r\n\r\n\t<div class=\"item-piles-give-item-container\">\r\n\t\t<img src=\"{item.img}\"/>\r\n\t\t<span>{item.name} ({quantity})</span>\r\n\t</div>\r\n\r\n\t<p>{localize(\"ITEM-PILES.Dialogs.ReceiveItem.Content\", {\r\n\t\tsource_actor_name: sourceActor.name,\r\n\t\ttarget_actor_name: targetActor.name\r\n\t})}</p>\r\n\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-dialog-root {\r\n\r\n    margin-bottom: 0.5rem;\r\n    font-size: 0.9rem;\r\n    text-align: center;\r\n\r\n    .header {\r\n      margin-bottom: 0.5rem;\r\n      font-size: 1.2rem;\r\n      font-weight: bold;\r\n    }\r\n\r\n    .item-piles-give-item-container, .item-piles-give-image-container {\r\n      display: grid;\r\n\r\n      grid-auto-flow: column;\r\n      align-items: center;\r\n      justify-items: center;\r\n      justify-content: center;\r\n      align-content: center;\r\n      gap: 1rem;\r\n\r\n      margin-bottom: 0.5rem;\r\n\r\n    }\r\n\r\n    .item-piles-give-image-container {\r\n\r\n      font-size: 2rem;\r\n\r\n      img {\r\n        max-height: 70px;\r\n        border: 0;\r\n      }\r\n    }\r\n\r\n    .item-piles-give-item-container {\r\n\r\n      font-size: 1rem;\r\n\r\n      img {\r\n        max-height: 40px;\r\n        border: 0;\r\n        border-radius: 0.5rem;\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n</style>\r\n","import * as Helpers from \"../helpers/helpers.js\";\r\nimport * as Utilities from \"../helpers/utilities.js\";\r\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\r\nimport * as SharingUtilities from \"../helpers/sharing-utilities.js\";\r\nimport ItemPileSocket from \"../socket.js\";\r\nimport SETTINGS from \"../constants/settings.js\";\r\nimport CONSTANTS from \"../constants/constants.js\";\r\nimport DropItemDialog from \"../applications/dialogs/drop-item-dialog/drop-item-dialog.js\";\r\nimport ItemPileInventoryApp from \"../applications/item-pile-inventory-app/item-pile-inventory-app.js\";\r\nimport Transaction from \"../helpers/transaction.js\";\r\nimport ItemPileStore from \"../stores/item-pile-store.js\";\r\nimport MerchantApp from \"../applications/merchant-app/merchant-app.js\";\r\nimport { SYSTEMS } from \"../systems.js\";\r\nimport { TJSDialog } from \"#runtime/svelte/application\";\r\nimport CustomDialog from \"../applications/components/CustomDialog.svelte\";\r\nimport ReceiveItemsShell from \"../applications/dialogs/receive-items-dialog/receive-items-shell.svelte\";\r\nimport BankVaultApp from \"../applications/vault-app/vault-app.js\";\r\nimport { hotkeyActionState } from \"../hotkeys.js\";\r\nimport { ensureValidIds } from \"../helpers/utilities.js\";\r\nimport { getPileActorDefaults } from \"../helpers/pile-utilities.js\";\r\n\r\nconst preloadedFiles = new Set();\r\n\r\nexport default class PrivateAPI {\r\n\r\n\t/**\r\n\t * Initializes the API for Foundry's core hooks\r\n\t */\r\n\tstatic initialize() {\r\n\t\tHelpers.hooks.on(\"canvasReady\", this._onCanvasReady.bind(this));\r\n\t\tHelpers.hooks.on(\"createItem\", this._onCreateItem.bind(this));\r\n\t\tHelpers.hooks.on(\"updateItem\", this._onUpdateItem.bind(this));\r\n\t\tHelpers.hooks.on(\"deleteItem\", this._onDeleteItem.bind(this));\r\n\t\tHelpers.hooks.on(\"updateActor\", this._onUpdateActor.bind(this));\r\n\t\tHelpers.hooks.on(\"deleteToken\", this._onDeleteToken.bind(this));\r\n\t\tHelpers.hooks.on(\"deleteActor\", this._onDeleteActor.bind(this));\r\n\t\tHelpers.hooks.on(\"preCreateToken\", this._onPreCreateToken.bind(this))\r\n\t\tHelpers.hooks.on(\"preUpdateToken\", this._onPreUpdateToken.bind(this));\r\n\t\tHelpers.hooks.on(\"updateToken\", this._onUpdateToken.bind(this));\r\n\t\tHelpers.hooks.on(\"createToken\", this._onCreateToken.bind(this))\r\n\t\tHelpers.hooks.on(\"dropCanvasData\", this._dropData.bind(this));\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tstatic async _onCanvasReady(canvas) {\r\n\t\tconst tokens = [...canvas.tokens.placeables].map(token => token.document);\r\n\t\tfor (const doc of tokens) {\r\n\t\t\tawait this._preloadItemPileFiles(doc);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tstatic _onCreateItem(doc) {\r\n\t\tif (!doc.parent) return true;\r\n\t\tItemPileStore.notifyChanges(\"createItem\", doc.parent, doc);\r\n\t\tif (!PileUtilities.isValidItemPile(doc.parent)) return true;\r\n\t\tthis._evaluateItemPileChange(doc.parent, {}, true);\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tstatic _onUpdateItem(doc) {\r\n\t\tif (!doc.parent) return true;\r\n\t\tif (!PileUtilities.isValidItemPile(doc.parent)) return true;\r\n\t\tthis._evaluateItemPileChange(doc.parent, {}, true);\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tstatic _onDeleteItem(doc) {\r\n\t\tif (!doc.parent) return true;\r\n\t\tItemPileStore.notifyChanges(\"deleteItem\", doc.parent, doc);\r\n\t\tif (!PileUtilities.isValidItemPile(doc.parent)) return true;\r\n\t\tthis._evaluateItemPileChange(doc.parent, {}, true);\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tstatic _onUpdateActor(doc, changes) {\r\n\t\tif (!PileUtilities.isValidItemPile(doc)) return true;\r\n\t\tthis._evaluateItemPileChange(doc, changes);\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tstatic _onDeleteToken(doc) {\r\n\t\tItemPileStore.notifyChanges(\"delete\", doc.actor)\r\n\t\tif (!PileUtilities.isValidItemPile(doc)) return true;\r\n\t\tHelpers.hooks.callAll(CONSTANTS.HOOKS.PILE.DELETE, doc);\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tstatic _onDeleteActor(doc) {\r\n\t\tItemPileStore.notifyChanges(\"delete\", doc)\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tstatic _onPreCreateToken(doc, data) {\r\n\t\tconst docData = foundry.utils.deepClone(data);\r\n\t\tconst sourceActor = game.actors.get(doc.actorId);\r\n\t\tlet itemPileConfig = foundry.utils.mergeObject(\r\n\t\t\tfoundry.utils.deepClone(CONSTANTS.PILE_DEFAULTS),\r\n\t\t\tfoundry.utils.getProperty(docData, CONSTANTS.FLAGS.PILE) ?? {}\r\n\t\t)\r\n\t\tif (doc.isLinked || !foundry.utils.hasProperty(docData, CONSTANTS.FLAGS.PILE)) {\r\n\t\t\titemPileConfig = foundry.utils.mergeObject(\r\n\t\t\t\titemPileConfig,\r\n\t\t\t\tfoundry.utils.deepClone(foundry.utils.getProperty(sourceActor, CONSTANTS.FLAGS.PILE) ?? {})\r\n\t\t\t);\r\n\t\t}\r\n\t\tif (!itemPileConfig?.enabled) return true;\r\n\t\tif (!doc.isLinked) {\r\n\t\t\tUtilities.deleteProperty(docData, CONSTANTS.ACTOR_DELTA_PROPERTY + \".\" + CONSTANTS.FLAGS.SHARING);\r\n\t\t}\r\n\t\tif (itemPileConfig.closedImage.includes(\"*\")) {\r\n\t\t\titemPileConfig.closedImage = Helpers.random_array_element(itemPileConfig.closedImages);\r\n\t\t\titemPileConfig.closedImages = [];\r\n\t\t}\r\n\t\tif (itemPileConfig.emptyImage.includes(\"*\")) {\r\n\t\t\titemPileConfig.emptyImage = Helpers.random_array_element(itemPileConfig.emptyImages);\r\n\t\t\titemPileConfig.emptyImages = [];\r\n\t\t}\r\n\t\tif (itemPileConfig.openedImage.includes(\"*\")) {\r\n\t\t\titemPileConfig.openedImage = Helpers.random_array_element(itemPileConfig.openedImages);\r\n\t\t\titemPileConfig.openedImages = [];\r\n\t\t}\r\n\t\tif (itemPileConfig.lockedImage.includes(\"*\")) {\r\n\t\t\titemPileConfig.lockedImage = Helpers.random_array_element(itemPileConfig.lockedImages);\r\n\t\t\titemPileConfig.lockedImages = [];\r\n\t\t}\r\n\t\tconst targetItems = PileUtilities.getActorItems(doc.actor, {\r\n\t\t\titemFilters: itemPileConfig?.overrideItemFilters\r\n\t\t});\r\n\t\tconst targetCurrencies = PileUtilities.getActorCurrencies(doc.actor, {\r\n\t\t\tcurrencyList: PileUtilities.getCurrencyList(doc.actor, itemPileConfig)\r\n\t\t});\r\n\t\tconst pileData = { data: itemPileConfig, items: targetItems, currencies: targetCurrencies };\r\n\t\tconst scale = PileUtilities.getItemPileTokenScale(doc, pileData);\r\n\t\tfoundry.utils.setProperty(docData, \"texture.src\", PileUtilities.getItemPileTokenImage(doc, pileData));\r\n\t\tfoundry.utils.setProperty(docData, \"texture.scaleX\", scale);\r\n\t\tfoundry.utils.setProperty(docData, \"texture.scaleY\", scale);\r\n\t\tfoundry.utils.setProperty(docData, \"name\", PileUtilities.getItemPileName(doc, pileData));\r\n\t\tconst cleanItemPileConfig = PileUtilities.cleanFlagData(itemPileConfig);\r\n\t\tUtilities.deleteProperty(docData, CONSTANTS.FLAGS.PILE);\r\n\t\tfoundry.utils.setProperty(docData, CONSTANTS.FLAGS.PILE, cleanItemPileConfig);\r\n\t\tif (!doc.isLinked) {\r\n\t\t\tUtilities.deleteProperty(docData, CONSTANTS.ACTOR_DELTA_PROPERTY + \".\" + CONSTANTS.FLAGS.PILE);\r\n\t\t\tfoundry.utils.setProperty(docData, CONSTANTS.ACTOR_DELTA_PROPERTY + \".\" + CONSTANTS.FLAGS.PILE, cleanItemPileConfig);\r\n\t\t}\r\n\r\n\t\tdoc.updateSource(docData);\r\n\t}\r\n\r\n\tstatic _onPreUpdateToken(doc, changes) {\r\n\t\tconst diff = foundry.utils.diffObject(doc, changes);\r\n\t\tif (!foundry.utils.hasProperty(diff, \"actorLink\")) return true;\r\n\t\tif (!PileUtilities.isValidItemPile(doc)) return true;\r\n\t\tconst actor = Utilities.getActor(doc);\r\n\t\tconst changingFlags = foundry.utils.getProperty(changes, CONSTANTS.FLAGS.PILE) ?? {};\r\n\t\tconst flagData = foundry.utils.mergeObject(\r\n\t\t\tPileUtilities.getActorFlagData(actor),\r\n\t\t\tchangingFlags\r\n\t\t);\r\n\t\tchanges[CONSTANTS.FLAGS.PILE] = PileUtilities.cleanFlagData(flagData);\r\n\t}\r\n\r\n\tstatic _onUpdateToken(doc) {\r\n\t\tif (doc.actorLink) return true;\r\n\t\tif (!PileUtilities.isValidItemPile(doc)) return true;\r\n\t\tItemPileStore.notifyChanges(\"updateUnlinkedToken\", doc.actor)\r\n\t}\r\n\r\n\t/**\r\n\t * @private\r\n\t */\r\n\tstatic _onCreateToken(doc) {\r\n\t\tif (!PileUtilities.isValidItemPile(doc)) return true;\r\n\t\tconst itemPileConfig = PileUtilities.getActorFlagData(doc.actor)\r\n\t\tHelpers.hooks.callAll(CONSTANTS.HOOKS.PILE.CREATE, doc, itemPileConfig);\r\n\t\treturn this._preloadItemPileFiles(doc);\r\n\t}\r\n\r\n\tstatic async _addItems(targetUuid, items, userId, {\r\n\t\tremoveExistingActorItems = false, skipVaultLogging = false, interactionId = false\r\n\t} = {}) {\r\n\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst transaction = new Transaction(targetActor);\r\n\r\n\t\tif (removeExistingActorItems) {\r\n\t\t\tconst existingItems = PileUtilities.getActorItems(targetActor);\r\n\t\t\tawait transaction.appendItemChanges(existingItems, { remove: true });\r\n\t\t}\r\n\r\n\t\tawait transaction.appendItemChanges(items);\r\n\r\n\t\tconst { itemsToUpdate, itemsToCreate } = transaction.prepare(); // Prepare data\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_ADD, targetActor, itemsToCreate, itemsToUpdate, interactionId);\r\n\t\tif (hookResult === false) return false; // Call pre-hook to allow user to interrupt it\r\n\r\n\t\tconst { itemDeltas } = await transaction.commit(); // Actually add the items to the actor\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.ITEM.ADD, targetUuid, itemDeltas, userId, interactionId);\r\n\r\n\t\tawait this._executeItemPileMacro(targetUuid, {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.ADD_ITEMS,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\titems: itemDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t});\r\n\r\n\t\tif (!skipVaultLogging && PileUtilities.isItemPileVault(targetActor)) {\r\n\t\t\tawait PileUtilities.updateVaultLog(targetActor, {\r\n\t\t\t\tuserId, items: itemDeltas, withdrawal: false\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn itemDeltas;\r\n\r\n\t}\r\n\r\n\tstatic async _removeItems(targetUuid, items, userId, { skipVaultLogging = false, interactionId = false } = {}) {\r\n\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst transaction = new Transaction(targetActor);\r\n\r\n\t\tawait transaction.appendItemChanges(items, { remove: true });\r\n\r\n\t\tconst { itemsToUpdate, itemsToDelete } = transaction.prepare();\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_REMOVE, targetActor, itemsToUpdate, itemsToDelete, interactionId);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tconst { itemDeltas } = await transaction.commit();\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.ITEM.REMOVE, targetUuid, itemDeltas, userId, interactionId);\r\n\r\n\t\tawait this._executeItemPileMacro(targetUuid, {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.REMOVE_ITEMS,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\titems: itemDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t});\r\n\r\n\t\tconst shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(targetUuid);\r\n\t\tif (shouldBeDeleted) {\r\n\t\t\tawait this._deleteItemPile(targetUuid);\r\n\t\t}\r\n\r\n\t\tif (!skipVaultLogging && PileUtilities.isItemPileVault(targetActor)) {\r\n\t\t\tawait PileUtilities.updateVaultLog(targetActor, {\r\n\t\t\t\tuserId, items: itemDeltas, withdrawal: true\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn itemDeltas;\r\n\r\n\t}\r\n\r\n\tstatic async _transferItems(sourceUuid, targetUuid, items, userId, {\r\n\t\tskipVaultLogging = false, interactionId = false\r\n\t} = {}) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(sourceUuid);\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst sourceTransaction = new Transaction(sourceActor);\r\n\t\tif (SYSTEMS.DATA.ITEM_TYPE_HANDLERS) {\r\n\t\t\tconst newItems = [];\r\n\t\t\tfor (const data of items) {\r\n\t\t\t\tconst itemData = data?.item ?? data;\r\n\t\t\t\tconst item = sourceActor.items.get(itemData._id ?? itemData.id);\r\n\t\t\t\tconst handler = Utilities.getItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.TRANSFER, item.type);\r\n\t\t\t\tif (!handler) continue;\r\n\t\t\t\thandler({ item, items: newItems });\r\n\t\t\t}\r\n\t\t\titems = items.concat(newItems.map(item => ({\r\n\t\t\t\t_id: item._id,\r\n\t\t\t\tflags: undefined,\r\n\t\t\t\tquantity: Utilities.getItemQuantity(item)\r\n\t\t\t})));\r\n\t\t}\r\n\t\tawait sourceTransaction.appendItemChanges(items, { remove: true });\r\n\r\n\t\tconst sourceUpdates = sourceTransaction.prepare();\r\n\r\n\t\tconst targetTransaction = new Transaction(targetActor);\r\n\t\tawait targetTransaction.appendItemChanges(sourceUpdates.itemDeltas);\r\n\t\tconst targetUpdates = targetTransaction.prepare();\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_TRANSFER, sourceActor, sourceUpdates, targetActor, targetUpdates, interactionId);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tawait sourceTransaction.commit();\r\n\t\tconst { itemDeltas } = await targetTransaction.commit();\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.ITEM.TRANSFER, sourceUuid, targetUuid, itemDeltas, userId, interactionId);\r\n\r\n\t\tconst macroData = {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.TRANSFER_ITEMS,\r\n\t\t\tsource: sourceUuid,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\titems: itemDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t};\r\n\r\n\t\tawait this._executeItemPileMacro(sourceUuid, macroData);\r\n\t\tawait this._executeItemPileMacro(targetUuid, macroData);\r\n\r\n\t\tconst sourceIsItemPile = PileUtilities.isValidItemPile(sourceActor);\r\n\r\n\t\tconst itemPileUuid = sourceIsItemPile ? sourceUuid : targetUuid;\r\n\t\tconst itemPile = sourceIsItemPile ? Utilities.getToken(sourceUuid) : Utilities.getToken(targetUuid);\r\n\r\n\t\tconst shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(itemPileUuid);\r\n\t\tif (shouldBeDeleted) {\r\n\t\t\tawait this._deleteItemPile(itemPileUuid);\r\n\t\t} else if (PileUtilities.isItemPileLootable(itemPile)) {\r\n\t\t\tif (PileUtilities.isItemPileEmpty(itemPile)) {\r\n\t\t\t\tawait SharingUtilities.clearItemPileSharingData(itemPile);\r\n\t\t\t} else {\r\n\t\t\t\tawait SharingUtilities.setItemPileSharingData(sourceUuid, targetUuid, {\r\n\t\t\t\t\titems: itemDeltas\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else if (!skipVaultLogging && (PileUtilities.isItemPileVault(sourceActor) || PileUtilities.isItemPileVault(targetActor))) {\r\n\t\t\tconst pileActor = sourceIsItemPile ? sourceActor : targetActor;\r\n\t\t\tconst actorToLog = sourceIsItemPile ? targetActor : sourceActor;\r\n\t\t\tawait PileUtilities.updateVaultLog(pileActor, {\r\n\t\t\t\tuserId, actor: actorToLog, items: itemDeltas, withdrawal: sourceIsItemPile\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn itemDeltas;\r\n\r\n\t}\r\n\r\n\tstatic async _transferAllItems(sourceUuid, targetUuid, userId, {\r\n\t\titemFilters = false, skipVaultLogging = false, interactionId = false\r\n\t} = {}) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(sourceUuid);\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst itemsToTransfer = PileUtilities.getActorItems(sourceActor, { itemFilters }).map(item => item.toObject());\r\n\r\n\t\tconst sourceTransaction = new Transaction(sourceActor);\r\n\t\tawait sourceTransaction.appendItemChanges(itemsToTransfer, { remove: true });\r\n\t\tconst sourceUpdates = sourceTransaction.prepare();\r\n\r\n\t\tconst targetTransaction = new Transaction(targetActor);\r\n\t\tawait targetTransaction.appendItemChanges(sourceUpdates.itemDeltas);\r\n\t\tconst targetUpdates = targetTransaction.prepare();\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_TRANSFER_ALL, sourceActor, sourceUpdates, targetActor, targetUpdates, userId);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tawait sourceTransaction.commit();\r\n\t\tconst { itemDeltas } = await targetTransaction.commit();\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.ITEM.TRANSFER_ALL, sourceUuid, targetUuid, itemDeltas, userId, interactionId);\r\n\r\n\t\tconst macroData = {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.TRANSFER_ALL_ITEMS,\r\n\t\t\tsource: sourceUuid,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\titems: itemDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t};\r\n\t\tawait this._executeItemPileMacro(sourceUuid, macroData);\r\n\t\tawait this._executeItemPileMacro(targetUuid, macroData);\r\n\r\n\t\tconst sourceIsItemPile = PileUtilities.isValidItemPile(sourceActor);\r\n\t\tconst itemPileUuid = sourceIsItemPile ? sourceUuid : targetUuid;\r\n\t\tconst itemPile = sourceIsItemPile ? Utilities.getToken(sourceUuid) : Utilities.getToken(targetUuid);\r\n\r\n\t\tconst shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(itemPileUuid);\r\n\t\tif (shouldBeDeleted) {\r\n\t\t\tawait this._deleteItemPile(itemPileUuid);\r\n\t\t} else if (!skipVaultLogging && (PileUtilities.isItemPileVault(itemPile) || PileUtilities.isItemPileVault(targetActor))) {\r\n\t\t\tconst pileActor = sourceIsItemPile ? sourceActor : targetActor;\r\n\t\t\tconst actorToLog = sourceIsItemPile ? targetActor : sourceActor;\r\n\t\t\tawait PileUtilities.updateVaultLog(pileActor, {\r\n\t\t\t\tuserId, actor: actorToLog, items: itemDeltas, withdrawal: sourceIsItemPile\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn itemDeltas;\r\n\t}\r\n\r\n\tstatic async _updateCurrencies(targetUuid, currencies, userId, {\r\n\t\tskipVaultLogging = false, interactionId = false\r\n\t} = {}) {\r\n\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst transaction = new Transaction(targetActor);\r\n\r\n\t\tconst currenciesToUpdate = PileUtilities.getPriceFromString(currencies).currencies\r\n\t\t\t.filter(currency => Helpers.isRealNumber(currency.quantity) && currency.quantity >= 0);\r\n\r\n\t\tconst itemsToUpdate2 = currenciesToUpdate.filter(currency => currency.type === \"item\")\r\n\t\t\t.map(currency => ({ item: currency.data.item, quantity: 1, cost: currency.quantity }));\r\n\r\n\t\tconst attributesToUpdate = currenciesToUpdate.filter(currency => currency.type === \"attribute\")\r\n\t\t\t.map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n\t\tawait transaction.appendItemChanges(itemsToUpdate2, { type: \"currency\", set: true });\r\n\t\tawait transaction.appendDocumentChanges(attributesToUpdate, { type: \"currency\", set: true });\r\n\r\n\t\tconst { actorUpdates, itemsToCreate, itemsToUpdate } = transaction.prepare(); // Prepare data\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.CURRENCY.PRE_UPDATE, targetActor, actorUpdates, itemsToCreate, itemsToUpdate, interactionId);\r\n\t\tif (hookResult === false) return false; // Call pre-hook to allow user to interrupt it\r\n\r\n\t\tconst { itemDeltas, attributeDeltas } = await transaction.commit(); // Actually update the items to the actor\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.CURRENCY.UPDATE, targetUuid, itemDeltas, attributeDeltas, userId, interactionId);\r\n\r\n\t\tawait this._executeItemPileMacro(targetUuid, {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.UPDATE_CURRENCIES,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\titems: itemDeltas,\r\n\t\t\tattributes: attributeDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t});\r\n\r\n\t\tif (!skipVaultLogging && PileUtilities.isItemPileVault(targetActor)) {\r\n\t\t\tawait PileUtilities.updateVaultLog(targetActor, {\r\n\t\t\t\tuserId, items: itemDeltas, attributes: attributeDeltas, withdrawal: false\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn { itemDeltas, attributeDeltas };\r\n\r\n\t}\r\n\r\n\tstatic async _addCurrencies(targetUuid, currencies, userId, {\r\n\t\tskipVaultLogging = false, interactionId = false\r\n\t} = {}) {\r\n\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst transaction = new Transaction(targetActor);\r\n\r\n\t\tconst currenciesToAdd = PileUtilities.getPriceFromString(currencies).currencies\r\n\t\t\t.filter(currency => Helpers.isRealNumber(currency.quantity) && currency.quantity > 0);\r\n\r\n\t\tconst itemsToAdd = currenciesToAdd.filter(currency => currency.type === \"item\")\r\n\t\t\t.map(currency => ({ item: currency.data.item, quantity: currency.quantity }));\r\n\r\n\t\tconst attributesToAdd = currenciesToAdd.filter(currency => currency.type === \"attribute\")\r\n\t\t\t.map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n\t\tawait transaction.appendItemChanges(itemsToAdd, { type: \"currency\" });\r\n\t\tawait transaction.appendDocumentChanges(attributesToAdd, { type: \"currency\" });\r\n\r\n\t\tconst { actorUpdates, itemsToCreate, itemsToUpdate } = transaction.prepare(); // Prepare data\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.CURRENCY.PRE_ADD, targetActor, actorUpdates, itemsToCreate, itemsToUpdate, interactionId);\r\n\t\tif (hookResult === false) return false; // Call pre-hook to allow user to interrupt it\r\n\r\n\t\tconst { itemDeltas, attributeDeltas } = await transaction.commit(); // Actually add the items to the actor\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.CURRENCY.ADD, targetUuid, itemDeltas, attributeDeltas, userId, interactionId);\r\n\r\n\t\tawait this._executeItemPileMacro(targetUuid, {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.ADD_CURRENCIES,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\titems: itemDeltas,\r\n\t\t\tattributes: attributeDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t});\r\n\r\n\t\tif (!skipVaultLogging && PileUtilities.isItemPileVault(targetActor)) {\r\n\t\t\tawait PileUtilities.updateVaultLog(targetActor, {\r\n\t\t\t\tuserId, items: itemDeltas, attributes: attributeDeltas, withdrawal: false\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn { itemDeltas, attributeDeltas };\r\n\r\n\t}\r\n\r\n\tstatic async _removeCurrencies(targetUuid, currencies, userId, {\r\n\t\tskipVaultLogging = false, interactionId = false\r\n\t} = {}) {\r\n\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst transaction = new Transaction(targetActor);\r\n\r\n\t\tconst priceData = PileUtilities.getPriceFromString(currencies)\r\n\t\tconst secondaryPrices = priceData.currencies.filter(currency => currency.secondary && currency.quantity);\r\n\t\tconst overallCost = priceData.overallCost;\r\n\r\n\t\tconst paymentData = PileUtilities.getPaymentData({\r\n\t\t\tpurchaseData: [{ cost: overallCost, quantity: 1, secondaryPrices }], buyer: targetActor\r\n\t\t});\r\n\r\n\t\tconst itemsToRemove = paymentData.finalPrices.filter(currency => currency.type === \"item\" && currency.quantity)\r\n\t\t\t.map(currency => ({ item: currency.data.item, quantity: currency.quantity }));\r\n\r\n\t\tconst attributesToRemove = paymentData.finalPrices.filter(currency => currency.type === \"attribute\" && currency.quantity)\r\n\t\t\t.map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n\t\tconst itemsToAdd = paymentData.buyerChange.filter(currency => currency.type === \"item\" && currency.quantity)\r\n\t\t\t.map(currency => ({ item: currency.data.item, quantity: currency.quantity }));\r\n\r\n\t\tconst attributesToAdd = paymentData.buyerChange.filter(currency => currency.type === \"attribute\" && currency.quantity)\r\n\t\t\t.map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n\t\tawait transaction.appendItemChanges(itemsToRemove, { remove: true, type: \"currency\" });\r\n\t\tawait transaction.appendDocumentChanges(attributesToRemove, { remove: true, type: \"currency\" });\r\n\t\tawait transaction.appendItemChanges(itemsToAdd, { type: \"currency\" });\r\n\t\tawait transaction.appendDocumentChanges(attributesToAdd, { type: \"currency\" });\r\n\r\n\t\tconst { actorUpdates, itemsToUpdate } = transaction.prepare(); // Prepare data\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.CURRENCY.PRE_REMOVE, targetActor, actorUpdates, itemsToUpdate, interactionId);\r\n\t\tif (hookResult === false) return false; // Call pre-hook to allow user to interrupt it\r\n\r\n\t\tconst { itemDeltas, attributeDeltas } = await transaction.commit(); // Actually add the items to the actor\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.CURRENCY.REMOVE, targetUuid, itemDeltas, attributeDeltas, userId, interactionId);\r\n\r\n\t\tawait this._executeItemPileMacro(targetUuid, {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.REMOVE_CURRENCIES,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\titems: itemDeltas,\r\n\t\t\tattributes: attributeDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t});\r\n\r\n\t\tconst shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(targetUuid);\r\n\t\tif (shouldBeDeleted) {\r\n\t\t\tawait this._deleteItemPile(targetUuid);\r\n\t\t}\r\n\r\n\t\tif (!skipVaultLogging && PileUtilities.isItemPileVault(targetActor)) {\r\n\t\t\tawait PileUtilities.updateVaultLog(targetActor, {\r\n\t\t\t\tuserId, items: itemDeltas, attributes: attributeDeltas, withdrawal: true\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn { itemDeltas, attributeDeltas };\r\n\r\n\t}\r\n\r\n\tstatic async _transferCurrencies(sourceUuid, targetUuid, currencies, userId, {\r\n\t\tskipVaultLogging = false, interactionId = false\r\n\t} = {}) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(sourceUuid);\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst priceData = PileUtilities.getPriceFromString(currencies);\r\n\t\tconst overallCost = priceData.overallCost;\r\n\r\n\t\tconst paymentData = PileUtilities.getPaymentData({\r\n\t\t\tpurchaseData: [{ cost: overallCost, quantity: 1 }], buyer: sourceActor\r\n\t\t});\r\n\r\n\t\tconst sourceItemsToRemove = paymentData.finalPrices.filter(currency => currency.type === \"item\" && currency.quantity)\r\n\t\t\t.map(currency => ({ item: currency.data.item, quantity: currency.quantity }));\r\n\r\n\t\tconst sourceAttributesToRemove = paymentData.finalPrices.filter(currency => currency.type === \"attribute\" && currency.quantity)\r\n\t\t\t.map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n\t\tconst sourceItemsToAdd = paymentData.buyerChange.filter(currency => currency.type === \"item\" && currency.quantity)\r\n\t\t\t.map(currency => ({ item: currency.data.item, quantity: currency.quantity }));\r\n\r\n\t\tconst sourceAttributesToAdd = paymentData.buyerChange.filter(currency => currency.type === \"attribute\" && currency.quantity)\r\n\t\t\t.map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n\t\tconst sourceTransaction = new Transaction(sourceActor);\r\n\t\tawait sourceTransaction.appendItemChanges(sourceItemsToRemove, { remove: true, type: \"currency\" });\r\n\t\tawait sourceTransaction.appendDocumentChanges(sourceAttributesToRemove, { remove: true, type: \"currency\" });\r\n\t\tawait sourceTransaction.appendItemChanges(sourceItemsToAdd, { type: \"currency\" });\r\n\t\tawait sourceTransaction.appendDocumentChanges(sourceAttributesToAdd, { type: \"currency\" });\r\n\t\tconst sourceUpdates = sourceTransaction.prepare();\r\n\r\n\t\tconst targetItemsToAdd = paymentData.sellerReceive.filter(currency => currency.type === \"item\")\r\n\t\t\t.map(currency => ({ item: currency.data.item, quantity: currency.quantity }));\r\n\r\n\t\tconst targetAttributesToAdd = paymentData.sellerReceive.filter(currency => currency.type === \"attribute\")\r\n\t\t\t.map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n\t\tconst targetTransaction = new Transaction(targetActor);\r\n\t\tawait targetTransaction.appendItemChanges(targetItemsToAdd, { type: \"currency\" });\r\n\t\tawait targetTransaction.appendDocumentChanges(targetAttributesToAdd, { type: \"currency\" });\r\n\t\tconst targetUpdates = targetTransaction.prepare();\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.CURRENCY.PRE_TRANSFER, sourceActor, sourceUpdates, targetActor, targetUpdates, interactionId);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tawait sourceTransaction.commit();\r\n\t\tconst { itemDeltas, attributeDeltas } = await targetTransaction.commit();\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.CURRENCY.TRANSFER, sourceUuid, targetUuid, itemDeltas, attributeDeltas, userId, interactionId);\r\n\r\n\t\tconst macroData = {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.TRANSFER_CURRENCIES,\r\n\t\t\tsource: sourceUuid,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\titems: itemDeltas,\r\n\t\t\tattributes: attributeDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t};\r\n\r\n\t\tawait this._executeItemPileMacro(sourceUuid, macroData);\r\n\t\tawait this._executeItemPileMacro(targetUuid, macroData);\r\n\r\n\t\tconst sourceIsItemPile = PileUtilities.isValidItemPile(sourceActor);\r\n\r\n\t\tconst itemPileUuid = sourceIsItemPile ? sourceUuid : targetUuid;\r\n\t\tconst itemPile = sourceIsItemPile ? Utilities.getToken(sourceUuid) : Utilities.getToken(targetUuid);\r\n\r\n\t\tconst shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(itemPileUuid);\r\n\t\tif (shouldBeDeleted) {\r\n\t\t\tawait this._deleteItemPile(itemPileUuid);\r\n\t\t} else if (PileUtilities.isItemPileLootable(itemPile)) {\r\n\t\t\tif (PileUtilities.isItemPileEmpty(itemPile)) {\r\n\t\t\t\tawait SharingUtilities.clearItemPileSharingData(itemPile);\r\n\t\t\t} else {\r\n\t\t\t\tawait SharingUtilities.setItemPileSharingData(sourceUuid, targetUuid, {\r\n\t\t\t\t\titems: itemDeltas, attributes: attributeDeltas\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else if (!skipVaultLogging && (PileUtilities.isItemPileVault(sourceActor) || PileUtilities.isItemPileVault(targetActor))) {\r\n\t\t\tconst sourceIsItemPile = PileUtilities.isItemPileVault(sourceActor);\r\n\t\t\tconst pileActor = sourceIsItemPile ? sourceActor : targetActor;\r\n\t\t\tconst actorToLog = sourceIsItemPile ? targetActor : sourceActor;\r\n\t\t\tawait PileUtilities.updateVaultLog(pileActor, {\r\n\t\t\t\tuserId, actor: actorToLog, items: itemDeltas, attributes: attributeDeltas, withdrawal: sourceIsItemPile\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn { itemDeltas, attributeDeltas };\r\n\r\n\t}\r\n\r\n\tstatic async _transferAllCurrencies(sourceUuid, targetUuid, userId, {\r\n\t\tskipVaultLogging = false, interactionId = false\r\n\t} = {}) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(sourceUuid);\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst currencyList = PileUtilities.getCurrencyList();\r\n\t\tconst sourceCurrencyList = PileUtilities.getActorCurrencies(sourceActor, { currencyList });\r\n\r\n\t\tconst itemsToTransfer = sourceCurrencyList.filter(currency => currency.type === \"item\")\r\n\t\t\t.map(currency => ({ item: currency.data.item, quantity: currency.quantity }));\r\n\r\n\t\tconst attributesToTransfer = sourceCurrencyList.filter(currency => currency.type === \"attribute\")\r\n\t\t\t.map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n\t\tconst sourceTransaction = new Transaction(sourceActor);\r\n\t\tawait sourceTransaction.appendItemChanges(itemsToTransfer, { remove: true, type: \"currency\" });\r\n\t\tawait sourceTransaction.appendDocumentChanges(attributesToTransfer, { remove: true, type: \"currency\" });\r\n\t\tconst sourceUpdates = sourceTransaction.prepare();\r\n\r\n\t\tconst targetTransaction = new Transaction(targetActor);\r\n\t\tawait targetTransaction.appendItemChanges(sourceUpdates.itemDeltas);\r\n\t\tawait targetTransaction.appendDocumentChanges(sourceUpdates.attributeDeltas);\r\n\t\tconst targetUpdates = targetTransaction.prepare();\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.CURRENCY.PRE_TRANSFER_ALL, sourceActor, sourceUpdates, targetActor, targetUpdates, interactionId);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tawait sourceTransaction.commit();\r\n\t\tconst { itemDeltas, attributeDeltas } = await targetTransaction.commit();\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.CURRENCY.TRANSFER_ALL, sourceUuid, targetUuid, itemDeltas, attributeDeltas, userId, interactionId);\r\n\r\n\t\tconst macroData = {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.TRANSFER_ALL_CURRENCIES,\r\n\t\t\tsource: sourceUuid,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\titems: itemDeltas,\r\n\t\t\tattributes: attributeDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t};\r\n\t\tawait this._executeItemPileMacro(sourceUuid, macroData);\r\n\t\tawait this._executeItemPileMacro(targetUuid, macroData);\r\n\r\n\t\tconst sourceIsItemPile = PileUtilities.isValidItemPile(sourceActor);\r\n\t\tconst itemPileUuid = sourceIsItemPile ? sourceUuid : targetUuid;\r\n\t\tconst itemPile = sourceIsItemPile ? Utilities.getToken(sourceUuid) : Utilities.getToken(targetUuid);\r\n\r\n\t\tconst shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(itemPileUuid);\r\n\t\tif (shouldBeDeleted) {\r\n\t\t\tawait this._deleteItemPile(itemPileUuid);\r\n\t\t} else if (!skipVaultLogging && PileUtilities.isItemPileVault(itemPile)) {\r\n\t\t\tconst pileActor = sourceIsItemPile ? sourceActor : targetActor;\r\n\t\t\tconst actorToLog = sourceIsItemPile ? targetActor : sourceActor;\r\n\t\t\tawait PileUtilities.updateVaultLog(pileActor, {\r\n\t\t\t\tuserId, actor: actorToLog, items: itemDeltas, attributes: attributeDeltas, withdrawal: sourceIsItemPile\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn { itemDeltas, attributeDeltas };\r\n\r\n\t}\r\n\r\n\tstatic async _setAttributes(targetUuid, attributes, userId, { interactionId = false } = {}) {\r\n\r\n\t\tconst targetDocument = Utilities.getDocument(targetUuid);\r\n\r\n\t\tconst transaction = new Transaction(targetDocument);\r\n\t\tawait transaction.appendDocumentChanges(attributes, { set: true });\r\n\t\tconst { actorUpdates } = transaction.prepare();\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ATTRIBUTE.PRE_SET, targetDocument, actorUpdates, interactionId);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tconst { attributeDeltas } = await transaction.commit();\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.ATTRIBUTE.SET, targetUuid, attributeDeltas, userId, interactionId);\r\n\r\n\t\tawait this._executeItemPileMacro(targetUuid, {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.SET_ATTRIBUTES,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\tattributes: attributeDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t});\r\n\r\n\t\treturn attributeDeltas;\r\n\r\n\t}\r\n\r\n\tstatic async _addAttributes(targetUuid, attributes, userId, {\r\n\t\tskipVaultLogging = false, interactionId = false\r\n\t} = {}) {\r\n\r\n\t\tconst targetDocument = Utilities.getDocument(targetUuid);\r\n\r\n\t\tconst transaction = new Transaction(targetDocument);\r\n\t\tawait transaction.appendDocumentChanges(attributes);\r\n\t\tconst { actorUpdates } = transaction.prepare();\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ATTRIBUTE.PRE_ADD, targetDocument, actorUpdates, interactionId);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tconst { attributeDeltas } = await transaction.commit();\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.ATTRIBUTE.ADD, targetUuid, attributeDeltas, userId, interactionId);\r\n\r\n\t\tawait this._executeItemPileMacro(targetUuid, {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.ADD_ATTRIBUTES,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\tattributes: attributeDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t});\r\n\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\t\tif (!skipVaultLogging && PileUtilities.isItemPileVault(targetActor)) {\r\n\t\t\tawait PileUtilities.updateVaultLog(targetActor, {\r\n\t\t\t\tuserId, attributes: attributeDeltas, withdrawal: false\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn attributeDeltas;\r\n\r\n\t}\r\n\r\n\tstatic async _removeAttributes(targetUuid, attributes, userId, {\r\n\t\tskipVaultLogging = false, interactionId = false\r\n\t} = {}) {\r\n\r\n\t\tconst targetDocument = Utilities.getDocument(targetUuid);\r\n\r\n\t\tconst transaction = new Transaction(targetDocument);\r\n\t\tawait transaction.appendDocumentChanges(attributes, { remove: true });\r\n\t\tconst { actorUpdates } = transaction.prepare();\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ATTRIBUTE.PRE_REMOVE, targetDocument, actorUpdates, interactionId);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tconst { attributeDeltas } = await transaction.commit();\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.ATTRIBUTE.REMOVE, targetUuid, attributeDeltas, userId, interactionId);\r\n\r\n\t\tawait this._executeItemPileMacro(targetUuid, {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.REMOVE_ATTRIBUTES,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\tattributes: attributeDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t});\r\n\r\n\t\tconst shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(targetUuid);\r\n\t\tif (shouldBeDeleted) {\r\n\t\t\tawait this._deleteItemPile(targetUuid);\r\n\t\t}\r\n\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\t\tif (!skipVaultLogging && PileUtilities.isItemPileVault(targetActor)) {\r\n\t\t\tawait PileUtilities.updateVaultLog(targetActor, {\r\n\t\t\t\tuserId, attributes: attributeDeltas, withdrawal: true\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn attributeDeltas;\r\n\r\n\t}\r\n\r\n\tstatic async _transferAttributes(sourceUuid, targetUuid, attributes, userId, {\r\n\t\tskipVaultLogging = false, interactionId = false\r\n\t} = {}) {\r\n\r\n\t\tconst sourceDocument = Utilities.getDocument(sourceUuid);\r\n\t\tconst targetDocument = Utilities.getDocument(targetUuid);\r\n\r\n\t\tconst sourceTransaction = new Transaction(sourceDocument);\r\n\t\tawait sourceTransaction.appendDocumentChanges(attributes, { remove: true });\r\n\t\tconst sourceUpdates = sourceTransaction.prepare();\r\n\r\n\t\tconst targetTransaction = new Transaction(targetDocument);\r\n\t\tawait targetTransaction.appendDocumentChanges(sourceUpdates.attributeDeltas);\r\n\t\tconst targetUpdates = targetTransaction.prepare();\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ATTRIBUTE.PRE_TRANSFER, sourceDocument, sourceUpdates.actorUpdates, targetDocument, targetUpdates.actorUpdates, interactionId);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tawait sourceTransaction.commit();\r\n\t\tconst { attributeDeltas } = await targetTransaction.commit();\r\n\r\n\t\tawait ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.CALL_HOOK, CONSTANTS.HOOKS.ATTRIBUTE.TRANSFER, sourceUuid, targetUuid, attributeDeltas, userId, interactionId);\r\n\r\n\t\tconst macroData = {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.TRANSFER_ATTRIBUTES,\r\n\t\t\tsource: sourceUuid,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\tattributes: attributeDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t};\r\n\t\tawait this._executeItemPileMacro(sourceUuid, macroData);\r\n\t\tawait this._executeItemPileMacro(targetUuid, macroData);\r\n\r\n\t\tconst sourceActor = Utilities.getActor(sourceUuid);\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst sourceIsItemPile = PileUtilities.isValidItemPile(sourceActor);\r\n\r\n\t\tconst itemPileUuid = sourceIsItemPile ? sourceUuid : targetUuid;\r\n\t\tconst itemPile = sourceIsItemPile ? Utilities.getToken(sourceUuid) : Utilities.getToken(targetUuid);\r\n\r\n\t\tconst shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(itemPileUuid);\r\n\t\tif (shouldBeDeleted) {\r\n\t\t\tawait this._deleteItemPile(itemPileUuid);\r\n\t\t} else if (PileUtilities.isItemPileLootable(itemPile)) {\r\n\t\t\tif (PileUtilities.isItemPileEmpty(itemPile)) {\r\n\t\t\t\tawait SharingUtilities.clearItemPileSharingData(itemPile);\r\n\t\t\t} else {\r\n\t\t\t\tawait SharingUtilities.setItemPileSharingData(sourceUuid, targetUuid, {\r\n\t\t\t\t\tattributes: attributeDeltas\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else if (!skipVaultLogging && (PileUtilities.isItemPileVault(sourceActor) || PileUtilities.isItemPileVault(targetActor))) {\r\n\t\t\tconst pileActor = sourceIsItemPile ? sourceActor : targetActor;\r\n\t\t\tconst actorToLog = sourceIsItemPile ? targetActor : sourceActor;\r\n\t\t\tawait PileUtilities.updateVaultLog(pileActor, {\r\n\t\t\t\tuserId, actor: actorToLog, attributes: attributeDeltas, withdrawal: sourceIsItemPile\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn attributeDeltas;\r\n\r\n\t}\r\n\r\n\tstatic async _transferAllAttributes(sourceUuid, targetUuid, userId, {\r\n\t\tskipVaultLogging = false, interactionId = false\r\n\t} = {}) {\r\n\r\n\t\tconst sourceDocument = Utilities.getDocument(sourceUuid);\r\n\t\tconst targetDocument = Utilities.getDocument(targetUuid);\r\n\r\n\t\tconst sourceAttributes = PileUtilities.getActorCurrencies(sourceDocument).filter(entry => entry.type === \"attribute\");\r\n\t\tconst attributesToTransfer = sourceAttributes.filter(attribute => {\r\n\t\t\treturn foundry.utils.hasProperty(targetActor, attribute.data.path);\r\n\t\t}).map(attribute => attribute.data.path);\r\n\r\n\t\tconst sourceTransaction = new Transaction(sourceDocument);\r\n\t\tawait sourceTransaction.appendDocumentChanges(attributesToTransfer, { remove: true });\r\n\t\tconst sourceUpdates = sourceTransaction.prepare();\r\n\r\n\t\tconst targetTransaction = new Transaction(targetDocument);\r\n\t\tawait targetTransaction.appendDocumentChanges(sourceUpdates.attributeDeltas);\r\n\t\tconst targetUpdates = targetTransaction.prepare();\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ATTRIBUTE.PRE_TRANSFER_ALL, sourceDocument, sourceUpdates.actorUpdates, targetDocument, targetUpdates.actorUpdates, interactionId);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tawait sourceTransaction.commit();\r\n\t\tconst { attributeDeltas } = await targetTransaction.commit();\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.ATTRIBUTE.TRANSFER_ALL, sourceUuid, targetUuid, attributeDeltas, userId, interactionId);\r\n\r\n\t\tconst macroData = {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.TRANSFER_ALL_ATTRIBUTES,\r\n\t\t\tsource: sourceUuid,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\tattributes: attributeDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t};\r\n\t\tawait this._executeItemPileMacro(sourceUuid, macroData);\r\n\t\tawait this._executeItemPileMacro(targetUuid, macroData);\r\n\r\n\t\tconst sourceActor = Utilities.getActor(sourceUuid);\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst sourceIsItemPile = PileUtilities.isValidItemPile(sourceActor);\r\n\r\n\t\tconst itemPileUuid = sourceIsItemPile ? sourceUuid : targetUuid;\r\n\r\n\t\tconst shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(itemPileUuid);\r\n\t\tif (shouldBeDeleted) {\r\n\t\t\tawait this._deleteItemPile(itemPileUuid);\r\n\t\t}\r\n\r\n\t\treturn attributeDeltas;\r\n\r\n\t}\r\n\r\n\tstatic async _transferEverything(sourceUuid, targetUuid, userId, { itemFilters = false, interactionId } = {}) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(sourceUuid);\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst itemsToTransfer = PileUtilities.getActorItems(sourceActor, { itemFilters }).map(item => item.toObject());\r\n\r\n\t\tconst sourceCurrencies = PileUtilities.getActorCurrencies(sourceActor);\r\n\r\n\t\tconst itemCurrenciesToTransfer = sourceCurrencies\r\n\t\t\t.filter(currency => currency.type === \"item\")\r\n\t\t\t.map(currency => ({ id: currency.id, quantity: currency.quantity }));\r\n\r\n\t\tconst attributesToTransfer = sourceCurrencies\r\n\t\t\t.filter(entry => entry.type === \"attribute\")\r\n\t\t\t.map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n\t\tconst sourceTransaction = new Transaction(sourceActor);\r\n\t\tawait sourceTransaction.appendItemChanges(itemsToTransfer, { remove: true });\r\n\t\tawait sourceTransaction.appendItemChanges(itemCurrenciesToTransfer, {\r\n\t\t\tremove: true, type: \"currency\"\r\n\t\t});\r\n\t\tawait sourceTransaction.appendDocumentChanges(attributesToTransfer, { remove: true, type: \"currency\" });\r\n\t\tconst sourceUpdates = sourceTransaction.prepare();\r\n\r\n\t\tconst targetTransaction = new Transaction(targetActor);\r\n\t\tawait targetTransaction.appendItemChanges(sourceUpdates.itemDeltas);\r\n\t\tawait targetTransaction.appendDocumentChanges(sourceUpdates.attributeDeltas);\r\n\t\tconst targetUpdates = targetTransaction.prepare();\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PRE_TRANSFER_EVERYTHING, sourceActor, sourceUpdates, targetActor, targetUpdates, interactionId);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tawait sourceTransaction.commit();\r\n\t\tconst { itemDeltas, attributeDeltas } = await targetTransaction.commit();\r\n\r\n\t\tawait ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.CALL_HOOK, CONSTANTS.HOOKS.TRANSFER_EVERYTHING, sourceUuid, targetUuid, itemDeltas, attributeDeltas, userId, interactionId);\r\n\r\n\t\tconst macroData = {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.TRANSFER_EVERYTHING,\r\n\t\t\tsource: sourceUuid,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\titems: itemDeltas,\r\n\t\t\tattributes: attributeDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t};\r\n\t\tawait this._executeItemPileMacro(sourceUuid, macroData);\r\n\t\tawait this._executeItemPileMacro(targetUuid, macroData);\r\n\r\n\t\tconst shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(sourceUuid);\r\n\t\tif (shouldBeDeleted) {\r\n\t\t\tawait this._deleteItemPile(sourceUuid);\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\titemsTransferred: itemDeltas, attributesTransferred: attributeDeltas\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tstatic async _combineItemPiles(targetUuid, sourceUuids, userId, {\r\n\t\titemFilters = false,\r\n\t\ttargetItemPileFlags = false,\r\n\t\tinteractionId\r\n\t} = {}) {\r\n\r\n\t\tconst sourceActors = sourceUuids.map(Utilities.getActor);\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst targetTransaction = new Transaction(targetActor);\r\n\r\n\t\tconst sourceTransactions = [];\r\n\t\tfor (const sourceActor of sourceActors) {\r\n\r\n\t\t\tconst itemsToTransfer = PileUtilities.getActorItems(sourceActor, { itemFilters })\r\n\t\t\t\t.map(item => item.toObject());\r\n\r\n\t\t\tconst sourceCurrencies = PileUtilities.getActorCurrencies(sourceActor);\r\n\r\n\t\t\tconst itemCurrenciesToTransfer = sourceCurrencies\r\n\t\t\t\t.filter(currency => currency.type === \"item\")\r\n\t\t\t\t.map(currency => ({ id: currency.id, quantity: currency.quantity }));\r\n\r\n\t\t\tconst attributesToTransfer = sourceCurrencies\r\n\t\t\t\t.filter(entry => entry.type === \"attribute\")\r\n\t\t\t\t.map(currency => ({ path: currency.data.path, quantity: currency.quantity }));\r\n\r\n\t\t\tconst sourceTransaction = new Transaction(sourceActor);\r\n\t\t\tawait sourceTransaction.appendItemChanges(itemsToTransfer, { remove: true });\r\n\t\t\tawait sourceTransaction.appendItemChanges(itemCurrenciesToTransfer, {\r\n\t\t\t\tremove: true, type: \"currency\"\r\n\t\t\t});\r\n\t\t\tawait sourceTransaction.appendDocumentChanges(attributesToTransfer, { remove: true, type: \"currency\" });\r\n\t\t\tconst sourceUpdates = sourceTransaction.prepare();\r\n\r\n\t\t\tawait targetTransaction.appendItemChanges(sourceUpdates.itemDeltas);\r\n\t\t\tawait targetTransaction.appendDocumentChanges(sourceUpdates.attributeDeltas);\r\n\r\n\t\t\tsourceTransactions.push({ transaction: sourceTransaction, updates: sourceUpdates });\r\n\r\n\t\t}\r\n\r\n\t\tconst targetUpdates = targetTransaction.prepare();\r\n\t\tconst sourceUpdates = sourceTransactions.map(data => data.updates)\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PRE_TRANSFER_EVERYTHING, sourceActors, sourceUpdates, targetActor, targetUpdates, interactionId);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tawait Promise.allSettled(sourceTransactions.map(data => data.transaction.commit()));\r\n\t\tconst { itemDeltas, attributeDeltas } = await targetTransaction.commit();\r\n\r\n\t\tif (targetItemPileFlags) {\r\n\t\t\tconst flags = PileUtilities.cleanFlagData(foundry.utils.mergeObject(CONSTANTS.PILE_DEFAULTS, targetItemPileFlags));\r\n\t\t\tawait PileUtilities.updateItemPileData(targetActor, flags);\r\n\t\t}\r\n\r\n\t\tawait ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.CALL_HOOK, CONSTANTS.HOOKS.TRANSFER_EVERYTHING, sourceUuids, targetUuid, itemDeltas, attributeDeltas, userId, interactionId);\r\n\r\n\t\tconst macroData = {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.TRANSFER_EVERYTHING,\r\n\t\t\tsources: sourceUuids,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\titems: itemDeltas,\r\n\t\t\tattributes: attributeDeltas,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t};\r\n\t\tawait Promise.allSettled(sourceUuids.map(uuid => this._executeItemPileMacro(uuid, { ...macroData, source: uuid })));\r\n\t\tawait this._executeItemPileMacro(targetUuid, { ...macroData, source: false });\r\n\r\n\t\tconst tokensToDelete = sourceUuids\r\n\t\t\t.filter(PileUtilities.shouldItemPileBeDeleted)\r\n\t\t\t.map(Utilities.getToken)\r\n\t\t\t.map(Utilities.getDocument)\r\n\t\t\t.filter(Boolean)\r\n\t\t\t.reduce((acc, doc) => {\r\n\t\t\t\tacc[doc.parent.id] ??= [];\r\n\t\t\t\tacc[doc.parent.id].push(doc.id);\r\n\t\t\t\treturn acc;\r\n\t\t\t}, {});\r\n\r\n\t\tfor (const [sceneId, tokenIds] of Object.entries(tokensToDelete)) {\r\n\t\t\tconst scene = game.scenes.get(sceneId);\r\n\t\t\tif (scene) await scene.deleteEmbeddedDocuments(\"Token\", tokenIds);\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\titemsTransferred: itemDeltas, attributesTransferred: attributeDeltas, deletedTokens: tokensToDelete\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tstatic async _commitDocumentChanges(documentUuid, {\r\n\t\tdocumentChanges = {}, itemsToUpdate = [], itemsToDelete = [], itemsToCreate = []\r\n\t} = {}) {\r\n\t\tconst targetDocument = Utilities.getDocument(documentUuid);\r\n\t\tif (!foundry.utils.isEmpty(documentChanges)) {\r\n\t\t\tawait targetDocument.update(documentChanges);\r\n\t\t}\r\n\t\tconst createdItems = itemsToCreate.length\r\n\t\t\t? await targetDocument.createEmbeddedDocuments(\"Item\", itemsToCreate, { keepId: true, keepEmbeddedIds: true })\r\n\t\t\t: [];\r\n\t\tif (itemsToUpdate.length) await targetDocument.updateEmbeddedDocuments(\"Item\", itemsToUpdate);\r\n\t\tif (itemsToDelete.length) await targetDocument.deleteEmbeddedDocuments(\"Item\", itemsToDelete);\r\n\t\treturn createdItems.map(item => item.toObject());\r\n\t}\r\n\r\n\t/**\r\n\t * If not given an actor, this method creates an item pile at a location, then adds an item to it.\r\n\t *\r\n\t * If a target was provided, it will just add the item to that target actor.\r\n\t *\r\n\t * If an actor was provided, it will transfer the item from the actor to the target actor.\r\n\t *\r\n\t * @param {String} userId\r\n\t * @param {String} sceneId\r\n\t * @param {String/Boolean} [sourceUuid=false]\r\n\t * @param {String/Boolean} [targetUuid=false]\r\n\t * @param {Object/Boolean} [position=false]\r\n\t * @param {Number/Boolean} [elevation=false]\r\n\t * @param {Object} [itemData=false]\r\n\t *\r\n\t * @returns {sourceUuid: string/boolean, targetUuid: string/boolean, position: object/boolean, itemsDropped: array }\r\n\t */\r\n\tstatic async _dropItems({\r\n\t\tuserId, sceneId, sourceUuid = false, targetUuid = false, itemData = false, position = false, elevation = false\r\n\t} = {}) {\r\n\r\n\t\tlet itemsDropped;\r\n\r\n\t\tfoundry.utils.setProperty(itemData.item, game.itempiles.API.ITEM_QUANTITY_ATTRIBUTE, itemData?.quantity ?? 1);\r\n\t\tconst containerItems = [itemData.item];\r\n\t\tconst item = fromUuidSync(itemData.uuid);\r\n\t\tconst handler = Utilities.getItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.TRANSFER, item.type);\r\n\t\tif (handler) handler({ item, items: containerItems });\r\n\t\tconst items = containerItems.map(item => ({\r\n\t\t\titem,\r\n\t\t\tflags: undefined,\r\n\t\t\tquantity: Utilities.getItemQuantity(item)\r\n\t\t}));\r\n\r\n\t\t// If there's a source of the item (it wasn't dropped from the item bar)\r\n\t\tif (sourceUuid) {\r\n\r\n\t\t\t// If there's a target token, add the item to it, otherwise create a new pile at the drop location\r\n\t\t\tif (targetUuid) {\r\n\t\t\t\titemsDropped = await this._transferItems(sourceUuid, targetUuid, items, userId);\r\n\t\t\t} else {\r\n\r\n\t\t\t\titemsDropped = (await this._removeItems(sourceUuid, items, userId)).map(item => {\r\n\t\t\t\t\titem.quantity = Math.abs(item.quantity)\r\n\t\t\t\t\tUtilities.setItemQuantity(item.item, Math.abs(item.quantity), true);\r\n\t\t\t\t\treturn item;\r\n\t\t\t\t});\r\n\t\t\t\ttargetUuid = await this._createItemPile({\r\n\t\t\t\t\tsceneId, position, items: itemsDropped, tokenOverrides: {\r\n\t\t\t\t\t\televation: elevation || fromUuidSync(sourceUuid)?.elevation || 0\r\n\t\t\t\t\t}, checkContainers: false\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\t// If there's no source (it was dropped from the item bar)\r\n\t\t} else {\r\n\r\n\t\t\t// If there's a target token, add the item to it, otherwise create a new pile at the drop location\r\n\t\t\tif (targetUuid) {\r\n\t\t\t\titemsDropped = await this._addItems(targetUuid, items, userId);\r\n\t\t\t} else {\r\n\t\t\t\ttargetUuid = await this._createItemPile({\r\n\t\t\t\t\tsceneId, position, items: items.map(data => data.item), tokenOverrides: { elevation: elevation || 0 }\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.ITEM.DROP, sourceUuid, targetUuid, itemsDropped, position);\r\n\r\n\t\treturn { sourceUuid, targetUuid, position, itemsDropped };\r\n\r\n\t}\r\n\r\n\tstatic async _createItemPile({\r\n\t\tsceneId = null,\r\n\t\tposition = false,\r\n\t\tactor = false,\r\n\t\tcreateActor = false,\r\n\t\titems = false,\r\n\t\ttokenOverrides = {},\r\n\t\tactorOverrides = {},\r\n\t\titemPileFlags = {},\r\n\t\tfolders = false\r\n\t} = {}) {\r\n\r\n\t\tlet returns = {};\r\n\r\n\t\tlet pileActor;\r\n\r\n\t\tif (createActor) {\r\n\r\n\t\t\tconst pileDataDefaults = PileUtilities.getPileActorDefaults({ ...itemPileFlags, enabled: true });\r\n\r\n\t\t\tconst actorData = {\r\n\t\t\t\tname: actor || \"New Item Pile\", type: Helpers.getSetting(\"actorClassType\"), img: \"icons/svg/item-bag.svg\"\r\n\t\t\t};\r\n\r\n\t\t\tif (folders) {\r\n\t\t\t\tconst folder = await Utilities.createFoldersFromNames(folders);\r\n\t\t\t\tif (folder) {\r\n\t\t\t\t\tactorData.folder = folder.id;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tpileActor = await Actor.create(actorData);\r\n\r\n\t\t\tconst prototypeTokenData = foundry.utils.mergeObject({\r\n\t\t\t\tname: \"Item Pile\",\r\n\t\t\t\tactorLink: false,\r\n\t\t\t\tbar1: { attribute: \"\" },\r\n\t\t\t\tvision: false,\r\n\t\t\t\tdisplayName: 50,\r\n\t\t\t\t[CONSTANTS.FLAGS.PILE]: pileDataDefaults,\r\n\t\t\t\t[CONSTANTS.FLAGS.VERSION]: Helpers.getModuleVersion(), ...Helpers.getSetting(SETTINGS.TOKEN_FLAG_DEFAULTS)\r\n\t\t\t}, tokenOverrides)\r\n\r\n\t\t\tconst actorUpdate = foundry.utils.mergeObject({\r\n\t\t\t\t[CONSTANTS.FLAGS.PILE]: pileDataDefaults,\r\n\t\t\t\t[CONSTANTS.FLAGS.VERSION]: Helpers.getModuleVersion(),\r\n\t\t\t\tprototypeToken: prototypeTokenData,\r\n\t\t\t}, actorOverrides)\r\n\r\n\t\t\tawait pileActor.update(actorUpdate);\r\n\r\n\t\t} else if (!actor) {\r\n\r\n\t\t\tconst defaultItemPileId = Helpers.getSetting(SETTINGS.DEFAULT_ITEM_PILE_ACTOR_ID);\r\n\t\t\tpileActor = game.actors.get(defaultItemPileId);\r\n\r\n\t\t\tif (!pileActor) {\r\n\r\n\t\t\t\tHelpers.custom_notify(\"A Default Item Pile has been added to your Actors list. You can configure the default look and behavior on it, or duplicate it to create different styles.\")\r\n\r\n\t\t\t\tlet pileDataDefaults = foundry.utils.deepClone(CONSTANTS.PILE_DEFAULTS);\r\n\r\n\t\t\t\tpileDataDefaults.enabled = true;\r\n\t\t\t\tif (foundry.utils.isEmpty(itemPileFlags)) {\r\n\t\t\t\t\tpileDataDefaults.deleteWhenEmpty = true;\r\n\t\t\t\t\tpileDataDefaults.displayOne = true;\r\n\t\t\t\t\tpileDataDefaults.showItemName = true;\r\n\t\t\t\t\tpileDataDefaults.overrideSingleItemScale = true;\r\n\t\t\t\t\tpileDataDefaults.singleItemScale = 0.75;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpileDataDefaults = foundry.utils.mergeObject(pileDataDefaults, itemPileFlags);\r\n\r\n\t\t\t\tconst actorData = {\r\n\t\t\t\t\tname: \"Default Item Pile\", type: Helpers.getSetting(\"actorClassType\"), img: \"icons/svg/item-bag.svg\"\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (folders) {\r\n\t\t\t\t\tconst folder = await Utilities.createFoldersFromNames(folders);\r\n\t\t\t\t\tif (folder) {\r\n\t\t\t\t\t\tactorData.folder = folder.id;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpileActor = await Actor.create(actorData);\r\n\r\n\t\t\t\tawait pileActor.update({\r\n\t\t\t\t\t[CONSTANTS.FLAGS.PILE]: pileDataDefaults,\r\n\t\t\t\t\t[CONSTANTS.FLAGS.VERSION]: Helpers.getModuleVersion(),\r\n\t\t\t\t\tprototypeToken: {\r\n\t\t\t\t\t\tname: \"Item Pile\",\r\n\t\t\t\t\t\tactorLink: false,\r\n\t\t\t\t\t\tbar1: { attribute: \"\" },\r\n\t\t\t\t\t\tvision: false,\r\n\t\t\t\t\t\tdisplayName: 50,\r\n\t\t\t\t\t\t[CONSTANTS.FLAGS.PILE]: pileDataDefaults,\r\n\t\t\t\t\t\t[CONSTANTS.FLAGS.VERSION]: Helpers.getModuleVersion(), ...Helpers.getSetting(SETTINGS.TOKEN_FLAG_DEFAULTS)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\tawait game.settings.set(CONSTANTS.MODULE_NAME, SETTINGS.DEFAULT_ITEM_PILE_ACTOR_ID, pileActor.id);\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tpileActor = await fromUuid(actor);\r\n\r\n\t\t\tif (!pileActor) {\r\n\t\t\t\tthrow Helpers.custom_error(\"Could not find actor with UUID \" + actor);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif (items) {\r\n\t\t\tfor (let i = 0; i < items.length; i++) {\r\n\t\t\t\tlet itemData = items[i]?.item ?? items[i];\r\n\t\t\t\titemData = new Item.implementation(itemData);\r\n\t\t\t\titemData = itemData.toObject();\r\n\t\t\t\tif (SYSTEMS.DATA.ITEM_TRANSFORMER) {\r\n\t\t\t\t\titemData = await SYSTEMS.DATA.ITEM_TRANSFORMER(itemData);\r\n\t\t\t\t}\r\n\t\t\t\titems[i] = itemData;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\titems = []\r\n\t\t}\r\n\r\n\t\titems = items ? items.map(item => {\r\n\t\t\treturn item.item ?? item;\r\n\t\t}) : [];\r\n\r\n\t\tif (position && sceneId) {\r\n\r\n\t\t\tlet pileData = PileUtilities.getActorFlagData(pileActor);\r\n\t\t\tpileData.enabled = true;\r\n\t\t\tpileData = foundry.utils.mergeObject(pileData, itemPileFlags);\r\n\r\n\t\t\tlet overrideData = foundry.utils.mergeObject({\r\n\t\t\t\t...position,\r\n\t\t\t\t...tokenOverrides,\r\n\t\t\t\t...Helpers.getSetting(SETTINGS.TOKEN_FLAG_DEFAULTS)\r\n\t\t\t}, {});\r\n\r\n\t\t\tif (!pileActor.prototypeToken.actorLink) {\r\n\r\n\t\t\t\toverrideData[CONSTANTS.ACTOR_DELTA_PROPERTY] = actorOverrides;\r\n\r\n\t\t\t\tconst data = { data: pileData, items: [...items] };\r\n\r\n\t\t\t\tfor (let index = 0; index < data.items.length; index++) {\r\n\t\t\t\t\tdata.items[index] = new Item.implementation(data.items[index]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst overrideImage = foundry.utils.getProperty(overrideData, \"texture.src\")\r\n\t\t\t\t\t?? foundry.utils.getProperty(overrideData, \"img\");\r\n\t\t\t\tconst overrideScale = foundry.utils.getProperty(overrideData, \"texture.scaleX\")\r\n\t\t\t\t\t?? foundry.utils.getProperty(overrideData, \"texture.scaleY\")\r\n\t\t\t\t\t?? foundry.utils.getProperty(overrideData, \"scale\");\r\n\r\n\t\t\t\tconst scale = PileUtilities.getItemPileTokenScale(pileActor, data, overrideScale);\r\n\r\n\t\t\t\toverrideData = foundry.utils.mergeObject(overrideData, {\r\n\t\t\t\t\t\"texture.src\": PileUtilities.getItemPileTokenImage(pileActor, data, overrideImage),\r\n\t\t\t\t\t\"texture.scaleX\": scale,\r\n\t\t\t\t\t\"texture.scaleY\": scale,\r\n\t\t\t\t\t\"name\": PileUtilities.getItemPileName(pileActor, data, overrideData?.name)\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_CREATE, overrideData, items);\r\n\t\t\tif (hookResult === false) return false;\r\n\r\n\t\t\tconst tokenData = (await pileActor.getTokenDocument(overrideData)).toObject();\r\n\r\n\t\t\tconst cleanItemPileConfig = PileUtilities.cleanFlagData(pileData);\r\n\t\t\tUtilities.deleteProperty(tokenData, CONSTANTS.FLAGS.PILE);\r\n\t\t\tfoundry.utils.setProperty(tokenData, CONSTANTS.FLAGS.PILE, cleanItemPileConfig);\r\n\t\t\tif (!pileActor.prototypeToken.actorLink) {\r\n\t\t\t\tUtilities.deleteProperty(tokenData, CONSTANTS.ACTOR_DELTA_PROPERTY + \".\" + CONSTANTS.FLAGS.PILE);\r\n\t\t\t\tfoundry.utils.setProperty(tokenData, CONSTANTS.ACTOR_DELTA_PROPERTY + \".\" + CONSTANTS.FLAGS.PILE, cleanItemPileConfig);\r\n\t\t\t}\r\n\r\n\t\t\tconst scene = game.scenes.get(sceneId);\r\n\r\n\t\t\tconst [tokenDocument] = await scene.createEmbeddedDocuments(\"Token\", [tokenData]);\r\n\r\n\t\t\tif (items.length && !pileActor.prototypeToken.actorLink) {\r\n\t\t\t\tnew Promise(async (resolve) => {\r\n\t\t\t\t\tawait Helpers.wait(250);\r\n\t\t\t\t\tawait Helpers.hooks.runWithout(async () => {\r\n\t\t\t\t\t\tconst newItems = Utilities.ensureValidIds(tokenDocument.actor, items);\r\n\t\t\t\t\t\tawait tokenDocument.actor.createEmbeddedDocuments(\"Item\", newItems, {\r\n\t\t\t\t\t\t\tkeepId: true,\r\n\t\t\t\t\t\t\tkeepEmbeddedIds: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturns[\"tokenUuid\"] = Utilities.getUuid(tokenDocument);\r\n\r\n\t\t} else if (pileActor.prototypeToken.actorLink) {\r\n\r\n\t\t\tif (items.length && !pileActor.prototypeToken.actorLink) {\r\n\t\t\t\tawait Helpers.hooks.runWithout(async () => {\r\n\t\t\t\t\tconst newItems = Utilities.ensureValidIds(pileActor, items);\r\n\t\t\t\t\tawait pileActor.createEmbeddedDocuments(\"Item\", newItems, { keepId: true, keepEmbeddedIds: true });\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturns[\"actorUuid\"] = pileActor.uuid;\r\n\r\n\t\treturn returns;\r\n\r\n\t}\r\n\r\n\tstatic async _turnTokensIntoItemPiles(targetUuids, pileSettings = {}, tokenSettings = {}) {\r\n\r\n\t\tconst tokenUpdateGroups = {};\r\n\t\tconst actorUpdateGroups = {};\r\n\r\n\t\tfor (const targetUuid of targetUuids) {\r\n\r\n\t\t\tconst target = fromUuidSync(targetUuid);\r\n\r\n\t\t\tlet targetItemPileSettings = PileUtilities.getActorFlagData(target);\r\n\r\n\t\t\tconst defaultItemPileId = Helpers.getSetting(SETTINGS.DEFAULT_ITEM_PILE_ACTOR_ID);\r\n\t\t\tconst defaultItemPileActor = game.actors.get(defaultItemPileId);\r\n\t\t\tif (defaultItemPileActor) {\r\n\t\t\t\tconst defaultItemPileSettings = PileUtilities.getActorFlagData(defaultItemPileActor);\r\n\t\t\t\ttargetItemPileSettings = foundry.utils.mergeObject(targetItemPileSettings, defaultItemPileSettings);\r\n\t\t\t}\r\n\r\n\t\t\tlet specificPileSettings = foundry.utils.mergeObject(targetItemPileSettings, pileSettings);\r\n\t\t\tspecificPileSettings.enabled = true;\r\n\r\n\t\t\tconst targetItems = PileUtilities.getActorItems(target, { itemFilters: specificPileSettings.overrideItemFilters });\r\n\t\t\tconst targetCurrencies = PileUtilities.getActorCurrencies(target, { currencyList: specificPileSettings.overrideCurrencies });\r\n\r\n\t\t\tconst data = { data: specificPileSettings, items: targetItems, currencies: targetCurrencies };\r\n\r\n\t\t\tlet specificTokenSettings = Helpers.isFunction(tokenSettings) ? await tokenSettings(target) : foundry.utils.deepClone(tokenSettings);\r\n\r\n\t\t\tconst overrideImage = foundry.utils.getProperty(specificTokenSettings, \"texture.src\")\r\n\t\t\t\t?? foundry.utils.getProperty(specificTokenSettings, \"img\");\r\n\t\t\tconst overrideScale = foundry.utils.getProperty(specificTokenSettings, \"texture.scaleX\")\r\n\t\t\t\t?? foundry.utils.getProperty(specificTokenSettings, \"texture.scaleY\")\r\n\t\t\t\t?? foundry.utils.getProperty(specificTokenSettings, \"scale\");\r\n\r\n\t\t\tconst scale = PileUtilities.getItemPileTokenScale(target, data, overrideScale);\r\n\r\n\t\t\tspecificTokenSettings = foundry.utils.mergeObject(specificTokenSettings, {\r\n\t\t\t\t\"texture.src\": PileUtilities.getItemPileTokenImage(target, data, overrideImage),\r\n\t\t\t\t\"texture.scaleX\": scale,\r\n\t\t\t\t\"texture.scaleY\": scale,\r\n\t\t\t\t\"name\": PileUtilities.getItemPileName(target, data, specificTokenSettings?.name)\r\n\t\t\t});\r\n\r\n\t\t\tconst sceneId = targetUuid.split('.')[1];\r\n\t\t\tconst tokenId = targetUuid.split('.')[3];\r\n\r\n\t\t\tif (!tokenUpdateGroups[sceneId]) {\r\n\t\t\t\ttokenUpdateGroups[sceneId] = []\r\n\t\t\t}\r\n\r\n\t\t\ttokenUpdateGroups[sceneId].push({\r\n\t\t\t\t\"_id\": tokenId, ...specificTokenSettings, [CONSTANTS.FLAGS.PILE]: specificPileSettings\r\n\t\t\t});\r\n\r\n\t\t\tif (target.isLinked) {\r\n\t\t\t\tif (actorUpdateGroups[target.actor.id]) continue;\r\n\t\t\t\tactorUpdateGroups[target.actor.id] = {\r\n\t\t\t\t\t\"_id\": target.actor.id, [CONSTANTS.FLAGS.PILE]: specificPileSettings\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_TURN_INTO, tokenUpdateGroups, actorUpdateGroups);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tawait Actor.updateDocuments(Object.values(actorUpdateGroups));\r\n\r\n\t\tfor (const [sceneId, updateData] of Object.entries(tokenUpdateGroups)) {\r\n\t\t\tconst scene = game.scenes.get(sceneId);\r\n\t\t\tawait scene.updateEmbeddedDocuments(\"Token\", updateData, { animate: false });\r\n\t\t}\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.PILE.TURN_INTO, tokenUpdateGroups, actorUpdateGroups);\r\n\r\n\t\treturn targetUuids;\r\n\r\n\t}\r\n\r\n\tstatic async _revertTokensFromItemPiles(targetUuids, tokenSettings) {\r\n\r\n\t\tconst actorUpdateGroups = {};\r\n\t\tconst tokenUpdateGroups = {};\r\n\r\n\t\tfor (const targetUuid of targetUuids) {\r\n\r\n\t\t\tlet target = fromUuidSync(targetUuid);\r\n\r\n\t\t\tlet specificPileSettings = PileUtilities.getActorFlagData(target);\r\n\t\t\tspecificPileSettings.enabled = false;\r\n\r\n\t\t\tconst sceneId = targetUuid.split('.')[1];\r\n\t\t\tconst tokenId = targetUuid.split('.')[3];\r\n\r\n\t\t\tif (!tokenUpdateGroups[sceneId]) {\r\n\t\t\t\ttokenUpdateGroups[sceneId] = [];\r\n\t\t\t}\r\n\r\n\t\t\tconst specificTokenSettings = Helpers.isFunction(tokenSettings) ? await tokenSettings(target) : foundry.utils.deepClone(tokenSettings);\r\n\r\n\t\t\ttokenUpdateGroups[sceneId].push({\r\n\t\t\t\t\"_id\": tokenId, ...specificTokenSettings, [CONSTANTS.FLAGS.PILE]: specificPileSettings\r\n\t\t\t});\r\n\r\n\t\t\tif (target.isLinked) {\r\n\t\t\t\tif (actorUpdateGroups[target.actor.id]) continue;\r\n\t\t\t\tactorUpdateGroups[target.actor.id] = {\r\n\t\t\t\t\t\"_id\": target.actor.id, [CONSTANTS.FLAGS.PILE]: specificPileSettings\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_REVERT_FROM, tokenUpdateGroups, actorUpdateGroups);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tawait Actor.updateDocuments(Object.values(actorUpdateGroups));\r\n\r\n\t\tfor (const [sceneId, updateData] of Object.entries(tokenUpdateGroups)) {\r\n\t\t\tconst scene = game.scenes.get(sceneId);\r\n\t\t\tawait scene.updateEmbeddedDocuments(\"Token\", updateData, { animate: false });\r\n\t\t}\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.PILE.REVERT_FROM, tokenUpdateGroups, actorUpdateGroups);\r\n\r\n\t\treturn targetUuids;\r\n\r\n\t}\r\n\r\n\tstatic async _updateItemPile(targetUuid, newData, { interactingTokenUuid = false, tokenSettings = false } = {}) {\r\n\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\t\tconst interactingToken = interactingTokenUuid ? Utilities.getToken(interactingTokenUuid) : false;\r\n\r\n\t\tconst oldData = PileUtilities.getActorFlagData(targetActor);\r\n\r\n\t\tconst data = foundry.utils.mergeObject(foundry.utils.deepClone(oldData), foundry.utils.deepClone(newData));\r\n\r\n\t\tconst diff = foundry.utils.diffObject(oldData, data);\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_UPDATE, targetActor, data, interactingToken, tokenSettings);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tawait Helpers.wait(15);\r\n\r\n\t\tawait PileUtilities.updateItemPileData(targetActor, data, tokenSettings);\r\n\r\n\t\tif (PileUtilities.isItemPileContainer(targetActor, data)) {\r\n\t\t\tif (diff?.closed === true) {\r\n\t\t\t\tawait this._executeItemPileMacro(targetUuid, {\r\n\t\t\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.OPEN_ITEM_PILE, source: interactingTokenUuid, target: targetUuid\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (diff?.locked === true) {\r\n\t\t\t\tawait this._executeItemPileMacro(targetUuid, {\r\n\t\t\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.LOCK_ITEM_PILE, source: interactingTokenUuid, target: targetUuid\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (diff?.locked === false) {\r\n\t\t\t\tawait this._executeItemPileMacro(targetUuid, {\r\n\t\t\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.UNLOCK_ITEM_PILE, source: interactingTokenUuid, target: targetUuid\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (diff?.closed === false) {\r\n\t\t\t\tawait this._executeItemPileMacro(targetUuid, {\r\n\t\t\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.OPEN_ITEM_PILE, source: interactingTokenUuid, target: targetUuid\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.UPDATED_PILE, targetUuid, diff, interactingTokenUuid);\r\n\t}\r\n\r\n\tstatic _updatedItemPile(targetUuid, diffData, interactingTokenUuid) {\r\n\r\n\t\tconst target = Utilities.getToken(targetUuid);\r\n\r\n\t\tconst interactingToken = interactingTokenUuid ? fromUuidSync(interactingTokenUuid) : false;\r\n\r\n\t\tif (foundry.utils.isEmpty(diffData)) return false;\r\n\r\n\t\tconst data = PileUtilities.getActorFlagData(target);\r\n\r\n\t\tHelpers.hooks.callAll(CONSTANTS.HOOKS.PILE.UPDATE, target, diffData, interactingToken)\r\n\r\n\t\tif (PileUtilities.isItemPileContainer(target, data)) {\r\n\t\t\tif (diffData?.closed === true) {\r\n\t\t\t\tHelpers.hooks.callAll(CONSTANTS.HOOKS.PILE.CLOSE, target, interactingToken)\r\n\t\t\t}\r\n\t\t\tif (diffData?.locked === true) {\r\n\t\t\t\tHelpers.hooks.callAll(CONSTANTS.HOOKS.PILE.LOCK, target, interactingToken)\r\n\t\t\t}\r\n\t\t\tif (diffData?.locked === false) {\r\n\t\t\t\tHelpers.hooks.callAll(CONSTANTS.HOOKS.PILE.UNLOCK, target, interactingToken)\r\n\t\t\t}\r\n\t\t\tif (diffData?.closed === false) {\r\n\t\t\t\tHelpers.hooks.callAll(CONSTANTS.HOOKS.PILE.OPEN, target, interactingToken)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tstatic async _deleteItemPile(targetUuid) {\r\n\t\tconst target = Utilities.getToken(targetUuid);\r\n\t\tif (!target) return false;\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_DELETE, target);\r\n\t\tif (hookResult === false) return false;\r\n\t\treturn target.document.delete();\r\n\t}\r\n\r\n\t/* -------- PRIVATE ITEM PILE METHODS -------- */\r\n\r\n\t/**\r\n\t * Checks whether a given item pile would need to update its images, text, and/or scale\r\n\t *\r\n\t * @param {foundry.abstract.Document} doc\r\n\t * @param {object} changes\r\n\t * @param {boolean} force\r\n\t * @returns {*}\r\n\t * @private\r\n\t */\r\n\tstatic async _evaluateItemPileChange(doc, changes = {}, force = false) {\r\n\t\tconst diff = foundry.utils.diffObject(doc, changes);\r\n\t\tconst duplicatedChanges = foundry.utils.deepClone(diff);\r\n\t\tconst target = doc?.token ?? doc;\r\n\t\tif (!Helpers.isResponsibleGM()) return;\r\n\t\tif (!force && !PileUtilities.shouldEvaluateChange(target, duplicatedChanges)) return;\r\n\t\tconst targetUuid = target.uuid;\r\n\t\treturn Helpers.debounceManager.setDebounce(targetUuid, async (uuid) => {\r\n\t\t\tif (!Utilities.getDocument(uuid)) return;\r\n\t\t\tconst deleted = PileUtilities.shouldItemPileBeDeleted(uuid);\r\n\t\t\tif (deleted) return;\r\n\t\t\tawait Helpers.hooks.runWithout(async () => {\r\n\t\t\t\tawait PileUtilities.updateItemPileData(uuid);\r\n\t\t\t});\r\n\t\t})(targetUuid);\r\n\t}\r\n\r\n\t/**\r\n\t * Pre-loads all images and sounds related to a given token document on the client-side.\r\n\t *\r\n\t * @param {TokenDocument} tokenDocument\r\n\t * @return {Promise<boolean>}\r\n\t */\r\n\tstatic async _preloadItemPileFiles(tokenDocument) {\r\n\r\n\t\tif (!PileUtilities.isItemPileContainer(tokenDocument)) return false;\r\n\r\n\t\tconst pileData = PileUtilities.getActorFlagData(tokenDocument);\r\n\r\n\t\tif (Helpers.getSetting(\"preloadFiles\")) {\r\n\t\t\tawait Promise.allSettled(Object.entries(pileData).map(entry => {\r\n\t\t\t\treturn new Promise(async (resolve) => {\r\n\t\t\t\t\tconst [property, filePath] = entry;\r\n\t\t\t\t\tif (Array.isArray(filePath)) {\r\n\t\t\t\t\t\treturn resolve();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst isImage = property.toLowerCase().includes(\"image\");\r\n\t\t\t\t\tconst isSound = property.toLowerCase().includes(\"sound\");\r\n\t\t\t\t\tif ((!isImage && !isSound) || (!filePath || preloadedFiles.has(filePath))) return resolve();\r\n\t\t\t\t\tpreloadedFiles.add(filePath);\r\n\t\t\t\t\tif (isImage) {\r\n\t\t\t\t\t\tawait loadTexture(filePath);\r\n\t\t\t\t\t\tHelpers.debug(`Preloaded image: ${filePath}`);\r\n\t\t\t\t\t} else if (isSound) {\r\n\t\t\t\t\t\tHelpers.debug(`Preloaded sound: ${filePath}`);\r\n\t\t\t\t\t\tawait AudioHelper.preloadSound(filePath);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t});\r\n\t\t\t}));\r\n\t\t}\r\n\r\n\t\tHelpers.debug(`Initialized item pile with uuid ${tokenDocument.uuid}`);\r\n\t}\r\n\r\n\t/**\r\n\t * This executes any macro that is configured on the item pile, providing the macro with extra data relating to the\r\n\t * action that prompted the execution (if the advanced-macros module is installed)\r\n\t *\r\n\t * @param {String} targetUuid\r\n\t * @param {Object} macroData\r\n\t * @return {Promise/Boolean}\r\n\t */\r\n\tstatic async _executeItemPileMacro(targetUuid, macroData) {\r\n\r\n\t\tconst target = Utilities.getToken(targetUuid);\r\n\r\n\t\tif (!PileUtilities.isValidItemPile(target)) return;\r\n\r\n\t\tconst pileData = PileUtilities.getActorFlagData(target);\r\n\r\n\t\tif (!pileData.macro) return;\r\n\r\n\t\t// Reformat macro data to contain useful information\r\n\t\tif (macroData.source) {\r\n\t\t\tmacroData.source = fromUuidSync(macroData.source);\r\n\t\t}\r\n\r\n\t\tif (Array.isArray(macroData.target)) {\r\n\r\n\t\t\tmacroData.target = macroData.target.map(target => fromUuidSync(target));\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif (macroData.target) {\r\n\t\t\t\tmacroData.target = fromUuidSync(macroData.target);\r\n\t\t\t}\r\n\r\n\t\t\tconst sourceActor = macroData.source instanceof TokenDocument ? macroData.source.actor : macroData.source;\r\n\t\t\tconst targetActor = macroData.target instanceof TokenDocument ? macroData.target.actor : macroData.target;\r\n\r\n\t\t\tif (macroData.items) {\r\n\t\t\t\tmacroData.items = macroData.items.map(item => targetActor.items.get(item?.item?._id ?? item._id));\r\n\t\t\t}\r\n\r\n\t\t\tif (macroData.sourceItems) {\r\n\t\t\t\tmacroData.sourceItems = macroData.sourceItems.map(item => sourceActor.items.get(item?.item?._id ?? item._id));\r\n\t\t\t}\r\n\r\n\t\t\tif (macroData.targetItems) {\r\n\t\t\t\tmacroData.targetItems = macroData.targetItems.map(item => targetActor.items.get(item?.item?._id ?? item._id));\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn Utilities.runMacro(pileData.macro, macroData)\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * This handles any dropped data onto the canvas or a set item pile\r\n\t *\r\n\t * @param {canvas} canvas\r\n\t * @param {Object} data\r\n\t * @return {Promise}\r\n\t */\r\n\tstatic async _dropData(canvas, data) {\r\n\r\n\t\tif (data.type !== \"Item\") return;\r\n\r\n\t\tlet item = await Item.implementation.fromDropData(data);\r\n\t\tlet itemData = item ? item.toObject() : false;\r\n\r\n\t\tif (!itemData) {\r\n\t\t\tconsole.error(data);\r\n\t\t\tthrow Helpers.custom_error(\"Something went wrong when dropping this item!\")\r\n\t\t}\r\n\r\n\t\tconst dropData = {\r\n\t\t\tsource: false, target: data?.target ?? false, elevation: data?.elevation, itemData: {\r\n\t\t\t\titem: itemData, quantity: 1, uuid: data?.uuid\r\n\t\t\t}, position: false\r\n\t\t};\r\n\r\n\t\tdropData.source = Utilities.getSourceActorFromDropData(data);\r\n\r\n\t\tif (!dropData.source && !game.user.isGM) {\r\n\t\t\treturn Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Errors.NoSourceDrop\"), true)\r\n\t\t}\r\n\r\n\t\tconst pre_drop_determined_hook = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_DROP_DETERMINED, dropData.source, dropData.target, dropData.itemData, dropData.position);\r\n\t\tif (pre_drop_determined_hook === false) return;\r\n\r\n\t\tlet droppableDocuments = [];\r\n\t\tlet x, y;\r\n\r\n\t\tif (dropData.target) {\r\n\r\n\t\t\tdroppableDocuments.push(dropData.target);\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconst position = canvas.grid.getTopLeft(data.x, data.y);\r\n\t\t\tx = position[0];\r\n\t\t\ty = position[1];\r\n\r\n\t\t\tdroppableDocuments = Utilities.getTokensAtLocation({ x, y })\r\n\t\t\t\t.map(token => Utilities.getDocument(token));\r\n\r\n\t\t\tif (droppableDocuments.length && game.modules.get(\"midi-qol\")?.active && game.settings.get(\"midi-qol\", \"DragDropTarget\")) {\r\n\t\t\t\tHelpers.custom_warning(\"You have Drag & Drop Targetting enabled in MidiQOL, which disables drag & drop items\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!droppableDocuments.length) {\r\n\t\t\t\tdropData.position = { x, y };\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst droppableItemPiles = droppableDocuments.filter(token => PileUtilities.isValidItemPile(token));\r\n\t\tconst droppableNormalTokens = droppableDocuments.filter(token => !PileUtilities.isValidItemPile(token));\r\n\r\n\t\tdropData.target = droppableItemPiles?.[0] ?? droppableNormalTokens[0];\r\n\r\n\t\tconst sourceIsVault = dropData.source ? PileUtilities.isItemPileVault(dropData.source) : false;\r\n\t\tconst targetIsVault = PileUtilities.isItemPileVault(dropData.target);\r\n\t\tconst targetIsItemPile = PileUtilities.isValidItemPile(droppableItemPiles[0]);\r\n\r\n\t\tconst canGiveItems = Helpers.getSetting(SETTINGS.ENABLE_GIVING_ITEMS);\r\n\t\tconst canDropItems = Helpers.getSetting(SETTINGS.ENABLE_DROPPING_ITEMS);\r\n\r\n\t\tconst givingItem = canGiveItems && dropData.target && !targetIsItemPile;\r\n\t\tconst droppingItem = canDropItems && (dropData.target || dropData.position);\r\n\r\n\t\tif ((sourceIsVault || targetIsVault) && dropData.target) {\r\n\t\t\treturn this._depositWithdrawItem(dropData, sourceIsVault, targetIsVault);\r\n\t\t} else if (givingItem && canGiveItems) {\r\n\t\t\treturn this._giveItem(dropData);\r\n\t\t} else if (droppingItem && canDropItems) {\r\n\t\t\treturn this._dropItem(dropData);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tstatic async _depositWithdrawItem(dropData, sourceIsVault = false, targetIsVault = true) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(dropData.source);\r\n\t\tconst targetActor = Utilities.getActor(dropData.target);\r\n\t\tif (sourceActor && targetActor && sourceActor === targetActor) return;\r\n\r\n\t\tconst vaultActor = (!sourceIsVault && targetIsVault) || !sourceActor ? targetActor : sourceActor;\r\n\t\tconst localization = (!sourceIsVault && targetIsVault) || !sourceActor ? \"DepositItem\" : \"WithdrawItem\";\r\n\r\n\t\tconst validItem = await PileUtilities.checkItemType(vaultActor, dropData.itemData.item);\r\n\t\tif (!validItem) return;\r\n\t\tdropData.itemData.item = validItem;\r\n\r\n\t\tconst item = new Item.implementation(dropData.itemData.item);\r\n\r\n\t\tdropData.itemData.quantity = 1;\r\n\t\tif (PileUtilities.canItemStack(dropData.itemData.item, vaultActor)) {\r\n\t\t\tconst itemQuantity = Utilities.getItemQuantity(dropData.itemData.item);\r\n\t\t\tif (itemQuantity > 1) {\r\n\t\t\t\tdropData.itemData.quantity = await DropItemDialog.show(item, vaultActor, {\r\n\t\t\t\t\tlocalizationTitle: localization\r\n\t\t\t\t});\r\n\t\t\t} else if (!itemQuantity || itemQuantity <= 0) {\r\n\t\t\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Errors.ItemNoQuantity\"), true);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tUtilities.setItemQuantity(dropData.itemData.item, dropData.itemData.quantity);\r\n\r\n\t\tlet flagData = PileUtilities.getItemFlagData(dropData.itemData.item);\r\n\t\tif (!sourceIsVault && targetIsVault) {\r\n\t\t\tfoundry.utils.setProperty(flagData, \"x\", dropData.gridPosition?.x ?? 0);\r\n\t\t\tfoundry.utils.setProperty(flagData, \"y\", dropData.gridPosition?.y ?? 0);\r\n\t\t}\r\n\t\tfoundry.utils.setProperty(dropData.itemData, CONSTANTS.FLAGS.ITEM, flagData);\r\n\r\n\t\tif (sourceActor) {\r\n\t\t\treturn game.itempiles.API.transferItems(sourceActor, targetActor, [dropData.itemData], { interactionId: dropData.interactionId });\r\n\t\t}\r\n\r\n\t\tif (!game.user.isGM) return;\r\n\r\n\t\treturn game.itempiles.API.addItems(targetActor, [dropData.itemData], { interactionId: dropData.interactionId });\r\n\r\n\t}\r\n\r\n\tstatic async _dropItem(dropData) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(dropData.source);\r\n\t\tconst targetActor = Utilities.getActor(dropData.target);\r\n\t\tif (sourceActor && targetActor && sourceActor === targetActor) return;\r\n\r\n\t\tif (dropData.target && PileUtilities.isItemPileMerchant(dropData.target)) return;\r\n\r\n\t\tconst validItem = await PileUtilities.checkItemType(dropData.target, dropData.itemData.item);\r\n\t\tif (!validItem) return;\r\n\t\tdropData.itemData.item = validItem;\r\n\r\n\t\tif (dropData.target && !dropData.position && !game.user.isGM) {\r\n\r\n\t\t\tif (!(dropData.target instanceof Actor && dropData.source instanceof Actor)) {\r\n\r\n\t\t\t\tconst sourceToken = canvas.tokens.placeables.find(token => token.actor === dropData.source);\r\n\r\n\t\t\t\tif (sourceToken) {\r\n\r\n\t\t\t\t\tconst distance = Math.floor(Utilities.distance_between_rect(sourceToken, dropData.target.object) / canvas.grid.size) + 1\r\n\r\n\t\t\t\t\tconst pileData = PileUtilities.getActorFlagData(dropData.target);\r\n\r\n\t\t\t\t\tconst maxDistance = pileData?.distance ? pileData?.distance : Infinity;\r\n\r\n\t\t\t\t\tif (distance > maxDistance) {\r\n\t\t\t\t\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Errors.PileTooFar\"), true);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (game.itempiles.API.isItemPileLocked(dropData.target)) {\r\n\t\t\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Errors.PileLocked\"), true);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tdropData.itemData.quantity = 1;\r\n\r\n\t\tif (PileUtilities.canItemStack(dropData.itemData.item, targetActor)) {\r\n\r\n\t\t\tlet itemQuantity = Utilities.getItemQuantity(dropData.itemData.item);\r\n\r\n\t\t\tif (!itemQuantity || itemQuantity <= 0) {\r\n\t\t\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Errors.ItemNoQuantity\"), true);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!hotkeyActionState.forceDropOneItem) {\r\n\r\n\t\t\t\tif (!dropData.skipCheck) {\r\n\t\t\t\t\tconst item = new Item.implementation(dropData.itemData.item);\r\n\t\t\t\t\titemQuantity = await DropItemDialog.show(item, dropData.target, { unlimitedQuantity: !dropData.source && game.user.isGM });\r\n\t\t\t\t\tif (!itemQuantity) return;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdropData.itemData.quantity = Number(itemQuantity);\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tUtilities.setItemQuantity(dropData.itemData.item, dropData.itemData.quantity);\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_DROP, dropData.source, dropData.target, dropData.position, dropData.itemData);\r\n\t\tif (hookResult === false) return;\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.DROP_ITEMS, {\r\n\t\t\tuserId: game.user.id,\r\n\t\t\tsceneId: canvas?.scene?.id ?? \"\",\r\n\t\t\tsourceUuid: Utilities.getUuid(dropData.source),\r\n\t\t\ttargetUuid: Utilities.getUuid(dropData.target),\r\n\t\t\tposition: dropData.position,\r\n\t\t\televation: dropData.elevation,\r\n\t\t\titemData: dropData.itemData\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tstatic async _giveItem(dropData, options = {}) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(dropData.source);\r\n\t\tconst targetActor = Utilities.getActor(dropData.target);\r\n\t\tif (sourceActor === targetActor) return;\r\n\r\n\t\tconst sourceUuid = Utilities.getUuid(sourceActor);\r\n\t\tconst targetUuid = Utilities.getUuid(targetActor);\r\n\r\n\t\tconst validItem = await PileUtilities.checkItemType(dropData.target, dropData.itemData.item);\r\n\t\tif (!validItem) return;\r\n\t\tdropData.itemData.item = validItem;\r\n\r\n\t\tconst actorOwners = Object.entries(targetActor.ownership)\r\n\t\t\t.filter(entry => {\r\n\t\t\t\treturn entry[0] !== \"default\" && entry[1] === CONST.DOCUMENT_OWNERSHIP_LEVELS.OWNER;\r\n\t\t\t})\r\n\t\t\t.map(entry => game.users.get(entry[0]))\r\n\t\t\t.sort(user => user.isGM ? 1 : -1);\r\n\r\n\t\tlet user = actorOwners?.[0];\r\n\r\n\t\tif (user && !user?.active) {\r\n\t\t\tuser = Helpers.getActiveGMs()?.[0];\r\n\t\t}\r\n\r\n\t\tif (user && !user?.active && !game.user.isGM) {\r\n\t\t\treturn TJSDialog.prompt({\r\n\t\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Dialogs.GiveItemUserNotActive.Title\"), content: {\r\n\t\t\t\t\tclass: CustomDialog, props: {\r\n\t\t\t\t\t\tcontent: game.i18n.format(\"ITEM-PILES.Dialogs.GiveItemUserNotActive.Content\", {\r\n\t\t\t\t\t\t\tactor_name: targetActor.name, user_name: user.name\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst item = new Item.implementation(dropData.itemData.item);\r\n\r\n\t\tif (!sourceActor && game.user.isGM) {\r\n\t\t\tHelpers.custom_notify(game.i18n.format(\"ITEM-PILES.Notifications.ItemAdded\", {\r\n\t\t\t\ttarget_actor_name: targetActor.name, item_name: item.name\r\n\t\t\t}));\r\n\t\t\treturn this._addItems(targetUuid, [dropData.itemData.item], game.user.id)\r\n\t\t}\r\n\r\n\t\tconst gms = Helpers.getActiveGMs().map(user => user.id);\r\n\r\n\t\tif (user?.active || gms.length || game.user.isGM) {\r\n\r\n\t\t\tif (PileUtilities.canItemStack(dropData.itemData.item)) {\r\n\t\t\t\tlet itemQuantity = Utilities.getItemQuantity(item);\r\n\t\t\t\tif ((!itemQuantity || itemQuantity <= 0)) {\r\n\t\t\t\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Errors.ItemNoQuantity\"), true);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!options?.skipQuantityDialog) {\r\n\t\t\t\t\tdropData.itemData.quantity = await DropItemDialog.show(item, dropData.target.actor, {\r\n\t\t\t\t\t\tlocalizationTitle: \"GiveItem\"\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (!dropData.itemData.quantity) {\r\n\t\t\t\t\tdropData.itemData.quantity = 1;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tdropData.itemData.quantity = 1;\r\n\t\t\t}\r\n\r\n\t\t\tUtilities.setItemQuantity(dropData.itemData.item, dropData.itemData.quantity);\r\n\t\t\tfoundry.utils.setProperty(dropData.itemData, \"quantity\", dropData.itemData.quantity);\r\n\r\n\t\t\tif (Hooks.call(CONSTANTS.HOOKS.ITEM.PRE_GIVE, sourceActor, targetActor, dropData.itemData, user.id) === false) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ((!user || !user?.active || user === game.user) && game.user.isGM) {\r\n\t\t\t\tif (sourceActor) {\r\n\t\t\t\t\tHelpers.custom_notify(game.i18n.format(\"ITEM-PILES.Notifications.ItemTransferred\", {\r\n\t\t\t\t\t\tsource_actor_name: sourceActor.name, target_actor_name: targetActor.name, item_name: item.name\r\n\t\t\t\t\t}));\r\n\t\t\t\t\tHooks.callAll(CONSTANTS.HOOKS.ITEM.GIVE, sourceActor, targetActor, dropData.itemData, game.user.id, game.user.id, dropData?.secret);\r\n\t\t\t\t\treturn this._transferItems(sourceUuid, targetUuid, [dropData.itemData], game.user.id)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn ItemPileSocket.executeForUsers(ItemPileSocket.HANDLERS.GIVE_ITEMS, [user ? user.id : gms[0]], {\r\n\t\t\t\tuserId: game.user.id, sourceUuid, targetUuid, itemData: dropData.itemData, secret: dropData?.secret\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tstatic async _giveItems({ userId, sourceUuid, targetUuid, itemData } = {}) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(sourceUuid);\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst item = new Item.implementation(itemData.item);\r\n\r\n\t\tconst accepted = await TJSDialog.confirm({\r\n\t\t\ttitle: \"Item Piles - \" + game.i18n.localize(\"ITEM-PILES.Dialogs.ReceiveItem.Title\"), content: {\r\n\t\t\t\tclass: ReceiveItemsShell, props: {\r\n\t\t\t\t\tsourceActor, targetActor, quantity: itemData.quantity, item\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (accepted) {\r\n\t\t\tawait PrivateAPI._addItems(targetUuid, [itemData], game.user.id);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeForUsers(ItemPileSocket.HANDLERS.GIVE_ITEMS_RESPONSE, [userId], {\r\n\t\t\tuserId: game.user.id, accepted, sourceUuid, targetUuid, itemData\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tstatic async _giveItemsResponse({ userId, accepted, sourceUuid, targetUuid, itemData, secret } = {}) {\r\n\t\tconst user = game.users.get(userId);\r\n\t\tif (accepted) {\r\n\t\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.ITEM.GIVE, sourceUuid, targetUuid, itemData, game.user.id, userId, secret)\r\n\t\t\tawait PrivateAPI._removeItems(sourceUuid, [itemData], game.user.id);\r\n\t\t\treturn Helpers.custom_notify(game.i18n.format(\"ITEM-PILES.Notifications.GiveItemAccepted\", { user_name: user.name }));\r\n\t\t}\r\n\t\treturn Helpers.custom_warning(game.i18n.format(\"ITEM-PILES.Warnings.GiveItemDeclined\", { user_name: user.name }), true);\r\n\t}\r\n\r\n\tstatic async _itemPileClicked(pileDocument) {\r\n\r\n\t\tif (!PileUtilities.isValidItemPile(pileDocument)) return;\r\n\r\n\t\tif (PileUtilities.isItemPileLootable(pileDocument) && !Helpers.isGMConnected()) {\r\n\t\t\tHelpers.custom_warning(`Item Piles requires a GM to be connected for players to be able to loot item piles.`, true)\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst pileToken = pileDocument.object;\r\n\r\n\t\tHelpers.debug(`Clicked: ${pileDocument.uuid}`);\r\n\r\n\t\tconst pileData = PileUtilities.getActorFlagData(pileDocument);\r\n\r\n\t\tconst maxDistance = pileData.distance ? pileData.distance : Infinity;\r\n\r\n\t\tlet validTokens = [];\r\n\r\n\t\tlet playerToken = false;\r\n\t\tif (game.user.character) {\r\n\t\t\tplayerToken = canvas.tokens.placeables.find(token => token.actor === game.user.character && Utilities.tokens_close_enough(pileToken, token, maxDistance));\r\n\t\t}\r\n\r\n\t\tif (!playerToken && canvas.tokens.controlled.length > 0) {\r\n\t\t\tvalidTokens = [...canvas.tokens.controlled];\r\n\t\t\tvalidTokens = validTokens.filter(token => token.document !== pileDocument);\r\n\t\t} else if (game.user.character) {\r\n\t\t\tif (playerToken) {\r\n\t\t\t\tvalidTokens.push(playerToken);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!validTokens.length && !game.user.isGM) {\r\n\t\t\tvalidTokens.push(...canvas.tokens.placeables);\r\n\t\t\tif (_token) {\r\n\t\t\t\tvalidTokens.unshift(_token);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvalidTokens = validTokens.filter(token => token.isOwner && token.document !== pileDocument).filter(token => {\r\n\t\t\treturn Utilities.tokens_close_enough(pileToken, token, maxDistance) || game.user.isGM;\r\n\t\t});\r\n\r\n\t\tlet interactingActor;\r\n\r\n\t\tif (!validTokens.length && !game.user.isGM) {\r\n\t\t\tif (maxDistance === Infinity) {\r\n\t\t\t\tinteractingActor = Utilities.getUserCharacter();\r\n\t\t\t}\r\n\t\t\tif (!interactingActor) {\r\n\t\t\t\tHelpers.custom_warning(game.i18n.localize(maxDistance === Infinity ? \"ITEM-PILES.Errors.NoTokenFound\" : \"ITEM-PILES.Errors.PileTooFar\"), true);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!interactingActor && validTokens.length) {\r\n\t\t\tif (validTokens.includes(_token)) {\r\n\t\t\t\tinteractingActor = _token.actor;\r\n\t\t\t} else if (validTokens.includes(playerToken)) {\r\n\t\t\t\tinteractingActor = playerToken.actor;\r\n\t\t\t} else {\r\n\t\t\t\tvalidTokens.sort((potentialTargetA, potentialTargetB) => {\r\n\t\t\t\t\treturn Utilities.grids_between_tokens(pileToken, potentialTargetA) - Utilities.grids_between_tokens(pileToken, potentialTargetB);\r\n\t\t\t\t});\r\n\t\t\t\tinteractingActor = validTokens[0].actor;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (PileUtilities.isItemPileContainer(pileDocument) && interactingActor) {\r\n\r\n\t\t\tif (pileData.locked && !game.user.isGM) {\r\n\t\t\t\tHelpers.debug(`Attempted to open locked item pile with UUID ${pileDocument.uuid}`);\r\n\t\t\t\treturn game.itempiles.API.rattleItemPile(pileDocument, interactingActor);\r\n\t\t\t}\r\n\r\n\t\t\tif (pileData.closed) {\r\n\t\t\t\tHelpers.debug(`Opened item pile with UUID ${pileDocument.uuid}`);\r\n\t\t\t\tawait game.itempiles.API.openItemPile(pileDocument, interactingActor);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_CLICK, pileDocument, interactingActor);\r\n\t\tif (hookResult === false) return;\r\n\r\n\t\treturn this._renderItemPileInterface(pileDocument.uuid, { inspectingTargetUuid: interactingActor?.uuid });\r\n\r\n\t}\r\n\r\n\tstatic async _splitItemPileContents(itemPileUuid, actorUuids, userId, instigator) {\r\n\r\n\t\tconst itemPileActor = Utilities.getActor(itemPileUuid);\r\n\r\n\t\tconst items = PileUtilities.getActorItems(itemPileActor);\r\n\t\tconst currencies = PileUtilities.getActorCurrencies(itemPileActor);\r\n\r\n\t\tconst pileData = PileUtilities.getActorFlagData(itemPileActor);\r\n\t\tconst shareData = SharingUtilities.getItemPileSharingData(itemPileActor);\r\n\r\n\t\tconst tempPileTransaction = new Transaction(itemPileActor);\r\n\r\n\t\tconst numPlayers = actorUuids.length;\r\n\r\n\t\tif (pileData.shareItemsEnabled) {\r\n\t\t\tconst itemsToRemove = items.map(item => {\r\n\t\t\t\tconst itemData = item.toObject();\r\n\t\t\t\tconst quantity = Math.floor(Utilities.getItemQuantity(itemData) / numPlayers) * numPlayers;\r\n\t\t\t\treturn {\r\n\t\t\t\t\titem: itemData, quantity\r\n\t\t\t\t}\r\n\t\t\t}).filter(entry => entry.quantity);\r\n\t\t\tawait tempPileTransaction.appendItemChanges(itemsToRemove, { remove: true });\r\n\t\t}\r\n\r\n\t\tconst currencyItems = currencies.filter(entry => entry.type === \"item\").map(entry => {\r\n\t\t\tconst itemData = entry.item.toObject();\r\n\t\t\tconst quantity = Math.floor(Utilities.getItemQuantity(itemData) / numPlayers) * numPlayers;\r\n\t\t\treturn {\r\n\t\t\t\titem: itemData, quantity\r\n\t\t\t}\r\n\t\t}).filter(entry => entry.quantity);\r\n\t\tawait tempPileTransaction.appendItemChanges(currencyItems, { remove: true, type: \"currency\" });\r\n\r\n\t\tconst attributes = currencies.filter(entry => entry.type === \"attribute\").map(attribute => {\r\n\t\t\treturn {\r\n\t\t\t\t...attribute, quantity: Math.floor(attribute.quantity / numPlayers) * numPlayers\r\n\t\t\t}\r\n\t\t});\r\n\t\tawait tempPileTransaction.appendDocumentChanges(attributes, { remove: true, type: \"currency\" });\r\n\r\n\t\tif (SYSTEMS.DATA.ITEM_TYPE_HANDLERS) {\r\n\t\t\tfor (const item of items) {\r\n\t\t\t\tif (!Utilities.hasItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.HAS_CURRENCY, item.type)) continue;\r\n\t\t\t\tconst itemCurrencies = PileUtilities.getCurrenciesInItem(item, { forActor: itemPileActor });\r\n\r\n\t\t\t\tconst attributes = itemCurrencies.filter(entry => entry.type === \"attribute\").map(attribute => {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...attribute, quantity: Math.floor(attribute.quantity / numPlayers) * numPlayers\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tawait tempPileTransaction.appendEmbeddedChanges(item, attributes, { remove: true, type: \"currency\" });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst preparedData = tempPileTransaction.prepare();\r\n\r\n\t\tconst transactionMap = actorUuids.map(uuid => {\r\n\t\t\treturn [uuid, new Transaction(Utilities.getActor(uuid))];\r\n\t\t});\r\n\r\n\t\tfor (const [uuid, transaction] of transactionMap) {\r\n\r\n\t\t\tconst clonedData = foundry.utils.deepClone(preparedData);\r\n\r\n\t\t\tif (pileData.shareItemsEnabled) {\r\n\t\t\t\tawait transaction.appendItemChanges(clonedData.itemDeltas.filter(delta => delta.type === \"item\").map(delta => {\r\n\t\t\t\t\tdelta.quantity = SharingUtilities.getItemSharesLeftForActor(itemPileActor, delta.item, transaction.document, {\r\n\t\t\t\t\t\tplayers: numPlayers, shareData: shareData, floor: true\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn delta;\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\r\n\t\t\tif (pileData.shareCurrenciesEnabled || pileData.splitAllEnabled) {\r\n\t\t\t\tawait transaction.appendItemChanges(clonedData.itemDeltas.filter(delta => delta.type === \"currency\").map(delta => {\r\n\t\t\t\t\tdelta.quantity = SharingUtilities.getItemSharesLeftForActor(itemPileActor, delta.item, transaction.document, {\r\n\t\t\t\t\t\tplayers: numPlayers, shareData: shareData, floor: true\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn delta;\r\n\t\t\t\t}), { type: \"currency\" });\r\n\r\n\t\t\t\tawait transaction.appendDocumentChanges(Object.entries(clonedData.attributeDeltas).map(entry => {\r\n\t\t\t\t\tlet [path] = entry;\r\n\t\t\t\t\tconst quantity = SharingUtilities.getAttributeSharesLeftForActor(itemPileActor, path, transaction.document, {\r\n\t\t\t\t\t\tplayers: numPlayers, shareData: shareData, floor: true\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn { path, quantity };\r\n\t\t\t\t}));\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst actorPreparedData = Object.fromEntries(transactionMap.map(entry => [entry[0], entry[1].prepare()]));\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_SPLIT_INVENTORY, itemPileActor, preparedData, actorPreparedData, userId, instigator);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tconst pileDeltas = await tempPileTransaction.commit();\r\n\t\tconst actorDeltas = {};\r\n\t\tfor (const [uuid, transaction] of transactionMap) {\r\n\t\t\tactorDeltas[uuid] = await transaction.commit();\r\n\t\t}\r\n\r\n\t\tawait SharingUtilities.clearItemPileSharingData(itemPileActor);\r\n\r\n\t\tawait ItemPileSocket.callHook(CONSTANTS.HOOKS.PILE.SPLIT_INVENTORY, itemPileUuid, pileDeltas, actorDeltas, userId, instigator);\r\n\r\n\t\tawait this._executeItemPileMacro(itemPileUuid, {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.SPLIT_INVENTORY, source: itemPileUuid, target: actorUuids, transfers: {\r\n\t\t\t\tpileDeltas, actorDeltas\r\n\t\t\t}, userId: userId, instigator: instigator\r\n\t\t});\r\n\r\n\t\tconst shouldBeDeleted = PileUtilities.shouldItemPileBeDeleted(itemPileUuid);\r\n\t\tif (shouldBeDeleted) {\r\n\t\t\tawait this._deleteItemPile(itemPileUuid);\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tpileDeltas, actorDeltas\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tstatic async _updateTokenHud() {\r\n\t\tif (!canvas.tokens.hud.rendered) return;\r\n\t\treturn canvas.tokens.hud.render(true);\r\n\t}\r\n\r\n\tstatic async _renderItemPileInterface(targetUuid, {\r\n\t\tinspectingTargetUuid = false, useDefaultCharacter = false, remote = false\r\n\t} = {}) {\r\n\r\n\t\tconst target = Utilities.getActor(targetUuid);\r\n\r\n\t\tlet inspectingTarget;\r\n\t\tif (useDefaultCharacter) {\r\n\t\t\tinspectingTarget = Utilities.getUserCharacter();\r\n\t\t} else {\r\n\t\t\tinspectingTarget = inspectingTargetUuid ? fromUuidSync(inspectingTargetUuid) : false;\r\n\t\t}\r\n\r\n\t\tconst hookResult = Hooks.call(CONSTANTS.HOOKS.PRE_RENDER_INTERFACE, target, inspectingTarget)\r\n\t\tif (hookResult === false) return;\r\n\r\n\t\tconst result = await this._executeItemPileMacro(targetUuid, {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.RENDER_INTERFACE,\r\n\t\t\tsource: inspectingTarget?.uuid ?? false,\r\n\t\t\ttarget: targetUuid,\r\n\t\t\tuserId: game.user.id\r\n\t\t});\r\n\t\tif (result === false) return;\r\n\r\n\t\tif (PileUtilities.isItemPileVault(target)) {\r\n\t\t\treturn BankVaultApp.show(target, inspectingTarget)\r\n\t\t}\r\n\r\n\t\tif (PileUtilities.isItemPileMerchant(target)) {\r\n\t\t\treturn MerchantApp.show(target, inspectingTarget)\r\n\t\t}\r\n\r\n\t\treturn ItemPileInventoryApp.show(target, inspectingTarget, { remote });\r\n\r\n\t}\r\n\r\n\tstatic async _unrenderItemPileInterface(targetUuid, { remote = false } = {}) {\r\n\r\n\t\tconst target = Utilities.getActor(targetUuid);\r\n\r\n\t\treturn Promise.allSettled(Object.values(ui.windows).filter(app => {\r\n\t\t\treturn app.id.includes(`-${target.id}-`) || app?.actor === target || app?.merchant === target;\r\n\t\t}).map(app => app.close()));\r\n\r\n\t}\r\n\r\n\tstatic async _tradeItems(sellerUuid, buyerUuid, items, userId, { interactionId = false } = {}) {\r\n\r\n\t\tconst sellingActor = Utilities.getActor(sellerUuid);\r\n\t\tconst buyingActor = Utilities.getActor(buyerUuid);\r\n\r\n\t\tconst itemPrices = PileUtilities.getPaymentData({\r\n\t\t\tpurchaseData: items.map(data => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...data, item: sellingActor.items.get(data.id)\r\n\t\t\t\t}\r\n\t\t\t}), seller: sellingActor, buyer: buyingActor\r\n\t\t});\r\n\r\n\t\tconst preCalcHookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_CALC_TRADE, sellingActor, buyingActor, itemPrices, userId, interactionId);\r\n\t\tif (preCalcHookResult === false) return false;\r\n\r\n\t\tconst sellerTransaction = new Transaction(sellingActor);\r\n\t\tconst sellerFlagData = PileUtilities.getActorFlagData(sellerTransaction);\r\n\t\tconst sellerIsMerchant = PileUtilities.isItemPileMerchant(sellingActor, sellerFlagData);\r\n\t\tconst sellerInfiniteQuantity = sellerIsMerchant && sellerFlagData.infiniteQuantity;\r\n\t\tconst sellerInfiniteCurrencies = sellerIsMerchant && sellerFlagData.infiniteCurrencies;\r\n\t\tconst sellerKeepZeroQuantity = sellerIsMerchant && sellerFlagData.keepZeroQuantity;\r\n\r\n\t\tfor (const payment of itemPrices.sellerReceive) {\r\n\t\t\tif (!payment.quantity) continue;\r\n\t\t\tif (payment.type === \"attribute\") {\r\n\t\t\t\tawait sellerTransaction.appendDocumentChanges([{\r\n\t\t\t\t\tpath: payment.data.path, quantity: payment.quantity\r\n\t\t\t\t}], { type: payment.isCurrency ? \"currency\" : payment.type });\r\n\t\t\t} else {\r\n\t\t\t\tawait sellerTransaction.appendItemChanges([{\r\n\t\t\t\t\titem: payment.data.item, quantity: payment.quantity\r\n\t\t\t\t}], { type: payment.isCurrency ? \"currency\" : payment.type });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (const entry of itemPrices.buyerReceive) {\r\n\t\t\tif (!entry.quantity) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tconst onlyDelta = (sellerInfiniteCurrencies && entry.isCurrency) || (sellerInfiniteQuantity && !entry.isCurrency);\r\n\t\t\tif (entry.type === \"attribute\") {\r\n\t\t\t\tawait sellerTransaction.appendDocumentChanges([{\r\n\t\t\t\t\tpath: entry.data.path, quantity: entry.quantity\r\n\t\t\t\t}], {\r\n\t\t\t\t\tremove: true, type: entry.isCurrency ? \"currency\" : entry.type, onlyDelta\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tconst itemFlagData = PileUtilities.getItemFlagData(entry.item);\r\n\t\t\t\tconst itemInfiniteQuantity = {\r\n\t\t\t\t\t\"default\": sellerFlagData?.infiniteQuantity ?? false, \"yes\": true, \"no\": false\r\n\t\t\t\t}[itemFlagData.infiniteQuantity ?? \"default\"];\r\n\t\t\t\tif (sellerIsMerchant && itemInfiniteQuantity) continue;\r\n\t\t\t\tawait sellerTransaction.appendItemChanges([{\r\n\t\t\t\t\titem: entry.item, quantity: entry.quantity\r\n\t\t\t\t}], {\r\n\t\t\t\t\tremove: true,\r\n\t\t\t\t\ttype: entry.isCurrency ? \"currency\" : entry.type,\r\n\t\t\t\t\tkeepIfZero: itemFlagData.isService || sellerKeepZeroQuantity || itemFlagData.keepZeroQuantity,\r\n\t\t\t\t\tonlyDelta\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst buyerTransaction = new Transaction(buyingActor);\r\n\t\tconst buyerFlagData = PileUtilities.getActorFlagData(buyingActor);\r\n\t\tconst buyerIsMerchant = PileUtilities.isItemPileMerchant(buyingActor, buyerFlagData);\r\n\t\tconst buyerInfiniteCurrencies = buyerIsMerchant && buyerFlagData.infiniteCurrencies;\r\n\t\tconst buyerInfiniteQuantity = buyerIsMerchant && buyerFlagData.infiniteQuantity;\r\n\t\tconst buyerHidesNewItems = buyerIsMerchant && buyerFlagData.hideNewItems;\r\n\r\n\t\tfor (const price of itemPrices.finalPrices) {\r\n\t\t\tif (!price.quantity) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tconst onlyDelta = (buyerInfiniteCurrencies && price.isCurrency) || (buyerInfiniteQuantity && !price.isCurrency);\r\n\t\t\tif (price.type === \"attribute\") {\r\n\t\t\t\tawait buyerTransaction.appendDocumentChanges([{\r\n\t\t\t\t\tpath: price.data.path, quantity: price.quantity\r\n\t\t\t\t}], { remove: true, type: price.isCurrency ? \"currency\" : price.type, onlyDelta });\r\n\t\t\t} else {\r\n\t\t\t\tawait buyerTransaction.appendItemChanges([{\r\n\t\t\t\t\titem: price.data.item, quantity: price.quantity\r\n\t\t\t\t}], { remove: true, type: price.isCurrency ? \"currency\" : price.type, onlyDelta });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (const entry of itemPrices.buyerReceive) {\r\n\t\t\tif (!entry.quantity) continue;\r\n\t\t\tif (entry.type === \"attribute\") {\r\n\t\t\t\tawait buyerTransaction.appendDocumentChanges([{\r\n\t\t\t\t\tpath: entry.data.path, quantity: entry.quantity\r\n\t\t\t\t}], { type: entry.type });\r\n\t\t\t} else {\r\n\t\t\t\tconst itemFlagData = PileUtilities.getItemFlagData(entry.item);\r\n\t\t\t\tif (itemFlagData.isService) continue;\r\n\t\t\t\tconst item = entry.item.toObject();\r\n\t\t\t\tif (buyerHidesNewItems) {\r\n\t\t\t\t\tfoundry.utils.setProperty(item, CONSTANTS.FLAGS.ITEM + '.hidden', true);\r\n\t\t\t\t}\r\n\t\t\t\tawait buyerTransaction.appendItemChanges([{\r\n\t\t\t\t\titem: item, quantity: entry.quantity\r\n\t\t\t\t}], { type: entry.type });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (const change of itemPrices.buyerChange) {\r\n\t\t\tif (!change.quantity) continue;\r\n\t\t\tif (change.type === \"attribute\") {\r\n\t\t\t\tawait buyerTransaction.appendDocumentChanges([{\r\n\t\t\t\t\tpath: change.data.path, quantity: change.quantity\r\n\t\t\t\t}], { type: \"currency\" });\r\n\t\t\t} else {\r\n\t\t\t\tawait buyerTransaction.appendItemChanges([{\r\n\t\t\t\t\titem: change.data.item, quantity: change.quantity\r\n\t\t\t\t}], { type: \"currency\" });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst sellerUpdates = sellerTransaction.prepare();\r\n\t\tconst buyerUpdates = buyerTransaction.prepare();\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.ITEM.PRE_TRADE, sellingActor, sellerUpdates, buyingActor, buyerUpdates, userId, interactionId);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tconst sellerTransactionData = await sellerTransaction.commit();\r\n\t\tconst buyerTransactionData = await buyerTransaction.commit();\r\n\r\n\t\tconst itemPileActorUuid = sellerIsMerchant ? sellerUuid : buyerUuid;\r\n\r\n\t\tawait this._executeItemPileMacro(itemPileActorUuid, {\r\n\t\t\taction: CONSTANTS.MACRO_EXECUTION_TYPES.TRADE_ITEMS,\r\n\t\t\tsource: sellerUuid,\r\n\t\t\ttarget: buyerUuid,\r\n\t\t\tsourceIsMerchant: sellerIsMerchant,\r\n\t\t\tsourceItems: sellerTransactionData.itemDeltas,\r\n\t\t\tsourceAttributes: sellerTransactionData.attributeDeltas,\r\n\t\t\ttargetItems: buyerTransactionData.itemDeltas,\r\n\t\t\ttargetAttributes: buyerTransactionData.attributeDeltas,\r\n\t\t\tprices: itemPrices,\r\n\t\t\tuserId: userId,\r\n\t\t\tinteractionId: interactionId\r\n\t\t});\r\n\r\n\t\tconst merchantFlagData = sellerIsMerchant ? sellerFlagData : buyerFlagData;\r\n\t\tif (merchantFlagData.logMerchantActivity) {\r\n\t\t\tconst merchantActor = sellerIsMerchant ? sellingActor : buyingActor;\r\n\t\t\tconst regularActor = sellerIsMerchant ? buyingActor : sellingActor;\r\n\t\t\tawait PileUtilities.updateMerchantLog(merchantActor, {\r\n\t\t\t\ttype: \"transaction\",\r\n\t\t\t\tactor: regularActor.name,\r\n\t\t\t\tuser: userId,\r\n\t\t\t\titem: itemPrices[\"buyerReceive\"][0].name,\r\n\t\t\t\tqty: itemPrices[\"buyerReceive\"][0].quantity,\r\n\t\t\t\tprice: itemPrices.basePriceString,\r\n\t\t\t\tsold: !sellerIsMerchant\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (sellerIsMerchant) {\r\n\t\t\tfor (let entry of itemPrices.buyerReceive) {\r\n\t\t\t\tconst itemFlagData = PileUtilities.getItemFlagData(entry.item);\r\n\t\t\t\tif (!itemFlagData.macro) continue;\r\n\t\t\t\tawait Utilities.runMacro(itemFlagData.macro, {\r\n\t\t\t\t\tseller: sellingActor, buyer: buyingActor, item: entry.item, quantity: entry.quantity, userId\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tawait ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.CALL_HOOK, CONSTANTS.HOOKS.ITEM.TRADE, sellerUuid, buyerUuid, itemPrices, userId, interactionId);\r\n\r\n\t\treturn {\r\n\t\t\titemDeltas: buyerTransactionData.itemDeltas, attributeDeltas: buyerTransactionData.attributeDeltas, itemPrices\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tstatic async _rollItemTable({\r\n\t\ttable = \"\",\r\n\t\ttimesToRoll = \"1\",\r\n\t\tresetTable = true,\r\n\t\tnormalizeTable = false,\r\n\t\tdisplayChat = false,\r\n\t\trollData = {},\r\n\t\tcustomCategory = false,\r\n\t\ttargetActor = false,\r\n\t\tremoveExistingActorItems = false,\r\n\t\tuserId = false,\r\n\t} = {}) {\r\n\r\n\t\tlet items = await PileUtilities.rollTable({\r\n\t\t\ttableUuid: table,\r\n\t\t\tformula: timesToRoll,\r\n\t\t\tnormalize: normalizeTable,\r\n\t\t\tresetTable,\r\n\t\t\tdisplayChat,\r\n\t\t\trollData,\r\n\t\t\tcustomCategory\r\n\t\t});\r\n\r\n\t\tif (targetActor) {\r\n\t\t\tconst itemsToAdd = items.map((item) => {\r\n\t\t\t\tconst actualItem = item.item.toObject();\r\n\t\t\t\treturn Utilities.setItemQuantity(actualItem, item.quantity);\r\n\t\t\t});\r\n\t\t\titems = await this._addItems(targetActor, itemsToAdd, userId, { removeExistingActorItems });\r\n\t\t}\r\n\r\n\t\treturn items;\r\n\r\n\t}\r\n\r\n\tstatic async _refreshMerchantInventory(merchantUuid, {\r\n\t\tremoveExistingActorItems = false,\r\n\t\tuserId = false\r\n\t} = {}) {\r\n\r\n\t\tconst merchant = Utilities.getActor(merchantUuid);\r\n\r\n\t\tconst items = await PileUtilities.rollMerchantTables({ actor: merchant });\r\n\r\n\t\tconst itemsToAdd = items.map((item) => {\r\n\t\t\tconst actualItem = item.item.toObject();\r\n\t\t\treturn Utilities.setItemQuantity(actualItem, item.quantity);\r\n\t\t});\r\n\r\n\t\treturn this._addItems(merchantUuid, itemsToAdd, userId, { removeExistingActorItems });\r\n\r\n\t}\r\n\r\n}\r\n","import CONSTANTS from \"./constants/constants.js\";\r\nimport * as Utilities from \"./helpers/utilities.js\";\r\nimport PrivateAPI from \"./API/private-api.js\";\r\nimport * as Helpers from \"./helpers/helpers.js\";\r\n\r\nconst HOTKEYS = {\r\n\tFORCE_DEFAULT_SHEET: \"force-open-item-pile-inventory\",\r\n\tDROP: \"force-drop-item\",\r\n\tDROP_ONE: \"force-drop-one-item\"\r\n}\r\n\r\nexport const hotkeyActionState = {\r\n\tget openPileInventory() {\r\n\t\tconst down = game.keybindings.get(CONSTANTS.MODULE_NAME, HOTKEYS.FORCE_DEFAULT_SHEET).some(keybind => {\r\n\t\t\treturn window.keyboard.downKeys.has(keybind?.key);\r\n\t\t});\r\n\t\treturn (\r\n\t\t\t(!down && !game.settings.get(CONSTANTS.MODULE_NAME, \"invertSheetOpen\"))\r\n\t\t\t||\r\n\t\t\t(down && game.settings.get(CONSTANTS.MODULE_NAME, \"invertSheetOpen\"))\r\n\t\t);\r\n\t},\r\n\r\n\tget forceDropItem() {\r\n\t\treturn game.keybindings.get(CONSTANTS.MODULE_NAME, HOTKEYS.DROP).some(key => {\r\n\t\t\treturn window.keyboard.downKeys.has(key);\r\n\t\t});\r\n\t},\r\n\r\n\tget forceDropOneItem() {\r\n\t\treturn game.keybindings.get(CONSTANTS.MODULE_NAME, HOTKEYS.DROP).some(key => {\r\n\t\t\treturn window.keyboard.downKeys.has(key);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport function registerHotkeysPre() {\r\n\r\n\tgame.keybindings.register(CONSTANTS.MODULE_NAME, HOTKEYS.FORCE_DEFAULT_SHEET, {\r\n\t\tname: \"Force open inventory modifier\",\r\n\t\teditable: [\r\n\t\t\t{ key: \"ControlLeft\" },\r\n\t\t]\r\n\t});\r\n\r\n\tgame.keybindings.register(CONSTANTS.MODULE_NAME, HOTKEYS.DROP, {\r\n\t\tname: \"Force drop item (GM only) modifier\",\r\n\t\teditable: [\r\n\t\t\t{ key: \"ShiftLeft\" },\r\n\t\t]\r\n\t});\r\n\r\n\tgame.keybindings.register(CONSTANTS.MODULE_NAME, HOTKEYS.DROP_ONE, {\r\n\t\tname: \"Force drop one item modifier\",\r\n\t\teditable: [\r\n\t\t\t{ key: \"AltLeft\" },\r\n\t\t]\r\n\t});\r\n\r\n}\r\n\r\nexport function registerHotkeysPost() {\r\n\r\n\tif (!game.user.isGM) {\r\n\t\tlet clicked = false;\r\n\t\twindow.addEventListener(\"mousedown\", (event) => {\r\n\t\t\tif (!canvas.ready) return;\r\n\t\t\tif (!(canvas.activeLayer instanceof TokenLayer)) return;\r\n\t\t\tif (game.activeTool !== \"select\") return;\r\n\t\t\tconst hover = document.elementFromPoint(event.clientX, event.clientY);\r\n\t\t\tif (!hover || (hover.id !== \"board\")) return;\r\n\t\t\tif (event.button !== 0) return;\r\n\r\n\t\t\tconst pos = Helpers.getCanvasMouse().getLocalPosition(canvas.app.stage);\r\n\t\t\tconst tokens = Utilities.getTokensAtLocation(pos)\r\n\t\t\t\t.filter(token => {\r\n\t\t\t\t\tconst canView = token._canView(game.user);\r\n\t\t\t\t\tconst canSee = token.visible || game.user.isGM;\r\n\t\t\t\t\treturn !canView && canSee;\r\n\t\t\t\t});\r\n\t\t\tif (!tokens.length) return;\r\n\t\t\ttokens.sort((a, b) => b.zIndex - a.zIndex);\r\n\t\t\tconst token = Utilities.getDocument(tokens[0]);\r\n\r\n\t\t\tif (clicked === token) {\r\n\t\t\t\tclicked = false;\r\n\t\t\t\treturn PrivateAPI._itemPileClicked(token);\r\n\t\t\t}\r\n\r\n\t\t\tclicked = token;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tclicked = false;\r\n\t\t\t}, 500);\r\n\t\t});\r\n\t}\r\n}\r\n","import CONSTANTS from \"../constants/constants.js\";\nimport { SYSTEMS } from \"../systems.js\";\nimport SETTINGS from \"../constants/settings.js\";\nimport {\n\tcachedActorCurrencies,\n\tcachedCurrenciesInItem,\n\tcachedCurrencyList,\n\tcachedFilterList,\n\tcachedRequiredPropertiesList\n} from \"./caches.js\";\nimport { hotkeyActionState } from \"../hotkeys.js\";\nimport * as Utilities from \"./utilities.js\"\nimport * as Helpers from \"./helpers.js\";\nimport * as CompendiumUtilities from \"./compendium-utilities.js\";\n\nexport function getPileDefaults() {\n\treturn foundry.utils.mergeObject({}, CONSTANTS.PILE_DEFAULTS, Helpers.getSetting(SETTINGS.PILE_DEFAULTS) ?? {});\n}\n\nexport function getPileActorDefaults(itemPileFlags = {}) {\n\tconst defaultItemPileId = Helpers.getSetting(SETTINGS.DEFAULT_ITEM_PILE_ACTOR_ID);\n\tconst defaultItemPileActor = game.actors.get(defaultItemPileId);\n\n\tlet pileDataDefaults = foundry.utils.deepClone(CONSTANTS.PILE_DEFAULTS);\n\tif (foundry.utils.isEmpty(itemPileFlags) && defaultItemPileActor) {\n\t\tconst defaultItemPileSettings = getActorFlagData(defaultItemPileActor);\n\t\titemPileFlags = foundry.utils.mergeObject(pileDataDefaults, defaultItemPileSettings);\n\t}\n\n\treturn foundry.utils.mergeObject(pileDataDefaults, itemPileFlags);\n}\n\nfunction getFlagData(inDocument, flag, defaults, existing = false) {\n\tconst defaultFlags = foundry.utils.deepClone(defaults);\n\tlet flags = foundry.utils.deepClone(existing || (foundry.utils.getProperty(inDocument, flag) ?? {}));\n\tif (flag === CONSTANTS.FLAGS.PILE) {\n\t\tflags = migrateFlagData(inDocument, flags);\n\t}\n\treturn foundry.utils.mergeObject(defaultFlags, flags);\n}\n\nexport function migrateFlagData(document, data = false) {\n\n\tlet flags = data || foundry.utils.getProperty(document, CONSTANTS.FLAGS.PILE);\n\n\tif (flags.type) {\n\t\treturn flags;\n\t}\n\n\tif (flags.isMerchant) {\n\t\tflags.type = CONSTANTS.PILE_TYPES.MERCHANT;\n\t} else if (flags.isContainer) {\n\t\tflags.type = CONSTANTS.PILE_TYPES.CONTAINER;\n\t} else {\n\t\tflags.type = CONSTANTS.PILE_TYPES.PILE;\n\t}\n\n\treturn flags;\n\n}\n\nexport function areItemsColliding(itemA, itemB) {\n\tconst itemAFlags = getItemFlagData(itemA);\n\tconst itemBFlags = getItemFlagData(itemB);\n\treturn (\n\t\titemAFlags.x + (itemAFlags.width - 1) >= itemBFlags.x &&\n\t\titemAFlags.y + (itemAFlags.height - 1) >= itemBFlags.y &&\n\t\titemAFlags.x <= itemBFlags.x + (itemBFlags.width - 1) &&\n\t\titemAFlags.y <= itemBFlags.y + (itemBFlags.height - 1)\n\t);\n}\n\nexport function canItemStack(item, targetActor) {\n\tconst itemData = item instanceof Item\n\t\t? item.toObject()\n\t\t: item;\n\tconst itemFlagData = getItemFlagData(itemData);\n\tconst actorFlagData = getActorFlagData(targetActor);\n\tif (actorFlagData.enabled && actorFlagData.type === CONSTANTS.PILE_TYPES.VAULT && itemFlagData.vaultExpander) {\n\t\treturn false;\n\t}\n\tif (isItemCurrency(itemData)) return true;\n\tif (typeof actorFlagData.canStackItems === \"boolean\") {\n\t\tactorFlagData.canStackItems = \"yes\";\n\t}\n\tif (!Utilities.isItemStackable(itemData)) return false;\n\tif (actorFlagData.canStackItems.includes(\"always\")) {\n\t\treturn actorFlagData.canStackItems.endsWith(\"yes\");\n\t}\n\treturn {\n\t\t\"default\": actorFlagData.canStackItems === \"yes\", \"yes\": true, \"no\": false\n\t}[itemFlagData?.canStack ?? \"default\"];\n}\n\n/**\n *\n * @param item\n * @param options\n * @param useDefaults.data\n * @param useDefaults.useDefaults\n * @returns {Object<CONSTANTS.ITEM_DEFAULTS>}\n */\nexport function getItemFlagData(item, { data = false, useDefaults = true } = {}) {\n\treturn getFlagData(\n\t\tUtilities.getDocument(item),\n\t\tCONSTANTS.FLAGS.ITEM,\n\t\t{ ...(useDefaults ? CONSTANTS.ITEM_DEFAULTS : {}) },\n\t\tdata\n\t);\n}\n\n/**\n *\n * @param target\n * @param data\n * @param useDefaults\n * @returns {Object<CONSTANTS.PILE_DEFAULTS>}\n */\nexport function getActorFlagData(target, { data = false, useDefaults = true } = {}) {\n\tconst defaults = useDefaults ? getPileDefaults() : {};\n\ttarget = Utilities.getActor(target);\n\tif (target?.token) {\n\t\ttarget = target.token;\n\t}\n\treturn getFlagData(target, CONSTANTS.FLAGS.PILE, defaults, data);\n}\n\nexport function isValidItemPile(target, data = false) {\n\tconst targetActor = Utilities.getActor(target);\n\tconst pileData = getActorFlagData(targetActor, { data });\n\treturn targetActor && pileData?.enabled;\n}\n\nexport function isRegularItemPile(target, data = false) {\n\tconst targetActor = Utilities.getActor(target);\n\tconst pileData = getActorFlagData(targetActor, { data });\n\treturn targetActor && pileData?.enabled && pileData?.type === CONSTANTS.PILE_TYPES.PILE;\n}\n\nexport function isItemPileContainer(target, data = false) {\n\tconst targetActor = Utilities.getActor(target);\n\tconst pileData = getActorFlagData(targetActor, { data });\n\treturn pileData?.enabled && pileData?.type === CONSTANTS.PILE_TYPES.CONTAINER;\n}\n\nexport function isItemPileLootable(target, data = false) {\n\tconst targetActor = Utilities.getActor(target);\n\tconst pileData = getActorFlagData(targetActor, { data });\n\treturn targetActor && pileData?.enabled && (pileData?.type === CONSTANTS.PILE_TYPES.PILE || pileData?.type === CONSTANTS.PILE_TYPES.CONTAINER);\n}\n\nexport function isItemPileVault(target, data = false) {\n\tconst targetActor = Utilities.getActor(target);\n\tconst pileData = getActorFlagData(targetActor, { data });\n\treturn pileData?.enabled && pileData?.type === CONSTANTS.PILE_TYPES.VAULT;\n}\n\nexport function isItemPileMerchant(target, data = false) {\n\tconst targetActor = Utilities.getActor(target);\n\tconst pileData = getActorFlagData(targetActor, { data });\n\treturn pileData?.enabled && pileData?.type === CONSTANTS.PILE_TYPES.MERCHANT;\n}\n\nexport function isItemPileAuctioneer(target, data = false) {\n\tconst targetActor = Utilities.getActor(target);\n\tconst pileData = getActorFlagData(targetActor, { data });\n\treturn pileData?.enabled && pileData?.type === CONSTANTS.PILE_TYPES.AUCTIONEER;\n}\n\nexport function isItemPileBanker(target, data = false) {\n\tconst targetActor = Utilities.getActor(target);\n\tconst pileData = getActorFlagData(targetActor, { data });\n\treturn pileData?.enabled && pileData?.type === CONSTANTS.PILE_TYPES.BANKER;\n}\n\nexport function isItemPileClosed(target, data = false) {\n\tconst targetActor = Utilities.getActor(target);\n\tconst pileData = getActorFlagData(targetActor, { data });\n\tif (!pileData?.enabled || pileData?.type !== CONSTANTS.PILE_TYPES.CONTAINER) return false;\n\treturn pileData.closed;\n}\n\nexport function isItemPileLocked(target, data = false) {\n\tconst targetActor = Utilities.getActor(target);\n\tconst pileData = getActorFlagData(targetActor, { data });\n\tif (!pileData?.enabled || pileData?.type !== CONSTANTS.PILE_TYPES.CONTAINER) return false;\n\treturn pileData.locked;\n}\n\nexport function isItemPileEmpty(target) {\n\n\tconst targetActor = Utilities.getActor(target);\n\tif (!targetActor) return false;\n\n\tconst validItemPile = isValidItemPile(targetActor);\n\tif (!validItemPile) return false;\n\n\tconst hasNoItems = getActorItems(targetActor).length === 0;\n\tconst hasNoAttributes = getActorCurrencies(targetActor).length === 0;\n\n\treturn validItemPile && hasNoItems && hasNoAttributes;\n\n}\n\nexport function shouldItemPileBeDeleted(targetUuid) {\n\n\tconst target = Utilities.getToken(targetUuid);\n\n\tif (!(target instanceof Token)) return false;\n\n\tconst targetDocument = Utilities.getDocument(target);\n\n\tconst pileData = getActorFlagData(targetDocument);\n\n\tif (!isItemPileLootable(targetDocument, pileData) || !isItemPileEmpty(targetDocument)) {\n\t\treturn false;\n\t}\n\n\tif (typeof pileData?.deleteWhenEmpty === \"boolean\") {\n\t\treturn pileData?.deleteWhenEmpty;\n\t}\n\n\treturn {\n\t\t\"default\": Helpers.getSetting(\"deleteEmptyPiles\"), \"true\": true, \"false\": false\n\t}[pileData?.deleteWhenEmpty ?? \"default\"];\n\n}\n\nexport function getItemPileActors(filter = false) {\n\treturn Array.from(game.actors).filter((a) => {\n\t\treturn foundry.utils.getProperty(a, CONSTANTS.FLAGS.PILE)?.enabled && (filter\n\t\t\t? filter(a)\n\t\t\t: true);\n\t});\n}\n\nexport function getItemPileTokens(filter = false) {\n\n\tconst allTokensOnScenes = Array.from(game.scenes)\n\t\t.map(scene => ([scene.id, Array.from(scene.tokens).filter(t => {\n\t\t\treturn foundry.utils.getProperty(t, CONSTANTS.FLAGS.PILE)?.enabled && !t.actorLink;\n\t\t})]))\n\t\t.filter(([_, tokens]) => tokens.length)\n\n\tconst validTokensOnScenes = allTokensOnScenes.map(([scene, tokens]) => [scene, tokens.filter((token) => {\n\t\treturn filter\n\t\t\t? filter(token)\n\t\t\t: true;\n\t})]).filter(([_, tokens]) => tokens.length);\n\n\tconst mappedValidTokens = Object.fromEntries(validTokensOnScenes);\n\n\tconst invalidTokensOnScenes = allTokensOnScenes.map(([scene, tokens]) => [scene, tokens.filter(token => {\n\t\tif (mappedValidTokens[scene.id] && mappedValidTokens[scene.id].includes(token)) return false;\n\t\ttry {\n\t\t\tif (filter) filter(token);\n\t\t} catch (err) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t})]).filter(([_, tokens]) => tokens.length);\n\n\treturn { invalidTokensOnScenes, validTokensOnScenes };\n}\n\nexport function getActorItems(target, { itemFilters = false, getItemCurrencies = false } = {}) {\n\tconst actor = Utilities.getActor(target);\n\tconst actorItemFilters = itemFilters\n\t\t? cleanItemFilters(itemFilters)\n\t\t: getActorItemFilters(actor);\n\tconst currencies = (actor\n\t\t? getActorCurrencies(actor, { getAll: true })\n\t\t: game.itempiles.API.CURRENCIES.concat(game.itempiles.API.SECONDARY_CURRENCIES))\n\t\t.map(entry => entry.id);\n\treturn actor.items.filter(item => (getItemCurrencies || currencies.indexOf(item.id) === -1) && !isItemInvalid(actor, item, actorItemFilters));\n}\n\n// Lots happening here, but in essence, it gets the actor's currencies, and creates an array of them\nexport function getActorCurrencies(target, {\n\tforActor = false, currencyList = false, getAll = false, secondary = true\n} = {}) {\n\tconst actor = Utilities.getActor(target);\n\tconst actorUuid = Utilities.getUuid(actor.uuid)\n\tconst actorItems = actor\n\t\t? Array.from(actor.items)\n\t\t: [];\n\tconst cached = cachedActorCurrencies.get(actorUuid)\n\tcurrencyList = cached\n\t\t? false\n\t\t: currencyList || getCurrencyList(forActor || actor);\n\t// Loop through each currency and match it against the actor's data\n\tlet currencies = cached || (currencyList.map((currency, index) => {\n\t\tif (currency.type === \"attribute\" || !currency.type) {\n\t\t\tconst path = currency?.data?.path ?? currency?.path;\n\t\t\treturn {\n\t\t\t\t...currency, quantity: 0, path: path, id: path, index\n\t\t\t}\n\t\t}\n\t\tconst itemData = CompendiumUtilities.getItemFromCache(currency.data.uuid) || currency.data.item || false;\n\t\tif (!itemData) return false;\n\t\tconst item = Utilities.findSimilarItem(actorItems, itemData);\n\t\t// If the item exists on the actor, use the item's ID, so that we can match it against the actual item on the actor\n\t\tcurrency.data.item = itemData;\n\t\tcurrency.data.item._id = item?.id ?? itemData._id;\n\t\treturn {\n\t\t\t...currency, quantity: 0, id: item?.id ?? item?._id ?? itemData._id ?? null, item, index\n\t\t}\n\t})).filter(Boolean);\n\n\tcachedActorCurrencies.set(actorUuid, currencies);\n\n\tcurrencies = currencies.map(currency => {\n\t\tcurrency.quantity = currency.type === \"attribute\"\n\t\t\t? foundry.utils.getProperty(actor, currency.path)\n\t\t\t: Utilities.getItemQuantity(currency.item);\n\t\treturn currency;\n\t});\n\n\tif (!getAll) {\n\t\tcurrencies = currencies.filter(currency => currency.quantity > 0);\n\t}\n\n\tif (!secondary) {\n\t\tcurrencies = currencies.filter(currency => !currency.secondary);\n\t}\n\n\treturn currencies;\n}\n\nexport function getCurrenciesInItem(targetItem, {\n\tforActor = false, currencyList = false, getAll = false, secondary = true\n} = {}) {\n\n\tconst itemDocument = Utilities.getDocument(targetItem);\n\tconst itemUuid = Utilities.getUuid(itemDocument);\n\tconst handler = Utilities.getItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.CONTENTS, itemDocument.type);\n\tconst subItems = handler\n\t\t? handler({ item: itemDocument })\n\t\t: [];\n\tconst cached = cachedCurrenciesInItem.get(itemUuid)\n\tcurrencyList = cached\n\t\t? false\n\t\t: currencyList || getCurrencyList(forActor || itemDocument.parent);\n\n\tlet currencies = cached || (currencyList.map((currency, index) => {\n\t\tif (currency.type === \"attribute\" || !currency.type) {\n\t\t\tconst path = currency?.data?.path ?? currency?.path;\n\t\t\treturn {\n\t\t\t\t...currency, quantity: 0, path: path, id: path, index\n\t\t\t}\n\t\t}\n\t\tconst itemData = CompendiumUtilities.getItemFromCache(currency.data.uuid) || currency.data.item || false;\n\t\tif (!itemData) return false;\n\t\tconst item = Utilities.findSimilarItem(subItems, itemData);\n\t\t// If the item exists on the actor, use the item's ID, so that we can match it against the actual item on the actor\n\t\tcurrency.data.item = itemData;\n\t\tcurrency.data.item._id = item?.id ?? itemData._id;\n\t\treturn {\n\t\t\t...currency, quantity: 0, id: item?.id ?? item?._id ?? itemData._id ?? null, item, index\n\t\t}\n\t})).filter(Boolean);\n\n\tcachedCurrenciesInItem.set(itemUuid, currencies);\n\n\tcurrencies = currencies.map(currency => {\n\t\tcurrency.quantity = currency.type === \"attribute\"\n\t\t\t? foundry.utils.getProperty(itemDocument, currency.path)\n\t\t\t: Utilities.getItemQuantity(currency.item);\n\t\treturn currency;\n\t});\n\n\tif (!getAll) {\n\t\tcurrencies = currencies.filter(currency => currency.quantity > 0);\n\t}\n\n\tif (!secondary) {\n\t\tcurrencies = currencies.filter(currency => !currency.secondary);\n\t}\n\n\treturn currencies;\n\n}\n\nexport function getActorPrimaryCurrency(target) {\n\tconst actor = Utilities.getActor(target);\n\treturn getActorCurrencies(actor, { getAll: true }).find(currency => currency.primary);\n}\n\nexport function getCurrencyList(target = false, pileData = false) {\n\tlet targetUuid = false;\n\tif (target) {\n\t\ttargetUuid = Utilities.getUuid(target);\n\t\tif (cachedCurrencyList.has(targetUuid)) {\n\t\t\treturn cachedCurrencyList.get(targetUuid)\n\t\t}\n\t\tconst targetActor = Utilities.getActor(target);\n\t\tpileData = getActorFlagData(targetActor, { data: pileData });\n\t}\n\n\tconst primaryCurrencies = (pileData?.overrideCurrencies || game.itempiles.API.CURRENCIES);\n\tconst secondaryCurrencies = (pileData?.overrideSecondaryCurrencies || game.itempiles.API.SECONDARY_CURRENCIES).map(currency => {\n\t\tcurrency.secondary = true;\n\t\treturn currency;\n\t});\n\n\tconst currencies = primaryCurrencies.concat(secondaryCurrencies);\n\n\tconst currencyList = currencies.map(currency => {\n\t\tcurrency.name = game.i18n.localize(currency.name);\n\t\treturn currency;\n\t});\n\tif (target) {\n\t\tcachedCurrencyList.set(targetUuid, currencyList);\n\t}\n\treturn currencyList;\n}\n\nexport function getActorItemFilters(target, pileData = false) {\n\tif (!target) return cleanItemFilters(game.itempiles.API.ITEM_FILTERS);\n\tconst targetUuid = Utilities.getUuid(target);\n\tif (cachedFilterList.has(targetUuid)) {\n\t\treturn cachedFilterList.get(targetUuid)\n\t}\n\tconst targetActor = Utilities.getActor(target);\n\tpileData = getActorFlagData(targetActor, { data: pileData });\n\tconst itemFilters = isValidItemPile(targetActor, pileData) && pileData?.overrideItemFilters\n\t\t? cleanItemFilters(pileData.overrideItemFilters)\n\t\t: cleanItemFilters(game.itempiles.API.ITEM_FILTERS);\n\tcachedFilterList.set(targetUuid, itemFilters);\n\treturn itemFilters;\n}\n\nexport function getActorRequiredItemProperties(target, pileData = false) {\n\tif (!target) return [];\n\tconst targetUuid = Utilities.getUuid(target);\n\tif (cachedRequiredPropertiesList.has(targetUuid)) {\n\t\treturn cachedRequiredPropertiesList.get(targetUuid)\n\t}\n\tconst targetActor = Utilities.getActor(target);\n\tpileData = getActorFlagData(targetActor, { data: pileData });\n\tconst itemFilters = isValidItemPile(targetActor, pileData)\n\t\t? cleanItemFilters(pileData.requiredItemProperties)\n\t\t: [];\n\tcachedRequiredPropertiesList.set(targetUuid, itemFilters);\n\treturn itemFilters;\n}\n\nexport function cleanItemFilters(itemFilters) {\n\treturn itemFilters\n\t\t? foundry.utils.duplicate(itemFilters).map(filter => {\n\t\t\tfilter.path = filter.path.trim();\n\t\t\tfilter.filters = (Array.isArray(filter.filters)\n\t\t\t\t? filter.filters\n\t\t\t\t: filter.filters.split(','))\n\t\t\t\t.map(string => {\n\t\t\t\t\tif (typeof string === \"boolean\") return string;\n\t\t\t\t\tconst str = string.trim();\n\t\t\t\t\tif (str.toLowerCase() === \"true\" || str.toLowerCase() === \"false\") {\n\t\t\t\t\t\treturn str.toLowerCase() === \"true\";\n\t\t\t\t\t}\n\t\t\t\t\treturn str;\n\t\t\t\t});\n\t\t\treturn filter;\n\t\t})\n\t\t: [];\n}\n\nfunction doesPropertyMatch(propertyValue, filterValue) {\n\tif (Array.isArray(propertyValue)) {\n\t\treturn propertyValue.some(value => doesPropertyMatch(value, filterValue));\n\t}\n\tif (Utilities.isRealNumber(propertyValue) && Utilities.isRealNumber(Number(filterValue))) {\n\t\treturn Math.abs(propertyValue - Number(filterValue)) < Number.EPSILON;\n\t}\n\treturn propertyValue === filterValue;\n}\n\nexport function isItemInvalid(targetActor, item, itemFilters = false) {\n\tconst pileItemFilters = itemFilters\n\t\t? itemFilters\n\t\t: getActorItemFilters(targetActor)\n\tconst itemData = item instanceof Item\n\t\t? item.toObject()\n\t\t: item;\n\tfor (const filter of pileItemFilters) {\n\t\tif (!foundry.utils.hasProperty(itemData, filter.path)) continue;\n\t\tconst propertyValue = foundry.utils.getProperty(itemData, filter.path);\n\t\tconst filterValues = Array.isArray(filter.filters) ? filter.filters : Array.from(filter.filters);\n\t\tconst foundFilterValue = filterValues.find(filterValue => doesPropertyMatch(propertyValue, filterValue));\n\t\tif (foundFilterValue) return foundFilterValue;\n\t}\n\treturn false;\n}\n\nexport function isItemValidBasedOnProperties(targetActor, item) {\n\tconst pileItemRequiredProperties = getActorRequiredItemProperties(targetActor);\n\tconst itemData = item instanceof Item\n\t\t? item.toObject()\n\t\t: item;\n\tfor (const filter of pileItemRequiredProperties) {\n\t\tif (!foundry.utils.hasProperty(itemData, filter.path)) return false;\n\n\t\tconst propertyValue = foundry.utils.getProperty(itemData, filter.path);\n\t\tconst filterValues = Array.isArray(filter.filters) ? filter.filters : Array.from(filter.filters);\n\n\t\tconst matchFound = filterValues.some(filterValue => doesPropertyMatch(propertyValue, filterValue));\n\t\tif (!matchFound) return false;\n\t}\n\treturn true;\n\n}\n\nexport async function checkItemType(targetActor, item, {\n\terrorText = \"ITEM-PILES.Errors.DisallowedItemDrop\",\n\twarningTitle = \"ITEM-PILES.Dialogs.TypeWarning.Title\",\n\twarningContent = \"ITEM-PILES.Dialogs.TypeWarning.DropContent\",\n\trunTransformer = true\n} = {}) {\n\n\tconst disallowedType = isItemInvalid(targetActor, item);\n\tif (disallowedType) {\n\t\tif (!game.user.isGM) {\n\t\t\treturn Helpers.custom_warning(game.i18n.format(errorText, { type: disallowedType }), true)\n\t\t}\n\n\t\tif (SYSTEMS.DATA.ITEM_TRANSFORMER && runTransformer) {\n\t\t\titem = await SYSTEMS.DATA.ITEM_TRANSFORMER(item);\n\t\t}\n\n\t\tconst newDisallowedType = isItemInvalid(targetActor, item);\n\n\t\tif (newDisallowedType && !hotkeyActionState.forceDropItem) {\n\t\t\tconst force = await Dialog.confirm({\n\t\t\t\ttitle: game.i18n.localize(warningTitle),\n\t\t\t\tcontent: `<p class=\"item-piles-dialog\">${game.i18n.format(warningContent, { type: newDisallowedType })}</p>`,\n\t\t\t\tdefaultYes: false\n\t\t\t});\n\t\t\tif (!force) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (SYSTEMS.DATA.ITEM_TRANSFORMER && runTransformer) {\n\t\t\titem = await SYSTEMS.DATA.ITEM_TRANSFORMER(item);\n\t\t}\n\t}\n\n\treturn item;\n\n}\n\nexport function isItemCurrency(item, { target = false, actorCurrencies = false } = {}) {\n\tconst currencies = (actorCurrencies || getActorCurrencies(item.parent || false, {\n\t\tforActor: target, getAll: true\n\t}))\n\t\t.filter(currency => currency.type === \"item\")\n\t\t.map(item => item.data.item);\n\n\treturn !!Utilities.findSimilarItem(currencies, item);\n}\n\nexport function getItemCurrencyData(item, { target = false, actorCurrencies = false }) {\n\treturn (actorCurrencies || getActorCurrencies(item?.parent || false, {\n\t\tforActor: target, getAll: true, combine: true\n\t}))\n\t\t.filter(currency => currency.type === \"item\")\n\t\t.find(currency => {\n\t\t\treturn item.name === currency.data.item.name && item.type === currency.data.item.type;\n\t\t})\n}\n\nexport function getItemPileTokenImage(token, {\n\tdata = false, items = false, currencies = false\n} = {}, overrideImage = null) {\n\n\tconst pileDocument = Utilities.getDocument(token);\n\n\tconst itemPileData = getActorFlagData(pileDocument, { data });\n\n\tconst originalImg = overrideImage ?? (pileDocument instanceof TokenDocument\n\t\t? pileDocument.texture.src\n\t\t: pileDocument.prototypeToken.texture.src);\n\n\tif (!isValidItemPile(pileDocument, itemPileData) || !isItemPileLootable(pileDocument, itemPileData)) return originalImg;\n\n\titems = (items || getActorItems(pileDocument)).filter(itemData => {\n\t\tconst method = Utilities.getItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.IS_CONTAINED);\n\t\tif (!method) return true;\n\t\treturn !method({ item: itemData });\n\t});\n\tcurrencies = currencies || getActorCurrencies(pileDocument);\n\n\tconst numItems = items.length + currencies.length;\n\n\tlet img = originalImg;\n\n\tif (itemPileData.type === CONSTANTS.PILE_TYPES.CONTAINER) {\n\n\t\timg = itemPileData.lockedImage || itemPileData.closedImage || itemPileData.openedImage || itemPileData.emptyImage;\n\n\t\tif (itemPileData.locked && itemPileData.lockedImage) {\n\t\t\timg = itemPileData.lockedImage;\n\t\t} else if (itemPileData.closed && itemPileData.closedImage) {\n\t\t\timg = itemPileData.closedImage;\n\t\t} else if (itemPileData.emptyImage && isItemPileEmpty(pileDocument)) {\n\t\t\timg = itemPileData.emptyImage;\n\t\t} else if (itemPileData.openedImage) {\n\t\t\timg = itemPileData.openedImage;\n\t\t}\n\n\t} else if (itemPileData.displayOne && numItems === 1) {\n\n\t\timg = items.length > 0\n\t\t\t? items[0].img\n\t\t\t: currencies[0].img;\n\n\t} else if (itemPileData.displayOne && numItems > 1) {\n\n\t\timg = originalImg;\n\n\t}\n\n\treturn img || originalImg;\n\n}\n\nexport function getItemPileTokenScale(target, {\n\tdata = false, items = false, currencies = false\n} = {}, overrideScale = null) {\n\n\tconst pileDocument = Utilities.getDocument(target);\n\n\tlet itemPileData = getActorFlagData(pileDocument, { data });\n\n\tconst baseScale = overrideScale ?? (pileDocument instanceof TokenDocument\n\t\t? pileDocument.texture.scaleX\n\t\t: pileDocument.prototypeToken.texture.scaleX);\n\n\tif (!isValidItemPile(pileDocument, itemPileData) || !isItemPileLootable(pileDocument, itemPileData)) {\n\t\treturn baseScale;\n\t}\n\n\titems = (items || getActorItems(pileDocument)).filter(itemData => {\n\t\tconst method = Utilities.getItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.IS_CONTAINED);\n\t\tif (!method) return true;\n\t\treturn !method({ item: itemData });\n\t});\n\tcurrencies = currencies || getActorCurrencies(pileDocument);\n\n\tconst numItems = items.length + currencies.length;\n\n\tif (itemPileData?.type === CONSTANTS.PILE_TYPES.CONTAINER || !itemPileData.displayOne || !itemPileData.overrideSingleItemScale || numItems > 1 || numItems === 0) {\n\t\treturn baseScale;\n\t}\n\n\treturn itemPileData.singleItemScale;\n\n}\n\nexport function getItemPileName(target, { data = false, items = false, currencies = false } = {}, overrideName = null) {\n\n\tconst pileDocument = Utilities.getDocument(target);\n\n\tconst itemPileData = getActorFlagData(pileDocument, { data });\n\n\tlet name = overrideName ?? (pileDocument instanceof TokenDocument\n\t\t? pileDocument.name\n\t\t: pileDocument.prototypeToken.name);\n\n\tif (!isValidItemPile(pileDocument, itemPileData) || !isItemPileLootable(pileDocument, itemPileData)) {\n\t\treturn name;\n\t}\n\n\titems = (items || getActorItems(pileDocument)).filter(itemData => {\n\t\tconst method = Utilities.getItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.IS_CONTAINED);\n\t\tif (!method) return true;\n\t\treturn !method({ item: itemData });\n\t});\n\tcurrencies = currencies || getActorCurrencies(pileDocument);\n\n\tconst numItems = items.length + currencies.length;\n\n\tif (itemPileData?.type === CONSTANTS.PILE_TYPES.CONTAINER || !itemPileData.displayOne || !itemPileData.showItemName || numItems > 1 || numItems === 0) {\n\t\treturn name;\n\t}\n\n\tconst item = items.length > 0\n\t\t? items[0]\n\t\t: currencies[0];\n\tconst quantity = (items.length > 0\n\t\t? Utilities.getItemQuantity(item)\n\t\t: currencies[0]?.quantity) ?? 1\n\n\treturn item.name + (quantity > 1\n\t\t? \" x \" + quantity\n\t\t: \"\");\n\n}\n\nexport function shouldEvaluateChange(target, changes) {\n\tconst baseFlags = foundry.utils.getProperty(changes, CONSTANTS.FLAGS.PILE) ?? false;\n\tconst flags = getActorFlagData(target, baseFlags\n\t\t? foundry.utils.deepClone(baseFlags)\n\t\t: baseFlags);\n\tif (!isValidItemPile(target, flags)) return false;\n\treturn (flags.type === CONSTANTS.PILE_TYPES.CONTAINER\n\t\t\t&& (flags.closedImage || flags.emptyImage || flags.openedImage || flags.lockedImage))\n\t\t|| flags.displayOne || flags.showItemName || flags.overrideSingleItemScale;\n}\n\nexport async function updateItemPileData(target, newFlags, tokenData) {\n\n\tif (!target) return;\n\n\tconst flagData = getActorFlagData(target, { data: foundry.utils.deepClone(newFlags) });\n\tif (!tokenData) tokenData = {};\n\ttokenData = foundry.utils.mergeObject(tokenData, {});\n\n\tlet documentActor = Utilities.getActor(target);\n\tconst documentTokens = documentActor.getActiveTokens();\n\n\tconst items = getActorItems(documentActor, { itemFilters: flagData.overrideItemFilters });\n\tconst actorCurrencies = (flagData.overrideCurrencies || []).concat(flagData.overrideSecondaryCurrencies || []);\n\tconst currencies = getActorCurrencies(documentActor, { currencyList: actorCurrencies });\n\n\tconst pileData = { data: flagData, items, currencies };\n\n\tconst currentFlagData = getActorFlagData(target, { useDefaults: false });\n\n\tconst cleanedFlagData = cleanFlagData(flagData, {\n\t\taddRemoveFlag: true,\n\t\texistingData: currentFlagData\n\t});\n\n\tconst sceneUpdates = documentTokens.reduce((acc, token) => {\n\t\tconst tokenDocument = token.document;\n\t\tconst overrideImage = foundry.utils.getProperty(tokenData, \"texture.src\")\n\t\t\t?? foundry.utils.getProperty(tokenData, \"img\");\n\t\tconst overrideScale = foundry.utils.getProperty(tokenData, \"texture.scaleX\")\n\t\t\t?? foundry.utils.getProperty(tokenData, \"texture.scaleY\")\n\t\t\t?? foundry.utils.getProperty(tokenData, \"scale\");\n\t\tconst scale = getItemPileTokenScale(tokenDocument, pileData, overrideScale);\n\t\tconst newTokenData = foundry.utils.mergeObject(tokenData, {\n\t\t\t\"texture.src\": getItemPileTokenImage(tokenDocument, pileData, overrideImage),\n\t\t\t\"texture.scaleX\": scale,\n\t\t\t\"texture.scaleY\": scale,\n\t\t\t\"name\": getItemPileName(tokenDocument, pileData, tokenData?.name),\n\t\t});\n\t\tconst data = {\n\t\t\t\"_id\": tokenDocument.id,\n\t\t\t[CONSTANTS.FLAGS.PILE]: cleanedFlagData,\n\t\t\t[CONSTANTS.FLAGS.VERSION]: Helpers.getModuleVersion(),\n\t\t\t...newTokenData\n\t\t};\n\t\tif (!tokenDocument.actorLink) {\n\t\t\tdata[CONSTANTS.ACTOR_DELTA_PROPERTY] = {\n\t\t\t\t[CONSTANTS.FLAGS.PILE]: cleanedFlagData,\n\t\t\t\t[CONSTANTS.FLAGS.VERSION]: Helpers.getModuleVersion(),\n\t\t\t}\n\t\t}\n\t\tacc[tokenDocument.parent.id] ??= [];\n\t\tacc[tokenDocument.parent.id].push(foundry.utils.mergeObject({}, data));\n\t\treturn acc;\n\t}, {});\n\n\tif (!foundry.utils.isEmpty(sceneUpdates)) {\n\t\tfor (const [sceneId, updates] of Object.entries(sceneUpdates)) {\n\t\t\tconst scene = game.scenes.get(sceneId);\n\t\t\tif (!scene) continue\n\t\t\tawait scene.updateEmbeddedDocuments(\"Token\", updates, { animate: false });\n\t\t}\n\t}\n\n\tif (documentActor) {\n\t\tawait documentActor.update({\n\t\t\t[CONSTANTS.FLAGS.PILE]: cleanedFlagData,\n\t\t\t[CONSTANTS.FLAGS.VERSION]: Helpers.getModuleVersion(),\n\t\t\tprototypeToken: {\n\t\t\t\t[CONSTANTS.FLAGS.PILE]: cleanedFlagData,\n\t\t\t\t[CONSTANTS.FLAGS.VERSION]: Helpers.getModuleVersion(),\n\t\t\t}\n\t\t});\n\t}\n\n\treturn true;\n}\n\nexport function cleanFlagData(flagData, { addRemoveFlag = false, existingData = false } = {}) {\n\tconst defaults = getPileDefaults();\n\tconst defaultKeys = Object.keys(defaults);\n\tconst newKeys = new Set(Object.keys(flagData));\n\tconst difference = new Set(Object.keys(foundry.utils.diffObject(flagData, defaults)));\n\tconst toRemove = new Set(defaultKeys.filter(key => !difference.has(key) && newKeys.has(key)));\n\tconst existingDataKeys = existingData ? new Set(Object.keys(existingData)) : false;\n\tif (flagData.enabled) {\n\t\ttoRemove.delete(\"type\")\n\t}\n\tif (!CONSTANTS.CUSTOM_PILE_TYPES[flagData.type]) {\n\t\tconst baseKeys = new Set(defaultKeys);\n\t\tfor (const key of Object.keys(flagData)) {\n\t\t\tif (!baseKeys.has(key)) {\n\t\t\t\tdelete flagData[key];\n\t\t\t\tif (addRemoveFlag && (!existingDataKeys || existingDataKeys.has(key))) {\n\t\t\t\t\tflagData[\"-=\" + key] = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor (const key of toRemove) {\n\t\tdelete flagData[key];\n\t\tif (addRemoveFlag && (!existingDataKeys || existingDataKeys.has(key))) {\n\t\t\tflagData[\"-=\" + key] = null;\n\t\t}\n\t}\n\treturn flagData;\n}\n\nexport function cleanItemFlagData(flagData, { addRemoveFlag = false, existingData = false } = {}) {\n\tconst defaults = Object.keys(CONSTANTS.ITEM_DEFAULTS);\n\tconst difference = new Set(Object.keys(foundry.utils.diffObject(flagData, CONSTANTS.ITEM_DEFAULTS)));\n\tconst toRemove = new Set(defaults.filter(key => !difference.has(key)));\n\tconst existingDataKeys = existingData ? new Set(Object.keys(existingData)) : false;\n\tfor (const key of toRemove) {\n\t\tdelete flagData[key];\n\t\tif (addRemoveFlag && (!existingDataKeys || existingDataKeys.has(key))) {\n\t\t\tflagData[\"-=\" + key] = null;\n\t\t}\n\t}\n\treturn flagData;\n}\n\nexport function updateItemData(item, update, { returnUpdate = false, version = false } = {}) {\n\tconst existingData = getItemFlagData(item, { useDefaults: false });\n\tconst flagData = cleanItemFlagData(update.flags ?? {}, { addRemoveFlag: true, existingData });\n\tconst updates = foundry.utils.mergeObject(update?.data ?? {}, {});\n\tfoundry.utils.setProperty(updates, CONSTANTS.FLAGS.ITEM, flagData)\n\tfoundry.utils.setProperty(updates, CONSTANTS.FLAGS.VERSION, version || Helpers.getModuleVersion())\n\tif (returnUpdate) {\n\t\tupdates[\"_id\"] = item?.id ?? item?._id;\n\t\treturn updates;\n\t}\n\treturn item.update(updates);\n}\n\n/* -------------------------- Merchant Methods ------------------------- */\n\nexport function getMerchantModifiersForActor(merchant, {\n\titem = false, actor = false, pileFlagData = false, itemFlagData = false, absolute = false\n} = {}) {\n\n\tlet {\n\t\tbuyPriceModifier, sellPriceModifier, itemTypePriceModifiers, actorPriceModifiers\n\t} = getActorFlagData(merchant, { data: pileFlagData });\n\n\tif (item) {\n\t\tif (!itemFlagData) {\n\t\t\titemFlagData = getItemFlagData(item);\n\t\t}\n\n\t\tbuyPriceModifier *= itemFlagData.buyPriceModifier ?? 1.0;\n\t\tsellPriceModifier *= itemFlagData.sellPriceModifier ?? 1.0;\n\n\t\tconst itemTypePriceModifier = itemTypePriceModifiers\n\t\t\t.sort((a, b) => a.type === \"custom\" && b.type !== \"custom\"\n\t\t\t\t? -1\n\t\t\t\t: 0)\n\t\t\t.find(priceData => {\n\t\t\t\treturn priceData.type === \"custom\"\n\t\t\t\t\t? priceData.category.toLowerCase() === itemFlagData.customCategory.toLowerCase()\n\t\t\t\t\t: priceData.type === item.type;\n\t\t\t});\n\t\tif (itemTypePriceModifier) {\n\t\t\tbuyPriceModifier = itemTypePriceModifier.override\n\t\t\t\t? itemTypePriceModifier.buyPriceModifier ?? buyPriceModifier\n\t\t\t\t: buyPriceModifier * itemTypePriceModifier.buyPriceModifier;\n\t\t\tsellPriceModifier = itemTypePriceModifier.override\n\t\t\t\t? itemTypePriceModifier.sellPriceModifier ?? sellPriceModifier\n\t\t\t\t: sellPriceModifier * itemTypePriceModifier.sellPriceModifier;\n\t\t}\n\t}\n\n\tif (actor && actorPriceModifiers) {\n\t\tconst actorSpecificModifiers = actorPriceModifiers?.find(data => data.actorUuid === Utilities.getUuid(actor) || data.actor === actor.id);\n\t\tif (actorSpecificModifiers) {\n\t\t\tbuyPriceModifier = actorSpecificModifiers.override || absolute\n\t\t\t\t? actorSpecificModifiers.buyPriceModifier ?? buyPriceModifier\n\t\t\t\t: buyPriceModifier * actorSpecificModifiers.buyPriceModifier;\n\t\t\tsellPriceModifier = actorSpecificModifiers.override || absolute\n\t\t\t\t? actorSpecificModifiers.sellPriceModifier ?? sellPriceModifier\n\t\t\t\t: sellPriceModifier * actorSpecificModifiers.sellPriceModifier;\n\t\t}\n\t}\n\n\tif (SYSTEMS.DATA.PRICE_MODIFIER_TRANSFORMER && !absolute) {\n\t\tconst modifiers = SYSTEMS.DATA.PRICE_MODIFIER_TRANSFORMER({\n\t\t\tbuyPriceModifier, sellPriceModifier, merchant, item, actor, actorPriceModifiers\n\t\t});\n\t\tbuyPriceModifier = modifiers.buyPriceModifier;\n\t\tsellPriceModifier = modifiers.sellPriceModifier;\n\t}\n\n\treturn {\n\t\tbuyPriceModifier: Helpers.roundToDecimals(buyPriceModifier, 2),\n\t\tsellPriceModifier: Helpers.roundToDecimals(sellPriceModifier, 2)\n\t}\n}\n\nfunction getSmallestExchangeRate(currencies) {\n\treturn currencies.length > 1\n\t\t? Math.min(...currencies.filter(currency => !currency.secondary).map(currency => currency.exchangeRate))\n\t\t: (Helpers.getSetting(SETTINGS.CURRENCY_DECIMAL_DIGITS) ?? 0.00001);\n}\n\nfunction getExchangeRateDecimals(smallestExchangeRate) {\n\treturn smallestExchangeRate.toString().includes(\".\")\n\t\t? smallestExchangeRate.toString().split(\".\")[1].length\n\t\t: 0;\n}\n\nexport function getPriceArray(totalCost, currencies) {\n\n\tif (!currencies) currencies = getCurrencyList()\n\n\tconst primaryCurrency = currencies.find(currency => currency.primary);\n\n\tif (currencies.length === 1) {\n\t\treturn [{\n\t\t\t...primaryCurrency,\n\t\t\tcost: totalCost,\n\t\t\tbaseCost: totalCost,\n\t\t\tmaxCurrencyCost: totalCost,\n\t\t\tstring: primaryCurrency.abbreviation.replace('{#}', totalCost)\n\t\t}]\n\t}\n\n\tconst smallestExchangeRate = getSmallestExchangeRate(currencies);\n\n\tconst prices = [];\n\n\tif (primaryCurrency.exchangeRate === smallestExchangeRate) {\n\n\t\tlet cost = totalCost;\n\n\t\tfor (const currency of currencies) {\n\n\t\t\tif (currency.secondary) continue;\n\n\t\t\tconst numCurrency = Math.floor(cost / currency.exchangeRate);\n\n\t\t\tcost = cost - (numCurrency * currency.exchangeRate);\n\n\t\t\tprices.push({\n\t\t\t\t...currency,\n\t\t\t\tcost: Math.round(numCurrency),\n\t\t\t\tbaseCost: Math.round(numCurrency),\n\t\t\t\tmaxCurrencyCost: Math.ceil(totalCost / currency.exchangeRate),\n\t\t\t\tstring: currency.abbreviation.replace(\"{#}\", numCurrency)\n\t\t\t});\n\n\t\t}\n\n\t\treturn prices;\n\n\t}\n\n\tconst decimals = getExchangeRateDecimals(smallestExchangeRate);\n\n\tlet fraction = Helpers.roundToDecimals(totalCost % 1, decimals);\n\tlet cost = Math.round(totalCost - fraction);\n\n\tlet skipPrimary = false;\n\tif (cost) {\n\t\tskipPrimary = true;\n\t\tprices.push({\n\t\t\t...primaryCurrency,\n\t\t\tcost: cost,\n\t\t\tbaseCost: cost,\n\t\t\tmaxCurrencyCost: totalCost,\n\t\t\tstring: primaryCurrency.abbreviation.replace('{#}', cost)\n\t\t});\n\t}\n\n\tfor (const currency of currencies) {\n\n\t\tif ((currency === primaryCurrency && skipPrimary) || currency.secondary) continue;\n\n\t\tconst numCurrency = Math.floor(Helpers.roundToDecimals(fraction / currency.exchangeRate, decimals));\n\n\t\tfraction = Helpers.roundToDecimals(fraction - (numCurrency * currency.exchangeRate), decimals);\n\n\t\tprices.push({\n\t\t\t...currency,\n\t\t\tcost: Math.round(numCurrency),\n\t\t\tbaseCost: Math.round(numCurrency),\n\t\t\tmaxCurrencyCost: Math.ceil(totalCost / currency.exchangeRate),\n\t\t\tstring: currency.abbreviation.replace(\"{#}\", numCurrency)\n\t\t});\n\t}\n\n\tprices.sort((a, b) => b.exchangeRate - a.exchangeRate);\n\n\treturn prices.map(price => {\n\t\tif (price?.quantity === undefined) {\n\t\t\tprice.quantity = price.cost;\n\t\t}\n\t\treturn price;\n\t});\n}\n\nexport function getCurrenciesAbbreviations() {\n\t// Retrieve all the primary abbreviations for the check\n\tlet primaryAbbreviationsArray = game.itempiles.API.CURRENCIES\n\t\t.filter(currency => currency.abbreviation)\n\t\t.map(currency => {\n\t\t\tif (currency.abbreviation?.includes(\"{#}\")) {\n\t\t\t\treturn currency.abbreviation?.replace(\"{#}\", \"\");\n\t\t\t} else {\n\t\t\t\treturn currency.abbreviation || \"\";\n\t\t\t}\n\t\t});\n\tlet secondaryAbbreviationsArray = game.itempiles.API.SECONDARY_CURRENCIES\n\t\t.filter(currency => currency.abbreviation)\n\t\t.map(currency => {\n\t\t\tif (currency.abbreviation?.includes(\"{#}\")) {\n\t\t\t\treturn currency.abbreviation?.replace(\"{#}\", \"\");\n\t\t\t} else {\n\t\t\t\treturn currency.abbreviation || \"\";\n\t\t\t}\n\t\t});\n\treturn primaryAbbreviationsArray.concat(secondaryAbbreviationsArray);\n}\n\nexport function getStringFromCurrencies(currencies) {\n\tlet allAbbreviationsArray = getCurrenciesAbbreviations();\n\n\tlet priceString = currencies\n\t\t.filter(price => price.cost)\n\t\t.map(price => {\n\t\t\tlet cost = price.cost;\n\t\t\tlet abbreviation = price.abbreviation;\n\t\t\tif (!Helpers.isRealNumber(cost) || !abbreviation) {\n\t\t\t\tHelpers.custom_error(`getStringFromCurrencies | The currency element is not valid with cost '${cost}' and abbreviation '${abbreviation}'`, true);\n\t\t\t\treturn \"\";\n\t\t\t}\n\t\t\t// Check abbreviation by case unsensitive...\n\t\t\tconst indexAbbreviation = allAbbreviationsArray.findIndex(a => {\n\t\t\t\treturn a?.replace(\"{#}\", \"\")?.toLowerCase() === abbreviation?.replace(\"{#}\", \"\")?.toLowerCase();\n\t\t\t});\n\t\t\tif (indexAbbreviation === -1) {\n\t\t\t\tHelpers.custom_error(`getStringFromCurrencies | The currency abbreviation '${abbreviation?.replace(\"{#}\", \"\")}' is not registered`, true);\n\t\t\t\treturn \"\";\n\t\t\t}\n\t\t\tif (price.percent && abbreviation.includes(\"%\")) {\n\t\t\t\tabbreviation = abbreviation.replaceAll(\"%\", \"\")\n\t\t\t}\n\t\t\tif (abbreviation.includes(\"{#}\")) {\n\t\t\t\treturn abbreviation.replace(\"{#}\", price.cost)\n\t\t\t} else {\n\t\t\t\treturn price.cost + abbreviation;\n\t\t\t}\n\t\t}).join(\" \");\n\n\treturn priceString\n\t\t? priceString.trim()\n\t\t: \"\";\n}\n\nexport function getPriceFromString(str, currencyList = false) {\n\n\tif (!currencyList) {\n\t\tcurrencyList = getCurrencyList()\n\t}\n\n\tlet currencies = foundry.utils.duplicate(currencyList)\n\t\t.map(currency => {\n\t\t\tcurrency.quantity = 0\n\t\t\tcurrency.identifier = currency.abbreviation.toLowerCase().replace(\"{#}\", \"\").trim()\n\t\t\treturn currency;\n\t\t});\n\n\tconst sortedCurrencies = currencies.map(currency => `(${currency.identifier})`);\n\tsortedCurrencies.sort((a, b) => b.length - a.length);\n\tconst splitBy = new RegExp(\"(.*?) *(\" + sortedCurrencies.join(\"|\") + \")\", \"g\");\n\n\tconst parts = [...str.split(\",\").join(\"\").split(\" \").join(\"\").trim().toLowerCase().matchAll(splitBy)];\n\tconst identifierFilter = [];\n\tlet overallCost = 0;\n\tfor (const part of parts) {\n\t\tfor (const currency of currencies) {\n\n\t\t\tif (part[2]) {\n\t\t\t\tidentifierFilter.push(part[2]?.toLowerCase());\n\t\t\t}\n\n\t\t\tif (part[2] !== currency.identifier) continue;\n\n\t\t\ttry {\n\t\t\t\tconst roll = new Roll(part[1]).evaluateSync()\n\t\t\t\tcurrency.quantity = roll.total;\n\t\t\t\tif (roll.total !== Number(part[1])) {\n\t\t\t\t\tcurrency.roll = roll;\n\t\t\t\t}\n\t\t\t\tif (currency.exchangeRate) {\n\t\t\t\t\toverallCost += roll.total * currency.exchangeRate;\n\t\t\t\t}\n\t\t\t} catch (err) {\n\n\t\t\t}\n\t\t}\n\t}\n\n\t// Maybe there is a better method for this ?\n\tcurrencies = currencies.filter(currency => identifierFilter.includes(currency.identifier?.toLowerCase()));\n\n\tif (!currencies.some(currency => Helpers.isRealNumber(currency.quantity) && currency.quantity >= 0)) {\n\t\ttry {\n\t\t\tconst roll = new Roll(str).evaluateSync();\n\t\t\tif (roll.total) {\n\t\t\t\tconst primaryCurrency = currencies.find(currency => currency.primary);\n\t\t\t\tprimaryCurrency.quantity = roll.total;\n\t\t\t\tif (roll.total !== Number(str)) {\n\t\t\t\t\tprimaryCurrency.roll = roll;\n\t\t\t\t}\n\t\t\t\toverallCost = roll.total;\n\t\t\t}\n\t\t} catch (err) {\n\n\t\t}\n\t}\n\n\treturn { currencies, overallCost };\n}\n\nexport function getCostOfItem(item, defaultCurrencies = false) {\n\n\tif (!defaultCurrencies) {\n\t\tdefaultCurrencies = getCurrencyList().filter(currency => !currency.secondary);\n\t}\n\n\tlet overallCost = 0;\n\tlet itemCost = Utilities.getItemCost(item);\n\tif (SYSTEMS.DATA.ITEM_COST_TRANSFORMER) {\n\t\toverallCost = SYSTEMS.DATA.ITEM_COST_TRANSFORMER(item, defaultCurrencies);\n\t\tif (overallCost === false) {\n\t\t\tHelpers.debug(\"failed to find price for item:\", item)\n\t\t}\n\t} else if (typeof itemCost === \"string\" && isNaN(Number(itemCost))) {\n\t\toverallCost = getPriceFromString(itemCost, defaultCurrencies).overallCost;\n\t} else {\n\t\toverallCost = Number(itemCost);\n\t}\n\n\treturn Math.max(0, overallCost);\n}\n\nfunction getItemFlagPriceData(priceData, quantity, modifier, defaultCurrencies, currencyList) {\n\n\treturn priceData.map(priceGroup => {\n\t\tif (!Array.isArray(priceGroup)) priceGroup = [priceGroup];\n\t\tconst itemPrices = priceGroup.map(price => {\n\t\t\tconst itemModifier = price.fixed\n\t\t\t\t? 1\n\t\t\t\t: modifier;\n\t\t\tconst cost = Math.round(price.quantity * itemModifier * quantity);\n\t\t\tlet baseCost = Math.round(price.quantity * itemModifier);\n\t\t\tprice.name = game.i18n.localize(price.name);\n\t\t\tif (!price.data?.item) {\n\t\t\t\tprice.data.item = CompendiumUtilities.getItemFromCache(price.data.uuid);\n\t\t\t}\n\n\t\t\tconst isRegularCurrency = !price.secondary ? currencyList.find(currency => {\n\t\t\t\treturn currency.name === price.name && currency.img === price.img && (currency.data.uuid === price.data.uuid || currency.data.path === price.data.path)\n\t\t\t}) : false;\n\n\t\t\tconst totalCost = isRegularCurrency ? price.quantity * isRegularCurrency.exchangeRate : 0;\n\n\t\t\treturn {\n\t\t\t\t...price,\n\t\t\t\tcost,\n\t\t\t\tbaseCost: baseCost * (isRegularCurrency ? isRegularCurrency.exchangeRate : 1.0),\n\t\t\t\ttotalCost,\n\t\t\t\tmodifier: itemModifier,\n\t\t\t\tpriceString: cost\n\t\t\t\t\t? price.abbreviation.replace(\"{#}\", cost)\n\t\t\t\t\t: \"\",\n\t\t\t\tbasePriceString: baseCost\n\t\t\t\t\t? price.abbreviation.replace(\"{#}\", baseCost)\n\t\t\t\t\t: \"\",\n\t\t\t\tsecondary: !isRegularCurrency\n\t\t\t};\n\t\t});\n\n\t\tconst primaryPrices = itemPrices.filter(price => !price.secondary);\n\t\tconst secondaryPrices = itemPrices.filter(price => price.secondary);\n\t\tconst totalCost = primaryPrices.reduce((acc, price) => price.totalCost + acc, 0) * quantity;\n\t\tconst baseCost = primaryPrices.reduce((acc, price) => price.baseCost + acc, 0) * quantity;\n\t\tconst primaryCurrencyPrices = getPriceArray(totalCost, defaultCurrencies);\n\n\t\tconst prices = primaryCurrencyPrices.filter(price => price.cost).concat(secondaryPrices);\n\n\t\treturn {\n\t\t\tprices,\n\t\t\tbaseCost,\n\t\t\ttotalCost,\n\t\t\tpriceString: prices.filter(price => price.string || price.priceString).map(price => price.string || price.priceString).join(\" \"),\n\t\t\tbasePriceString: prices.filter(price => price.string || price.basePriceString).map(price => price.string || price.basePriceString).join(\" \"),\n\t\t\tmaxQuantity: 0,\n\t\t\tquantity: quantity,\n\t\t}\n\t});\n\n}\n\nexport function getPriceData({\n\tcost = false,\n\titem = false,\n\tseller = false,\n\tbuyer = false,\n\tsellerFlagData = false,\n\tbuyerFlagData = false,\n\titemFlagData = false,\n\tquantity = 1,\n\tsecondaryPrices = false\n} = {}) {\n\n\tlet priceData = [];\n\n\tbuyerFlagData = getActorFlagData(buyer, { data: buyerFlagData });\n\tif (!isItemPileMerchant(buyer, buyerFlagData)) {\n\t\tbuyerFlagData = false;\n\t}\n\n\tsellerFlagData = getActorFlagData(seller, { data: sellerFlagData });\n\tif (!isItemPileMerchant(seller, sellerFlagData)) {\n\t\tsellerFlagData = false;\n\t}\n\n\tif (cost && !item) {\n\t\titem = {};\n\t\tfoundry.utils.setProperty(item, game.itempiles.API.ITEM_PRICE_ATTRIBUTE, cost);\n\t\tfoundry.utils.setProperty(item, CONSTANTS.FLAGS.ITEM, CONSTANTS.ITEM_DEFAULTS);\n\t}\n\n\titemFlagData = itemFlagData || getItemFlagData(item);\n\n\tlet merchant = sellerFlagData\n\t\t? seller\n\t\t: buyer;\n\n\tif (merchant === buyer && itemFlagData.cantBeSoldToMerchants) {\n\t\tpriceData.push({\n\t\t\tfree: false,\n\t\t\tbasePrices: [],\n\t\t\tbasePriceString: \"\",\n\t\t\tprices: [],\n\t\t\tpriceString: \"\",\n\t\t\ttotalCost: 0,\n\t\t\tbaseCost: 0,\n\t\t\tprimary: true,\n\t\t\tmaxQuantity: 0,\n\t\t\tquantity\n\t\t});\n\t\treturn priceData;\n\t}\n\n\t// Retrieve the item price modifiers\n\tlet modifier = 1;\n\tif (sellerFlagData) {\n\n\t\tmodifier = getMerchantModifiersForActor(seller, {\n\t\t\titem, actor: buyer, pileFlagData: sellerFlagData, itemFlagData\n\t\t}).buyPriceModifier;\n\n\t} else if (buyerFlagData) {\n\n\t\tmodifier = getMerchantModifiersForActor(buyer, {\n\t\t\titem, actor: seller, pileFlagData: buyerFlagData, itemFlagData\n\t\t}).sellPriceModifier;\n\n\t}\n\n\tconst disableNormalCost = itemFlagData.disableNormalCost && (merchant === seller || (itemFlagData.purchaseOptionsAsSellOption && !buyerFlagData.onlyAcceptBasePrice));\n\tconst hasOtherPrices = secondaryPrices?.length > 0 || itemFlagData.prices.filter(priceGroup => priceGroup.length).length > 0 || itemFlagData.sellPrices.filter(priceGroup => priceGroup.length).length > 0;\n\n\tconst currencyList = getCurrencyList(merchant);\n\tconst currencies = getActorCurrencies(merchant, { currencyList, getAll: true });\n\tconst defaultCurrencies = currencies.filter(currency => !currency.secondary);\n\n\t// In order to easily calculate an item's total worth, we can use the smallest exchange rate and convert all prices\n\t// to it, in order have a stable form of exchange calculation\n\tconst smallestExchangeRate = getSmallestExchangeRate(defaultCurrencies);\n\tconst decimals = getExchangeRateDecimals(smallestExchangeRate);\n\n\tlet overallCost = getCostOfItem(item, defaultCurrencies);\n\n\tif (itemFlagData?.free || (!disableNormalCost && (overallCost === 0 || overallCost < smallestExchangeRate) && !hasOtherPrices) || modifier <= 0) {\n\t\tpriceData.push({\n\t\t\tfree: true,\n\t\t\tbasePrices: [],\n\t\t\tbasePriceString: \"\",\n\t\t\tprices: [],\n\t\t\tpriceString: \"\",\n\t\t\ttotalCost: 0,\n\t\t\tbaseCost: 0,\n\t\t\tprimary: true,\n\t\t\tmaxQuantity: Infinity,\n\t\t\tquantity: quantity\n\t\t})\n\t\treturn priceData;\n\t}\n\n\t// If the item does include its normal cost, we calculate that here\n\tif (overallCost >= smallestExchangeRate && !disableNormalCost) {\n\n\t\t// Base prices is the displayed price, without quantity taken into account\n\t\tconst baseCost = Helpers.roundToDecimals(overallCost * modifier, decimals);\n\t\tconst basePrices = getPriceArray(baseCost, defaultCurrencies);\n\n\t\t// Prices is the cost with the amount of quantity taken into account, which may change the number of the different\n\t\t// types of currencies it costs (eg, an item wouldn't cost 1 gold and 100 silver, it would cost 11 gold\n\t\tlet totalCost = baseCost * quantity;\n\n\t\tlet prices = getPriceArray(totalCost, defaultCurrencies);\n\n\t\tif (baseCost) {\n\n\t\t\tpriceData.push({\n\t\t\t\tbasePrices,\n\t\t\t\tbasePriceString: basePrices.filter(price => price.cost).map(price => price.string).join(\" \"),\n\t\t\t\tprices,\n\t\t\t\tpriceString: prices.filter(price => price.cost).map(price => price.string).join(\" \"),\n\t\t\t\ttotalCost,\n\t\t\t\tbaseCost,\n\t\t\t\tprimary: true,\n\t\t\t\tmaxQuantity: 0,\n\t\t\t\tquantity: quantity\n\t\t\t});\n\n\t\t}\n\t}\n\n\t// If the item has custom prices, we include them here\n\tif (secondaryPrices?.length) {\n\n\t\tif (!priceData.length) {\n\t\t\tpriceData.push({\n\t\t\t\tbasePrices: [],\n\t\t\t\tbasePriceString: \"\",\n\t\t\t\tprices: [],\n\t\t\t\tpriceString: \"\",\n\t\t\t\ttotalCost: 0,\n\t\t\t\tbaseCost: 0,\n\t\t\t\tprimary: true,\n\t\t\t\tmaxQuantity: 0,\n\t\t\t\tquantity: quantity\n\t\t\t});\n\t\t}\n\n\t\tfor (const secondaryPrice of secondaryPrices) {\n\n\t\t\tconst itemModifier = modifier;\n\t\t\tconst cost = Math.round(secondaryPrice.quantity * itemModifier * quantity);\n\t\t\tconst baseCost = Math.round(secondaryPrice.quantity * itemModifier);\n\t\t\tsecondaryPrice.name = game.i18n.localize(secondaryPrice.name);\n\t\t\tif (!secondaryPrice.data?.item && secondaryPrice.data.uuid) {\n\t\t\t\tsecondaryPrice.data.item = CompendiumUtilities.getItemFromCache(secondaryPrice.data.uuid);\n\t\t\t}\n\t\t\tpriceData[0].basePrices.push({\n\t\t\t\t...secondaryPrice,\n\t\t\t\tcost,\n\t\t\t\tbaseCost,\n\t\t\t\tmodifier: itemModifier,\n\t\t\t\tstring: secondaryPrice.abbreviation.replace(\"{#}\", baseCost),\n\t\t\t\tpriceString: cost\n\t\t\t\t\t? secondaryPrice.abbreviation.replace(\"{#}\", cost)\n\t\t\t\t\t: \"\",\n\t\t\t\tbasePriceString: baseCost\n\t\t\t\t\t? secondaryPrice.abbreviation.replace(\"{#}\", baseCost)\n\t\t\t\t\t: \"\"\n\t\t\t});\n\t\t\tpriceData[0].prices.push({\n\t\t\t\t...secondaryPrice,\n\t\t\t\tcost,\n\t\t\t\tbaseCost,\n\t\t\t\tmodifier: itemModifier,\n\t\t\t\tstring: secondaryPrice.abbreviation.replace(\"{#}\", cost),\n\t\t\t\tpriceString: cost\n\t\t\t\t\t? secondaryPrice.abbreviation.replace(\"{#}\", cost)\n\t\t\t\t\t: \"\",\n\t\t\t\tbasePriceString: baseCost\n\t\t\t\t\t? secondaryPrice.abbreviation.replace(\"{#}\", baseCost)\n\t\t\t\t\t: \"\"\n\t\t\t});\n\n\t\t\tpriceData[0].basePriceString = priceData[0].basePrices.filter(price => price.cost).map(price => price.string).join(\" \");\n\t\t\tpriceData[0].priceString = priceData[0].prices.filter(price => price.cost).map(price => price.string).join(\" \");\n\n\t\t}\n\n\t}\n\n\tif (itemFlagData.prices.length && (merchant === seller || (itemFlagData.purchaseOptionsAsSellOption && !buyerFlagData.onlyAcceptBasePrice))) {\n\t\tpriceData = priceData.concat(getItemFlagPriceData(itemFlagData.prices, quantity, modifier, defaultCurrencies, currencyList));\n\t}\n\n\tif (itemFlagData.sellPrices.length && merchant === buyer && !buyerFlagData.onlyAcceptBasePrice) {\n\t\tpriceData = priceData.concat(getItemFlagPriceData(itemFlagData.sellPrices, quantity, modifier, defaultCurrencies, currencyList));\n\t}\n\n\t// If there's a buyer, we also calculate how many of the item the buyer can afford\n\tif (!buyer) return priceData;\n\n\tconst buyerInfiniteCurrencies = buyerFlagData?.infiniteCurrencies;\n\tconst buyerInfiniteQuantity = buyerFlagData?.infiniteQuantity;\n\n\tconst recipientCurrencies = getActorCurrencies(buyer, { currencyList });\n\tconst totalCurrencies = recipientCurrencies\n\t\t.filter(currency => currency.exchangeRate !== undefined)\n\t\t.map(currency => currency.quantity * currency.exchangeRate).reduce((acc, num) => acc + num, 0);\n\n\t// For each price group, check for properties and items and make sure that the actor can afford it\n\tfor (const priceGroup of priceData) {\n\n\t\tconst primaryPrices = priceGroup.prices.filter(price => !price.secondary);\n\t\tconst secondaryPrices = priceGroup.prices.filter(price => price.secondary);\n\t\tpriceGroup.maxQuantity = Infinity;\n\n\t\tif (primaryPrices.length) {\n\t\t\tpriceGroup.prices.forEach(price => {\n\t\t\t\tprice.maxQuantity = Infinity;\n\t\t\t});\n\t\t\tif (!buyerInfiniteCurrencies) {\n\t\t\t\tpriceGroup.maxQuantity = Math.floor(totalCurrencies / priceGroup.baseCost);\n\t\t\t\tpriceGroup.prices.forEach(price => {\n\t\t\t\t\tprice.maxQuantity = priceGroup.maxQuantity;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tfor (const price of secondaryPrices) {\n\n\t\t\tif (buyerInfiniteQuantity) {\n\t\t\t\tprice.maxQuantity = Infinity;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (price.type === \"attribute\") {\n\t\t\t\tconst attributeQuantity = Number(foundry.utils.getProperty(buyer, price.data.path));\n\t\t\t\tprice.buyerQuantity = attributeQuantity;\n\n\t\t\t\tif (price.percent) {\n\t\t\t\t\tconst percent = Math.min(1, price.baseCost / 100);\n\t\t\t\t\tconst percentQuantity = Math.max(0, Math.floor(attributeQuantity * percent));\n\t\t\t\t\tprice.maxQuantity = Math.floor(attributeQuantity / percentQuantity);\n\t\t\t\t\tprice.baseCost = !buyer\n\t\t\t\t\t\t? price.baseCost\n\t\t\t\t\t\t: percentQuantity;\n\t\t\t\t\tprice.cost = !buyer\n\t\t\t\t\t\t? price.cost\n\t\t\t\t\t\t: percentQuantity * quantity;\n\t\t\t\t\tprice.quantity = !buyer\n\t\t\t\t\t\t? price.quantity\n\t\t\t\t\t\t: percentQuantity;\n\t\t\t\t} else {\n\t\t\t\t\tprice.maxQuantity = Math.floor(attributeQuantity / price.baseCost);\n\t\t\t\t}\n\n\t\t\t\tpriceGroup.maxQuantity = Math.min(priceGroup.maxQuantity, price.maxQuantity)\n\n\t\t\t} else {\n\t\t\t\tconst priceItem = CompendiumUtilities.getItemFromCache(price.data.uuid);\n\t\t\t\tconst foundItem = priceItem\n\t\t\t\t\t? Utilities.findSimilarItem(buyer.items, priceItem)\n\t\t\t\t\t: false;\n\t\t\t\tconst itemQuantity = foundItem\n\t\t\t\t\t? Utilities.getItemQuantity(foundItem)\n\t\t\t\t\t: 0;\n\t\t\t\tprice.buyerQuantity = itemQuantity;\n\t\t\t\tif (!itemQuantity) {\n\t\t\t\t\tpriceGroup.maxQuantity = 0;\n\t\t\t\t\tpriceGroup.quantity = 0;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (price.percent) {\n\t\t\t\t\tconst percent = Math.min(1, price.baseCost / 100);\n\t\t\t\t\tconst percentQuantity = Math.max(0, Math.floor(itemQuantity * percent));\n\t\t\t\t\tprice.maxQuantity = Math.floor(itemQuantity / percentQuantity);\n\t\t\t\t\tprice.baseCost = !buyer\n\t\t\t\t\t\t? price.baseCost\n\t\t\t\t\t\t: percentQuantity;\n\t\t\t\t\tprice.cost = !buyer\n\t\t\t\t\t\t? price.cost\n\t\t\t\t\t\t: percentQuantity * quantity;\n\t\t\t\t\tprice.quantity = !buyer\n\t\t\t\t\t\t? price.quantity\n\t\t\t\t\t\t: percentQuantity;\n\t\t\t\t} else {\n\t\t\t\t\tprice.maxQuantity = Math.floor(itemQuantity / price.baseCost);\n\t\t\t\t}\n\n\t\t\t\tpriceGroup.maxQuantity = Math.min(priceGroup.maxQuantity, price.maxQuantity);\n\t\t\t}\n\n\t\t}\n\t}\n\n\treturn priceData;\n}\n\nexport function getPaymentData({\n\tpurchaseData = [],\n\tseller = false,\n\tbuyer = false,\n\tsellerFlagData = false,\n\tbuyerFlagData = false\n} = {}) {\n\n\tbuyerFlagData = getActorFlagData(buyer, { data: buyerFlagData });\n\tif (!isItemPileMerchant(buyer, buyerFlagData)) {\n\t\tbuyerFlagData = false;\n\t}\n\n\tsellerFlagData = getActorFlagData(seller, { data: sellerFlagData });\n\tif (!isItemPileMerchant(seller, sellerFlagData)) {\n\t\tsellerFlagData = false;\n\t}\n\n\tconst merchant = sellerFlagData\n\t\t? seller\n\t\t: buyer;\n\tconst currencyList = getCurrencyList(merchant);\n\tconst currencies = getActorCurrencies(merchant, { currencyList, getAll: true });\n\tconst smallestExchangeRate = getSmallestExchangeRate(currencies)\n\tconst decimals = getExchangeRateDecimals(smallestExchangeRate);\n\n\tconst recipientCurrencies = getActorCurrencies(buyer, { currencyList, getAll: true });\n\n\tconst buyerInfiniteCurrencies = buyerFlagData?.infiniteCurrencies;\n\n\tconst paymentData = purchaseData.map(data => {\n\t\t\tconst prices = getPriceData({\n\t\t\t\tcost: data.cost,\n\t\t\t\titem: data.item,\n\t\t\t\tsecondaryPrices: data.secondaryPrices,\n\t\t\t\tseller,\n\t\t\t\tbuyer,\n\t\t\t\tsellerFlagData,\n\t\t\t\tbuyerFlagData,\n\t\t\t\titemFlagData: data.itemFlagData,\n\t\t\t\tquantity: data.quantity || 1\n\t\t\t})[data.paymentIndex || 0];\n\t\t\treturn {\n\t\t\t\t...prices,\n\t\t\t\titem: data.item\n\t\t\t};\n\t\t})\n\t\t.reduce((priceData, priceGroup) => {\n\n\t\t\tpriceData.reasons = [];\n\n\t\t\tif (!priceGroup.maxQuantity && (buyer || seller)) {\n\t\t\t\tpriceData.canBuy = false;\n\t\t\t\tconst reason = (buyer === merchant ? \"TheyCantAfford\" : \"YouCantAfford\");\n\t\t\t\tpriceData.reason.push([`ITEM-PILES.Applications.TradeMerchantItem.${reason}`]);\n\t\t\t\treturn priceData;\n\t\t\t}\n\n\t\t\tconst primaryPrices = priceGroup.prices.filter(price => !price.secondary && price.cost);\n\t\t\tconst secondaryPrices = priceGroup.prices.filter(price => price.secondary && price.cost);\n\n\t\t\tif (primaryPrices.length) {\n\n\t\t\t\tpriceData.totalCurrencyCost = Helpers.roundToDecimals(priceData.totalCurrencyCost + priceGroup.totalCost, decimals);\n\t\t\t\tpriceData.primary = true;\n\n\t\t\t}\n\n\t\t\tif (secondaryPrices.length) {\n\n\t\t\t\tfor (const price of secondaryPrices) {\n\n\t\t\t\t\tlet existingPrice = priceData.otherPrices.find(otherPrice => {\n\t\t\t\t\t\treturn otherPrice.id === price.id || (otherPrice.name === price.name && otherPrice.img === price.img && otherPrice.type === price.type);\n\t\t\t\t\t});\n\n\t\t\t\t\tif (existingPrice) {\n\t\t\t\t\t\texistingPrice.cost += price.cost;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst index = priceData.otherPrices.push(price);\n\t\t\t\t\t\texistingPrice = priceData.otherPrices[index - 1];\n\t\t\t\t\t\texistingPrice.quantity = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\texistingPrice.quantity += price.cost;\n\t\t\t\t\texistingPrice.buyerQuantity -= price.cost;\n\n\t\t\t\t\tif (existingPrice.buyerQuantity < 0) {\n\t\t\t\t\t\tpriceData.canBuy = false;\n\t\t\t\t\t\tconst reason = (buyer === merchant ? \"TheyCantAfford\" : \"YouCantAfford\");\n\t\t\t\t\t\tpriceData.reasons.push([`ITEM-PILES.Applications.TradeMerchantItem.${reason}`]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (priceGroup.item) {\n\n\t\t\t\tlet items = [{ item: priceGroup.item, contained: false }];\n\t\t\t\tconst itemTypeHandler = Utilities.getItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.TRANSFER, priceGroup.item.type);\n\t\t\t\tif (itemTypeHandler) {\n\t\t\t\t\tconst containedItems = [];\n\t\t\t\t\titemTypeHandler({ item: priceGroup.item, items: containedItems, raw: true })\n\t\t\t\t\titems = items.concat(containedItems.map(item => ({ item, contained: true })))\n\t\t\t\t}\n\n\t\t\t\tfor (const itemData of items) {\n\n\t\t\t\t\tconst itemQuantity = Utilities.getItemQuantity(itemData.item);\n\n\t\t\t\t\tconst quantityPerPrice = foundry.utils.getProperty(itemData.item, game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE) ?? 1;\n\n\t\t\t\t\tconst requiredQuantity = Math.floor(priceGroup.quantity * quantityPerPrice);\n\n\t\t\t\t\tif (requiredQuantity > itemQuantity && requiredQuantity > (priceGroup.maxQuantity * quantityPerPrice)) {\n\t\t\t\t\t\tpriceData.canBuy = false;\n\t\t\t\t\t\tconst reason = buyer === merchant ? \"You\" : \"They\";\n\t\t\t\t\t\tpriceData.reasons.push([`ITEM-PILES.Applications.TradeMerchantItem.${reason}LackQuantity`, {\n\t\t\t\t\t\t\tquantity: itemQuantity,\n\t\t\t\t\t\t\trequiredQuantity\n\t\t\t\t\t\t}]);\n\t\t\t\t\t}\n\n\t\t\t\t\tpriceData.buyerReceive.push({\n\t\t\t\t\t\ttype: \"item\",\n\t\t\t\t\t\tname: itemData.item.name,\n\t\t\t\t\t\timg: itemData.item.img,\n\t\t\t\t\t\tquantity: requiredQuantity,\n\t\t\t\t\t\titem: itemData.item,\n\t\t\t\t\t\tcontained: itemData.contained\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn priceData;\n\n\t\t}, {\n\t\t\ttotalCurrencyCost: 0, canBuy: true, primary: false, finalPrices: [], otherPrices: [], reason: [],\n\n\t\t\tbuyerReceive: [], buyerChange: [], sellerReceive: []\n\t\t});\n\n\tif (paymentData.totalCurrencyCost && !seller && !buyer) {\n\n\t\tpaymentData.finalPrices = getPriceArray(paymentData.totalCurrencyCost, recipientCurrencies)\n\t\t\t.filter(currency => !currency.secondary);\n\n\t} else if (paymentData.totalCurrencyCost) {\n\n\t\t// The price array that we need to fill\n\t\tconst prices = getPriceArray(paymentData.totalCurrencyCost, recipientCurrencies)\n\t\t\t.filter(currency => !currency.secondary);\n\n\t\t// This is the target price amount we need to hit\n\t\tlet priceLeft = paymentData.totalCurrencyCost;\n\n\t\tconst inverse = prices[prices.length - 1].primary && prices[prices.length - 1].exchangeRate === 1;\n\n\t\t// Starting from the smallest currency increment in the price\n\t\tfor (let i = prices.length - 1, j = 0; i >= 0; i--, j++) {\n\n\t\t\tconst price = prices[inverse\n\t\t\t\t? j\n\t\t\t\t: i];\n\n\t\t\tconst buyerPrice = {\n\t\t\t\t...price,\n\t\t\t\tbuyerQuantity: buyerInfiniteCurrencies\n\t\t\t\t\t? Infinity\n\t\t\t\t\t: price.quantity,\n\t\t\t\tquantity: 0,\n\t\t\t\tisCurrency: true\n\t\t\t}\n\n\t\t\tif (price.type === \"item\") {\n\t\t\t\tbuyerPrice.item = price.data.item ?? CompendiumUtilities.getItemFromCache(price.data.uuid);\n\t\t\t}\n\n\t\t\t// If we have met the price target (or exceeded it, eg, we need change), populate empty entry\n\t\t\tif (priceLeft <= 0 || !price.cost || currencies.length === 1) {\n\t\t\t\tif (currencies.length === 1) {\n\t\t\t\t\tbuyerPrice.quantity = price.cost;\n\t\t\t\t\tpriceLeft = 0;\n\t\t\t\t}\n\t\t\t\tpaymentData.finalPrices.push(buyerPrice);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// If the buyer does not have enough to cover the cost, put what we can into it, otherwise all of it\n\t\t\tbuyerPrice.quantity = buyerPrice.buyerQuantity < price.cost\n\t\t\t\t? buyerPrice.buyerQuantity\n\t\t\t\t: price.cost;\n\n\t\t\t// If it's the primary currency\n\t\t\tif (price.primary) {\n\t\t\t\t// And the buyer has enough of the primary currency to cover the rest of the price, use that\n\t\t\t\tconst totalCurrencyValue = Helpers.roundToDecimals(buyerPrice.buyerQuantity * price.exchangeRate, decimals);\n\t\t\t\tif (totalCurrencyValue > priceLeft) {\n\t\t\t\t\tbuyerPrice.quantity = Math.ceil(priceLeft);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tpaymentData.finalPrices.push(buyerPrice);\n\n\t\t\t// Then adjust the remaining price - if this goes below zero, we will need change back\n\t\t\tpriceLeft = Helpers.roundToDecimals(priceLeft - (buyerPrice.quantity * price.exchangeRate), decimals);\n\n\t\t}\n\n\t\t// If there's STILL some remaining price (eg, we haven't been able to scrounge up enough currency to pay for it)\n\t\t// we can start using the larger currencies, such as platinum in D&D 5e\n\t\tif (currencies.length > 1) {\n\n\t\t\twhile (priceLeft > 0) {\n\n\t\t\t\t// We then need to loop through each price, and check if we have any more left over\n\t\t\t\tfor (const buyerPrice of paymentData.finalPrices) {\n\n\t\t\t\t\t// If we don't, look for the next one\n\t\t\t\t\tlet buyerCurrencyQuantity = buyerPrice.buyerQuantity - buyerPrice.quantity;\n\t\t\t\t\tif (!buyerCurrencyQuantity) continue;\n\n\t\t\t\t\t// Otherwise, add enough to cover the remaining cost\n\t\t\t\t\tconst newQuantity = Math.ceil(Math.min(buyerCurrencyQuantity, priceLeft / buyerPrice.exchangeRate));\n\t\t\t\t\tbuyerPrice.quantity += newQuantity;\n\t\t\t\t\tpriceLeft = Helpers.roundToDecimals(priceLeft - (newQuantity * buyerPrice.exchangeRate), decimals);\n\n\t\t\t\t\tif (priceLeft <= 0) break;\n\n\t\t\t\t}\n\n\t\t\t\tif (priceLeft > 0) {\n\t\t\t\t\tpaymentData.finalPrices = paymentData.finalPrices.sort((a, b) => b.exchangeRate - a.exchangeRate);\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tpaymentData.finalPrices = paymentData.finalPrices.sort((a, b) => b.exchangeRate - a.exchangeRate);\n\n\t\t\t// Since the change will be negative, we'll need to flip it, since this is what we'll get back\n\t\t\tlet change = Math.abs(priceLeft);\n\n\t\t\tfor (const currency of currencies) {\n\n\t\t\t\tif (!change) break;\n\n\t\t\t\t// Get the remaining price, and normalize it to this currency\n\t\t\t\tlet numCurrency = Math.floor(Helpers.roundToDecimals(change / currency.exchangeRate, decimals));\n\t\t\t\tchange = Helpers.roundToDecimals(change - (numCurrency * currency.exchangeRate), decimals);\n\n\t\t\t\t// If there's some currencies to be gotten back\n\t\t\t\tif (numCurrency) {\n\t\t\t\t\t// We check if we've paid with this currency\n\t\t\t\t\tconst payment = paymentData.finalPrices.find(payment => {\n\t\t\t\t\t\treturn payment.id === currency.id || (payment.name === currency.name && payment.img === currency.img && payment.type === currency.type);\n\t\t\t\t\t});\n\t\t\t\t\tif (!payment) continue;\n\n\t\t\t\t\t// If we have paid with this currency, and we're getting some back, we can do one of two things:\n\t\t\t\t\tif ((payment.quantity - numCurrency) >= 0) {\n\t\t\t\t\t\t// Either just subtract it from the total paid if some of our payment will still remain\n\t\t\t\t\t\t// IE, the change we got back didn't cancel out the payment\n\t\t\t\t\t\tpayment.quantity -= numCurrency;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Or if it does cancel out our payment, we add that to the change we'll get back and remove the payment entirely\n\t\t\t\t\t\tpaymentData.buyerChange.push({\n\t\t\t\t\t\t\t...currency, isCurrency: true, quantity: numCurrency - payment.quantity\n\t\t\t\t\t\t});\n\t\t\t\t\t\tpayment.quantity = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Copy the final currencies that the seller will get\n\t\tpaymentData.sellerReceive = paymentData.finalPrices.map(price => {\n\t\t\treturn { ...price };\n\t\t});\n\n\t\t// But, we'll need to make sure they have enough change to _give_ to the buyer\n\t\t// We collate the total amount of change needed\n\t\tlet changeNeeded = paymentData.buyerChange.reduce((acc, change) => {\n\t\t\tconst currency = currencies.find(currency => {\n\t\t\t\treturn change.id === currency.id || (change.name === currency.name && change.img === currency.img && change.type === currency.type);\n\t\t\t});\n\t\t\treturn acc + currency.quantity >= change.quantity\n\t\t\t\t? 0\n\t\t\t\t: (change.quantity - currency.quantity) * change.exchangeRate;\n\t\t}, 0);\n\n\t\t// If the seller needs give the buyer some change, we'll modify the payment they'll get to cover for it\n\t\tif (changeNeeded) {\n\n\t\t\t// If the seller is being given enough of the primary currency to cover for the cost, we use that\n\t\t\tconst primaryCurrency = paymentData.sellerReceive.find(price => price.primary && (price.quantity * price.exchangeRate) > changeNeeded);\n\t\t\tif (primaryCurrency) {\n\t\t\t\tprimaryCurrency.quantity--;\n\t\t\t\tchangeNeeded -= 1 * primaryCurrency.exchangeRate;\n\t\t\t} else {\n\t\t\t\t// Otherwise, we'll use the biggest currency we can find to cover for it\n\t\t\t\tconst biggestCurrency = paymentData.sellerReceive.find(price => price.quantity && (price.quantity * price.exchangeRate) > changeNeeded);\n\t\t\t\tbiggestCurrency.quantity--;\n\t\t\t\tchangeNeeded -= 1 * biggestCurrency.exchangeRate;\n\t\t\t}\n\n\t\t\tchangeNeeded = Math.abs(changeNeeded);\n\n\t\t\t// Then loop through each currency and add enough currency so that the total adds up\n\t\t\tfor (const currency of paymentData.sellerReceive) {\n\t\t\t\tif (!changeNeeded) break;\n\t\t\t\tlet numCurrency = Math.floor(Helpers.roundToDecimals(changeNeeded / currency.exchangeRate, decimals));\n\t\t\t\tchangeNeeded = Helpers.roundToDecimals(changeNeeded - (numCurrency * currency.exchangeRate), decimals);\n\t\t\t\tcurrency.quantity += numCurrency;\n\t\t\t}\n\t\t}\n\t}\n\n\tpaymentData.finalPrices = paymentData.finalPrices.concat(paymentData.otherPrices);\n\tpaymentData.sellerReceive = paymentData.sellerReceive.concat(paymentData.otherPrices);\n\n\tpaymentData.basePriceString = paymentData.finalPrices\n\t\t.filter(price => price.cost)\n\t\t.map(price => {\n\t\t\tlet abbreviation = price.abbreviation;\n\t\t\tif (price.percent && abbreviation.includes(\"%\")) {\n\t\t\t\tabbreviation = abbreviation.replaceAll(\"%\", \"\")\n\t\t\t}\n\t\t\treturn abbreviation.replace(\"{#}\", price.cost)\n\t\t}).join(\" \");\n\n\tdelete paymentData.otherPrices;\n\n\treturn paymentData;\n\n}\n\nexport function isMerchantClosed(merchant, { pileData = false } = {}) {\n\n\tif (!pileData) pileData = getActorFlagData(merchant);\n\n\tconst timestamp = window.SimpleCalendar.api.timestampToDate(window.SimpleCalendar.api.timestamp());\n\n\tconst openTimes = pileData.openTimes.open;\n\tconst closeTimes = pileData.openTimes.close;\n\n\tconst openingTime = Number(openTimes.hour.toString() + \".\" + openTimes.minute.toString());\n\tconst closingTime = Number(closeTimes.hour.toString() + \".\" + closeTimes.minute.toString());\n\tconst currentTime = Number(timestamp.hour.toString() + \".\" + timestamp.minute.toString());\n\n\tlet isClosed = openingTime > closingTime\n\t\t? !(currentTime >= openingTime || currentTime <= closingTime)  // Is the store open over midnight?\n\t\t: !(currentTime >= openingTime && currentTime <= closingTime); // or is the store open during normal daylight hours?\n\n\tconst currentWeekday = window.SimpleCalendar.api.getCurrentWeekday();\n\n\tisClosed = isClosed || (pileData.closedDays ?? []).includes(currentWeekday.name);\n\n\tconst currentDate = window.SimpleCalendar.api.currentDateTime();\n\tconst notes = window.SimpleCalendar.api.getNotesForDay(currentDate.year, currentDate.month, currentDate.day);\n\tconst categories = new Set(notes.map(note => foundry.utils.getProperty(note, \"flags.foundryvtt-simple-calendar.noteData.categories\") ?? []).deepFlatten());\n\n\treturn isClosed || categories.intersection(new Set(pileData.closedHolidays ?? [])).size > 0;\n\n}\n\nexport async function updateMerchantLog(itemPile, activityData) {\n\n\tconst vaultLog = getActorLog(itemPile);\n\n\tvaultLog.push({\n\t\t...activityData, date: Date.now()\n\t});\n\n\treturn itemPile.update({\n\t\t[CONSTANTS.FLAGS.LOG]: vaultLog\n\t});\n}\n\n/* ---------------------- VAULT FUNCTIONS ---------------------- */\n\nexport function getVaultGridData(vaultActor, { flagData = false, items = false } = {}) {\n\n\tconst vaultFlags = getActorFlagData(vaultActor, { data: flagData });\n\n\tconst vaultItems = getActorItems(vaultActor);\n\n\tlet enabledCols = vaultFlags.cols;\n\tlet enabledRows = vaultFlags.rows;\n\n\tconst regularItems = (items || vaultItems).map(item => ({\n\t\titem, itemFlagData: getItemFlagData(item), quantity: Utilities.getItemQuantity(item)\n\t})).filter(({ itemFlagData }) => {\n\t\treturn !itemFlagData.vaultExpander || !vaultFlags.vaultExpansion;\n\t});\n\n\tconst vaultExpanders = vaultItems.map(item => ({\n\t\titem, itemFlagData: getItemFlagData(item), quantity: Utilities.getItemQuantity(item)\n\t})).filter(({ itemFlagData }) => {\n\t\treturn itemFlagData.vaultExpander && vaultFlags.vaultExpansion;\n\t});\n\n\tif (vaultFlags.vaultExpansion) {\n\n\t\tconst expansions = vaultExpanders.reduce((acc, item) => {\n\t\t\tacc.cols += (item.itemFlagData.addsCols ?? 0) * item.quantity;\n\t\t\tacc.rows += (item.itemFlagData.addsRows ?? 0) * item.quantity;\n\t\t\treturn acc;\n\t\t}, {\n\t\t\tcols: vaultFlags.baseExpansionCols ?? 0, rows: vaultFlags.baseExpansionRows ?? 0\n\t\t});\n\n\t\tenabledCols = expansions.cols;\n\t\tenabledRows = expansions.rows;\n\n\t}\n\n\tenabledCols = Math.min(enabledCols, vaultFlags.cols);\n\tenabledRows = Math.min(enabledRows, vaultFlags.rows);\n\n\tconst grid = Array.from(Array(enabledCols).keys()).map(() => {\n\t\treturn Array.from(Array(enabledRows).keys()).map(() => {\n\t\t\treturn null;\n\t\t})\n\t});\n\n\tfor (const item of regularItems) {\n\t\tconst { width, height } = getVaultItemDimensions(item.item, item.itemFlagData);\n\t\tfor (let w = 0; w < width; w++) {\n\t\t\tconst x = Math.max(0, Math.min(item.itemFlagData.x + w, enabledCols - 1));\n\t\t\tfor (let h = 0; h < height; h++) {\n\t\t\t\tconst y = Math.max(0, Math.min(item.itemFlagData.y + h, enabledRows - 1));\n\t\t\t\tgrid[x][y] = item.item.name;\n\t\t\t}\n\t\t}\n\t}\n\n\tlet freeCells = [];\n\tfor (let x = 0; x < enabledCols; x++) {\n\t\tfor (let y = 0; y < enabledRows; y++) {\n\t\t\tif (grid[x][y]) continue;\n\t\t\tfreeCells.push({ x, y });\n\t\t}\n\t}\n\n\treturn {\n\t\ttotalSpaces: Math.max(0, (vaultFlags.cols * vaultFlags.rows)),\n\t\tenabledSpaces: Math.max(0, (enabledCols * enabledRows)),\n\t\tfreeSpaces: Math.max(0, (enabledCols * enabledRows) - regularItems.length),\n\t\tenabledCols: enabledCols,\n\t\tenabledRows: enabledRows,\n\t\tcols: vaultFlags.cols,\n\t\trows: vaultFlags.rows,\n\t\titems: regularItems,\n\t\tgrid,\n\t\tfreeCells\n\t}\n\n}\n\nexport function getVaultItemDimensions(item, itemFlagData = false) {\n\tlet { width, height, flipped } = getItemFlagData(item, itemFlagData);\n\treturn {\n\t\twidth: flipped\n\t\t\t? height\n\t\t\t: width,\n\t\theight: flipped\n\t\t\t? width\n\t\t\t: height\n\t}\n}\n\nexport function fitItemsIntoVault(items, vaultActor, {\n\tmergeItems = true,\n\texistingItems = false,\n\titemFilters = false\n} = {}) {\n\tif (!isItemPileVault(vaultActor)) return { updates: items, deletions: [] };\n\tconst vaultItems = existingItems || getActorItems(vaultActor, { itemFilters });\n\tconst gridData = getVaultGridData(vaultActor, { items: existingItems });\n\tconst updates = [];\n\tconst deletions = [];\n\tfor (let i = 0; i < items.length; i++) {\n\t\tconst item = items[i];\n\t\tconst itemData = foundry.utils.deepClone(item instanceof Item\n\t\t\t? item.toObject()\n\t\t\t: item);\n\t\tconst flagData = getItemFlagData(itemData);\n\t\tconst newPosition = canItemFitInVault(itemData, vaultActor, { gridData, items: vaultItems, mergeItems });\n\t\tif (typeof newPosition === \"string\") {\n\t\t\tdeletions.push(item._id);\n\t\t\tconst update = updates.find(update => update._id === newPosition);\n\t\t\tif (update) Utilities.setItemQuantity(update, (Utilities.getItemQuantity(update) ?? 1) + Utilities.getItemQuantity(itemData));\n\t\t\tcontinue;\n\t\t} else if (!newPosition) {\n\t\t\treturn false;\n\t\t}\n\t\tfoundry.utils.setProperty(flagData, \"x\", newPosition.x);\n\t\tfoundry.utils.setProperty(flagData, \"y\", newPosition.y);\n\t\tfoundry.utils.setProperty(flagData, \"flipped\", newPosition.flipped);\n\t\tconst { width, height } = getVaultItemDimensions(item, flagData);\n\t\tfor (let w = 0; w < width; w++) {\n\t\t\tconst x = Math.max(0, Math.min(newPosition.x + w, gridData.enabledCols - 1));\n\t\t\tfor (let h = 0; h < height; h++) {\n\t\t\t\tconst y = Math.max(0, Math.min(newPosition.y + h, gridData.enabledRows - 1));\n\t\t\t\tgridData.grid[x][y] = item.name;\n\t\t\t\tconst indexToDelete = gridData.freeCells.findIndex(pos => pos.x === x && pos.y === y);\n\t\t\t\tif (indexToDelete > -1) {\n\t\t\t\t\tgridData.freeCells.splice(indexToDelete, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfoundry.utils.setProperty(itemData, CONSTANTS.FLAGS.ITEM, flagData);\n\t\tupdates.push(itemData);\n\t\tvaultItems.push(itemData);\n\t}\n\treturn {\n\t\tupdates,\n\t\tdeletions\n\t}\n}\n\nexport function canItemFitInVault(item, vaultActor, {\n\tmergeItems = true,\n\tgridData = null,\n\tposition = null,\n\titems = null\n} = {}) {\n\tif (!isItemPileVault(vaultActor)) return true;\n\tconst vaultItems = items ?? getActorItems(vaultActor);\n\tif (mergeItems && canItemStack(item, vaultActor)) {\n\t\tconst similarItem = Utilities.findSimilarItem(vaultItems, item);\n\t\tif (similarItem) {\n\t\t\tconst itemFlagData = getItemFlagData(similarItem);\n\t\t\tif (!position || areItemsColliding(position, itemFlagData)) {\n\t\t\t\treturn similarItem.id ?? similarItem._id;\n\t\t\t}\n\t\t}\n\t}\n\tconst vaultGridData = gridData ?? getVaultGridData(vaultActor);\n\treturn getNewItemsVaultPosition(item, vaultGridData, { position, items });\n}\n\nexport function getNewItemsVaultPosition(item, gridData, { position = null } = {}) {\n\n\tconst itemFlagData = getItemFlagData(item);\n\tlet flipped = position?.flipped ?? false;\n\tconst { grid, freeCells, enabledCols, enabledRows } = gridData;\n\n\tif (position) {\n\t\tlet fitsInPosition = true;\n\t\tconst { width, height } = getVaultItemDimensions(item, { ...itemFlagData, flipped });\n\t\tfor (let w = 0; w < width; w++) {\n\t\t\tfor (let h = 0; h < height; h++) {\n\t\t\t\tfitsInPosition = (position.x + w) < enabledCols\n\t\t\t\t\t&& (position.y + h) < enabledRows\n\t\t\t\t\t&& !grid[position.x + w][position.y + h];\n\t\t\t\tif (!fitsInPosition) break;\n\t\t\t}\n\t\t\tif (!fitsInPosition) break;\n\t\t}\n\t\tif (fitsInPosition) return position;\n\t} else {\n\t\tposition = { x: 0, y: 0 };\n\t}\n\n\tconst loops = Number(itemFlagData.width > 1 || itemFlagData.height > 1);\n\tfor (let i = 0; i <= loops; i++) {\n\n\t\tconst { width, height } = getVaultItemDimensions(item, { ...itemFlagData, flipped });\n\n\t\tconst validCells = freeCells.filter(cell => {\n\t\t\treturn ((cell.x + width) <= enabledCols) && ((cell.y + height) <= enabledRows);\n\t\t});\n\n\t\tconst cellsToCheck = validCells.sort((a, b) => {\n\t\t\tconst distA = (new Ray(a, position)).distance;\n\t\t\tconst distB = (new Ray(b, position)).distance;\n\t\t\treturn distA - distB;\n\t\t});\n\n\t\tif (width === 1 && height === 1 && cellsToCheck.length) {\n\t\t\treturn cellsToCheck[0];\n\t\t}\n\n\t\tcellLoop:\n\t\t\tfor (const { x, y } of cellsToCheck) {\n\t\t\t\tfor (let w = 0; w < width; w++) {\n\t\t\t\t\tfor (let h = 0; h < height; h++) {\n\t\t\t\t\t\tif (grid[x + w][y + h]) {\n\t\t\t\t\t\t\tcontinue cellLoop;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn { x, y, flipped };\n\t\t\t}\n\t\tflipped = !flipped;\n\t}\n\n\treturn false;\n\n}\n\nexport function getVaultAccess(vaultActor, { flagData = false, hasRecipient = false } = {}) {\n\n\tconst vaultFlags = getActorFlagData(vaultActor, { data: flagData });\n\n\tconst vaultAccess = vaultFlags.vaultAccess.filter(access => {\n\t\treturn fromUuidSync(access.uuid)?.isOwner;\n\t});\n\n\treturn vaultAccess.reduce((acc, access) => {\n\t\tacc.canView = acc.canView || (access.view ?? true);\n\t\tacc.canOrganize = acc.canOrganize || access.organize;\n\t\tacc.canWithdrawItems = (acc.canWithdrawItems || access.items.withdraw) && hasRecipient;\n\t\tacc.canDepositItems = (acc.canDepositItems || access.items.deposit) && hasRecipient;\n\t\tacc.canWithdrawCurrencies = (acc.canWithdrawCurrencies || access.currencies.withdraw) && hasRecipient;\n\t\tacc.canDepositCurrencies = (acc.canDepositCurrencies || access.currencies.deposit) && hasRecipient;\n\t\treturn acc;\n\t}, {\n\t\tcanView: vaultActor.isOwner || !vaultFlags.restrictVaultAccess,\n\t\tcanOrganize: vaultActor.isOwner,\n\t\tcanWithdrawItems: vaultActor.isOwner && hasRecipient,\n\t\tcanDepositItems: vaultActor.isOwner && hasRecipient,\n\t\tcanWithdrawCurrencies: vaultActor.isOwner && hasRecipient,\n\t\tcanDepositCurrencies: vaultActor.isOwner && hasRecipient\n\t});\n\n}\n\nexport async function updateVaultLog(itemPile, {\n\tactor = false, userId = false, items = [], attributes = [], withdrawal = true, vaultLogData = {},\n} = {}) {\n\n\tconst formattedItems = [];\n\tconst formattedCurrencies = [];\n\n\tconst currencies = getActorCurrencies(itemPile, { getAll: true });\n\n\tconst date = Date.now();\n\n\tfor (const itemData of items) {\n\t\tif (currencies.some(currency => currency.name === itemData.item.name)) {\n\t\t\tformattedCurrencies.push({\n\t\t\t\tactor: actor?.name ?? false,\n\t\t\t\tuser: userId,\n\t\t\t\tname: itemData.item.name,\n\t\t\t\tqty: itemData.quantity * (withdrawal\n\t\t\t\t\t? -1\n\t\t\t\t\t: 1),\n\t\t\t\taction: vaultLogData?.action ?? (withdrawal\n\t\t\t\t\t? \"withdrew\"\n\t\t\t\t\t: \"deposited\"),\n\t\t\t\tdate\n\t\t\t});\n\t\t} else {\n\t\t\tconst item = new Item.implementation(itemData.item);\n\t\t\tformattedItems.push({\n\t\t\t\tactor: actor?.name ?? false,\n\t\t\t\tuser: userId,\n\t\t\t\tname: item.name,\n\t\t\t\tqty: itemData.quantity * (withdrawal\n\t\t\t\t\t? -1\n\t\t\t\t\t: 1),\n\t\t\t\taction: vaultLogData?.action ?? (withdrawal\n\t\t\t\t\t? \"withdrew\"\n\t\t\t\t\t: \"deposited\"),\n\t\t\t\tdate\n\t\t\t});\n\t\t}\n\t}\n\n\tfor (const [key, quantity] of Object.entries(attributes)) {\n\t\tconst currency = currencies.find(currency => currency.data.path === key);\n\t\tif (currency) {\n\t\t\tformattedCurrencies.push({\n\t\t\t\tactor: actor?.name ?? false,\n\t\t\t\tuser: userId,\n\t\t\t\tname: currency.name,\n\t\t\t\tqty: quantity * (withdrawal\n\t\t\t\t\t? -1\n\t\t\t\t\t: 1),\n\t\t\t\taction: vaultLogData?.action ?? (withdrawal\n\t\t\t\t\t? \"withdrew\"\n\t\t\t\t\t: \"deposited\"),\n\t\t\t\tdate\n\t\t\t});\n\t\t}\n\t}\n\n\tconst vaultLog = getActorLog(itemPile);\n\n\treturn itemPile.update({\n\t\t[CONSTANTS.FLAGS.LOG]: formattedItems.concat(formattedCurrencies).concat(vaultLog)\n\t});\n}\n\nexport function getActorLog(actor) {\n\treturn foundry.utils.getProperty(Utilities.getActor(actor), CONSTANTS.FLAGS.LOG) || [];\n}\n\nexport function clearActorLog(actor) {\n\treturn actor.update({\n\t\t[CONSTANTS.FLAGS.LOG]: []\n\t});\n}\n\n/**\n *\n * @param tableUuid\n * @param formula\n * @param resetTable\n * @param normalize\n * @param displayChat\n * @param rollData\n * @param customCategory\n * @returns {Promise<[object]>}\n */\nexport async function rollTable({\n\ttableUuid,\n\tformula = \"1\",\n\tresetTable = true,\n\tnormalize = false,\n\tdisplayChat = false,\n\trollData = {},\n\tcustomCategory = false\n} = {}) {\n\n\tconst rolledItems = [];\n\n\tconst table = await fromUuid(tableUuid);\n\n\tif (!tableUuid.startsWith(\"Compendium\")) {\n\t\tif (resetTable) {\n\t\t\tawait table.reset();\n\t\t}\n\n\t\tif (normalize) {\n\t\t\tawait table.update({\n\t\t\t\tresults: table.results.map(result => ({\n\t\t\t\t\t_id: result.id, weight: result.range[1] - (result.range[0] - 1)\n\t\t\t\t}))\n\t\t\t});\n\t\t\tawait table.normalize();\n\t\t}\n\t}\n\n\tconst roll = await new Roll(formula.toString(), rollData).evaluate({ allowInteractive: false });\n\tif (roll.total <= 0) {\n\t\treturn [];\n\t}\n\n\tlet results = [];\n\tif (game.modules.get(\"better-rolltables\")?.active) {\n\t\tconst brtOptions = {\n\t\t\trollsAmount: roll.total,\n\t\t\troll: undefined,\n\t\t\tdisplayChat: displayChat,\n\t\t\trecursive: true\n\t\t}\n\t\tresults = (await game.modules.get(\"better-rolltables\").api.roll(table, brtOptions)).itemsData.map(result => ({\n\t\t\tdocumentCollection: result.documentCollection,\n\t\t\tdocumentId: result.documentId,\n\t\t\ttext: result.text || result.name,\n\t\t\timg: result.img,\n\t\t\tquantity: 1\n\t\t}));\n\t} else {\n\t\tresults = (await table.drawMany(roll.total, { displayChat, recursive: true })).results;\n\t}\n\n\tfor (const rollData of results) {\n\n\t\tlet rolledQuantity = rollData?.quantity ?? 1;\n\n\t\tlet item;\n\t\tif (rollData.documentCollection === \"Item\") {\n\t\t\titem = game.items.get(rollData.documentId);\n\t\t} else {\n\t\t\tconst compendium = game.packs.get(rollData.documentCollection);\n\t\t\tif (compendium) {\n\t\t\t\titem = await compendium.getDocument(rollData.documentId);\n\t\t\t}\n\t\t}\n\n\t\tif (item instanceof RollTable) {\n\t\t\trolledItems.push(...(await rollTable({ tableUuid: item.uuid, resetTable, normalize, displayChat })))\n\t\t} else if (item instanceof Item) {\n\t\t\tconst quantity = Math.max(Utilities.getItemQuantity(item) * rolledQuantity, 1);\n\t\t\trolledItems.push({\n\t\t\t\t...rollData, item, quantity\n\t\t\t});\n\t\t}\n\n\t}\n\n\tconst items = [];\n\n\trolledItems.forEach(newItem => {\n\t\tconst existingItem = items.find((item) => {\n\t\t\tif (item.documentId && newItem.documentId) {\n\t\t\t\treturn item.documentId === newItem.documentId;\n\t\t\t} else {\n\t\t\t\treturn item._id === newItem._id;\n\t\t\t}\n\t\t});\n\t\tif (existingItem) {\n\t\t\texistingItem.quantity += Math.max(newItem.quantity, 1);\n\t\t} else {\n\t\t\tconst flags = foundry.utils.getProperty(newItem.item, CONSTANTS.FLAGS.ITEM) ?? {};\n\t\t\tif (customCategory) {\n\t\t\t\tfoundry.utils.setProperty(newItem, CONSTANTS.FLAGS.CUSTOM_CATEGORY, customCategory);\n\t\t\t\tfoundry.utils.setProperty(flags, \"customCategory\", customCategory);\n\t\t\t}\n\t\t\tfoundry.utils.setProperty(newItem, CONSTANTS.FLAGS.ITEM, flags);\n\t\t\tif (game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE && !foundry.utils.getProperty(newItem, game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE)) {\n\t\t\t\tfoundry.utils.setProperty(newItem, game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE, Utilities.getItemQuantity(newItem.item));\n\t\t\t}\n\t\t\titems.push({\n\t\t\t\t...newItem\n\t\t\t});\n\t\t}\n\t})\n\n\treturn items;\n\n}\n\nexport async function rollMerchantTables({ tableData = false, actor = false } = {}) {\n\n\tif (tableData && !Array.isArray(tableData)) {\n\t\ttableData = [tableData]\n\t} else if (!tableData && actor) {\n\t\tconst flagData = getActorFlagData(actor);\n\t\ttableData = flagData.tablesForPopulate;\n\t} else if (!tableData && !actor) {\n\t\treturn [];\n\t}\n\n\tlet items = [];\n\n\tfor (const table of tableData) {\n\n\t\tconst rollableTable = await fromUuid(table.uuid);\n\n\t\tif (!rollableTable) continue;\n\n\t\tif (!table.uuid.startsWith(\"Compendium\")) {\n\t\t\tawait rollableTable.reset();\n\t\t}\n\n\t\tlet tableItems = [];\n\t\tconst customCategory = table?.customCategory ?? false;\n\n\t\tif (table.addAll) {\n\n\t\t\tfor (const [itemId, formula] of Object.entries(table.items)) {\n\t\t\t\tconst roll = await new Roll(formula).evaluate({ allowInteractive: false });\n\t\t\t\tif (roll.total <= 0) continue;\n\t\t\t\tconst rollResult = rollableTable.results.get(itemId).toObject();\n\t\t\t\tconst potentialPack = game.packs.get(rollResult.documentCollection);\n\t\t\t\tif (rollResult.documentCollection === \"RollTable\" || potentialPack?.documentName === \"RollTable\") {\n\t\t\t\t\tconst subTable = await getTable(rollResult);\n\t\t\t\t\titems.push(...(await rollMerchantTables({\n\t\t\t\t\t\ttableData: [{\n\t\t\t\t\t\t\tuuid: subTable.uuid, addAll: false, timesToRoll: roll.total, customCategory: customCategory\n\t\t\t\t\t\t}], actor\n\t\t\t\t\t})))\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst item = await getItem(rollResult);\n\t\t\t\tif (!item) continue;\n\t\t\t\tconst quantity = roll.total * Math.max(Utilities.getItemQuantity(item), 1);\n\t\t\t\ttableItems.push({\n\t\t\t\t\t...rollResult, customCategory: customCategory, item, quantity\n\t\t\t\t})\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst roll = await new Roll((table.timesToRoll ?? \"1\").toString()).evaluate({ allowInteractive: false });\n\n\t\t\tif (roll.total <= 0) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\ttableItems = await rollTable({\n\t\t\t\ttableUuid: table.uuid, formula: roll.total, customCategory: customCategory\n\t\t\t})\n\n\t\t\tif (table?.customCategory) {\n\t\t\t\ttableItems = tableItems.map(item => {\n\t\t\t\t\tfoundry.utils.setProperty(item, \"customCategory\", table?.customCategory)\n\t\t\t\t\treturn item;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\ttableItems.forEach(newItem => {\n\t\t\tconst existingItem = items.find((item) => {\n\t\t\t\tif (item.documentId && newItem.documentId) {\n\t\t\t\t\treturn item.documentId === newItem.documentId;\n\t\t\t\t} else {\n\t\t\t\t\treturn item._id === newItem._id;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (existingItem) {\n\t\t\t\texistingItem.quantity += Math.max(newItem.quantity, 1);\n\t\t\t} else {\n\t\t\t\tconst flags = cleanItemFlagData(foundry.utils.getProperty(newItem.item, CONSTANTS.FLAGS.ITEM) ?? {});\n\t\t\t\tif (newItem?.customCategory) {\n\t\t\t\t\tfoundry.utils.setProperty(newItem, CONSTANTS.FLAGS.CUSTOM_CATEGORY, newItem?.customCategory);\n\t\t\t\t\tfoundry.utils.setProperty(flags, \"customCategory\", newItem?.customCategory);\n\t\t\t\t}\n\t\t\t\tfoundry.utils.setProperty(newItem, CONSTANTS.FLAGS.ITEM, flags);\n\t\t\t\tif (game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE && !foundry.utils.getProperty(newItem, game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE)) {\n\t\t\t\t\tfoundry.utils.setProperty(newItem, game.itempiles.API.QUANTITY_FOR_PRICE_ATTRIBUTE, Utilities.getItemQuantity(newItem.item));\n\t\t\t\t}\n\t\t\t\titems.push({\n\t\t\t\t\t...newItem,\n\t\t\t\t\tquantity: newItem.quantity\n\t\t\t\t});\n\t\t\t}\n\t\t})\n\t}\n\n\treturn items;\n}\n\nasync function getTable(tableToGet) {\n\tlet table;\n\tif (tableToGet.documentCollection === \"RollTable\") {\n\t\ttable = game.tables.get(tableToGet.documentId);\n\t} else {\n\t\tconst compendium = game.packs.get(tableToGet.documentCollection);\n\t\tif (compendium) {\n\t\t\ttable = await compendium.getDocument(tableToGet.documentId);\n\t\t}\n\t}\n\treturn table;\n}\n\nasync function getItem(itemToGet) {\n\tlet item;\n\tif (itemToGet.documentCollection === \"Item\") {\n\t\titem = game.items.get(itemToGet.documentId);\n\t} else {\n\t\tconst compendium = game.packs.get(itemToGet.documentCollection);\n\t\tif (compendium) {\n\t\t\titem = await compendium.getDocument(itemToGet.documentId);\n\t\t}\n\t}\n\treturn item;\n}\n","/**\n * Custom positioning reference element.\n * @see https://floating-ui.com/docs/virtual-elements\n */\n\nconst sides = ['top', 'right', 'bottom', 'left'];\nconst alignments = ['start', 'end'];\nconst placements = /*#__PURE__*/sides.reduce((acc, side) => acc.concat(side, side + \"-\" + alignments[0], side + \"-\" + alignments[1]), []);\nconst min = Math.min;\nconst max = Math.max;\nconst round = Math.round;\nconst floor = Math.floor;\nconst createCoords = v => ({\n  x: v,\n  y: v\n});\nconst oppositeSideMap = {\n  left: 'right',\n  right: 'left',\n  bottom: 'top',\n  top: 'bottom'\n};\nconst oppositeAlignmentMap = {\n  start: 'end',\n  end: 'start'\n};\nfunction clamp(start, value, end) {\n  return max(start, min(value, end));\n}\nfunction evaluate(value, param) {\n  return typeof value === 'function' ? value(param) : value;\n}\nfunction getSide(placement) {\n  return placement.split('-')[0];\n}\nfunction getAlignment(placement) {\n  return placement.split('-')[1];\n}\nfunction getOppositeAxis(axis) {\n  return axis === 'x' ? 'y' : 'x';\n}\nfunction getAxisLength(axis) {\n  return axis === 'y' ? 'height' : 'width';\n}\nfunction getSideAxis(placement) {\n  return ['top', 'bottom'].includes(getSide(placement)) ? 'y' : 'x';\n}\nfunction getAlignmentAxis(placement) {\n  return getOppositeAxis(getSideAxis(placement));\n}\nfunction getAlignmentSides(placement, rects, rtl) {\n  if (rtl === void 0) {\n    rtl = false;\n  }\n  const alignment = getAlignment(placement);\n  const alignmentAxis = getAlignmentAxis(placement);\n  const length = getAxisLength(alignmentAxis);\n  let mainAlignmentSide = alignmentAxis === 'x' ? alignment === (rtl ? 'end' : 'start') ? 'right' : 'left' : alignment === 'start' ? 'bottom' : 'top';\n  if (rects.reference[length] > rects.floating[length]) {\n    mainAlignmentSide = getOppositePlacement(mainAlignmentSide);\n  }\n  return [mainAlignmentSide, getOppositePlacement(mainAlignmentSide)];\n}\nfunction getExpandedPlacements(placement) {\n  const oppositePlacement = getOppositePlacement(placement);\n  return [getOppositeAlignmentPlacement(placement), oppositePlacement, getOppositeAlignmentPlacement(oppositePlacement)];\n}\nfunction getOppositeAlignmentPlacement(placement) {\n  return placement.replace(/start|end/g, alignment => oppositeAlignmentMap[alignment]);\n}\nfunction getSideList(side, isStart, rtl) {\n  const lr = ['left', 'right'];\n  const rl = ['right', 'left'];\n  const tb = ['top', 'bottom'];\n  const bt = ['bottom', 'top'];\n  switch (side) {\n    case 'top':\n    case 'bottom':\n      if (rtl) return isStart ? rl : lr;\n      return isStart ? lr : rl;\n    case 'left':\n    case 'right':\n      return isStart ? tb : bt;\n    default:\n      return [];\n  }\n}\nfunction getOppositeAxisPlacements(placement, flipAlignment, direction, rtl) {\n  const alignment = getAlignment(placement);\n  let list = getSideList(getSide(placement), direction === 'start', rtl);\n  if (alignment) {\n    list = list.map(side => side + \"-\" + alignment);\n    if (flipAlignment) {\n      list = list.concat(list.map(getOppositeAlignmentPlacement));\n    }\n  }\n  return list;\n}\nfunction getOppositePlacement(placement) {\n  return placement.replace(/left|right|bottom|top/g, side => oppositeSideMap[side]);\n}\nfunction expandPaddingObject(padding) {\n  return {\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    ...padding\n  };\n}\nfunction getPaddingObject(padding) {\n  return typeof padding !== 'number' ? expandPaddingObject(padding) : {\n    top: padding,\n    right: padding,\n    bottom: padding,\n    left: padding\n  };\n}\nfunction rectToClientRect(rect) {\n  const {\n    x,\n    y,\n    width,\n    height\n  } = rect;\n  return {\n    width,\n    height,\n    top: y,\n    left: x,\n    right: x + width,\n    bottom: y + height,\n    x,\n    y\n  };\n}\n\nexport { alignments, clamp, createCoords, evaluate, expandPaddingObject, floor, getAlignment, getAlignmentAxis, getAlignmentSides, getAxisLength, getExpandedPlacements, getOppositeAlignmentPlacement, getOppositeAxis, getOppositeAxisPlacements, getOppositePlacement, getPaddingObject, getSide, getSideAxis, max, min, placements, rectToClientRect, round, sides };\n","import { getSideAxis, getAlignmentAxis, getAxisLength, getSide, getAlignment, evaluate, getPaddingObject, rectToClientRect, min, clamp, placements, getAlignmentSides, getOppositeAlignmentPlacement, getOppositePlacement, getExpandedPlacements, getOppositeAxisPlacements, sides, max, getOppositeAxis } from '@floating-ui/utils';\nexport { rectToClientRect } from '@floating-ui/utils';\n\nfunction computeCoordsFromPlacement(_ref, placement, rtl) {\n  let {\n    reference,\n    floating\n  } = _ref;\n  const sideAxis = getSideAxis(placement);\n  const alignmentAxis = getAlignmentAxis(placement);\n  const alignLength = getAxisLength(alignmentAxis);\n  const side = getSide(placement);\n  const isVertical = sideAxis === 'y';\n  const commonX = reference.x + reference.width / 2 - floating.width / 2;\n  const commonY = reference.y + reference.height / 2 - floating.height / 2;\n  const commonAlign = reference[alignLength] / 2 - floating[alignLength] / 2;\n  let coords;\n  switch (side) {\n    case 'top':\n      coords = {\n        x: commonX,\n        y: reference.y - floating.height\n      };\n      break;\n    case 'bottom':\n      coords = {\n        x: commonX,\n        y: reference.y + reference.height\n      };\n      break;\n    case 'right':\n      coords = {\n        x: reference.x + reference.width,\n        y: commonY\n      };\n      break;\n    case 'left':\n      coords = {\n        x: reference.x - floating.width,\n        y: commonY\n      };\n      break;\n    default:\n      coords = {\n        x: reference.x,\n        y: reference.y\n      };\n  }\n  switch (getAlignment(placement)) {\n    case 'start':\n      coords[alignmentAxis] -= commonAlign * (rtl && isVertical ? -1 : 1);\n      break;\n    case 'end':\n      coords[alignmentAxis] += commonAlign * (rtl && isVertical ? -1 : 1);\n      break;\n  }\n  return coords;\n}\n\n/**\n * Computes the `x` and `y` coordinates that will place the floating element\n * next to a given reference element.\n *\n * This export does not have any `platform` interface logic. You will need to\n * write one for the platform you are using Floating UI with.\n */\nconst computePosition = async (reference, floating, config) => {\n  const {\n    placement = 'bottom',\n    strategy = 'absolute',\n    middleware = [],\n    platform\n  } = config;\n  const validMiddleware = middleware.filter(Boolean);\n  const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(floating));\n  let rects = await platform.getElementRects({\n    reference,\n    floating,\n    strategy\n  });\n  let {\n    x,\n    y\n  } = computeCoordsFromPlacement(rects, placement, rtl);\n  let statefulPlacement = placement;\n  let middlewareData = {};\n  let resetCount = 0;\n  for (let i = 0; i < validMiddleware.length; i++) {\n    const {\n      name,\n      fn\n    } = validMiddleware[i];\n    const {\n      x: nextX,\n      y: nextY,\n      data,\n      reset\n    } = await fn({\n      x,\n      y,\n      initialPlacement: placement,\n      placement: statefulPlacement,\n      strategy,\n      middlewareData,\n      rects,\n      platform,\n      elements: {\n        reference,\n        floating\n      }\n    });\n    x = nextX != null ? nextX : x;\n    y = nextY != null ? nextY : y;\n    middlewareData = {\n      ...middlewareData,\n      [name]: {\n        ...middlewareData[name],\n        ...data\n      }\n    };\n    if (reset && resetCount <= 50) {\n      resetCount++;\n      if (typeof reset === 'object') {\n        if (reset.placement) {\n          statefulPlacement = reset.placement;\n        }\n        if (reset.rects) {\n          rects = reset.rects === true ? await platform.getElementRects({\n            reference,\n            floating,\n            strategy\n          }) : reset.rects;\n        }\n        ({\n          x,\n          y\n        } = computeCoordsFromPlacement(rects, statefulPlacement, rtl));\n      }\n      i = -1;\n    }\n  }\n  return {\n    x,\n    y,\n    placement: statefulPlacement,\n    strategy,\n    middlewareData\n  };\n};\n\n/**\n * Resolves with an object of overflow side offsets that determine how much the\n * element is overflowing a given clipping boundary on each side.\n * - positive = overflowing the boundary by that number of pixels\n * - negative = how many pixels left before it will overflow\n * - 0 = lies flush with the boundary\n * @see https://floating-ui.com/docs/detectOverflow\n */\nasync function detectOverflow(state, options) {\n  var _await$platform$isEle;\n  if (options === void 0) {\n    options = {};\n  }\n  const {\n    x,\n    y,\n    platform,\n    rects,\n    elements,\n    strategy\n  } = state;\n  const {\n    boundary = 'clippingAncestors',\n    rootBoundary = 'viewport',\n    elementContext = 'floating',\n    altBoundary = false,\n    padding = 0\n  } = evaluate(options, state);\n  const paddingObject = getPaddingObject(padding);\n  const altContext = elementContext === 'floating' ? 'reference' : 'floating';\n  const element = elements[altBoundary ? altContext : elementContext];\n  const clippingClientRect = rectToClientRect(await platform.getClippingRect({\n    element: ((_await$platform$isEle = await (platform.isElement == null ? void 0 : platform.isElement(element))) != null ? _await$platform$isEle : true) ? element : element.contextElement || (await (platform.getDocumentElement == null ? void 0 : platform.getDocumentElement(elements.floating))),\n    boundary,\n    rootBoundary,\n    strategy\n  }));\n  const rect = elementContext === 'floating' ? {\n    x,\n    y,\n    width: rects.floating.width,\n    height: rects.floating.height\n  } : rects.reference;\n  const offsetParent = await (platform.getOffsetParent == null ? void 0 : platform.getOffsetParent(elements.floating));\n  const offsetScale = (await (platform.isElement == null ? void 0 : platform.isElement(offsetParent))) ? (await (platform.getScale == null ? void 0 : platform.getScale(offsetParent))) || {\n    x: 1,\n    y: 1\n  } : {\n    x: 1,\n    y: 1\n  };\n  const elementClientRect = rectToClientRect(platform.convertOffsetParentRelativeRectToViewportRelativeRect ? await platform.convertOffsetParentRelativeRectToViewportRelativeRect({\n    elements,\n    rect,\n    offsetParent,\n    strategy\n  }) : rect);\n  return {\n    top: (clippingClientRect.top - elementClientRect.top + paddingObject.top) / offsetScale.y,\n    bottom: (elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom) / offsetScale.y,\n    left: (clippingClientRect.left - elementClientRect.left + paddingObject.left) / offsetScale.x,\n    right: (elementClientRect.right - clippingClientRect.right + paddingObject.right) / offsetScale.x\n  };\n}\n\n/**\n * Provides data to position an inner element of the floating element so that it\n * appears centered to the reference element.\n * @see https://floating-ui.com/docs/arrow\n */\nconst arrow = options => ({\n  name: 'arrow',\n  options,\n  async fn(state) {\n    const {\n      x,\n      y,\n      placement,\n      rects,\n      platform,\n      elements,\n      middlewareData\n    } = state;\n    // Since `element` is required, we don't Partial<> the type.\n    const {\n      element,\n      padding = 0\n    } = evaluate(options, state) || {};\n    if (element == null) {\n      return {};\n    }\n    const paddingObject = getPaddingObject(padding);\n    const coords = {\n      x,\n      y\n    };\n    const axis = getAlignmentAxis(placement);\n    const length = getAxisLength(axis);\n    const arrowDimensions = await platform.getDimensions(element);\n    const isYAxis = axis === 'y';\n    const minProp = isYAxis ? 'top' : 'left';\n    const maxProp = isYAxis ? 'bottom' : 'right';\n    const clientProp = isYAxis ? 'clientHeight' : 'clientWidth';\n    const endDiff = rects.reference[length] + rects.reference[axis] - coords[axis] - rects.floating[length];\n    const startDiff = coords[axis] - rects.reference[axis];\n    const arrowOffsetParent = await (platform.getOffsetParent == null ? void 0 : platform.getOffsetParent(element));\n    let clientSize = arrowOffsetParent ? arrowOffsetParent[clientProp] : 0;\n\n    // DOM platform can return `window` as the `offsetParent`.\n    if (!clientSize || !(await (platform.isElement == null ? void 0 : platform.isElement(arrowOffsetParent)))) {\n      clientSize = elements.floating[clientProp] || rects.floating[length];\n    }\n    const centerToReference = endDiff / 2 - startDiff / 2;\n\n    // If the padding is large enough that it causes the arrow to no longer be\n    // centered, modify the padding so that it is centered.\n    const largestPossiblePadding = clientSize / 2 - arrowDimensions[length] / 2 - 1;\n    const minPadding = min(paddingObject[minProp], largestPossiblePadding);\n    const maxPadding = min(paddingObject[maxProp], largestPossiblePadding);\n\n    // Make sure the arrow doesn't overflow the floating element if the center\n    // point is outside the floating element's bounds.\n    const min$1 = minPadding;\n    const max = clientSize - arrowDimensions[length] - maxPadding;\n    const center = clientSize / 2 - arrowDimensions[length] / 2 + centerToReference;\n    const offset = clamp(min$1, center, max);\n\n    // If the reference is small enough that the arrow's padding causes it to\n    // to point to nothing for an aligned placement, adjust the offset of the\n    // floating element itself. To ensure `shift()` continues to take action,\n    // a single reset is performed when this is true.\n    const shouldAddOffset = !middlewareData.arrow && getAlignment(placement) != null && center !== offset && rects.reference[length] / 2 - (center < min$1 ? minPadding : maxPadding) - arrowDimensions[length] / 2 < 0;\n    const alignmentOffset = shouldAddOffset ? center < min$1 ? center - min$1 : center - max : 0;\n    return {\n      [axis]: coords[axis] + alignmentOffset,\n      data: {\n        [axis]: offset,\n        centerOffset: center - offset - alignmentOffset,\n        ...(shouldAddOffset && {\n          alignmentOffset\n        })\n      },\n      reset: shouldAddOffset\n    };\n  }\n});\n\nfunction getPlacementList(alignment, autoAlignment, allowedPlacements) {\n  const allowedPlacementsSortedByAlignment = alignment ? [...allowedPlacements.filter(placement => getAlignment(placement) === alignment), ...allowedPlacements.filter(placement => getAlignment(placement) !== alignment)] : allowedPlacements.filter(placement => getSide(placement) === placement);\n  return allowedPlacementsSortedByAlignment.filter(placement => {\n    if (alignment) {\n      return getAlignment(placement) === alignment || (autoAlignment ? getOppositeAlignmentPlacement(placement) !== placement : false);\n    }\n    return true;\n  });\n}\n/**\n * Optimizes the visibility of the floating element by choosing the placement\n * that has the most space available automatically, without needing to specify a\n * preferred placement. Alternative to `flip`.\n * @see https://floating-ui.com/docs/autoPlacement\n */\nconst autoPlacement = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'autoPlacement',\n    options,\n    async fn(state) {\n      var _middlewareData$autoP, _middlewareData$autoP2, _placementsThatFitOnE;\n      const {\n        rects,\n        middlewareData,\n        placement,\n        platform,\n        elements\n      } = state;\n      const {\n        crossAxis = false,\n        alignment,\n        allowedPlacements = placements,\n        autoAlignment = true,\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      const placements$1 = alignment !== undefined || allowedPlacements === placements ? getPlacementList(alignment || null, autoAlignment, allowedPlacements) : allowedPlacements;\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const currentIndex = ((_middlewareData$autoP = middlewareData.autoPlacement) == null ? void 0 : _middlewareData$autoP.index) || 0;\n      const currentPlacement = placements$1[currentIndex];\n      if (currentPlacement == null) {\n        return {};\n      }\n      const alignmentSides = getAlignmentSides(currentPlacement, rects, await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating)));\n\n      // Make `computeCoords` start from the right place.\n      if (placement !== currentPlacement) {\n        return {\n          reset: {\n            placement: placements$1[0]\n          }\n        };\n      }\n      const currentOverflows = [overflow[getSide(currentPlacement)], overflow[alignmentSides[0]], overflow[alignmentSides[1]]];\n      const allOverflows = [...(((_middlewareData$autoP2 = middlewareData.autoPlacement) == null ? void 0 : _middlewareData$autoP2.overflows) || []), {\n        placement: currentPlacement,\n        overflows: currentOverflows\n      }];\n      const nextPlacement = placements$1[currentIndex + 1];\n\n      // There are more placements to check.\n      if (nextPlacement) {\n        return {\n          data: {\n            index: currentIndex + 1,\n            overflows: allOverflows\n          },\n          reset: {\n            placement: nextPlacement\n          }\n        };\n      }\n      const placementsSortedByMostSpace = allOverflows.map(d => {\n        const alignment = getAlignment(d.placement);\n        return [d.placement, alignment && crossAxis ?\n        // Check along the mainAxis and main crossAxis side.\n        d.overflows.slice(0, 2).reduce((acc, v) => acc + v, 0) :\n        // Check only the mainAxis.\n        d.overflows[0], d.overflows];\n      }).sort((a, b) => a[1] - b[1]);\n      const placementsThatFitOnEachSide = placementsSortedByMostSpace.filter(d => d[2].slice(0,\n      // Aligned placements should not check their opposite crossAxis\n      // side.\n      getAlignment(d[0]) ? 2 : 3).every(v => v <= 0));\n      const resetPlacement = ((_placementsThatFitOnE = placementsThatFitOnEachSide[0]) == null ? void 0 : _placementsThatFitOnE[0]) || placementsSortedByMostSpace[0][0];\n      if (resetPlacement !== placement) {\n        return {\n          data: {\n            index: currentIndex + 1,\n            overflows: allOverflows\n          },\n          reset: {\n            placement: resetPlacement\n          }\n        };\n      }\n      return {};\n    }\n  };\n};\n\n/**\n * Optimizes the visibility of the floating element by flipping the `placement`\n * in order to keep it in view when the preferred placement(s) will overflow the\n * clipping boundary. Alternative to `autoPlacement`.\n * @see https://floating-ui.com/docs/flip\n */\nconst flip = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'flip',\n    options,\n    async fn(state) {\n      var _middlewareData$arrow, _middlewareData$flip;\n      const {\n        placement,\n        middlewareData,\n        rects,\n        initialPlacement,\n        platform,\n        elements\n      } = state;\n      const {\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = true,\n        fallbackPlacements: specifiedFallbackPlacements,\n        fallbackStrategy = 'bestFit',\n        fallbackAxisSideDirection = 'none',\n        flipAlignment = true,\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n\n      // If a reset by the arrow was caused due to an alignment offset being\n      // added, we should skip any logic now since `flip()` has already done its\n      // work.\n      // https://github.com/floating-ui/floating-ui/issues/2549#issuecomment-1719601643\n      if ((_middlewareData$arrow = middlewareData.arrow) != null && _middlewareData$arrow.alignmentOffset) {\n        return {};\n      }\n      const side = getSide(placement);\n      const initialSideAxis = getSideAxis(initialPlacement);\n      const isBasePlacement = getSide(initialPlacement) === initialPlacement;\n      const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating));\n      const fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipAlignment ? [getOppositePlacement(initialPlacement)] : getExpandedPlacements(initialPlacement));\n      const hasFallbackAxisSideDirection = fallbackAxisSideDirection !== 'none';\n      if (!specifiedFallbackPlacements && hasFallbackAxisSideDirection) {\n        fallbackPlacements.push(...getOppositeAxisPlacements(initialPlacement, flipAlignment, fallbackAxisSideDirection, rtl));\n      }\n      const placements = [initialPlacement, ...fallbackPlacements];\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const overflows = [];\n      let overflowsData = ((_middlewareData$flip = middlewareData.flip) == null ? void 0 : _middlewareData$flip.overflows) || [];\n      if (checkMainAxis) {\n        overflows.push(overflow[side]);\n      }\n      if (checkCrossAxis) {\n        const sides = getAlignmentSides(placement, rects, rtl);\n        overflows.push(overflow[sides[0]], overflow[sides[1]]);\n      }\n      overflowsData = [...overflowsData, {\n        placement,\n        overflows\n      }];\n\n      // One or more sides is overflowing.\n      if (!overflows.every(side => side <= 0)) {\n        var _middlewareData$flip2, _overflowsData$filter;\n        const nextIndex = (((_middlewareData$flip2 = middlewareData.flip) == null ? void 0 : _middlewareData$flip2.index) || 0) + 1;\n        const nextPlacement = placements[nextIndex];\n        if (nextPlacement) {\n          // Try next placement and re-run the lifecycle.\n          return {\n            data: {\n              index: nextIndex,\n              overflows: overflowsData\n            },\n            reset: {\n              placement: nextPlacement\n            }\n          };\n        }\n\n        // First, find the candidates that fit on the mainAxis side of overflow,\n        // then find the placement that fits the best on the main crossAxis side.\n        let resetPlacement = (_overflowsData$filter = overflowsData.filter(d => d.overflows[0] <= 0).sort((a, b) => a.overflows[1] - b.overflows[1])[0]) == null ? void 0 : _overflowsData$filter.placement;\n\n        // Otherwise fallback.\n        if (!resetPlacement) {\n          switch (fallbackStrategy) {\n            case 'bestFit':\n              {\n                var _overflowsData$filter2;\n                const placement = (_overflowsData$filter2 = overflowsData.filter(d => {\n                  if (hasFallbackAxisSideDirection) {\n                    const currentSideAxis = getSideAxis(d.placement);\n                    return currentSideAxis === initialSideAxis ||\n                    // Create a bias to the `y` side axis due to horizontal\n                    // reading directions favoring greater width.\n                    currentSideAxis === 'y';\n                  }\n                  return true;\n                }).map(d => [d.placement, d.overflows.filter(overflow => overflow > 0).reduce((acc, overflow) => acc + overflow, 0)]).sort((a, b) => a[1] - b[1])[0]) == null ? void 0 : _overflowsData$filter2[0];\n                if (placement) {\n                  resetPlacement = placement;\n                }\n                break;\n              }\n            case 'initialPlacement':\n              resetPlacement = initialPlacement;\n              break;\n          }\n        }\n        if (placement !== resetPlacement) {\n          return {\n            reset: {\n              placement: resetPlacement\n            }\n          };\n        }\n      }\n      return {};\n    }\n  };\n};\n\nfunction getSideOffsets(overflow, rect) {\n  return {\n    top: overflow.top - rect.height,\n    right: overflow.right - rect.width,\n    bottom: overflow.bottom - rect.height,\n    left: overflow.left - rect.width\n  };\n}\nfunction isAnySideFullyClipped(overflow) {\n  return sides.some(side => overflow[side] >= 0);\n}\n/**\n * Provides data to hide the floating element in applicable situations, such as\n * when it is not in the same clipping context as the reference element.\n * @see https://floating-ui.com/docs/hide\n */\nconst hide = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'hide',\n    options,\n    async fn(state) {\n      const {\n        rects\n      } = state;\n      const {\n        strategy = 'referenceHidden',\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      switch (strategy) {\n        case 'referenceHidden':\n          {\n            const overflow = await detectOverflow(state, {\n              ...detectOverflowOptions,\n              elementContext: 'reference'\n            });\n            const offsets = getSideOffsets(overflow, rects.reference);\n            return {\n              data: {\n                referenceHiddenOffsets: offsets,\n                referenceHidden: isAnySideFullyClipped(offsets)\n              }\n            };\n          }\n        case 'escaped':\n          {\n            const overflow = await detectOverflow(state, {\n              ...detectOverflowOptions,\n              altBoundary: true\n            });\n            const offsets = getSideOffsets(overflow, rects.floating);\n            return {\n              data: {\n                escapedOffsets: offsets,\n                escaped: isAnySideFullyClipped(offsets)\n              }\n            };\n          }\n        default:\n          {\n            return {};\n          }\n      }\n    }\n  };\n};\n\nfunction getBoundingRect(rects) {\n  const minX = min(...rects.map(rect => rect.left));\n  const minY = min(...rects.map(rect => rect.top));\n  const maxX = max(...rects.map(rect => rect.right));\n  const maxY = max(...rects.map(rect => rect.bottom));\n  return {\n    x: minX,\n    y: minY,\n    width: maxX - minX,\n    height: maxY - minY\n  };\n}\nfunction getRectsByLine(rects) {\n  const sortedRects = rects.slice().sort((a, b) => a.y - b.y);\n  const groups = [];\n  let prevRect = null;\n  for (let i = 0; i < sortedRects.length; i++) {\n    const rect = sortedRects[i];\n    if (!prevRect || rect.y - prevRect.y > prevRect.height / 2) {\n      groups.push([rect]);\n    } else {\n      groups[groups.length - 1].push(rect);\n    }\n    prevRect = rect;\n  }\n  return groups.map(rect => rectToClientRect(getBoundingRect(rect)));\n}\n/**\n * Provides improved positioning for inline reference elements that can span\n * over multiple lines, such as hyperlinks or range selections.\n * @see https://floating-ui.com/docs/inline\n */\nconst inline = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'inline',\n    options,\n    async fn(state) {\n      const {\n        placement,\n        elements,\n        rects,\n        platform,\n        strategy\n      } = state;\n      // A MouseEvent's client{X,Y} coords can be up to 2 pixels off a\n      // ClientRect's bounds, despite the event listener being triggered. A\n      // padding of 2 seems to handle this issue.\n      const {\n        padding = 2,\n        x,\n        y\n      } = evaluate(options, state);\n      const nativeClientRects = Array.from((await (platform.getClientRects == null ? void 0 : platform.getClientRects(elements.reference))) || []);\n      const clientRects = getRectsByLine(nativeClientRects);\n      const fallback = rectToClientRect(getBoundingRect(nativeClientRects));\n      const paddingObject = getPaddingObject(padding);\n      function getBoundingClientRect() {\n        // There are two rects and they are disjoined.\n        if (clientRects.length === 2 && clientRects[0].left > clientRects[1].right && x != null && y != null) {\n          // Find the first rect in which the point is fully inside.\n          return clientRects.find(rect => x > rect.left - paddingObject.left && x < rect.right + paddingObject.right && y > rect.top - paddingObject.top && y < rect.bottom + paddingObject.bottom) || fallback;\n        }\n\n        // There are 2 or more connected rects.\n        if (clientRects.length >= 2) {\n          if (getSideAxis(placement) === 'y') {\n            const firstRect = clientRects[0];\n            const lastRect = clientRects[clientRects.length - 1];\n            const isTop = getSide(placement) === 'top';\n            const top = firstRect.top;\n            const bottom = lastRect.bottom;\n            const left = isTop ? firstRect.left : lastRect.left;\n            const right = isTop ? firstRect.right : lastRect.right;\n            const width = right - left;\n            const height = bottom - top;\n            return {\n              top,\n              bottom,\n              left,\n              right,\n              width,\n              height,\n              x: left,\n              y: top\n            };\n          }\n          const isLeftSide = getSide(placement) === 'left';\n          const maxRight = max(...clientRects.map(rect => rect.right));\n          const minLeft = min(...clientRects.map(rect => rect.left));\n          const measureRects = clientRects.filter(rect => isLeftSide ? rect.left === minLeft : rect.right === maxRight);\n          const top = measureRects[0].top;\n          const bottom = measureRects[measureRects.length - 1].bottom;\n          const left = minLeft;\n          const right = maxRight;\n          const width = right - left;\n          const height = bottom - top;\n          return {\n            top,\n            bottom,\n            left,\n            right,\n            width,\n            height,\n            x: left,\n            y: top\n          };\n        }\n        return fallback;\n      }\n      const resetRects = await platform.getElementRects({\n        reference: {\n          getBoundingClientRect\n        },\n        floating: elements.floating,\n        strategy\n      });\n      if (rects.reference.x !== resetRects.reference.x || rects.reference.y !== resetRects.reference.y || rects.reference.width !== resetRects.reference.width || rects.reference.height !== resetRects.reference.height) {\n        return {\n          reset: {\n            rects: resetRects\n          }\n        };\n      }\n      return {};\n    }\n  };\n};\n\n// For type backwards-compatibility, the `OffsetOptions` type was also\n// Derivable.\n\nasync function convertValueToCoords(state, options) {\n  const {\n    placement,\n    platform,\n    elements\n  } = state;\n  const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating));\n  const side = getSide(placement);\n  const alignment = getAlignment(placement);\n  const isVertical = getSideAxis(placement) === 'y';\n  const mainAxisMulti = ['left', 'top'].includes(side) ? -1 : 1;\n  const crossAxisMulti = rtl && isVertical ? -1 : 1;\n  const rawValue = evaluate(options, state);\n\n  // eslint-disable-next-line prefer-const\n  let {\n    mainAxis,\n    crossAxis,\n    alignmentAxis\n  } = typeof rawValue === 'number' ? {\n    mainAxis: rawValue,\n    crossAxis: 0,\n    alignmentAxis: null\n  } : {\n    mainAxis: 0,\n    crossAxis: 0,\n    alignmentAxis: null,\n    ...rawValue\n  };\n  if (alignment && typeof alignmentAxis === 'number') {\n    crossAxis = alignment === 'end' ? alignmentAxis * -1 : alignmentAxis;\n  }\n  return isVertical ? {\n    x: crossAxis * crossAxisMulti,\n    y: mainAxis * mainAxisMulti\n  } : {\n    x: mainAxis * mainAxisMulti,\n    y: crossAxis * crossAxisMulti\n  };\n}\n\n/**\n * Modifies the placement by translating the floating element along the\n * specified axes.\n * A number (shorthand for `mainAxis` or distance), or an axes configuration\n * object may be passed.\n * @see https://floating-ui.com/docs/offset\n */\nconst offset = function (options) {\n  if (options === void 0) {\n    options = 0;\n  }\n  return {\n    name: 'offset',\n    options,\n    async fn(state) {\n      var _middlewareData$offse, _middlewareData$arrow;\n      const {\n        x,\n        y,\n        placement,\n        middlewareData\n      } = state;\n      const diffCoords = await convertValueToCoords(state, options);\n\n      // If the placement is the same and the arrow caused an alignment offset\n      // then we don't need to change the positioning coordinates.\n      if (placement === ((_middlewareData$offse = middlewareData.offset) == null ? void 0 : _middlewareData$offse.placement) && (_middlewareData$arrow = middlewareData.arrow) != null && _middlewareData$arrow.alignmentOffset) {\n        return {};\n      }\n      return {\n        x: x + diffCoords.x,\n        y: y + diffCoords.y,\n        data: {\n          ...diffCoords,\n          placement\n        }\n      };\n    }\n  };\n};\n\n/**\n * Optimizes the visibility of the floating element by shifting it in order to\n * keep it in view when it will overflow the clipping boundary.\n * @see https://floating-ui.com/docs/shift\n */\nconst shift = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'shift',\n    options,\n    async fn(state) {\n      const {\n        x,\n        y,\n        placement\n      } = state;\n      const {\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = false,\n        limiter = {\n          fn: _ref => {\n            let {\n              x,\n              y\n            } = _ref;\n            return {\n              x,\n              y\n            };\n          }\n        },\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      const coords = {\n        x,\n        y\n      };\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const crossAxis = getSideAxis(getSide(placement));\n      const mainAxis = getOppositeAxis(crossAxis);\n      let mainAxisCoord = coords[mainAxis];\n      let crossAxisCoord = coords[crossAxis];\n      if (checkMainAxis) {\n        const minSide = mainAxis === 'y' ? 'top' : 'left';\n        const maxSide = mainAxis === 'y' ? 'bottom' : 'right';\n        const min = mainAxisCoord + overflow[minSide];\n        const max = mainAxisCoord - overflow[maxSide];\n        mainAxisCoord = clamp(min, mainAxisCoord, max);\n      }\n      if (checkCrossAxis) {\n        const minSide = crossAxis === 'y' ? 'top' : 'left';\n        const maxSide = crossAxis === 'y' ? 'bottom' : 'right';\n        const min = crossAxisCoord + overflow[minSide];\n        const max = crossAxisCoord - overflow[maxSide];\n        crossAxisCoord = clamp(min, crossAxisCoord, max);\n      }\n      const limitedCoords = limiter.fn({\n        ...state,\n        [mainAxis]: mainAxisCoord,\n        [crossAxis]: crossAxisCoord\n      });\n      return {\n        ...limitedCoords,\n        data: {\n          x: limitedCoords.x - x,\n          y: limitedCoords.y - y\n        }\n      };\n    }\n  };\n};\n/**\n * Built-in `limiter` that will stop `shift()` at a certain point.\n */\nconst limitShift = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    options,\n    fn(state) {\n      const {\n        x,\n        y,\n        placement,\n        rects,\n        middlewareData\n      } = state;\n      const {\n        offset = 0,\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = true\n      } = evaluate(options, state);\n      const coords = {\n        x,\n        y\n      };\n      const crossAxis = getSideAxis(placement);\n      const mainAxis = getOppositeAxis(crossAxis);\n      let mainAxisCoord = coords[mainAxis];\n      let crossAxisCoord = coords[crossAxis];\n      const rawOffset = evaluate(offset, state);\n      const computedOffset = typeof rawOffset === 'number' ? {\n        mainAxis: rawOffset,\n        crossAxis: 0\n      } : {\n        mainAxis: 0,\n        crossAxis: 0,\n        ...rawOffset\n      };\n      if (checkMainAxis) {\n        const len = mainAxis === 'y' ? 'height' : 'width';\n        const limitMin = rects.reference[mainAxis] - rects.floating[len] + computedOffset.mainAxis;\n        const limitMax = rects.reference[mainAxis] + rects.reference[len] - computedOffset.mainAxis;\n        if (mainAxisCoord < limitMin) {\n          mainAxisCoord = limitMin;\n        } else if (mainAxisCoord > limitMax) {\n          mainAxisCoord = limitMax;\n        }\n      }\n      if (checkCrossAxis) {\n        var _middlewareData$offse, _middlewareData$offse2;\n        const len = mainAxis === 'y' ? 'width' : 'height';\n        const isOriginSide = ['top', 'left'].includes(getSide(placement));\n        const limitMin = rects.reference[crossAxis] - rects.floating[len] + (isOriginSide ? ((_middlewareData$offse = middlewareData.offset) == null ? void 0 : _middlewareData$offse[crossAxis]) || 0 : 0) + (isOriginSide ? 0 : computedOffset.crossAxis);\n        const limitMax = rects.reference[crossAxis] + rects.reference[len] + (isOriginSide ? 0 : ((_middlewareData$offse2 = middlewareData.offset) == null ? void 0 : _middlewareData$offse2[crossAxis]) || 0) - (isOriginSide ? computedOffset.crossAxis : 0);\n        if (crossAxisCoord < limitMin) {\n          crossAxisCoord = limitMin;\n        } else if (crossAxisCoord > limitMax) {\n          crossAxisCoord = limitMax;\n        }\n      }\n      return {\n        [mainAxis]: mainAxisCoord,\n        [crossAxis]: crossAxisCoord\n      };\n    }\n  };\n};\n\n/**\n * Provides data that allows you to change the size of the floating element \n * for instance, prevent it from overflowing the clipping boundary or match the\n * width of the reference element.\n * @see https://floating-ui.com/docs/size\n */\nconst size = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'size',\n    options,\n    async fn(state) {\n      const {\n        placement,\n        rects,\n        platform,\n        elements\n      } = state;\n      const {\n        apply = () => {},\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const side = getSide(placement);\n      const alignment = getAlignment(placement);\n      const isYAxis = getSideAxis(placement) === 'y';\n      const {\n        width,\n        height\n      } = rects.floating;\n      let heightSide;\n      let widthSide;\n      if (side === 'top' || side === 'bottom') {\n        heightSide = side;\n        widthSide = alignment === ((await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating))) ? 'start' : 'end') ? 'left' : 'right';\n      } else {\n        widthSide = side;\n        heightSide = alignment === 'end' ? 'top' : 'bottom';\n      }\n      const maximumClippingHeight = height - overflow.top - overflow.bottom;\n      const maximumClippingWidth = width - overflow.left - overflow.right;\n      const overflowAvailableHeight = min(height - overflow[heightSide], maximumClippingHeight);\n      const overflowAvailableWidth = min(width - overflow[widthSide], maximumClippingWidth);\n      const noShift = !state.middlewareData.shift;\n      let availableHeight = overflowAvailableHeight;\n      let availableWidth = overflowAvailableWidth;\n      if (isYAxis) {\n        availableWidth = alignment || noShift ? min(overflowAvailableWidth, maximumClippingWidth) : maximumClippingWidth;\n      } else {\n        availableHeight = alignment || noShift ? min(overflowAvailableHeight, maximumClippingHeight) : maximumClippingHeight;\n      }\n      if (noShift && !alignment) {\n        const xMin = max(overflow.left, 0);\n        const xMax = max(overflow.right, 0);\n        const yMin = max(overflow.top, 0);\n        const yMax = max(overflow.bottom, 0);\n        if (isYAxis) {\n          availableWidth = width - 2 * (xMin !== 0 || xMax !== 0 ? xMin + xMax : max(overflow.left, overflow.right));\n        } else {\n          availableHeight = height - 2 * (yMin !== 0 || yMax !== 0 ? yMin + yMax : max(overflow.top, overflow.bottom));\n        }\n      }\n      await apply({\n        ...state,\n        availableWidth,\n        availableHeight\n      });\n      const nextDimensions = await platform.getDimensions(elements.floating);\n      if (width !== nextDimensions.width || height !== nextDimensions.height) {\n        return {\n          reset: {\n            rects: true\n          }\n        };\n      }\n      return {};\n    }\n  };\n};\n\nexport { arrow, autoPlacement, computePosition, detectOverflow, flip, hide, inline, limitShift, offset, shift, size };\n","function getNodeName(node) {\n  if (isNode(node)) {\n    return (node.nodeName || '').toLowerCase();\n  }\n  // Mocked nodes in testing environments may not be instances of Node. By\n  // returning `#document` an infinite loop won't occur.\n  // https://github.com/floating-ui/floating-ui/issues/2317\n  return '#document';\n}\nfunction getWindow(node) {\n  var _node$ownerDocument;\n  return (node == null || (_node$ownerDocument = node.ownerDocument) == null ? void 0 : _node$ownerDocument.defaultView) || window;\n}\nfunction getDocumentElement(node) {\n  var _ref;\n  return (_ref = (isNode(node) ? node.ownerDocument : node.document) || window.document) == null ? void 0 : _ref.documentElement;\n}\nfunction isNode(value) {\n  return value instanceof Node || value instanceof getWindow(value).Node;\n}\nfunction isElement(value) {\n  return value instanceof Element || value instanceof getWindow(value).Element;\n}\nfunction isHTMLElement(value) {\n  return value instanceof HTMLElement || value instanceof getWindow(value).HTMLElement;\n}\nfunction isShadowRoot(value) {\n  // Browsers without `ShadowRoot` support.\n  if (typeof ShadowRoot === 'undefined') {\n    return false;\n  }\n  return value instanceof ShadowRoot || value instanceof getWindow(value).ShadowRoot;\n}\nfunction isOverflowElement(element) {\n  const {\n    overflow,\n    overflowX,\n    overflowY,\n    display\n  } = getComputedStyle(element);\n  return /auto|scroll|overlay|hidden|clip/.test(overflow + overflowY + overflowX) && !['inline', 'contents'].includes(display);\n}\nfunction isTableElement(element) {\n  return ['table', 'td', 'th'].includes(getNodeName(element));\n}\nfunction isTopLayer(element) {\n  return [':popover-open', ':modal'].some(selector => {\n    try {\n      return element.matches(selector);\n    } catch (e) {\n      return false;\n    }\n  });\n}\nfunction isContainingBlock(element) {\n  const webkit = isWebKit();\n  const css = getComputedStyle(element);\n\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block\n  return css.transform !== 'none' || css.perspective !== 'none' || (css.containerType ? css.containerType !== 'normal' : false) || !webkit && (css.backdropFilter ? css.backdropFilter !== 'none' : false) || !webkit && (css.filter ? css.filter !== 'none' : false) || ['transform', 'perspective', 'filter'].some(value => (css.willChange || '').includes(value)) || ['paint', 'layout', 'strict', 'content'].some(value => (css.contain || '').includes(value));\n}\nfunction getContainingBlock(element) {\n  let currentNode = getParentNode(element);\n  while (isHTMLElement(currentNode) && !isLastTraversableNode(currentNode)) {\n    if (isTopLayer(currentNode)) {\n      return null;\n    }\n    if (isContainingBlock(currentNode)) {\n      return currentNode;\n    }\n    currentNode = getParentNode(currentNode);\n  }\n  return null;\n}\nfunction isWebKit() {\n  if (typeof CSS === 'undefined' || !CSS.supports) return false;\n  return CSS.supports('-webkit-backdrop-filter', 'none');\n}\nfunction isLastTraversableNode(node) {\n  return ['html', 'body', '#document'].includes(getNodeName(node));\n}\nfunction getComputedStyle(element) {\n  return getWindow(element).getComputedStyle(element);\n}\nfunction getNodeScroll(element) {\n  if (isElement(element)) {\n    return {\n      scrollLeft: element.scrollLeft,\n      scrollTop: element.scrollTop\n    };\n  }\n  return {\n    scrollLeft: element.pageXOffset,\n    scrollTop: element.pageYOffset\n  };\n}\nfunction getParentNode(node) {\n  if (getNodeName(node) === 'html') {\n    return node;\n  }\n  const result =\n  // Step into the shadow DOM of the parent of a slotted node.\n  node.assignedSlot ||\n  // DOM Element detected.\n  node.parentNode ||\n  // ShadowRoot detected.\n  isShadowRoot(node) && node.host ||\n  // Fallback.\n  getDocumentElement(node);\n  return isShadowRoot(result) ? result.host : result;\n}\nfunction getNearestOverflowAncestor(node) {\n  const parentNode = getParentNode(node);\n  if (isLastTraversableNode(parentNode)) {\n    return node.ownerDocument ? node.ownerDocument.body : node.body;\n  }\n  if (isHTMLElement(parentNode) && isOverflowElement(parentNode)) {\n    return parentNode;\n  }\n  return getNearestOverflowAncestor(parentNode);\n}\nfunction getOverflowAncestors(node, list, traverseIframes) {\n  var _node$ownerDocument2;\n  if (list === void 0) {\n    list = [];\n  }\n  if (traverseIframes === void 0) {\n    traverseIframes = true;\n  }\n  const scrollableAncestor = getNearestOverflowAncestor(node);\n  const isBody = scrollableAncestor === ((_node$ownerDocument2 = node.ownerDocument) == null ? void 0 : _node$ownerDocument2.body);\n  const win = getWindow(scrollableAncestor);\n  if (isBody) {\n    return list.concat(win, win.visualViewport || [], isOverflowElement(scrollableAncestor) ? scrollableAncestor : [], win.frameElement && traverseIframes ? getOverflowAncestors(win.frameElement) : []);\n  }\n  return list.concat(scrollableAncestor, getOverflowAncestors(scrollableAncestor, [], traverseIframes));\n}\n\nexport { getComputedStyle, getContainingBlock, getDocumentElement, getNearestOverflowAncestor, getNodeName, getNodeScroll, getOverflowAncestors, getParentNode, getWindow, isContainingBlock, isElement, isHTMLElement, isLastTraversableNode, isNode, isOverflowElement, isShadowRoot, isTableElement, isTopLayer, isWebKit };\n","import { rectToClientRect, detectOverflow as detectOverflow$1, offset as offset$1, autoPlacement as autoPlacement$1, shift as shift$1, flip as flip$1, size as size$1, hide as hide$1, arrow as arrow$1, inline as inline$1, limitShift as limitShift$1, computePosition as computePosition$1 } from '@floating-ui/core';\nimport { round, createCoords, max, min, floor } from '@floating-ui/utils';\nimport { getComputedStyle, isHTMLElement, isElement, getWindow, isWebKit, getDocumentElement, isTopLayer, getNodeName, isOverflowElement, getNodeScroll, getOverflowAncestors, getParentNode, isLastTraversableNode, isContainingBlock, isTableElement, getContainingBlock } from '@floating-ui/utils/dom';\nexport { getOverflowAncestors } from '@floating-ui/utils/dom';\n\nfunction getCssDimensions(element) {\n  const css = getComputedStyle(element);\n  // In testing environments, the `width` and `height` properties are empty\n  // strings for SVG elements, returning NaN. Fallback to `0` in this case.\n  let width = parseFloat(css.width) || 0;\n  let height = parseFloat(css.height) || 0;\n  const hasOffset = isHTMLElement(element);\n  const offsetWidth = hasOffset ? element.offsetWidth : width;\n  const offsetHeight = hasOffset ? element.offsetHeight : height;\n  const shouldFallback = round(width) !== offsetWidth || round(height) !== offsetHeight;\n  if (shouldFallback) {\n    width = offsetWidth;\n    height = offsetHeight;\n  }\n  return {\n    width,\n    height,\n    $: shouldFallback\n  };\n}\n\nfunction unwrapElement(element) {\n  return !isElement(element) ? element.contextElement : element;\n}\n\nfunction getScale(element) {\n  const domElement = unwrapElement(element);\n  if (!isHTMLElement(domElement)) {\n    return createCoords(1);\n  }\n  const rect = domElement.getBoundingClientRect();\n  const {\n    width,\n    height,\n    $\n  } = getCssDimensions(domElement);\n  let x = ($ ? round(rect.width) : rect.width) / width;\n  let y = ($ ? round(rect.height) : rect.height) / height;\n\n  // 0, NaN, or Infinity should always fallback to 1.\n\n  if (!x || !Number.isFinite(x)) {\n    x = 1;\n  }\n  if (!y || !Number.isFinite(y)) {\n    y = 1;\n  }\n  return {\n    x,\n    y\n  };\n}\n\nconst noOffsets = /*#__PURE__*/createCoords(0);\nfunction getVisualOffsets(element) {\n  const win = getWindow(element);\n  if (!isWebKit() || !win.visualViewport) {\n    return noOffsets;\n  }\n  return {\n    x: win.visualViewport.offsetLeft,\n    y: win.visualViewport.offsetTop\n  };\n}\nfunction shouldAddVisualOffsets(element, isFixed, floatingOffsetParent) {\n  if (isFixed === void 0) {\n    isFixed = false;\n  }\n  if (!floatingOffsetParent || isFixed && floatingOffsetParent !== getWindow(element)) {\n    return false;\n  }\n  return isFixed;\n}\n\nfunction getBoundingClientRect(element, includeScale, isFixedStrategy, offsetParent) {\n  if (includeScale === void 0) {\n    includeScale = false;\n  }\n  if (isFixedStrategy === void 0) {\n    isFixedStrategy = false;\n  }\n  const clientRect = element.getBoundingClientRect();\n  const domElement = unwrapElement(element);\n  let scale = createCoords(1);\n  if (includeScale) {\n    if (offsetParent) {\n      if (isElement(offsetParent)) {\n        scale = getScale(offsetParent);\n      }\n    } else {\n      scale = getScale(element);\n    }\n  }\n  const visualOffsets = shouldAddVisualOffsets(domElement, isFixedStrategy, offsetParent) ? getVisualOffsets(domElement) : createCoords(0);\n  let x = (clientRect.left + visualOffsets.x) / scale.x;\n  let y = (clientRect.top + visualOffsets.y) / scale.y;\n  let width = clientRect.width / scale.x;\n  let height = clientRect.height / scale.y;\n  if (domElement) {\n    const win = getWindow(domElement);\n    const offsetWin = offsetParent && isElement(offsetParent) ? getWindow(offsetParent) : offsetParent;\n    let currentWin = win;\n    let currentIFrame = currentWin.frameElement;\n    while (currentIFrame && offsetParent && offsetWin !== currentWin) {\n      const iframeScale = getScale(currentIFrame);\n      const iframeRect = currentIFrame.getBoundingClientRect();\n      const css = getComputedStyle(currentIFrame);\n      const left = iframeRect.left + (currentIFrame.clientLeft + parseFloat(css.paddingLeft)) * iframeScale.x;\n      const top = iframeRect.top + (currentIFrame.clientTop + parseFloat(css.paddingTop)) * iframeScale.y;\n      x *= iframeScale.x;\n      y *= iframeScale.y;\n      width *= iframeScale.x;\n      height *= iframeScale.y;\n      x += left;\n      y += top;\n      currentWin = getWindow(currentIFrame);\n      currentIFrame = currentWin.frameElement;\n    }\n  }\n  return rectToClientRect({\n    width,\n    height,\n    x,\n    y\n  });\n}\n\nfunction convertOffsetParentRelativeRectToViewportRelativeRect(_ref) {\n  let {\n    elements,\n    rect,\n    offsetParent,\n    strategy\n  } = _ref;\n  const isFixed = strategy === 'fixed';\n  const documentElement = getDocumentElement(offsetParent);\n  const topLayer = elements ? isTopLayer(elements.floating) : false;\n  if (offsetParent === documentElement || topLayer && isFixed) {\n    return rect;\n  }\n  let scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  let scale = createCoords(1);\n  const offsets = createCoords(0);\n  const isOffsetParentAnElement = isHTMLElement(offsetParent);\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {\n    if (getNodeName(offsetParent) !== 'body' || isOverflowElement(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n    if (isHTMLElement(offsetParent)) {\n      const offsetRect = getBoundingClientRect(offsetParent);\n      scale = getScale(offsetParent);\n      offsets.x = offsetRect.x + offsetParent.clientLeft;\n      offsets.y = offsetRect.y + offsetParent.clientTop;\n    }\n  }\n  return {\n    width: rect.width * scale.x,\n    height: rect.height * scale.y,\n    x: rect.x * scale.x - scroll.scrollLeft * scale.x + offsets.x,\n    y: rect.y * scale.y - scroll.scrollTop * scale.y + offsets.y\n  };\n}\n\nfunction getClientRects(element) {\n  return Array.from(element.getClientRects());\n}\n\nfunction getWindowScrollBarX(element) {\n  // If <html> has a CSS width greater than the viewport, then this will be\n  // incorrect for RTL.\n  return getBoundingClientRect(getDocumentElement(element)).left + getNodeScroll(element).scrollLeft;\n}\n\n// Gets the entire size of the scrollable document area, even extending outside\n// of the `<html>` and `<body>` rect bounds if horizontally scrollable.\nfunction getDocumentRect(element) {\n  const html = getDocumentElement(element);\n  const scroll = getNodeScroll(element);\n  const body = element.ownerDocument.body;\n  const width = max(html.scrollWidth, html.clientWidth, body.scrollWidth, body.clientWidth);\n  const height = max(html.scrollHeight, html.clientHeight, body.scrollHeight, body.clientHeight);\n  let x = -scroll.scrollLeft + getWindowScrollBarX(element);\n  const y = -scroll.scrollTop;\n  if (getComputedStyle(body).direction === 'rtl') {\n    x += max(html.clientWidth, body.clientWidth) - width;\n  }\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\n\nfunction getViewportRect(element, strategy) {\n  const win = getWindow(element);\n  const html = getDocumentElement(element);\n  const visualViewport = win.visualViewport;\n  let width = html.clientWidth;\n  let height = html.clientHeight;\n  let x = 0;\n  let y = 0;\n  if (visualViewport) {\n    width = visualViewport.width;\n    height = visualViewport.height;\n    const visualViewportBased = isWebKit();\n    if (!visualViewportBased || visualViewportBased && strategy === 'fixed') {\n      x = visualViewport.offsetLeft;\n      y = visualViewport.offsetTop;\n    }\n  }\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\n\n// Returns the inner client rect, subtracting scrollbars if present.\nfunction getInnerBoundingClientRect(element, strategy) {\n  const clientRect = getBoundingClientRect(element, true, strategy === 'fixed');\n  const top = clientRect.top + element.clientTop;\n  const left = clientRect.left + element.clientLeft;\n  const scale = isHTMLElement(element) ? getScale(element) : createCoords(1);\n  const width = element.clientWidth * scale.x;\n  const height = element.clientHeight * scale.y;\n  const x = left * scale.x;\n  const y = top * scale.y;\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\nfunction getClientRectFromClippingAncestor(element, clippingAncestor, strategy) {\n  let rect;\n  if (clippingAncestor === 'viewport') {\n    rect = getViewportRect(element, strategy);\n  } else if (clippingAncestor === 'document') {\n    rect = getDocumentRect(getDocumentElement(element));\n  } else if (isElement(clippingAncestor)) {\n    rect = getInnerBoundingClientRect(clippingAncestor, strategy);\n  } else {\n    const visualOffsets = getVisualOffsets(element);\n    rect = {\n      ...clippingAncestor,\n      x: clippingAncestor.x - visualOffsets.x,\n      y: clippingAncestor.y - visualOffsets.y\n    };\n  }\n  return rectToClientRect(rect);\n}\nfunction hasFixedPositionAncestor(element, stopNode) {\n  const parentNode = getParentNode(element);\n  if (parentNode === stopNode || !isElement(parentNode) || isLastTraversableNode(parentNode)) {\n    return false;\n  }\n  return getComputedStyle(parentNode).position === 'fixed' || hasFixedPositionAncestor(parentNode, stopNode);\n}\n\n// A \"clipping ancestor\" is an `overflow` element with the characteristic of\n// clipping (or hiding) child elements. This returns all clipping ancestors\n// of the given element up the tree.\nfunction getClippingElementAncestors(element, cache) {\n  const cachedResult = cache.get(element);\n  if (cachedResult) {\n    return cachedResult;\n  }\n  let result = getOverflowAncestors(element, [], false).filter(el => isElement(el) && getNodeName(el) !== 'body');\n  let currentContainingBlockComputedStyle = null;\n  const elementIsFixed = getComputedStyle(element).position === 'fixed';\n  let currentNode = elementIsFixed ? getParentNode(element) : element;\n\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block\n  while (isElement(currentNode) && !isLastTraversableNode(currentNode)) {\n    const computedStyle = getComputedStyle(currentNode);\n    const currentNodeIsContaining = isContainingBlock(currentNode);\n    if (!currentNodeIsContaining && computedStyle.position === 'fixed') {\n      currentContainingBlockComputedStyle = null;\n    }\n    const shouldDropCurrentNode = elementIsFixed ? !currentNodeIsContaining && !currentContainingBlockComputedStyle : !currentNodeIsContaining && computedStyle.position === 'static' && !!currentContainingBlockComputedStyle && ['absolute', 'fixed'].includes(currentContainingBlockComputedStyle.position) || isOverflowElement(currentNode) && !currentNodeIsContaining && hasFixedPositionAncestor(element, currentNode);\n    if (shouldDropCurrentNode) {\n      // Drop non-containing blocks.\n      result = result.filter(ancestor => ancestor !== currentNode);\n    } else {\n      // Record last containing block for next iteration.\n      currentContainingBlockComputedStyle = computedStyle;\n    }\n    currentNode = getParentNode(currentNode);\n  }\n  cache.set(element, result);\n  return result;\n}\n\n// Gets the maximum area that the element is visible in due to any number of\n// clipping ancestors.\nfunction getClippingRect(_ref) {\n  let {\n    element,\n    boundary,\n    rootBoundary,\n    strategy\n  } = _ref;\n  const elementClippingAncestors = boundary === 'clippingAncestors' ? isTopLayer(element) ? [] : getClippingElementAncestors(element, this._c) : [].concat(boundary);\n  const clippingAncestors = [...elementClippingAncestors, rootBoundary];\n  const firstClippingAncestor = clippingAncestors[0];\n  const clippingRect = clippingAncestors.reduce((accRect, clippingAncestor) => {\n    const rect = getClientRectFromClippingAncestor(element, clippingAncestor, strategy);\n    accRect.top = max(rect.top, accRect.top);\n    accRect.right = min(rect.right, accRect.right);\n    accRect.bottom = min(rect.bottom, accRect.bottom);\n    accRect.left = max(rect.left, accRect.left);\n    return accRect;\n  }, getClientRectFromClippingAncestor(element, firstClippingAncestor, strategy));\n  return {\n    width: clippingRect.right - clippingRect.left,\n    height: clippingRect.bottom - clippingRect.top,\n    x: clippingRect.left,\n    y: clippingRect.top\n  };\n}\n\nfunction getDimensions(element) {\n  const {\n    width,\n    height\n  } = getCssDimensions(element);\n  return {\n    width,\n    height\n  };\n}\n\nfunction getRectRelativeToOffsetParent(element, offsetParent, strategy) {\n  const isOffsetParentAnElement = isHTMLElement(offsetParent);\n  const documentElement = getDocumentElement(offsetParent);\n  const isFixed = strategy === 'fixed';\n  const rect = getBoundingClientRect(element, true, isFixed, offsetParent);\n  let scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  const offsets = createCoords(0);\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {\n    if (getNodeName(offsetParent) !== 'body' || isOverflowElement(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n    if (isOffsetParentAnElement) {\n      const offsetRect = getBoundingClientRect(offsetParent, true, isFixed, offsetParent);\n      offsets.x = offsetRect.x + offsetParent.clientLeft;\n      offsets.y = offsetRect.y + offsetParent.clientTop;\n    } else if (documentElement) {\n      offsets.x = getWindowScrollBarX(documentElement);\n    }\n  }\n  const x = rect.left + scroll.scrollLeft - offsets.x;\n  const y = rect.top + scroll.scrollTop - offsets.y;\n  return {\n    x,\n    y,\n    width: rect.width,\n    height: rect.height\n  };\n}\n\nfunction isStaticPositioned(element) {\n  return getComputedStyle(element).position === 'static';\n}\n\nfunction getTrueOffsetParent(element, polyfill) {\n  if (!isHTMLElement(element) || getComputedStyle(element).position === 'fixed') {\n    return null;\n  }\n  if (polyfill) {\n    return polyfill(element);\n  }\n  return element.offsetParent;\n}\n\n// Gets the closest ancestor positioned element. Handles some edge cases,\n// such as table ancestors and cross browser bugs.\nfunction getOffsetParent(element, polyfill) {\n  const win = getWindow(element);\n  if (isTopLayer(element)) {\n    return win;\n  }\n  if (!isHTMLElement(element)) {\n    let svgOffsetParent = getParentNode(element);\n    while (svgOffsetParent && !isLastTraversableNode(svgOffsetParent)) {\n      if (isElement(svgOffsetParent) && !isStaticPositioned(svgOffsetParent)) {\n        return svgOffsetParent;\n      }\n      svgOffsetParent = getParentNode(svgOffsetParent);\n    }\n    return win;\n  }\n  let offsetParent = getTrueOffsetParent(element, polyfill);\n  while (offsetParent && isTableElement(offsetParent) && isStaticPositioned(offsetParent)) {\n    offsetParent = getTrueOffsetParent(offsetParent, polyfill);\n  }\n  if (offsetParent && isLastTraversableNode(offsetParent) && isStaticPositioned(offsetParent) && !isContainingBlock(offsetParent)) {\n    return win;\n  }\n  return offsetParent || getContainingBlock(element) || win;\n}\n\nconst getElementRects = async function (data) {\n  const getOffsetParentFn = this.getOffsetParent || getOffsetParent;\n  const getDimensionsFn = this.getDimensions;\n  const floatingDimensions = await getDimensionsFn(data.floating);\n  return {\n    reference: getRectRelativeToOffsetParent(data.reference, await getOffsetParentFn(data.floating), data.strategy),\n    floating: {\n      x: 0,\n      y: 0,\n      width: floatingDimensions.width,\n      height: floatingDimensions.height\n    }\n  };\n};\n\nfunction isRTL(element) {\n  return getComputedStyle(element).direction === 'rtl';\n}\n\nconst platform = {\n  convertOffsetParentRelativeRectToViewportRelativeRect,\n  getDocumentElement,\n  getClippingRect,\n  getOffsetParent,\n  getElementRects,\n  getClientRects,\n  getDimensions,\n  getScale,\n  isElement,\n  isRTL\n};\n\n// https://samthor.au/2021/observing-dom/\nfunction observeMove(element, onMove) {\n  let io = null;\n  let timeoutId;\n  const root = getDocumentElement(element);\n  function cleanup() {\n    var _io;\n    clearTimeout(timeoutId);\n    (_io = io) == null || _io.disconnect();\n    io = null;\n  }\n  function refresh(skip, threshold) {\n    if (skip === void 0) {\n      skip = false;\n    }\n    if (threshold === void 0) {\n      threshold = 1;\n    }\n    cleanup();\n    const {\n      left,\n      top,\n      width,\n      height\n    } = element.getBoundingClientRect();\n    if (!skip) {\n      onMove();\n    }\n    if (!width || !height) {\n      return;\n    }\n    const insetTop = floor(top);\n    const insetRight = floor(root.clientWidth - (left + width));\n    const insetBottom = floor(root.clientHeight - (top + height));\n    const insetLeft = floor(left);\n    const rootMargin = -insetTop + \"px \" + -insetRight + \"px \" + -insetBottom + \"px \" + -insetLeft + \"px\";\n    const options = {\n      rootMargin,\n      threshold: max(0, min(1, threshold)) || 1\n    };\n    let isFirstUpdate = true;\n    function handleObserve(entries) {\n      const ratio = entries[0].intersectionRatio;\n      if (ratio !== threshold) {\n        if (!isFirstUpdate) {\n          return refresh();\n        }\n        if (!ratio) {\n          // If the reference is clipped, the ratio is 0. Throttle the refresh\n          // to prevent an infinite loop of updates.\n          timeoutId = setTimeout(() => {\n            refresh(false, 1e-7);\n          }, 1000);\n        } else {\n          refresh(false, ratio);\n        }\n      }\n      isFirstUpdate = false;\n    }\n\n    // Older browsers don't support a `document` as the root and will throw an\n    // error.\n    try {\n      io = new IntersectionObserver(handleObserve, {\n        ...options,\n        // Handle <iframe>s\n        root: root.ownerDocument\n      });\n    } catch (e) {\n      io = new IntersectionObserver(handleObserve, options);\n    }\n    io.observe(element);\n  }\n  refresh(true);\n  return cleanup;\n}\n\n/**\n * Automatically updates the position of the floating element when necessary.\n * Should only be called when the floating element is mounted on the DOM or\n * visible on the screen.\n * @returns cleanup function that should be invoked when the floating element is\n * removed from the DOM or hidden from the screen.\n * @see https://floating-ui.com/docs/autoUpdate\n */\nfunction autoUpdate(reference, floating, update, options) {\n  if (options === void 0) {\n    options = {};\n  }\n  const {\n    ancestorScroll = true,\n    ancestorResize = true,\n    elementResize = typeof ResizeObserver === 'function',\n    layoutShift = typeof IntersectionObserver === 'function',\n    animationFrame = false\n  } = options;\n  const referenceEl = unwrapElement(reference);\n  const ancestors = ancestorScroll || ancestorResize ? [...(referenceEl ? getOverflowAncestors(referenceEl) : []), ...getOverflowAncestors(floating)] : [];\n  ancestors.forEach(ancestor => {\n    ancestorScroll && ancestor.addEventListener('scroll', update, {\n      passive: true\n    });\n    ancestorResize && ancestor.addEventListener('resize', update);\n  });\n  const cleanupIo = referenceEl && layoutShift ? observeMove(referenceEl, update) : null;\n  let reobserveFrame = -1;\n  let resizeObserver = null;\n  if (elementResize) {\n    resizeObserver = new ResizeObserver(_ref => {\n      let [firstEntry] = _ref;\n      if (firstEntry && firstEntry.target === referenceEl && resizeObserver) {\n        // Prevent update loops when using the `size` middleware.\n        // https://github.com/floating-ui/floating-ui/issues/1740\n        resizeObserver.unobserve(floating);\n        cancelAnimationFrame(reobserveFrame);\n        reobserveFrame = requestAnimationFrame(() => {\n          var _resizeObserver;\n          (_resizeObserver = resizeObserver) == null || _resizeObserver.observe(floating);\n        });\n      }\n      update();\n    });\n    if (referenceEl && !animationFrame) {\n      resizeObserver.observe(referenceEl);\n    }\n    resizeObserver.observe(floating);\n  }\n  let frameId;\n  let prevRefRect = animationFrame ? getBoundingClientRect(reference) : null;\n  if (animationFrame) {\n    frameLoop();\n  }\n  function frameLoop() {\n    const nextRefRect = getBoundingClientRect(reference);\n    if (prevRefRect && (nextRefRect.x !== prevRefRect.x || nextRefRect.y !== prevRefRect.y || nextRefRect.width !== prevRefRect.width || nextRefRect.height !== prevRefRect.height)) {\n      update();\n    }\n    prevRefRect = nextRefRect;\n    frameId = requestAnimationFrame(frameLoop);\n  }\n  update();\n  return () => {\n    var _resizeObserver2;\n    ancestors.forEach(ancestor => {\n      ancestorScroll && ancestor.removeEventListener('scroll', update);\n      ancestorResize && ancestor.removeEventListener('resize', update);\n    });\n    cleanupIo == null || cleanupIo();\n    (_resizeObserver2 = resizeObserver) == null || _resizeObserver2.disconnect();\n    resizeObserver = null;\n    if (animationFrame) {\n      cancelAnimationFrame(frameId);\n    }\n  };\n}\n\n/**\n * Resolves with an object of overflow side offsets that determine how much the\n * element is overflowing a given clipping boundary on each side.\n * - positive = overflowing the boundary by that number of pixels\n * - negative = how many pixels left before it will overflow\n * - 0 = lies flush with the boundary\n * @see https://floating-ui.com/docs/detectOverflow\n */\nconst detectOverflow = detectOverflow$1;\n\n/**\n * Modifies the placement by translating the floating element along the\n * specified axes.\n * A number (shorthand for `mainAxis` or distance), or an axes configuration\n * object may be passed.\n * @see https://floating-ui.com/docs/offset\n */\nconst offset = offset$1;\n\n/**\n * Optimizes the visibility of the floating element by choosing the placement\n * that has the most space available automatically, without needing to specify a\n * preferred placement. Alternative to `flip`.\n * @see https://floating-ui.com/docs/autoPlacement\n */\nconst autoPlacement = autoPlacement$1;\n\n/**\n * Optimizes the visibility of the floating element by shifting it in order to\n * keep it in view when it will overflow the clipping boundary.\n * @see https://floating-ui.com/docs/shift\n */\nconst shift = shift$1;\n\n/**\n * Optimizes the visibility of the floating element by flipping the `placement`\n * in order to keep it in view when the preferred placement(s) will overflow the\n * clipping boundary. Alternative to `autoPlacement`.\n * @see https://floating-ui.com/docs/flip\n */\nconst flip = flip$1;\n\n/**\n * Provides data that allows you to change the size of the floating element \n * for instance, prevent it from overflowing the clipping boundary or match the\n * width of the reference element.\n * @see https://floating-ui.com/docs/size\n */\nconst size = size$1;\n\n/**\n * Provides data to hide the floating element in applicable situations, such as\n * when it is not in the same clipping context as the reference element.\n * @see https://floating-ui.com/docs/hide\n */\nconst hide = hide$1;\n\n/**\n * Provides data to position an inner element of the floating element so that it\n * appears centered to the reference element.\n * @see https://floating-ui.com/docs/arrow\n */\nconst arrow = arrow$1;\n\n/**\n * Provides improved positioning for inline reference elements that can span\n * over multiple lines, such as hyperlinks or range selections.\n * @see https://floating-ui.com/docs/inline\n */\nconst inline = inline$1;\n\n/**\n * Built-in `limiter` that will stop `shift()` at a certain point.\n */\nconst limitShift = limitShift$1;\n\n/**\n * Computes the `x` and `y` coordinates that will place the floating element\n * next to a given reference element.\n */\nconst computePosition = (reference, floating, options) => {\n  // This caches the expensive `getClippingElementAncestors` function so that\n  // multiple lifecycle resets re-use the same result. It only lives for a\n  // single call. If other functions become expensive, we can add them as well.\n  const cache = new Map();\n  const mergedOptions = {\n    platform,\n    ...options\n  };\n  const platformWithCache = {\n    ...mergedOptions.platform,\n    _c: cache\n  };\n  return computePosition$1(reference, floating, {\n    ...mergedOptions,\n    platform: platformWithCache\n  });\n};\n\nexport { arrow, autoPlacement, autoUpdate, computePosition, detectOverflow, flip, hide, inline, limitShift, offset, platform, shift, size };\n","//@ts-ignore\nimport { arrow as arrowCore } from \"./core\";\nimport { autoUpdate as _autoUpdate, computePosition } from \"./dom/index.js\";\nimport { get } from \"svelte/store\";\nimport { onDestroy, tick } from 'svelte';\nexport function createFloatingActions(initOptions) {\n    let referenceElement;\n    let floatingElement;\n    const defaultOptions = {\n        autoUpdate: true\n    };\n    let options = initOptions;\n    const getOptions = (mixin) => {\n        return { ...defaultOptions, ...(initOptions || {}), ...(mixin || {}) };\n    };\n    const updatePosition = (updateOptions) => {\n        if (referenceElement && floatingElement) {\n            options = getOptions(updateOptions);\n            computePosition(referenceElement, floatingElement, options)\n                .then(v => {\n                Object.assign(floatingElement.style, {\n                    position: v.strategy,\n                    left: `${v.x}px`,\n                    top: `${v.y}px`,\n                });\n                options?.onComputed && options.onComputed(v);\n            });\n        }\n    };\n    const referenceAction = node => {\n        if ('subscribe' in node) {\n            setupVirtualElementObserver(node);\n            return {};\n        }\n        else {\n            referenceElement = node;\n            updatePosition();\n        }\n    };\n    const contentAction = (node, contentOptions) => {\n        let autoUpdateDestroy;\n        floatingElement = node;\n        options = getOptions(contentOptions);\n        setTimeout(() => updatePosition(contentOptions), 0); //tick doesn't work\n        updatePosition(contentOptions);\n        const destroyAutoUpdate = () => {\n            if (autoUpdateDestroy) {\n                autoUpdateDestroy();\n                autoUpdateDestroy = undefined;\n            }\n        };\n        const initAutoUpdate = ({ autoUpdate } = options || {}) => {\n            destroyAutoUpdate();\n            if (autoUpdate !== false) {\n                tick().then(() => {\n                    return _autoUpdate(referenceElement, floatingElement, () => updatePosition(options), (autoUpdate === true ? {} : autoUpdate));\n                });\n            }\n            return;\n        };\n        autoUpdateDestroy = initAutoUpdate();\n        return {\n            update(contentOptions) {\n                updatePosition(contentOptions);\n                autoUpdateDestroy = initAutoUpdate(contentOptions);\n            },\n            destroy() {\n                destroyAutoUpdate();\n            }\n        };\n    };\n    const setupVirtualElementObserver = (node) => {\n        const unsubscribe = node.subscribe(($node) => {\n            if (referenceElement === undefined) {\n                referenceElement = $node;\n                updatePosition();\n            }\n            else {\n                // Preserve the reference to the virtual element.\n                Object.assign(referenceElement, $node);\n                updatePosition();\n            }\n        });\n        onDestroy(unsubscribe);\n    };\n    return [\n        referenceAction,\n        contentAction,\n        updatePosition\n    ];\n}\nexport function arrow(options) {\n    return {\n        name: \"arrow\",\n        options,\n        fn(args) {\n            const element = get(options.element);\n            if (element) {\n                return arrowCore({\n                    element,\n                    padding: options.padding\n                }).fn(args);\n            }\n            return {};\n        }\n    };\n}\n","export default function filter({\n    loadOptions,\n    filterText,\n    items,\n    multiple,\n    value,\n    itemId,\n    groupBy,\n    filterSelectedItems,\n    itemFilter,\n    convertStringItemsToObjects,\n    filterGroupedItems,\n    label,\n}) {\n    if (items && loadOptions) return items;\n    if (!items) return [];\n\n    if (items && items.length > 0 && typeof items[0] !== 'object') {\n        items = convertStringItemsToObjects(items);\n    }\n\n    let filterResults = items.filter((item) => {\n        let matchesFilter = itemFilter(item[label], filterText, item);\n        if (matchesFilter && multiple && value?.length) {\n            matchesFilter = !value.some((x) => {\n                return filterSelectedItems ? x[itemId] === item[itemId] : false;\n            });\n        }\n\n        return matchesFilter;\n    });\n\n    if (groupBy) {\n        filterResults = filterGroupedItems(filterResults);\n    }\n\n    return filterResults;\n}\n","export default async function getItems({ dispatch, loadOptions, convertStringItemsToObjects, filterText }) {\n    let res = await loadOptions(filterText).catch((err) => {\n        console.warn('svelte-select loadOptions error :>> ', err);\n        dispatch('error', { type: 'loadOptions', details: err });\n    });\n\n    if (res && !res.cancelled) {        \n        if (res) {\n            if (res && res.length > 0 && typeof res[0] !== 'object') {\n                res = convertStringItemsToObjects(res);\n            }\n            \n            dispatch('loaded', { items: res });\n        } else {\n            res = [];\n        }\n\n        return {\n            filteredItems: res,\n            loading: false,\n            focused: true,\n            listOpen: true,\n        };\n    }\n}\n","<svg\n    width=\"100%\"\n    height=\"100%\"\n    viewBox=\"0 0 20 20\"\n    focusable=\"false\"\n    aria-hidden=\"true\">\n    <path\n    fill=\"currentColor\"\n        d=\"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747\n          3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0\n          1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502\n          0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0\n          0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z\" />\n</svg>\n\n<style>\n  svg {\n      width: var(--chevron-icon-width, 20px);\n      height: var(--chevron-icon-width, 20px);\n      color: var(--chevron-icon-colour, currentColor);\n  }\n</style>","<svg\n    width=\"100%\"\n    height=\"100%\"\n    viewBox=\"-2 -2 50 50\"\n    focusable=\"false\"\n    aria-hidden=\"true\"\n    role=\"presentation\"\n>\n    <path\n        fill=\"currentColor\"\n        d=\"M34.923,37.251L24,26.328L13.077,37.251L9.436,33.61l10.923-10.923L9.436,11.765l3.641-3.641L24,19.047L34.923,8.124\n    l3.641,3.641L27.641,22.688L38.564,33.61L34.923,37.251z\"\n    />\n</svg>\n\n<style>\n    svg {\n        width: var(--clear-icon-width, 20px);\n        height: var(--clear-icon-width, 20px);\n        color: var(--clear-icon-color, currentColor);\n    }\n</style>","<svg class=\"loading\" viewBox=\"25 25 50 50\">\n    <circle\n        class=\"circle_path\"\n        cx=\"50\"\n        cy=\"50\"\n        r=\"20\"\n        fill=\"none\"\n        stroke=\"currentColor\"\n        stroke-width=\"5\"\n        stroke-miterlimit=\"10\" />\n</svg>\n\n<style>\n    .loading {\n        width: var(--spinner-width, 20px);\n        height: var(--spinner-height, 20px);\n        color: var(--spinner-color, var(--icons-color));\n        animation: rotate 0.75s linear infinite;\n        transform-origin: center center;\n        transform: none;\n    }\n\n    .circle_path {\n        stroke-dasharray: 90;\n        stroke-linecap: round;\n    }\n\n    @keyframes rotate {\n        100% {\n            transform: rotate(360deg);\n        }\n    }\n</style>","<script>\n    import { beforeUpdate, createEventDispatcher, onDestroy, onMount } from 'svelte';\n    import { offset, flip, shift } from 'svelte-floating-ui/dom';\n    import { createFloatingActions } from 'svelte-floating-ui';\n\n    const dispatch = createEventDispatcher();\n\n    import _filter from './filter';\n    import _getItems from './get-items';\n\n    import ChevronIcon from './ChevronIcon.svelte';\n    import ClearIcon from './ClearIcon.svelte';\n    import LoadingIcon from './LoadingIcon.svelte';\n\n    export let justValue = null; // read-only\n\n    export let filter = _filter;\n    export let getItems = _getItems;\n\n    export let id = null;\n    export let name = null;\n    export let container = undefined;\n    export let input = undefined;\n    export let multiple = false;\n    export let multiFullItemClearable = false;\n    export let disabled = false;\n    export let focused = false;\n    export let value = null;\n    export let filterText = '';\n    export let placeholder = 'Please select';\n    export let placeholderAlwaysShow = false;\n    export let items = null;\n    export let label = 'label';\n    export let itemFilter = (label, filterText, option) => `${label}`.toLowerCase().includes(filterText.toLowerCase());\n    export let groupBy = undefined;\n    export let groupFilter = (groups) => groups;\n    export let groupHeaderSelectable = false;\n    export let itemId = 'value';\n    export let loadOptions = undefined;\n    export let containerStyles = '';\n    export let hasError = false;\n    export let filterSelectedItems = true;\n    export let required = false;\n    export let closeListOnChange = true;\n    export let clearFilterTextOnBlur = true;\n\n    export let createGroupHeaderItem = (groupValue, item) => {\n        return {\n            value: groupValue,\n            [label]: groupValue,\n        };\n    };\n\n    export const getFilteredItems = () => {\n        return filteredItems;\n    };\n\n    export let searchable = true;\n    export let inputStyles = '';\n    export let clearable = true;\n    export let loading = false;\n    export let listOpen = false;\n\n    let timeout;\n    export let debounce = (fn, wait = 1) => {\n        clearTimeout(timeout);\n        timeout = setTimeout(fn, wait);\n    };\n\n    export let debounceWait = 300;\n    export let hideEmptyState = false;\n    export let inputAttributes = {};\n    export let listAutoWidth = true;\n    export let showChevron = false;\n    export let listOffset = 5;\n    export let hoverItemIndex = 0;\n    export let floatingConfig = {};\n\n    export { containerClasses as class };\n\n    let containerClasses = '';\n    let activeValue;\n    let prev_value;\n    let prev_filterText;\n    let prev_multiple;\n\n    function setValue() {\n        if (typeof value === 'string') {\n            let item = (items || []).find((item) => item[itemId] === value);\n            value = item || {\n                [itemId]: value,\n                label: value,\n            };\n        } else if (multiple && Array.isArray(value) && value.length > 0) {\n            value = value.map((item) => (typeof item === 'string' ? { value: item, label: item } : item));\n        }\n    }\n\n    let _inputAttributes;\n    function assignInputAttributes() {\n        _inputAttributes = Object.assign(\n            {\n                autocapitalize: 'none',\n                autocomplete: 'off',\n                autocorrect: 'off',\n                spellcheck: false,\n                tabindex: 0,\n                type: 'text',\n                'aria-autocomplete': 'list',\n            },\n            inputAttributes\n        );\n\n        if (id) {\n            _inputAttributes['id'] = id;\n        }\n\n        if (!searchable) {\n            _inputAttributes['readonly'] = true;\n        }\n    }\n\n    function convertStringItemsToObjects(_items) {\n        return _items.map((item, index) => {\n            return {\n                index,\n                value: item,\n                label: `${item}`,\n            };\n        });\n    }\n\n    function filterGroupedItems(_items) {\n        const groupValues = [];\n        const groups = {};\n\n        _items.forEach((item) => {\n            const groupValue = groupBy(item);\n\n            if (!groupValues.includes(groupValue)) {\n                groupValues.push(groupValue);\n                groups[groupValue] = [];\n\n                if (groupValue) {\n                    groups[groupValue].push(\n                        Object.assign(createGroupHeaderItem(groupValue, item), {\n                            id: groupValue,\n                            groupHeader: true,\n                            selectable: groupHeaderSelectable,\n                        })\n                    );\n                }\n            }\n\n            groups[groupValue].push(Object.assign({ groupItem: !!groupValue }, item));\n        });\n\n        const sortedGroupedItems = [];\n\n        groupFilter(groupValues).forEach((groupValue) => {\n            if (groups[groupValue]) sortedGroupedItems.push(...groups[groupValue]);\n        });\n\n        return sortedGroupedItems;\n    }\n\n    function dispatchSelectedItem() {\n        if (multiple) {\n            if (JSON.stringify(value) !== JSON.stringify(prev_value)) {\n                if (checkValueForDuplicates()) {\n                    dispatch('input', value);\n                }\n            }\n            return;\n        }\n\n        if (!prev_value || JSON.stringify(value[itemId]) !== JSON.stringify(prev_value[itemId])) {\n            dispatch('input', value);\n        }\n    }\n\n    function setupMulti() {\n        if (value) {\n            if (Array.isArray(value)) {\n                value = [...value];\n            } else {\n                value = [value];\n            }\n        }\n    }\n\n    function setupSingle() {\n        if (value) value = null;\n    }\n\n    $: if ((items, value)) setValue();\n    $: if (inputAttributes || !searchable) assignInputAttributes();\n    $: if (multiple) setupMulti();\n    $: if (prev_multiple && !multiple) setupSingle();\n    $: if (multiple && value && value.length > 1) checkValueForDuplicates();\n    $: if (value) dispatchSelectedItem();\n    $: if (!value && multiple && prev_value) dispatch('input', value);\n    $: if (!focused && input) closeList();\n    $: if (filterText !== prev_filterText) setupFilterText();\n    $: if (!multiple && listOpen && value && filteredItems) setValueIndexAsHoverIndex();\n    $: dispatchHover(hoverItemIndex);\n\n    function setValueIndexAsHoverIndex() {\n        const valueIndex = filteredItems.findIndex((i) => {\n            return i[itemId] === value[itemId];\n        });\n\n        checkHoverSelectable(valueIndex, true);\n    }\n\n    function dispatchHover(i) {\n        dispatch('hoverItem', i);\n    }\n\n    function checkHoverSelectable(startingIndex = 0, ignoreGroup) {\n        hoverItemIndex = startingIndex < 0 ? 0 : startingIndex;\n        if (!ignoreGroup && groupBy && filteredItems[hoverItemIndex] && !filteredItems[hoverItemIndex].selectable) {\n            setHoverIndex(1);\n        }\n    }\n\n    function setupFilterText() {\n        if (!loadOptions && filterText.length === 0) return;\n\n        if (loadOptions) {\n            debounce(async function () {\n                loading = true;\n                let res = await getItems({\n                    dispatch,\n                    loadOptions,\n                    convertStringItemsToObjects,\n                    filterText,\n                });\n\n                if (res) {\n                    loading = res.loading;\n                    listOpen = listOpen ? res.listOpen : filterText.length > 0 ? true : false;\n                    focused = listOpen && res.focused;\n                    items = groupBy ? filterGroupedItems(res.filteredItems) : res.filteredItems;\n                } else {\n                    loading = false;\n                    focused = true;\n                    listOpen = true;\n                }\n            }, debounceWait);\n        } else {\n            listOpen = true;\n\n            if (multiple) {\n                activeValue = undefined;\n            }\n        }\n    }\n\n    $: hasValue = multiple ? value && value.length > 0 : value;\n    $: hideSelectedItem = hasValue && filterText.length > 0;\n    $: showClear = hasValue && clearable && !disabled && !loading;\n    $: placeholderText =\n        placeholderAlwaysShow && multiple\n            ? placeholder\n            : multiple && value?.length === 0\n            ? placeholder\n            : value\n            ? ''\n            : placeholder;\n    $: ariaSelection = value ? handleAriaSelection(multiple) : '';\n    $: ariaContext = handleAriaContent({ filteredItems, hoverItemIndex, focused, listOpen });\n    $: updateValueDisplay(items);\n    $: justValue = computeJustValue(multiple, value, itemId);\n    $: if (!multiple && prev_value && !value) dispatch('input', value);\n    $: filteredItems = filter({\n        loadOptions,\n        filterText,\n        items,\n        multiple,\n        value,\n        itemId,\n        groupBy,\n        label,\n        filterSelectedItems,\n        itemFilter,\n        convertStringItemsToObjects,\n        filterGroupedItems,\n    });\n    $: if (listOpen && filteredItems && !multiple && !value) checkHoverSelectable();\n    $: handleFilterEvent(filteredItems);\n    $: if (container && floatingConfig) floatingUpdate(Object.assign(_floatingConfig, floatingConfig));\n    $: listDom = !!list;\n    $: listMounted(list, listOpen);\n    $: if (listOpen && container && list) setListWidth();\n    $: scrollToHoverItem = hoverItemIndex;\n    $: if (listOpen && multiple) hoverItemIndex = 0;\n    $: if (input && listOpen && !focused) handleFocus();\n    $: if (filterText) hoverItemIndex = 0;\n\n    function handleFilterEvent(items) {\n        if (listOpen) dispatch('filter', items);\n    }\n\n    beforeUpdate(async () => {\n        prev_value = value;\n        prev_filterText = filterText;\n        prev_multiple = multiple;\n    });\n\n    function computeJustValue() {\n        if (multiple) return value ? value.map((item) => item[itemId]) : null;\n        return value ? value[itemId] : value;\n    }\n\n    function checkValueForDuplicates() {\n        let noDuplicates = true;\n        if (value) {\n            const ids = [];\n            const uniqueValues = [];\n\n            value.forEach((val) => {\n                if (!ids.includes(val[itemId])) {\n                    ids.push(val[itemId]);\n                    uniqueValues.push(val);\n                } else {\n                    noDuplicates = false;\n                }\n            });\n\n            if (!noDuplicates) value = uniqueValues;\n        }\n        return noDuplicates;\n    }\n\n    function findItem(selection) {\n        let matchTo = selection ? selection[itemId] : value[itemId];\n        return items.find((item) => item[itemId] === matchTo);\n    }\n\n    function updateValueDisplay(items) {\n        if (!items || items.length === 0 || items.some((item) => typeof item !== 'object')) return;\n        if (!value || (multiple ? value.some((selection) => !selection || !selection[itemId]) : !value[itemId])) return;\n\n        if (Array.isArray(value)) {\n            value = value.map((selection) => findItem(selection) || selection);\n        } else {\n            value = findItem() || value;\n        }\n    }\n\n    async function handleMultiItemClear(i) {\n        const itemToRemove = value[i];\n\n        if (value.length === 1) {\n            value = undefined;\n        } else {\n            value = value.filter((item) => {\n                return item !== itemToRemove;\n            });\n        }\n\n        dispatch('clear', itemToRemove);\n    }\n\n    function handleKeyDown(e) {\n        if (!focused) return;\n        e.stopPropagation();\n        switch (e.key) {\n            case 'Escape':\n                e.preventDefault();\n                closeList();\n                break;\n            case 'Enter':\n                e.preventDefault();\n\n                if (listOpen) {\n                    if (filteredItems.length === 0) break;\n                    const hoverItem = filteredItems[hoverItemIndex];\n\n                    if (value && !multiple && value[itemId] === hoverItem[itemId]) {\n                        closeList();\n                        break;\n                    } else {\n                        handleSelect(filteredItems[hoverItemIndex]);\n                    }\n                }\n\n                break;\n            case 'ArrowDown':\n                e.preventDefault();\n\n                if (listOpen) {\n                    setHoverIndex(1);\n                } else {\n                    listOpen = true;\n                    activeValue = undefined;\n                }\n\n                break;\n            case 'ArrowUp':\n                e.preventDefault();\n\n                if (listOpen) {\n                    setHoverIndex(-1);\n                } else {\n                    listOpen = true;\n                    activeValue = undefined;\n                }\n\n                break;\n            case 'Tab':\n                if (listOpen && focused) {\n                    if (\n                        filteredItems.length === 0 ||\n                        (value && value[itemId] === filteredItems[hoverItemIndex][itemId])\n                    )\n                        return closeList();\n\n                    e.preventDefault();\n                    handleSelect(filteredItems[hoverItemIndex]);\n                    closeList();\n                }\n\n                break;\n            case 'Backspace':\n                if (!multiple || filterText.length > 0) return;\n\n                if (multiple && value && value.length > 0) {\n                    handleMultiItemClear(activeValue !== undefined ? activeValue : value.length - 1);\n                    if (activeValue === 0 || activeValue === undefined) break;\n                    activeValue = value.length > activeValue ? activeValue - 1 : undefined;\n                }\n\n                break;\n            case 'ArrowLeft':\n                if (!value || !multiple || filterText.length > 0) return;\n                if (activeValue === undefined) {\n                    activeValue = value.length - 1;\n                } else if (value.length > activeValue && activeValue !== 0) {\n                    activeValue -= 1;\n                }\n                break;\n            case 'ArrowRight':\n                if (!value || !multiple || filterText.length > 0 || activeValue === undefined) return;\n                if (activeValue === value.length - 1) {\n                    activeValue = undefined;\n                } else if (activeValue < value.length - 1) {\n                    activeValue += 1;\n                }\n                break;\n        }\n    }\n\n    function handleFocus(e) {\n        if (focused && input === document?.activeElement) return;\n        if (e) dispatch('focus', e);\n        input?.focus();\n        focused = true;\n    }\n\n    async function handleBlur(e) {\n        if (isScrolling) return;\n        if (listOpen || focused) {\n            dispatch('blur', e);\n            closeList();\n            focused = false;\n            activeValue = undefined;\n            input?.blur();\n        }\n    }\n\n    function handleClick() {\n        if (disabled) return;\n        if (filterText.length > 0) return listOpen = true;\n        listOpen = !listOpen;\n    }\n\n    export function handleClear() {\n        dispatch('clear', value);\n        value = undefined;\n        closeList();\n        handleFocus();\n    }\n\n    onMount(() => {\n        if (listOpen) focused = true;\n        if (focused && input) input.focus();\n    });\n\n    function itemSelected(selection) {\n        if (selection) {\n            filterText = '';\n            const item = Object.assign({}, selection);\n\n            if (item.groupHeader && !item.selectable) return;\n            value = multiple ? (value ? value.concat([item]) : [item]) : (value = item);\n\n            setTimeout(() => {\n                if (closeListOnChange) closeList();\n                activeValue = undefined;\n                dispatch('change', value);\n                dispatch('select', selection);\n            });\n        }\n    }\n\n    function closeList() {\n        if (clearFilterTextOnBlur) {\n            filterText = '';\n        }\n        listOpen = false;\n    }\n\n    export let ariaValues = (values) => {\n        return `Option ${values}, selected.`;\n    };\n\n    export let ariaListOpen = (label, count) => {\n        return `You are currently focused on option ${label}. There are ${count} results available.`;\n    };\n\n    export let ariaFocused = () => {\n        return `Select is focused, type to refine list, press down to open the menu.`;\n    };\n\n    function handleAriaSelection(_multiple) {\n        let selected = undefined;\n\n        if (_multiple && value.length > 0) {\n            selected = value.map((v) => v[label]).join(', ');\n        } else {\n            selected = value[label];\n        }\n\n        return ariaValues(selected);\n    }\n\n    function handleAriaContent() {\n        if (!filteredItems || filteredItems.length === 0) return '';\n        let _item = filteredItems[hoverItemIndex];\n        if (listOpen && _item) {\n            let count = filteredItems ? filteredItems.length : 0;\n            return ariaListOpen(_item[label], count);\n        } else {\n            return ariaFocused();\n        }\n    }\n\n    let list = null;\n\n    let isScrollingTimer;\n    function handleListScroll() {\n        clearTimeout(isScrollingTimer);\n        isScrollingTimer = setTimeout(() => {\n            isScrolling = false;\n        }, 100);\n    }\n\n    function handleClickOutside(event) {\n        if (!listOpen && !focused && container && !container.contains(event.target) && !list?.contains(event.target)) {\n            handleBlur();\n        }\n    }\n\n    onDestroy(() => {\n        list?.remove();\n    });\n\n    let isScrolling = false;\n\n    function handleSelect(item) {\n        if (!item || item.selectable === false) return;\n        itemSelected(item);\n    }\n\n    function handleHover(i) {\n        if (isScrolling) return;\n        hoverItemIndex = i;\n    }\n\n    function handleItemClick(args) {\n        const { item, i } = args;\n        if (item?.selectable === false) return;\n        if (value && !multiple && value[itemId] === item[itemId]) return closeList();\n        if (isItemSelectable(item)) {\n            hoverItemIndex = i;\n            handleSelect(item);\n        }\n    }\n\n    function setHoverIndex(increment) {\n        let selectableFilteredItems = filteredItems.filter(\n            (item) => !Object.hasOwn(item, 'selectable') || item.selectable === true\n        );\n\n        if (selectableFilteredItems.length === 0) {\n            return (hoverItemIndex = 0);\n        }\n\n        if (increment > 0 && hoverItemIndex === filteredItems.length - 1) {\n            hoverItemIndex = 0;\n        } else if (increment < 0 && hoverItemIndex === 0) {\n            hoverItemIndex = filteredItems.length - 1;\n        } else {\n            hoverItemIndex = hoverItemIndex + increment;\n        }\n\n        const hover = filteredItems[hoverItemIndex];\n\n        if (hover && hover.selectable === false) {\n            if (increment === 1 || increment === -1) setHoverIndex(increment);\n            return;\n        }\n    }\n\n    function isItemActive(item, value, itemId) {\n        if (multiple) return;\n        return value && value[itemId] === item[itemId];\n    }\n\n    function isItemFirst(itemIndex) {\n        return itemIndex === 0;\n    }\n\n    function isItemSelectable(item) {\n        return (item.groupHeader && item.selectable) || item.selectable || !item.hasOwnProperty('selectable');\n    }\n\n    const activeScroll = scrollAction;\n    const hoverScroll = scrollAction;\n\n    function scrollAction(node) {\n        return {\n            update(args) {\n                if (args.scroll) {\n                    handleListScroll();\n                    node.scrollIntoView({ behavior: 'auto', block: 'nearest' });\n                }\n            },\n        };\n    }\n\n    function setListWidth() {\n        const { width } = container.getBoundingClientRect();\n        list.style.width = listAutoWidth ? width + 'px' : 'auto';\n    }\n\n    let _floatingConfig = {\n        strategy: 'absolute',\n        placement: 'bottom-start',\n        middleware: [offset(listOffset), flip(), shift()],\n        autoUpdate: false,\n    };\n\n    const [floatingRef, floatingContent, floatingUpdate] = createFloatingActions(_floatingConfig);\n\n    $: if (container && floatingConfig?.autoUpdate === undefined) {\n        _floatingConfig.autoUpdate = true;\n    }\n\n    let prefloat = true;\n    function listMounted(list, listOpen) {\n        if (!list || !listOpen) return (prefloat = true);\n        setTimeout(() => {\n            prefloat = false;\n        }, 0);\n    }\n</script>\n\n<svelte:window on:click={handleClickOutside} on:keydown={handleKeyDown} />\n\n<div\n    class=\"svelte-select {containerClasses}\"\n    class:multi={multiple}\n    class:disabled\n    class:focused\n    class:list-open={listOpen}\n    class:show-chevron={showChevron}\n    class:error={hasError}\n    style={containerStyles}\n    on:pointerup|preventDefault={handleClick}\n    bind:this={container}\n    use:floatingRef\n    role=\"none\">\n    {#if listOpen}\n        <div\n            use:floatingContent\n            bind:this={list}\n            class=\"svelte-select-list\"\n            class:prefloat\n            on:scroll={handleListScroll}\n            on:pointerup|preventDefault|stopPropagation\n            on:mousedown|preventDefault|stopPropagation\n\t\t\trole=\"none\">\n            {#if $$slots['list-prepend']}<slot name=\"list-prepend\" />{/if}\n            {#if $$slots.list}<slot name=\"list\" {filteredItems} />\n            {:else if filteredItems.length > 0}\n                {#each filteredItems as item, i}\n                    <div\n                        on:mouseover={() => handleHover(i)}\n                        on:focus={() => handleHover(i)}\n                        on:click|stopPropagation={() => handleItemClick({ item, i })}\n                        on:keydown|preventDefault|stopPropagation\n                        class=\"list-item\"\n                        tabindex=\"-1\"\n                        role=\"none\">\n                        <div\n                            use:activeScroll={{ scroll: isItemActive(item, value, itemId), listDom }}\n                            use:hoverScroll={{ scroll: scrollToHoverItem === i, listDom }}\n                            class=\"item\"\n                            class:list-group-title={item.groupHeader}\n                            class:active={isItemActive(item, value, itemId)}\n                            class:first={isItemFirst(i)}\n                            class:hover={hoverItemIndex === i}\n                            class:group-item={item.groupItem}\n                            class:not-selectable={item?.selectable === false}>\n                            <slot name=\"item\" {item} index={i}>\n                                {item?.[label]}\n                            </slot>\n                        </div>\n                    </div>\n                {/each}\n            {:else if !hideEmptyState}\n                <slot name=\"empty\">\n                    <div class=\"empty\">No options</div>\n                </slot>\n            {/if}\n            {#if $$slots['list-append']}<slot name=\"list-append\" />{/if}\n        </div>\n    {/if}\n\n    <span aria-live=\"polite\" aria-atomic=\"false\" aria-relevant=\"additions text\" class=\"a11y-text\">\n        {#if focused}\n            <span id=\"aria-selection\">{ariaSelection}</span>\n            <span id=\"aria-context\">\n                {ariaContext}\n            </span>\n        {/if}\n    </span>\n\n    <div class=\"prepend\">\n        <slot name=\"prepend\" />\n    </div>\n\n    <div class=\"value-container\">\n        {#if hasValue}\n            {#if multiple}\n                {#each value as item, i}\n                    <div\n                        class=\"multi-item\"\n                        class:active={activeValue === i}\n                        class:disabled\n                        on:click|preventDefault={() => (multiFullItemClearable ? handleMultiItemClear(i) : {})}\n                        on:keydown|preventDefault|stopPropagation\n                        role=\"none\">\n                        <span class=\"multi-item-text\">\n                            <slot name=\"selection\" selection={item} index={i}>\n                                {item[label]}\n                            </slot>\n                        </span>\n\n                        {#if !disabled && !multiFullItemClearable && ClearIcon}\n                            <div\n                                class=\"multi-item-clear\"\n                                on:pointerup|preventDefault|stopPropagation={() => handleMultiItemClear(i)}>\n                                <slot name=\"multi-clear-icon\">\n                                    <ClearIcon />\n                                </slot>\n                            </div>\n                        {/if}\n                    </div>\n                {/each}\n            {:else}\n                <div class=\"selected-item\" class:hide-selected-item={hideSelectedItem}>\n                    <slot name=\"selection\" selection={value}>\n                        {value[label]}\n                    </slot>\n                </div>\n            {/if}\n        {/if}\n\n        <input\n            on:keydown={handleKeyDown}\n            on:blur={handleBlur}\n            on:focus={handleFocus}\n            readOnly={!searchable}\n            {..._inputAttributes}\n            bind:this={input}\n            bind:value={filterText}\n            placeholder={placeholderText}\n            style={inputStyles}\n            {disabled} />\n    </div>\n\n    <div class=\"indicators\">\n        {#if loading}\n            <div class=\"icon loading\" aria-hidden=\"true\">\n                <slot name=\"loading-icon\">\n                    <LoadingIcon />\n                </slot>\n            </div>\n        {/if}\n\n        {#if showClear}\n            <button type=\"button\" class=\"icon clear-select\" on:click={handleClear}>\n                <slot name=\"clear-icon\">\n                    <ClearIcon />\n                </slot>\n            </button>\n        {/if}\n\n        {#if showChevron}\n            <div class=\"icon chevron\" aria-hidden=\"true\">\n                <slot name=\"chevron-icon\" {listOpen}>\n                    <ChevronIcon />\n                </slot>\n            </div>\n        {/if}\n    </div>\n\n    <slot name=\"input-hidden\" {value}>\n        <input {name} type=\"hidden\" value={value ? JSON.stringify(value) : null} />\n    </slot>\n\n    {#if required && (!value || value.length === 0)}\n        <slot name=\"required\" {value}>\n            <select class=\"required\" required tabindex=\"-1\" aria-hidden=\"true\" />\n        </slot>\n    {/if}\n</div>\n\n<style>\n    .svelte-select {\n        /* deprecating camelCase custom props in favour of kebab-case for v5 */\n        --borderRadius: var(--border-radius);\n        --clearSelectColor: var(--clear-select-color);\n        --clearSelectWidth: var(--clear-select-width);\n        --disabledBackground: var(--disabled-background);\n        --disabledBorderColor: var(--disabled-border-color);\n        --disabledColor: var(--disabled-color);\n        --disabledPlaceholderColor: var(--disabled-placeholder-color);\n        --disabledPlaceholderOpacity: var(--disabled-placeholder-opacity);\n        --errorBackground: var(--error-background);\n        --errorBorder: var(--error-border);\n        --groupItemPaddingLeft: var(--group-item-padding-left);\n        --groupTitleColor: var(--group-title-color);\n        --groupTitleFontSize: var(--group-title-font-size);\n        --groupTitleFontWeight: var(--group-title-font-weight);\n        --groupTitlePadding: var(--group-title-padding);\n        --groupTitleTextTransform: var(--group-title-text-transform);\n        --groupTitleBorderColor: var(--group-title-border-color);\n        --groupTitleBorderWidth: var(--group-title-border-width);\n        --groupTitleBorderStyle: var(--group-title-border-style);\n        --indicatorColor: var(--chevron-color);\n        --indicatorHeight: var(--chevron-height);\n        --indicatorWidth: var(--chevron-width);\n        --inputColor: var(--input-color);\n        --inputLeft: var(--input-left);\n        --inputLetterSpacing: var(--input-letter-spacing);\n        --inputMargin: var(--input-margin);\n        --inputPadding: var(--input-padding);\n        --itemActiveBackground: var(--item-active-background);\n        --itemColor: var(--item-color);\n        --itemFirstBorderRadius: var(--item-first-border-radius);\n        --itemHoverBG: var(--item-hover-bg);\n        --itemHoverColor: var(--item-hover-color);\n        --itemIsActiveBG: var(--item-is-active-bg);\n        --itemIsActiveColor: var(--item-is-active-color);\n        --itemIsNotSelectableColor: var(--item-is-not-selectable-color);\n        --itemPadding: var(--item-padding);\n        --listBackground: var(--list-background);\n        --listBorder: var(--list-border);\n        --listBorderRadius: var(--list-border-radius);\n        --listEmptyColor: var(--list-empty-color);\n        --listEmptyPadding: var(--list-empty-padding);\n        --listEmptyTextAlign: var(--list-empty-text-align);\n        --listMaxHeight: var(--list-max-height);\n        --listPosition: var(--list-position);\n        --listShadow: var(--list-shadow);\n        --listZIndex: var(--list-z-index);\n        --multiItemBG: var(--multi-item-bg);\n        --multiItemBorderRadius: var(--multi-item-border-radius);\n        --multiItemDisabledHoverBg: var(--multi-item-disabled-hover-bg);\n        --multiItemDisabledHoverColor: var(--multi-item-disabled-hover-color);\n        --multiItemHeight: var(--multi-item-height);\n        --multiItemMargin: var(--multi-item-margin);\n        --multiItemPadding: var(--multi-item-padding);\n        --multiSelectInputMargin: var(--multi-select-input-margin);\n        --multiSelectInputPadding: var(--multi-select-input-padding);\n        --multiSelectPadding: var(--multi-select-padding);\n        --placeholderColor: var(--placeholder-color);\n        --placeholderOpacity: var(--placeholder-opacity);\n        --selectedItemPadding: var(--selected-item-padding);\n        --spinnerColor: var(--spinner-color);\n        --spinnerHeight: var(--spinner-height);\n        --spinnerWidth: var(--spinner-width);\n\n        --internal-padding: 0 0 0 16px;\n\n        border: var(--border, 1px solid #d8dbdf);\n        border-radius: var(--border-radius, 6px);\n        min-height: var(--height, 42px);\n        position: relative;\n        display: flex;\n        align-items: stretch;\n        padding: var(--padding, var(--internal-padding));\n        background: var(--background, #fff);\n        margin: var(--margin, 0);\n        width: var(--width, 100%);\n        font-size: var(--font-size, 16px);\n        max-height: var(--max-height);\n    }\n\n    * {\n        box-sizing: var(--box-sizing, border-box);\n    }\n\n    .svelte-select:hover {\n        border: var(--border-hover, 1px solid #b2b8bf);\n    }\n\n    .value-container {\n        display: flex;\n        flex: 1 1 0%;\n        flex-wrap: wrap;\n        align-items: center;\n        gap: 5px 10px;\n        padding: var(--value-container-padding, 5px 0);\n        position: relative;\n        overflow: var(--value-container-overflow, hidden);\n        align-self: stretch;\n    }\n\n    .prepend,\n    .indicators {\n        display: flex;\n        flex-shrink: 0;\n        align-items: center;\n    }\n\n    .indicators {\n        position: var(--indicators-position);\n        top: var(--indicators-top);\n        right: var(--indicators-right);\n        bottom: var(--indicators-bottom);\n    }\n\n    input {\n        position: absolute;\n        cursor: default;\n        border: none;\n        color: var(--input-color, var(--item-color));\n        padding: var(--input-padding, 0);\n        letter-spacing: var(--input-letter-spacing, inherit);\n        margin: var(--input-margin, 0);\n        min-width: 10px;\n        top: 0;\n        right: 0;\n        bottom: 0;\n        left: 0;\n        background: transparent;\n        font-size: var(--font-size, 16px);\n    }\n\n    :not(.multi) > .value-container > input {\n        width: 100%;\n        height: 100%;\n    }\n\n    input::placeholder {\n        color: var(--placeholder-color, #78848f);\n        opacity: var(--placeholder-opacity, 1);\n    }\n\n    input:focus {\n        outline: none;\n    }\n\n    .svelte-select.focused {\n        border: var(--border-focused, 1px solid #006fe8);\n        border-radius: var(--border-radius-focused, var(--border-radius, 6px));\n    }\n\n    .disabled {\n        background: var(--disabled-background, #ebedef);\n        border-color: var(--disabled-border-color, #ebedef);\n        color: var(--disabled-color, #c1c6cc);\n    }\n\n    .disabled input::placeholder {\n        color: var(--disabled-placeholder-color, #c1c6cc);\n        opacity: var(--disabled-placeholder-opacity, 1);\n    }\n\n    .selected-item {\n        position: relative;\n        overflow: var(--selected-item-overflow, hidden);\n        padding: var(--selected-item-padding, 0 20px 0 0);\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        color: var(--selected-item-color, inherit);\n        font-size: var(--font-size, 16px);\n    }\n\n    .multi .selected-item {\n        position: absolute;\n        line-height: var(--height, 42px);\n        height: var(--height, 42px);\n    }\n\n    .selected-item:focus {\n        outline: none;\n    }\n\n    .hide-selected-item {\n        opacity: 0;\n    }\n\n    .icon {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n\n    .clear-select {\n        all: unset;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: var(--clear-select-width, 40px);\n        height: var(--clear-select-height, 100%);\n        color: var(--clear-select-color, var(--icons-color));\n        margin: var(--clear-select-margin, 0);\n        pointer-events: all;\n        flex-shrink: 0;\n    }\n\n    .clear-select:focus {\n        outline: var(--clear-select-focus-outline, 1px solid #006fe8);\n    }\n\n    .loading {\n        width: var(--loading-width, 40px);\n        height: var(--loading-height);\n        color: var(--loading-color, var(--icons-color));\n        margin: var(--loading--margin, 0);\n        flex-shrink: 0;\n    }\n\n    .chevron {\n        width: var(--chevron-width, 40px);\n        height: var(--chevron-height, 40px);\n        background: var(--chevron-background, transparent);\n        pointer-events: var(--chevron-pointer-events, none);\n        color: var(--chevron-color, var(--icons-color));\n        border: var(--chevron-border, 0 0 0 1px solid #d8dbdf);\n        flex-shrink: 0;\n    }\n\n    .multi {\n        padding: var(--multi-select-padding, var(--internal-padding));\n    }\n\n    .multi input {\n        padding: var(--multi-select-input-padding, 0);\n        position: relative;\n        margin: var(--multi-select-input-margin, 5px 0);\n        flex: 1 1 40px;\n    }\n\n    .svelte-select.error {\n        border: var(--error-border, 1px solid #ff2d55);\n        background: var(--error-background, #fff);\n    }\n\n    .a11y-text {\n        z-index: 9999;\n        border: 0px;\n        clip: rect(1px, 1px, 1px, 1px);\n        height: 1px;\n        width: 1px;\n        position: absolute;\n        overflow: hidden;\n        padding: 0px;\n        white-space: nowrap;\n    }\n\n    .multi-item {\n        background: var(--multi-item-bg, #ebedef);\n        margin: var(--multi-item-margin, 0);\n        outline: var(--multi-item-outline, 1px solid #ddd);\n        border-radius: var(--multi-item-border-radius, 4px);\n        height: var(--multi-item-height, 25px);\n        line-height: var(--multi-item-height, 25px);\n        display: flex;\n        cursor: default;\n        padding: var(--multi-item-padding, 0 5px);\n        overflow: hidden;\n        gap: var(--multi-item-gap, 4px);\n        outline-offset: -1px;\n        max-width: var(--multi-max-width, none);\n        color: var(--multi-item-color, var(--item-color));\n    }\n\n    .multi-item.disabled:hover {\n        background: var(--multi-item-disabled-hover-bg, #ebedef);\n        color: var(--multi-item-disabled-hover-color, #c1c6cc);\n    }\n\n    .multi-item-text {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n    }\n\n    .multi-item-clear {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        --clear-icon-color: var(--multi-item-clear-icon-color, #000);\n    }\n\n    .multi-item.active {\n        outline: var(--multi-item-active-outline, 1px solid #006fe8);\n    }\n\n    .svelte-select-list {\n        box-shadow: var(--list-shadow, 0 2px 3px 0 rgba(44, 62, 80, 0.24));\n        border-radius: var(--list-border-radius, 4px);\n        max-height: var(--list-max-height, 252px);\n        overflow-y: auto;\n        background: var(--list-background, #fff);\n        position: var(--list-position, absolute);\n        z-index: var(--list-z-index, 2);\n        border: var(--list-border);\n    }\n\n    .prefloat {\n        opacity: 0;\n        pointer-events: none;\n    }\n\n    .list-group-title {\n        color: var(--group-title-color, #8f8f8f);\n        cursor: default;\n        font-size: var(--group-title-font-size, 16px);\n        font-weight: var(--group-title-font-weight, 600);\n        height: var(--height, 42px);\n        line-height: var(--height, 42px);\n        padding: var(--group-title-padding, 0 20px);\n        text-overflow: ellipsis;\n        overflow-x: hidden;\n        white-space: nowrap;\n        text-transform: var(--group-title-text-transform, uppercase);\n        border-width: var(--group-title-border-width, medium);\n        border-style: var(--group-title-border-style, none);\n        border-color: var(--group-title-border-color, color);\n    }\n\n    .empty {\n        text-align: var(--list-empty-text-align, center);\n        padding: var(--list-empty-padding, 20px 0);\n        color: var(--list-empty-color, #78848f);\n    }\n\n    .item {\n        cursor: default;\n        height: var(--item-height, var(--height, 42px));\n        line-height: var(--item-line-height, var(--height, 42px));\n        padding: var(--item-padding, 0 20px);\n        color: var(--item-color, inherit);\n        text-overflow: ellipsis;\n        overflow: hidden;\n        white-space: nowrap;\n        transition: var(--item-transition, all 0.2s);\n        align-items: center;\n        width: 100%;\n    }\n\n    .item.group-item {\n        padding-left: var(--group-item-padding-left, 40px);\n    }\n\n    .item:active {\n        background: var(--item-active-background, #b9daff);\n    }\n\n    .item.active {\n        background: var(--item-is-active-bg, #007aff);\n        color: var(--item-is-active-color, #fff);\n    }\n\n    .item.first {\n        border-radius: var(--item-first-border-radius, 4px 4px 0 0);\n    }\n\n    .item.hover:not(.active) {\n        background: var(--item-hover-bg, #e7f2ff);\n        color: var(--item-hover-color, inherit);\n    }\n\n    .item.not-selectable,\n    .item.hover.item.not-selectable,\n    .item.active.item.not-selectable,\n    .item.not-selectable:active {\n        color: var(--item-is-not-selectable-color, #999);\n        background: transparent;\n    }\n\n    .required {\n        opacity: 0;\n        z-index: -1;\n        position: absolute;\n        top: 0;\n        left: 0;\n        bottom: 0;\n        right: 0;\n    }\n</style>\n","<script>\r\n\timport { getContext } from \"svelte\";\r\n\timport * as Utilities from \"../../../helpers/utilities.js\";\r\n\timport * as PileUtilities from \"../../../helpers/pile-utilities.js\";\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\timport SliderInput from \"../../components/SliderInput.svelte\";\r\n\timport Select from 'svelte-select';\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let item;\r\n\r\n\tlet form;\r\n\r\n\tconst itemQuantity = Utilities.getItemQuantity(item);\r\n\tconst sliderQuantity = itemQuantity + (application.options?.quantityAdjustment ?? 0);\r\n\tconst canItemStack = PileUtilities.canItemStack(item);\r\n\r\n\tlet quantity = 1;\r\n\tlet secret = false;\r\n\tlet selectedActor = localStorage.getItem(\"item-piles-give-item\") ?? false;\r\n\r\n\tlet items = Array.from(game.actors)\r\n\t\t.filter(actor => {\r\n\t\t\treturn game.user.isGM || (actor.ownership[\"default\"] >= 1 || actor.ownership[game.user.id] >= 1);\r\n\t\t})\r\n\t\t.concat(game.users.map(user => user.character).filter(Boolean))\r\n\t\t.filter(actor => actor !== item.parent)\r\n\t\t.filter((actor, index, self) => {\r\n\t\t\treturn index === self.findIndex(a => a.uuid === actor.uuid)\r\n\t\t})\r\n\t\t.map(actor => ({\r\n\t\t\tvalue: actor.uuid,\r\n\t\t\tlabel: actor.name,\r\n\t\t\tactor,\r\n\t\t\tgroup: actor.hasPlayerOwner ? \"Player Characters\" : \"Unassigned Characters\"\r\n\t\t}))\r\n\t\t.sort((a, b) => {\r\n\t\t\treturn (a.group >= b.group ? 100000 : -100000) + (a.label >= b.label ? 1 : -1);\r\n\t\t});\r\n\r\n\tif (selectedActor && !items.some(data => data.value === selectedActor)) {\r\n\t\tselectedActor = false;\r\n\t}\r\n\r\n\tconst groupBy = (item) => item.group;\r\n\r\n\tfunction requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n\tfunction submit() {\r\n\t\tlocalStorage.setItem(\"item-piles-give-item\", selectedActor.value)\r\n\t\tapplication.options.resolve({ quantity, secret, target: selectedActor.value });\r\n\t\tapplication.close();\r\n\t}\r\n\r\n</script>\r\n\r\n<form autocomplete=\"off\" bind:this={form} class=\"item-piles-flexcol\" on:submit|once|preventDefault={submit}\r\n      style=\"padding:0.5rem;\">\r\n\r\n\t<h3 style=\"text-align: center;\">\r\n\t\t{localize(`ITEM-PILES.Dialogs.GiveItems.Header`, {\r\n\t\t\titem_name: item.name\r\n\t\t})}\r\n\t</h3>\r\n\r\n\t{#if itemQuantity > 1 && canItemStack}\r\n\t\t<div class=\"form-group item-piles-text-center\">\r\n\t\t\t<label>{localize(`ITEM-PILES.Dialogs.GiveItems.ContentMultipleQuantity`, {\r\n\t\t\t\tquantity: itemQuantity,\r\n\t\t\t\titemName: item.name\r\n\t\t\t})}</label>\r\n\t\t</div>\r\n\t\t<SliderInput min={1} max={sliderQuantity} maxInput={sliderQuantity} divideBy={1} bind:value={quantity}/>\r\n\t{/if}\r\n\r\n\t<div class=\"form-group\">\r\n\t\t<Select\r\n\t\t\t--background=\"rgba(0, 0, 0, 0.05)\"\r\n\t\t\t--border-radius=\"5px\"\r\n\t\t\t--font-family=\"inherit\"\r\n\t\t\t--font-size=\"0.833rem\"\r\n\t\t\t--group-item-padding-left=\"1rem\"\r\n\t\t\t--group-title-font-size=\"0.833rem\"\r\n\t\t\t--group-title-font-weight=\"bold\"\r\n\t\t\t--height=\"calc(var(--form-field-height) + 1px)\"\r\n\t\t\t--input-color=\"black\"\r\n\t\t\t--item-padding=\"0.25rem\"\r\n\t\t\t--margin=\"0.25rem 0\"\r\n\t\t\t--padding=\"0 8px\"\r\n\t\t\t--text-overflow=\"ellipsis\"\r\n\t\t\tbind:value={selectedActor}\r\n\t\t\tfloatingConfig={{ strategy: \"fixed\", placement: \"bottom\" }}\r\n\t\t\t{groupBy}\r\n\t\t\t{items}\r\n\t\t\tplaceholder=\"{localize('ITEM-PILES.Dialogs.GiveItems.SelectPlaceholder')}\"\r\n\t\t></Select>\r\n\t</div>\r\n\r\n\t<div class=\"form-group item-piles-flexrow\">\r\n\t\t<input id=\"item-piles-give-item-secret\" type=\"checkbox\" bind:checked={secret}/>\r\n\t\t<label for=\"item-piles-give-item-secret\">{localize(\"ITEM-PILES.Dialogs.GiveItems.Secret\")}</label>\r\n\t</div>\r\n\r\n\t<footer class=\"sheet-footer item-piles-flexrow\" style=\"margin-top: 0.25rem;\">\r\n\t\t<button disabled={!selectedActor} on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t<i class=\"fas fa-box\"></i>\r\n\t\t\t{localize(`ITEM-PILES.Dialogs.GiveItems.Submit`)}\r\n\t\t</button>\r\n\t\t<button on:click={() => { application.close() }} type=\"button\">\r\n\t\t\t<i class=\"fas fa-times\"></i>\r\n\t\t\t{localize(\"Cancel\")}\r\n\t\t</button>\r\n\t</footer>\r\n\r\n</form>\r\n","import GiveItemsShell from \"./give-items-shell.svelte\";\r\nimport { TJSDialog } from '#runtime/svelte/application';\r\nimport { getActiveApps } from \"../../../helpers/helpers\";\r\n\r\nexport default class GiveItems extends TJSDialog {\r\n\r\n\t/**\r\n\t *\r\n\t * @param item\r\n\t * @param options\r\n\t */\r\n\tconstructor(item, options = {}) {\r\n\t\tsuper({\r\n\t\t\ttitle: game.i18n.localize(`ITEM-PILES.Dialogs.GiveItems.Title`),\r\n\t\t\tid: `item-pile-give-items-${item.id}-${foundry.utils.randomID()}`,\r\n\t\t\tcontent: {\r\n\t\t\t\tclass: GiveItemsShell,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\titem\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmodal: true,\r\n\t\t\tdraggable: false,\r\n\t\t}, {\r\n\t\t\t...options,\r\n\t\t\tfocusAuto: false,\r\n\t\t\tclose: () => this.options.resolve?.(null)\r\n\t\t});\r\n\t\tthis.item = item;\r\n\t}\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\twidth: 430,\r\n\t\t\theight: \"auto\",\r\n\t\t\tclasses: [\"item-piles-app visible-overflow\"]\r\n\t\t})\r\n\t}\r\n\r\n\tstatic getActiveApps(item) {\r\n\t\treturn getActiveApps(`item-pile-give-items-${item.id}`);\r\n\t}\r\n\r\n\tstatic async show(item, options = {}) {\r\n\t\tconst apps = this.getActiveApps(item);\r\n\t\tif (apps.length) {\r\n\t\t\tfor (let app of apps) {\r\n\t\t\t\tapp.render(false, { focus: true });\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\toptions.resolve = resolve;\r\n\t\t\tnew this(item, options).render(true, { focus: true });\r\n\t\t})\r\n\t}\r\n\r\n}\r\n","import GiveItems from \"../applications/dialogs/give-items-dialog/give-items-dialog.js\";\nimport PrivateAPI from \"../API/private-api.js\";\nimport CONSTANTS from \"../constants/constants.js\";\n\nexport default {\n\n\t\"VERSION\": \"1.0.8\",\n\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n\t\"ACTOR_CLASS_TYPE\": \"character\",\n\n\t// The item class type is the type of item that will be used for the default loot item\n\t\"ITEM_CLASS_LOOT_TYPE\": \"loot\",\n\n\t// The item class type is the type of item that will be used for the default weapon item\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"weapon\",\n\n\t// The item class type is the type of item that will be used for the default equipment item\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"equipment\",\n\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price.value\",\n\n\t// Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n\t\"ITEM_FILTERS\": [\n\t\t{\n\t\t\t\"path\": \"type\",\n\t\t\t\"filters\": \"spell,feat,class,subclass,background\"\n\t\t},\n\t\t{\n\t\t\t\"path\": \"system.type.value\",\n\t\t\t\"filters\": \"natural\"\n\t\t}\n\t],\n\n\t\"UNSTACKABLE_ITEM_TYPES\": [\"container\"],\n\n\t// This function is an optional system handler that specifically transforms an item when it is added to actors\n\t\"ITEM_TRANSFORMER\": async (itemData) => {\n\t\t[\"equipped\", \"proficient\", \"prepared\", \"attuned\"].forEach(key => {\n\t\t\tif (itemData?.system?.[key] !== undefined) {\n\t\t\t\tdelete itemData.system[key];\n\t\t\t}\n\t\t});\n\t\tif (itemData.type === \"spell\") {\n\t\t\ttry {\n\t\t\t\tconst scroll = await Item.implementation.createScrollFromSpell(itemData);\n\t\t\t\titemData = scroll.toObject();\n\t\t\t} catch (err) {\n\t\t\t}\n\t\t}\n\t\treturn itemData;\n\t},\n\n\t\"ITEM_TYPE_HANDLERS\": {\n\t\t\"GLOBAL\": {\n\t\t\t[CONSTANTS.ITEM_TYPE_METHODS.IS_CONTAINED]: ({ item }) => {\n\t\t\t\tconst itemData = item instanceof Item ? item.toObject() : item;\n\t\t\t\treturn !!itemData?.system?.container;\n\t\t\t},\n\t\t\t[CONSTANTS.ITEM_TYPE_METHODS.IS_CONTAINED_PATH]: \"system.container\"\n\t\t},\n\t\t\"container\": {\n\t\t\t[CONSTANTS.ITEM_TYPE_METHODS.HAS_CURRENCY]: true,\n\t\t\t[CONSTANTS.ITEM_TYPE_METHODS.CONTENTS]: ({ item }) => {\n\t\t\t\treturn item.system.contents.contents;\n\t\t\t},\n\t\t\t[CONSTANTS.ITEM_TYPE_METHODS.TRANSFER]: ({ item, items, raw = false } = {}) => {\n\t\t\t\tfor (const containedItem of item.system.contents.contents) {\n\t\t\t\t\titems.push(raw ? containedItem : containedItem.toObject());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t// This function is an optional system handler that specifically transforms an item's price into a more unified numeric format\n\t\"ITEM_COST_TRANSFORMER\": (item, currencies) => {\n\t\tconst overallCost = Number(foundry.utils.getProperty(item, \"system.price.value\")) ?? 0;\n\t\tconst priceDenomination = foundry.utils.getProperty(item, \"system.price.denomination\");\n\t\tif (priceDenomination) {\n\t\t\tconst currencyDenomination = currencies\n\t\t\t\t.filter(currency => currency.type === \"attribute\")\n\t\t\t\t.find(currency => {\n\t\t\t\t\treturn currency.data.path.toLowerCase().endsWith(priceDenomination);\n\t\t\t\t});\n\t\t\tif (currencyDenomination) {\n\t\t\t\treturn overallCost * currencyDenomination.exchangeRate;\n\t\t\t}\n\t\t}\n\t\treturn overallCost ?? 0;\n\t},\n\n\t\"PRICE_MODIFIER_TRANSFORMER\": ({\n\t\tbuyPriceModifier,\n\t\tsellPriceModifier,\n\t\tactor = false,\n\t\tactorPriceModifiers = []\n\t} = {}) => {\n\n\t\tconst modifiers = {\n\t\t\tbuyPriceModifier,\n\t\t\tsellPriceModifier\n\t\t};\n\n\t\tif (!actor) return modifiers;\n\n\t\tconst groupModifiers = actorPriceModifiers\n\t\t\t.map(data => ({ ...data, actor: fromUuidSync(data.actorUuid) }))\n\t\t\t.filter(data => {\n\t\t\t\treturn data.actor && data.actor.type === \"group\" && data.actor.system.members.some(member => member === actor)\n\t\t\t});\n\n\t\tmodifiers.buyPriceModifier = groupModifiers.reduce((acc, data) => {\n\t\t\treturn data.override ? data.buyPriceModifier ?? acc : acc * data.buyPriceModifier;\n\t\t}, buyPriceModifier);\n\n\t\tmodifiers.sellPriceModifier = groupModifiers.reduce((acc, data) => {\n\t\t\treturn data.override ? data.sellPriceModifier ?? acc : acc * data.sellPriceModifier;\n\t\t}, sellPriceModifier);\n\n\t\treturn modifiers;\n\n\t},\n\n\t\"PILE_DEFAULTS\": {\n\t\tmerchantColumns: [{\n\t\t\tlabel: \"<i class=\\\"fa-solid fa-shield\\\"></i>\",\n\t\t\tpath: \"system.equipped\",\n\t\t\tformatting: \"{#}\",\n\t\t\tbuying: false,\n\t\t\tselling: true,\n\t\t\tmapping: {\n\t\t\t\t\"true\": \"\",\n\t\t\t\t\"false\": \"\"\n\t\t\t}\n\t\t}, {\n\t\t\tlabel: \"Rarity\",\n\t\t\tpath: \"system.rarity\",\n\t\t\tformatting: \"{#}\",\n\t\t\tbuying: true,\n\t\t\tselling: true,\n\t\t\tmapping: {\n\t\t\t\t\"common\": \"DND5E.ItemRarityCommon\",\n\t\t\t\t\"uncommon\": \"DND5E.ItemRarityUncommon\",\n\t\t\t\t\"rare\": \"DND5E.ItemRarityRare\",\n\t\t\t\t\"veryRare\": \"DND5E.ItemRarityVeryRare\",\n\t\t\t\t\"legendary\": \"DND5E.ItemRarityLegendary\",\n\t\t\t\t\"artifact\": \"DND5E.ItemRarityArtifact\"\n\t\t\t}\n\t\t}]\n\t},\n\n\t// Item similarities determines how item piles detect similarities and differences in the system\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\", \"system.container\"],\n\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n\t// In the case of attributes, the path is relative to the \"actor.system\"\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n\t\"CURRENCIES\": [\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND5E.CurrencyPP\",\n\t\t\timg: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\n\t\t\tabbreviation: \"{#}PP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.pp\"\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 10\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND5E.CurrencyGP\",\n\t\t\timg: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n\t\t\tabbreviation: \"{#}GP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.gp\",\n\t\t\t},\n\t\t\tprimary: true,\n\t\t\texchangeRate: 1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND5E.CurrencyEP\",\n\t\t\timg: \"icons/commodities/currency/coin-inset-copper-axe.webp\",\n\t\t\tabbreviation: \"{#}EP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.ep\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.5\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND5E.CurrencySP\",\n\t\t\timg: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\n\t\t\tabbreviation: \"{#}SP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.sp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND5E.CurrencyCP\",\n\t\t\timg: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\n\t\t\tabbreviation: \"{#}CP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.cp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.01\n\t\t}\n\t],\n\n\t\"VAULT_STYLES\": [\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"artifact\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,191,0,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"legendary\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,119,0,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"veryRare\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,0,247,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"rare\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(0,136,255,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"uncommon\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(0,255,9,1)\"\n\t\t\t}\n\t\t}\n\t],\n\n\t\"SYSTEM_HOOKS\": () => {\n\n\t\tHooks.on(\"dnd5e.getItemContextOptions\", (item, options) => {\n\t\t\toptions.push({\n\t\t\t\tname: game.i18n.localize(\"ITEM-PILES.ContextMenu.GiveToCharacter\"),\n\t\t\t\ticon: \"<i class='fa fa-user'></i>\",\n\t\t\t\tcallback: async () => {\n\t\t\t\t\tconst result = await GiveItems.show(item);\n\t\t\t\t\tif (!result) return;\n\t\t\t\t\tPrivateAPI._giveItem({\n\t\t\t\t\t\titemData: {\n\t\t\t\t\t\t\titem: item.toObject(),\n\t\t\t\t\t\t\tquantity: result.quantity\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsource: item.parent.uuid,\n\t\t\t\t\t\ttarget: result.target,\n\t\t\t\t\t\tsecret: result.secret,\n\t\t\t\t\t}, { skipQuantityDialog: true })\n\t\t\t\t},\n\t\t\t\tcondition: !game.itempiles.API.isItemInvalid(item)\n\t\t\t})\n\t\t});\n\n\t}\n}\n","export default {\n\n\t\"VERSION\": \"1.0.3\",\n\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n\t\"ACTOR_CLASS_TYPE\": \"character\",\n\n\t// The item class type is the type of item that will be used for the default loot item\n\t\"ITEM_CLASS_LOOT_TYPE\": \"loot\",\n\n\t// The item class type is the type of item that will be used for the default weapon item\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"weapon\", \n\n\t// The item class type is the type of item that will be used for the default equipment item\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"equipment\",\n\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\n\n\t// Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n\t\"ITEM_FILTERS\": [\n\t\t{\n\t\t\t\"path\": \"type\",\n\t\t\t\"filters\": \"spell,feat,class,subclass,background\"\n\t\t},\n\t\t{\n\t\t\t\"path\": \"system.weaponType\",\n\t\t\t\"filters\": \"natural\"\n\t\t}\n\t],\n\n\t// This function is an optional system handler that specifically transforms an item when it is added to actors\n\t\"ITEM_TRANSFORMER\": async (itemData) => {\n\t\t[\"equipped\", \"proficient\", \"prepared\"].forEach(key => {\n\t\t\tif (itemData?.system?.[key] !== undefined) {\n\t\t\t\tdelete itemData.system[key];\n\t\t\t}\n\t\t});\n\t\tfoundry.utils.setProperty(itemData, \"system.attunement\", Math.min(CONFIG.DND5E.attunementTypes.REQUIRED, itemData?.system?.attunement ?? 0));\n\t\tif (itemData.type === \"spell\") {\n\t\t\ttry {\n\t\t\t\tconst scroll = await Item.implementation.createScrollFromSpell(itemData);\n\t\t\t\titemData = scroll.toObject();\n\t\t\t} catch (err) {\n\t\t\t}\n\t\t}\n\t\treturn itemData;\n\t},\n\n\t// Item similarities determines how item piles detect similarities and differences in the system\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n\t// In the case of attributes, the path is relative to the \"actor.system\"\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n\t\"CURRENCIES\": [\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND5E.CurrencyPP\",\n\t\t\timg: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\n\t\t\tabbreviation: \"{#}PP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.pp\"\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 10\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND5E.CurrencyGP\",\n\t\t\timg: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n\t\t\tabbreviation: \"{#}GP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.gp\",\n\t\t\t},\n\t\t\tprimary: true,\n\t\t\texchangeRate: 1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND5E.CurrencyEP\",\n\t\t\timg: \"icons/commodities/currency/coin-inset-copper-axe.webp\",\n\t\t\tabbreviation: \"{#}EP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.ep\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.5\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND5E.CurrencySP\",\n\t\t\timg: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\n\t\t\tabbreviation: \"{#}SP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.sp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND5E.CurrencyCP\",\n\t\t\timg: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\n\t\t\tabbreviation: \"{#}CP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.cp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.01\n\t\t}\n\t],\n\n\tVAULT_STYLES: [\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"artifact\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,191,0,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"legendary\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,119,0,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"veryRare\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,0,247,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"rare\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(0,136,255,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"uncommon\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(0,255,9,1)\"\n\t\t\t}\n\t\t}\n\t]\n}\n","export default {\r\n\r\n\t\"VERSION\": \"1.1.0\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"npc\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"loot\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"weapon\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"equipment\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n\t// This function is an optional system handler that specifically transforms an item's price into a more unified numeric format\r\n\t\"ITEM_COST_TRANSFORMER\": (item, currencies) => {\r\n\t\t// Account for wand charges, broken condition, and other traits that are not reflected in base price.\r\n\t\treturn item.getValue({ sellValue: 1.0, single: true });\r\n\t},\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"attack,buff,class,feat,race,spell\"\r\n\t\t}\r\n\t],\r\n\r\n\t\r\n\t\"UNSTACKABLE_ITEM_TYPES\": [\"container\"],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\", \"system.subType\", \"system.masterwork\", \"system.enh\", \"system.armor.enh\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"PF1.Currency.Full.pp\",\r\n\t\t\timg: \"systems/pf1/icons/items/inventory/coins-silver.jpg\",\r\n\t\t\tabbreviation: \"{#}P\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.pp\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 10\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"PF1.Currency.Full.gp\",\r\n\t\t\timg: \"systems/pf1/icons/items/inventory/coin-gold.jpg\",\r\n\t\t\tabbreviation: \"{#}G\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.gp\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"PF1.Currency.Full.sp\",\r\n\t\t\timg: \"systems/pf1/icons/items/inventory/coin-silver.jpg\",\r\n\t\t\tabbreviation: \"{#}S\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.sp\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"PF1.Currency.Full.cp\",\r\n\t\t\timg: \"systems/pf1/icons/items/inventory/coin-copper.jpg\",\r\n\t\t\tabbreviation: \"{#}C\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.cp\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.01\r\n\t\t}\r\n\t]\r\n};\r\n","// PF1 v9.09.6\nexport default {\n\n\t\"VERSION\": \"1.0.5\",\n\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n\t\"ACTOR_CLASS_TYPE\": \"npc\",\n\n\t// The item class type is the type of item that will be used for the default loot item\n\t\"ITEM_CLASS_LOOT_TYPE\": \"equipment\",\n\n\t// The item class type is the type of item that will be used for the default weapon item\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \n\n\t// The item class type is the type of item that will be used for the default equipment item\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\n\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\n\n\t// This function is an optional system handler that specifically transforms an item's price into a more unified numeric format\n\t\"ITEM_COST_TRANSFORMER\": (item, currencies) => {\n\t\t// Account for wand charges, broken condition, and other traits that are not reflected in base price.\n\t\t// Spoof quantity to 1 temporarily\n\t\tconst origQuantity = item.system.quantity;\n\t\titem.system.quantity = 1;\n\t\t// Get actual value\n\t\tconst value = item.getValue({ sellValue: 1.0 });\n\t\t// Restore quantity\n\t\titem.system.quantity = origQuantity;\n\t\treturn value;\n\t},\n\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n\t\"ITEM_FILTERS\": [\n\t\t{\n\t\t\t\"path\": \"type\",\n\t\t\t\"filters\": \"attack,buff,class,feat,race,spell\"\n\t\t}\n\t],\n\n\t// Item similarities determines how item piles detect similarities and differences in the system\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n\t// In the case of attributes, the path is relative to the \"actor.system\"\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n\t\"CURRENCIES\": [\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"PF1.CurrencyPlatinumP\",\n\t\t\timg: \"systems/pf1/icons/items/inventory/coins-silver.jpg\",\n\t\t\tabbreviation: \"{#}P\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.pp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 10\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"PF1.CurrencyGoldP\",\n\t\t\timg: \"systems/pf1/icons/items/inventory/coin-gold.jpg\",\n\t\t\tabbreviation: \"{#}G\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.gp\",\n\t\t\t},\n\t\t\tprimary: true,\n\t\t\texchangeRate: 1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"PF1.CurrencySilverP\",\n\t\t\timg: \"systems/pf1/icons/items/inventory/coin-silver.jpg\",\n\t\t\tabbreviation: \"{#}S\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.sp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"PF1.CurrencyCopperP\",\n\t\t\timg: \"systems/pf1/icons/items/inventory/coin-copper.jpg\",\n\t\t\tabbreviation: \"{#}C\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.cp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.01\n\t\t}\n\t]\n};\n","<script>\r\n\r\n\texport let item;\r\n\r\n</script>\r\n\r\n<form>\r\n\r\n\t<header class=\"sheet-header\">\r\n\t\t<img data-edit=\"img\" src={item.img}>\r\n\t\t<div class=\"details\">\r\n\t\t\t<input disabled name=\"name\" placeholder=\"Name\" spellcheck=\"false\" type=\"text\" value={item.name}/>\r\n\r\n\t\t\t<span class=\"level\">\r\n\t\t\t\t\t<span>Item</span>\r\n\t\t\t\t\t<input data-property=\"system.level.value\" disabled type=\"text\" value=\"?\">\r\n\t\t\t</span>\r\n\t\t\t<template class=\"traits-extra\"></template>\r\n\t\t\t<!-- showTraits true -->\r\n\t\t\t<tags class=\"tagify paizo-style tags tagify--noTags tagify--empty\" data-name=\"system.traits.value\" disabled=\"\"\r\n\t\t\t      tabindex=\"-1\">\r\n\t\t\t\t<select class=\"tag\">\r\n\t\t\t\t\t<option value=\"common\">Unknown</option>\r\n\t\t\t\t</select>\r\n\r\n\t\t\t\t<span aria-autocomplete=\"both\" aria-multiline=\"false\" aria-placeholder=\"Traits\" class=\"tagify__input\"\r\n\t\t\t\t      data-placeholder=\"Traits\"\r\n\t\t\t\t      role=\"textbox\" tabindex=\"0\"></span>\r\n\t\t\t\t\r\n\t\t\t</tags>\r\n\t\t\t<input class=\"paizo-style tags\" data-dtype=\"JSON\" disabled=\"\" name=\"system.traits.value\" placeholder=\"Traits\"\r\n\t\t\t       tabindex=\"-1\" value=\"[]\">\r\n\t\t</div>\r\n\t</header>\r\n\r\n\t<span style=\"padding: 0.5rem;\">\r\n\t\t{@html item.system.description.value}\r\n\t</span>\r\n\r\n</form>\r\n\r\n<style lang=\"scss\">\r\n\r\n</style>\r\n","import { TJSDialog } from \"#runtime/svelte/application\";\r\nimport BasicItemDialog from \"../applications/components/BasicItemDialog.svelte\";\r\n\r\nexport default {\r\n\r\n\t\"VERSION\": \"1.0.4\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"loot\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"equipment\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n\t// The quantity for price attribute is the path to the attribute on each item that determine how many you get for its price\r\n\t\"QUANTITY_FOR_PRICE_ATTRIBUTE\": \"system.price.per\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [{\r\n\t\t\"path\": \"type\",\r\n\t\t\"filters\": 'action,ancestry,background,class,condition,deity,effect,feat,heritage,lore,melee,spell,spellcastingEntry'\r\n\t}],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\", \"system.temporary.value\"],\r\n\r\n\t// This function is an optional system handler that specifically transforms an item's price into a more unified numeric format\r\n\t\"ITEM_COST_TRANSFORMER\": (item) => {\r\n\t\tconst itemCost = foundry.utils.getProperty(item, \"system.price\");\r\n\t\tconst { copperValue } = new game.pf2e.Coins(itemCost?.value ?? {});\r\n\t\treturn copperValue / 100;\r\n\t},\r\n\r\n\t\"PREVIEW_ITEM_TRANSFORMER\": (item) => {\r\n\t\tif (game.user.isGM || item?.identificationStatus !== \"unidentified\") return item;\r\n\t\tnew TJSDialog({\r\n\t\t\ttitle: item.name,\r\n\t\t\tcontent: {\r\n\t\t\t\tclass: BasicItemDialog,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\titem\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\tclasses: [\"pf2e item sheet dorako-ui\"],\r\n\t\t\tresizable: false,\r\n\t\t\theight: \"auto\",\r\n\t\t\twidth: \"auto\"\r\n\t\t}).render(true);\r\n\t\treturn false;\r\n\t},\r\n\r\n\t\"PILE_DEFAULTS\": {\r\n\t\tmerchantColumns: [{\r\n\t\t\t\"label\": \"Rarity\",\r\n\t\t\t\"path\": \"system.traits.rarity\",\r\n\t\t\t\"formatting\": \"{#}\",\r\n\t\t\t\"buying\": true,\r\n\t\t\t\"selling\": true,\r\n\t\t\t\"mapping\": {\r\n\t\t\t\t\"common\": \"PF2E.TraitCommon\",\r\n\t\t\t\t\"uncommon\": \"PF2E.TraitUncommon\",\r\n\t\t\t\t\"rare\": \"PF2E.TraitRare\",\r\n\t\t\t\t\"unique\": \"PF2E.TraitUnique\"\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\t\"label\": \"Bulk\",\r\n\t\t\t\"path\": \"system.bulk.value\",\r\n\t\t\t\"formatting\": \"{#}\",\r\n\t\t\t\"buying\": true,\r\n\t\t\t\"selling\": true,\r\n\t\t\t\"mapping\": { \"0\": \"\" }\r\n\t\t}]\r\n\t},\r\n\r\n\t\"TOKEN_FLAG_DEFAULTS\": {\r\n\t\tflags: {\r\n\t\t\tpf2e: {\r\n\t\t\t\tlinkToActorSize: false,\r\n\t\t\t\tautoscale: false\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()`, put it into `data.item`, and strip out any module data\r\n\t\"CURRENCIES\": [{\r\n\t\ttype: \"item\",\r\n\t\tname: \"Platinum Pieces\",\r\n\t\timg: \"systems/pf2e/icons/equipment/treasure/currency/platinum-pieces.webp\",\r\n\t\tabbreviation: \"{#}PP\",\r\n\t\tdata: {\r\n\t\t\tuuid: \"Compendium.pf2e.equipment-srd.JuNPeK5Qm1w6wpb4\"\r\n\t\t},\r\n\t\tprimary: false,\r\n\t\texchangeRate: 10\r\n\t}, {\r\n\t\ttype: \"item\",\r\n\t\tname: \"Gold Pieces\",\r\n\t\timg: \"systems/pf2e/icons/equipment/treasure/currency/gold-pieces.webp\",\r\n\t\tabbreviation: \"{#}GP\",\r\n\t\tdata: {\r\n\t\t\tuuid: \"Compendium.pf2e.equipment-srd.B6B7tBWJSqOBz5zz\"\r\n\t\t},\r\n\t\tprimary: true,\r\n\t\texchangeRate: 1\r\n\t}, {\r\n\t\ttype: \"item\",\r\n\t\tname: \"Silver Pieces\",\r\n\t\timg: \"systems/pf2e/icons/equipment/treasure/currency/silver-pieces.webp\",\r\n\t\tabbreviation: \"{#}SP\",\r\n\t\tdata: {\r\n\t\t\tuuid: \"Compendium.pf2e.equipment-srd.5Ew82vBF9YfaiY9f\"\r\n\t\t},\r\n\t\tprimary: false,\r\n\t\texchangeRate: 0.1\r\n\t}, {\r\n\t\ttype: \"item\",\r\n\t\tname: \"Copper Pieces\",\r\n\t\timg: \"systems/pf2e/icons/equipment/treasure/currency/copper-pieces.webp\",\r\n\t\tabbreviation: \"{#}CP\",\r\n\t\tdata: {\r\n\t\t\tuuid: \"Compendium.pf2e.equipment-srd.lzJ8AVhRcbFul5fh\"\r\n\t\t},\r\n\t\tprimary: false,\r\n\t\texchangeRate: 0.01\r\n\t}]\r\n}\r\n","// Item Piles Definitions for Foundry VTT Game System Dungeonslayers 4\n\nexport default {\n\n\t\"VERSION\": \"1.0.2\",\n\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n\t\"ACTOR_CLASS_TYPE\": \"character\",\n\n\t// The item class type is the type of item that will be used for the default loot item\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\n\n\t// The item class type is the type of item that will be used for the default weapon item\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \n\n\t// The item class type is the type of item that will be used for the default equipment item\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\n\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\n\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n\t\"ITEM_FILTERS\": [\n\t\t{\n\t\t\t\"path\": \"type\",\n\t\t\t\"filters\": \"spell,talent,racialAbility,language,alphabet,specialCreatureAbility\"\n\t\t}\n\t],\n\n\t// Item similarities determines how item piles detect similarities and differences in the system\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n\t// In the case of attributes, the path is relative to the \"actor.system\"\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n\t\"CURRENCIES\": [\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DS4.CharacterCurrencyGold\",\n\t\t\timg: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n\t\t\tabbreviation: \"{#}G\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.gold\",\n\t\t\t},\n\t\t\tprimary: true,\n\t\t\texchangeRate: 1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DS4.CharacterCurrencySilver\",\n\t\t\timg: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\n\t\t\tabbreviation: \"{#}S\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.silver\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DS4.CharacterCurrencyCopper\",\n\t\t\timg: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\n\t\t\tabbreviation: \"{#}C\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.copper\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.01\n\t\t}\n\t]\n}\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.2\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"npc\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"equipment\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"spell,feat,class,race,attack,full-attack,buff,aura,alignment,enhancement,damage-type,material\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"DND5E.CurrencyPP\",\r\n\t\t\timg: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\r\n\t\t\tabbreviation: \"{#}PP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.pp\"\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 10\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"DND5E.CurrencyGP\",\r\n\t\t\timg: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\r\n\t\t\tabbreviation: \"{#}GP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.gp\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"DND5E.CurrencySP\",\r\n\t\t\timg: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\r\n\t\t\tabbreviation: \"{#}SP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.sp\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"DND5E.CurrencyCP\",\r\n\t\t\timg: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\r\n\t\t\tabbreviation: \"{#}CP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.cp\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.01\r\n\t\t}\r\n\t]\r\n}\r\n","export default {\n\n\t\"VERSION\": \"1.0.2\",\n\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n\t\"ACTOR_CLASS_TYPE\": \"npc2\",\n\n\t// The item class type is the type of item that will be used for the default loot item\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\n\n\t// The item class type is the type of item that will be used for the default weapon item\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \n\n\t// The item class type is the type of item that will be used for the default equipment item\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\n\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\n\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n\t\"ITEM_FILTERS\": [\n\t\t{\n\t\t\t\"path\": \"type\",\n\t\t\t\"filters\": \"attack,buff,class,feat,race,spell\"\n\t\t}\n\t],\n\n\t// Item similarities determines how item piles detect similarities and differences in the system\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n\t\"CURRENCIES\": [\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"SFRPG.Currencies.Credits\",\n\t\t\timg: \"systems/sfrpg/icons/equipment/goods/credstick.webp\",\n\t\t\tabbreviation: \"{#}C\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.credit\",\n\t\t\t},\n\t\t\tprimary: true,\n\t\t\texchangeRate: 1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"SFRPG.Currencies.UPBs\",\n\t\t\timg: \"systems/sfrpg/icons/equipment/goods/upb.webp\",\n\t\t\tabbreviation: \"{#} UBP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.upb\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 1\n\t\t}\n\t],\n\n\t\"CURRENCY_DECIMAL_DIGITS\": 0.01\n}\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.5\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"npc\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"edge,hindrance,skill,power,ability,action\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"SWADE.Currency\",\r\n\t\t\timg: \"icons/svg/coins.svg\",\r\n\t\t\tabbreviation: \"{#}T\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.details.currency\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t}\r\n\t],\r\n\r\n\t\"CURRENCY_DECIMAL_DIGITS\": 0.01\r\n\r\n}\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.3\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.qtd\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.preco\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"magia,poder,classe\"\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"path\": \"system.tipoUso\",\r\n\t\t\t\"filters\": \"nat\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Ouro\",\r\n\t\t\timg: \"icons/commodities/currency/coin-embossed-insect-gold.webp\",\r\n\t\t\tabbreviation: \"{#}O\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.dinheiro.to\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Prata\",\r\n\t\t\timg: \"icons/commodities/currency/coin-embossed-unicorn-silver.webp\",\r\n\t\t\tabbreviation: \"{#}P\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.dinheiro.tp\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Cobre\",\r\n\t\t\timg: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\r\n\t\t\tabbreviation: \"{#}C\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.dinheiro.tc\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.01\r\n\t\t}\r\n\t]\r\n}\r\n","import CONSTANTS from \"../constants/constants.js\";\r\n\r\nexport default {\r\n\r\n\t\"VERSION\": \"1.0.7\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"cargo\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity.value\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"career,container,critical,disease,injury,mutation,prayer,psychology,talent,skill,spell,trait,extendedTest,vehicleMod,cargo\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// This function is an optional system handler that specifically transforms an item's price into a more unified numeric format\r\n\t\"ITEM_COST_TRANSFORMER\": (item) => {\r\n\t\tlet overallCost = 0;\r\n\t\tconst prices = foundry.utils.getProperty(item, \"system.price\");\r\n\t\toverallCost += (Number(prices?.[\"gc\"]) ?? 0) * 240;\r\n\t\toverallCost += (Number(prices?.[\"ss\"]) ?? 0) * 12;\r\n\t\toverallCost += (Number(prices?.[\"bp\"]) ?? 0) * 1;\r\n\t\treturn overallCost;\r\n\t},\r\n\r\n\t\"PILE_TYPE_DEFAULTS\": {\r\n\t\t[CONSTANTS.PILE_TYPES.MERCHANT]: {\r\n\t\t\tmerchantColumns: [{\r\n\t\t\t\tlabel: \"Availability\",\r\n\t\t\t\tpath: \"system.availability.value\"\r\n\t\t\t}],\r\n\t\t}\r\n\t},\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"item\",\r\n\t\t\tname: \"Gold Crown\",\r\n\t\t\timg: \"modules/wfrp4e-core/icons/currency/goldcrown.png\",\r\n\t\t\tabbreviation: \"{#}GC\",\r\n\t\t\tdata: {\r\n\t\t\t\titem: {\r\n\t\t\t\t\t\"name\": \"Gold Crown\",\r\n\t\t\t\t\t\"type\": \"money\",\r\n\t\t\t\t\t\"img\": \"modules/wfrp4e-core/icons/currency/goldcrown.png\",\r\n\t\t\t\t\t\"system\": {\r\n\t\t\t\t\t\t\"quantity\": { \"type\": \"Number\", \"label\": \"Quantity\", \"value\": 1 },\r\n\t\t\t\t\t\t\"encumbrance\": { \"type\": \"Number\", \"label\": \"Encumbrance\", \"value\": 0.005 },\r\n\t\t\t\t\t\t\"coinValue\": { \"label\": \"Value (in d)\", \"type\": \"Number\", \"value\": 240 },\r\n\t\t\t\t\t\t\"source\": { \"type\": \"String\", \"label\": \"Source\" }\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 240\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"item\",\r\n\t\t\tname: \"Silver Shilling\",\r\n\t\t\timg: \"modules/wfrp4e-core/icons/currency/silvershilling.png\",\r\n\t\t\tabbreviation: \"{#}SS\",\r\n\t\t\tdata: {\r\n\t\t\t\titem: {\r\n\t\t\t\t\t\"name\": \"Silver Shilling\",\r\n\t\t\t\t\t\"type\": \"money\",\r\n\t\t\t\t\t\"img\": \"modules/wfrp4e-core/icons/currency/silvershilling.png\",\r\n\t\t\t\t\t\"system\": {\r\n\t\t\t\t\t\t\"quantity\": { \"type\": \"Number\", \"label\": \"Quantity\", \"value\": 1 },\r\n\t\t\t\t\t\t\"encumbrance\": { \"type\": \"Number\", \"label\": \"Encumbrance\", \"value\": 0.01 },\r\n\t\t\t\t\t\t\"coinValue\": { \"label\": \"Value (in d)\", \"type\": \"Number\", \"value\": 12 },\r\n\t\t\t\t\t\t\"source\": { \"type\": \"String\", \"label\": \"Source\" }\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 12\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"item\",\r\n\t\t\tname: \"Brass Penny\",\r\n\t\t\timg: \"modules/wfrp4e-core/icons/currency/brasspenny.png\",\r\n\t\t\tabbreviation: \"{#}BP\",\r\n\t\t\tdata: {\r\n\t\t\t\titem: {\r\n\t\t\t\t\t\"name\": \"Brass Penny\",\r\n\t\t\t\t\t\"type\": \"money\",\r\n\t\t\t\t\t\"img\": \"modules/wfrp4e-core/icons/currency/brasspenny.png\",\r\n\t\t\t\t\t\"system\": {\r\n\t\t\t\t\t\t\"quantity\": { \"type\": \"Number\", \"label\": \"Quantity\", \"value\": 1 },\r\n\t\t\t\t\t\t\"encumbrance\": { \"type\": \"Number\", \"label\": \"Encumbrance\", \"value\": 0.01 },\r\n\t\t\t\t\t\t\"coinValue\": { \"label\": \"Value (in d)\", \"type\": \"Number\", \"value\": 1 },\r\n\t\t\t\t\t\t\"source\": { \"type\": \"String\", \"label\": \"Source\" }\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t}\r\n\t]\r\n}\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.4\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"npc\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"spell,strength,weakness,mastery,species,culture,ancestry,education,resource,npcfeature,moonsign,language,culturelore,statuseffect,spelleffect,npcattack\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\", \"system.sufferedDamage\", \"system.quality\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Solare\",\r\n\t\t\timg: \"icons/commodities/currency/coins-assorted-mix-copper.webp\",\r\n\t\t\tabbreviation: \"{#}S\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.S\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Lunare\",\r\n\t\t\timg: \"icons/commodities/currency/coins-assorted-mix-silver.webp\",\r\n\t\t\tabbreviation: \"{#}L\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.L\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.01\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Telare\",\r\n\t\t\timg: \"icons/commodities/currency/coins-assorted-mix-platinum.webp\",\r\n\t\t\tabbreviation: \"{#}T\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.T\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.0001\r\n\t\t}\r\n\t]\r\n}\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.2\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.cost\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"criticalInjury,monsterAttack,monsterTalent\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Gold\",\r\n\t\t\timg: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\r\n\t\t\tabbreviation: \"{#}GP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.gold.value\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Silver\",\r\n\t\t\timg: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\r\n\t\t\tabbreviation: \"{#}SP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.silver.value\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Copper\",\r\n\t\t\timg: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\r\n\t\t\tabbreviation: \"{#}CP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.copper.value\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.01\r\n\t\t}\r\n\t]\r\n}\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.3\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"ability\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Coin\",\r\n\t\t\timg: \"icons/svg/coins.svg\",\r\n\t\t\tabbreviation: \"{#}C\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.coin.value\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t}\r\n\t],\r\n\r\n\t\"CURRENCY_DECIMAL_DIGITS\": 0.01\r\n}\r\n","export default {\n\n    \"VERSION\": \"1.0.2\",\n\n    // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n    \"ACTOR_CLASS_TYPE\": \"Player\",\n\n\t// The item class type is the type of item that will be used for the default loot item\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\n\n\t// The item class type is the type of item that will be used for the default weapon item\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \n\n\t// The item class type is the type of item that will be used for the default equipment item\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\n\n    // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n    \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n    // Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n    \"ITEM_FILTERS\": [\n        {\n            \"path\": \"type\",\n            \"filters\": \"Ancestry,Background,Boon,Class Ability,Class,Deity,Effect,Language,NPC Attack,NPC Special Attack,NPC Spell,NPC Feature,Property,Spell,Talent\"\n        },\n    ],\n\n    // Item similarities determines how item piles detect similarities and differences in the system\n    \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n    // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n    // In the case of attributes, the path is relative to the \"actor.system\"\n    // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n    \"CURRENCIES\": [\n        {\n            \"type\": \"attribute\",\n            \"name\": \"Gold Pieces\",\n            \"img\": \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n            \"abbreviation\": \"{#}GP\",\n            \"data\": {\n                \"path\": \"system.coins.gp\",\n            },\n            \"primary\": true,\n            \"exchangeRate\": 1\n        },\n        {\n            \"type\": \"attribute\",\n            \"name\": \"Silver Pieces\",\n            \"img\": \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\n            \"abbreviation\": \"{#}SP\",\n            \"data\": {\n                \"path\": \"system.coins.sp\",\n            },\n            \"primary\": false,\n            \"exchangeRate\": 0.1\n        },\n        {\n            \"type\": \"attribute\",\n            \"name\": \"Copper Pieces\",\n            \"img\": \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\n            \"abbreviation\": \"{#}CP\",\n            \"data\": {\n                \"path\": \"system.coins.cp\",\n            },\n            \"primary\": false,\n            \"exchangeRate\": 0.01\n        }\n    ],\n\n    // This function is an optional system handler that specifically transforms an item's price into a more unified numeric format\n    \"ITEM_COST_TRANSFORMER\": (item, currencies) => {\n        const cost = foundry.utils.getProperty(item, \"system.cost\") ?? {};\n        let totalCost = 0;\n        for (const costDenomination in cost) {\n            const subCost = Number(foundry.utils.getProperty(cost, costDenomination)) ?? 0;\n            if (subCost === 0) {\n                continue;\n            }\n\n            const currencyDenomination = currencies\n                .filter(currency => currency.type === \"attribute\")\n                .find(currency => {\n                    return currency.data.path.toLowerCase().endsWith(costDenomination);\n                });\n\n            totalCost += subCost * currencyDenomination?.exchangeRate ?? 0;\n        }\n\n        return totalCost;\n    }\n}","export default {\r\n\r\n\t\"VERSION\": \"1.0.3\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"affiliation,background,class,beast quality,destiny,feat,forcePower,forceRegimen,forceSecret,forceTechnique,species,talent,template,trait,vehicleSystem\"\r\n\t\t}\r\n\t],\r\n\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.cost\",\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"type\", \"name\", \"strippable\", \"hasPrerequisites\", \"modifiable\", \"hasLevels\"],\r\n\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Credits\",\r\n\t\t\timg: \"icons/svg/coins.svg\",\r\n\t\t\tabbreviation: \"{#}C\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.credits\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t}\r\n\t],\r\n\r\n\t\"CURRENCY_DECIMAL_DIGITS\": 0.01\r\n}\r\n","export default {\n\tVERSION: \"1.0.1\",\n\n\tACTOR_CLASS_TYPE: \"character\",\n\n\t// The item class type is the type of item that will be used for the default loot item\n\t\"ITEM_CLASS_LOOT_TYPE\": \"loot\",\n\n\t// The item class type is the type of item that will be used for the default weapon item\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"weapon\", \n\n\t// The item class type is the type of item that will be used for the default equipment item\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"equipment\",\n\n\tITEM_QUANTITY_ATTRIBUTE: \"system.quantity\",\n\n\tITEM_PRICE_ATTRIBUTE: \"system.price.value\",\n\n\tITEM_FILTERS: [\n\t\t{\n\t\t\tpath: \"type\",\n\t\t\tfilters: \"power,feat,class,archetype,background\",\n\t\t},\n\t\t{\n\t\t\tpath: \"system.weaponType\",\n\t\t\tfilters: \"natural\",\n\t\t},\n\t],\n\n\tITEM_TRANSFORMER: async (itemData, actor = false) => {\n\t\t[\"equipped\", \"proficient\", \"prepared\"].forEach((key) => {\n\t\t\tif (itemData?.system?.[key] !== void 0) {\n\t\t\t\tdelete itemData.system[key];\n\t\t\t}\n\t\t});\n\t\tfoundry.utils.setProperty(\n\t\t\titemData,\n\t\t\t\"system.attunement\",\n\t\t\tMath.min(\n\t\t\t\tCONFIG.SW5E.attunementTypes.REQUIRED,\n\t\t\t\titemData?.system?.attunement ?? 0\n\t\t\t)\n\t\t);\n\t\treturn itemData;\n\t},\n\n\tITEM_SIMILARITIES: [\"name\", \"type\"],\n\n\tCURRENCIES: [\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"SW5E.CurrencyGC\",\n\t\t\timg: \"systems/sw5e/packs/Icons/Data Recording and Storage/CreditChip.webp\",\n\t\t\tabbreviation: \"{#}GC\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.gc\",\n\t\t\t},\n\t\t\tprimary: true,\n\t\t\texchangeRate: 1,\n\t\t},\n\t],\n};\n","export default {\n\tVERSION: \"1.0.1\",\n\n\tACTOR_CLASS_TYPE: \"character\",\n\n\t// The item class type is the type of item that will be used for the default loot item\n\t\"ITEM_CLASS_LOOT_TYPE\": \"loot\",\n\n\t// The item class type is the type of item that will be used for the default weapon item\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"weapon\", \n\n\t// The item class type is the type of item that will be used for the default equipment item\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"equipment\",\n\n\tITEM_QUANTITY_ATTRIBUTE: \"system.quantity\",\n\n\tITEM_PRICE_ATTRIBUTE: \"system.price\",\n\n\tITEM_FILTERS: [\n\t\t{\n\t\t\tpath: \"type\",\n\t\t\tfilters: \"power,feat,class,archetype,background\",\n\t\t},\n\t\t{\n\t\t\tpath: \"system.weaponType\",\n\t\t\tfilters: \"natural\",\n\t\t},\n\t],\n\n\tITEM_TRANSFORMER: async (itemData, actor = false) => {\n\t\t[\"equipped\", \"proficient\", \"prepared\"].forEach((key) => {\n\t\t\tif (itemData?.system?.[key] !== void 0) {\n\t\t\t\tdelete itemData.system[key];\n\t\t\t}\n\t\t});\n\t\tfoundry.utils.setProperty(\n\t\t\titemData,\n\t\t\t\"system.attunement\",\n\t\t\tMath.min(\n\t\t\t\tCONFIG.SW5E.attunementTypes.REQUIRED,\n\t\t\t\titemData?.system?.attunement ?? 0\n\t\t\t)\n\t\t);\n\t\treturn itemData;\n\t},\n\n\tITEM_SIMILARITIES: [\"name\", \"type\"],\n\n\tCURRENCIES: [\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"SW5E.CurrencyGC\",\n\t\t\timg: \"systems/sw5e/packs/Icons/Data Recording and Storage/CreditChip.webp\",\n\t\t\tabbreviation: \"{#}GC\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.gc\",\n\t\t\t},\n\t\t\tprimary: true,\n\t\t\texchangeRate: 1,\n\t\t},\n\t],\n};\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.3\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.cost\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"skill,perk,special_ability\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"FALLOUT.UI.CAPS\",\r\n\t\t\timg: \"icons/commodities/currency/coins-engraved-copper.webp\",\r\n\t\t\tabbreviation: \"{#}C\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.caps\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t}\r\n\t],\r\n\r\n\t\"CURRENCY_DECIMAL_DIGITS\": 0.01\r\n}\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.3\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"gear\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.amount\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price.market\",\r\n\r\n\t// Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"role, skill, criticalInjury\"\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"path\": \"system.isInstalled\",\r\n\t\t\t\"filters\": [true]\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"CPR.characterSheet.rightPane.eurobucks.eurobucks\",\r\n\t\t\timg: \"icons/svg/coins.svg\",\r\n\t\t\tabbreviation: \"{#}$\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.wealth.value\"\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t}\r\n\t],\r\n\r\n\t\"CURRENCY_DECIMAL_DIGITS\": 0.01\r\n}\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.0\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.coppers\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"spell\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": []\r\n}\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.0\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.qty\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"specialty,injury\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": []\r\n}\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.0\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"npc\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.cost\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"injury, shipProblem, shipCriticalDamage, shipLogbook\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"YZECORIOLIS.Birr\",\r\n\t\t\timg: \"icons/commodities/currency/coin-inset-insect-gold.webp\",\r\n\t\t\tabbreviation: \"{#}B\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.birr\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t}\r\n\t],\r\n\r\n\t\"CURRENCY_DECIMAL_DIGITS\": 0.01\r\n}\r\n","export default {\n\n\t\"VERSION\": \"1.0.0\",\n\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n\t\"ACTOR_CLASS_TYPE\": \"character\",\n\n\t// The item class type is the type of item that will be used for the default loot item\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\n\n\t// The item class type is the type of item that will be used for the default weapon item\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \n\n\t// The item class type is the type of item that will be used for the default equipment item\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\n\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\n\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n\t\"ITEM_FILTERS\": [\n\t\t{\n\t\t\t\"path\": \"type\",\n\t\t\t\"filters\": \"talent,attackOption,race,style,facade,bond\"\n\t\t}\n\t],\n\n\t// Item similarities determines how item piles detect similarities and differences in the system\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n\t\"CURRENCIES\": [\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"KG.Money\",\n\t\t\timg: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n\t\t\tabbreviation: \"{#}G\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.attributes.money\",\n\t\t\t},\n\t\t\tprimary: true,\n\t\t\texchangeRate: 1\n\t\t}\n\t],\n\n\t\"CURRENCY_DECIMAL_DIGITS\": 0.01\n}\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.0\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"monster\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.number\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.cost\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"ability,boon,burden,mysticalPower,ritual,trait\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Thaler\",\r\n\t\t\timg: \"icons/commodities/currency/coins-assorted-mix-copper.webp\",\r\n\t\t\tabbreviation: \"{#}T\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.money.thaler\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Shilling\",\r\n\t\t\timg: \"icons/commodities/currency/coins-assorted-mix-silver.webp\",\r\n\t\t\tabbreviation: \"{#}S\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.money.shilling\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Orteg\",\r\n\t\t\timg: \"icons/commodities/currency/coins-assorted-mix-platinum.webp\",\r\n\t\t\tabbreviation: \"{#}O\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.money.orteg\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.01\r\n\t\t}\r\n\t]\r\n}\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.0\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"ability, art, asset, focus, skill, spell\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"WWN.items.PP.long\",\r\n\t\t\timg: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\r\n\t\t\tabbreviation: \"{#}PP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.pp\"\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 50\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"WWN.items.GP.long\",\r\n\t\t\timg: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\r\n\t\t\tabbreviation: \"{#}GP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.gp\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 10\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"WWN.items.EP.long\",\r\n\t\t\timg: \"icons/commodities/currency/coin-inset-copper-axe.webp\",\r\n\t\t\tabbreviation: \"{#}EP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.ep\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 5\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"WWN.items.SP.long\",\r\n\t\t\timg: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\r\n\t\t\tabbreviation: \"{#}SP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.sp\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"WWN.items.CP.long\",\r\n\t\t\timg: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\r\n\t\t\tabbreviation: \"{#}CP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.cp\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.01\r\n\t\t}\r\n\t]\r\n}\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.1\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"pc\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.basic.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"flags.item-piles.system.price\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"ability, lasting-damage, power-shift, recursion, skill, tag\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Adamantine pieces\",\r\n\t\t\timg: \"icons/commodities/currency/coin-embossed-ruby-gold.webp\",\r\n\t\t\tabbreviation: \"{#} ap\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.settings.equipment.currency.quantity6\"\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 1000\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Mithral pieces\",\r\n\t\t\timg: \"icons/commodities/currency/coin-embossed-unicorn-silver.webp\",\r\n\t\t\tabbreviation: \"{#} mp\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.settings.equipment.currency.quantity5\"\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 100\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Platinum pieces\",\r\n\t\t\timg: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\r\n\t\t\tabbreviation: \"{#} pp\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.settings.equipment.currency.quantity4\"\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 10\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Gold pieces\",\r\n\t\t\timg: \"icons/commodities/currency/coins-plain-gold.webp\",\r\n\t\t\tabbreviation: \"{#} gp\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.settings.equipment.currency.quantity3\"\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Silver pieces\",\r\n\t\t\timg: \"icons/commodities/currency/coins-engraved-face-silver.webp\",\r\n\t\t\tabbreviation: \"{#} sp\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.settings.equipment.currency.quantity2\"\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Copper pieces\",\r\n\t\t\timg: \"icons/commodities/currency/coins-engraved-copper.webp\",\r\n\t\t\tabbreviation: \"{#} cp\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.settings.equipment.currency.quantity1\"\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.01\r\n\t\t}\r\n\t]\r\n}\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.0\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.cost\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"feat,edge,ability,move,capability,pokeedge,dexentry\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"PTU.Money\",\r\n\t\t\timg: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\r\n\t\t\tabbreviation: \"{#}\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.money\"\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t}\r\n\t]\r\n}\r\n","export default {\n\n\t\"VERSION\": \"1.0.0\",\n\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n\t\"ACTOR_CLASS_TYPE\": \"Player\",\n\n\t// The item class type is the type of item that will be used for the default loot item\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\n\n\t// The item class type is the type of item that will be used for the default weapon item\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \n\n\t// The item class type is the type of item that will be used for the default equipment item\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\n\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.value\",\n\n\t// Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n\t\"ITEM_FILTERS\": [\n\t\t{\n\t\t\t\"path\": \"type\",\n\t\t\t\"filters\": \"spell,skill\"\n\t\t},\n\t],\n\n\t// This function is an optional system handler that specifically transforms an item when it is added to actors\n\t\"ITEM_TRANSFORMER\": async (itemData) => {\n\t\t// Transferred items should become unequipped\n\t\tif (itemData?.system?.equipped) {\n\t\t\titemData.system.equipped = false;\n\t\t}\n\t\t// Transferring spells doesn't make a lot of sense, but if it happens the lost flag and mercurial effect should be cleared\n\t\t[\"lost\", \"mercurialEffect\"].forEach(key => {\n\t\t\tif (itemData?.system?.[key] !== undefined) {\n\t\t\t\tdelete itemData.system[key];\n\t\t\t}\n\t\t});\n\t\treturn itemData;\n\t},\n\n\t// This function is an optional system handler that specifically transforms an item's price into a more unified numeric format\n\t\"ITEM_COST_TRANSFORMER\": (item, currencies) => {\n\t\tlet overallCost = 0;\n\t\tcurrencies.forEach((currency, index) => {\n\t\t\tlet denominationCost = Number(foundry.utils.getProperty(item, currency.data.path.replace(\"system.currency.\", \"system.value.\")));\n\t\t\tif (!isNaN(denominationCost)) {\n\t\t\t\toverallCost += denominationCost * currency.exchangeRate;\n\t\t\t}\n\t\t})\n\t\treturn overallCost ?? 0;\n\t},\n\n\t// Item similarities determines how item piles detect similarities and differences in the system\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n\t// In the case of attributes, the path is relative to the \"actor.system\"\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n\t\"CURRENCIES\": [\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DCC.CurrencyPP\",\n\t\t\timg: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\n\t\t\tabbreviation: \"{#}Pp\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.pp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 100\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DCC.CurrencyEP\",\n\t\t\timg: \"icons/commodities/currency/coin-inset-copper-axe.webp\",\n\t\t\tabbreviation: \"{#} Ep\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.ep\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 10\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DCC.CurrencyGP\",\n\t\t\timg: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n\t\t\tabbreviation: \"{#} Gp\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.gp\",\n\t\t\t},\n\t\t\tprimary: true,\n\t\t\texchangeRate: 1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DCC.CurrencySP\",\n\t\t\timg: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\n\t\t\tabbreviation: \"{#} Sp\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.sp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DCC.CurrencyCP\",\n\t\t\timg: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\n\t\t\tabbreviation: \"{#} Cp\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.cp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.01\n\t\t}\n\t],\n}\n","import CONSTANTS from \"../constants/constants.js\";\n\nexport default {\n\n\t\"VERSION\": \"1.0.1\",\n\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n\t\"ACTOR_CLASS_TYPE\": \"character\",\n\n\t// The item class type is the type of item that will be used for the default loot item\n\t\"ITEM_CLASS_LOOT_TYPE\": \"object\",\n\n\t// The item class type is the type of item that will be used for the default weapon item\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \n\n\t// The item class type is the type of item that will be used for the default equipment item\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\n\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\n\n\t// Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n\t\"ITEM_FILTERS\": [\n\t\t{\n\t\t\t\"path\": \"type\",\n\t\t\t\"filters\": \"feature, maneuver, spell, background, culture, heritage, destiny\"\n\t\t}\n\t],\n\n\t// Item similarities determines how item piles detect similarities and differences in the system\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n\t// In the case of attributes, the path is relative to the \"actor.system\"\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n\t\"CURRENCIES\": [\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"Platinum Pieces\",\n\t\t\timg: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\n\t\t\tabbreviation: \"{#}PP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.pp\"\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 10\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"Gold Pieces\",\n\t\t\timg: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n\t\t\tabbreviation: \"{#}GP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.gp\",\n\t\t\t},\n\t\t\tprimary: true,\n\t\t\texchangeRate: 1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"Electrum Pieces\",\n\t\t\timg: \"icons/commodities/currency/coin-inset-copper-axe.webp\",\n\t\t\tabbreviation: \"{#}EP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.ep\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.5\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"Silver Pieces\",\n\t\t\timg: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\n\t\t\tabbreviation: \"{#}SP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.sp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"Copper Pieces\",\n\t\t\timg: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\n\t\t\tabbreviation: \"{#}CP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.cp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.01\n\t\t}\n\t],\n\n\t\"SHEET_OVERRIDES\": () => {\n\n\t\tlibWrapper.register(CONSTANTS.MODULE_NAME, `game.a5e.applications.ActorSheetA5e.prototype.render`, function (wrapped, forced, options, ...args) {\n\t\t\tconst renderItemPileInterface = Hooks.call(CONSTANTS.HOOKS.PRE_RENDER_SHEET, this.actor, forced, options) === false;\n\t\t\tif (this._state > Application.RENDER_STATES.NONE) {\n\t\t\t\tif (renderItemPileInterface) {\n\t\t\t\t\twrapped(forced, options, ...args)\n\t\t\t\t} else {\n\t\t\t\t\treturn wrapped(forced, options, ...args)\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (renderItemPileInterface) return;\n\t\t\treturn wrapped(forced, options, ...args);\n\t\t}, \"MIXED\");\n\n\t}\n};\n","export default {\n\n\t\"VERSION\": \"1.0.0\",\n\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n\t\"ACTOR_CLASS_TYPE\": \"acolyte\",\n\n\t// The item class type is the type of item that will be used for the default loot item\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\n\n\t// The item class type is the type of item that will be used for the default weapon item\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \n\n\t// The item class type is the type of item that will be used for the default equipment item\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\n\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\n\t\"ITEM_PRICE_ATTRIBUTE\": \"\",\n\n\t// Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n\t\"ITEM_FILTERS\": [\n\t\t{\n\t\t\t\"path\": \"type\",\n\t\t\t\"filters\": \"specialAbility, aptitude, talent, psychicPower, trait\"\n\t\t},\n\t\t{\n\t\t\t\"path\": \"system.installed\",\n\t\t\t\"filters\": \"installed\"\n\t\t}\n\t],\n\n\t// Item similarities determines how item piles detect similarities and differences in the system\n\t\"ITEM_SIMILARITIES\": [],\n\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n\t// In the case of attributes, the path is relative to the \"actor.system\"\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n\t\"CURRENCIES\": [],\n\n\t\"CURRENCY_DECIMAL_DIGITS\": 0.00001\n}\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.0\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.prix\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"ape,attaque,competence,coup,etat,metier,origine,region,sort,trait\"\r\n\t\t}\r\n\t],\r\n\r\n\t// This function is an optional system handler that specifically transforms an item when it is added to actors\r\n\t\"ITEM_TRANSFORMER\": async (itemData) => {\r\n\t\t[\"equipe\"].forEach(key => {\r\n\t\t\tif (itemData?.system?.[key] !== undefined) {\r\n\t\t\t\tdelete itemData.system[key];\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn itemData;\r\n\t},\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"item\",\r\n\t\t\tname: \"Pice d'argent\",\r\n\t\t\timg: \"systems/naheulbeuk/assets/from-rexard-icons/Tresors/tresor%20(101).webp\",\r\n\t\t\tabbreviation: \"{#}PA\",\r\n\t\t\tdata: {\r\n\t\t\t\tuuid: \"Compendium.naheulbeuk.trucs.BTUFKc6sEbJLmlas\"\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 10\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"item\",\r\n\t\t\tname: \"Pice d'or\",\r\n\t\t\timg: \"systems/naheulbeuk/assets/from-rexard-icons/Tresors/tresor%20(52).webp\",\r\n\t\t\tabbreviation: \"{#}PO\",\r\n\t\t\tdata: {\r\n\t\t\t\tuuid: \"Compendium.naheulbeuk.trucs.AKuErwzQ6wDxtzyp\"\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"item\",\r\n\t\t\tname: \"Lingot de Thrytil\",\r\n\t\t\timg: \"systems/naheulbeuk/assets/from-rexard-icons/Objets/Materiaux/objet%20(291).webp\",\r\n\t\t\tabbreviation: \"{#}LT\",\r\n\t\t\tdata: {\r\n\t\t\t\tuuid: \"Compendium.naheulbeuk.trucs.tOTNc2WYpkyf2Yyl\"\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.01\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"item\",\r\n\t\t\tname: \"Lingot de Berylium\",\r\n\t\t\timg: \"systems/naheulbeuk/assets/from-rexard-icons/Objets/Materiaux/objet%20(252).webp\",\r\n\t\t\tabbreviation: \"{#}LB\",\r\n\t\t\tdata: {\r\n\t\t\t\tuuid: \"Compendium.naheulbeuk.trucs.r4qLXqXaIIdyKzOf\"\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.002\r\n\t\t}\r\n\t]\r\n}\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.0\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"flags.item-piles.system.price\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"ability,power,augment,spell,part,property\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [],\r\n\r\n\t\"CURRENCY_DECIMAL_DIGITS\": 0.01\r\n\r\n}\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.0\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"loot\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.qty\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.cost\",\r\n\r\n\t// Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"upgrade,specialty,injury\"\r\n\t\t}\r\n\t],\r\n\r\n\t\"UNSTACKABLE_ITEM_TYPES\": [\"weapon\", \"armor\"],\r\n\r\n\t\"PILE_DEFAULTS\": {\r\n\t\tmerchantColumns: [{\r\n\t\t\tlabel: \"FLBR.ItemAvailability\",\r\n\t\t\tpath: \"system.availability\",\r\n\t\t\tformatting: \"{#}\",\r\n\t\t\tmapping: {\r\n\t\t\t\t5: 'FLBR.ITEM_AVAILABILITY.Incidental',\r\n\t\t\t\t4: 'FLBR.ITEM_AVAILABILITY.Standard',\r\n\t\t\t\t3: 'FLBR.ITEM_AVAILABILITY.Premium',\r\n\t\t\t\t2: 'FLBR.ITEM_AVAILABILITY.Rare',\r\n\t\t\t\t1: 'FLBR.ITEM_AVAILABILITY.Luxury',\r\n\t\t\t}\r\n\t\t}]\r\n\t},\r\n\r\n\t// This function is an optional system handler that specifically transforms an item when it is added to actors\r\n\t\"ITEM_TRANSFORMER\": async (itemData) => {\r\n\t\tif (itemData?.system?.mounted) itemData.system.mounted = false;\r\n\t\treturn itemData;\r\n\t},\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"FLBR.HEADER.ChinyenPoints\",\r\n\t\t\timg: \"icons/commodities/currency/coins-plain-stack-silver.webp\",\r\n\t\t\tabbreviation: \"{#}C\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.metaCurrencies.chinyen\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"FLBR.HEADER.PromotionPoints\",\r\n\t\t\timg: \"icons/commodities/treasure/medal-ribbon-gold-blue.webp\",\r\n\t\t\tabbreviation: \"{#}PP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.metaCurrencies.promotion\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"FLBR.HEADER.HumanityPoints\",\r\n\t\t\timg: \"icons/sundries/gaming/chess-knight-white.webp\",\r\n\t\t\tabbreviation: \"{#}HP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.metaCurrencies.humanity\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 1\r\n\t\t}\r\n\t],\r\n\r\n\t\"VAULT_STYLES\": [\r\n\t\t{\r\n\t\t\tpath: \"system.availability\",\r\n\t\t\tvalue: 1,\r\n\t\t\tstyling: {\r\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,119,0,1)\"\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tpath: \"system.availability\",\r\n\t\t\tvalue: 2,\r\n\t\t\tstyling: {\r\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,0,247,1)\"\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tpath: \"system.availability\",\r\n\t\t\tvalue: 3,\r\n\t\t\tstyling: {\r\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(0,136,255,1)\"\r\n\t\t\t}\r\n\t\t}\r\n\t]\r\n}\r\n","export default {\r\n\t\"VERSION\": \"1.0.1\",\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\t\"type\": \"attribute\",\r\n\t\t\t\"name\": \"Dollar\",\r\n\t\t\t\"img\": \"\",\r\n\t\t\t\"abbreviation\": \"${#}\",\r\n\t\t\t\"data\": {\r\n\t\t\t\t\"path\": \"system.general.cash.value\"\r\n\t\t\t},\r\n\t\t\t\"primary\": true,\r\n\t\t\t\"exchangeRate\": 1\r\n\t\t}\r\n\t],\r\n\t\"CURRENCY_DECIMAL_DIGITS\": 0.01,\r\n\t\"ITEM_FILTERS\": [{\r\n\t\t\"path\": \"type\",\r\n\t\t\"filters\": \"talent,planet-system,skill-stunts,agenda,specialty,critical-injury\"\r\n\t}],\r\n\t\"ITEM_COST_TRANSFORMER\": (item) => {\r\n\t\tlet overallCost = foundry.utils.getProperty(item, \"system.attributes.cost.value\");\r\n\t\tif (overallCost) {\r\n\t\t\toverallCost = overallCost.replace(\"$\", \"\").replace(\",\", \"\");\r\n\t\t}\r\n\t\treturn Number(overallCost) ?? 0;\r\n\t},\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.attributes.quantity.value\",\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.attributes.cost.value\"\r\n}\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.0\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"container\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price\",\r\n\r\n\t// Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"feature,class,subclass,background\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"PB.Silver\",\r\n\t\t\timg: \"systems/pirateborg/icons/misc/thing-of-importance.png\",\r\n\t\t\tabbreviation: \"{#}SP\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.silver\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t}\r\n\t]\r\n}\r\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.0\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity.value\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price.value\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"species,career,specialization,ability,criticaldamage,criticalinjury,talent,homesteadupgrade,signatureability,forcepower\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\t\"type\": \"attribute\",\r\n\t\t\t\"name\": \"Credits\",\r\n\t\t\t\"img\": \"systems/starwarsffg/images/mod-all.png\",\r\n\t\t\t\"abbreviation\": \"{#}cr\",\r\n\t\t\t\"data\": {\r\n\t\t\t\t\"path\": \"system.stats.credits.value\"\r\n\t\t\t},\r\n\t\t\t\"primary\": true,\r\n\t\t\t\"exchangeRate\": 1,\r\n\t\t\t\"index\": 0,\r\n\t\t\t\"id\": \"system.stats.credits.value\"\r\n\t\t}\r\n\t]\r\n}\r\n","export default {\r\n\r\n  \"VERSION\": \"1.0.3\",\r\n\r\n  // The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n  \"ACTOR_CLASS_TYPE\": \"creature\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"\", \r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"\",\r\n\r\n  // The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n  \"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n  // The item price attribute is the path to the attribute on each item that determine how much it costs\r\n  \"ITEM_PRICE_ATTRIBUTE\": \"system.value\",\r\n\r\n  // Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n  \"ITEM_FILTERS\": [\r\n    {\r\n      \"path\": \"type\",\r\n      \"filters\": \"feature,ancestry,path,talent,spell\"\r\n    }\r\n  ],\r\n\r\n\t\"PILE_DEFAULTS\": {\r\n\t\tmerchantColumns: [{\r\n\t\t\tlabel: \"DL.Availability\",\r\n\t\t\tpath: \"system.availability\",\r\n\t\t\tformatting: \"{#}\",\r\n\t\t\tbuying: true,\r\n\t\t\tselling: true,\r\n\t\t\tmapping: {\r\n\t\t\t\t\"C\": \"DL.AvailabilityC\",\r\n\t\t\t\t\"U\": \"DL.AvailabilityU\",\r\n\t\t\t\t\"R\": \"DL.AvailabilityR\",\r\n\t\t\t\t\"E\": \"DL.AvailabilityE\",\r\n\t\t\t}\r\n\t\t}]\r\n\t},\r\n\r\n  // Item similarities determines how item piles detect similarities and differences in the system\r\n  \"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n  // Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n  // In the case of attributes, the path is relative to the \"actor.system\"\r\n  // In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n  \"CURRENCIES\": [\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Gold Crowns\",\r\n      img: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\r\n      abbreviation: \"{#} gc\",\r\n      data: {\r\n        path: \"system.wealth.gc\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 10\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Silver Shillings\",\r\n      img: \"icons/commodities/currency/coin-inset-compass-silver.webp\",\r\n      abbreviation: \"{#} ss\",\r\n      data: {\r\n        path: \"system.wealth.ss\",\r\n      },\r\n      primary: true,\r\n      exchangeRate: 1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Copper Pennies\",\r\n      img: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\r\n      abbreviation: \"{#} cp\",\r\n      data: {\r\n        path: \"system.wealth.cp\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.1\r\n    },\r\n    {\r\n      type: \"attribute\",\r\n      name: \"Bits\",\r\n      img: \"icons/commodities/currency/coins-assorted-mix-platinum.webp\",\r\n      abbreviation: \"{#} bits\",\r\n      data: {\r\n        path: \"system.wealth.bits\",\r\n      },\r\n      primary: false,\r\n      exchangeRate: 0.01\r\n    },\r\n  ],\r\n\r\n  \"CURRENCY_DECIMAL_DIGITS\": 0.01\r\n}\r\n","import GiveItems from \"../applications/dialogs/give-items-dialog/give-items-dialog.js\";\nimport PrivateAPI from \"../API/private-api.js\";\n\nexport default {\n\n\t\"VERSION\": \"1.0.7\",\n\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n\t\"ACTOR_CLASS_TYPE\": \"character\",\n\n\t// The item class type is the type of item that will be used for the default loot item\n\t\"ITEM_CLASS_LOOT_TYPE\": \"loot\",\n\n\t// The item class type is the type of item that will be used for the default weapon item\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"weapon\",\n\n\t// The item class type is the type of item that will be used for the default equipment item\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"equipment\",\n\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price.value\",\n\n\t// Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n\t\"ITEM_FILTERS\": [\n\t\t{\n\t\t\t\"path\": \"type\",\n\t\t\t\"filters\": \"spell,feat,class,subclass,background\"\n\t\t},\n\t\t{\n\t\t\t\"path\": \"system.weaponType\",\n\t\t\t\"filters\": \"natural\"\n\t\t}\n\t],\n\n\t// This function is an optional system handler that specifically transforms an item when it is added to actors\n\t\"ITEM_TRANSFORMER\": async (itemData) => {\n\t\t[\"equipped\", \"proficient\", \"prepared\"].forEach(key => {\n\t\t\tif (itemData?.system?.[key] !== undefined) {\n\t\t\t\tdelete itemData.system[key];\n\t\t\t}\n\t\t});\n\t\tfoundry.utils.setProperty(itemData, \"system.attunement\", Math.min(CONFIG.DND5E.attunementTypes.REQUIRED, itemData?.system?.attunement ?? 0));\n\t\tif (itemData.type === \"spell\") {\n\t\t\ttry {\n\t\t\t\tconst scroll = await Item.implementation.createScrollFromSpell(itemData);\n\t\t\t\titemData = scroll.toObject();\n\t\t\t} catch (err) {\n\t\t\t}\n\t\t}\n\t\treturn itemData;\n\t},\n\n\t// This function is an optional system handler that specifically transforms an item's price into a more unified numeric format\n\t\"ITEM_COST_TRANSFORMER\": (item, currencies) => {\n\t\tconst overallCost = Number(foundry.utils.getProperty(item, \"system.price.value\")) ?? 0;\n\t\tconst priceDenomination = foundry.utils.getProperty(item, \"system.price.denomination\");\n\t\tif (priceDenomination) {\n\t\t\tconst currencyDenomination = currencies\n\t\t\t\t.filter(currency => currency.type === \"attribute\")\n\t\t\t\t.find(currency => {\n\t\t\t\t\treturn currency.data.path.toLowerCase().endsWith(priceDenomination);\n\t\t\t\t});\n\t\t\tif (currencyDenomination) {\n\t\t\t\treturn overallCost * currencyDenomination.exchangeRate;\n\t\t\t}\n\t\t}\n\t\treturn overallCost ?? 0;\n\t},\n\n\t\"PRICE_MODIFIER_TRANSFORMER\": ({\n\t\tbuyPriceModifier,\n\t\tsellPriceModifier,\n\t\tactor = false,\n\t\tactorPriceModifiers = []\n\t} = {}) => {\n\n\t\tconst modifiers = {\n\t\t\tbuyPriceModifier,\n\t\t\tsellPriceModifier\n\t\t};\n\n\t\tif (!actor) return modifiers;\n\n\t\tconst groupModifiers = actorPriceModifiers\n\t\t\t.map(data => ({ ...data, actor: fromUuidSync(data.actorUuid) }))\n\t\t\t.filter(data => {\n\t\t\t\treturn data.actor && data.actor.type === \"group\" && data.actor.system.members.some(member => member === actor)\n\t\t\t});\n\n\t\tmodifiers.buyPriceModifier = groupModifiers.reduce((acc, data) => {\n\t\t\treturn data.override ? data.buyPriceModifier ?? acc : acc * data.buyPriceModifier;\n\t\t}, buyPriceModifier);\n\n\t\tmodifiers.sellPriceModifier = groupModifiers.reduce((acc, data) => {\n\t\t\treturn data.override ? data.sellPriceModifier ?? acc : acc * data.sellPriceModifier;\n\t\t}, sellPriceModifier);\n\n\t\treturn modifiers;\n\n\t},\n\n\t\"SOFT_MIGRATIONS\": {\n\t\t\"1.0.6-1.0.7\": {\n\t\t\t\"ITEM_FILTERS\": [\n\t\t\t\t{\n\t\t\t\t\t\"path\": \"type\",\n\t\t\t\t\t\"filters\": \"spell,feat,class,subclass,background,race\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t},\n\n\t\"PILE_DEFAULTS\": {\n\t\tmerchantColumns: [{\n\t\t\tlabel: \"<i class=\\\"fa-solid fa-shield\\\"></i>\",\n\t\t\tpath: \"system.equipped\",\n\t\t\tformatting: \"{#}\",\n\t\t\tbuying: false,\n\t\t\tselling: true,\n\t\t\tmapping: {\n\t\t\t\t\"true\": \"\",\n\t\t\t\t\"false\": \"\"\n\t\t\t}\n\t\t}, {\n\t\t\tlabel: \"Rarity\",\n\t\t\tpath: \"system.rarity\",\n\t\t\tformatting: \"{#}\",\n\t\t\tbuying: true,\n\t\t\tselling: true,\n\t\t\tmapping: {\n\t\t\t\t\"common\": \"DND5E.ItemRarityCommon\",\n\t\t\t\t\"uncommon\": \"DND5E.ItemRarityUncommon\",\n\t\t\t\t\"rare\": \"DND5E.ItemRarityRare\",\n\t\t\t\t\"veryRare\": \"DND5E.ItemRarityVeryRare\",\n\t\t\t\t\"legendary\": \"DND5E.ItemRarityLegendary\",\n\t\t\t\t\"artifact\": \"DND5E.ItemRarityArtifact\"\n\t\t\t}\n\t\t}]\n\t},\n\n\t// Item similarities determines how item piles detect similarities and differences in the system\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\n\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n\t// In the case of attributes, the path is relative to the \"actor.system\"\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n\t\"CURRENCIES\": [\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND5E.CurrencyPP\",\n\t\t\timg: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\n\t\t\tabbreviation: \"{#}PP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.pp\"\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 10\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND5E.CurrencyGP\",\n\t\t\timg: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n\t\t\tabbreviation: \"{#}GP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.gp\",\n\t\t\t},\n\t\t\tprimary: true,\n\t\t\texchangeRate: 1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND5E.CurrencyEP\",\n\t\t\timg: \"icons/commodities/currency/coin-inset-copper-axe.webp\",\n\t\t\tabbreviation: \"{#}EP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.ep\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.5\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND5E.CurrencySP\",\n\t\t\timg: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\n\t\t\tabbreviation: \"{#}SP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.sp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"DND5E.CurrencyCP\",\n\t\t\timg: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\n\t\t\tabbreviation: \"{#}CP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.cp\",\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.01\n\t\t}\n\t],\n\n\t\"VAULT_STYLES\": [\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"artifact\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,191,0,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"legendary\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,119,0,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"veryRare\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,0,247,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"rare\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(0,136,255,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"uncommon\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(0,255,9,1)\"\n\t\t\t}\n\t\t}\n\t],\n\n\t\"SYSTEM_HOOKS\": () => {\n\n\t\tHooks.on(\"dnd5e.getItemContextOptions\", (item, options) => {\n\t\t\toptions.push({\n\t\t\t\tname: game.i18n.localize(\"ITEM-PILES.ContextMenu.GiveToCharacter\"),\n\t\t\t\ticon: \"<i class='fa fa-user'></i>\",\n\t\t\t\tcallback: async () => {\n\t\t\t\t\tconst result = await GiveItems.show(item);\n\t\t\t\t\tif (!result) return;\n\t\t\t\t\tPrivateAPI._giveItem({\n\t\t\t\t\t\titemData: {\n\t\t\t\t\t\t\titem: item.toObject(),\n\t\t\t\t\t\t\tquantity: result.quantity\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsource: item.parent.uuid,\n\t\t\t\t\t\ttarget: result.target,\n\t\t\t\t\t\tsecret: result.secret,\n\t\t\t\t\t}, { skipQuantityDialog: true })\n\t\t\t\t},\n\t\t\t\tcondition: !game.itempiles.API.isItemInvalid(item)\n\t\t\t})\n\t\t});\n\n\t}\n}\n","export default {\r\n\r\n\t\"VERSION\": \"1.0.0\",\r\n\r\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\r\n\t\"ACTOR_CLASS_TYPE\": \"character\",\r\n\r\n\t// The item class type is the type of item that will be used for the default loot item\r\n\t\"ITEM_CLASS_LOOT_TYPE\": \"\",\r\n\r\n\t// The item class type is the type of item that will be used for the default weapon item\r\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"weapon\",\r\n\r\n\t// The item class type is the type of item that will be used for the default equipment item\r\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"item\",\r\n\r\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\r\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\r\n\r\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\r\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.cost\",\r\n\r\n\t// Item types and the filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\r\n\t\"ITEM_FILTERS\": [\r\n\t\t{\r\n\t\t\t\"path\": \"type\",\r\n\t\t\t\"filters\": \"ability,kin,profession,skill,spell\"\r\n\t\t}\r\n\t],\r\n\r\n\t// Item similarities determines how item piles detect similarities and differences in the system\r\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\"],\r\n\r\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\r\n\t// In the case of attributes, the path is relative to the \"actor.system\"\r\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\r\n\t\"CURRENCIES\": [\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Gold\",\r\n\t\t\timg: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\r\n\t\t\tabbreviation: \"{#}GC\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.gc\",\r\n\t\t\t},\r\n\t\t\tprimary: true,\r\n\t\t\texchangeRate: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Silver\",\r\n\t\t\timg: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\r\n\t\t\tabbreviation: \"{#}SC\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.sc\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.1\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: \"attribute\",\r\n\t\t\tname: \"Copper\",\r\n\t\t\timg: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\r\n\t\t\tabbreviation: \"{#}CC\",\r\n\t\t\tdata: {\r\n\t\t\t\tpath: \"system.currency.cc\",\r\n\t\t\t},\r\n\t\t\tprimary: false,\r\n\t\t\texchangeRate: 0.01\r\n\t\t}\r\n\t]\r\n}\r\n","import GiveItems from \"../applications/dialogs/give-items-dialog/give-items-dialog.js\";\nimport PrivateAPI from \"../API/private-api.js\";\nimport CONSTANTS from \"../constants/constants.js\";\n\nexport default {\n\n\t\"VERSION\": \"1.0.0\",\n\t// The actor class type is the type of actor that will be used for the default item pile actor that is created on first item drop.\n\t\"ACTOR_CLASS_TYPE\": \"character\",\n\t// The item class type is the type of item that will be used for the default loot item\n\t\"ITEM_CLASS_LOOT_TYPE\": \"loot\",\n\t// The item class type is the type of item that will be used for the default weapon item\n\t\"ITEM_CLASS_WEAPON_TYPE\": \"weapon\",\n\t// The item class type is the type of item that will be used for the default equipment item\n\t\"ITEM_CLASS_EQUIPMENT_TYPE\": \"equipment\",\n\t// The item quantity attribute is the path to the attribute on items that denote how many of that item that exists\n\t\"ITEM_QUANTITY_ATTRIBUTE\": \"system.quantity\",\n\t// The item price attribute is the path to the attribute on each item that determine how much it costs\n\t\"ITEM_PRICE_ATTRIBUTE\": \"system.price.value\",\n\t// Item filters actively remove items from the item pile inventory UI that users cannot loot, such as spells, feats, and classes\n\t\"ITEM_FILTERS\": [\n\t\t{\n\t\t\t\"path\": \"type\",\n\t\t\t\"filters\": \"spell,feat,class,subclass,background\"\n\t\t},\n\t\t{\n\t\t\t\"path\": \"system.type.value\",\n\t\t\t\"filters\": \"natural\"\n\t\t}\n\t],\n\t// This function is an optional system handler that specifically transforms an item's price into a more unified numeric format\n\t\"ITEM_COST_TRANSFORMER\": (item, currencies) => {\n\t\tconst overallCost = Number(foundry.utils.getProperty(item, \"system.price.value\")) ?? 0;\n\t\tconst priceDenomination = foundry.utils.getProperty(item, \"system.price.denomination\");\n\t\tif (priceDenomination) {\n\t\t\tconst currencyDenomination = currencies.filter((currency) => currency.type === \"attribute\").find((currency) => {\n\t\t\t\treturn currency.data.path.toLowerCase().endsWith(priceDenomination);\n\t\t\t});\n\t\t\tif (currencyDenomination) {\n\t\t\t\treturn overallCost * currencyDenomination.exchangeRate;\n\t\t\t}\n\t\t}\n\t\treturn overallCost ?? 0;\n\t},\n\t\"PRICE_MODIFIER_TRANSFORMER\": ({\n\t\tbuyPriceModifier,\n\t\tsellPriceModifier,\n\t\tactor = false,\n\t\tactorPriceModifiers = []\n\t} = {}) => {\n\t\tconst modifiers = {\n\t\t\tbuyPriceModifier,\n\t\t\tsellPriceModifier\n\t\t};\n\t\tif (!actor)\n\t\t\treturn modifiers;\n\t\tconst groupModifiers = actorPriceModifiers.map((data2) => ({\n\t\t\t...data2,\n\t\t\tactor: fromUuidSync(data2.actorUuid)\n\t\t})).filter((data2) => {\n\t\t\treturn data2.actor && data2.actor.type === \"group\" && data2.actor.system.members.some((member) => member === actor);\n\t\t});\n\t\tmodifiers.buyPriceModifier = groupModifiers.reduce((acc, data2) => {\n\t\t\treturn data2.override ? data2.buyPriceModifier ?? acc : acc * data2.buyPriceModifier;\n\t\t}, buyPriceModifier);\n\t\tmodifiers.sellPriceModifier = groupModifiers.reduce((acc, data2) => {\n\t\t\treturn data2.override ? data2.sellPriceModifier ?? acc : acc * data2.sellPriceModifier;\n\t\t}, sellPriceModifier);\n\t\treturn modifiers;\n\t},\n\n\t\"PILE_DEFAULTS\": {\n\t\tmerchantColumns: [{\n\t\t\tlabel: \"<i class=\\\"fa-solid fa-shield\\\"></i>\",\n\t\t\tpath: \"system.equipped\",\n\t\t\tformatting: \"{#}\",\n\t\t\tbuying: false,\n\t\t\tselling: true,\n\t\t\tmapping: {\n\t\t\t\t\"true\": \"\",\n\t\t\t\t\"false\": \"\"\n\t\t\t}\n\t\t}, {\n\t\t\tlabel: \"Rarity\",\n\t\t\tpath: \"system.rarity\",\n\t\t\tformatting: \"{#}\",\n\t\t\tbuying: true,\n\t\t\tselling: true,\n\t\t\tmapping: {\n\t\t\t\t\"common\": \"VAARFEU.ItemRarityCommon\",\n\t\t\t\t\"uncommon\": \"VAARFEU.ItemRarityUncommon\",\n\t\t\t\t\"rare\": \"VAARFEU.ItemRarityRare\",\n\t\t\t\t\"veryRare\": \"VAARFEU.ItemRarityVeryRare\",\n\t\t\t\t\"legendary\": \"VAARFEU.ItemRarityLegendary\",\n\t\t\t\t\"artifact\": \"VAARFEU.ItemRarityArtifact\"\n\t\t\t}\n\t\t}]\n\t},\n\n\t// Item similarities determines how item piles detect similarities and differences in the system\n\t\"ITEM_SIMILARITIES\": [\"name\", \"type\", \"system.container\"],\n\n\t// Currencies in item piles is a versatile system that can accept actor attributes (a number field on the actor's sheet) or items (actual items in their inventory)\n\t// In the case of attributes, the path is relative to the \"actor.system\"\n\t// In the case of items, it is recommended you export the item with `.toObject()` and strip out any module data\n\t\"CURRENCIES\": [\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"VAARFEU.CurrencyPP\",\n\t\t\timg: \"icons/commodities/currency/coin-inset-snail-silver.webp\",\n\t\t\tabbreviation: \"{#}PP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.pp\"\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 10\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"VAARFEU.CurrencyGP\",\n\t\t\timg: \"icons/commodities/currency/coin-embossed-crown-gold.webp\",\n\t\t\tabbreviation: \"{#}GP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.gp\"\n\t\t\t},\n\t\t\tprimary: true,\n\t\t\texchangeRate: 1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"VAARFEU.CurrencyEP\",\n\t\t\timg: \"icons/commodities/currency/coin-inset-copper-axe.webp\",\n\t\t\tabbreviation: \"{#}EP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.ep\"\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.5\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"VAARFEU.CurrencySP\",\n\t\t\timg: \"icons/commodities/currency/coin-engraved-moon-silver.webp\",\n\t\t\tabbreviation: \"{#}SP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.sp\"\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.1\n\t\t},\n\t\t{\n\t\t\ttype: \"attribute\",\n\t\t\tname: \"VAARFEU.CurrencyCP\",\n\t\t\timg: \"icons/commodities/currency/coin-engraved-waves-copper.webp\",\n\t\t\tabbreviation: \"{#}CP\",\n\t\t\tdata: {\n\t\t\t\tpath: \"system.currency.cp\"\n\t\t\t},\n\t\t\tprimary: false,\n\t\t\texchangeRate: 0.01\n\t\t}\n\t],\n\n\t\"VAULT_STYLES\": [\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"artifact\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,191,0,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"legendary\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,119,0,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"veryRare\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(255,0,247,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"rare\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(0,136,255,1)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tpath: \"system.rarity\",\n\t\t\tvalue: \"uncommon\",\n\t\t\tstyling: {\n\t\t\t\t\"box-shadow\": \"inset 0px 0px 7px 0px rgba(0,255,9,1)\"\n\t\t\t}\n\t\t}\n\t],\n\n\t\"SYSTEM_HOOKS\": () => {\n\n\t\tHooks.on(\"vaarfeu.getItemContextOptions\", (item, options) => {\n\t\t\toptions.push({\n\t\t\t\tname: game.i18n.localize(\"ITEM-PILES.ContextMenu.GiveToCharacter\"),\n\t\t\t\ticon: \"<i class='fa fa-user'></i>\",\n\t\t\t\tcallback: async () => {\n\t\t\t\t\tconst result = await GiveItems.show(item);\n\t\t\t\t\tif (!result) return;\n\t\t\t\t\tPrivateAPI._giveItem({\n\t\t\t\t\t\titemData: {\n\t\t\t\t\t\t\titem: item.toObject(),\n\t\t\t\t\t\t\tquantity: result.quantity\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsource: item.parent.uuid,\n\t\t\t\t\t\ttarget: result.target,\n\t\t\t\t\t\tsecret: result.secret,\n\t\t\t\t\t}, { skipQuantityDialog: true })\n\t\t\t\t},\n\t\t\t\tcondition: !game.itempiles.API.isItemInvalid(item)\n\t\t\t})\n\t\t});\n\n\t}\n}\n","//  IMPORT SYSTEMS HERE \r\nimport dnd4e from \"./dnd4e.js\";\r\nimport dnd4e0443 from \"./dnd4e-0.4.43.js\";\r\nimport dnd5e from \"./dnd5e.js\";\r\nimport dnd5e203 from \"./dnd5e-2.0.3.js\";\r\nimport pf1 from \"./pf1.js\";\r\nimport pf1_9 from \"./pf1-9.0.js\";\r\nimport pf2e from \"./pf2e.js\";\r\nimport ds4 from \"./ds4.js\";\r\nimport d35e from \"./d35e.js\";\r\nimport sfrpg from \"./sfrpg.js\";\r\nimport swade from \"./swade.js\";\r\nimport tormenta20 from \"./tormenta20.js\";\r\nimport wfrp4e from \"./wfrp4e.js\";\r\nimport splittermond from \"./splittermond.js\";\r\nimport forbiddenLands from \"./forbidden-lands.js\";\r\nimport icrpg from \"./icrpg.js\";\r\nimport shadowdark from \"./shadowdark.js\";\r\nimport swse from \"./swse.js\";\r\nimport sw5e from \"./sw5e.js\";\r\nimport sw5e203 from \"./sw5e-2.0.3.2.3.8.js\";\r\nimport fallout from \"./fallout.js\";\r\nimport cyberpunkRedCore from \"./cyberpunk-red-core.js\";\r\nimport knave from \"./knave.js\";\r\nimport t2k4e from \"./t2k4e.js\";\r\nimport yzecoriolis from \"./yzecoriolis.js\";\r\nimport kamigakari from \"./kamigakari.js\";\r\nimport symbaroum from \"./symbaroum.js\";\r\nimport wwn from \"./wwn.js\";\r\nimport cyphersystem from \"./cyphersystem.js\";\r\nimport ptu from \"./ptu.js\";\r\nimport dcc from \"./dcc.js\";\r\nimport a5e from \"./a5e.js\";\r\nimport darkHeresy2e from \"./dark-heresy.js\";\r\nimport naheulbeuk from \"./naheulbeuk.js\";\r\nimport icrpgme from \"./icrpgme.js\";\r\nimport bladeRunner from \"./blade-runner.js\";\r\nimport alienrpg from \"./alienrpg.js\";\r\nimport pirateborg from \"./pirateborg.js\";\r\nimport starwarsffg from \"./starwarsffg.js\";\r\nimport demonlord from \"./demonlord.js\";\r\nimport dnd5e241 from \"./dnd5e-2.4.1.js\";\r\nimport dragonbane from \"./dragonbane.js\";\r\nimport vaarfeu from \"./vaarfeu.js\";\r\n//  IMPORT SYSTEMS HERE \r\n\r\n/**\r\n * NOTE: YOUR PULL REQUEST WILL NOT BE ACCEPTED IF YOU DO NOT\r\n * FOLLOW THE CONVENTION IN THE D&D 5E SYSTEM FILE\r\n */\r\nexport default {\r\n\t//  ADD SYSTEMS HERE \r\n\t\"alienrpg\": {\r\n\t\t\"latest\": alienrpg\r\n\t},\r\n\t\"dnd4e\": {\r\n\t\t\"latest\": dnd4e,\r\n\t\t\"0.4.43\": dnd4e0443,\r\n\t},\r\n\t\"dnd5e\": {\r\n\t\t\"latest\": dnd5e,\r\n\t\t\"2.4.1\": dnd5e241,\r\n\t\t\"2.0.3\": dnd5e203,\r\n\t},\r\n\t\"pf1\": {\r\n\t\t\"latest\": pf1,\r\n\t\t\"9.6\": pf1_9\r\n\t},\r\n\t\"pf2e\": {\r\n\t\t\"latest\": pf2e\r\n\t},\r\n\t\"ds4\": {\r\n\t\t\"latest\": ds4\r\n\t},\r\n\t\"d35e\": {\r\n\t\t\"latest\": d35e\r\n\t},\r\n\t\"blade-runner\": {\r\n\t\t\"latest\": bladeRunner\r\n\t},\r\n\t\"sfrpg\": {\r\n\t\t\"latest\": sfrpg\r\n\t},\r\n\t\"swade\": {\r\n\t\t\"latest\": swade\r\n\t},\r\n\t\"tormenta20\": {\r\n\t\t\"latest\": tormenta20\r\n\t},\r\n\t\"wfrp4e\": {\r\n\t\t\"latest\": wfrp4e\r\n\t},\r\n\t\"splittermond\": {\r\n\t\t\"latest\": splittermond\r\n\t},\r\n\t\"forbidden-lands\": {\r\n\t\t\"latest\": forbiddenLands\r\n\t},\r\n\t\"icrpg\": {\r\n\t\t\"latest\": icrpg\r\n\t},\r\n\t\"icrpgme\": {\r\n\t\t\"latest\": icrpgme\r\n\t},\r\n\t\"swse\": {\r\n\t\t\"latest\": swse\r\n\t},\r\n\t\"sw5e\": {\r\n\t\t\"latest\": sw5e,\r\n\t\t\"2.0.3.2.3.8\": sw5e203\r\n\t},\r\n\t\"fallout\": {\r\n\t\t\"latest\": fallout\r\n\t},\r\n\t\"cyberpunk-red-core\": {\r\n\t\t\"latest\": cyberpunkRedCore\r\n\t},\r\n\t\"knave\": {\r\n\t\t\"latest\": knave\r\n\t},\r\n\t\"t2k4e\": {\r\n\t\t\"latest\": t2k4e\r\n\t},\r\n\t\"yzecoriolis\": {\r\n\t\t\"latest\": yzecoriolis\r\n\t},\r\n\t\"kamigakari\": {\r\n\t\t\"latest\": kamigakari\r\n\t},\r\n\t\"wwn\": {\r\n\t\t\"latest\": wwn\r\n\t},\r\n\t\"symbaroum\": {\r\n\t\t\"latest\": symbaroum\r\n\t},\r\n\t\"cyphersystem\": {\r\n\t\t\"latest\": cyphersystem\r\n\t},\r\n\t\"ptu\": {\r\n\t\t\"latest\": ptu\r\n\t},\r\n\t\"dcc\": {\r\n\t\t\"latest\": dcc\r\n\t},\r\n\t\"a5e\": {\r\n\t\t\"latest\": a5e\r\n\t},\r\n\t\"dark-heresy\": {\r\n\t\t\"latest\": darkHeresy2e\r\n\t},\r\n\t\"naheulbeuk\": {\r\n\t\t\"latest\": naheulbeuk\r\n\t},\r\n\t\"pirateborg\": {\r\n\t\t\"latest\": pirateborg\r\n\t},\r\n\t\"starwarsffg\": {\r\n\t\t\"latest\": starwarsffg\r\n\t},\r\n\t\"demonlord\": {\r\n\t\t\"latest\": demonlord\r\n\t},\r\n\t\"shadowdark\": {\r\n\t\t\"latest\": shadowdark\r\n\t},\r\n\t\"dragonbane\": {\r\n\t\t\"latest\": dragonbane\r\n\t},\r\n\t\"vaarfeu\": {\r\n\t\t\"latest\": vaarfeu\r\n\t}\t\r\n\t//  ADD SYSTEMS HERE \r\n}\r\n","import SUPPORTED_SYSTEMS from \"./systems/_index.js\";\n\nexport const SYSTEMS = {\n\n\tSUPPORTED_SYSTEMS,\n\n\tDEFAULT_SETTINGS: {\n\t\tACTOR_CLASS_TYPE: \"\",\n\t\tITEM_CLASS_LOOT_TYPE: \"\",\n\t\tITEM_CLASS_WEAPON_TYPE: \"\",\n\t\tITEM_CLASS_EQUIPMENT_TYPE: \"\",\n\t\tITEM_QUANTITY_ATTRIBUTE: \"\",\n\t\tITEM_PRICE_ATTRIBUTE: \"\",\n\t\tQUANTITY_FOR_PRICE_ATTRIBUTE: \"flags.item-piles.system.quantityForPrice\",\n\t\tITEM_FILTERS: [],\n\t\tITEM_SIMILARITIES: [],\n\t\tVAULT_STYLES: [],\n\t\tCSS_VARIABLES: [],\n\t\tUNSTACKABLE_ITEM_TYPES: [],\n\t\tCURRENCIES: [],\n\t\tSECONDARY_CURRENCIES: [],\n\t\tPILE_DEFAULTS: {},\n\t\tTOKEN_FLAG_DEFAULTS: {},\n\t\tCURRENCY_DECIMAL_DIGITS: 0.00001,\n\t\tSOFT_MIGRATIONS: {}\n\t},\n\n\tget HAS_SYSTEM_SUPPORT() {\n\t\treturn !!this.SUPPORTED_SYSTEMS?.[game.system.id.toLowerCase()];\n\t},\n\n\t_currentSystem: false,\n\n\tget DATA() {\n\n\t\tif (this._currentSystem) return this._currentSystem;\n\n\t\tconst system = this.SUPPORTED_SYSTEMS?.[game.system.id.toLowerCase()];\n\t\tif (!system) return this.DEFAULT_SETTINGS;\n\n\t\tif (system[game.system.version]) {\n\t\t\tthis._currentSystem = foundry.utils.mergeObject(this.DEFAULT_SETTINGS, system[game.system.version]);\n\t\t\treturn this._currentSystem;\n\t\t}\n\n\t\tconst versions = Object.keys(system);\n\t\tif (versions.length === 1) {\n\t\t\tthis._currentSystem = foundry.utils.mergeObject(this.DEFAULT_SETTINGS, system[versions[0]]);\n\t\t\treturn this._currentSystem;\n\t\t}\n\n\t\tversions.sort((a, b) => {\n\t\t\treturn a === \"latest\" || b === \"latest\" ? -Infinity : (foundry.utils.isNewerVersion(b, a) ? -1 : 1);\n\t\t});\n\t\tconst version = versions.find(version => {\n\t\t\treturn version === \"latest\" || !foundry.utils.isNewerVersion(game.system.version, version);\n\t\t});\n\n\t\tthis._currentSystem = foundry.utils.mergeObject(this.DEFAULT_SETTINGS, system[version]);\n\n\t\treturn this._currentSystem;\n\t},\n\n\taddSystem(data) {\n\t\tthis.SUPPORTED_SYSTEMS[game.system.id.toLowerCase()] = { latest: data };\n\t}\n};\n","<script>\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\r\n\texport let key;\r\n\texport let data;\r\n\texport let disabled = false;\r\n\texport let options = [];\r\n\r\n</script>\r\n\r\n<div class=\"item-pile-setting form-scope item-piles-flexrow\">\r\n\r\n\t<div class=\"label-side\">\r\n\t\t<label>{localize(data.name)} <a>\r\n\t\t\t<i class=\"fas fa-undo reset-setting\" data-fast-tooltip=\"Reset data\"\r\n\t\t\t   on:click={() => { data.value = data.default; }}></i></a>\r\n\t\t</label>\r\n\t\t<p class=\"notes\">{localize(data.hint)}</p>\r\n\t</div>\r\n\r\n\t<div class=\"form-fields input-side\">\r\n\r\n\t\t{#if data.type === Boolean}\r\n\r\n\t\t\t<input type=\"checkbox\" bind:checked={data.value} disabled={disabled}/>\r\n\r\n\t\t{:else if data.choices}\r\n\r\n\t\t\t<div class=\"choice-container\">\r\n\t\t\t\t<select name={key} bind:value={data.value} disabled={disabled}>\r\n\t\t\t\t\t{#each Object.entries(data.choices) as [key, choice], index (index)}\r\n\t\t\t\t\t\t{#if data.type === Number}\r\n\t\t\t\t\t\t\t<option value=\"{index}\">{localize(choice)}</option>\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t<option value=\"{key}\">{localize(choice)}</option>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</select>\r\n\t\t\t</div>\r\n\r\n\t\t{:else if data.type === Number}\r\n\r\n\t\t\t<input\r\n\t\t\t\ttype=\"number\"\r\n\t\t\t\tdisabled={disabled}\r\n\t\t\t\tbind:value={data.value}\r\n\t\t\t\tclass:invalid={!data.value && data.value !== 0}\r\n\t\t\t\tstep={data.step}\r\n\t\t\t\tmin={data.min}\r\n\t\t\t\tmax={data.max}\r\n\t\t\t/>\r\n\r\n\t\t{:else}\r\n\r\n\t\t\t<div class=\"item-pile-setting-container\">\r\n\r\n\t\t\t\t{#if options.length}\r\n\t\t\t\t\t<select name=\"{key}\" bind:value={data.value} disabled={disabled}>\r\n\t\t\t\t\t\t{#each options as option}\r\n\t\t\t\t\t\t\t<option value={option === \"None\" ? \"\" : option}>{option}</option>\r\n\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t</select>\r\n\t\t\t\t{:else}\r\n\t\t\t\t\t<input type=\"text\" bind:value={data.value} disabled={disabled}/>\r\n\t\t\t\t\t{#if data.localize}\r\n\t\t\t\t\t\t<input type=\"text\" disabled value={localize(data.value)}/>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\r\n\t\t{/if}\r\n\t</div>\r\n\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-pile-setting:not(:last-child) {\r\n\r\n    border-bottom: 1px solid rgba(0, 0, 0, 0.25);\r\n    margin-bottom: 0.4rem;\r\n    padding-bottom: 0.4rem;\r\n\r\n  }\r\n\r\n  .item-pile-setting {\r\n\r\n    .reset-setting {\r\n      font-size: 0.75rem;\r\n      margin-left: 0.5rem;\r\n      opacity: 0.5;\r\n      transition: opacity 250ms;\r\n\r\n      &:hover {\r\n        opacity: 1.0;\r\n      }\r\n    }\r\n\r\n    .invalid {\r\n      border: 2px solid #d93131;\r\n    }\r\n\r\n    label {\r\n      flex: 1 0 auto;\r\n    }\r\n\r\n    .form-fields {\r\n      flex: 0 1 auto;\r\n      align-self: center;\r\n    }\r\n\r\n    select {\r\n      min-width: 200px;\r\n    }\r\n\r\n    .item-pile-setting-container {\r\n      min-width: 200px;\r\n      display: flex;\r\n      flex-direction: column;\r\n\r\n      input:first-child {\r\n        margin-bottom: 0.25rem;\r\n      }\r\n    }\r\n\r\n    .label-side {\r\n      flex: 1;\r\n      margin-right: 1rem;\r\n    }\r\n\r\n    .choice-container {\r\n      max-width: 400px;\r\n    }\r\n\r\n    input[type=\"number\"] {\r\n      min-width: 100px;\r\n    }\r\n\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\timport { getContext } from 'svelte';\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport PriceList from \"../../components/PriceList.svelte\";\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let data;\r\n\texport let elementRoot;\r\n\tlet form;\r\n\r\n\tlet prices = foundry.utils.deepClone(data);\r\n\r\n\tasync function updateSettings() {\r\n\t\tapplication.options.resolve(prices);\r\n\t\tapplication.close();\r\n\t}\r\n\r\n\texport function requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form autocomplete=off bind:this={form} class=\"item-piles-config-container\" on:submit|preventDefault={updateSettings}>\r\n\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.PricePresetEditor.Explanation\")}</p>\r\n\r\n\t\t<PriceList bind:prices presets={false}/>\r\n\r\n\t\t<footer>\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"ITEM-PILES.Applications.PricePresetEditor.Update\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={() => { application.close(); }} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n\r\n<style lang=\"scss\">\r\n\r\n  p {\r\n    font-size: 0.8rem;\r\n    text-align: center;\r\n    line-height: 1rem;\r\n  }\r\n\r\n  table {\r\n\r\n    td {\r\n      vertical-align: middle;\r\n    }\r\n\r\n    tr {\r\n\r\n      &.is-active {\r\n        background-color: #3273dc;\r\n        color: #fff;\r\n      }\r\n\r\n      &.is-dragging {\r\n        background-color: rgba(50, 220, 132, 0.55);\r\n        color: #fff;\r\n      }\r\n    }\r\n\r\n    .small {\r\n      width: 26px;\r\n    }\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem;\r\n      flex: 0;\r\n      text-align: center;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n    }\r\n\r\n    a {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n</style>\r\n","import PricePresetEditorShell from \"./price-preset-editor-shell.svelte\";\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class PricePresetEditor extends Editor {\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\tid: `item-pile-price-preset-editor-${foundry.utils.randomID()}`,\r\n\t\t\ttitle: game.i18n.format(\"ITEM-PILES.Applications.PricePresetEditor.Title\"),\r\n\t\t\twidth: 500,\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: PricePresetEditorShell,\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n","<script>\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\timport { getContext } from 'svelte';\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { get, writable } from \"svelte/store\";\r\n\timport SETTINGS from \"../../../constants/settings.js\";\r\n\timport { getSetting } from \"../../../helpers/helpers.js\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\tlet form;\r\n\r\n\texport let elementRoot;\r\n\texport let data;\r\n\r\n\tconst itemFilters = (getSetting(SETTINGS.ITEM_FILTERS).find(filter => filter.path === \"type\")?.filters ?? \"\").split(',');\r\n\r\n\tconst unstackableItemTypesStore = writable(data);\r\n\tlet systemTypes = Object.keys(game.system.documentTypes.Item).filter(type => !itemFilters.includes(type));\r\n\tlet unusedTypes = [];\r\n\r\n\t$: {\r\n\t\tunusedTypes = systemTypes.filter(systemType => !$unstackableItemTypesStore.some(type => type === systemType));\r\n\t}\r\n\r\n\tfunction add() {\r\n\t\tif (!unusedTypes.length) return;\r\n\t\tunstackableItemTypesStore.update(arr => {\r\n\t\t\tarr.push(unusedTypes[0]);\r\n\t\t\treturn arr;\r\n\t\t})\r\n\t}\r\n\r\n\tfunction remove(index) {\r\n\t\tunstackableItemTypesStore.update(arr => {\r\n\t\t\tarr.splice(index, 1)\r\n\t\t\treturn arr;\r\n\t\t})\r\n\t}\r\n\r\n\tasync function updateSettings() {\r\n\t\tapplication.options.resolve(get(unstackableItemTypesStore));\r\n\t\tapplication.close();\r\n\t}\r\n\r\n\texport function requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\t<form autocomplete=off bind:this={form} on:submit|preventDefault={updateSettings}>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.UnstackableItemTypesEditor.Explanation\")}</p>\r\n\r\n\t\t<table>\r\n\t\t\t<tr>\r\n\t\t\t\t<th>{localize(\"ITEM-PILES.Applications.UnstackableItemTypesEditor.Type\")}</th>\r\n\t\t\t\t<th class=\"small\"><a class=\"item-piles-clickable\" on:click={add}><i class=\"fas fa-plus\"></i></a></th>\r\n\t\t\t</tr>\r\n\t\t\t{#each $unstackableItemTypesStore as type, index (index)}\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<select bind:value={type}>\r\n\t\t\t\t\t\t\t{#each systemTypes as systemType}\r\n\t\t\t\t\t\t\t\t<option value=\"{systemType}\" disabled=\"{systemType !== type && !unusedTypes.includes(systemType)}\">\r\n\t\t\t\t\t\t\t\t\t{systemType}\r\n\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td class=\"small\">\r\n\t\t\t\t\t\t<button type=\"button\" on:click={remove(index)}><i class=\"fas fa-times\"></i></button>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t{/each}\r\n\t\t</table>\r\n\r\n\t\t<footer>\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={() => { application.close(); }} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  table {\r\n    vertical-align: middle;\r\n\r\n    tr {\r\n      border-spacing: 15px;\r\n    }\r\n\r\n    .small {\r\n      width: 26px;\r\n    }\r\n\r\n    select {\r\n      width: 100%;\r\n    }\r\n\r\n    button {\r\n      padding: 0.25rem 0.25rem;\r\n      line-height: 1rem;\r\n      flex: 0;\r\n      text-align: center;\r\n    }\r\n\r\n    a {\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n</style>\r\n","import UnstackableItemTypesEditorShell from './unstackable-item-types-editor.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class UnstackableItemTypesEditor extends Editor {\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Applications.UnstackableItemTypesEditor.Title\"),\r\n\t\t\twidth: 300,\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: UnstackableItemTypesEditorShell,\r\n\t\t\t},\r\n\t\t})\r\n\t}\r\n}\r\n","<script>\r\n\r\n\timport { get, writable } from \"svelte/store\";\r\n\timport { getContext } from \"svelte\";\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let data;\r\n\texport let elementRoot;\r\n\r\n\tlet form;\r\n\r\n\tconst options = application.options;\r\n\r\n\tconst styleValues = data?.subscribe ? data : writable(data);\r\n\r\n\tconst styleStore = Object.entries(get(styleValues));\r\n\tlet values = writable(styleStore.length ? styleStore : [[\"\", \"\"]])\r\n\r\n\tfunction add() {\r\n\t\tvalues.update(arr => {\r\n\t\t\treturn [...arr, [\"\", \"\"]];\r\n\t\t})\r\n\t}\r\n\r\n\tfunction remove(index) {\r\n\t\tvalues.update(arr => {\r\n\t\t\tarr.splice(index, 1);\r\n\t\t\treturn arr;\r\n\t\t})\r\n\t}\r\n\r\n\t$: {\r\n\t\tconst data = Object.fromEntries($values\r\n\t\t\t.map(entry => [entry[0].trim(), entry[1].trim()])\r\n\t\t\t.filter(entry => entry[0].length && entry[1].length)\r\n\t\t);\r\n\t\tstyleValues.set(data);\r\n\t\tif (options.onchange) {\r\n\t\t\toptions.onchange(data);\r\n\t\t}\r\n\t}\r\n\r\n\tasync function updateSettings() {\r\n\t\tapplication.options.resolve(Object.fromEntries(get(values)));\r\n\t\tapplication.close();\r\n\t}\r\n\r\n\texport function requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<form autocomplete=off bind:this={form} on:submit|preventDefault={updateSettings}>\r\n\r\n\t\t<div class=\"item-piles-bottom-divider\"\r\n\t\t     style=\"display: grid; grid-template-columns: 1.25fr 2fr {options.readOnly ? '' : 'auto'}; gap: 5px;\">\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.StylesEditor.\" + (options.variables ? \"Variable\" : \"Style\"))}</span>\r\n\t\t\t<span>{localize(\"ITEM-PILES.Applications.StylesEditor.Value\")}</span>\r\n\t\t\t{#if !options.readOnly}\r\n\t\t\t\t<a class=\"item-piles-flexrow align-center-row item-piles-clickable-green\" style=\"text-align: center;\"\r\n\t\t\t\t   on:click={() => add()}>\r\n\t\t\t\t\t<i class=\"fas fa-plus\"></i>\r\n\t\t\t\t</a>\r\n\t\t\t{/if}\r\n\r\n\t\t\t{#each $values as [key, value], index (index)}\r\n\t\t\t\t<input disabled={options.readOnly} autocomplete=\"false\" type=\"text\" bind:value={key}/>\r\n\t\t\t\t<input autocomplete=\"false\" type=\"text\" bind:value={value}/>\r\n\t\t\t\t{#if !options.readOnly}\r\n\t\t\t\t\t<a class=\"item-piles-flexrow align-center-row\" style=\"text-align: center;\" on:click={() => remove(index)}>\r\n\t\t\t\t\t\t<i class=\"fas fa-times item-piles-clickable-red\"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t{/if}\r\n\t\t\t{/each}\r\n\r\n\t\t</div>\r\n\r\n\t\t<footer>\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={() => { application.options.resolve(null); application.close(); }} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n\r\n</ApplicationShell>\r\n","import StylesEditorShell from './styles-editor.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class StylesEditor extends Editor {\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Applications.StylesEditor.Title\"),\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: StylesEditorShell,\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n","<script>\r\n\r\n\timport * as Helpers from \"../../../helpers/helpers.js\";\r\n\timport { writable } from \"svelte/store\";\r\n\timport { getContext } from \"svelte\";\r\n\timport StylesEditor from \"../styles-editor/styles-editor.js\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let index;\r\n\texport let entry;\r\n\texport let image;\r\n\texport let remove;\r\n\r\n\tlet style = writable(entry.styling);\r\n\r\n\tasync function renderStyleEditor(event) {\r\n\r\n\t\tconst oldStyle = entry.styling;\r\n\r\n\t\tconst newStyles = await StylesEditor.show(style, {\r\n\t\t\twidth: 400,\r\n\t\t\tleft: application.position.left + 405,\r\n\t\t\ttop: event.clientY - 75,\r\n\t\t\treadOnly: false\r\n\t\t});\r\n\r\n\t\tstyle.set(newStyles || oldStyle);\r\n\t\tentry.styling = newStyles || oldStyle;\r\n\r\n\t}\r\n\r\n</script>\r\n\r\n<div><input bind:value=\"{entry.path}\" placeholder=\"system.rarity\" required type=\"text\"/></div>\r\n<div><input bind:value=\"{entry.value}\" placeholder=\"rare\" required type=\"text\"/></div>\r\n<div>\r\n\t{#if image}\r\n\t\t<img class=\"item-piles-item-image-example\" src={image}/>\r\n\t{/if}\r\n\t<div class=\"img-div\" style={Helpers.styleFromObject($style)}></div>\r\n</div>\r\n<div>\r\n\t<a class=\"item-piles-clickable-green\" on:click={(evt) => renderStyleEditor(evt)}>\r\n\t\t<i class=\"fas fa-cog\"></i>\r\n\t</a>\r\n</div>\r\n<div>\r\n\t<a class=\"item-piles-clickable-red\" on:click={remove(index)}>\r\n\t\t<i class=\"fas fa-times\"></i>\r\n\t</a>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  div {\r\n    display: flex;\r\n    align-items: center;\r\n    position: relative;\r\n    justify-content: center;\r\n\r\n    img, .img-div {\r\n      position: absolute;\r\n      border-radius: 4px;\r\n      min-height: 24px;\r\n      min-width: 24px;\r\n      max-height: 24px;\r\n      max-width: 24px;\r\n    }\r\n\r\n    a {\r\n      padding: 0;\r\n      line-height: inherit;\r\n      text-align: center;\r\n\r\n      > i {\r\n        line-height: inherit;\r\n        margin: 0;\r\n      }\r\n    }\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\timport { getContext } from 'svelte';\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { get, writable } from \"svelte/store\";\r\n\timport StyleEntry from \"./StyleEntry.svelte\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\tlet form;\r\n\r\n\texport let elementRoot;\r\n\texport let data;\r\n\r\n\tconst vaultStyleStore = writable(data);\r\n\r\n\tloadImages();\r\n\r\n\tfunction add() {\r\n\t\tvaultStyleStore.update(arr => {\r\n\t\t\tarr.push({ path: \"\", value: \"\", styling: {} })\r\n\t\t\treturn arr;\r\n\t\t});\r\n\t}\r\n\r\n\tlet images = [];\r\n\r\n\tasync function loadImages() {\r\n\t\tconst data = await FilePicker.browse(\"public\", \"icons/weapons/swords/*.webp\", { wildcard: true });\r\n\t\timages = data.files;\r\n\t}\r\n\r\n\tfunction remove(index) {\r\n\t\tvaultStyleStore.update(arr => {\r\n\t\t\tarr.splice(index, 1)\r\n\t\t\treturn arr;\r\n\t\t});\r\n\t}\r\n\r\n\tasync function updateSettings() {\r\n\t\tapplication.options.resolve(get(vaultStyleStore));\r\n\t\tapplication.close();\r\n\t}\r\n\r\n\texport function requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\t<form autocomplete=off bind:this={form} on:submit|preventDefault={updateSettings}>\r\n\t\t<p>{localize(\"ITEM-PILES.Applications.VaultStylesEditor.Explanation\")}</p>\r\n\r\n\t\t<div class=\"item-piles-table\">\r\n\t\t\t<div>{localize(\"ITEM-PILES.Applications.VaultStylesEditor.Path\")}</div>\r\n\t\t\t<div>{localize(\"ITEM-PILES.Applications.VaultStylesEditor.Value\")}</div>\r\n\t\t\t<div></div>\r\n\t\t\t<div></div>\r\n\t\t\t<div style=\"text-align: right;\"><a class=\"item-piles-clickable\" on:click={add}><i class=\"fas fa-plus\"></i></a>\r\n\t\t\t</div>\r\n\r\n\t\t\t{#each $vaultStyleStore as entry, index (index)}\r\n\t\t\t\t<StyleEntry bind:entry image={images[index]} {index} {remove}/>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\r\n\t\t<footer>\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"Save\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={() => { application.close(); }} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-times\"></i> { localize(\"Cancel\") }\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</form>\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-table {\r\n    display: grid;\r\n    grid-template-columns: 1fr 1fr 26px 21px 21px;\r\n    padding: 3px;\r\n    gap: 3px;\r\n\r\n    div > a {\r\n      display: flex;\r\n      align-items: center;\r\n      position: relative;\r\n      justify-content: center;\r\n\r\n      a {\r\n        padding: 0;\r\n        line-height: inherit;\r\n        text-align: center;\r\n\r\n\r\n        > i {\r\n          line-height: inherit;\r\n          margin: 0;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n</style>\r\n","import VaultStylesEditorShell from './vault-styles-editor.svelte';\r\nimport Editor from \"../Editor.js\";\r\n\r\nexport default class VaultStylesEditor extends Editor {\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Applications.VaultStylesEditor.Title\"),\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: VaultStylesEditorShell,\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}\r\n","import { CurrenciesEditor, SecondaryCurrenciesEditor } from \"./currencies-editor/currencies-editor.js\";\r\nimport ItemFiltersEditor from \"./item-filters-editor/item-filters-editor.js\";\r\nimport StringListEditor from \"./string-list-editor/string-list-editor.js\";\r\nimport PriceModifiersEditor from \"./price-modifiers-editor/price-modifiers-editor.js\";\r\nimport PricePresetEditor from \"./price-preset-editor/price-preset-editor.js\";\r\nimport UnstackableItemTypesEditor from \"./unstackable-item-types-editor/unstackable-item-types-editor.js\";\r\nimport VaultStylesEditor from \"./vault-styles-editor/vault-styles-editor.js\";\r\nimport StylesEditor from \"./styles-editor/styles-editor.js\";\r\n\r\nexport default {\r\n\t\"currencies\": CurrenciesEditor,\r\n\t\"secondary-currencies\": SecondaryCurrenciesEditor,\r\n\t\"item-filters\": ItemFiltersEditor,\r\n\t\"item-similarities\": StringListEditor,\r\n\t\"item-categories\": StringListEditor,\r\n\t\"styles\": StylesEditor,\r\n\t\"vault-styles\": VaultStylesEditor,\r\n\t\"price-modifiers\": PriceModifiersEditor,\r\n\t\"unstackable-item-types\": UnstackableItemTypesEditor,\r\n\t\"price-presets\": PricePresetEditor\r\n}\r\n","<script>\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { getContext } from 'svelte';\r\n\timport editors from \"../editors/index.js\";\r\n\timport { openEditor } from \"../../helpers/helpers.js\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let key;\r\n\texport let data;\r\n\texport let callback = false;\r\n\r\n\tlet editor = false;\r\n\tif (!callback) {\r\n\t\teditor = editors[data.application];\r\n\t\tcallback = () => {\r\n\t\t\tshowEditor();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction showEditor() {\r\n\t\tif (editor) {\r\n\t\t\tconst combinedData = data?.mergedDefaults\r\n\t\t\t\t? foundry.utils.mergeObject(data.mergedDefaults, data.value)\r\n\t\t\t\t: data.value;\r\n\t\t\topenEditor(key, combinedData).then((result) => {\r\n\t\t\t\tif (!result) return;\r\n\t\t\t\tif (data?.mergedDefaults) {\r\n\t\t\t\t\tresult = foundry.utils.diffObject(data?.mergedDefaults, result);\r\n\t\t\t\t}\r\n\t\t\t\tdata.value = result;\r\n\t\t\t});\r\n\t\t\tapplication.options.zLevel = 100;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction reset() {\r\n\t\tdata.value = foundry.utils.deepClone(data.default);\r\n\t}\r\n\r\n</script>\r\n\r\n<div class=\"setting form-scope item-piles-flexrow\">\r\n\r\n\t<div class=\"label-side\">\r\n\t\t<label>\r\n\t\t\t{localize(data.name)}\r\n\t\t\t{#if !data.hideResetButton}\r\n\t\t\t\t<a on:click={() => reset()} data-fast-tooltip=\"Reset setting\">\r\n\t\t\t\t\t<i class=\"fas fa-undo reset-setting\"></i>\r\n\t\t\t\t</a>\r\n\t\t\t{/if}\r\n\t\t</label>\r\n\t\t<p class=\"notes\">{localize(data.hint)}</p>\r\n\t</div>\r\n\r\n\t<div class=\"form-fields input-side\">\r\n\t\t<div class=\"button-container\">\r\n\t\t\t<button on:click={() => { callback(); }} type=\"button\">\r\n\t\t\t\t<i class=\"{data.icon}\"></i>\r\n\t\t\t\t{localize(data.label)}\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t</div>\r\n\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .setting:not(:last-child) {\r\n    border-bottom: 1px solid rgba(0, 0, 0, 0.25);\r\n    margin-bottom: 0.5rem;\r\n    padding-bottom: 0.5rem;\r\n  }\r\n\r\n  .reset-setting {\r\n    font-size: 0.75rem;\r\n    margin-left: 0.5rem;\r\n    opacity: 0.5;\r\n    transition: opacity 250ms;\r\n\r\n    &:hover {\r\n      opacity: 1.0;\r\n    }\r\n  }\r\n\r\n  .invalid {\r\n    border: 2px solid #d93131;\r\n  }\r\n\r\n  label {\r\n    flex: 1 0 auto;\r\n  }\r\n\r\n  .form-fields {\r\n    flex: 0 1 auto;\r\n  }\r\n\r\n  .setting-container {\r\n    display: flex;\r\n    flex-direction: column;\r\n  }\r\n\r\n  .label-side {\r\n    flex: 1;\r\n    margin-right: 1rem;\r\n  }\r\n\r\n  .button-container {\r\n    min-width: 220px;\r\n    max-width: 220px;\r\n    height: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n\r\n  button {\r\n    flex: 1;\r\n    line-height: initial;\r\n    padding: 0.5rem 0;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\timport SETTINGS from \"../../constants/settings.js\";\r\n\r\n\timport { getContext } from 'svelte';\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { ApplicationShell } from '#runtime/svelte/component/core';\r\n\r\n\timport * as helpers from \"../../helpers/helpers.js\"\r\n\timport { applyDefaultSettings } from \"../../settings.js\";\r\n\r\n\timport Setting from \"./Setting.svelte\";\r\n\timport SettingButton from \"./SettingButton.svelte\";\r\n\timport Tabs from \"../components/Tabs.svelte\";\r\n\timport { TJSDialog } from \"#runtime/svelte/application\";\r\n\timport CustomDialog from \"../components/CustomDialog.svelte\";\r\n\timport { getDocumentTemplates } from \"../../helpers/utilities.js\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let elementRoot;\r\n\tlet form;\r\n\r\n\texport let settings = {};\r\n\tlet userCanChangeSettings = game.user.hasPermission(\"SETTINGS_MODIFY\");\r\n\r\n\tgetSettings();\r\n\r\n\tfunction getSettings() {\r\n\t\tsettings = Object.fromEntries(Object.entries(SETTINGS.GET_DEFAULT()).map(entry => {\r\n\t\t\tentry[1].value = helpers.getSetting(entry[0]);\r\n\t\t\treturn entry;\r\n\t\t}));\r\n\r\n\t\tsettings[SETTINGS.POPULATION_TABLES_FOLDER].choices = {\r\n\t\t\t\"root\": \"ITEM-PILES.Settings.PopulationTablesFolder.AllTables\",\r\n\t\t\t...Object.fromEntries(\r\n\t\t\t\tgame.folders\r\n\t\t\t\t\t.filter(f => f.type === \"RollTable\")\r\n\t\t\t\t\t.map(f => [f.id, f.name])\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\r\n\texport function importSettings(incomingSettings) {\r\n\t\tfor (const [key, value] of Object.entries(incomingSettings)) {\r\n\t\t\tif (settings[SETTINGS[key]] === undefined) continue;\r\n\t\t\tsettings[SETTINGS[key]].value = value;\r\n\t\t}\r\n\t\tsettings = settings;\r\n\t}\r\n\r\n\tfunction requestSubmit() {\r\n\t\tform.requestSubmit();\r\n\t}\r\n\r\n\tasync function updateSettings() {\r\n\t\tlet settingsToUpdate = Object.entries(settings).filter(entry => userCanChangeSettings || entry[1].scope === \"client\");\r\n\t\tfor (let [key, setting] of settingsToUpdate) {\r\n\t\t\tawait helpers.setSetting(key, setting.value);\r\n\t\t}\r\n\t\tconst currencies = settings[SETTINGS.CURRENCIES].value.concat(settings[SETTINGS.SECONDARY_CURRENCIES].value)\r\n\t\tfor (const currency of currencies) {\r\n\t\t\tif (!currency.data?.uuid) continue;\r\n\t\t\tconst actualItem = await fromUuid(currency.data?.uuid);\r\n\t\t\tawait actualItem.update({\r\n\t\t\t\tname: currency.name,\r\n\t\t\t\timg: currency.img\r\n\t\t\t});\r\n\t\t}\r\n\t\tapplication.close();\r\n\t}\r\n\r\n\tasync function resetSettings() {\r\n\r\n\t\tconst doThing = await TJSDialog.confirm({\r\n\t\t\ttitle: \"Item Piles - \" + game.i18n.localize(\"ITEM-PILES.Dialogs.ResetSettings.Title\"),\r\n\t\t\tcontent: {\r\n\t\t\t\tclass: CustomDialog,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\tcontent: game.i18n.localize(\"ITEM-PILES.Dialogs.ResetSettings.Content\")\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbuttons: {\r\n\t\t\t\tyes: {\r\n\t\t\t\t\ticon: '<i class=\"fas fa-check\"></i>',\r\n\t\t\t\t\tlabel: game.i18n.localize(\"ITEM-PILES.Dialogs.ResetSettings.Confirm\")\r\n\t\t\t\t},\r\n\t\t\t\tno: {\r\n\t\t\t\t\ticon: '<i class=\"fas fa-times\"></i>',\r\n\t\t\t\t\tlabel: game.i18n.localize(\"No\")\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmodal: true,\r\n\t\t\tdraggable: false,\r\n\t\t\trejectClose: false,\r\n\t\t\tdefaultYes: true,\r\n\t\t\toptions: {\r\n\t\t\t\theight: \"auto\"\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (!doThing) return;\r\n\r\n\t\treturn applyDefaultSettings();\r\n\t}\r\n\r\n\tlet tabs = [\r\n\t\t{ value: \"local\", label: localize(\"ITEM-PILES.Applications.Settings.Local\") },\r\n\t\t{ value: \"module\", label: localize(\"ITEM-PILES.Applications.Settings.Module\"), hidden: !userCanChangeSettings },\r\n\t\t{ value: \"styles\", label: localize(\"ITEM-PILES.Applications.Settings.Styles\"), hidden: !userCanChangeSettings },\r\n\t\t{ value: \"system\", label: localize(\"ITEM-PILES.Applications.Settings.System\"), hidden: !userCanChangeSettings },\r\n\t];\r\n\r\n\tlet activeTab = application?.options?.tab ?? tabs[0].value;\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\t<form autocomplete=\"off\" bind:this={form} on:submit|once|preventDefault={updateSettings}>\r\n\r\n\t\t<h2 style=\"text-align: center; margin-bottom: 1rem;\">{localize(\"ITEM-PILES.Applications.Settings.Title\")}</h2>\r\n\r\n\t\t{#if userCanChangeSettings}\r\n\t\t\t<Tabs bind:activeTab {tabs}/>\r\n\t\t{/if}\r\n\r\n\t\t<section class=\"item-piles-tab-body\">\r\n\r\n\t\t\t<div class=\"item-piles-tab\" class:active={activeTab === 'local'} data-scope=\"primary\"\r\n\t\t\t     data-tab=\"local\">\r\n\r\n\t\t\t\t<Setting bind:data=\"{settings[SETTINGS.INVERT_SHEET_OPEN]}\" key={SETTINGS.INVERT_SHEET_OPEN}/>\r\n\t\t\t\t<Setting bind:data=\"{settings[SETTINGS.HIDE_ACTOR_HEADER_TEXT]}\" key={SETTINGS.HIDE_ACTOR_HEADER_TEXT}/>\r\n\t\t\t\t<Setting bind:data=\"{settings[SETTINGS.HIDE_ACTOR_HEADER_BUTTON]}\" key={SETTINGS.HIDE_ACTOR_HEADER_BUTTON}/>\r\n\t\t\t\t<Setting bind:data=\"{settings[SETTINGS.PRELOAD_FILES]}\" key={SETTINGS.PRELOAD_FILES}/>\r\n\t\t\t\t<Setting bind:data=\"{settings[SETTINGS.DEBUG]}\" key={SETTINGS.DEBUG}/>\r\n\t\t\t\t<Setting bind:data=\"{settings[SETTINGS.DEBUG_HOOKS]}\" key={SETTINGS.DEBUG_HOOKS}/>\r\n\r\n\t\t\t\t<div style=\"text-align: center; font-size: 1rem; margin-top:3rem;\">\r\n\t\t\t\t\t<p>{localize(\"ITEM-PILES.Applications.Settings.MoreToCome\")}\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t<p style=\"margin-bottom:1rem;\">\r\n\t\t\t\t\t\t<a class=\"link-text\"\r\n\t\t\t\t\t\t   href=\"https://github.com/fantasycalendar/FoundryVTT-ItemPiles/issues/new?assignees=&labels=&template=feature_request.md&title=\"\r\n\t\t\t\t\t\t   target=\"_blank\"\r\n\t\t\t\t\t\t>{localize(\"ITEM-PILES.Applications.Settings.Request\")}</a>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\t{localize(\"ITEM-PILES.Applications.Settings.Donate\")}\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\t<a href=\"https://ko-fi.com/fantasycomputerworks\" style=\"text-decoration: none !important;\" target=\"_blank\">\r\n\t\t\t\t\t\t\t<button class=\"donate-button\" type=\"button\">\r\n\t\t\t\t\t\t\t\t<img src=\"https://storage.ko-fi.com/cdn/cup-border.png\">\r\n\t\t\t\t\t\t\t\t<span>Donate</span>\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t\t{#if userCanChangeSettings}\r\n\t\t\t\t<div class=\"item-piles-tab\" class:active={activeTab === 'module'}>\r\n\t\t\t\t\t<Setting key={SETTINGS.ENABLE_DROPPING_ITEMS} bind:data=\"{settings[SETTINGS.ENABLE_DROPPING_ITEMS]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.ENABLE_GIVING_ITEMS} bind:data=\"{settings[SETTINGS.ENABLE_GIVING_ITEMS]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.ENABLE_TRADING} bind:data=\"{settings[SETTINGS.ENABLE_TRADING]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.SHOW_TRADE_BUTTON} bind:data=\"{settings[SETTINGS.SHOW_TRADE_BUTTON]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.INSPECT_ITEMS_IN_TRADE} bind:data=\"{settings[SETTINGS.INSPECT_ITEMS_IN_TRADE]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.OUTPUT_TO_CHAT} bind:data=\"{settings[SETTINGS.OUTPUT_TO_CHAT]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.DELETE_EMPTY_PILES} bind:data=\"{settings[SETTINGS.DELETE_EMPTY_PILES]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.POPULATION_TABLES_FOLDER} bind:data=\"{settings[SETTINGS.POPULATION_TABLES_FOLDER]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.HIDE_TOKEN_BORDER} bind:data=\"{settings[SETTINGS.HIDE_TOKEN_BORDER]}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.PRICE_PRESETS} bind:data=\"{settings[SETTINGS.PRICE_PRESETS]}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.CUSTOM_ITEM_CATEGORIES} bind:data=\"{settings[SETTINGS.CUSTOM_ITEM_CATEGORIES]}\"/>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"item-piles-tab\" class:active={activeTab === 'styles'}>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.CSS_VARIABLES} bind:data=\"{settings[SETTINGS.CSS_VARIABLES]}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.VAULT_STYLES} bind:data=\"{settings[SETTINGS.VAULT_STYLES]}\"/>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"item-piles-tab\" class:active={activeTab === 'system'}>\r\n\t\t\t\t\t<SettingButton data={{\r\n            name: \"ITEM-PILES.Settings.Reset.Title\",\r\n            hint: \"ITEM-PILES.Settings.Reset.Hint\",\r\n            label: \"ITEM-PILES.Settings.Reset.Label\",\r\n            icon: \"fas fa-undo\",\r\n            hideResetButton: true\r\n          }} callback={async () => {\r\n            await resetSettings()\r\n            getSettings();\r\n          }}/>\r\n\t\t\t\t\t<Setting key={SETTINGS.ACTOR_CLASS_TYPE} bind:data=\"{settings[SETTINGS.ACTOR_CLASS_TYPE]}\"\r\n\t\t\t\t\t         options={[\"None\", ...Object.keys(getDocumentTemplates(\"Actor\"))]}/>\r\n\t\t\t\t\t<Setting key={SETTINGS.ITEM_CLASS_LOOT_TYPE} bind:data=\"{settings[SETTINGS.ITEM_CLASS_LOOT_TYPE]}\"\r\n\t\t\t\t\t         options={[\"None\", ...Object.keys(getDocumentTemplates(\"Item\"))]}/>\r\n\t\t\t\t\t<Setting key={SETTINGS.ITEM_CLASS_WEAPON_TYPE} bind:data=\"{settings[SETTINGS.ITEM_CLASS_WEAPON_TYPE]}\"\r\n\t\t\t\t\t         options={[\"None\", ...Object.keys(getDocumentTemplates(\"Item\"))]}/>\r\n\t\t\t\t\t<Setting key={SETTINGS.ITEM_CLASS_EQUIPMENT_TYPE} bind:data=\"{settings[SETTINGS.ITEM_CLASS_EQUIPMENT_TYPE]}\"\r\n\t\t\t\t\t         options={[\"None\", ...Object.keys(getDocumentTemplates(\"Item\"))]}/>\r\n\t\t\t\t\t<Setting key={SETTINGS.ITEM_QUANTITY_ATTRIBUTE} bind:data=\"{settings[SETTINGS.ITEM_QUANTITY_ATTRIBUTE]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.ITEM_PRICE_ATTRIBUTE} bind:data=\"{settings[SETTINGS.ITEM_PRICE_ATTRIBUTE]}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.CURRENCIES} bind:data=\"{settings[SETTINGS.CURRENCIES]}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.SECONDARY_CURRENCIES} bind:data=\"{settings[SETTINGS.SECONDARY_CURRENCIES]}\"/>\r\n\t\t\t\t\t<Setting key={SETTINGS.CURRENCY_DECIMAL_DIGITS} bind:data=\"{settings[SETTINGS.CURRENCY_DECIMAL_DIGITS]}\"\r\n\t\t\t\t\t         disabled=\"{settings[SETTINGS.CURRENCIES].value.length !== 1}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.ITEM_FILTERS} bind:data=\"{settings[SETTINGS.ITEM_FILTERS]}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.ITEM_SIMILARITIES} bind:data=\"{settings[SETTINGS.ITEM_SIMILARITIES]}\"/>\r\n\t\t\t\t\t<SettingButton key={SETTINGS.UNSTACKABLE_ITEM_TYPES} bind:data=\"{settings[SETTINGS.UNSTACKABLE_ITEM_TYPES]}\"/>\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\r\n\t\t</section>\r\n\r\n\t\t<footer>\r\n\t\t\t<button on:click|once={requestSubmit} type=\"button\">\r\n\t\t\t\t<i class=\"far fa-save\"></i> {localize(\"ITEM-PILES.Applications.Settings.Submit\")}\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\t</form>\r\n</ApplicationShell>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .link-text {\r\n    color: var(--color-text-hyperlink);\r\n  }\r\n\r\n  .donate-button {\r\n    border: 0;\r\n    border-radius: 9999px;\r\n    background-color: #00bfa5;\r\n    align-items: center;\r\n    font-family: nunito, quicksand, sans-serif;\r\n    font-size: 16px;\r\n    width: max-content;\r\n    justify-content: space-between;\r\n    padding: 5px 15px;\r\n    font-weight: 700;\r\n    cursor: pointer;\r\n    -webkit-border-radius: 100px;\r\n    display: flex;\r\n    margin: 10px auto;\r\n\r\n    img {\r\n      border: 0;\r\n      width: 39px;\r\n    }\r\n\r\n    span {\r\n      margin-left: 8px;\r\n      color: white !important;\r\n    }\r\n  }\r\n\r\n  .preset-select {\r\n    display: flex;\r\n    flex-direction: row;\r\n    border-bottom: 1px solid rgba(0, 0, 0, 0.25);\r\n    margin-bottom: 0.5rem;\r\n    padding-bottom: 0.5rem;\r\n\r\n    align-items: center;\r\n\r\n    label {\r\n      flex: 0 1 auto;\r\n      margin-right: 0.5rem;\r\n    }\r\n\r\n    select {\r\n      flex: 1;\r\n    }\r\n\r\n    button {\r\n      margin-left: 0.25rem;\r\n      flex: 0 1 auto;\r\n      width: auto;\r\n      height: 27px;\r\n      text-align: center;\r\n      line-height: normal;\r\n    }\r\n  }\r\n\r\n  .item-piles-tab-body {\r\n    max-height: 729px;\r\n    min-height: 729px;\r\n    overflow-y: scroll;\r\n    padding: 5px;\r\n\r\n    .item-piles-tab {\r\n      display: none;\r\n\r\n      &.active {\r\n        display: block;\r\n      }\r\n    }\r\n  }\r\n\r\n  footer {\r\n    border-top: 1px solid rgba(0, 0, 0, 0.25);\r\n    margin-top: 0.5rem;\r\n    padding-top: 0.5rem;\r\n  }\r\n\r\n\r\n</style>\r\n","import { SvelteApplication } from '#runtime/svelte/application';\r\nimport { getActiveApps } from '../../helpers/helpers';\r\nimport SettingsShell from './settings-shell.svelte';\r\nimport SETTINGS from \"../../constants/settings.js\";\r\n\r\nexport class SettingsApp extends SvelteApplication {\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\tid: `item-piles-application-system-settings-${foundry.utils.randomID()}`,\r\n\t\t\ttitle: \"Item Piles Module Configuration\",\r\n\t\t\twidth: 600,\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: SettingsShell,\r\n\t\t\t\ttarget: document.body\r\n\t\t\t},\r\n\t\t\tzIndex: 100,\r\n\t\t\tclasses: [\"item-piles-app\"],\r\n\t\t});\r\n\t}\r\n\r\n\tstatic getActiveApp() {\r\n\t\treturn getActiveApps(\"item-piles-application-system-settings\", true);\r\n\t}\r\n\r\n\tstatic async show(options = {}, dialogData = {}) {\r\n\t\tconst app = this.getActiveApp()\r\n\t\tif (app) return app.render(false, { focus: true });\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\toptions.resolve = resolve;\r\n\t\t\tnew this(options, dialogData).render(true, { focus: true });\r\n\t\t})\r\n\t}\r\n\r\n\r\n\t/** @override */\r\n\t_getHeaderButtons() {\r\n\t\tlet buttons = super._getHeaderButtons();\r\n\t\tif (game.user.isGM) {\r\n\t\t\tbuttons = [\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"ITEM-PILES.Applications.Settings.Export\",\r\n\t\t\t\t\tclass: \"item-piles-export-settings\",\r\n\t\t\t\t\ticon: \"fas fa-file-export\",\r\n\t\t\t\t\tonclick: () => {\r\n\t\t\t\t\t\tconst settingKeys = Object.fromEntries(Object.entries(SETTINGS)\r\n\t\t\t\t\t\t\t.filter(([_, value]) => typeof value === \"string\")\r\n\t\t\t\t\t\t\t.map(([key, value]) => [value, key]));\r\n\t\t\t\t\t\tconst settings = Object.entries(this.svelte.applicationShell.settings)\r\n\t\t\t\t\t\t\t.filter(([_, setting]) => {\r\n\t\t\t\t\t\t\t\treturn setting.system && setting.name;\r\n\t\t\t\t\t\t\t}).map(([key, setting]) => {\r\n\t\t\t\t\t\t\t\treturn [settingKeys[key], setting.value];\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tconst a = document.createElement(\"a\");\r\n\t\t\t\t\t\tconst file = new Blob([JSON.stringify(Object.fromEntries(settings), null, 4)], { type: \"text/json\" });\r\n\t\t\t\t\t\ta.href = URL.createObjectURL(file);\r\n\t\t\t\t\t\ta.download = `item-piles-${game.system.id}.json`;\r\n\t\t\t\t\t\ta.click();\r\n\t\t\t\t\t\ta.remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"ITEM-PILES.Applications.Settings.Import\",\r\n\t\t\t\t\tclass: \"item-piles-import-settings\",\r\n\t\t\t\t\ticon: \"fas fa-file-import\",\r\n\t\t\t\t\tonclick: () => {\r\n\r\n\t\t\t\t\t\tconst input = document.createElement('input');\r\n\t\t\t\t\t\tinput.type = 'file';\r\n\r\n\t\t\t\t\t\tinput.onchange = e => {\r\n\r\n\t\t\t\t\t\t\tinput.remove();\r\n\r\n\t\t\t\t\t\t\t// getting a hold of the file reference\r\n\t\t\t\t\t\t\tconst file = e.target.files[0];\r\n\r\n\t\t\t\t\t\t\tconst reader = new FileReader();\r\n\t\t\t\t\t\t\treader.addEventListener('load', async () => {\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\tconst incomingSettings = JSON.parse(reader.result);\r\n\t\t\t\t\t\t\t\t\tthis.svelte.applicationShell.importSettings(incomingSettings)\r\n\t\t\t\t\t\t\t\t} catch (err) {\r\n\t\t\t\t\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\treader.readAsText(file);\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tinput.click();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t].concat(buttons);\r\n\t\t}\r\n\t\treturn buttons\r\n\t}\r\n}\r\n\r\nexport class SettingsShim extends FormApplication {\r\n\r\n\t/**\r\n\t * @inheritDoc\r\n\t */\r\n\tconstructor() {\r\n\t\tsuper({});\r\n\t\tSettingsApp.show();\r\n\t}\r\n\r\n\tasync _updateObject(event, formData) {\r\n\t}\r\n\r\n\trender() {\r\n\t\tthis.close();\r\n\t}\r\n\r\n}\r\n","import CONSTANTS from \"./constants/constants.js\";\r\nimport SETTINGS from \"./constants/settings.js\";\r\nimport * as Helpers from \"./helpers/helpers.js\";\r\nimport { SYSTEMS } from \"./systems.js\";\r\nimport { SettingsShim, SettingsApp } from \"./applications/settings-app/settings-app.js\";\r\nimport { TJSDialog } from \"#runtime/svelte/application\";\r\nimport CustomDialog from \"./applications/components/CustomDialog.svelte\";\r\n\r\nexport function registerSettings() {\r\n\r\n\tgame.settings.registerMenu(CONSTANTS.MODULE_NAME, \"configure-settings\", {\r\n\t\tname: \"ITEM-PILES.Settings.Configure.Title\",\r\n\t\tlabel: \"ITEM-PILES.Settings.Configure.Label\",\r\n\t\thint: \"ITEM-PILES.Settings.Configure.Hint\",\r\n\t\ticon: \"fas fa-cog\",\r\n\t\ttype: SettingsShim,\r\n\t\trestricted: false\r\n\t});\r\n\r\n\tfor (let [name, data] of Object.entries(SETTINGS.GET_DEFAULT())) {\r\n\t\tgame.settings.register(CONSTANTS.MODULE_NAME, name, data);\r\n\t}\r\n\r\n}\r\n\r\nexport async function applyDefaultSettings() {\r\n\tconst settings = SETTINGS.GET_SYSTEM_DEFAULTS();\r\n\tfor (const [name, data] of Object.entries(settings)) {\r\n\t\tawait Helpers.setSetting(name, data.default);\r\n\t}\r\n\tawait Helpers.setSetting(SETTINGS.SYSTEM_VERSION, SYSTEMS.DATA.VERSION);\r\n\tawait patchCurrencySettings();\r\n}\r\n\r\nexport async function applySoftMigration(migrationKey) {\r\n\tconst migrationSettings = SYSTEMS.DATA.SOFT_MIGRATIONS[migrationKey];\r\n\tfor (const [key, values] of Object.entries(migrationSettings)) {\r\n\t\tconst settingsKey = SETTINGS[key];\r\n\t\tconst currentSettingValue = Helpers.getSetting(settingsKey);\r\n\t\tawait Helpers.setSetting(settingsKey, foundry.utils.mergeObject(currentSettingValue, values));\r\n\t}\r\n\tawait Helpers.setSetting(SETTINGS.SYSTEM_VERSION, SYSTEMS.DATA.VERSION);\r\n}\r\n\r\nexport async function patchCurrencySettings() {\r\n\tconst currencies = Helpers.getSetting(SETTINGS.CURRENCIES);\r\n\tfor (let currency of currencies) {\r\n\t\tif (currency.type !== \"item\" || !currency.data.uuid || currency.data.item) continue;\r\n\t\tconst item = await fromUuid(currency.data.uuid);\r\n\t\tif (!item) continue;\r\n\t\tcurrency.data.item = item.toObject();\r\n\t}\r\n\treturn Helpers.setSetting(SETTINGS.CURRENCIES, currencies);\r\n}\r\n\r\nexport function applySystemSpecificStyles(data = false) {\r\n\tconst defaultCssVariables = foundry.utils.deepClone(SETTINGS.DEFAULT_CSS_VARIABLES);\r\n\tconst cssVariables = data || Helpers.getSetting(SETTINGS.CSS_VARIABLES);\r\n\tconst mergedCssVariables = foundry.utils.mergeObject(defaultCssVariables, cssVariables)\r\n\tconst root = document.documentElement;\r\n\tfor (const [style, val] of Object.entries(mergedCssVariables)) {\r\n\t\tif (!val) {\r\n\t\t\troot.style.removeProperty(`--item-piles-${style}`)\r\n\t\t} else {\r\n\t\t\troot.style.setProperty(`--item-piles-${style}`, val);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport async function checkSystem() {\r\n\r\n\tif (!SYSTEMS.HAS_SYSTEM_SUPPORT) {\r\n\r\n\t\tif (Helpers.getSetting(SETTINGS.SYSTEM_NOT_FOUND_WARNING_SHOWN)) return;\r\n\r\n\t\tlet settingsValid = true;\r\n\t\tfor (const [name, data] of Object.entries(SETTINGS.GET_DEFAULT())) {\r\n\t\t\tsettingsValid = settingsValid && Helpers.getSetting(name).length !== (new data.type).length\r\n\t\t}\r\n\r\n\t\tif (settingsValid) return;\r\n\r\n\t\tTJSDialog.prompt({\r\n\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Dialogs.NoSystemFound.Title\"),\r\n\t\t\tcontent: {\r\n\t\t\t\tclass: CustomDialog,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\tcontent: game.i18n.localize(\"ITEM-PILES.Dialogs.NoSystemFound.Content\")\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmodal: true\r\n\t\t}).then(() => {\r\n\t\t\tSettingsApp.show({ tab: \"system\" });\r\n\t\t});\r\n\r\n\t\treturn Helpers.setSetting(SETTINGS.SYSTEM_NOT_FOUND_WARNING_SHOWN, true);\r\n\r\n\t}\r\n\r\n\tif (Helpers.getSetting(SETTINGS.SYSTEM_FOUND) || SYSTEMS.DATA.INTEGRATION) {\r\n\t\tconst currentVersion = Helpers.getSetting(SETTINGS.SYSTEM_VERSION);\r\n\t\tconst newVersion = SYSTEMS.DATA.VERSION;\r\n\t\tHelpers.debug(`Comparing system version - Current: ${currentVersion} - New: ${newVersion}`)\r\n\t\tif (SYSTEMS.DATA.SOFT_MIGRATIONS[currentVersion + \"-\" + newVersion]) {\r\n\t\t\tHelpers.debug(`Applying soft migration for ${game.system.title}`);\r\n\t\t\tawait applySoftMigration(currentVersion + \"-\" + newVersion);\r\n\t\t} else if (foundry.utils.isNewerVersion(newVersion, currentVersion)) {\r\n\t\t\tHelpers.debug(`Applying system settings for ${game.system.title}`)\r\n\t\t\tawait applyDefaultSettings();\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\r\n\tawait Helpers.setSetting(SETTINGS.SYSTEM_FOUND, true);\r\n\r\n\tif (Helpers.getSetting(SETTINGS.SYSTEM_NOT_FOUND_WARNING_SHOWN)) {\r\n\t\tHelpers.custom_notify(game.i18n.localize(\"ITEM-PILES.Notifications.SystemSupportFound\"));\r\n\t}\r\n\r\n\treturn applyDefaultSettings();\r\n}\r\n","import { SYSTEMS } from \"../systems.js\";\r\nimport { refreshItemTypesThatCanStack } from \"../helpers/utilities.js\";\r\nimport { applySystemSpecificStyles } from \"../settings.js\";\r\n\r\nconst SETTINGS = {\r\n\r\n\t// Client settings\r\n\tOUTPUT_TO_CHAT: \"outputToChat\",\r\n\tINVERT_SHEET_OPEN: \"invertSheetOpen\",\r\n\tHIDE_ACTOR_HEADER_TEXT: \"hideActorHeaderText\",\r\n\tHIDE_ACTOR_HEADER_BUTTON: \"hideActorHeaderButton\",\r\n\tPRELOAD_FILES: \"preloadFiles\",\r\n\tDEBUG: \"debug\",\r\n\tDEBUG_HOOKS: \"debugHooks\",\r\n\r\n\t// Module Settings\r\n\tENABLE_DROPPING_ITEMS: \"enableDroppingItems\",\r\n\tENABLE_TRADING: \"enableTrading\",\r\n\tENABLE_GIVING_ITEMS: \"enableGivingItems\",\r\n\tSHOW_TRADE_BUTTON: \"showTradeButton\",\r\n\tDELETE_EMPTY_PILES: \"deleteEmptyPiles\",\r\n\tINSPECT_ITEMS_IN_TRADE: \"inspectItemsInTrade\",\r\n\tPOPULATION_TABLES_FOLDER: \"populationTablesFolder\",\r\n\tPRICE_PRESETS: \"pricePresets\",\r\n\tHIDE_TOKEN_BORDER: \"hideTokenBorder\",\r\n\r\n\t// Style settings\r\n\tCSS_VARIABLES: \"cssVariables\",\r\n\tVAULT_STYLES: \"vaultStyles\",\r\n\r\n\t// System Settings\r\n\tCURRENCIES: \"currencies\",\r\n\tSECONDARY_CURRENCIES: \"secondaryCurrencies\",\r\n\tCURRENCY_DECIMAL_DIGITS: \"currencyDecimalDigits\",\r\n\tITEM_FILTERS: \"itemFilters\",\r\n\tACTOR_CLASS_TYPE: \"actorClassType\",\r\n\tITEM_CLASS_LOOT_TYPE: \"itemClassLootType\",\r\n\tITEM_CLASS_WEAPON_TYPE: \"itemClassWeaponType\",\r\n\tITEM_CLASS_EQUIPMENT_TYPE: \"itemClassEquipmentType\",\r\n\tITEM_QUANTITY_ATTRIBUTE: \"itemQuantityAttribute\",\r\n\tITEM_PRICE_ATTRIBUTE: \"itemPriceAttribute\",\r\n\tQUANTITY_FOR_PRICE_ATTRIBUTE: \"quantityForPriceAttribute\",\r\n\tITEM_SIMILARITIES: \"itemSimilarities\",\r\n\tUNSTACKABLE_ITEM_TYPES: \"unstackableItemTypes\",\r\n\tPILE_DEFAULTS: \"pileDefaults\",\r\n\tTOKEN_FLAG_DEFAULTS: \"tokenFlagDefaults\",\r\n\r\n\t// Hidden settings\r\n\tDEFAULT_ITEM_PILE_ACTOR_ID: \"defaultItemPileActorID\",\r\n\tSYSTEM_FOUND: \"systemFound\",\r\n\tSYSTEM_NOT_FOUND_WARNING_SHOWN: \"systemNotFoundWarningShown\",\r\n\tSYSTEM_VERSION: \"systemVersion\",\r\n\tCUSTOM_ITEM_CATEGORIES: \"customItemCategories\",\r\n\r\n\tHIDE_TOKEN_BORDER_OPTIONS: {\r\n\t\tEVERYONE: \"everyone\",\r\n\t\tPLAYERS: \"players\",\r\n\t\tSHOW: \"show\"\r\n\t},\r\n\r\n\tDEFAULT_CSS_VARIABLES: {\r\n\t\t\"inactive\": \"rgba(31,143,255,1)\",\r\n\t\t\"minor-inactive\": \"rgba(201,200,185,1)\",\r\n\t\t\"shadow-primary\": \"rgba(255,0,0,1)\",\r\n\t\t\"even-color\": \"rgba(240,240,223,1)\",\r\n\t\t\"odd-color\": \"rgba(0,0,0,0)\",\r\n\t\t\"border-dark-primary\": \"rgba(25,24,19,1)\",\r\n\t\t\"border-light-primary\": \"rgba(181,179,164,1)\",\r\n\t\t\"text-light-highlight\": \"rgba(240,240,224,1)\",\r\n\t\t\"text-important\": \"rgba(255,100,0,1)\"\r\n\t},\r\n\r\n\tGET_DEFAULT() {\r\n\t\treturn foundry.utils.deepClone(SETTINGS.DEFAULTS())\r\n\t},\r\n\r\n\tGET_SYSTEM_DEFAULTS() {\r\n\t\treturn Object.fromEntries(Object.entries(SETTINGS.GET_DEFAULT()).filter(entry => {\r\n\t\t\treturn entry[1].system;\r\n\t\t}));\r\n\t},\r\n\r\n\tDEFAULTS: () => ({\r\n\r\n\t\t[SETTINGS.CURRENCIES]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.Currencies.Title\",\r\n\t\t\tlabel: \"ITEM-PILES.Settings.Currencies.Label\",\r\n\t\t\thint: \"ITEM-PILES.Settings.Currencies.Hint\",\r\n\t\t\ticon: \"fa fa-money-bill-alt\",\r\n\t\t\tapplication: \"currencies\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tsystem: true,\r\n\t\t\tdefault: SYSTEMS.DATA.CURRENCIES,\r\n\t\t\ttype: Array\r\n\t\t},\r\n\r\n\t\t[SETTINGS.SECONDARY_CURRENCIES]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.SecondaryCurrencies.Title\",\r\n\t\t\tlabel: \"ITEM-PILES.Settings.SecondaryCurrencies.Label\",\r\n\t\t\thint: \"ITEM-PILES.Settings.SecondaryCurrencies.Hint\",\r\n\t\t\ticon: \"fa fa-money-bill-alt\",\r\n\t\t\tapplication: \"secondary-currencies\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tsystem: true,\r\n\t\t\tdefault: SYSTEMS.DATA.SECONDARY_CURRENCIES,\r\n\t\t\ttype: Array\r\n\t\t},\r\n\r\n\t\t[SETTINGS.CURRENCY_DECIMAL_DIGITS]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.CurrencyDecimalDigits.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.CurrencyDecimalDigits.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tsystem: true,\r\n\t\t\tdefault: SYSTEMS.DATA.CURRENCY_DECIMAL_DIGITS,\r\n\t\t\tstep: 0.00001,\r\n\t\t\tmin: 0,\r\n\t\t\tmax: 1,\r\n\t\t\ttype: Number\r\n\t\t},\r\n\r\n\t\t[SETTINGS.ITEM_FILTERS]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.ItemFilters.Title\",\r\n\t\t\tlabel: \"ITEM-PILES.Settings.ItemFilters.Label\",\r\n\t\t\thint: \"ITEM-PILES.Settings.ItemFilters.Hint\",\r\n\t\t\ticon: \"fa fa-filter\",\r\n\t\t\tapplication: \"item-filters\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tsystem: true,\r\n\t\t\tdefault: SYSTEMS.DATA.ITEM_FILTERS,\r\n\t\t\ttype: Array\r\n\t\t},\r\n\r\n\t\t[SETTINGS.ITEM_SIMILARITIES]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.ItemSimilarities.Title\",\r\n\t\t\tlabel: \"ITEM-PILES.Settings.ItemSimilarities.Label\",\r\n\t\t\thint: \"ITEM-PILES.Settings.ItemSimilarities.Hint\",\r\n\t\t\ticon: \"fa fa-equals\",\r\n\t\t\tapplication: \"item-similarities\",\r\n\t\t\tapplicationOptions: {\r\n\t\t\t\ttitle: \"ITEM-PILES.Applications.SimilaritiesEditor.Title\",\r\n\t\t\t\tcontent: \"ITEM-PILES.Applications.SimilaritiesEditor.Explanation\",\r\n\t\t\t\tcolumn: \"ITEM-PILES.Applications.SimilaritiesEditor.Path\",\r\n\t\t\t},\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tsystem: true,\r\n\t\t\tdefault: SYSTEMS.DATA.ITEM_SIMILARITIES,\r\n\t\t\ttype: Array\r\n\t\t},\r\n\r\n\t\t[SETTINGS.UNSTACKABLE_ITEM_TYPES]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.UnstackableItemTypes.Title\",\r\n\t\t\tlabel: \"ITEM-PILES.Settings.UnstackableItemTypes.Label\",\r\n\t\t\thint: \"ITEM-PILES.Settings.UnstackableItemTypes.Hint\",\r\n\t\t\ticon: \"fa fa-equals\",\r\n\t\t\tapplication: \"unstackable-item-types\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tsystem: true,\r\n\t\t\tdefault: SYSTEMS.DATA.UNSTACKABLE_ITEM_TYPES,\r\n\t\t\tonChange: () => {\r\n\t\t\t\trefreshItemTypesThatCanStack();\r\n\t\t\t},\r\n\t\t\ttype: Array\r\n\t\t},\r\n\r\n\t\t[SETTINGS.CSS_VARIABLES]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.CssVariables.Title\",\r\n\t\t\tlabel: \"ITEM-PILES.Settings.CssVariables.Label\",\r\n\t\t\thint: \"ITEM-PILES.Settings.CssVariables.Hint\",\r\n\t\t\ticon: \"fa-solid fa-wand-magic-sparkles\",\r\n\t\t\tapplication: \"styles\",\r\n\t\t\tapplicationOptions: {\r\n\t\t\t\treadOnly: true,\r\n\t\t\t\tvariables: true\r\n\t\t\t},\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: SYSTEMS.DATA.CSS_VARIABLES,\r\n\t\t\tmergedDefaults: SETTINGS.DEFAULT_CSS_VARIABLES,\r\n\t\t\tonchange: (data) => {\r\n\t\t\t\tapplySystemSpecificStyles(data);\r\n\t\t\t},\r\n\t\t\ttype: Object\r\n\t\t},\r\n\r\n\t\t[SETTINGS.VAULT_STYLES]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.VaultStyles.Title\",\r\n\t\t\tlabel: \"ITEM-PILES.Settings.VaultStyles.Label\",\r\n\t\t\thint: \"ITEM-PILES.Settings.VaultStyles.Hint\",\r\n\t\t\ticon: \"fa-solid fa-wand-magic-sparkles\",\r\n\t\t\tapplication: \"vault-styles\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: SYSTEMS.DATA.VAULT_STYLES,\r\n\t\t\ttype: Array\r\n\t\t},\r\n\r\n\t\t[SETTINGS.ACTOR_CLASS_TYPE]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.ActorClass.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.ActorClass.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tsystem: true,\r\n\t\t\tdefault: SYSTEMS.DATA.ACTOR_CLASS_TYPE,\r\n\t\t\ttype: String\r\n\t\t},\r\n\r\n\t\t[SETTINGS.ITEM_CLASS_LOOT_TYPE]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.ItemLootClass.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.ItemLootClass.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tsystem: true,\r\n\t\t\tdefault: SYSTEMS.DATA.ITEM_CLASS_LOOT_TYPE,\r\n\t\t\ttype: String\r\n\t\t},\r\n\r\n\t\t[SETTINGS.ITEM_CLASS_WEAPON_TYPE]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.ItemWeaponClass.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.ItemWeaponClass.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tsystem: true,\r\n\t\t\tdefault: SYSTEMS.DATA.ITEM_CLASS_WEAPON_TYPE,\r\n\t\t\ttype: String\r\n\t\t},\r\n\r\n\t\t[SETTINGS.ITEM_CLASS_EQUIPMENT_TYPE]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.ItemEquipmentClass.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.ItemEquipmentClass.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tsystem: true,\r\n\t\t\tdefault: SYSTEMS.DATA.ITEM_CLASS_EQUIPMENT_TYPE,\r\n\t\t\ttype: String\r\n\t\t},\r\n\r\n\t\t[SETTINGS.ITEM_QUANTITY_ATTRIBUTE]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.Quantity.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.Quantity.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tsystem: true,\r\n\t\t\tdefault: SYSTEMS.DATA.ITEM_QUANTITY_ATTRIBUTE,\r\n\t\t\ttype: String\r\n\t\t},\r\n\r\n\t\t[SETTINGS.ITEM_PRICE_ATTRIBUTE]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.Price.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.Price.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tsystem: true,\r\n\t\t\tdefault: SYSTEMS.DATA.ITEM_PRICE_ATTRIBUTE,\r\n\t\t\ttype: String\r\n\t\t},\r\n\r\n\t\t[SETTINGS.QUANTITY_FOR_PRICE_ATTRIBUTE]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.QuantityForPrice.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.QuantityForPrice.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tsystem: true,\r\n\t\t\tdefault: SYSTEMS.DATA.QUANTITY_FOR_PRICE_ATTRIBUTE,\r\n\t\t\ttype: String\r\n\t\t},\r\n\r\n\t\t[SETTINGS.PILE_DEFAULTS]: {\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tsystem: true,\r\n\t\t\tdefault: SYSTEMS.DATA.PILE_DEFAULTS,\r\n\t\t\ttype: Object\r\n\t\t},\r\n\r\n\t\t[SETTINGS.TOKEN_FLAG_DEFAULTS]: {\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tsystem: true,\r\n\t\t\tdefault: SYSTEMS.DATA.TOKEN_FLAG_DEFAULTS,\r\n\t\t\ttype: Object\r\n\t\t},\r\n\r\n\t\t[SETTINGS.CUSTOM_ITEM_CATEGORIES]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.CustomItemCategories.Title\",\r\n\t\t\tlabel: \"ITEM-PILES.Settings.CustomItemCategories.Label\",\r\n\t\t\thint: \"ITEM-PILES.Settings.CustomItemCategories.Hint\",\r\n\t\t\tapplication: \"item-categories\",\r\n\t\t\tapplicationOptions: {\r\n\t\t\t\ttitle: \"ITEM-PILES.Applications.CustomItemCategoriesEditor.Title\",\r\n\t\t\t\tcontent: \"ITEM-PILES.Applications.CustomItemCategoriesEditor.Explanation\",\r\n\t\t\t\tcolumn: \"ITEM-PILES.Applications.CustomItemCategoriesEditor.Category\",\r\n\t\t\t},\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: [],\r\n\t\t\ttype: Array\r\n\t\t},\r\n\r\n\t\t[SETTINGS.SYSTEM_VERSION]: {\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: \"0.0.0\",\r\n\t\t\ttype: String\r\n\t\t},\r\n\r\n\t\t[SETTINGS.DEFAULT_ITEM_PILE_ACTOR_ID]: {\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: \"\",\r\n\t\t\ttype: String\r\n\t\t},\r\n\r\n\t\t[SETTINGS.SYSTEM_FOUND]: {\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: false,\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\r\n\t\t[SETTINGS.SYSTEM_NOT_FOUND_WARNING_SHOWN]: {\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: false,\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\r\n\t\t[SETTINGS.OUTPUT_TO_CHAT]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.OutputToChat.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.OutputToChat.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: 1,\r\n\t\t\tchoices: [\r\n\t\t\t\t\"ITEM-PILES.Settings.OutputToChat.Off\",\r\n\t\t\t\t\"ITEM-PILES.Settings.OutputToChat.Public\",\r\n\t\t\t\t\"ITEM-PILES.Settings.OutputToChat.SelfGM\",\r\n\t\t\t\t\"ITEM-PILES.Settings.OutputToChat.Blind\",\r\n\t\t\t],\r\n\t\t\ttype: Number\r\n\t\t},\r\n\r\n\t\t[SETTINGS.INSPECT_ITEMS_IN_TRADE]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.InspectItemsTrade.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.InspectItemsTrade.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: true,\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\r\n\t\t[SETTINGS.POPULATION_TABLES_FOLDER]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.PopulationTablesFolder.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.PopulationTablesFolder.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: \"root\",\r\n\t\t\ttype: String\r\n\t\t},\r\n\r\n\t\t[SETTINGS.DELETE_EMPTY_PILES]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.DeleteEmptyPiles.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.DeleteEmptyPiles.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: false,\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\r\n\t\t[SETTINGS.ENABLE_DROPPING_ITEMS]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.EnableDroppingItems.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.EnableDroppingItems.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: true,\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\r\n\t\t[SETTINGS.ENABLE_TRADING]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.EnableTrading.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.EnableTrading.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: true,\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\r\n\t\t[SETTINGS.ENABLE_GIVING_ITEMS]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.EnableGivingItems.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.EnableGivingItems.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: true,\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\r\n\t\t[SETTINGS.SHOW_TRADE_BUTTON]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.ShowTradeButton.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.ShowTradeButton.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: true,\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\r\n\t\t[SETTINGS.PRICE_PRESETS]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.PricePresets.Title\",\r\n\t\t\tlabel: \"ITEM-PILES.Settings.PricePresets.Label\",\r\n\t\t\thint: \"ITEM-PILES.Settings.PricePresets.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\ticon: \"fa fa-tags\",\r\n\t\t\tapplication: \"price-presets\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: [],\r\n\t\t\ttype: Array\r\n\t\t},\r\n\r\n\t\t[SETTINGS.HIDE_TOKEN_BORDER]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.HideTokenBorder.Title\",\r\n\t\t\tlabel: \"ITEM-PILES.Settings.HideTokenBorder.Label\",\r\n\t\t\thint: \"ITEM-PILES.Settings.HideTokenBorder.Hint\",\r\n\t\t\tscope: \"world\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: SETTINGS.HIDE_TOKEN_BORDER_OPTIONS.EVERYONE,\r\n\t\t\tchoices: {\r\n\t\t\t\t[SETTINGS.HIDE_TOKEN_BORDER_OPTIONS.EVERYONE]: \"ITEM-PILES.Settings.HideTokenBorder.HideEveryone\",\r\n\t\t\t\t[SETTINGS.HIDE_TOKEN_BORDER_OPTIONS.PLAYERS]: \"ITEM-PILES.Settings.HideTokenBorder.HidePlayers\",\r\n\t\t\t\t[SETTINGS.HIDE_TOKEN_BORDER_OPTIONS.SHOW]: \"ITEM-PILES.Settings.HideTokenBorder.Show\"\r\n\t\t\t},\r\n\t\t\ttype: String\r\n\t\t},\r\n\r\n\t\t[SETTINGS.INVERT_SHEET_OPEN]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.InvertSheetOpen.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.InvertSheetOpen.Hint\",\r\n\t\t\tscope: \"client\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: false,\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\r\n\t\t[SETTINGS.HIDE_ACTOR_HEADER_TEXT]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.HideHeaderButtonText.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.HideHeaderButtonText.Hint\",\r\n\t\t\tscope: \"client\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: false,\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\r\n\t\t[SETTINGS.HIDE_ACTOR_HEADER_BUTTON]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.HideHeaderButton.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.HideHeaderButton.Hint\",\r\n\t\t\tscope: \"client\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: false,\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\r\n\t\t[SETTINGS.PRELOAD_FILES]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.PreloadFiles.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.PreloadFiles.Hint\",\r\n\t\t\tscope: \"client\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: true,\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\r\n\t\t[SETTINGS.DEBUG]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.Debug.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.Debug.Hint\",\r\n\t\t\tscope: \"client\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: false,\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\r\n\r\n\t\t[SETTINGS.DEBUG_HOOKS]: {\r\n\t\t\tname: \"ITEM-PILES.Settings.DebugHooks.Title\",\r\n\t\t\thint: \"ITEM-PILES.Settings.DebugHooks.Hint\",\r\n\t\t\tscope: \"client\",\r\n\t\t\tconfig: false,\r\n\t\t\tdefault: false,\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\r\n\t})\r\n}\r\n\r\nexport default SETTINGS;\r\n","import * as Helpers from \"./helpers.js\";\r\nimport CONSTANTS from \"../constants/constants.js\";\r\nimport SETTINGS from \"../constants/settings.js\";\r\nimport { deletedActorCache } from \"./caches.js\";\r\nimport { SYSTEMS } from \"../systems.js\";\r\n\r\nexport function getActor(target) {\r\n\tif (target instanceof Actor) return target;\r\n\tlet targetDoc = target;\r\n\tif (stringIsUuid(target)) {\r\n\t\ttargetDoc = fromUuidSync(target);\r\n\t\tif (!targetDoc && deletedActorCache.has(target)) {\r\n\t\t\treturn deletedActorCache.get(target);\r\n\t\t}\r\n\t}\r\n\ttargetDoc = getDocument(targetDoc);\r\n\tif (targetDoc instanceof Item && targetDoc.parent instanceof Actor) return targetDoc.parent;\r\n\treturn targetDoc?.character ?? targetDoc?.actor ?? targetDoc;\r\n}\r\n\r\n/**\r\n * @param documentUuid\r\n * @returns {PlaceableObject|foundry.abstract.Document}\r\n */\r\nexport function getToken(documentUuid) {\r\n\tlet doc = fromUuidSync(documentUuid);\r\n\tdoc = doc?.token ?? doc;\r\n\treturn doc instanceof TokenDocument ? doc?.object ?? doc : doc;\r\n}\r\n\r\nexport function getDocument(target) {\r\n\tif (stringIsUuid(target)) {\r\n\t\ttarget = fromUuidSync(target);\r\n\t}\r\n\treturn target?.document ?? target;\r\n}\r\n\r\nexport function stringIsUuid(inId) {\r\n\treturn typeof inId === \"string\" && (inId.match(/\\./g) || []).length && !inId.endsWith(\".\");\r\n}\r\n\r\nexport function getUuid(target) {\r\n\tif (stringIsUuid(target)) return target;\r\n\tconst document = getDocument(target);\r\n\treturn document?.uuid ?? false;\r\n}\r\n\r\n/**\r\n * Find and retrieves an item in a list of items\r\n *\r\n * @param {Array<Item|Object>} items\r\n * @param {Item|Object} findItem\r\n * @param {boolean/object} actorFlagData\r\n * @param {boolean} returnOne\r\n * @returns {*}\r\n */\r\nexport function findSimilarItem(items, findItem, {\r\n\treturnOne = true\r\n} = {}) {\r\n\r\n\tconst itemSimilarities = game.itempiles.API.ITEM_SIMILARITIES;\r\n\r\n\tlet findItemData = findItem instanceof Item ? findItem.toObject() : findItem;\r\n\tfindItemData = findItemData?.item ?? findItemData;\r\n\tconst findItemId = findItemData?._id;\r\n\r\n\tlet hasUniqueKey = false;\r\n\tfor (let prop of CONSTANTS.ITEM_FORCED_UNIQUE_KEYS) {\r\n\t\tif (foundry.utils.getProperty(findItemData, prop)) {\r\n\t\t\thasUniqueKey = true;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tconst filteredItems = items\r\n\t\t.filter(item => {\r\n\t\t\tfor (let prop of CONSTANTS.ITEM_FORCED_UNIQUE_KEYS) {\r\n\t\t\t\tif (foundry.utils.getProperty(item?.item ?? item, prop)) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t})\r\n\t\t.filter(item => {\r\n\t\t\tconst itemId = item instanceof Item ? item.id : item?.item?._id ?? item?._id ?? item?.id;\r\n\t\t\tif (itemId && findItemId && itemId === findItemId) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tif (!itemSimilarities.some(path => foundry.utils.hasProperty(findItem, path))) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tif (hasUniqueKey) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tlet itemData = item instanceof Item ? item.toObject() : item;\r\n\t\t\titemData = itemData?.item ?? itemData;\r\n\t\t\tif (areItemsDifferent(itemData, findItemData)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\treturn itemSimilarities.length > 0;\r\n\t\t})\r\n\r\n\treturn returnOne ? filteredItems?.[0] ?? false : filteredItems;\r\n\r\n}\r\n\r\nexport function areItemsDifferent(itemA, itemB) {\r\n\tconst itemSimilarities = game.itempiles.API.ITEM_SIMILARITIES;\r\n\tfor (const path of itemSimilarities) {\r\n\t\tif (foundry.utils.getProperty(itemA, path) !== foundry.utils.getProperty(itemB, path)\r\n\t\t\t|| (!foundry.utils.hasProperty(itemA, path) ^ !foundry.utils.hasProperty(itemB, path))) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nexport function setSimilarityProperties(obj, item) {\r\n\tconst itemData = item instanceof Item ? item.toObject() : item;\r\n\tfoundry.utils.setProperty(obj, \"_id\", itemData._id);\r\n\tgame.itempiles.API.ITEM_SIMILARITIES.forEach(prop => {\r\n\t\tfoundry.utils.setProperty(obj, prop, foundry.utils.getProperty(itemData, prop));\r\n\t})\r\n\treturn obj;\r\n}\r\n\r\nlet itemTypesWithQuantities;\r\n\r\nexport function refreshItemTypesThatCanStack() {\r\n\titemTypesWithQuantities = undefined;\r\n\tgetItemTypesThatCanStack();\r\n}\r\n\r\n\r\nexport function getDocumentTemplates(templateType) {\r\n\treturn foundry.utils.mergeObject(\r\n\t\tgame.model[templateType],\r\n\t\tObject.fromEntries(Object.entries(CONFIG[templateType]?.dataModels ?? {}).map(([k, v]) => [k, v.schema.getInitialValue()])),\r\n\t\t{ inplace: false },\r\n\t);\r\n}\r\n\r\n\r\n/**\r\n * Retrieve all system item types that can be stacked\r\n * @returns {Set<string>}                       The items type that can be stacked on this system\r\n */\r\nexport function getItemTypesThatCanStack() {\r\n\r\n\tif (!itemTypesWithQuantities) {\r\n\r\n\t\titemTypesWithQuantities = new Set();\r\n\r\n\t\tif (game.system.id === \"custom-system-builder\") {\r\n\t\t\tconst quantityAttribute = game.itempiles.API.ITEM_QUANTITY_ATTRIBUTE.split(\".\").pop();\r\n\t\t\tconst itemTemplates = game.items\r\n\t\t\t\t.filter(_i => _i?.templateSystem?.isTemplate && _i?.templateSystem?.getKeys)\r\n\t\t\t\t.filter(_i => _i.templateSystem.getKeys().has(quantityAttribute));\r\n\t\t\tfor (const item of itemTemplates) {\r\n\t\t\t\titemTypesWithQuantities.add(item.name);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst unstackableItemTypes = Helpers.getSetting(SETTINGS.UNSTACKABLE_ITEM_TYPES);\r\n\t\tconst templates = getDocumentTemplates(\"Item\");\r\n\t\tconst types = new Set(Object.keys(templates));\r\n\t\titemTypesWithQuantities = new Set([...itemTypesWithQuantities, ...types.filter(type => {\r\n\t\t\tlet itemTemplate = {\r\n\t\t\t\tsystem: foundry.utils.deepClone(templates[type])\r\n\t\t\t};\r\n\t\t\tif (itemTemplate.system?.templates?.length) {\r\n\t\t\t\tconst templates = foundry.utils.duplicate(itemTemplate.system.templates);\r\n\t\t\t\tfor (let template of templates) {\r\n\t\t\t\t\titemTemplate.system = foundry.utils.mergeObject(itemTemplate.system, foundry.utils.duplicate(game.system.documentTypes.Item.templates[template]));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn hasItemQuantity(itemTemplate);\r\n\t\t})].filter(type => !unstackableItemTypes.includes(type)));\r\n\t}\r\n\r\n\treturn itemTypesWithQuantities;\r\n}\r\n\r\nexport function isItemStackable(itemData) {\r\n\tgetItemTypesThatCanStack();\r\n\tif (game.system.id === \"custom-system-builder\" && itemData?.system?.template) {\r\n\t\tconst templateItem = game.items.get(itemData?.system?.template);\r\n\t\tif (templateItem) {\r\n\t\t\treturn itemTypesWithQuantities.has(templateItem.name)\r\n\t\t}\r\n\t}\r\n\treturn itemTypesWithQuantities.has(itemData.type);\r\n}\r\n\r\n/**\r\n * Returns a given item's quantity\r\n *\r\n * @param {Item/Object} item\r\n * @returns {number}\r\n */\r\nexport function getItemQuantity(item) {\r\n\tconst itemData = item instanceof Item ? item.toObject() : item;\r\n\treturn Number(foundry.utils.getProperty(itemData, game.itempiles.API.ITEM_QUANTITY_ATTRIBUTE) ?? 0);\r\n}\r\n\r\n\r\n/**\r\n * Returns whether an item has the quantity property\r\n *\r\n * @param {Item/Object} item\r\n * @returns {Boolean}\r\n */\r\nexport function hasItemQuantity(item) {\r\n\tconst itemData = item instanceof Item ? item.toObject() : item;\r\n\treturn foundry.utils.hasProperty(itemData, game.itempiles.API.ITEM_QUANTITY_ATTRIBUTE);\r\n}\r\n\r\n/**\r\n * Returns a given item's quantity\r\n *\r\n * @param {Object} itemData\r\n * @param {Number} quantity\r\n * @param {Boolean} requiresExistingQuantity\r\n * @returns {Object}\r\n */\r\nexport function setItemQuantity(item, quantity, requiresExistingQuantity = false) {\r\n\tconst itemData = item instanceof Item ? item.toObject() : item;\r\n\tif (!requiresExistingQuantity || getItemTypesThatCanStack().has(itemData.type) || hasItemQuantity(itemData)) {\r\n\t\tfoundry.utils.setProperty(itemData, game.itempiles.API.ITEM_QUANTITY_ATTRIBUTE, quantity);\r\n\t}\r\n\treturn itemData;\r\n}\r\n\r\n/**\r\n * Returns a given item's cost/price\r\n *\r\n * @param {Item/Object} item\r\n * @returns {number}\r\n */\r\nexport function getItemCost(item) {\r\n\tconst itemData = item instanceof Item ? item.toObject() : item;\r\n\treturn foundry.utils.getProperty(itemData, game.itempiles.API.ITEM_PRICE_ATTRIBUTE) ?? 0;\r\n}\r\n\r\n/**\r\n * Returns whether an item has the cost/price property\r\n *\r\n * @param {Item/Object} item\r\n * @returns {Boolean}\r\n */\r\nexport function hasItemCost(item) {\r\n\tconst itemData = item instanceof Item ? item.toObject() : item;\r\n\treturn foundry.utils.hasProperty(itemData, game.itempiles.API.ITEM_PRICE_ATTRIBUTE);\r\n}\r\n\r\n/**\r\n * Returns a given item's cost/price\r\n *\r\n * @param {Object} itemData\r\n * @param {Number} cost\r\n * @param {Boolean} requiresExistingCost\r\n * @returns {Object}\r\n */\r\nexport function setItemCost(item, cost, requiresExistingCost = false) {\r\n\tconst itemData = item instanceof Item ? item.toObject() : item;\r\n\tif (!requiresExistingCost || hasItemCost(itemData)) {\r\n\t\tfoundry.utils.setProperty(itemData, game.itempiles.API.ITEM_PRICE_ATTRIBUTE, cost);\r\n\t}\r\n\treturn itemData\r\n}\r\n\r\n/**\r\n * Retrieves all visible tokens on a given location\r\n *\r\n * @param position\r\n * @returns {Array<Token>}\r\n */\r\nexport function getTokensAtLocation(position) {\r\n\tconst tokens = [...canvas.tokens.placeables].filter(token => token?.mesh?.visible);\r\n\treturn tokens.filter(token => {\r\n\t\treturn position.x >= token.x && position.x < (token.x + (token.document.width * canvas.grid.size)) && position.y >= token.y && position.y < (token.y + (token.document.height * canvas.grid.size));\r\n\t});\r\n}\r\n\r\nexport function distance_between_rect(p1, p2) {\r\n\r\n\tconst x1 = p1.x;\r\n\tconst y1 = p1.y;\r\n\tconst x1b = p1.x + p1.w;\r\n\tconst y1b = p1.y + p1.h;\r\n\r\n\tconst x2 = p2.x;\r\n\tconst y2 = p2.y;\r\n\tconst x2b = p2.x + p2.w;\r\n\tconst y2b = p2.y + p2.h;\r\n\r\n\tconst left = x2b < x1;\r\n\tconst right = x1b < x2;\r\n\tconst bottom = y2b < y1;\r\n\tconst top = y1b < y2;\r\n\r\n\tif (top && left) {\r\n\t\treturn distance_between({ x: x1, y: y1b }, { x: x2b, y: y2 });\r\n\t} else if (left && bottom) {\r\n\t\treturn distance_between({ x: x1, y: y1 }, { x: x2b, y: y2b });\r\n\t} else if (bottom && right) {\r\n\t\treturn distance_between({ x: x1b, y: y1 }, { x: x2, y: y2b });\r\n\t} else if (right && top) {\r\n\t\treturn distance_between({ x: x1b, y: y1b }, { x: x2, y: y2 });\r\n\t} else if (left) {\r\n\t\treturn x1 - x2b;\r\n\t} else if (right) {\r\n\t\treturn x2 - x1b;\r\n\t} else if (bottom) {\r\n\t\treturn y1 - y2b;\r\n\t} else if (top) {\r\n\t\treturn y2 - y1b;\r\n\t}\r\n\r\n\treturn 0;\r\n\r\n}\r\n\r\nexport function distance_between(a, b) {\r\n\treturn new Ray(a, b).distance;\r\n}\r\n\r\nexport function grids_between_tokens(a, b) {\r\n\treturn Math.floor(distance_between_rect(a, b) / canvas.grid.size) + 1\r\n}\r\n\r\nexport function tokens_close_enough(a, b, maxDistance) {\r\n\tconst distance = grids_between_tokens(a, b);\r\n\treturn maxDistance >= distance;\r\n}\r\n\r\nexport function refreshAppsWithDocument(doc, callback) {\r\n\tconst apps = Object.values(ui.windows).filter(app => app.id.endsWith(doc.id));\r\n\tfor (const app of apps) {\r\n\t\tif (app[callback]) {\r\n\t\t\tapp[callback]();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport async function runMacro(macroId, macroData) {\r\n\r\n\t// Credit to Otigon, Zhell, Gazkhan and MrVauxs for the code in this section\r\n\tlet macro;\r\n\tif (macroId.startsWith(\"Compendium\")) {\r\n\t\tlet packArray = macroId.split(\".\");\r\n\t\tlet compendium = game.packs.get(`${packArray[1]}.${packArray[2]}`);\r\n\t\tif (!compendium) {\r\n\t\t\tthrow Helpers.custom_error(`Compendium ${packArray[1]}.${packArray[2]} was not found`);\r\n\t\t}\r\n\t\tlet findMacro = (await compendium.getDocuments()).find(m => {\r\n\t\t\treturn m.name === packArray[3] || m.id === packArray[3] || m.id === packArray[4];\r\n\t\t})\r\n\t\tif (!findMacro) {\r\n\t\t\tthrow Helpers.custom_error(`The \"${packArray[3]}\" macro was not found in Compendium ${packArray[1]}.${packArray[2]}`);\r\n\t\t}\r\n\t\tmacro = new Macro(findMacro?.toObject());\r\n\t\tmacro.ownership.default = CONST.DOCUMENT_OWNERSHIP_LEVELS.OWNER;\r\n\t} else {\r\n\t\tmacro = game.macros.getName(macroId);\r\n\t\tif (!macro) {\r\n\t\t\tthrow Helpers.custom_error(`Could not find macro with name \"${macroId}\"`);\r\n\t\t}\r\n\t}\r\n\r\n\tlet result = false;\r\n\ttry {\r\n\t\tresult = await macro.execute(macroData);\r\n\t} catch (err) {\r\n\t\tHelpers.custom_warning(`Error when executing macro ${macroId}!\\n${err}`, true);\r\n\t}\r\n\r\n\treturn result;\r\n\r\n}\r\n\r\nexport function getOwnedCharacters(user = game.user) {\r\n\treturn game.actors.filter(actor => {\r\n\t\t\treturn actor.ownership?.[user.id] === CONST.DOCUMENT_OWNERSHIP_LEVELS.OWNER && actor.prototypeToken.actorLink;\r\n\t\t})\r\n\t\t.sort((a, b) => {\r\n\t\t\treturn b._stats.modifiedTime - a._stats.modifiedTime;\r\n\t\t});\r\n}\r\n\r\nexport function getUserCharacter(user = game.user) {\r\n\treturn user.character || (user.isGM ? false : (getOwnedCharacters(user)?.[0] ?? false));\r\n}\r\n\r\nexport async function createFoldersFromNames(folders, type = \"Actor\") {\r\n\tlet lastFolder = false;\r\n\tfor (const folder of folders) {\r\n\t\tlet actualFolder = game.folders.getName(folder);\r\n\t\tif (!actualFolder) {\r\n\t\t\tconst folderData = { name: folder, type, sorting: 'a' };\r\n\t\t\tif (lastFolder) {\r\n\t\t\t\tfolderData.folder = lastFolder.id;\r\n\t\t\t\tfolderData.parent = lastFolder.id;\r\n\t\t\t}\r\n\t\t\tactualFolder = await Folder.create(folderData);\r\n\t\t}\r\n\t\tlastFolder = actualFolder;\r\n\t}\r\n\r\n\tif (lastFolder) {\r\n\t\treturn lastFolder;\r\n\t}\r\n}\r\n\r\n\r\nexport function getSourceActorFromDropData(dropData) {\r\n\tif (dropData.uuid) {\r\n\t\tconst doc = fromUuidSync(dropData.uuid);\r\n\t\tif (doc instanceof Actor) {\r\n\t\t\treturn doc;\r\n\t\t} else if (doc instanceof TokenDocument) {\r\n\t\t\treturn doc.actor;\r\n\t\t} else if (doc instanceof Item) {\r\n\t\t\treturn doc.parent\r\n\t\t}\r\n\t\treturn false;\r\n\t} else if (dropData.tokenId) {\r\n\t\tif (dropData.sceneId) {\r\n\t\t\tconst uuid = `Scene.${dropData.sceneId}.Token.${dropData.tokenId}`;\r\n\t\t\treturn fromUuidSync(uuid)?.actor;\r\n\t\t}\r\n\t\treturn canvas.tokens.get(dropData.tokenId).actor;\r\n\t} else if (dropData.actorId) {\r\n\t\treturn game.actors.get(dropData.actorId);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nexport function deleteProperty(object, key) {\r\n\tif (!key || !object) return false;\r\n\tif (key in object) return true;\r\n\tlet target = object;\r\n\tconst keys = key.split('.');\r\n\tfor (let index = 0; index < keys.length; index++) {\r\n\t\tconst p = keys[index];\r\n\t\tif (!target || (typeof target !== \"object\")) return false;\r\n\t\tif (index === keys.length - 1 && p in target) {\r\n\t\t\tdelete target[p];\r\n\t\t} else if (p in target) {\r\n\t\t\ttarget = target[p];\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n\r\nexport function hasItemTypeHandler(handler, itemType = \"GLOBAL\") {\r\n\treturn !!SYSTEMS.DATA.ITEM_TYPE_HANDLERS?.[itemType]?.[handler];\r\n}\r\n\r\n\r\nexport function getItemTypeHandler(handler, itemType = \"GLOBAL\") {\r\n\treturn SYSTEMS.DATA.ITEM_TYPE_HANDLERS?.[itemType]?.[handler];\r\n}\r\n\r\n\r\nexport function createUniqueId(actor) {\r\n\tlet newId = foundry.utils.randomID();\r\n\tlet i = 0;\r\n\twhile (i < 10) {\r\n\t\tif (!actor.items.get(newId)) return newId;\r\n\t\tnewId = foundry.utils.randomID();\r\n\t\ti++;\r\n\t}\r\n\tthrow Helpers.custom_error(`Could not generate unique item ID for actor ${actor.uuid}!`)\r\n}\r\n\r\nexport function ensureValidIds(actor, itemsToCreate) {\r\n\r\n\tconst containerIdMap = {};\r\n\r\n\treturn itemsToCreate.map(data => {\r\n\t\tconst item = data?.item ?? data;\r\n\t\tif (!item.system || !item.type) return data;\r\n\t\tconst handler = getItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.IS_CONTAINED);\r\n\t\tif (handler && handler({ item })) {\r\n\t\t\tconst path = getItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.IS_CONTAINED_PATH);\r\n\t\t\tconst containerId = foundry.utils.getProperty(item, path);\r\n\t\t\tcontainerIdMap[containerId] ??= createUniqueId(actor);\r\n\t\t\tfoundry.utils.setProperty(item, path, containerIdMap[containerId]);\r\n\t\t\titem._id = createUniqueId(actor);\r\n\t\t} else if (hasItemTypeHandler(CONSTANTS.ITEM_TYPE_METHODS.CONTENTS, item.type)) {\r\n\t\t\tcontainerIdMap[item._id] ??= createUniqueId(actor);\r\n\t\t\titem._id = containerIdMap[item._id];\r\n\t\t} else {\r\n\t\t\titem._id = createUniqueId(actor);\r\n\t\t}\r\n\t\treturn data;\r\n\t});\r\n\r\n}\r\n\r\nexport function isRealNumber(inNumber) {\r\n\treturn !isNaN(inNumber) && typeof inNumber === \"number\" && isFinite(inNumber);\r\n}\r\n","<script>\r\n\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { getSourceActorFromDropData } from \"../../helpers/utilities.js\";\r\n\r\n\texport let actor;\r\n\texport let actors;\r\n\r\n\tlet changingActor = false;\r\n\tlet multipleActors = actors.length > 1 && !game.user.isGM;\r\n\tlet hasUnlinkedTokenOwnership = actors.filter(a => !a.prototypeToken.actorLink).length > 0;\r\n\r\n\tfunction setActorFromSelectedToken() {\r\n\t\tif (canvas.tokens.controlled.length === 0) return;\r\n\t\tactor = canvas.tokens.controlled[0].actor;\r\n\t}\r\n\r\n\tasync function dropData(event) {\r\n\t\tcounter = 0;\r\n\t\tlet data;\r\n\t\ttry {\r\n\t\t\tdata = JSON.parse(event.dataTransfer.getData('text/plain'));\r\n\t\t} catch (err) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (data.type !== \"Actor\") return;\r\n\t\tactor = getSourceActorFromDropData(data);\r\n\t}\r\n\r\n\tlet counter = 0;\r\n\r\n\tfunction dragEnter() {\r\n\t\tcounter++;\r\n\t}\r\n\r\n\tfunction dragLeave() {\r\n\t\tcounter--;\r\n\t}\r\n\r\n\tfunction preventDefault(event) {\r\n\t\tevent.preventDefault();\r\n\t}\r\n\r\n</script>\r\n\r\n\r\n<div class=\"item-piles-bottom-divider\">\r\n\t<div class=\"form-group item-piles-actor-container align-center-row\"\r\n\t     class:item-piles-box-highlight={counter > 0}\r\n\t     on:dragenter={dragEnter}\r\n\t     on:dragleave={dragLeave}\r\n\t     on:dragover={preventDefault}\r\n\t     on:dragstart={preventDefault}\r\n\t     on:drop={dropData}\r\n\t>\r\n\t\t{#if actor}\r\n\t\t\t<div class=\"align-center-col\">\r\n\t\t\t\t{#if actor.img}\r\n\t\t\t\t\t<img src=\"{actor.img}\">\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if multipleActors}\r\n          <span>\r\n            {#if changingActor}\r\n              <select class=\"item-piles-change-actor-select\"\r\n                      bind:value={actor}\r\n                      on:change={() => { changingActor = false }}\r\n              >\r\n                {#each actors as potentialActor (potentialActor.id)}\r\n                <option value=\"{potentialActor}\">{ potentialActor.name }</option>\r\n                {/each}\r\n              </select>\r\n            {:else}\r\n              <a class='item-piles-change-actor item-piles-highlight'\r\n                 on:click={() => { changingActor = true }}>{ actor.name }</a>\r\n            {/if}\r\n          </span>\r\n\t\t\t\t{:else}\r\n\t\t\t\t\t<span>{ actor.name }</span>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t</div>\r\n\t\t{:else}\r\n\t\t\t<p>{ localize(\"ITEM-PILES.Trade.Prompt.DropActor\") }</p>\r\n\t\t{/if}\r\n\t</div>\r\n\t{#if hasUnlinkedTokenOwnership}\r\n\t\t<div class=\"item-piles-flexrow\">\r\n\t\t\t<button type=\"button\" on:click={setActorFromSelectedToken}>\r\n\t\t\t\t<i class=\"fas fa-expand\"></i>\r\n\t\t\t\t{localize(\"ITEM-PILES.Trade.Prompt.PickToken\")}\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t{/if}\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .item-piles-actor-container {\r\n    margin-bottom: 1rem;\r\n    min-height: 150px;\r\n    padding: 0.5rem;\r\n    text-align: center;\r\n    border: 1px solid gray;\r\n    border-radius: 5px;\r\n\r\n    img {\r\n      border: 0;\r\n      max-height: 80px;\r\n      max-width: 80px;\r\n      width: auto;\r\n      height: auto;\r\n      border-radius: 5px;\r\n      filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.5));\r\n      margin-bottom: 10px;\r\n    }\r\n\r\n    span {\r\n      font-size: 1.5rem;\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n  .item-piles-box-highlight {\r\n    box-shadow: 0 0 20px inset var(--color-shadow-highlight, #ff6400);\r\n  }\r\n\r\n  .item-piles-change-actor-select {\r\n    height: 23px;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { getContext } from \"svelte\";\r\n\timport ActorDropSelect from \"./ActorDropSelect.svelte\";\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let elementRoot;\r\n\texport let isPrivate;\r\n\texport let users;\r\n\texport let user;\r\n\texport let actors;\r\n\texport let actor;\r\n\r\n\tlet isGM = game.user.isGM;\r\n\r\n\tusers = game.users.filter(user => user.active && user !== game.user);\r\n\tuser = user || users?.[0] || false;\r\n\tactors = actors || game.actors.filter(actor => actor.isOwner);\r\n\tactor = actor || game.user.character || (!isGM ? actors?.[0] : false);\r\n\r\n\tfunction requestTrade() {\r\n\t\tapplication.options.resolve({\r\n\t\t\tuser,\r\n\t\t\tactor,\r\n\t\t\tisPrivate\r\n\t\t});\r\n\t\tapplication.close();\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<div class=\"item-piles-flexcol trade-dialog\">\r\n\r\n\t\t<p><i class=\"item-piles-header-icon fas fa-handshake\"></i></p>\r\n\r\n\t\t<p style=\"margin-bottom: 1rem\">\r\n\t\t\t<strong style=\"font-size:1.2rem;\">\r\n\t\t\t\t{localize(\"ITEM-PILES.Trade.Prompt.Title\")}\r\n\t\t\t</strong>\r\n\t\t</p>\r\n\r\n\t\t<p>{localize(\"ITEM-PILES.Trade.Prompt.User\")}</p>\r\n\r\n\t\t<div class=\"item-piles-bottom-divider\">\r\n\t\t\t<div class=\"form-group align-center-row\">\r\n\t\t\t\t<select bind:value={user} name=\"user\" style=\"width: 66%;\">\r\n\t\t\t\t\t{#each users as potentialUser (potentialUser.id)}\r\n\t\t\t\t\t\t<option value=\"{potentialUser}\">{potentialUser.name}</option>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=\"item-piles-bottom-divider\">\r\n\t\t\t<div class=\"form-group align-center-col\">\r\n\t\t\t\t<label class=\"align-center-row\">\r\n\t\t\t\t\t<input bind:checked={isPrivate} name=\"private\" type=\"checkbox\">\r\n\t\t\t\t\t<span>{localize(\"ITEM-PILES.Trade.Private\")}</span>\r\n\t\t\t\t</label>\r\n\t\t\t\t<small>{localize(\"ITEM-PILES.Trade.PrivateExplanation\")}</small>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t{#if actor}\r\n\t\t\t<p>{localize(\"ITEM-PILES.Trade.Prompt.PickedActor\")}</p>\r\n\t\t{:else}\r\n\t\t\t<p>{localize(\"ITEM-PILES.Trade.Prompt.PickActor\")}</p>\r\n\t\t{/if}\r\n\r\n\t\t<ActorDropSelect {actors} bind:actor={actor}/>\r\n\r\n\t\t<footer class=\"sheet-footer item-piles-flexrow\">\r\n\t\t\t<button disabled={!actor} on:click|once={requestTrade} type=\"button\">\r\n\t\t\t\t<i class=\"fas fa-check\"></i> {localize(\"ITEM-PILES.Trade.Prompt.Label\")}\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t</div>\r\n\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .trade-dialog {\r\n    text-align: center;\r\n  }\r\n\r\n  .item-piles-header-icon {\r\n    font-size: 3rem;\r\n  }\r\n\r\n  .item-piles-actor-container {\r\n    margin-bottom: 0.25rem;\r\n    min-height: 150px;\r\n    padding: 0.5rem;\r\n    text-align: center;\r\n    border: 1px solid gray;\r\n    border-radius: 5px;\r\n\r\n    img {\r\n      border: 0;\r\n      max-height: 80px;\r\n      max-width: 80px;\r\n      width: auto;\r\n      height: auto;\r\n      border-radius: 5px;\r\n      filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.5));\r\n      margin-bottom: 10px;\r\n    }\r\n\r\n    span {\r\n      font-size: 1.5rem;\r\n      text-align: center;\r\n    }\r\n  }\r\n\r\n  .item-piles-box-highlight {\r\n    box-shadow: 0 0 20px inset var(--color-shadow-highlight, #ff6400);\r\n  }\r\n\r\n  .item-piles-change-actor-select {\r\n    height: 23px;\r\n  }\r\n\r\n  button:disabled {\r\n    opacity: 0.75;\r\n  }\r\n\r\n</style>\r\n","/**\n * @param {any} obj\n * @returns {boolean}\n */\nexport function is_date(obj) {\n\treturn Object.prototype.toString.call(obj) === '[object Date]';\n}\n","import { writable } from '../store/index.js';\nimport { assign, loop, now } from '../internal/index.js';\nimport { linear } from '../easing/index.js';\nimport { is_date } from './utils.js';\n\n/** @returns {(t: any) => any} */\nfunction get_interpolator(a, b) {\n\tif (a === b || a !== a) return () => a;\n\tconst type = typeof a;\n\tif (type !== typeof b || Array.isArray(a) !== Array.isArray(b)) {\n\t\tthrow new Error('Cannot interpolate values of different type');\n\t}\n\tif (Array.isArray(a)) {\n\t\tconst arr = b.map((bi, i) => {\n\t\t\treturn get_interpolator(a[i], bi);\n\t\t});\n\t\treturn (t) => arr.map((fn) => fn(t));\n\t}\n\tif (type === 'object') {\n\t\tif (!a || !b) throw new Error('Object cannot be null');\n\t\tif (is_date(a) && is_date(b)) {\n\t\t\ta = a.getTime();\n\t\t\tb = b.getTime();\n\t\t\tconst delta = b - a;\n\t\t\treturn (t) => new Date(a + t * delta);\n\t\t}\n\t\tconst keys = Object.keys(b);\n\t\tconst interpolators = {};\n\t\tkeys.forEach((key) => {\n\t\t\tinterpolators[key] = get_interpolator(a[key], b[key]);\n\t\t});\n\t\treturn (t) => {\n\t\t\tconst result = {};\n\t\t\tkeys.forEach((key) => {\n\t\t\t\tresult[key] = interpolators[key](t);\n\t\t\t});\n\t\t\treturn result;\n\t\t};\n\t}\n\tif (type === 'number') {\n\t\tconst delta = b - a;\n\t\treturn (t) => a + t * delta;\n\t}\n\tthrow new Error(`Cannot interpolate ${type} values`);\n}\n\n/**\n * A tweened store in Svelte is a special type of store that provides smooth transitions between state values over time.\n *\n * https://svelte.dev/docs/svelte-motion#tweened\n * @template T\n * @param {T} [value]\n * @param {import('./private.js').TweenedOptions<T>} [defaults]\n * @returns {import('./public.js').Tweened<T>}\n */\nexport function tweened(value, defaults = {}) {\n\tconst store = writable(value);\n\t/** @type {import('../internal/private.js').Task} */\n\tlet task;\n\tlet target_value = value;\n\t/**\n\t * @param {T} new_value\n\t * @param {import('./private.js').TweenedOptions<T>} [opts]\n\t */\n\tfunction set(new_value, opts) {\n\t\tif (value == null) {\n\t\t\tstore.set((value = new_value));\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\ttarget_value = new_value;\n\t\tlet previous_task = task;\n\t\tlet started = false;\n\t\tlet {\n\t\t\tdelay = 0,\n\t\t\tduration = 400,\n\t\t\teasing = linear,\n\t\t\tinterpolate = get_interpolator\n\t\t} = assign(assign({}, defaults), opts);\n\t\tif (duration === 0) {\n\t\t\tif (previous_task) {\n\t\t\t\tprevious_task.abort();\n\t\t\t\tprevious_task = null;\n\t\t\t}\n\t\t\tstore.set((value = target_value));\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tconst start = now() + delay;\n\t\tlet fn;\n\t\ttask = loop((now) => {\n\t\t\tif (now < start) return true;\n\t\t\tif (!started) {\n\t\t\t\tfn = interpolate(value, new_value);\n\t\t\t\tif (typeof duration === 'function') duration = duration(value, new_value);\n\t\t\t\tstarted = true;\n\t\t\t}\n\t\t\tif (previous_task) {\n\t\t\t\tprevious_task.abort();\n\t\t\t\tprevious_task = null;\n\t\t\t}\n\t\t\tconst elapsed = now - start;\n\t\t\tif (elapsed > /** @type {number} */ (duration)) {\n\t\t\t\tstore.set((value = new_value));\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// @ts-ignore\n\t\t\tstore.set((value = fn(easing(elapsed / duration))));\n\t\t\treturn true;\n\t\t});\n\t\treturn task.promise;\n\t}\n\treturn {\n\t\tset,\n\t\tupdate: (fn, opts) => set(fn(target_value, value), opts),\n\t\tsubscribe: store.subscribe\n\t};\n}\n","<script>\r\n\r\n\timport { localize } from '#runtime/svelte/helper';\r\n\timport { getContext } from \"svelte\";\r\n\timport { tweened } from 'svelte/motion';\r\n\timport { linear } from 'svelte/easing';\r\n\timport * as Helpers from \"../../helpers/helpers.js\";\r\n\timport ActorDropSelect from \"./ActorDropSelect.svelte\";\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\r\n\tconst { application } = getContext('#external');\r\n\r\n\texport let elementRoot;\r\n\texport let isPrivate;\r\n\texport let tradingActor;\r\n\texport let tradingUser;\r\n\texport let users;\r\n\texport let user;\r\n\texport let actors;\r\n\texport let actor;\r\n\r\n\tlet isGM = game.user.isGM;\r\n\r\n\tusers = game.users.filter(user => user.active && user !== game.user);\r\n\tuser = user || users?.[0] || false;\r\n\tactors = actors || game.actors.filter(actor => actor.isOwner);\r\n\tactor = actor || game.user.character || (!isGM ? actors?.[0] : false);\r\n\r\n\tlet done = false;\r\n\r\n\tasync function accept() {\r\n\t\tapplication.options.resolve(actor);\r\n\t\tclose();\r\n\t}\r\n\r\n\tasync function decline() {\r\n\t\tapplication.options.resolve(false);\r\n\t\tclose();\r\n\t}\r\n\r\n\tasync function mute() {\r\n\t\tapplication.options.resolve(\"mute\");\r\n\t\tclose();\r\n\t}\r\n\r\n\tasync function disconnected() {\r\n\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.Disconnected\"), true)\r\n\t\tclose();\r\n\t}\r\n\r\n\tconst progress = tweened(0, {\r\n\t\tduration: 20000,\r\n\t\teasing: linear\r\n\t});\r\n\r\n\t$: actualProgress = $progress * 100;\r\n\r\n\tlet timeout = setTimeout(() => {\r\n\t\tif (done) return;\r\n\t\tprogress.set(1);\r\n\t\ttimeout = setTimeout(() => {\r\n\t\t\tif (done) return;\r\n\t\t\tHelpers.custom_warning(localize(\"ITEM-PILES.Trade.AutoDecline\"), true)\r\n\t\t\tdecline();\r\n\t\t}, 21000)\r\n\t}, 14000);\r\n\r\n\tconst connection = setInterval(() => {\r\n\t\tconst user = game.users.get(tradingUser.id)\r\n\t\tif (!user.active) {\r\n\t\t\tdisconnected();\r\n\t\t}\r\n\t}, 100);\r\n\r\n\tfunction close() {\r\n\t\tclearInterval(connection);\r\n\t\tclearTimeout(timeout);\r\n\t\tdone = true;\r\n\t\tapplication.close();\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<div class=\"item-piles-flexcol trade-dialog\">\r\n\r\n\t\t<p><i class=\"item-piles-header-icon fas fa-handshake\"></i></p>\r\n\r\n\t\t<p style=\"margin-bottom: 1rem\">\r\n\t\t\t<strong style=\"font-size:1.2rem;\">\r\n\t\t\t\t{ localize(\"ITEM-PILES.Trade.Request.Title\") }\r\n\t\t\t</strong>\r\n\t\t</p>\r\n\r\n\t\t<div class=\"item-piles-bottom-divider\">\r\n\t\t\t{#if isPrivate}\r\n\t\t\t\t<p>{@html localize(\"ITEM-PILES.Trade.Request.PrivateContent\", {\r\n\t\t\t\t\ttrading_user_name: tradingUser.name,\r\n\t\t\t\t\ttrading_actor_name: tradingActor.name\r\n\t\t\t\t})}</p>\r\n\t\t\t{:else}\r\n\t\t\t\t<p>{localize(\"ITEM-PILES.Trade.Request.Content\", {\r\n\t\t\t\t\ttrading_user_name: tradingUser.name,\r\n\t\t\t\t\ttrading_actor_name: tradingActor.name\r\n\t\t\t\t})}</p>\r\n\t\t\t{/if}\r\n\t\t\t<p>{localize(\"ITEM-PILES.Trade.Request.AcceptQuery\")}</p>\r\n\t\t</div>\r\n\r\n\t\t{#if actor}\r\n\t\t\t<p>{localize(\"ITEM-PILES.Trade.Prompt.PickedActor\")}</p>\r\n\t\t{:else}\r\n\t\t\t<p>{localize(\"ITEM-PILES.Trade.Prompt.PickActor\")}</p>\r\n\t\t{/if}\r\n\r\n\t\t<ActorDropSelect {actors} bind:actor={actor}/>\r\n\r\n\t\t<footer class=\"sheet-footer item-piles-flexrow\">\r\n\t\t\t<button disabled={!actor} on:click|once={accept} type=\"button\">\r\n\t\t\t\t<i class=\"fas fa-check\"></i> {localize(\"ITEM-PILES.Trade.Accept\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={decline} type=\"button\">\r\n\t\t\t\t<i class=\"fas fa-times\"></i> {localize(\"ITEM-PILES.Trade.Decline\")}\r\n\t\t\t</button>\r\n\t\t\t<button on:click|once={mute} type=\"button\">\r\n\t\t\t\t<i class=\"fas fa-comment-slash\"></i> {localize(\"ITEM-PILES.Trade.Mute\")}\r\n\t\t\t</button>\r\n\t\t</footer>\r\n\r\n\t\t<div class=\"item-piles-progress\" class:active={actualProgress > 0} style=\"flex: 1 0 auto;\">\r\n\t\t\t<span class=\"progress-bar\" style=\"width: {actualProgress}%;\"></span>\r\n\t\t</div>\r\n\t</div>\r\n\r\n</ApplicationShell>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .trade-dialog {\r\n    text-align: center;\r\n  }\r\n\r\n  .item-piles-header-icon {\r\n    font-size: 3rem;\r\n  }\r\n\r\n  .item-piles-progress {\r\n    width: calc(100% - 4px);\r\n    background: #e1e4e8;\r\n    border-radius: 3px;\r\n    overflow: hidden;\r\n    margin: 0.25rem 2px 0 2px;\r\n    height: 6px;\r\n    display: none;\r\n\r\n    &.active {\r\n      display: block;\r\n    }\r\n\r\n    .progress-bar {\r\n      display: block;\r\n      height: 100%;\r\n      background-color: rgba(255, 20, 20, 0.65);\r\n    }\r\n  }\r\n\r\n  button:disabled {\r\n    opacity: 0.75;\r\n  }\r\n\r\n</style>\r\n","import { SvelteApplication } from '#runtime/svelte/application';\r\nimport TradeDialogPrompt from './trade-dialog-prompt.svelte';\r\nimport TradeDialogRequest from './trade-dialog-request.svelte';\r\n\r\nexport class TradePromptDialog extends SvelteApplication {\r\n\r\n\tconstructor(tradeOptions, options = {}) {\r\n\t\tsuper({\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: TradeDialogPrompt,\r\n\t\t\t\ttarget: document.body,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\t...tradeOptions\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclose: () => this.options.resolve?.(null),\r\n\t\t\t...options\r\n\t\t});\r\n\t}\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Trade.Title\"),\r\n\t\t\twidth: 400,\r\n\t\t\theight: \"auto\",\r\n\t\t\tclasses: [\"dialog\", \"item-piles-app\"],\r\n\t\t})\r\n\t}\r\n\r\n\tstatic show(tradeOptions, options = {}, dialogData = {}) {\r\n\t\treturn new Promise(resolve => {\r\n\t\t\toptions.resolve = resolve;\r\n\t\t\tnew this(tradeOptions, options, dialogData).render(true);\r\n\t\t})\r\n\t}\r\n}\r\n\r\nexport class TradeRequestDialog extends SvelteApplication {\r\n\r\n\tconstructor(tradeOptions, options = {}) {\r\n\r\n\t\tsuper({\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: TradeDialogRequest,\r\n\t\t\t\ttarget: document.body,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\t...tradeOptions\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclose: () => this.options.resolve?.(null),\r\n\t\t\t...options\r\n\t\t});\r\n\t\tthis.tradeId = tradeOptions.tradeId;\r\n\t}\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Trade.Title\"),\r\n\t\t\twidth: 400,\r\n\t\t\theight: \"auto\",\r\n\t\t\tclasses: [\"dialog\"],\r\n\t\t})\r\n\t}\r\n\r\n\tstatic show(tradeOptions, options = {}) {\r\n\t\treturn new Promise(resolve => {\r\n\t\t\toptions.resolve = resolve;\r\n\t\t\tnew this(tradeOptions, options).render(true);\r\n\t\t})\r\n\t}\r\n\r\n\tstatic cancel(tradeId) {\r\n\t\tfor (const app of Object.values(ui.windows)) {\r\n\t\t\tif (app instanceof this && app.tradeId === tradeId) {\r\n\t\t\t\tapp.options.resolve({ type: \"cancelled\" });\r\n\t\t\t\treturn app.close();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n}\r\n","import { get, writable } from 'svelte/store';\r\nimport * as Utilities from \"../../helpers/utilities.js\";\r\nimport * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n\r\nexport default class TradeStore {\r\n\r\n\tconstructor(instigator, leftTrader, rightTrader, publicTradeId, privateTradeId = false, isPrivate = false) {\r\n\r\n\t\tthis.instigator = instigator;\r\n\t\tthis.publicTradeId = publicTradeId;\r\n\t\tthis.privateTradeId = privateTradeId;\r\n\t\tthis.isPrivate = isPrivate;\r\n\r\n\t\tthis.leftTraderUser = leftTrader.user;\r\n\t\tthis.leftTraderActor = leftTrader.actor;\r\n\t\tthis.leftTraderItems = writable(leftTrader.items ?? []);\r\n\t\tthis.leftTraderCurrencies = writable(leftTrader.currencies ?? []);\r\n\t\tthis.leftTraderItemCurrencies = writable(leftTrader.itemCurrencies ?? []);\r\n\t\tthis.leftTraderAccepted = writable(leftTrader.accepted ?? false);\r\n\r\n\t\tthis.rightTraderUser = rightTrader.user;\r\n\t\tthis.rightTraderActor = rightTrader.actor;\r\n\t\tthis.rightTraderItems = writable(rightTrader.items ?? []);\r\n\t\tthis.rightTraderCurrencies = writable(rightTrader.currencies ?? []);\r\n\t\tthis.rightTraderItemCurrencies = writable(rightTrader.itemCurrencies ?? []);\r\n\t\tthis.rightTraderAccepted = writable(rightTrader?.accepted ?? false);\r\n\r\n\t}\r\n\r\n\tget isUserParticipant() {\r\n\t\treturn game.user === this.leftTraderUser || game.user === this.rightTraderUser;\r\n\t}\r\n\r\n\tget tradeIsAccepted() {\r\n\t\treturn get(this.leftTraderAccepted) && get(this.rightTraderAccepted);\r\n\t}\r\n\r\n\tstatic import(tradeData) {\r\n\r\n\t\tconst leftTrader = {\r\n\t\t\tuser: game.users.get(tradeData.leftTraderData.user),\r\n\t\t\tactor: fromUuidSync(tradeData.leftTraderData.actor),\r\n\t\t\titems: tradeData.leftTraderData.items,\r\n\t\t\tcurrencies: tradeData.leftTraderData.currencies,\r\n\t\t\titemCurrencies: tradeData.leftTraderData.itemCurrencies,\r\n\t\t\taccepted: tradeData.leftTraderData.accepted\r\n\t\t};\r\n\r\n\t\tconst rightTrader = {\r\n\t\t\tuser: game.users.get(tradeData.rightTraderData.user),\r\n\t\t\tactor: fromUuidSync(tradeData.rightTraderData.actor),\r\n\t\t\titems: tradeData.rightTraderData.items,\r\n\t\t\tcurrencies: tradeData.rightTraderData.currencies,\r\n\t\t\titemCurrencies: tradeData.rightTraderData.itemCurrencies,\r\n\t\t\taccepted: tradeData.rightTraderData.accepted\r\n\t\t};\r\n\r\n\t\treturn new this(tradeData.instigator, leftTrader, rightTrader, tradeData.publicTradeId);\r\n\t}\r\n\r\n\texport() {\r\n\t\treturn {\r\n\t\t\tinstigator: this.instigator,\r\n\t\t\tpublicTradeId: this.publicTradeId,\r\n\t\t\tleftTraderData: {\r\n\t\t\t\tuser: this.leftTraderUser.id,\r\n\t\t\t\tactor: Utilities.getUuid(this.leftTraderActor),\r\n\t\t\t\titems: get(this.leftTraderItems),\r\n\t\t\t\tcurrencies: get(this.leftTraderCurrencies),\r\n\t\t\t\titemCurrencies: get(this.leftTraderItemCurrencies),\r\n\t\t\t\taccepted: get(this.leftTraderAccepted)\r\n\t\t\t},\r\n\t\t\trightTraderData: {\r\n\t\t\t\tuser: this.rightTraderUser.id,\r\n\t\t\t\tactor: Utilities.getUuid(this.rightTraderActor),\r\n\t\t\t\titems: get(this.rightTraderItems),\r\n\t\t\t\tcurrencies: get(this.rightTraderCurrencies),\r\n\t\t\t\titemCurrencies: get(this.rightTraderItemCurrencies),\r\n\t\t\t\taccepted: get(this.rightTraderAccepted)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tgetTradeData() {\r\n\t\treturn {\r\n\t\t\tsourceActor: this.leftTraderActor,\r\n\t\t\ttargetActor: this.rightTraderActor,\r\n\t\t\tremove: {\r\n\t\t\t\titems: get(this.leftTraderItems).concat(get(this.leftTraderItemCurrencies)),\r\n\t\t\t\tattributes: get(this.leftTraderCurrencies)\r\n\t\t\t}, add: {\r\n\t\t\t\titems: get(this.rightTraderItems).concat(get(this.rightTraderItemCurrencies)),\r\n\t\t\t\tattributes: get(this.rightTraderCurrencies)\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tgetExistingCurrencies() {\r\n\t\treturn [...get(this.leftTraderCurrencies), ...get(this.leftTraderItemCurrencies)]\r\n\t}\r\n\r\n\tasync toggleAccepted() {\r\n\t\tthis.leftTraderAccepted.set(!get(this.leftTraderAccepted));\r\n\t}\r\n\r\n\tupdateItems(userId, inItems) {\r\n\t\tif (userId === game.user.id) return;\r\n\t\tthis.leftTraderAccepted.set(false);\r\n\t\tthis.rightTraderAccepted.set(false);\r\n\t\tif (userId === this.leftTraderUser.id) {\r\n\t\t\tthis.leftTraderItems.set(inItems)\r\n\t\t}\r\n\t\tif (userId === this.rightTraderUser.id) {\r\n\t\t\tthis.rightTraderItems.set(inItems)\r\n\t\t}\r\n\t}\r\n\r\n\tupdateItemCurrencies(userId, itemCurrencies) {\r\n\t\tif (userId === game.user.id) return;\r\n\t\tthis.leftTraderAccepted.set(false);\r\n\t\tthis.rightTraderAccepted.set(false);\r\n\t\tif (userId === this.leftTraderUser.id) {\r\n\t\t\tthis.leftTraderItemCurrencies.set(itemCurrencies)\r\n\t\t}\r\n\t\tif (userId === this.rightTraderUser.id) {\r\n\t\t\tthis.rightTraderItemCurrencies.set(itemCurrencies)\r\n\t\t}\r\n\t}\r\n\r\n\tupdateCurrencies(userId, inCurrencies) {\r\n\t\tif (userId === game.user.id) return;\r\n\t\tthis.leftTraderAccepted.set(false);\r\n\t\tthis.rightTraderAccepted.set(false);\r\n\t\tif (userId === this.leftTraderUser.id) {\r\n\t\t\tthis.leftTraderCurrencies.set(inCurrencies)\r\n\t\t}\r\n\t\tif (userId === this.rightTraderUser.id) {\r\n\t\t\tthis.rightTraderCurrencies.set(inCurrencies)\r\n\t\t}\r\n\t}\r\n\r\n\tupdateAcceptedState(userId, state) {\r\n\t\tif (userId === game.user.id) return;\r\n\t\tif (userId === this.leftTraderUser.id) {\r\n\t\t\tthis.leftTraderAccepted.set(state);\r\n\t\t}\r\n\t\tif (userId === this.rightTraderUser.id) {\r\n\t\t\tthis.rightTraderAccepted.set(state);\r\n\t\t}\r\n\t}\r\n\r\n\taddItem(newItem, { uuid = false, quantity = false, currency = false } = {}) {\r\n\r\n\t\tconst items = !currency\r\n\t\t\t? get(this.leftTraderItems)\r\n\t\t\t: get(this.leftTraderItemCurrencies);\r\n\r\n\t\tconst item = Utilities.findSimilarItem(items, newItem)\r\n\r\n\t\tconst maxQuantity = game.user.isGM ? Infinity : Utilities.getItemQuantity(newItem);\r\n\r\n\t\tif (item && PileUtilities.canItemStack(item)) {\r\n\t\t\tif (item.quantity >= maxQuantity) return;\r\n\t\t\tif (quantity) {\r\n\t\t\t\titem.quantity = Math.min(quantity ? quantity : item.quantity + 1, maxQuantity);\r\n\t\t\t\titem.newQuantity = item.quantity;\r\n\t\t\t\titem.maxQuantity = maxQuantity;\r\n\t\t\t} else {\r\n\t\t\t\titems.splice(items.indexOf(item));\r\n\t\t\t}\r\n\t\t} else if (!item && quantity) {\r\n\t\t\titems.push({\r\n\t\t\t\tid: newItem._id ?? newItem.id,\r\n\t\t\t\tuuid: uuid,\r\n\t\t\t\tname: newItem.name,\r\n\t\t\t\timg: newItem?.img ?? \"\",\r\n\t\t\t\ttype: newItem?.type,\r\n\t\t\t\tcurrency: currency,\r\n\t\t\t\tquantity: quantity ? quantity : 1,\r\n\t\t\t\tnewQuantity: quantity ? quantity : 1,\r\n\t\t\t\tmaxQuantity: maxQuantity,\r\n\t\t\t\tdata: newItem instanceof Item ? newItem.toObject() : newItem\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (!currency) {\r\n\t\t\tthis.leftTraderItems.set(items);\r\n\t\t} else {\r\n\t\t\tthis.leftTraderItemCurrencies.set(items);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\taddAttribute(newCurrency) {\r\n\r\n\t\tconst currencies = get(this.leftTraderCurrencies);\r\n\r\n\t\tconst existingCurrency = currencies.find(currency => currency.path === newCurrency.path);\r\n\r\n\t\tif (existingCurrency) {\r\n\t\t\texistingCurrency.quantity = newCurrency.quantity;\r\n\t\t\texistingCurrency.newQuantity = newCurrency.quantity;\r\n\t\t} else {\r\n\t\t\tcurrencies.push(newCurrency);\r\n\t\t}\r\n\r\n\t\tcurrencies.sort((a, b) => a.index - b.index);\r\n\r\n\t\tthis.leftTraderCurrencies.set(currencies);\r\n\r\n\t}\r\n\r\n\tremoveEntry(entry) {\r\n\r\n\t\tif (entry.id) {\r\n\r\n\t\t\tif (!entry.currency) {\r\n\r\n\t\t\t\tconst items = get(this.leftTraderItems)\r\n\t\t\t\t\t.filter(item => item.id !== entry.id);\r\n\r\n\t\t\t\tthis.leftTraderItems.set(items);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconst items = get(this.leftTraderItemCurrencies)\r\n\t\t\t\t\t.filter(item => item.id !== entry.id);\r\n\r\n\t\t\t\tthis.leftTraderItemCurrencies.set(items);\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconst items = get(this.leftTraderCurrencies)\r\n\t\t\t\t.filter(currency => currency.path !== entry.path);\r\n\r\n\t\t\tthis.leftTraderCurrencies.set(items);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n","<script>\r\n\r\n\timport * as Helpers from \"../../helpers/helpers.js\";\r\n\timport SETTINGS from \"../../constants/settings.js\";\r\n\timport { SYSTEMS } from \"../../systems.js\";\r\n\r\n\texport let store;\r\n\texport let data;\r\n\texport let editable = true;\r\n\r\n\tconst canPreview = data.id && (Helpers.getSetting(SETTINGS.INSPECT_ITEMS_IN_TRADE) || editable)\r\n\r\n\tfunction previewItem() {\r\n\t\tif (!canPreview || !data.id) return;\r\n\t\tconst item = store.leftTraderActor.items.get(data.id) ?? store.rightTraderActor.items.get(data.id);\r\n\t\tif (!item) return;\r\n\t\tif (SYSTEMS.DATA?.PREVIEW_ITEM_TRANSFORMER) {\r\n\t\t\tif (!SYSTEMS.DATA?.PREVIEW_ITEM_TRANSFORMER(item)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (game.user.isGM || item.ownership[game.user.id] === 3) {\r\n\t\t\treturn item.sheet.render(true);\r\n\t\t}\r\n\t\tconst itemData = item.toObject();\r\n\t\titemData.ownership[game.user.id] = 1;\r\n\t\tconst newItem = new Item.implementation(itemData);\r\n\t\tconst cls = newItem._getSheetClass();\r\n\t\tconst sheet = new cls(newItem, { editable: false });\r\n\t\treturn sheet._render(true);\r\n\t}\r\n\r\n\tfunction onKeyDown(e) {\r\n\t\tif (e.keyCode === 13) {\r\n\t\t\tupdateQuantity();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction updateQuantity() {\r\n\t\tdata.quantity = Math.max(0, Math.min(data.maxQuantity, data.newQuantity));\r\n\t\tif (data.quantity === 0) {\r\n\t\t\treturn store.removeEntry(data);\r\n\t\t}\r\n\t\tdata.newQuantity = data.quantity;\r\n\t\tdata.editing = false;\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:window on:click={() => {\r\n  if(data.editing && editable) updateQuantity();\r\n}}/>\r\n\r\n<div class=\"item-piles-flexrow item-piles-item-row item-piles-even-color\">\r\n\r\n\t{#if editable}\r\n\t\t<div style=\"flex: 0 1 auto; margin: 0 6px;\">\r\n\t\t\t<a class=\"item-piles-clickable-red\" on:click={() => { store.removeEntry(data) }}>\r\n\t\t\t\t<i class=\"fas fa-times\"></i>\r\n\t\t\t</a>\r\n\t\t</div>\r\n\t{/if}\r\n\r\n\t<div class=\"item-piles-img-container\">\r\n\t\t<img class=\"item-piles-img\" src=\"{data.img}\"/>\r\n\t</div>\r\n\r\n\t<div class=\"item-piles-name item-piles-text\">\r\n\t\t<div class=\"item-piles-name-container\">\r\n\t\t\t<p class:item-piles-clickable-link=\"{canPreview}\" on:click={previewItem}>{data.name}</p>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t{#if editable}\r\n\t\t<div style=\"flex: 0 1 17px; margin: 0 5px;\">\r\n\t\t\t{#if data.editing}\r\n\t\t\t\t<a class=\"item-piles-clickable-green item-piles-confirm-quantity\" on:click=\"{updateQuantity}\">\r\n\t\t\t\t\t<i class=\"fas fa-check\"></i>\r\n\t\t\t\t</a>\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\t{/if}\r\n\r\n\t<div class=\"item-piles-text-right\" class:item-piles-quantity-container={editable}\r\n\t     on:click={(evt) => evt.stopPropagation()}>\r\n\t\t{#if editable}\r\n\t\t\t<div class=\"item-piles-quantity-container\">\r\n\t\t\t\t{#if data.editing}\r\n\t\t\t\t\t<div class=\"item-piles-quantity-input-container\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\tclass=\"item-piles-quantity\"\r\n\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\tbind:value={data.newQuantity}\r\n\t\t\t\t\t\t\ton:keydown={onKeyDown}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{:else}\r\n            <span class=\"item-piles-quantity-text\"\r\n                  on:click=\"{ () => { data.editing = true } }\">\r\n              {data.quantity}\r\n            </span>\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\t\t{:else}\r\n\t\t\t<span class=\"item-piles-text\" style=\"padding-right:0.5rem;\">{data.quantity}</span>\r\n\t\t{/if}\r\n\t</div>\r\n</div>\r\n","<script>\r\n\r\n\timport { fade } from 'svelte/transition';\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n\timport DropZone from \"../components/DropZone.svelte\";\r\n\timport { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n\timport * as Helpers from \"../../helpers/helpers.js\";\r\n\timport * as PileUtilities from \"../../helpers/pile-utilities.js\";\r\n\timport ItemPileSocket from \"../../socket.js\";\r\n\timport TradeEntry from \"./TradeEntry.svelte\";\r\n\timport DropCurrencyDialog from \"../dialogs/drop-currency-dialog/drop-currency-dialog.js\";\r\n\timport * as Utilities from \"../../helpers/utilities.js\";\r\n\r\n\texport let elementRoot;\r\n\texport let store;\r\n\r\n\tconst leftItems = store.leftTraderItems;\r\n\tconst leftCurrencies = store.leftTraderCurrencies;\r\n\tconst leftItemCurrencies = store.leftTraderItemCurrencies;\r\n\tconst leftTraderAccepted = store.leftTraderAccepted;\r\n\r\n\tconst rightItems = store.rightTraderItems;\r\n\tconst rightCurrencies = store.rightTraderCurrencies;\r\n\tconst rightItemCurrencies = store.rightTraderItemCurrencies;\r\n\tconst rightTraderAccepted = store.rightTraderAccepted;\r\n\r\n\tlet isGM = game.user.isGM;\r\n\tlet systemHasCurrencies = game.itempiles.API.CURRENCIES.length > 0;\r\n\r\n\tasync function dropItem(data) {\r\n\r\n\t\tif (data.type !== \"Item\") return;\r\n\r\n\t\tlet item = (await Item.implementation.fromDropData(data)).toObject();\r\n\r\n\t\tdata.actorId = Utilities.getSourceActorFromDropData(data)?.id;\r\n\r\n\t\tif (!data.actorId && !game.user.isGM) {\r\n\t\t\treturn Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Errors.NoSourceDrop\"), true)\r\n\t\t}\r\n\r\n\t\tif (!game.user.isGM && data.actorId && data.actorId !== store.leftTraderActor.id) {\r\n\t\t\tthrow Helpers.custom_error(`You cannot drop items into the trade UI from a different actor than ${store.leftTraderActor.name}!`)\r\n\t\t}\r\n\r\n\t\tconst validItem = await PileUtilities.checkItemType(store.rightTraderActor, item, {\r\n\t\t\terrorText: \"ITEM-PILES.Errors.DisallowedItemTrade\",\r\n\t\t\twarningTitle: \"ITEM-PILES.Dialogs.TypeWarning.Title\",\r\n\t\t\twarningContent: \"ITEM-PILES.Dialogs.TypeWarning.TradeContent\"\r\n\t\t});\r\n\t\tif (!validItem) return;\r\n\r\n\t\tconst actorItemCurrencyList = PileUtilities.getCurrencyList(store.leftTraderActor).filter(entry => entry.type !== \"attribute\");\r\n\t\tconst isCurrency = !!Utilities.findSimilarItem(actorItemCurrencyList.map(item => item.data), validItem);\r\n\r\n\t\tif (!validItem._id) {\r\n\t\t\tvalidItem._id = item._id;\r\n\t\t}\r\n\r\n\t\tconst itemToSend = new Item.implementation(validItem);\r\n\r\n\t\treturn store.addItem(itemToSend, { uuid: data.uuid, quantity: 1, currency: isCurrency });\r\n\r\n\t}\r\n\r\n\tif (store.isUserParticipant) {\r\n\t\tconst itemsUpdatedDebounce = debounce(async (items) => {\r\n\t\t\tawait ItemPileSocket.executeForUsers(ItemPileSocket.HANDLERS.PRIVATE_TRADE_UPDATE_ITEMS, [store.leftTraderUser.id, store.rightTraderUser.id], store.privateTradeId, game.user.id, items);\r\n\t\t\treturn executeSocketAction(ItemPileSocket.HANDLERS.PUBLIC_TRADE_UPDATE_ITEMS, store.publicTradeId, game.user.id, items);\r\n\t\t}, 20)\r\n\t\tleftItems.subscribe(itemsUpdatedDebounce)\r\n\r\n\t\tconst itemCurrenciesUpdatedDebounce = debounce(async (items) => {\r\n\t\t\tawait ItemPileSocket.executeForUsers(ItemPileSocket.HANDLERS.PRIVATE_TRADE_UPDATE_ITEM_CURRENCIES, [store.leftTraderUser.id, store.rightTraderUser.id], store.privateTradeId, game.user.id, items);\r\n\t\t\treturn executeSocketAction(ItemPileSocket.HANDLERS.PUBLIC_TRADE_UPDATE_ITEM_CURRENCIES, store.publicTradeId, game.user.id, items);\r\n\t\t}, 20)\r\n\t\tleftItemCurrencies.subscribe(itemCurrenciesUpdatedDebounce)\r\n\r\n\t\tconst attributesUpdatedDebounce = debounce(async (attributes) => {\r\n\t\t\tawait ItemPileSocket.executeForUsers(ItemPileSocket.HANDLERS.PRIVATE_TRADE_UPDATE_CURRENCIES, [store.leftTraderUser.id, store.rightTraderUser.id], store.privateTradeId, game.user.id, attributes);\r\n\t\t\treturn executeSocketAction(ItemPileSocket.HANDLERS.PUBLIC_TRADE_UPDATE_CURRENCIES, store.publicTradeId, game.user.id, attributes);\r\n\t\t}, 40)\r\n\t\tleftCurrencies.subscribe(attributesUpdatedDebounce)\r\n\r\n\t\tconst acceptedDebounce = debounce(async (acceptedState) => {\r\n\t\t\tawait ItemPileSocket.executeForUsers(ItemPileSocket.HANDLERS.PRIVATE_TRADE_STATE, [store.leftTraderUser.id, store.rightTraderUser.id], store.privateTradeId, game.user.id, acceptedState);\r\n\t\t\treturn executeSocketAction(ItemPileSocket.HANDLERS.PUBLIC_TRADE_STATE, store.publicTradeId, game.user.id, acceptedState);\r\n\t\t}, 10)\r\n\t\tleftTraderAccepted.subscribe(acceptedDebounce)\r\n\t}\r\n\r\n\tasync function executeSocketAction(socketHandler, ...args) {\r\n\t\tif (store.isPrivate) {\r\n\t\t\treturn ItemPileSocket.executeForUsers(socketHandler, [store.leftTraderUser.id, store.rightTraderUser.id], ...args);\r\n\t\t}\r\n\t\treturn ItemPileSocket.executeForEveryone(socketHandler, ...args);\r\n\t}\r\n\r\n\tasync function addCurrency(asGM = false) {\r\n\r\n\t\tconst currenciesToAdd = await DropCurrencyDialog.show(\r\n\t\t\tstore.leftTraderActor,\r\n\t\t\tstore.rightTraderActor,\r\n\t\t\t{\r\n\t\t\t\texistingCurrencies: store.getExistingCurrencies(),\r\n\t\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Trade.AddCurrency.Title\"),\r\n\t\t\t\tcontent: game.i18n.format(\"ITEM-PILES.Trade.AddCurrency.Content\", { trader_actor_name: store.rightTraderActor.name }),\r\n\t\t\t\tbutton: game.i18n.localize(\"ITEM-PILES.Trade.AddCurrency.Label\"),\r\n\t\t\t\tunlimitedCurrencies: asGM\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tif (!currenciesToAdd || (foundry.utils.isEmpty(currenciesToAdd.attributes) && !currenciesToAdd.items.length)) return;\r\n\r\n\t\tcurrenciesToAdd.items.forEach(item => {\r\n\t\t\tconst itemData = store.leftTraderActor.items.get(item.item._id).toObject();\r\n\t\t\tstore.addItem(itemData, { quantity: item.quantity, currency: true })\r\n\t\t});\r\n\r\n\t\tconst currencies = PileUtilities.getActorCurrencies(store.leftTraderActor, { getAll: asGM })\r\n\t\t\t.filter(currency => currency.type === \"attribute\");\r\n\r\n\t\tObject.entries(currenciesToAdd.attributes).forEach(([path, quantity]) => {\r\n\t\t\tconst currency = currencies.find(currency => currency.path === path);\r\n\t\t\tstore.addAttribute({\r\n\t\t\t\tpath: path,\r\n\t\t\t\tquantity: quantity,\r\n\t\t\t\tnewQuantity: quantity,\r\n\t\t\t\tname: currency.name,\r\n\t\t\t\timg: currency.img,\r\n\t\t\t\tmaxQuantity: !game.user.isGM ? currency.quantity : Infinity,\r\n\t\t\t\tindex: currency.index\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t{#if $leftTraderAccepted && $rightTraderAccepted}\r\n\t\t<div class=\"lds-ellipsis\" transition:fade>\r\n\t\t\t<div></div>\r\n\t\t\t<div></div>\r\n\t\t\t<div></div>\r\n\t\t\t<div></div>\r\n\t\t</div>\r\n\t{/if}\r\n\r\n\t<DropZone callback={dropItem}>\r\n\r\n\t\t<div class=\"item-piles-flexcol\">\r\n\r\n\t\t\t<div class=\"item-piles-flexrow\">\r\n\r\n\t\t\t\t<div class=\"col item-piles-flexcol\">\r\n\r\n\t\t\t\t\t<div class=\"item-piles-character-header item-piles-bottom-divider\">\r\n\t\t\t\t\t\t<img src=\"{store.leftTraderActor.img}\">\r\n\t\t\t\t\t\t<h2 class=\"item-piles-character-name\">\r\n\t\t\t\t\t\t\t<div>{store.leftTraderActor.name}</div>\r\n\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclass=\"fas accepted-icon\"\r\n\t\t\t\t\t\t\t\tclass:accepted={$leftTraderAccepted}\r\n\t\t\t\t\t\t\t\tclass:fa-user-check={$leftTraderAccepted}\r\n\t\t\t\t\t\t\t\tclass:fa-user-times={!$leftTraderAccepted}\r\n\t\t\t\t\t\t\t></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\r\n\t\t\t\t\t\t<div class=\"row item-piles-items-list\">\r\n\r\n\t\t\t\t\t\t\t{#if !$leftItems.length && store.isUserParticipant}\r\n\t\t\t\t\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\t\t\t\t\t\t\t\t\t<h3 class=\"item-piles-text-center\">{localize(\"ITEM-PILES.Trade.DragDrop\")}</h3>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t{#each $leftItems as item (item.id)}\r\n\t\t\t\t\t\t\t\t<TradeEntry bind:data={item} {store} editable={store.isUserParticipant}/>\r\n\t\t\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{#if systemHasCurrencies}\r\n\r\n\t\t\t\t\t\t\t<div class=\"row item-piles-items-list item-piles-currency-list\"\r\n\t\t\t\t\t\t\t     class:item-piles-top-divider={$leftCurrencies.length || $leftItemCurrencies.length}>\r\n\r\n\t\t\t\t\t\t\t\t{#if store.isUserParticipant}\r\n\t\t\t\t\t\t\t\t\t<div class=\"item-piles-flexrow\">\r\n\t\t\t\t\t\t\t\t\t\t{#if isGM}\r\n\t\t\t\t\t\t\t\t\t\t\t<a on:click={() => { addCurrency(true) }}\r\n\t\t\t\t\t\t\t\t\t\t\t   class=\"item-piles-text-right item-piles-small-text item-piles-middle item-piles-gm-add-currency\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-plus\"></i>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Trade.GMAddCurrency\")}\r\n\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t<a on:click={() => { addCurrency() }}\r\n\t\t\t\t\t\t\t\t\t\t   class=\"item-piles-text-right item-piles-small-text item-piles-middle item-piles-add-currency\">\r\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-plus\"></i>\r\n\t\t\t\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Inspect.AddCurrency\")}\r\n\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t{#each $leftCurrencies as currency (currency.path)}\r\n\t\t\t\t\t\t\t\t\t<TradeEntry bind:data={currency} {store} editable={store.isUserParticipant}/>\r\n\t\t\t\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t\t\t\t\t{#each $leftItemCurrencies as item (item.id)}\r\n\t\t\t\t\t\t\t\t\t<TradeEntry bind:data={item} {store} editable={store.isUserParticipant}/>\r\n\t\t\t\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{#if store.isUserParticipant}\r\n\r\n\t\t\t\t\t\t<button type=\"button\" style=\"flex:0 1 auto; margin-top: 0.25rem;\"\r\n\t\t\t\t\t\t        on:click={() => { store.toggleAccepted(store.leftTraderUser.id) }}>\r\n\t\t\t\t\t\t\t{#if $leftTraderAccepted}\r\n\t\t\t\t\t\t\t\t<i class=\"fas fa-times\"></i>\r\n\t\t\t\t\t\t\t\t{localize(\"Cancel\")}\r\n\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t<i class=\"fas fa-check\"></i>\r\n\t\t\t\t\t\t\t\t{localize(\"ITEM-PILES.Trade.Accept\")}\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"col item-piles-flexcol\">\r\n\r\n\t\t\t\t\t<div class=\"item-piles-character-header trader item-piles-bottom-divider\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\tclass=\"fas accepted-icon\"\r\n\t\t\t\t\t\t\t\tclass:accepted={$rightTraderAccepted}\r\n\t\t\t\t\t\t\t\tclass:fa-user-check={$rightTraderAccepted}\r\n\t\t\t\t\t\t\t\tclass:fa-user-times={!$rightTraderAccepted}\r\n\t\t\t\t\t\t\t></i>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<h2 class=\"item-piles-character-name\">\r\n\t\t\t\t\t\t\t{store.rightTraderActor.name}\r\n\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t<img src=\"{store.rightTraderActor.img}\">\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"item-piles-flexcol\">\r\n\r\n\t\t\t\t\t\t<div class=\"row item-piles-items-list\">\r\n\r\n\t\t\t\t\t\t\t{#each $rightItems as item (item.id)}\r\n\t\t\t\t\t\t\t\t<TradeEntry bind:data={item} {store} editable={false}/>\r\n\t\t\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{#if systemHasCurrencies}\r\n\r\n\t\t\t\t\t\t\t<div class=\"row item-piles-items-list item-piles-currency-list\"\r\n\t\t\t\t\t\t\t     class:item-piles-top-divider={$rightCurrencies.length || $rightItemCurrencies.length}>\r\n\r\n\t\t\t\t\t\t\t\t{#each $rightCurrencies as currency (currency.path)}\r\n\t\t\t\t\t\t\t\t\t<TradeEntry bind:data={currency} {store} editable={false}/>\r\n\t\t\t\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t\t\t\t\t{#each $rightItemCurrencies as item (item.id)}\r\n\t\t\t\t\t\t\t\t\t<TradeEntry bind:data={item} {store} editable={false}/>\r\n\t\t\t\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t</div>\r\n\r\n\t</DropZone>\r\n\r\n</ApplicationShell>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .col {\r\n    flex-direction: column;\r\n    margin: 0 5px;\r\n  }\r\n\r\n  .col:not(:last-child) {\r\n    padding-right: 10px;\r\n    border-right: 1px solid rgba(0, 0, 0, 0.35);\r\n  }\r\n\r\n  .row {\r\n    flex: 1;\r\n  }\r\n\r\n  .row:last-child {\r\n    flex: 0 1 auto;\r\n  }\r\n\r\n  .trader {\r\n\r\n  }\r\n\r\n  .lds-ellipsis {\r\n    position: absolute;\r\n    left: calc(50% - 38px);\r\n    top: calc(50% - 40px);\r\n    display: inline-block;\r\n    width: 80px;\r\n    height: 80px;\r\n  }\r\n\r\n  .lds-ellipsis div {\r\n    position: absolute;\r\n    top: 33px;\r\n    width: 13px;\r\n    height: 13px;\r\n    border-radius: 50%;\r\n    background: #435068;\r\n    animation-timing-function: cubic-bezier(0, 1, 1, 0);\r\n  }\r\n\r\n  .lds-ellipsis div:nth-child(1) {\r\n    left: 8px;\r\n    animation: lds-ellipsis1 0.6s infinite;\r\n  }\r\n\r\n  .lds-ellipsis div:nth-child(2) {\r\n    left: 8px;\r\n    animation: lds-ellipsis2 0.6s infinite;\r\n  }\r\n\r\n  .lds-ellipsis div:nth-child(3) {\r\n    left: 32px;\r\n    animation: lds-ellipsis2 0.6s infinite;\r\n  }\r\n\r\n  .lds-ellipsis div:nth-child(4) {\r\n    left: 56px;\r\n    animation: lds-ellipsis3 0.6s infinite;\r\n  }\r\n\r\n  @keyframes lds-ellipsis1 {\r\n    0% {\r\n      transform: scale(0);\r\n    }\r\n    100% {\r\n      transform: scale(1);\r\n    }\r\n  }\r\n\r\n  @keyframes lds-ellipsis3 {\r\n    0% {\r\n      transform: scale(1);\r\n    }\r\n    100% {\r\n      transform: scale(0);\r\n    }\r\n  }\r\n\r\n  @keyframes lds-ellipsis2 {\r\n    0% {\r\n      transform: translate(0, 0);\r\n    }\r\n    100% {\r\n      transform: translate(24px, 0);\r\n    }\r\n  }\r\n\r\n\r\n</style>\r\n","import { SvelteApplication } from '#runtime/svelte/application';\r\nimport TradingAppShell from \"./trading-app-shell.svelte\";\r\nimport ItemPileSocket from \"../../socket.js\";\r\n\r\nexport default class TradingApp extends SvelteApplication {\r\n\tconstructor(store, options = {}, dialogData = {}) {\r\n\t\tsuper({\r\n\t\t\ttitle: game.i18n.format(\"ITEM-PILES.Trade.Between\", {\r\n\t\t\t\tactor_1: store.leftTraderActor.name,\r\n\t\t\t\tactor_2: store.rightTraderActor.name\r\n\t\t\t}),\r\n\t\t\tsvelte: {\r\n\t\t\t\tclass: TradingAppShell,\r\n\t\t\t\ttarget: document.body,\r\n\t\t\t\tprops: {\r\n\t\t\t\t\tstore\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t...options\r\n\t\t}, dialogData);\r\n\t\tthis.store = store;\r\n\t\tthis.publicTradeId = store.publicTradeId;\r\n\t}\r\n\r\n\tstatic get defaultOptions() {\r\n\t\treturn foundry.utils.mergeObject(super.defaultOptions, {\r\n\t\t\tzIndex: 100,\r\n\t\t\tclasses: [\"dialog\", \"item-piles-trading-sheet\", \"item-piles\", \"item-piles-app\"],\r\n\t\t\twidth: 800,\r\n\t\t\theight: \"auto\",\r\n\t\t\tcloseOnSubmit: false\r\n\t\t});\r\n\t}\r\n\r\n\tstatic getActiveApp(publicTradeId) {\r\n\t\tfor (const app of Object.values(ui.windows)) {\r\n\t\t\tif (app instanceof this && app?.publicTradeId === publicTradeId) {\r\n\t\t\t\treturn app;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tasync close(options = {}) {\r\n\t\tif (!options?.callback && this.store.isUserParticipant) {\r\n\t\t\tawait ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.TRADE_CLOSED, this.publicTradeId, game.user.id);\r\n\t\t}\r\n\t\treturn super.close(options)\r\n\t}\r\n}\r\n","import { TJSDialog } from \"#runtime/svelte/application\";\r\nimport CustomDialog from \"../applications/components/CustomDialog.svelte\";\r\nimport { TradePromptDialog, TradeRequestDialog } from \"../applications/trade-dialogs/trade-dialogs.js\";\r\n\r\nimport CONSTANTS from \"../constants/constants.js\";\r\nimport ItemPileSocket from \"../socket.js\";\r\nimport * as Helpers from \"../helpers/helpers.js\";\r\nimport * as Utilities from \"../helpers/utilities.js\";\r\nimport TradeStore from \"../applications/trading-app/trade-store.js\";\r\nimport TradingApp from \"../applications/trading-app/trading-app.js\";\r\nimport Transaction from \"../helpers/transaction.js\";\r\n\r\nconst mutedUsers = new Set();\r\nconst ongoingTrades = new Map();\r\n\r\nexport default class TradeAPI {\r\n\r\n\tstatic initialize() {\r\n\t\tHooks.on(\"renderPlayerList\", this._userDisconnected.bind(this));\r\n\t}\r\n\r\n\tstatic async _requestTrade(user = false) {\r\n\r\n\t\t// Grab all the active users (not self)\r\n\t\tconst users = game.users.filter(user => user.active && user !== game.user);\r\n\r\n\t\t// No users!\r\n\t\tif (!users.length) {\r\n\t\t\treturn TJSDialog.prompt({\r\n\t\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Trade.Title\"), content: {\r\n\t\t\t\t\tclass: CustomDialog, props: {\r\n\t\t\t\t\t\theader: game.i18n.localize(\"ITEM-PILES.Trade.NoActiveUsers.Title\"),\r\n\t\t\t\t\t\tcontent: game.i18n.localize(\"ITEM-PILES.Trade.NoActiveUsers.Content\"),\r\n\t\t\t\t\t\ticon: \"fas fa-heart-broken\"\r\n\t\t\t\t\t}\r\n\t\t\t\t}, modal: true, draggable: false, options: {\r\n\t\t\t\t\theight: \"auto\"\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tlet userId;\r\n\t\tlet actor;\r\n\t\tlet isPrivate;\r\n\r\n\t\t// Find actors you own\r\n\t\tconst actors = game.actors.filter(actor => actor.isOwner);\r\n\r\n\t\t// If you only own one actor, and the user was already preselected (through the right click menu in the actors list)\r\n\t\tif (actors.length === 1 && user) {\r\n\t\t\tuserId = user.id;\r\n\t\t\tactor = actors[0];\r\n\t\t\tisPrivate = false;\r\n\t\t} else {\r\n\t\t\t// If you have more than 1 owned actor, prompt to choose which one\r\n\t\t\tconst result = await TradePromptDialog.show({ actors, users, user });\r\n\t\t\tif (!result) return;\r\n\t\t\tuserId = result.user.id;\r\n\t\t\tactor = result.actor;\r\n\t\t\tisPrivate = result.private;\r\n\t\t}\r\n\r\n\t\tif (!actor) return false;\r\n\r\n\t\tactor = Utilities.getActor(actor);\r\n\r\n\t\tconst actorOwner = game.users.find(user => user.character === actor && user !== game.user);\r\n\t\tif (actorOwner) {\r\n\r\n\t\t\tconst doContinue = await TJSDialog.confirm({\r\n\t\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Trade.Title\"), content: {\r\n\t\t\t\t\tclass: CustomDialog, props: {\r\n\t\t\t\t\t\theader: game.i18n.localize(\"ITEM-PILES.Trade.Title\"),\r\n\t\t\t\t\t\tcontent: actorOwner.active ? game.i18n.format(\"ITEM-PILES.Trade.UserActiveCharacterWarning\", {\r\n\t\t\t\t\t\t\tactor_name: actor.name, player_name: actorOwner.name\r\n\t\t\t\t\t\t}) : game.i18n.format(\"ITEM-PILES.Trade.UserCharacterWarning\", {\r\n\t\t\t\t\t\t\tactor_name: actor.name, player_name: actorOwner.name\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t\ticon: \"fas fa-exclamation-triangle\",\r\n\t\t\t\t\t}\r\n\t\t\t\t}, modal: true, draggable: false, rejectClose: false, defaultYes: true, options: {\r\n\t\t\t\t\theight: \"auto\"\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (!doContinue) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst privateTradeId = foundry.utils.randomID();\r\n\t\tconst publicTradeId = foundry.utils.randomID();\r\n\r\n\t\t// Spawn a cancel dialog\r\n\t\tconst cancelDialog = new Dialog({\r\n\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Trade.Title\"),\r\n\t\t\tcontent: `<p style=\"text-align: center\">${game.i18n.format(\"ITEM-PILES.Trade.OngoingRequest.Content\", { user_name: game.users.get(userId).name })}</p>`,\r\n\t\t\tbuttons: {\r\n\t\t\t\tconfirm: {\r\n\t\t\t\t\ticon: '<i class=\"fas fa-times\"></i>',\r\n\t\t\t\t\tlabel: game.i18n.localize(\"ITEM-PILES.Trade.OngoingRequest.Label\"),\r\n\t\t\t\t\tcallback: () => {\r\n\t\t\t\t\t\tItemPileSocket.executeAsUser(ItemPileSocket.HANDLERS.TRADE_REQUEST_CANCELLED, userId, game.user.id, privateTradeId);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\ttop: 50, width: 300\r\n\t\t}).render(true);\r\n\r\n\t\t// Send out the request\r\n\t\treturn ItemPileSocket.executeAsUser(ItemPileSocket.HANDLERS.TRADE_REQUEST_PROMPT, userId, game.user.id, actor.uuid, privateTradeId, publicTradeId, isPrivate)\r\n\t\t\t.then(async (data) => {\r\n\r\n\t\t\t\tif (data === \"cancelled\") return;\r\n\t\t\t\tcancelDialog.close();\r\n\r\n\t\t\t\tif (data === \"same-actor\") {\r\n\t\t\t\t\treturn Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.SameActor\"), true);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If they declined, show warning\r\n\t\t\t\tif (!data || !data.fullPrivateTradeId.includes(privateTradeId)) {\r\n\t\t\t\t\treturn Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.Declined\"), true);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst traderActor = Utilities.getActor(data.actorUuid);\r\n\r\n\t\t\t\tif (traderActor === actor) {\r\n\t\t\t\t\treturn Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.SameActor\"), true);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst store = new TradeStore(game.user.id, {\r\n\t\t\t\t\tuser: game.user, actor\r\n\t\t\t\t}, {\r\n\t\t\t\t\tuser: game.users.get(userId), actor: traderActor\r\n\t\t\t\t}, data.fullPublicTradeId, data.fullPrivateTradeId, isPrivate);\r\n\r\n\t\t\t\tconst [actorSheet, tradeApp] = Helpers.getApplicationPositions(actor.sheet);\r\n\r\n\t\t\t\tconst app = new TradingApp(store, tradeApp).render(true);\r\n\r\n\t\t\t\tongoingTrades.set(data.fullPublicTradeId, { app, store });\r\n\r\n\t\t\t\tactorSheet.byassItemPiles = true;\r\n\t\t\t\tactor.sheet.render(true, actorSheet);\r\n\r\n\t\t\t\tif (isPrivate) {\r\n\t\t\t\t\treturn ItemPileSocket.callHookForUsers(CONSTANTS.HOOKS.TRADE.STARTED, [game.user.id, userId], {\r\n\t\t\t\t\t\tuser: game.user.id, actor: actor.uuid\r\n\t\t\t\t\t}, { user: userId, actor: data.actorUuid }, data.fullPublicTradeId, isPrivate);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn ItemPileSocket.callHook(CONSTANTS.HOOKS.TRADE.STARTED, {\r\n\t\t\t\t\tuser: game.user.id, actor: actor.uuid\r\n\t\t\t\t}, { user: userId, actor: data.actorUuid }, data.fullPublicTradeId, isPrivate);\r\n\r\n\t\t\t}).catch((err) => {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\t// If the counterparty disconnected, show that and close dialog\r\n\t\t\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.Disconnected\"), true);\r\n\t\t\t\tcancelDialog.close()\r\n\t\t\t});\r\n\r\n\t}\r\n\r\n\tstatic async _respondPrompt(tradingUserId, tradingActorUuid, privateTradeId, publicTradeId, isPrivate) {\r\n\r\n\t\t// If the user was previously muted, wait for a random amount of time and respond with false\r\n\t\tif (mutedUsers.has(tradingUserId)) {\r\n\t\t\tawait Helpers.wait(Math.random() * 15000);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Complete the private and public trade IDs\r\n\t\tconst fullPrivateTradeId = privateTradeId + foundry.utils.randomID();\r\n\t\tconst fullPublicTradeId = publicTradeId + foundry.utils.randomID();\r\n\r\n\t\tconst tradingUser = game.users.get(tradingUserId);\r\n\t\tconst tradingActor = Utilities.getActor(tradingActorUuid);\r\n\r\n\t\t// Make em pick an actor (if more than one) and accept/decline/mute\r\n\t\tconst result = await TradeRequestDialog.show({ tradeId: privateTradeId, tradingUser, tradingActor, isPrivate });\r\n\r\n\t\tif (!result) return false;\r\n\r\n\t\tif (result === \"cancelled\") {\r\n\t\t\treturn \"cancelled\";\r\n\t\t}\r\n\r\n\t\t// If muted, add user to blacklist locally\r\n\t\tif (result === \"mute\") {\r\n\t\t\tmutedUsers.push(tradingUserId);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst actor = result.actor ?? result;\r\n\r\n\t\tif (actor === tradingActor) {\r\n\t\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.SameActor\"), true);\r\n\t\t\treturn \"same-actor\";\r\n\t\t}\r\n\r\n\t\tconst store = new TradeStore(tradingUserId, {\r\n\t\t\tuser: game.user, actor\r\n\t\t}, {\r\n\t\t\tuser: tradingUser, actor: tradingActor\r\n\t\t}, fullPublicTradeId, fullPrivateTradeId, isPrivate);\r\n\r\n\t\tconst [actorSheet, tradeApp] = Helpers.getApplicationPositions(actor.sheet);\r\n\r\n\t\tconst app = new TradingApp(store, tradeApp).render(true);\r\n\r\n\t\tongoingTrades.set(fullPublicTradeId, { app, store });\r\n\r\n\t\tactorSheet.byassItemPiles = true;\r\n\t\tactor.sheet.render(true, actorSheet);\r\n\r\n\t\treturn {\r\n\t\t\tfullPrivateTradeId, fullPublicTradeId, actorUuid: result.uuid\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tstatic getAppOptions(actor) {\r\n\t\tconst midPoint = (window.innerWidth / 2) - 200;\r\n\t\treturn {\r\n\t\t\tactorSheet: { left: midPoint - actor.sheet.position.width - 25 }, tradeApp: { left: midPoint + 25 }\r\n\t\t}\r\n\t}\r\n\r\n\tstatic async _tradeCancelled(userId, privateTradeId) {\r\n\r\n\t\tTJSDialog.prompt({\r\n\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Trade.Title\"), content: {\r\n\t\t\t\tclass: CustomDialog, props: {\r\n\t\t\t\t\theader: game.i18n.localize(\"ITEM-PILES.Trade.Title\"),\r\n\t\t\t\t\tcontent: game.i18n.format(\"ITEM-PILES.Trade.CancelledRequest.Content\", { user_name: game.users.get(userId).name }),\r\n\t\t\t\t\ticon: \"fas fa-exclamation-triangle\"\r\n\t\t\t\t}\r\n\t\t\t}, modal: true, draggable: false, options: {\r\n\t\t\t\theight: \"auto\"\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn TradeRequestDialog.cancel(privateTradeId);\r\n\r\n\t}\r\n\r\n\tstatic async _requestTradeData({ tradeId, tradeUser } = {}) {\r\n\r\n\t\tconst ongoingTrade = this._getOngoingTrade(tradeId);\r\n\t\tif (ongoingTrade) {\r\n\t\t\treturn ongoingTrade.store.export();\r\n\t\t}\r\n\r\n\t\tconst user = game.users.get(tradeUser);\r\n\t\tif (!user?.active) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst ongoingTradeData = await ItemPileSocket.executeAsUser(ItemPileSocket.HANDLERS.REQUEST_TRADE_DATA, tradeUser, tradeId, game.user.id);\r\n\t\tif (!ongoingTradeData) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn ongoingTradeData;\r\n\r\n\t}\r\n\r\n\tstatic async _spectateTrade({ tradeId, tradeUser } = {}) {\r\n\r\n\t\tconst existingApp = TradingApp.getActiveApp(tradeId);\r\n\t\tif (existingApp) {\r\n\t\t\treturn existingApp.render(false, { focus: true });\r\n\t\t}\r\n\r\n\t\tconst ongoingTradeData = await this._requestTradeData({ tradeId, tradeUser });\r\n\t\tif (!ongoingTradeData) {\r\n\t\t\tif (Helpers.isGMConnected()) {\r\n\t\t\t\tItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.DISABLE_CHAT_TRADE_BUTTON, tradeId);\r\n\t\t\t}\r\n\t\t\treturn Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.Over\"), true);\r\n\t\t}\r\n\r\n\t\tconst store = TradeStore.import(ongoingTradeData);\r\n\r\n\t\tconst app = new TradingApp(store).render(true);\r\n\r\n\t\tongoingTrades.set(store.publicTradeId, { app, store });\r\n\r\n\t}\r\n\r\n\tstatic async _respondActiveTradeData(tradeId, requesterId) {\r\n\t\tconst trade = this._getOngoingTrade(tradeId, requesterId);\r\n\t\tif (!trade) return;\r\n\t\treturn trade.store.export();\r\n\t}\r\n\r\n\tstatic _getOngoingTrade(tradeId, requesterId = game.user.id) {\r\n\t\tif (!ongoingTrades.has(tradeId)) return false;\r\n\t\tconst trade = ongoingTrades.get(tradeId);\r\n\t\tif (!trade.store.isPrivate) {\r\n\t\t\treturn trade;\r\n\t\t}\r\n\t\tif (trade.store.leftTraderUser.id !== requesterId && trade.store.rightTraderUser.id !== requesterId) return false;\r\n\t\treturn trade;\r\n\t}\r\n\r\n\tstatic async _updateItems(tradeId, userId, items) {\r\n\t\tconst trade = this._getOngoingTrade(tradeId);\r\n\t\tif (!trade) return;\r\n\t\ttrade.store.updateItems(userId, items);\r\n\t}\r\n\r\n\tstatic async _updateItemCurrencies(tradeId, userId, items) {\r\n\t\tconst trade = this._getOngoingTrade(tradeId);\r\n\t\tif (!trade) return;\r\n\t\ttrade.store.updateItemCurrencies(userId, items);\r\n\t}\r\n\r\n\tstatic async _updateCurrencies(tradeId, userId, currencies) {\r\n\t\tconst trade = this._getOngoingTrade(tradeId);\r\n\t\tif (!trade) return;\r\n\t\ttrade.store.updateCurrencies(userId, currencies);\r\n\t}\r\n\r\n\tstatic async _updateAcceptedState(tradeId, userId, status) {\r\n\t\tconst trade = this._getOngoingTrade(tradeId);\r\n\t\tif (!trade) return;\r\n\t\ttrade.store.updateAcceptedState(userId, status);\r\n\t\tif (userId === game.user.id && (trade.store.leftTraderUser.id === game.user.id || trade.store.rightTraderUser.id === game.user.id)) {\r\n\t\t\tif (trade.store.tradeIsAccepted) {\r\n\t\t\t\tsetTimeout(async () => {\r\n\t\t\t\t\tif (trade.store.tradeIsAccepted) {\r\n\t\t\t\t\t\tItemPileSocket.executeForUsers(\r\n\t\t\t\t\t\t\tItemPileSocket.HANDLERS.EXECUTE_TRADE,\r\n\t\t\t\t\t\t\t[trade.store.leftTraderUser.id, trade.store.rightTraderUser.id],\r\n\t\t\t\t\t\t\ttrade.store.publicTradeId,\r\n\t\t\t\t\t\t\ttrade.store.privateTradeId,\r\n\t\t\t\t\t\t\tuserId);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 2000);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tstatic async _userDisconnected() {\r\n\t\tconst tradesToDelete = [];\r\n\t\tconst activeUsers = game.users.filter(user => user.active);\r\n\t\tfor (let [tradeId, trade] of ongoingTrades) {\r\n\t\t\tconst foundLeft = activeUsers.find(u => u === trade.store.leftTraderUser);\r\n\t\t\tconst foundRight = activeUsers.find(u => u === trade.store.rightTraderUser);\r\n\t\t\tif (foundLeft && foundRight) continue;\r\n\t\t\ttradesToDelete.push(tradeId);\r\n\t\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.Disconnected\"), true);\r\n\t\t\tawait trade.app.close({ callback: true });\r\n\t\t\tif (foundLeft === game.user || foundRight === game.user) {\r\n\t\t\t\tif (Helpers.isGMConnected()) {\r\n\t\t\t\t\tawait ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.DISABLE_CHAT_TRADE_BUTTON, tradeId);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\ttradesToDelete.forEach(tradeId => ongoingTrades.delete(tradeId));\r\n\t}\r\n\r\n\tstatic async _tradeClosed(tradeId, closeUserId) {\r\n\t\tconst trade = this._getOngoingTrade(tradeId);\r\n\t\tif (!trade) return;\r\n\r\n\t\tif (trade.store.leftTraderUser.id === game.user.id || trade.store.rightTraderUser.id === game.user.id) {\r\n\r\n\t\t\tif (closeUserId === trade.store.rightTraderUser.id) {\r\n\r\n\t\t\t\tTJSDialog.prompt({\r\n\t\t\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Trade.Closed.Title\"), content: {\r\n\t\t\t\t\t\tclass: CustomDialog, props: {\r\n\t\t\t\t\t\t\theader: game.i18n.localize(\"ITEM-PILES.Trade.Closed.Title\"),\r\n\t\t\t\t\t\t\tcontent: game.i18n.format(\"ITEM-PILES.Trade.Closed.Them\", {\r\n\t\t\t\t\t\t\t\tuser_name: trade.store.rightTraderUser.name\r\n\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\ticon: \"fas fa-exclamation-triangle\",\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, modal: false, draggable: true, options: {\r\n\t\t\t\t\t\theight: \"auto\"\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif (trade.store.isPrivate) {\r\n\t\t\t\t\tconst otherUserId = trade.store.leftTraderUser.id === game.user.id ? trade.store.rightTraderUser.id : trade.store.leftTraderUser.id;\r\n\t\t\t\t\tItemPileSocket.executeAsUser(ItemPileSocket.HANDLERS.TRADE_CLOSED, otherUserId, tradeId, game.user.id);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tItemPileSocket.executeForOthers(ItemPileSocket.HANDLERS.TRADE_CLOSED, tradeId, game.user.id);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tTJSDialog.prompt({\r\n\t\t\t\t\ttitle: game.i18n.localize(\"ITEM-PILES.Trade.Closed.Title\"), content: {\r\n\t\t\t\t\t\tclass: CustomDialog, props: {\r\n\t\t\t\t\t\t\theader: game.i18n.localize(\"ITEM-PILES.Trade.Closed.Title\"),\r\n\t\t\t\t\t\t\tcontent: game.i18n.format(\"ITEM-PILES.Trade.Closed.You\"),\r\n\t\t\t\t\t\t\ticon: \"fas fa-exclamation-triangle\",\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, modal: false, draggable: true, options: {\r\n\t\t\t\t\t\theight: \"auto\"\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (Helpers.isGMConnected()) {\r\n\t\t\t\t\tawait ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.DISABLE_CHAT_TRADE_BUTTON, tradeId);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tHelpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Trade.Closed.Someone\"), true);\r\n\r\n\t\t}\r\n\r\n\t\ttrade.app.close({ callback: true });\r\n\t\tongoingTrades.delete(tradeId);\r\n\t}\r\n\r\n\tstatic async _executeTrade(tradeId, privateId, userId) {\r\n\t\tconst trade = this._getOngoingTrade(tradeId);\r\n\t\tif (!trade) return;\r\n\t\tif (trade.store.privateTradeId !== privateId) return;\r\n\t\tconst updates = trade.store.getTradeData();\r\n\r\n\t\tconst itemsToAdd = [];\r\n\t\tfor (const entry of updates.add.items) {\r\n\t\t\tlet item = updates.targetActor.items.get(entry.id);\r\n\t\t\tif (!item) {\r\n\t\t\t\titem = await fromUuid(entry.uuid);\r\n\t\t\t\tif (!item) continue;\r\n\t\t\t}\r\n\t\t\tconst itemData = item.toObject();\r\n\t\t\titemsToAdd.push(Utilities.setItemQuantity(itemData, entry.quantity, true));\r\n\t\t}\r\n\r\n\t\tconst itemsToRemove = []\r\n\t\tfor (const entry of updates.remove.items) {\r\n\t\t\tconst item = updates.sourceActor.items.get(entry.id);\r\n\t\t\tif (!item) continue;\r\n\t\t\tconst itemData = item.toObject();\r\n\t\t\titemsToRemove.push(Utilities.setItemQuantity(itemData, entry.quantity, true));\r\n\t\t}\r\n\r\n\t\tconst transaction = new Transaction(updates.sourceActor);\r\n\t\tawait transaction.appendItemChanges(itemsToAdd);\r\n\t\tawait transaction.appendItemChanges(itemsToRemove, { remove: true });\r\n\t\tawait transaction.appendDocumentChanges(updates.add.attributes);\r\n\t\tawait transaction.appendDocumentChanges(updates.remove.attributes, { remove: true });\r\n\t\tawait transaction.commit();\r\n\r\n\t\tif (trade.store.isPrivate) {\r\n\t\t\tHooks.callAll(CONSTANTS.HOOKS.TRADE.COMPLETE, trade.store.instigator, data[0], data[1], tradeId);\r\n\t\t\ttrade.app.close({ callback: true });\r\n\t\t\tongoingTrades.delete(tradeId);\r\n\t\t} else if (userId === game.user.id) {\r\n\t\t\tif (Helpers.isGMConnected()) {\r\n\t\t\t\tawait ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.DISABLE_CHAT_TRADE_BUTTON, tradeId);\r\n\t\t\t}\r\n\t\t\treturn ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.TRADE_COMPLETED, tradeId, updates);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic async _tradeCompleted(tradeId) {\r\n\t\tconst trade = this._getOngoingTrade(tradeId);\r\n\t\tif (!trade) return;\r\n\t\tconst data = trade.store.export();\r\n\t\tif (data.instigator === game.user.id) {\r\n\t\t\tif (trade.store.isPrivate) {\r\n\t\t\t\tHooks.callAll(CONSTANTS.HOOKS.TRADE.COMPLETE, data.instigator, data.leftTraderData, data.rightTraderData, tradeId);\r\n\t\t\t} else {\r\n\t\t\t\tItemPileSocket.executeForEveryone(\r\n\t\t\t\t\tItemPileSocket.HANDLERS.CALL_HOOK,\r\n\t\t\t\t\tCONSTANTS.HOOKS.TRADE.COMPLETE,\r\n\t\t\t\t\ttrade.store.instigator,\r\n\t\t\t\t\tdata.leftTraderData,\r\n\t\t\t\t\tdata.rightTraderData,\r\n\t\t\t\t\ttradeId,\r\n\t\t\t\t\ttrade.store.isPrivate\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\ttrade.app.close({ callback: true });\r\n\t\tongoingTrades.delete(tradeId);\r\n\t}\r\n\r\n}\r\n\r\n","import SETTINGS from \"../constants/settings.js\";\r\nimport * as Helpers from \"../helpers/helpers.js\";\r\nimport CONSTANTS from \"../constants/constants.js\";\r\nimport ItemPileSocket from \"../socket.js\";\r\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\r\nimport * as Utilities from \"../helpers/utilities.js\";\r\nimport TradeAPI from \"./trade-api.js\";\r\n\r\nlet CHAT_MESSAGE_STYLES = false;\r\n\r\nexport default class ChatAPI {\r\n\r\n\tstatic initialize() {\r\n\r\n\t\tHelpers.hooks.on(\"preCreateChatMessage\", this._preCreateChatMessage.bind(this));\r\n\t\tHelpers.hooks.on(\"renderChatMessage\", this._renderChatMessage.bind(this));\r\n\t\tHelpers.hooks.on(CONSTANTS.HOOKS.ITEM.TRANSFER, this._outputTransferItem.bind(this));\r\n\t\tHelpers.hooks.on(CONSTANTS.HOOKS.ATTRIBUTE.TRANSFER, this._outputTransferCurrency.bind(this));\r\n\t\tHelpers.hooks.on(CONSTANTS.HOOKS.TRANSFER_EVERYTHING, this._outputTransferEverything.bind(this));\r\n\t\tHelpers.hooks.on(CONSTANTS.HOOKS.PILE.SPLIT_INVENTORY, this._outputSplitItemPileInventory.bind(this));\r\n\t\tHelpers.hooks.on(CONSTANTS.HOOKS.TRADE.STARTED, this._outputTradeStarted.bind(this));\r\n\t\tHelpers.hooks.on(CONSTANTS.HOOKS.TRADE.COMPLETE, this._outputTradeComplete.bind(this));\r\n\t\tHelpers.hooks.on(CONSTANTS.HOOKS.ITEM.TRADE, this._outputMerchantTradeComplete.bind(this));\r\n\t\tHelpers.hooks.on(CONSTANTS.HOOKS.ITEM.GIVE, this._outputGiveItem.bind(this));\r\n\r\n\t\t$(document).on(\"click\", \".item-piles-chat-card .item-piles-collapsible\", async function () {\r\n\t\t\tif ($(this).attr(\"open\")) return;\r\n\t\t\tawait Helpers.wait(25);\r\n\t\t\t$(this).parent()[0].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' });\r\n\t\t});\r\n\r\n\t\tCHAT_MESSAGE_STYLES = CONSTANTS.IS_V12 ? CONST.CHAT_MESSAGE_STYLES : CONST.CHAT_MESSAGE_TYPES;\r\n\r\n\t}\r\n\r\n\tstatic _preCreateChatMessage(chatMessage) {\r\n\r\n\t\tif (!Helpers.getSetting(SETTINGS.ENABLE_TRADING)) return;\r\n\r\n\t\tconst content = chatMessage.content.toLowerCase();\r\n\r\n\t\tif (!(content.startsWith(\"!itempiles\") || content.startsWith(\"!ip\"))) return;\r\n\r\n\t\tconst args = content.split(\" \").slice(1);\r\n\r\n\t\tif (args[0] === \"trade\") {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tgame.itempiles.API.requestTrade();\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\tstatic _renderChatMessage(app, html) {\r\n\t\thtml.find(\".item-piles-specate-trade\").click(function () {\r\n\t\t\tgame.itempiles.API.spectateTrade($(this).data());\r\n\t\t});\r\n\t}\r\n\r\n\tstatic _disableTradingButton(publicTradeId) {\r\n\t\tconst message = Array.from(game.messages).find(message => {\r\n\t\t\treturn foundry.utils.getProperty(message, CONSTANTS.FLAGS.PUBLIC_TRADE_ID) === publicTradeId;\r\n\t\t});\r\n\t\tif (!message) return;\r\n\t\tconst update = this._replaceChatContent(message);\r\n\t\treturn message.update(update)\r\n\t}\r\n\r\n\tstatic async disablePastTradingButtons() {\r\n\t\tif (!game.user.isGM) return;\r\n\r\n\t\tconst messages = Array.from(game.messages).filter(message => {\r\n\t\t\treturn foundry.utils.getProperty(message, CONSTANTS.FLAGS.PUBLIC_TRADE_ID);\r\n\t\t});\r\n\r\n\t\tif (!messages.length) return;\r\n\t\tconst updates = [];\r\n\t\tfor (let message of messages) {\r\n\t\t\tconst update = this._replaceChatContent(message);\r\n\t\t\tconst tradeId = foundry.utils.getProperty(message, CONSTANTS.FLAGS.PUBLIC_TRADE_ID);\r\n\t\t\tconst tradeUsers = foundry.utils.getProperty(message, CONSTANTS.FLAGS.TRADE_USERS);\r\n\t\t\tconst bothUsersActive = tradeUsers.filter(userId => game.users.get(userId).active).length === tradeUsers.length;\r\n\t\t\tif (!bothUsersActive) {\r\n\t\t\t\tupdates.push(update);\r\n\t\t\t} else {\r\n\t\t\t\tconst otherUsers = tradeUsers.filter(userId => userId !== game.user.id);\r\n\t\t\t\tconst tradeData = await TradeAPI._requestTradeData({ tradeId, tradeUser: otherUsers[0] });\r\n\t\t\t\tif (!tradeData) {\r\n\t\t\t\t\tupdates.push(update);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!updates.length) return;\r\n\r\n\t\treturn ChatMessage.updateDocuments(updates);\r\n\r\n\t}\r\n\r\n\tstatic _replaceChatContent(message) {\r\n\t\tconst tradeId = foundry.utils.getProperty(message, CONSTANTS.FLAGS.PUBLIC_TRADE_ID);\r\n\t\tconst stringToFind = `data-trade-id=\"${tradeId}\"`;\r\n\t\tlet content = message.content;\r\n\t\tcontent = content.replace(stringToFind, \"\");\r\n\t\tcontent = content.replace(stringToFind, \"disabled\");\r\n\t\tcontent = content.replace(game.i18n.localize(\"ITEM-PILES.Chat.TradeSpectate\"), game.i18n.localize(\"ITEM-PILES.Chat.SpectateDisabled\"));\r\n\t\treturn {\r\n\t\t\t_id: message.id,\r\n\t\t\tcontent,\r\n\t\t\t[`flags.-=${CONSTANTS.MODULE_NAME}`]: null\r\n\t\t};\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Outputs to chat based on transferring an item from or to an item pile\r\n\t *\r\n\t * @param source\r\n\t * @param target\r\n\t * @param items\r\n\t * @param userId\r\n\t * @param interactionId\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async _outputTransferItem(source, target, items, userId, interactionId) {\r\n\t\tif (!PileUtilities.isItemPileLootable(source)) return;\r\n\t\tif (!interactionId || game.user.id !== userId || !Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n\t\tconst [itemData, itemCurrencies] = await this._formatItemData(source, items);\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.PICKUP_CHAT_MESSAGE, source.uuid, target.uuid, itemData, itemCurrencies, userId, interactionId);\r\n\t}\r\n\r\n\t/**\r\n\t * Outputs to chat based on transferring a currency from or to an item pile\r\n\t *\r\n\t * @param source\r\n\t * @param target\r\n\t * @param currencies\r\n\t * @param userId\r\n\t * @param interactionId\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async _outputTransferCurrency(source, target, currencies, userId, interactionId) {\r\n\t\tif (!PileUtilities.isItemPileLootable(source)) return;\r\n\t\tif (!interactionId || game.user.id !== userId || !Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n\t\tconst currencyData = this._formatCurrencyData(source, currencies);\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.PICKUP_CHAT_MESSAGE, source.uuid, target.uuid, [], currencyData, userId, interactionId);\r\n\t}\r\n\r\n\t/**\r\n\t * Outputs to chat based on giving an item from one actor to another\r\n\t *\r\n\t * @param source\r\n\t * @param target\r\n\t * @param item\r\n\t * @param userId\r\n\t * @param targetUserId\r\n\t * @param secret\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async _outputGiveItem(source, target, item, userId, targetUserId, secret) {\r\n\t\tif (game.user.id !== userId || !Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n\t\tconst [itemData, itemCurrencies] = await this._formatItemData(source, [item]);\r\n\t\treturn this._giveChatMessage(source, target, itemData.concat(itemCurrencies), userId, targetUserId, secret);\r\n\t}\r\n\r\n\t/**\r\n\t * Outputs to chat based on transferring everything from or to an item pile\r\n\t *\r\n\t * @param source\r\n\t * @param target\r\n\t * @param items\r\n\t * @param currencies\r\n\t * @param userId\r\n\t * @param interactionId\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async _outputTransferEverything(source, target, items, currencies, userId, interactionId) {\r\n\t\tif (!PileUtilities.isItemPileLootable(source)) return;\r\n\t\tif (!interactionId || game.user.id !== userId || !Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n\t\tconst [itemData, itemCurrencies] = await this._formatItemData(source, items);\r\n\t\tconst currencyData = this._formatCurrencyData(source, currencies).concat(itemCurrencies);\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.PICKUP_CHAT_MESSAGE, source.uuid, target.uuid, itemData, currencyData, userId, interactionId);\r\n\t}\r\n\r\n\tstatic _outputSplitItemPileInventory(source, pileDeltas, actorDeltas, userId) {\r\n\t\tif (!PileUtilities.isItemPileLootable(source)) return;\r\n\t\tif (game.user.id !== userId || !Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.SPLIT_CHAT_MESSAGE, source.uuid, pileDeltas, actorDeltas, userId);\r\n\t}\r\n\r\n\tstatic async _outputTradeStarted(party_1, party_2, publicTradeId, isPrivate) {\r\n\t\tif (party_1.user !== game.user.id || !Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT) || isPrivate) return;\r\n\t\treturn this._outputTradeStartedToChat(party_1, party_2, publicTradeId);\r\n\t}\r\n\r\n\tstatic async _outputTradeComplete(instigator, party_1, party_2, publicTradeId, isPrivate) {\r\n\t\tif (!Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n\t\treturn this._outputTradeCompleteToChat(instigator, party_1, party_2, publicTradeId, isPrivate);\r\n\t}\r\n\r\n\tstatic async _outputMerchantTradeComplete(source, target, priceInformation, userId, interactionId) {\r\n\t\tif (!Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n\t\tif (!PileUtilities.isItemPileMerchant(source)) return;\r\n\t\tif (!interactionId || game.user.id !== userId || !Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT)) return;\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.MERCHANT_TRADE_CHAT_MESSAGE, source.uuid, target.uuid, priceInformation, userId, interactionId);\r\n\t}\r\n\r\n\t/**\r\n\t * Formats item data to a chat friendly structure\r\n\t *\r\n\t * @param itemPile\r\n\t * @param items\r\n\t * @param divideBy\r\n\t * @returns {Promise<Array>}\r\n\t */\r\n\tstatic async _formatItemData(itemPile, items, divideBy = 1) {\r\n\t\tconst formattedItems = [];\r\n\t\tconst formattedCurrencies = [];\r\n\t\tconst currencyList = PileUtilities.getActorCurrencies(itemPile, { getAll: true });\r\n\t\tfor (const itemData of items) {\r\n\t\t\tconst tempItem = new Item.implementation(itemData.item);\r\n\t\t\tconst data = {\r\n\t\t\t\tname: game.i18n.localize(tempItem.name),\r\n\t\t\t\timg: tempItem.img ?? itemData?.item?.img ?? \"\",\r\n\t\t\t\tquantity: Math.abs(itemData.quantity) / divideBy\r\n\t\t\t};\r\n\t\t\tif (PileUtilities.isItemCurrency(tempItem, { actorCurrencies: currencyList })) {\r\n\t\t\t\tformattedCurrencies.push(data)\r\n\t\t\t} else {\r\n\t\t\t\tformattedItems.push(data);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn [formattedItems, formattedCurrencies];\r\n\t}\r\n\r\n\t/**\r\n\t * Formats currency data to a chat friendly structure\r\n\t *\r\n\t * @param itemPile\r\n\t * @param currencies\r\n\t * @param divideBy\r\n\t * @returns {Array}\r\n\t */\r\n\tstatic _formatCurrencyData(itemPile, currencies, divideBy = 1) {\r\n\t\tconst currencyList = PileUtilities.getActorCurrencies(itemPile, { getAll: true });\r\n\t\treturn Object.entries(currencies).map(entry => {\r\n\t\t\tconst currency = currencyList.find(currency => currency.id === entry[0]);\r\n\t\t\treturn {\r\n\t\t\t\tname: game.i18n.localize(currency.name),\r\n\t\t\t\timg: currency.img ?? \"\",\r\n\t\t\t\tquantity: Math.abs(entry[1]) / divideBy,\r\n\t\t\t\tindex: currencyList.indexOf(currency)\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Outputs the transferred data in chat\r\n\t *\r\n\t * @param sourceUuid\r\n\t * @param targetUuid\r\n\t * @param items\r\n\t * @param currencies\r\n\t * @param userId\r\n\t * @param interactionId\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async _outputPickupToChat(sourceUuid, targetUuid, items, currencies, userId, interactionId) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(sourceUuid);\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst now = (+new Date());\r\n\r\n\t\t// Get all messages younger than 3 hours, and grab the last 10, then reverse them (latest to oldest)\r\n\t\tconst messages = Array.from(game.messages).filter(message => (now - message.timestamp) <= (10800000)).slice(-10);\r\n\t\tmessages.reverse()\r\n\r\n\t\tfor (const message of messages) {\r\n\t\t\tconst flags = foundry.utils.getProperty(message, CONSTANTS.FLAGS.PILE);\r\n\t\t\tif (flags && flags.version && !foundry.utils.isNewerVersion(Helpers.getModuleVersion(), flags.version) && flags.source === sourceUuid && flags.target === targetUuid && flags.interactionId === interactionId) {\r\n\t\t\t\treturn this._updateExistingPickupMessage(message, sourceActor, targetActor, items, currencies, interactionId)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/looted.html\", {\r\n\t\t\tmessage: game.i18n.format(\"ITEM-PILES.Chat.Pickup\", { name: targetActor.name }),\r\n\t\t\titemPile: sourceActor,\r\n\t\t\tactor: targetActor,\r\n\t\t\titems: items,\r\n\t\t\tcurrencies: currencies\r\n\t\t});\r\n\r\n\t\treturn this._createNewChatMessage(userId, {\r\n\t\t\tuser: game.user.id,\r\n\t\t\ttype: CHAT_MESSAGE_STYLES.OTHER,\r\n\t\t\tcontent: chatCardHtml,\r\n\t\t\tflavor: \"Item Piles\",\r\n\t\t\tspeaker: ChatMessage.getSpeaker({ alias: game.user.name }),\r\n\t\t\t[CONSTANTS.FLAGS.PILE]: {\r\n\t\t\t\tversion: Helpers.getModuleVersion(),\r\n\t\t\t\tsource: sourceUuid,\r\n\t\t\t\ttarget: targetUuid,\r\n\t\t\t\titems: items,\r\n\t\t\t\tcurrencies: currencies,\r\n\t\t\t\tinteractionId: interactionId\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t}\r\n\r\n\tstatic _matchEntries(existingEntries, incomingEntries) {\r\n\r\n\t\tconst combinedEntries = existingEntries.map(existingEntry => {\r\n\t\t\tconst foundEntry = incomingEntries.find(item => item.name === existingEntry.name && existingEntry.img === item.img);\r\n\t\t\tif (foundEntry) {\r\n\t\t\t\texistingEntry.quantity += foundEntry.quantity;\r\n\t\t\t\tincomingEntries.splice(incomingEntries.indexOf(foundEntry), 1)\r\n\t\t\t}\r\n\t\t\treturn existingEntry;\r\n\t\t});\r\n\r\n\t\tincomingEntries.forEach(item => combinedEntries.push(item));\r\n\r\n\t\treturn combinedEntries;\r\n\r\n\t}\r\n\r\n\tstatic async _updateExistingPickupMessage(message, sourceActor, targetActor, items, currencies, interactionId) {\r\n\r\n\t\tconst flags = foundry.utils.getProperty(message, CONSTANTS.FLAGS.PILE);\r\n\r\n\t\tconst newItems = this._matchEntries(flags.items, items);\r\n\t\tconst newCurrencies = this._matchEntries(flags.currencies, currencies);\r\n\r\n\t\tnewCurrencies.sort((a, b) => {\r\n\t\t\treturn a.index - b.index;\r\n\t\t})\r\n\r\n\t\tconst chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/looted.html\", {\r\n\t\t\tmessage: game.i18n.format(\"ITEM-PILES.Chat.Pickup\", { name: targetActor.name }),\r\n\t\t\titemPile: sourceActor,\r\n\t\t\tactor: targetActor,\r\n\t\t\titems: newItems,\r\n\t\t\tcurrencies: newCurrencies\r\n\t\t});\r\n\r\n\t\treturn message.update({\r\n\t\t\tcontent: chatCardHtml,\r\n\t\t\t[`${CONSTANTS.FLAGS.PILE}.interactionId`]: interactionId,\r\n\t\t\t[`${CONSTANTS.FLAGS.PILE}.items`]: newItems,\r\n\t\t\t[`${CONSTANTS.FLAGS.PILE}.currencies`]: newCurrencies,\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tstatic async _outputSplitToChat(sourceUuid, pileDeltas, actorDeltas, userId) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(sourceUuid);\r\n\r\n\t\tconst divideBy = Object.values(actorDeltas).length;\r\n\r\n\t\tconst [items, itemCurrencies] = await this._formatItemData(sourceActor, pileDeltas.itemDeltas, divideBy);\r\n\t\tconst currencies = this._formatCurrencyData(sourceActor, pileDeltas.attributeDeltas, divideBy).concat(itemCurrencies);\r\n\r\n\t\tconst chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/looted.html\", {\r\n\t\t\tmessage: game.i18n.format(\"ITEM-PILES.Chat.Split\", { num_players: divideBy }),\r\n\t\t\titemPile: sourceActor,\r\n\t\t\titems: items,\r\n\t\t\tcurrencies: currencies\r\n\t\t});\r\n\r\n\t\treturn this._createNewChatMessage(userId, {\r\n\t\t\tuser: game.user.id,\r\n\t\t\ttype: CHAT_MESSAGE_STYLES.OTHER,\r\n\t\t\tcontent: chatCardHtml,\r\n\t\t\tflavor: \"Item Piles\",\r\n\t\t\tspeaker: ChatMessage.getSpeaker({ alias: game.user.name })\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tstatic async _outputTradeStartedToChat(party_1, party_2, publicTradeId) {\r\n\r\n\t\tconst party_1_actor = Utilities.getActor(party_1.actor);\r\n\t\tconst party_2_actor = Utilities.getActor(party_2.actor);\r\n\r\n\t\tconst chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/trade-started.html\", {\r\n\t\t\tparty_1_actor,\r\n\t\t\tparty_2_actor,\r\n\t\t\tpublicTradeId,\r\n\t\t\tuserId: game.user.id\r\n\t\t});\r\n\r\n\t\treturn this._createNewChatMessage(game.user.id, {\r\n\t\t\tuser: game.user.id,\r\n\t\t\ttype: CHAT_MESSAGE_STYLES.OTHER,\r\n\t\t\tcontent: chatCardHtml,\r\n\t\t\tflavor: \"Item Piles\",\r\n\t\t\tspeaker: ChatMessage.getSpeaker({ alias: game.user.name }),\r\n\t\t\t[CONSTANTS.FLAGS.PUBLIC_TRADE_ID]: publicTradeId,\r\n\t\t\t[CONSTANTS.FLAGS.TRADE_USERS]: [party_1.user, party_2.user]\r\n\t\t});\r\n\t}\r\n\r\n\tstatic async _outputTradeCompleteToChat(instigator, party_1, party_2, publicTradeId, isPrivate) {\r\n\r\n\t\tif (instigator !== game.user.id) return;\r\n\r\n\t\tconst party_1_actor = Utilities.getActor(party_1.actor);\r\n\t\tconst party_1_data = {\r\n\t\t\tactor: party_1_actor,\r\n\t\t\titems: party_2.items,\r\n\t\t\tcurrencies: party_2.currencies.concat(party_2.itemCurrencies)\r\n\t\t}\r\n\t\tparty_1_data.got_nothing = !party_1_data.items.length && !party_1_data.currencies.length;\r\n\r\n\t\tconst party_2_actor = Utilities.getActor(party_2.actor);\r\n\t\tconst party_2_data = {\r\n\t\t\tactor: party_2_actor,\r\n\t\t\titems: party_1.items,\r\n\t\t\tcurrencies: party_1.currencies.concat(party_1.itemCurrencies)\r\n\t\t}\r\n\t\tparty_2_data.got_nothing = !party_2_data.items.length && !party_2_data.currencies.length;\r\n\r\n\t\tif (party_1.got_nothing && party_2.got_nothing) return;\r\n\r\n\t\tconst enableCollapse = (party_1_data.items.length + party_1_data.currencies.length + party_2_data.items.length + party_2_data.currencies.length) > 6;\r\n\r\n\t\tconst chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/trade-complete.html\", {\r\n\t\t\tparty_1: party_1_data,\r\n\t\t\tparty_2: party_2_data,\r\n\t\t\tpublicTradeId,\r\n\t\t\tisPrivate,\r\n\t\t\tenableCollapse\r\n\t\t});\r\n\r\n\t\treturn this._createNewChatMessage(game.user.id, {\r\n\t\t\tuser: game.user.id,\r\n\t\t\ttype: isPrivate && !CONSTANTS.IS_V12 ? CHAT_MESSAGE_STYLES.WHISPER : CHAT_MESSAGE_STYLES.OTHER,\r\n\t\t\tcontent: chatCardHtml,\r\n\t\t\tflavor: \"Item Piles\" + (isPrivate ? \": \" + game.i18n.localize(\"ITEM-PILES.Chat.PrivateTrade\") : \"\"),\r\n\t\t\tspeaker: ChatMessage.getSpeaker({ alias: game.user.name }),\r\n\t\t\twhisper: isPrivate ? [party_2.user] : []\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tstatic async _outputMerchantTradeToChat(sourceUuid, targetUuid, priceInformation, userId, interactionId) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(sourceUuid);\r\n\t\tconst targetActor = Utilities.getActor(targetUuid);\r\n\r\n\t\tconst now = (+new Date());\r\n\r\n\t\tpriceInformation.id = foundry.utils.randomID();\r\n\r\n\t\t// Get all messages younger than 3 hours, and grab the last 10, then reverse them (latest to oldest)\r\n\t\tconst messages = Array.from(game.messages).filter(message => (now - message.timestamp) <= (10800000)).slice(-10);\r\n\t\tmessages.reverse();\r\n\r\n\t\tfor (const message of messages) {\r\n\t\t\tconst flags = foundry.utils.getProperty(message, CONSTANTS.FLAGS.PILE);\r\n\t\t\tif (flags && flags.version && !foundry.utils.isNewerVersion(Helpers.getModuleVersion(), flags.version) && flags.source === sourceUuid && flags.target === targetUuid && flags.interactionId === interactionId) {\r\n\t\t\t\treturn this._updateExistingMerchantMessage(message, sourceActor, targetActor, priceInformation, interactionId)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst pileData = PileUtilities.getActorFlagData(sourceActor);\r\n\r\n\t\tconst chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/merchant-traded.html\", {\r\n\t\t\tmessage: game.i18n.format(\"ITEM-PILES.Chat.MerchantTraded\", {\r\n\t\t\t\tname: targetActor.name,\r\n\t\t\t\tmerchant: sourceActor.name\r\n\t\t\t}),\r\n\t\t\tmerchant: {\r\n\t\t\t\tname: sourceActor.name,\r\n\t\t\t\timg: pileData.merchantImage || sourceActor.img\r\n\t\t\t},\r\n\t\t\tactor: targetActor,\r\n\t\t\tpriceInformation: [priceInformation]\r\n\t\t});\r\n\r\n\t\treturn this._createNewChatMessage(userId, {\r\n\t\t\tuser: game.user.id,\r\n\t\t\ttype: CHAT_MESSAGE_STYLES.OTHER,\r\n\t\t\tcontent: chatCardHtml,\r\n\t\t\tflavor: \"Item Piles\",\r\n\t\t\tspeaker: ChatMessage.getSpeaker({ alias: game.user.name }),\r\n\t\t\t[CONSTANTS.FLAGS.PILE]: {\r\n\t\t\t\tversion: Helpers.getModuleVersion(),\r\n\t\t\t\tsource: sourceUuid,\r\n\t\t\t\ttarget: targetUuid,\r\n\t\t\t\tpriceInformation: [priceInformation],\r\n\t\t\t\tinteractionId: interactionId\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tstatic async _giveChatMessage(source, target, items, userId, targetUserId, secret) {\r\n\r\n\t\tconst now = (+new Date());\r\n\r\n\t\tconst sourceActor = Utilities.getActor(source);\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\r\n\t\t// Get all messages younger than 1 minute, and grab the last 5, then reverse them (latest to oldest)\r\n\t\tconst messages = Array.from(game.messages)\r\n\t\t\t.filter(message => (now - message.timestamp) <= (60000))\r\n\t\t\t.slice(-5)\r\n\t\t\t.reverse();\r\n\r\n\t\tfor (const message of messages) {\r\n\t\t\tconst flags = foundry.utils.getProperty(message, CONSTANTS.FLAGS.PILE);\r\n\t\t\tif (flags && flags.version && !foundry.utils.isNewerVersion(Helpers.getModuleVersion(), flags.version) && flags.source === sourceActor.uuid && flags.target === targetActor.uuid && message.isAuthor && (flags.secret === undefined || flags.secret === secret)) {\r\n\t\t\t\treturn this._updateExistingGiveMessage(message, sourceActor, targetActor, items)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/gave-items.html\", {\r\n\t\t\tmessage: game.i18n.format(\"ITEM-PILES.Chat.GaveItems\", { source: sourceActor.name, target: targetActor.name }),\r\n\t\t\tsource: sourceActor,\r\n\t\t\ttarget: targetActor,\r\n\t\t\titems: items\r\n\t\t});\r\n\r\n\t\tconst user = game.users.get(userId);\r\n\r\n\t\tconst chatData = {\r\n\t\t\tuser: user.id,\r\n\t\t\ttype: CHAT_MESSAGE_STYLES.OTHER,\r\n\t\t\tcontent: chatCardHtml,\r\n\t\t\tflavor: \"Item Piles\",\r\n\t\t\tspeaker: ChatMessage.getSpeaker({ alias: user.name }),\r\n\t\t\t[CONSTANTS.FLAGS.PILE]: {\r\n\t\t\t\tversion: Helpers.getModuleVersion(),\r\n\t\t\t\tsource: sourceActor.uuid,\r\n\t\t\t\ttarget: targetActor.uuid,\r\n\t\t\t\titems: items,\r\n\t\t\t\tsecret\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (secret) {\r\n\t\t\tchatData.whisper = Array.from(game.users)\r\n\t\t\t\t.filter(user => user.isGM)\r\n\t\t\t\t.map(user => user.id);\r\n\t\t\tchatData.whisper.push(userId);\r\n\t\t\tchatData.whisper.push(targetUserId);\r\n\t\t\tif (!CONSTANTS.IS_V12) {\r\n\t\t\t\tchatData.type = CHAT_MESSAGE_STYLES.WHISPER;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this._createNewChatMessage(user.id, chatData)\r\n\r\n\t}\r\n\r\n\tstatic async _updateExistingGiveMessage(message, sourceActor, targetActor, items) {\r\n\r\n\t\tconst flags = foundry.utils.getProperty(message, CONSTANTS.FLAGS.PILE);\r\n\r\n\t\tconst newItems = this._matchEntries(flags.items, items);\r\n\r\n\t\tconst chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/gave-items.html\", {\r\n\t\t\tmessage: game.i18n.format(\"ITEM-PILES.Chat.GaveItems\", { source: sourceActor.name, target: targetActor.name }),\r\n\t\t\tsource: sourceActor,\r\n\t\t\ttarget: targetActor,\r\n\t\t\titems: newItems\r\n\t\t});\r\n\r\n\t\treturn message.update({\r\n\t\t\tcontent: chatCardHtml,\r\n\t\t\t[`${CONSTANTS.FLAGS.PILE}.items`]: newItems\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tstatic async _updateExistingMerchantMessage(message, sourceActor, targetActor, incomingPriceInformation, interactionId) {\r\n\r\n\t\tconst flags = foundry.utils.getProperty(message, CONSTANTS.FLAGS.PILE);\r\n\r\n\t\tconst newPriceInformation = flags.priceInformation\r\n\t\t\t.map(priceInformation => {\r\n\t\t\t\tconst boughtItem = incomingPriceInformation.buyerReceive[0];\r\n\t\t\t\tconst foundEntry = Utilities.findSimilarItem(priceInformation.buyerReceive, boughtItem);\r\n\t\t\t\tif (foundEntry) {\r\n\t\t\t\t\tif (incomingPriceInformation.primary && priceInformation.primary) {\r\n\t\t\t\t\t\tfoundEntry.quantity += boughtItem.quantity;\r\n\t\t\t\t\t\tincomingPriceInformation.buyerReceive.splice(0, 1);\r\n\t\t\t\t\t\tpriceInformation.totalCurrencyCost += incomingPriceInformation.totalCurrencyCost;\r\n\t\t\t\t\t\tpriceInformation.basePriceString = PileUtilities.getPriceArray(priceInformation.totalCurrencyCost, priceInformation.finalPrices)\r\n\t\t\t\t\t\t\t.filter(price => price.cost).map(price => price.string).join(\" \");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst sameTypePrice = incomingPriceInformation.finalPrices\r\n\t\t\t\t\t\t\t.map(price => {\r\n\t\t\t\t\t\t\t\tconst foundItem = Utilities.findSimilarItem(priceInformation.buyerReceive, price);\r\n\t\t\t\t\t\t\t\tif (foundItem) {\r\n\t\t\t\t\t\t\t\t\treturn { foundItem, price }\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.filter(Boolean);\r\n\t\t\t\t\t\tif (sameTypePrice.length) {\r\n\t\t\t\t\t\t\tincomingPriceInformation.buyerReceive.splice(0, 1);\r\n\t\t\t\t\t\t\tsameTypePrice.forEach(match => {\r\n\t\t\t\t\t\t\t\tmatch.price.quantity += match.foundItem.quantity;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn priceInformation;\r\n\t\t\t})\r\n\t\t\t.concat([incomingPriceInformation].filter(priceInformation => priceInformation.buyerReceive.length));\r\n\r\n\t\tconst pileData = PileUtilities.getActorFlagData(sourceActor);\r\n\r\n\t\tconst chatCardHtml = await renderTemplate(CONSTANTS.PATH + \"templates/chat/merchant-traded.html\", {\r\n\t\t\tmessage: game.i18n.format(\"ITEM-PILES.Chat.MerchantTraded\", {\r\n\t\t\t\tname: targetActor.name,\r\n\t\t\t\tmerchant: sourceActor.name\r\n\t\t\t}),\r\n\t\t\tmerchant: {\r\n\t\t\t\tname: sourceActor.name,\r\n\t\t\t\timg: pileData.merchantImage || sourceActor.img\r\n\t\t\t},\r\n\t\t\tactor: targetActor,\r\n\t\t\tpriceInformation: newPriceInformation\r\n\t\t});\r\n\r\n\t\treturn message.update({\r\n\t\t\tcontent: chatCardHtml,\r\n\t\t\t[`${CONSTANTS.FLAGS.PILE}.interactionId`]: interactionId,\r\n\t\t\t[`${CONSTANTS.FLAGS.PILE}.priceInformation`]: newPriceInformation\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tstatic _createNewChatMessage(userId, chatData) {\r\n\r\n\t\tif (!chatData.whisper) {\r\n\r\n\t\t\tconst mode = Helpers.getSetting(SETTINGS.OUTPUT_TO_CHAT);\r\n\r\n\t\t\tif (mode > 1) {\r\n\t\t\t\tchatData.whisper = Array.from(game.users)\r\n\t\t\t\t\t.filter(user => user.isGM)\r\n\t\t\t\t\t.map(user => user.id);\r\n\t\t\t\tif (mode === 2) {\r\n\t\t\t\t\tchatData.whisper.push(userId);\r\n\t\t\t\t}\r\n\t\t\t\tif (!CONSTANTS.IS_V12) {\r\n\t\t\t\t\tchatData.type = CHAT_MESSAGE_STYLES.WHISPER;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif (chatData?.whisper?.length) {\r\n\t\t\tchatData.whisper = Array.from(new Set(chatData.whisper));\r\n\t\t}\r\n\r\n\t\treturn ChatMessage.create(chatData);\r\n\r\n\t}\r\n\r\n}\r\n","import CONSTANTS from \"./constants/constants.js\";\r\nimport * as Helpers from \"./helpers/helpers.js\";\r\nimport { debug } from \"./helpers/helpers.js\";\r\nimport { stringIsUuid } from \"./helpers/utilities.js\";\r\nimport PrivateAPI from \"./API/private-api.js\";\r\nimport TradeAPI from \"./API/trade-api.js\";\r\nimport ChatAPI from \"./API/chat-api.js\";\r\n\r\nexport default class ItemPileSocket {\r\n\r\n\tstatic ready = false;\r\n\r\n\tstatic HANDLERS = {\r\n\t\t/**\r\n\t\t * Generic sockets\r\n\t\t */\r\n\t\tCALL_HOOK: \"callHook\",\r\n\t\tTOGGLE_HOOKS: \"toggleHooks\",\r\n\r\n\t\t/**\r\n\t\t * Chat messages\r\n\t\t */\r\n\t\tPICKUP_CHAT_MESSAGE: \"pickupChatMessage\",\r\n\t\tSPLIT_CHAT_MESSAGE: \"splitChatMessage\",\r\n\t\tMERCHANT_TRADE_CHAT_MESSAGE: \"merchantTradeChatMessage\",\r\n\t\tDISABLE_CHAT_TRADE_BUTTON: \"disableChatTradeButton\",\r\n\r\n\t\t/**\r\n\t\t * Item pile sockets\r\n\t\t */\r\n\t\tCREATE_PILE: \"createItemPile\",\r\n\t\tUPDATE_PILE: \"updateItemPile\",\r\n\t\tUPDATED_PILE: \"updatedPile\",\r\n\t\tDELETE_PILE: \"deleteItemPile\",\r\n\t\tTURN_INTO_PILE: \"turnIntoPiles\",\r\n\t\tREVERT_FROM_PILE: \"revertFromPiles\",\r\n\t\tREFRESH_PILE: \"refreshItemPile\",\r\n\t\tSPLIT_PILE: \"splitItemPileContent\",\r\n\r\n\t\t/**\r\n\t\t * UI sockets\r\n\t\t */\r\n\t\tRENDER_INTERFACE: \"renderItemPileApplication\",\r\n\t\tUNRENDER_INTERFACE: \"unrenderItemPileApplication\",\r\n\t\tRERENDER_TOKEN_HUD: \"rerenderTokenHud\",\r\n\t\tUSER_OPENED_INTERFACE: \"userOpenedInterface\",\r\n\t\tUSER_CLOSED_INTERFACE: \"userClosedInterface\",\r\n\r\n\t\t/**\r\n\t\t * Item & attribute sockets\r\n\t\t */\r\n\t\tGIVE_ITEMS: \"giveItems\",\r\n\t\tGIVE_ITEMS_RESPONSE: \"giveItemsResponse\",\r\n\t\tDROP_ITEMS: \"dropItems\",\r\n\t\tADD_ITEMS: \"addItems\",\r\n\t\tREMOVE_ITEMS: \"removeItems\",\r\n\t\tTRANSFER_ITEMS: \"transferItems\",\r\n\t\tTRANSFER_ALL_ITEMS: \"transferAllItems\",\r\n\t\tUPDATE_CURRENCIES: \"updateCurrencies\",\r\n\t\tADD_CURRENCIES: \"addCurrencies\",\r\n\t\tREMOVE_CURRENCIES: \"removeCurrencies\",\r\n\t\tTRANSFER_CURRENCIES: \"transferCurrencies\",\r\n\t\tTRANSFER_ALL_CURRENCIES: \"transferAllCurrencies\",\r\n\t\tSET_ATTRIBUTES: \"setAttributes\",\r\n\t\tADD_ATTRIBUTES: \"addAttributes\",\r\n\t\tREMOVE_ATTRIBUTES: \"removeAttributes\",\r\n\t\tTRANSFER_ATTRIBUTES: \"transferAttributes\",\r\n\t\tTRANSFER_ALL_ATTRIBUTES: \"transferAllAttributes\",\r\n\t\tTRANSFER_EVERYTHING: \"transferEverything\",\r\n\t\tCOMBINE_ITEM_PILES: \"combineItemPiles\",\r\n\t\tCOMMIT_DOCUMENT_CHANGES: \"commitActorChanges\",\r\n\t\tROLL_ITEM_TABLE: \"rollItemTable\",\r\n\t\tREFRESH_MERCHANT_INVENTORY: \"refreshMerchantInventory\",\r\n\r\n\t\t/**\r\n\t\t * Trading sockets\r\n\t\t */\r\n\t\tTRADE_REQUEST_PROMPT: \"tradePrompt\",\r\n\t\tTRADE_REQUEST_CANCELLED: \"tradeCancelled\",\r\n\t\tREQUEST_TRADE_DATA: \"requestTradeData\",\r\n\t\tTRADE_CLOSED: \"publicTradeClosed\",\r\n\t\tPUBLIC_TRADE_UPDATE_ITEMS: \"publicTradeUpdateItems\",\r\n\t\tPUBLIC_TRADE_UPDATE_ITEM_CURRENCIES: \"publicTradeUpdateItemCurrencies\",\r\n\t\tPUBLIC_TRADE_UPDATE_CURRENCIES: \"publicTradeUpdateCurrencies\",\r\n\t\tPUBLIC_TRADE_STATE: \"publicTradeAcceptedState\",\r\n\t\tPRIVATE_TRADE_UPDATE_ITEMS: \"privateTradeUpdateItems\",\r\n\t\tPRIVATE_TRADE_UPDATE_ITEM_CURRENCIES: \"privateTradeUpdateItemCurrencies\",\r\n\t\tPRIVATE_TRADE_UPDATE_CURRENCIES: \"privateTradeUpdateCurrencies\",\r\n\t\tPRIVATE_TRADE_STATE: \"privateTradeAcceptedState\",\r\n\t\tEXECUTE_TRADE: \"executeTrade\",\r\n\t\tTRADE_COMPLETED: \"tradeCompleted\",\r\n\r\n\t\t/**\r\n\t\t * Merchant sockets\r\n\t\t */\r\n\t\tTRADE_ITEMS: \"tradeItems\"\r\n\t}\r\n\r\n\tstatic BINDINGS = {\r\n\t\t[this.HANDLERS.CALL_HOOK]: (hook, response, ...args) => callHook(hook, response, ...args),\r\n\r\n\t\t[this.HANDLERS.TOGGLE_HOOKS]: (toggle) => {\r\n\t\t\tHelpers.hooks.run = toggle;\r\n\t\t},\r\n\r\n\t\t[this.HANDLERS.DROP_ITEMS]: (args) => PrivateAPI._dropItems(args),\r\n\t\t[this.HANDLERS.GIVE_ITEMS]: (...args) => PrivateAPI._giveItems(...args),\r\n\t\t[this.HANDLERS.GIVE_ITEMS_RESPONSE]: (...args) => PrivateAPI._giveItemsResponse(...args),\r\n\t\t[this.HANDLERS.ADD_ITEMS]: (...args) => PrivateAPI._addItems(...args),\r\n\t\t[this.HANDLERS.REMOVE_ITEMS]: (...args) => PrivateAPI._removeItems(...args),\r\n\t\t[this.HANDLERS.TRANSFER_ITEMS]: (...args) => PrivateAPI._transferItems(...args),\r\n\t\t[this.HANDLERS.TRANSFER_ALL_ITEMS]: (...args) => PrivateAPI._transferAllItems(...args),\r\n\t\t[this.HANDLERS.UPDATE_CURRENCIES]: (...args) => PrivateAPI._updateCurrencies(...args),\r\n\t\t[this.HANDLERS.ADD_CURRENCIES]: (...args) => PrivateAPI._addCurrencies(...args),\r\n\t\t[this.HANDLERS.REMOVE_CURRENCIES]: (...args) => PrivateAPI._removeCurrencies(...args),\r\n\t\t[this.HANDLERS.TRANSFER_CURRENCIES]: (...args) => PrivateAPI._transferCurrencies(...args),\r\n\t\t[this.HANDLERS.TRANSFER_ALL_CURRENCIES]: (...args) => PrivateAPI._transferAllCurrencies(...args),\r\n\t\t[this.HANDLERS.SET_ATTRIBUTES]: (...args) => PrivateAPI._setAttributes(...args),\r\n\t\t[this.HANDLERS.ADD_ATTRIBUTES]: (...args) => PrivateAPI._addAttributes(...args),\r\n\t\t[this.HANDLERS.REMOVE_ATTRIBUTES]: (...args) => PrivateAPI._removeAttributes(...args),\r\n\t\t[this.HANDLERS.TRANSFER_ATTRIBUTES]: (...args) => PrivateAPI._transferAttributes(...args),\r\n\t\t[this.HANDLERS.TRANSFER_ALL_ATTRIBUTES]: (...args) => PrivateAPI._transferAllAttributes(...args),\r\n\t\t[this.HANDLERS.TRANSFER_EVERYTHING]: (...args) => PrivateAPI._transferEverything(...args),\r\n\t\t[this.HANDLERS.COMBINE_ITEM_PILES]: (...args) => PrivateAPI._combineItemPiles(...args),\r\n\t\t[this.HANDLERS.COMMIT_DOCUMENT_CHANGES]: (...args) => PrivateAPI._commitDocumentChanges(...args),\r\n\t\t[this.HANDLERS.ROLL_ITEM_TABLE]: (...args) => PrivateAPI._rollItemTable(...args),\r\n\t\t[this.HANDLERS.REFRESH_MERCHANT_INVENTORY]: (...args) => PrivateAPI._refreshMerchantInventory(...args),\r\n\r\n\t\t[this.HANDLERS.CREATE_PILE]: (...args) => PrivateAPI._createItemPile(...args),\r\n\t\t[this.HANDLERS.UPDATE_PILE]: (...args) => PrivateAPI._updateItemPile(...args),\r\n\t\t[this.HANDLERS.UPDATED_PILE]: (...args) => PrivateAPI._updatedItemPile(...args),\r\n\t\t[this.HANDLERS.DELETE_PILE]: (...args) => PrivateAPI._deleteItemPile(...args),\r\n\t\t[this.HANDLERS.TURN_INTO_PILE]: (...args) => PrivateAPI._turnTokensIntoItemPiles(...args),\r\n\t\t[this.HANDLERS.REVERT_FROM_PILE]: (...args) => PrivateAPI._revertTokensFromItemPiles(...args),\r\n\t\t[this.HANDLERS.SPLIT_PILE]: (...args) => PrivateAPI._splitItemPileContents(...args),\r\n\r\n\t\t[this.HANDLERS.TRADE_REQUEST_PROMPT]: (...args) => TradeAPI._respondPrompt(...args),\r\n\t\t[this.HANDLERS.TRADE_REQUEST_CANCELLED]: (...args) => TradeAPI._tradeCancelled(...args),\r\n\t\t[this.HANDLERS.EXECUTE_TRADE]: (...args) => TradeAPI._executeTrade(...args),\r\n\t\t[this.HANDLERS.TRADE_COMPLETED]: (...args) => TradeAPI._tradeCompleted(...args),\r\n\t\t[this.HANDLERS.REQUEST_TRADE_DATA]: (...args) => TradeAPI._respondActiveTradeData(...args),\r\n\t\t[this.HANDLERS.TRADE_CLOSED]: (...args) => TradeAPI._tradeClosed(...args),\r\n\r\n\t\t[this.HANDLERS.PUBLIC_TRADE_UPDATE_ITEMS]: (...args) => TradeAPI._updateItems(...args),\r\n\t\t[this.HANDLERS.PUBLIC_TRADE_UPDATE_ITEM_CURRENCIES]: (...args) => TradeAPI._updateItemCurrencies(...args),\r\n\t\t[this.HANDLERS.PUBLIC_TRADE_UPDATE_CURRENCIES]: (...args) => TradeAPI._updateCurrencies(...args),\r\n\t\t[this.HANDLERS.PUBLIC_TRADE_STATE]: (...args) => TradeAPI._updateAcceptedState(...args),\r\n\r\n\t\t[this.HANDLERS.PRIVATE_TRADE_UPDATE_ITEMS]: (...args) => TradeAPI._updateItems(...args),\r\n\t\t[this.HANDLERS.PRIVATE_TRADE_UPDATE_ITEM_CURRENCIES]: (...args) => TradeAPI._updateItemCurrencies(...args),\r\n\t\t[this.HANDLERS.PRIVATE_TRADE_UPDATE_CURRENCIES]: (...args) => TradeAPI._updateCurrencies(...args),\r\n\t\t[this.HANDLERS.PRIVATE_TRADE_STATE]: (...args) => TradeAPI._updateAcceptedState(...args),\r\n\r\n\t\t[this.HANDLERS.PICKUP_CHAT_MESSAGE]: (...args) => ChatAPI._outputPickupToChat(...args),\r\n\t\t[this.HANDLERS.SPLIT_CHAT_MESSAGE]: (...args) => ChatAPI._outputSplitToChat(...args),\r\n\t\t[this.HANDLERS.MERCHANT_TRADE_CHAT_MESSAGE]: (...args) => ChatAPI._outputMerchantTradeToChat(...args),\r\n\t\t[this.HANDLERS.DISABLE_CHAT_TRADE_BUTTON]: (...args) => ChatAPI._disableTradingButton(...args),\r\n\r\n\t\t[this.HANDLERS.RENDER_INTERFACE]: (...args) => PrivateAPI._renderItemPileInterface(...args),\r\n\t\t[this.HANDLERS.UNRENDER_INTERFACE]: (...args) => PrivateAPI._unrenderItemPileInterface(...args),\r\n\t\t[this.HANDLERS.RERENDER_TOKEN_HUD]: (...args) => PrivateAPI._updateTokenHud(...args),\r\n\t\t[this.HANDLERS.USER_OPENED_INTERFACE]: (...args) => InterfaceTracker.userOpened(...args),\r\n\t\t[this.HANDLERS.USER_CLOSED_INTERFACE]: (...args) => InterfaceTracker.userClosed(...args),\r\n\r\n\t\t[this.HANDLERS.TRADE_ITEMS]: (...args) => PrivateAPI._tradeItems(...args),\r\n\r\n\t}\r\n\r\n\tstatic socket;\r\n\r\n\tstatic initialize() {\r\n\t\tInterfaceTracker.initialize();\r\n\t\tthis.socket = socketlib.registerModule(CONSTANTS.MODULE_NAME);\r\n\t\tfor (let [key, callback] of Object.entries(this.BINDINGS)) {\r\n\t\t\tthis.socket.register(key, callback);\r\n\t\t\tdebug(`Registered itemPileSocket: ${key}`);\r\n\t\t}\r\n\t\tdebug(\"Registered all Item Piles sockets\")\r\n\t\tthis.ready = true;\r\n\t}\r\n\r\n\tstatic executeAsGM(handler, ...args) {\r\n\t\tif (!Helpers.isGMConnected()) {\r\n\t\t\tHelpers.custom_warning(game.i18n.format(\"ITEM-PILES.Warnings.NoGMsConnectedAction\", { action: handler }), true);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn Requests.timedSocketRequest(handler, async () => this.socket.executeAsGM(handler, ...args));\r\n\t}\r\n\r\n\tstatic executeAsUser(handler, userId, ...args) {\r\n\t\treturn this.socket.executeAsUser(handler, userId, ...args);\r\n\t}\r\n\r\n\tstatic executeForAllGMs(handler, ...args) {\r\n\t\treturn this.socket.executeForAllGMs(handler, ...args);\r\n\t}\r\n\r\n\tstatic executeForOtherGMs(handler, ...args) {\r\n\t\treturn this.socket.executeForOtherGMs(handler, ...args);\r\n\t}\r\n\r\n\tstatic executeForEveryone(handler, ...args) {\r\n\t\treturn this.socket.executeForEveryone(handler, ...args);\r\n\t}\r\n\r\n\tstatic executeForOthers(handler, ...args) {\r\n\t\treturn this.socket.executeForOthers(handler, ...args);\r\n\t}\r\n\r\n\tstatic executeForUsers(handler, userIds, ...args) {\r\n\t\treturn this.socket.executeForUsers(handler, userIds, ...args);\r\n\t}\r\n\r\n\tstatic callHook(hook, ...args) {\r\n\t\tif (!Helpers.hooks.run) return;\r\n\t\treturn this.socket.executeForEveryone(this.HANDLERS.CALL_HOOK, hook, ...args);\r\n\t}\r\n\r\n\tstatic callHookForUsers(hook, users, ...args) {\r\n\t\tif (!Helpers.hooks.run) return;\r\n\t\treturn this.socket.executeForUsers(this.HANDLERS.CALL_HOOK, users, hook, ...args);\r\n\t}\r\n\r\n}\r\n\r\nconst Requests = {\r\n\t_unresponsiveGM: false,\r\n\t_lastGmUnresponsiveTimestamp: false,\r\n\t_timers: {},\r\n\t_defaultTimeout: 2000,\r\n\t_unresponsiveTimeout: 10000,\r\n\tasync timedSocketRequest(handler, method) {\r\n\t\tconst activeGM = Helpers.getResponsibleGM();\r\n\t\tif (activeGM === game.user) return method();\r\n\t\tif (Requests._unresponsiveGM && Number(Date.now()) < Requests._lastGmUnresponsiveTimestamp) {\r\n\t\t\tHelpers.custom_warning(game.i18n.format(\"ITEM-PILES.Warnings.NoResponseFromGMTimeout\", {\r\n\t\t\t\tuser_name: Requests._unresponsiveGM,\r\n\t\t\t\ttime: Math.ceil((Requests._lastGmUnresponsiveTimestamp - Number(Date.now())) / 1000)\r\n\t\t\t}), true);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tRequests._addTimeout(handler);\r\n\t\tlet result;\r\n\t\ttry {\r\n\t\t\tresult = await method();\r\n\t\t} catch (err) {\r\n\t\t\tRequests._clearPendingTimeout(handler);\r\n\t\t\tconsole.error(err);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tRequests._clearPendingTimeout(handler);\r\n\t\tRequests._unresponsiveGM = false;\r\n\t\tRequests._lastGmUnresponsiveTimestamp = false;\r\n\t\treturn result;\r\n\t},\r\n\t_addTimeout(handler) {\r\n\t\tRequests._timers[handler] = setTimeout(() => {\r\n\t\t\tconst activeGM = Helpers.getResponsibleGM();\r\n\t\t\tHelpers.custom_warning(game.i18n.format(\"ITEM-PILES.Warnings.NoResponseFromGM\", {\r\n\t\t\t\tuser_name: activeGM.name\r\n\t\t\t}), true, true);\r\n\t\t\tRequests._unresponsiveGM = activeGM.name;\r\n\t\t\tRequests._lastGmUnresponsiveTimestamp = Number(Date.now()) + Requests._unresponsiveTimeout;\r\n\t\t\tRequests._clearPendingTimeout(handler);\r\n\t\t}, Requests._defaultTimeout);\r\n\t},\r\n\t_clearPendingTimeout(handler) {\r\n\t\tclearTimeout(Requests._timers[handler]);\r\n\t\tdelete Requests._timers[handler];\r\n\t}\r\n};\r\n\r\nasync function callHook(hook, ...args) {\r\n\tconst newArgs = [];\r\n\tfor (let arg of args) {\r\n\t\tif (stringIsUuid(arg)) {\r\n\t\t\tconst testArg = fromUuidSync(arg);\r\n\t\t\tif (testArg) {\r\n\t\t\t\targ = testArg;\r\n\t\t\t}\r\n\t\t}\r\n\t\tnewArgs.push(arg);\r\n\t}\r\n\treturn Hooks.callAll(hook, ...newArgs);\r\n}\r\n\r\nexport const InterfaceTracker = {\r\n\r\n\tusers: {},\r\n\r\n\tinitialize() {\r\n\t\tthis.users = {};\r\n\t\tArray.from(game.users).forEach(user => {\r\n\t\t\tthis.users[user.id] = new Set();\r\n\t\t});\r\n\t\tHooks.on(CONSTANTS.HOOKS.OPEN_INTERFACE, (app) => {\r\n\t\t\tItemPileSocket.executeForOthers(ItemPileSocket.HANDLERS.USER_OPENED_INTERFACE, game.user.id, app.id);\r\n\t\t});\r\n\t\tHooks.on(CONSTANTS.HOOKS.CLOSE_INTERFACE, (app) => {\r\n\t\t\tItemPileSocket.executeForOthers(ItemPileSocket.HANDLERS.USER_CLOSED_INTERFACE, game.user.id, app.id);\r\n\t\t});\r\n\t},\r\n\r\n\tuserOpened(userId, id) {\r\n\t\tif (!this.users[userId]) return;\r\n\t\tthis.users[userId].add(id);\r\n\t},\r\n\r\n\tuserClosed(userId, id) {\r\n\t\tif (!this.users[userId]) return;\r\n\t\tthis.users[userId].delete(id);\r\n\t},\r\n\r\n\tisOpened(id) {\r\n\t\treturn Object.values(this.users).some(interfaceList => interfaceList.has(id))\r\n\t}\r\n\r\n}\r\n","import CONSTANTS from \"../constants/constants.js\";\r\nimport ItemPileSocket from \"../socket.js\";\r\nimport SETTINGS from \"../constants/settings.js\";\r\nimport editors from \"../applications/editors/index.js\";\r\n\r\n\r\nexport const debounceManager = {\r\n\r\n\tdebounces: {},\r\n\r\n\tsetDebounce(id, method) {\r\n\t\tif (this.debounces[id]) {\r\n\t\t\treturn this.debounces[id];\r\n\t\t}\r\n\t\tthis.debounces[id] = foundry.utils.debounce(function (...args) {\r\n\t\t\tdelete debounceManager.debounces[id];\r\n\t\t\treturn method(...args);\r\n\t\t}, 250);\r\n\t\treturn this.debounces[id];\r\n\t}\r\n};\r\n\r\nexport const hooks = {\r\n\trun: true,\r\n\t_hooks: {},\r\n\r\n\tasync runWithout(callback) {\r\n\t\tawait ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.TOGGLE_HOOKS, false);\r\n\t\tawait callback();\r\n\t\tawait ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.TOGGLE_HOOKS, true);\r\n\t},\r\n\r\n\tcall(hook, ...args) {\r\n\t\tif (!this.run) return;\r\n\t\treturn Hooks.call(hook, ...args);\r\n\t},\r\n\r\n\tcallAll(hook, ...args) {\r\n\t\tif (!this.run) return;\r\n\t\treturn Hooks.callAll(hook, ...args);\r\n\t},\r\n\r\n\ton(hook, callback) {\r\n\t\tHooks.on(hook, (...args) => {\r\n\t\t\tif (!this.run) return;\r\n\t\t\tcallback(...args);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport function getModuleVersion() {\r\n\treturn game.modules.get(CONSTANTS.MODULE_NAME).version;\r\n}\r\n\r\n/**\r\n *  This function determines if the given parameter is a callable function\r\n *\r\n * @param  {function}   inFunc    The function object to be tested\r\n * @return {boolean}              A boolean whether the function is actually a function\r\n */\r\nexport function isFunction(inFunc) {\r\n\treturn inFunc && (\r\n\t\t{}.toString.call(inFunc) === '[object Function]'\r\n\t\t||\r\n\t\t{}.toString.call(inFunc) === '[object AsyncFunction]'\r\n\t);\r\n}\r\n\r\nexport function wait(ms) {\r\n\treturn new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n\r\n/**\r\n * @param key\r\n * @returns {*}\r\n */\r\nexport function getSetting(key) {\r\n\treturn game.settings.get(CONSTANTS.MODULE_NAME, key);\r\n}\r\n\r\nexport function setSetting(key, value) {\r\n\tif (value === undefined) {\r\n\t\tthrow new Error(\"setSetting | value must not be undefined!\");\r\n\t}\r\n\treturn game.settings.set(CONSTANTS.MODULE_NAME, key, value);\r\n}\r\n\r\nexport function debug(msg, args = \"\") {\r\n\tif (game.settings.get(CONSTANTS.MODULE_NAME, \"debug\")) {\r\n\t\tconsole.log(`DEBUG | Item Piles | ${msg}`, args)\r\n\t}\r\n}\r\n\r\nexport function custom_notify(message) {\r\n\tmessage = `Item Piles | ${message}`;\r\n\tui.notifications.notify(message, { console: false });\r\n\tconsole.log(message.replace(\"<br>\", \"\\n\"));\r\n}\r\n\r\nexport function custom_warning(warning, notify = false, permanent = false) {\r\n\twarning = `Item Piles | ${warning}`;\r\n\tif (notify) {\r\n\t\tui.notifications.warn(warning, { console: false, permanent });\r\n\t}\r\n\tconsole.warn(warning.replace(\"<br>\", \"\\n\"));\r\n}\r\n\r\nexport function custom_error(error, notify = true, permanent = false) {\r\n\terror = `Item Piles | ${error}`;\r\n\tif (notify) {\r\n\t\tui.notifications.error(error, { console: false, permanent });\r\n\t}\r\n\treturn new Error(error.replace(\"<br>\", \"\\n\"));\r\n}\r\n\r\nexport function capitalizeFirstLetter(str) {\r\n\treturn str.slice(0, 1).toUpperCase() + str.slice(1);\r\n}\r\n\r\nexport function isRealNumber(inNumber) {\r\n\treturn !isNaN(inNumber)\r\n\t\t&& typeof inNumber === \"number\"\r\n\t\t&& isFinite(inNumber);\r\n}\r\n\r\nexport function isActiveGM(user) {\r\n\treturn user.active && user.isGM;\r\n}\r\n\r\nexport function getActiveGMs() {\r\n\treturn game.users.filter(isActiveGM);\r\n}\r\n\r\nexport function isResponsibleGM() {\r\n\tif (!game.user.isGM) {\r\n\t\treturn false;\r\n\t}\r\n\treturn !getActiveGMs().some(other => other.id < game.user.id);\r\n}\r\n\r\nexport function getResponsibleGM() {\r\n\tconst activeGMs = getActiveGMs();\r\n\tif (!activeGMs.length) return false;\r\n\treturn activeGMs.sort((a, b) => b.id > a.id)?.[0];\r\n}\r\n\r\nexport function isGMConnected() {\r\n\treturn !!Array.from(game.users).find(user => user.isGM && user.active);\r\n}\r\n\r\nexport function roundToDecimals(num, decimals) {\r\n\tif (!decimals) return Math.floor(num);\r\n\treturn Number(Math.round(num + 'e' + decimals) + 'e-' + decimals);\r\n}\r\n\r\nexport function clamp(num, min, max) {\r\n\treturn Math.max(Math.min(num, max), min);\r\n}\r\n\r\nexport function getActiveApps(id, single = false) {\r\n\tconst apps = Object.values(ui.windows).filter(app => app.id.startsWith(id) && app._state > Application.RENDER_STATES.CLOSED);\r\n\tif (single) {\r\n\t\treturn apps?.[0] ?? false;\r\n\t}\r\n\treturn apps;\r\n}\r\n\r\n/**\r\n *  This function linearly interpolates between p1 and p2 based on a normalized value of t\r\n *\r\n * @param  {string}         inFile      The start value\r\n * @param  {object}         inOptions   The end value\r\n * @return {array|boolean}              Interpolated value\r\n */\r\nexport async function getFiles(inFile, { applyWildCard = false, softFail = false } = {}) {\r\n\r\n\tlet source = 'data';\r\n\tconst browseOptions = { wildcard: applyWildCard };\r\n\r\n\tif (/\\.s3\\./.test(inFile)) {\r\n\t\tsource = 's3'\r\n\t\tconst { bucket, keyPrefix } = FilePicker.parseS3URL(inFile);\r\n\t\tif (bucket) {\r\n\t\t\tbrowseOptions.bucket = bucket;\r\n\t\t\tinFile = keyPrefix;\r\n\t\t}\r\n\t}\r\n\r\n\ttry {\r\n\t\treturn (await FilePicker.browse(source, inFile, browseOptions)).files;\r\n\t} catch (err) {\r\n\t\tif (softFail) return false;\r\n\t\tthrow custom_error(`Could not get files! | ${err}`);\r\n\t}\r\n}\r\n\r\n/**\r\n *  Returns a floating point number between a minimum and maximum value\r\n *\r\n * @param  {number}     min                     The minimum value\r\n * @param  {number}     max                     The maximum value\r\n * @return {number}                             A random value between the range given\r\n */\r\nexport function random_float_between(min, max) {\r\n\tconst random = Math.random();\r\n\tconst _max = Math.max(max, min);\r\n\tconst _min = Math.min(max, min);\r\n\treturn random * (_max - _min) + _min;\r\n}\r\n\r\n/**\r\n *  Returns an integer between a minimum and maximum value\r\n *\r\n * @param  {number}     min                     The minimum value\r\n * @param  {number}     max                     The maximum value\r\n * @return {int}                                A random integer between the range given\r\n */\r\nexport function random_int_between(min, max) {\r\n\treturn Math.floor(random_float_between(min, max));\r\n}\r\n\r\n/**\r\n *  Returns a random element in the given array\r\n *\r\n * @param  {array}   inArray                    An array\r\n * @param  {boolean} recurse                    Whether to recurse if the randomly chosen element is also an array\r\n * @return {object}                             A random element from the array\r\n */\r\nexport function random_array_element(inArray, { recurse = false } = {}) {\r\n\tlet choice = inArray[random_int_between(0, inArray.length)];\r\n\tif (recurse && Array.isArray(choice)) {\r\n\t\treturn random_array_element(choice, { recurse: true });\r\n\t}\r\n\treturn choice;\r\n}\r\n\r\n\r\nexport function styleFromObject(obj, vars = false) {\r\n\treturn Object.entries(obj).map(entry => (vars ? \"--\" : \"\") + entry[0] + ': ' + entry[1] + \";\").join(\"\");\r\n}\r\n\r\n\r\nexport function abbreviateNumbers(number, decPlaces = 2) {\r\n\r\n\t// 2 decimal places => 100, 3 => 1000, etc\r\n\tdecPlaces = Math.pow(10, decPlaces)\r\n\r\n\t// Enumerate number abbreviations\r\n\tlet abbrev = ['k', 'm', 'b', 't']\r\n\r\n\t// Go through the array backwards, so we do the largest first\r\n\tfor (let i = abbrev.length - 1; i >= 0; i--) {\r\n\r\n\t\t// Convert array index to \"1000\", \"1000000\", etc\r\n\t\tlet size = Math.pow(10, (i + 1) * 3)\r\n\r\n\t\t// If the number is bigger or equal do the abbreviation\r\n\t\tif (size <= number) {\r\n\t\t\t// Here, we multiply by decPlaces, round, and then divide by decPlaces.\r\n\t\t\t// This gives us nice rounding to a particular decimal place.\r\n\t\t\tnumber = Math.round((number * decPlaces) / size) / decPlaces\r\n\r\n\t\t\t// Handle special case where we round up to the next abbreviation\r\n\t\t\tif (number === 1000 && i < abbrev.length - 1) {\r\n\t\t\t\tnumber = 1\r\n\t\t\t\ti++\r\n\t\t\t}\r\n\r\n\t\t\t// Add the letter for the abbreviation\r\n\t\t\tnumber += abbrev[i]\r\n\r\n\t\t\t// We are done... stop\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\treturn number\r\n}\r\n\r\n\r\nexport function timeSince(date) {\r\n\tconst seconds = Math.floor((new Date() - date) / 1000);\r\n\tconst intervals = {\r\n\t\t\"d\": 86400,\r\n\t\t\"h\": 3600,\r\n\t\t\"m\": 60\r\n\t}\r\n\r\n\tfor (const [key, value] of Object.entries(intervals)) {\r\n\t\tconst interval = seconds / value;\r\n\t\tif (interval > 1) {\r\n\t\t\treturn Math.floor(interval) + key;\r\n\t\t}\r\n\t}\r\n\r\n\treturn Math.ceil(seconds) + \"s\";\r\n}\r\n\r\n\r\nexport function getApplicationPositions(application_1, application_2 = false) {\r\n\r\n\tlet midPoint = (window.innerWidth / 2);\r\n\r\n\tif (!application_2) {\r\n\t\tif (((midPoint - 200) - application_1.position.width - 25) > 0) {\r\n\t\t\tmidPoint -= 200\r\n\t\t}\r\n\t\treturn [\r\n\t\t\t{ left: midPoint - application_1.position.width - 25 },\r\n\t\t\t{ left: midPoint + 25 }\r\n\t\t]\r\n\t}\r\n\r\n\tconst application_1_position = {\r\n\t\tleft: application_1.position.left,\r\n\t\ttop: application_1.position.top,\r\n\t\twidth: application_1.position.width\r\n\t};\r\n\tconst application_2_position = {\r\n\t\tleft: application_2.position.left,\r\n\t\ttop: application_1.position.top,\r\n\t\twidth: application_2.position.width\r\n\t};\r\n\r\n\tapplication_2_position.left = application_1_position.left - application_2_position.width - 25;\r\n\tif (application_2_position.left < 0) {\r\n\t\tapplication_2_position.left = application_1_position.left + application_1_position.width + 25\r\n\t}\r\n\tif ((application_2_position.left + application_2_position.width) > window.innerWidth) {\r\n\t\tapplication_2_position.left = midPoint - application_2_position.width - 25;\r\n\t\tapplication_1_position.left = midPoint + 25;\r\n\t}\r\n\r\n\treturn [\r\n\t\tapplication_1_position,\r\n\t\tapplication_2_position\r\n\t]\r\n\r\n}\r\n\r\nexport async function openEditor(key, data = false) {\r\n\r\n\tconst setting = SETTINGS.DEFAULTS()[key];\r\n\r\n\tconst editor = editors[setting.application];\r\n\r\n\tif (!data) {\r\n\t\tdata = getSetting(key);\r\n\t}\r\n\r\n\tconst result = await editor.show(data, { ...setting.applicationOptions, onchange: setting.onchange } ?? {});\r\n\r\n\tif (setting.onchange && result) setting.onchange(result);\r\n\r\n\treturn result;\r\n\r\n}\r\n\r\nexport function isCoordinateWithinPosition(x, y, position) {\r\n\treturn x >= position.left && x < position.left + position.width\r\n\t\t&& y >= position.top && y < position.top + position.height;\r\n}\r\n\r\n\r\nexport function getCanvasMouse() {\r\n\treturn canvas?.app?.renderer?.plugins?.interaction?.pointer ?? canvas?.app?.renderer?.events?.pointer;\r\n}\r\n","import * as Helpers from \"./helpers/helpers.js\";\r\nimport * as PileUtilities from \"./helpers/pile-utilities.js\";\r\nimport { isValidItemPile } from \"./helpers/pile-utilities.js\";\r\nimport ItemPileConfig from \"./applications/item-pile-config/item-pile-config.js\";\r\nimport ItemEditor from \"./applications/item-editor/item-editor.js\";\r\nimport SETTINGS from \"./constants/settings.js\";\r\nimport CONSTANTS from \"./constants/constants.js\";\r\nimport UserSelectDialog from \"./applications/dialogs/user-select-dialog/user-select-dialog.js\";\r\n\r\nexport let fastToolTip = null;\r\n\r\nexport default function registerUIOverrides() {\r\n\tHooks.on(\"renderPlayerList\", addTradeButton);\r\n\tHooks.on(\"getActorDirectoryEntryContext\", insertActorContextMenuItems);\r\n\tHooks.on(\"getActorSheetHeaderButtons\", insertActorHeaderButtons);\r\n\tHooks.on(\"getItemSheetHeaderButtons\", insertItemHeaderButtons);\r\n\tHooks.on(\"renderSidebarTab\", hideTemporaryItems);\r\n\tHooks.on(\"renderTokenHUD\", renderPileHUD);\r\n\tHooks.on(\"hoverToken\", handleTokenBorders);\r\n\tHooks.on(\"controlToken\", handleTokenBorders);\r\n\tfastToolTip = new FastTooltipManager();\r\n\tfastToolTip.activateEventListeners();\r\n}\r\n\r\nfunction handleTokenBorders(token) {\r\n\tif (!isValidItemPile(token)) return;\r\n\tconst setting = Helpers.getSetting(SETTINGS.HIDE_TOKEN_BORDER);\r\n\ttoken.border.renderable = token.controlled ||\r\n\t\t(setting !== SETTINGS.HIDE_TOKEN_BORDER_OPTIONS.EVERYONE && (\r\n\t\t\tsetting === SETTINGS.HIDE_TOKEN_BORDER_OPTIONS.SHOW\r\n\t\t\t||\r\n\t\t\t(setting === SETTINGS.HIDE_TOKEN_BORDER_OPTIONS.PLAYERS && game.user.isGM)\r\n\t\t));\r\n}\r\n\r\nfunction hideTemporaryItems(sidebar) {\r\n\tif (sidebar.tabName !== \"items\") return;\r\n\tArray.from(game.items).filter(item => {\r\n\t\t\treturn foundry.utils.getProperty(item.toObject(), CONSTANTS.FLAGS.TEMPORARY_ITEM);\r\n\t\t})\r\n\t\t.forEach(item => {\r\n\t\t\tconst element = sidebar.element.find(`.directory-item[data-document-id=\"${item.id}\"]`);\r\n\t\t\tif (!element.length) return;\r\n\t\t\tif (element.parent().children().length === 1) {\r\n\t\t\t\treturn element.parent().empty();\r\n\t\t\t}\r\n\t\t\telement.find(`.directory-item[data-document-id=\"${item.id}\"]`).remove();\r\n\t\t});\r\n}\r\n\r\nfunction addTradeButton(app, html) {\r\n\tif (!Helpers.getSetting(SETTINGS.ENABLE_TRADING) || !Helpers.getSetting(SETTINGS.SHOW_TRADE_BUTTON)) return;\r\n\r\n\tconst minimalUI = game.modules.get('minimal-ui')?.active;\r\n\tconst classes = \"item-piles-player-list-trade-button\" + (minimalUI ? \" item-piles-minimal-ui\" : \"\");\r\n\tconst text = !minimalUI ? game.i18n.localize(\"ITEM-PILES.ContextMenu.RequestTrade\") : \"\";\r\n\tconst button = $(`<button type=\"button\" class=\"${classes}\"><i class=\"fas fa-handshake\"></i>${text}</button>`)\r\n\r\n\tbutton.click(() => {\r\n\t\tgame.itempiles.API.requestTrade();\r\n\t});\r\n\thtml.append(button);\r\n}\r\n\r\nfunction insertActorContextMenuItems(html, menuItems) {\r\n\r\n\tmenuItems.push({\r\n\t\tname: \"Item Piles: \" + game.i18n.localize(\"ITEM-PILES.ContextMenu.ShowToPlayers\"),\r\n\t\ticon: `<i class=\"fas fa-eye\"></i>`,\r\n\t\tcallback: async (html) => {\r\n\t\t\tconst actorId = html[0].dataset.documentId;\r\n\t\t\tconst actor = game.actors.get(actorId);\r\n\t\t\tconst activeUsers = Array.from(game.users).filter(u => u.active && u !== game.user).map(u => u.id);\r\n\t\t\tif (!activeUsers.length) {\r\n\t\t\t\treturn Helpers.custom_warning(game.i18n.localize(\"ITEM-PILES.Warnings.NoPlayersActive\"), true);\r\n\t\t\t}\r\n\t\t\tconst users = await UserSelectDialog.show();\r\n\t\t\tif (!users || !users.length) return;\r\n\t\t\tHelpers.custom_notify(game.i18n.format(\"ITEM-PILES.Notifications.ShownToPlayers\", { actor_name: actor.name }))\r\n\t\t\treturn game.itempiles.API.renderItemPileInterface(actor, { userIds: users, useDefaultCharacter: true });\r\n\t\t},\r\n\t\tcondition: (html) => {\r\n\t\t\tconst actorId = html[0].dataset.documentId;\r\n\t\t\tconst actor = game.actors.get(actorId);\r\n\t\t\treturn game.user.isGM && PileUtilities.isValidItemPile(actor);\r\n\t\t}\r\n\t}, {\r\n\t\tname: \"Item Piles: \" + game.i18n.localize(\"ITEM-PILES.ContextMenu.RequestTrade\"),\r\n\t\ticon: `<i class=\"fas fa-handshake\"></i>`,\r\n\t\tcallback: (html) => {\r\n\t\t\tconst actorId = html[0].dataset.documentId;\r\n\t\t\tconst actor = game.actors.get(actorId);\r\n\t\t\tconst user = Array.from(game.users).find(u => u.character === actor && u.active);\r\n\t\t\treturn game.itempiles.API.requestTrade(user);\r\n\t\t},\r\n\t\tcondition: (html) => {\r\n\t\t\tconst actorId = html[0].dataset.documentId;\r\n\t\t\tconst actor = game.actors.get(actorId);\r\n\t\t\treturn Helpers.getSetting(SETTINGS.ENABLE_TRADING)\r\n\t\t\t\t&& (game.user?.character !== actor || Array.from(game.users).find(u => u.character === actor && u.active));\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction insertActorHeaderButtons(actorSheet, buttons) {\r\n\r\n\tif (!game.user.isGM || Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_BUTTON)) return;\r\n\r\n\tlet obj = actorSheet?.object ?? actorSheet?.actor;\r\n\r\n\tbuttons.unshift({\r\n\t\tlabel: Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT)\r\n\t\t\t? \"\"\r\n\t\t\t: game.i18n.localize(\"ITEM-PILES.HeaderButtons.Configure\"),\r\n\t\ticon: \"fas fa-box-open\",\r\n\t\tclass: \"item-piles-config-button\",\r\n\t\tonclick: () => {\r\n\t\t\tItemPileConfig.show(obj);\r\n\t\t}\r\n\t})\r\n}\r\n\r\nfunction insertItemHeaderButtons(itemSheet, buttons) {\r\n\r\n\tif (!game.user.isGM || Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_BUTTON)) return;\r\n\r\n\tlet obj = itemSheet?.object ?? itemSheet?.item;\r\n\r\n\tbuttons.unshift({\r\n\t\tlabel: !Helpers.getSetting(SETTINGS.HIDE_ACTOR_HEADER_TEXT) ? game.i18n.localize(\"ITEM-PILES.HeaderButtons.Configure\") : \"\",\r\n\t\ticon: \"fas fa-box-open\",\r\n\t\tclass: \"item-piles-config-button\",\r\n\t\tonclick: async (event) => {\r\n\t\t\tif (game.modules.get(\"item-linking\")?.active && !event.ctrlKey) {\r\n\t\t\t\tconst linkedItemUuid = foundry.utils.getProperty(obj, \"flags.item-linking.baseItem\") ?? false;\r\n\t\t\t\tif (linkedItemUuid) {\r\n\t\t\t\t\tobj = await fromUuid(linkedItemUuid);\r\n\t\t\t\t\treturn ItemEditor.show(obj, {\r\n\t\t\t\t\t\textraTitle: \" - Compendium\"\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn ItemEditor.show(obj);\r\n\t\t}\r\n\t})\r\n}\r\n\r\nfunction renderPileHUD(app, html) {\r\n\r\n\tconst document = app?.object?.document;\r\n\r\n\tif (!document) return;\r\n\r\n\tif (!PileUtilities.isValidItemPile(document)) return;\r\n\r\n\tif (PileUtilities.isItemPileContainer(document)) {\r\n\r\n\t\tconst pileData = PileUtilities.getActorFlagData(document);\r\n\r\n\t\tconst container = $(`<div class=\"col right\" style=\"right:-130px;\"></div>`);\r\n\r\n\t\tconst lock_button = $(`<div class=\"control-icon item-piles\" data-fast-tooltip=\"${game.i18n.localize(\"ITEM-PILES.HUD.ToggleLocked\")}\"><i class=\"fas fa-lock${pileData.locked ? \"\" : \"-open\"}\"></i></div>`);\r\n\t\tlock_button.click(async function () {\r\n\t\t\t$(this).find('.fas').toggleClass('fa-lock').toggleClass('fa-lock-open');\r\n\t\t\tawait game.itempiles.API.toggleItemPileLocked(document);\r\n\t\t});\r\n\t\tcontainer.append(lock_button);\r\n\r\n\t\tconst open_button = $(`<div class=\"control-icon item-piles\" data-fast-tooltip=\"${game.i18n.localize(\"ITEM-PILES.HUD.ToggleClosed\")}\"><i class=\"fas fa-box${pileData.closed ? \"\" : \"-open\"}\"></i></div>`);\r\n\t\topen_button.click(async function () {\r\n\t\t\t$(this).find('.fas').toggleClass('fa-box').toggleClass('fa-box-open');\r\n\t\t\tawait game.itempiles.API.toggleItemPileClosed(document);\r\n\t\t});\r\n\t\tcontainer.append(open_button);\r\n\r\n\t\tconst configure_button = $(`<div class=\"control-icon item-piles\" data-fast-tooltip=\"${game.i18n.localize(\"ITEM-PILES.HUD.Configure\")}\"><i class=\"fas fa-toolbox\"></i></div>`);\r\n\t\tconfigure_button.click(async function () {\r\n\t\t\tItemPileConfig.show(document);\r\n\t\t});\r\n\t\tcontainer.append(configure_button);\r\n\r\n\t\thtml.append(container)\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass FastTooltipManager extends TooltipManager {\r\n\r\n\t/**\r\n\t * An amount of margin which is used to offset tooltips from their anchored element.\r\n\t * @type {number}\r\n\t */\r\n\tstatic TOOLTIP_MARGIN_PX = 5;\r\n\t/**\r\n\t * The number of milliseconds delay which activates a tooltip on a \"long hover\".\r\n\t * @type {number}\r\n\t */\r\n\tstatic TOOLTIP_ACTIVATION_MS = 500;\r\n\t/**\r\n\t * The number of milliseconds delay which activates a tooltip on a \"long hover\".\r\n\t * @type {number}\r\n\t */\r\n\tstatic TOOLTIP_DEACTIVATION_MS = 500;\r\n\t/**\r\n\t * The directions in which a tooltip can extend, relative to its tool-tipped element.\r\n\t * @enum {string}\r\n\t */\r\n\tstatic TOOLTIP_DIRECTIONS = {\r\n\t\tUP: \"UP\",\r\n\t\tDOWN: \"DOWN\",\r\n\t\tLEFT: \"LEFT\",\r\n\t\tRIGHT: \"RIGHT\",\r\n\t\tCENTER: \"CENTER\"\r\n\t};\r\n\t/**\r\n\t * A reference to the HTML element which is currently tool-tipped, if any.\r\n\t * @type {HTMLElement|null}\r\n\t */\r\n\telement = null;\r\n\t/**\r\n\t * Is the tooltip currently active?\r\n\t * @type {boolean}\r\n\t */\r\n\t#active = false;\r\n\t/**\r\n\t * A reference to a window timeout function when an element is activated.\r\n\t * @private\r\n\t */\r\n\t#activationTimeout;\r\n\t/**\r\n\t * A reference to a window timeout function when an element is deactivated.\r\n\t * @private\r\n\t */\r\n\t#deactivationTimeout;\r\n\t/**\r\n\t * An element which is pending tooltip activation if hover is sustained\r\n\t * @type {HTMLElement|null}\r\n\t */\r\n\t#pending;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tconst tooltipElem = $(`<aside id=\"fast-tooltip\" role=\"tooltip\"></aside>`);\r\n\t\t$(\"body\").append(tooltipElem);\r\n\t\tthis.tooltip = document.getElementById(\"fast-tooltip\");\r\n\t}\r\n\r\n\t/* -------------------------------------------- */\r\n\r\n\t/**\r\n\t * Activate interactivity by listening for hover events on HTML elements which have a data-fast-tooltip defined.\r\n\t */\r\n\tactivateEventListeners() {\r\n\t\tdocument.body.addEventListener(\"pointerenter\", this.#onActivate.bind(this), true);\r\n\t\tdocument.body.addEventListener(\"pointerleave\", this.#onDeactivate.bind(this), true);\r\n\t}\r\n\r\n\t/* -------------------------------------------- */\r\n\r\n\t/**\r\n\t * Handle hover events which activate a tooltipped element.\r\n\t * @param {PointerEvent} event    The initiating pointerenter event\r\n\t */\r\n\t#onActivate(event) {\r\n\t\tif (Tour.tourInProgress) return; // Don't activate tooltips during a tour\r\n\t\tconst element = event.target;\r\n\t\tif (!element.dataset.fastTooltip) {\r\n\t\t\t// Check if the element has moved out from underneath the cursor and pointerenter has fired on a non-child of the\r\n\t\t\t// tooltipped element.\r\n\t\t\tif (this.#active && this.element && !this.element.contains(element)) this.#startDeactivation();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Don't activate tooltips if the element contains an active context menu\r\n\t\tif (element.matches(\"#context-menu\") || element.querySelector(\"#context-menu\")) return;\r\n\r\n\t\t// If the tooltip is currently active, we can move it to a new element immediately\r\n\t\tif (this.#active) this.activate(element);\r\n\t\telse this.#clearDeactivation();\r\n\r\n\t\t// Otherwise, delay activation to determine user intent\r\n\t\tthis.#pending = element;\r\n\t\tthis.#activationTimeout = window.setTimeout(() => {\r\n\t\t\tthis.activate(element);\r\n\t\t}, Number(element?.dataset?.tooltipActivationSpeed) ?? this.constructor.TOOLTIP_ACTIVATION_MS);\r\n\t}\r\n\r\n\tactivate(element, { text, direction, cssClass } = {}) {\r\n\r\n\t\t// Check if the element still exists in the DOM.\r\n\t\tif (!document.body.contains(element)) return;\r\n\t\tthis.#clearDeactivation();\r\n\r\n\t\t// Mark the element as active\r\n\t\tthis.#active = true;\r\n\t\tthis.element = element;\r\n\t\telement.setAttribute(\"aria-describedby\", \"fast-tooltip\");\r\n\t\tthis.tooltip.innerHTML = text || game.i18n.localize(element.dataset.fastTooltip);\r\n\r\n\t\t// Activate display of the tooltip\r\n\t\tthis.tooltip.removeAttribute(\"class\");\r\n\t\tthis.tooltip.classList.add(\"active\");\r\n\t\tif (cssClass) this.tooltip.classList.add(cssClass);\r\n\r\n\t\t// Set tooltip position\r\n\t\tdirection = direction || element.closest(\"[data-tooltip-direction]\")?.dataset.tooltipDirection;\r\n\t\tif (!direction) direction = this._determineDirection();\r\n\t\tthis._setAnchor(direction);\r\n\t}\r\n\r\n\t/* -------------------------------------------- */\r\n\r\n\t/**\r\n\t * Handle hover events which deactivate a tooltipped element.\r\n\t * @param {PointerEvent} event    The initiating pointerleave event\r\n\t */\r\n\t#onDeactivate(event) {\r\n\t\tif (event.target !== (this.element ?? this.#pending)) return;\r\n\t\tthis.#startDeactivation();\r\n\t}\r\n\r\n\t/* -------------------------------------------- */\r\n\r\n\t/**\r\n\t * Start the deactivation process.\r\n\t */\r\n\t#startDeactivation() {\r\n\t\t// Clear any existing activation workflow\r\n\t\twindow.clearTimeout(this.#activationTimeout);\r\n\t\tthis.#pending = this.#activationTimeout = null;\r\n\r\n\t\t// Delay deactivation to confirm whether some new element is now pending\r\n\t\twindow.clearTimeout(this.#deactivationTimeout);\r\n\t\tthis.#deactivationTimeout = window.setTimeout(() => {\r\n\t\t\tif (!this.#pending) this.deactivate();\r\n\t\t}, Number(this.element?.dataset?.tooltipDeactivationSpeed) ?? this.constructor.TOOLTIP_DEACTIVATION_MS);\r\n\t}\r\n\r\n\t/* -------------------------------------------- */\r\n\r\n\t/**\r\n\t * Clear any existing deactivation workflow.\r\n\t */\r\n\t#clearDeactivation() {\r\n\t\twindow.clearTimeout(this.#deactivationTimeout);\r\n\t\tthis.#pending = this.#deactivationTimeout = null;\r\n\t}\r\n}\r\n","import CONSTANTS from \"./constants/constants.js\";\r\nimport PrivateAPI from \"./API/private-api.js\";\r\nimport * as PileUtilities from \"./helpers/pile-utilities.js\";\r\nimport * as Helpers from \"./helpers/helpers.js\";\r\nimport { hotkeyActionState } from \"./hotkeys.js\";\r\nimport { SYSTEMS } from \"./systems.js\";\r\n\r\nexport default function registerLibwrappers() {\r\n\r\n\tlibWrapper.register(CONSTANTS.MODULE_NAME, 'Token.prototype._onClickLeft2', function (wrapped, ...args) {\r\n\t\tif (PileUtilities.isValidItemPile(this.document) && hotkeyActionState.openPileInventory) {\r\n\t\t\treturn PrivateAPI._itemPileClicked(this.document);\r\n\t\t}\r\n\t\treturn wrapped(...args);\r\n\t}, \"MIXED\");\r\n\r\n\tconst versionIsEleven = foundry.utils.isNewerVersion(game.version, \"10.999\");\r\n\r\n\tconst overrideMethod = versionIsEleven\r\n\t\t? `DocumentDirectory.prototype._onClickEntryName`\r\n\t\t: `SidebarDirectory.prototype._onClickDocumentName`;\r\n\r\n\tlibWrapper.register(CONSTANTS.MODULE_NAME, overrideMethod, function (wrapped, event) {\r\n\t\tevent.preventDefault();\r\n\t\tconst element = event.currentTarget;\r\n\t\tif (!(this instanceof Compendium)) {\r\n\t\t\tconst documentId = element.parentElement.dataset.documentId;\r\n\t\t\tconst document = this.constructor.collection.get(documentId);\r\n\t\t\tif (PileUtilities.isValidItemPile(document)) {\r\n\t\t\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_DIRECTORY_CLICK, document);\r\n\t\t\t\tif (hookResult === false) return false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn wrapped(event);\r\n\t}, \"MIXED\");\r\n\r\n\tHooks.on(CONSTANTS.HOOKS.PRE_RENDER_SHEET, (doc, forced, options) => {\r\n\t\tconst renderItemPileInterface = forced && !options?.bypassItemPiles && PileUtilities.isValidItemPile(doc) && hotkeyActionState.openPileInventory;\r\n\t\tif (!renderItemPileInterface) return;\r\n\t\tgame.itempiles.API.renderItemPileInterface(doc, { useDefaultCharacter: true });\r\n\t\treturn false;\r\n\t})\r\n\r\n\tlibWrapper.register(CONSTANTS.MODULE_NAME, `ActorSheet.prototype.render`, function (wrapped, forced, options, ...args) {\r\n\t\tconst renderItemPileInterface = Hooks.call(CONSTANTS.HOOKS.PRE_RENDER_SHEET, this.document, forced, options) === false;\r\n\t\tif (this._state > Application.RENDER_STATES.NONE) {\r\n\t\t\tif (renderItemPileInterface) {\r\n\t\t\t\twrapped(forced, options, ...args)\r\n\t\t\t} else {\r\n\t\t\t\treturn wrapped(forced, options, ...args)\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (renderItemPileInterface) return;\r\n\t\treturn wrapped(forced, options, ...args);\r\n\t}, \"MIXED\");\r\n\r\n\tlibWrapper.register(CONSTANTS.MODULE_NAME, \"DragDrop.prototype.callback\", function (wrapped, event, type) {\r\n\t\tconst result = wrapped(event, type)\r\n\t\tconst hookType = {\r\n\t\t\t\"dragstart\": CONSTANTS.HOOKS.DRAG_DOCUMENT,\r\n\t\t\t\"drop\": CONSTANTS.HOOKS.DROP_DOCUMENT,\r\n\t\t}[type] ?? false;\r\n\t\tif (hookType) {\r\n\t\t\ttry {\r\n\t\t\t\tconst value = JSON.parse(event.dataTransfer.getData(\"text/plain\"));\r\n\t\t\t\tHooks.callAll(hookType, value);\r\n\t\t\t} catch (err) {\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}, \"WRAPPER\")\r\n\r\n\tif (SYSTEMS.DATA.SHEET_OVERRIDES) {\r\n\t\tSYSTEMS.DATA.SHEET_OVERRIDES();\r\n\t}\r\n\r\n}\r\n","import * as Helpers from \"../helpers/helpers.js\";\r\nimport * as Utilities from \"../helpers/utilities.js\";\r\nimport * as PileUtilities from \"../helpers/pile-utilities.js\";\r\nimport * as SharingUtilities from \"../helpers/sharing-utilities.js\";\r\nimport * as CompendiumUtilities from \"../helpers/compendium-utilities.js\";\r\nimport CONSTANTS from \"../constants/constants.js\";\r\nimport SETTINGS from \"../constants/settings.js\";\r\nimport ItemPileSocket from \"../socket.js\";\r\nimport TradeAPI from \"./trade-api.js\";\r\nimport PrivateAPI from \"./private-api.js\";\r\nimport { SYSTEMS } from \"../systems.js\";\r\nimport ItemPileConfig from \"../applications/item-pile-config/item-pile-config.js\";\r\n\r\nclass API {\r\n\t/**\r\n\t * @class API\r\n\t */\r\n\r\n\t/**\r\n\t * The actor class type used for the original item pile actor in this system\r\n\t *\r\n\t * @returns {string}\r\n\t */\r\n\tstatic get ACTOR_CLASS_TYPE() {\r\n\t\treturn Helpers.getSetting(SETTINGS.ACTOR_CLASS_TYPE);\r\n\t}\r\n\r\n\t/**\r\n\t * The item class type is the type of item that will be used for the default loot item\r\n\t *\r\n\t * @returns {string}\r\n\t */\r\n\tstatic get ITEM_CLASS_LOOT_TYPE() {\r\n\t\treturn Helpers.getSetting(SETTINGS.ITEM_CLASS_LOOT_TYPE);\r\n\t}\r\n\r\n\t/**\r\n\t * The item class type is the type of item that will be used for the default weapon item\r\n\t *\r\n\t * @returns {string}\r\n\t */\r\n\tstatic get ITEM_CLASS_WEAPON_TYPE() {\r\n\t\treturn Helpers.getSetting(SETTINGS.ITEM_CLASS_WEAPON_TYPE);\r\n\t}\r\n\r\n\t/**\r\n\t * The item class type is the type of item that will be used for the default equipment item\r\n\t *\r\n\t * @returns {string}\r\n\t */\r\n\tstatic get ITEM_CLASS_EQUIPMENT_TYPE() {\r\n\t\treturn Helpers.getSetting(SETTINGS.ITEM_CLASS_EQUIPMENT_TYPE);\r\n\t}\r\n\r\n\t/**\r\n\t * The currencies used in this system\r\n\t *\r\n\t * @returns {Array<{primary: boolean, name: string, data: Object, img: string, abbreviation: string, exchange: number}>}\r\n\t */\r\n\tstatic get CURRENCIES() {\r\n\t\treturn foundry.utils.deepClone(Helpers.getSetting(SETTINGS.CURRENCIES).map(currency => {\r\n\t\t\tif (currency.type === \"item\" && currency.data.uuid) {\r\n\t\t\t\tconst compendiumItem = CompendiumUtilities.getItemFromCache(currency.data.uuid);\r\n\t\t\t\tif (compendiumItem) {\r\n\t\t\t\t\tcurrency.data.item = compendiumItem;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdelete currency[\"quantity\"];\r\n\t\t\tcurrency.secondary = false;\r\n\t\t\treturn currency;\r\n\t\t}));\r\n\t}\r\n\r\n\t/**\r\n\t * The secondary currencies used in this system\r\n\t *\r\n\t * @returns {Array<{name: string, data: Object, img: string, abbreviation: string}>}\r\n\t */\r\n\tstatic get SECONDARY_CURRENCIES() {\r\n\t\treturn foundry.utils.deepClone(Helpers.getSetting(SETTINGS.SECONDARY_CURRENCIES).map(currency => {\r\n\t\t\tif (currency.type === \"item\" && currency.data.uuid) {\r\n\t\t\t\tconst compendiumItem = CompendiumUtilities.getItemFromCache(currency.data.uuid);\r\n\t\t\t\tif (compendiumItem) {\r\n\t\t\t\t\tcurrency.data.item = compendiumItem;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdelete currency[\"quantity\"];\r\n\t\t\tcurrency.secondary = true;\r\n\t\t\treturn currency;\r\n\t\t}));\r\n\t}\r\n\r\n\t/**\r\n\t * The smallest decimal digits shown for any fractional currency amounts. Only used when there is only one currency.\r\n\t *\r\n\t * @returns {Number}\r\n\t */\r\n\tstatic get CURRENCY_DECIMAL_DIGITS() {\r\n\t\treturn Helpers.getSetting(SETTINGS.CURRENCY_DECIMAL_DIGITS);\r\n\t}\r\n\r\n\t/**\r\n\t * The attribute used to track the price of items in this system\r\n\t *\r\n\t * @returns {string}\r\n\t */\r\n\tstatic get ITEM_PRICE_ATTRIBUTE() {\r\n\t\treturn Helpers.getSetting(SETTINGS.ITEM_PRICE_ATTRIBUTE);\r\n\t}\r\n\r\n\t/**\r\n\t * The attribute used to track the quantity of items you would get for the price of an item\r\n\t *\r\n\t * @returns {string}\r\n\t */\r\n\tstatic get QUANTITY_FOR_PRICE_ATTRIBUTE() {\r\n\t\treturn Helpers.getSetting(SETTINGS.QUANTITY_FOR_PRICE_ATTRIBUTE);\r\n\t}\r\n\r\n\t/**\r\n\t * The attribute used to track the quantity of items in this system\r\n\t *\r\n\t * @returns {string}\r\n\t */\r\n\tstatic get ITEM_QUANTITY_ATTRIBUTE() {\r\n\t\treturn Helpers.getSetting(SETTINGS.ITEM_QUANTITY_ATTRIBUTE);\r\n\t}\r\n\r\n\t/**\r\n\t * The filters for item types eligible for interaction within this system\r\n\t *\r\n\t * @returns {Array<{name: string, filters: string}>}\r\n\t */\r\n\tstatic get ITEM_FILTERS() {\r\n\t\treturn Helpers.getSetting(SETTINGS.ITEM_FILTERS);\r\n\t}\r\n\r\n\t/**\r\n\t * The attributes for detecting item similarities\r\n\t *\r\n\t * @returns {Array<string>}\r\n\t */\r\n\tstatic get ITEM_SIMILARITIES() {\r\n\t\treturn Helpers.getSetting(SETTINGS.ITEM_SIMILARITIES);\r\n\t}\r\n\r\n\t/**\r\n\t * The types of items that will always be considered unique when transferring between actors\r\n\t *\r\n\t * @returns {Array<string>}\r\n\t */\r\n\tstatic get UNSTACKABLE_ITEM_TYPES() {\r\n\t\treturn Helpers.getSetting(SETTINGS.UNSTACKABLE_ITEM_TYPES);\r\n\t}\r\n\r\n\t/**\r\n\t * The system specific default values for item pile actors created in this system\r\n\t *\r\n\t * @returns {Object}\r\n\t */\r\n\tstatic get PILE_DEFAULTS() {\r\n\t\treturn Helpers.getSetting(SETTINGS.PILE_DEFAULTS);\r\n\t}\r\n\r\n\t/**\r\n\t * The system specific default values for item pile tokens created in this system\r\n\t *\r\n\t * @returns {Object}\r\n\t */\r\n\tstatic get TOKEN_FLAG_DEFAULTS() {\r\n\t\treturn Helpers.getSetting(SETTINGS.TOKEN_FLAG_DEFAULTS);\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the actor class type used for the original item pile actor in this system\r\n\t *\r\n\t * @param {string} inClassType\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async setActorClassType(inClassType) {\r\n\t\tif (typeof inClassType !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(\"setActorTypeClass | inClassType must be of type string\");\r\n\t\t}\r\n\t\treturn Helpers.setSetting(SETTINGS.ACTOR_CLASS_TYPE, inClassType);\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the currencies used in this system\r\n\t *\r\n\t * @param {Array<Object>} inCurrencies\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async setCurrencies(inCurrencies) {\r\n\t\tif (!Array.isArray(inCurrencies)) {\r\n\t\t\tthrow Helpers.custom_error(\"setCurrencies | inCurrencies must be an array\");\r\n\t\t}\r\n\t\tinCurrencies.forEach(currency => {\r\n\t\t\tif (typeof currency !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setCurrencies | each entry in inCurrencies must be of type object\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.primary !== \"boolean\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setCurrencies | currency.primary must be of type boolean\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.name !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setCurrencies | currency.name must be of type string\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.abbreviation !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setCurrencies | currency.abbreviation must be of type string\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.exchangeRate !== \"number\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setCurrencies | currency.exchangeRate must be of type number\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.data !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setCurrencies | currency.data must be of type object\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.data.path !== \"string\" && typeof currency.data.uuid !== \"string\" && typeof currency.data.item !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setCurrencies | currency.data must contain either \\\"path\\\" (string), \\\"uuid\\\" (string), or \\\"item\\\" (object)\");\r\n\t\t\t}\r\n\t\t\tif (currency.img && typeof currency.img !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setCurrencies | currency.img must be of type string\");\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn Helpers.setSetting(SETTINGS.CURRENCIES, inCurrencies);\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the secondary currencies used in this system\r\n\t *\r\n\t * @param {Array<Object>} inSecondaryCurrencies\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async setSecondaryCurrencies(inSecondaryCurrencies) {\r\n\t\tif (!Array.isArray(inSecondaryCurrencies)) {\r\n\t\t\tthrow Helpers.custom_error(\"setSecondaryCurrencies | inSecondaryCurrencies must be an array\");\r\n\t\t}\r\n\t\tinSecondaryCurrencies.forEach(currency => {\r\n\t\t\tif (typeof currency !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setSecondaryCurrencies | each entry in inSecondaryCurrencies must be of type object\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.name !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setSecondaryCurrencies | currency.name must be of type string\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.abbreviation !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setSecondaryCurrencies | currency.abbreviation must be of type string\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.data !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setSecondaryCurrencies | currency.data must be of type object\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.data.path !== \"string\" && typeof currency.data.uuid !== \"string\" && typeof currency.data.item !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setSecondaryCurrencies | currency.data must contain either \\\"path\\\" (string), \\\"uuid\\\" (string), or \\\"item\\\" (object)\");\r\n\t\t\t}\r\n\t\t\tif (currency.img && typeof currency.img !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setSecondaryCurrencies | currency.img must be of type string\");\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn Helpers.setSetting(SETTINGS.SECONDARY_CURRENCIES, inSecondaryCurrencies);\r\n\t}\r\n\r\n\t/**\r\n\t * Set the smallest decimal digits shown for any fractional currency amounts. Only used when there is only one currency.\r\n\t *\r\n\t * @param {Number} inDecimalDigits\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic setCurrencyDecimalDigits(inDecimalDigits) {\r\n\t\tif (typeof inDecimalDigits !== \"number\") {\r\n\t\t\tthrow Helpers.custom_error(\"setCurrencyDecimalDigits | inDecimalDigits must be of type string\");\r\n\t\t}\r\n\t\treturn Helpers.setSetting(SETTINGS.CURRENCY_DECIMAL_DIGITS, inDecimalDigits);\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the attribute used to track the quantity of items in this system\r\n\t *\r\n\t * @param {string} inAttribute\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async setItemQuantityAttribute(inAttribute) {\r\n\t\tif (typeof inAttribute !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(\"setItemQuantityAttribute | inAttribute must be of type string\");\r\n\t\t}\r\n\t\treturn Helpers.setSetting(SETTINGS.ITEM_QUANTITY_ATTRIBUTE, inAttribute);\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the attribute used to track the price of items in this system\r\n\t *\r\n\t * @param {string} inAttribute\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async setItemPriceAttribute(inAttribute) {\r\n\t\tif (typeof inAttribute !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(\"setItemPriceAttribute | inAttribute must be of type string\");\r\n\t\t}\r\n\t\treturn Helpers.setSetting(SETTINGS.ITEM_PRICE_ATTRIBUTE, inAttribute);\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the attribute used to track the price of items in this system\r\n\t *\r\n\t * @param {string} inAttribute\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async setQuantityForPriceAttribute(inAttribute) {\r\n\t\tif (typeof inAttribute !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(\"setQuantityForPriceAttribute | inAttribute must be of type string\");\r\n\t\t}\r\n\t\treturn Helpers.setSetting(SETTINGS.QUANTITY_FOR_PRICE_ATTRIBUTE, inAttribute);\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the items filters for interaction within this system\r\n\t *\r\n\t * @param {Array<{path: string, filters: string}>} inFilters\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async setItemFilters(inFilters) {\r\n\t\tif (!Array.isArray(inFilters)) {\r\n\t\t\tthrow Helpers.custom_error(\"setItemFilters | inFilters must be of type array\");\r\n\t\t}\r\n\t\tinFilters.forEach(filter => {\r\n\t\t\tif (typeof filter?.path !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setItemFilters | each entry in inFilters must have a \\\"path\\\" property with a value that is of type string\");\r\n\t\t\t}\r\n\t\t\tif (typeof filter?.filters !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setItemFilters | each entry in inFilters must have a \\\"filters\\\" property with a value that is of type string\");\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn Helpers.setSetting(SETTINGS.ITEM_FILTERS, inFilters);\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the attributes for detecting item similarities\r\n\t *\r\n\t * @param {Array<string>} inPaths\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async setItemSimilarities(inPaths) {\r\n\t\tif (!Array.isArray(inPaths)) {\r\n\t\t\tthrow Helpers.custom_error(\"setItemSimilarities | inPaths must be of type array\");\r\n\t\t}\r\n\t\tinPaths.forEach(path => {\r\n\t\t\tif (typeof path !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setItemSimilarities | each entry in inPaths must be of type string\");\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn Helpers.setSetting(SETTINGS.ITEM_SIMILARITIES, inPaths);\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the types of items that will always be considered unique when transferring between actors\r\n\t *\r\n\t * @param {Array<string>} inTypes\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async setUnstackableItemTypes(inTypes) {\r\n\t\tif (!Array.isArray(inTypes)) {\r\n\t\t\tthrow Helpers.custom_error(\"setUnstackableItemTypes | inTypes must be of type array\");\r\n\t\t}\r\n\t\tinTypes.forEach(path => {\r\n\t\t\tif (typeof path !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setUnstackableItemTypes | each entry in inTypes must be of type string\");\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn Helpers.setSetting(SETTINGS.UNSTACKABLE_ITEM_TYPES, inTypes);\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the types of items that will always be considered unique when transferring between actors\r\n\t *\r\n\t * @param {Object} inDefaults\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async setPileDefaults(inDefaults) {\r\n\t\tif (typeof inDefaults !== \"object\") {\r\n\t\t\tthrow Helpers.custom_error(\"setPileDefaults | inDefaults must be of type object\");\r\n\t\t}\r\n\t\tconst validKeys = new Set(Object.keys(CONSTANTS.PILE_DEFAULTS));\r\n\t\tfor (const key of Object.keys(inDefaults)) {\r\n\t\t\tif (!validKeys.has(key)) {\r\n\t\t\t\tthrow Helpers.custom_error(`setPileDefaults | ${key} is not a valid pile setting`);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn Helpers.setSetting(SETTINGS.PILE_DEFAULTS, inDefaults);\r\n\t}\r\n\r\n\t/**\r\n\t * Set the flags that will be applied to any tokens created through item piles\r\n\t *\r\n\t * @param {Object} inDefaults\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic async setTokenFlagDefaults(inDefaults) {\r\n\t\tif (typeof inDefaults !== \"object\") {\r\n\t\t\tthrow Helpers.custom_error(\"setTokenFlagDefaults | inDefaults must be of type object\");\r\n\t\t}\r\n\t\treturn Helpers.setSetting(SETTINGS.TOKEN_FLAG_DEFAULTS, inDefaults);\r\n\t}\r\n\r\n\t/**\r\n\t * A combination of all the methods above, but this integrates a system's specific\r\n\t * settings more readily into item piles, allowing users to also change the settings\r\n\t * afterward.\r\n\t *\r\n\t * @param {Object<{\r\n\t *   VERSION: string,\r\n\t *   ACTOR_CLASS_TYPE: string,\r\n\t *   ITEM_CLASS_LOOT_TYPE: string,\r\n\t *   ITEM_CLASS_WEAPON_TYPE: string,\r\n\t *   ITEM_CLASS_EQUIPMENT_TYPE: string,\r\n\t *   ITEM_QUANTITY_ATTRIBUTE: string,\r\n\t *   ITEM_PRICE_ATTRIBUTE: string,\r\n\t *   QUANTITY_FOR_PRICE_ATTRIBUTE: string,\r\n\t *   ITEM_FILTERS: Array<{path: string, filters: string}>,\r\n\t *   ITEM_SIMILARITIES: Array<string>,\r\n\t *   UNSTACKABLE_ITEM_TYPES: Array<string>,\r\n\t *   PILE_DEFAULTS: Object,\r\n\t *   TOKEN_FLAG_DEFAULTS: Object,\r\n\t *   ITEM_TRANSFORMER: undefined/Function,\r\n\t *   PRICE_MODIFIER_TRANSFORMER: undefined/Function,\r\n\t *   SYSTEM_HOOKS: undefined/Function,\r\n\t *   SHEET_OVERRIDES: undefined/Function,\r\n\t *   CURRENCIES: Array<{\r\n\t *     primary: boolean,\r\n\t *     type: string [\"attribute\"/\"item\"],\r\n\t *     img: string,\r\n\t *     abbreviation: string,\r\n\t *     data: Object<{ path: string }|{ uuid: string }|{ item: object }>,\r\n\t *     exchangeRate: number\r\n\t *   }>,\r\n\t *   SECONDARY_CURRENCIES: Array<{\r\n\t *     type: string [\"attribute\"/\"item\"],\r\n\t *     img: string,\r\n\t *     abbreviation: string,\r\n\t *     data: Object<{ path: string }|{ uuid: string }|{ item: object }>\r\n\t *   }>,\r\n\t *   CURRENCY_DECIMAL_DIGITS: undefined/number\r\n\t * }>} inData\r\n\t */\r\n\tstatic addSystemIntegration(inData) {\r\n\r\n\t\tconst data = foundry.utils.mergeObject({\r\n\t\t\tVERSION: \"\",\r\n\t\t\tACTOR_CLASS_TYPE: \"\",\r\n\t\t\tITEM_CLASS_LOOT_TYPE: \"\",\r\n\t\t\tITEM_CLASS_WEAPON_TYPE: \"\",\r\n\t\t\tITEM_CLASS_EQUIPMENT_TYPE: \"\",\r\n\t\t\tITEM_QUANTITY_ATTRIBUTE: \"\",\r\n\t\t\tITEM_PRICE_ATTRIBUTE: \"\",\r\n\t\t\tQUANTITY_FOR_PRICE_ATTRIBUTE: \"flags.item-piles.system.quantityForPrice\",\r\n\t\t\tITEM_FILTERS: [],\r\n\t\t\tITEM_SIMILARITIES: [],\r\n\t\t\tUNSTACKABLE_ITEM_TYPES: [],\r\n\t\t\tPILE_DEFAULTS: {},\r\n\t\t\tTOKEN_FLAG_DEFAULTS: {},\r\n\t\t\tITEM_TRANSFORMER: null,\r\n\t\t\tPRICE_MODIFIER_TRANSFORMER: null,\r\n\t\t\tSYSTEM_HOOKS: null,\r\n\t\t\tSHEET_OVERRIDES: null,\r\n\t\t\tCURRENCIES: [],\r\n\t\t\tSECONDARY_CURRENCIES: [],\r\n\t\t\tCURRENCY_DECIMAL_DIGITS: 0.00001\r\n\t\t}, inData)\r\n\r\n\t\tif (typeof data[\"VERSION\"] !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.VERSION must be of type string\");\r\n\t\t}\r\n\r\n\t\tif (typeof data[\"ACTOR_CLASS_TYPE\"] !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.ACTOR_CLASS_TYPE must be of type string\");\r\n\t\t}\r\n\r\n\t\tif (data[\"ITEM_CLASS_LOOT_TYPE\"] && typeof data[\"ITEM_CLASS_LOOT_TYPE\"] !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.ITEM_CLASS_LOOT_TYPE must be of type string\");\r\n\t\t}\r\n\r\n\t\tif (data[\"ITEM_CLASS_WEAPON_TYPE\"] && typeof data[\"ITEM_CLASS_WEAPON_TYPE\"] !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.ITEM_CLASS_WEAPON_TYPE must be of type string\");\r\n\t\t}\r\n\r\n\t\tif (data[\"ITEM_CLASS_EQUIPMENT_TYPE\"] && typeof data[\"ITEM_CLASS_EQUIPMENT_TYPE\"] !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.ITEM_CLASS_EQUIPMENT_TYPE must be of type string\");\r\n\t\t}\r\n\r\n\t\tif (typeof data[\"ITEM_QUANTITY_ATTRIBUTE\"] !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.ITEM_QUANTITY_ATTRIBUTE must be of type string\");\r\n\t\t}\r\n\r\n\t\tif (typeof data[\"ITEM_PRICE_ATTRIBUTE\"] !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.ITEM_PRICE_ATTRIBUTE must be of type string\");\r\n\t\t}\r\n\r\n\t\tif (data[\"QUANTITY_FOR_PRICE_ATTRIBUTE\"] && typeof data[\"QUANTITY_FOR_PRICE_ATTRIBUTE\"] !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.QUANTITY_FOR_PRICE_ATTRIBUTE must be of type string\");\r\n\t\t}\r\n\r\n\t\tif (!Array.isArray(data[\"ITEM_FILTERS\"])) {\r\n\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.ITEM_FILTERS must be of type array\");\r\n\t\t}\r\n\r\n\t\tdata[\"ITEM_FILTERS\"].forEach(filter => {\r\n\t\t\tif (typeof filter?.path !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | each entry in data.ITEM_FILTERS must have a \\\"path\\\" property with a value that is of type string\");\r\n\t\t\t}\r\n\t\t\tif (typeof filter?.filters !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | each entry in data.ITEM_FILTERS must have a \\\"filters\\\" property with a value that is of type string\");\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (data['ITEM_TRANSFORMER']) {\r\n\t\t\tif (!Helpers.isFunction(data['ITEM_TRANSFORMER'])) {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.ITEM_TRANSFORMER must be of type function\");\r\n\t\t\t}\r\n\t\t\tif (typeof data['ITEM_TRANSFORMER']({}) !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.ITEM_TRANSFORMER's return value must be of type object\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (data['PRICE_MODIFIER_TRANSFORMER']) {\r\n\t\t\tif (!Helpers.isFunction(data['PRICE_MODIFIER_TRANSFORMER'])) {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.PRICE_MODIFIER_TRANSFORMER must be of type function\");\r\n\t\t\t}\r\n\t\t\tif (typeof data['PRICE_MODIFIER_TRANSFORMER']({}) !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.PRICE_MODIFIER_TRANSFORMER's return value must be of type object\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (data['SYSTEM_HOOKS']) {\r\n\t\t\tif (!Helpers.isFunction(data['SYSTEM_HOOKS'])) {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.SYSTEM_HOOKS must be of type function\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (data['SHEET_OVERRIDES']) {\r\n\t\t\tif (!Helpers.isFunction(data['SHEET_OVERRIDES'])) {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.SHEET_OVERRIDES must be of type function\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (typeof data['PILE_DEFAULTS'] !== \"object\") {\r\n\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.PILE_DEFAULTS must be of type object\");\r\n\t\t}\r\n\t\tconst validKeys = new Set(Object.keys(CONSTANTS.PILE_DEFAULTS));\r\n\t\tfor (const key of Object.keys(data['PILE_DEFAULTS'])) {\r\n\t\t\tif (!validKeys.has(key)) {\r\n\t\t\t\tthrow Helpers.custom_error(`addSystemIntegration | data.PILE_DEFAULTS contains illegal key \"${key}\" that is not a valid pile default`);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (typeof data['TOKEN_FLAG_DEFAULTS'] !== \"object\") {\r\n\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.TOKEN_FLAG_DEFAULTS must be of type object\");\r\n\t\t}\r\n\r\n\t\tif (!Array.isArray(data['ITEM_SIMILARITIES'])) {\r\n\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.ITEM_SIMILARITIES must be of type array\");\r\n\t\t}\r\n\t\tdata['ITEM_SIMILARITIES'].forEach(path => {\r\n\t\t\tif (typeof path !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | each entry in data.ITEM_SIMILARITIES must be of type string\");\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (data['UNSTACKABLE_ITEM_TYPES']) {\r\n\t\t\tif (!Array.isArray(data['UNSTACKABLE_ITEM_TYPES'])) {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.UNSTACKABLE_ITEM_TYPES must be of type array\");\r\n\t\t\t}\r\n\t\t\tdata['UNSTACKABLE_ITEM_TYPES'].forEach(path => {\r\n\t\t\t\tif (typeof path !== \"string\") {\r\n\t\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | each entry in data.UNSTACKABLE_ITEM_TYPES must be of type string\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (!Array.isArray(data['CURRENCIES'])) {\r\n\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.CURRENCIES must be an array\");\r\n\t\t}\r\n\t\tdata['CURRENCIES'].forEach(currency => {\r\n\t\t\tif (typeof currency !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | CURRENCIES | each entry in data.CURRENCIES must be of type object\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.primary !== \"boolean\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | CURRENCIES | currency.primary must be of type boolean\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.name !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | CURRENCIES | currency.name must be of type string\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.abbreviation !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | CURRENCIES | currency.abbreviation must be of type string\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.exchangeRate !== \"number\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | CURRENCIES | currency.exchangeRate must be of type number\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.data !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | CURRENCIES | currency.data must be of type object\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.data.path !== \"string\" && typeof currency.data.uuid !== \"string\" && typeof currency.data.item !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | CURRENCIES | currency.data must contain either \\\"path\\\" (string), \\\"uuid\\\" (string), or \\\"item\\\" (object)\");\r\n\t\t\t}\r\n\t\t\tif (currency.img && typeof currency.img !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | CURRENCIES | currency.img must be of type string\");\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (!Array.isArray(data['SECONDARY_CURRENCIES'])) {\r\n\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.SECONDARY_CURRENCIES must be an array\");\r\n\t\t}\r\n\t\tdata['SECONDARY_CURRENCIES'].forEach(currency => {\r\n\t\t\tif (typeof currency !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | SECONDARY_CURRENCIES | each entry in data.SECONDARY_CURRENCIES must be of type object\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.name !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | SECONDARY_CURRENCIES | currency.name must be of type string\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.abbreviation !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | SECONDARY_CURRENCIES | currency.abbreviation must be of type string\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.data !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | SECONDARY_CURRENCIES | currency.data must be of type object\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.data.path !== \"string\" && typeof currency.data.uuid !== \"string\" && typeof currency.data.item !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | SECONDARY_CURRENCIES | currency.data must contain either \\\"path\\\" (string), \\\"uuid\\\" (string), or \\\"item\\\" (object)\");\r\n\t\t\t}\r\n\t\t\tif (currency.img && typeof currency.img !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | SECONDARY_CURRENCIES | currency.img must be of type string\");\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (data[\"CURRENCY_DECIMAL_DIGITS\"] && typeof data['CURRENCY_DECIMAL_DIGITS'] !== \"number\") {\r\n\t\t\tthrow Helpers.custom_error(\"addSystemIntegration | data.CURRENCY_DECIMAL_DIGITS must be of type number\");\r\n\t\t}\r\n\r\n\t\tdata['INTEGRATION'] = true;\r\n\r\n\t\tSYSTEMS.addSystem(data);\r\n\r\n\t\tHelpers.debug(`Registered system settings for ${game.system.id}`, data)\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Gets all the system item types, including custom item piles item categories\r\n\t *\r\n\t * @returns {Array<{primary: boolean, name: string, data: Object, img: string, abbreviation: string, exchange: number}>}\r\n\t */\r\n\tstatic getPrimaryCurrency(actor = false) {\r\n\t\tif (actor && actor instanceof Actor) {\r\n\t\t\treturn PileUtilities.getActorPrimaryCurrency(actor);\r\n\t\t}\r\n\t\treturn this.CURRENCIES.find(currency => currency.primary);\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieves all the system item types, including custom item piles item categories\r\n\t *\r\n\t * @returns {Object}\r\n\t */\r\n\tstatic getItemCategories() {\r\n\t\tlet systemTypes = Object.entries(CONFIG.Item.typeLabels).map(([key, value]) => {\r\n\t\t\treturn [key, game.i18n.localize(value)];\r\n\t\t});\r\n\t\tsystemTypes.shift();\r\n\t\tlet customItemPilesCategories = Array.from(new Set(Helpers.getSetting(SETTINGS.CUSTOM_ITEM_CATEGORIES))).map(cat => {\r\n\t\t\treturn [cat, cat];\r\n\t\t});\r\n\t\treturn Object.fromEntries(systemTypes.concat(customItemPilesCategories)\r\n\t\t\t.sort((a, b) => a[1] > b[1] ? 1 : -1));\r\n\t}\r\n\r\n\t/* ================= ITEM PILE METHODS ================= */\r\n\r\n\t/**\r\n\t * Creates an item pile token at a location, or an item pile actor, or both at the same time.\r\n\t *\r\n\t * @param {object} options                                          Options to pass to the function\r\n\t * @param {object/boolean} [options.position=false]                 Where to create the item pile, with x and y coordinates\r\n\t * @param {string/boolean} [options.sceneId=game.user.viewedScene]  Which scene to create the item pile on\r\n\t * @param {object} [options.tokenOverrides={}]                      Token data to apply to the newly created token\r\n\t * @param {object} [options.actorOverrides={}]                      Actor data to apply to the newly created actor (if unlinked)\r\n\t * @param {object} [options.itemPileFlags={}]                       Item pile specific flags to apply to the token and actor\r\n\t * @param {Array/boolean} [options.items=false]                     Any items to create on the item pile\r\n\t * @param {boolean} [options.createActor=false]                     Whether to create a new item pile actor\r\n\t * @param {string/boolean} [options.actor=false]                    The UUID, ID, or name of the actor to use when creating this item pile\r\n\t * @param {Array<string>/>string/boolean} [options.folders=false]   The folder to create the actor in, this can be an array of folder names, which will be traversed and created\r\n\t *\r\n\t * @returns {Promise<string>}\r\n\t */\r\n\tstatic async createItemPile({\r\n\t\tposition = false,\r\n\t\tsceneId = game.user.viewedScene,\r\n\t\ttokenOverrides = {},\r\n\t\tactorOverrides = {},\r\n\t\titemPileFlags = {},\r\n\t\titems = false,\r\n\t\tcreateActor = false,\r\n\t\tactor = false,\r\n\t\tfolders = false\r\n\t} = {}) {\r\n\r\n\t\tif (position) {\r\n\t\t\tif (typeof position !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(`createItemPile | position must be of type object`);\r\n\t\t\t} else if (!Helpers.isRealNumber(position.x) || !Helpers.isRealNumber(position.y)) {\r\n\t\t\t\tthrow Helpers.custom_error(`createItemPile | position.x and position.y must be of type numbers`);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (folders) {\r\n\t\t\tif (!Array.isArray(folders)) {\r\n\t\t\t\tfolders = [folders];\r\n\t\t\t}\r\n\t\t\tfolders.forEach(f => {\r\n\t\t\t\tif (typeof f !== 'string') {\r\n\t\t\t\t\tthrow Helpers.custom_error(`createItemPile | folder must be of type string or array of strings`);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (actor && !createActor) {\r\n\t\t\tif (typeof actor !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(`createItemPile | actor must be of type string`);\r\n\t\t\t}\r\n\t\t\tlet pileActor = await fromUuid(actor);\r\n\t\t\tif (!pileActor) {\r\n\t\t\t\tpileActor = game.actors.getName(actor);\r\n\t\t\t}\r\n\t\t\tif (!pileActor) {\r\n\t\t\t\tpileActor = game.actors.get(actor);\r\n\t\t\t}\r\n\t\t\tif (!pileActor) {\r\n\t\t\t\tthrow Helpers.custom_error(`createItemPile | Could not find actor with the identifier of \"${actor}\"`);\r\n\t\t\t}\r\n\t\t\tactor = pileActor.uuid;\r\n\t\t}\r\n\r\n\t\tif (typeof sceneId !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(`createItemPile | sceneId must be of type string`);\r\n\t\t}\r\n\r\n\t\tif (typeof tokenOverrides !== \"object\") {\r\n\t\t\tthrow Helpers.custom_error(`createItemPile | tokenOverrides must be of type object`);\r\n\t\t}\r\n\r\n\t\tif (typeof actorOverrides !== \"object\") {\r\n\t\t\tthrow Helpers.custom_error(`createItemPile | tokenOverrides must be of type object`);\r\n\t\t}\r\n\r\n\t\tif (typeof itemPileFlags !== \"object\") {\r\n\t\t\tthrow Helpers.custom_error(`createItemPile | tokenOverrides must be of type object`);\r\n\t\t}\r\n\r\n\t\tif (items) {\r\n\t\t\tif (!Array.isArray(items)) items = [items]\r\n\t\t\titems = items.map(item => {\r\n\t\t\t\treturn item instanceof Item ? item.toObject() : item;\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.CREATE_PILE, {\r\n\t\t\tsceneId, position, actor, createActor, items, tokenOverrides, actorOverrides, itemPileFlags, folders\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Turns tokens and its actors into item piles\r\n\t *\r\n\t * @param {Token/TokenDocument/Array<Token/TokenDocument>} targets  The targets to be turned into item piles\r\n\t * @param {object} options                                          Options to pass to the function\r\n\t * @param {object} options.pileSettings                             Overriding settings to be put on the item piles' settings\r\n\t * @param {object/Function} options.tokenSettings                   Overriding settings that will update the tokens' settings\r\n\t *\r\n\t * @return {Promise<Array>}                                         The uuids of the targets after they were turned into item piles\r\n\t */\r\n\tstatic turnTokensIntoItemPiles(targets, { pileSettings = {}, tokenSettings = {} } = {}) {\r\n\r\n\t\tif (!Array.isArray(targets)) targets = [targets];\r\n\r\n\t\tconst targetUuids = targets.map(target => {\r\n\t\t\tif (!(target instanceof Token || target instanceof TokenDocument)) {\r\n\t\t\t\tthrow Helpers.custom_error(`turnTokensIntoItemPiles | Target must be of type Token or TokenDocument`)\r\n\t\t\t}\r\n\t\t\tconst targetUuid = Utilities.getUuid(target);\r\n\t\t\tif (!targetUuid) throw Helpers.custom_error(`turnTokensIntoItemPiles | Could not determine the UUID, please provide a valid target`)\r\n\t\t\treturn targetUuid;\r\n\t\t})\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TURN_INTO_PILE, targetUuids, pileSettings, tokenSettings);\r\n\t}\r\n\r\n\t/**\r\n\t * Reverts tokens from an item pile into a normal token and actor\r\n\t *\r\n\t * @param {Token/TokenDocument/Array<Token/TokenDocument>} targets  The targets to be reverted from item piles\r\n\t * @param {object} options                                          Options to pass to the function\r\n\t * @param {object/Function} options.tokenSettings                   Overriding settings that will update the tokens\r\n\t *\r\n\t * @return {Promise<Array>}                                         The uuids of the targets after they were reverted from being item piles\r\n\t */\r\n\tstatic revertTokensFromItemPiles(targets, { tokenSettings = {} } = {}) {\r\n\r\n\t\tif (!Array.isArray(targets)) targets = [targets];\r\n\r\n\t\tconst targetUuids = targets.map(target => {\r\n\t\t\tif (!(target instanceof Token || target instanceof TokenDocument)) {\r\n\t\t\t\tthrow Helpers.custom_error(`revertTokensFromItemPiles | Target must be of type Token or TokenDocument`)\r\n\t\t\t}\r\n\t\t\tconst targetUuid = Utilities.getUuid(target);\r\n\t\t\tif (!targetUuid) throw Helpers.custom_error(`revertTokensFromItemPiles | Could not determine the UUID, please provide a valid target`)\r\n\t\t\treturn targetUuid;\r\n\t\t})\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.REVERT_FROM_PILE, targetUuids, tokenSettings);\r\n\t}\r\n\r\n\t/**\r\n\t * Opens a pile if it is enabled and a container\r\n\t *\r\n\t * @param {Token/TokenDocument} target\r\n\t * @param {Token/TokenDocument/boolean} [interactingToken=false]\r\n\t *\r\n\t * @return {Promise/boolean}\r\n\t */\r\n\tstatic openItemPile(target, interactingToken = false) {\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tif (!PileUtilities.isItemPileContainer(target)) return false;\r\n\t\tconst interactingTokenDocument = interactingToken ? Utilities.getActor(interactingToken) : false;\r\n\t\tconst pileData = PileUtilities.getActorFlagData(targetActor);\r\n\t\tconst wasLocked = pileData.locked;\r\n\t\tconst wasClosed = pileData.closed;\r\n\t\tpileData.closed = false;\r\n\t\tpileData.locked = false;\r\n\t\tif (wasLocked) {\r\n\t\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_UNLOCK, targetActor, pileData, interactingTokenDocument);\r\n\t\t\tif (hookResult === false) return false;\r\n\t\t}\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_OPEN, targetActor, pileData, interactingTokenDocument);\r\n\t\tif (hookResult === false) return false;\r\n\t\tif (wasClosed && pileData.openSound) {\r\n\t\t\tlet sound = pileData.openSound;\r\n\t\t\tif (pileData.openSound.includes(\"*\")) {\r\n\t\t\t\tsound = Helpers.random_array_element(pileData.openSounds)\r\n\t\t\t}\r\n\t\t\tAudioHelper.play({ src: sound }, true)\r\n\t\t}\r\n\t\treturn this.updateItemPile(targetActor, pileData, { interactingToken: interactingTokenDocument });\r\n\t}\r\n\r\n\t/**\r\n\t * Closes a pile if it is enabled and a container\r\n\t *\r\n\t * @param {Token/TokenDocument} target          Target pile to close\r\n\t * @param {Token/TokenDocument/boolean} [interactingToken=false]\r\n\t *\r\n\t * @return {Promise/boolean}\r\n\t */\r\n\tstatic closeItemPile(target, interactingToken = false) {\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tif (!PileUtilities.isItemPileContainer(target)) return false;\r\n\t\tconst interactingTokenDocument = interactingToken ? Utilities.getActor(interactingToken) : false;\r\n\t\tconst pileData = PileUtilities.getActorFlagData(targetActor);\r\n\r\n\t\tconst wasOpen = !pileData.closed;\r\n\t\tpileData.closed = true;\r\n\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_CLOSE, targetActor, pileData, interactingTokenDocument);\r\n\t\tif (hookResult === false) return false;\r\n\r\n\t\tif (wasOpen && pileData.closeSound) {\r\n\t\t\tlet sound = pileData.closeSound;\r\n\t\t\tif (pileData.closeSound.includes(\"*\")) {\r\n\t\t\t\tsound = Helpers.random_array_element(pileData.closeSounds)\r\n\t\t\t}\r\n\t\t\tAudioHelper.play({ src: sound }, true)\r\n\t\t}\r\n\r\n\t\treturn this.updateItemPile(targetActor, pileData, { interactingToken: interactingTokenDocument });\r\n\t}\r\n\r\n\t/**\r\n\t * Toggles a pile's closed state if it is enabled and a container\r\n\t *\r\n\t * @param {Token/TokenDocument} target          Target pile to open or close\r\n\t * @param {Token/TokenDocument/boolean} [interactingToken=false]\r\n\t *\r\n\t * @return {Promise/boolean}\r\n\t */\r\n\tstatic async toggleItemPileClosed(target, interactingToken = false) {\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tif (!PileUtilities.isItemPileContainer(target)) return false;\r\n\t\tconst interactingTokenDocument = interactingToken ? Utilities.getActor(interactingToken) : false;\r\n\t\tconst pileData = PileUtilities.getActorFlagData(targetActor);\r\n\t\tif (pileData.closed) {\r\n\t\t\tawait this.openItemPile(targetActor, interactingTokenDocument);\r\n\t\t} else {\r\n\t\t\tawait this.closeItemPile(targetActor, interactingTokenDocument);\r\n\t\t}\r\n\t\treturn !pileData.closed;\r\n\t}\r\n\r\n\t/**\r\n\t * Locks a pile if it is enabled and a container\r\n\t *\r\n\t * @param {Token/TokenDocument} target          Target pile to lock\r\n\t * @param {Token/TokenDocument/boolean} [interactingToken=false]\r\n\t *\r\n\t * @return {Promise/boolean}\r\n\t */\r\n\tstatic lockItemPile(target, interactingToken = false) {\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tif (!PileUtilities.isItemPileContainer(target)) return false;\r\n\t\tconst interactingTokenDocument = interactingToken ? Utilities.getActor(interactingToken) : false;\r\n\t\tconst pileData = PileUtilities.getActorFlagData(targetActor);\r\n\t\tconst wasClosed = pileData.closed;\r\n\t\tpileData.closed = true;\r\n\t\tpileData.locked = true;\r\n\t\tif (!wasClosed) {\r\n\t\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_CLOSE, targetActor, pileData, interactingTokenDocument);\r\n\t\t\tif (hookResult === false) return false;\r\n\t\t}\r\n\t\tconst hookResult = Helpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_LOCK, targetActor, pileData, interactingTokenDocument);\r\n\t\tif (hookResult === false) return false;\r\n\t\tif (!wasClosed && pileData.closeSound) {\r\n\t\t\tlet sound = pileData.closeSound;\r\n\t\t\tif (pileData.closeSound.includes(\"*\")) {\r\n\t\t\t\tsound = Helpers.random_array_element(pileData.closeSounds)\r\n\t\t\t}\r\n\t\t\tAudioHelper.play({ src: sound }, true)\r\n\t\t}\r\n\t\treturn this.updateItemPile(targetActor, pileData, { interactingToken: interactingTokenDocument });\r\n\t}\r\n\r\n\t/**\r\n\t * Unlocks a pile if it is enabled and a container\r\n\t *\r\n\t * @param {Token/TokenDocument} target          Target pile to unlock\r\n\t * @param {Token/TokenDocument/boolean} [interactingToken=false]\r\n\t *\r\n\t * @return {Promise/boolean}\r\n\t */\r\n\tstatic unlockItemPile(target, interactingToken = false) {\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tif (!PileUtilities.isItemPileContainer(target)) return false;\r\n\t\tconst interactingTokenDocument = interactingToken ? Utilities.getActor(interactingToken) : false;\r\n\t\tconst pileData = PileUtilities.getActorFlagData(targetActor);\r\n\t\tpileData.locked = false;\r\n\t\tHelpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_UNLOCK, targetActor, pileData, interactingTokenDocument);\r\n\t\treturn this.updateItemPile(targetActor, pileData, { interactingToken: interactingTokenDocument });\r\n\t}\r\n\r\n\t/**\r\n\t * Toggles a pile's locked state if it is enabled and a container\r\n\t *\r\n\t * @param {Token/TokenDocument} target          Target pile to lock or unlock\r\n\t * @param {Token/TokenDocument/boolean} [interactingToken=false]\r\n\t *\r\n\t * @return {Promise/boolean}\r\n\t */\r\n\tstatic toggleItemPileLocked(target, interactingToken = false) {\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tif (!PileUtilities.isItemPileContainer(target)) return false;\r\n\t\tconst interactingTokenDocument = interactingToken ? Utilities.getActor(interactingToken) : false;\r\n\t\tconst pileData = PileUtilities.getActorFlagData(targetActor);\r\n\t\tif (pileData.locked) {\r\n\t\t\treturn this.unlockItemPile(targetActor, interactingTokenDocument);\r\n\t\t}\r\n\t\treturn this.lockItemPile(targetActor, interactingTokenDocument);\r\n\t}\r\n\r\n\t/**\r\n\t * Causes the item pile to play a sound as it was attempted to be opened, but was locked\r\n\t *\r\n\t * @param {Token/TokenDocument} target\r\n\t * @param {Token/TokenDocument/boolean} [interactingToken=false]\r\n\t *\r\n\t * @return {Promise<boolean>}\r\n\t */\r\n\tstatic rattleItemPile(target, interactingToken = false) {\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tif (!PileUtilities.isItemPileContainer(target)) return false;\r\n\t\tconst interactingTokenDocument = interactingToken ? Utilities.getActor(interactingToken) : false;\r\n\t\tconst pileData = PileUtilities.getActorFlagData(targetActor);\r\n\r\n\t\tHelpers.hooks.call(CONSTANTS.HOOKS.PILE.PRE_RATTLE, targetActor, pileData, interactingTokenDocument);\r\n\r\n\t\tif (pileData.lockedSound) {\r\n\t\t\tlet sound = pileData.lockedSound;\r\n\t\t\tif (pileData.lockedSound.includes(\"*\")) {\r\n\t\t\t\tsound = Helpers.random_array_element(pileData.lockedSounds)\r\n\t\t\t}\r\n\t\t\tAudioHelper.play({ src: sound }, true);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.CALL_HOOK, CONSTANTS.HOOKS.PILE.RATTLE, Utilities.getUuid(targetActor), pileData, Utilities.getUuid(interactingTokenDocument));\r\n\t}\r\n\r\n\t/**\r\n\t * Whether an item pile is locked. If it is not enabled or not a container, it is always false.\r\n\t *\r\n\t * @param {Token/TokenDocument} target\r\n\t * @param {Object/boolean} [data=false] data existing flags data to use\r\n\t * @return {boolean}\r\n\t */\r\n\tstatic isItemPileLocked(target, data = false) {\r\n\t\treturn PileUtilities.isItemPileLocked(target, data);\r\n\t}\r\n\r\n\t/**\r\n\t * Whether an item pile is closed. If it is not enabled or not a container, it is always false.\r\n\t *\r\n\t * @param {Token/TokenDocument} target\r\n\t * @param {Object/boolean} [data=false] data existing flags data to use\r\n\t * @return {boolean}\r\n\t */\r\n\tstatic isItemPileClosed(target, data = false) {\r\n\t\treturn PileUtilities.isItemPileClosed(target, data);\r\n\t}\r\n\r\n\t/**\r\n\t * Whether an item pile is a valid item pile. If it is not enabled, it is always false.\r\n\t *\r\n\t * @param {Token/TokenDocument} target\r\n\t * @param {Object/boolean} [data=false] data existing flags data to use\r\n\t * @return {boolean}\r\n\t */\r\n\tstatic isValidItemPile(target, data = false) {\r\n\t\treturn PileUtilities.isValidItemPile(target, data);\r\n\t}\r\n\r\n\t/**\r\n\t * Whether an item pile is a regular item pile. If it is not enabled, it is always false.\r\n\t *\r\n\t * @param {Token/TokenDocument} target\r\n\t * @param {Object/boolean} [data=false] data existing flags data to use\r\n\t * @return {boolean}\r\n\t */\r\n\tstatic isRegularItemPile(target, data = false) {\r\n\t\treturn PileUtilities.isRegularItemPile(target, data);\r\n\t}\r\n\r\n\t/**\r\n\t * Whether an item pile is a container. If it is not enabled, it is always false.\r\n\t *\r\n\t * @param {Token/TokenDocument} target\r\n\t * @param {Object/boolean} [data=false] data existing flags data to use\r\n\t * @return {boolean}\r\n\t */\r\n\tstatic isItemPileContainer(target, data = false) {\r\n\t\treturn PileUtilities.isItemPileContainer(target, data);\r\n\t}\r\n\r\n\t/**\r\n\t * Whether an item pile is a lootable. If it is not enabled, it is always false.\r\n\t *\r\n\t * @param {Token/TokenDocument} target\r\n\t * @param {Object/boolean} [data=false] data existing flags data to use\r\n\t * @return {boolean}\r\n\t */\r\n\tstatic isItemPileLootable(target, data = false) {\r\n\t\treturn PileUtilities.isItemPileLootable(target, data);\r\n\t}\r\n\r\n\t/**\r\n\t * Whether an item pile is a vault. If it is not enabled, it is always false.\r\n\t *\r\n\t * @param {Token/TokenDocument} target\r\n\t * @param {Object/boolean} [data=false] data existing flags data to use\r\n\t * @return {boolean}\r\n\t */\r\n\tstatic isItemPileVault(target, data = false) {\r\n\t\treturn PileUtilities.isItemPileVault(target, data);\r\n\t}\r\n\r\n\t/**\r\n\t * Whether an item pile is a merchant. If it is not enabled, it is always false.\r\n\t *\r\n\t * @param {Token/TokenDocument} target\r\n\t * @param {Object/boolean} [data=false] data existing flags data to use\r\n\t * @return {boolean}\r\n\t */\r\n\tstatic isItemPileMerchant(target, data = false) {\r\n\t\treturn PileUtilities.isItemPileMerchant(target, data);\r\n\t}\r\n\r\n\t/**\r\n\t * Whether an item pile is a banker. If it is not enabled, it is always false.\r\n\t *\r\n\t * @param {Token/TokenDocument} target\r\n\t * @param {Object/boolean} [data=false] data existing flags data to use\r\n\t * @return {boolean}\r\n\t */\r\n\tstatic isItemPileBanker(target, data = false) {\r\n\t\tif (!game.modules.get(\"item_piles_bankers\")?.active) {\r\n\t\t\tlet word = \"install and activate\";\r\n\t\t\tif (game.modules.get('item_piles_bankers')) word = \"activate\";\r\n\t\t\tHelpers.custom_warning(`This api method from Item Piles requires the 'item_piles_bankers' module. Please ${word} it.`, true);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn PileUtilities.isItemPileBanker(target, data);\r\n\t}\r\n\r\n\t/**\r\n\t * Whether an item pile is a merchant. If it is not enabled, it is always false.\r\n\t *\r\n\t * @param {Token/TokenDocument} target\r\n\t * @param {Object/boolean} [data=false] data existing flags data to use\r\n\t * @return {boolean}\r\n\t */\r\n\tstatic isItemPileAuctioneer(target, data = false) {\r\n\t\tif (!game.modules.get(\"item_piles_auctioneer\")?.active) {\r\n\t\t\tlet word = \"install and activate\";\r\n\t\t\tif (game.modules.get('item_piles_auctioneer')) word = \"activate\";\r\n\t\t\tHelpers.custom_warning(`This api method from Item Piles requires the 'item_piles_auctioneer' module. Please ${word} it.`, true);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn PileUtilities.isItemPileAuctioneer(target, data);\r\n\t}\r\n\r\n\t/**\r\n\t * Whether an item pile is empty pile. If it is not enabled, it is always false.\r\n\t *\r\n\t * @param {Token/TokenDocument} target\r\n\t * @return {boolean}\r\n\t */\r\n\tstatic isItemPileEmpty(target) {\r\n\t\treturn PileUtilities.isItemPileEmpty(target);\r\n\t}\r\n\r\n\t/**\r\n\t * Updates a pile with new data.\r\n\t *\r\n\t * @param {Actor/TokenDocument} target                                      Target token or actor to update\r\n\t * @param {object} newData                                                  New data to update the actor with\r\n\t * @param {object} options                                                  Options to pass to the function\r\n\t * @param {Token/TokenDocument/boolean} [options.interactingToken=false]    If an actor caused this update, you can pass one here to pass it along to macros that the item pile may run\r\n\t * @param {Object/boolean} [options.tokenSettings=false]                    Updates to make to the target token\r\n\t *\r\n\t * @return {Promise}\r\n\t */\r\n\tstatic updateItemPile(target, newData, { interactingToken = false, tokenSettings = false } = {}) {\r\n\r\n\t\tconst targetUuid = Utilities.getUuid(target);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`updateItemPile | Could not determine the UUID, please provide a valid target`);\r\n\r\n\t\tconst interactingTokenUuid = interactingToken ? Utilities.getUuid(interactingToken) : false;\r\n\t\tif (interactingToken && !interactingTokenUuid) throw Helpers.custom_error(`updateItemPile | Could not determine the UUID, please provide a valid target`);\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.UPDATE_PILE, targetUuid, newData, {\r\n\t\t\tinteractingTokenUuid, tokenSettings\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Deletes a pile, calling the relevant hooks.\r\n\t *\r\n\t * @param {Token/TokenDocument} target\r\n\t *\r\n\t * @return {Promise}\r\n\t */\r\n\tstatic deleteItemPile(target) {\r\n\t\tif (!PileUtilities.isValidItemPile(target)) {\r\n\t\t\tthrow Helpers.custom_error(`deleteItemPile | This is not an item pile, please provide a valid target`);\r\n\t\t}\r\n\t\tconst targetUuid = Utilities.getUuid(target);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`deleteItemPile | Could not determine the UUID, please provide a valid target`);\r\n\t\tif (!targetUuid.includes(\"Token\")) {\r\n\t\t\tthrow Helpers.custom_error(`deleteItemPile | Please provide a Token or TokenDocument`);\r\n\t\t}\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.DELETE_PILE, targetUuid);\r\n\t}\r\n\r\n\t/**\r\n\t * Splits an item pile's content between all players (or a specified set of target actors).\r\n\t *\r\n\t * @param target {Token/TokenDocument/Actor}                                                  The item pile to split\r\n\t * @param {object} options                                                                    Options to pass to the function\r\n\t * @param {boolean/TokenDocument/Actor/Array<TokenDocument/Actor>} [options.targets=false]    The targets to receive the split contents\r\n\t * @param {boolean/TokenDocument/Actor} [options.instigator=false]                            Whether this was triggered by a specific actor\r\n\t *\r\n\t * @returns {Promise<object/boolean>}\r\n\t */\r\n\tstatic async splitItemPileContents(target, { targets = false, instigator = false } = {}) {\r\n\r\n\t\tif (!PileUtilities.isItemPileLootable(target)) return false;\r\n\r\n\t\tconst itemPileUuid = Utilities.getUuid(target);\r\n\t\tif (!itemPileUuid) throw Helpers.custom_error(`SplitItemPileContents | Could not determine the UUID, please provide a valid item pile`)\r\n\r\n\t\tconst itemPileActor = Utilities.getActor(target);\r\n\r\n\t\tif (targets) {\r\n\t\t\tif (!Array.isArray(targets)) {\r\n\t\t\t\ttargets = [targets]\r\n\t\t\t}\r\n\t\t\ttargets.forEach(actor => {\r\n\t\t\t\tif (!(actor instanceof TokenDocument || actor instanceof Actor)) {\r\n\t\t\t\t\tthrow Helpers.custom_error(\"SplitItemPileContents | Each of the entries in targets must be of type TokenDocument or Actor\")\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\ttargets = targets.map(target => Utilities.getActor(target));\r\n\t\t}\r\n\r\n\t\tif (instigator && !(instigator instanceof TokenDocument || instigator instanceof Actor)) {\r\n\t\t\tthrow Helpers.custom_error(\"SplitItemPileContents | instigator must be of type TokenDocument or Actor\")\r\n\t\t}\r\n\r\n\t\tconst actorUuids = (targets || SharingUtilities.getPlayersForItemPile(itemPileActor)\r\n\t\t\t.map(u => u.character))\r\n\t\t\t.map(actor => Utilities.getUuid(actor));\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.SPLIT_PILE, itemPileUuid, actorUuids, game.user.id, instigator);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieves the price modifiers for a given item piles merchant\r\n\t *\r\n\t * @param {Actor/TokenDocument} target                                      Target token or actor to retrieve the modifiers from\r\n\t * @param {object} options                                                  Options to pass to the function\r\n\t * @param {Token/TokenDocument/Actor/string/boolean} [options.actor=false]  The actor whose price modifiers to consider\r\n\t * @param {boolean} [options.absolute=false]                                Whether to only consider the actor's modifiers (true means not considering the merchant's base modifiers)\r\n\t *\r\n\t * @return {Object}\r\n\t */\r\n\tstatic getMerchantPriceModifiers(target, { actor = false, absolute = false } = {}) {\r\n\r\n\t\tconst merchantActor = Utilities.getActor(target);\r\n\r\n\t\tif (!(merchantActor instanceof Actor)) {\r\n\t\t\tthrow Helpers.custom_error(`getMerchantPriceModifiers | target must be of type Actor`);\r\n\t\t}\r\n\r\n\t\tif (!PileUtilities.isItemPileMerchant(merchantActor)) {\r\n\t\t\tthrow Helpers.custom_error(`getMerchantPriceModifiers | target is not an item pile merchant`);\r\n\t\t}\r\n\r\n\t\tif (actor) {\r\n\t\t\tif (!(actor instanceof Actor) && typeof actor !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(`getMerchantPriceModifiers | actor must be of type Actor or string (UUID)`);\r\n\t\t\t}\r\n\t\t\tif (typeof actor === \"string\") {\r\n\t\t\t\tactor = fromUuidSync(actor) || false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (typeof absolute !== \"boolean\") {\r\n\t\t\tthrow Helpers.custom_error(`getMerchantPriceModifiers | absolute must be of type boolean`);\r\n\t\t}\r\n\r\n\t\treturn PileUtilities.getMerchantModifiersForActor(target, { actor, absolute });\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the price modifiers for a given item piles merchant\r\n\t *\r\n\t * @param {Actor/TokenDocument} target                                      Target token or actor to update modifiers on\r\n\t * @param {Array<{\r\n\t *   actor?: Actor,\r\n\t *   actorUuid?: string,\r\n\t *   relative?: boolean,\r\n\t *   override?: boolean,\r\n\t *   buyPriceModifier?: number,\r\n\t *   sellPriceModifier?: number\r\n\t * }>} priceModifierData                                                    The price modifier data to update on the merchant\r\n\t *\r\n\t * @return {Promise}\r\n\t */\r\n\tstatic updateMerchantPriceModifiers(target, priceModifierData = []) {\r\n\r\n\t\tconst merchantActor = Utilities.getActor(target);\r\n\r\n\t\tconst targetUuid = Utilities.getUuid(merchantActor);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`updateMerchantPriceModifiers | Could not determine the UUID, please provide a valid target`);\r\n\r\n\t\tif (!PileUtilities.isItemPileMerchant(merchantActor)) {\r\n\t\t\tthrow Helpers.custom_error(`updateMerchantPriceModifiers | Target is not an item pile merchant`);\r\n\t\t}\r\n\r\n\t\tconst flagData = PileUtilities.getActorFlagData(merchantActor);\r\n\r\n\t\tconst actorPriceModifiers = flagData?.actorPriceModifiers ?? [];\r\n\r\n\t\tfor (const priceModifier of priceModifierData) {\r\n\t\t\tif (priceModifier.actor && !(priceModifier.actor instanceof Actor)) {\r\n\t\t\t\tthrow Helpers.custom_error(`updateMerchantPriceModifiers | priceModifierData.actor must be of type Actor`);\r\n\t\t\t}\r\n\t\t\tif (priceModifier.actor) {\r\n\t\t\t\tpriceModifier.actorUuid = priceModifier.actor.uuid;\r\n\t\t\t}\r\n\t\t\tif (priceModifier.actorUuid && typeof priceModifier.actorUuid !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(`updateMerchantPriceModifiers | if priceModifierData.actor if not provided, priceModifierData.actorUuid must be of type string `);\r\n\t\t\t}\r\n\t\t\tif (!priceModifier.actorUuid) {\r\n\t\t\t\tthrow Helpers.custom_error(`updateMerchantPriceModifiers | Could not find the UUID for the given actor`);\r\n\t\t\t}\r\n\t\t\tif (priceModifier.relative !== undefined && typeof priceModifier.relative !== \"boolean\") {\r\n\t\t\t\tthrow Helpers.custom_error(`updateMerchantPriceModifiers | priceModifierData.relative must be of type boolean`);\r\n\t\t\t}\r\n\t\t\tif (priceModifier.override !== undefined && typeof priceModifier.override !== \"boolean\") {\r\n\t\t\t\tthrow Helpers.custom_error(`updateMerchantPriceModifiers | priceModifierData.override must be of type boolean`);\r\n\t\t\t}\r\n\t\t\tif (priceModifier.buyPriceModifier !== undefined && typeof priceModifier.buyPriceModifier !== \"number\") {\r\n\t\t\t\tthrow Helpers.custom_error(`updateMerchantPriceModifiers | priceModifierData.buyPriceModifier must be of type number`);\r\n\t\t\t}\r\n\t\t\tif (priceModifier.sellPriceModifier !== undefined && typeof priceModifier.sellPriceModifier !== \"number\") {\r\n\t\t\t\tthrow Helpers.custom_error(`updateMerchantPriceModifiers | priceModifierData.sellPriceModifier must be of type number`);\r\n\t\t\t}\r\n\r\n\t\t\tlet actorPriceModifierIndex = actorPriceModifiers.findIndex(existingPriceModifier => existingPriceModifier.actorUuid === priceModifier.actorUuid);\r\n\t\t\tif (actorPriceModifierIndex === -1) {\r\n\t\t\t\tactorPriceModifierIndex = actorPriceModifiers.push({}) - 1;\r\n\t\t\t}\r\n\r\n\t\t\tconst oldBuyPriceModifier = actorPriceModifiers[actorPriceModifierIndex]?.buyPriceModifier ?? flagData?.buyPriceModifier ?? 1;\r\n\t\t\tconst newBuyPriceModifier = Math.max(0, priceModifier.relative ? oldBuyPriceModifier + priceModifier.buyPriceModifier : priceModifier.buyPriceModifier ?? oldBuyPriceModifier);\r\n\r\n\t\t\tconst oldSellPriceModifier = actorPriceModifiers[actorPriceModifierIndex]?.sellPriceModifier ?? flagData?.sellPriceModifier ?? 0.5;\r\n\t\t\tconst newSellPriceModifier = Math.max(0, priceModifier.relative ? oldSellPriceModifier + priceModifier.sellPriceModifier : priceModifier.sellPriceModifier ?? oldSellPriceModifier);\r\n\r\n\t\t\tactorPriceModifiers[actorPriceModifierIndex] = foundry.utils.mergeObject(actorPriceModifiers[actorPriceModifierIndex], {\r\n\t\t\t\tactorUuid: priceModifier.actorUuid,\r\n\t\t\t\tbuyPriceModifier: newBuyPriceModifier,\r\n\t\t\t\tsellPriceModifier: newSellPriceModifier,\r\n\t\t\t\toverride: priceModifier.override ?? false,\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.UPDATE_PILE, targetUuid, { actorPriceModifiers });\r\n\r\n\t}\r\n\r\n\t/* ================= ITEM AND ATTRIBUTE METHODS ================= */\r\n\r\n\t/**\r\n\t * Adds item to an actor, increasing item quantities if matches were found\r\n\t *\r\n\t * @param {Actor/TokenDocument/Token} target                  The target to add an item to\r\n\t * @param {Array} items                                       An array of objects, with the key \"item\" being an item object or an Item class (the foundry class), with an optional key of \"quantity\" being the amount of the item to add\r\n\t * @param {object} options                                    Options to pass to the function\r\n\t * @param {boolean} [options.removeExistingActorItems=false]  Whether to remove the actor's existing items before adding the new ones\r\n\t * @param {boolean} [options.skipVaultLogging=false]          Whether to skip logging this action to the target actor if it is a vault\r\n\t * @param {string/boolean} [options.interactionId=false]      The interaction ID of this action\r\n\t *\r\n\t * @returns {Promise<array>}                                  An array of objects, each containing the item that was added or updated, and the quantity that was added\r\n\t */\r\n\tstatic addItems(target, items, {\r\n\t\tremoveExistingActorItems = false, skipVaultLogging = false, interactionId = false\r\n\t} = {}) {\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tif (!targetActor) throw Helpers.custom_error(`addItems | Could not determine the target actor, please provide a valid target`)\r\n\t\tconst targetUuid = Utilities.getUuid(targetActor);\r\n\r\n\t\tconst itemsToAdd = []\r\n\t\titems.forEach(itemData => {\r\n\r\n\t\t\tlet item = itemData;\r\n\t\t\tif (itemData instanceof Item) {\r\n\t\t\t\titem = itemData.toObject();\r\n\t\t\t} else if (itemData.item) {\r\n\t\t\t\titem = itemData.item instanceof Item ? itemData.item.toObject() : itemData.item;\r\n\t\t\t\tif (itemData.flags) {\r\n\t\t\t\t\tfoundry.utils.setProperty(item, CONSTANTS.FLAGS.ITEM, foundry.utils.mergeObject(\r\n\t\t\t\t\t\tfoundry.utils.getProperty(item, CONSTANTS.FLAGS.ITEM) ?? {},\r\n\t\t\t\t\t\tfoundry.utils.getProperty(itemData, CONSTANTS.FLAGS.ITEM))\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t} else if (itemData.id) {\r\n\t\t\t\titem = target.items.get(itemData.id);\r\n\t\t\t\tif (item) {\r\n\t\t\t\t\titem = item.toObject();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow Helpers.custom_error(`addItems | Could not find item with id ${itemData.id} on actor with UUID ${targetUuid}!`)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (itemData?.quantity !== undefined) {\r\n\t\t\t\tUtilities.setItemQuantity(item, itemData.quantity, true);\r\n\t\t\t}\r\n\r\n\t\t\titemsToAdd.push(item);\r\n\r\n\t\t});\r\n\r\n\t\tif (PileUtilities.isItemPileVault(targetActor)) {\r\n\t\t\tconst canItemsFit = PileUtilities.fitItemsIntoVault(itemsToAdd, targetActor);\r\n\t\t\tif (!canItemsFit) throw Helpers.custom_error(`addItems | The vault actor ${targetActor.name} cannot fit these items`, true);\r\n\t\t}\r\n\r\n\t\tif (interactionId && typeof interactionId !== \"string\") throw Helpers.custom_error(`addItems | interactionId must be of type string`);\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.ADD_ITEMS, targetUuid, itemsToAdd, game.user.id, {\r\n\t\t\tremoveExistingActorItems, interactionId, skipVaultLogging\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Subtracts the quantity of items on an actor. If the quantity of an item reaches 0, the item is removed from the actor.\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} target                  The target to remove items from\r\n\t * @param {Array} items                                       An array of objects each containing the item id (key \"_id\") and the quantity to remove (key \"quantity\"), or Items (the foundry class) or strings of IDs to remove all quantities of\r\n\t * @param {object} options                                    Options to pass to the function\r\n\t * @param {boolean} [options.skipVaultLogging=false]          Whether to skip logging this action to the target actor if it is a vault\r\n\t * @param {string/boolean} [options.interactionId=false]      The interaction ID of this action\r\n\t *\r\n\t * @returns {Promise<array>}                                  An array of objects, each containing the item that was removed or updated, the quantity that was removed, and whether the item was deleted\r\n\t */\r\n\tstatic removeItems(target, items, { skipVaultLogging = false, interactionId = false } = {}) {\r\n\r\n\t\tconst targetUuid = Utilities.getUuid(target);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`removeItems | Could not determine the UUID, please provide a valid target`);\r\n\r\n\t\tconst targetActorItems = PileUtilities.getActorItems(target, { getItemCurrencies: true });\r\n\r\n\t\titems = items.map(itemData => {\r\n\r\n\t\t\tlet item;\r\n\t\t\tif (typeof itemData === \"string\" || itemData._id) {\r\n\t\t\t\tconst itemId = typeof itemData === \"string\" ? itemData : itemData._id;\r\n\t\t\t\titem = targetActorItems.find(actorItem => actorItem.id === itemId);\r\n\t\t\t\tif (!item) {\r\n\t\t\t\t\tthrow Helpers.custom_error(`removeItems | Could not find item with id \"${itemId}\" on target \"${targetUuid}\"`)\r\n\t\t\t\t}\r\n\t\t\t\titem = item.toObject();\r\n\t\t\t} else {\r\n\t\t\t\tif (itemData.item instanceof Item) {\r\n\t\t\t\t\titem = itemData.item.toObject();\r\n\t\t\t\t} else if (itemData instanceof Item) {\r\n\t\t\t\t\titem = itemData.toObject();\r\n\t\t\t\t} else {\r\n\t\t\t\t\titem = itemData.item;\r\n\t\t\t\t}\r\n\t\t\t\tlet foundActorItem = targetActorItems.find(actorItem => actorItem.id === item._id);\r\n\t\t\t\tif (!foundActorItem) {\r\n\t\t\t\t\tthrow Helpers.custom_error(`removeItems | Could not find item with id \"${item._id}\" on target \"${targetUuid}\"`)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\t_id: item._id, quantity: itemData?.quantity ?? Utilities.getItemQuantity(item)\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (interactionId) {\r\n\t\t\tif (typeof interactionId !== \"string\") throw Helpers.custom_error(`removeItems | interactionId must be of type string`);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.REMOVE_ITEMS, targetUuid, items, game.user.id, {\r\n\t\t\tinteractionId,\r\n\t\t\tskipVaultLogging\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Transfers items from the source to the target, subtracting a number of quantity from the source's item and adding it to the target's item, deleting items from the source if their quantity reaches 0\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} source              The source to transfer the items from\r\n\t * @param {Actor/Token/TokenDocument} target              The target to transfer the items to\r\n\t * @param {Array} items                                   An array of objects each containing the item id (key \"_id\") and the quantity to transfer (key \"quantity\"), or Items (the foundry class) or strings of IDs to transfer all quantities of\r\n\t * @param {object} options                                Options to pass to the function\r\n\t * @param {boolean} [options.skipVaultLogging=false]      Whether to skip logging this action to the target actor if it is a vault\r\n\t * @param {string/boolean} [options.interactionId=false]  The interaction ID of this action\r\n\t *\r\n\t * @returns {Promise<object>}                             An array of objects, each containing the item that was added or updated, and the quantity that was transferred\r\n\t */\r\n\tstatic transferItems(source, target, items, { skipVaultLogging = false, interactionId = false } = {}) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(source);\r\n\t\tif (!sourceActor) throw Helpers.custom_error(`transferItems | Could not determine the source actor, please provide a valid source`);\r\n\t\tconst sourceUuid = Utilities.getUuid(sourceActor);\r\n\r\n\t\tconst sourceActorItems = PileUtilities.getActorItems(source, { getItemCurrencies: true });\r\n\r\n\t\titems = items.map(itemData => {\r\n\r\n\t\t\tlet item;\r\n\t\t\tif (typeof itemData === \"string\" || itemData._id) {\r\n\t\t\t\tconst itemId = typeof itemData === \"string\" ? itemData : itemData._id;\r\n\t\t\t\titem = sourceActorItems.find(actorItem => actorItem.id === itemId);\r\n\t\t\t\tif (!item) {\r\n\t\t\t\t\tthrow Helpers.custom_error(`transferItems | Could not find item with id \"${itemId}\" on target \"${sourceUuid}\"`)\r\n\t\t\t\t}\r\n\t\t\t\titem = item.toObject();\r\n\t\t\t} else if (itemData instanceof Item) {\r\n\t\t\t\titem = itemData.toObject();\r\n\t\t\t} else if (itemData.item instanceof Item) {\r\n\t\t\t\titem = itemData.item.toObject();\r\n\t\t\t} else {\r\n\t\t\t\titem = itemData.item;\r\n\t\t\t}\r\n\r\n\t\t\tlet foundActorItem = sourceActorItems.find(actorItem => actorItem.id === item._id);\r\n\t\t\tif (!foundActorItem) {\r\n\t\t\t\tthrow Helpers.custom_error(`transferItems | Could not find item with id \"${item._id}\" on target \"${sourceUuid}\"`)\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\tid: item._id,\r\n\t\t\t\tquantity: Math.max(itemData?.quantity ?? Utilities.getItemQuantity(itemData), 0),\r\n\t\t\t\tflags: foundry.utils.getProperty(itemData, CONSTANTS.FLAGS.ITEM)\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tif (!targetActor) throw Helpers.custom_error(`transferItems | Could not determine the target, please provide a valid target`);\r\n\t\tconst targetUuid = Utilities.getUuid(targetActor);\r\n\r\n\t\tif (PileUtilities.isItemPileVault(targetActor)) {\r\n\t\t\tconst itemsToFit = items.reduce((acc, data) => {\r\n\t\t\t\tconst item = sourceActor.items.get(data.id);\r\n\t\t\t\tif (PileUtilities.canItemStack(item, targetActor)) {\r\n\t\t\t\t\tacc.push(item);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (let i = 0; i < data.quantity; i++) {\r\n\t\t\t\t\t\tacc.push(item);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn acc;\r\n\t\t\t}, [])\r\n\t\t\tconst canItemsFit = PileUtilities.fitItemsIntoVault(itemsToFit, targetActor);\r\n\t\t\tif (!canItemsFit) throw Helpers.custom_error(`transferItems | The target vault actor ${targetActor.name} cannot fit these items`, true);\r\n\t\t}\r\n\r\n\t\tif (interactionId) {\r\n\t\t\tif (typeof interactionId !== \"string\") throw Helpers.custom_error(`transferItems | interactionId must be of type string`);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRANSFER_ITEMS, sourceUuid, targetUuid, items, game.user.id, {\r\n\t\t\tinteractionId, skipVaultLogging\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Transfers all items between the source and the target.\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} source                The actor to transfer all items from\r\n\t * @param {Actor/Token/TokenDocument} target                The actor to receive all the items\r\n\t * @param {object} options                                  Options to pass to the function\r\n\t * @param {Array/boolean} [options.itemFilters=false]       Array of item types disallowed - will default to module settings if none provided\r\n\t * @param {boolean} [options.skipVaultLogging=false]        Whether to skip logging this action to the target actor if it is a vault\r\n\t * @param {string/boolean} [options.interactionId=false]    The interaction ID of this action\r\n\t *\r\n\t * @returns {Promise<array>}                                An array containing all the items that were transferred to the target\r\n\t */\r\n\tstatic transferAllItems(source, target, {\r\n\t\titemFilters = false,\r\n\t\tskipVaultLogging = false,\r\n\t\tinteractionId = false\r\n\t} = {}) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(source);\r\n\t\tif (!sourceActor) throw Helpers.custom_error(`transferAllItems | Could not determine the source actor, please provide a valid source`)\r\n\t\tconst sourceUuid = Utilities.getUuid(sourceActor);\r\n\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tif (!targetActor) throw Helpers.custom_error(`transferAllItems | Could not determine the target actor, please provide a valid target`)\r\n\t\tconst targetUuid = Utilities.getUuid(targetActor);\r\n\r\n\t\tif (itemFilters) {\r\n\t\t\tif (!Array.isArray(itemFilters)) throw Helpers.custom_error(`transferAllItems | itemFilters must be of type array`);\r\n\t\t\titemFilters.forEach(entry => {\r\n\t\t\t\tif (typeof entry?.path !== \"string\") throw Helpers.custom_error(`transferAllItems | each entry in the itemFilters must have a \"path\" property that is of type string`);\r\n\t\t\t\tif (typeof entry?.filter !== \"string\") throw Helpers.custom_error(`transferAllItems | each entry in the itemFilters must have a \"filter\" property that is of type string`);\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (interactionId) {\r\n\t\t\tif (typeof interactionId !== \"string\") throw Helpers.custom_error(`transferAllItems | interactionId must be of type string`);\r\n\t\t}\r\n\r\n\t\tif (PileUtilities.isItemPileVault(targetActor)) {\r\n\t\t\tconst sourceActorItems = PileUtilities.getActorItems(sourceActor, { getItemCurrencies: true });\r\n\t\t\tconst canItemsFit = PileUtilities.fitItemsIntoVault(sourceActorItems, targetActor, { itemFilters });\r\n\t\t\tif (!canItemsFit) throw Helpers.custom_error(`transferAllItems | The target vault actor ${targetActor.name} cannot fit these items`, true);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRANSFER_ALL_ITEMS, sourceUuid, targetUuid, game.user.id, {\r\n\t\t\titemFilters, skipVaultLogging, interactionId\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Sets attributes on an actor\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} target                  The target whose attribute will have their quantity set\r\n\t * @param {object} attributes                                 An object with each key being an attribute path, and its value being the quantity to set\r\n\t * @param {object} options                                    Options to pass to the function\r\n\t * @param {string/boolean} [options.interactionId=false]      The interaction ID of this action\r\n\t *\r\n\t * @returns {Promise<object>}                                 An array containing a key value pair of the attribute path and the quantity of that attribute that was set\r\n\t *\r\n\t */\r\n\tstatic setAttributes(target, attributes, { interactionId = false } = {}) {\r\n\r\n\t\tconst targetUuid = Utilities.getUuid(target);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`setAttributes | Could not determine the UUID, please provide a valid target`);\r\n\r\n\t\tObject.entries(attributes).forEach(entry => {\r\n\t\t\tconst [attribute, quantity] = entry;\r\n\t\t\tif (!Helpers.isRealNumber(quantity)) {\r\n\t\t\t\tthrow Helpers.custom_error(`setAttributes | Attribute \"${attribute}\" must be of type number`);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (interactionId) {\r\n\t\t\tif (typeof interactionId !== \"string\") throw Helpers.custom_error(`setAttributes | interactionId must be of type string`);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.SET_ATTRIBUTES, targetUuid, attributes, game.user.id, {\r\n\t\t\tinteractionId\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Adds attributes on an actor\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} target                  The target whose attribute will have a set quantity added to it\r\n\t * @param {object} attributes                                 An object with each key being an attribute path, and its value being the quantity to add\r\n\t * @param {object} options                                    Options to pass to the function\r\n\t * @param {boolean} [options.skipVaultLogging=false]          Whether to skip logging this action to the target actor if it is a vault\r\n\t * @param {string/boolean} [options.interactionId=false]      The interaction ID of this action\r\n\t *\r\n\t * @returns {Promise<object>}                                 An array containing a key value pair of the attribute path and the quantity of that attribute that was added\r\n\t *\r\n\t */\r\n\tstatic addAttributes(target, attributes, { skipVaultLogging = false, interactionId = false } = {}) {\r\n\r\n\t\tconst targetUuid = Utilities.getUuid(target);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`addAttributes | Could not determine the UUID, please provide a valid target`);\r\n\r\n\t\tObject.entries(attributes).forEach(entry => {\r\n\t\t\tconst [attribute, quantity] = entry;\r\n\t\t\tif (!Helpers.isRealNumber(quantity) && quantity > 0) {\r\n\t\t\t\tthrow Helpers.custom_error(`addAttributes | Attribute \"${attribute}\" must be of type number and greater than 0`);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (interactionId) {\r\n\t\t\tif (typeof interactionId !== \"string\") throw Helpers.custom_error(`addAttributes | interactionId must be of type string`);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.ADD_ATTRIBUTES, targetUuid, attributes, game.user.id, {\r\n\t\t\tskipVaultLogging,\r\n\t\t\tinteractionId\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Subtracts attributes on the target\r\n\t *\r\n\t * @param {Token/TokenDocument} target                      The target whose attributes will be subtracted from\r\n\t * @param {Array/object} attributes                         This can be either an array of attributes to subtract (to zero out a given attribute), or an object with each key being an attribute path, and its value being the quantity to subtract\r\n\t * @param {object} options                                  Options to pass to the function\r\n\t * @param {boolean} [options.skipVaultLogging=false]        Whether to skip logging this action to the target actor if it is a vault\r\n\t * @param {string/boolean} [options.interactionId=false]    The interaction ID of this action\r\n\t *\r\n\t * @returns {Promise<object>}                               An array containing a key value pair of the attribute path and the quantity of that attribute that was removed\r\n\t */\r\n\tstatic removeAttributes(target, attributes, { skipVaultLogging = false, interactionId = false } = {}) {\r\n\r\n\t\tconst targetUuid = Utilities.getUuid(target);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`removeAttributes | Could not determine the UUID, please provide a valid target`);\r\n\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\r\n\t\tlet attributesToSend = {};\r\n\t\tif (Array.isArray(attributes)) {\r\n\t\t\tattributes.forEach(attribute => {\r\n\t\t\t\tif (typeof attribute !== \"string\") {\r\n\t\t\t\t\tthrow Helpers.custom_error(`removeAttributes | Each attribute in the array must be of type string`);\r\n\t\t\t\t}\r\n\t\t\t\tattributesToSend[attribute] = Number(foundry.utils.getProperty(targetActor, attribute));\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tObject.entries(attributes).forEach(entry => {\r\n\t\t\t\tconst [attribute, quantity] = entry;\r\n\t\t\t\tif (!foundry.utils.hasProperty(targetActor, attribute)) {\r\n\t\t\t\t\tthrow Helpers.custom_error(`removeAttributes | Could not find attribute ${attribute} on target's actor with UUID \"${targetUuid}\"`);\r\n\t\t\t\t}\r\n\t\t\t\tif (!Helpers.isRealNumber(quantity) && quantity > 0) {\r\n\t\t\t\t\tthrow Helpers.custom_error(`removeAttributes | Attribute \"${attribute}\" must be of type number and greater than 0`);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tattributesToSend = attributes;\r\n\t\t}\r\n\r\n\t\tif (interactionId) {\r\n\t\t\tif (typeof interactionId !== \"string\") throw Helpers.custom_error(`removeAttributes | interactionId must be of type string`);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.REMOVE_ATTRIBUTES, targetUuid, attributesToSend, game.user.id, {\r\n\t\t\tskipVaultLogging,\r\n\t\t\tinteractionId\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Transfers a set quantity of an attribute from a source to a target, removing it or subtracting from the source and adds it the target\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} source                The source to transfer the attribute from\r\n\t * @param {Actor/Token/TokenDocument} target                The target to transfer the attribute to\r\n\t * @param {Array/object} attributes                         This can be either an array of attributes to transfer (to transfer all of a given attribute), or an object with each key being an attribute path, and its value being the quantity to transfer\r\n\t * @param {object} options                                  Options to pass to the function\r\n\t * @param {boolean} [options.skipVaultLogging=false]        Whether to skip logging this action to the target actor if it is a vault\r\n\t * @param {string/boolean} [options.interactionId=false]    The interaction ID of this action\r\n\t *\r\n\t * @returns {Promise<object>}                               An object containing a key value pair of each attribute transferred, the key being the attribute path and its value being the quantity that was transferred\r\n\t */\r\n\tstatic transferAttributes(source, target, attributes, { skipVaultLogging = false, interactionId = false } = {}) {\r\n\r\n\t\tconst sourceUuid = Utilities.getUuid(source);\r\n\t\tif (!sourceUuid) throw Helpers.custom_error(`transferAttributes | Could not determine the UUID, please provide a valid source`);\r\n\t\tconst sourceActor = Utilities.getActor(source);\r\n\r\n\t\tconst targetUuid = Utilities.getUuid(target);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`transferAttributes | Could not determine the UUID, please provide a valid target`);\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\r\n\t\tif (Array.isArray(attributes)) {\r\n\t\t\tattributes.forEach(attribute => {\r\n\t\t\t\tif (typeof attribute !== \"string\") {\r\n\t\t\t\t\tthrow Helpers.custom_error(`transferAttributes | Each attribute in the array must be of type string`);\r\n\t\t\t\t}\r\n\t\t\t\tif (!foundry.utils.hasProperty(sourceActor, attribute)) {\r\n\t\t\t\t\tthrow Helpers.custom_error(`transferAttributes | Could not find attribute ${attribute} on source's actor with UUID \"${targetUuid}\"`);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tObject.entries(attributes).forEach(entry => {\r\n\t\t\t\tconst [attribute, quantity] = entry;\r\n\t\t\t\tif (!foundry.utils.hasProperty(sourceActor, attribute)) {\r\n\t\t\t\t\tthrow Helpers.custom_error(`transferAttributes | Could not find attribute ${attribute} on source's actor with UUID \"${targetUuid}\"`);\r\n\t\t\t\t}\r\n\t\t\t\tif (!Helpers.isRealNumber(quantity) && quantity > 0) {\r\n\t\t\t\t\tthrow Helpers.custom_error(`transferAttributes | Attribute \"${attribute}\" must be of type number and greater than 0`);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (interactionId) {\r\n\t\t\tif (typeof interactionId !== \"string\") throw Helpers.custom_error(`transferAttributes | interactionId must be of type string`);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRANSFER_ATTRIBUTES, sourceUuid, targetUuid, attributes, game.user.id, {\r\n\t\t\tskipVaultLogging,\r\n\t\t\tinteractionId\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Transfers all dynamic attributes from a source to a target, removing it or subtracting from the source and adding them to the target\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} source                The source to transfer the attributes from\r\n\t * @param {Actor/Token/TokenDocument} target                The target to transfer the attributes to\r\n\t * @param {object} options                                  Options to pass to the function\r\n\t * @param {boolean} [options.skipVaultLogging=false]        Whether to skip logging this action to the target actor if it is a vault\r\n\t * @param {string/boolean} [options.interactionId=false]    The interaction ID of this action\r\n\t *\r\n\t * @returns {Promise<object>}                               An object containing a key value pair of each attribute transferred, the key being the attribute path and its value being the quantity that was transferred\r\n\t */\r\n\tstatic transferAllAttributes(source, target, { skipVaultLogging = false, interactionId = false } = {}) {\r\n\r\n\t\tconst sourceUuid = Utilities.getUuid(source);\r\n\t\tif (!sourceUuid) throw Helpers.custom_error(`transferAllAttributes | Could not determine the UUID, please provide a valid source`);\r\n\r\n\t\tconst targetUuid = Utilities.getUuid(target);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`transferAllAttributes | Could not determine the UUID, please provide a valid target`);\r\n\r\n\t\tif (interactionId) {\r\n\t\t\tif (typeof interactionId !== \"string\") throw Helpers.custom_error(`transferAllAttributes | interactionId must be of type string`);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRANSFER_ALL_ATTRIBUTES, sourceUuid, targetUuid, game.user.id, {\r\n\t\t\tskipVaultLogging,\r\n\t\t\tinteractionId\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Transfers all items and attributes between the source and the target.\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} source                The actor to transfer all items and attributes from\r\n\t * @param {Actor/Token/TokenDocument} target                The actor to receive all the items and attributes\r\n\t * @param {object} options                                  Options to pass to the function\r\n\t * @param {Array/boolean} [options.itemFilters=false]       Array of item types disallowed - will default to module settings if none provided\r\n\t * @param {boolean} [options.skipVaultLogging=false]        Whether to skip logging this action to the target actor if it is a vault\r\n\t * @param {string/boolean} [options.interactionId=false]    The ID of this interaction\r\n\t *\r\n\t * @returns {Promise<object>}                               An object containing all items and attributes transferred to the target\r\n\t */\r\n\tstatic transferEverything(source, target, {\r\n\t\titemFilters = false,\r\n\t\tskipVaultLogging = false,\r\n\t\tinteractionId = false\r\n\t} = {}) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(source);\r\n\t\tif (!sourceActor) throw Helpers.custom_error(`transferEverything | Could not determine the source actor, please provide a valid source`);\r\n\t\tconst sourceUuid = Utilities.getUuid(sourceActor);\r\n\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tif (!targetActor) throw Helpers.custom_error(`transferEverything | Could not determine the target actor, please provide a valid target`);\r\n\t\tconst targetUuid = Utilities.getUuid(targetActor);\r\n\r\n\t\tif (itemFilters) {\r\n\t\t\tif (!Array.isArray(itemFilters)) throw Helpers.custom_error(`transferEverything | itemFilters must be of type array`);\r\n\t\t\titemFilters.forEach(entry => {\r\n\t\t\t\tif (typeof entry?.path !== \"string\") throw Helpers.custom_error(`transferEverything | each entry in the itemFilters must have a \"path\" property that is of type string`);\r\n\t\t\t\tif (typeof entry?.filter !== \"string\") throw Helpers.custom_error(`transferEverything | each entry in the itemFilters must have a \"filter\" property that is of type string`);\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (PileUtilities.isItemPileVault(targetActor)) {\r\n\t\t\tconst sourceActorItems = PileUtilities.getActorItems(sourceActor, { getItemCurrencies: true });\r\n\t\t\tconst canItemsFit = PileUtilities.fitItemsIntoVault(sourceActorItems, targetActor, { itemFilters });\r\n\t\t\tif (!canItemsFit) throw Helpers.custom_error(`transferEverything | The target vault actor ${targetActor.name} cannot fit these items`, true);\r\n\t\t}\r\n\r\n\t\tif (interactionId) {\r\n\t\t\tif (typeof interactionId !== \"string\") throw Helpers.custom_error(`transferEverything | interactionId must be of type string`);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRANSFER_EVERYTHING, sourceUuid, targetUuid, game.user.id, {\r\n\t\t\titemFilters, skipVaultLogging, interactionId\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Combines several item piles into a single item pile by transferring\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} target                    The actor to transfer items and currencies to\r\n\t * @param {Array<Actor/Token/TokenDocument>} sources            The actors to transfer items and currencies from\r\n\t * @param {object} options                                      Options to pass to the function\r\n\t * @param {Array/boolean} [options.itemFilters=false]           Array of item types disallowed - will default to module settings if none provided\r\n\t * @param {object/boolean} [options.targetItemPileFlags=false]  Item pile flags to set on the target as a part of this transfer\r\n\t * @param {string/boolean} [options.interactionId=false]        The ID of this interaction\r\n\t *\r\n\t * @returns {Promise<object>}                                   An object containing all items and attributes transferred to the target\r\n\t */\r\n\tstatic combineItemPiles(target, sources, {\r\n\t\titemFilters = false,\r\n\t\ttargetItemPileFlags = false,\r\n\t\tinteractionId = false\r\n\t} = {}) {\r\n\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tif (!targetActor) throw Helpers.custom_error(`combineItemPiles | Could not determine the target actor, please provide a valid target`);\r\n\t\tconst targetUuid = Utilities.getUuid(targetActor);\r\n\r\n\t\tif (!Array.isArray(sources)) {\r\n\t\t\ttry {\r\n\t\t\t\tsources = Array.from(sources);\r\n\t\t\t} catch (err) {\r\n\t\t\t\tthrow Helpers.custom_error(`combineItemPiles | sources must be of type array or set`);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst sourceActors = sources.map(Utilities.getActor);\r\n\t\tif (!sourceActors.every(Boolean) || !sourceActors.length) throw Helpers.custom_error(`combineItemPiles | Could not determine one of the source actors, please provide valid sources`);\r\n\t\tif (!sourceActors.every(actor => PileUtilities.isValidItemPile(actor))) throw Helpers.custom_error(`combineItemPiles | One or more of the source actors are not item piles`);\r\n\t\tconst sourceUuids = sourceActors.map(Utilities.getUuid);\r\n\r\n\t\tif (sourceActors.find(actor => actor === targetActor)) {\r\n\t\t\tthrow Helpers.custom_error(`combineItemPiles | Sources may not contain the target`);\r\n\t\t}\r\n\r\n\t\tif (itemFilters) {\r\n\t\t\tif (!Array.isArray(itemFilters)) throw Helpers.custom_error(`combineItemPiles | itemFilters must be of type array`);\r\n\t\t\titemFilters.forEach(entry => {\r\n\t\t\t\tif (typeof entry?.path !== \"string\") throw Helpers.custom_error(`combineItemPiles | each entry in the itemFilters must have a \"path\" property that is of type string`);\r\n\t\t\t\tif (typeof entry?.filter !== \"string\") throw Helpers.custom_error(`combineItemPiles | each entry in the itemFilters must have a \"filter\" property that is of type string`);\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (targetItemPileFlags && typeof targetItemPileFlags !== \"object\") throw Helpers.custom_error(`combineItemPiles | options.targetItemPileFlags must be of type object`);\r\n\r\n\t\tif (PileUtilities.isItemPileVault(targetActor)) {\r\n\t\t\tconst sourceActorItems = sourceActors.map(sourceActor => PileUtilities.getActorItems(sourceActor, { getItemCurrencies: true }));\r\n\t\t\tconst canItemsFit = PileUtilities.fitItemsIntoVault(sourceActorItems, targetActor, { itemFilters });\r\n\t\t\tif (!canItemsFit) throw Helpers.custom_error(`combineItemPiles | The target vault actor ${targetActor.name} cannot fit these items`);\r\n\t\t}\r\n\r\n\t\tif (interactionId) {\r\n\t\t\tif (typeof interactionId !== \"string\") throw Helpers.custom_error(`combineItemPiles | interactionId must be of type string`);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.COMBINE_ITEM_PILES, targetUuid, sourceUuids, game.user.id, {\r\n\t\t\titemFilters, interactionId\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Return all th registered currencies abbreviations\r\n\t * @returns {Array<string>}                                 An array of string containing the abbreviation for each currency registered\r\n\t */\r\n\tstatic getCurrenciesAbbreviations() {\r\n\t\treturn PileUtilities.getCurrenciesAbbreviations();\r\n\t}\r\n\r\n\t/**\r\n\t * Turns an array containing the data and quantities for each currency into a string of currencies\r\n\t *\r\n\t * @param {Array<object>} currencies                      An array of object containing the data and quantity for each currency\r\n|    * @param {number} currencies[].cost                      The cost of the currency\r\n|    * @param {string} currencies[].denom                     The abbreviation of the currency, which are usually {#}GP, which when {#} is replaced with the number it becomes 5GP.\r\n\t * @param {string} currencies[].percent                   The cost of  the currency is in percentage (for work the 'abbreviation' property must includes '%' substring)\r\n\t * @returns {string}                                      An array of object containing the data and quantity for each currency\r\n\t */\r\n\tstatic getStringFromCurrencies(currencies) {\r\n\t\tif (!currencies) {\r\n\t\t\tthrow Helpers.custom_error(`getStringFromCurrencies | currencies must be defined`, true);\r\n\t\t}\r\n\t\tif (typeof currencies === \"string\") {\r\n\t\t\tthrow Helpers.custom_error(`getStringFromCurrencies | currencies can't be of type string`, true);\r\n\t\t}\r\n\t\tif (!Array.isArray(currencies)) {\r\n\t\t\tthrow Helpers.custom_error(`getStringFromCurrencies | currencies must be of type array`, true);\r\n\t\t}\r\n\t\tif (currencies.length === 0) {\r\n\t\t\tthrow Helpers.custom_error(`getStringFromCurrencies | currencies must be a not empty array`, true);\r\n\t\t}\r\n\t\tcurrencies.forEach(currency => {\r\n\t\t\tif (typeof currency !== \"object\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"setCurrencies | each entry in inCurrencies must be of type object\");\r\n\t\t\t}\r\n\t\t\tif (typeof currency.cost !== \"number\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"getStringFromCurrencies | currency.cost must be of type number\");\r\n\t\t\t}\r\n\t\t\tif (currency.cost < 0) {\r\n\t\t\t\tthrow Helpers.custom_error(\"getStringFromCurrencies | currency.cost cannot be a negative number\");\r\n\t\t\t}\r\n\t\t\t// Is optional\r\n\t\t\t// if (typeof currency.percent !== \"boolean\") {\r\n\t\t\t// \tthrow Helpers.custom_error(\"getStringFromCurrencies | currency.percent must be of type boolean\");\r\n\t\t\t// }\r\n\t\t\tif (typeof currency.abbreviation !== \"string\") {\r\n\t\t\t\tthrow Helpers.custom_error(\"getStringFromCurrencies | currency.abbreviation must be of type string\");\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn PileUtilities.getStringFromCurrencies(currencies);\r\n\t}\r\n\r\n\t/**\r\n\t * Turns a string of currencies into an array containing the data and quantities for each currency\r\n\t *\r\n\t * @param {string} currencies                               A string of currencies to convert (eg, \"5gp 25sp\")\r\n\t *\r\n\t * @returns {Array<object>}                                 An array of object containing the data and quantity for each currency\r\n\t */\r\n\tstatic getCurrenciesFromString(currencies) {\r\n\t\tif (typeof currencies !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(`getCurrenciesFromString | currencies must be of type string`)\r\n\t\t}\r\n\t\treturn PileUtilities.getPriceFromString(currencies).currencies;\r\n\t}\r\n\r\n\t/**\r\n\t * This method takes a string, and another string or number, an alternatively a boolean, to modify the first string's currencies.Whether to subtract the second currencies from the first; not needed if the second argument is a number\r\n\t *\r\n\t * @param firstCurrencies {string}                          The starting sum of money as strings\r\n\t * @param secondCurrencies {string/number}                  A string of currencies to alter the first with, or a number to multiply it\r\n\t * @param subtract {boolean}                                Whether to subtract the second currencies from the first; not needed if the second argument is a number\r\n\t *\r\n\t * @returns {string}                                        The resulting currency string\r\n\t */\r\n\tstatic calculateCurrencies(firstCurrencies, secondCurrencies, subtract = true) {\r\n\t\tif (typeof firstCurrencies !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(`getCurrencyDifference | firstCurrencies must be of type string`)\r\n\t\t}\r\n\t\tif (!(typeof secondCurrencies === \"string\" || typeof secondCurrencies === \"number\")) {\r\n\t\t\tthrow Helpers.custom_error(`getCurrencyDifference | secondCurrencies must be of type string or number`)\r\n\t\t}\r\n\r\n\t\tconst firstCurrenciesData = PileUtilities.getPriceFromString(firstCurrencies);\r\n\t\tconst secondCurrenciesData = typeof secondCurrencies === \"string\"\r\n\t\t\t? PileUtilities.getPriceFromString(secondCurrencies)\r\n\t\t\t: secondCurrencies;\r\n\r\n\t\tconst totalCost = typeof secondCurrencies === \"string\"\r\n\t\t\t? firstCurrenciesData.overallCost + (secondCurrenciesData.overallCost * (subtract ? -1 : 1))\r\n\t\t\t: firstCurrenciesData.overallCost * secondCurrencies;\r\n\r\n\t\tconst differenceCost = PileUtilities.getPriceArray(totalCost);\r\n\t\tconst newBaseCurrencies = differenceCost\r\n\t\t\t.filter(currency => !currency.secondary && currency.cost)\r\n\t\t\t.reduce((acc, currency) => {\r\n\t\t\t\treturn acc + currency.abbreviation.replace(\"{#}\", currency.cost) + \" \";\r\n\t\t\t}, \"\");\r\n\r\n\t\tconst newSecondaryCurrencies = firstCurrenciesData.currencies\r\n\t\t\t.reduce((acc, currency, index) => {\r\n\t\t\t\tif (!currency.secondary) return acc;\r\n\t\t\t\tconst quantity = typeof secondCurrencies === \"string\"\r\n\t\t\t\t\t? currency.quantity + (secondCurrenciesData.currencies[index].quantity * (subtract ? -1 : 1))\r\n\t\t\t\t\t: Math.round(currency.quantity * secondCurrencies);\r\n\t\t\t\tif (quantity <= 0) return acc;\r\n\t\t\t\treturn acc + currency.abbreviation.replace(\"{#}\", quantity) + \" \";\r\n\t\t\t}, \"\");\r\n\r\n\t\treturn (newBaseCurrencies + newSecondaryCurrencies).trim();\r\n\t}\r\n\r\n\t/**\r\n\t * Turns a string of currencies or a number into an object containing payment data, and the change an optional target would receive back\r\n\t *\r\n\t * @param {string/number} price                             A string of currencies to convert (eg, \"5gp 25sp\") or a number\r\n\t * @param {object} options                                  Options to pass to the function\r\n\t * @param {number/boolean} [options.quantity=1]             The number of this to buy\r\n\t * @param {string/boolean} [options.target=false]           The target whose currencies to check against\r\n\t *\r\n\t * @returns {object}                                        An object containing the price data\r\n\t */\r\n\tstatic getPaymentData(price, { quantity = 1, target = false } = {}) {\r\n\r\n\t\tlet targetActor = false;\r\n\t\tif (target) {\r\n\t\t\ttargetActor = Utilities.getActor(target);\r\n\t\t\tif (!targetActor) throw Helpers.custom_error(`getPaymentData | Could not determine target actor`);\r\n\t\t}\r\n\r\n\t\tlet overallCost;\r\n\t\tlet secondaryPrices = false;\r\n\t\tif (typeof price === \"string\") {\r\n\t\t\tconst priceData = PileUtilities.getPriceFromString(price)\r\n\t\t\tconst currenciesToRemove = priceData.currencies.filter(currency => Helpers.isRealNumber(currency.quantity) && currency.quantity > 0);\r\n\t\t\tif (!currenciesToRemove.length) {\r\n\t\t\t\tthrow Helpers.custom_error(`getPaymentData | Could not determine currencies to remove with string \"${price}\"`);\r\n\t\t\t}\r\n\t\t\toverallCost = priceData.overallCost;\r\n\t\t\tsecondaryPrices = currenciesToRemove.filter(currency => currency.secondary);\r\n\t\t} else if (typeof price === \"number\") {\r\n\t\t\toverallCost = price;\r\n\t\t} else {\r\n\t\t\tif (!targetActor) throw Helpers.custom_error(`getPaymentData | price must be of type string or number`);\r\n\t\t}\r\n\r\n\t\treturn PileUtilities.getPaymentData({\r\n\t\t\tpurchaseData: [{ cost: overallCost, quantity, secondaryPrices }],\r\n\t\t\tbuyer: targetActor\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * TODO: Remove in future update\r\n\t * @deprecated\r\n\t */\r\n\tstatic getPaymentDataFromString(...args) {\r\n\t\tHelpers.custom_warning(`game.itempiles.API.getPaymentDataFromString has been deprecated in favor of game.itempiles.API.getPaymentData`, false);\r\n\t\treturn this.getPaymentData(...args);\r\n\t}\r\n\r\n\t/**\r\n\t * Update currencies to the target\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} target                The actor to update the currencies to\r\n\t * @param {string} currencies                               A string of currencies to update (eg, \"5gp 25sp\")\r\n\t * @param {object} options                                  Options to pass to the function\r\n\t * @param {string/boolean} [options.interactionId=false]    The ID of this interaction\r\n\t *\r\n\t * @returns {Promise<object>}                               An object containing the items and attributes update to the target\r\n\t */\r\n\tstatic updateCurrencies(target, currencies, { interactionId = false } = {}) {\r\n\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tconst targetUuid = Utilities.getUuid(targetActor);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`updateCurrency | Could not determine the UUID, please provide a valid target`);\r\n\r\n\t\tif (typeof currencies !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(`updateCurrency | currencies must be of type string`)\r\n\t\t}\r\n\r\n\t\tconst currenciesToUpdate = PileUtilities.getPriceFromString(currencies).currencies\r\n\t\t\t.filter(currency => Helpers.isRealNumber(currency.quantity) && currency.quantity >= 0);\r\n\r\n\t\tif (!currenciesToUpdate.length) {\r\n\t\t\tthrow Helpers.custom_error(`updateCurrency | Could not determine currencies to update with string \"${currencies}\"`);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.UPDATE_CURRENCIES, targetUuid, currencies, game.user.id, { interactionId });\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Adds currencies to the target\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} target                The actor to add the currencies to\r\n\t * @param {string} currencies                               A string of currencies to add (eg, \"5gp 25sp\")\r\n\t * @param {object} options                                  Options to pass to the function\r\n\t * @param {string/boolean} [options.interactionId=false]    The ID of this interaction\r\n\t *\r\n\t * @returns {Promise<object>}                               An object containing the items and attributes added to the target\r\n\t */\r\n\tstatic addCurrencies(target, currencies, { interactionId = false } = {}) {\r\n\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tconst targetUuid = Utilities.getUuid(targetActor);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`addCurrency | Could not determine the UUID, please provide a valid target`);\r\n\r\n\t\tif (typeof currencies !== \"string\") {\r\n\t\t\tthrow Helpers.custom_error(`addCurrency | currencies must be of type string`)\r\n\t\t}\r\n\r\n\t\tconst currenciesToAdd = PileUtilities.getPriceFromString(currencies).currencies\r\n\t\t\t.filter(currency => Helpers.isRealNumber(currency.quantity) && currency.quantity > 0);\r\n\r\n\t\tif (!currenciesToAdd.length) {\r\n\t\t\tthrow Helpers.custom_error(`addCurrency | Could not determine currencies to add with string \"${currencies}\"`);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.ADD_CURRENCIES, targetUuid, currencies, game.user.id, { interactionId });\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Removes currencies from the target\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} target                The actor to remove currencies from\r\n\t * @param {string} currencies                               A string of currencies to remove (eg, \"5gp 25sp\")\r\n\t * @param {object} options                                  Options to pass to the function\r\n\t * @param {boolean} [options.change=true]                   Whether the actor can get change back\r\n\t * @param {string/boolean} [options.interactionId=false]    The ID of this interaction\r\n\t *\r\n\t * @returns {Promise<object>}                               An object containing the items and attributes removed from the target\r\n\t */\r\n\tstatic removeCurrencies(target, currencies, { change = true, interactionId = false } = {}) {\r\n\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tconst targetUuid = Utilities.getUuid(targetActor);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`removeCurrencies | Could not determine the UUID, please provide a valid target`);\r\n\r\n\t\tlet overallCost;\r\n\t\tlet secondaryPrices = false;\r\n\t\tif (typeof currencies === \"string\") {\r\n\t\t\tconst priceData = PileUtilities.getPriceFromString(currencies)\r\n\t\t\tconst currenciesToRemove = priceData.currencies.filter(currency => Helpers.isRealNumber(currency.quantity) && currency.quantity > 0);\r\n\t\t\tif (!currenciesToRemove.length) {\r\n\t\t\t\tthrow Helpers.custom_error(`removeCurrencies | Could not determine currencies to remove with string \"${currencies}\"`);\r\n\t\t\t}\r\n\t\t\toverallCost = priceData.overallCost;\r\n\t\t\tsecondaryPrices = currenciesToRemove.filter(currency => currency.secondary);\r\n\t\t} else {\r\n\t\t\tthrow Helpers.custom_error(`removeCurrencies | price must be of type string`);\r\n\t\t}\r\n\r\n\t\tconst paymentData = PileUtilities.getPaymentData({\r\n\t\t\tpurchaseData: [{ cost: overallCost, quantity: 1, secondaryPrices }], buyer: targetActor\r\n\t\t});\r\n\r\n\t\tif (!paymentData.canBuy) {\r\n\t\t\tthrow Helpers.custom_error(`removeCurrencies | ${targetActor.name} cannot afford \"${currencies}\"`);\r\n\t\t}\r\n\r\n\t\tif (!change && paymentData.buyerChange.length) {\r\n\t\t\tthrow Helpers.custom_error(`removeCurrencies | ${targetActor.name} cannot afford \"${currencies}\" without receiving change!`);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.REMOVE_CURRENCIES, targetUuid, currencies, game.user.id, { interactionId });\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Transfers currencies between the source and the target.\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} source                The actor to transfer currencies from\r\n\t * @param {Actor/Token/TokenDocument} target                The actor to receive the currencies\r\n\t * @param {string} currencies                               A string of currencies to transfer (eg, \"5gp 25sp\")\r\n\t * @param {object} options                                  Options to pass to the function\r\n\t * @param {boolean} [options.change=true]                   Whether the source actor can get change back\r\n\t * @param {string/boolean} [options.interactionId=false]    The ID of this interaction\r\n\t *\r\n\t * @returns {Promise<object>}                               An object containing the items and attributes transferred to the target\r\n\t */\r\n\tstatic transferCurrencies(source, target, currencies, { change = true, interactionId = false } = {}) {\r\n\r\n\t\tconst sourceActor = Utilities.getActor(source);\r\n\t\tconst sourceUuid = Utilities.getUuid(sourceActor);\r\n\t\tif (!sourceUuid) throw Helpers.custom_error(`transferCurrencies | Could not determine the UUID, please provide a valid source`);\r\n\r\n\t\tconst targetActor = Utilities.getActor(target);\r\n\t\tconst targetUuid = Utilities.getUuid(targetActor);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`transferCurrencies | Could not determine the UUID, please provide a valid target`);\r\n\r\n\t\tlet overallCost;\r\n\t\tlet secondaryPrices = false;\r\n\t\tif (typeof currencies === \"string\") {\r\n\t\t\tconst priceData = PileUtilities.getPriceFromString(currencies)\r\n\t\t\tconst currenciesToRemove = priceData.currencies.filter(currency => Helpers.isRealNumber(currency.quantity) && currency.quantity > 0);\r\n\t\t\tif (!currenciesToRemove.length) {\r\n\t\t\t\tthrow Helpers.custom_error(`transferCurrencies | Could not determine currencies to remove with string \"${currencies}\"`);\r\n\t\t\t}\r\n\t\t\toverallCost = priceData.overallCost;\r\n\t\t\tsecondaryPrices = currenciesToRemove.filter(currency => currency.secondary);\r\n\t\t} else {\r\n\t\t\tthrow Helpers.custom_error(`transferCurrencies | price must be of type string`);\r\n\t\t}\r\n\r\n\t\tconst paymentData = PileUtilities.getPaymentData({\r\n\t\t\tpurchaseData: [{ cost: overallCost, quantity: 1, secondaryPrices }], buyer: sourceActor\r\n\t\t});\r\n\r\n\t\tif (!paymentData.canBuy) {\r\n\t\t\tthrow Helpers.custom_error(`transferCurrencies | ${sourceActor.name} cannot afford to transfer \"${currencies}\"`);\r\n\t\t}\r\n\r\n\t\tif (!change && paymentData.buyerChange.length) {\r\n\t\t\tthrow Helpers.custom_error(`transferCurrencies | ${sourceActor.name} cannot afford to transfer \"${currencies}\" without receiving change!`);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRANSFER_CURRENCIES, sourceUuid, targetUuid, currencies, game.user.id, { interactionId });\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Transfers all currencies between the source and the target.\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} source                The actor to transfer all currencies from\r\n\t * @param {Actor/Token/TokenDocument} target                The actor to receive all the currencies\r\n\t * @param {object} options                                  Options to pass to the function\r\n\t * @param {string/boolean} [options.interactionId=false]    The ID of this interaction\r\n\t *\r\n\t * @returns {Promise<object>}                               An object containing all items and attributes transferred to the target\r\n\t */\r\n\tstatic transferAllCurrencies(source, target, { interactionId = false } = {}) {\r\n\r\n\t\tconst sourceUuid = Utilities.getUuid(source);\r\n\t\tif (!sourceUuid) throw Helpers.custom_error(`transferCurrencies | Could not determine the UUID, please provide a valid source`);\r\n\r\n\t\tconst targetUuid = Utilities.getUuid(target);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`transferCurrencies | Could not determine the UUID, please provide a valid target`);\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRANSFER_ALL_CURRENCIES, sourceUuid, targetUuid, game.user.id, { interactionId });\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Rolls on a table of items and collates them to be able to be added to actors and such\r\n\t *\r\n\t * @param {string/RollTable} table                              The name, ID, UUID, or the table itself, or an array of such\r\n\t * @param {object} options                                      Options to pass to the function\r\n\t * @param {string/number} [options.timesToRoll=\"1\"]             The number of times to roll on the tables, which can be a roll formula\r\n\t * @param {boolean} [options.resetTable=true]                   Whether to reset the table before rolling it\r\n\t * @param {boolean} [options.normalizeTable=true]               Whether to normalize the table before rolling it\r\n\t * @param {boolean} [options.displayChat=false]                 Whether to display the rolls to the chat\r\n\t * @param {object} [options.rollData={}]                        Data to inject into the roll formula\r\n\t * @param {Actor/string/boolean} [options.targetActor=false]    The target actor to add the items to, or the UUID of an actor\r\n\t * @param {boolean} [options.removeExistingActorItems=false]    Whether to clear the target actor's items before adding the ones rolled\r\n\t * @param {boolean/string} [options.customCategory=false]       Whether to apply a custom category to the items rolled\r\n\t *\r\n\t * @returns {Promise<Array<Item>>}                              An array of object containing the item data and their quantity\r\n\t */\r\n\tstatic async rollItemTable(table, {\r\n\t\ttimesToRoll = \"1\",\r\n\t\tresetTable = true,\r\n\t\tnormalizeTable = false,\r\n\t\tdisplayChat = false,\r\n\t\trollData = {},\r\n\t\ttargetActor = false,\r\n\t\tremoveExistingActorItems = false,\r\n\t\tcustomCategory = false\r\n\t} = {}) {\r\n\r\n\t\tlet rollTable = table;\r\n\t\tif (typeof table === \"string\") {\r\n\t\t\tlet potentialTable = await fromUuid(table);\r\n\t\t\tif (!potentialTable) {\r\n\t\t\t\tpotentialTable = game.tables.get(table)\r\n\t\t\t}\r\n\t\t\tif (!potentialTable) {\r\n\t\t\t\tpotentialTable = game.tables.getName(table)\r\n\t\t\t}\r\n\t\t\tif (!potentialTable) {\r\n\t\t\t\tthrow Helpers.custom_error(`rollItemTable | could not find table with string \"${table}\"`);\r\n\t\t\t}\r\n\t\t\tif (resetTable && table.startsWith(\"Compendium\")) {\r\n\t\t\t\tresetTable = false;\r\n\t\t\t}\r\n\t\t\trollTable = potentialTable;\r\n\t\t}\r\n\r\n\t\tif (!(rollTable instanceof RollTable)) {\r\n\t\t\tthrow Helpers.custom_error(`rollItemTable | table must be of type RollTable`);\r\n\t\t}\r\n\r\n\t\ttable = rollTable.uuid;\r\n\r\n\t\tif (!(typeof timesToRoll === \"string\" || typeof timesToRoll === \"number\")) {\r\n\t\t\tthrow Helpers.custom_error(`rollItemTable | timesToRoll must be of type string or number`);\r\n\t\t}\r\n\r\n\t\tif (typeof rollData !== \"object\") {\r\n\t\t\tthrow Helpers.custom_error(`rollItemTable | rollData must be of type object`);\r\n\t\t}\r\n\r\n\t\tif (typeof removeExistingActorItems !== \"boolean\") {\r\n\t\t\tthrow Helpers.custom_error(`rollItemTable | removeExistingActorItems of type boolean`);\r\n\t\t}\r\n\r\n\t\tif (targetActor) {\r\n\t\t\ttargetActor = Utilities.getActor(targetActor);\r\n\t\t\tif (!(targetActor instanceof Actor)) {\r\n\t\t\t\tthrow Helpers.custom_error(`rollItemTable | could not find the actor of the target actor`);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst items = await ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.ROLL_ITEM_TABLE, {\r\n\t\t\ttable,\r\n\t\t\ttimesToRoll,\r\n\t\t\tresetTable,\r\n\t\t\tnormalizeTable,\r\n\t\t\tdisplayChat,\r\n\t\t\trollData,\r\n\t\t\tcustomCategory,\r\n\t\t\ttargetActor: Utilities.getUuid(targetActor),\r\n\t\t\tremoveExistingActorItems,\r\n\t\t\tuserId: game.user.id\r\n\t\t});\r\n\r\n\t\tif (items) {\r\n\t\t\tfor (const entry of items) {\r\n\t\t\t\tentry.item = targetActor\r\n\t\t\t\t\t? targetActor.items.get(entry.item._id)\r\n\t\t\t\t\t: new Item.implementation(entry.item);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn items;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Refreshes the merchant's inventory, potentially removing existing items and populating it based on its item tables\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} target                  The merchant actor to refresh the inventory of\r\n\t * @param {object} options                                    Options to pass to the function\r\n\t * @param {boolean} [options.removeExistingActorItems=true]   Whether to clear the merchant's existing inventory before adding the new items\r\n\t * @returns {Promise<boolean|*>}\r\n\t */\r\n\tstatic async refreshMerchantInventory(target, { removeExistingActorItems = true } = {}) {\r\n\r\n\t\tif (target) {\r\n\t\t\ttarget = Utilities.getActor(target);\r\n\t\t\tif (!(target instanceof Actor)) {\r\n\t\t\t\tthrow Helpers.custom_error(`refreshMerchantInventory | could not find the actor of the target actor`);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst targetUuid = Utilities.getUuid(target);\r\n\r\n\t\tif (!PileUtilities.isItemPileMerchant(target)) {\r\n\t\t\tthrow Helpers.custom_error(`refreshMerchantInventory | target of uuid ${targetUuid} is not a merchant`);\r\n\t\t}\r\n\r\n\t\tif (typeof removeExistingActorItems !== \"boolean\") {\r\n\t\t\tthrow Helpers.custom_error(`refreshMerchantInventory | removeExistingActorItems of type boolean`);\r\n\t\t}\r\n\r\n\t\tconst items = await ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.REFRESH_MERCHANT_INVENTORY, targetUuid, {\r\n\t\t\tremoveExistingActorItems,\r\n\t\t\tuserId: game.user.id\r\n\t\t});\r\n\r\n\t\tif (items) {\r\n\t\t\tfor (const entry of items) {\r\n\t\t\t\tentry.item = target.items.get(entry.item._id);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn items;\r\n\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Gets all the valid items from a given actor or token, excluding items based on its item type filters\r\n\t *\r\n\t * @param {Actor/TokenDocument/Token} target      The target to get the items from\r\n\t *\r\n\t * @returns {Array<Item>}                         Array containing the target's valid items\r\n\t */\r\n\tstatic getActorItems(target) {\r\n\t\treturn PileUtilities.getActorItems(target);\r\n\t}\r\n\r\n\tstatic findSimilarItem(itemsToSearch, itemToFind, options = {}) {\r\n\t\treturn Utilities.findSimilarItem(itemsToSearch, itemToFind, options);\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the valid currencies from a given actor or token\r\n\t *\r\n\t * @param {Actor/TokenDocument/Token} target      The target to get the currencies from\r\n\t * @param {object} [options]                      Object containing optional parameters\r\n\t * @param {Boolean} [options.getAll]              Whether to get all the currencies, regardless of quantity\r\n\t *\r\n\t * @returns {Array<object>}                       An array of objects containing the data about each currency\r\n\t */\r\n\tstatic getActorCurrencies(target, { getAll = false, secondary = true } = {}) {\r\n\t\treturn PileUtilities.getActorCurrencies(target, { getAll, secondary });\r\n\t}\r\n\r\n\tstatic updateTokenHud() {\r\n\t\treturn ItemPileSocket.executeForEveryone(ItemPileSocket.HANDLERS.RERENDER_TOKEN_HUD);\r\n\t}\r\n\r\n\tstatic requestTrade(user) {\r\n\t\treturn TradeAPI._requestTrade(user);\r\n\t}\r\n\r\n\tstatic spectateTrade(tradeId) {\r\n\t\treturn TradeAPI._spectateTrade(tradeId);\r\n\t}\r\n\r\n\t/**\r\n\t * Renders the appropriate interface for a given actor\r\n\t *\r\n\t * @param {Actor/TokenDocument} target                      The actor whose interface to render\r\n\t * @param {object} options                                  An object containing the options for this method\r\n\t * @param {Array<string/User>} [options.userIds]            An array of users or user ids for each user to render the interface for (defaults to only self)\r\n\t * @param {Actor/TokenDocument} [options.inspectingTarget]  Sets what actor should be viewing the interface\r\n\t * @param {boolean} [options.useDefaultCharacter]           Whether other users should use their assigned character when rendering the interface\r\n\t *\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic renderItemPileInterface(target, {\r\n\t\tuserIds = null, inspectingTarget = null, useDefaultCharacter = false\r\n\t} = {}) {\r\n\r\n\t\tconst targetDocument = Utilities.getDocument(target);\r\n\t\tconst targetUuid = Utilities.getUuid(targetDocument);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`renderItemPileInterface | Could not determine the UUID, please provide a valid target item pile`);\r\n\r\n\t\tif (!PileUtilities.isValidItemPile(targetDocument)) {\r\n\t\t\tthrow Helpers.custom_error(\"renderItemPileInterface | This target is not a valid item pile\")\r\n\t\t}\r\n\r\n\t\tif (!inspectingTarget && !useDefaultCharacter) {\r\n\t\t\tuseDefaultCharacter = true;\r\n\t\t}\r\n\r\n\t\tif (inspectingTarget && useDefaultCharacter) {\r\n\t\t\tthrow Helpers.custom_error(\"renderItemPileInterface | You cannot force users to use both their default character and a specific character to inspect the pile\")\r\n\t\t}\r\n\r\n\t\tconst inspectingTargetUuid = inspectingTarget ? Utilities.getUuid(inspectingTarget) : false;\r\n\t\tif (inspectingTarget && !inspectingTargetUuid) throw Helpers.custom_error(`renderItemPileInterface | Could not determine the UUID, please provide a valid inspecting target`);\r\n\r\n\t\tif (!Array.isArray(userIds)) {\r\n\t\t\tif (userIds === null) {\r\n\t\t\t\tuserIds = [game.user.id];\r\n\t\t\t} else {\r\n\t\t\t\tuserIds = [userIds]\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tuserIds = userIds.map(user => {\r\n\t\t\t\treturn user instanceof User ? user.id : user;\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (!game.user.isGM) {\r\n\t\t\tif (userIds.length > 1 || !userIds.includes(game.user.id)) {\r\n\t\t\t\tthrow Helpers.custom_error(`renderItemPileInterface | You are not a GM, so you cannot force others to render an item pile's interface`);\r\n\t\t\t}\r\n\t\t\tuserIds = [game.user.id];\r\n\t\t}\r\n\r\n\t\tif (userIds.length === 1 && userIds[0] === game.user.id) {\r\n\t\t\treturn PrivateAPI._renderItemPileInterface(targetUuid, {\r\n\t\t\t\tinspectingTargetUuid, useDefaultCharacter, remote: true\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tfor (const userId of userIds) {\r\n\t\t\tconst user = game.users.get(userId);\r\n\t\t\tif (!user) throw Helpers.custom_error(`renderItemPileInterface | No user with ID \"${userId}\" exists`);\r\n\t\t\tif (user.isGM) continue;\r\n\t\t\tif (useDefaultCharacter) {\r\n\t\t\t\tif (!user.character) {\r\n\t\t\t\t\tHelpers.custom_warning(`renderItemPileInterface | User \"${user.name}\" has no default character`, true);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeForUsers(ItemPileSocket.HANDLERS.RENDER_INTERFACE, userIds, targetUuid, {\r\n\t\t\tinspectingTargetUuid, useDefaultCharacter, remote: true\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Closes any open interfaces from a given item pile actor\r\n\t *\r\n\t * @param {Actor/TokenDocument} target                      The actor whose interface to potentially close\r\n\t * @param {object} options                                  An object containing the options for this method\r\n\t * @param {Array<string/User>} [options.userIds]            An array of users or user ids for each user to close the interface for (defaults to only self)\r\n\t *\r\n\t * @returns {Promise}\r\n\t */\r\n\tstatic unrenderItemPileInterface(target, { userIds = null } = {}) {\r\n\r\n\t\tconst targetDocument = Utilities.getDocument(target);\r\n\t\tconst targetUuid = Utilities.getUuid(targetDocument);\r\n\t\tif (!targetUuid) throw Helpers.custom_error(`unrenderItemPileInterface | Could not determine the UUID, please provide a valid target item pile`);\r\n\r\n\t\tif (!PileUtilities.isValidItemPile(targetDocument)) {\r\n\t\t\tthrow Helpers.custom_error(\"unrenderItemPileInterface | This target is not a valid item pile\")\r\n\t\t}\r\n\r\n\t\tif (!Array.isArray(userIds)) {\r\n\t\t\tif (userIds === null) {\r\n\t\t\t\tuserIds = [game.user.id];\r\n\t\t\t} else {\r\n\t\t\t\tuserIds = [userIds]\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tuserIds = userIds.map(user => {\r\n\t\t\t\treturn user instanceof User ? user.id : user;\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (!game.user.isGM) {\r\n\t\t\tif (userIds.length > 1 || !userIds.includes(game.user.id)) {\r\n\t\t\t\tthrow Helpers.custom_error(`unrenderItemPileInterface | You are not a GM, so you cannot force others to close an item pile's interface`);\r\n\t\t\t}\r\n\t\t\tuserIds = [game.user.id];\r\n\t\t}\r\n\r\n\t\tif (userIds.length === 1 && userIds[0] === game.user.id) {\r\n\t\t\treturn PrivateAPI._unrenderItemPileInterface(targetUuid, { remote: true });\r\n\t\t}\r\n\r\n\t\tfor (const userId of userIds) {\r\n\t\t\tconst user = game.users.get(userId);\r\n\t\t\tif (!user) throw Helpers.custom_error(`unrenderItemPileInterface | No user with ID \"${userId}\" exists`);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeForUsers(ItemPileSocket.HANDLERS.UNRENDER_INTERFACE, userIds, targetUuid, { remote: true });\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieves the total numerical cost of an item\r\n\t *\r\n\t * @param item\r\n\t * @returns {number}\r\n\t */\r\n\tstatic getCostOfItem(item) {\r\n\t\treturn PileUtilities.getCostOfItem(item);\r\n\t}\r\n\r\n\t/**\r\n\t *  Get the prices array for a given item\r\n\t *\r\n\t * @param {Item} item                             Item to get the price for\r\n\t * @param {object} options                        Options to pass to the function\r\n\t * @param {Actor/boolean} [options.seller=false]  Actor that is selling the item\r\n\t * @param {Actor/boolean} [options.buyer=false]   Actor that is buying the item\r\n\t * @param {number} [options.quantity=1]           Quantity of item to buy\r\n\t *\r\n\t * @returns {Array}                               Array containing all the different purchase options for this item\r\n\t */\r\n\tstatic getPricesForItem(item, { seller = false, buyer = false, quantity = 1 } = {}) {\r\n\r\n\t\tif (!(item instanceof Item)) {\r\n\t\t\tthrow Helpers.custom_error(\"getPricesForItem | The given item must be of type Item\");\r\n\t\t}\r\n\r\n\t\tif (seller) {\r\n\t\t\tseller = Utilities.getActor(seller);\r\n\t\t\tif (!seller) {\r\n\t\t\t\tthrow Helpers.custom_error(\"getPricesForItem | Could not determine actor for the seller\");\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (!item.parent) {\r\n\t\t\t\tthrow Helpers.custom_error(\"getPricesForItem | If no seller was given, the item must belong to an actor\");\r\n\t\t\t}\r\n\t\t\tseller = Utilities.getActor(item.parent);\r\n\t\t}\r\n\r\n\t\tif (buyer) {\r\n\t\t\tbuyer = Utilities.getActor(buyer);\r\n\t\t\tif (!buyer) {\r\n\t\t\t\tthrow Helpers.custom_error(`getPricesForItem | Could not determine the actor for the buyer`);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn PileUtilities.getPriceData({ item, seller, buyer, quantity });\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Trades multiple items between one actor to another, and currencies and/or change is exchanged between them\r\n\t *\r\n\t * @param {Actor/Token/TokenDocument} seller                                                    The actor that is selling the item\r\n\t * @param {Actor/Token/TokenDocument} buyer                                                     The actor that is buying the item\r\n\t * @param {Array<Object<{ item: Item/string, quantity: number, paymentIndex: number }>>} items  An array of objects containing the item or the id of the\r\n\t *                                                                                              item to be sold, the quantity to be sold, and the payment\r\n\t *                                                                                              index to be used\r\n\t * @param {string/boolean} [interactionId=false]                                                The ID of this interaction\r\n\t *\r\n\t * @returns {Promise<Object>}                       The items that were created and the attributes that were changed\r\n\t */\r\n\tstatic tradeItems(seller, buyer, items, { interactionId = false } = {}) {\r\n\r\n\t\tconst sellerActor = Utilities.getActor(seller);\r\n\t\tconst sellerUuid = Utilities.getUuid(sellerActor);\r\n\t\tif (!sellerUuid) {\r\n\t\t\tthrow Helpers.custom_error(`tradeItems | Could not determine the UUID of the seller, please provide a valid actor or token`, true);\r\n\t\t}\r\n\r\n\t\tconst buyerActor = Utilities.getActor(buyer);\r\n\t\tconst buyerUuid = Utilities.getUuid(buyer);\r\n\t\tif (!buyerUuid) {\r\n\t\t\tthrow Helpers.custom_error(`tradeItems | Could not determine the UUID of the buyer, please provide a valid actor or token`, true);\r\n\t\t}\r\n\r\n\t\tlet itemsToSell = items.map(data => {\r\n\r\n\t\t\tdata = foundry.utils.mergeObject({\r\n\t\t\t\titem: \"\", quantity: 1, paymentIndex: 0\r\n\t\t\t}, data);\r\n\r\n\t\t\tif (!data.item) {\r\n\t\t\t\tthrow Helpers.custom_error(`tradeItems | You must provide an item!`, true);\r\n\t\t\t}\r\n\r\n\t\t\tlet actorItem;\r\n\t\t\tif (typeof data.item === \"string\") {\r\n\t\t\t\tactorItem = sellerActor.items.get(data.item) || sellerActor.items.getName(data.item);\r\n\t\t\t\tif (!actorItem) {\r\n\t\t\t\t\tthrow Helpers.custom_error(`tradeItems | Could not find item on seller with identifier \"${data.item}\"`);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tactorItem = sellerActor.items.get(data.item instanceof Item ? data.item.id : data.item._id) || sellerActor.items.getName(data.item.name);\r\n\t\t\t\tif (!actorItem) {\r\n\t\t\t\t\tthrow Helpers.custom_error(`tradeItems | Could not find provided item on seller`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst itemPrices = PileUtilities.getPriceData({\r\n\t\t\t\titem: actorItem, seller: sellerActor, buyer: buyerActor, quantity: data.quantity\r\n\t\t\t});\r\n\t\t\tif (itemPrices.length) {\r\n\t\t\t\tif (data.paymentIndex >= itemPrices.length || data.paymentIndex < 0) {\r\n\t\t\t\t\tthrow Helpers.custom_error(`tradeItems | That payment index does not exist on ${actorItem.name}`, true);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst selectedPrice = itemPrices[data.paymentIndex];\r\n\t\t\t\tif (data.quantity > selectedPrice.maxQuantity) {\r\n\t\t\t\t\tthrow Helpers.custom_error(`tradeItems | The buyer actor cannot afford ${data.quantity} of ${actorItem.name} (max ${selectedPrice.maxQuantity})`, true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\tid: actorItem.id, quantity: data.quantity, paymentIndex: data.paymentIndex\r\n\t\t\t};\r\n\r\n\t\t});\r\n\r\n\t\tif (PileUtilities.isItemPileVault(buyerActor)) {\r\n\t\t\tconst items = itemsToSell.reduce((acc, data) => {\r\n\t\t\t\tconst item = sellerActor.items.get(data.id);\r\n\t\t\t\tif (PileUtilities.canItemStack(item, buyerActor)) {\r\n\t\t\t\t\tacc.push(item);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (let i = 0; i < data.quantity; i++) {\r\n\t\t\t\t\t\tacc.push(item);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn acc;\r\n\t\t\t}, []);\r\n\t\t\tconst canItemsFit = PileUtilities.fitItemsIntoVault(items, buyerActor);\r\n\t\t\tif (!canItemsFit) throw Helpers.custom_error(`tradeItems | The vault buyer actor ${buyerActor.name} cannot fit these items`, true);\r\n\t\t}\r\n\r\n\t\treturn ItemPileSocket.executeAsGM(ItemPileSocket.HANDLERS.TRADE_ITEMS, sellerUuid, buyerUuid, itemsToSell, game.user.id, { interactionId });\r\n\r\n\t}\r\n\r\n\tstatic canItemFitInVault(item, vaultActor) {\r\n\t\treturn PileUtilities.canItemFitInVault(item, vaultActor);\r\n\t}\r\n\r\n\tstatic fitItemsIntoVault(items, vaultActor) {\r\n\t\treturn PileUtilities.fitItemsIntoVault(items, vaultActor);\r\n\t}\r\n\r\n\tstatic async registerItemPileType(type, label, flags = []) {\r\n\t\tgame.i18n.translations['ITEM-PILES'].Types[type] = \"Custom: \" + label;\r\n\t\tCONSTANTS.CUSTOM_PILE_TYPES[type] = flags;\r\n\t}\r\n\r\n\tstatic isItemInvalid(item) {\r\n\t\treturn PileUtilities.isItemInvalid(item.parent, item);\r\n\t}\r\n\r\n\tstatic canItemStack(item, actor = false) {\r\n\t\treturn PileUtilities.canItemStack(item, actor);\r\n\t}\r\n\r\n\tstatic getVaultGridData(vaultActor) {\r\n\t\treturn PileUtilities.getVaultGridData(vaultActor);\r\n\t}\r\n\r\n\tstatic getActorFlagData(actor) {\r\n\t\treturn PileUtilities.getActorFlagData(actor);\r\n\t}\r\n\r\n\tstatic getItemQuantity(item) {\r\n\t\treturn Utilities.getItemQuantity(item);\r\n\t}\r\n\r\n\tstatic showItemPileConfig(actor) {\r\n\t\tif (!PileUtilities.isValidItemPile(actor)) return;\r\n\t\treturn ItemPileConfig.show(actor);\r\n\t}\r\n\r\n}\r\n\r\nexport default API;\r\n","import CONSTANTS from \"./constants/constants.js\";\r\nimport * as Helpers from \"./helpers/helpers.js\";\r\nimport * as PileUtilities from \"./helpers/pile-utilities.js\";\r\nimport SETTINGS from \"./constants/settings.js\";\r\nimport { findOrCreateItemInCompendium } from \"./helpers/compendium-utilities.js\";\r\n\r\nexport default async function runMigrations() {\r\n\r\n\tfor (const version of Object.keys(migrations)) {\r\n\t\ttry {\r\n\t\t\tawait migrations[version](version);\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(err);\r\n\t\t\tHelpers.custom_warning(`Something went wrong when migrating to version ${version}. Please check the console for the error!`, true)\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction getItemPileActorsOfLowerVersion(version) {\r\n\treturn PileUtilities.getItemPileActors((actor) => {\r\n\t\tconst actorFlagVersion = foundry.utils.getProperty(actor, CONSTANTS.FLAGS.VERSION) || \"1.0.0\";\r\n\t\treturn foundry.utils.getProperty(actor, CONSTANTS.FLAGS.PILE)?.enabled && foundry.utils.isNewerVersion(version, actorFlagVersion);\r\n\t})\r\n}\r\n\r\nfunction getItemPileTokensOfLowerVersion(version) {\r\n\treturn PileUtilities.getItemPileTokens((token) => {\r\n\t\ttry {\r\n\t\t\tconst actorFlagVersion = foundry.utils.getProperty(token, CONSTANTS.FLAGS.VERSION) || \"1.0.0\";\r\n\t\t\treturn token.actor && foundry.utils.isNewerVersion(version, actorFlagVersion);\r\n\t\t} catch (err) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t})\r\n}\r\n\r\nfunction filterValidItems(items, version) {\r\n\treturn items.filter(item => {\r\n\t\tconst itemFlagVersion = foundry.utils.getProperty(item, CONSTANTS.FLAGS.VERSION);\r\n\t\treturn (itemFlagVersion && foundry.utils.isNewerVersion(version, itemFlagVersion)) || (!itemFlagVersion && foundry.utils.hasProperty(item, CONSTANTS.FLAGS.ITEM));\r\n\t});\r\n}\r\n\r\nfunction getActorValidItems(actor, version) {\r\n\treturn filterValidItems(actor.items, version);\r\n}\r\n\r\n/**\r\n * @param version\r\n * @param {Function} callback\r\n * @returns {Promise}\r\n */\r\nasync function updateActors(version, callback) {\r\n\r\n\tconst actorUpdates = getItemPileActorsOfLowerVersion(version).map(actor => {\r\n\t\tlet flags = foundry.utils.getProperty(actor, CONSTANTS.FLAGS.PILE);\r\n\t\tconst flagData = {\r\n\t\t\t[CONSTANTS.FLAGS.PILE]: callback(flags, actor), [CONSTANTS.FLAGS.VERSION]: version\r\n\t\t}\r\n\t\tif (actor.actorLink) {\r\n\t\t\tflagData[\"token\"] = foundry.utils.deepClone(flagData);\r\n\t\t}\r\n\t\treturn {\r\n\t\t\t_id: actor.id, ...flagData\r\n\t\t};\r\n\t});\r\n\r\n\tif (actorUpdates.length) {\r\n\t\tHelpers.debug(`Item Piles | Migrating ${actorUpdates.length} actors to version ${version}...`)\r\n\t\tawait Actor.updateDocuments(actorUpdates);\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * @param version\r\n * @param {Function} callback\r\n * @returns {Promise}\r\n */\r\nasync function updateTokens(version, callback) {\r\n\r\n\tconst { validTokensOnScenes } = getItemPileTokensOfLowerVersion(version);\r\n\r\n\tfor (const [sceneId, tokens] of validTokensOnScenes) {\r\n\t\tconst scene = game.scenes.get(sceneId)\r\n\t\tconst updates = tokens.map(token => ({\r\n\t\t\t_id: token.id,\r\n\t\t\t[CONSTANTS.FLAGS.PILE]: callback(getProperty(token, CONSTANTS.FLAGS.PILE)),\r\n\t\t\t[CONSTANTS.FLAGS.VERSION]: version,\r\n\t\t}));\r\n\t\tif (updates.length) {\r\n\t\t\tHelpers.debug(`Item Piles | Migrating ${updates.length} tokens on scene \"${sceneId}\" to version ${version}...`);\r\n\t\t\tawait scene.updateEmbeddedDocuments(\"Token\", updates, { animate: false });\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * @param version\r\n * @param {Function} callback\r\n * @returns {Promise}\r\n */\r\nasync function updateItems(version, callback) {\r\n\r\n\tconst gameItems = filterValidItems(game.items, version);\r\n\r\n\tconst gameItemUpdates = gameItems.map(item => {\r\n\t\tconst flags = foundry.utils.getProperty(item, CONSTANTS.FLAGS.ITEM);\r\n\t\tif (!flags) return false;\r\n\t\treturn PileUtilities.updateItemData(item, {\r\n\t\t\tflags: callback(flags)\r\n\t\t}, { version, returnUpdate: true });\r\n\t}).filter(Boolean);\r\n\r\n\tif (gameItemUpdates.length) {\r\n\t\tHelpers.debug(`Item Piles | Migrating ${gameItemUpdates.length} items to version ${version}...`);\r\n\t\tawait Item.updateDocuments(gameItemUpdates);\r\n\t}\r\n\r\n\tconst actors = getItemPileActorsOfLowerVersion(version);\r\n\r\n\tconst actorItemUpdates = actors.map(actor => {\r\n\r\n\t\tconst itemPileItems = getActorValidItems(actor, version)\r\n\r\n\t\treturn {\r\n\t\t\tactor,\r\n\t\t\tupdate: {\r\n\t\t\t\t_id: actor.id,\r\n\t\t\t\t[CONSTANTS.FLAGS.VERSION]: version\r\n\t\t\t},\r\n\t\t\titems: itemPileItems.map(item => {\r\n\t\t\t\tconst flags = foundry.utils.getProperty(item, CONSTANTS.FLAGS.ITEM);\r\n\t\t\t\tif (!flags) return false;\r\n\t\t\t\treturn PileUtilities.updateItemData(item, {\r\n\t\t\t\t\tflags: callback(flags)\r\n\t\t\t\t}, { version, returnUpdate: true });\r\n\t\t\t}).filter(Boolean)\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tif (actorItemUpdates.length) {\r\n\t\tHelpers.debug(`Item Piles | Migrating ${actorItemUpdates.length} item pile actors' items to version ${version}...`)\r\n\t}\r\n\r\n\tawait Actor.updateDocuments(actorItemUpdates.map(data => data.update))\r\n\r\n\tfor (const { actor, items } of actorItemUpdates) {\r\n\t\tawait actor.updateEmbeddedDocuments(\"Item\", items);\r\n\t}\r\n\r\n\tconst { validTokensOnScenes } = getItemPileTokensOfLowerVersion(version);\r\n\r\n\tfor (const [sceneId, tokens] of validTokensOnScenes) {\r\n\r\n\t\tconst scene = game.scenes.get(sceneId);\r\n\r\n\t\tconst updates = tokens.map(token => {\r\n\t\t\tconst itemPileItems = getActorValidItems(token.actor, version);\r\n\t\t\treturn {\r\n\t\t\t\ttoken,\r\n\t\t\t\tupdate: {\r\n\t\t\t\t\t_id: token.id,\r\n\t\t\t\t\t[CONSTANTS.FLAGS.VERSION]: version\r\n\t\t\t\t},\r\n\t\t\t\titems: itemPileItems.map(item => {\r\n\t\t\t\t\tconst flags = foundry.utils.getProperty(item, CONSTANTS.FLAGS.ITEM);\r\n\t\t\t\t\tif (!flags) return false;\r\n\t\t\t\t\treturn PileUtilities.updateItemData(item, {\r\n\t\t\t\t\t\tflags: callback(flags)\r\n\t\t\t\t\t}, { version, returnUpdate: true });\r\n\t\t\t\t}).filter(Boolean)\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (updates.length) {\r\n\t\t\tHelpers.debug(`Item Piles | Migrating ${updates.length} tokens on scene \"${sceneId}\" to version ${version}...`);\r\n\t\t}\r\n\r\n\t\tawait scene.updateEmbeddedDocuments(\"Token\", updates.map(data => data.update), { animate: false });\r\n\r\n\t\tfor (const { token, itemUpdates } of updates) {\r\n\t\t\tawait token.actor.updateEmbeddedDocuments(\"Item\", itemUpdates);\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nconst migrations = {\r\n\r\n\t\"2.4.0\": async (version) => {\r\n\r\n\t\tawait updateActors(version, (flags) => {\r\n\t\t\treturn PileUtilities.cleanFlagData(flags);\r\n\t\t});\r\n\r\n\t\tawait updateTokens(version, (flags) => {\r\n\t\t\treturn PileUtilities.cleanFlagData(flags);\r\n\t\t});\r\n\r\n\t\tconst { invalidTokensOnScenes } = getItemPileTokensOfLowerVersion(version);\r\n\r\n\t\tfor (const [sceneId, tokens] of invalidTokensOnScenes) {\r\n\r\n\t\t\tconst scene = game.scenes.get(sceneId);\r\n\r\n\t\t\tlet deletions = [];\r\n\t\t\tlet updates = [];\r\n\t\t\tfor (const token of tokens) {\r\n\r\n\t\t\t\tconst flagData = {\r\n\t\t\t\t\t[CONSTANTS.FLAGS.PILE]: PileUtilities.cleanFlagData(PileUtilities.migrateFlagData(token)),\r\n\t\t\t\t\t[CONSTANTS.FLAGS.VERSION]: version,\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet tokenActor = game.actors.get(token.actorId);\r\n\t\t\t\tif (!tokenActor) {\r\n\t\t\t\t\ttokenActor = game.actors.get(Helpers.getSetting(SETTINGS.DEFAULT_ITEM_PILE_ACTOR_ID));\r\n\t\t\t\t}\r\n\t\t\t\tif (!tokenActor) {\r\n\t\t\t\t\tdeletions.push(token.id);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst update = {\r\n\t\t\t\t\t_id: token.id, actorId: tokenActor.id, [CONSTANTS.ACTOR_DELTA_PROPERTY]: {\r\n\t\t\t\t\t\titems: []\r\n\t\t\t\t\t}, ...flagData\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (let itemData of token[CONSTANTS.ACTOR_DELTA_PROPERTY]?.items ?? []) {\r\n\t\t\t\t\tconst item = new Item.implementation(itemData);\r\n\t\t\t\t\tupdate[CONSTANTS.ACTOR_DELTA_PROPERTY].items.push(item.toObject());\r\n\t\t\t\t}\r\n\r\n\t\t\t\tupdates.push(update);\r\n\t\t\t}\r\n\r\n\t\t\tawait scene.updateEmbeddedDocuments(\"Token\", updates, { animate: false });\r\n\t\t\tawait scene.deleteEmbeddedDocuments(\"Token\", deletions);\r\n\r\n\t\t\tHelpers.debug(`Item Piles | Fixing ${updates.length} tokens on scene \"${sceneId}\" to version ${version}...`);\r\n\r\n\t\t}\r\n\r\n\t\tif (invalidTokensOnScenes.length && invalidTokensOnScenes.some(([sceneId]) => sceneId === game.user.viewedScene)) {\r\n\t\t\tui.notifications.notify(\"Item Piles | Attempted to fix some broken tokens on various scenes. If the current scene fails to load, please refresh.\")\r\n\t\t}\r\n\t},\r\n\r\n\t\"2.4.17\": async (version) => {\r\n\r\n\t\tawait updateItems(version, (flags) => {\r\n\t\t\tflags.infiniteQuantity = \"default\";\r\n\t\t\treturn flags;\r\n\t\t});\r\n\r\n\t},\r\n\r\n\t\"2.6.1\": async (version) => {\r\n\r\n\t\tconst flagUpdateCallback = (flags) => {\r\n\t\t\tif (flags?.itemTypePriceModifiers) {\r\n\t\t\t\tflags.itemTypePriceModifiers = flags.itemTypePriceModifiers.map(priceModifier => {\r\n\t\t\t\t\tconst custom = Object.keys(CONFIG.Item.typeLabels).indexOf(priceModifier.type) === -1;\r\n\t\t\t\t\tpriceModifier.category = custom ? priceModifier.type : \"\";\r\n\t\t\t\t\tpriceModifier.type = custom ? \"custom\" : priceModifier.type;\r\n\t\t\t\t\treturn priceModifier;\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\treturn flags;\r\n\t\t}\r\n\r\n\t\tawait updateActors(version, flagUpdateCallback);\r\n\t\tawait updateTokens(version, flagUpdateCallback);\r\n\r\n\t},\r\n\r\n\t\"2.7.18\": async (version) => {\r\n\r\n\t\tconst actors = getItemPileActorsOfLowerVersion(version);\r\n\r\n\t\tconst recursivelyAddItemsToCompendium = async (itemData) => {\r\n\t\t\tconst flagData = PileUtilities.getItemFlagData(itemData);\r\n\t\t\tfor (const priceGroup of flagData?.prices ?? []) {\r\n\t\t\t\tfor (const price of priceGroup) {\r\n\t\t\t\t\tif (price.type !== \"item\" || !price.data.item) continue;\r\n\t\t\t\t\tconst compendiumItemUuid = (await recursivelyAddItemsToCompendium(price.data.item).uuid);\r\n\t\t\t\t\tprice.data = { uuid: compendiumItemUuid };\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfoundry.utils.setProperty(itemData, CONSTANTS.FLAGS.ITEM, PileUtilities.cleanItemFlagData(flagData, { addRemoveFlag: true }));\r\n\t\t\treturn findOrCreateItemInCompendium(itemData);\r\n\t\t}\r\n\r\n\t\tconst getActorItemUpdates = async (actorItems) => {\r\n\t\t\tconst items = actorItems.filter(item => PileUtilities.getItemFlagData(item).prices.length);\r\n\t\t\tconst updates = [];\r\n\t\t\tfor (const item of items) {\r\n\t\t\t\tconst flagData = PileUtilities.getItemFlagData(item);\r\n\t\t\t\tlet update = false;\r\n\t\t\t\tif (!flagData.prices.length) continue;\r\n\t\t\t\tfor (const priceGroup of flagData.prices) {\r\n\t\t\t\t\tfor (const price of priceGroup) {\r\n\t\t\t\t\t\tif (price.type !== \"item\" || !price.data.item) continue;\r\n\t\t\t\t\t\tconst compendiumItem = await recursivelyAddItemsToCompendium(price.data.item);\r\n\t\t\t\t\t\tprice.data = { uuid: compendiumItem.uuid };\r\n\t\t\t\t\t\tupdate = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (update) {\r\n\t\t\t\t\tupdates.push({\r\n\t\t\t\t\t\t_id: item.id,\r\n\t\t\t\t\t\t[CONSTANTS.FLAGS.VERSION]: version,\r\n\t\t\t\t\t\t[CONSTANTS.FLAGS.ITEM]: PileUtilities.cleanItemFlagData(flagData)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn updates;\r\n\t\t}\r\n\r\n\t\tconst updates = await getActorItemUpdates(filterValidItems(game.items, version));\r\n\t\tif (updates.length) {\r\n\t\t\tHelpers.debug(`Item Piles | Migrating ${updates.length} items to version ${version}...`);\r\n\t\t\tawait Item.updateDocuments(updates);\r\n\t\t}\r\n\r\n\t\tlet updatedActors = 0;\r\n\t\tfor (const actor of actors) {\r\n\t\t\tconst items = getActorValidItems(actor, version);\r\n\t\t\tconst updates = await getActorItemUpdates(items);\r\n\t\t\tif (updates.length) {\r\n\t\t\t\tawait actor.updateEmbeddedDocuments(\"Item\", updates);\r\n\t\t\t\tupdatedActors++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (updatedActors) {\r\n\t\t\tHelpers.debug(`Item Piles | Migrating ${updatedActors} actors with out of date items to version ${version}...`);\r\n\t\t}\r\n\r\n\t\tconst { validTokensOnScenes } = getItemPileTokensOfLowerVersion(version);\r\n\r\n\t\tfor (const [sceneId, tokens] of validTokensOnScenes) {\r\n\t\t\tlet updatedTokens = 0;\r\n\t\t\tfor (const token of tokens) {\r\n\t\t\t\tconst items = getActorValidItems(token.actor, version);\r\n\t\t\t\tconst updates = await getActorItemUpdates(items);\r\n\t\t\t\tif (updates.length) {\r\n\t\t\t\t\tupdatedTokens++;\r\n\t\t\t\t\tawait token.actor.updateEmbeddedDocuments(\"Item\", updates);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (updatedTokens) {\r\n\t\t\t\tHelpers.debug(`Item Piles | Migrating ${updatedTokens} tokens on scene \"${sceneId}\" to version ${version}...`);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t\"2.8.2\": async (version) => {\r\n\r\n\t\tconst flagUpdateCallback = (flags) => {\r\n\t\t\tif (flags?.canStackItems !== undefined) {\r\n\t\t\t\tflags.canStackItems = flags.canStackItems ? \"yes\" : \"no\";\r\n\t\t\t}\r\n\t\t\treturn flags;\r\n\t\t}\r\n\r\n\t\tawait updateActors(version, flagUpdateCallback);\r\n\t\tawait updateTokens(version, flagUpdateCallback);\r\n\r\n\t}\r\n};\r\n","import \"./styles/styles.scss\";\n\nimport CONSTANTS from \"./constants/constants.js\";\nimport registerUIOverrides from \"./foundry-ui-overrides.js\";\nimport registerLibwrappers from \"./libwrapper.js\";\nimport {\n\tapplySystemSpecificStyles,\n\tcheckSystem,\n\tpatchCurrencySettings,\n\tregisterSettings\n} from \"./settings.js\";\nimport { registerHotkeysPost, registerHotkeysPre } from \"./hotkeys.js\";\nimport Socket from \"./socket.js\";\nimport API from \"./API/api.js\";\nimport TradeAPI from \"./API/trade-api.js\";\nimport ChatAPI from \"./API/chat-api.js\";\nimport PrivateAPI from \"./API/private-api.js\";\nimport * as Helpers from \"./helpers/helpers.js\";\nimport runMigrations from \"./migrations.js\"\n\nimport ItemPileConfig from \"./applications/item-pile-config/item-pile-config.js\";\nimport ItemEditor from \"./applications/item-editor/item-editor.js\";\nimport { setupPlugins } from \"./plugins/main.js\";\nimport { setupCaches } from \"./helpers/caches.js\";\nimport { initializeCompendiumCache } from \"./helpers/compendium-utilities.js\";\nimport { SYSTEMS } from \"./systems.js\";\nimport Transaction from \"./helpers/transaction.js\";\n\nHooks.once(\"init\", async () => {\n\tregisterSettings();\n\tregisterHotkeysPre();\n\tregisterLibwrappers();\n\tregisterUIOverrides();\n\tsetupCaches();\n\tsetupPlugins(\"init\");\n\n\tgame.itempiles = {\n\t\tAPI,\n\t\thooks: CONSTANTS.HOOKS,\n\t\tflags: CONSTANTS.FLAGS,\n\t\tpile_types: CONSTANTS.PILE_TYPES,\n\t\tpile_flag_defaults: CONSTANTS.PILE_DEFAULTS,\n\t\titem_flag_defaults: CONSTANTS.ITEM_DEFAULTS,\n\t\tmacro_execution_types: CONSTANTS.MACRO_EXECUTION_TYPES,\n\t\tTransaction,\n\t\tapps: {\n\t\t\tItemPileConfig,\n\t\t\tItemEditor\n\t\t}\n\t};\n\twindow.ItemPiles = {\n\t\tAPI: API\n\t};\n\tCONSTANTS.IS_V12 = game.release.generation >= 12;\n\tObject.freeze(CONSTANTS);\n\n});\n\nHooks.once(\"ready\", () => {\n\n\tsetTimeout(() => {\n\n\t\tif (game.user.isGM) {\n\t\t\tif (!game.modules.get('lib-wrapper')?.active) {\n\t\t\t\tlet word = \"install and activate\";\n\t\t\t\tif (game.modules.get('lib-wrapper')) word = \"activate\";\n\t\t\t\tthrow Helpers.custom_error(`Item Piles requires the 'libWrapper' module. Please ${word} it.`)\n\t\t\t}\n\n\t\t\tif (!game.modules.get('socketlib')?.active) {\n\t\t\t\tlet word = \"install and activate\";\n\t\t\t\tif (game.modules.get('socketlib')) word = \"activate\";\n\t\t\t\tthrow Helpers.custom_error(`Item Piles requires the 'socketlib' module. Please ${word} it.`)\n\t\t\t}\n\t\t}\n\n\t\tSocket.initialize();\n\t\tPrivateAPI.initialize();\n\t\tTradeAPI.initialize();\n\t\tChatAPI.initialize();\n\n\t\tregisterHotkeysPost();\n\t\tinitializeCompendiumCache();\n\t\tsetupPlugins(\"ready\");\n\n\t\tChatAPI.disablePastTradingButtons();\n\n\t\tHooks.callAll(CONSTANTS.HOOKS.READY);\n\n\t}, 100);\n\n});\n\nHooks.once(CONSTANTS.HOOKS.READY, async () => {\n\tsetTimeout(async () => {\n\t\tif (game.user.isGM) {\n\t\t\tawait checkSystem();\n\t\t\tawait patchCurrencySettings();\n\t\t\tawait runMigrations();\n\t\t}\n\n\t\tif (SYSTEMS.DATA.SYSTEM_HOOKS) {\n\t\t\tSYSTEMS.DATA.SYSTEM_HOOKS();\n\t\t}\n\t\t//game.itempiles.API.renderItemPileInterface(game.actors.getName(\"Gamemaster's Vault\"));\n\t\t// new SettingsShim().render(true);\n\t\tapplySystemSpecificStyles();\n\t}, 500);\n});\n\nHooks.on(CONSTANTS.HOOKS.RESET_SETTINGS, async () => {\n\tfor (let setting of game.settings.storage.get(\"world\").filter(setting => setting.key.includes('item-piles'))) {\n\t\tawait setting.delete();\n\t}\n\tcheckSystem();\n})\n"],"names":["now","data","element","text","hash","next","linear","tick","wait","detach","init","create_each_block","insert","update","instance","create_fragment","Utilities.getUuid","Utilities.getActor","PileUtilities.isValidItemPile","PileUtilities.getActorFlagData","Utilities.getUserCharacter","PileUtilities.getActorItems","PileUtilities.getActorCurrencies","Utilities.hasItemTypeHandler","PileUtilities.getCurrenciesInItem","Utilities.setItemQuantity","PileUtilities.isItemPileEmpty","sharingData","Utilities.findSimilarItem","Utilities.setSimilarityProperties","Utilities.getItemQuantity","floor","Utilities.getItemTypeHandler","debug","document","cssVariables","styles","ctx","dispatch","set","subscribe","run","children","get","clamp","min","max","duration","ease","interpolate","options","parent","active","create_if_block","s_REGEX_HTML","draggable","booleanStore","dragDefault","TJSHeaderButton","storeResizing","create_if_block_1","preventDefault","autoClose","create_if_block_3","canItemStack","PileUtilities.canItemStack","promise","writable","DialogShell","DropItemDialogShell","create_if_block_4","create_if_block_5","create_if_block_2","filter","Helpers.custom_error","PileUtilities.isItemCurrency","item","PileUtilities.areItemsColliding","PileUtilities.getItemFlagData","Utilities.deleteProperty","PileUtilities.cleanItemFlagData","Utilities.ensureValidIds","PileUtilities.getItemPileActors","PileUtilities.isItemPileMerchant","PileUtilities.getItemPileTokens","PileUtilities.isMerchantClosed","previousState","PileUtilities.rollMerchantTables","SETTINGS","CompendiumUtilities.findSimilarItemInCompendiumSync","SharingUtilities.getItemSharesLeftForActor","Utilities.hasItemQuantity","PileUtilities.getItemCurrencyData","PileUtilities.updateItemData","SharingUtilities.getAttributeSharesLeftForActor","func","func_2","create_if_block_6","PileUtilities.getCurrencyList","existingCurrency","DropCurrencyDialogShell","SharingUtilities.getItemPileSharingData","PileUtilities.isItemInvalid","pileItem","SharingUtilities.updateItemPileSharingData","Helpers.custom_notify","create_if_block_10","create_if_block_9","create_if_block_8","Helpers.custom_warning","PileUtilities.isItemPileContainer","SharingUtilities.canItemPileBeSplit","SharingUtilities.getPlayersForItemPile","Plugins.TJSKeyMaps","Plugins.TJSPasteUUID","content","offset","click_handler_3","i","PileUtilities.getPaymentData","TradeMerchantItemDialogShell","quantityForPriceProp","flip","draggedEl","multiScroller","canvas","DEFAULT_DROP_ZONE_TYPE","DEFAULT_DROP_TARGET_STYLE","typeToDropZones","dzToConfig","registerDropZone","unregisterDropZone","handleDrop","draggedElData","dndzone","INSTRUCTION_IDs","pointerDndZone","keyboardDndZone","flipDurationMs","CompendiumUtilities.findOrCreateItemInCompendium","Helpers.setSetting","Helpers.getSetting","ItemEditorShell","PileUtilities.isItemValidBasedOnProperties","PileUtilities.updateItemPileData","PileUtilities.getActorLog","PileUtilities.getPriceData","PileUtilities.updateMerchantLog","TextEditorDialogShell","create_if_block_7","tables","Helpers.abbreviateNumbers","Helpers.timeSince","PileUtilities.checkItemType","UserSelectDialogShell","MerchantAppShell","Helpers.hooks","Helpers.getActiveApps","flagData","transform","Helpers.styleFromObject","PileUtilities.getVaultAccess","PileUtilities.getVaultGridData","helpers.debug","_","PileUtilities.getNewItemsVaultPosition","PileUtilities.getVaultItemDimensions","PileUtilities.canItemFitInVault","PileUtilities.fitItemsIntoVault","Utilities.areItemsDifferent","create_if_block_11","Helpers.getCanvasMouse","Helpers.getApplicationPositions","func_1","VaultShell","CurrenciesEditorShell","ItemFiltersShell","ItemTypePriceModifiersShell","PriceModifiersEditorShell","StringListEditorShell","MerchantColumnsEditorShell","PileUtilities.clearActorLog","SharingUtilities.clearItemPileSharingData","VaultAccessEditorShell","PileUtilities.getPileActorDefaults","Helpers.getFiles","ItemPileConfigShell","ItemPileInventoryShell","Helpers.random_array_element","PileUtilities.getItemPileTokenScale","PileUtilities.getItemPileTokenImage","PileUtilities.getItemPileName","PileUtilities.cleanFlagData","PileUtilities.isItemPileVault","PileUtilities.updateVaultLog","PileUtilities.shouldItemPileBeDeleted","Utilities.getToken","PileUtilities.isItemPileLootable","SharingUtilities.setItemPileSharingData","PileUtilities.getPriceFromString","Helpers.isRealNumber","sourceIsItemPile","Utilities.getDocument","sourceUpdates","Utilities.createFoldersFromNames","Helpers.getModuleVersion","Helpers.wait","Helpers.isFunction","Helpers.isResponsibleGM","PileUtilities.shouldEvaluateChange","Helpers.debounceManager","Helpers.debug","target","Utilities.runMacro","Utilities.getSourceActorFromDropData","Utilities.getTokensAtLocation","Utilities.distance_between_rect","user","Helpers.getActiveGMs","ReceiveItemsShell","Helpers.isGMConnected","Utilities.tokens_close_enough","Utilities.grids_between_tokens","attributes","BankVaultApp","PileUtilities.rollTable","token","Utilities.isItemStackable","CompendiumUtilities.getItemFromCache","Utilities.isRealNumber","Helpers.roundToDecimals","cost","Utilities.getItemCost","baseCost","totalCost","secondaryPrices","payment","currency","rollData","computePosition","platform","side","placement","overflow","shift","x","y","getComputedStyle","$","resizeObserver","autoUpdate","_autoUpdate","contentOptions","convertStringItemsToObjects","_filter","getItems","_getItems","label","filterText","debounce","items","value","itemId","list","listOpen","GiveItemsShell","version","PricePresetEditorShell","UnstackableItemTypesEditorShell","StylesEditorShell","VaultStylesEditorShell","helpers.getSetting","helpers.setSetting","SettingsShell","templates","isRealNumber","actor","TradeDialogPrompt","TradeDialogRequest","previewItem","TradingAppShell","message","PileUtilities.getPriceArray","Helpers.getResponsibleGM","html","PileUtilities.getActorPrimaryCurrency","hookResult","PileUtilities.isItemPileLocked","PileUtilities.isItemPileClosed","PileUtilities.isRegularItemPile","PileUtilities.isItemPileBanker","PileUtilities.isItemPileAuctioneer","PileUtilities.getMerchantModifiersForActor","PileUtilities.getCurrenciesAbbreviations","PileUtilities.getStringFromCurrencies","rollTable","PileUtilities.getCostOfItem","PileUtilities.migrateFlagData","updates","Socket","setting"],"mappings":"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","x_google_ignoreList":[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,50,51,52,53,54,55,56,57,58,59,60,61,62,69,70,85,86,87,88,89,90,91,92,93,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,144,187,188,189,190,191,192,193,194,195,196,197,263,264]}