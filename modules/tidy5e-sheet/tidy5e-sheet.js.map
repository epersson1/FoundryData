{"version":3,"file":"tidy5e-sheet.js","sources":["../node_modules/svelte/src/constants.js","../node_modules/svelte/src/utils.js","../node_modules/esm-env/false.js","../node_modules/svelte/src/internal/shared/utils.js","../node_modules/svelte/src/internal/client/constants.js","../node_modules/svelte/src/internal/client/reactivity/equality.js","../node_modules/svelte/src/internal/client/errors.js","../node_modules/svelte/src/internal/flags/index.js","../node_modules/svelte/src/internal/client/reactivity/sources.js","../node_modules/svelte/src/internal/client/dom/hydration.js","../node_modules/svelte/src/internal/client/proxy.js","../node_modules/svelte/src/internal/client/dom/operations.js","../node_modules/svelte/src/internal/client/reactivity/deriveds.js","../node_modules/svelte/src/internal/client/reactivity/effects.js","../node_modules/svelte/src/internal/client/dom/task.js","../node_modules/svelte/src/internal/shared/errors.js","../node_modules/svelte/src/internal/client/runtime.js","../node_modules/svelte/src/internal/client/dom/elements/misc.js","../node_modules/svelte/src/internal/client/dom/elements/bindings/shared.js","../node_modules/svelte/src/internal/client/dom/elements/events.js","../node_modules/svelte/src/internal/client/dom/reconciler.js","../node_modules/svelte/src/internal/client/dom/template.js","../node_modules/svelte/src/internal/client/render.js","../node_modules/svelte/src/internal/client/dom/blocks/await.js","../node_modules/svelte/src/internal/client/dom/blocks/if.js","../node_modules/svelte/src/internal/client/dom/blocks/key.js","../node_modules/svelte/src/internal/client/dom/blocks/css-props.js","../node_modules/svelte/src/internal/client/dom/blocks/each.js","../node_modules/svelte/src/internal/client/dom/blocks/html.js","../node_modules/svelte/src/internal/client/dom/blocks/snippet.js","../node_modules/svelte/src/internal/client/dom/blocks/svelte-component.js","../node_modules/svelte/src/internal/client/dom/blocks/svelte-element.js","../node_modules/svelte/src/internal/client/dom/elements/actions.js","../node_modules/clsx/dist/clsx.mjs","../node_modules/svelte/src/internal/shared/attributes.js","../node_modules/svelte/src/internal/client/dom/elements/attributes.js","../node_modules/svelte/src/internal/client/dom/elements/class.js","../node_modules/svelte/src/internal/client/dom/elements/style.js","../node_modules/svelte/src/internal/client/timing.js","../node_modules/svelte/src/internal/client/loop.js","../node_modules/svelte/src/internal/client/dom/elements/transitions.js","../node_modules/svelte/src/internal/client/dom/elements/bindings/input.js","../node_modules/svelte/src/internal/client/dom/elements/bindings/select.js","../node_modules/svelte/src/internal/client/dom/elements/bindings/this.js","../node_modules/svelte/src/internal/client/dom/elements/bindings/universal.js","../node_modules/svelte/src/internal/client/dom/legacy/lifecycle.js","../node_modules/svelte/src/index-client.js","../node_modules/svelte/src/internal/client/reactivity/store.js","../node_modules/svelte/src/internal/client/reactivity/props.js","../node_modules/svelte/src/internal/client/dom/blocks/boundary.js","../src/constants.ts","../src/utils/logging.ts","../src/settings/ResetSettingsDialog.ts","../src/theme/default-dark-theme.ts","../src/theme/default-light-theme.ts","../src/theme/theme-reference.ts","../node_modules/colord/index.mjs","../src/theme/theme.ts","../src/applications/SvelteFormApplicationBase.ts","../node_modules/svelte/src/version.js","../node_modules/svelte/src/internal/disclose-version.js","../src/sheets/sheet-context.svelte.ts","../src/components/tabs/Tabs.svelte","../src/types/location-awareness.types.ts","../src/components/tabs/TabContent.svelte","../src/components/tabs/TabContents.svelte","../node_modules/svelte/src/internal/flags/legacy.js","../src/applications/settings/parts/CheckboxSetting.svelte","../src/applications/settings/user-settings/tabs/PlayerSettingsTab.svelte","../src/applications/settings/user-settings/tabs/NpcSettingsTab.svelte","../src/applications/settings/user-settings/tabs/VehicleSettingsTab.svelte","../src/applications/settings/user-settings/tabs/ActionsListSettingsTab.svelte","../src/utils/data.ts","../src/utils/formatting.ts","../src/components/inputs/SelectOptions.svelte","../src/applications/settings/parts/SelectSetting.svelte","../src/applications/settings/user-settings/tabs/ActivitiesSettingsTabs.svelte","../src/applications/settings/user-settings/UserSettings.svelte","../src/applications/settings/user-settings/UserSettingsFormApplication.svelte.ts","../src/applications/settings/parts/TextInputSetting.svelte","../src/applications/settings/world-settings/tabs/MiscWorldSettingsTab.svelte","../node_modules/svelte/src/easing/index.js","../node_modules/svelte/src/animate/index.js","../node_modules/svelte/src/transition/index.js","../src/components/listbox/Listbox.svelte","../src/components/listbox/SelectionListboxToolbar.svelte","../src/components/listbox/SelectionListbox.svelte","../src/applications/settings/parts/ListboxSetting.svelte","../src/applications/settings/world-settings/tabs/CharacterWorldSettingsTab.svelte","../src/applications/settings/world-settings/tabs/NpcWorldSettingsTab.svelte","../src/applications/settings/world-settings/tabs/VehicleWorldSettingsTab.svelte","../src/applications/settings/world-settings/tabs/ItemWorldSettingsTab.svelte","../src/applications/settings/parts/ExhaustionSetting.svelte","../src/features/exhaustion/exhaustion.ts","../src/applications/settings/world-settings/tabs/ExhaustionWorldSettingsTab.svelte","../src/applications/settings/world-settings/tabs/SheetLockWorldSettingsTab.svelte","../src/applications/settings/world-settings/tabs/IconsWorldSettingsTab.svelte","../src/events/clickOutside.svelte.ts","../src/components/button-menu/button-menu-position.ts","../src/components/button-menu/ButtonMenu.svelte","../src/components/button-menu/ButtonMenuItem.svelte","../src/components/button-menu/ButtonMenuCommand.svelte","../src/components/inputs/InlineTextDropdownList.svelte","../src/utils/active-effect.ts","../src/sheets/classic/actor/SkillsList.svelte","../src/sheets/classic/actor/traits/TraitSection.svelte","../src/sheets/classic/actor/traits/TraitSectionTools.svelte","../src/sheets/classic/actor/traits/TraitSectionTags.svelte","../src/sheets/classic/actor/traits/TraitSectionModifications.svelte","../src/sheets/classic/actor/traits/Traits.svelte","../src/components/expandable/ExpandableContainer.svelte","../src/features/expand-collapse/ExpansionTracker.svelte.ts","../src/components/item-list/v1/ItemTable.svelte","../src/utils/element.ts","../src/components/item-list/v1/ItemTableHeaderRow.svelte","../src/runtime/ItemSummaryRuntime.ts","../src/components/item-summary/ItemSummaryCommandButton.svelte","../src/components/item-summary/ItemSummaryCommandButtonList.svelte","../src/components/layout/HorizontalLineSeparator.svelte","../src/features/enrichers/Enrichers.ts","../src/components/table/TidyTable.svelte","../src/components/table/TidyTableRow.svelte","../src/components/table/TidyTableCell.svelte","../src/components/icon/Dnd5eIcon.svelte","../src/components/item-list/ActivityUses.svelte","../src/components/item-list/ItemImage.svelte","../src/foundry/TidyHooks.ts","../src/features/activities/activities.ts","../src/components/item-list/controls/RechargeControl.svelte","../src/components/item-list/InlineActivitiesList.svelte","../src/components/item-list/ItemSummary.svelte","../src/components/item-list/v1/ItemTableRow.svelte","../src/components/item-list/ItemCreateButton.svelte","../src/runtime/ActorItemRuntime.ts","../src/components/item-list/ItemTableFooter.svelte","../src/components/item-list/v1/ItemTableColumn.svelte","../src/components/item-list/v1/ItemTableCell.svelte","../src/components/item-list/ItemUseButton.svelte","../src/components/item-list/ActiveEffectsMarker.svelte","../src/components/item-list/ItemName.svelte","../src/components/item-list/ItemUses.svelte","../src/components/item-list/controls/ItemControl.svelte","../src/components/item-list/controls/ItemDeleteControl.svelte","../src/components/item-list/controls/ItemEditControl.svelte","../src/components/item-list/controls/EquipControl.svelte","../src/components/item-list/controls/AttuneControl.svelte","../src/components/item-list/InlineFavoriteIcon.svelte","../src/components/item-list/controls/ItemFavoriteControl.svelte","../src/runtime/action-list/ActionListRuntime.ts","../src/foundry/TidyFlags.ts","../src/utils/formula.ts","../src/utils/ItemUtils.ts","../src/api/ApiConstants.ts","../src/api/config/action-list/ActionListApi.ts","../src/api/config/actor-item/ActorItemApi.ts","../src/runtime/ActorPortraitRuntime.ts","../src/api/config/actor-portrait/ActorPortraitApi.ts","../src/runtime/actor-traits/CustomActorTraitsRuntime.ts","../src/api/config/actor-traits/ActorTraitsApi.ts","../src/features/spell-school/SpellSchool.ts","../src/api/config/spell-school/SpellSchoolApi.ts","../src/api/config/item-summary/ItemSummaryApi.ts","../src/api/config/exhaustion/ExhaustionApi.svelte.ts","../src/context-menu/FloatingContextMenu.ts","../src/sheets/classic/item/parts/ItemProfilePicture.svelte","../src/components/inputs/Select.svelte","../src/utils/form.ts","../src/components/inputs/TextInput.svelte","../src/sheets/classic/shared/Source.svelte","../src/sheets/classic/item/parts/ItemIdentifiableName.svelte","../src/components/toggles/TidySwitch.svelte","../src/components/toggles/PropertyToggle.svelte","../src/sheets/classic/item/parts/ItemHeaderToggles.svelte","../src/sheets/classic/item/EquipmentSheet.svelte","../src/components/inputs/NumberInput.svelte","../src/components/inputs/Checkbox.svelte","../src/utils/system-properties.ts","../src/sheets/classic/item/parts/ItemProperties.svelte","../src/sheets/quadrone/container/tabs/ContainerDetailsTab.svelte","../src/components/content-concealment/UnidentifiedNotice.svelte","../src/sheets/classic/item/tabs/ItemActiveEffectsTab.svelte","../src/components/utility/InlineSvg.svelte","../src/sheets/classic/item/tabs/ItemAdvancementTab.svelte","../src/sheets/classic/item/parts/ItemStartingEquipment.svelte","../src/sheets/classic/item/tabs/ItemBackgroundDetailsTab.svelte","../src/applications/max-prepared-spells-config/MaxPreparedSpellsConfig.svelte","../src/applications/max-prepared-spells-config/MaxPreparedSpellsConfigFormApplication.svelte.ts","../src/sheets/classic/item/parts/DetailsSpellcasting.svelte","../src/sheets/classic/item/tabs/ItemClassDetailsTab.svelte","../src/sheets/classic/item/parts/FieldDamage.svelte","../src/sheets/classic/item/parts/FieldUses.svelte","../src/sheets/classic/item/tabs/ItemConsumableDetailsTab.svelte","../src/sheets/classic/container/CapacityBar.svelte","../src/sheets/classic/actor/Currency.svelte","../src/components/utility-bar/UtilityToolbar.svelte","../src/components/utility-bar/UtilityToolbarCommand.svelte","../src/components/utility-bar/Search.svelte","../src/utils/value-cycling.ts","../src/components/filter/FilterToggleButton.svelte","../src/components/filter/FilterMenu.svelte","../src/components/filter/PinnedFilterToggle.svelte","../src/components/filter/PinnedFilterToggles.svelte","../src/runtime/item/default-item-filters.ts","../src/runtime/item/ItemFilterRuntime.svelte.ts","../src/components/table/TidyTableToggleIcon.svelte","../src/components/table/TidyTableHeaderCell.svelte","../src/components/table/TidyTableHeaderRow.svelte","../src/components/item-list/v2/ItemTableRowV2.svelte","../node_modules/svelte/src/reactivity/utils.js","../node_modules/svelte/src/reactivity/set.js","../node_modules/svelte/src/reactivity/map.js","../src/features/expand-collapse/InlineToggleService.svelte.ts","../src/sheets/classic/shared/InlineToggleControl.svelte","../src/features/user-preferences/SheetPreferencesService.ts","../src/features/sections/SheetSections.ts","../src/features/search/search.svelte.ts","../src/sheets/classic/container/InlineContainerView.svelte","../src/sheets/classic/container/ContainerContentsSections.svelte","../src/features/filtering/ItemFilterService.svelte.ts","../src/features/sections/ItemVisibility.ts","../src/sheets/classic/item/tabs/ItemContainerContentsTab.svelte","../src/sheets/classic/item/tabs/ItemContainerDetailsTab.svelte","../src/components/editor/SheetEditorV2.svelte","../src/sheets/classic/item/tabs/ItemDescriptionTab.svelte","../src/sheets/classic/item/tabs/ItemSpeciesDetailsTab.svelte","../src/components/accordion/Accordion.svelte","../src/components/accordion/AccordionItem.svelte","../src/sheets/classic/item/parts/ItemDescriptions.svelte","../src/utils/applications.svelte.ts","../src/runtime/HandlebarsTemplateRenderer.ts","../src/api/content/CustomContentBase.ts","../src/api/content/HandlebarsContent.ts","../src/runtime/content/CustomContentManager.ts","../src/sheets/CustomContentRendererV2.ts","../src/utils/asynchrony.ts","../src/runtime/header-controls/HeaderControlsRuntime.ts","../src/features/reactivity/CoarseReactivityProvider.svelte.ts","../src/features/sheet-header-controls/header-controls.ts","../src/mixins/SvelteApplicationMixin.svelte.ts","../src/applications/section-selector/SectionSelector.svelte","../src/applications/section-selector/SectionSelectorApplication.svelte.ts","../src/sheets/classic/item/tabs/ItemDescriptionWithSidebarTab.svelte","../src/sheets/quadrone/shared/CollapsibleEditorSection.svelte","../src/sheets/quadrone/shared/ItemDescriptions.svelte","../src/sheets/quadrone/item/tabs/ItemDescriptionsTab.svelte","../src/sheets/classic/item/parts/DetailsMountable.svelte","../src/sheets/classic/item/tabs/ItemEquipmentDetailsTab.svelte","../src/sheets/classic/item/tabs/ItemFeatDetailsTab.svelte","../src/sheets/classic/item/tabs/ItemLootDetailsTab.svelte","../src/sheets/classic/item/tabs/ItemSpeciesDescriptionTab.svelte","../src/sheets/classic/item/parts/FieldTargets.svelte","../src/sheets/classic/item/parts/FieldActivation.svelte","../src/sheets/classic/item/parts/FieldRange.svelte","../src/sheets/classic/item/parts/FieldDuration.svelte","../src/sheets/classic/item/tabs/ItemSpellDetailsTab.svelte","../src/sheets/classic/item/tabs/ItemSubclassDetailsTab.svelte","../src/sheets/classic/item/tabs/ItemToolDetailsTab.svelte","../src/sheets/classic/item/tabs/ItemWeaponDetailsTab.svelte","../src/sheets/classic/item/tabs/ItemActivitiesTab.svelte","../src/sheets/classic/item/tabs/ItemFacilityDetailsTab.svelte","../src/sheets/quadrone/container/parts/CapacityBar.svelte","../src/sheets/quadrone/container/parts/InlineContainerView.svelte","../src/components/trackers/InlineItemQuantityTracker.svelte","../src/sheets/quadrone/container/parts/ContainerContentsSections.svelte","../src/components/buttons/ToggleButton.svelte","../src/sheets/quadrone/shared/Search.svelte","../src/actions/longpress.svelte.ts","../src/components/buttons/ButtonWithOptionPanel.svelte","../src/components/utility/TidyVisibilityObserver.svelte","../src/features/sections/Inventory.ts","../src/features/containers/Container.ts","../src/features/user-preferences/UserPreferencesService.ts","../src/sheets/quadrone/shared/ExpandCollapseButton.svelte","../src/sheets/quadrone/container/tabs/ContainerContentsTab.svelte","../src/runtime/item/item-sheet-tabs.ts","../src/sheets/classic/item/BackgroundSheet.svelte","../src/sheets/classic/item/ClassSheet.svelte","../src/sheets/classic/item/ConsumableSheet.svelte","../src/sheets/classic/item/ContainerSheet.svelte","../src/sheets/classic/item/FacilitySheet.svelte","../src/sheets/classic/item/FeatSheet.svelte","../src/sheets/classic/item/LootSheet.svelte","../src/sheets/classic/item/SpellSheet.svelte","../src/sheets/classic/item/SubclassSheet.svelte","../src/sheets/classic/item/ToolSheet.svelte","../src/sheets/classic/item/WeaponSheet.svelte","../src/sheets/classic/item/SpeciesSheet.svelte","../src/runtime/item/ItemSheetRuntime.ts","../src/api/config/item/ItemConfigApi.ts","../src/api/config/ConfigApi.ts","../src/api/content/HtmlContent.ts","../src/api/tab/CustomTabBase.ts","../src/api/tab/HandlebarsTab.ts","../src/api/tab/HtmlTab.ts","../src/api/tab/SvelteTab.ts","../src/sheets/classic/npc/parts/NpcLegendaryActions.svelte","../src/components/spellbook/SpellComponents.svelte","../src/components/spellbook/SpellPrepareControl.svelte","../src/components/spellbook/SpellSlotConfigButton.svelte","../src/components/spellbook/SpellSlotUses.svelte","../src/components/pips/SpellPip.svelte","../src/components/pips/SpellPips.svelte","../src/components/spellbook/SpellSlotManagement.svelte","../src/sheets/classic/shared/ClassicControls.svelte","../src/components/spellbook/ConcentrationOverlayIcon.svelte","../src/components/item-list/controls/SpellOpenCastActivityControl.svelte","../src/components/item-list/controls/DeleteOrOpenActivity.svelte","../src/components/spellbook/SpellbookList.svelte","../src/components/notice/Notice.svelte","../src/sheets/classic/actor/NoSpells.svelte","../src/sheets/classic/actor/TabFooter.svelte","../src/components/spellbook/SpellbookFooter.svelte","../src/components/item-list/ItemFilterLayoutToggle.svelte","../src/components/item-grid/GridPaneFavoriteIcon.svelte","../src/components/spellbook/SpellbookGrid.svelte","../src/sheets/classic/actor/EncumbranceBar.svelte","../src/sheets/classic/actor/LevelUpDropdown.svelte","../src/utils/array.ts","../src/components/listbox/SortingListbox.svelte","../src/applications/section-config/DocumentTabSectionConfig.svelte","../src/applications/section-config/DocumentTabSectionConfigApplication.svelte.ts","../src/sheets/classic/npc/tabs/NpcAbilitiesTab.svelte","../src/applications/spell-source-class-assignments/SpellSourceClassAssignments.svelte","../src/applications/spell-source-class-assignments/SpellSourceClassAssignmentsFormApplication.svelte.ts","../src/sheets/classic/npc/tabs/NpcSpellbookTab.svelte","../src/components/editor/SheetEditor.svelte","../src/utils/numbers.ts","../src/components/inputs/ContentEditableFormField.svelte","../src/components/utility/RerenderAfterFormSubmission.svelte","../src/sheets/classic/npc/tabs/NpcBiographyTab.svelte","../src/components/toggles/ConditionToggle.svelte","../src/sheets/classic/actor/ActorConditions.svelte","../src/components/item-list/controls/ActorEffectToggleControl.svelte","../src/components/item-list/EffectSummary.svelte","../src/components/item-list/v1/EffectTableRow.svelte","../src/sheets/classic/npc/tabs/NpcEffectsTab.svelte","../src/sheets/classic/actor/tabs/ActorJournalTab.svelte","../src/sheets/classic/actor/tabs/ActorActionsTab.svelte","../src/runtime/tab/TabManager.ts","../src/sheets/classic/actor/InventoryGrid.svelte","../src/sheets/classic/shared/ContainerPanel.svelte","../src/tooltips/AttunementSummaryTooltip.svelte","../src/tooltips/Tooltip.ts","../src/sheets/classic/actor/AttunementTracker.svelte","../src/sheets/classic/actor/tabs/ActorInventoryTab.svelte","../src/runtime/NpcSheetRuntime.svelte.ts","../src/sheets/classic/actor/ActorEffectsTab.svelte","../src/sheets/classic/vehicle/parts/VehicleAttributes.svelte","../src/components/bar/Bar.svelte","../src/components/bar/HpBar.svelte","../src/components/bar/ResourceWithBar.svelte","../src/sheets/classic/vehicle/parts/ItemCrewedControl.svelte","../src/sheets/classic/vehicle/tabs/VehicleAttributesTab.svelte","../src/sheets/classic/vehicle/parts/CargoList.svelte","../src/sheets/classic/vehicle/parts/PassengerOrCrewList.svelte","../src/sheets/classic/vehicle/tabs/VehicleCargoAndCrewTab.svelte","../src/sheets/classic/vehicle/tabs/VehicleDescriptionTab.svelte","../src/runtime/VehicleSheetRuntime.ts","../src/sheets/classic/group/parts/RemoveMemberControl.svelte","../src/sheets/classic/actor/AcShieldBase.svelte","../src/sheets/classic/group/parts/GroupMemberListItemProfile.svelte","../src/sheets/classic/group/parts/GroupMemberListItem.svelte","../src/sheets/classic/group/parts/GroupMemberList.svelte","../src/features/sections/GroupSheetSections.ts","../src/sheets/classic/group/parts/EncounterMemberList.svelte","../src/tooltips/GroupLanguageTooltip.svelte","../src/sheets/classic/group/parts/GroupLanguages.svelte","../src/tooltips/GroupSkillTooltip.svelte","../src/sheets/classic/group/parts/GroupSkills.svelte","../src/components/tabs/UnderlinedTabStrip.svelte","../src/sheets/classic/group/tabs/GroupMembersTab.svelte","../src/sheets/classic/group/tabs/GroupInventoryTab.svelte","../src/sheets/classic/group/tabs/GroupDescriptionTab.svelte","../src/runtime/GroupSheetRuntime.svelte.ts","../src/api/Tidy5eSheetsApi.ts","../src/utils/SpellUtils.ts","../src/features/actions/actions.svelte.ts","../src/components/item-list/controls/ActionFilterOverrideControl.svelte","../src/sheets/classic/actor/InventoryList.svelte","../src/sheets/classic/character/parts/FavoriteFeaturesList.svelte","../src/sheets/classic/character/parts/FavoriteSpellsList.svelte","../src/sheets/classic/character/parts/FavoriteEffectsList.svelte","../src/features/facility/facility.ts","../src/sheets/classic/character/parts/FacilityOrderProgressMeter.svelte","../src/tooltips/OccupantSummaryTooltip.svelte","../src/sheets/classic/character/parts/FavoriteFacilitiesList.svelte","../src/sheets/classic/character/parts/FavoriteActivitiesList.svelte","../src/sheets/classic/character/parts/Favorites.svelte","../src/features/attribute-pins/AttributePins.ts","../src/utils/events.ts","../src/sheets/classic/character/parts/AttributeItemPin.svelte","../src/components/item-list/ActivityUseButton.svelte","../src/sheets/classic/character/parts/AttributeActivityPin.svelte","../src/sheets/classic/character/tabs/CharacterAttributesTab.svelte","../src/sheets/classic/character/parts/FacilityOccupant.svelte","../src/sheets/classic/character/parts/FacilityRosterOccupant.svelte","../src/sheets/classic/character/parts/FacilityOrderProgressTracker.svelte","../src/events/drag-and-drop.ts","../src/sheets/classic/character/tabs/CharacterBastionTab.svelte","../src/components/spellbook/SpellbookClassFilter.svelte","../src/sheets/classic/character/tabs/CharacterSpellbookTab.svelte","../src/sheets/classic/character/tabs/CharacterFeaturesTab.svelte","../src/components/item-list/controls/EffectFavoriteControl.svelte","../src/sheets/classic/character/tabs/CharacterEffectsTab.svelte","../src/sheets/classic/character/tabs/CharacterBiographyTab.svelte","../src/runtime/CharacterSheetRuntime.svelte.ts","../src/applications/settings/world-settings/tabs/CustomSectionsWorldSettingsTab.svelte","../src/applications/settings/world-settings/WorldSettings.svelte","../src/applications/settings/world-settings/WorldSettingsFormApplication.svelte.ts","../src/sheets/classic/shared/ThemeSelectorButtonMenuCommand.svelte","../src/applications/theme/ThemeSettingSheetMenu.svelte","../src/applications/theme/ThemeSettingColorArticle.svelte","../src/utils/file.ts","../src/applications/theme/ThemeSettingsSheet.svelte","../src/applications/theme/ThemeSettingsFormApplication.svelte.ts","../src/migrations/migration-selection/MigrationSelection.svelte","../src/migrations/migration-selection/MigrationSelectionApplication.svelte.ts","../src/migrations/v3/ccss-to-tidy.ts","../src/migrations/v3/CcssToTidyMigration.svelte","../src/migrations/BulkMigrations.svelte","../src/migrations/BulkMigrationsApplication.ts","../src/applications/settings/about/About.svelte","../src/applications/settings/about/AboutApplication.ts","../src/applications/sheet-preferences/ApplyTidySheetPreferences.svelte","../src/sheets/classic/actor/ExhaustionTracker.svelte","../src/sheets/classic/character/parts/Inspiration.svelte","../src/sheets/classic/actor/DeathSaves.svelte","../src/sheets/classic/character/parts/Rest.svelte","../src/sheets/classic/character/parts/HitDice.svelte","../src/sheets/classic/character/parts/CharacterHitPoints.svelte","../src/sheets/classic/actor/TempHp.svelte","../src/sheets/classic/actor/ActorPortrait.svelte","../src/sheets/classic/actor/ActorProfile.svelte","../src/sheets/classic/actor/ExhaustionInput.svelte","../src/sheets/classic/character/parts/CharacterProfile.svelte","../src/sheets/classic/actor/ActorWarnings.svelte","../src/sheets/classic/actor/SpecialSaves.svelte","../src/sheets/classic/actor/SheetEditModeToggle.svelte","../src/sheets/classic/actor/ActorMovement.svelte","../src/sheets/classic/actor/RollableBlockTitle.svelte","../src/sheets/classic/actor/AttributeBlock.svelte","../src/sheets/classic/actor/InitiativeBlock.svelte","../src/sheets/classic/actor/AcShield.svelte","../src/sheets/classic/actor/ActorHeaderStats.svelte","../src/applications/tab-selection/TabSelection.svelte","../src/applications/tab-selection/TabSelectionFormApplication.svelte.ts","../src/applications/ApplicationsManager.ts","../src/sheets/classic/actor/SheetMenu.svelte","../src/sheets/classic/shared/InlineCreatureType.svelte","../src/applications/actor-origin-summary/ActorOriginSummaryConfig.svelte","../src/applications/actor-origin-summary/ActorOriginSummaryConfigFormApplication.svelte.ts","../src/sheets/classic/actor/ActorName.svelte","../src/sheets/classic/character/CharacterSheetFull.svelte","../src/sheets/classic/actor/LimitedHeader.svelte","../src/sheets/classic/character/CharacterSheetLimited.svelte","../src/sheets/classic/character/CharacterSheet.svelte","../src/context-menu/tidy5e-item-context-menu.ts","../src/context-menu/tidy5e-active-effect-context-menu.ts","../src/context-menu/tidy5e-group-context-menu.ts","../src/context-menu/tidy5e-facility-context-menu.ts","../src/context-menu/tidy5e-activities-context-menu.ts","../src/context-menu/tidy5e-context-menu.ts","../src/utils/content.ts","../src/sheets/CustomContentRenderer.ts","../src/utils/session-storage.ts","../src/features/caching/ItemTableToggleCacheService.ts","../src/utils/mutex.ts","../src/sheets/classic/Tidy5eBaseActorSheet.svelte.ts","../src/features/sections/CharacterSheetSections.ts","../src/sheets/classic/mixins/BaseSheetCustomSectionMixin.ts","../src/features/conditions-and-effects/ConditionsAndEffects.ts","../src/components/info-card/info-card.svelte.ts","../src/components/info-card/Parts/ItemCardPills.svelte","../src/components/info-card/Cards/DefaultItemCard.svelte","../src/components/info-card/Cards/InventoryItemCard.svelte","../src/components/info-card/Cards/SpellItemCard.svelte","../src/components/info-card/Cards/EffectInfoCard.svelte","../src/applications/info-card/DetachedInfoCard.svelte","../src/applications/info-card/DetachedInfoCardApplication.ts","../src/components/info-card/AttachedInfoCard.svelte","../src/sheets/classic/Tidy5eCharacterSheet.svelte.ts","../src/sheets/classic/npc/parts/NpcHitPoints.svelte","../src/sheets/classic/npc/parts/NpcRest.svelte","../src/sheets/classic/npc/parts/NpcHealthFormulaRoller.svelte","../src/sheets/classic/npc/parts/NpcLoyaltyTracker.svelte","../src/sheets/classic/npc/parts/NpcProfile.svelte","../src/components/layout/DelimitedTruncatedContent.svelte","../src/sheets/classic/shared/InlineSource.svelte","../src/components/actor-link-indicator/ActorLinkIndicator.svelte","../src/sheets/classic/npc/NpcSheetFull.svelte","../src/sheets/classic/npc/NpcSheetLimited.svelte","../src/sheets/classic/npc/NpcSheet.svelte","../src/features/sections/NpcSheetSections.ts","../src/sheets/classic/Tidy5eNpcSheet.svelte.ts","../src/sheets/classic/vehicle/parts/VehicleHitPoints.svelte","../src/sheets/classic/vehicle/parts/VehicleDamageAndMishapThresholds.svelte","../src/sheets/classic/vehicle/parts/VehicleMovement.svelte","../src/sheets/classic/vehicle/parts/VehicleProfile.svelte","../src/sheets/classic/actor/AcShieldVehicle.svelte","../src/sheets/classic/vehicle/VehicleSheetFull.svelte","../src/sheets/classic/vehicle/VehicleSheetLimited.svelte","../src/sheets/classic/vehicle/VehicleSheet.svelte","../src/utils/class-inheritance.ts","../src/sheets/classic/Tidy5eKgarVehicleSheet.svelte.ts","../src/sheets/classic/item/TypeNotFoundSheet.svelte","../src/mixins/DragAndDropBaseMixin.ts","../src/features/sheet-header-controls/ImportSheetControl.ts","../src/sheets/classic/Tidy5eItemSheetClassic.svelte.ts","../src/sheets/classic/group/parts/GroupHitPoints.svelte","../src/sheets/classic/group/GroupSheet.svelte","../src/utils/set.ts","../src/mixins/Tidy5eActorSheetBaseMixin.ts","../src/sheets/classic/shared/SheetHeaderEditModeToggle.svelte","../src/sheets/classic/Tidy5eGroupSheetClassic.svelte.ts","../src/sheets/classic/Tidy5eContainerSheetClassic.svelte.ts","../src/applications/sheet-preferences/ApplyTidySheetPreferencesApplication.svelte.ts","../src/settings/settings.svelte.ts","../src/foundry/foundry-adapter.ts","../src/runtime/runtime-init.ts","../src/migrations/MigrationTally.ts","../src/integration/modules/PopoutModuleIntegration.ts","../src/integration/modules/CustomCharacterSheetsModuleIntegration.ts","../src/components/pips/Pips.svelte","../src/integration/modules/Drakkenheim/DrakkenheimCoreConstants.ts","../src/integration/modules/Drakkenheim/DrakkenheimCoreContaminationTab.svelte","../src/integration/modules/Drakkenheim/DrakkenheimCore.ts","../src/integration/system/TidyCustomSectionsInDefaultItemSheetIntegration.ts","../src/integration/integration-classes.ts","../node_modules/@melloware/coloris/dist/esm/coloris.js","../src/integration/third-party/Coloris.svelte.ts","../src/integration/integration.ts","../src/keybindings/keybind-init.ts","../src/utils/DebugTools.ts","../src/components/toggles/FieldToggle.svelte","../src/components/toggles/PillSwitch.svelte","../src/features/rarity-colors/RarityColors.ts","../src/sheets/quadrone/container/ContainerSheet.svelte","../src/sheets/quadrone/shared/ConfigurableSource.svelte","../src/sheets/quadrone/item/parts/ContainerHeaderStart.svelte","../src/sheets/quadrone/Tidy5eContainerSheetQuadrone.svelte.ts","../src/actions/prevent-newlines.ts","../src/sheets/quadrone/item/ItemDebugSheet.svelte","../src/sheets/quadrone/Tidy5eItemDebugSheetQuadrone.svelte.ts","../src/features/ready-hooks.ts","../src/main.svelte.ts"],"sourcesContent":["export const EACH_ITEM_REACTIVE = 1;\nexport const EACH_INDEX_REACTIVE = 1 << 1;\n/** See EachBlock interface metadata.is_controlled for an explanation what this is */\nexport const EACH_IS_CONTROLLED = 1 << 2;\nexport const EACH_IS_ANIMATED = 1 << 3;\nexport const EACH_ITEM_IMMUTABLE = 1 << 4;\n\nexport const PROPS_IS_IMMUTABLE = 1;\nexport const PROPS_IS_RUNES = 1 << 1;\nexport const PROPS_IS_UPDATED = 1 << 2;\nexport const PROPS_IS_BINDABLE = 1 << 3;\nexport const PROPS_IS_LAZY_INITIAL = 1 << 4;\n\nexport const TRANSITION_IN = 1;\nexport const TRANSITION_OUT = 1 << 1;\nexport const TRANSITION_GLOBAL = 1 << 2;\n\nexport const TEMPLATE_FRAGMENT = 1;\nexport const TEMPLATE_USE_IMPORT_NODE = 1 << 1;\n\nexport const HYDRATION_START = '[';\n/** used to indicate that an `{:else}...` block was rendered */\nexport const HYDRATION_START_ELSE = '[!';\nexport const HYDRATION_END = ']';\nexport const HYDRATION_ERROR = {};\n\nexport const ELEMENT_IS_NAMESPACED = 1;\nexport const ELEMENT_PRESERVE_ATTRIBUTE_CASE = 1 << 1;\n\nexport const UNINITIALIZED = Symbol();\n\n// Dev-time component properties\nexport const FILENAME = Symbol('filename');\nexport const HMR = Symbol('hmr');\n\nexport const NAMESPACE_SVG = 'http://www.w3.org/2000/svg';\nexport const NAMESPACE_MATHML = 'http://www.w3.org/1998/Math/MathML';\n\n// we use a list of ignorable runtime warnings because not every runtime warning\n// can be ignored and we want to keep the validation for svelte-ignore in place\nexport const IGNORABLE_RUNTIME_WARNINGS = /** @type {const} */ ([\n\t'state_snapshot_uncloneable',\n\t'binding_property_non_reactive',\n\t'hydration_attribute_changed',\n\t'hydration_html_changed',\n\t'ownership_invalid_binding',\n\t'ownership_invalid_mutation'\n]);\n\n/**\n * Whitespace inside one of these elements will not result in\n * a whitespace node being created in any circumstances. (This\n * list is almost certainly very incomplete)\n * TODO this is currently unused\n */\nexport const ELEMENTS_WITHOUT_TEXT = ['audio', 'datalist', 'dl', 'optgroup', 'select', 'video'];\n","const regex_return_characters = /\\r/g;\n\n/**\n * @param {string} str\n * @returns {string}\n */\nexport function hash(str) {\n\tstr = str.replace(regex_return_characters, '');\n\tlet hash = 5381;\n\tlet i = str.length;\n\n\twhile (i--) hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n\treturn (hash >>> 0).toString(36);\n}\n\nconst VOID_ELEMENT_NAMES = [\n\t'area',\n\t'base',\n\t'br',\n\t'col',\n\t'command',\n\t'embed',\n\t'hr',\n\t'img',\n\t'input',\n\t'keygen',\n\t'link',\n\t'meta',\n\t'param',\n\t'source',\n\t'track',\n\t'wbr'\n];\n\n/**\n * Returns `true` if `name` is of a void element\n * @param {string} name\n */\nexport function is_void(name) {\n\treturn VOID_ELEMENT_NAMES.includes(name) || name.toLowerCase() === '!doctype';\n}\n\nconst RESERVED_WORDS = [\n\t'arguments',\n\t'await',\n\t'break',\n\t'case',\n\t'catch',\n\t'class',\n\t'const',\n\t'continue',\n\t'debugger',\n\t'default',\n\t'delete',\n\t'do',\n\t'else',\n\t'enum',\n\t'eval',\n\t'export',\n\t'extends',\n\t'false',\n\t'finally',\n\t'for',\n\t'function',\n\t'if',\n\t'implements',\n\t'import',\n\t'in',\n\t'instanceof',\n\t'interface',\n\t'let',\n\t'new',\n\t'null',\n\t'package',\n\t'private',\n\t'protected',\n\t'public',\n\t'return',\n\t'static',\n\t'super',\n\t'switch',\n\t'this',\n\t'throw',\n\t'true',\n\t'try',\n\t'typeof',\n\t'var',\n\t'void',\n\t'while',\n\t'with',\n\t'yield'\n];\n\n/**\n * Returns `true` if `word` is a reserved JavaScript keyword\n * @param {string} word\n */\nexport function is_reserved(word) {\n\treturn RESERVED_WORDS.includes(word);\n}\n\n/**\n * @param {string} name\n */\nexport function is_capture_event(name) {\n\treturn name.endsWith('capture') && name !== 'gotpointercapture' && name !== 'lostpointercapture';\n}\n\n/** List of Element events that will be delegated */\nconst DELEGATED_EVENTS = [\n\t'beforeinput',\n\t'click',\n\t'change',\n\t'dblclick',\n\t'contextmenu',\n\t'focusin',\n\t'focusout',\n\t'input',\n\t'keydown',\n\t'keyup',\n\t'mousedown',\n\t'mousemove',\n\t'mouseout',\n\t'mouseover',\n\t'mouseup',\n\t'pointerdown',\n\t'pointermove',\n\t'pointerout',\n\t'pointerover',\n\t'pointerup',\n\t'touchend',\n\t'touchmove',\n\t'touchstart'\n];\n\n/**\n * Returns `true` if `event_name` is a delegated event\n * @param {string} event_name\n */\nexport function is_delegated(event_name) {\n\treturn DELEGATED_EVENTS.includes(event_name);\n}\n\n/**\n * Attributes that are boolean, i.e. they are present or not present.\n */\nconst DOM_BOOLEAN_ATTRIBUTES = [\n\t'allowfullscreen',\n\t'async',\n\t'autofocus',\n\t'autoplay',\n\t'checked',\n\t'controls',\n\t'default',\n\t'disabled',\n\t'formnovalidate',\n\t'hidden',\n\t'indeterminate',\n\t'inert',\n\t'ismap',\n\t'loop',\n\t'multiple',\n\t'muted',\n\t'nomodule',\n\t'novalidate',\n\t'open',\n\t'playsinline',\n\t'readonly',\n\t'required',\n\t'reversed',\n\t'seamless',\n\t'selected',\n\t'webkitdirectory'\n];\n\n/**\n * Returns `true` if `name` is a boolean attribute\n * @param {string} name\n */\nexport function is_boolean_attribute(name) {\n\treturn DOM_BOOLEAN_ATTRIBUTES.includes(name);\n}\n\n/**\n * @type {Record<string, string>}\n * List of attribute names that should be aliased to their property names\n * because they behave differently between setting them as an attribute and\n * setting them as a property.\n */\nconst ATTRIBUTE_ALIASES = {\n\t// no `class: 'className'` because we handle that separately\n\tformnovalidate: 'formNoValidate',\n\tismap: 'isMap',\n\tnomodule: 'noModule',\n\tplaysinline: 'playsInline',\n\treadonly: 'readOnly',\n\tdefaultvalue: 'defaultValue',\n\tdefaultchecked: 'defaultChecked',\n\tsrcobject: 'srcObject'\n};\n\n/**\n * @param {string} name\n */\nexport function normalize_attribute(name) {\n\tname = name.toLowerCase();\n\treturn ATTRIBUTE_ALIASES[name] ?? name;\n}\n\nconst DOM_PROPERTIES = [\n\t...DOM_BOOLEAN_ATTRIBUTES,\n\t'formNoValidate',\n\t'isMap',\n\t'noModule',\n\t'playsInline',\n\t'readOnly',\n\t'value',\n\t'volume',\n\t'defaultValue',\n\t'defaultChecked',\n\t'srcObject'\n];\n\n/**\n * @param {string} name\n */\nexport function is_dom_property(name) {\n\treturn DOM_PROPERTIES.includes(name);\n}\n\nconst NON_STATIC_PROPERTIES = ['autofocus', 'muted', 'defaultValue', 'defaultChecked'];\n\n/**\n * Returns `true` if the given attribute cannot be set through the template\n * string, i.e. needs some kind of JavaScript handling to work.\n * @param {string} name\n */\nexport function cannot_be_set_statically(name) {\n\treturn NON_STATIC_PROPERTIES.includes(name);\n}\n\n/**\n * Subset of delegated events which should be passive by default.\n * These two are already passive via browser defaults on window, document and body.\n * But since\n * - we're delegating them\n * - they happen often\n * - they apply to mobile which is generally less performant\n * we're marking them as passive by default for other elements, too.\n */\nconst PASSIVE_EVENTS = ['touchstart', 'touchmove'];\n\n/**\n * Returns `true` if `name` is a passive event\n * @param {string} name\n */\nexport function is_passive_event(name) {\n\treturn PASSIVE_EVENTS.includes(name);\n}\n\nconst CONTENT_EDITABLE_BINDINGS = ['textContent', 'innerHTML', 'innerText'];\n\n/** @param {string} name */\nexport function is_content_editable_binding(name) {\n\treturn CONTENT_EDITABLE_BINDINGS.includes(name);\n}\n\nconst LOAD_ERROR_ELEMENTS = [\n\t'body',\n\t'embed',\n\t'iframe',\n\t'img',\n\t'link',\n\t'object',\n\t'script',\n\t'style',\n\t'track'\n];\n\n/**\n * Returns `true` if the element emits `load` and `error` events\n * @param {string} name\n */\nexport function is_load_error_element(name) {\n\treturn LOAD_ERROR_ELEMENTS.includes(name);\n}\n\nconst SVG_ELEMENTS = [\n\t'altGlyph',\n\t'altGlyphDef',\n\t'altGlyphItem',\n\t'animate',\n\t'animateColor',\n\t'animateMotion',\n\t'animateTransform',\n\t'circle',\n\t'clipPath',\n\t'color-profile',\n\t'cursor',\n\t'defs',\n\t'desc',\n\t'discard',\n\t'ellipse',\n\t'feBlend',\n\t'feColorMatrix',\n\t'feComponentTransfer',\n\t'feComposite',\n\t'feConvolveMatrix',\n\t'feDiffuseLighting',\n\t'feDisplacementMap',\n\t'feDistantLight',\n\t'feDropShadow',\n\t'feFlood',\n\t'feFuncA',\n\t'feFuncB',\n\t'feFuncG',\n\t'feFuncR',\n\t'feGaussianBlur',\n\t'feImage',\n\t'feMerge',\n\t'feMergeNode',\n\t'feMorphology',\n\t'feOffset',\n\t'fePointLight',\n\t'feSpecularLighting',\n\t'feSpotLight',\n\t'feTile',\n\t'feTurbulence',\n\t'filter',\n\t'font',\n\t'font-face',\n\t'font-face-format',\n\t'font-face-name',\n\t'font-face-src',\n\t'font-face-uri',\n\t'foreignObject',\n\t'g',\n\t'glyph',\n\t'glyphRef',\n\t'hatch',\n\t'hatchpath',\n\t'hkern',\n\t'image',\n\t'line',\n\t'linearGradient',\n\t'marker',\n\t'mask',\n\t'mesh',\n\t'meshgradient',\n\t'meshpatch',\n\t'meshrow',\n\t'metadata',\n\t'missing-glyph',\n\t'mpath',\n\t'path',\n\t'pattern',\n\t'polygon',\n\t'polyline',\n\t'radialGradient',\n\t'rect',\n\t'set',\n\t'solidcolor',\n\t'stop',\n\t'svg',\n\t'switch',\n\t'symbol',\n\t'text',\n\t'textPath',\n\t'tref',\n\t'tspan',\n\t'unknown',\n\t'use',\n\t'view',\n\t'vkern'\n];\n\n/** @param {string} name */\nexport function is_svg(name) {\n\treturn SVG_ELEMENTS.includes(name);\n}\n\nconst MATHML_ELEMENTS = [\n\t'annotation',\n\t'annotation-xml',\n\t'maction',\n\t'math',\n\t'merror',\n\t'mfrac',\n\t'mi',\n\t'mmultiscripts',\n\t'mn',\n\t'mo',\n\t'mover',\n\t'mpadded',\n\t'mphantom',\n\t'mprescripts',\n\t'mroot',\n\t'mrow',\n\t'ms',\n\t'mspace',\n\t'msqrt',\n\t'mstyle',\n\t'msub',\n\t'msubsup',\n\t'msup',\n\t'mtable',\n\t'mtd',\n\t'mtext',\n\t'mtr',\n\t'munder',\n\t'munderover',\n\t'semantics'\n];\n\n/** @param {string} name */\nexport function is_mathml(name) {\n\treturn MATHML_ELEMENTS.includes(name);\n}\n\nconst RUNES = /** @type {const} */ ([\n\t'$state',\n\t'$state.raw',\n\t'$state.snapshot',\n\t'$props',\n\t'$bindable',\n\t'$derived',\n\t'$derived.by',\n\t'$effect',\n\t'$effect.pre',\n\t'$effect.tracking',\n\t'$effect.root',\n\t'$inspect',\n\t'$inspect().with',\n\t'$inspect.trace',\n\t'$host'\n]);\n\n/**\n * @param {string} name\n * @returns {name is RUNES[number]}\n */\nexport function is_rune(name) {\n\treturn RUNES.includes(/** @type {RUNES[number]} */ (name));\n}\n\n/** List of elements that require raw contents and should not have SSR comments put in them */\nconst RAW_TEXT_ELEMENTS = /** @type {const} */ (['textarea', 'script', 'style', 'title']);\n\n/** @param {string} name */\nexport function is_raw_text_element(name) {\n\treturn RAW_TEXT_ELEMENTS.includes(/** @type {RAW_TEXT_ELEMENTS[number]} */ (name));\n}\n\n/**\n * Prevent devtools trying to make `location` a clickable link by inserting a zero-width space\n * @param {string | undefined} location\n */\nexport function sanitize_location(location) {\n\treturn location?.replace(/\\//g, '/\\u200b');\n}\n","export default false;\n","// Store the references to globals in case someone tries to monkey patch these, causing the below\n// to de-opt (this occurs often when using popular extensions).\nexport var is_array = Array.isArray;\nexport var index_of = Array.prototype.indexOf;\nexport var array_from = Array.from;\nexport var object_keys = Object.keys;\nexport var define_property = Object.defineProperty;\nexport var get_descriptor = Object.getOwnPropertyDescriptor;\nexport var get_descriptors = Object.getOwnPropertyDescriptors;\nexport var object_prototype = Object.prototype;\nexport var array_prototype = Array.prototype;\nexport var get_prototype_of = Object.getPrototypeOf;\n\n/**\n * @param {any} thing\n * @returns {thing is Function}\n */\nexport function is_function(thing) {\n\treturn typeof thing === 'function';\n}\n\nexport const noop = () => {};\n\n// Adapted from https://github.com/then/is-promise/blob/master/index.js\n// Distributed under MIT License https://github.com/then/is-promise/blob/master/LICENSE\n\n/**\n * @template [T=any]\n * @param {any} value\n * @returns {value is PromiseLike<T>}\n */\nexport function is_promise(value) {\n\treturn typeof value?.then === 'function';\n}\n\n/** @param {Function} fn */\nexport function run(fn) {\n\treturn fn();\n}\n\n/** @param {Array<() => void>} arr */\nexport function run_all(arr) {\n\tfor (var i = 0; i < arr.length; i++) {\n\t\tarr[i]();\n\t}\n}\n\n/**\n * TODO replace with Promise.withResolvers once supported widely enough\n * @template T\n */\nexport function deferred() {\n\t/** @type {(value: T) => void} */\n\tvar resolve;\n\n\t/** @type {(reason: any) => void} */\n\tvar reject;\n\n\t/** @type {Promise<T>} */\n\tvar promise = new Promise((res, rej) => {\n\t\tresolve = res;\n\t\treject = rej;\n\t});\n\n\t// @ts-expect-error\n\treturn { promise, resolve, reject };\n}\n\n/**\n * @template V\n * @param {V} value\n * @param {V | (() => V)} fallback\n * @param {boolean} [lazy]\n * @returns {V}\n */\nexport function fallback(value, fallback, lazy = false) {\n\treturn value === undefined\n\t\t? lazy\n\t\t\t? /** @type {() => V} */ (fallback)()\n\t\t\t: /** @type {V} */ (fallback)\n\t\t: value;\n}\n","export const DERIVED = 1 << 1;\nexport const EFFECT = 1 << 2;\nexport const RENDER_EFFECT = 1 << 3;\nexport const BLOCK_EFFECT = 1 << 4;\nexport const BRANCH_EFFECT = 1 << 5;\nexport const ROOT_EFFECT = 1 << 6;\nexport const BOUNDARY_EFFECT = 1 << 7;\nexport const UNOWNED = 1 << 8;\nexport const DISCONNECTED = 1 << 9;\nexport const CLEAN = 1 << 10;\nexport const DIRTY = 1 << 11;\nexport const MAYBE_DIRTY = 1 << 12;\nexport const INERT = 1 << 13;\nexport const DESTROYED = 1 << 14;\nexport const EFFECT_RAN = 1 << 15;\n/** 'Transparent' effects do not create a transition boundary */\nexport const EFFECT_TRANSPARENT = 1 << 16;\n/** Svelte 4 legacy mode props need to be handled with deriveds and be recognized elsewhere, hence the dedicated flag */\nexport const LEGACY_DERIVED_PROP = 1 << 17;\nexport const INSPECT_EFFECT = 1 << 18;\nexport const HEAD_EFFECT = 1 << 19;\nexport const EFFECT_HAS_DERIVED = 1 << 20;\n\nexport const STATE_SYMBOL = Symbol('$state');\nexport const STATE_SYMBOL_METADATA = Symbol('$state metadata');\nexport const LEGACY_PROPS = Symbol('legacy props');\nexport const LOADING_ATTR_SYMBOL = Symbol('');\n","/** @import { Equals } from '#client' */\n/** @type {Equals} */\nexport function equals(value) {\n\treturn value === this.v;\n}\n\n/**\n * @param {unknown} a\n * @param {unknown} b\n * @returns {boolean}\n */\nexport function safe_not_equal(a, b) {\n\treturn a != a\n\t\t? b == b\n\t\t: a !== b || (a !== null && typeof a === 'object') || typeof a === 'function';\n}\n\n/**\n * @param {unknown} a\n * @param {unknown} b\n * @returns {boolean}\n */\nexport function not_equal(a, b) {\n\treturn a !== b;\n}\n\n/** @type {Equals} */\nexport function safe_equals(value) {\n\treturn !safe_not_equal(value, this.v);\n}\n","/* This file is generated by scripts/process-messages/index.js. Do not edit! */\n\nimport { DEV } from 'esm-env';\n\n/**\n * Using `bind:value` together with a checkbox input is not allowed. Use `bind:checked` instead\n * @returns {never}\n */\nexport function bind_invalid_checkbox_value() {\n\tif (DEV) {\n\t\tconst error = new Error(`bind_invalid_checkbox_value\\nUsing \\`bind:value\\` together with a checkbox input is not allowed. Use \\`bind:checked\\` instead\\nhttps://svelte.dev/e/bind_invalid_checkbox_value`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/bind_invalid_checkbox_value`);\n\t}\n}\n\n/**\n * Component %component% has an export named `%key%` that a consumer component is trying to access using `bind:%key%`, which is disallowed. Instead, use `bind:this` (e.g. `<%name% bind:this={component} />`) and then access the property on the bound component instance (e.g. `component.%key%`)\n * @param {string} component\n * @param {string} key\n * @param {string} name\n * @returns {never}\n */\nexport function bind_invalid_export(component, key, name) {\n\tif (DEV) {\n\t\tconst error = new Error(`bind_invalid_export\\nComponent ${component} has an export named \\`${key}\\` that a consumer component is trying to access using \\`bind:${key}\\`, which is disallowed. Instead, use \\`bind:this\\` (e.g. \\`<${name} bind:this={component} />\\`) and then access the property on the bound component instance (e.g. \\`component.${key}\\`)\\nhttps://svelte.dev/e/bind_invalid_export`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/bind_invalid_export`);\n\t}\n}\n\n/**\n * A component is attempting to bind to a non-bindable property `%key%` belonging to %component% (i.e. `<%name% bind:%key%={...}>`). To mark a property as bindable: `let { %key% = $bindable() } = $props()`\n * @param {string} key\n * @param {string} component\n * @param {string} name\n * @returns {never}\n */\nexport function bind_not_bindable(key, component, name) {\n\tif (DEV) {\n\t\tconst error = new Error(`bind_not_bindable\\nA component is attempting to bind to a non-bindable property \\`${key}\\` belonging to ${component} (i.e. \\`<${name} bind:${key}={...}>\\`). To mark a property as bindable: \\`let { ${key} = $bindable() } = $props()\\`\\nhttps://svelte.dev/e/bind_not_bindable`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/bind_not_bindable`);\n\t}\n}\n\n/**\n * %parent% called `%method%` on an instance of %component%, which is no longer valid in Svelte 5\n * @param {string} parent\n * @param {string} method\n * @param {string} component\n * @returns {never}\n */\nexport function component_api_changed(parent, method, component) {\n\tif (DEV) {\n\t\tconst error = new Error(`component_api_changed\\n${parent} called \\`${method}\\` on an instance of ${component}, which is no longer valid in Svelte 5\\nhttps://svelte.dev/e/component_api_changed`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/component_api_changed`);\n\t}\n}\n\n/**\n * Attempted to instantiate %component% with `new %name%`, which is no longer valid in Svelte 5. If this component is not under your control, set the `compatibility.componentApi` compiler option to `4` to keep it working.\n * @param {string} component\n * @param {string} name\n * @returns {never}\n */\nexport function component_api_invalid_new(component, name) {\n\tif (DEV) {\n\t\tconst error = new Error(`component_api_invalid_new\\nAttempted to instantiate ${component} with \\`new ${name}\\`, which is no longer valid in Svelte 5. If this component is not under your control, set the \\`compatibility.componentApi\\` compiler option to \\`4\\` to keep it working.\\nhttps://svelte.dev/e/component_api_invalid_new`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/component_api_invalid_new`);\n\t}\n}\n\n/**\n * A derived value cannot reference itself recursively\n * @returns {never}\n */\nexport function derived_references_self() {\n\tif (DEV) {\n\t\tconst error = new Error(`derived_references_self\\nA derived value cannot reference itself recursively\\nhttps://svelte.dev/e/derived_references_self`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/derived_references_self`);\n\t}\n}\n\n/**\n * Keyed each block has duplicate key `%value%` at indexes %a% and %b%\n * @param {string} a\n * @param {string} b\n * @param {string | undefined | null} [value]\n * @returns {never}\n */\nexport function each_key_duplicate(a, b, value) {\n\tif (DEV) {\n\t\tconst error = new Error(`each_key_duplicate\\n${value ? `Keyed each block has duplicate key \\`${value}\\` at indexes ${a} and ${b}` : `Keyed each block has duplicate key at indexes ${a} and ${b}`}\\nhttps://svelte.dev/e/each_key_duplicate`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/each_key_duplicate`);\n\t}\n}\n\n/**\n * `%rune%` cannot be used inside an effect cleanup function\n * @param {string} rune\n * @returns {never}\n */\nexport function effect_in_teardown(rune) {\n\tif (DEV) {\n\t\tconst error = new Error(`effect_in_teardown\\n\\`${rune}\\` cannot be used inside an effect cleanup function\\nhttps://svelte.dev/e/effect_in_teardown`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/effect_in_teardown`);\n\t}\n}\n\n/**\n * Effect cannot be created inside a `$derived` value that was not itself created inside an effect\n * @returns {never}\n */\nexport function effect_in_unowned_derived() {\n\tif (DEV) {\n\t\tconst error = new Error(`effect_in_unowned_derived\\nEffect cannot be created inside a \\`$derived\\` value that was not itself created inside an effect\\nhttps://svelte.dev/e/effect_in_unowned_derived`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/effect_in_unowned_derived`);\n\t}\n}\n\n/**\n * `%rune%` can only be used inside an effect (e.g. during component initialisation)\n * @param {string} rune\n * @returns {never}\n */\nexport function effect_orphan(rune) {\n\tif (DEV) {\n\t\tconst error = new Error(`effect_orphan\\n\\`${rune}\\` can only be used inside an effect (e.g. during component initialisation)\\nhttps://svelte.dev/e/effect_orphan`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/effect_orphan`);\n\t}\n}\n\n/**\n * Maximum update depth exceeded. This can happen when a reactive block or effect repeatedly sets a new value. Svelte limits the number of nested updates to prevent infinite loops\n * @returns {never}\n */\nexport function effect_update_depth_exceeded() {\n\tif (DEV) {\n\t\tconst error = new Error(`effect_update_depth_exceeded\\nMaximum update depth exceeded. This can happen when a reactive block or effect repeatedly sets a new value. Svelte limits the number of nested updates to prevent infinite loops\\nhttps://svelte.dev/e/effect_update_depth_exceeded`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/effect_update_depth_exceeded`);\n\t}\n}\n\n/**\n * Failed to hydrate the application\n * @returns {never}\n */\nexport function hydration_failed() {\n\tif (DEV) {\n\t\tconst error = new Error(`hydration_failed\\nFailed to hydrate the application\\nhttps://svelte.dev/e/hydration_failed`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/hydration_failed`);\n\t}\n}\n\n/**\n * Could not `{@render}` snippet due to the expression being `null` or `undefined`. Consider using optional chaining `{@render snippet?.()}`\n * @returns {never}\n */\nexport function invalid_snippet() {\n\tif (DEV) {\n\t\tconst error = new Error(`invalid_snippet\\nCould not \\`{@render}\\` snippet due to the expression being \\`null\\` or \\`undefined\\`. Consider using optional chaining \\`{@render snippet?.()}\\`\\nhttps://svelte.dev/e/invalid_snippet`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/invalid_snippet`);\n\t}\n}\n\n/**\n * `%name%(...)` cannot be used in runes mode\n * @param {string} name\n * @returns {never}\n */\nexport function lifecycle_legacy_only(name) {\n\tif (DEV) {\n\t\tconst error = new Error(`lifecycle_legacy_only\\n\\`${name}(...)\\` cannot be used in runes mode\\nhttps://svelte.dev/e/lifecycle_legacy_only`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/lifecycle_legacy_only`);\n\t}\n}\n\n/**\n * Cannot do `bind:%key%={undefined}` when `%key%` has a fallback value\n * @param {string} key\n * @returns {never}\n */\nexport function props_invalid_value(key) {\n\tif (DEV) {\n\t\tconst error = new Error(`props_invalid_value\\nCannot do \\`bind:${key}={undefined}\\` when \\`${key}\\` has a fallback value\\nhttps://svelte.dev/e/props_invalid_value`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/props_invalid_value`);\n\t}\n}\n\n/**\n * Rest element properties of `$props()` such as `%property%` are readonly\n * @param {string} property\n * @returns {never}\n */\nexport function props_rest_readonly(property) {\n\tif (DEV) {\n\t\tconst error = new Error(`props_rest_readonly\\nRest element properties of \\`$props()\\` such as \\`${property}\\` are readonly\\nhttps://svelte.dev/e/props_rest_readonly`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/props_rest_readonly`);\n\t}\n}\n\n/**\n * The `%rune%` rune is only available inside `.svelte` and `.svelte.js/ts` files\n * @param {string} rune\n * @returns {never}\n */\nexport function rune_outside_svelte(rune) {\n\tif (DEV) {\n\t\tconst error = new Error(`rune_outside_svelte\\nThe \\`${rune}\\` rune is only available inside \\`.svelte\\` and \\`.svelte.js/ts\\` files\\nhttps://svelte.dev/e/rune_outside_svelte`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/rune_outside_svelte`);\n\t}\n}\n\n/**\n * Property descriptors defined on `$state` objects must contain `value` and always be `enumerable`, `configurable` and `writable`.\n * @returns {never}\n */\nexport function state_descriptors_fixed() {\n\tif (DEV) {\n\t\tconst error = new Error(`state_descriptors_fixed\\nProperty descriptors defined on \\`$state\\` objects must contain \\`value\\` and always be \\`enumerable\\`, \\`configurable\\` and \\`writable\\`.\\nhttps://svelte.dev/e/state_descriptors_fixed`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/state_descriptors_fixed`);\n\t}\n}\n\n/**\n * Cannot set prototype of `$state` object\n * @returns {never}\n */\nexport function state_prototype_fixed() {\n\tif (DEV) {\n\t\tconst error = new Error(`state_prototype_fixed\\nCannot set prototype of \\`$state\\` object\\nhttps://svelte.dev/e/state_prototype_fixed`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/state_prototype_fixed`);\n\t}\n}\n\n/**\n * Reading state that was created inside the same derived is forbidden. Consider using `untrack` to read locally created state\n * @returns {never}\n */\nexport function state_unsafe_local_read() {\n\tif (DEV) {\n\t\tconst error = new Error(`state_unsafe_local_read\\nReading state that was created inside the same derived is forbidden. Consider using \\`untrack\\` to read locally created state\\nhttps://svelte.dev/e/state_unsafe_local_read`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/state_unsafe_local_read`);\n\t}\n}\n\n/**\n * Updating state inside a derived or a template expression is forbidden. If the value should not be reactive, declare it without `$state`\n * @returns {never}\n */\nexport function state_unsafe_mutation() {\n\tif (DEV) {\n\t\tconst error = new Error(`state_unsafe_mutation\\nUpdating state inside a derived or a template expression is forbidden. If the value should not be reactive, declare it without \\`$state\\`\\nhttps://svelte.dev/e/state_unsafe_mutation`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/state_unsafe_mutation`);\n\t}\n}","export let legacy_mode_flag = false;\nexport let tracing_mode_flag = false;\n\nexport function enable_legacy_mode_flag() {\n\tlegacy_mode_flag = true;\n}\n\nexport function enable_tracing_mode_flag() {\n\ttracing_mode_flag = true;\n}\n","/** @import { Derived, Effect, Reaction, Source, Value } from '#client' */\nimport { DEV } from 'esm-env';\nimport {\n\tcomponent_context,\n\tactive_reaction,\n\tnew_deps,\n\tactive_effect,\n\tuntracked_writes,\n\tget,\n\tis_runes,\n\tschedule_effect,\n\tset_untracked_writes,\n\tset_signal_status,\n\tuntrack,\n\tincrement_write_version,\n\tupdate_effect,\n\tderived_sources,\n\tset_derived_sources,\n\tcheck_dirtiness,\n\tset_is_flushing_effect,\n\tis_flushing_effect\n} from '../runtime.js';\nimport { equals, safe_equals } from './equality.js';\nimport {\n\tCLEAN,\n\tDERIVED,\n\tDIRTY,\n\tBRANCH_EFFECT,\n\tINSPECT_EFFECT,\n\tUNOWNED,\n\tMAYBE_DIRTY,\n\tBLOCK_EFFECT\n} from '../constants.js';\nimport * as e from '../errors.js';\nimport { legacy_mode_flag, tracing_mode_flag } from '../../flags/index.js';\nimport { get_stack } from '../dev/tracing.js';\n\nexport let inspect_effects = new Set();\n\n/**\n * @param {Set<any>} v\n */\nexport function set_inspect_effects(v) {\n\tinspect_effects = v;\n}\n\n/**\n * @template V\n * @param {V} v\n * @param {Error | null} [stack]\n * @returns {Source<V>}\n */\nexport function source(v, stack) {\n\t/** @type {Value} */\n\tvar signal = {\n\t\tf: 0, // TODO ideally we could skip this altogether, but it causes type errors\n\t\tv,\n\t\treactions: null,\n\t\tequals,\n\t\trv: 0,\n\t\twv: 0\n\t};\n\n\tif (DEV && tracing_mode_flag) {\n\t\tsignal.created = stack ?? get_stack('CreatedAt');\n\t\tsignal.debug = null;\n\t}\n\n\treturn signal;\n}\n\n/**\n * @template V\n * @param {V} v\n */\nexport function state(v) {\n\treturn push_derived_source(source(v));\n}\n\n/**\n * @template V\n * @param {V} initial_value\n * @param {boolean} [immutable]\n * @returns {Source<V>}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function mutable_source(initial_value, immutable = false) {\n\tconst s = source(initial_value);\n\tif (!immutable) {\n\t\ts.equals = safe_equals;\n\t}\n\n\t// bind the signal to the component context, in case we need to\n\t// track updates to trigger beforeUpdate/afterUpdate callbacks\n\tif (legacy_mode_flag && component_context !== null && component_context.l !== null) {\n\t\t(component_context.l.s ??= []).push(s);\n\t}\n\n\treturn s;\n}\n\n/**\n * @template V\n * @param {V} v\n * @param {boolean} [immutable]\n * @returns {Source<V>}\n */\nexport function mutable_state(v, immutable = false) {\n\treturn push_derived_source(mutable_source(v, immutable));\n}\n\n/**\n * @template V\n * @param {Source<V>} source\n */\n/*#__NO_SIDE_EFFECTS__*/\nfunction push_derived_source(source) {\n\tif (active_reaction !== null && (active_reaction.f & DERIVED) !== 0) {\n\t\tif (derived_sources === null) {\n\t\t\tset_derived_sources([source]);\n\t\t} else {\n\t\t\tderived_sources.push(source);\n\t\t}\n\t}\n\n\treturn source;\n}\n\n/**\n * @template V\n * @param {Value<V>} source\n * @param {V} value\n */\nexport function mutate(source, value) {\n\tset(\n\t\tsource,\n\t\tuntrack(() => get(source))\n\t);\n\treturn value;\n}\n\n/**\n * @template V\n * @param {Source<V>} source\n * @param {V} value\n * @returns {V}\n */\nexport function set(source, value) {\n\tif (\n\t\tactive_reaction !== null &&\n\t\tis_runes() &&\n\t\t(active_reaction.f & (DERIVED | BLOCK_EFFECT)) !== 0 &&\n\t\t// If the source was created locally within the current derived, then\n\t\t// we allow the mutation.\n\t\t(derived_sources === null || !derived_sources.includes(source))\n\t) {\n\t\te.state_unsafe_mutation();\n\t}\n\n\treturn internal_set(source, value);\n}\n\n/**\n * @template V\n * @param {Source<V>} source\n * @param {V} value\n * @returns {V}\n */\nexport function internal_set(source, value) {\n\tif (!source.equals(value)) {\n\t\tvar old_value = source.v;\n\t\tsource.v = value;\n\t\tsource.wv = increment_write_version();\n\n\t\tif (DEV && tracing_mode_flag) {\n\t\t\tsource.updated = get_stack('UpdatedAt');\n\t\t\tif (active_effect != null) {\n\t\t\t\tsource.trace_need_increase = true;\n\t\t\t\tsource.trace_v ??= old_value;\n\t\t\t}\n\t\t}\n\n\t\tmark_reactions(source, DIRTY);\n\n\t\t// If the current signal is running for the first time, it won't have any\n\t\t// reactions as we only allocate and assign the reactions after the signal\n\t\t// has fully executed. So in the case of ensuring it registers the reaction\n\t\t// properly for itself, we need to ensure the current effect actually gets\n\t\t// scheduled. i.e: `$effect(() => x++)`\n\t\tif (\n\t\t\tis_runes() &&\n\t\t\tactive_effect !== null &&\n\t\t\t(active_effect.f & CLEAN) !== 0 &&\n\t\t\t(active_effect.f & BRANCH_EFFECT) === 0\n\t\t) {\n\t\t\tif (new_deps !== null && new_deps.includes(source)) {\n\t\t\t\tset_signal_status(active_effect, DIRTY);\n\t\t\t\tschedule_effect(active_effect);\n\t\t\t} else {\n\t\t\t\tif (untracked_writes === null) {\n\t\t\t\t\tset_untracked_writes([source]);\n\t\t\t\t} else {\n\t\t\t\t\tuntracked_writes.push(source);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (DEV && inspect_effects.size > 0) {\n\t\t\tconst inspects = Array.from(inspect_effects);\n\t\t\tvar previously_flushing_effect = is_flushing_effect;\n\t\t\tset_is_flushing_effect(true);\n\t\t\ttry {\n\t\t\t\tfor (const effect of inspects) {\n\t\t\t\t\t// Mark clean inspect-effects as maybe dirty and then check their dirtiness\n\t\t\t\t\t// instead of just updating the effects - this way we avoid overfiring.\n\t\t\t\t\tif ((effect.f & CLEAN) !== 0) {\n\t\t\t\t\t\tset_signal_status(effect, MAYBE_DIRTY);\n\t\t\t\t\t}\n\t\t\t\t\tif (check_dirtiness(effect)) {\n\t\t\t\t\t\tupdate_effect(effect);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tset_is_flushing_effect(previously_flushing_effect);\n\t\t\t}\n\t\t\tinspect_effects.clear();\n\t\t}\n\t}\n\n\treturn value;\n}\n\n/**\n * @param {Value} signal\n * @param {number} status should be DIRTY or MAYBE_DIRTY\n * @returns {void}\n */\nfunction mark_reactions(signal, status) {\n\tvar reactions = signal.reactions;\n\tif (reactions === null) return;\n\n\tvar runes = is_runes();\n\tvar length = reactions.length;\n\n\tfor (var i = 0; i < length; i++) {\n\t\tvar reaction = reactions[i];\n\t\tvar flags = reaction.f;\n\n\t\t// Skip any effects that are already dirty\n\t\tif ((flags & DIRTY) !== 0) continue;\n\n\t\t// In legacy mode, skip the current effect to prevent infinite loops\n\t\tif (!runes && reaction === active_effect) continue;\n\n\t\t// Inspect effects need to run immediately, so that the stack trace makes sense\n\t\tif (DEV && (flags & INSPECT_EFFECT) !== 0) {\n\t\t\tinspect_effects.add(reaction);\n\t\t\tcontinue;\n\t\t}\n\n\t\tset_signal_status(reaction, status);\n\n\t\t// If the signal a) was previously clean or b) is an unowned derived, then mark it\n\t\tif ((flags & (CLEAN | UNOWNED)) !== 0) {\n\t\t\tif ((flags & DERIVED) !== 0) {\n\t\t\t\tmark_reactions(/** @type {Derived} */ (reaction), MAYBE_DIRTY);\n\t\t\t} else {\n\t\t\t\tschedule_effect(/** @type {Effect} */ (reaction));\n\t\t\t}\n\t\t}\n\t}\n}\n","/** @import { TemplateNode } from '#client' */\n\nimport {\n\tHYDRATION_END,\n\tHYDRATION_ERROR,\n\tHYDRATION_START,\n\tHYDRATION_START_ELSE\n} from '../../../constants.js';\nimport * as w from '../warnings.js';\nimport { get_next_sibling } from './operations.js';\n\n/**\n * Use this variable to guard everything related to hydration code so it can be treeshaken out\n * if the user doesn't use the `hydrate` method and these code paths are therefore not needed.\n */\nexport let hydrating = false;\n\n/** @param {boolean} value */\nexport function set_hydrating(value) {\n\thydrating = value;\n}\n\n/**\n * The node that is currently being hydrated. This starts out as the first node inside the opening\n * <!--[--> comment, and updates each time a component calls `$.child(...)` or `$.sibling(...)`.\n * When entering a block (e.g. `{#if ...}`), `hydrate_node` is the block opening comment; by the\n * time we leave the block it is the closing comment, which serves as the block's anchor.\n * @type {TemplateNode}\n */\nexport let hydrate_node;\n\n/** @param {TemplateNode} node */\nexport function set_hydrate_node(node) {\n\tif (node === null) {\n\t\tw.hydration_mismatch();\n\t\tthrow HYDRATION_ERROR;\n\t}\n\n\treturn (hydrate_node = node);\n}\n\nexport function hydrate_next() {\n\treturn set_hydrate_node(/** @type {TemplateNode} */ (get_next_sibling(hydrate_node)));\n}\n\n/** @param {TemplateNode} node */\nexport function reset(node) {\n\tif (!hydrating) return;\n\n\t// If the node has remaining siblings, something has gone wrong\n\tif (get_next_sibling(hydrate_node) !== null) {\n\t\tw.hydration_mismatch();\n\t\tthrow HYDRATION_ERROR;\n\t}\n\n\thydrate_node = node;\n}\n\n/**\n * @param {HTMLTemplateElement} template\n */\nexport function hydrate_template(template) {\n\tif (hydrating) {\n\t\t// @ts-expect-error TemplateNode doesn't include DocumentFragment, but it's actually fine\n\t\thydrate_node = template.content;\n\t}\n}\n\nexport function next(count = 1) {\n\tif (hydrating) {\n\t\tvar i = count;\n\t\tvar node = hydrate_node;\n\n\t\twhile (i--) {\n\t\t\tnode = /** @type {TemplateNode} */ (get_next_sibling(node));\n\t\t}\n\n\t\thydrate_node = node;\n\t}\n}\n\n/**\n * Removes all nodes starting at `hydrate_node` up until the next hydration end comment\n */\nexport function remove_nodes() {\n\tvar depth = 0;\n\tvar node = hydrate_node;\n\n\twhile (true) {\n\t\tif (node.nodeType === 8) {\n\t\t\tvar data = /** @type {Comment} */ (node).data;\n\n\t\t\tif (data === HYDRATION_END) {\n\t\t\t\tif (depth === 0) return node;\n\t\t\t\tdepth -= 1;\n\t\t\t} else if (data === HYDRATION_START || data === HYDRATION_START_ELSE) {\n\t\t\t\tdepth += 1;\n\t\t\t}\n\t\t}\n\n\t\tvar next = /** @type {TemplateNode} */ (get_next_sibling(node));\n\t\tnode.remove();\n\t\tnode = next;\n\t}\n}\n","/** @import { ProxyMetadata, ProxyStateObject, Source } from '#client' */\nimport { DEV } from 'esm-env';\nimport { get, component_context, active_effect } from './runtime.js';\nimport {\n\tarray_prototype,\n\tget_descriptor,\n\tget_prototype_of,\n\tis_array,\n\tobject_prototype\n} from '../shared/utils.js';\nimport { check_ownership, widen_ownership } from './dev/ownership.js';\nimport { source, set } from './reactivity/sources.js';\nimport { STATE_SYMBOL, STATE_SYMBOL_METADATA } from './constants.js';\nimport { UNINITIALIZED } from '../../constants.js';\nimport * as e from './errors.js';\nimport { get_stack } from './dev/tracing.js';\nimport { tracing_mode_flag } from '../flags/index.js';\n\n/**\n * @template T\n * @param {T} value\n * @param {ProxyMetadata | null} [parent]\n * @param {Source<T>} [prev] dev mode only\n * @returns {T}\n */\nexport function proxy(value, parent = null, prev) {\n\t/** @type {Error | null} */\n\tvar stack = null;\n\tif (DEV && tracing_mode_flag) {\n\t\tstack = get_stack('CreatedAt');\n\t}\n\t// if non-proxyable, or is already a proxy, return `value`\n\tif (typeof value !== 'object' || value === null || STATE_SYMBOL in value) {\n\t\treturn value;\n\t}\n\n\tconst prototype = get_prototype_of(value);\n\n\tif (prototype !== object_prototype && prototype !== array_prototype) {\n\t\treturn value;\n\t}\n\n\t/** @type {Map<any, Source<any>>} */\n\tvar sources = new Map();\n\tvar is_proxied_array = is_array(value);\n\tvar version = source(0);\n\n\tif (is_proxied_array) {\n\t\t// We need to create the length source eagerly to ensure that\n\t\t// mutations to the array are properly synced with our proxy\n\t\tsources.set('length', source(/** @type {any[]} */ (value).length, stack));\n\t}\n\n\t/** @type {ProxyMetadata} */\n\tvar metadata;\n\n\tif (DEV) {\n\t\tmetadata = {\n\t\t\tparent,\n\t\t\towners: null\n\t\t};\n\n\t\tif (prev) {\n\t\t\t// Reuse owners from previous state; necessary because reassignment is not guaranteed to have correct component context.\n\t\t\t// If no previous proxy exists we play it safe and assume ownerless state\n\t\t\t// @ts-expect-error\n\t\t\tconst prev_owners = prev.v?.[STATE_SYMBOL_METADATA]?.owners;\n\t\t\tmetadata.owners = prev_owners ? new Set(prev_owners) : null;\n\t\t} else {\n\t\t\tmetadata.owners =\n\t\t\t\tparent === null\n\t\t\t\t\t? component_context !== null\n\t\t\t\t\t\t? new Set([component_context.function])\n\t\t\t\t\t\t: null\n\t\t\t\t\t: new Set();\n\t\t}\n\t}\n\n\treturn new Proxy(/** @type {any} */ (value), {\n\t\tdefineProperty(_, prop, descriptor) {\n\t\t\tif (\n\t\t\t\t!('value' in descriptor) ||\n\t\t\t\tdescriptor.configurable === false ||\n\t\t\t\tdescriptor.enumerable === false ||\n\t\t\t\tdescriptor.writable === false\n\t\t\t) {\n\t\t\t\t// we disallow non-basic descriptors, because unless they are applied to the\n\t\t\t\t// target object  which we avoid, so that state can be forked  we will run\n\t\t\t\t// afoul of the various invariants\n\t\t\t\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/getOwnPropertyDescriptor#invariants\n\t\t\t\te.state_descriptors_fixed();\n\t\t\t}\n\n\t\t\tvar s = sources.get(prop);\n\n\t\t\tif (s === undefined) {\n\t\t\t\ts = source(descriptor.value, stack);\n\t\t\t\tsources.set(prop, s);\n\t\t\t} else {\n\t\t\t\tset(s, proxy(descriptor.value, metadata));\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tdeleteProperty(target, prop) {\n\t\t\tvar s = sources.get(prop);\n\n\t\t\tif (s === undefined) {\n\t\t\t\tif (prop in target) {\n\t\t\t\t\tsources.set(prop, source(UNINITIALIZED, stack));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// When working with arrays, we need to also ensure we update the length when removing\n\t\t\t\t// an indexed property\n\t\t\t\tif (is_proxied_array && typeof prop === 'string') {\n\t\t\t\t\tvar ls = /** @type {Source<number>} */ (sources.get('length'));\n\t\t\t\t\tvar n = Number(prop);\n\n\t\t\t\t\tif (Number.isInteger(n) && n < ls.v) {\n\t\t\t\t\t\tset(ls, n);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tset(s, UNINITIALIZED);\n\t\t\t\tupdate_version(version);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tget(target, prop, receiver) {\n\t\t\tif (DEV && prop === STATE_SYMBOL_METADATA) {\n\t\t\t\treturn metadata;\n\t\t\t}\n\n\t\t\tif (prop === STATE_SYMBOL) {\n\t\t\t\treturn value;\n\t\t\t}\n\n\t\t\tvar s = sources.get(prop);\n\t\t\tvar exists = prop in target;\n\n\t\t\t// create a source, but only if it's an own property and not a prototype property\n\t\t\tif (s === undefined && (!exists || get_descriptor(target, prop)?.writable)) {\n\t\t\t\ts = source(proxy(exists ? target[prop] : UNINITIALIZED, metadata), stack);\n\t\t\t\tsources.set(prop, s);\n\t\t\t}\n\n\t\t\tif (s !== undefined) {\n\t\t\t\tvar v = get(s);\n\n\t\t\t\t// In case of something like `foo = bar.map(...)`, foo would have ownership\n\t\t\t\t// of the array itself, while the individual items would have ownership\n\t\t\t\t// of the component that created bar. That means if we later do `foo[0].baz = 42`,\n\t\t\t\t// we could get a false-positive ownership violation, since the two proxies\n\t\t\t\t// are not connected to each other via the parent metadata relationship.\n\t\t\t\t// For this reason, we need to widen the ownership of the children\n\t\t\t\t// upon access when we detect they are not connected.\n\t\t\t\tif (DEV) {\n\t\t\t\t\t/** @type {ProxyMetadata | undefined} */\n\t\t\t\t\tvar prop_metadata = v?.[STATE_SYMBOL_METADATA];\n\t\t\t\t\tif (prop_metadata && prop_metadata?.parent !== metadata) {\n\t\t\t\t\t\twiden_ownership(metadata, prop_metadata);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn v === UNINITIALIZED ? undefined : v;\n\t\t\t}\n\n\t\t\treturn Reflect.get(target, prop, receiver);\n\t\t},\n\n\t\tgetOwnPropertyDescriptor(target, prop) {\n\t\t\tvar descriptor = Reflect.getOwnPropertyDescriptor(target, prop);\n\n\t\t\tif (descriptor && 'value' in descriptor) {\n\t\t\t\tvar s = sources.get(prop);\n\t\t\t\tif (s) descriptor.value = get(s);\n\t\t\t} else if (descriptor === undefined) {\n\t\t\t\tvar source = sources.get(prop);\n\t\t\t\tvar value = source?.v;\n\n\t\t\t\tif (source !== undefined && value !== UNINITIALIZED) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tenumerable: true,\n\t\t\t\t\t\tconfigurable: true,\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t\twritable: true\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn descriptor;\n\t\t},\n\n\t\thas(target, prop) {\n\t\t\tif (DEV && prop === STATE_SYMBOL_METADATA) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (prop === STATE_SYMBOL) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tvar s = sources.get(prop);\n\t\t\tvar has = (s !== undefined && s.v !== UNINITIALIZED) || Reflect.has(target, prop);\n\n\t\t\tif (\n\t\t\t\ts !== undefined ||\n\t\t\t\t(active_effect !== null && (!has || get_descriptor(target, prop)?.writable))\n\t\t\t) {\n\t\t\t\tif (s === undefined) {\n\t\t\t\t\ts = source(has ? proxy(target[prop], metadata) : UNINITIALIZED, stack);\n\t\t\t\t\tsources.set(prop, s);\n\t\t\t\t}\n\n\t\t\t\tvar value = get(s);\n\t\t\t\tif (value === UNINITIALIZED) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn has;\n\t\t},\n\n\t\tset(target, prop, value, receiver) {\n\t\t\tvar s = sources.get(prop);\n\t\t\tvar has = prop in target;\n\n\t\t\t// variable.length = value -> clear all signals with index >= value\n\t\t\tif (is_proxied_array && prop === 'length') {\n\t\t\t\tfor (var i = value; i < /** @type {Source<number>} */ (s).v; i += 1) {\n\t\t\t\t\tvar other_s = sources.get(i + '');\n\t\t\t\t\tif (other_s !== undefined) {\n\t\t\t\t\t\tset(other_s, UNINITIALIZED);\n\t\t\t\t\t} else if (i in target) {\n\t\t\t\t\t\t// If the item exists in the original, we need to create a uninitialized source,\n\t\t\t\t\t\t// else a later read of the property would result in a source being created with\n\t\t\t\t\t\t// the value of the original item at that index.\n\t\t\t\t\t\tother_s = source(UNINITIALIZED, stack);\n\t\t\t\t\t\tsources.set(i + '', other_s);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If we haven't yet created a source for this property, we need to ensure\n\t\t\t// we do so otherwise if we read it later, then the write won't be tracked and\n\t\t\t// the heuristics of effects will be different vs if we had read the proxied\n\t\t\t// object property before writing to that property.\n\t\t\tif (s === undefined) {\n\t\t\t\tif (!has || get_descriptor(target, prop)?.writable) {\n\t\t\t\t\ts = source(undefined, stack);\n\t\t\t\t\tset(s, proxy(value, metadata));\n\t\t\t\t\tsources.set(prop, s);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\thas = s.v !== UNINITIALIZED;\n\t\t\t\tset(s, proxy(value, metadata));\n\t\t\t}\n\n\t\t\tif (DEV) {\n\t\t\t\t/** @type {ProxyMetadata | undefined} */\n\t\t\t\tvar prop_metadata = value?.[STATE_SYMBOL_METADATA];\n\t\t\t\tif (prop_metadata && prop_metadata?.parent !== metadata) {\n\t\t\t\t\twiden_ownership(metadata, prop_metadata);\n\t\t\t\t}\n\t\t\t\tcheck_ownership(metadata);\n\t\t\t}\n\n\t\t\tvar descriptor = Reflect.getOwnPropertyDescriptor(target, prop);\n\n\t\t\t// Set the new value before updating any signals so that any listeners get the new value\n\t\t\tif (descriptor?.set) {\n\t\t\t\tdescriptor.set.call(receiver, value);\n\t\t\t}\n\n\t\t\tif (!has) {\n\t\t\t\t// If we have mutated an array directly, we might need to\n\t\t\t\t// signal that length has also changed. Do it before updating metadata\n\t\t\t\t// to ensure that iterating over the array as a result of a metadata update\n\t\t\t\t// will not cause the length to be out of sync.\n\t\t\t\tif (is_proxied_array && typeof prop === 'string') {\n\t\t\t\t\tvar ls = /** @type {Source<number>} */ (sources.get('length'));\n\t\t\t\t\tvar n = Number(prop);\n\n\t\t\t\t\tif (Number.isInteger(n) && n >= ls.v) {\n\t\t\t\t\t\tset(ls, n + 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tupdate_version(version);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\townKeys(target) {\n\t\t\tget(version);\n\n\t\t\tvar own_keys = Reflect.ownKeys(target).filter((key) => {\n\t\t\t\tvar source = sources.get(key);\n\t\t\t\treturn source === undefined || source.v !== UNINITIALIZED;\n\t\t\t});\n\n\t\t\tfor (var [key, source] of sources) {\n\t\t\t\tif (source.v !== UNINITIALIZED && !(key in target)) {\n\t\t\t\t\town_keys.push(key);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn own_keys;\n\t\t},\n\n\t\tsetPrototypeOf() {\n\t\t\te.state_prototype_fixed();\n\t\t}\n\t});\n}\n\n/**\n * @param {Source<number>} signal\n * @param {1 | -1} [d]\n */\nfunction update_version(signal, d = 1) {\n\tset(signal, signal.v + d);\n}\n\n/**\n * @param {any} value\n */\nexport function get_proxied_value(value) {\n\tif (value !== null && typeof value === 'object' && STATE_SYMBOL in value) {\n\t\treturn value[STATE_SYMBOL];\n\t}\n\n\treturn value;\n}\n\n/**\n * @param {any} a\n * @param {any} b\n */\nexport function is(a, b) {\n\treturn Object.is(get_proxied_value(a), get_proxied_value(b));\n}\n","/** @import { TemplateNode } from '#client' */\nimport { hydrate_node, hydrating, set_hydrate_node } from './hydration.js';\nimport { DEV } from 'esm-env';\nimport { init_array_prototype_warnings } from '../dev/equality.js';\nimport { get_descriptor } from '../../shared/utils.js';\n\n// export these for reference in the compiled code, making global name deduplication unnecessary\n/** @type {Window} */\nexport var $window;\n\n/** @type {Document} */\nexport var $document;\n\n/** @type {() => Node | null} */\nvar first_child_getter;\n/** @type {() => Node | null} */\nvar next_sibling_getter;\n\n/**\n * Initialize these lazily to avoid issues when using the runtime in a server context\n * where these globals are not available while avoiding a separate server entry point\n */\nexport function init_operations() {\n\tif ($window !== undefined) {\n\t\treturn;\n\t}\n\n\t$window = window;\n\t$document = document;\n\n\tvar element_prototype = Element.prototype;\n\tvar node_prototype = Node.prototype;\n\n\t// @ts-ignore\n\tfirst_child_getter = get_descriptor(node_prototype, 'firstChild').get;\n\t// @ts-ignore\n\tnext_sibling_getter = get_descriptor(node_prototype, 'nextSibling').get;\n\n\t// the following assignments improve perf of lookups on DOM nodes\n\t// @ts-expect-error\n\telement_prototype.__click = undefined;\n\t// @ts-expect-error\n\telement_prototype.__className = '';\n\t// @ts-expect-error\n\telement_prototype.__attributes = null;\n\t// @ts-expect-error\n\telement_prototype.__styles = null;\n\t// @ts-expect-error\n\telement_prototype.__e = undefined;\n\n\t// @ts-expect-error\n\tText.prototype.__t = undefined;\n\n\tif (DEV) {\n\t\t// @ts-expect-error\n\t\telement_prototype.__svelte_meta = null;\n\n\t\tinit_array_prototype_warnings();\n\t}\n}\n\n/**\n * @param {string} value\n * @returns {Text}\n */\nexport function create_text(value = '') {\n\treturn document.createTextNode(value);\n}\n\n/**\n * @template {Node} N\n * @param {N} node\n * @returns {Node | null}\n */\n/*@__NO_SIDE_EFFECTS__*/\nexport function get_first_child(node) {\n\treturn first_child_getter.call(node);\n}\n\n/**\n * @template {Node} N\n * @param {N} node\n * @returns {Node | null}\n */\n/*@__NO_SIDE_EFFECTS__*/\nexport function get_next_sibling(node) {\n\treturn next_sibling_getter.call(node);\n}\n\n/**\n * Don't mark this as side-effect-free, hydration needs to walk all nodes\n * @template {Node} N\n * @param {N} node\n * @param {boolean} is_text\n * @returns {Node | null}\n */\nexport function child(node, is_text) {\n\tif (!hydrating) {\n\t\treturn get_first_child(node);\n\t}\n\n\tvar child = /** @type {TemplateNode} */ (get_first_child(hydrate_node));\n\n\t// Child can be null if we have an element with a single child, like `<p>{text}</p>`, where `text` is empty\n\tif (child === null) {\n\t\tchild = hydrate_node.appendChild(create_text());\n\t} else if (is_text && child.nodeType !== 3) {\n\t\tvar text = create_text();\n\t\tchild?.before(text);\n\t\tset_hydrate_node(text);\n\t\treturn text;\n\t}\n\n\tset_hydrate_node(child);\n\treturn child;\n}\n\n/**\n * Don't mark this as side-effect-free, hydration needs to walk all nodes\n * @param {DocumentFragment | TemplateNode[]} fragment\n * @param {boolean} is_text\n * @returns {Node | null}\n */\nexport function first_child(fragment, is_text) {\n\tif (!hydrating) {\n\t\t// when not hydrating, `fragment` is a `DocumentFragment` (the result of calling `open_frag`)\n\t\tvar first = /** @type {DocumentFragment} */ (get_first_child(/** @type {Node} */ (fragment)));\n\n\t\t// TODO prevent user comments with the empty string when preserveComments is true\n\t\tif (first instanceof Comment && first.data === '') return get_next_sibling(first);\n\n\t\treturn first;\n\t}\n\n\t// if an {expression} is empty during SSR, there might be no\n\t// text node to hydrate  we must therefore create one\n\tif (is_text && hydrate_node?.nodeType !== 3) {\n\t\tvar text = create_text();\n\n\t\thydrate_node?.before(text);\n\t\tset_hydrate_node(text);\n\t\treturn text;\n\t}\n\n\treturn hydrate_node;\n}\n\n/**\n * Don't mark this as side-effect-free, hydration needs to walk all nodes\n * @param {TemplateNode} node\n * @param {number} count\n * @param {boolean} is_text\n * @returns {Node | null}\n */\nexport function sibling(node, count = 1, is_text = false) {\n\tlet next_sibling = hydrating ? hydrate_node : node;\n\tvar last_sibling;\n\n\twhile (count--) {\n\t\tlast_sibling = next_sibling;\n\t\tnext_sibling = /** @type {TemplateNode} */ (get_next_sibling(next_sibling));\n\t}\n\n\tif (!hydrating) {\n\t\treturn next_sibling;\n\t}\n\n\tvar type = next_sibling?.nodeType;\n\n\t// if a sibling {expression} is empty during SSR, there might be no\n\t// text node to hydrate  we must therefore create one\n\tif (is_text && type !== 3) {\n\t\tvar text = create_text();\n\t\t// If the next sibling is `null` and we're handling text then it's because\n\t\t// the SSR content was empty for the text, so we need to generate a new text\n\t\t// node and insert it after the last sibling\n\t\tif (next_sibling === null) {\n\t\t\tlast_sibling?.after(text);\n\t\t} else {\n\t\t\tnext_sibling.before(text);\n\t\t}\n\t\tset_hydrate_node(text);\n\t\treturn text;\n\t}\n\n\tset_hydrate_node(next_sibling);\n\treturn /** @type {TemplateNode} */ (next_sibling);\n}\n\n/**\n * @template {Node} N\n * @param {N} node\n * @returns {void}\n */\nexport function clear_text_content(node) {\n\tnode.textContent = '';\n}\n","/** @import { Derived, Effect } from '#client' */\nimport { DEV } from 'esm-env';\nimport {\n\tCLEAN,\n\tDERIVED,\n\tDESTROYED,\n\tDIRTY,\n\tEFFECT_HAS_DERIVED,\n\tMAYBE_DIRTY,\n\tUNOWNED\n} from '../constants.js';\nimport {\n\tactive_reaction,\n\tactive_effect,\n\tremove_reactions,\n\tset_signal_status,\n\tskip_reaction,\n\tupdate_reaction,\n\tincrement_write_version,\n\tset_active_effect,\n\tcomponent_context\n} from '../runtime.js';\nimport { equals, safe_equals } from './equality.js';\nimport * as e from '../errors.js';\nimport { destroy_effect } from './effects.js';\nimport { inspect_effects, set_inspect_effects } from './sources.js';\nimport { get_stack } from '../dev/tracing.js';\nimport { tracing_mode_flag } from '../../flags/index.js';\n\n/**\n * @template V\n * @param {() => V} fn\n * @returns {Derived<V>}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function derived(fn) {\n\tvar flags = DERIVED | DIRTY;\n\n\tif (active_effect === null) {\n\t\tflags |= UNOWNED;\n\t} else {\n\t\t// Since deriveds are evaluated lazily, any effects created inside them are\n\t\t// created too late to ensure that the parent effect is added to the tree\n\t\tactive_effect.f |= EFFECT_HAS_DERIVED;\n\t}\n\n\tvar parent_derived =\n\t\tactive_reaction !== null && (active_reaction.f & DERIVED) !== 0\n\t\t\t? /** @type {Derived} */ (active_reaction)\n\t\t\t: null;\n\n\t/** @type {Derived<V>} */\n\tconst signal = {\n\t\tchildren: null,\n\t\tctx: component_context,\n\t\tdeps: null,\n\t\tequals,\n\t\tf: flags,\n\t\tfn,\n\t\treactions: null,\n\t\trv: 0,\n\t\tv: /** @type {V} */ (null),\n\t\twv: 0,\n\t\tparent: parent_derived ?? active_effect\n\t};\n\n\tif (DEV && tracing_mode_flag) {\n\t\tsignal.created = get_stack('CreatedAt');\n\t}\n\n\tif (parent_derived !== null) {\n\t\t(parent_derived.children ??= []).push(signal);\n\t}\n\n\treturn signal;\n}\n\n/**\n * @template V\n * @param {() => V} fn\n * @returns {Derived<V>}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function derived_safe_equal(fn) {\n\tconst signal = derived(fn);\n\tsignal.equals = safe_equals;\n\treturn signal;\n}\n\n/**\n * @param {Derived} derived\n * @returns {void}\n */\nfunction destroy_derived_children(derived) {\n\tvar children = derived.children;\n\n\tif (children !== null) {\n\t\tderived.children = null;\n\n\t\tfor (var i = 0; i < children.length; i += 1) {\n\t\t\tvar child = children[i];\n\t\t\tif ((child.f & DERIVED) !== 0) {\n\t\t\t\tdestroy_derived(/** @type {Derived} */ (child));\n\t\t\t} else {\n\t\t\t\tdestroy_effect(/** @type {Effect} */ (child));\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * The currently updating deriveds, used to detect infinite recursion\n * in dev mode and provide a nicer error than 'too much recursion'\n * @type {Derived[]}\n */\nlet stack = [];\n\n/**\n * @param {Derived} derived\n * @returns {Effect | null}\n */\nfunction get_derived_parent_effect(derived) {\n\tvar parent = derived.parent;\n\twhile (parent !== null) {\n\t\tif ((parent.f & DERIVED) === 0) {\n\t\t\treturn /** @type {Effect} */ (parent);\n\t\t}\n\t\tparent = parent.parent;\n\t}\n\treturn null;\n}\n\n/**\n * @template T\n * @param {Derived} derived\n * @returns {T}\n */\nexport function execute_derived(derived) {\n\tvar value;\n\tvar prev_active_effect = active_effect;\n\n\tset_active_effect(get_derived_parent_effect(derived));\n\n\tif (DEV) {\n\t\tlet prev_inspect_effects = inspect_effects;\n\t\tset_inspect_effects(new Set());\n\t\ttry {\n\t\t\tif (stack.includes(derived)) {\n\t\t\t\te.derived_references_self();\n\t\t\t}\n\n\t\t\tstack.push(derived);\n\n\t\t\tdestroy_derived_children(derived);\n\t\t\tvalue = update_reaction(derived);\n\t\t} finally {\n\t\t\tset_active_effect(prev_active_effect);\n\t\t\tset_inspect_effects(prev_inspect_effects);\n\t\t\tstack.pop();\n\t\t}\n\t} else {\n\t\ttry {\n\t\t\tdestroy_derived_children(derived);\n\t\t\tvalue = update_reaction(derived);\n\t\t} finally {\n\t\t\tset_active_effect(prev_active_effect);\n\t\t}\n\t}\n\n\treturn value;\n}\n\n/**\n * @param {Derived} derived\n * @returns {void}\n */\nexport function update_derived(derived) {\n\tvar value = execute_derived(derived);\n\tvar status =\n\t\t(skip_reaction || (derived.f & UNOWNED) !== 0) && derived.deps !== null ? MAYBE_DIRTY : CLEAN;\n\n\tset_signal_status(derived, status);\n\n\tif (!derived.equals(value)) {\n\t\tderived.v = value;\n\t\tderived.wv = increment_write_version();\n\t}\n}\n\n/**\n * @param {Derived} derived\n * @returns {void}\n */\nexport function destroy_derived(derived) {\n\tdestroy_derived_children(derived);\n\tremove_reactions(derived, 0);\n\tset_signal_status(derived, DESTROYED);\n\n\tderived.v = derived.children = derived.deps = derived.ctx = derived.reactions = null;\n}\n","/** @import { ComponentContext, ComponentContextLegacy, Derived, Effect, TemplateNode, TransitionManager } from '#client' */\nimport {\n\tcheck_dirtiness,\n\tcomponent_context,\n\tactive_effect,\n\tactive_reaction,\n\tdev_current_component_function,\n\tupdate_effect,\n\tget,\n\tis_destroying_effect,\n\tis_flushing_effect,\n\tremove_reactions,\n\tschedule_effect,\n\tset_active_reaction,\n\tset_is_destroying_effect,\n\tset_is_flushing_effect,\n\tset_signal_status,\n\tuntrack,\n\tskip_reaction\n} from '../runtime.js';\nimport {\n\tDIRTY,\n\tBRANCH_EFFECT,\n\tRENDER_EFFECT,\n\tEFFECT,\n\tDESTROYED,\n\tINERT,\n\tEFFECT_RAN,\n\tBLOCK_EFFECT,\n\tROOT_EFFECT,\n\tEFFECT_TRANSPARENT,\n\tDERIVED,\n\tUNOWNED,\n\tCLEAN,\n\tINSPECT_EFFECT,\n\tHEAD_EFFECT,\n\tMAYBE_DIRTY,\n\tEFFECT_HAS_DERIVED\n} from '../constants.js';\nimport { set } from './sources.js';\nimport * as e from '../errors.js';\nimport { DEV } from 'esm-env';\nimport { define_property } from '../../shared/utils.js';\nimport { get_next_sibling } from '../dom/operations.js';\nimport { destroy_derived } from './deriveds.js';\n\n/**\n * @param {'$effect' | '$effect.pre' | '$inspect'} rune\n */\nexport function validate_effect(rune) {\n\tif (active_effect === null && active_reaction === null) {\n\t\te.effect_orphan(rune);\n\t}\n\n\tif (active_reaction !== null && (active_reaction.f & UNOWNED) !== 0) {\n\t\te.effect_in_unowned_derived();\n\t}\n\n\tif (is_destroying_effect) {\n\t\te.effect_in_teardown(rune);\n\t}\n}\n\n/**\n * @param {Effect} effect\n * @param {Effect} parent_effect\n */\nfunction push_effect(effect, parent_effect) {\n\tvar parent_last = parent_effect.last;\n\tif (parent_last === null) {\n\t\tparent_effect.last = parent_effect.first = effect;\n\t} else {\n\t\tparent_last.next = effect;\n\t\teffect.prev = parent_last;\n\t\tparent_effect.last = effect;\n\t}\n}\n\n/**\n * @param {number} type\n * @param {null | (() => void | (() => void))} fn\n * @param {boolean} sync\n * @param {boolean} push\n * @returns {Effect}\n */\nfunction create_effect(type, fn, sync, push = true) {\n\tvar is_root = (type & ROOT_EFFECT) !== 0;\n\tvar parent_effect = active_effect;\n\n\tif (DEV) {\n\t\t// Ensure the parent is never an inspect effect\n\t\twhile (parent_effect !== null && (parent_effect.f & INSPECT_EFFECT) !== 0) {\n\t\t\tparent_effect = parent_effect.parent;\n\t\t}\n\t}\n\n\t/** @type {Effect} */\n\tvar effect = {\n\t\tctx: component_context,\n\t\tdeps: null,\n\t\tderiveds: null,\n\t\tnodes_start: null,\n\t\tnodes_end: null,\n\t\tf: type | DIRTY,\n\t\tfirst: null,\n\t\tfn,\n\t\tlast: null,\n\t\tnext: null,\n\t\tparent: is_root ? null : parent_effect,\n\t\tprev: null,\n\t\tteardown: null,\n\t\ttransitions: null,\n\t\twv: 0\n\t};\n\n\tif (DEV) {\n\t\teffect.component_function = dev_current_component_function;\n\t}\n\n\tif (sync) {\n\t\tvar previously_flushing_effect = is_flushing_effect;\n\n\t\ttry {\n\t\t\tset_is_flushing_effect(true);\n\t\t\tupdate_effect(effect);\n\t\t\teffect.f |= EFFECT_RAN;\n\t\t} catch (e) {\n\t\t\tdestroy_effect(effect);\n\t\t\tthrow e;\n\t\t} finally {\n\t\t\tset_is_flushing_effect(previously_flushing_effect);\n\t\t}\n\t} else if (fn !== null) {\n\t\tschedule_effect(effect);\n\t}\n\n\t// if an effect has no dependencies, no DOM and no teardown function,\n\t// don't bother adding it to the effect tree\n\tvar inert =\n\t\tsync &&\n\t\teffect.deps === null &&\n\t\teffect.first === null &&\n\t\teffect.nodes_start === null &&\n\t\teffect.teardown === null &&\n\t\t(effect.f & EFFECT_HAS_DERIVED) === 0;\n\n\tif (!inert && !is_root && push) {\n\t\tif (parent_effect !== null) {\n\t\t\tpush_effect(effect, parent_effect);\n\t\t}\n\n\t\t// if we're in a derived, add the effect there too\n\t\tif (active_reaction !== null && (active_reaction.f & DERIVED) !== 0) {\n\t\t\tvar derived = /** @type {Derived} */ (active_reaction);\n\t\t\t(derived.children ??= []).push(effect);\n\t\t}\n\t}\n\n\treturn effect;\n}\n\n/**\n * Internal representation of `$effect.tracking()`\n * @returns {boolean}\n */\nexport function effect_tracking() {\n\tif (active_reaction === null) {\n\t\treturn false;\n\t}\n\n\t// If it's skipped, that's because we're inside an unowned\n\t// that is not being tracked by another reaction\n\treturn !skip_reaction;\n}\n\n/**\n * @param {() => void} fn\n */\nexport function teardown(fn) {\n\tconst effect = create_effect(RENDER_EFFECT, null, false);\n\tset_signal_status(effect, CLEAN);\n\teffect.teardown = fn;\n\treturn effect;\n}\n\n/**\n * Internal representation of `$effect(...)`\n * @param {() => void | (() => void)} fn\n */\nexport function user_effect(fn) {\n\tvalidate_effect('$effect');\n\n\t// Non-nested `$effect(...)` in a component should be deferred\n\t// until the component is mounted\n\tvar defer =\n\t\tactive_effect !== null &&\n\t\t(active_effect.f & BRANCH_EFFECT) !== 0 &&\n\t\tcomponent_context !== null &&\n\t\t!component_context.m;\n\n\tif (DEV) {\n\t\tdefine_property(fn, 'name', {\n\t\t\tvalue: '$effect'\n\t\t});\n\t}\n\n\tif (defer) {\n\t\tvar context = /** @type {ComponentContext} */ (component_context);\n\t\t(context.e ??= []).push({\n\t\t\tfn,\n\t\t\teffect: active_effect,\n\t\t\treaction: active_reaction\n\t\t});\n\t} else {\n\t\tvar signal = effect(fn);\n\t\treturn signal;\n\t}\n}\n\n/**\n * Internal representation of `$effect.pre(...)`\n * @param {() => void | (() => void)} fn\n * @returns {Effect}\n */\nexport function user_pre_effect(fn) {\n\tvalidate_effect('$effect.pre');\n\tif (DEV) {\n\t\tdefine_property(fn, 'name', {\n\t\t\tvalue: '$effect.pre'\n\t\t});\n\t}\n\treturn render_effect(fn);\n}\n\n/** @param {() => void | (() => void)} fn */\nexport function inspect_effect(fn) {\n\treturn create_effect(INSPECT_EFFECT, fn, true);\n}\n\n/**\n * Internal representation of `$effect.root(...)`\n * @param {() => void | (() => void)} fn\n * @returns {() => void}\n */\nexport function effect_root(fn) {\n\tconst effect = create_effect(ROOT_EFFECT, fn, true);\n\n\treturn () => {\n\t\tdestroy_effect(effect);\n\t};\n}\n\n/**\n * An effect root whose children can transition out\n * @param {() => void} fn\n * @returns {(options?: { outro?: boolean }) => Promise<void>}\n */\nexport function component_root(fn) {\n\tconst effect = create_effect(ROOT_EFFECT, fn, true);\n\n\treturn (options = {}) => {\n\t\treturn new Promise((fulfil) => {\n\t\t\tif (options.outro) {\n\t\t\t\tpause_effect(effect, () => {\n\t\t\t\t\tdestroy_effect(effect);\n\t\t\t\t\tfulfil(undefined);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tdestroy_effect(effect);\n\t\t\t\tfulfil(undefined);\n\t\t\t}\n\t\t});\n\t};\n}\n\n/**\n * @param {() => void | (() => void)} fn\n * @returns {Effect}\n */\nexport function effect(fn) {\n\treturn create_effect(EFFECT, fn, false);\n}\n\n/**\n * Internal representation of `$: ..`\n * @param {() => any} deps\n * @param {() => void | (() => void)} fn\n */\nexport function legacy_pre_effect(deps, fn) {\n\tvar context = /** @type {ComponentContextLegacy} */ (component_context);\n\n\t/** @type {{ effect: null | Effect, ran: boolean }} */\n\tvar token = { effect: null, ran: false };\n\tcontext.l.r1.push(token);\n\n\ttoken.effect = render_effect(() => {\n\t\tdeps();\n\n\t\t// If this legacy pre effect has already run before the end of the reset, then\n\t\t// bail out to emulate the same behavior.\n\t\tif (token.ran) return;\n\n\t\ttoken.ran = true;\n\t\tset(context.l.r2, true);\n\t\tuntrack(fn);\n\t});\n}\n\nexport function legacy_pre_effect_reset() {\n\tvar context = /** @type {ComponentContextLegacy} */ (component_context);\n\n\trender_effect(() => {\n\t\tif (!get(context.l.r2)) return;\n\n\t\t// Run dirty `$:` statements\n\t\tfor (var token of context.l.r1) {\n\t\t\tvar effect = token.effect;\n\n\t\t\t// If the effect is CLEAN, then make it MAYBE_DIRTY. This ensures we traverse through\n\t\t\t// the effects dependencies and correctly ensure each dependency is up-to-date.\n\t\t\tif ((effect.f & CLEAN) !== 0) {\n\t\t\t\tset_signal_status(effect, MAYBE_DIRTY);\n\t\t\t}\n\n\t\t\tif (check_dirtiness(effect)) {\n\t\t\t\tupdate_effect(effect);\n\t\t\t}\n\n\t\t\ttoken.ran = false;\n\t\t}\n\n\t\tcontext.l.r2.v = false; // set directly to avoid rerunning this effect\n\t});\n}\n\n/**\n * @param {() => void | (() => void)} fn\n * @returns {Effect}\n */\nexport function render_effect(fn) {\n\treturn create_effect(RENDER_EFFECT, fn, true);\n}\n\n/**\n * @param {() => void | (() => void)} fn\n * @returns {Effect}\n */\nexport function template_effect(fn) {\n\tif (DEV) {\n\t\tdefine_property(fn, 'name', {\n\t\t\tvalue: '{expression}'\n\t\t});\n\t}\n\treturn block(fn);\n}\n\n/**\n * @param {(() => void)} fn\n * @param {number} flags\n */\nexport function block(fn, flags = 0) {\n\treturn create_effect(RENDER_EFFECT | BLOCK_EFFECT | flags, fn, true);\n}\n\n/**\n * @param {(() => void)} fn\n * @param {boolean} [push]\n */\nexport function branch(fn, push = true) {\n\treturn create_effect(RENDER_EFFECT | BRANCH_EFFECT, fn, true, push);\n}\n\n/**\n * @param {Effect} effect\n */\nexport function execute_effect_teardown(effect) {\n\tvar teardown = effect.teardown;\n\tif (teardown !== null) {\n\t\tconst previously_destroying_effect = is_destroying_effect;\n\t\tconst previous_reaction = active_reaction;\n\t\tset_is_destroying_effect(true);\n\t\tset_active_reaction(null);\n\t\ttry {\n\t\t\tteardown.call(null);\n\t\t} finally {\n\t\t\tset_is_destroying_effect(previously_destroying_effect);\n\t\t\tset_active_reaction(previous_reaction);\n\t\t}\n\t}\n}\n\n/**\n * @param {Effect} signal\n * @returns {void}\n */\nexport function destroy_effect_deriveds(signal) {\n\tvar deriveds = signal.deriveds;\n\n\tif (deriveds !== null) {\n\t\tsignal.deriveds = null;\n\n\t\tfor (var i = 0; i < deriveds.length; i += 1) {\n\t\t\tdestroy_derived(deriveds[i]);\n\t\t}\n\t}\n}\n\n/**\n * @param {Effect} signal\n * @param {boolean} remove_dom\n * @returns {void}\n */\nexport function destroy_effect_children(signal, remove_dom = false) {\n\tvar effect = signal.first;\n\tsignal.first = signal.last = null;\n\n\twhile (effect !== null) {\n\t\tvar next = effect.next;\n\t\tdestroy_effect(effect, remove_dom);\n\t\teffect = next;\n\t}\n}\n\n/**\n * @param {Effect} signal\n * @returns {void}\n */\nexport function destroy_block_effect_children(signal) {\n\tvar effect = signal.first;\n\n\twhile (effect !== null) {\n\t\tvar next = effect.next;\n\t\tif ((effect.f & BRANCH_EFFECT) === 0) {\n\t\t\tdestroy_effect(effect);\n\t\t}\n\t\teffect = next;\n\t}\n}\n\n/**\n * @param {Effect} effect\n * @param {boolean} [remove_dom]\n * @returns {void}\n */\nexport function destroy_effect(effect, remove_dom = true) {\n\tvar removed = false;\n\n\tif ((remove_dom || (effect.f & HEAD_EFFECT) !== 0) && effect.nodes_start !== null) {\n\t\t/** @type {TemplateNode | null} */\n\t\tvar node = effect.nodes_start;\n\t\tvar end = effect.nodes_end;\n\n\t\twhile (node !== null) {\n\t\t\t/** @type {TemplateNode | null} */\n\t\t\tvar next = node === end ? null : /** @type {TemplateNode} */ (get_next_sibling(node));\n\n\t\t\tnode.remove();\n\t\t\tnode = next;\n\t\t}\n\n\t\tremoved = true;\n\t}\n\n\tdestroy_effect_children(effect, remove_dom && !removed);\n\tdestroy_effect_deriveds(effect);\n\tremove_reactions(effect, 0);\n\tset_signal_status(effect, DESTROYED);\n\n\tvar transitions = effect.transitions;\n\n\tif (transitions !== null) {\n\t\tfor (const transition of transitions) {\n\t\t\ttransition.stop();\n\t\t}\n\t}\n\n\texecute_effect_teardown(effect);\n\n\tvar parent = effect.parent;\n\n\t// If the parent doesn't have any children, then skip this work altogether\n\tif (parent !== null && parent.first !== null) {\n\t\tunlink_effect(effect);\n\t}\n\n\tif (DEV) {\n\t\teffect.component_function = null;\n\t}\n\n\t// `first` and `child` are nulled out in destroy_effect_children\n\t// we don't null out `parent` so that error propagation can work correctly\n\teffect.next =\n\t\teffect.prev =\n\t\teffect.teardown =\n\t\teffect.ctx =\n\t\teffect.deps =\n\t\teffect.fn =\n\t\teffect.nodes_start =\n\t\teffect.nodes_end =\n\t\t\tnull;\n}\n\n/**\n * Detach an effect from the effect tree, freeing up memory and\n * reducing the amount of work that happens on subsequent traversals\n * @param {Effect} effect\n */\nexport function unlink_effect(effect) {\n\tvar parent = effect.parent;\n\tvar prev = effect.prev;\n\tvar next = effect.next;\n\n\tif (prev !== null) prev.next = next;\n\tif (next !== null) next.prev = prev;\n\n\tif (parent !== null) {\n\t\tif (parent.first === effect) parent.first = next;\n\t\tif (parent.last === effect) parent.last = prev;\n\t}\n}\n\n/**\n * When a block effect is removed, we don't immediately destroy it or yank it\n * out of the DOM, because it might have transitions. Instead, we 'pause' it.\n * It stays around (in memory, and in the DOM) until outro transitions have\n * completed, and if the state change is reversed then we _resume_ it.\n * A paused effect does not update, and the DOM subtree becomes inert.\n * @param {Effect} effect\n * @param {() => void} [callback]\n */\nexport function pause_effect(effect, callback) {\n\t/** @type {TransitionManager[]} */\n\tvar transitions = [];\n\n\tpause_children(effect, transitions, true);\n\n\trun_out_transitions(transitions, () => {\n\t\tdestroy_effect(effect);\n\t\tif (callback) callback();\n\t});\n}\n\n/**\n * @param {TransitionManager[]} transitions\n * @param {() => void} fn\n */\nexport function run_out_transitions(transitions, fn) {\n\tvar remaining = transitions.length;\n\tif (remaining > 0) {\n\t\tvar check = () => --remaining || fn();\n\t\tfor (var transition of transitions) {\n\t\t\ttransition.out(check);\n\t\t}\n\t} else {\n\t\tfn();\n\t}\n}\n\n/**\n * @param {Effect} effect\n * @param {TransitionManager[]} transitions\n * @param {boolean} local\n */\nexport function pause_children(effect, transitions, local) {\n\tif ((effect.f & INERT) !== 0) return;\n\teffect.f ^= INERT;\n\n\tif (effect.transitions !== null) {\n\t\tfor (const transition of effect.transitions) {\n\t\t\tif (transition.is_global || local) {\n\t\t\t\ttransitions.push(transition);\n\t\t\t}\n\t\t}\n\t}\n\n\tvar child = effect.first;\n\n\twhile (child !== null) {\n\t\tvar sibling = child.next;\n\t\tvar transparent = (child.f & EFFECT_TRANSPARENT) !== 0 || (child.f & BRANCH_EFFECT) !== 0;\n\t\t// TODO we don't need to call pause_children recursively with a linked list in place\n\t\t// it's slightly more involved though as we have to account for `transparent` changing\n\t\t// through the tree.\n\t\tpause_children(child, transitions, transparent ? local : false);\n\t\tchild = sibling;\n\t}\n}\n\n/**\n * The opposite of `pause_effect`. We call this if (for example)\n * `x` becomes falsy then truthy: `{#if x}...{/if}`\n * @param {Effect} effect\n */\nexport function resume_effect(effect) {\n\tresume_children(effect, true);\n}\n\n/**\n * @param {Effect} effect\n * @param {boolean} local\n */\nfunction resume_children(effect, local) {\n\tif ((effect.f & INERT) === 0) return;\n\n\t// If a dependency of this effect changed while it was paused,\n\t// apply the change now\n\tif (check_dirtiness(effect)) {\n\t\tupdate_effect(effect);\n\t}\n\n\t// Ensure we toggle the flag after possibly updating the effect so that\n\t// each block logic can correctly operate on inert items\n\teffect.f ^= INERT;\n\n\tvar child = effect.first;\n\n\twhile (child !== null) {\n\t\tvar sibling = child.next;\n\t\tvar transparent = (child.f & EFFECT_TRANSPARENT) !== 0 || (child.f & BRANCH_EFFECT) !== 0;\n\t\t// TODO we don't need to call resume_children recursively with a linked list in place\n\t\t// it's slightly more involved though as we have to account for `transparent` changing\n\t\t// through the tree.\n\t\tresume_children(child, transparent ? local : false);\n\t\tchild = sibling;\n\t}\n\n\tif (effect.transitions !== null) {\n\t\tfor (const transition of effect.transitions) {\n\t\t\tif (transition.is_global || local) {\n\t\t\t\ttransition.in();\n\t\t\t}\n\t\t}\n\t}\n}\n","import { run_all } from '../../shared/utils.js';\n\n// Fallback for when requestIdleCallback is not available\nexport const request_idle_callback =\n\ttypeof requestIdleCallback === 'undefined'\n\t\t? (/** @type {() => void} */ cb) => setTimeout(cb, 1)\n\t\t: requestIdleCallback;\n\nlet is_micro_task_queued = false;\nlet is_idle_task_queued = false;\n\n/** @type {Array<() => void>} */\nlet current_queued_micro_tasks = [];\n/** @type {Array<() => void>} */\nlet current_queued_idle_tasks = [];\n\nfunction process_micro_tasks() {\n\tis_micro_task_queued = false;\n\tconst tasks = current_queued_micro_tasks.slice();\n\tcurrent_queued_micro_tasks = [];\n\trun_all(tasks);\n}\n\nfunction process_idle_tasks() {\n\tis_idle_task_queued = false;\n\tconst tasks = current_queued_idle_tasks.slice();\n\tcurrent_queued_idle_tasks = [];\n\trun_all(tasks);\n}\n\n/**\n * @param {() => void} fn\n */\nexport function queue_micro_task(fn) {\n\tif (!is_micro_task_queued) {\n\t\tis_micro_task_queued = true;\n\t\tqueueMicrotask(process_micro_tasks);\n\t}\n\tcurrent_queued_micro_tasks.push(fn);\n}\n\n/**\n * @param {() => void} fn\n */\nexport function queue_idle_task(fn) {\n\tif (!is_idle_task_queued) {\n\t\tis_idle_task_queued = true;\n\t\trequest_idle_callback(process_idle_tasks);\n\t}\n\tcurrent_queued_idle_tasks.push(fn);\n}\n\n/**\n * Synchronously run any queued tasks.\n */\nexport function flush_tasks() {\n\tif (is_micro_task_queued) {\n\t\tprocess_micro_tasks();\n\t}\n\tif (is_idle_task_queued) {\n\t\tprocess_idle_tasks();\n\t}\n}\n","/* This file is generated by scripts/process-messages/index.js. Do not edit! */\n\nimport { DEV } from 'esm-env';\n\n/**\n * Cannot use `{@render children(...)}` if the parent component uses `let:` directives. Consider using a named snippet instead\n * @returns {never}\n */\nexport function invalid_default_snippet() {\n\tif (DEV) {\n\t\tconst error = new Error(`invalid_default_snippet\\nCannot use \\`{@render children(...)}\\` if the parent component uses \\`let:\\` directives. Consider using a named snippet instead\\nhttps://svelte.dev/e/invalid_default_snippet`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/invalid_default_snippet`);\n\t}\n}\n\n/**\n * `%name%(...)` can only be used during component initialisation\n * @param {string} name\n * @returns {never}\n */\nexport function lifecycle_outside_component(name) {\n\tif (DEV) {\n\t\tconst error = new Error(`lifecycle_outside_component\\n\\`${name}(...)\\` can only be used during component initialisation\\nhttps://svelte.dev/e/lifecycle_outside_component`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/lifecycle_outside_component`);\n\t}\n}\n\n/**\n * `%name%` is not a store with a `subscribe` method\n * @param {string} name\n * @returns {never}\n */\nexport function store_invalid_shape(name) {\n\tif (DEV) {\n\t\tconst error = new Error(`store_invalid_shape\\n\\`${name}\\` is not a store with a \\`subscribe\\` method\\nhttps://svelte.dev/e/store_invalid_shape`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/store_invalid_shape`);\n\t}\n}\n\n/**\n * The `this` prop on `<svelte:element>` must be a string, if defined\n * @returns {never}\n */\nexport function svelte_element_invalid_this_value() {\n\tif (DEV) {\n\t\tconst error = new Error(`svelte_element_invalid_this_value\\nThe \\`this\\` prop on \\`<svelte:element>\\` must be a string, if defined\\nhttps://svelte.dev/e/svelte_element_invalid_this_value`);\n\n\t\terror.name = 'Svelte error';\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/svelte_element_invalid_this_value`);\n\t}\n}","/** @import { ComponentContext, Derived, Effect, Reaction, Signal, Source, Value } from '#client' */\nimport { DEV } from 'esm-env';\nimport { define_property, get_descriptors, get_prototype_of, index_of } from '../shared/utils.js';\nimport {\n\tdestroy_block_effect_children,\n\tdestroy_effect_children,\n\tdestroy_effect_deriveds,\n\teffect,\n\texecute_effect_teardown,\n\tunlink_effect\n} from './reactivity/effects.js';\nimport {\n\tEFFECT,\n\tRENDER_EFFECT,\n\tDIRTY,\n\tMAYBE_DIRTY,\n\tCLEAN,\n\tDERIVED,\n\tUNOWNED,\n\tDESTROYED,\n\tINERT,\n\tBRANCH_EFFECT,\n\tSTATE_SYMBOL,\n\tBLOCK_EFFECT,\n\tROOT_EFFECT,\n\tLEGACY_DERIVED_PROP,\n\tDISCONNECTED,\n\tBOUNDARY_EFFECT\n} from './constants.js';\nimport { flush_tasks } from './dom/task.js';\nimport { add_owner } from './dev/ownership.js';\nimport { internal_set, set, source } from './reactivity/sources.js';\nimport { destroy_derived, execute_derived, update_derived } from './reactivity/deriveds.js';\nimport * as e from './errors.js';\nimport { lifecycle_outside_component } from '../shared/errors.js';\nimport { FILENAME } from '../../constants.js';\nimport { legacy_mode_flag, tracing_mode_flag } from '../flags/index.js';\nimport { tracing_expressions, get_stack } from './dev/tracing.js';\n\nconst FLUSH_MICROTASK = 0;\nconst FLUSH_SYNC = 1;\n// Used for DEV time error handling\n/** @param {WeakSet<Error>} value */\nconst handled_errors = new WeakSet();\nexport let is_throwing_error = false;\n\n// Used for controlling the flush of effects.\nlet scheduler_mode = FLUSH_MICROTASK;\n// Used for handling scheduling\nlet is_micro_task_queued = false;\n\n/** @type {Effect | null} */\nlet last_scheduled_effect = null;\n\nexport let is_flushing_effect = false;\nexport let is_destroying_effect = false;\n\n/** @param {boolean} value */\nexport function set_is_flushing_effect(value) {\n\tis_flushing_effect = value;\n}\n\n/** @param {boolean} value */\nexport function set_is_destroying_effect(value) {\n\tis_destroying_effect = value;\n}\n\n// Handle effect queues\n\n/** @type {Effect[]} */\nlet queued_root_effects = [];\n\nlet flush_count = 0;\n/** @type {Effect[]} Stack of effects, dev only */\nlet dev_effect_stack = [];\n// Handle signal reactivity tree dependencies and reactions\n\n/** @type {null | Reaction} */\nexport let active_reaction = null;\n\n/** @param {null | Reaction} reaction */\nexport function set_active_reaction(reaction) {\n\tactive_reaction = reaction;\n}\n\n/** @type {null | Effect} */\nexport let active_effect = null;\n\n/** @param {null | Effect} effect */\nexport function set_active_effect(effect) {\n\tactive_effect = effect;\n}\n\n/**\n * When sources are created within a derived, we record them so that we can safely allow\n * local mutations to these sources without the side-effect error being invoked unnecessarily.\n * @type {null | Source[]}\n */\nexport let derived_sources = null;\n\n/**\n * @param {Source[] | null} sources\n */\nexport function set_derived_sources(sources) {\n\tderived_sources = sources;\n}\n\n/**\n * The dependencies of the reaction that is currently being executed. In many cases,\n * the dependencies are unchanged between runs, and so this will be `null` unless\n * and until a new dependency is accessed  we track this via `skipped_deps`\n * @type {null | Value[]}\n */\nexport let new_deps = null;\n\nlet skipped_deps = 0;\n\n/**\n * Tracks writes that the effect it's executed in doesn't listen to yet,\n * so that the dependency can be added to the effect later on if it then reads it\n * @type {null | Source[]}\n */\nexport let untracked_writes = null;\n\n/** @param {null | Source[]} value */\nexport function set_untracked_writes(value) {\n\tuntracked_writes = value;\n}\n\n/**\n * @type {number} Used by sources and deriveds for handling updates.\n * Version starts from 1 so that unowned deriveds differentiate between a created effect and a run one for tracing\n **/\nlet write_version = 1;\n\n/** @type {number} Used to version each read of a source of derived to avoid duplicating depedencies inside a reaction */\nlet read_version = 0;\n\n// If we are working with a get() chain that has no active container,\n// to prevent memory leaks, we skip adding the reaction.\nexport let skip_reaction = false;\n// Handle collecting all signals which are read during a specific time frame\n/** @type {Set<Value> | null} */\nexport let captured_signals = null;\n\n/** @param {Set<Value> | null} value */\nexport function set_captured_signals(value) {\n\tcaptured_signals = value;\n}\n\n// Handling runtime component context\n/** @type {ComponentContext | null} */\nexport let component_context = null;\n\n/** @param {ComponentContext | null} context */\nexport function set_component_context(context) {\n\tcomponent_context = context;\n}\n\n/**\n * The current component function. Different from current component context:\n * ```html\n * <!-- App.svelte -->\n * <Foo>\n *   <Bar /> <!-- context == Foo.svelte, function == App.svelte -->\n * </Foo>\n * ```\n * @type {ComponentContext['function']}\n */\nexport let dev_current_component_function = null;\n\n/** @param {ComponentContext['function']} fn */\nexport function set_dev_current_component_function(fn) {\n\tdev_current_component_function = fn;\n}\n\nexport function increment_write_version() {\n\treturn ++write_version;\n}\n\n/** @returns {boolean} */\nexport function is_runes() {\n\treturn !legacy_mode_flag || (component_context !== null && component_context.l === null);\n}\n\n/**\n * Determines whether a derived or effect is dirty.\n * If it is MAYBE_DIRTY, will set the status to CLEAN\n * @param {Reaction} reaction\n * @returns {boolean}\n */\nexport function check_dirtiness(reaction) {\n\tvar flags = reaction.f;\n\n\tif ((flags & DIRTY) !== 0) {\n\t\treturn true;\n\t}\n\n\tif ((flags & MAYBE_DIRTY) !== 0) {\n\t\tvar dependencies = reaction.deps;\n\t\tvar is_unowned = (flags & UNOWNED) !== 0;\n\n\t\tif (dependencies !== null) {\n\t\t\tvar i;\n\t\t\tvar dependency;\n\t\t\tvar is_disconnected = (flags & DISCONNECTED) !== 0;\n\t\t\tvar is_unowned_connected = is_unowned && active_effect !== null && !skip_reaction;\n\t\t\tvar length = dependencies.length;\n\n\t\t\t// If we are working with a disconnected or an unowned signal that is now connected (due to an active effect)\n\t\t\t// then we need to re-connect the reaction to the dependency\n\t\t\tif (is_disconnected || is_unowned_connected) {\n\t\t\t\tfor (i = 0; i < length; i++) {\n\t\t\t\t\tdependency = dependencies[i];\n\n\t\t\t\t\t// We always re-add all reactions (even duplicates) if the derived was\n\t\t\t\t\t// previously disconnected\n\t\t\t\t\tif (is_disconnected || !dependency?.reactions?.includes(reaction)) {\n\t\t\t\t\t\t(dependency.reactions ??= []).push(reaction);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (is_disconnected) {\n\t\t\t\t\treaction.f ^= DISCONNECTED;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (i = 0; i < length; i++) {\n\t\t\t\tdependency = dependencies[i];\n\n\t\t\t\tif (check_dirtiness(/** @type {Derived} */ (dependency))) {\n\t\t\t\t\tupdate_derived(/** @type {Derived} */ (dependency));\n\t\t\t\t}\n\n\t\t\t\tif (dependency.wv > reaction.wv) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Unowned signals should never be marked as clean unless they\n\t\t// are used within an active_effect without skip_reaction\n\t\tif (!is_unowned || (active_effect !== null && !skip_reaction)) {\n\t\t\tset_signal_status(reaction, CLEAN);\n\t\t}\n\t}\n\n\treturn false;\n}\n\n/**\n * @param {unknown} error\n * @param {Effect} effect\n */\nfunction propagate_error(error, effect) {\n\t/** @type {Effect | null} */\n\tvar current = effect;\n\n\twhile (current !== null) {\n\t\tif ((current.f & BOUNDARY_EFFECT) !== 0) {\n\t\t\ttry {\n\t\t\t\t// @ts-expect-error\n\t\t\t\tcurrent.fn(error);\n\t\t\t\treturn;\n\t\t\t} catch {\n\t\t\t\t// Remove boundary flag from effect\n\t\t\t\tcurrent.f ^= BOUNDARY_EFFECT;\n\t\t\t}\n\t\t}\n\n\t\tcurrent = current.parent;\n\t}\n\n\tis_throwing_error = false;\n\tthrow error;\n}\n\n/**\n * @param {Effect} effect\n */\nfunction should_rethrow_error(effect) {\n\treturn (\n\t\t(effect.f & DESTROYED) === 0 &&\n\t\t(effect.parent === null || (effect.parent.f & BOUNDARY_EFFECT) === 0)\n\t);\n}\n\nexport function reset_is_throwing_error() {\n\tis_throwing_error = false;\n}\n\n/**\n * @param {unknown} error\n * @param {Effect} effect\n * @param {Effect | null} previous_effect\n * @param {ComponentContext | null} component_context\n */\nexport function handle_error(error, effect, previous_effect, component_context) {\n\tif (is_throwing_error) {\n\t\tif (previous_effect === null) {\n\t\t\tis_throwing_error = false;\n\t\t}\n\n\t\tif (should_rethrow_error(effect)) {\n\t\t\tthrow error;\n\t\t}\n\n\t\treturn;\n\t}\n\n\tif (previous_effect !== null) {\n\t\tis_throwing_error = true;\n\t}\n\n\tif (\n\t\t!DEV ||\n\t\tcomponent_context === null ||\n\t\t!(error instanceof Error) ||\n\t\thandled_errors.has(error)\n\t) {\n\t\tpropagate_error(error, effect);\n\t\treturn;\n\t}\n\n\thandled_errors.add(error);\n\n\tconst component_stack = [];\n\n\tconst effect_name = effect.fn?.name;\n\n\tif (effect_name) {\n\t\tcomponent_stack.push(effect_name);\n\t}\n\n\t/** @type {ComponentContext | null} */\n\tlet current_context = component_context;\n\n\twhile (current_context !== null) {\n\t\tif (DEV) {\n\t\t\t/** @type {string} */\n\t\t\tvar filename = current_context.function?.[FILENAME];\n\n\t\t\tif (filename) {\n\t\t\t\tconst file = filename.split('/').pop();\n\t\t\t\tcomponent_stack.push(file);\n\t\t\t}\n\t\t}\n\n\t\tcurrent_context = current_context.p;\n\t}\n\n\tconst indent = /Firefox/.test(navigator.userAgent) ? '  ' : '\\t';\n\tdefine_property(error, 'message', {\n\t\tvalue: error.message + `\\n${component_stack.map((name) => `\\n${indent}in ${name}`).join('')}\\n`\n\t});\n\tdefine_property(error, 'component_stack', {\n\t\tvalue: component_stack\n\t});\n\n\tconst stack = error.stack;\n\n\t// Filter out internal files from callstack\n\tif (stack) {\n\t\tconst lines = stack.split('\\n');\n\t\tconst new_lines = [];\n\t\tfor (let i = 0; i < lines.length; i++) {\n\t\t\tconst line = lines[i];\n\t\t\tif (line.includes('svelte/src/internal')) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tnew_lines.push(line);\n\t\t}\n\t\tdefine_property(error, 'stack', {\n\t\t\tvalue: new_lines.join('\\n')\n\t\t});\n\t}\n\n\tpropagate_error(error, effect);\n\n\tif (should_rethrow_error(effect)) {\n\t\tthrow error;\n\t}\n}\n\n/**\n * @template V\n * @param {Reaction} reaction\n * @returns {V}\n */\nexport function update_reaction(reaction) {\n\tvar previous_deps = new_deps;\n\tvar previous_skipped_deps = skipped_deps;\n\tvar previous_untracked_writes = untracked_writes;\n\tvar previous_reaction = active_reaction;\n\tvar previous_skip_reaction = skip_reaction;\n\tvar prev_derived_sources = derived_sources;\n\tvar previous_component_context = component_context;\n\tvar flags = reaction.f;\n\n\tnew_deps = /** @type {null | Value[]} */ (null);\n\tskipped_deps = 0;\n\tuntracked_writes = null;\n\tactive_reaction = (flags & (BRANCH_EFFECT | ROOT_EFFECT)) === 0 ? reaction : null;\n\tskip_reaction = !is_flushing_effect && (flags & UNOWNED) !== 0;\n\tderived_sources = null;\n\tcomponent_context = reaction.ctx;\n\tread_version++;\n\n\ttry {\n\t\tvar result = /** @type {Function} */ (0, reaction.fn)();\n\t\tvar deps = reaction.deps;\n\n\t\tif (new_deps !== null) {\n\t\t\tvar i;\n\n\t\t\tremove_reactions(reaction, skipped_deps);\n\n\t\t\tif (deps !== null && skipped_deps > 0) {\n\t\t\t\tdeps.length = skipped_deps + new_deps.length;\n\t\t\t\tfor (i = 0; i < new_deps.length; i++) {\n\t\t\t\t\tdeps[skipped_deps + i] = new_deps[i];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treaction.deps = deps = new_deps;\n\t\t\t}\n\n\t\t\tif (!skip_reaction) {\n\t\t\t\tfor (i = skipped_deps; i < deps.length; i++) {\n\t\t\t\t\t(deps[i].reactions ??= []).push(reaction);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (deps !== null && skipped_deps < deps.length) {\n\t\t\tremove_reactions(reaction, skipped_deps);\n\t\t\tdeps.length = skipped_deps;\n\t\t}\n\n\t\t// If we are returning to an previous reaction then\n\t\t// we need to increment the read version to ensure that\n\t\t// any dependencies in this reaction aren't marked with\n\t\t// the same version\n\t\tif (previous_reaction !== null) {\n\t\t\tread_version++;\n\t\t}\n\n\t\treturn result;\n\t} finally {\n\t\tnew_deps = previous_deps;\n\t\tskipped_deps = previous_skipped_deps;\n\t\tuntracked_writes = previous_untracked_writes;\n\t\tactive_reaction = previous_reaction;\n\t\tskip_reaction = previous_skip_reaction;\n\t\tderived_sources = prev_derived_sources;\n\t\tcomponent_context = previous_component_context;\n\t}\n}\n\n/**\n * @template V\n * @param {Reaction} signal\n * @param {Value<V>} dependency\n * @returns {void}\n */\nfunction remove_reaction(signal, dependency) {\n\tlet reactions = dependency.reactions;\n\tif (reactions !== null) {\n\t\tvar index = index_of.call(reactions, signal);\n\t\tif (index !== -1) {\n\t\t\tvar new_length = reactions.length - 1;\n\t\t\tif (new_length === 0) {\n\t\t\t\treactions = dependency.reactions = null;\n\t\t\t} else {\n\t\t\t\t// Swap with last element and then remove.\n\t\t\t\treactions[index] = reactions[new_length];\n\t\t\t\treactions.pop();\n\t\t\t}\n\t\t}\n\t}\n\t// If the derived has no reactions, then we can disconnect it from the graph,\n\t// allowing it to either reconnect in the future, or be GC'd by the VM.\n\tif (\n\t\treactions === null &&\n\t\t(dependency.f & DERIVED) !== 0 &&\n\t\t// Destroying a child effect while updating a parent effect can cause a dependency to appear\n\t\t// to be unused, when in fact it is used by the currently-updating parent. Checking `new_deps`\n\t\t// allows us to skip the expensive work of disconnecting and immediately reconnecting it\n\t\t(new_deps === null || !new_deps.includes(dependency))\n\t) {\n\t\tset_signal_status(dependency, MAYBE_DIRTY);\n\t\t// If we are working with a derived that is owned by an effect, then mark it as being\n\t\t// disconnected.\n\t\tif ((dependency.f & (UNOWNED | DISCONNECTED)) === 0) {\n\t\t\tdependency.f ^= DISCONNECTED;\n\t\t}\n\t\tremove_reactions(/** @type {Derived} **/ (dependency), 0);\n\t}\n}\n\n/**\n * @param {Reaction} signal\n * @param {number} start_index\n * @returns {void}\n */\nexport function remove_reactions(signal, start_index) {\n\tvar dependencies = signal.deps;\n\tif (dependencies === null) return;\n\n\tfor (var i = start_index; i < dependencies.length; i++) {\n\t\tremove_reaction(signal, dependencies[i]);\n\t}\n}\n\n/**\n * @param {Effect} effect\n * @returns {void}\n */\nexport function update_effect(effect) {\n\tvar flags = effect.f;\n\n\tif ((flags & DESTROYED) !== 0) {\n\t\treturn;\n\t}\n\n\tset_signal_status(effect, CLEAN);\n\n\tvar previous_effect = active_effect;\n\tvar previous_component_context = component_context;\n\n\tactive_effect = effect;\n\n\tif (DEV) {\n\t\tvar previous_component_fn = dev_current_component_function;\n\t\tdev_current_component_function = effect.component_function;\n\t}\n\n\ttry {\n\t\tif ((flags & BLOCK_EFFECT) !== 0) {\n\t\t\tdestroy_block_effect_children(effect);\n\t\t} else {\n\t\t\tdestroy_effect_children(effect);\n\t\t}\n\t\tdestroy_effect_deriveds(effect);\n\n\t\texecute_effect_teardown(effect);\n\t\tvar teardown = update_reaction(effect);\n\t\teffect.teardown = typeof teardown === 'function' ? teardown : null;\n\t\teffect.wv = write_version;\n\n\t\tvar deps = effect.deps;\n\n\t\t// In DEV, we need to handle a case where $inspect.trace() might\n\t\t// incorrectly state a source dependency has not changed when it has.\n\t\t// That's beacuse that source was changed by the same effect, causing\n\t\t// the versions to match. We can avoid this by incrementing the version\n\t\tif (DEV && tracing_mode_flag && (effect.f & DIRTY) !== 0 && deps !== null) {\n\t\t\tfor (let i = 0; i < deps.length; i++) {\n\t\t\t\tvar dep = deps[i];\n\t\t\t\tif (dep.trace_need_increase) {\n\t\t\t\t\tdep.wv = increment_write_version();\n\t\t\t\t\tdep.trace_need_increase = undefined;\n\t\t\t\t\tdep.trace_v = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (DEV) {\n\t\t\tdev_effect_stack.push(effect);\n\t\t}\n\t} catch (error) {\n\t\thandle_error(error, effect, previous_effect, previous_component_context || effect.ctx);\n\t} finally {\n\t\tactive_effect = previous_effect;\n\n\t\tif (DEV) {\n\t\t\tdev_current_component_function = previous_component_fn;\n\t\t}\n\t}\n}\n\nfunction log_effect_stack() {\n\t// eslint-disable-next-line no-console\n\tconsole.error(\n\t\t'Last ten effects were: ',\n\t\tdev_effect_stack.slice(-10).map((d) => d.fn)\n\t);\n\tdev_effect_stack = [];\n}\n\nfunction infinite_loop_guard() {\n\tif (flush_count > 1000) {\n\t\tflush_count = 0;\n\t\ttry {\n\t\t\te.effect_update_depth_exceeded();\n\t\t} catch (error) {\n\t\t\tif (DEV) {\n\t\t\t\t// stack is garbage, ignore. Instead add a console.error message.\n\t\t\t\tdefine_property(error, 'stack', {\n\t\t\t\t\tvalue: ''\n\t\t\t\t});\n\t\t\t}\n\t\t\t// Try and handle the error so it can be caught at a boundary, that's\n\t\t\t// if there's an effect available from when it was last scheduled\n\t\t\tif (last_scheduled_effect !== null) {\n\t\t\t\tif (DEV) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\thandle_error(error, last_scheduled_effect, null, null);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// Only log the effect stack if the error is re-thrown\n\t\t\t\t\t\tlog_effect_stack();\n\t\t\t\t\t\tthrow e;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\thandle_error(error, last_scheduled_effect, null, null);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (DEV) {\n\t\t\t\t\tlog_effect_stack();\n\t\t\t\t}\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\t}\n\tflush_count++;\n}\n\n/**\n * @param {Array<Effect>} root_effects\n * @returns {void}\n */\nfunction flush_queued_root_effects(root_effects) {\n\tvar length = root_effects.length;\n\tif (length === 0) {\n\t\treturn;\n\t}\n\tinfinite_loop_guard();\n\n\tvar previously_flushing_effect = is_flushing_effect;\n\tis_flushing_effect = true;\n\n\ttry {\n\t\tfor (var i = 0; i < length; i++) {\n\t\t\tvar effect = root_effects[i];\n\n\t\t\tif ((effect.f & CLEAN) === 0) {\n\t\t\t\teffect.f ^= CLEAN;\n\t\t\t}\n\n\t\t\t/** @type {Effect[]} */\n\t\t\tvar collected_effects = [];\n\n\t\t\tprocess_effects(effect, collected_effects);\n\t\t\tflush_queued_effects(collected_effects);\n\t\t}\n\t} finally {\n\t\tis_flushing_effect = previously_flushing_effect;\n\t}\n}\n\n/**\n * @param {Array<Effect>} effects\n * @returns {void}\n */\nfunction flush_queued_effects(effects) {\n\tvar length = effects.length;\n\tif (length === 0) return;\n\n\tfor (var i = 0; i < length; i++) {\n\t\tvar effect = effects[i];\n\n\t\tif ((effect.f & (DESTROYED | INERT)) === 0) {\n\t\t\ttry {\n\t\t\t\tif (check_dirtiness(effect)) {\n\t\t\t\t\tupdate_effect(effect);\n\n\t\t\t\t\t// Effects with no dependencies or teardown do not get added to the effect tree.\n\t\t\t\t\t// Deferred effects (e.g. `$effect(...)`) _are_ added to the tree because we\n\t\t\t\t\t// don't know if we need to keep them until they are executed. Doing the check\n\t\t\t\t\t// here (rather than in `update_effect`) allows us to skip the work for\n\t\t\t\t\t// immediate effects.\n\t\t\t\t\tif (effect.deps === null && effect.first === null && effect.nodes_start === null) {\n\t\t\t\t\t\tif (effect.teardown === null) {\n\t\t\t\t\t\t\t// remove this effect from the graph\n\t\t\t\t\t\t\tunlink_effect(effect);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// keep the effect in the graph, but free up some memory\n\t\t\t\t\t\t\teffect.fn = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\thandle_error(error, effect, null, effect.ctx);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction process_deferred() {\n\tis_micro_task_queued = false;\n\tif (flush_count > 1001) {\n\t\treturn;\n\t}\n\tconst previous_queued_root_effects = queued_root_effects;\n\tqueued_root_effects = [];\n\tflush_queued_root_effects(previous_queued_root_effects);\n\n\tif (!is_micro_task_queued) {\n\t\tflush_count = 0;\n\t\tlast_scheduled_effect = null;\n\t\tif (DEV) {\n\t\t\tdev_effect_stack = [];\n\t\t}\n\t}\n}\n\n/**\n * @param {Effect} signal\n * @returns {void}\n */\nexport function schedule_effect(signal) {\n\tif (scheduler_mode === FLUSH_MICROTASK) {\n\t\tif (!is_micro_task_queued) {\n\t\t\tis_micro_task_queued = true;\n\t\t\tqueueMicrotask(process_deferred);\n\t\t}\n\t}\n\n\tlast_scheduled_effect = signal;\n\n\tvar effect = signal;\n\n\twhile (effect.parent !== null) {\n\t\teffect = effect.parent;\n\t\tvar flags = effect.f;\n\n\t\tif ((flags & (ROOT_EFFECT | BRANCH_EFFECT)) !== 0) {\n\t\t\tif ((flags & CLEAN) === 0) return;\n\t\t\teffect.f ^= CLEAN;\n\t\t}\n\t}\n\n\tqueued_root_effects.push(effect);\n}\n\n/**\n *\n * This function both runs render effects and collects user effects in topological order\n * from the starting effect passed in. Effects will be collected when they match the filtered\n * bitwise flag passed in only. The collected effects array will be populated with all the user\n * effects to be flushed.\n *\n * @param {Effect} effect\n * @param {Effect[]} collected_effects\n * @returns {void}\n */\nfunction process_effects(effect, collected_effects) {\n\tvar current_effect = effect.first;\n\tvar effects = [];\n\n\tmain_loop: while (current_effect !== null) {\n\t\tvar flags = current_effect.f;\n\t\tvar is_branch = (flags & BRANCH_EFFECT) !== 0;\n\t\tvar is_skippable_branch = is_branch && (flags & CLEAN) !== 0;\n\t\tvar sibling = current_effect.next;\n\n\t\tif (!is_skippable_branch && (flags & INERT) === 0) {\n\t\t\tif ((flags & RENDER_EFFECT) !== 0) {\n\t\t\t\tif (is_branch) {\n\t\t\t\t\tcurrent_effect.f ^= CLEAN;\n\t\t\t\t} else {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (check_dirtiness(current_effect)) {\n\t\t\t\t\t\t\tupdate_effect(current_effect);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\thandle_error(error, current_effect, null, current_effect.ctx);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar child = current_effect.first;\n\n\t\t\t\tif (child !== null) {\n\t\t\t\t\tcurrent_effect = child;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t} else if ((flags & EFFECT) !== 0) {\n\t\t\t\teffects.push(current_effect);\n\t\t\t}\n\t\t}\n\n\t\tif (sibling === null) {\n\t\t\tlet parent = current_effect.parent;\n\n\t\t\twhile (parent !== null) {\n\t\t\t\tif (effect === parent) {\n\t\t\t\t\tbreak main_loop;\n\t\t\t\t}\n\t\t\t\tvar parent_sibling = parent.next;\n\t\t\t\tif (parent_sibling !== null) {\n\t\t\t\t\tcurrent_effect = parent_sibling;\n\t\t\t\t\tcontinue main_loop;\n\t\t\t\t}\n\t\t\t\tparent = parent.parent;\n\t\t\t}\n\t\t}\n\n\t\tcurrent_effect = sibling;\n\t}\n\n\t// We might be dealing with many effects here, far more than can be spread into\n\t// an array push call (callstack overflow). So let's deal with each effect in a loop.\n\tfor (var i = 0; i < effects.length; i++) {\n\t\tchild = effects[i];\n\t\tcollected_effects.push(child);\n\t\tprocess_effects(child, collected_effects);\n\t}\n}\n\n/**\n * Internal version of `flushSync` with the option to not flush previous effects.\n * Returns the result of the passed function, if given.\n * @param {() => any} [fn]\n * @returns {any}\n */\nexport function flush_sync(fn) {\n\tvar previous_scheduler_mode = scheduler_mode;\n\tvar previous_queued_root_effects = queued_root_effects;\n\n\ttry {\n\t\tinfinite_loop_guard();\n\n\t\t/** @type {Effect[]} */\n\t\tconst root_effects = [];\n\n\t\tscheduler_mode = FLUSH_SYNC;\n\t\tqueued_root_effects = root_effects;\n\t\tis_micro_task_queued = false;\n\n\t\tflush_queued_root_effects(previous_queued_root_effects);\n\n\t\tvar result = fn?.();\n\n\t\tflush_tasks();\n\t\tif (queued_root_effects.length > 0 || root_effects.length > 0) {\n\t\t\tflush_sync();\n\t\t}\n\n\t\tflush_count = 0;\n\t\tlast_scheduled_effect = null;\n\t\tif (DEV) {\n\t\t\tdev_effect_stack = [];\n\t\t}\n\n\t\treturn result;\n\t} finally {\n\t\tscheduler_mode = previous_scheduler_mode;\n\t\tqueued_root_effects = previous_queued_root_effects;\n\t}\n}\n\n/**\n * Returns a promise that resolves once any pending state changes have been applied.\n * @returns {Promise<void>}\n */\nexport async function tick() {\n\tawait Promise.resolve();\n\t// By calling flush_sync we guarantee that any pending state changes are applied after one tick.\n\t// TODO look into whether we can make flushing subsequent updates synchronously in the future.\n\tflush_sync();\n}\n\n/**\n * @template V\n * @param {Value<V>} signal\n * @returns {V}\n */\nexport function get(signal) {\n\tvar flags = signal.f;\n\tvar is_derived = (flags & DERIVED) !== 0;\n\n\t// If the derived is destroyed, just execute it again without retaining\n\t// its memoisation properties as the derived is stale\n\tif (is_derived && (flags & DESTROYED) !== 0) {\n\t\tvar value = execute_derived(/** @type {Derived} */ (signal));\n\t\t// Ensure the derived remains destroyed\n\t\tdestroy_derived(/** @type {Derived} */ (signal));\n\t\treturn value;\n\t}\n\n\tif (captured_signals !== null) {\n\t\tcaptured_signals.add(signal);\n\t}\n\n\t// Register the dependency on the current reaction signal.\n\tif (active_reaction !== null) {\n\t\tif (derived_sources !== null && derived_sources.includes(signal)) {\n\t\t\te.state_unsafe_local_read();\n\t\t}\n\t\tvar deps = active_reaction.deps;\n\t\tif (signal.rv < read_version) {\n\t\t\tsignal.rv = read_version;\n\t\t\t// If the signal is accessing the same dependencies in the same\n\t\t\t// order as it did last time, increment `skipped_deps`\n\t\t\t// rather than updating `new_deps`, which creates GC cost\n\t\t\tif (new_deps === null && deps !== null && deps[skipped_deps] === signal) {\n\t\t\t\tskipped_deps++;\n\t\t\t} else if (new_deps === null) {\n\t\t\t\tnew_deps = [signal];\n\t\t\t} else {\n\t\t\t\tnew_deps.push(signal);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tuntracked_writes !== null &&\n\t\t\t\tactive_effect !== null &&\n\t\t\t\t(active_effect.f & CLEAN) !== 0 &&\n\t\t\t\t(active_effect.f & BRANCH_EFFECT) === 0 &&\n\t\t\t\tuntracked_writes.includes(signal)\n\t\t\t) {\n\t\t\t\tset_signal_status(active_effect, DIRTY);\n\t\t\t\tschedule_effect(active_effect);\n\t\t\t}\n\t\t}\n\t} else if (is_derived && /** @type {Derived} */ (signal).deps === null) {\n\t\tvar derived = /** @type {Derived} */ (signal);\n\t\tvar parent = derived.parent;\n\t\tvar target = derived;\n\n\t\twhile (parent !== null) {\n\t\t\t// Attach the derived to the nearest parent effect, if there are deriveds\n\t\t\t// in between then we also need to attach them too\n\t\t\tif ((parent.f & DERIVED) !== 0) {\n\t\t\t\tvar parent_derived = /** @type {Derived} */ (parent);\n\n\t\t\t\ttarget = parent_derived;\n\t\t\t\tparent = parent_derived.parent;\n\t\t\t} else {\n\t\t\t\tvar parent_effect = /** @type {Effect} */ (parent);\n\n\t\t\t\tif (!parent_effect.deriveds?.includes(target)) {\n\t\t\t\t\t(parent_effect.deriveds ??= []).push(target);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (is_derived) {\n\t\tderived = /** @type {Derived} */ (signal);\n\n\t\tif (check_dirtiness(derived)) {\n\t\t\tupdate_derived(derived);\n\t\t}\n\t}\n\n\tif (\n\t\tDEV &&\n\t\ttracing_mode_flag &&\n\t\ttracing_expressions !== null &&\n\t\tactive_reaction !== null &&\n\t\ttracing_expressions.reaction === active_reaction\n\t) {\n\t\t// Used when mapping state between special blocks like `each`\n\t\tif (signal.debug) {\n\t\t\tsignal.debug();\n\t\t} else if (signal.created) {\n\t\t\tvar entry = tracing_expressions.entries.get(signal);\n\n\t\t\tif (entry === undefined) {\n\t\t\t\tentry = { read: [] };\n\t\t\t\ttracing_expressions.entries.set(signal, entry);\n\t\t\t}\n\n\t\t\tentry.read.push(get_stack('TracedAt'));\n\t\t}\n\t}\n\n\treturn signal.v;\n}\n\n/**\n * Like `get`, but checks for `undefined`. Used for `var` declarations because they can be accessed before being declared\n * @template V\n * @param {Value<V> | undefined} signal\n * @returns {V | undefined}\n */\nexport function safe_get(signal) {\n\treturn signal && get(signal);\n}\n\n/**\n * Capture an array of all the signals that are read when `fn` is called\n * @template T\n * @param {() => T} fn\n */\nexport function capture_signals(fn) {\n\tvar previous_captured_signals = captured_signals;\n\tcaptured_signals = new Set();\n\n\tvar captured = captured_signals;\n\tvar signal;\n\n\ttry {\n\t\tuntrack(fn);\n\t\tif (previous_captured_signals !== null) {\n\t\t\tfor (signal of captured_signals) {\n\t\t\t\tprevious_captured_signals.add(signal);\n\t\t\t}\n\t\t}\n\t} finally {\n\t\tcaptured_signals = previous_captured_signals;\n\t}\n\n\treturn captured;\n}\n\n/**\n * Invokes a function and captures all signals that are read during the invocation,\n * then invalidates them.\n * @param {() => any} fn\n */\nexport function invalidate_inner_signals(fn) {\n\tvar captured = capture_signals(() => untrack(fn));\n\n\tfor (var signal of captured) {\n\t\t// Go one level up because derived signals created as part of props in legacy mode\n\t\tif ((signal.f & LEGACY_DERIVED_PROP) !== 0) {\n\t\t\tfor (const dep of /** @type {Derived} */ (signal).deps || []) {\n\t\t\t\tif ((dep.f & DERIVED) === 0) {\n\t\t\t\t\t// Use internal_set instead of set here and below to avoid mutation validation\n\t\t\t\t\tinternal_set(dep, dep.v);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tinternal_set(signal, signal.v);\n\t\t}\n\t}\n}\n\n/**\n * When used inside a [`$derived`](https://svelte.dev/docs/svelte/$derived) or [`$effect`](https://svelte.dev/docs/svelte/$effect),\n * any state read inside `fn` will not be treated as a dependency.\n *\n * ```ts\n * $effect(() => {\n *   // this will run when `data` changes, but not when `time` changes\n *   save(data, {\n *     timestamp: untrack(() => time)\n *   });\n * });\n * ```\n * @template T\n * @param {() => T} fn\n * @returns {T}\n */\nexport function untrack(fn) {\n\tconst previous_reaction = active_reaction;\n\ttry {\n\t\tactive_reaction = null;\n\t\treturn fn();\n\t} finally {\n\t\tactive_reaction = previous_reaction;\n\t}\n}\n\nconst STATUS_MASK = ~(DIRTY | MAYBE_DIRTY | CLEAN);\n\n/**\n * @param {Signal} signal\n * @param {number} status\n * @returns {void}\n */\nexport function set_signal_status(signal, status) {\n\tsignal.f = (signal.f & STATUS_MASK) | status;\n}\n\n/**\n * Retrieves the context that belongs to the closest parent component with the specified `key`.\n * Must be called during component initialisation.\n *\n * @template T\n * @param {any} key\n * @returns {T}\n */\nexport function getContext(key) {\n\tconst context_map = get_or_init_context_map('getContext');\n\tconst result = /** @type {T} */ (context_map.get(key));\n\n\tif (DEV) {\n\t\tconst fn = /** @type {ComponentContext} */ (component_context).function;\n\t\tif (fn) {\n\t\t\tadd_owner(result, fn, true);\n\t\t}\n\t}\n\n\treturn result;\n}\n\n/**\n * Associates an arbitrary `context` object with the current component and the specified `key`\n * and returns that object. The context is then available to children of the component\n * (including slotted content) with `getContext`.\n *\n * Like lifecycle functions, this must be called during component initialisation.\n *\n * @template T\n * @param {any} key\n * @param {T} context\n * @returns {T}\n */\nexport function setContext(key, context) {\n\tconst context_map = get_or_init_context_map('setContext');\n\tcontext_map.set(key, context);\n\treturn context;\n}\n\n/**\n * Checks whether a given `key` has been set in the context of a parent component.\n * Must be called during component initialisation.\n *\n * @param {any} key\n * @returns {boolean}\n */\nexport function hasContext(key) {\n\tconst context_map = get_or_init_context_map('hasContext');\n\treturn context_map.has(key);\n}\n\n/**\n * Retrieves the whole context map that belongs to the closest parent component.\n * Must be called during component initialisation. Useful, for example, if you\n * programmatically create a component and want to pass the existing context to it.\n *\n * @template {Map<any, any>} [T=Map<any, any>]\n * @returns {T}\n */\nexport function getAllContexts() {\n\tconst context_map = get_or_init_context_map('getAllContexts');\n\n\tif (DEV) {\n\t\tconst fn = component_context?.function;\n\t\tif (fn) {\n\t\t\tfor (const value of context_map.values()) {\n\t\t\t\tadd_owner(value, fn, true);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn /** @type {T} */ (context_map);\n}\n\n/**\n * @param {string} name\n * @returns {Map<unknown, unknown>}\n */\nfunction get_or_init_context_map(name) {\n\tif (component_context === null) {\n\t\tlifecycle_outside_component(name);\n\t}\n\n\treturn (component_context.c ??= new Map(get_parent_context(component_context) || undefined));\n}\n\n/**\n * @param {ComponentContext} component_context\n * @returns {Map<unknown, unknown> | null}\n */\nfunction get_parent_context(component_context) {\n\tlet parent = component_context.p;\n\twhile (parent !== null) {\n\t\tconst context_map = parent.c;\n\t\tif (context_map !== null) {\n\t\t\treturn context_map;\n\t\t}\n\t\tparent = parent.p;\n\t}\n\treturn null;\n}\n\n/**\n * @template {number | bigint} T\n * @param {Value<T>} signal\n * @param {1 | -1} [d]\n * @returns {T}\n */\nexport function update(signal, d = 1) {\n\tvar value = get(signal);\n\tvar result = d === 1 ? value++ : value--;\n\n\tset(signal, value);\n\n\t// @ts-expect-error\n\treturn result;\n}\n\n/**\n * @template {number | bigint} T\n * @param {Value<T>} signal\n * @param {1 | -1} [d]\n * @returns {T}\n */\nexport function update_pre(signal, d = 1) {\n\tvar value = get(signal);\n\n\t// @ts-expect-error\n\treturn set(signal, d === 1 ? ++value : --value);\n}\n\n/**\n * @param {Record<string, unknown>} obj\n * @param {string[]} keys\n * @returns {Record<string, unknown>}\n */\nexport function exclude_from_object(obj, keys) {\n\t/** @type {Record<string, unknown>} */\n\tvar result = {};\n\n\tfor (var key in obj) {\n\t\tif (!keys.includes(key)) {\n\t\t\tresult[key] = obj[key];\n\t\t}\n\t}\n\n\treturn result;\n}\n\n/**\n * @param {Record<string, unknown>} props\n * @param {any} runes\n * @param {Function} [fn]\n * @returns {void}\n */\nexport function push(props, runes = false, fn) {\n\tcomponent_context = {\n\t\tp: component_context,\n\t\tc: null,\n\t\te: null,\n\t\tm: false,\n\t\ts: props,\n\t\tx: null,\n\t\tl: null\n\t};\n\n\tif (legacy_mode_flag && !runes) {\n\t\tcomponent_context.l = {\n\t\t\ts: null,\n\t\t\tu: null,\n\t\t\tr1: [],\n\t\t\tr2: source(false)\n\t\t};\n\t}\n\n\tif (DEV) {\n\t\t// component function\n\t\tcomponent_context.function = fn;\n\t\tdev_current_component_function = fn;\n\t}\n}\n\n/**\n * @template {Record<string, any>} T\n * @param {T} [component]\n * @returns {T}\n */\nexport function pop(component) {\n\tconst context_stack_item = component_context;\n\tif (context_stack_item !== null) {\n\t\tif (component !== undefined) {\n\t\t\tcontext_stack_item.x = component;\n\t\t}\n\t\tconst component_effects = context_stack_item.e;\n\t\tif (component_effects !== null) {\n\t\t\tvar previous_effect = active_effect;\n\t\t\tvar previous_reaction = active_reaction;\n\t\t\tcontext_stack_item.e = null;\n\t\t\ttry {\n\t\t\t\tfor (var i = 0; i < component_effects.length; i++) {\n\t\t\t\t\tvar component_effect = component_effects[i];\n\t\t\t\t\tset_active_effect(component_effect.effect);\n\t\t\t\t\tset_active_reaction(component_effect.reaction);\n\t\t\t\t\teffect(component_effect.fn);\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tset_active_effect(previous_effect);\n\t\t\t\tset_active_reaction(previous_reaction);\n\t\t\t}\n\t\t}\n\t\tcomponent_context = context_stack_item.p;\n\t\tif (DEV) {\n\t\t\tdev_current_component_function = context_stack_item.p?.function ?? null;\n\t\t}\n\t\tcontext_stack_item.m = true;\n\t}\n\t// Micro-optimization: Don't set .a above to the empty object\n\t// so it can be garbage-collected when the return here is unused\n\treturn component || /** @type {T} */ ({});\n}\n\n/**\n * Possibly traverse an object and read all its properties so that they're all reactive in case this is `$state`.\n * Does only check first level of an object for performance reasons (heuristic should be good for 99% of all cases).\n * @param {any} value\n * @returns {void}\n */\nexport function deep_read_state(value) {\n\tif (typeof value !== 'object' || !value || value instanceof EventTarget) {\n\t\treturn;\n\t}\n\n\tif (STATE_SYMBOL in value) {\n\t\tdeep_read(value);\n\t} else if (!Array.isArray(value)) {\n\t\tfor (let key in value) {\n\t\t\tconst prop = value[key];\n\t\t\tif (typeof prop === 'object' && prop && STATE_SYMBOL in prop) {\n\t\t\t\tdeep_read(prop);\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Deeply traverse an object and read all its properties\n * so that they're all reactive in case this is `$state`\n * @param {any} value\n * @param {Set<any>} visited\n * @returns {void}\n */\nexport function deep_read(value, visited = new Set()) {\n\tif (\n\t\ttypeof value === 'object' &&\n\t\tvalue !== null &&\n\t\t// We don't want to traverse DOM elements\n\t\t!(value instanceof EventTarget) &&\n\t\t!visited.has(value)\n\t) {\n\t\tvisited.add(value);\n\t\t// When working with a possible SvelteDate, this\n\t\t// will ensure we capture changes to it.\n\t\tif (value instanceof Date) {\n\t\t\tvalue.getTime();\n\t\t}\n\t\tfor (let key in value) {\n\t\t\ttry {\n\t\t\t\tdeep_read(value[key], visited);\n\t\t\t} catch (e) {\n\t\t\t\t// continue\n\t\t\t}\n\t\t}\n\t\tconst proto = get_prototype_of(value);\n\t\tif (\n\t\t\tproto !== Object.prototype &&\n\t\t\tproto !== Array.prototype &&\n\t\t\tproto !== Map.prototype &&\n\t\t\tproto !== Set.prototype &&\n\t\t\tproto !== Date.prototype\n\t\t) {\n\t\t\tconst descriptors = get_descriptors(proto);\n\t\t\tfor (let key in descriptors) {\n\t\t\t\tconst get = descriptors[key].get;\n\t\t\t\tif (get) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tget.call(value);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// continue\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nif (DEV) {\n\t/**\n\t * @param {string} rune\n\t */\n\tfunction throw_rune_error(rune) {\n\t\tif (!(rune in globalThis)) {\n\t\t\t// TODO if people start adjusting the \"this can contain runes\" config through v-p-s more, adjust this message\n\t\t\t/** @type {any} */\n\t\t\tlet value; // let's hope noone modifies this global, but belts and braces\n\t\t\tObject.defineProperty(globalThis, rune, {\n\t\t\t\tconfigurable: true,\n\t\t\t\t// eslint-disable-next-line getter-return\n\t\t\t\tget: () => {\n\t\t\t\t\tif (value !== undefined) {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\n\t\t\t\t\te.rune_outside_svelte(rune);\n\t\t\t\t},\n\t\t\t\tset: (v) => {\n\t\t\t\t\tvalue = v;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tthrow_rune_error('$state');\n\tthrow_rune_error('$effect');\n\tthrow_rune_error('$derived');\n\tthrow_rune_error('$inspect');\n\tthrow_rune_error('$props');\n\tthrow_rune_error('$bindable');\n}\n","import { hydrating } from '../hydration.js';\nimport { clear_text_content, get_first_child } from '../operations.js';\nimport { queue_micro_task } from '../task.js';\n\n/**\n * @param {HTMLElement} dom\n * @param {boolean} value\n * @returns {void}\n */\nexport function autofocus(dom, value) {\n\tif (value) {\n\t\tconst body = document.body;\n\t\tdom.autofocus = true;\n\n\t\tqueue_micro_task(() => {\n\t\t\tif (document.activeElement === body) {\n\t\t\t\tdom.focus();\n\t\t\t}\n\t\t});\n\t}\n}\n\n/**\n * The child of a textarea actually corresponds to the defaultValue property, so we need\n * to remove it upon hydration to avoid a bug when someone resets the form value.\n * @param {HTMLTextAreaElement} dom\n * @returns {void}\n */\nexport function remove_textarea_child(dom) {\n\tif (hydrating && get_first_child(dom) !== null) {\n\t\tclear_text_content(dom);\n\t}\n}\n\nlet listening_to_form_reset = false;\n\nexport function add_form_reset_listener() {\n\tif (!listening_to_form_reset) {\n\t\tlistening_to_form_reset = true;\n\t\tdocument.addEventListener(\n\t\t\t'reset',\n\t\t\t(evt) => {\n\t\t\t\t// Needs to happen one tick later or else the dom properties of the form\n\t\t\t\t// elements have not updated to their reset values yet\n\t\t\t\tPromise.resolve().then(() => {\n\t\t\t\t\tif (!evt.defaultPrevented) {\n\t\t\t\t\t\tfor (const e of /**@type {HTMLFormElement} */ (evt.target).elements) {\n\t\t\t\t\t\t\t// @ts-expect-error\n\t\t\t\t\t\t\te.__on_r?.();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t// In the capture phase to guarantee we get noticed of it (no possiblity of stopPropagation)\n\t\t\t{ capture: true }\n\t\t);\n\t}\n}\n","import { teardown } from '../../../reactivity/effects.js';\nimport {\n\tactive_effect,\n\tactive_reaction,\n\tset_active_effect,\n\tset_active_reaction\n} from '../../../runtime.js';\nimport { add_form_reset_listener } from '../misc.js';\n\n/**\n * Fires the handler once immediately (unless corresponding arg is set to `false`),\n * then listens to the given events until the render effect context is destroyed\n * @param {EventTarget} target\n * @param {Array<string>} events\n * @param {(event?: Event) => void} handler\n * @param {any} call_handler_immediately\n */\nexport function listen(target, events, handler, call_handler_immediately = true) {\n\tif (call_handler_immediately) {\n\t\thandler();\n\t}\n\n\tfor (var name of events) {\n\t\ttarget.addEventListener(name, handler);\n\t}\n\n\tteardown(() => {\n\t\tfor (var name of events) {\n\t\t\ttarget.removeEventListener(name, handler);\n\t\t}\n\t});\n}\n\n/**\n * @template T\n * @param {() => T} fn\n */\nexport function without_reactive_context(fn) {\n\tvar previous_reaction = active_reaction;\n\tvar previous_effect = active_effect;\n\tset_active_reaction(null);\n\tset_active_effect(null);\n\ttry {\n\t\treturn fn();\n\t} finally {\n\t\tset_active_reaction(previous_reaction);\n\t\tset_active_effect(previous_effect);\n\t}\n}\n\n/**\n * Listen to the given event, and then instantiate a global form reset listener if not already done,\n * to notify all bindings when the form is reset\n * @param {HTMLElement} element\n * @param {string} event\n * @param {(is_reset?: true) => void} handler\n * @param {(is_reset?: true) => void} [on_reset]\n */\nexport function listen_to_event_and_reset_event(element, event, handler, on_reset = handler) {\n\telement.addEventListener(event, () => without_reactive_context(handler));\n\t// @ts-expect-error\n\tconst prev = element.__on_r;\n\tif (prev) {\n\t\t// special case for checkbox that can have multiple binds (group & checked)\n\t\t// @ts-expect-error\n\t\telement.__on_r = () => {\n\t\t\tprev();\n\t\t\ton_reset(true);\n\t\t};\n\t} else {\n\t\t// @ts-expect-error\n\t\telement.__on_r = () => on_reset(true);\n\t}\n\n\tadd_form_reset_listener();\n}\n","/** @import { Location } from 'locate-character' */\nimport { teardown } from '../../reactivity/effects.js';\nimport { define_property, is_array } from '../../../shared/utils.js';\nimport { hydrating } from '../hydration.js';\nimport { queue_micro_task } from '../task.js';\nimport { FILENAME } from '../../../../constants.js';\nimport * as w from '../../warnings.js';\nimport {\n\tactive_effect,\n\tactive_reaction,\n\tset_active_effect,\n\tset_active_reaction\n} from '../../runtime.js';\nimport { without_reactive_context } from './bindings/shared.js';\n\n/** @type {Set<string>} */\nexport const all_registered_events = new Set();\n\n/** @type {Set<(events: Array<string>) => void>} */\nexport const root_event_handles = new Set();\n\n/**\n * SSR adds onload and onerror attributes to catch those events before the hydration.\n * This function detects those cases, removes the attributes and replays the events.\n * @param {HTMLElement} dom\n */\nexport function replay_events(dom) {\n\tif (!hydrating) return;\n\n\tif (dom.onload) {\n\t\tdom.removeAttribute('onload');\n\t}\n\tif (dom.onerror) {\n\t\tdom.removeAttribute('onerror');\n\t}\n\t// @ts-expect-error\n\tconst event = dom.__e;\n\tif (event !== undefined) {\n\t\t// @ts-expect-error\n\t\tdom.__e = undefined;\n\t\tqueueMicrotask(() => {\n\t\t\tif (dom.isConnected) {\n\t\t\t\tdom.dispatchEvent(event);\n\t\t\t}\n\t\t});\n\t}\n}\n\n/**\n * @param {string} event_name\n * @param {EventTarget} dom\n * @param {EventListener} handler\n * @param {AddEventListenerOptions} options\n */\nexport function create_event(event_name, dom, handler, options) {\n\t/**\n\t * @this {EventTarget}\n\t */\n\tfunction target_handler(/** @type {Event} */ event) {\n\t\tif (!options.capture) {\n\t\t\t// Only call in the bubble phase, else delegated events would be called before the capturing events\n\t\t\thandle_event_propagation.call(dom, event);\n\t\t}\n\t\tif (!event.cancelBubble) {\n\t\t\treturn without_reactive_context(() => {\n\t\t\t\treturn handler.call(this, event);\n\t\t\t});\n\t\t}\n\t}\n\n\t// Chrome has a bug where pointer events don't work when attached to a DOM element that has been cloned\n\t// with cloneNode() and the DOM element is disconnected from the document. To ensure the event works, we\n\t// defer the attachment till after it's been appended to the document. TODO: remove this once Chrome fixes\n\t// this bug. The same applies to wheel events and touch events.\n\tif (\n\t\tevent_name.startsWith('pointer') ||\n\t\tevent_name.startsWith('touch') ||\n\t\tevent_name === 'wheel'\n\t) {\n\t\tqueue_micro_task(() => {\n\t\t\tdom.addEventListener(event_name, target_handler, options);\n\t\t});\n\t} else {\n\t\tdom.addEventListener(event_name, target_handler, options);\n\t}\n\n\treturn target_handler;\n}\n\n/**\n * Attaches an event handler to an element and returns a function that removes the handler. Using this\n * rather than `addEventListener` will preserve the correct order relative to handlers added declaratively\n * (with attributes like `onclick`), which use event delegation for performance reasons\n *\n * @param {EventTarget} element\n * @param {string} type\n * @param {EventListener} handler\n * @param {AddEventListenerOptions} [options]\n */\nexport function on(element, type, handler, options = {}) {\n\tvar target_handler = create_event(type, element, handler, options);\n\n\treturn () => {\n\t\telement.removeEventListener(type, target_handler, options);\n\t};\n}\n\n/**\n * @param {string} event_name\n * @param {Element} dom\n * @param {EventListener} handler\n * @param {boolean} capture\n * @param {boolean} [passive]\n * @returns {void}\n */\nexport function event(event_name, dom, handler, capture, passive) {\n\tvar options = { capture, passive };\n\tvar target_handler = create_event(event_name, dom, handler, options);\n\n\t// @ts-ignore\n\tif (dom === document.body || dom === window || dom === document) {\n\t\tteardown(() => {\n\t\t\tdom.removeEventListener(event_name, target_handler, options);\n\t\t});\n\t}\n}\n\n/**\n * @param {Array<string>} events\n * @returns {void}\n */\nexport function delegate(events) {\n\tfor (var i = 0; i < events.length; i++) {\n\t\tall_registered_events.add(events[i]);\n\t}\n\n\tfor (var fn of root_event_handles) {\n\t\tfn(events);\n\t}\n}\n\n/**\n * @this {EventTarget}\n * @param {Event} event\n * @returns {void}\n */\nexport function handle_event_propagation(event) {\n\tvar handler_element = this;\n\tvar owner_document = /** @type {Node} */ (handler_element).ownerDocument;\n\tvar event_name = event.type;\n\tvar path = event.composedPath?.() || [];\n\tvar current_target = /** @type {null | Element} */ (path[0] || event.target);\n\n\t// composedPath contains list of nodes the event has propagated through.\n\t// We check __root to skip all nodes below it in case this is a\n\t// parent of the __root node, which indicates that there's nested\n\t// mounted apps. In this case we don't want to trigger events multiple times.\n\tvar path_idx = 0;\n\n\t// @ts-expect-error is added below\n\tvar handled_at = event.__root;\n\n\tif (handled_at) {\n\t\tvar at_idx = path.indexOf(handled_at);\n\t\tif (\n\t\t\tat_idx !== -1 &&\n\t\t\t(handler_element === document || handler_element === /** @type {any} */ (window))\n\t\t) {\n\t\t\t// This is the fallback document listener or a window listener, but the event was already handled\n\t\t\t// -> ignore, but set handle_at to document/window so that we're resetting the event\n\t\t\t// chain in case someone manually dispatches the same event object again.\n\t\t\t// @ts-expect-error\n\t\t\tevent.__root = handler_element;\n\t\t\treturn;\n\t\t}\n\n\t\t// We're deliberately not skipping if the index is higher, because\n\t\t// someone could create an event programmatically and emit it multiple times,\n\t\t// in which case we want to handle the whole propagation chain properly each time.\n\t\t// (this will only be a false negative if the event is dispatched multiple times and\n\t\t// the fallback document listener isn't reached in between, but that's super rare)\n\t\tvar handler_idx = path.indexOf(handler_element);\n\t\tif (handler_idx === -1) {\n\t\t\t// handle_idx can theoretically be -1 (happened in some JSDOM testing scenarios with an event listener on the window object)\n\t\t\t// so guard against that, too, and assume that everything was handled at this point.\n\t\t\treturn;\n\t\t}\n\n\t\tif (at_idx <= handler_idx) {\n\t\t\tpath_idx = at_idx;\n\t\t}\n\t}\n\n\tcurrent_target = /** @type {Element} */ (path[path_idx] || event.target);\n\t// there can only be one delegated event per element, and we either already handled the current target,\n\t// or this is the very first target in the chain which has a non-delegated listener, in which case it's safe\n\t// to handle a possible delegated event on it later (through the root delegation listener for example).\n\tif (current_target === handler_element) return;\n\n\t// Proxy currentTarget to correct target\n\tdefine_property(event, 'currentTarget', {\n\t\tconfigurable: true,\n\t\tget() {\n\t\t\treturn current_target || owner_document;\n\t\t}\n\t});\n\n\t// This started because of Chromium issue https://chromestatus.com/feature/5128696823545856,\n\t// where removal or moving of of the DOM can cause sync `blur` events to fire, which can cause logic\n\t// to run inside the current `active_reaction`, which isn't what we want at all. However, on reflection,\n\t// it's probably best that all event handled by Svelte have this behaviour, as we don't really want\n\t// an event handler to run in the context of another reaction or effect.\n\tvar previous_reaction = active_reaction;\n\tvar previous_effect = active_effect;\n\tset_active_reaction(null);\n\tset_active_effect(null);\n\n\ttry {\n\t\t/**\n\t\t * @type {unknown}\n\t\t */\n\t\tvar throw_error;\n\t\t/**\n\t\t * @type {unknown[]}\n\t\t */\n\t\tvar other_errors = [];\n\n\t\twhile (current_target !== null) {\n\t\t\t/** @type {null | Element} */\n\t\t\tvar parent_element =\n\t\t\t\tcurrent_target.assignedSlot ||\n\t\t\t\tcurrent_target.parentNode ||\n\t\t\t\t/** @type {any} */ (current_target).host ||\n\t\t\t\tnull;\n\n\t\t\ttry {\n\t\t\t\t// @ts-expect-error\n\t\t\t\tvar delegated = current_target['__' + event_name];\n\n\t\t\t\tif (delegated !== undefined && !(/** @type {any} */ (current_target).disabled)) {\n\t\t\t\t\tif (is_array(delegated)) {\n\t\t\t\t\t\tvar [fn, ...data] = delegated;\n\t\t\t\t\t\tfn.apply(current_target, [event, ...data]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdelegated.call(current_target, event);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tif (throw_error) {\n\t\t\t\t\tother_errors.push(error);\n\t\t\t\t} else {\n\t\t\t\t\tthrow_error = error;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (event.cancelBubble || parent_element === handler_element || parent_element === null) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcurrent_target = parent_element;\n\t\t}\n\n\t\tif (throw_error) {\n\t\t\tfor (let error of other_errors) {\n\t\t\t\t// Throw the rest of the errors, one-by-one on a microtask\n\t\t\t\tqueueMicrotask(() => {\n\t\t\t\t\tthrow error;\n\t\t\t\t});\n\t\t\t}\n\t\t\tthrow throw_error;\n\t\t}\n\t} finally {\n\t\t// @ts-expect-error is used above\n\t\tevent.__root = handler_element;\n\t\t// @ts-ignore remove proxy on currentTarget\n\t\tdelete event.currentTarget;\n\t\tset_active_reaction(previous_reaction);\n\t\tset_active_effect(previous_effect);\n\t}\n}\n\n/**\n * In dev, warn if an event handler is not a function, as it means the\n * user probably called the handler or forgot to add a `() =>`\n * @param {() => (event: Event, ...args: any) => void} thunk\n * @param {EventTarget} element\n * @param {[Event, ...any]} args\n * @param {any} component\n * @param {[number, number]} [loc]\n * @param {boolean} [remove_parens]\n */\nexport function apply(\n\tthunk,\n\telement,\n\targs,\n\tcomponent,\n\tloc,\n\thas_side_effects = false,\n\tremove_parens = false\n) {\n\tlet handler;\n\tlet error;\n\n\ttry {\n\t\thandler = thunk();\n\t} catch (e) {\n\t\terror = e;\n\t}\n\n\tif (typeof handler === 'function') {\n\t\thandler.apply(element, args);\n\t} else if (has_side_effects || handler != null || error) {\n\t\tconst filename = component?.[FILENAME];\n\t\tconst location = loc ? ` at ${filename}:${loc[0]}:${loc[1]}` : ` in ${filename}`;\n\n\t\tconst event_name = args[0].type;\n\t\tconst description = `\\`${event_name}\\` handler${location}`;\n\t\tconst suggestion = remove_parens ? 'remove the trailing `()`' : 'add a leading `() =>`';\n\n\t\tw.event_handler_invalid(description, suggestion);\n\n\t\tif (error) {\n\t\t\tthrow error;\n\t\t}\n\t}\n}\n","/** @param {string} html */\nexport function create_fragment_from_html(html) {\n\tvar elem = document.createElement('template');\n\telem.innerHTML = html;\n\treturn elem.content;\n}\n","/** @import { Effect, TemplateNode } from '#client' */\nimport { hydrate_next, hydrate_node, hydrating, set_hydrate_node } from './hydration.js';\nimport { create_text, get_first_child } from './operations.js';\nimport { create_fragment_from_html } from './reconciler.js';\nimport { active_effect } from '../runtime.js';\nimport { TEMPLATE_FRAGMENT, TEMPLATE_USE_IMPORT_NODE } from '../../../constants.js';\n\n/**\n * @param {TemplateNode} start\n * @param {TemplateNode | null} end\n */\nexport function assign_nodes(start, end) {\n\tvar effect = /** @type {Effect} */ (active_effect);\n\tif (effect.nodes_start === null) {\n\t\teffect.nodes_start = start;\n\t\teffect.nodes_end = end;\n\t}\n}\n\n/**\n * @param {string} content\n * @param {number} flags\n * @returns {() => Node | Node[]}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function template(content, flags) {\n\tvar is_fragment = (flags & TEMPLATE_FRAGMENT) !== 0;\n\tvar use_import_node = (flags & TEMPLATE_USE_IMPORT_NODE) !== 0;\n\n\t/** @type {Node} */\n\tvar node;\n\n\t/**\n\t * Whether or not the first item is a text/element node. If not, we need to\n\t * create an additional comment node to act as `effect.nodes.start`\n\t */\n\tvar has_start = !content.startsWith('<!>');\n\n\treturn () => {\n\t\tif (hydrating) {\n\t\t\tassign_nodes(hydrate_node, null);\n\t\t\treturn hydrate_node;\n\t\t}\n\n\t\tif (node === undefined) {\n\t\t\tnode = create_fragment_from_html(has_start ? content : '<!>' + content);\n\t\t\tif (!is_fragment) node = /** @type {Node} */ (get_first_child(node));\n\t\t}\n\n\t\tvar clone = /** @type {TemplateNode} */ (\n\t\t\tuse_import_node ? document.importNode(node, true) : node.cloneNode(true)\n\t\t);\n\n\t\tif (is_fragment) {\n\t\t\tvar start = /** @type {TemplateNode} */ (get_first_child(clone));\n\t\t\tvar end = /** @type {TemplateNode} */ (clone.lastChild);\n\n\t\t\tassign_nodes(start, end);\n\t\t} else {\n\t\t\tassign_nodes(clone, clone);\n\t\t}\n\n\t\treturn clone;\n\t};\n}\n\n/**\n * @param {string} content\n * @param {number} flags\n * @returns {() => Node | Node[]}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function template_with_script(content, flags) {\n\tvar fn = template(content, flags);\n\treturn () => run_scripts(/** @type {Element | DocumentFragment} */ (fn()));\n}\n\n/**\n * @param {string} content\n * @param {number} flags\n * @param {'svg' | 'math'} ns\n * @returns {() => Node | Node[]}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function ns_template(content, flags, ns = 'svg') {\n\t/**\n\t * Whether or not the first item is a text/element node. If not, we need to\n\t * create an additional comment node to act as `effect.nodes.start`\n\t */\n\tvar has_start = !content.startsWith('<!>');\n\n\tvar is_fragment = (flags & TEMPLATE_FRAGMENT) !== 0;\n\tvar wrapped = `<${ns}>${has_start ? content : '<!>' + content}</${ns}>`;\n\n\t/** @type {Element | DocumentFragment} */\n\tvar node;\n\n\treturn () => {\n\t\tif (hydrating) {\n\t\t\tassign_nodes(hydrate_node, null);\n\t\t\treturn hydrate_node;\n\t\t}\n\n\t\tif (!node) {\n\t\t\tvar fragment = /** @type {DocumentFragment} */ (create_fragment_from_html(wrapped));\n\t\t\tvar root = /** @type {Element} */ (get_first_child(fragment));\n\n\t\t\tif (is_fragment) {\n\t\t\t\tnode = document.createDocumentFragment();\n\t\t\t\twhile (get_first_child(root)) {\n\t\t\t\t\tnode.appendChild(/** @type {Node} */ (get_first_child(root)));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnode = /** @type {Element} */ (get_first_child(root));\n\t\t\t}\n\t\t}\n\n\t\tvar clone = /** @type {TemplateNode} */ (node.cloneNode(true));\n\n\t\tif (is_fragment) {\n\t\t\tvar start = /** @type {TemplateNode} */ (get_first_child(clone));\n\t\t\tvar end = /** @type {TemplateNode} */ (clone.lastChild);\n\n\t\t\tassign_nodes(start, end);\n\t\t} else {\n\t\t\tassign_nodes(clone, clone);\n\t\t}\n\n\t\treturn clone;\n\t};\n}\n\n/**\n * @param {string} content\n * @param {number} flags\n * @returns {() => Node | Node[]}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function svg_template_with_script(content, flags) {\n\tvar fn = ns_template(content, flags);\n\treturn () => run_scripts(/** @type {Element | DocumentFragment} */ (fn()));\n}\n\n/**\n * @param {string} content\n * @param {number} flags\n * @returns {() => Node | Node[]}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function mathml_template(content, flags) {\n\treturn ns_template(content, flags, 'math');\n}\n\n/**\n * Creating a document fragment from HTML that contains script tags will not execute\n * the scripts. We need to replace the script tags with new ones so that they are executed.\n * @param {Element | DocumentFragment} node\n * @returns {Node | Node[]}\n */\nfunction run_scripts(node) {\n\t// scripts were SSR'd, in which case they will run\n\tif (hydrating) return node;\n\n\tconst is_fragment = node.nodeType === 11;\n\tconst scripts =\n\t\t/** @type {HTMLElement} */ (node).tagName === 'SCRIPT'\n\t\t\t? [/** @type {HTMLScriptElement} */ (node)]\n\t\t\t: node.querySelectorAll('script');\n\tconst effect = /** @type {Effect} */ (active_effect);\n\n\tfor (const script of scripts) {\n\t\tconst clone = document.createElement('script');\n\t\tfor (var attribute of script.attributes) {\n\t\t\tclone.setAttribute(attribute.name, attribute.value);\n\t\t}\n\n\t\tclone.textContent = script.textContent;\n\n\t\t// The script has changed - if it's at the edges, the effect now points at dead nodes\n\t\tif (is_fragment ? node.firstChild === script : node === script) {\n\t\t\teffect.nodes_start = clone;\n\t\t}\n\t\tif (is_fragment ? node.lastChild === script : node === script) {\n\t\t\teffect.nodes_end = clone;\n\t\t}\n\n\t\tscript.replaceWith(clone);\n\t}\n\treturn node;\n}\n\n/**\n * Don't mark this as side-effect-free, hydration needs to walk all nodes\n * @param {any} value\n */\nexport function text(value = '') {\n\tif (!hydrating) {\n\t\tvar t = create_text(value + '');\n\t\tassign_nodes(t, t);\n\t\treturn t;\n\t}\n\n\tvar node = hydrate_node;\n\n\tif (node.nodeType !== 3) {\n\t\t// if an {expression} is empty during SSR, we need to insert an empty text node\n\t\tnode.before((node = create_text()));\n\t\tset_hydrate_node(node);\n\t}\n\n\tassign_nodes(node, node);\n\treturn node;\n}\n\nexport function comment() {\n\t// we're not delegating to `template` here for performance reasons\n\tif (hydrating) {\n\t\tassign_nodes(hydrate_node, null);\n\t\treturn hydrate_node;\n\t}\n\n\tvar frag = document.createDocumentFragment();\n\tvar start = document.createComment('');\n\tvar anchor = create_text();\n\tfrag.append(start, anchor);\n\n\tassign_nodes(start, anchor);\n\n\treturn frag;\n}\n\n/**\n * Assign the created (or in hydration mode, traversed) dom elements to the current block\n * and insert the elements into the dom (in client mode).\n * @param {Text | Comment | Element} anchor\n * @param {DocumentFragment | Element} dom\n */\nexport function append(anchor, dom) {\n\tif (hydrating) {\n\t\t/** @type {Effect} */ (active_effect).nodes_end = hydrate_node;\n\t\thydrate_next();\n\t\treturn;\n\t}\n\n\tif (anchor === null) {\n\t\t// edge case  void `<svelte:element>` with content\n\t\treturn;\n\t}\n\n\tanchor.before(/** @type {Node} */ (dom));\n}\n","/** @import { ComponentContext, Effect, TemplateNode } from '#client' */\n/** @import { Component, ComponentType, SvelteComponent, MountOptions } from '../../index.js' */\nimport { DEV } from 'esm-env';\nimport {\n\tclear_text_content,\n\tcreate_text,\n\tget_first_child,\n\tget_next_sibling,\n\tinit_operations\n} from './dom/operations.js';\nimport { HYDRATION_END, HYDRATION_ERROR, HYDRATION_START } from '../../constants.js';\nimport { push, pop, component_context, active_effect } from './runtime.js';\nimport { component_root, branch } from './reactivity/effects.js';\nimport {\n\thydrate_next,\n\thydrate_node,\n\thydrating,\n\tset_hydrate_node,\n\tset_hydrating\n} from './dom/hydration.js';\nimport { array_from } from '../shared/utils.js';\nimport {\n\tall_registered_events,\n\thandle_event_propagation,\n\troot_event_handles\n} from './dom/elements/events.js';\nimport { reset_head_anchor } from './dom/blocks/svelte-head.js';\nimport * as w from './warnings.js';\nimport * as e from './errors.js';\nimport { assign_nodes } from './dom/template.js';\nimport { is_passive_event } from '../../utils.js';\n\n/**\n * This is normally true  block effects should run their intro transitions \n * but is false during hydration (unless `options.intro` is `true`) and\n * when creating the children of a `<svelte:element>` that just changed tag\n */\nexport let should_intro = true;\n\n/** @param {boolean} value */\nexport function set_should_intro(value) {\n\tshould_intro = value;\n}\n\n/**\n * @param {Element} text\n * @param {string} value\n * @returns {void}\n */\nexport function set_text(text, value) {\n\t// For objects, we apply string coercion (which might make things like $state array references in the template reactive) before diffing\n\tvar str = value == null ? '' : typeof value === 'object' ? value + '' : value;\n\t// @ts-expect-error\n\tif (str !== (text.__t ??= text.nodeValue)) {\n\t\t// @ts-expect-error\n\t\ttext.__t = str;\n\t\ttext.nodeValue = str == null ? '' : str + '';\n\t}\n}\n\n/**\n * Mounts a component to the given target and returns the exports and potentially the props (if compiled with `accessors: true`) of the component.\n * Transitions will play during the initial render unless the `intro` option is set to `false`.\n *\n * @template {Record<string, any>} Props\n * @template {Record<string, any>} Exports\n * @param {ComponentType<SvelteComponent<Props>> | Component<Props, Exports, any>} component\n * @param {MountOptions<Props>} options\n * @returns {Exports}\n */\nexport function mount(component, options) {\n\treturn _mount(component, options);\n}\n\n/**\n * Hydrates a component on the given target and returns the exports and potentially the props (if compiled with `accessors: true`) of the component\n *\n * @template {Record<string, any>} Props\n * @template {Record<string, any>} Exports\n * @param {ComponentType<SvelteComponent<Props>> | Component<Props, Exports, any>} component\n * @param {{} extends Props ? {\n * \t\ttarget: Document | Element | ShadowRoot;\n * \t\tprops?: Props;\n * \t\tevents?: Record<string, (e: any) => any>;\n *  \tcontext?: Map<any, any>;\n * \t\tintro?: boolean;\n * \t\trecover?: boolean;\n * \t} : {\n * \t\ttarget: Document | Element | ShadowRoot;\n * \t\tprops: Props;\n * \t\tevents?: Record<string, (e: any) => any>;\n *  \tcontext?: Map<any, any>;\n * \t\tintro?: boolean;\n * \t\trecover?: boolean;\n * \t}} options\n * @returns {Exports}\n */\nexport function hydrate(component, options) {\n\tinit_operations();\n\toptions.intro = options.intro ?? false;\n\tconst target = options.target;\n\tconst was_hydrating = hydrating;\n\tconst previous_hydrate_node = hydrate_node;\n\n\ttry {\n\t\tvar anchor = /** @type {TemplateNode} */ (get_first_child(target));\n\t\twhile (\n\t\t\tanchor &&\n\t\t\t(anchor.nodeType !== 8 || /** @type {Comment} */ (anchor).data !== HYDRATION_START)\n\t\t) {\n\t\t\tanchor = /** @type {TemplateNode} */ (get_next_sibling(anchor));\n\t\t}\n\n\t\tif (!anchor) {\n\t\t\tthrow HYDRATION_ERROR;\n\t\t}\n\n\t\tset_hydrating(true);\n\t\tset_hydrate_node(/** @type {Comment} */ (anchor));\n\t\thydrate_next();\n\n\t\tconst instance = _mount(component, { ...options, anchor });\n\n\t\tif (\n\t\t\thydrate_node === null ||\n\t\t\thydrate_node.nodeType !== 8 ||\n\t\t\t/** @type {Comment} */ (hydrate_node).data !== HYDRATION_END\n\t\t) {\n\t\t\tw.hydration_mismatch();\n\t\t\tthrow HYDRATION_ERROR;\n\t\t}\n\n\t\tset_hydrating(false);\n\n\t\treturn /**  @type {Exports} */ (instance);\n\t} catch (error) {\n\t\tif (error === HYDRATION_ERROR) {\n\t\t\tif (options.recover === false) {\n\t\t\t\te.hydration_failed();\n\t\t\t}\n\n\t\t\t// If an error occured above, the operations might not yet have been initialised.\n\t\t\tinit_operations();\n\t\t\tclear_text_content(target);\n\n\t\t\tset_hydrating(false);\n\t\t\treturn mount(component, options);\n\t\t}\n\n\t\tthrow error;\n\t} finally {\n\t\tset_hydrating(was_hydrating);\n\t\tset_hydrate_node(previous_hydrate_node);\n\t\treset_head_anchor();\n\t}\n}\n\n/** @type {Map<string, number>} */\nconst document_listeners = new Map();\n\n/**\n * @template {Record<string, any>} Exports\n * @param {ComponentType<SvelteComponent<any>> | Component<any>} Component\n * @param {MountOptions} options\n * @returns {Exports}\n */\nfunction _mount(Component, { target, anchor, props = {}, events, context, intro = true }) {\n\tinit_operations();\n\n\tvar registered_events = new Set();\n\n\t/** @param {Array<string>} events */\n\tvar event_handle = (events) => {\n\t\tfor (var i = 0; i < events.length; i++) {\n\t\t\tvar event_name = events[i];\n\n\t\t\tif (registered_events.has(event_name)) continue;\n\t\t\tregistered_events.add(event_name);\n\n\t\t\tvar passive = is_passive_event(event_name);\n\n\t\t\t// Add the event listener to both the container and the document.\n\t\t\t// The container listener ensures we catch events from within in case\n\t\t\t// the outer content stops propagation of the event.\n\t\t\ttarget.addEventListener(event_name, handle_event_propagation, { passive });\n\n\t\t\tvar n = document_listeners.get(event_name);\n\n\t\t\tif (n === undefined) {\n\t\t\t\t// The document listener ensures we catch events that originate from elements that were\n\t\t\t\t// manually moved outside of the container (e.g. via manual portals).\n\t\t\t\tdocument.addEventListener(event_name, handle_event_propagation, { passive });\n\t\t\t\tdocument_listeners.set(event_name, 1);\n\t\t\t} else {\n\t\t\t\tdocument_listeners.set(event_name, n + 1);\n\t\t\t}\n\t\t}\n\t};\n\n\tevent_handle(array_from(all_registered_events));\n\troot_event_handles.add(event_handle);\n\n\t/** @type {Exports} */\n\t// @ts-expect-error will be defined because the render effect runs synchronously\n\tvar component = undefined;\n\n\tvar unmount = component_root(() => {\n\t\tvar anchor_node = anchor ?? target.appendChild(create_text());\n\n\t\tbranch(() => {\n\t\t\tif (context) {\n\t\t\t\tpush({});\n\t\t\t\tvar ctx = /** @type {ComponentContext} */ (component_context);\n\t\t\t\tctx.c = context;\n\t\t\t}\n\n\t\t\tif (events) {\n\t\t\t\t// We can't spread the object or else we'd lose the state proxy stuff, if it is one\n\t\t\t\t/** @type {any} */ (props).$$events = events;\n\t\t\t}\n\n\t\t\tif (hydrating) {\n\t\t\t\tassign_nodes(/** @type {TemplateNode} */ (anchor_node), null);\n\t\t\t}\n\n\t\t\tshould_intro = intro;\n\t\t\t// @ts-expect-error the public typings are not what the actual function looks like\n\t\t\tcomponent = Component(anchor_node, props) || {};\n\t\t\tshould_intro = true;\n\n\t\t\tif (hydrating) {\n\t\t\t\t/** @type {Effect} */ (active_effect).nodes_end = hydrate_node;\n\t\t\t}\n\n\t\t\tif (context) {\n\t\t\t\tpop();\n\t\t\t}\n\t\t});\n\n\t\treturn () => {\n\t\t\tfor (var event_name of registered_events) {\n\t\t\t\ttarget.removeEventListener(event_name, handle_event_propagation);\n\n\t\t\t\tvar n = /** @type {number} */ (document_listeners.get(event_name));\n\n\t\t\t\tif (--n === 0) {\n\t\t\t\t\tdocument.removeEventListener(event_name, handle_event_propagation);\n\t\t\t\t\tdocument_listeners.delete(event_name);\n\t\t\t\t} else {\n\t\t\t\t\tdocument_listeners.set(event_name, n);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\troot_event_handles.delete(event_handle);\n\n\t\t\tif (anchor_node !== anchor) {\n\t\t\t\tanchor_node.parentNode?.removeChild(anchor_node);\n\t\t\t}\n\t\t};\n\t});\n\n\tmounted_components.set(component, unmount);\n\treturn component;\n}\n\n/**\n * References of the components that were mounted or hydrated.\n * Uses a `WeakMap` to avoid memory leaks.\n */\nlet mounted_components = new WeakMap();\n\n/**\n * Unmounts a component that was previously mounted using `mount` or `hydrate`.\n *\n * Since 5.13.0, if `options.outro` is `true`, [transitions](https://svelte.dev/docs/svelte/transition) will play before the component is removed from the DOM.\n *\n * Returns a `Promise` that resolves after transitions have completed if `options.outro` is true, or immediately otherwise (prior to 5.13.0, returns `void`).\n *\n * ```js\n * import { mount, unmount } from 'svelte';\n * import App from './App.svelte';\n *\n * const app = mount(App, { target: document.body });\n *\n * // later...\n * unmount(app, { outro: true });\n * ```\n * @param {Record<string, any>} component\n * @param {{ outro?: boolean }} [options]\n * @returns {Promise<void>}\n */\nexport function unmount(component, options) {\n\tconst fn = mounted_components.get(component);\n\n\tif (fn) {\n\t\tmounted_components.delete(component);\n\t\treturn fn(options);\n\t}\n\n\tif (DEV) {\n\t\tw.lifecycle_double_unmount();\n\t}\n\n\treturn Promise.resolve();\n}\n","/** @import { Effect, Source, TemplateNode } from '#client' */\nimport { DEV } from 'esm-env';\nimport { is_promise } from '../../../shared/utils.js';\nimport { block, branch, pause_effect, resume_effect } from '../../reactivity/effects.js';\nimport { internal_set, mutable_source, source } from '../../reactivity/sources.js';\nimport {\n\tcomponent_context,\n\tflush_sync,\n\tis_runes,\n\tset_active_effect,\n\tset_active_reaction,\n\tset_component_context,\n\tset_dev_current_component_function\n} from '../../runtime.js';\nimport { hydrate_next, hydrate_node, hydrating } from '../hydration.js';\nimport { queue_micro_task } from '../task.js';\nimport { UNINITIALIZED } from '../../../../constants.js';\n\nconst PENDING = 0;\nconst THEN = 1;\nconst CATCH = 2;\n\n/**\n * @template V\n * @param {TemplateNode} node\n * @param {(() => Promise<V>)} get_input\n * @param {null | ((anchor: Node) => void)} pending_fn\n * @param {null | ((anchor: Node, value: Source<V>) => void)} then_fn\n * @param {null | ((anchor: Node, error: unknown) => void)} catch_fn\n * @returns {void}\n */\nexport function await_block(node, get_input, pending_fn, then_fn, catch_fn) {\n\tif (hydrating) {\n\t\thydrate_next();\n\t}\n\n\tvar anchor = node;\n\tvar runes = is_runes();\n\tvar active_component_context = component_context;\n\n\t/** @type {any} */\n\tvar component_function = DEV ? component_context?.function : null;\n\n\t/** @type {V | Promise<V> | typeof UNINITIALIZED} */\n\tvar input = UNINITIALIZED;\n\n\t/** @type {Effect | null} */\n\tvar pending_effect;\n\n\t/** @type {Effect | null} */\n\tvar then_effect;\n\n\t/** @type {Effect | null} */\n\tvar catch_effect;\n\n\tvar input_source = (runes ? source : mutable_source)(/** @type {V} */ (undefined));\n\tvar error_source = (runes ? source : mutable_source)(undefined);\n\tvar resolved = false;\n\n\t/**\n\t * @param {PENDING | THEN | CATCH} state\n\t * @param {boolean} restore\n\t */\n\tfunction update(state, restore) {\n\t\tresolved = true;\n\n\t\tif (restore) {\n\t\t\tset_active_effect(effect);\n\t\t\tset_active_reaction(effect); // TODO do we need both?\n\t\t\tset_component_context(active_component_context);\n\t\t\tif (DEV) set_dev_current_component_function(component_function);\n\t\t}\n\n\t\ttry {\n\t\t\tif (state === PENDING && pending_fn) {\n\t\t\t\tif (pending_effect) resume_effect(pending_effect);\n\t\t\t\telse pending_effect = branch(() => pending_fn(anchor));\n\t\t\t}\n\n\t\t\tif (state === THEN && then_fn) {\n\t\t\t\tif (then_effect) resume_effect(then_effect);\n\t\t\t\telse then_effect = branch(() => then_fn(anchor, input_source));\n\t\t\t}\n\n\t\t\tif (state === CATCH && catch_fn) {\n\t\t\t\tif (catch_effect) resume_effect(catch_effect);\n\t\t\t\telse catch_effect = branch(() => catch_fn(anchor, error_source));\n\t\t\t}\n\n\t\t\tif (state !== PENDING && pending_effect) {\n\t\t\t\tpause_effect(pending_effect, () => (pending_effect = null));\n\t\t\t}\n\n\t\t\tif (state !== THEN && then_effect) {\n\t\t\t\tpause_effect(then_effect, () => (then_effect = null));\n\t\t\t}\n\n\t\t\tif (state !== CATCH && catch_effect) {\n\t\t\t\tpause_effect(catch_effect, () => (catch_effect = null));\n\t\t\t}\n\t\t} finally {\n\t\t\tif (restore) {\n\t\t\t\tif (DEV) set_dev_current_component_function(null);\n\t\t\t\tset_component_context(null);\n\t\t\t\tset_active_reaction(null);\n\t\t\t\tset_active_effect(null);\n\n\t\t\t\t// without this, the DOM does not update until two ticks after the promise\n\t\t\t\t// resolves, which is unexpected behaviour (and somewhat irksome to test)\n\t\t\t\tflush_sync();\n\t\t\t}\n\t\t}\n\t}\n\n\tvar effect = block(() => {\n\t\tif (input === (input = get_input())) return;\n\n\t\tif (is_promise(input)) {\n\t\t\tvar promise = input;\n\n\t\t\tresolved = false;\n\n\t\t\tpromise.then(\n\t\t\t\t(value) => {\n\t\t\t\t\tif (promise !== input) return;\n\t\t\t\t\t// we technically could use `set` here since it's on the next microtick\n\t\t\t\t\t// but let's use internal_set for consistency and just to be safe\n\t\t\t\t\tinternal_set(input_source, value);\n\t\t\t\t\tupdate(THEN, true);\n\t\t\t\t},\n\t\t\t\t(error) => {\n\t\t\t\t\tif (promise !== input) return;\n\t\t\t\t\t// we technically could use `set` here since it's on the next microtick\n\t\t\t\t\t// but let's use internal_set for consistency and just to be safe\n\t\t\t\t\tinternal_set(error_source, error);\n\t\t\t\t\tupdate(CATCH, true);\n\t\t\t\t\tif (!catch_fn) {\n\t\t\t\t\t\t// Rethrow the error if no catch block exists\n\t\t\t\t\t\tthrow error_source.v;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif (hydrating) {\n\t\t\t\tif (pending_fn) {\n\t\t\t\t\tpending_effect = branch(() => pending_fn(anchor));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Wait a microtask before checking if we should show the pending state as\n\t\t\t\t// the promise might have resolved by the next microtask.\n\t\t\t\tqueue_micro_task(() => {\n\t\t\t\t\tif (!resolved) update(PENDING, true);\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tinternal_set(input_source, input);\n\t\t\tupdate(THEN, false);\n\t\t}\n\n\t\t// Set the input to something else, in order to disable the promise callbacks\n\t\treturn () => (input = UNINITIALIZED);\n\t});\n\n\tif (hydrating) {\n\t\tanchor = hydrate_node;\n\t}\n}\n","/** @import { Effect, TemplateNode } from '#client' */\nimport { EFFECT_TRANSPARENT } from '../../constants.js';\nimport {\n\thydrate_next,\n\thydrate_node,\n\thydrating,\n\tremove_nodes,\n\tset_hydrate_node,\n\tset_hydrating\n} from '../hydration.js';\nimport { block, branch, pause_effect, resume_effect } from '../../reactivity/effects.js';\nimport { HYDRATION_START_ELSE, UNINITIALIZED } from '../../../../constants.js';\n\n/**\n * @param {TemplateNode} node\n * @param {(branch: (fn: (anchor: Node) => void, flag?: boolean) => void) => void} fn\n * @param {boolean} [elseif] True if this is an `{:else if ...}` block rather than an `{#if ...}`, as that affects which transitions are considered 'local'\n * @returns {void}\n */\nexport function if_block(node, fn, elseif = false) {\n\tif (hydrating) {\n\t\thydrate_next();\n\t}\n\n\tvar anchor = node;\n\n\t/** @type {Effect | null} */\n\tvar consequent_effect = null;\n\n\t/** @type {Effect | null} */\n\tvar alternate_effect = null;\n\n\t/** @type {UNINITIALIZED | boolean | null} */\n\tvar condition = UNINITIALIZED;\n\n\tvar flags = elseif ? EFFECT_TRANSPARENT : 0;\n\n\tvar has_branch = false;\n\n\tconst set_branch = (/** @type {(anchor: Node) => void} */ fn, flag = true) => {\n\t\thas_branch = true;\n\t\tupdate_branch(flag, fn);\n\t};\n\n\tconst update_branch = (\n\t\t/** @type {boolean | null} */ new_condition,\n\t\t/** @type {null | ((anchor: Node) => void)} */ fn\n\t) => {\n\t\tif (condition === (condition = new_condition)) return;\n\n\t\t/** Whether or not there was a hydration mismatch. Needs to be a `let` or else it isn't treeshaken out */\n\t\tlet mismatch = false;\n\n\t\tif (hydrating) {\n\t\t\tconst is_else = /** @type {Comment} */ (anchor).data === HYDRATION_START_ELSE;\n\n\t\t\tif (!!condition === is_else) {\n\t\t\t\t// Hydration mismatch: remove everything inside the anchor and start fresh.\n\t\t\t\t// This could happen with `{#if browser}...{/if}`, for example\n\t\t\t\tanchor = remove_nodes();\n\n\t\t\t\tset_hydrate_node(anchor);\n\t\t\t\tset_hydrating(false);\n\t\t\t\tmismatch = true;\n\t\t\t}\n\t\t}\n\n\t\tif (condition) {\n\t\t\tif (consequent_effect) {\n\t\t\t\tresume_effect(consequent_effect);\n\t\t\t} else if (fn) {\n\t\t\t\tconsequent_effect = branch(() => fn(anchor));\n\t\t\t}\n\n\t\t\tif (alternate_effect) {\n\t\t\t\tpause_effect(alternate_effect, () => {\n\t\t\t\t\talternate_effect = null;\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tif (alternate_effect) {\n\t\t\t\tresume_effect(alternate_effect);\n\t\t\t} else if (fn) {\n\t\t\t\talternate_effect = branch(() => fn(anchor));\n\t\t\t}\n\n\t\t\tif (consequent_effect) {\n\t\t\t\tpause_effect(consequent_effect, () => {\n\t\t\t\t\tconsequent_effect = null;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (mismatch) {\n\t\t\t// continue in hydration mode\n\t\t\tset_hydrating(true);\n\t\t}\n\t};\n\n\tblock(() => {\n\t\thas_branch = false;\n\t\tfn(set_branch);\n\t\tif (!has_branch) {\n\t\t\tupdate_branch(null, null);\n\t\t}\n\t}, flags);\n\n\tif (hydrating) {\n\t\tanchor = hydrate_node;\n\t}\n}\n","/** @import { Effect, TemplateNode } from '#client' */\nimport { UNINITIALIZED } from '../../../../constants.js';\nimport { block, branch, pause_effect } from '../../reactivity/effects.js';\nimport { not_equal, safe_not_equal } from '../../reactivity/equality.js';\nimport { is_runes } from '../../runtime.js';\nimport { hydrate_next, hydrate_node, hydrating } from '../hydration.js';\n\n/**\n * @template V\n * @param {TemplateNode} node\n * @param {() => V} get_key\n * @param {(anchor: Node) => TemplateNode | void} render_fn\n * @returns {void}\n */\nexport function key_block(node, get_key, render_fn) {\n\tif (hydrating) {\n\t\thydrate_next();\n\t}\n\n\tvar anchor = node;\n\n\t/** @type {V | typeof UNINITIALIZED} */\n\tvar key = UNINITIALIZED;\n\n\t/** @type {Effect} */\n\tvar effect;\n\n\tvar changed = is_runes() ? not_equal : safe_not_equal;\n\n\tblock(() => {\n\t\tif (changed(key, (key = get_key()))) {\n\t\t\tif (effect) {\n\t\t\t\tpause_effect(effect);\n\t\t\t}\n\n\t\t\teffect = branch(() => render_fn(anchor));\n\t\t}\n\t});\n\n\tif (hydrating) {\n\t\tanchor = hydrate_node;\n\t}\n}\n","/** @import { TemplateNode } from '#client' */\nimport { render_effect, teardown } from '../../reactivity/effects.js';\nimport { hydrate_node, hydrating, set_hydrate_node } from '../hydration.js';\nimport { get_first_child } from '../operations.js';\n\n/**\n * @param {HTMLDivElement | SVGGElement} element\n * @param {() => Record<string, string>} get_styles\n * @returns {void}\n */\nexport function css_props(element, get_styles) {\n\tif (hydrating) {\n\t\tset_hydrate_node(/** @type {TemplateNode} */ (get_first_child(element)));\n\t}\n\n\trender_effect(() => {\n\t\tvar styles = get_styles();\n\n\t\tfor (var key in styles) {\n\t\t\tvar value = styles[key];\n\n\t\t\tif (value) {\n\t\t\t\telement.style.setProperty(key, value);\n\t\t\t} else {\n\t\t\t\telement.style.removeProperty(key);\n\t\t\t}\n\t\t}\n\t});\n\n\tteardown(() => {\n\t\telement.remove();\n\t});\n}\n","/** @import { EachItem, EachState, Effect, MaybeSource, Source, TemplateNode, TransitionManager, Value } from '#client' */\nimport {\n\tEACH_INDEX_REACTIVE,\n\tEACH_IS_ANIMATED,\n\tEACH_IS_CONTROLLED,\n\tEACH_ITEM_IMMUTABLE,\n\tEACH_ITEM_REACTIVE,\n\tHYDRATION_END,\n\tHYDRATION_START_ELSE\n} from '../../../../constants.js';\nimport {\n\thydrate_next,\n\thydrate_node,\n\thydrating,\n\tremove_nodes,\n\tset_hydrate_node,\n\tset_hydrating\n} from '../hydration.js';\nimport {\n\tclear_text_content,\n\tcreate_text,\n\tget_first_child,\n\tget_next_sibling\n} from '../operations.js';\nimport {\n\tblock,\n\tbranch,\n\tdestroy_effect,\n\trun_out_transitions,\n\tpause_children,\n\tpause_effect,\n\tresume_effect\n} from '../../reactivity/effects.js';\nimport { source, mutable_source, internal_set } from '../../reactivity/sources.js';\nimport { array_from, is_array } from '../../../shared/utils.js';\nimport { INERT } from '../../constants.js';\nimport { queue_micro_task } from '../task.js';\nimport { active_effect, active_reaction } from '../../runtime.js';\nimport { DEV } from 'esm-env';\n\n/**\n * The row of a keyed each block that is currently updating. We track this\n * so that `animate:` directives have something to attach themselves to\n * @type {EachItem | null}\n */\nexport let current_each_item = null;\n\n/** @param {EachItem | null} item */\nexport function set_current_each_item(item) {\n\tcurrent_each_item = item;\n}\n\n/**\n * @param {any} _\n * @param {number} i\n */\nexport function index(_, i) {\n\treturn i;\n}\n\n/**\n * Pause multiple effects simultaneously, and coordinate their\n * subsequent destruction. Used in each blocks\n * @param {EachState} state\n * @param {EachItem[]} items\n * @param {null | Node} controlled_anchor\n * @param {Map<any, EachItem>} items_map\n */\nfunction pause_effects(state, items, controlled_anchor, items_map) {\n\t/** @type {TransitionManager[]} */\n\tvar transitions = [];\n\tvar length = items.length;\n\n\tfor (var i = 0; i < length; i++) {\n\t\tpause_children(items[i].e, transitions, true);\n\t}\n\n\tvar is_controlled = length > 0 && transitions.length === 0 && controlled_anchor !== null;\n\t// If we have a controlled anchor, it means that the each block is inside a single\n\t// DOM element, so we can apply a fast-path for clearing the contents of the element.\n\tif (is_controlled) {\n\t\tvar parent_node = /** @type {Element} */ (\n\t\t\t/** @type {Element} */ (controlled_anchor).parentNode\n\t\t);\n\t\tclear_text_content(parent_node);\n\t\tparent_node.append(/** @type {Element} */ (controlled_anchor));\n\t\titems_map.clear();\n\t\tlink(state, items[0].prev, items[length - 1].next);\n\t}\n\n\trun_out_transitions(transitions, () => {\n\t\tfor (var i = 0; i < length; i++) {\n\t\t\tvar item = items[i];\n\t\t\tif (!is_controlled) {\n\t\t\t\titems_map.delete(item.k);\n\t\t\t\tlink(state, item.prev, item.next);\n\t\t\t}\n\t\t\tdestroy_effect(item.e, !is_controlled);\n\t\t}\n\t});\n}\n\n/**\n * @template V\n * @param {Element | Comment} node The next sibling node, or the parent node if this is a 'controlled' block\n * @param {number} flags\n * @param {() => V[]} get_collection\n * @param {(value: V, index: number) => any} get_key\n * @param {(anchor: Node, item: MaybeSource<V>, index: MaybeSource<number>) => void} render_fn\n * @param {null | ((anchor: Node) => void)} fallback_fn\n * @returns {void}\n */\nexport function each(node, flags, get_collection, get_key, render_fn, fallback_fn = null) {\n\tvar anchor = node;\n\n\t/** @type {EachState} */\n\tvar state = { flags, items: new Map(), first: null };\n\n\tvar is_controlled = (flags & EACH_IS_CONTROLLED) !== 0;\n\n\tif (is_controlled) {\n\t\tvar parent_node = /** @type {Element} */ (node);\n\n\t\tanchor = hydrating\n\t\t\t? set_hydrate_node(/** @type {Comment | Text} */ (get_first_child(parent_node)))\n\t\t\t: parent_node.appendChild(create_text());\n\t}\n\n\tif (hydrating) {\n\t\thydrate_next();\n\t}\n\n\t/** @type {Effect | null} */\n\tvar fallback = null;\n\n\tvar was_empty = false;\n\n\tblock(() => {\n\t\tvar collection = get_collection();\n\n\t\tvar array = is_array(collection)\n\t\t\t? collection\n\t\t\t: collection == null\n\t\t\t\t? []\n\t\t\t\t: array_from(collection);\n\n\t\tvar length = array.length;\n\n\t\tif (was_empty && length === 0) {\n\t\t\t// ignore updates if the array is empty,\n\t\t\t// and it already was empty on previous run\n\t\t\treturn;\n\t\t}\n\t\twas_empty = length === 0;\n\n\t\t/** `true` if there was a hydration mismatch. Needs to be a `let` or else it isn't treeshaken out */\n\t\tlet mismatch = false;\n\n\t\tif (hydrating) {\n\t\t\tvar is_else = /** @type {Comment} */ (anchor).data === HYDRATION_START_ELSE;\n\n\t\t\tif (is_else !== (length === 0)) {\n\t\t\t\t// hydration mismatch  remove the server-rendered DOM and start over\n\t\t\t\tanchor = remove_nodes();\n\n\t\t\t\tset_hydrate_node(anchor);\n\t\t\t\tset_hydrating(false);\n\t\t\t\tmismatch = true;\n\t\t\t}\n\t\t}\n\n\t\t// this is separate to the previous block because `hydrating` might change\n\t\tif (hydrating) {\n\t\t\t/** @type {EachItem | null} */\n\t\t\tvar prev = null;\n\n\t\t\t/** @type {EachItem} */\n\t\t\tvar item;\n\n\t\t\tfor (var i = 0; i < length; i++) {\n\t\t\t\tif (\n\t\t\t\t\thydrate_node.nodeType === 8 &&\n\t\t\t\t\t/** @type {Comment} */ (hydrate_node).data === HYDRATION_END\n\t\t\t\t) {\n\t\t\t\t\t// The server rendered fewer items than expected,\n\t\t\t\t\t// so break out and continue appending non-hydrated items\n\t\t\t\t\tanchor = /** @type {Comment} */ (hydrate_node);\n\t\t\t\t\tmismatch = true;\n\t\t\t\t\tset_hydrating(false);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tvar value = array[i];\n\t\t\t\tvar key = get_key(value, i);\n\t\t\t\titem = create_item(\n\t\t\t\t\thydrate_node,\n\t\t\t\t\tstate,\n\t\t\t\t\tprev,\n\t\t\t\t\tnull,\n\t\t\t\t\tvalue,\n\t\t\t\t\tkey,\n\t\t\t\t\ti,\n\t\t\t\t\trender_fn,\n\t\t\t\t\tflags,\n\t\t\t\t\tget_collection\n\t\t\t\t);\n\t\t\t\tstate.items.set(key, item);\n\n\t\t\t\tprev = item;\n\t\t\t}\n\n\t\t\t// remove excess nodes\n\t\t\tif (length > 0) {\n\t\t\t\tset_hydrate_node(remove_nodes());\n\t\t\t}\n\t\t}\n\n\t\tif (!hydrating) {\n\t\t\tvar effect = /** @type {Effect} */ (active_reaction);\n\t\t\treconcile(\n\t\t\t\tarray,\n\t\t\t\tstate,\n\t\t\t\tanchor,\n\t\t\t\trender_fn,\n\t\t\t\tflags,\n\t\t\t\t(effect.f & INERT) !== 0,\n\t\t\t\tget_key,\n\t\t\t\tget_collection\n\t\t\t);\n\t\t}\n\n\t\tif (fallback_fn !== null) {\n\t\t\tif (length === 0) {\n\t\t\t\tif (fallback) {\n\t\t\t\t\tresume_effect(fallback);\n\t\t\t\t} else {\n\t\t\t\t\tfallback = branch(() => fallback_fn(anchor));\n\t\t\t\t}\n\t\t\t} else if (fallback !== null) {\n\t\t\t\tpause_effect(fallback, () => {\n\t\t\t\t\tfallback = null;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (mismatch) {\n\t\t\t// continue in hydration mode\n\t\t\tset_hydrating(true);\n\t\t}\n\n\t\t// When we mount the each block for the first time, the collection won't be\n\t\t// connected to this effect as the effect hasn't finished running yet and its deps\n\t\t// won't be assigned. However, it's possible that when reconciling the each block\n\t\t// that a mutation occurred and it's made the collection MAYBE_DIRTY, so reading the\n\t\t// collection again can provide consistency to the reactive graph again as the deriveds\n\t\t// will now be `CLEAN`.\n\t\tget_collection();\n\t});\n\n\tif (hydrating) {\n\t\tanchor = hydrate_node;\n\t}\n}\n\n/**\n * Add, remove, or reorder items output by an each block as its input changes\n * @template V\n * @param {Array<V>} array\n * @param {EachState} state\n * @param {Element | Comment | Text} anchor\n * @param {(anchor: Node, item: MaybeSource<V>, index: number | Source<number>) => void} render_fn\n * @param {number} flags\n * @param {boolean} is_inert\n * @param {(value: V, index: number) => any} get_key\n * @param {() => V[]} get_collection\n * @returns {void}\n */\nfunction reconcile(array, state, anchor, render_fn, flags, is_inert, get_key, get_collection) {\n\tvar is_animated = (flags & EACH_IS_ANIMATED) !== 0;\n\tvar should_update = (flags & (EACH_ITEM_REACTIVE | EACH_INDEX_REACTIVE)) !== 0;\n\n\tvar length = array.length;\n\tvar items = state.items;\n\tvar first = state.first;\n\tvar current = first;\n\n\t/** @type {undefined | Set<EachItem>} */\n\tvar seen;\n\n\t/** @type {EachItem | null} */\n\tvar prev = null;\n\n\t/** @type {undefined | Set<EachItem>} */\n\tvar to_animate;\n\n\t/** @type {EachItem[]} */\n\tvar matched = [];\n\n\t/** @type {EachItem[]} */\n\tvar stashed = [];\n\n\t/** @type {V} */\n\tvar value;\n\n\t/** @type {any} */\n\tvar key;\n\n\t/** @type {EachItem | undefined} */\n\tvar item;\n\n\t/** @type {number} */\n\tvar i;\n\n\tif (is_animated) {\n\t\tfor (i = 0; i < length; i += 1) {\n\t\t\tvalue = array[i];\n\t\t\tkey = get_key(value, i);\n\t\t\titem = items.get(key);\n\n\t\t\tif (item !== undefined) {\n\t\t\t\titem.a?.measure();\n\t\t\t\t(to_animate ??= new Set()).add(item);\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (i = 0; i < length; i += 1) {\n\t\tvalue = array[i];\n\t\tkey = get_key(value, i);\n\t\titem = items.get(key);\n\n\t\tif (item === undefined) {\n\t\t\tvar child_anchor = current ? /** @type {TemplateNode} */ (current.e.nodes_start) : anchor;\n\n\t\t\tprev = create_item(\n\t\t\t\tchild_anchor,\n\t\t\t\tstate,\n\t\t\t\tprev,\n\t\t\t\tprev === null ? state.first : prev.next,\n\t\t\t\tvalue,\n\t\t\t\tkey,\n\t\t\t\ti,\n\t\t\t\trender_fn,\n\t\t\t\tflags,\n\t\t\t\tget_collection\n\t\t\t);\n\n\t\t\titems.set(key, prev);\n\n\t\t\tmatched = [];\n\t\t\tstashed = [];\n\n\t\t\tcurrent = prev.next;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (should_update) {\n\t\t\tupdate_item(item, value, i, flags);\n\t\t}\n\n\t\tif ((item.e.f & INERT) !== 0) {\n\t\t\tresume_effect(item.e);\n\t\t\tif (is_animated) {\n\t\t\t\titem.a?.unfix();\n\t\t\t\t(to_animate ??= new Set()).delete(item);\n\t\t\t}\n\t\t}\n\n\t\tif (item !== current) {\n\t\t\tif (seen !== undefined && seen.has(item)) {\n\t\t\t\tif (matched.length < stashed.length) {\n\t\t\t\t\t// more efficient to move later items to the front\n\t\t\t\t\tvar start = stashed[0];\n\t\t\t\t\tvar j;\n\n\t\t\t\t\tprev = start.prev;\n\n\t\t\t\t\tvar a = matched[0];\n\t\t\t\t\tvar b = matched[matched.length - 1];\n\n\t\t\t\t\tfor (j = 0; j < matched.length; j += 1) {\n\t\t\t\t\t\tmove(matched[j], start, anchor);\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (j = 0; j < stashed.length; j += 1) {\n\t\t\t\t\t\tseen.delete(stashed[j]);\n\t\t\t\t\t}\n\n\t\t\t\t\tlink(state, a.prev, b.next);\n\t\t\t\t\tlink(state, prev, a);\n\t\t\t\t\tlink(state, b, start);\n\n\t\t\t\t\tcurrent = start;\n\t\t\t\t\tprev = b;\n\t\t\t\t\ti -= 1;\n\n\t\t\t\t\tmatched = [];\n\t\t\t\t\tstashed = [];\n\t\t\t\t} else {\n\t\t\t\t\t// more efficient to move earlier items to the back\n\t\t\t\t\tseen.delete(item);\n\t\t\t\t\tmove(item, current, anchor);\n\n\t\t\t\t\tlink(state, item.prev, item.next);\n\t\t\t\t\tlink(state, item, prev === null ? state.first : prev.next);\n\t\t\t\t\tlink(state, prev, item);\n\n\t\t\t\t\tprev = item;\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tmatched = [];\n\t\t\tstashed = [];\n\n\t\t\twhile (current !== null && current.k !== key) {\n\t\t\t\t// If the each block isn't inert and an item has an effect that is already inert,\n\t\t\t\t// skip over adding it to our seen Set as the item is already being handled\n\t\t\t\tif (is_inert || (current.e.f & INERT) === 0) {\n\t\t\t\t\t(seen ??= new Set()).add(current);\n\t\t\t\t}\n\t\t\t\tstashed.push(current);\n\t\t\t\tcurrent = current.next;\n\t\t\t}\n\n\t\t\tif (current === null) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\titem = current;\n\t\t}\n\n\t\tmatched.push(item);\n\t\tprev = item;\n\t\tcurrent = item.next;\n\t}\n\n\tif (current !== null || seen !== undefined) {\n\t\tvar to_destroy = seen === undefined ? [] : array_from(seen);\n\n\t\twhile (current !== null) {\n\t\t\t// If the each block isn't inert, then inert effects are currently outroing and will be removed once the transition is finished\n\t\t\tif (is_inert || (current.e.f & INERT) === 0) {\n\t\t\t\tto_destroy.push(current);\n\t\t\t}\n\t\t\tcurrent = current.next;\n\t\t}\n\n\t\tvar destroy_length = to_destroy.length;\n\n\t\tif (destroy_length > 0) {\n\t\t\tvar controlled_anchor = (flags & EACH_IS_CONTROLLED) !== 0 && length === 0 ? anchor : null;\n\n\t\t\tif (is_animated) {\n\t\t\t\tfor (i = 0; i < destroy_length; i += 1) {\n\t\t\t\t\tto_destroy[i].a?.measure();\n\t\t\t\t}\n\n\t\t\t\tfor (i = 0; i < destroy_length; i += 1) {\n\t\t\t\t\tto_destroy[i].a?.fix();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tpause_effects(state, to_destroy, controlled_anchor, items);\n\t\t}\n\t}\n\n\tif (is_animated) {\n\t\tqueue_micro_task(() => {\n\t\t\tif (to_animate === undefined) return;\n\t\t\tfor (item of to_animate) {\n\t\t\t\titem.a?.apply();\n\t\t\t}\n\t\t});\n\t}\n\n\t/** @type {Effect} */ (active_effect).first = state.first && state.first.e;\n\t/** @type {Effect} */ (active_effect).last = prev && prev.e;\n}\n\n/**\n * @param {EachItem} item\n * @param {any} value\n * @param {number} index\n * @param {number} type\n * @returns {void}\n */\nfunction update_item(item, value, index, type) {\n\tif ((type & EACH_ITEM_REACTIVE) !== 0) {\n\t\tinternal_set(item.v, value);\n\t}\n\n\tif ((type & EACH_INDEX_REACTIVE) !== 0) {\n\t\tinternal_set(/** @type {Value<number>} */ (item.i), index);\n\t} else {\n\t\titem.i = index;\n\t}\n}\n\n/**\n * @template V\n * @param {Node} anchor\n * @param {EachState} state\n * @param {EachItem | null} prev\n * @param {EachItem | null} next\n * @param {V} value\n * @param {unknown} key\n * @param {number} index\n * @param {(anchor: Node, item: V | Source<V>, index: number | Value<number>) => void} render_fn\n * @param {number} flags\n * @param {() => V[]} get_collection\n * @returns {EachItem}\n */\nfunction create_item(\n\tanchor,\n\tstate,\n\tprev,\n\tnext,\n\tvalue,\n\tkey,\n\tindex,\n\trender_fn,\n\tflags,\n\tget_collection\n) {\n\tvar previous_each_item = current_each_item;\n\tvar reactive = (flags & EACH_ITEM_REACTIVE) !== 0;\n\tvar mutable = (flags & EACH_ITEM_IMMUTABLE) === 0;\n\n\tvar v = reactive ? (mutable ? mutable_source(value) : source(value)) : value;\n\tvar i = (flags & EACH_INDEX_REACTIVE) === 0 ? index : source(index);\n\n\tif (DEV && reactive) {\n\t\t// For tracing purposes, we need to link the source signal we create with the\n\t\t// collection + index so that tracing works as intended\n\t\t/** @type {Value} */ (v).debug = () => {\n\t\t\tvar collection_index = typeof i === 'number' ? index : i.v;\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-unused-expressions\n\t\t\tget_collection()[collection_index];\n\t\t};\n\t}\n\n\t/** @type {EachItem} */\n\tvar item = {\n\t\ti,\n\t\tv,\n\t\tk: key,\n\t\ta: null,\n\t\t// @ts-expect-error\n\t\te: null,\n\t\tprev,\n\t\tnext\n\t};\n\n\tcurrent_each_item = item;\n\n\ttry {\n\t\titem.e = branch(() => render_fn(anchor, v, i), hydrating);\n\n\t\titem.e.prev = prev && prev.e;\n\t\titem.e.next = next && next.e;\n\n\t\tif (prev === null) {\n\t\t\tstate.first = item;\n\t\t} else {\n\t\t\tprev.next = item;\n\t\t\tprev.e.next = item.e;\n\t\t}\n\n\t\tif (next !== null) {\n\t\t\tnext.prev = item;\n\t\t\tnext.e.prev = item.e;\n\t\t}\n\n\t\treturn item;\n\t} finally {\n\t\tcurrent_each_item = previous_each_item;\n\t}\n}\n\n/**\n * @param {EachItem} item\n * @param {EachItem | null} next\n * @param {Text | Element | Comment} anchor\n */\nfunction move(item, next, anchor) {\n\tvar end = item.next ? /** @type {TemplateNode} */ (item.next.e.nodes_start) : anchor;\n\n\tvar dest = next ? /** @type {TemplateNode} */ (next.e.nodes_start) : anchor;\n\tvar node = /** @type {TemplateNode} */ (item.e.nodes_start);\n\n\twhile (node !== end) {\n\t\tvar next_node = /** @type {TemplateNode} */ (get_next_sibling(node));\n\t\tdest.before(node);\n\t\tnode = next_node;\n\t}\n}\n\n/**\n * @param {EachState} state\n * @param {EachItem | null} prev\n * @param {EachItem | null} next\n */\nfunction link(state, prev, next) {\n\tif (prev === null) {\n\t\tstate.first = next;\n\t} else {\n\t\tprev.next = next;\n\t\tprev.e.next = next && next.e;\n\t}\n\n\tif (next !== null) {\n\t\tnext.prev = prev;\n\t\tnext.e.prev = prev && prev.e;\n\t}\n}\n","/** @import { Effect, TemplateNode } from '#client' */\nimport { FILENAME, HYDRATION_ERROR } from '../../../../constants.js';\nimport { block, branch, destroy_effect } from '../../reactivity/effects.js';\nimport { hydrate_next, hydrate_node, hydrating, set_hydrate_node } from '../hydration.js';\nimport { create_fragment_from_html } from '../reconciler.js';\nimport { assign_nodes } from '../template.js';\nimport * as w from '../../warnings.js';\nimport { hash, sanitize_location } from '../../../../utils.js';\nimport { DEV } from 'esm-env';\nimport { dev_current_component_function } from '../../runtime.js';\nimport { get_first_child, get_next_sibling } from '../operations.js';\n\n/**\n * @param {Element} element\n * @param {string | null} server_hash\n * @param {string} value\n */\nfunction check_hash(element, server_hash, value) {\n\tif (!server_hash || server_hash === hash(String(value ?? ''))) return;\n\n\tlet location;\n\n\t// @ts-expect-error\n\tconst loc = element.__svelte_meta?.loc;\n\tif (loc) {\n\t\tlocation = `near ${loc.file}:${loc.line}:${loc.column}`;\n\t} else if (dev_current_component_function?.[FILENAME]) {\n\t\tlocation = `in ${dev_current_component_function[FILENAME]}`;\n\t}\n\n\tw.hydration_html_changed(sanitize_location(location));\n}\n\n/**\n * @param {Element | Text | Comment} node\n * @param {() => string} get_value\n * @param {boolean} svg\n * @param {boolean} mathml\n * @param {boolean} [skip_warning]\n * @returns {void}\n */\nexport function html(node, get_value, svg, mathml, skip_warning) {\n\tvar anchor = node;\n\n\tvar value = '';\n\n\t/** @type {Effect | undefined} */\n\tvar effect;\n\n\tblock(() => {\n\t\tif (value === (value = get_value() ?? '')) {\n\t\t\tif (hydrating) {\n\t\t\t\thydrate_next();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (effect !== undefined) {\n\t\t\tdestroy_effect(effect);\n\t\t\teffect = undefined;\n\t\t}\n\n\t\tif (value === '') return;\n\n\t\teffect = branch(() => {\n\t\t\tif (hydrating) {\n\t\t\t\t// We're deliberately not trying to repair mismatches between server and client,\n\t\t\t\t// as it's costly and error-prone (and it's an edge case to have a mismatch anyway)\n\t\t\t\tvar hash = /** @type {Comment} */ (hydrate_node).data;\n\t\t\t\tvar next = hydrate_next();\n\t\t\t\tvar last = next;\n\n\t\t\t\twhile (\n\t\t\t\t\tnext !== null &&\n\t\t\t\t\t(next.nodeType !== 8 || /** @type {Comment} */ (next).data !== '')\n\t\t\t\t) {\n\t\t\t\t\tlast = next;\n\t\t\t\t\tnext = /** @type {TemplateNode} */ (get_next_sibling(next));\n\t\t\t\t}\n\n\t\t\t\tif (next === null) {\n\t\t\t\t\tw.hydration_mismatch();\n\t\t\t\t\tthrow HYDRATION_ERROR;\n\t\t\t\t}\n\n\t\t\t\tif (DEV && !skip_warning) {\n\t\t\t\t\tcheck_hash(/** @type {Element} */ (next.parentNode), hash, value);\n\t\t\t\t}\n\n\t\t\t\tassign_nodes(hydrate_node, last);\n\t\t\t\tanchor = set_hydrate_node(next);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar html = value + '';\n\t\t\tif (svg) html = `<svg>${html}</svg>`;\n\t\t\telse if (mathml) html = `<math>${html}</math>`;\n\n\t\t\t// Don't use create_fragment_with_script_from_html here because that would mean script tags are executed.\n\t\t\t// @html is basically `.innerHTML = ...` and that doesn't execute scripts either due to security reasons.\n\t\t\t/** @type {DocumentFragment | Element} */\n\t\t\tvar node = create_fragment_from_html(html);\n\n\t\t\tif (svg || mathml) {\n\t\t\t\tnode = /** @type {Element} */ (get_first_child(node));\n\t\t\t}\n\n\t\t\tassign_nodes(\n\t\t\t\t/** @type {TemplateNode} */ (get_first_child(node)),\n\t\t\t\t/** @type {TemplateNode} */ (node.lastChild)\n\t\t\t);\n\n\t\t\tif (svg || mathml) {\n\t\t\t\twhile (get_first_child(node)) {\n\t\t\t\t\tanchor.before(/** @type {Node} */ (get_first_child(node)));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tanchor.before(node);\n\t\t\t}\n\t\t});\n\t});\n}\n","/** @import { Snippet } from 'svelte' */\n/** @import { Effect, TemplateNode } from '#client' */\n/** @import { Getters } from '#shared' */\nimport { EFFECT_TRANSPARENT } from '../../constants.js';\nimport { branch, block, destroy_effect, teardown } from '../../reactivity/effects.js';\nimport {\n\tdev_current_component_function,\n\tset_dev_current_component_function\n} from '../../runtime.js';\nimport { hydrate_next, hydrate_node, hydrating } from '../hydration.js';\nimport { create_fragment_from_html } from '../reconciler.js';\nimport { assign_nodes } from '../template.js';\nimport * as w from '../../warnings.js';\nimport * as e from '../../errors.js';\nimport { DEV } from 'esm-env';\nimport { get_first_child, get_next_sibling } from '../operations.js';\nimport { noop } from '../../../shared/utils.js';\n\n/**\n * @template {(node: TemplateNode, ...args: any[]) => void} SnippetFn\n * @param {TemplateNode} node\n * @param {() => SnippetFn | null | undefined} get_snippet\n * @param {(() => any)[]} args\n * @returns {void}\n */\nexport function snippet(node, get_snippet, ...args) {\n\tvar anchor = node;\n\n\t/** @type {SnippetFn | null | undefined} */\n\t// @ts-ignore\n\tvar snippet = noop;\n\n\t/** @type {Effect | null} */\n\tvar snippet_effect;\n\n\tblock(() => {\n\t\tif (snippet === (snippet = get_snippet())) return;\n\n\t\tif (snippet_effect) {\n\t\t\tdestroy_effect(snippet_effect);\n\t\t\tsnippet_effect = null;\n\t\t}\n\n\t\tif (DEV && snippet == null) {\n\t\t\te.invalid_snippet();\n\t\t}\n\n\t\tsnippet_effect = branch(() => /** @type {SnippetFn} */ (snippet)(anchor, ...args));\n\t}, EFFECT_TRANSPARENT);\n\n\tif (hydrating) {\n\t\tanchor = hydrate_node;\n\t}\n}\n\n/**\n * In development, wrap the snippet function so that it passes validation, and so that the\n * correct component context is set for ownership checks\n * @param {any} component\n * @param {(node: TemplateNode, ...args: any[]) => void} fn\n */\nexport function wrap_snippet(component, fn) {\n\treturn (/** @type {TemplateNode} */ node, /** @type {any[]} */ ...args) => {\n\t\tvar previous_component_function = dev_current_component_function;\n\t\tset_dev_current_component_function(component);\n\n\t\ttry {\n\t\t\treturn fn(node, ...args);\n\t\t} finally {\n\t\t\tset_dev_current_component_function(previous_component_function);\n\t\t}\n\t};\n}\n\n/**\n * Create a snippet programmatically\n * @template {unknown[]} Params\n * @param {(...params: Getters<Params>) => {\n *   render: () => string\n *   setup?: (element: Element) => void | (() => void)\n * }} fn\n * @returns {Snippet<Params>}\n */\nexport function createRawSnippet(fn) {\n\t// @ts-expect-error the types are a lie\n\treturn (/** @type {TemplateNode} */ anchor, /** @type {Getters<Params>} */ ...params) => {\n\t\tvar snippet = fn(...params);\n\n\t\t/** @type {Element} */\n\t\tvar element;\n\n\t\tif (hydrating) {\n\t\t\telement = /** @type {Element} */ (hydrate_node);\n\t\t\thydrate_next();\n\t\t} else {\n\t\t\tvar html = snippet.render().trim();\n\t\t\tvar fragment = create_fragment_from_html(html);\n\t\t\telement = /** @type {Element} */ (get_first_child(fragment));\n\n\t\t\tif (DEV && (get_next_sibling(element) !== null || element.nodeType !== 1)) {\n\t\t\t\tw.invalid_raw_snippet_render();\n\t\t\t}\n\n\t\t\tanchor.before(element);\n\t\t}\n\n\t\tconst result = snippet.setup?.(element);\n\t\tassign_nodes(element, element);\n\n\t\tif (typeof result === 'function') {\n\t\t\tteardown(result);\n\t\t}\n\t};\n}\n","/** @import { TemplateNode, Dom, Effect } from '#client' */\nimport { EFFECT_TRANSPARENT } from '../../constants.js';\nimport { block, branch, pause_effect } from '../../reactivity/effects.js';\nimport { hydrate_next, hydrate_node, hydrating } from '../hydration.js';\n\n/**\n * @template P\n * @template {(props: P) => void} C\n * @param {TemplateNode} node\n * @param {() => C} get_component\n * @param {(anchor: TemplateNode, component: C) => Dom | void} render_fn\n * @returns {void}\n */\nexport function component(node, get_component, render_fn) {\n\tif (hydrating) {\n\t\thydrate_next();\n\t}\n\n\tvar anchor = node;\n\n\t/** @type {C} */\n\tvar component;\n\n\t/** @type {Effect | null} */\n\tvar effect;\n\n\tblock(() => {\n\t\tif (component === (component = get_component())) return;\n\n\t\tif (effect) {\n\t\t\tpause_effect(effect);\n\t\t\teffect = null;\n\t\t}\n\n\t\tif (component) {\n\t\t\teffect = branch(() => render_fn(anchor, component));\n\t\t}\n\t}, EFFECT_TRANSPARENT);\n\n\tif (hydrating) {\n\t\tanchor = hydrate_node;\n\t}\n}\n","/** @import { Effect, TemplateNode } from '#client' */\nimport { FILENAME, NAMESPACE_SVG } from '../../../../constants.js';\nimport {\n\thydrate_next,\n\thydrate_node,\n\thydrating,\n\tset_hydrate_node,\n\tset_hydrating\n} from '../hydration.js';\nimport { create_text, get_first_child } from '../operations.js';\nimport {\n\tblock,\n\tbranch,\n\tdestroy_effect,\n\tpause_effect,\n\tresume_effect\n} from '../../reactivity/effects.js';\nimport { set_should_intro } from '../../render.js';\nimport { current_each_item, set_current_each_item } from './each.js';\nimport { component_context, active_effect } from '../../runtime.js';\nimport { DEV } from 'esm-env';\nimport { EFFECT_TRANSPARENT } from '../../constants.js';\nimport { assign_nodes } from '../template.js';\nimport { is_raw_text_element } from '../../../../utils.js';\n\n/**\n * @param {Comment | Element} node\n * @param {() => string} get_tag\n * @param {boolean} is_svg\n * @param {undefined | ((element: Element, anchor: Node | null) => void)} render_fn,\n * @param {undefined | (() => string)} get_namespace\n * @param {undefined | [number, number]} location\n * @returns {void}\n */\nexport function element(node, get_tag, is_svg, render_fn, get_namespace, location) {\n\tlet was_hydrating = hydrating;\n\n\tif (hydrating) {\n\t\thydrate_next();\n\t}\n\n\tvar filename = DEV && location && component_context?.function[FILENAME];\n\n\t/** @type {string | null} */\n\tvar tag;\n\n\t/** @type {string | null} */\n\tvar current_tag;\n\n\t/** @type {null | Element} */\n\tvar element = null;\n\n\tif (hydrating && hydrate_node.nodeType === 1) {\n\t\telement = /** @type {Element} */ (hydrate_node);\n\t\thydrate_next();\n\t}\n\n\tvar anchor = /** @type {TemplateNode} */ (hydrating ? hydrate_node : node);\n\n\t/** @type {Effect | null} */\n\tvar effect;\n\n\t/**\n\t * The keyed `{#each ...}` item block, if any, that this element is inside.\n\t * We track this so we can set it when changing the element, allowing any\n\t * `animate:` directive to bind itself to the correct block\n\t */\n\tvar each_item_block = current_each_item;\n\n\tblock(() => {\n\t\tconst next_tag = get_tag() || null;\n\t\tvar ns = get_namespace ? get_namespace() : is_svg || next_tag === 'svg' ? NAMESPACE_SVG : null;\n\n\t\t// Assumption: Noone changes the namespace but not the tag (what would that even mean?)\n\t\tif (next_tag === tag) return;\n\n\t\t// See explanation of `each_item_block` above\n\t\tvar previous_each_item = current_each_item;\n\t\tset_current_each_item(each_item_block);\n\n\t\tif (effect) {\n\t\t\tif (next_tag === null) {\n\t\t\t\t// start outro\n\t\t\t\tpause_effect(effect, () => {\n\t\t\t\t\teffect = null;\n\t\t\t\t\tcurrent_tag = null;\n\t\t\t\t});\n\t\t\t} else if (next_tag === current_tag) {\n\t\t\t\t// same tag as is currently rendered  abort outro\n\t\t\t\tresume_effect(effect);\n\t\t\t} else {\n\t\t\t\t// tag is changing  destroy immediately, render contents without intro transitions\n\t\t\t\tdestroy_effect(effect);\n\t\t\t\tset_should_intro(false);\n\t\t\t}\n\t\t}\n\n\t\tif (next_tag && next_tag !== current_tag) {\n\t\t\teffect = branch(() => {\n\t\t\t\telement = hydrating\n\t\t\t\t\t? /** @type {Element} */ (element)\n\t\t\t\t\t: ns\n\t\t\t\t\t\t? document.createElementNS(ns, next_tag)\n\t\t\t\t\t\t: document.createElement(next_tag);\n\n\t\t\t\tif (DEV && location) {\n\t\t\t\t\t// @ts-expect-error\n\t\t\t\t\telement.__svelte_meta = {\n\t\t\t\t\t\tloc: {\n\t\t\t\t\t\t\tfile: filename,\n\t\t\t\t\t\t\tline: location[0],\n\t\t\t\t\t\t\tcolumn: location[1]\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tassign_nodes(element, element);\n\n\t\t\t\tif (render_fn) {\n\t\t\t\t\tif (hydrating && is_raw_text_element(next_tag)) {\n\t\t\t\t\t\t// prevent hydration glitches\n\t\t\t\t\t\telement.append(document.createComment(''));\n\t\t\t\t\t}\n\n\t\t\t\t\t// If hydrating, use the existing ssr comment as the anchor so that the\n\t\t\t\t\t// inner open and close methods can pick up the existing nodes correctly\n\t\t\t\t\tvar child_anchor = /** @type {TemplateNode} */ (\n\t\t\t\t\t\thydrating ? get_first_child(element) : element.appendChild(create_text())\n\t\t\t\t\t);\n\n\t\t\t\t\tif (hydrating) {\n\t\t\t\t\t\tif (child_anchor === null) {\n\t\t\t\t\t\t\tset_hydrating(false);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tset_hydrate_node(child_anchor);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// `child_anchor` is undefined if this is a void element, but we still\n\t\t\t\t\t// need to call `render_fn` in order to run actions etc. If the element\n\t\t\t\t\t// contains children, it's a user error (which is warned on elsewhere)\n\t\t\t\t\t// and the DOM will be silently discarded\n\t\t\t\t\trender_fn(element, child_anchor);\n\t\t\t\t}\n\n\t\t\t\t// we do this after calling `render_fn` so that child effects don't override `nodes.end`\n\t\t\t\t/** @type {Effect} */ (active_effect).nodes_end = element;\n\n\t\t\t\tanchor.before(element);\n\t\t\t});\n\t\t}\n\n\t\ttag = next_tag;\n\t\tif (tag) current_tag = tag;\n\t\tset_should_intro(true);\n\n\t\tset_current_each_item(previous_each_item);\n\t}, EFFECT_TRANSPARENT);\n\n\tif (was_hydrating) {\n\t\tset_hydrating(true);\n\t\tset_hydrate_node(anchor);\n\t}\n}\n","/** @import { ActionPayload } from '#client' */\nimport { effect, render_effect } from '../../reactivity/effects.js';\nimport { safe_not_equal } from '../../reactivity/equality.js';\nimport { deep_read_state, untrack } from '../../runtime.js';\n\n/**\n * @template P\n * @param {Element} dom\n * @param {(dom: Element, value?: P) => ActionPayload<P>} action\n * @param {() => P} [get_value]\n * @returns {void}\n */\nexport function action(dom, action, get_value) {\n\teffect(() => {\n\t\tvar payload = untrack(() => action(dom, get_value?.()) || {});\n\n\t\tif (get_value && payload?.update) {\n\t\t\tvar inited = false;\n\t\t\t/** @type {P} */\n\t\t\tvar prev = /** @type {any} */ ({}); // initialize with something so it's never equal on first run\n\n\t\t\trender_effect(() => {\n\t\t\t\tvar value = get_value();\n\n\t\t\t\t// Action's update method is coarse-grained, i.e. when anything in the passed value changes, update.\n\t\t\t\t// This works in legacy mode because of mutable_source being updated as a whole, but when using $state\n\t\t\t\t// together with actions and mutation, it wouldn't notice the change without a deep read.\n\t\t\t\tdeep_read_state(value);\n\n\t\t\t\tif (inited && safe_not_equal(prev, value)) {\n\t\t\t\t\tprev = value;\n\t\t\t\t\t/** @type {Function} */ (payload.update)(value);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tinited = true;\n\t\t}\n\n\t\tif (payload?.destroy) {\n\t\t\treturn () => /** @type {Function} */ (payload.destroy)();\n\t\t}\n\t});\n}\n","function r(e){var t,f,n=\"\";if(\"string\"==typeof e||\"number\"==typeof e)n+=e;else if(\"object\"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=\" \"),n+=f)}else for(f in e)e[f]&&(n&&(n+=\" \"),n+=f);return n}export function clsx(){for(var e,t,f=0,n=\"\",o=arguments.length;f<o;f++)(e=arguments[f])&&(t=r(e))&&(n&&(n+=\" \"),n+=t);return n}export default clsx;","import { escape_html } from '../../escaping.js';\nimport { clsx as _clsx } from 'clsx';\n\n/**\n * `<div translate={false}>` should be rendered as `<div translate=\"no\">` and _not_\n * `<div translate=\"false\">`, which is equivalent to `<div translate=\"yes\">`. There\n * may be other odd cases that need to be added to this list in future\n * @type {Record<string, Map<any, string>>}\n */\nconst replacements = {\n\ttranslate: new Map([\n\t\t[true, 'yes'],\n\t\t[false, 'no']\n\t])\n};\n\n/**\n * @template V\n * @param {string} name\n * @param {V} value\n * @param {boolean} [is_boolean]\n * @returns {string}\n */\nexport function attr(name, value, is_boolean = false) {\n\tif (value == null || (!value && is_boolean) || (value === '' && name === 'class')) return '';\n\tconst normalized = (name in replacements && replacements[name].get(value)) || value;\n\tconst assignment = is_boolean ? '' : `=\"${escape_html(normalized, true)}\"`;\n\treturn ` ${name}${assignment}`;\n}\n\n/**\n * Small wrapper around clsx to preserve Svelte's (weird) handling of falsy values.\n * TODO Svelte 6 revisit this, and likely turn all falsy values into the empty string (what clsx also does)\n * @param  {any} value\n */\nexport function clsx(value) {\n\tif (typeof value === 'object') {\n\t\treturn _clsx(value);\n\t} else {\n\t\treturn value ?? '';\n\t}\n}\n","import { DEV } from 'esm-env';\nimport { hydrating } from '../hydration.js';\nimport { get_descriptors, get_prototype_of } from '../../../shared/utils.js';\nimport { create_event, delegate } from './events.js';\nimport { add_form_reset_listener, autofocus } from './misc.js';\nimport * as w from '../../warnings.js';\nimport { LOADING_ATTR_SYMBOL } from '../../constants.js';\nimport { queue_idle_task } from '../task.js';\nimport { is_capture_event, is_delegated, normalize_attribute } from '../../../../utils.js';\nimport {\n\tactive_effect,\n\tactive_reaction,\n\tset_active_effect,\n\tset_active_reaction\n} from '../../runtime.js';\nimport { clsx } from '../../../shared/attributes.js';\n\n/**\n * The value/checked attribute in the template actually corresponds to the defaultValue property, so we need\n * to remove it upon hydration to avoid a bug when someone resets the form value.\n * @param {HTMLInputElement} input\n * @returns {void}\n */\nexport function remove_input_defaults(input) {\n\tif (!hydrating) return;\n\n\tvar already_removed = false;\n\n\t// We try and remove the default attributes later, rather than sync during hydration.\n\t// Doing it sync during hydration has a negative impact on performance, but deferring the\n\t// work in an idle task alleviates this greatly. If a form reset event comes in before\n\t// the idle callback, then we ensure the input defaults are cleared just before.\n\tvar remove_defaults = () => {\n\t\tif (already_removed) return;\n\t\talready_removed = true;\n\n\t\t// Remove the attributes but preserve the values\n\t\tif (input.hasAttribute('value')) {\n\t\t\tvar value = input.value;\n\t\t\tset_attribute(input, 'value', null);\n\t\t\tinput.value = value;\n\t\t}\n\n\t\tif (input.hasAttribute('checked')) {\n\t\t\tvar checked = input.checked;\n\t\t\tset_attribute(input, 'checked', null);\n\t\t\tinput.checked = checked;\n\t\t}\n\t};\n\n\t// @ts-expect-error\n\tinput.__on_r = remove_defaults;\n\tqueue_idle_task(remove_defaults);\n\tadd_form_reset_listener();\n}\n\n/**\n * @param {Element} element\n * @param {any} value\n */\nexport function set_value(element, value) {\n\t// @ts-expect-error\n\tvar attributes = (element.__attributes ??= {});\n\n\tif (\n\t\tattributes.value ===\n\t\t\t(attributes.value =\n\t\t\t\t// treat null and undefined the same for the initial value\n\t\t\t\tvalue ?? undefined) ||\n\t\t// @ts-expect-error\n\t\t// `progress` elements always need their value set when its `0`\n\t\t(element.value === value && (value !== 0 || element.nodeName !== 'PROGRESS'))\n\t) {\n\t\treturn;\n\t}\n\n\t// @ts-expect-error\n\telement.value = value;\n}\n\n/**\n * @param {Element} element\n * @param {boolean} checked\n */\nexport function set_checked(element, checked) {\n\t// @ts-expect-error\n\tvar attributes = (element.__attributes ??= {});\n\n\tif (\n\t\tattributes.checked ===\n\t\t(attributes.checked =\n\t\t\t// treat null and undefined the same for the initial value\n\t\t\tchecked ?? undefined)\n\t) {\n\t\treturn;\n\t}\n\n\t// @ts-expect-error\n\telement.checked = checked;\n}\n\n/**\n * Sets the `selected` attribute on an `option` element.\n * Not set through the property because that doesn't reflect to the DOM,\n * which means it wouldn't be taken into account when a form is reset.\n * @param {HTMLOptionElement} element\n * @param {boolean} selected\n */\nexport function set_selected(element, selected) {\n\tif (selected) {\n\t\t// The selected option could've changed via user selection, and\n\t\t// setting the value without this check would set it back.\n\t\tif (!element.hasAttribute('selected')) {\n\t\t\telement.setAttribute('selected', '');\n\t\t}\n\t} else {\n\t\telement.removeAttribute('selected');\n\t}\n}\n\n/**\n * Applies the default checked property without influencing the current checked property.\n * @param {HTMLInputElement} element\n * @param {boolean} checked\n */\nexport function set_default_checked(element, checked) {\n\tconst existing_value = element.checked;\n\telement.defaultChecked = checked;\n\telement.checked = existing_value;\n}\n\n/**\n * Applies the default value property without influencing the current value property.\n * @param {HTMLInputElement | HTMLTextAreaElement} element\n * @param {string} value\n */\nexport function set_default_value(element, value) {\n\tconst existing_value = element.value;\n\telement.defaultValue = value;\n\telement.value = existing_value;\n}\n\n/**\n * @param {Element} element\n * @param {string} attribute\n * @param {string | null} value\n * @param {boolean} [skip_warning]\n */\nexport function set_attribute(element, attribute, value, skip_warning) {\n\t// @ts-expect-error\n\tvar attributes = (element.__attributes ??= {});\n\n\tif (hydrating) {\n\t\tattributes[attribute] = element.getAttribute(attribute);\n\n\t\tif (\n\t\t\tattribute === 'src' ||\n\t\t\tattribute === 'srcset' ||\n\t\t\t(attribute === 'href' && element.nodeName === 'LINK')\n\t\t) {\n\t\t\tif (!skip_warning) {\n\t\t\t\tcheck_src_in_dev_hydration(element, attribute, value ?? '');\n\t\t\t}\n\n\t\t\t// If we reset these attributes, they would result in another network request, which we want to avoid.\n\t\t\t// We assume they are the same between client and server as checking if they are equal is expensive\n\t\t\t// (we can't just compare the strings as they can be different between client and server but result in the\n\t\t\t// same url, so we would need to create hidden anchor elements to compare them)\n\t\t\treturn;\n\t\t}\n\t}\n\n\tif (attributes[attribute] === (attributes[attribute] = value)) return;\n\n\tif (attribute === 'style' && '__styles' in element) {\n\t\t// reset styles to force style: directive to update\n\t\telement.__styles = {};\n\t}\n\n\tif (attribute === 'loading') {\n\t\t// @ts-expect-error\n\t\telement[LOADING_ATTR_SYMBOL] = value;\n\t}\n\n\tif (value == null) {\n\t\telement.removeAttribute(attribute);\n\t} else if (typeof value !== 'string' && get_setters(element).includes(attribute)) {\n\t\t// @ts-ignore\n\t\telement[attribute] = value;\n\t} else {\n\t\telement.setAttribute(attribute, value);\n\t}\n}\n\n/**\n * @param {Element} dom\n * @param {string} attribute\n * @param {string} value\n */\nexport function set_xlink_attribute(dom, attribute, value) {\n\tdom.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\n\n/**\n * @param {HTMLElement} node\n * @param {string} prop\n * @param {any} value\n */\nexport function set_custom_element_data(node, prop, value) {\n\t// We need to ensure that setting custom element props, which can\n\t// invoke lifecycle methods on other custom elements, does not also\n\t// associate those lifecycle methods with the current active reaction\n\t// or effect\n\tvar previous_reaction = active_reaction;\n\tvar previous_effect = active_effect;\n\n\tset_active_reaction(null);\n\tset_active_effect(null);\n\ttry {\n\t\tif (\n\t\t\t// Don't compute setters for custom elements while they aren't registered yet,\n\t\t\t// because during their upgrade/instantiation they might add more setters.\n\t\t\t// Instead, fall back to a simple \"an object, then set as property\" heuristic.\n\t\t\tsetters_cache.has(node.nodeName) ||\n\t\t\t// customElements may not be available in browser extension contexts\n\t\t\t!customElements ||\n\t\t\tcustomElements.get(node.tagName.toLowerCase())\n\t\t\t\t? get_setters(node).includes(prop)\n\t\t\t\t: value && typeof value === 'object'\n\t\t) {\n\t\t\t// @ts-expect-error\n\t\t\tnode[prop] = value;\n\t\t} else {\n\t\t\t// We did getters etc checks already, stringify before passing to set_attribute\n\t\t\t// to ensure it doesn't invoke the same logic again, and potentially populating\n\t\t\t// the setters cache too early.\n\t\t\tset_attribute(node, prop, value == null ? value : String(value));\n\t\t}\n\t} finally {\n\t\tset_active_reaction(previous_reaction);\n\t\tset_active_effect(previous_effect);\n\t}\n}\n\n/**\n * Spreads attributes onto a DOM element, taking into account the currently set attributes\n * @param {Element & ElementCSSInlineStyle} element\n * @param {Record<string, any> | undefined} prev\n * @param {Record<string, any>} next New attributes - this function mutates this object\n * @param {string} [css_hash]\n * @param {boolean} [preserve_attribute_case]\n * @param {boolean} [is_custom_element]\n * @param {boolean} [skip_warning]\n * @returns {Record<string, any>}\n */\nexport function set_attributes(\n\telement,\n\tprev,\n\tnext,\n\tcss_hash,\n\tpreserve_attribute_case = false,\n\tis_custom_element = false,\n\tskip_warning = false\n) {\n\tvar current = prev || {};\n\tvar is_option_element = element.tagName === 'OPTION';\n\n\tfor (var key in prev) {\n\t\tif (!(key in next)) {\n\t\t\tnext[key] = null;\n\t\t}\n\t}\n\n\tif (next.class) {\n\t\tnext.class = clsx(next.class);\n\t}\n\n\tif (css_hash !== undefined) {\n\t\tnext.class = next.class ? next.class + ' ' + css_hash : css_hash;\n\t}\n\n\tvar setters = get_setters(element);\n\n\t// @ts-expect-error\n\tvar attributes = /** @type {Record<string, unknown>} **/ (element.__attributes ??= {});\n\n\t// since key is captured we use const\n\tfor (const key in next) {\n\t\t// let instead of var because referenced in a closure\n\t\tlet value = next[key];\n\n\t\t// Up here because we want to do this for the initial value, too, even if it's undefined,\n\t\t// and this wouldn't be reached in case of undefined because of the equality check below\n\t\tif (is_option_element && key === 'value' && value == null) {\n\t\t\t// The <option> element is a special case because removing the value attribute means\n\t\t\t// the value is set to the text content of the option element, and setting the value\n\t\t\t// to null or undefined means the value is set to the string \"null\" or \"undefined\".\n\t\t\t// To align with how we handle this case in non-spread-scenarios, this logic is needed.\n\t\t\t// There's a super-edge-case bug here that is left in in favor of smaller code size:\n\t\t\t// Because of the \"set missing props to null\" logic above, we can't differentiate\n\t\t\t// between a missing value and an explicitly set value of null or undefined. That means\n\t\t\t// that once set, the value attribute of an <option> element can't be removed. This is\n\t\t\t// a very rare edge case, and removing the attribute altogether isn't possible either\n\t\t\t// for the <option value={undefined}> case, so we're not losing any functionality here.\n\t\t\t// @ts-ignore\n\t\t\telement.value = element.__value = '';\n\t\t\tcurrent[key] = value;\n\t\t\tcontinue;\n\t\t}\n\n\t\tvar prev_value = current[key];\n\t\tif (value === prev_value) continue;\n\n\t\tcurrent[key] = value;\n\n\t\tvar prefix = key[0] + key[1]; // this is faster than key.slice(0, 2)\n\t\tif (prefix === '$$') continue;\n\n\t\tif (prefix === 'on') {\n\t\t\t/** @type {{ capture?: true }} */\n\t\t\tconst opts = {};\n\t\t\tconst event_handle_key = '$$' + key;\n\t\t\tlet event_name = key.slice(2);\n\t\t\tvar delegated = is_delegated(event_name);\n\n\t\t\tif (is_capture_event(event_name)) {\n\t\t\t\tevent_name = event_name.slice(0, -7);\n\t\t\t\topts.capture = true;\n\t\t\t}\n\n\t\t\tif (!delegated && prev_value) {\n\t\t\t\t// Listening to same event but different handler -> our handle function below takes care of this\n\t\t\t\t// If we were to remove and add listeners in this case, it could happen that the event is \"swallowed\"\n\t\t\t\t// (the browser seems to not know yet that a new one exists now) and doesn't reach the handler\n\t\t\t\t// https://github.com/sveltejs/svelte/issues/11903\n\t\t\t\tif (value != null) continue;\n\n\t\t\t\telement.removeEventListener(event_name, current[event_handle_key], opts);\n\t\t\t\tcurrent[event_handle_key] = null;\n\t\t\t}\n\n\t\t\tif (value != null) {\n\t\t\t\tif (!delegated) {\n\t\t\t\t\t/**\n\t\t\t\t\t * @this {any}\n\t\t\t\t\t * @param {Event} evt\n\t\t\t\t\t */\n\t\t\t\t\tfunction handle(evt) {\n\t\t\t\t\t\tcurrent[key].call(this, evt);\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrent[event_handle_key] = create_event(event_name, element, handle, opts);\n\t\t\t\t} else {\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\telement[`__${event_name}`] = value;\n\t\t\t\t\tdelegate([event_name]);\n\t\t\t\t}\n\t\t\t} else if (delegated) {\n\t\t\t\t// @ts-ignore\n\t\t\t\telement[`__${event_name}`] = undefined;\n\t\t\t}\n\t\t} else if (key === 'style' && value != null) {\n\t\t\telement.style.cssText = value + '';\n\t\t} else if (key === 'autofocus') {\n\t\t\tautofocus(/** @type {HTMLElement} */ (element), Boolean(value));\n\t\t} else if (key === '__value' || (key === 'value' && value != null)) {\n\t\t\t// @ts-ignore\n\t\t\telement.value = element[key] = element.__value = value;\n\t\t} else if (key === 'selected' && is_option_element) {\n\t\t\tset_selected(/** @type {HTMLOptionElement} */ (element), value);\n\t\t} else {\n\t\t\tvar name = key;\n\t\t\tif (!preserve_attribute_case) {\n\t\t\t\tname = normalize_attribute(name);\n\t\t\t}\n\n\t\t\tvar is_default = name === 'defaultValue' || name === 'defaultChecked';\n\n\t\t\tif (value == null && !is_custom_element && !is_default) {\n\t\t\t\tattributes[key] = null;\n\n\t\t\t\tif (name === 'value' || name === 'checked') {\n\t\t\t\t\t// removing value/checked also removes defaultValue/defaultChecked  preserve\n\t\t\t\t\tlet input = /** @type {HTMLInputElement} */ (element);\n\n\t\t\t\t\tif (name === 'value') {\n\t\t\t\t\t\tlet prev = input.defaultValue;\n\t\t\t\t\t\tinput.removeAttribute(name);\n\t\t\t\t\t\tinput.defaultValue = prev;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet prev = input.defaultChecked;\n\t\t\t\t\t\tinput.removeAttribute(name);\n\t\t\t\t\t\tinput.defaultChecked = prev;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\telement.removeAttribute(key);\n\t\t\t\t}\n\t\t\t} else if (\n\t\t\t\tis_default ||\n\t\t\t\t(setters.includes(name) && (is_custom_element || typeof value !== 'string'))\n\t\t\t) {\n\t\t\t\t// @ts-ignore\n\t\t\t\telement[name] = value;\n\t\t\t} else if (typeof value !== 'function') {\n\t\t\t\tif (hydrating && (name === 'src' || name === 'href' || name === 'srcset')) {\n\t\t\t\t\tif (!skip_warning) check_src_in_dev_hydration(element, name, value ?? '');\n\t\t\t\t} else {\n\t\t\t\t\tset_attribute(element, name, value);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (key === 'style' && '__styles' in element) {\n\t\t\t// reset styles to force style: directive to update\n\t\t\telement.__styles = {};\n\t\t}\n\t}\n\n\treturn current;\n}\n\n/** @type {Map<string, string[]>} */\nvar setters_cache = new Map();\n\n/** @param {Element} element */\nfunction get_setters(element) {\n\tvar setters = setters_cache.get(element.nodeName);\n\tif (setters) return setters;\n\tsetters_cache.set(element.nodeName, (setters = []));\n\n\tvar descriptors;\n\tvar proto = element; // In the case of custom elements there might be setters on the instance\n\tvar element_proto = Element.prototype;\n\n\t// Stop at Element, from there on there's only unnecessary setters we're not interested in\n\t// Do not use contructor.name here as that's unreliable in some browser environments\n\twhile (element_proto !== proto) {\n\t\tdescriptors = get_descriptors(proto);\n\n\t\tfor (var key in descriptors) {\n\t\t\tif (descriptors[key].set) {\n\t\t\t\tsetters.push(key);\n\t\t\t}\n\t\t}\n\n\t\tproto = get_prototype_of(proto);\n\t}\n\n\treturn setters;\n}\n\n/**\n * @param {any} element\n * @param {string} attribute\n * @param {string} value\n */\nfunction check_src_in_dev_hydration(element, attribute, value) {\n\tif (!DEV) return;\n\tif (attribute === 'srcset' && srcset_url_equal(element, value)) return;\n\tif (src_url_equal(element.getAttribute(attribute) ?? '', value)) return;\n\n\tw.hydration_attribute_changed(\n\t\tattribute,\n\t\telement.outerHTML.replace(element.innerHTML, element.innerHTML && '...'),\n\t\tString(value)\n\t);\n}\n\n/**\n * @param {string} element_src\n * @param {string} url\n * @returns {boolean}\n */\nfunction src_url_equal(element_src, url) {\n\tif (element_src === url) return true;\n\treturn new URL(element_src, document.baseURI).href === new URL(url, document.baseURI).href;\n}\n\n/** @param {string} srcset */\nfunction split_srcset(srcset) {\n\treturn srcset.split(',').map((src) => src.trim().split(' ').filter(Boolean));\n}\n\n/**\n * @param {HTMLSourceElement | HTMLImageElement} element\n * @param {string} srcset\n * @returns {boolean}\n */\nfunction srcset_url_equal(element, srcset) {\n\tvar element_urls = split_srcset(element.srcset);\n\tvar urls = split_srcset(srcset);\n\n\treturn (\n\t\turls.length === element_urls.length &&\n\t\turls.every(\n\t\t\t([url, width], i) =>\n\t\t\t\twidth === element_urls[i][1] &&\n\t\t\t\t// We need to test both ways because Vite will create an a full URL with\n\t\t\t\t// `new URL(asset, import.meta.url).href` for the client when `base: './'`, and the\n\t\t\t\t// relative URLs inside srcset are not automatically resolved to absolute URLs by\n\t\t\t\t// browsers (in contrast to img.src). This means both SSR and DOM code could\n\t\t\t\t// contain relative or absolute URLs.\n\t\t\t\t(src_url_equal(element_urls[i][0], url) || src_url_equal(url, element_urls[i][0]))\n\t\t)\n\t);\n}\n\n/**\n * @param {HTMLImageElement} element\n * @returns {void}\n */\nexport function handle_lazy_img(element) {\n\t// If we're using an image that has a lazy loading attribute, we need to apply\n\t// the loading and src after the img element has been appended to the document.\n\t// Otherwise the lazy behaviour will not work due to our cloneNode heuristic for\n\t// templates.\n\tif (!hydrating && element.loading === 'lazy') {\n\t\tvar src = element.src;\n\t\t// @ts-expect-error\n\t\telement[LOADING_ATTR_SYMBOL] = null;\n\t\telement.loading = 'eager';\n\t\telement.removeAttribute('src');\n\t\trequestAnimationFrame(() => {\n\t\t\t// @ts-expect-error\n\t\t\tif (element[LOADING_ATTR_SYMBOL] !== 'eager') {\n\t\t\t\telement.loading = 'lazy';\n\t\t\t}\n\t\t\telement.src = src;\n\t\t});\n\t}\n}\n","import { hydrating } from '../hydration.js';\n\n/**\n * @param {SVGElement} dom\n * @param {string} value\n * @param {string} [hash]\n * @returns {void}\n */\nexport function set_svg_class(dom, value, hash) {\n\t// @ts-expect-error need to add __className to patched prototype\n\tvar prev_class_name = dom.__className;\n\tvar next_class_name = to_class(value, hash);\n\n\tif (hydrating && dom.getAttribute('class') === next_class_name) {\n\t\t// In case of hydration don't reset the class as it's already correct.\n\t\t// @ts-expect-error need to add __className to patched prototype\n\t\tdom.__className = next_class_name;\n\t} else if (\n\t\tprev_class_name !== next_class_name ||\n\t\t(hydrating && dom.getAttribute('class') !== next_class_name)\n\t) {\n\t\tif (next_class_name === '') {\n\t\t\tdom.removeAttribute('class');\n\t\t} else {\n\t\t\tdom.setAttribute('class', next_class_name);\n\t\t}\n\n\t\t// @ts-expect-error need to add __className to patched prototype\n\t\tdom.__className = next_class_name;\n\t}\n}\n\n/**\n * @param {MathMLElement} dom\n * @param {string} value\n * @param {string} [hash]\n * @returns {void}\n */\nexport function set_mathml_class(dom, value, hash) {\n\t// @ts-expect-error need to add __className to patched prototype\n\tvar prev_class_name = dom.__className;\n\tvar next_class_name = to_class(value, hash);\n\n\tif (hydrating && dom.getAttribute('class') === next_class_name) {\n\t\t// In case of hydration don't reset the class as it's already correct.\n\t\t// @ts-expect-error need to add __className to patched prototype\n\t\tdom.__className = next_class_name;\n\t} else if (\n\t\tprev_class_name !== next_class_name ||\n\t\t(hydrating && dom.getAttribute('class') !== next_class_name)\n\t) {\n\t\tif (next_class_name === '') {\n\t\t\tdom.removeAttribute('class');\n\t\t} else {\n\t\t\tdom.setAttribute('class', next_class_name);\n\t\t}\n\n\t\t// @ts-expect-error need to add __className to patched prototype\n\t\tdom.__className = next_class_name;\n\t}\n}\n\n/**\n * @param {HTMLElement} dom\n * @param {string} value\n * @param {string} [hash]\n * @returns {void}\n */\nexport function set_class(dom, value, hash) {\n\t// @ts-expect-error need to add __className to patched prototype\n\tvar prev_class_name = dom.__className;\n\tvar next_class_name = to_class(value, hash);\n\n\tif (hydrating && dom.className === next_class_name) {\n\t\t// In case of hydration don't reset the class as it's already correct.\n\t\t// @ts-expect-error need to add __className to patched prototype\n\t\tdom.__className = next_class_name;\n\t} else if (\n\t\tprev_class_name !== next_class_name ||\n\t\t(hydrating && dom.className !== next_class_name)\n\t) {\n\t\t// Removing the attribute when the value is only an empty string causes\n\t\t// peformance issues vs simply making the className an empty string. So\n\t\t// we should only remove the class if the the value is nullish.\n\t\tif (value == null && !hash) {\n\t\t\tdom.removeAttribute('class');\n\t\t} else {\n\t\t\tdom.className = next_class_name;\n\t\t}\n\n\t\t// @ts-expect-error need to add __className to patched prototype\n\t\tdom.__className = next_class_name;\n\t}\n}\n\n/**\n * @template V\n * @param {V} value\n * @param {string} [hash]\n * @returns {string | V}\n */\nfunction to_class(value, hash) {\n\treturn (value == null ? '' : value) + (hash ? ' ' + hash : '');\n}\n\n/**\n * @param {Element} dom\n * @param {string} class_name\n * @param {boolean} value\n * @returns {void}\n */\nexport function toggle_class(dom, class_name, value) {\n\tif (value) {\n\t\tif (dom.classList.contains(class_name)) return;\n\t\tdom.classList.add(class_name);\n\t} else {\n\t\tif (!dom.classList.contains(class_name)) return;\n\t\tdom.classList.remove(class_name);\n\t}\n}\n","/**\n * @param {HTMLElement} dom\n * @param {string} key\n * @param {string} value\n * @param {boolean} [important]\n */\nexport function set_style(dom, key, value, important) {\n\t// @ts-expect-error\n\tvar styles = (dom.__styles ??= {});\n\n\tif (styles[key] === value) {\n\t\treturn;\n\t}\n\n\tstyles[key] = value;\n\n\tif (value == null) {\n\t\tdom.style.removeProperty(key);\n\t} else {\n\t\tdom.style.setProperty(key, value, important ? 'important' : '');\n\t}\n}\n","/** @import { Raf } from '#client' */\nimport { noop } from '../shared/utils.js';\n\nimport { BROWSER } from 'esm-env';\n\nconst now = BROWSER ? () => performance.now() : () => Date.now();\n\n/** @type {Raf} */\nexport const raf = {\n\t// don't access requestAnimationFrame eagerly outside method\n\t// this allows basic testing of user code without JSDOM\n\t// bunder will eval and remove ternary when the user's app is built\n\ttick: /** @param {any} _ */ (_) => (BROWSER ? requestAnimationFrame : noop)(_),\n\tnow: () => now(),\n\ttasks: new Set()\n};\n","/** @import { TaskCallback, Task, TaskEntry } from '#client' */\nimport { raf } from './timing.js';\n\n// TODO move this into timing.js where it probably belongs\n\n/**\n * @returns {void}\n */\nfunction run_tasks() {\n\t// use `raf.now()` instead of the `requestAnimationFrame` callback argument, because\n\t// otherwise things can get wonky https://github.com/sveltejs/svelte/pull/14541\n\tconst now = raf.now();\n\n\traf.tasks.forEach((task) => {\n\t\tif (!task.c(now)) {\n\t\t\traf.tasks.delete(task);\n\t\t\ttask.f();\n\t\t}\n\t});\n\n\tif (raf.tasks.size !== 0) {\n\t\traf.tick(run_tasks);\n\t}\n}\n\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n * @param {TaskCallback} callback\n * @returns {Task}\n */\nexport function loop(callback) {\n\t/** @type {TaskEntry} */\n\tlet task;\n\n\tif (raf.tasks.size === 0) {\n\t\traf.tick(run_tasks);\n\t}\n\n\treturn {\n\t\tpromise: new Promise((fulfill) => {\n\t\t\traf.tasks.add((task = { c: callback, f: fulfill }));\n\t\t}),\n\t\tabort() {\n\t\t\traf.tasks.delete(task);\n\t\t}\n\t};\n}\n","/** @import { AnimateFn, Animation, AnimationConfig, EachItem, Effect, TransitionFn, TransitionManager } from '#client' */\nimport { noop, is_function } from '../../../shared/utils.js';\nimport { effect } from '../../reactivity/effects.js';\nimport {\n\tactive_effect,\n\tactive_reaction,\n\tset_active_effect,\n\tset_active_reaction,\n\tuntrack\n} from '../../runtime.js';\nimport { loop } from '../../loop.js';\nimport { should_intro } from '../../render.js';\nimport { current_each_item } from '../blocks/each.js';\nimport { TRANSITION_GLOBAL, TRANSITION_IN, TRANSITION_OUT } from '../../../../constants.js';\nimport { BLOCK_EFFECT, EFFECT_RAN, EFFECT_TRANSPARENT } from '../../constants.js';\nimport { queue_micro_task } from '../task.js';\n\n/**\n * @param {Element} element\n * @param {'introstart' | 'introend' | 'outrostart' | 'outroend'} type\n * @returns {void}\n */\nfunction dispatch_event(element, type) {\n\telement.dispatchEvent(new CustomEvent(type));\n}\n\n/**\n * Converts a property to the camel-case format expected by Element.animate(), KeyframeEffect(), and KeyframeEffect.setKeyframes().\n * @param {string} style\n * @returns {string}\n */\nfunction css_property_to_camelcase(style) {\n\t// in compliance with spec\n\tif (style === 'float') return 'cssFloat';\n\tif (style === 'offset') return 'cssOffset';\n\n\t// do not rename custom @properties\n\tif (style.startsWith('--')) return style;\n\n\tconst parts = style.split('-');\n\tif (parts.length === 1) return parts[0];\n\treturn (\n\t\tparts[0] +\n\t\tparts\n\t\t\t.slice(1)\n\t\t\t.map(/** @param {any} word */ (word) => word[0].toUpperCase() + word.slice(1))\n\t\t\t.join('')\n\t);\n}\n\n/**\n * @param {string} css\n * @returns {Keyframe}\n */\nfunction css_to_keyframe(css) {\n\t/** @type {Keyframe} */\n\tconst keyframe = {};\n\tconst parts = css.split(';');\n\tfor (const part of parts) {\n\t\tconst [property, value] = part.split(':');\n\t\tif (!property || value === undefined) break;\n\n\t\tconst formatted_property = css_property_to_camelcase(property.trim());\n\t\tkeyframe[formatted_property] = value.trim();\n\t}\n\treturn keyframe;\n}\n\n/** @param {number} t */\nconst linear = (t) => t;\n\n/**\n * Called inside keyed `{#each ...}` blocks (as `$.animation(...)`). This creates an animation manager\n * and attaches it to the block, so that moves can be animated following reconciliation.\n * @template P\n * @param {Element} element\n * @param {() => AnimateFn<P | undefined>} get_fn\n * @param {(() => P) | null} get_params\n */\nexport function animation(element, get_fn, get_params) {\n\tvar item = /** @type {EachItem} */ (current_each_item);\n\n\t/** @type {DOMRect} */\n\tvar from;\n\n\t/** @type {DOMRect} */\n\tvar to;\n\n\t/** @type {Animation | undefined} */\n\tvar animation;\n\n\t/** @type {null | { position: string, width: string, height: string, transform: string }} */\n\tvar original_styles = null;\n\n\titem.a ??= {\n\t\telement,\n\t\tmeasure() {\n\t\t\tfrom = this.element.getBoundingClientRect();\n\t\t},\n\t\tapply() {\n\t\t\tanimation?.abort();\n\n\t\t\tto = this.element.getBoundingClientRect();\n\n\t\t\tif (\n\t\t\t\tfrom.left !== to.left ||\n\t\t\t\tfrom.right !== to.right ||\n\t\t\t\tfrom.top !== to.top ||\n\t\t\t\tfrom.bottom !== to.bottom\n\t\t\t) {\n\t\t\t\tconst options = get_fn()(this.element, { from, to }, get_params?.());\n\n\t\t\t\tanimation = animate(this.element, options, undefined, 1, () => {\n\t\t\t\t\tanimation?.abort();\n\t\t\t\t\tanimation = undefined;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tfix() {\n\t\t\t// If an animation is already running, transforming the element is likely to fail,\n\t\t\t// because the styles applied by the animation take precedence. In the case of crossfade,\n\t\t\t// that means the `translate(...)` of the crossfade transition overrules the `translate(...)`\n\t\t\t// we would apply below, leading to the element jumping somewhere to the top left.\n\t\t\tif (element.getAnimations().length) return;\n\n\t\t\t// It's important to destructure these to get fixed values - the object itself has getters,\n\t\t\t// and changing the style to 'absolute' can for example influence the width.\n\t\t\tvar { position, width, height } = getComputedStyle(element);\n\n\t\t\tif (position !== 'absolute' && position !== 'fixed') {\n\t\t\t\tvar style = /** @type {HTMLElement | SVGElement} */ (element).style;\n\n\t\t\t\toriginal_styles = {\n\t\t\t\t\tposition: style.position,\n\t\t\t\t\twidth: style.width,\n\t\t\t\t\theight: style.height,\n\t\t\t\t\ttransform: style.transform\n\t\t\t\t};\n\n\t\t\t\tstyle.position = 'absolute';\n\t\t\t\tstyle.width = width;\n\t\t\t\tstyle.height = height;\n\t\t\t\tvar to = element.getBoundingClientRect();\n\n\t\t\t\tif (from.left !== to.left || from.top !== to.top) {\n\t\t\t\t\tvar transform = `translate(${from.left - to.left}px, ${from.top - to.top}px)`;\n\t\t\t\t\tstyle.transform = style.transform ? `${style.transform} ${transform}` : transform;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tunfix() {\n\t\t\tif (original_styles) {\n\t\t\t\tvar style = /** @type {HTMLElement | SVGElement} */ (element).style;\n\n\t\t\t\tstyle.position = original_styles.position;\n\t\t\t\tstyle.width = original_styles.width;\n\t\t\t\tstyle.height = original_styles.height;\n\t\t\t\tstyle.transform = original_styles.transform;\n\t\t\t}\n\t\t}\n\t};\n\n\t// in the case of a `<svelte:element>`, it's possible for `$.animation(...)` to be called\n\t// when an animation manager already exists, if the tag changes. in that case, we need to\n\t// swap out the element rather than creating a new manager, in case it happened at the same\n\t// moment as a reconciliation\n\titem.a.element = element;\n}\n\n/**\n * Called inside block effects as `$.transition(...)`. This creates a transition manager and\n * attaches it to the current effect  later, inside `pause_effect` and `resume_effect`, we\n * use this to create `intro` and `outro` transitions.\n * @template P\n * @param {number} flags\n * @param {HTMLElement} element\n * @param {() => TransitionFn<P | undefined>} get_fn\n * @param {(() => P) | null} get_params\n * @returns {void}\n */\nexport function transition(flags, element, get_fn, get_params) {\n\tvar is_intro = (flags & TRANSITION_IN) !== 0;\n\tvar is_outro = (flags & TRANSITION_OUT) !== 0;\n\tvar is_both = is_intro && is_outro;\n\tvar is_global = (flags & TRANSITION_GLOBAL) !== 0;\n\n\t/** @type {'in' | 'out' | 'both'} */\n\tvar direction = is_both ? 'both' : is_intro ? 'in' : 'out';\n\n\t/** @type {AnimationConfig | ((opts: { direction: 'in' | 'out' }) => AnimationConfig) | undefined} */\n\tvar current_options;\n\n\tvar inert = element.inert;\n\n\t/**\n\t * The default overflow style, stashed so we can revert changes during the transition\n\t * that are necessary to work around a Safari <18 bug\n\t * TODO 6.0 remove this, if older versions of Safari have died out enough\n\t */\n\tvar overflow = element.style.overflow;\n\n\t/** @type {Animation | undefined} */\n\tvar intro;\n\n\t/** @type {Animation | undefined} */\n\tvar outro;\n\n\tfunction get_options() {\n\t\tvar previous_reaction = active_reaction;\n\t\tvar previous_effect = active_effect;\n\t\tset_active_reaction(null);\n\t\tset_active_effect(null);\n\t\ttry {\n\t\t\t// If a transition is still ongoing, we use the existing options rather than generating\n\t\t\t// new ones. This ensures that reversible transitions reverse smoothly, rather than\n\t\t\t// jumping to a new spot because (for example) a different `duration` was used\n\t\t\treturn (current_options ??= get_fn()(element, get_params?.() ?? /** @type {P} */ ({}), {\n\t\t\t\tdirection\n\t\t\t}));\n\t\t} finally {\n\t\t\tset_active_reaction(previous_reaction);\n\t\t\tset_active_effect(previous_effect);\n\t\t}\n\t}\n\n\t/** @type {TransitionManager} */\n\tvar transition = {\n\t\tis_global,\n\t\tin() {\n\t\t\telement.inert = inert;\n\n\t\t\tif (!is_intro) {\n\t\t\t\toutro?.abort();\n\t\t\t\toutro?.reset?.();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!is_outro) {\n\t\t\t\t// if we intro then outro then intro again, we want to abort the first intro,\n\t\t\t\t// if it's not a bidirectional transition\n\t\t\t\tintro?.abort();\n\t\t\t}\n\n\t\t\tdispatch_event(element, 'introstart');\n\n\t\t\tintro = animate(element, get_options(), outro, 1, () => {\n\t\t\t\tdispatch_event(element, 'introend');\n\n\t\t\t\t// Ensure we cancel the animation to prevent leaking\n\t\t\t\tintro?.abort();\n\t\t\t\tintro = current_options = undefined;\n\n\t\t\t\telement.style.overflow = overflow;\n\t\t\t});\n\t\t},\n\t\tout(fn) {\n\t\t\tif (!is_outro) {\n\t\t\t\tfn?.();\n\t\t\t\tcurrent_options = undefined;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.inert = true;\n\n\t\t\tdispatch_event(element, 'outrostart');\n\n\t\t\toutro = animate(element, get_options(), intro, 0, () => {\n\t\t\t\tdispatch_event(element, 'outroend');\n\t\t\t\tfn?.();\n\t\t\t});\n\t\t},\n\t\tstop: () => {\n\t\t\tintro?.abort();\n\t\t\toutro?.abort();\n\t\t}\n\t};\n\n\tvar e = /** @type {Effect} */ (active_effect);\n\n\t(e.transitions ??= []).push(transition);\n\n\t// if this is a local transition, we only want to run it if the parent (branch) effect's\n\t// parent (block) effect is where the state change happened. we can determine that by\n\t// looking at whether the block effect is currently initializing\n\tif (is_intro && should_intro) {\n\t\tvar run = is_global;\n\n\t\tif (!run) {\n\t\t\tvar block = /** @type {Effect | null} */ (e.parent);\n\n\t\t\t// skip over transparent blocks (e.g. snippets, else-if blocks)\n\t\t\twhile (block && (block.f & EFFECT_TRANSPARENT) !== 0) {\n\t\t\t\twhile ((block = block.parent)) {\n\t\t\t\t\tif ((block.f & BLOCK_EFFECT) !== 0) break;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trun = !block || (block.f & EFFECT_RAN) !== 0;\n\t\t}\n\n\t\tif (run) {\n\t\t\teffect(() => {\n\t\t\t\tuntrack(() => transition.in());\n\t\t\t});\n\t\t}\n\t}\n}\n\n/**\n * Animates an element, according to the provided configuration\n * @param {Element} element\n * @param {AnimationConfig | ((opts: { direction: 'in' | 'out' }) => AnimationConfig)} options\n * @param {Animation | undefined} counterpart The corresponding intro/outro to this outro/intro\n * @param {number} t2 The target `t` value  `1` for intro, `0` for outro\n * @param {(() => void)} on_finish Called after successfully completing the animation\n * @returns {Animation}\n */\nfunction animate(element, options, counterpart, t2, on_finish) {\n\tvar is_intro = t2 === 1;\n\n\tif (is_function(options)) {\n\t\t// In the case of a deferred transition (such as `crossfade`), `option` will be\n\t\t// a function rather than an `AnimationConfig`. We need to call this function\n\t\t// once the DOM has been updated...\n\t\t/** @type {Animation} */\n\t\tvar a;\n\t\tvar aborted = false;\n\n\t\tqueue_micro_task(() => {\n\t\t\tif (aborted) return;\n\t\t\tvar o = options({ direction: is_intro ? 'in' : 'out' });\n\t\t\ta = animate(element, o, counterpart, t2, on_finish);\n\t\t});\n\n\t\t// ...but we want to do so without using `async`/`await` everywhere, so\n\t\t// we return a facade that allows everything to remain synchronous\n\t\treturn {\n\t\t\tabort: () => {\n\t\t\t\taborted = true;\n\t\t\t\ta?.abort();\n\t\t\t},\n\t\t\tdeactivate: () => a.deactivate(),\n\t\t\treset: () => a.reset(),\n\t\t\tt: () => a.t()\n\t\t};\n\t}\n\n\tcounterpart?.deactivate();\n\n\tif (!options?.duration) {\n\t\ton_finish();\n\n\t\treturn {\n\t\t\tabort: noop,\n\t\t\tdeactivate: noop,\n\t\t\treset: noop,\n\t\t\tt: () => t2\n\t\t};\n\t}\n\n\tconst { delay = 0, css, tick, easing = linear } = options;\n\n\tvar keyframes = [];\n\n\tif (is_intro && counterpart === undefined) {\n\t\tif (tick) {\n\t\t\ttick(0, 1); // TODO put in nested effect, to avoid interleaved reads/writes?\n\t\t}\n\n\t\tif (css) {\n\t\t\tvar styles = css_to_keyframe(css(0, 1));\n\t\t\tkeyframes.push(styles, styles);\n\t\t}\n\t}\n\n\tvar get_t = () => 1 - t2;\n\n\t// create a dummy animation that lasts as long as the delay (but with whatever devtools\n\t// multiplier is in effect). in the common case that it is `0`, we keep it anyway so that\n\t// the CSS keyframes aren't created until the DOM is updated\n\tvar animation = element.animate(keyframes, { duration: delay });\n\n\tanimation.onfinish = () => {\n\t\t// for bidirectional transitions, we start from the current position,\n\t\t// rather than doing a full intro/outro\n\t\tvar t1 = counterpart?.t() ?? 1 - t2;\n\t\tcounterpart?.abort();\n\n\t\tvar delta = t2 - t1;\n\t\tvar duration = /** @type {number} */ (options.duration) * Math.abs(delta);\n\t\tvar keyframes = [];\n\n\t\tif (duration > 0) {\n\t\t\t/**\n\t\t\t * Whether or not the CSS includes `overflow: hidden`, in which case we need to\n\t\t\t * add it as an inline style to work around a Safari <18 bug\n\t\t\t * TODO 6.0 remove this, if possible\n\t\t\t */\n\t\t\tvar needs_overflow_hidden = false;\n\n\t\t\tif (css) {\n\t\t\t\tvar n = Math.ceil(duration / (1000 / 60)); // `n` must be an integer, or we risk missing the `t2` value\n\n\t\t\t\tfor (var i = 0; i <= n; i += 1) {\n\t\t\t\t\tvar t = t1 + delta * easing(i / n);\n\t\t\t\t\tvar styles = css_to_keyframe(css(t, 1 - t));\n\t\t\t\t\tkeyframes.push(styles);\n\n\t\t\t\t\tneeds_overflow_hidden ||= styles.overflow === 'hidden';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (needs_overflow_hidden) {\n\t\t\t\t/** @type {HTMLElement} */ (element).style.overflow = 'hidden';\n\t\t\t}\n\n\t\t\tget_t = () => {\n\t\t\t\tvar time = /** @type {number} */ (\n\t\t\t\t\t/** @type {globalThis.Animation} */ (animation).currentTime\n\t\t\t\t);\n\n\t\t\t\treturn t1 + delta * easing(time / duration);\n\t\t\t};\n\n\t\t\tif (tick) {\n\t\t\t\tloop(() => {\n\t\t\t\t\tif (animation.playState !== 'running') return false;\n\n\t\t\t\t\tvar t = get_t();\n\t\t\t\t\ttick(t, 1 - t);\n\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tanimation = element.animate(keyframes, { duration, fill: 'forwards' });\n\n\t\tanimation.onfinish = () => {\n\t\t\tget_t = () => t2;\n\t\t\ttick?.(t2, 1 - t2);\n\t\t\ton_finish();\n\t\t};\n\t};\n\n\treturn {\n\t\tabort: () => {\n\t\t\tif (animation) {\n\t\t\t\tanimation.cancel();\n\t\t\t\t// This prevents memory leaks in Chromium\n\t\t\t\tanimation.effect = null;\n\t\t\t\t// This prevents onfinish to be launched after cancel(),\n\t\t\t\t// which can happen in some rare cases\n\t\t\t\t// see https://github.com/sveltejs/svelte/issues/13681\n\t\t\t\tanimation.onfinish = noop;\n\t\t\t}\n\t\t},\n\t\tdeactivate: () => {\n\t\t\ton_finish = noop;\n\t\t},\n\t\treset: () => {\n\t\t\tif (t2 === 0) {\n\t\t\t\ttick?.(1, 0);\n\t\t\t}\n\t\t},\n\t\tt: () => get_t()\n\t};\n}\n","import { DEV } from 'esm-env';\nimport { render_effect, teardown } from '../../../reactivity/effects.js';\nimport { listen_to_event_and_reset_event } from './shared.js';\nimport * as e from '../../../errors.js';\nimport { is } from '../../../proxy.js';\nimport { queue_micro_task } from '../../task.js';\nimport { hydrating } from '../../hydration.js';\nimport { is_runes, untrack } from '../../../runtime.js';\n\n/**\n * @param {HTMLInputElement} input\n * @param {() => unknown} get\n * @param {(value: unknown) => void} set\n * @returns {void}\n */\nexport function bind_value(input, get, set = get) {\n\tvar runes = is_runes();\n\n\tlisten_to_event_and_reset_event(input, 'input', (is_reset) => {\n\t\tif (DEV && input.type === 'checkbox') {\n\t\t\t// TODO should this happen in prod too?\n\t\t\te.bind_invalid_checkbox_value();\n\t\t}\n\n\t\t/** @type {any} */\n\t\tvar value = is_reset ? input.defaultValue : input.value;\n\t\tvalue = is_numberlike_input(input) ? to_number(value) : value;\n\t\tset(value);\n\n\t\t// In runes mode, respect any validation in accessors (doesn't apply in legacy mode,\n\t\t// because we use mutable state which ensures the render effect always runs)\n\t\tif (runes && value !== (value = get())) {\n\t\t\tvar start = input.selectionStart;\n\t\t\tvar end = input.selectionEnd;\n\n\t\t\t// the value is coerced on assignment\n\t\t\tinput.value = value ?? '';\n\n\t\t\t// Restore selection\n\t\t\tif (end !== null) {\n\t\t\t\tinput.selectionStart = start;\n\t\t\t\tinput.selectionEnd = Math.min(end, input.value.length);\n\t\t\t}\n\t\t}\n\t});\n\n\tif (\n\t\t// If we are hydrating and the value has since changed,\n\t\t// then use the updated value from the input instead.\n\t\t(hydrating && input.defaultValue !== input.value) ||\n\t\t// If defaultValue is set, then value == defaultValue\n\t\t// TODO Svelte 6: remove input.value check and set to empty string?\n\t\t(untrack(get) == null && input.value)\n\t) {\n\t\tset(is_numberlike_input(input) ? to_number(input.value) : input.value);\n\t}\n\n\trender_effect(() => {\n\t\tif (DEV && input.type === 'checkbox') {\n\t\t\t// TODO should this happen in prod too?\n\t\t\te.bind_invalid_checkbox_value();\n\t\t}\n\n\t\tvar value = get();\n\n\t\tif (is_numberlike_input(input) && value === to_number(input.value)) {\n\t\t\t// handles 0 vs 00 case (see https://github.com/sveltejs/svelte/issues/9959)\n\t\t\treturn;\n\t\t}\n\n\t\tif (input.type === 'date' && !value && !input.value) {\n\t\t\t// Handles the case where a temporarily invalid date is set (while typing, for example with a leading 0 for the day)\n\t\t\t// and prevents this state from clearing the other parts of the date input (see https://github.com/sveltejs/svelte/issues/7897)\n\t\t\treturn;\n\t\t}\n\n\t\t// don't set the value of the input if it's the same to allow\n\t\t// minlength to work properly\n\t\tif (value !== input.value) {\n\t\t\t// @ts-expect-error the value is coerced on assignment\n\t\t\tinput.value = value ?? '';\n\t\t}\n\t});\n}\n\n/** @type {Set<HTMLInputElement[]>} */\nconst pending = new Set();\n\n/**\n * @param {HTMLInputElement[]} inputs\n * @param {null | [number]} group_index\n * @param {HTMLInputElement} input\n * @param {() => unknown} get\n * @param {(value: unknown) => void} set\n * @returns {void}\n */\nexport function bind_group(inputs, group_index, input, get, set = get) {\n\tvar is_checkbox = input.getAttribute('type') === 'checkbox';\n\tvar binding_group = inputs;\n\n\t// needs to be let or related code isn't treeshaken out if it's always false\n\tlet hydration_mismatch = false;\n\n\tif (group_index !== null) {\n\t\tfor (var index of group_index) {\n\t\t\t// @ts-expect-error\n\t\t\tbinding_group = binding_group[index] ??= [];\n\t\t}\n\t}\n\n\tbinding_group.push(input);\n\n\tlisten_to_event_and_reset_event(\n\t\tinput,\n\t\t'change',\n\t\t() => {\n\t\t\t// @ts-ignore\n\t\t\tvar value = input.__value;\n\n\t\t\tif (is_checkbox) {\n\t\t\t\tvalue = get_binding_group_value(binding_group, value, input.checked);\n\t\t\t}\n\n\t\t\tset(value);\n\t\t},\n\t\t// TODO better default value handling\n\t\t() => set(is_checkbox ? [] : null)\n\t);\n\n\trender_effect(() => {\n\t\tvar value = get();\n\n\t\t// If we are hydrating and the value has since changed, then use the update value\n\t\t// from the input instead.\n\t\tif (hydrating && input.defaultChecked !== input.checked) {\n\t\t\thydration_mismatch = true;\n\t\t\treturn;\n\t\t}\n\n\t\tif (is_checkbox) {\n\t\t\tvalue = value || [];\n\t\t\t// @ts-ignore\n\t\t\tinput.checked = value.includes(input.__value);\n\t\t} else {\n\t\t\t// @ts-ignore\n\t\t\tinput.checked = is(input.__value, value);\n\t\t}\n\t});\n\n\tteardown(() => {\n\t\tvar index = binding_group.indexOf(input);\n\n\t\tif (index !== -1) {\n\t\t\tbinding_group.splice(index, 1);\n\t\t}\n\t});\n\n\tif (!pending.has(binding_group)) {\n\t\tpending.add(binding_group);\n\n\t\tqueue_micro_task(() => {\n\t\t\t// necessary to maintain binding group order in all insertion scenarios\n\t\t\tbinding_group.sort((a, b) => (a.compareDocumentPosition(b) === 4 ? -1 : 1));\n\t\t\tpending.delete(binding_group);\n\t\t});\n\t}\n\n\tqueue_micro_task(() => {\n\t\tif (hydration_mismatch) {\n\t\t\tvar value;\n\n\t\t\tif (is_checkbox) {\n\t\t\t\tvalue = get_binding_group_value(binding_group, value, input.checked);\n\t\t\t} else {\n\t\t\t\tvar hydration_input = binding_group.find((input) => input.checked);\n\t\t\t\t// @ts-ignore\n\t\t\t\tvalue = hydration_input?.__value;\n\t\t\t}\n\n\t\t\tset(value);\n\t\t}\n\t});\n}\n\n/**\n * @param {HTMLInputElement} input\n * @param {() => unknown} get\n * @param {(value: unknown) => void} set\n * @returns {void}\n */\nexport function bind_checked(input, get, set = get) {\n\tlisten_to_event_and_reset_event(input, 'change', (is_reset) => {\n\t\tvar value = is_reset ? input.defaultChecked : input.checked;\n\t\tset(value);\n\t});\n\n\tif (\n\t\t// If we are hydrating and the value has since changed,\n\t\t// then use the update value from the input instead.\n\t\t(hydrating && input.defaultChecked !== input.checked) ||\n\t\t// If defaultChecked is set, then checked == defaultChecked\n\t\tuntrack(get) == null\n\t) {\n\t\tset(input.checked);\n\t}\n\n\trender_effect(() => {\n\t\tvar value = get();\n\t\tinput.checked = Boolean(value);\n\t});\n}\n\n/**\n * @template V\n * @param {Array<HTMLInputElement>} group\n * @param {V} __value\n * @param {boolean} checked\n * @returns {V[]}\n */\nfunction get_binding_group_value(group, __value, checked) {\n\tvar value = new Set();\n\n\tfor (var i = 0; i < group.length; i += 1) {\n\t\tif (group[i].checked) {\n\t\t\t// @ts-ignore\n\t\t\tvalue.add(group[i].__value);\n\t\t}\n\t}\n\n\tif (!checked) {\n\t\tvalue.delete(__value);\n\t}\n\n\treturn Array.from(value);\n}\n\n/**\n * @param {HTMLInputElement} input\n */\nfunction is_numberlike_input(input) {\n\tvar type = input.type;\n\treturn type === 'number' || type === 'range';\n}\n\n/**\n * @param {string} value\n */\nfunction to_number(value) {\n\treturn value === '' ? null : +value;\n}\n\n/**\n * @param {HTMLInputElement} input\n * @param {() => FileList | null} get\n * @param {(value: FileList | null) => void} set\n */\nexport function bind_files(input, get, set = get) {\n\tlisten_to_event_and_reset_event(input, 'change', () => {\n\t\tset(input.files);\n\t});\n\n\trender_effect(() => {\n\t\tinput.files = get();\n\t});\n}\n","import { effect } from '../../../reactivity/effects.js';\nimport { listen_to_event_and_reset_event } from './shared.js';\nimport { untrack } from '../../../runtime.js';\nimport { is } from '../../../proxy.js';\n\n/**\n * Selects the correct option(s) (depending on whether this is a multiple select)\n * @template V\n * @param {HTMLSelectElement} select\n * @param {V} value\n * @param {boolean} [mounting]\n */\nexport function select_option(select, value, mounting) {\n\tif (select.multiple) {\n\t\treturn select_options(select, value);\n\t}\n\n\tfor (var option of select.options) {\n\t\tvar option_value = get_option_value(option);\n\t\tif (is(option_value, value)) {\n\t\t\toption.selected = true;\n\t\t\treturn;\n\t\t}\n\t}\n\n\tif (!mounting || value !== undefined) {\n\t\tselect.selectedIndex = -1; // no option should be selected\n\t}\n}\n\n/**\n * Selects the correct option(s) if `value` is given,\n * and then sets up a mutation observer to sync the\n * current selection to the dom when it changes. Such\n * changes could for example occur when options are\n * inside an `#each` block.\n * @template V\n * @param {HTMLSelectElement} select\n * @param {() => V} [get_value]\n */\nexport function init_select(select, get_value) {\n\tlet mounting = true;\n\teffect(() => {\n\t\tif (get_value) {\n\t\t\tselect_option(select, untrack(get_value), mounting);\n\t\t}\n\t\tmounting = false;\n\n\t\tvar observer = new MutationObserver(() => {\n\t\t\t// @ts-ignore\n\t\t\tvar value = select.__value;\n\t\t\tselect_option(select, value);\n\t\t\t// Deliberately don't update the potential binding value,\n\t\t\t// the model should be preserved unless explicitly changed\n\t\t});\n\n\t\tobserver.observe(select, {\n\t\t\t// Listen to option element changes\n\t\t\tchildList: true,\n\t\t\tsubtree: true, // because of <optgroup>\n\t\t\t// Listen to option element value attribute changes\n\t\t\t// (doesn't get notified of select value changes,\n\t\t\t// because that property is not reflected as an attribute)\n\t\t\tattributes: true,\n\t\t\tattributeFilter: ['value']\n\t\t});\n\n\t\treturn () => {\n\t\t\tobserver.disconnect();\n\t\t};\n\t});\n}\n\n/**\n * @param {HTMLSelectElement} select\n * @param {() => unknown} get\n * @param {(value: unknown) => void} set\n * @returns {void}\n */\nexport function bind_select_value(select, get, set = get) {\n\tvar mounting = true;\n\n\tlisten_to_event_and_reset_event(select, 'change', (is_reset) => {\n\t\tvar query = is_reset ? '[selected]' : ':checked';\n\t\t/** @type {unknown} */\n\t\tvar value;\n\n\t\tif (select.multiple) {\n\t\t\tvalue = [].map.call(select.querySelectorAll(query), get_option_value);\n\t\t} else {\n\t\t\t/** @type {HTMLOptionElement | null} */\n\t\t\tvar selected_option =\n\t\t\t\tselect.querySelector(query) ??\n\t\t\t\t// will fall back to first non-disabled option if no option is selected\n\t\t\t\tselect.querySelector('option:not([disabled])');\n\t\t\tvalue = selected_option && get_option_value(selected_option);\n\t\t}\n\n\t\tset(value);\n\t});\n\n\t// Needs to be an effect, not a render_effect, so that in case of each loops the logic runs after the each block has updated\n\teffect(() => {\n\t\tvar value = get();\n\t\tselect_option(select, value, mounting);\n\n\t\t// Mounting and value undefined -> take selection from dom\n\t\tif (mounting && value === undefined) {\n\t\t\t/** @type {HTMLOptionElement | null} */\n\t\t\tvar selected_option = select.querySelector(':checked');\n\t\t\tif (selected_option !== null) {\n\t\t\t\tvalue = get_option_value(selected_option);\n\t\t\t\tset(value);\n\t\t\t}\n\t\t}\n\n\t\t// @ts-ignore\n\t\tselect.__value = value;\n\t\tmounting = false;\n\t});\n\n\t// don't pass get_value, we already initialize it in the effect above\n\tinit_select(select);\n}\n\n/**\n * @template V\n * @param {HTMLSelectElement} select\n * @param {V} value\n */\nfunction select_options(select, value) {\n\tfor (var option of select.options) {\n\t\t// @ts-ignore\n\t\toption.selected = ~value.indexOf(get_option_value(option));\n\t}\n}\n\n/** @param {HTMLOptionElement} option */\nfunction get_option_value(option) {\n\t// __value only exists if the <option> has a value attribute\n\tif ('__value' in option) {\n\t\treturn option.__value;\n\t} else {\n\t\treturn option.value;\n\t}\n}\n","import { STATE_SYMBOL } from '../../../constants.js';\nimport { effect, render_effect } from '../../../reactivity/effects.js';\nimport { untrack } from '../../../runtime.js';\nimport { queue_micro_task } from '../../task.js';\n\n/**\n * @param {any} bound_value\n * @param {Element} element_or_component\n * @returns {boolean}\n */\nfunction is_bound_this(bound_value, element_or_component) {\n\treturn (\n\t\tbound_value === element_or_component || bound_value?.[STATE_SYMBOL] === element_or_component\n\t);\n}\n\n/**\n * @param {any} element_or_component\n * @param {(value: unknown, ...parts: unknown[]) => void} update\n * @param {(...parts: unknown[]) => unknown} get_value\n * @param {() => unknown[]} [get_parts] Set if the this binding is used inside an each block,\n * \t\t\t\t\t\t\t\t\t\treturns all the parts of the each block context that are used in the expression\n * @returns {void}\n */\nexport function bind_this(element_or_component = {}, update, get_value, get_parts) {\n\teffect(() => {\n\t\t/** @type {unknown[]} */\n\t\tvar old_parts;\n\n\t\t/** @type {unknown[]} */\n\t\tvar parts;\n\n\t\trender_effect(() => {\n\t\t\told_parts = parts;\n\t\t\t// We only track changes to the parts, not the value itself to avoid unnecessary reruns.\n\t\t\tparts = get_parts?.() || [];\n\n\t\t\tuntrack(() => {\n\t\t\t\tif (element_or_component !== get_value(...parts)) {\n\t\t\t\t\tupdate(element_or_component, ...parts);\n\t\t\t\t\t// If this is an effect rerun (cause: each block context changes), then nullfiy the binding at\n\t\t\t\t\t// the previous position if it isn't already taken over by a different effect.\n\t\t\t\t\tif (old_parts && is_bound_this(get_value(...old_parts), element_or_component)) {\n\t\t\t\t\t\tupdate(null, ...old_parts);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\treturn () => {\n\t\t\t// We cannot use effects in the teardown phase, we we use a microtask instead.\n\t\t\tqueue_micro_task(() => {\n\t\t\t\tif (parts && is_bound_this(get_value(...parts), element_or_component)) {\n\t\t\t\t\tupdate(null, ...parts);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t});\n\n\treturn element_or_component;\n}\n","import { render_effect, teardown } from '../../../reactivity/effects.js';\nimport { listen } from './shared.js';\n\n/**\n * @param {'innerHTML' | 'textContent' | 'innerText'} property\n * @param {HTMLElement} element\n * @param {() => unknown} get\n * @param {(value: unknown) => void} set\n * @returns {void}\n */\nexport function bind_content_editable(property, element, get, set = get) {\n\telement.addEventListener('input', () => {\n\t\t// @ts-ignore\n\t\tset(element[property]);\n\t});\n\n\trender_effect(() => {\n\t\tvar value = get();\n\n\t\tif (element[property] !== value) {\n\t\t\tif (value == null) {\n\t\t\t\t// @ts-ignore\n\t\t\t\tvar non_null_value = element[property];\n\t\t\t\tset(non_null_value);\n\t\t\t} else {\n\t\t\t\t// @ts-ignore\n\t\t\t\telement[property] = value + '';\n\t\t\t}\n\t\t}\n\t});\n}\n\n/**\n * @param {string} property\n * @param {string} event_name\n * @param {Element} element\n * @param {(value: unknown) => void} set\n * @param {() => unknown} [get]\n * @returns {void}\n */\nexport function bind_property(property, event_name, element, set, get) {\n\tvar handler = () => {\n\t\t// @ts-ignore\n\t\tset(element[property]);\n\t};\n\n\telement.addEventListener(event_name, handler);\n\n\tif (get) {\n\t\trender_effect(() => {\n\t\t\t// @ts-ignore\n\t\t\telement[property] = get();\n\t\t});\n\t} else {\n\t\thandler();\n\t}\n\n\t// @ts-ignore\n\tif (element === document.body || element === window || element === document) {\n\t\tteardown(() => {\n\t\t\telement.removeEventListener(event_name, handler);\n\t\t});\n\t}\n}\n\n/**\n * @param {HTMLElement} element\n * @param {(value: unknown) => void} set\n * @returns {void}\n */\nexport function bind_focused(element, set) {\n\tlisten(element, ['focus', 'blur'], () => {\n\t\tset(element === document.activeElement);\n\t});\n}\n","/** @import { ComponentContextLegacy } from '#client' */\nimport { run, run_all } from '../../../shared/utils.js';\nimport { derived } from '../../reactivity/deriveds.js';\nimport { user_pre_effect, user_effect } from '../../reactivity/effects.js';\nimport { component_context, deep_read_state, get, untrack } from '../../runtime.js';\n\n/**\n * Legacy-mode only: Call `onMount` callbacks and set up `beforeUpdate`/`afterUpdate` effects\n * @param {boolean} [immutable]\n */\nexport function init(immutable = false) {\n\tconst context = /** @type {ComponentContextLegacy} */ (component_context);\n\n\tconst callbacks = context.l.u;\n\tif (!callbacks) return;\n\n\tlet props = () => deep_read_state(context.s);\n\n\tif (immutable) {\n\t\tlet version = 0;\n\t\tlet prev = /** @type {Record<string, any>} */ ({});\n\n\t\t// In legacy immutable mode, before/afterUpdate only fire if the object identity of a prop changes\n\t\tconst d = derived(() => {\n\t\t\tlet changed = false;\n\t\t\tconst props = context.s;\n\t\t\tfor (const key in props) {\n\t\t\t\tif (props[key] !== prev[key]) {\n\t\t\t\t\tprev[key] = props[key];\n\t\t\t\t\tchanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (changed) version++;\n\t\t\treturn version;\n\t\t});\n\n\t\tprops = () => get(d);\n\t}\n\n\t// beforeUpdate\n\tif (callbacks.b.length) {\n\t\tuser_pre_effect(() => {\n\t\t\tobserve_all(context, props);\n\t\t\trun_all(callbacks.b);\n\t\t});\n\t}\n\n\t// onMount (must run before afterUpdate)\n\tuser_effect(() => {\n\t\tconst fns = untrack(() => callbacks.m.map(run));\n\t\treturn () => {\n\t\t\tfor (const fn of fns) {\n\t\t\t\tif (typeof fn === 'function') {\n\t\t\t\t\tfn();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t});\n\n\t// afterUpdate\n\tif (callbacks.a.length) {\n\t\tuser_effect(() => {\n\t\t\tobserve_all(context, props);\n\t\t\trun_all(callbacks.a);\n\t\t});\n\t}\n}\n\n/**\n * Invoke the getter of all signals associated with a component\n * so they can be registered to the effect this function is called in.\n * @param {ComponentContextLegacy} context\n * @param {(() => void)} props\n */\nfunction observe_all(context, props) {\n\tif (context.l.s) {\n\t\tfor (const signal of context.l.s) get(signal);\n\t}\n\n\tprops();\n}\n","/** @import { ComponentContext, ComponentContextLegacy } from '#client' */\n/** @import { EventDispatcher } from './index.js' */\n/** @import { NotFunction } from './internal/types.js' */\nimport { component_context, flush_sync, untrack } from './internal/client/runtime.js';\nimport { is_array } from './internal/shared/utils.js';\nimport { user_effect } from './internal/client/index.js';\nimport * as e from './internal/client/errors.js';\nimport { lifecycle_outside_component } from './internal/shared/errors.js';\nimport { legacy_mode_flag } from './internal/flags/index.js';\n\n/**\n * The `onMount` function schedules a callback to run as soon as the component has been mounted to the DOM.\n * It must be called during the component's initialisation (but doesn't need to live *inside* the component;\n * it can be called from an external module).\n *\n * If a function is returned _synchronously_ from `onMount`, it will be called when the component is unmounted.\n *\n * `onMount` does not run inside [server-side components](https://svelte.dev/docs/svelte/svelte-server#render).\n *\n * @template T\n * @param {() => NotFunction<T> | Promise<NotFunction<T>> | (() => any)} fn\n * @returns {void}\n */\nexport function onMount(fn) {\n\tif (component_context === null) {\n\t\tlifecycle_outside_component('onMount');\n\t}\n\n\tif (legacy_mode_flag && component_context.l !== null) {\n\t\tinit_update_callbacks(component_context).m.push(fn);\n\t} else {\n\t\tuser_effect(() => {\n\t\t\tconst cleanup = untrack(fn);\n\t\t\tif (typeof cleanup === 'function') return /** @type {() => void} */ (cleanup);\n\t\t});\n\t}\n}\n\n/**\n * Schedules a callback to run immediately before the component is unmounted.\n *\n * Out of `onMount`, `beforeUpdate`, `afterUpdate` and `onDestroy`, this is the\n * only one that runs inside a server-side component.\n *\n * @param {() => any} fn\n * @returns {void}\n */\nexport function onDestroy(fn) {\n\tif (component_context === null) {\n\t\tlifecycle_outside_component('onDestroy');\n\t}\n\n\tonMount(() => () => untrack(fn));\n}\n\n/**\n * @template [T=any]\n * @param {string} type\n * @param {T} [detail]\n * @param {any}params_0\n * @returns {CustomEvent<T>}\n */\nfunction create_custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {\n\treturn new CustomEvent(type, { detail, bubbles, cancelable });\n}\n\n/**\n * Creates an event dispatcher that can be used to dispatch [component events](https://svelte.dev/docs/svelte/legacy-on#Component-events).\n * Event dispatchers are functions that can take two arguments: `name` and `detail`.\n *\n * Component events created with `createEventDispatcher` create a\n * [CustomEvent](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent).\n * These events do not [bubble](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#Event_bubbling_and_capture).\n * The `detail` argument corresponds to the [CustomEvent.detail](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail)\n * property and can contain any type of data.\n *\n * The event dispatcher can be typed to narrow the allowed event names and the type of the `detail` argument:\n * ```ts\n * const dispatch = createEventDispatcher<{\n *  loaded: never; // does not take a detail argument\n *  change: string; // takes a detail argument of type string, which is required\n *  optional: number | null; // takes an optional detail argument of type number\n * }>();\n * ```\n *\n * @deprecated Use callback props and/or the `$host()` rune instead  see [migration guide](https://svelte.dev/docs/svelte/v5-migration-guide#Event-changes-Component-events)\n * @template {Record<string, any>} [EventMap = any]\n * @returns {EventDispatcher<EventMap>}\n */\nexport function createEventDispatcher() {\n\tconst active_component_context = component_context;\n\tif (active_component_context === null) {\n\t\tlifecycle_outside_component('createEventDispatcher');\n\t}\n\n\treturn (type, detail, options) => {\n\t\tconst events = /** @type {Record<string, Function | Function[]>} */ (\n\t\t\tactive_component_context.s.$$events\n\t\t)?.[/** @type {any} */ (type)];\n\n\t\tif (events) {\n\t\t\tconst callbacks = is_array(events) ? events.slice() : [events];\n\t\t\t// TODO are there situations where events could be dispatched\n\t\t\t// in a server (non-DOM) environment?\n\t\t\tconst event = create_custom_event(/** @type {string} */ (type), detail, options);\n\t\t\tfor (const fn of callbacks) {\n\t\t\t\tfn.call(active_component_context.x, event);\n\t\t\t}\n\t\t\treturn !event.defaultPrevented;\n\t\t}\n\n\t\treturn true;\n\t};\n}\n\n// TODO mark beforeUpdate and afterUpdate as deprecated in Svelte 6\n\n/**\n * Schedules a callback to run immediately before the component is updated after any state change.\n *\n * The first time the callback runs will be before the initial `onMount`.\n *\n * In runes mode use `$effect.pre` instead.\n *\n * @deprecated Use [`$effect.pre`](https://svelte.dev/docs/svelte/$effect#$effect.pre) instead\n * @param {() => void} fn\n * @returns {void}\n */\nexport function beforeUpdate(fn) {\n\tif (component_context === null) {\n\t\tlifecycle_outside_component('beforeUpdate');\n\t}\n\n\tif (component_context.l === null) {\n\t\te.lifecycle_legacy_only('beforeUpdate');\n\t}\n\n\tinit_update_callbacks(component_context).b.push(fn);\n}\n\n/**\n * Schedules a callback to run immediately after the component has been updated.\n *\n * The first time the callback runs will be after the initial `onMount`.\n *\n * In runes mode use `$effect` instead.\n *\n * @deprecated Use [`$effect`](https://svelte.dev/docs/svelte/$effect) instead\n * @param {() => void} fn\n * @returns {void}\n */\nexport function afterUpdate(fn) {\n\tif (component_context === null) {\n\t\tlifecycle_outside_component('afterUpdate');\n\t}\n\n\tif (component_context.l === null) {\n\t\te.lifecycle_legacy_only('afterUpdate');\n\t}\n\n\tinit_update_callbacks(component_context).a.push(fn);\n}\n\n/**\n * Legacy-mode: Init callbacks object for onMount/beforeUpdate/afterUpdate\n * @param {ComponentContext} context\n */\nfunction init_update_callbacks(context) {\n\tvar l = /** @type {ComponentContextLegacy} */ (context).l;\n\treturn (l.u ??= { a: [], b: [], m: [] });\n}\n\n/**\n * Synchronously flushes any pending state changes and those that result from it.\n * @param {() => void} [fn]\n * @returns {void}\n */\nexport function flushSync(fn) {\n\tflush_sync(fn);\n}\n\nexport { hydrate, mount, unmount } from './internal/client/render.js';\n\nexport {\n\tgetContext,\n\tgetAllContexts,\n\thasContext,\n\tsetContext,\n\ttick,\n\tuntrack\n} from './internal/client/runtime.js';\n\nexport { createRawSnippet } from './internal/client/dom/blocks/snippet.js';\n","/** @import { StoreReferencesContainer } from '#client' */\n/** @import { Store } from '#shared' */\nimport { subscribe_to_store } from '../../../store/utils.js';\nimport { noop } from '../../shared/utils.js';\nimport { get } from '../runtime.js';\nimport { teardown } from './effects.js';\nimport { mutable_source, set } from './sources.js';\n\n/**\n * Whether or not the prop currently being read is a store binding, as in\n * `<Child bind:x={$y} />`. If it is, we treat the prop as mutable even in\n * runes mode, and skip `binding_property_non_reactive` validation\n */\nlet is_store_binding = false;\n\n/**\n * Gets the current value of a store. If the store isn't subscribed to yet, it will create a proxy\n * signal that will be updated when the store is. The store references container is needed to\n * track reassignments to stores and to track the correct component context.\n * @template V\n * @param {Store<V> | null | undefined} store\n * @param {string} store_name\n * @param {StoreReferencesContainer} stores\n * @returns {V}\n */\nexport function store_get(store, store_name, stores) {\n\tconst entry = (stores[store_name] ??= {\n\t\tstore: null,\n\t\tsource: mutable_source(undefined),\n\t\tunsubscribe: noop\n\t});\n\n\tif (entry.store !== store) {\n\t\tentry.unsubscribe();\n\t\tentry.store = store ?? null;\n\n\t\tif (store == null) {\n\t\t\tentry.source.v = undefined; // see synchronous callback comment below\n\t\t\tentry.unsubscribe = noop;\n\t\t} else {\n\t\t\tvar is_synchronous_callback = true;\n\n\t\t\tentry.unsubscribe = subscribe_to_store(store, (v) => {\n\t\t\t\tif (is_synchronous_callback) {\n\t\t\t\t\t// If the first updates to the store value (possibly multiple of them) are synchronously\n\t\t\t\t\t// inside a derived, we will hit the `state_unsafe_mutation` error if we `set` the value\n\t\t\t\t\tentry.source.v = v;\n\t\t\t\t} else {\n\t\t\t\t\tset(entry.source, v);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tis_synchronous_callback = false;\n\t\t}\n\t}\n\n\treturn get(entry.source);\n}\n\n/**\n * Unsubscribe from a store if it's not the same as the one in the store references container.\n * We need this in addition to `store_get` because someone could unsubscribe from a store but\n * then never subscribe to the new one (if any), causing the subscription to stay open wrongfully.\n * @param {Store<any> | null | undefined} store\n * @param {string} store_name\n * @param {StoreReferencesContainer} stores\n */\nexport function store_unsub(store, store_name, stores) {\n\t/** @type {StoreReferencesContainer[''] | undefined} */\n\tlet entry = stores[store_name];\n\n\tif (entry && entry.store !== store) {\n\t\t// Don't reset store yet, so that store_get above can resubscribe to new store if necessary\n\t\tentry.unsubscribe();\n\t\tentry.unsubscribe = noop;\n\t}\n\n\treturn store;\n}\n\n/**\n * Sets the new value of a store and returns that value.\n * @template V\n * @param {Store<V>} store\n * @param {V} value\n * @returns {V}\n */\nexport function store_set(store, value) {\n\tstore.set(value);\n\treturn value;\n}\n\n/**\n * @param {StoreReferencesContainer} stores\n * @param {string} store_name\n */\nexport function invalidate_store(stores, store_name) {\n\tvar entry = stores[store_name];\n\tif (entry.store !== null) {\n\t\tstore_set(entry.store, entry.source.v);\n\t}\n}\n\n/**\n * Unsubscribes from all auto-subscribed stores on destroy\n * @returns {StoreReferencesContainer}\n */\nexport function setup_stores() {\n\t/** @type {StoreReferencesContainer} */\n\tconst stores = {};\n\n\tteardown(() => {\n\t\tfor (var store_name in stores) {\n\t\t\tconst ref = stores[store_name];\n\t\t\tref.unsubscribe();\n\t\t}\n\t});\n\n\treturn stores;\n}\n\n/**\n * Updates a store with a new value.\n * @param {Store<V>} store  the store to update\n * @param {any} expression  the expression that mutates the store\n * @param {V} new_value  the new store value\n * @template V\n */\nexport function store_mutate(store, expression, new_value) {\n\tstore.set(new_value);\n\treturn expression;\n}\n\n/**\n * @param {Store<number>} store\n * @param {number} store_value\n * @param {1 | -1} [d]\n * @returns {number}\n */\nexport function update_store(store, store_value, d = 1) {\n\tstore.set(store_value + d);\n\treturn store_value;\n}\n\n/**\n * @param {Store<number>} store\n * @param {number} store_value\n * @param {1 | -1} [d]\n * @returns {number}\n */\nexport function update_pre_store(store, store_value, d = 1) {\n\tconst value = store_value + d;\n\tstore.set(value);\n\treturn value;\n}\n\n/**\n * Called inside prop getters to communicate that the prop is a store binding\n */\nexport function mark_store_binding() {\n\tis_store_binding = true;\n}\n\n/**\n * Returns a tuple that indicates whether `fn()` reads a prop that is a store binding.\n * Used to prevent `binding_property_non_reactive` validation false positives and\n * ensure that these props are treated as mutable even in runes mode\n * @template T\n * @param {() => T} fn\n * @returns {[T, boolean]}\n */\nexport function capture_store_binding(fn) {\n\tvar previous_is_store_binding = is_store_binding;\n\n\ttry {\n\t\tis_store_binding = false;\n\t\treturn [fn(), is_store_binding];\n\t} finally {\n\t\tis_store_binding = previous_is_store_binding;\n\t}\n}\n","/** @import { Source } from './types.js' */\nimport { DEV } from 'esm-env';\nimport {\n\tPROPS_IS_BINDABLE,\n\tPROPS_IS_IMMUTABLE,\n\tPROPS_IS_LAZY_INITIAL,\n\tPROPS_IS_RUNES,\n\tPROPS_IS_UPDATED\n} from '../../../constants.js';\nimport { get_descriptor, is_function } from '../../shared/utils.js';\nimport { mutable_source, set, source } from './sources.js';\nimport { derived, derived_safe_equal } from './deriveds.js';\nimport {\n\tactive_effect,\n\tget,\n\tcaptured_signals,\n\tset_active_effect,\n\tuntrack,\n\tupdate\n} from '../runtime.js';\nimport { safe_equals } from './equality.js';\nimport * as e from '../errors.js';\nimport {\n\tBRANCH_EFFECT,\n\tLEGACY_DERIVED_PROP,\n\tLEGACY_PROPS,\n\tROOT_EFFECT,\n\tSTATE_SYMBOL\n} from '../constants.js';\nimport { proxy } from '../proxy.js';\nimport { capture_store_binding } from './store.js';\nimport { legacy_mode_flag } from '../../flags/index.js';\n\n/**\n * @param {((value?: number) => number)} fn\n * @param {1 | -1} [d]\n * @returns {number}\n */\nexport function update_prop(fn, d = 1) {\n\tconst value = fn();\n\tfn(value + d);\n\treturn value;\n}\n\n/**\n * @param {((value?: number) => number)} fn\n * @param {1 | -1} [d]\n * @returns {number}\n */\nexport function update_pre_prop(fn, d = 1) {\n\tconst value = fn() + d;\n\tfn(value);\n\treturn value;\n}\n\n/**\n * The proxy handler for rest props (i.e. `const { x, ...rest } = $props()`).\n * Is passed the full `$$props` object and excludes the named props.\n * @type {ProxyHandler<{ props: Record<string | symbol, unknown>, exclude: Array<string | symbol>, name?: string }>}}\n */\nconst rest_props_handler = {\n\tget(target, key) {\n\t\tif (target.exclude.includes(key)) return;\n\t\treturn target.props[key];\n\t},\n\tset(target, key) {\n\t\tif (DEV) {\n\t\t\t// TODO should this happen in prod too?\n\t\t\te.props_rest_readonly(`${target.name}.${String(key)}`);\n\t\t}\n\n\t\treturn false;\n\t},\n\tgetOwnPropertyDescriptor(target, key) {\n\t\tif (target.exclude.includes(key)) return;\n\t\tif (key in target.props) {\n\t\t\treturn {\n\t\t\t\tenumerable: true,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: target.props[key]\n\t\t\t};\n\t\t}\n\t},\n\thas(target, key) {\n\t\tif (target.exclude.includes(key)) return false;\n\t\treturn key in target.props;\n\t},\n\townKeys(target) {\n\t\treturn Reflect.ownKeys(target.props).filter((key) => !target.exclude.includes(key));\n\t}\n};\n\n/**\n * @param {Record<string, unknown>} props\n * @param {string[]} exclude\n * @param {string} [name]\n * @returns {Record<string, unknown>}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function rest_props(props, exclude, name) {\n\treturn new Proxy(\n\t\tDEV ? { props, exclude, name, other: {}, to_proxy: [] } : { props, exclude },\n\t\trest_props_handler\n\t);\n}\n\n/**\n * The proxy handler for legacy $$restProps and $$props\n * @type {ProxyHandler<{ props: Record<string | symbol, unknown>, exclude: Array<string | symbol>, special: Record<string | symbol, (v?: unknown) => unknown>, version: Source<number> }>}}\n */\nconst legacy_rest_props_handler = {\n\tget(target, key) {\n\t\tif (target.exclude.includes(key)) return;\n\t\tget(target.version);\n\t\treturn key in target.special ? target.special[key]() : target.props[key];\n\t},\n\tset(target, key, value) {\n\t\tif (!(key in target.special)) {\n\t\t\t// Handle props that can temporarily get out of sync with the parent\n\t\t\t/** @type {Record<string, (v?: unknown) => unknown>} */\n\t\t\ttarget.special[key] = prop(\n\t\t\t\t{\n\t\t\t\t\tget [key]() {\n\t\t\t\t\t\treturn target.props[key];\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t/** @type {string} */ (key),\n\t\t\t\tPROPS_IS_UPDATED\n\t\t\t);\n\t\t}\n\n\t\ttarget.special[key](value);\n\t\tupdate(target.version); // $$props is coarse-grained: when $$props.x is updated, usages of $$props.y etc are also rerun\n\t\treturn true;\n\t},\n\tgetOwnPropertyDescriptor(target, key) {\n\t\tif (target.exclude.includes(key)) return;\n\t\tif (key in target.props) {\n\t\t\treturn {\n\t\t\t\tenumerable: true,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: target.props[key]\n\t\t\t};\n\t\t}\n\t},\n\tdeleteProperty(target, key) {\n\t\t// Svelte 4 allowed for deletions on $$restProps\n\t\tif (target.exclude.includes(key)) return true;\n\t\ttarget.exclude.push(key);\n\t\tupdate(target.version);\n\t\treturn true;\n\t},\n\thas(target, key) {\n\t\tif (target.exclude.includes(key)) return false;\n\t\treturn key in target.props;\n\t},\n\townKeys(target) {\n\t\treturn Reflect.ownKeys(target.props).filter((key) => !target.exclude.includes(key));\n\t}\n};\n\n/**\n * @param {Record<string, unknown>} props\n * @param {string[]} exclude\n * @returns {Record<string, unknown>}\n */\nexport function legacy_rest_props(props, exclude) {\n\treturn new Proxy({ props, exclude, special: {}, version: source(0) }, legacy_rest_props_handler);\n}\n\n/**\n * The proxy handler for spread props. Handles the incoming array of props\n * that looks like `() => { dynamic: props }, { static: prop }, ..` and wraps\n * them so that the whole thing is passed to the component as the `$$props` argument.\n * @template {Record<string | symbol, unknown>} T\n * @type {ProxyHandler<{ props: Array<T | (() => T)> }>}}\n */\nconst spread_props_handler = {\n\tget(target, key) {\n\t\tlet i = target.props.length;\n\t\twhile (i--) {\n\t\t\tlet p = target.props[i];\n\t\t\tif (is_function(p)) p = p();\n\t\t\tif (typeof p === 'object' && p !== null && key in p) return p[key];\n\t\t}\n\t},\n\tset(target, key, value) {\n\t\tlet i = target.props.length;\n\t\twhile (i--) {\n\t\t\tlet p = target.props[i];\n\t\t\tif (is_function(p)) p = p();\n\t\t\tconst desc = get_descriptor(p, key);\n\t\t\tif (desc && desc.set) {\n\t\t\t\tdesc.set(value);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\tgetOwnPropertyDescriptor(target, key) {\n\t\tlet i = target.props.length;\n\t\twhile (i--) {\n\t\t\tlet p = target.props[i];\n\t\t\tif (is_function(p)) p = p();\n\t\t\tif (typeof p === 'object' && p !== null && key in p) {\n\t\t\t\tconst descriptor = get_descriptor(p, key);\n\t\t\t\tif (descriptor && !descriptor.configurable) {\n\t\t\t\t\t// Prevent a \"Non-configurability Report Error\": The target is an array, it does\n\t\t\t\t\t// not actually contain this property. If it is now described as non-configurable,\n\t\t\t\t\t// the proxy throws a validation error. Setting it to true avoids that.\n\t\t\t\t\tdescriptor.configurable = true;\n\t\t\t\t}\n\t\t\t\treturn descriptor;\n\t\t\t}\n\t\t}\n\t},\n\thas(target, key) {\n\t\t// To prevent a false positive `is_entry_props` in the `prop` function\n\t\tif (key === STATE_SYMBOL || key === LEGACY_PROPS) return false;\n\n\t\tfor (let p of target.props) {\n\t\t\tif (is_function(p)) p = p();\n\t\t\tif (p != null && key in p) return true;\n\t\t}\n\n\t\treturn false;\n\t},\n\townKeys(target) {\n\t\t/** @type {Array<string | symbol>} */\n\t\tconst keys = [];\n\n\t\tfor (let p of target.props) {\n\t\t\tif (is_function(p)) p = p();\n\t\t\tfor (const key in p) {\n\t\t\t\tif (!keys.includes(key)) keys.push(key);\n\t\t\t}\n\t\t}\n\n\t\treturn keys;\n\t}\n};\n\n/**\n * @param {Array<Record<string, unknown> | (() => Record<string, unknown>)>} props\n * @returns {any}\n */\nexport function spread_props(...props) {\n\treturn new Proxy({ props }, spread_props_handler);\n}\n\n/**\n * @template T\n * @param {() => T} fn\n * @returns {T}\n */\nfunction with_parent_branch(fn) {\n\tvar effect = active_effect;\n\tvar previous_effect = active_effect;\n\n\twhile (effect !== null && (effect.f & (BRANCH_EFFECT | ROOT_EFFECT)) === 0) {\n\t\teffect = effect.parent;\n\t}\n\ttry {\n\t\tset_active_effect(effect);\n\t\treturn fn();\n\t} finally {\n\t\tset_active_effect(previous_effect);\n\t}\n}\n\n/**\n * This function is responsible for synchronizing a possibly bound prop with the inner component state.\n * It is used whenever the compiler sees that the component writes to the prop, or when it has a default prop_value.\n * @template V\n * @param {Record<string, unknown>} props\n * @param {string} key\n * @param {number} flags\n * @param {V | (() => V)} [fallback]\n * @returns {(() => V | ((arg: V) => V) | ((arg: V, mutation: boolean) => V))}\n */\nexport function prop(props, key, flags, fallback) {\n\tvar immutable = (flags & PROPS_IS_IMMUTABLE) !== 0;\n\tvar runes = !legacy_mode_flag || (flags & PROPS_IS_RUNES) !== 0;\n\tvar bindable = (flags & PROPS_IS_BINDABLE) !== 0;\n\tvar lazy = (flags & PROPS_IS_LAZY_INITIAL) !== 0;\n\tvar is_store_sub = false;\n\tvar prop_value;\n\n\tif (bindable) {\n\t\t[prop_value, is_store_sub] = capture_store_binding(() => /** @type {V} */ (props[key]));\n\t} else {\n\t\tprop_value = /** @type {V} */ (props[key]);\n\t}\n\n\t// Can be the case when someone does `mount(Component, props)` with `let props = $state({...})`\n\t// or `createClassComponent(Component, props)`\n\tvar is_entry_props = STATE_SYMBOL in props || LEGACY_PROPS in props;\n\n\tvar setter =\n\t\t(bindable &&\n\t\t\t(get_descriptor(props, key)?.set ??\n\t\t\t\t(is_entry_props && key in props && ((v) => (props[key] = v))))) ||\n\t\tundefined;\n\n\tvar fallback_value = /** @type {V} */ (fallback);\n\tvar fallback_dirty = true;\n\tvar fallback_used = false;\n\n\tvar get_fallback = () => {\n\t\tfallback_used = true;\n\t\tif (fallback_dirty) {\n\t\t\tfallback_dirty = false;\n\t\t\tif (lazy) {\n\t\t\t\tfallback_value = untrack(/** @type {() => V} */ (fallback));\n\t\t\t} else {\n\t\t\t\tfallback_value = /** @type {V} */ (fallback);\n\t\t\t}\n\t\t}\n\n\t\treturn fallback_value;\n\t};\n\n\tif (prop_value === undefined && fallback !== undefined) {\n\t\tif (setter && runes) {\n\t\t\te.props_invalid_value(key);\n\t\t}\n\n\t\tprop_value = get_fallback();\n\t\tif (setter) setter(prop_value);\n\t}\n\n\t/** @type {() => V} */\n\tvar getter;\n\tif (runes) {\n\t\tgetter = () => {\n\t\t\tvar value = /** @type {V} */ (props[key]);\n\t\t\tif (value === undefined) return get_fallback();\n\t\t\tfallback_dirty = true;\n\t\t\tfallback_used = false;\n\t\t\treturn value;\n\t\t};\n\t} else {\n\t\t// Svelte 4 did not trigger updates when a primitive value was updated to the same value.\n\t\t// Replicate that behavior through using a derived\n\t\tvar derived_getter = with_parent_branch(() =>\n\t\t\t(immutable ? derived : derived_safe_equal)(() => /** @type {V} */ (props[key]))\n\t\t);\n\t\tderived_getter.f |= LEGACY_DERIVED_PROP;\n\t\tgetter = () => {\n\t\t\tvar value = get(derived_getter);\n\t\t\tif (value !== undefined) fallback_value = /** @type {V} */ (undefined);\n\t\t\treturn value === undefined ? fallback_value : value;\n\t\t};\n\t}\n\n\t// easy mode  prop is never written to\n\tif ((flags & PROPS_IS_UPDATED) === 0) {\n\t\treturn getter;\n\t}\n\n\t// intermediate mode  prop is written to, but the parent component had\n\t// `bind:foo` which means we can just call `$$props.foo = value` directly\n\tif (setter) {\n\t\tvar legacy_parent = props.$$legacy;\n\t\treturn function (/** @type {any} */ value, /** @type {boolean} */ mutation) {\n\t\t\tif (arguments.length > 0) {\n\t\t\t\t// We don't want to notify if the value was mutated and the parent is in runes mode.\n\t\t\t\t// In that case the state proxy (if it exists) should take care of the notification.\n\t\t\t\t// If the parent is not in runes mode, we need to notify on mutation, too, that the prop\n\t\t\t\t// has changed because the parent will not be able to detect the change otherwise.\n\t\t\t\tif (!runes || !mutation || legacy_parent || is_store_sub) {\n\t\t\t\t\t/** @type {Function} */ (setter)(mutation ? getter() : value);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t} else {\n\t\t\t\treturn getter();\n\t\t\t}\n\t\t};\n\t}\n\n\t// hard mode. this is where it gets ugly  the value in the child should\n\t// synchronize with the parent, but it should also be possible to temporarily\n\t// set the value to something else locally.\n\tvar from_child = false;\n\tvar was_from_child = false;\n\n\t// The derived returns the current value. The underlying mutable\n\t// source is written to from various places to persist this value.\n\tvar inner_current_value = mutable_source(prop_value);\n\tvar current_value = with_parent_branch(() =>\n\t\tderived(() => {\n\t\t\tvar parent_value = getter();\n\t\t\tvar child_value = get(inner_current_value);\n\n\t\t\tif (from_child) {\n\t\t\t\tfrom_child = false;\n\t\t\t\twas_from_child = true;\n\t\t\t\treturn child_value;\n\t\t\t}\n\n\t\t\twas_from_child = false;\n\t\t\treturn (inner_current_value.v = parent_value);\n\t\t})\n\t);\n\n\tif (!immutable) current_value.equals = safe_equals;\n\n\treturn function (/** @type {any} */ value, /** @type {boolean} */ mutation) {\n\t\t// legacy nonsense  need to ensure the source is invalidated when necessary\n\t\t// also needed for when handling inspect logic so we can inspect the correct source signal\n\t\tif (captured_signals !== null) {\n\t\t\t// set this so that we don't reset to the parent value if `d`\n\t\t\t// is invalidated because of `invalidate_inner_signals` (rather\n\t\t\t// than because the parent or child value changed)\n\t\t\tfrom_child = was_from_child;\n\t\t\t// invoke getters so that signals are picked up by `invalidate_inner_signals`\n\t\t\tgetter();\n\t\t\tget(inner_current_value);\n\t\t}\n\n\t\tif (arguments.length > 0) {\n\t\t\tconst new_value = mutation ? get(current_value) : runes && bindable ? proxy(value) : value;\n\n\t\t\tif (!current_value.equals(new_value)) {\n\t\t\t\tfrom_child = true;\n\t\t\t\tset(inner_current_value, new_value);\n\t\t\t\t// To ensure the fallback value is consistent when used with proxies, we\n\t\t\t\t// update the local fallback_value, but only if the fallback is actively used\n\t\t\t\tif (fallback_used && fallback_value !== undefined) {\n\t\t\t\t\tfallback_value = new_value;\n\t\t\t\t}\n\t\t\t\tuntrack(() => get(current_value)); // force a synchronisation immediately\n\t\t\t}\n\n\t\t\treturn value;\n\t\t}\n\t\treturn get(current_value);\n\t};\n}\n","/** @import { Effect, TemplateNode, } from '#client' */\n\nimport { BOUNDARY_EFFECT, EFFECT_TRANSPARENT } from '../../constants.js';\nimport { block, branch, destroy_effect, pause_effect } from '../../reactivity/effects.js';\nimport {\n\tactive_effect,\n\tactive_reaction,\n\tcomponent_context,\n\thandle_error,\n\tset_active_effect,\n\tset_active_reaction,\n\tset_component_context,\n\treset_is_throwing_error\n} from '../../runtime.js';\nimport {\n\thydrate_next,\n\thydrate_node,\n\thydrating,\n\tnext,\n\tremove_nodes,\n\tset_hydrate_node\n} from '../hydration.js';\nimport { queue_micro_task } from '../task.js';\n\n/**\n * @param {Effect} boundary\n * @param {() => void} fn\n */\nfunction with_boundary(boundary, fn) {\n\tvar previous_effect = active_effect;\n\tvar previous_reaction = active_reaction;\n\tvar previous_ctx = component_context;\n\n\tset_active_effect(boundary);\n\tset_active_reaction(boundary);\n\tset_component_context(boundary.ctx);\n\n\ttry {\n\t\tfn();\n\t} finally {\n\t\tset_active_effect(previous_effect);\n\t\tset_active_reaction(previous_reaction);\n\t\tset_component_context(previous_ctx);\n\t}\n}\n\n/**\n * @param {TemplateNode} node\n * @param {{\n * \t onerror?: (error: unknown, reset: () => void) => void,\n *   failed?: (anchor: Node, error: () => unknown, reset: () => () => void) => void\n * }} props\n * @param {((anchor: Node) => void)} boundary_fn\n * @returns {void}\n */\nexport function boundary(node, props, boundary_fn) {\n\tvar anchor = node;\n\n\t/** @type {Effect} */\n\tvar boundary_effect;\n\n\tblock(() => {\n\t\tvar boundary = /** @type {Effect} */ (active_effect);\n\t\tvar hydrate_open = hydrate_node;\n\t\tvar is_creating_fallback = false;\n\n\t\t// We re-use the effect's fn property to avoid allocation of an additional field\n\t\tboundary.fn = (/** @type {unknown}} */ error) => {\n\t\t\tvar onerror = props.onerror;\n\t\t\tlet failed = props.failed;\n\n\t\t\t// If we have nothing to capture the error, or if we hit an error while\n\t\t\t// rendering the fallback, re-throw for another boundary to handle\n\t\t\tif ((!onerror && !failed) || is_creating_fallback) {\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\tvar reset = () => {\n\t\t\t\tpause_effect(boundary_effect);\n\n\t\t\t\twith_boundary(boundary, () => {\n\t\t\t\t\tis_creating_fallback = false;\n\t\t\t\t\tboundary_effect = branch(() => boundary_fn(anchor));\n\t\t\t\t\treset_is_throwing_error();\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tonerror?.(error, reset);\n\n\t\t\tif (boundary_effect) {\n\t\t\t\tdestroy_effect(boundary_effect);\n\t\t\t} else if (hydrating) {\n\t\t\t\tset_hydrate_node(hydrate_open);\n\t\t\t\tnext();\n\t\t\t\tset_hydrate_node(remove_nodes());\n\t\t\t}\n\n\t\t\tif (failed) {\n\t\t\t\t// Render the `failed` snippet in a microtask\n\t\t\t\tqueue_micro_task(() => {\n\t\t\t\t\twith_boundary(boundary, () => {\n\t\t\t\t\t\tis_creating_fallback = true;\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tboundary_effect = branch(() => {\n\t\t\t\t\t\t\t\tfailed(\n\t\t\t\t\t\t\t\t\tanchor,\n\t\t\t\t\t\t\t\t\t() => error,\n\t\t\t\t\t\t\t\t\t() => reset\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\thandle_error(error, boundary, null, boundary.ctx);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treset_is_throwing_error();\n\t\t\t\t\t\tis_creating_fallback = false;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tif (hydrating) {\n\t\t\thydrate_next();\n\t\t}\n\n\t\tboundary_effect = branch(() => boundary_fn(anchor));\n\t\treset_is_throwing_error();\n\t}, EFFECT_TRANSPARENT | BOUNDARY_EFFECT);\n\n\tif (hydrating) {\n\t\tanchor = hydrate_node;\n\t}\n}\n","export const CONSTANTS = {\n  MODULE_ID: 'tidy5e-sheet',\n  DND5E_SYSTEM_ID: 'dnd5e',\n  SYSTEM_SETTING_BASTION_CONFIGURATION: 'bastionConfiguration',\n  SYSTEM_SETTING_LEVELING_MODE: 'levelingMode',\n  SYSTEM_SETTING_LEVELING_MODE_NO_XP: 'noxp',\n  SYSTEM_SETTING_LEVELING_MODE_XP: 'xp',\n  SYSTEM_SETTING_LEVELING_MODE_XP_BOONS: 'xpBoons',\n  DOCUMENT_NAME_ACTOR: 'Actor',\n  DOCUMENT_NAME_ITEM: 'Item',\n  DOCUMENT_NAME_ACTIVITY: 'Activity',\n  ATTUNEMENT_OPTIONAL: 'optional',\n  ATTUNEMENT_REQUIRED: 'required',\n  FAVORITES_SECTION_TYPE_ACTIVITY: 'activity',\n  FAVORITES_SECTION_TYPE_EFFECT: 'effect',\n  FAVORITES_SECTION_TYPE_FACILITY: 'facility',\n  FAVORITES_SECTION_TYPE_FEATURE: 'feature',\n  FAVORITES_SECTION_TYPE_GENERIC: 'generic',\n  FAVORITES_SECTION_TYPE_INVENTORY: 'inventory',\n  FAVORITES_SECTION_TYPE_SPELLBOOK: 'spellbook',\n  ITEM_CAPACITY_TYPE_ITEMS: 'items',\n  ITEM_CAPACITY_TYPE_WEIGHT: 'weight',\n  ITEM_TYPE_BACKGROUND: 'background',\n  ITEM_TYPE_CLASS: 'class',\n  ITEM_TYPE_CONSUMABLE: 'consumable',\n  ITEM_TYPE_CONTAINER: 'container',\n  ITEM_TYPE_EQUIPMENT: 'equipment',\n  ITEM_TYPE_FACILITY: 'facility',\n  ITEM_TYPE_FEAT: 'feat',\n  ITEM_TYPE_LOOT: 'loot',\n  ITEM_TYPE_RACE: 'race',\n  ITEM_TYPE_SPELL: 'spell',\n  ITEM_TYPE_SUBCLASS: 'subclass',\n  ITEM_TYPE_TOOL: 'tool',\n  ITEM_TYPE_WEAPON: 'weapon',\n  ITEM_SYSTEM_TYPE_AMMO: 'ammo',\n  MESSAGE_BUS_COLLAPSE_ALL: 'collapse-all',\n  MESSAGE_BUS_EXPAND_ALL: 'expand-all',\n  /**\n   * Main button pressed, usually the left button or the un-initialized state\n   */\n  MOUSE_BUTTON_MAIN: 0,\n  /**\n   * Auxiliary button pressed, usually the wheel button or the middle button (if present)\n   */\n  MOUSE_BUTTON_AUXILIARY: 1,\n  /**\n   * Secondary button pressed, usually the right button\n   */\n  MOUSE_BUTTON_SECONDARY: 2,\n  CONTEXT_MENU_TYPE_ACTIVITIES: 'activities',\n  CONTEXT_MENU_TYPE_EFFECTS: 'effects',\n  CONTEXT_MENU_TYPE_FACILITY_OCCUPANTS: 'facility-occupants',\n  CONTEXT_MENU_TYPE_GROUP_MEMBER: 'group-member',\n  CONTEXT_MENU_TYPE_ITEMS: 'items',\n  CONTEXT_MENU_TYPE_ITEM_ADVANCEMENT: 'item-advancement',\n  DND5E_CLASSES: {\n    artificer: 'TIDY5E.Class.Artificer',\n    barbarian: 'TIDY5E.Class.Barbarian',\n    bard: 'TIDY5E.Class.Bard',\n    cleric: 'TIDY5E.Class.Cleric',\n    druid: 'TIDY5E.Class.Druid',\n    fighter: 'TIDY5E.Class.Fighter',\n    monk: 'TIDY5E.Class.Monk',\n    paladin: 'TIDY5E.Class.Paladin',\n    ranger: 'TIDY5E.Class.Ranger',\n    rogue: 'TIDY5E.Class.Rogue',\n    sorcerer: 'TIDY5E.Class.Sorcerer',\n    warlock: 'TIDY5E.Class.Warlock',\n    wizard: 'TIDY5E.Class.Wizard',\n    custom: 'TIDY5E.Class.Custom',\n  },\n  CHARACTER_FEAT_SECTION_BACKGROUND: 'background',\n  CHARACTER_FEAT_SECTION_CLASSES: 'classes',\n  CHARACTER_FEAT_SECTION_ACTIVE: 'active',\n  CHARACTER_FEAT_SECTION_PASSIVE: 'passive',\n  CHARACTER_FEAT_SECTION_RACE: 'race',\n  FACILITY_TYPE_BASIC: 'basic',\n  FACILITY_TYPE_SPECIAL: 'special',\n  FEAT_TYPE_VEHICLE: 'vehicle',\n  GROUP_TYPE_GROUP: '',\n  GROUP_TYPE_ENCOUNTER: 'encounter',\n  GROUP_TYPE_PARTY: 'party',\n  NPC_ABILITY_SECTION_WEAPONS: 'weapons',\n  NPC_ABILITY_SECTION_ACTIONS: 'actions',\n  NPC_ABILITY_SECTION_PASSIVE: 'passive',\n  NPC_ABILITY_SECTION_EQUIPMENT: 'equipment',\n  NPC_ABILITY_SECTION_CLASSES: 'classes',\n  TAB_OPTION_CLASS: 'tab-option',\n  TAB_ACTOR_ACTIONS: 'actions',\n  TAB_ACTOR_INVENTORY: 'inventory',\n  TAB_ACTOR_SPELLBOOK: 'spellbook',\n  TAB_CHARACTER_ATTRIBUTES: 'attributes',\n  TAB_CHARACTER_BASTION: 'bastion',\n  TAB_CHARACTER_BIOGRAPHY: 'biography',\n  TAB_CHARACTER_EFFECTS: 'effects',\n  TAB_CHARACTER_FEATURES: 'features',\n  TAB_CHARACTER_JOURNAL: 'journal',\n  TAB_CONTAINER_CONTENTS: 'contents',\n  TAB_CONTAINER_SECTION_CONTENTS: 'contents',\n  TAB_GROUP_DESCRIPTION: 'description',\n  TAB_GROUP_MEMBERS: 'members',\n  TAB_ITEM_ACTIVITIES_ID: 'activities',\n  TAB_ITEM_ADVANCEMENT_ID: 'advancement',\n  TAB_ITEM_DESCRIPTION_ID: 'description',\n  TAB_ITEM_DETAILS_ID: 'details',\n  TAB_ITEM_EFFECTS_ID: 'effects',\n  TAB_MIGRATIONS_BONDS_IDEALS_FLAWS_TO_SYSTEM: 'bonds-ideals-flaws-to-system',\n  TAB_MIGRATIONS_CCSS_TO_TIDY: 'ccss-to-tidy',\n  TAB_MIGRATIONS_CHARACTER_BIOGRAPHY: 'character-bio',\n  TAB_MIGRATIONS_FAVORITES_TO_SYSTEM: 'favorites-to-system',\n  TAB_MIGRATIONS_NPC_DEATH: 'npc-death',\n  TAB_MIGRATIONS_NPC_EXHAUSTION: 'npc-exhaustion',\n  TAB_MIGRATIONS_SPELL_CLASS_TO_SOURCE_CLASS: 'spell-class-to-source-class',\n  TAB_NPC_ABILITIES: 'attributes',\n  TAB_NPC_BIOGRAPHY: 'biography',\n  TAB_NPC_EFFECTS: 'effects',\n  TAB_NPC_JOURNAL: 'journal',\n  TAB_USER_SETTINGS_ACTIONS_LIST: 'user-settings-actions-list',\n  TAB_USER_SETTINGS_ACTIVITIES: 'user-settings-activities',\n  TAB_USER_SETTINGS_NPCS: 'user-settings-npcs',\n  TAB_USER_SETTINGS_PLAYERS: 'user-settings-players',\n  TAB_USER_SETTINGS_VEHICLES: 'user-settings-vehicles',\n  TAB_VEHICLE_ATTRIBUTES: 'attributes',\n  TAB_VEHICLE_CARGO_AND_CREW: 'cargo',\n  TAB_VEHICLE_DESCRIPTION: 'biography',\n  TAB_VEHICLE_EFFECTS: 'effects',\n  TAB_WORLD_SETTINGS_CHARACTER: 'world-settings-character',\n  TAB_WORLD_SETTINGS_CUSTOM_SECTIONS: 'world-settings-custom-sections',\n  TAB_WORLD_SETTINGS_EXHAUSTION: 'world-settings-exhaustion',\n  TAB_WORLD_SETTINGS_ICONS: 'world-settings-icons',\n  TAB_WORLD_SETTINGS_ITEM: 'world-settings-item',\n  TAB_WORLD_SETTINGS_MISC: 'world-settings-misc',\n  TAB_WORLD_SETTINGS_NPC: 'world-settings-npc',\n  TAB_WORLD_SETTINGS_SHEETLOCK: 'world-settings-sheet-lock',\n  TAB_WORLD_SETTINGS_VEHICLE: 'world-settings-vehicle',\n  THEME_EXTENSION_WITH_DOT: '.tidy5e-theme',\n  THEME_ID_DEFAULT_LIGHT: 'light',\n  THEME_ID_DEFAULT_DARK: 'dark',\n  THEME_ID_DEFAULT: 'default',\n  VIEW_MODE_DEFAULT: 'default',\n  VIEW_MODE_INVERSE: 'inverse',\n  SHEET_TYPE_CHARACTER: 'character',\n  SHEET_TYPE_NPC: 'npc',\n  SHEET_TYPE_VEHICLE: 'vehicle',\n  SHEET_TYPE_CONTAINER: 'container',\n  SHEET_TYPE_ITEM: 'item',\n  SHEET_TYPE_GROUP: 'group',\n  SHEET_LAYOUT_ALL: 'all',\n  SHEET_LAYOUT_CLASSIC: 'classic',\n  SHEET_LAYOUT_QUADRONE: 'quadrone',\n  CIRCULAR_PORTRAIT_OPTION_ALL: 'all',\n  CIRCULAR_PORTRAIT_OPTION_CHARACTER: 'pc',\n  CIRCULAR_PORTRAIT_OPTION_NPCVEHICLE: 'npc-vehicle',\n  CIRCULAR_PORTRAIT_OPTION_NONE: 'none',\n  SPELLCASTING_PROGRESSION_NONE: 'none',\n  SPELL_PROPERTY_RITUAL: 'ritual',\n  SPELL_PREPARATION_MODE_INNATE: 'innate',\n  SPELL_PREPARATION_MODE_PREPARED: 'prepared',\n  SPELL_PREPARATION_MODE_ALWAYS: 'always',\n  SPELL_PREPARATION_MODE_PACT: 'pact',\n  SPELL_PREPARATION_MODE_ATWILL: 'atwill',\n  SPELL_PREPARATION_MODE_RITUAL: 'ritual',\n  SPELL_SLOT_TRACKER_MODE_PREFERENCE: 'spellSlotTrackerMode',\n  SPELL_SLOT_TRACKER_MODE_PIPS: 'pips',\n  SPELL_SLOT_TRACKER_MODE_VALUE_MAX: 'value-max',\n  CLASS_TIDY_USE_CORE_LISTENERS: 'tidy-use-core-listeners',\n  CLASS_SELECTOR_TIDY_USE_CORE_LISTENERS: '.tidy-use-core-listeners',\n  CLASS_ACTOR_SHEET_5E: 'ActorSheet5e',\n  HTML_DYNAMIC_RENDERING_ATTRIBUTE: 'data-tidy-render-scheme=\"handlebars\"',\n  HTML_DYNAMIC_RENDERING_ATTRIBUTE_SELECTOR:\n    '[data-tidy-render-scheme=\"handlebars\"]',\n  /** The attribute which indicates a particular part of a sheet. */\n  SHEET_PART_ATTRIBUTE: 'data-tidy-sheet-part',\n  SHEET_PARTS: {\n    /** An interactable control that can open configuration settings for a target ability. */\n    ABILITY_CONFIGURATION_CONTROL: 'ability-configuration-control',\n\n    /** A rollable/interactable element which rolls an ability save or test. */\n    ABILITY_ROLLER: 'ability-roller',\n\n    /** An interactable toggle for ability saving throw proficiency. */\n    ABILITY_SAVE_PROFICIENCY_TOGGLE: 'ability-save-proficiency-toggle',\n\n    /** An ability score (e.g., \"str\", \"dex\", \"wis\", etc.), whether readonly or editable. */\n    ABILITY_SCORE: 'ability-score',\n\n    /** A rollable/interactable element which rolls an ability save. */\n    ABILITY_SAVE_ROLLER: 'ability-save-roller',\n\n    /** A container for a given ability score (e.g., \"str\", \"dex\", \"wis\", etc.). */\n    ABILITY_SCORE_CONTAINER: 'ability-score-container',\n\n    /** A rollable/interactable element which rolls an ability test. */\n    ABILITY_TEST_ROLLER: 'ability-test-roller',\n\n    /** A toolbar with available actions for affeting the contents of a tab, usually item table contents (e.g., filter, sort, config). */\n    ACTION_BAR: 'action-bar',\n\n    /** A container which houses an actor portrait and other parts related to actor portrait features. */\n    ACTOR_PORTRAIT_CONTAINER: 'actor-portrait-container',\n\n    /** An overlay element for an actor portrait which provides a visual representation of remaining health. */\n    ACTOR_PORTRAIT_HEALTH_OVERLAY: 'actor-portrait-health-overlay',\n\n    /** An actor portrait image element. */\n    ACTOR_PORTRAIT_IMAGE: 'actor-portrait-image',\n\n    /** An actor trait container, such as Senses, Languages, or Tools. */\n    ACTOR_TRAIT: 'actor-trait',\n\n    /** The specific details of an actor trait container, such as Senses, Languages, or Tools. */\n    ACTOR_TRAIT_DETAILS: 'actor-trait-details',\n\n    /** A control for toggling a condition */\n    CONDITION_TOGGLE: 'condition-toggle',\n\n    /** A container for all form fields related to a given damage part. */\n    DAMAGE_PART_CONTAINER: 'damage-part-container',\n\n    /** An interactable control which the user can execute to delete a damage part to an item. */\n    DAMAGE_PART_DELETE_COMMAND: 'damage-part-delete-command',\n\n    /** An input element which contains a damage part formula, usually for an item. */\n    DAMAGE_PART_FORMULA: 'damage-part-formula',\n\n    /** An input element which represents the damage type of a damage part, usually for an item. */\n    DAMAGE_PART_TYPE: 'damage-part-type',\n\n    /** An input for the number of failed death saves an actor has. */\n    DEATH_SAVE_FAILURES: 'death-save-failures',\n\n    /** A rollable/interactable element which rolls a death saving throw. */\n    DEATH_SAVE_ROLLER: 'death-save-roller',\n\n    /** An input for the number of successful death saves an actor has. */\n    DEATH_SAVE_SUCCESSES: 'death-save-successes',\n\n    /** A row in an effect table. */\n    EFFECT_TABLE_ROW: 'effect-table-row',\n\n    /** An interactable element which toggles a view */\n    EXPANSION_TOGGLE: 'table-expansion-toggle',\n\n    /** An image representing a member of a group sheet. */\n    GROUP_MEMBER_PORTRAIT: 'group-member-portrait',\n\n    /** An interactable element which toggles an inline container's contents view */\n    INLINE_CONTAINER_TOGGLE: 'inline-container-toggle',\n\n    /** An interactable control which the user can execute to create an item (e.g., consumable, feature, loot, spell, weapon, etc.). */\n    ITEM_CREATE_COMMAND: 'item-create-command',\n\n    /** An image element for an item. */\n    ITEM_IMAGE: 'item-image',\n\n    /** The container element for an item image. */\n    ITEM_IMAGE_CONTAINER: 'item-image-container',\n\n    /** An element which contains the name of an item. */\n    ITEM_NAME: 'item-name',\n\n    /** A list-based tabular representation of items (e.g., equipment, loot, spells, etc.). */\n    ITEM_TABLE: 'item-table',\n\n    /** The header row of an item table. */\n    ITEM_TABLE_HEADER_ROW: 'item-table-header-row',\n\n    /** A row in an item table. */\n    ITEM_TABLE_ROW: 'item-table-row',\n\n    /** An interactable control which the user can execute to use an item (e.g., consumable, feature, loot, spell, weapon, etc.). */\n    ITEM_USE_COMMAND: 'item-use-command',\n\n    /** A series of properties related to an item, to be found on item summaries, item cards, and other locations where read-only item information is given. */\n    ITEM_PROPERTY_LIST: 'item-property-list',\n\n    /** A series of properties related to an item, viewed from that item's sheet. These include read-only properties, currency value, and other situational input. */\n    ITEM_SHEET_PROPERTIES: 'item-sheet-properties',\n\n    /** A summary of an item, usually taken from the item's chat data. */\n    ITEM_SUMMARY: 'item-summary',\n\n    /** A containing element for a series of item lists or grids. */\n    ITEMS_CONTAINER: 'items-container',\n\n    /** The element which contains the modifier text for melee spell attacks. */\n    MELEE_SPELL_ATTACK_MOD: 'melee-spell-attack-mod',\n\n    /**\n     * A container for a sheet name. The sheet name is usually in input, and its container has some additional styles associated with it.\n     * The container typically sits in a sheet header row with other header-related elements.\n     */\n    NAME_CONTAINER: 'name-container',\n\n    /** The sheet header row where the sheet name appears. */\n    NAME_HEADER_ROW: 'name-header-row',\n\n    /** A containing element for a series of item lists related to the NPC Abilities tab. */\n    NPC_ABILITIES_CONTAINER: 'npc-abilities-list',\n\n    /** The element which contains the modifier text for ranged spell attacks. */\n    RANGED_SPELL_ATTACK_MOD: 'ranged-spell-attack-mod',\n\n    /** A container for a single resource (first, second, third, etc.). */\n    RESOURCE: 'resource',\n\n    /** An interactable element that can clear the search input it is associated with. */\n    SEARCH_CLEAR: 'search-clear',\n\n    /** A container for a search input and its search clearing interactable element. */\n    SEARCH_CONTAINER: 'search-container',\n\n    /** A user input for performing searches. */\n    SEARCH_INPUT: 'search-input',\n\n    /** A button for toggling whether the sheet is locked or unlocked. */\n    SHEET_LOCK_TOGGLE: 'sheet-lock-toggle',\n\n    /** An interactable control that can open configuration settings for a target skill. */\n    SKILL_CONFIGURATION_CONTROL: 'skill-configuration-control',\n\n    /** A container for a single skill, including its roller, proficiency toggle, and any other elements related to the skill. */\n    SKILL_CONTAINER: 'skill-container',\n\n    /** An interactable toggle for skill proficiency. */\n    SKILL_PROFICIENCY_TOGGLE: 'skill-proficiency-toggle',\n\n    /** A rollable/interactable element which rolls a skill check. */\n    SKILL_ROLLER: 'skill-roller',\n\n    /** A list of skills for the target actor. */\n    SKILLS_LIST: 'skills-list',\n\n    /** An interactable toggle for showing/hiding unproficienct skills. */\n    SKILLS_SHOW_PROFICIENT_TOGGLE: 'skills-show-proficiency-toggle',\n\n    /** The element which contains the modifier text for spell attacks in general. This field is shown when melee and ranged spell attack mods are the same. */\n    SPELL_ATTACK_MOD: 'spell-attack-mod',\n\n    /** The element which contains spell DC. */\n    SPELL_DC: 'spell-dc',\n\n    /** A cell in a table row. */\n    TABLE_CELL: 'table-cell',\n\n    /** A cell in a table's header row. */\n    TABLE_HEADER_CELL: 'table-header-cell',\n\n    /** The header row in a table. */\n    TABLE_HEADER_ROW: 'table-header-row',\n\n    /** A row in a table. */\n    TABLE_ROW: 'table-row',\n\n    /** An interactable control that can open configuration settings for a target tool. */\n    TOOL_CONFIGURATION_CONTROL: 'tool-configuration-control',\n\n    /** A container for a single tool, including its roller, proficiency toggle, and any other elements related to the tool. */\n    TOOL_CONTAINER: 'tool-container',\n\n    /** An interactable toggle for tool proficiency. */\n    TOOL_PROFICIENCY_TOGGLE: 'tool-proficiency-toggle',\n\n    /** A rollable/interactable element which rolls a tool check. */\n    TOOL_ROLLER: 'tool-roller',\n\n    /** A list of tools for the target actor. */\n    TOOLS_LIST: 'tools-list',\n\n    /** A toolbar that usually sits at the top of a section of content, providing features like search, filtering, etc. */\n    UTILITY_TOOLBAR: 'utility-toolbar',\n\n    /** A toolbar command, usually a button */\n    UTILITY_TOOLBAR_COMMAND: 'utility-toolbar-command',\n  },\n  ACTIVATION_COST_ACTION: 'action',\n  ACTIVATION_COST_BONUS: 'bonus',\n  ACTIVATION_COST_CREW: 'crew',\n  ACTIVATION_COST_LAIR: 'lair',\n  ACTIVATION_COST_LEGENDARY: 'legendary',\n  ACTIVATION_COST_MYTHIC: 'mythic',\n  ACTIVATION_COST_NONE: 'none',\n  ACTIVATION_COST_REACTION: 'reaction',\n  ACTIVATION_COST_SPECIAL: 'special',\n  INLINE_ACTIVITIES_POSITION_TOP: 'top',\n  INLINE_ACTIVITIES_POSITION_BOTTOM: 'bottom',\n  LIMITED_USES_PER_CHARGES: 'charges',\n  LIMITED_USES_PER_DAWN: 'dawn',\n  LIMITED_USES_PER_DAY: 'day',\n  LIMITED_USES_PER_DUSK: 'dusk',\n  LIMITED_USES_PER_LONG_REST: 'lr',\n  LIMITED_USES_PER_SHORT_REST: 'sr',\n  LOCATION_SECTION: 'tidy-table-section',\n  SHEET_SETTINGS_OPTION_NONE: 'none',\n  SHEET_SETTINGS_OPTION_GM_ONLY: 'gm-only',\n  SHEET_SETTINGS_OPTION_GM_AND_OWNERS: 'gm-and-owners',\n  TEXT_EDITOR_ACTIVATION_ELEMENT_SELECTOR: '.editor-content[data-edit]',\n  SKILL_KEY_PERCEPTION: 'prc',\n  TREASURE_ANY: 'any',\n  SVELTE_CONTEXT: {\n    ACCORDION_CONTEXT: 'accordionContext',\n    APP_ID: 'appId',\n    APPLY: 'apply',\n    BUTTON_MENU_CONTEXT: 'buttonMenuContext',\n    CONFIRM: 'confirm',\n    CONTEXT: 'context',\n    CURRENT_TAB_ID: 'currentTabId',\n    EXPANDED_ITEM_DATA: 'expandedItemData',\n    EXPANDED_ITEMS: 'expandedItems',\n    FUNCTIONS: 'functions',\n    HOVERED_FACILITY_OCCUPANT: 'hoveredFacilityOccupant',\n    INITIAL_TAB_ID: 'initialTabId',\n    INLINE_TOGGLE_SERVICE: 'inlineToggleService',\n    ITEM_FILTER_SERVICE: 'itemFilterService',\n    ITEM_TABLE_TOGGLES: 'itemTableToggles',\n    LOCATION: 'location',\n    MEMBER_IDS_TO_SHOW: 'memberIdsToShow',\n    MESSAGE_BUS: 'messageBus',\n    ON_FILTER_CLEAR_ALL: 'onFilterClearAll',\n    ON_FILTER: 'onFilter',\n    ON_ITEM_TABLE_TOGGLE: 'onItemTableToggle',\n    ON_ITEM_TOGGLED: 'onItemToggled',\n    ON_SEARCH: 'onSearch',\n    ON_TAB_SELECTED: 'onTabSelected',\n    SEARCH_FILTERS: 'searchFilters',\n    SEARCH_RESULTS_STATE: 'searchResultsState',\n    SECTION_EXPANSION_TRACKER: 'sectionExpansionTracker',\n    SECTION_EXPANSION_TOGGLE_PROVIDER: 'expansionTrackerSectionToggleProvider',\n    STATS: 'stats',\n    TAB_ID: 'tabId',\n    USE_DEFAULT: 'useDefault',\n    VALIDATE: 'validate',\n  },\n} as const;\n","// ================================\n// Logger utility\n// ================================\n\nimport { CONSTANTS } from 'src/constants';\nimport { settings } from 'src/settings/settings.svelte';\n\n// 0 = none, warnings = 1, debug = 2, all = 3\nexport function debug(msg: string, args?: any) {\n  if (settings.value.debug) {\n    let formattedMsg = `DEBUG | ${CONSTANTS.MODULE_ID} | ${msg}`;\n\n    if (args !== undefined) {\n      console.log(formattedMsg, args);\n    } else {\n      console.log(formattedMsg);\n    }\n  }\n}\n\nexport function log(message: string, args?: any) {\n  message = `${CONSTANTS.MODULE_ID} | ${message}`;\n\n  const formattedLog = message.replace('<br>', '\\n');\n\n  if (args !== undefined) {\n    console.log(formattedLog, args);\n  } else {\n    console.log(formattedLog);\n  }\n}\n\nexport function notify(message: string) {\n  message = `${CONSTANTS.MODULE_ID} | ${message}`;\n  ui.notifications?.notify(message);\n  console.log(message.replace('<br>', '\\n'));\n}\n\nexport function info(info: string, notify = false, args?: any) {\n  info = `${CONSTANTS.MODULE_ID} | ${info}`;\n\n  if (notify) {\n    ui.notifications?.info(info);\n  }\n\n  const formattedInfo = info.replace('<br>', '\\n');\n\n  if (args !== undefined) {\n    console.log(formattedInfo, args);\n  } else {\n    console.log(formattedInfo);\n  }\n}\n\nexport function warn(warning: string, notify = false, args?: any) {\n  warning = `${CONSTANTS.MODULE_ID} | ${warning}`;\n\n  if (notify) {\n    ui.notifications?.warn(warning);\n  }\n\n  const formattedWarning = warning.replace('<br>', '\\n');\n\n  if (args !== undefined) {\n    console.warn(formattedWarning, args);\n  } else {\n    console.warn(formattedWarning);\n  }\n}\n\nexport function error(message: string, notify = true, args?: any) {\n  message = `${CONSTANTS.MODULE_ID} | ${message}`;\n\n  if (notify) {\n    ui.notifications?.error(message);\n  }\n\n  if (args !== undefined) {\n    console.error(message, args);\n  } else {\n    console.error(message);\n  }\n}\n","import { CONSTANTS } from 'src/constants';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { log } from 'src/utils/logging';\n\nexport class ResetSettingsDialog extends FormApplication {\n  constructor(...args: any[]) {\n    super(...args);\n    return new Dialog({\n      title: FoundryAdapter.localize(`TIDY5E.Settings.Reset.dialogs.title`),\n      content:\n        '<p style=\"margin-bottom:1rem;\">' +\n        FoundryAdapter.localize(`TIDY5E.Settings.Reset.dialogs.content`) +\n        '</p>',\n      buttons: {\n        confirm: {\n          icon: '<i class=\"fas fa-check\"></i>',\n          label: FoundryAdapter.localize(`TIDY5E.Settings.Reset.dialogs.confirm`),\n          callback: async () => {\n            const storedSettings = game.settings.storage\n              .get('world')\n              .filter((setting: any) =>\n                setting.key.startsWith(`${CONSTANTS.MODULE_ID}.`)\n              );\n\n            for (let setting of storedSettings) {\n              log(`Reset setting '${setting.key}'`);\n              await setting.delete();\n            }\n            //window.location.reload();\n          },\n        },\n        cancel: {\n          icon: '<i class=\"fas fa-times\"></i>',\n          label: FoundryAdapter.localize(`TIDY5E.Settings.Reset.dialogs.cancel`),\n        },\n      },\n      default: 'cancel',\n    });\n  }\n\n  async _updateObject(...args: any[]) {\n    // do nothing\n  }\n}\n","import { CONSTANTS } from 'src/constants';\nimport type { Tidy5eTheme } from 'src/types/theme.types';\n\nexport const defaultDarkTheme: Tidy5eTheme = {\n  name: 'TIDY5E.Settings.SheetTheme.dark',\n  id: CONSTANTS.THEME_ID_DEFAULT_DARK,\n  description: 'The default Tidy 5e Dark theme.',\n  variables: {\n    '--t5e-title-font-family':\n      \"'Modesto Condensed', 'Palatino Linotype', serif\",\n    '--t5e-body-font-family': \"'Signika', sans-serif\",\n    '--t5e-primary-font-color': 'rgba(255, 255, 255, 0.8)',\n    '--t5e-background': 'rgba(30, 30, 30, 1)',\n    '--t5e-faintest-color': 'rgba(255, 255, 255, 0.05)',\n    '--t5e-faint-color': 'rgba(255, 255, 255, 0.1)',\n    '--t5e-light-color': 'rgba(255, 255, 255, 0.25)',\n    '--t5e-primary-color': 'rgba(255, 255, 255, 0.8)',\n    '--t5e-secondary-color': 'rgba(255, 255, 255, 0.65)',\n    '--t5e-tertiary-color': 'rgba(255, 255, 255, 0.4)',\n    '--t5e-primary-accent-color': 'hsl(23.53, 80%, 50%)',\n    '--spell-level-button-available-slots-text-color': 'white',\n    '--t5e-white': 'rgba(0, 0, 0, 1)',\n    '--t5e-faint-white': 'rgba(255, 255, 255, 0.2)',\n    '--t5e-linked-accent-color': 'rgba(0, 255, 0, 0.75)',\n    '--t5e-unlinked-accent-color': 'rgba(255, 0, 0, 0.75)',\n    '--t5e-linked-light-color': 'rgba(0, 255, 0, 0.4)',\n    '--t5e-unlinked-light-color': 'rgba(255, 0, 0, 0.4)',\n    '--t5e-sheet-unlocked-icon-background': 'rgba(0, 150, 100, 0.6)',\n    '--t5e-sheet-locked-icon-background': 'rgba(255, 0, 0, 0.6)',\n    '--t5e-header-background': 'rgba(255, 255, 255, 0.05)',\n    '--t5e-prepareable-color': 'rgba(119, 136, 153, 1)',\n    '--t5e-equipped-background': 'rgba(0, 250, 180, 0.3)',\n    '--t5e-equipped-item-grid-tile-outline-color': 'rgba(50, 205, 50, 1)',\n    '--t5e-equipped-item-grid-tile-accent-color': 'rgba(173, 255, 47, 1)',\n    '--t5e-prepared-background': 'rgba(0, 250, 180, 0.3)',\n    '--t5e-prepared-item-grid-tile-outline-color': 'rgba(50, 205, 50, 1)',\n    '--t5e-prepared-item-grid-tile-accent-color': 'rgba(173, 255, 47, 1)',\n    '--t5e-pact-background': 'rgba(250, 0, 180, 0.3)',\n    '--t5e-pact-outline-color': 'rgba(250, 50, 213, 1)',\n    '--t5e-pact-accent-color': 'rgba(198, 119, 193, 1)',\n    '--t5e-atwill-background': 'rgba(226, 246, 4, 0.3)',\n    '--t5e-atwill-outline-color': 'rgba(163, 165, 50, 1)',\n    '--t5e-atwill-accent-color': 'rgba(255, 242, 0, 1)',\n    '--t5e-innate-background': 'rgba(255, 0, 0, 0.3)',\n    '--t5e-innate-outline': 'rgba(231, 23, 23, 1)',\n    '--t5e-innate-accent': 'rgba(195, 69, 69, 1)',\n    '--t5e-ritual-only-background': 'hsl(260.36deg 50% 21.96%)',\n    '--t5e-ritual-only-outline-color': 'hsl(260.36deg 50% 21.96%)',\n    '--t5e-ritual-only-accent-color': 'hsl(260.36deg 50% 21.96%)',\n    '--t5e-alwaysprepared-background': 'rgba(0, 100, 255, 0.3)',\n    '--t5e-alwaysprepared-outline-color': 'rgba(65, 105, 225, 1)',\n    '--t5e-alwaysprepared-accent-color': 'rgba(0, 191, 255, 1)',\n    '--t5e-magic-accent-color': '#ada11a',\n    '--t5e-attunement-required-color': 'var(--t5e-light-color)',\n    '--t5e-attuned-color': 'var(--t5e-primary-accent-color)',\n    '--t5e-attuned-item-grid-icon-color': 'rgba(0, 0, 0, 0.4)',\n    '--t5e-xp-bar-background': 'rgba(94, 225, 146, 1)',\n    '--t5e-encumbrance-bar-background': 'rgba(108, 138, 165, 1)',\n    '--t5e-encumbrance-bar-outline-color': 'var(--t5e-separator-color)',\n    '--t5e-encumbrance-outline-color': 'rgba(0, 0, 0, 0.9)',\n    '--t5e-encumbrance-text-color': 'rgba(238, 238, 238, 1)',\n    '--t5e-encumbrance-bar-text-shadow-color': '#000',\n    '--t5e-warning-accent-color': 'rgba(255, 30, 0, 0.65)',\n    '--t5e-warning-accent-contrast-color': 'rgba(255, 255, 255, 0.8)',\n    '--t5e-icon-background': 'rgba(30, 30, 30, 1)',\n    '--t5e-icon-shadow-color': 'rgba(0, 0, 0, 0.4)',\n    '--t5e-icon-outline-color': 'rgba(0, 0, 0, 0.4)',\n    '--t5e-icon-font-color': 'rgba(255, 255, 255, 0.4)',\n    '--t5e-icon-hover-color': 'rgba(255, 255, 255, 0.8)',\n    '--t5e-ability-modifiers-hover-label-background': 'rgba(0, 0, 0, 0.9)',\n    '--t5e-exhaustion-severity1-background': 'rgba(255, 230, 0, 1)',\n    '--t5e-exhaustion-severity2-background': 'rgba(255, 130, 0, 1)',\n    '--t5e-exhaustion-severity3-background': 'rgba(255, 50, 0, 1)',\n    '--t5e-ability-accent-background': 'rgb(80, 80, 80)',\n    '--t5e-context-outline-color': 'rgba(0, 0, 0, 0.4)',\n    '--t5e-context-shadow-color': 'rgba(0, 0, 0, 0.65)',\n    '--t5e-check-default-background-image':\n      \"url('../../modules/tidy5e-sheet/images/check-dark-unchecked.svg')\",\n    '--t5e-check-checked-background-image':\n      \"url('../../modules/tidy5e-sheet/images/check-light-checked.svg')\",\n    '--t5e-checkbox-font-color': 'rgba(255, 255, 255, 0.8)',\n    '--t5e-checkbox-outline-color': 'rgba(50, 50, 50, 1)',\n    '--t5e-checkbox-unchecked-color': 'rgba(75, 75, 75, 1)',\n    '--t5e-checkbox-checked-color': 'hsl(120deg 100% 40% / 50%)',\n    '--t5e-item-input-background': 'rgba(255, 255, 255, 0.1)',\n    '--t5e-item-input-hover-background': 'rgba(255, 255, 255, 0.2)',\n    '--t5e-death-save-icon-color': 'rgba(255, 255, 255, 0.75)',\n    '--t5e-death-save-text-color': 'white',\n    '--t5e-inspiration-hover-color': 'rgba(255, 255, 255, 0.75)',\n    '--t5e-inspiration-text-shadow-hover-color': 'rgba(118, 228, 255, 0.5)',\n    '--t5e-inspiration-inspired-text-shadow-color': '#76e4ff',\n    '--t5e-inspiration-inspired-background': 'rgba(153, 153, 153, 1)',\n    '--t5e-vehicle-motion-hover-color': 'rgba(255, 255, 255, 0.75)',\n    '--t5e-vehicle-motion-text-shadow-hover-color': 'rgba(118, 228, 255, 0.5)',\n    '--t5e-vehicle-in-motion-text-shadow-color': '#76e4ff',\n    '--t5e-vehicle-in-motion-background': 'rgba(153, 153, 153, 1)',\n    '--t5e-hp-bar-color': 'rgba(50, 149, 50, 0.6)',\n    '--t5e-resource-bar-color': 'rgba(120, 167, 242, 1)',\n    '--t5e-death-save-backdrop-background': 'rgba(255, 0, 0, 0.5)',\n    '--t5e-death-save-text-shadow-color': 'rgb(34, 34, 34)',\n    '--t5e-hp-overlay-background': 'rgba(255, 0, 0, 1)',\n    '--t5e-inventory-grid-image-contrast-text-shadow-color': 'rgba(0, 0, 0, 1)',\n    '--t5e-inventory-grid-hover-use-item-contrast-text-shadow-color':\n      'rgba(255, 255, 255, 1)',\n    '--t5e-sheet-background': 'var(--t5e-background)',\n    '--t5e-item-info-card-background': 'var(--t5e-background)',\n    '--t5e-content-entity-link-color': 'var(--t5e-primary-font-color)',\n    '--t5e-content-entity-link-hover-color': 'var(--t5e-primary-font-color)',\n    '--t5e-content-entity-link-background': 'var(--t5e-faint-color)',\n    '--t5e-content-entity-link-hover-background':\n      'var(--t5e-primary-accent-color)',\n    '--t5e-activated-profile-toggle-color': 'var(--t5e-primary-font-color)',\n    '--t5e-exhaustion-severity1-color': 'var(--t5e-icon-outline-color)',\n    '--t5e-exhaustion-severity2-color': 'rgba(255, 255, 255, 0.7)',\n    '--t5e-exhaustion-severity3-color': 'rgba(255, 255, 255, 0.7)',\n    '--t5e-tinymce-toolbar-background': '#fff',\n    '--t5e-tinymce-sidebar-background': 'var(--t5e-secondary-color)',\n    '--t5e-tinyme-toolbar-button-color': '#222',\n    '--t5e-prosemirror-button-color': 'rgba(100, 100, 100, 1)',\n    '--t5e-prosemirror-dropdown-item-hover-color': 'rgba(50, 50, 50, 1)',\n    '--t5e-item-info-card-box-shadow-color': 'rgba(0, 0, 0, 0.5)',\n    '--t5e-sheet-lock-icon-color': 'rgba(255, 255, 255, 0.6)',\n    '--t5e-grid-pane-favorite-icon-color': 'rgba(0, 200, 100, 1)',\n    '--t5e-settings-dialog-box-shadow-color': 'rgba(0, 0, 0, 0.75)',\n    '--t5e-sheet-lock-icon-hover-color': '#fff',\n    '--t5e-settings-dialog-border-color': '#ff6400',\n    '--t5e-spell-level-button-border-color': '#c9c7b8',\n    '--t5e-ability-modifiers-label-text-color': '#fff',\n    '--t5e-ability-mod-text-color': '#fff',\n    '--t5e-ability-mod-save-text-hover-color': '#fff',\n    '--t5e-button-menu-background': 'var(--t5e-sheet-background)',\n    '--t5e-button-menu-hover-color': 'var(--t5e-faint-color)',\n    '--t5e-button-menu-divider-color': 'var(--t5e-separator-color)',\n    '--t5e-focus-visible-box-shadow':\n      '-0.0625rem -0.0625rem 0 var(--t5e-primary-accent-color), -0.0625rem 0.0625rem 0 var(--t5e-primary-accent-color), 0.0625rem 0.0625rem 0 var(--t5e-primary-accent-color), 0.0625rem -0.0625rem 0 var(--t5e-primary-accent-color)',\n    '--t5e-button-background': 'var(--t5e-faintest-color)',\n    '--t5e-button-hover-background': 'var(--t5e-faint-color)',\n    '--t5e-button-disabled-color': 'var(--t5e-light-color)',\n    '--t5e-separator-color': 'rgba(120, 120, 120, 0.1)',\n    '--t5e-table-header-row-color': '#111111',\n    '--t5e-table-header-row-border-color': '#111111',\n    '--t5e-tab-strip-border-color': 'transparent',\n    '--t5e-tabs-background': 'var(--t5e-header-background)',\n    '--t5e-active-tab-background': 'var(--t5e-sheet-background)',\n    '--t5e-tab-background': 'transparent',\n    '--t5e-scrollbar-thumb-color': '#782e22',\n    '--t5e-scrollbar-track-color': '#0000',\n    '--t5e-spell-pip-active-background': 'var(--t5e-primary-accent-color)',\n    '--t5e-spell-pip-empty-background': 'transparent',\n    '--t5e-spell-pip-border-color': 'var(--t5e-primary-accent-color)',\n    '--t5e-switch-slider-color': '#DDD',\n  },\n  type: 'dark',\n};\n","import { CONSTANTS } from 'src/constants';\nimport type { Tidy5eTheme } from 'src/types/theme.types';\n\nexport const defaultLightTheme: Tidy5eTheme = {\n  name: 'TIDY5E.Settings.SheetTheme.light',\n  id: CONSTANTS.THEME_ID_DEFAULT_LIGHT,\n  description: 'The default Tidy 5e Light theme.',\n  variables: {\n    '--t5e-title-font-family':\n      \"'Modesto Condensed', 'Palatino Linotype', serif\",\n    '--t5e-body-font-family': \"'Signika', sans-serif\",\n    '--t5e-primary-font-color': 'rgba(0, 0, 0, 0.9)',\n    '--t5e-background': '#f1ebe8',\n    '--t5e-faintest-color': 'rgba(0, 0, 0, 0.05)',\n    '--t5e-faint-color': 'rgba(0, 0, 0, 0.1)',\n    '--t5e-light-color': 'rgba(0, 0, 0, 0.25)',\n    '--t5e-primary-color': 'rgba(0, 0, 0, 0.9)',\n    '--t5e-secondary-color': 'rgba(0, 0, 0, 0.65)',\n    '--t5e-tertiary-color': 'rgba(0, 0, 0, 0.4)',\n    '--t5e-primary-accent-color': 'rgba(255, 100, 0, 1)',\n    '--spell-level-button-available-slots-text-color': 'white',\n    '--t5e-white': 'rgba(255, 255, 255, 1)',\n    '--t5e-faint-white': 'rgba(255, 255, 255, 0.2)',\n    '--t5e-linked-accent-color': 'rgba(0, 255, 0, 0.75)',\n    '--t5e-unlinked-accent-color': 'rgba(255, 0, 0, 0.75)',\n    '--t5e-linked-light-color': 'rgba(0, 255, 0, 0.4)',\n    '--t5e-unlinked-light-color': 'rgba(255, 0, 0, 0.4)',\n    '--t5e-sheet-unlocked-icon-background': 'rgba(0, 150, 100, 0.6)',\n    '--t5e-sheet-locked-icon-background': 'rgba(255, 0, 0, 0.6)',\n    '--t5e-header-background': 'rgba(255, 255, 255, 0.2)',\n    '--t5e-prepareable-color': 'rgba(119, 136, 153, 1)',\n    '--t5e-equipped-background': 'rgba(50, 205, 50, 0.3)',\n    '--t5e-equipped-item-grid-tile-outline-color': 'rgba(50, 205, 50, 1)',\n    '--t5e-equipped-item-grid-tile-accent-color': 'rgba(173, 255, 47, 1)',\n    '--t5e-prepared-background': 'rgba(50, 205, 50, 0.3)',\n    '--t5e-prepared-item-grid-tile-outline-color': 'rgba(50, 205, 50, 1)',\n    '--t5e-prepared-item-grid-tile-accent-color': 'rgba(173, 255, 47, 1)',\n    '--t5e-pact-background': 'rgba(250, 0, 180, 0.3)',\n    '--t5e-pact-outline-color': 'rgba(250, 50, 213, 1)',\n    '--t5e-pact-accent-color': 'rgba(198, 119, 193, 1)',\n    '--t5e-atwill-background': 'rgba(226, 246, 4, 0.3)',\n    '--t5e-atwill-outline-color': 'rgba(163, 165, 50, 1)',\n    '--t5e-atwill-accent-color': 'rgba(255, 242, 0, 1)',\n    '--t5e-innate-background': 'rgba(255, 0, 0, 0.3)',\n    '--t5e-innate-outline': 'rgba(231, 23, 23, 1)',\n    '--t5e-innate-accent': 'rgba(195, 69, 69, 1)',\n    '--t5e-ritual-only-background': 'hsl(260.09deg 100% 45.1% / 25.88%)',\n    '--t5e-ritual-only-outline-color': 'hsl(260.09deg 100% 45.1% / 25.88%)',\n    '--t5e-ritual-only-accent-color': 'hsl(260.09deg 100% 45.1% / 25.88%)',\n    '--t5e-alwaysprepared-background': 'rgba(0, 0, 255, 0.15)',\n    '--t5e-alwaysprepared-outline-color': 'rgba(65, 105, 225, 1)',\n    '--t5e-alwaysprepared-accent-color': 'rgba(0, 191, 255, 1)',\n    '--t5e-magic-accent-color': '#ada11a',\n    '--t5e-attunement-required-color': 'var(--t5e-light-color)',\n    '--t5e-attuned-color': 'var(--t5e-primary-accent-color)',\n    '--t5e-attuned-item-grid-icon-color': 'rgba(0, 0, 0, 0.4)',\n    '--t5e-xp-bar-background': 'rgba(94, 225, 146, 1)',\n    '--t5e-encumbrance-bar-background': 'rgba(108, 138, 165, 1)',\n    '--t5e-encumbrance-bar-outline-color': 'var(--t5e-separator-color)',\n    '--t5e-encumbrance-outline-color': 'rgba(0, 0, 0, 0.9)',\n    '--t5e-encumbrance-text-color': 'rgba(238, 238, 238, 1)',\n    '--t5e-encumbrance-bar-text-shadow-color': '#000',\n    '--t5e-warning-accent-color': 'rgba(255, 0, 0, 0.6)',\n    '--t5e-warning-accent-contrast-color': 'rgba(255, 255, 255, 0.8)',\n    '--t5e-icon-background': 'rgba(236, 233, 223, 1)',\n    '--t5e-icon-shadow-color': 'rgba(0, 0, 0, 0.4)',\n    '--t5e-icon-outline-color': 'rgba(0, 0, 0, 0.4)',\n    '--t5e-icon-font-color': 'rgba(0, 0, 0, 0.4)',\n    '--t5e-icon-hover-color': 'rgba(0, 0, 0, 0.9)',\n    '--t5e-ability-modifiers-hover-label-background': 'rgba(0, 0, 0, 0.9)',\n    '--t5e-exhaustion-severity1-background': 'rgba(255, 230, 0, 1)',\n    '--t5e-exhaustion-severity2-background': 'rgba(255, 130, 0, 1)',\n    '--t5e-exhaustion-severity3-background': 'rgba(255, 50, 0, 1)',\n    '--t5e-ability-accent-background': 'darkslategrey',\n    '--t5e-context-outline-color': 'rgba(0, 0, 0, 0.4)',\n    '--t5e-context-shadow-color': 'rgba(0, 0, 0, 0.65)',\n    '--t5e-check-default-background-image':\n      \"url('../../modules/tidy5e-sheet/images/check-dark-unchecked.svg')\",\n    '--t5e-check-checked-background-image':\n      \"url('../../modules/tidy5e-sheet/images/check-dark-checked.svg')\",\n    '--t5e-checkbox-font-color': 'rgba(0, 0, 0, 0.9)',\n    '--t5e-checkbox-outline-color': 'rgba(150, 150, 150, 1)',\n    '--t5e-checkbox-unchecked-color': '#d8d7d1',\n    '--t5e-checkbox-checked-color': 'rgba(0, 255, 0, 0.3)',\n    '--t5e-item-input-background': 'rgba(255, 255, 255, 0.3)',\n    '--t5e-item-input-hover-background': 'rgba(255, 255, 255, 0.5)',\n    '--t5e-death-save-icon-color': 'rgba(255, 255, 255, 0.75)',\n    '--t5e-death-save-text-color': 'white',\n    '--t5e-inspiration-hover-color': 'rgba(255, 255, 255, 0.75)',\n    '--t5e-inspiration-text-shadow-hover-color': 'rgba(118, 228, 255, 0.5)',\n    '--t5e-inspiration-inspired-text-shadow-color': '#76e4ff',\n    '--t5e-inspiration-inspired-background': 'rgba(153, 153, 153, 1)',\n    '--t5e-vehicle-motion-hover-color': 'rgba(255, 255, 255, 0.75)',\n    '--t5e-vehicle-motion-text-shadow-hover-color': 'rgba(118, 228, 255, 0.5)',\n    '--t5e-vehicle-in-motion-text-shadow-color': '#76e4ff',\n    '--t5e-vehicle-in-motion-background': 'rgba(153, 153, 153, 1)',\n    '--t5e-hp-bar-color': 'rgba(0, 200, 0, 0.6)',\n    '--t5e-resource-bar-color': 'rgba(120, 167, 242, 1)',\n    '--t5e-death-save-backdrop-background': 'rgba(255, 0, 0, 0.5)',\n    '--t5e-death-save-text-shadow-color': 'rgb(34, 34, 34)',\n    '--t5e-hp-overlay-background': 'rgba(255, 0, 0, 1)',\n    '--t5e-inventory-grid-image-contrast-text-shadow-color': 'rgba(0, 0, 0, 1)',\n    '--t5e-inventory-grid-hover-use-item-contrast-text-shadow-color':\n      'rgba(255, 255, 255, 1)',\n    '--t5e-item-info-card-background': `url(../../modules/tidy5e-sheet/images/parchment-texture-top.webp) no-repeat top center / 150% auto, #f1ebe8 url(../../modules/tidy5e-sheet/images/parchment-texture-bottom.webp) no-repeat bottom center / 150% auto;`,\n    '--t5e-content-entity-link-color': 'var(--t5e-primary-font-color)',\n    '--t5e-content-entity-link-hover-color': 'var(--t5e-white)',\n    '--t5e-content-entity-link-background': 'var(--t5e-faintest-color)',\n    '--t5e-content-entity-link-hover-background':\n      'var(--t5e-primary-accent-color)',\n    '--t5e-activated-profile-toggle-color': 'var(--t5e-white)',\n    '--t5e-exhaustion-severity1-color': 'var(--t5e-icon-font-color)',\n    '--t5e-exhaustion-severity2-color': 'rgba(255, 255, 255, 0.7)',\n    '--t5e-exhaustion-severity3-color': 'rgba(255, 255, 255, 0.7)',\n    '--t5e-tinymce-toolbar-background': 'transparent',\n    '--t5e-prosemirror-button-color': '#deded3',\n    '--t5e-prosemirror-dropdown-item-hover-color': 'var(--t5e-faint-color)',\n    '--t5e-item-info-card-box-shadow-color': 'rgba(0, 0, 0, 0.5)',\n    '--t5e-sheet-lock-icon-color': 'rgba(255, 255, 255, 0.6)',\n    '--t5e-grid-pane-favorite-icon-color': 'rgba(0, 200, 100, 1)',\n    '--t5e-settings-dialog-box-shadow-color': 'rgba(0, 0, 0, 0.75)',\n    '--t5e-sheet-lock-icon-hover-color': '#fff',\n    '--t5e-settings-dialog-border-color': '#ff6400',\n    '--t5e-spell-level-button-border-color': '#c9c7b8',\n    '--t5e-ability-modifiers-label-text-color': '#fff',\n    '--t5e-ability-mod-text-color': '#fff',\n    '--t5e-ability-mod-save-text-hover-color': '#fff',\n    '--t5e-button-menu-background': 'var(--t5e-background)',\n    '--t5e-button-menu-hover-color': 'var(--t5e-faint-color)',\n    '--t5e-button-menu-divider-color': 'var(--t5e-separator-color)',\n    '--t5e-focus-visible-box-shadow':\n      '-0.0625rem -0.0625rem 0 var(--t5e-primary-accent-color), -0.0625rem 0.0625rem 0 var(--t5e-primary-accent-color), 0.0625rem 0.0625rem 0 var(--t5e-primary-accent-color), 0.0625rem -0.0625rem 0 var(--t5e-primary-accent-color)',\n    '--t5e-button-background': 'var(--t5e-faint-color)',\n    '--t5e-button-hover-background': 'var(--t5e-faintest-color)',\n    '--t5e-button-disabled-color': 'var(--t5e-light-color)',\n    '--t5e-separator-color': 'var(--t5e-light-color)',\n    '--t5e-table-header-row-color': 'var(--t5e-faint-color)',\n    '--t5e-table-header-row-border-color': 'var(--t5e-light-color)',\n    '--t5e-tab-strip-border-color': 'rgba(0, 0, 0, 0.25)',\n    '--t5e-active-tab-background': 'transparent',\n    '--t5e-tab-background': 'var(--t5e-header-background)',\n    '--t5e-scrollbar-thumb-color': '#782e22',\n    '--t5e-scrollbar-track-color': '#0000',\n    '--t5e-spell-pip-active-background': 'var(--t5e-primary-accent-color)',\n    '--t5e-spell-pip-empty-background': 'transparent',\n    '--t5e-spell-pip-border-color': 'var(--t5e-primary-accent-color)',\n    '--t5e-switch-slider-color': '#FFF',\n  },\n  type: 'light',\n};\n","import { CONSTANTS } from 'src/constants';\nimport { defaultDarkTheme } from './default-dark-theme';\nimport { defaultLightTheme } from './default-light-theme';\nimport type { Tidy5eTheme } from 'src/types/theme.types';\n\nexport function getCoreThemes(includeDefault: boolean) {\n  let themes: Record<string, string> = {};\n\n  if (includeDefault) {\n    themes[CONSTANTS.THEME_ID_DEFAULT] = 'TIDY5E.Settings.SheetTheme.default';\n  }\n\n  themes[CONSTANTS.THEME_ID_DEFAULT_LIGHT] = defaultLightTheme.name;\n  themes[CONSTANTS.THEME_ID_DEFAULT_DARK] = defaultDarkTheme.name;\n\n  return themes;\n}\n\n/**\n * Provides a record where the key is the theme ID and the value is the theme definition.\n * @returns all registered themes\n */\nexport function getThemes(): Record<string, Tidy5eTheme> {\n  return {\n    [CONSTANTS.THEME_ID_DEFAULT_LIGHT]: defaultLightTheme,\n    [CONSTANTS.THEME_ID_DEFAULT_DARK]: defaultDarkTheme,\n  };\n}\n\nexport const themeVariables = {\n  '--t5e-title-font-family': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-body-font-family': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-primary-font-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-faintest-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-faint-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-light-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-primary-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-secondary-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-tertiary-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-primary-accent-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--spell-level-button-available-slots-text-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-white': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-faint-white': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-linked-accent-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-unlinked-accent-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-linked-light-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-unlinked-light-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-sheet-unlocked-icon-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-sheet-locked-icon-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-header-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-prepareable-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-equipped-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-equipped-item-grid-tile-outline-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-equipped-item-grid-tile-accent-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-prepared-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-prepared-item-grid-tile-outline-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-prepared-item-grid-tile-accent-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-pact-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-pact-outline-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-pact-accent-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-atwill-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-atwill-outline-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-atwill-accent-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-ritual-only-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-ritual-only-outline-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-ritual-only-accent-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-innate-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-innate-outline': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-innate-accent': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-alwaysprepared-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-alwaysprepared-outline-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-alwaysprepared-accent-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-magic-accent-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-attunement-required-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-attuned-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-attuned-item-grid-icon-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-xp-bar-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-encumbrance-bar-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-encumbrance-bar-outline-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-encumbrance-outline-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-warning-accent-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-warning-accent-contrast-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-icon-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-icon-shadow-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-icon-outline-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-icon-font-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-icon-hover-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-ability-modifiers-hover-label-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-exhaustion-severity1-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-exhaustion-severity2-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-exhaustion-severity3-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-ability-accent-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-context-outline-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-context-shadow-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-check-default-background-image': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-check-checked-background-image': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-checkbox-font-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-checkbox-outline-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-checkbox-unchecked-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-checkbox-checked-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-item-input-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-item-input-hover-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-encumbrance-text-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-death-save-icon-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-inspiration-hover-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-inspiration-text-shadow-hover-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-inspiration-inspired-text-shadow-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-inspiration-inspired-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-vehicle-motion-hover-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-vehicle-motion-text-shadow-hover-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-vehicle-in-motion-text-shadow-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-vehicle-in-motion-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-hp-bar-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-resource-bar-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-death-save-backdrop-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-death-save-text-shadow-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-hp-overlay-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-inventory-grid-image-contrast-text-shadow-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-inventory-grid-hover-use-item-contrast-text-shadow-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-sheet-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-item-info-card-background': {\n    type: 'todo',\n    group: 'todo,',\n  },\n  '--t5e-content-entity-link-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-content-entity-link-hover-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-content-entity-link-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-content-entity-link-hover-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-activated-profile-toggle-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-exhaustion-severity1-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-exhaustion-severity2-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-exhaustion-severity3-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-death-save-text-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-tinymce-toolbar-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-tinymce-sidebar-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-tinyme-toolbar-button-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-prosemirror-button-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-prosemirror-dropdown-item-hover-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-item-info-card-box-shadow-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-sheet-lock-icon-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-grid-pane-favorite-icon-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-settings-dialog-box-shadow-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-sheet-lock-icon-hover-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-settings-dialog-border-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-spell-level-button-border-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-ability-modifiers-label-text-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-ability-mod-text-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-ability-mod-save-text-hover-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-encumbrance-bar-text-shadow-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-button-menu-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-button-menu-hover-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-button-menu-divider-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-focus-visible-box-shadow': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-button-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-button-hover-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-button-disabled-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-separator-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-table-header-row-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-table-header-row-border-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-tab-strip-border-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-tabs-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-active-tab-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-tab-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-scrollbar-thumb-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-scrollbar-track-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-spell-pip-active-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-spell-pip-empty-background': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-spell-pip-border-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n  '--t5e-switch-slider-color': {\n    type: 'todo',\n    group: 'todo',\n  },\n};\n","var r={grad:.9,turn:360,rad:360/(2*Math.PI)},t=function(r){return\"string\"==typeof r?r.length>0:\"number\"==typeof r},n=function(r,t,n){return void 0===t&&(t=0),void 0===n&&(n=Math.pow(10,t)),Math.round(n*r)/n+0},e=function(r,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),r>n?n:r>t?r:t},u=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},a=function(r){return{r:e(r.r,0,255),g:e(r.g,0,255),b:e(r.b,0,255),a:e(r.a)}},o=function(r){return{r:n(r.r),g:n(r.g),b:n(r.b),a:n(r.a,3)}},i=/^#([0-9a-f]{3,8})$/i,s=function(r){var t=r.toString(16);return t.length<2?\"0\"+t:t},h=function(r){var t=r.r,n=r.g,e=r.b,u=r.a,a=Math.max(t,n,e),o=a-Math.min(t,n,e),i=o?a===t?(n-e)/o:a===n?2+(e-t)/o:4+(t-n)/o:0;return{h:60*(i<0?i+6:i),s:a?o/a*100:0,v:a/255*100,a:u}},b=function(r){var t=r.h,n=r.s,e=r.v,u=r.a;t=t/360*6,n/=100,e/=100;var a=Math.floor(t),o=e*(1-n),i=e*(1-(t-a)*n),s=e*(1-(1-t+a)*n),h=a%6;return{r:255*[e,i,o,o,s,e][h],g:255*[s,e,e,i,o,o][h],b:255*[o,o,s,e,e,i][h],a:u}},g=function(r){return{h:u(r.h),s:e(r.s,0,100),l:e(r.l,0,100),a:e(r.a)}},d=function(r){return{h:n(r.h),s:n(r.s),l:n(r.l),a:n(r.a,3)}},f=function(r){return b((n=(t=r).s,{h:t.h,s:(n*=((e=t.l)<50?e:100-e)/100)>0?2*n/(e+n)*100:0,v:e+n,a:t.a}));var t,n,e},c=function(r){return{h:(t=h(r)).h,s:(u=(200-(n=t.s))*(e=t.v)/100)>0&&u<200?n*e/100/(u<=100?u:200-u)*100:0,l:u/2,a:t.a};var t,n,e,u},l=/^hsla?\\(\\s*([+-]?\\d*\\.?\\d+)(deg|rad|grad|turn)?\\s*,\\s*([+-]?\\d*\\.?\\d+)%\\s*,\\s*([+-]?\\d*\\.?\\d+)%\\s*(?:,\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*)?\\)$/i,p=/^hsla?\\(\\s*([+-]?\\d*\\.?\\d+)(deg|rad|grad|turn)?\\s+([+-]?\\d*\\.?\\d+)%\\s+([+-]?\\d*\\.?\\d+)%\\s*(?:\\/\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*)?\\)$/i,v=/^rgba?\\(\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*,\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*,\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*(?:,\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*)?\\)$/i,m=/^rgba?\\(\\s*([+-]?\\d*\\.?\\d+)(%)?\\s+([+-]?\\d*\\.?\\d+)(%)?\\s+([+-]?\\d*\\.?\\d+)(%)?\\s*(?:\\/\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*)?\\)$/i,y={string:[[function(r){var t=i.exec(r);return t?(r=t[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:4===r.length?n(parseInt(r[3]+r[3],16)/255,2):1}:6===r.length||8===r.length?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:8===r.length?n(parseInt(r.substr(6,2),16)/255,2):1}:null:null},\"hex\"],[function(r){var t=v.exec(r)||m.exec(r);return t?t[2]!==t[4]||t[4]!==t[6]?null:a({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},\"rgb\"],[function(t){var n=l.exec(t)||p.exec(t);if(!n)return null;var e,u,a=g({h:(e=n[1],u=n[2],void 0===u&&(u=\"deg\"),Number(e)*(r[u]||1)),s:Number(n[3]),l:Number(n[4]),a:void 0===n[5]?1:Number(n[5])/(n[6]?100:1)});return f(a)},\"hsl\"]],object:[[function(r){var n=r.r,e=r.g,u=r.b,o=r.a,i=void 0===o?1:o;return t(n)&&t(e)&&t(u)?a({r:Number(n),g:Number(e),b:Number(u),a:Number(i)}):null},\"rgb\"],[function(r){var n=r.h,e=r.s,u=r.l,a=r.a,o=void 0===a?1:a;if(!t(n)||!t(e)||!t(u))return null;var i=g({h:Number(n),s:Number(e),l:Number(u),a:Number(o)});return f(i)},\"hsl\"],[function(r){var n=r.h,a=r.s,o=r.v,i=r.a,s=void 0===i?1:i;if(!t(n)||!t(a)||!t(o))return null;var h=function(r){return{h:u(r.h),s:e(r.s,0,100),v:e(r.v,0,100),a:e(r.a)}}({h:Number(n),s:Number(a),v:Number(o),a:Number(s)});return b(h)},\"hsv\"]]},N=function(r,t){for(var n=0;n<t.length;n++){var e=t[n][0](r);if(e)return[e,t[n][1]]}return[null,void 0]},x=function(r){return\"string\"==typeof r?N(r.trim(),y.string):\"object\"==typeof r&&null!==r?N(r,y.object):[null,void 0]},I=function(r){return x(r)[1]},M=function(r,t){var n=c(r);return{h:n.h,s:e(n.s+100*t,0,100),l:n.l,a:n.a}},H=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},$=function(r,t){var n=c(r);return{h:n.h,s:n.s,l:e(n.l+100*t,0,100),a:n.a}},j=function(){function r(r){this.parsed=x(r)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return null!==this.parsed},r.prototype.brightness=function(){return n(H(this.rgba),2)},r.prototype.isDark=function(){return H(this.rgba)<.5},r.prototype.isLight=function(){return H(this.rgba)>=.5},r.prototype.toHex=function(){return r=o(this.rgba),t=r.r,e=r.g,u=r.b,i=(a=r.a)<1?s(n(255*a)):\"\",\"#\"+s(t)+s(e)+s(u)+i;var r,t,e,u,a,i},r.prototype.toRgb=function(){return o(this.rgba)},r.prototype.toRgbString=function(){return r=o(this.rgba),t=r.r,n=r.g,e=r.b,(u=r.a)<1?\"rgba(\"+t+\", \"+n+\", \"+e+\", \"+u+\")\":\"rgb(\"+t+\", \"+n+\", \"+e+\")\";var r,t,n,e,u},r.prototype.toHsl=function(){return d(c(this.rgba))},r.prototype.toHslString=function(){return r=d(c(this.rgba)),t=r.h,n=r.s,e=r.l,(u=r.a)<1?\"hsla(\"+t+\", \"+n+\"%, \"+e+\"%, \"+u+\")\":\"hsl(\"+t+\", \"+n+\"%, \"+e+\"%)\";var r,t,n,e,u},r.prototype.toHsv=function(){return r=h(this.rgba),{h:n(r.h),s:n(r.s),v:n(r.v),a:n(r.a,3)};var r},r.prototype.invert=function(){return w({r:255-(r=this.rgba).r,g:255-r.g,b:255-r.b,a:r.a});var r},r.prototype.saturate=function(r){return void 0===r&&(r=.1),w(M(this.rgba,r))},r.prototype.desaturate=function(r){return void 0===r&&(r=.1),w(M(this.rgba,-r))},r.prototype.grayscale=function(){return w(M(this.rgba,-1))},r.prototype.lighten=function(r){return void 0===r&&(r=.1),w($(this.rgba,r))},r.prototype.darken=function(r){return void 0===r&&(r=.1),w($(this.rgba,-r))},r.prototype.rotate=function(r){return void 0===r&&(r=15),this.hue(this.hue()+r)},r.prototype.alpha=function(r){return\"number\"==typeof r?w({r:(t=this.rgba).r,g:t.g,b:t.b,a:r}):n(this.rgba.a,3);var t},r.prototype.hue=function(r){var t=c(this.rgba);return\"number\"==typeof r?w({h:r,s:t.s,l:t.l,a:t.a}):n(t.h)},r.prototype.isEqual=function(r){return this.toHex()===w(r).toHex()},r}(),w=function(r){return r instanceof j?r:new j(r)},S=[],k=function(r){r.forEach(function(r){S.indexOf(r)<0&&(r(j,y),S.push(r))})},E=function(){return new j({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})};export{j as Colord,w as colord,k as extend,I as getFormat,E as random};\n","import type {\n  ThemeColorSetting,\n  Tidy5eTheme as Tidy5eTheme,\n  Tidy5eThemeDataV1,\n} from 'src/types/theme.types';\nimport { themeVariables } from './theme-reference';\nimport { debug } from 'src/utils/logging';\nimport { SettingsProvider } from 'src/settings/settings.svelte';\nimport { defaultDarkTheme } from './default-dark-theme';\nimport { defaultLightTheme } from './default-light-theme';\nimport { Colord } from 'colord';\nimport { CONSTANTS } from 'src/constants';\nimport type { Item5e } from 'src/types/item.types';\n\nexport function applyTheme(\n  theme: Tidy5eTheme,\n  colorPickerEnabledOverride: boolean | null = null\n) {\n  try {\n    const styleTagId = 'tidy5e-sheet-theme';\n    let existingThemeStyle = document.getElementById(styleTagId);\n\n    if (existingThemeStyle) {\n      existingThemeStyle.remove();\n    }\n\n    // Temporary measure for applying color overrides. Larger theme overhaul coming later.\n    const overrideBaseTheme =\n      (colorPickerEnabledOverride === null &&\n        SettingsProvider.settings.colorPickerEnabled.get()) ||\n      colorPickerEnabledOverride;\n\n    if (overrideBaseTheme) {\n      theme = overrideColorPickerSettings(theme);\n    }\n\n    document.head.insertAdjacentHTML(\n      'beforeend',\n      `\n    <style id=\"${styleTagId}\">\n      :root {\n        ${Object.entries(theme.variables)\n          .filter(([variable]) => variable in themeVariables)\n          .map(([variable, value]) => `${variable}: ${value};`)\n          .join('\\n')}\n      }\n    </style>\n    `\n    );\n  } catch (e) {\n    console.error(e);\n    debug(\n      'Unable to apply Tidy 5e style tag; falling back to root style properties.'\n    );\n    Object.keys(themeVariables).forEach((variable) => {\n      document.documentElement.style.setProperty(\n        variable,\n        theme.variables[variable] ?? null\n      );\n    });\n  }\n}\n\nfunction overrideColorPickerSettings(theme: Tidy5eTheme) {\n  const overriddenTheme = structuredClone(theme);\n\n  const themeableColors = getThemeableColors();\n  for (let color of themeableColors) {\n    overriddenTheme.variables[color.cssVariable] = SettingsProvider.settings[\n      color.key\n    ]\n      .get()\n      ?.toString();\n  }\n\n  return overriddenTheme;\n}\n\nexport function applyCurrentTheme(\n  colorPickerEnabledOverride: boolean | null = null\n) {\n  const currentTheme = SettingsProvider.settings.colorScheme.get();\n  SettingsProvider.settings.colorScheme.options.onChange(\n    currentTheme,\n    colorPickerEnabledOverride\n  );\n}\n\nexport function getThemeableColors(): ThemeColorSetting[] {\n  return Object.entries(SettingsProvider.settings)\n    .filter(([, value]) => 'representsCssVariable' in value)\n    .map(([key, value]) => ({\n      key: key as any,\n      name: value.options.name,\n      hint: 'hint' in value.options ? value.options.hint : '',\n      cssVariable:\n        'representsCssVariable' in value ? value.representsCssVariable : '',\n    }));\n}\n\nexport function getThemeOrDefault(themeId: string): Tidy5eTheme {\n  if (themeId === CONSTANTS.THEME_ID_DEFAULT) {\n    const defaultThemeId = SettingsProvider.settings.defaultTheme.get();\n    themeId = defaultThemeId;\n  }\n\n  const themes: Record<string, Tidy5eTheme> = {\n    light: defaultLightTheme,\n    dark: defaultDarkTheme,\n    // TODO: Aggregate all other available themes\n  };\n\n  return themes[themeId] ?? defaultLightTheme;\n}\n\ntype ProcessedColor = {\n  original: string;\n  hexa?: string;\n  parsed: boolean;\n};\n\nexport function trySetRootCssVariable(\n  cssVariable: string,\n  value: string,\n  colorPickerEnabled: boolean\n) {\n  if (colorPickerEnabled) {\n    document.documentElement.style.setProperty(cssVariable, value);\n  }\n}\n\nexport function clearTidy5eRootCssVariables() {\n  Object.keys(themeVariables).forEach((key) =>\n    document.documentElement.style.removeProperty(key)\n  );\n}\n\nexport function colorToHexaString(color: Colord | undefined): string {\n  if (color?.isValid()) {\n    return color.toHex();\n  }\n\n  return '';\n}\n\nexport function settingValueToHexaString(value: string): ProcessedColor {\n  const result = colorToHexaString(new Colord(value.toString()));\n\n  if (result !== '') {\n    return {\n      original: value?.toString() ?? '',\n      hexa: result,\n      parsed: true,\n    };\n  }\n\n  var ctx = document.createElement('canvas').getContext('2d');\n  if (ctx) {\n    ctx.fillStyle = value?.toString() ?? '';\n    return {\n      original: value,\n      hexa: ctx.fillStyle,\n      parsed: true,\n    };\n  }\n\n  return {\n    original: value,\n    parsed: true,\n  };\n}\n\nexport function extractSettingsUpdateDeltaFromTheme(\n  theme: Tidy5eThemeDataV1,\n  themeableColors: ThemeColorSetting[]\n) {\n  return Object.keys(theme.variables).reduce<Record<string, string>>(\n    (prev, key) => {\n      const themeableColor = themeableColors.find((c) => c.cssVariable === key);\n      if (themeableColor) {\n        prev[themeableColor.key] = theme.variables[key];\n      }\n\n      return prev;\n    },\n    {}\n  );\n}\n\nexport function validateImportFile(theme: Tidy5eThemeDataV1) {\n  return theme.version === 1 && typeof theme.variables === 'object';\n}\n\nexport function getInventoryItemThemeBackground(item: Item5e) {\n  if (item?.system?.equipped) {\n    return '--t5e-equipped-background';\n  }\n}\n\nexport function getSpellItemThemeBackground(spell: Item5e) {\n  if (\n    spell.system.preparation.mode === CONSTANTS.SPELL_PREPARATION_MODE_INNATE\n  ) {\n    return '--t5e-innate-background';\n  }\n\n  if (\n    spell.system.preparation.mode === CONSTANTS.SPELL_PREPARATION_MODE_RITUAL\n  ) {\n    return '--t5e-ritual-only-background';\n  }\n\n  if (\n    spell.system.preparation.mode === CONSTANTS.SPELL_PREPARATION_MODE_ATWILL\n  ) {\n    return '--t5e-atwill-background';\n  }\n\n  if (spell.system.preparation.mode === CONSTANTS.SPELL_PREPARATION_MODE_PACT) {\n    return '--t5e-pact-background';\n  }\n\n  if (\n    spell.system.preparation.mode === CONSTANTS.SPELL_PREPARATION_MODE_ALWAYS\n  ) {\n    return '--t5e-alwaysprepared-background';\n  }\n\n  if (spell.system.preparation.prepared) {\n    return '--t5e-prepared-background';\n  }\n\n  // TODO: in the future, offer up and API for this, or use a slugify convention based on what modes exist\n}\n","import { CONSTANTS } from 'src/constants';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { unmount } from 'svelte';\n\nexport default abstract class SvelteFormApplicationBase extends FormApplication {\n  component: Record<string, any> | undefined;\n  staticExtraApplicationClasses: string[] = [];\n\n  constructor(...args: any[]) {\n    super(...args);\n  }\n\n  static get defaultOptions() {\n    return {\n      ...super.defaultOptions,\n      classes: [\n        CONSTANTS.MODULE_ID,\n        'application-shell',\n        'app-v1',\n        CONSTANTS.SHEET_LAYOUT_CLASSIC,\n      ],\n      submitOnClose: false,\n      closeOnSubmit: false,\n      minimizable: true,\n      popOut: true,\n      resizable: true,\n    };\n  }\n\n  get template() {\n    return FoundryAdapter.getTemplate('empty-form-template.hbs');\n  }\n\n  activateListeners(html: any) {\n    const node = html.get(0);\n    this.refreshContext();\n    this.component = this.createComponent(node);\n  }\n\n  abstract createComponent(node: HTMLElement): Record<string, any>;\n\n  close(options: unknown = {}) {\n    if (this.component) {\n      unmount(this.component);\n    }\n    this.component = undefined;\n    return super.close(options);\n  }\n\n  render(force = false, ...args: any[]) {\n    if (force) {\n      if (this.component) {\n        unmount(this.component);\n      }\n      super.render(force, ...args);\n      return this;\n    }\n\n    this.refreshContext();\n    return this;\n  }\n\n  refreshContext() {\n    /* Implement in a subclass if needed */\n  }\n\n  async _updateObject() {\n    /* Implement in a subclass if needed */\n  }\n}\n","// generated during release, do not modify\n\n/**\n * The current version, as set in package.json.\n * @type {string}\n */\nexport const VERSION = '5.17.3';\nexport const PUBLIC_VERSION = '5';\n","import { PUBLIC_VERSION } from '../version.js';\n\nif (typeof window !== 'undefined')\n\t// @ts-ignore\n\t(window.__svelte ||= { v: new Set() }).v.add(PUBLIC_VERSION);\n","import { CONSTANTS } from 'src/constants';\nimport type { CoarseReactivityProvider } from 'src/features/reactivity/CoarseReactivityProvider.svelte';\nimport type { GroupSheetClassicContext } from 'src/types/group.types';\nimport type {\n  ContainerSheetClassicContext,\n  ContainerSheetQuadroneContext,\n  ItemSheetContext,\n} from 'src/types/item.types';\nimport type {\n  CharacterSheetContext,\n  NpcSheetContext,\n  VehicleSheetContext,\n} from 'src/types/types';\nimport { getContext } from 'svelte';\n\nexport function getSheetContext<TContext = any>(): TContext {\n  return getContext<CoarseReactivityProvider<TContext>>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT\n  ).data;\n}\n\nexport function getCharacterSheetContext(): CharacterSheetContext {\n  return getSheetContext<CharacterSheetContext>();\n}\n\nexport function getNpcSheetContext(): NpcSheetContext {\n  return getSheetContext<NpcSheetContext>();\n}\n\nexport function getVehicleSheetContext(): VehicleSheetContext {\n  return getSheetContext<VehicleSheetContext>();\n}\n\nexport function getGroupSheetClassicContext(): GroupSheetClassicContext {\n  return getSheetContext<GroupSheetClassicContext>();\n}\n\nexport function getItemSheetContext(): ItemSheetContext {\n  return getSheetContext<ItemSheetContext>();\n}\n\nexport function getContainerSheetClassicContext(): ContainerSheetClassicContext {\n  return getSheetContext<ContainerSheetClassicContext>();\n}\n\nexport function getContainerSheetQuadroneContext(): ContainerSheetQuadroneContext {\n  return getSheetContext<ContainerSheetQuadroneContext>();\n}\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { Tab, OnTabSelectedFn } from 'src/types/types';\n  import { getContext, onMount, type Snippet } from 'svelte';\n\n  interface Props {\n    tabs: Tab[];\n    selectedTabId?: string | undefined;\n    cssClass?: string;\n    orientation?: 'horizontal' | 'vertical';\n    onTabSelected?: (selectedTab: Tab) => void;\n    tabEnd?: Snippet;\n    sheet?: any;\n  }\n\n  let {\n    tabs,\n    selectedTabId = $bindable(undefined),\n    cssClass = '',\n    orientation = 'horizontal',\n    onTabSelected,\n    tabEnd,\n    sheet,\n  }: Props = $props();\n\n  const onTabSelectedContextFn = getContext<OnTabSelectedFn>(\n    CONSTANTS.SVELTE_CONTEXT.ON_TAB_SELECTED,\n  );\n\n  let nav: HTMLElement;\n\n  function selectTab(tab: Tab) {\n    if (sheet?.element && !FoundryAdapter.onTabSelecting(sheet, tab.id)) {\n      return;\n    }\n    selectedTabId = tab.id;\n    onTabSelectedContextFn?.(tab.id);\n    onTabSelected?.(tab);\n  }\n\n  function onKeyDown(ev: KeyboardEvent, i: number) {\n    switch (ev.key) {\n      case 'ArrowRight':\n      case 'ArrowDown':\n        const nextTab = tabs[(i + 1) % tabs.length];\n        selectTab(nextTab);\n        setTimeout(() => {\n          nav\n            .querySelector<HTMLElement>(`[data-tab-id='${nextTab.id}']`)\n            ?.focus();\n        });\n        break;\n      case 'ArrowLeft':\n      case 'ArrowUp':\n        const previousTab = tabs.at(i - 1);\n        if (previousTab) {\n          selectTab(previousTab);\n          setTimeout(() => {\n            nav\n              .querySelector<HTMLElement>(`[data-tab-id='${previousTab.id}']`)\n              ?.focus();\n          });\n        }\n        break;\n    }\n  }\n\n  const localize = FoundryAdapter.localize;\n  const currentTabId = getContext<string>(\n    CONSTANTS.SVELTE_CONTEXT.CURRENT_TAB_ID,\n  );\n\n  let mounted = $state(false);\n  onMount(() => {\n    const initialTab = tabs.find((t) => t.id === currentTabId);\n    if (initialTab) {\n      selectTab(initialTab);\n    }\n    mounted = true;\n  });\n\n  $effect(() => {\n    if (mounted && !tabs.some((tab) => tab.id === selectedTabId)) {\n      selectTab(tabs[0]);\n    }\n  });\n</script>\n\n<nav\n  class=\"tidy-tabs {cssClass}\"\n  class:vertical={orientation === 'vertical'}\n  bind:this={nav}\n>\n  {#if tabs.length > 1}\n    {#each tabs as tab, i (tab.id)}\n      <a\n        class={CONSTANTS.TAB_OPTION_CLASS}\n        class:active={tab.id === selectedTabId}\n        class:first-tab={i === 0}\n        class:no-border-on-last-tab={!tabEnd && i === tabs.length - 1}\n        data-tab-id={tab.id}\n        role=\"tab\"\n        onclick={() => selectTab(tab)}\n        onkeydown={(ev) => onKeyDown(ev, i)}\n      >\n        {localize(tab.title)}\n      </a>\n    {/each}\n  {/if}\n  {@render tabEnd?.()}\n</nav>\n","import { CONSTANTS } from 'src/constants';\nimport { getContext, setContext } from 'svelte';\n\n/**\n * Appends current location to the location context.\n * **Important**: Only use this during svelte component initialization. Treat it exactly like calling `getContext` and `setContext`.\n * @param segments strings of text to provide context for the current location\n * @returns void\n */\nexport function declareLocation(...segments: string[]) {\n  if (segments.length === 0) {\n    return;\n  }\n  const location = getContext<string>(CONSTANTS.SVELTE_CONTEXT.LOCATION) ?? '';\n  setContext(\n    CONSTANTS.SVELTE_CONTEXT.LOCATION,\n    [location, ...segments].join('/')\n  );\n}\n","<script lang=\"ts\">\n  import type { Tab } from 'src/types/types';\n  import { declareLocation } from 'src/types/location-awareness.types';\n  import { CONSTANTS } from 'src/constants';\n  import { getAllContexts, mount, onMount, setContext, unmount } from 'svelte';\n  import { error } from 'src/utils/logging';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    tab: Tab;\n    active: boolean;\n    cssClass?: string;\n  }\n\n  let { tab, active, cssClass = '' }: Props = $props();\n\n  const context = $derived(getSheetContext());\n  const allContexts = getAllContexts();\n\n  declareLocation('tab', tab.id);\n  setContext(CONSTANTS.SVELTE_CONTEXT.TAB_ID, tab.id);\n\n  let useCoreListenersClass = $derived(\n    tab.activateDefaultSheetListeners\n      ? CONSTANTS.CLASS_TIDY_USE_CORE_LISTENERS\n      : '',\n  );\n\n  let tidyTab: HTMLElement;\n\n  onMount(() => {\n    if (tab.content.type !== 'svelte') {\n      return;\n    }\n\n    try {\n      const props = tab.content.getProps?.(context) ?? {};\n      const tabComponentContext =\n        tab.content.getContext?.(allContexts) ?? allContexts;\n      const svelteTabComponent = mount(tab.content.component, {\n        target: tidyTab,\n        context: tabComponentContext,\n        props: props,\n      });\n\n      return () => {\n        unmount(svelteTabComponent);\n      };\n    } catch (e) {\n      error('Failed to render svelte tab', false, e);\n    }\n  });\n</script>\n\n<div\n  class=\"tidy-tab {tab.id} {cssClass} {tab.content.cssClass ??\n    ''} {useCoreListenersClass}\"\n  class:active\n  data-tab-contents-for={tab.id}\n  bind:this={tidyTab}\n></div>\n","<script lang=\"ts\">\n  import type { Tab } from 'src/types/types';\n  import TabContent from './TabContent.svelte';\n\n  interface Props {\n    tabs: Tab[];\n    selectedTabId: string;\n    cssClass?: string;\n  }\n\n  let { tabs, selectedTabId, cssClass = '' }: Props = $props();\n</script>\n\n{#each tabs as tab (tab.id)}\n  <TabContent active={selectedTabId === tab.id} {tab} {cssClass} />\n{/each}\n","import { enable_legacy_mode_flag } from './index.js';\n\nenable_legacy_mode_flag();\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getContext } from 'svelte';\n\n  interface Props {\n    value: boolean;\n    name: string;\n    hint: string;\n    id: string;\n  }\n\n  let { value = $bindable(), name, hint, id }: Props = $props();\n\n  const appId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.APP_ID);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<article class=\"setting\">\n  <input type=\"checkbox\" id=\"{id}-{appId}\" bind:checked={value} />\n  <div class=\"description\">\n    <label for=\"{id}-{appId}\">{localize(name)}</label>\n    <p class=\"tidy5e-notes\">{localize(hint)}</p>\n  </div>\n</article>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { SettingsProvider } from 'src/settings/settings.svelte';\n  import { getContext } from 'svelte';\n  import CheckboxSetting from 'src/applications/settings/parts/CheckboxSetting.svelte';\n  import type { UserSettingsContext } from '../UserSettings.types';\n  import { CONSTANTS } from 'src/constants';\n\n  let context = getContext<UserSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<h2>{localize('TIDY5E.UserSettings.TabPlayers.header')}</h2>\n\n<CheckboxSetting\n  bind:value={context.settings.useClassicControlsForCharacter}\n  name={SettingsProvider.settings.useClassicControlsForCharacter.options.name}\n  hint={SettingsProvider.settings.useClassicControlsForCharacter.options.hint}\n  id=\"useClassicControlsForCharacter\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.showClassList}\n  name={SettingsProvider.settings.showClassList.options.name}\n  hint={SettingsProvider.settings.showClassList.options.hint}\n  id=\"showClassList\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.animateInspiration}\n  name={SettingsProvider.settings.animateInspiration.options.name}\n  hint={SettingsProvider.settings.animateInspiration.options.hint}\n  id=\"animateInspiration\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.hideIfZero}\n  name={SettingsProvider.settings.hideIfZero.options.name}\n  hint={SettingsProvider.settings.hideIfZero.options.hint}\n  id=\"hideIfZero\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.showInspirationOnHover}\n  name={SettingsProvider.settings.showInspirationOnHover.options.name}\n  hint={SettingsProvider.settings.showInspirationOnHover.options.hint}\n  id=\"showInspirationOnHover\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.showExhaustionOnHover}\n  name={SettingsProvider.settings.showExhaustionOnHover.options.name}\n  hint={SettingsProvider.settings.showExhaustionOnHover.options.hint}\n  id=\"showExhaustionOnHover\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.useHpBar}\n  name={SettingsProvider.settings.useHpBar.options.name}\n  hint={SettingsProvider.settings.useHpBar.options.hint}\n  id=\"useHpBar\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.useHpOverlay}\n  name={SettingsProvider.settings.useHpOverlay.options.name}\n  hint={SettingsProvider.settings.useHpOverlay.options.hint}\n  id=\"useHpOverlay\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.toggleEmptyCharacterSkills}\n  name={SettingsProvider.settings.toggleEmptyCharacterSkills.options.name}\n  hint={SettingsProvider.settings.toggleEmptyCharacterSkills.options.hint}\n  id=\"toggleEmptyCharacterSkills\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.moveCharacterTraitsToRightOfSkills}\n  name={SettingsProvider.settings.moveCharacterTraitsToRightOfSkills.options\n    .name}\n  hint={SettingsProvider.settings.moveCharacterTraitsToRightOfSkills.options\n    .hint}\n  id=\"moveCharacterTraitsToRightOfSkills\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.showEquippedAmmoOnly}\n  name={SettingsProvider.settings.showEquippedAmmoOnly.options.name}\n  hint={SettingsProvider.settings.showEquippedAmmoOnly.options.hint}\n  id=\"showEquippedAmmoOnly\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.useContextMenu}\n  name={SettingsProvider.settings.useContextMenu.options.name}\n  hint={SettingsProvider.settings.useContextMenu.options.hint}\n  id=\"useContextMenu\"\n/>\n\n<h3>{localize('TIDY5E.Settings.MulticlassSpellbookFilterLabel')}</h3>\n\n<CheckboxSetting\n  bind:value={context.settings.useMulticlassSpellbookFilter}\n  name={SettingsProvider.settings.useMulticlassSpellbookFilter.options.name}\n  hint={SettingsProvider.settings.useMulticlassSpellbookFilter.options.hint}\n  id=\"useMulticlassSpellbookFilter\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.useSpellClassFilterIcons}\n  name={SettingsProvider.settings.useSpellClassFilterIcons.options.name}\n  hint={SettingsProvider.settings.useSpellClassFilterIcons.options.hint}\n  id=\"useSpellClassFilterIcons\"\n/>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import CheckboxSetting from 'src/applications/settings/parts/CheckboxSetting.svelte';\n  import { getContext } from 'svelte';\n  import { SettingsProvider } from 'src/settings/settings.svelte';\n  import type { UserSettingsContext } from '../UserSettings.types';\n  import { CONSTANTS } from 'src/constants';\n\n  let context = getContext<UserSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<h2>{localize('TIDY5E.UserSettings.TabNPCs.header')}</h2>\n\n<CheckboxSetting\n  bind:value={context.settings.useClassicControlsForNpc}\n  name={SettingsProvider.settings.useClassicControlsForNpc.options.name}\n  hint={SettingsProvider.settings.useClassicControlsForNpc.options.hint}\n  id=\"useClassicControlsForNpc\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.useHpBarNpc}\n  name={SettingsProvider.settings.useHpBarNpc.options.name}\n  hint={SettingsProvider.settings.useHpBarNpc.options.hint}\n  id=\"useHpBarNpc\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.useHpOverlayNpc}\n  name={SettingsProvider.settings.useHpOverlayNpc.options.name}\n  hint={SettingsProvider.settings.useHpOverlayNpc.options.hint}\n  id=\"useHpOverlayNpc\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.moveNpcTraitsToRightOfSkills}\n  name={SettingsProvider.settings.moveNpcTraitsToRightOfSkills.options.name}\n  hint={SettingsProvider.settings.moveNpcTraitsToRightOfSkills.options.hint}\n  id=\"moveNpcTraitsToRightOfSkills\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.alwaysShowNpcSkills}\n  name={SettingsProvider.settings.alwaysShowNpcSkills.options.name}\n  hint={SettingsProvider.settings.alwaysShowNpcSkills.options.hint}\n  id=\"alwaysShowNpcSkills\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.showSpellbookTabNpc}\n  name={SettingsProvider.settings.showSpellbookTabNpc.options.name}\n  hint={SettingsProvider.settings.showSpellbookTabNpc.options.hint}\n  id=\"showSpellbookTabNpc\"\n/>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import CheckboxSetting from 'src/applications/settings/parts/CheckboxSetting.svelte';\n  import { getContext } from 'svelte';\n  import { SettingsProvider } from 'src/settings/settings.svelte';\n  import type { UserSettingsContext } from '../UserSettings.types';\n  import { CONSTANTS } from 'src/constants';\n\n  let context = getContext<UserSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n  const localize = FoundryAdapter.localize;\n</script>\n\n<h2>{localize('TIDY5E.UserSettings.TabVehicles.header')}</h2>\n\n<CheckboxSetting\n  bind:value={context.settings.useClassicControlsForVehicle}\n  name={SettingsProvider.settings.useClassicControlsForVehicle.options.name}\n  hint={SettingsProvider.settings.useClassicControlsForVehicle.options.hint}\n  id=\"useClassicControlsForVehicle\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.useHpBarVehicle}\n  name={SettingsProvider.settings.useHpBarVehicle.options.name}\n  hint={SettingsProvider.settings.useHpBarVehicle.options.hint}\n  id=\"useHpBarVehicle\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.useHpOverlayVehicle}\n  name={SettingsProvider.settings.useHpOverlayVehicle.options.name}\n  hint={SettingsProvider.settings.useHpOverlayVehicle.options.hint}\n  id=\"useHpOverlayVehicle\"\n/>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getContext } from 'svelte';\n  import { SettingsProvider } from 'src/settings/settings.svelte';\n  import CheckboxSetting from '../../parts/CheckboxSetting.svelte';\n  import type { UserSettingsContext } from '../UserSettings.types';\n  import { CONSTANTS } from 'src/constants';\n\n  let context = getContext<UserSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<h2>{localize('TIDY5E.Settings.ActionList.Header')}</h2>\n\n<CheckboxSetting\n  bind:value={context.settings.actionListLimitActionsToCantrips}\n  name={SettingsProvider.settings.actionListLimitActionsToCantrips.options.name}\n  hint={SettingsProvider.settings.actionListLimitActionsToCantrips.options.hint}\n  id=\"actionListLimitActionsToCantrips\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.actionListIncludeMinuteLongSpellsAsActions}\n  name={SettingsProvider.settings.actionListIncludeMinuteLongSpellsAsActions\n    .options.name}\n  hint={SettingsProvider.settings.actionListIncludeMinuteLongSpellsAsActions\n    .options.hint}\n  id=\"actionListIncludeMinuteLongSpellsAsActions\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.actionListIncludeSpellsWithActiveEffects}\n  name={SettingsProvider.settings.actionListIncludeSpellsWithActiveEffects\n    .options.name}\n  hint={SettingsProvider.settings.actionListIncludeSpellsWithActiveEffects\n    .options.hint}\n  id=\"actionListIncludeSpellsWithActiveEffects\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.actionListIncludeConsumables}\n  name={SettingsProvider.settings.actionListIncludeConsumables.options.name}\n  hint={SettingsProvider.settings.actionListIncludeConsumables.options.hint}\n  id=\"actionListIncludeConsumables\"\n/>\n","const nilValues = [null, undefined] as const;\nexport function isNil(value: any, ...or: any[]): value is null | undefined {\n  return nilValues.concat(or ?? []).includes(value);\n}\n\nfunction camelToLowerDashCase(str: string) {\n  if (str != str.toLowerCase()) {\n    str = str.replace(/[A-Z]/g, (m) => '-' + m.toLowerCase());\n  }\n  return str;\n}\n\nexport function buildDataset(obj: Record<string, unknown> | null) {\n  if (!obj) {\n    return {};\n  }\n\n  return Object.entries(obj).reduce<Record<string, unknown>>(\n    (acc, [key, value]) => {\n      acc[`data-${camelToLowerDashCase(key)}`] = value;\n      return acc;\n    },\n    {}\n  );\n}\n","import { FoundryAdapter } from \"src/foundry/foundry-adapter\";\nimport { isNil } from \"./data\";\n\n/**\n * An Handlebars helper to format numbers\n *\n * @param value    - The string or number to format\n * @param options  - Options for how the number should be formatted\n */\nexport function formatAsModifier(value: string | number): string {\n  if (value === null || value === undefined) {\n    return toSignedNumberString(0);\n  }\n\n  const parsed = typeof value === 'string' ? +value : value;\n\n  if (isNaN(parsed)) {\n    return toSignedNumberString(0);\n  }\n\n  return toSignedNumberString(parsed);\n}\n\nfunction toSignedNumberString(value: number) {\n  return value.toLocaleString(FoundryAdapter.getCurrentLang(), { signDisplay: 'always' });\n}\n\n/**\n * @param values maybe string values that can be coalesced to fallbacks\n * @returns the first truthy, non-empty string value\n */\nexport function coalesce(...values: (string | null | undefined)[]) {\n  for (let value of values) {\n    if (!isNil(value?.trim(), '')) {\n      return value;\n    }\n  }\n\n  return '';\n}","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { coalesce } from 'src/utils/formatting';\n\n  interface Props {\n    data: Record<string, unknown> | Record<string, unknown>[];\n    valueProp?: string | null;\n    labelProp?: string | null;\n    blank?: string | null;\n  }\n\n  let {\n    data,\n    valueProp = null,\n    labelProp = null,\n    blank = null,\n  }: Props = $props();\n\n  let entries = $derived(Object.entries<any>(data));\n\n  function getLabel(value: unknown): string {\n    // Fallback to the convention of CONFIG.DND5E progressively changing referential data to use the \"label\" prop.\n    const effectiveLabelProp = coalesce(labelProp, 'label');\n    if (\n      value !== null &&\n      typeof value === 'object' &&\n      effectiveLabelProp in value\n    ) {\n      return (\n        (value as Record<string, unknown>)[effectiveLabelProp]?.toString() ?? ''\n      );\n    }\n\n    return value?.toString() ?? '';\n  }\n\n  function getValue(key: string, value: unknown): string {\n    if (\n      valueProp !== null &&\n      value !== null &&\n      typeof value === 'object' &&\n      valueProp in value\n    ) {\n      return (value as Record<string, unknown>)[valueProp]?.toString() ?? '';\n    }\n\n    return key;\n  }\n\n  // Apply optional grouping\n  let groups = $derived(FoundryAdapter.groupSelectOptions(entries));\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n{#if blank !== null}\n  <option value=\"\">{localize(blank)}</option>\n{/if}\n\n{#each groups as [groupKey, groupValue] (groupKey)}\n  {#if groupKey === ''}\n    {#each groupValue as [key, value]}\n      {#if value?.rule}\n        <hr />\n      {:else}\n        {@render optionElement(key, value)}\n      {/if}\n    {/each}\n  {:else}\n    <optgroup label={localize(groupKey)}>\n      {#each groupValue as [key, value]}\n        {#if !value?.rule}\n          {@render optionElement(key, value)}\n        {/if}\n      {/each}\n    </optgroup>\n  {/if}\n{/each}\n\n{#snippet optionElement(key: any, value: any)}\n  <option value={getValue(key, value)}>{localize(getLabel(value))}</option>\n{/snippet}\n","<script lang=\"ts\">\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getContext, type Snippet } from 'svelte';\n\n  interface Props {\n    value: string;\n    name: string;\n    hint: string;\n    id: string;\n    options: Record<string, unknown>;\n    additionalInputs?: Snippet;\n  }\n\n  let {\n    value = $bindable(),\n    name,\n    hint,\n    id,\n    options,\n    additionalInputs,\n  }: Props = $props();\n\n  const appId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.APP_ID);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<article class=\"setting group\">\n  <section>\n    <div class=\"description\">\n      <label for=\"{id}-{appId}\">{localize(name)}</label>\n      <p class=\"tidy5e-notes\">{localize(hint)}</p>\n    </div>\n    <div class=\"settings-group\">\n      <select id=\"{id}-{appId}\" bind:value>\n        <SelectOptions data={options} />\n      </select>\n      {@render additionalInputs?.()}\n    </div>\n  </section>\n</article>\n","<script lang=\"ts\">\n  import { getContext } from 'svelte';\n  import { SettingsProvider } from 'src/settings/settings.svelte';\n  import type { UserSettingsContext } from '../UserSettings.types';\n  import { CONSTANTS } from 'src/constants';\n  import SelectSetting from '../../parts/SelectSetting.svelte';\n\n  let context = getContext<UserSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n</script>\n\n<SelectSetting\n  options={SettingsProvider.settings.inlineActivitiesPosition.options.choices}\n  bind:value={context.settings.inlineActivitiesPosition}\n  name={SettingsProvider.settings.inlineActivitiesPosition.options.name}\n  hint={SettingsProvider.settings.inlineActivitiesPosition.options.hint}\n  id=\"inlineActivitiesPosition\"\n/>\n","<script lang=\"ts\">\n  import type { Tab } from 'src/types/types';\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import PlayerSettingsTab from './tabs/PlayerSettingsTab.svelte';\n  import NpcSettingsTab from './tabs/NpcSettingsTab.svelte';\n  import VehicleSettingsTab from './tabs/VehicleSettingsTab.svelte';\n  import ActionsListSettingsTab from './tabs/ActionsListSettingsTab.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getContext } from 'svelte';\n  import { CONSTANTS } from 'src/constants';\n  import type {\n    UserSettingsContext,\n    UserSettingsFunctions,\n  } from './UserSettings.types';\n  import ActivitiesSettingsTab from './tabs/ActivitiesSettingsTabs.svelte';\n\n  let selectedTabId = $state(\n    getContext<string>(CONSTANTS.SVELTE_CONTEXT.INITIAL_TAB_ID),\n  );\n  let context = getContext<UserSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n  let functions = getContext<UserSettingsFunctions>(\n    CONSTANTS.SVELTE_CONTEXT.FUNCTIONS,\n  );\n\n  let tabs: Tab[] = $derived.by(() => {\n    const result: Tab[] = [\n      {\n        id: CONSTANTS.TAB_USER_SETTINGS_PLAYERS,\n        title: 'TIDY5E.UserSettings.TabPlayers.tabLabel',\n        content: {\n          component: PlayerSettingsTab,\n          type: 'svelte',\n        },\n      },\n      {\n        id: CONSTANTS.TAB_USER_SETTINGS_NPCS,\n        title: 'TIDY5E.UserSettings.TabNPCs.tabLabel',\n        content: {\n          component: NpcSettingsTab,\n          type: 'svelte',\n        },\n      },\n      {\n        id: CONSTANTS.TAB_USER_SETTINGS_VEHICLES,\n        title: 'TIDY5E.UserSettings.TabVehicles.tabLabel',\n        content: {\n          component: VehicleSettingsTab,\n          type: 'svelte',\n        },\n      },\n    ];\n\n    result.push({\n      id: CONSTANTS.TAB_USER_SETTINGS_ACTIONS_LIST,\n      title: 'TIDY5E.UserSettings.TabActionsList.tabLabel',\n      content: {\n        component: ActionsListSettingsTab,\n        type: 'svelte',\n      },\n    });\n\n    result.push({\n      id: CONSTANTS.TAB_USER_SETTINGS_ACTIVITIES,\n      title: 'TIDY5E.UserSettings.TabActivities.tabLabel',\n      content: {\n        component: ActivitiesSettingsTab,\n        type: 'svelte',\n      },\n    });\n\n    return result;\n  });\n\n  $effect(() => {\n    selectedTabId ??= tabs[0].id;\n  });\n\n  let applyingChanges = $state(false);\n\n  async function save() {\n    applyingChanges = true;\n\n    try {\n      await functions.save(context);\n    } finally {\n      applyingChanges = false;\n    }\n  }\n\n  async function apply() {\n    applyingChanges = true;\n\n    try {\n      await functions.apply(context);\n    } finally {\n      applyingChanges = false;\n    }\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"settings-form\">\n  <div role=\"presentation\" class=\"vertical-tab-container flex-column no-gap\">\n    <Tabs {tabs} bind:selectedTabId orientation=\"vertical\" />\n    <div role=\"presentation\" class=\"remaining-vertical-space\"></div>\n  </div>\n\n  <TabContents {tabs} {selectedTabId} cssClass=\"tidy-sheet-body\" />\n  <div class=\"button-bar\">\n    <button\n      type=\"button\"\n      class=\"save-changes-btn\"\n      onclick={save}\n      disabled={applyingChanges}\n    >\n      <i class=\"fas fa-save\"></i>\n      {localize('TIDY5E.SaveChanges')}\n    </button>\n    <button\n      type=\"button\"\n      class=\"apply-changes-btn\"\n      onclick={apply}\n      disabled={applyingChanges}\n    >\n      <i class=\"fas fa-check\"></i>\n      {localize('TIDY5E.ApplyChanges')}\n    </button>\n  </div>\n</div>\n\n<style lang=\"scss\">\n  .settings-form {\n    height: 100%;\n    display: grid;\n    grid-template-areas:\n      'nav    body'\n      'nav    buttons';\n    grid-template-rows: 1fr auto;\n    grid-template-columns: 15rem 1fr;\n    gap: 0.5rem;\n\n    .vertical-tab-container {\n      grid-area: nav;\n      margin-top: -0.5rem;\n      margin-left: -0.5rem;\n      margin-bottom: -0.5rem;\n    }\n\n    :global(.tidy-sheet-body) {\n      grid-area: body;\n      overflow-y: scroll;\n      padding-top: 0.5rem;\n      padding-right: 0.5rem;\n      margin-right: -0.25rem;\n      flex: 1;\n    }\n\n    .button-bar {\n      grid-area: buttons;\n    }\n  }\n\n  .button-bar {\n    flex: 0;\n    display: flex;\n    padding-right: 0.5rem;\n  }\n\n  .remaining-vertical-space {\n    margin-right: -0.0625rem;\n    border-right: 0.0625rem solid var(--t5e-tab-strip-border-color);\n    flex: 1;\n    background-color: var(--t5e-header-background);\n  }\n</style>\n","import { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { mount } from 'svelte';\nimport {\n  getCurrentSettings,\n  type CurrentSettings,\n  type Tidy5eSettingKey,\n} from 'src/settings/settings.svelte';\nimport { debug } from 'src/utils/logging';\nimport { CONSTANTS } from 'src/constants';\nimport SvelteFormApplicationBase from 'src/applications/SvelteFormApplicationBase';\nimport UserSettings from './UserSettings.svelte';\nimport type {\n  UserSettingsContext,\n  UserSettingsFunctions,\n} from './UserSettings.types';\n\nexport class UserSettingsFormApplication extends SvelteFormApplicationBase {\n  initialTabId: string;\n  context = $state<UserSettingsContext>();\n\n  constructor(initialTabId: string, ...args: any[]) {\n    super(...args);\n    this.initialTabId = initialTabId ?? CONSTANTS.TAB_USER_SETTINGS_PLAYERS;\n  }\n\n  static get defaultOptions() {\n    return {\n      ...super.defaultOptions,\n      height: 750,\n      width: 750,\n      classes: [\n        ...super.defaultOptions.classes,\n        'settings',\n        'app-v1',\n        CONSTANTS.SHEET_LAYOUT_CLASSIC,\n      ],\n      id: 'tidy-5e-sheets-user-settings',\n      popOut: true,\n    };\n  }\n\n  get template() {\n    return FoundryAdapter.getTemplate('empty-form-template.hbs');\n  }\n\n  get title() {\n    return FoundryAdapter.localize('TIDY5E.UserSettings.Menu.title', {\n      userName: game.user.name,\n    });\n  }\n\n  getData(): UserSettingsContext {\n    const currentSettings = getCurrentSettings();\n\n    return {\n      settings: {\n        actionListIncludeConsumables:\n          currentSettings.actionListIncludeConsumables,\n        actionListIncludeMinuteLongSpellsAsActions:\n          currentSettings.actionListIncludeMinuteLongSpellsAsActions,\n        actionListIncludeSpellsWithActiveEffects:\n          currentSettings.actionListIncludeSpellsWithActiveEffects,\n        actionListLimitActionsToCantrips:\n          currentSettings.actionListLimitActionsToCantrips,\n        alwaysShowNpcSkills: currentSettings.alwaysShowNpcSkills,\n        animateInspiration: currentSettings.animateInspiration,\n        hideIfZero: currentSettings.hideIfZero,\n        inlineActivitiesPosition: currentSettings.inlineActivitiesPosition,\n        moveCharacterTraitsToRightOfSkills:\n          currentSettings.moveCharacterTraitsToRightOfSkills,\n        moveNpcTraitsToRightOfSkills:\n          currentSettings.moveNpcTraitsToRightOfSkills,\n        showClassList: currentSettings.showClassList,\n        showEquippedAmmoOnly: currentSettings.showEquippedAmmoOnly,\n        showExhaustionOnHover: currentSettings.showExhaustionOnHover,\n        showInspirationOnHover: currentSettings.showInspirationOnHover,\n        showSpellbookTabNpc: currentSettings.showSpellbookTabNpc,\n        toggleEmptyCharacterSkills: currentSettings.toggleEmptyCharacterSkills,\n        useClassicControlsForCharacter:\n          currentSettings.useClassicControlsForCharacter,\n        useClassicControlsForNpc: currentSettings.useClassicControlsForNpc,\n        useClassicControlsForVehicle:\n          currentSettings.useClassicControlsForVehicle,\n        useContextMenu: currentSettings.useContextMenu,\n        useHpBar: currentSettings.useHpBar,\n        useHpBarNpc: currentSettings.useHpBarNpc,\n        useHpBarVehicle: currentSettings.useHpBarVehicle,\n        useHpOverlay: currentSettings.useHpOverlay,\n        useHpOverlayNpc: currentSettings.useHpOverlayNpc,\n        useHpOverlayVehicle: currentSettings.useHpOverlayVehicle,\n        useMulticlassSpellbookFilter:\n          currentSettings.useMulticlassSpellbookFilter,\n        useSpellClassFilterIcons: currentSettings.useSpellClassFilterIcons,\n      },\n    };\n  }\n\n  createComponent(node: HTMLElement): Record<string, any> {\n    const data = this.getData();\n\n    debug('Sheet Settings context data', data);\n\n    this.context = data;\n\n    return mount(UserSettings, {\n      target: node,\n      context: new Map<any, any>([\n        ['context', this.context],\n        [\n          'functions',\n          {\n            save: this.saveChangedSettings.bind(this),\n            apply: this.applyChangedSettings.bind(this),\n            validate: this.validate.bind(this),\n          } satisfies UserSettingsFunctions,\n        ],\n        ['appId', this.appId],\n        ['initialTabId', this.initialTabId],\n      ]),\n    });\n  }\n\n  validate(context: UserSettingsContext) {\n    let valid = true;\n\n    // Add data validation here as needed\n    // if (somethingIsNotValid) {\n    //   valid = false;\n    //   error(\n    //     FoundryAdapter.localize(\n    //       'Some.ValidationRule.Violation.Key.Here'\n    //     ),\n    //     true\n    //   );\n    // }\n\n    return valid;\n  }\n\n  async applyChangedSettings() {\n    if (!this.context) {\n      return;\n    }\n\n    if (!this.validate(this.context)) {\n      return false;\n    }\n\n    const newSettings: Partial<CurrentSettings> = {\n      ...this.context.settings,\n    };\n\n    const currentSettings = getCurrentSettings();\n    const keys = Object.keys(newSettings) as Tidy5eSettingKey[];\n    for (let key of keys) {\n      const currentValue = currentSettings[key];\n      const newValue = newSettings[key];\n      if (currentValue !== newValue) {\n        await FoundryAdapter.setTidySetting(key, newValue);\n        debug(`Updated ${key} to ${newValue}`);\n      }\n    }\n\n    return true;\n  }\n\n  async saveChangedSettings() {\n    const changesApplied = await this.applyChangedSettings();\n\n    if (!changesApplied) {\n      return;\n    }\n\n    this.close();\n  }\n}\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getContext, type Snippet } from 'svelte';\n\n  interface Props {\n    value: string;\n    name: string;\n    hint: string;\n    id: string;\n    additionalInputs?: Snippet;\n  }\n\n  let {\n    value = $bindable(),\n    name,\n    hint,\n    id,\n    additionalInputs,\n  }: Props = $props();\n\n  const appId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.APP_ID);\n\n  let calculatedId = $derived(`${id}-${appId}`);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<article class=\"setting group\">\n  <div>\n    <div class=\"description\">\n      <label for={calculatedId}>{localize(name)}</label>\n      <p class=\"tidy5e-notes\">{localize(hint)}</p>\n    </div>\n    <div class=\"settings-group\">\n      <article>\n        <input type=\"text\" id={calculatedId} bind:value />\n      </article>\n      {@render additionalInputs?.()}\n    </div>\n  </div>\n</article>\n","<script lang=\"ts\">\n  import CheckboxSetting from 'src/applications/settings/parts/CheckboxSetting.svelte';\n  import { getContext } from 'svelte';\n  import { SettingsProvider } from 'src/settings/settings.svelte';\n  import TextInputSetting from 'src/applications/settings/parts/TextInputSetting.svelte';\n  import SelectSetting from 'src/applications/settings/parts/SelectSetting.svelte';\n  import type { WorldSettingsContext } from '../WorldSettings.types';\n  import { CONSTANTS } from 'src/constants';\n\n  const context = getContext<WorldSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n</script>\n\n<CheckboxSetting\n  bind:value={context.settings.hideDeathSavesFromPlayers}\n  name={'TIDY5E.Settings.HideDeathSavesFromPlayers.name'}\n  hint={'TIDY5E.Settings.HideDeathSavesFromPlayers.hint'}\n  id=\"hideDeathSavesFromPlayers\"\n/>\n\n<SelectSetting\n  options={SettingsProvider.settings.defaultDeathSaveRoll.options.choices}\n  bind:value={context.settings.defaultDeathSaveRoll}\n  name={'TIDY5E.Settings.DefaultDeathSaveRoll.name'}\n  hint={'TIDY5E.Settings.DefaultDeathSaveRoll.hint'}\n  id=\"defaultDeathSaveRoll\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.showExpandedLimitedView}\n  name={'TIDY5E.Settings.ShowExpandedLimitedView.name'}\n  hint={'TIDY5E.Settings.ShowExpandedLimitedView.hint'}\n  id=\"showExpandedLimitedView\"\n/>\n\n<TextInputSetting\n  bind:value={context.settings.itemCardsFixKey}\n  name={SettingsProvider.settings.itemCardsFixKey.options.name}\n  hint={SettingsProvider.settings.itemCardsFixKey.options.hint}\n  id=\"itemCardsFixKey\"\n/>\n\n<SelectSetting\n  options={SettingsProvider.settings.useCircularPortraitStyle.options.choices}\n  bind:value={context.settings.useCircularPortraitStyle}\n  name={'TIDY5E.Settings.UseCircularPortraitStyle.name'}\n  hint={'TIDY5E.Settings.UseCircularPortraitStyle.hint'}\n  id=\"useCircularPortraitStyle\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.limitEffectsManagementToGm}\n  name={'TIDY5E.Settings.LimitEffectsManagementToGM.name'}\n  hint={'TIDY5E.Settings.LimitEffectsManagementToGM.hint'}\n  id=\"limitEffectsManagementToGm\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.showTraitLabels}\n  name={'TIDY5E.Settings.ShowTraitLabels.name'}\n  hint={'TIDY5E.Settings.ShowTraitLabels.hint'}\n  id=\"showTraitLabels\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.allowCantripsToBePrepared}\n  name={'TIDY5E.Settings.AllowCantripsToBePrepared.name'}\n  hint={'TIDY5E.Settings.AllowCantripsToBePrepared.hint'}\n  id=\"allowCantripsToBePrepared\"\n/>\n\n<CheckboxSetting\n  bind:value={context.settings.showActiveEffectsMarker}\n  name={'TIDY5E.Settings.ShowActiveEffectsMarker.name'}\n  hint={'TIDY5E.Settings.ShowActiveEffectsMarker.hint'}\n  id=\"showActiveEffectsMarker\"\n/>\n","/*\nAdapted from https://github.com/mattdesl\nDistributed under MIT License https://github.com/mattdesl/eases/blob/master/LICENSE.md\n*/\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function linear(t) {\n\treturn t;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function backInOut(t) {\n\tconst s = 1.70158 * 1.525;\n\tif ((t *= 2) < 1) return 0.5 * (t * t * ((s + 1) * t - s));\n\treturn 0.5 * ((t -= 2) * t * ((s + 1) * t + s) + 2);\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function backIn(t) {\n\tconst s = 1.70158;\n\treturn t * t * ((s + 1) * t - s);\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function backOut(t) {\n\tconst s = 1.70158;\n\treturn --t * t * ((s + 1) * t + s) + 1;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function bounceOut(t) {\n\tconst a = 4.0 / 11.0;\n\tconst b = 8.0 / 11.0;\n\tconst c = 9.0 / 10.0;\n\tconst ca = 4356.0 / 361.0;\n\tconst cb = 35442.0 / 1805.0;\n\tconst cc = 16061.0 / 1805.0;\n\tconst t2 = t * t;\n\treturn t < a\n\t\t? 7.5625 * t2\n\t\t: t < b\n\t\t\t? 9.075 * t2 - 9.9 * t + 3.4\n\t\t\t: t < c\n\t\t\t\t? ca * t2 - cb * t + cc\n\t\t\t\t: 10.8 * t * t - 20.52 * t + 10.72;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function bounceInOut(t) {\n\treturn t < 0.5 ? 0.5 * (1.0 - bounceOut(1.0 - t * 2.0)) : 0.5 * bounceOut(t * 2.0 - 1.0) + 0.5;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function bounceIn(t) {\n\treturn 1.0 - bounceOut(1.0 - t);\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function circInOut(t) {\n\tif ((t *= 2) < 1) return -0.5 * (Math.sqrt(1 - t * t) - 1);\n\treturn 0.5 * (Math.sqrt(1 - (t -= 2) * t) + 1);\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function circIn(t) {\n\treturn 1.0 - Math.sqrt(1.0 - t * t);\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function circOut(t) {\n\treturn Math.sqrt(1 - --t * t);\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function cubicInOut(t) {\n\treturn t < 0.5 ? 4.0 * t * t * t : 0.5 * Math.pow(2.0 * t - 2.0, 3.0) + 1.0;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function cubicIn(t) {\n\treturn t * t * t;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function cubicOut(t) {\n\tconst f = t - 1.0;\n\treturn f * f * f + 1.0;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function elasticInOut(t) {\n\treturn t < 0.5\n\t\t? 0.5 * Math.sin(((+13.0 * Math.PI) / 2) * 2.0 * t) * Math.pow(2.0, 10.0 * (2.0 * t - 1.0))\n\t\t: 0.5 *\n\t\t\t\tMath.sin(((-13.0 * Math.PI) / 2) * (2.0 * t - 1.0 + 1.0)) *\n\t\t\t\tMath.pow(2.0, -10.0 * (2.0 * t - 1.0)) +\n\t\t\t\t1.0;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function elasticIn(t) {\n\treturn Math.sin((13.0 * t * Math.PI) / 2) * Math.pow(2.0, 10.0 * (t - 1.0));\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function elasticOut(t) {\n\treturn Math.sin((-13.0 * (t + 1.0) * Math.PI) / 2) * Math.pow(2.0, -10.0 * t) + 1.0;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function expoInOut(t) {\n\treturn t === 0.0 || t === 1.0\n\t\t? t\n\t\t: t < 0.5\n\t\t\t? +0.5 * Math.pow(2.0, 20.0 * t - 10.0)\n\t\t\t: -0.5 * Math.pow(2.0, 10.0 - t * 20.0) + 1.0;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function expoIn(t) {\n\treturn t === 0.0 ? t : Math.pow(2.0, 10.0 * (t - 1.0));\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function expoOut(t) {\n\treturn t === 1.0 ? t : 1.0 - Math.pow(2.0, -10.0 * t);\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function quadInOut(t) {\n\tt /= 0.5;\n\tif (t < 1) return 0.5 * t * t;\n\tt--;\n\treturn -0.5 * (t * (t - 2) - 1);\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function quadIn(t) {\n\treturn t * t;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function quadOut(t) {\n\treturn -t * (t - 2.0);\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function quartInOut(t) {\n\treturn t < 0.5 ? +8.0 * Math.pow(t, 4.0) : -8.0 * Math.pow(t - 1.0, 4.0) + 1.0;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function quartIn(t) {\n\treturn Math.pow(t, 4.0);\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function quartOut(t) {\n\treturn Math.pow(t - 1.0, 3.0) * (1.0 - t) + 1.0;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function quintInOut(t) {\n\tif ((t *= 2) < 1) return 0.5 * t * t * t * t * t;\n\treturn 0.5 * ((t -= 2) * t * t * t * t + 2);\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function quintIn(t) {\n\treturn t * t * t * t * t;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function quintOut(t) {\n\treturn --t * t * t * t * t + 1;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function sineInOut(t) {\n\treturn -0.5 * (Math.cos(Math.PI * t) - 1);\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function sineIn(t) {\n\tconst v = Math.cos(t * Math.PI * 0.5);\n\tif (Math.abs(v) < 1e-14) return 1;\n\telse return 1 - v;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nexport function sineOut(t) {\n\treturn Math.sin((t * Math.PI) / 2);\n}\n","/** @import { FlipParams, AnimationConfig } from './public.js' */\nimport { cubicOut } from '../easing/index.js';\n\n/**\n * The flip function calculates the start and end position of an element and animates between them, translating the x and y values.\n * `flip` stands for [First, Last, Invert, Play](https://aerotwist.com/blog/flip-your-animations/).\n *\n * @param {Element} node\n * @param {{ from: DOMRect; to: DOMRect }} fromTo\n * @param {FlipParams} params\n * @returns {AnimationConfig}\n */\nexport function flip(node, { from, to }, params = {}) {\n\tvar { delay = 0, duration = (d) => Math.sqrt(d) * 120, easing = cubicOut } = params;\n\n\tvar style = getComputedStyle(node);\n\n\t// find the transform origin, expressed as a pair of values between 0 and 1\n\tvar transform = style.transform === 'none' ? '' : style.transform;\n\tvar [ox, oy] = style.transformOrigin.split(' ').map(parseFloat);\n\tox /= node.clientWidth;\n\toy /= node.clientHeight;\n\n\t// calculate effect of parent transforms and zoom\n\tvar zoom = get_zoom(node); // https://drafts.csswg.org/css-viewport/#effective-zoom\n\tvar sx = node.clientWidth / to.width / zoom;\n\tvar sy = node.clientHeight / to.height / zoom;\n\n\t// find the starting position of the transform origin\n\tvar fx = from.left + from.width * ox;\n\tvar fy = from.top + from.height * oy;\n\n\t// find the ending position of the transform origin\n\tvar tx = to.left + to.width * ox;\n\tvar ty = to.top + to.height * oy;\n\n\t// find the translation at the start of the transform\n\tvar dx = (fx - tx) * sx;\n\tvar dy = (fy - ty) * sy;\n\n\t// find the relative scale at the start of the transform\n\tvar dsx = from.width / to.width;\n\tvar dsy = from.height / to.height;\n\n\treturn {\n\t\tdelay,\n\t\tduration: typeof duration === 'function' ? duration(Math.sqrt(dx * dx + dy * dy)) : duration,\n\t\teasing,\n\t\tcss: (t, u) => {\n\t\t\tvar x = u * dx;\n\t\t\tvar y = u * dy;\n\t\t\tvar sx = t + u * dsx;\n\t\t\tvar sy = t + u * dsy;\n\n\t\t\treturn `transform: ${transform} translate(${x}px, ${y}px) scale(${sx}, ${sy});`;\n\t\t}\n\t};\n}\n\n/**\n * @param {Element} element\n */\nfunction get_zoom(element) {\n\tif ('currentCSSZoom' in element) {\n\t\treturn /** @type {number} */ (element.currentCSSZoom);\n\t}\n\n\t/** @type {Element | null} */\n\tvar current = element;\n\tvar zoom = 1;\n\n\twhile (current !== null) {\n\t\tzoom *= +getComputedStyle(current).zoom;\n\t\tcurrent = /** @type {Element | null} */ (current.parentElement);\n\t}\n\n\treturn zoom;\n}\n","/** @import { BlurParams, CrossfadeParams, DrawParams, FadeParams, FlyParams, ScaleParams, SlideParams, TransitionConfig } from './public' */\n\nimport { DEV } from 'esm-env';\nimport * as w from '../internal/client/warnings.js';\n\n/** @param {number} x */\nconst linear = (x) => x;\n\n/** @param {number} t */\nfunction cubic_out(t) {\n\tconst f = t - 1.0;\n\treturn f * f * f + 1.0;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nfunction cubic_in_out(t) {\n\treturn t < 0.5 ? 4.0 * t * t * t : 0.5 * Math.pow(2.0 * t - 2.0, 3.0) + 1.0;\n}\n\n/** @param {number | string} value\n * @returns {[number, string]}\n */\nfunction split_css_unit(value) {\n\tconst split = typeof value === 'string' && value.match(/^\\s*(-?[\\d.]+)([^\\s]*)\\s*$/);\n\treturn split ? [parseFloat(split[1]), split[2] || 'px'] : [/** @type {number} */ (value), 'px'];\n}\n\n/**\n * Animates a `blur` filter alongside an element's opacity.\n *\n * @param {Element} node\n * @param {BlurParams} [params]\n * @returns {TransitionConfig}\n */\nexport function blur(\n\tnode,\n\t{ delay = 0, duration = 400, easing = cubic_in_out, amount = 5, opacity = 0 } = {}\n) {\n\tconst style = getComputedStyle(node);\n\tconst target_opacity = +style.opacity;\n\tconst f = style.filter === 'none' ? '' : style.filter;\n\tconst od = target_opacity * (1 - opacity);\n\tconst [value, unit] = split_css_unit(amount);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (_t, u) => `opacity: ${target_opacity - od * u}; filter: ${f} blur(${u * value}${unit});`\n\t};\n}\n\n/**\n * Animates the opacity of an element from 0 to the current opacity for `in` transitions and from the current opacity to 0 for `out` transitions.\n *\n * @param {Element} node\n * @param {FadeParams} [params]\n * @returns {TransitionConfig}\n */\nexport function fade(node, { delay = 0, duration = 400, easing = linear } = {}) {\n\tconst o = +getComputedStyle(node).opacity;\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (t) => `opacity: ${t * o}`\n\t};\n}\n\n/**\n * Animates the x and y positions and the opacity of an element. `in` transitions animate from the provided values, passed as parameters to the element's default values. `out` transitions animate from the element's default values to the provided values.\n *\n * @param {Element} node\n * @param {FlyParams} [params]\n * @returns {TransitionConfig}\n */\nexport function fly(\n\tnode,\n\t{ delay = 0, duration = 400, easing = cubic_out, x = 0, y = 0, opacity = 0 } = {}\n) {\n\tconst style = getComputedStyle(node);\n\tconst target_opacity = +style.opacity;\n\tconst transform = style.transform === 'none' ? '' : style.transform;\n\tconst od = target_opacity * (1 - opacity);\n\tconst [x_value, x_unit] = split_css_unit(x);\n\tconst [y_value, y_unit] = split_css_unit(y);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (t, u) => `\n\t\t\ttransform: ${transform} translate(${(1 - t) * x_value}${x_unit}, ${(1 - t) * y_value}${y_unit});\n\t\t\topacity: ${target_opacity - od * u}`\n\t};\n}\n\nvar slide_warning = false;\n\n/**\n * Slides an element in and out.\n *\n * @param {Element} node\n * @param {SlideParams} [params]\n * @returns {TransitionConfig}\n */\nexport function slide(node, { delay = 0, duration = 400, easing = cubic_out, axis = 'y' } = {}) {\n\tconst style = getComputedStyle(node);\n\n\tif (DEV && !slide_warning && /(contents|inline|table)/.test(style.display)) {\n\t\tslide_warning = true;\n\t\tPromise.resolve().then(() => (slide_warning = false));\n\t\tw.transition_slide_display(style.display);\n\t}\n\n\tconst opacity = +style.opacity;\n\tconst primary_property = axis === 'y' ? 'height' : 'width';\n\tconst primary_property_value = parseFloat(style[primary_property]);\n\tconst secondary_properties = axis === 'y' ? ['top', 'bottom'] : ['left', 'right'];\n\tconst capitalized_secondary_properties = secondary_properties.map(\n\t\t(e) => /** @type {'Left' | 'Right' | 'Top' | 'Bottom'} */ (`${e[0].toUpperCase()}${e.slice(1)}`)\n\t);\n\tconst padding_start_value = parseFloat(style[`padding${capitalized_secondary_properties[0]}`]);\n\tconst padding_end_value = parseFloat(style[`padding${capitalized_secondary_properties[1]}`]);\n\tconst margin_start_value = parseFloat(style[`margin${capitalized_secondary_properties[0]}`]);\n\tconst margin_end_value = parseFloat(style[`margin${capitalized_secondary_properties[1]}`]);\n\tconst border_width_start_value = parseFloat(\n\t\tstyle[`border${capitalized_secondary_properties[0]}Width`]\n\t);\n\tconst border_width_end_value = parseFloat(\n\t\tstyle[`border${capitalized_secondary_properties[1]}Width`]\n\t);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (t) =>\n\t\t\t'overflow: hidden;' +\n\t\t\t`opacity: ${Math.min(t * 20, 1) * opacity};` +\n\t\t\t`${primary_property}: ${t * primary_property_value}px;` +\n\t\t\t`padding-${secondary_properties[0]}: ${t * padding_start_value}px;` +\n\t\t\t`padding-${secondary_properties[1]}: ${t * padding_end_value}px;` +\n\t\t\t`margin-${secondary_properties[0]}: ${t * margin_start_value}px;` +\n\t\t\t`margin-${secondary_properties[1]}: ${t * margin_end_value}px;` +\n\t\t\t`border-${secondary_properties[0]}-width: ${t * border_width_start_value}px;` +\n\t\t\t`border-${secondary_properties[1]}-width: ${t * border_width_end_value}px;` +\n\t\t\t`min-${primary_property}: 0`\n\t};\n}\n\n/**\n * Animates the opacity and scale of an element. `in` transitions animate from the provided values, passed as parameters, to an element's current (default) values. `out` transitions animate from an element's default values to the provided values.\n *\n * @param {Element} node\n * @param {ScaleParams} [params]\n * @returns {TransitionConfig}\n */\nexport function scale(\n\tnode,\n\t{ delay = 0, duration = 400, easing = cubic_out, start = 0, opacity = 0 } = {}\n) {\n\tconst style = getComputedStyle(node);\n\tconst target_opacity = +style.opacity;\n\tconst transform = style.transform === 'none' ? '' : style.transform;\n\tconst sd = 1 - start;\n\tconst od = target_opacity * (1 - opacity);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (_t, u) => `\n\t\t\ttransform: ${transform} scale(${1 - sd * u});\n\t\t\topacity: ${target_opacity - od * u}\n\t\t`\n\t};\n}\n\n/**\n * Animates the stroke of an SVG element, like a snake in a tube. `in` transitions begin with the path invisible and draw the path to the screen over time. `out` transitions start in a visible state and gradually erase the path. `draw` only works with elements that have a `getTotalLength` method, like `<path>` and `<polyline>`.\n *\n * @param {SVGElement & { getTotalLength(): number }} node\n * @param {DrawParams} [params]\n * @returns {TransitionConfig}\n */\nexport function draw(node, { delay = 0, speed, duration, easing = cubic_in_out } = {}) {\n\tlet len = node.getTotalLength();\n\tconst style = getComputedStyle(node);\n\tif (style.strokeLinecap !== 'butt') {\n\t\tlen += parseInt(style.strokeWidth);\n\t}\n\tif (duration === undefined) {\n\t\tif (speed === undefined) {\n\t\t\tduration = 800;\n\t\t} else {\n\t\t\tduration = len / speed;\n\t\t}\n\t} else if (typeof duration === 'function') {\n\t\tduration = duration(len);\n\t}\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (_, u) => `\n\t\t\tstroke-dasharray: ${len};\n\t\t\tstroke-dashoffset: ${u * len};\n\t\t`\n\t};\n}\n\n/**\n * @template T\n * @template S\n * @param {T} tar\n * @param {S} src\n * @returns {T & S}\n */\nfunction assign(tar, src) {\n\t// @ts-ignore\n\tfor (const k in src) tar[k] = src[k];\n\treturn /** @type {T & S} */ (tar);\n}\n\n/**\n * The `crossfade` function creates a pair of [transitions](https://svelte.dev/docs/svelte/transition) called `send` and `receive`. When an element is 'sent', it looks for a corresponding element being 'received', and generates a transition that transforms the element to its counterpart's position and fades it out. When an element is 'received', the reverse happens. If there is no counterpart, the `fallback` transition is used.\n *\n * @param {CrossfadeParams & {\n * \tfallback?: (node: Element, params: CrossfadeParams, intro: boolean) => TransitionConfig;\n * }} params\n * @returns {[(node: any, params: CrossfadeParams & { key: any; }) => () => TransitionConfig, (node: any, params: CrossfadeParams & { key: any; }) => () => TransitionConfig]}\n */\nexport function crossfade({ fallback, ...defaults }) {\n\t/** @type {Map<any, Element>} */\n\tconst to_receive = new Map();\n\t/** @type {Map<any, Element>} */\n\tconst to_send = new Map();\n\n\t/**\n\t * @param {Element} from_node\n\t * @param {Element} node\n\t * @param {CrossfadeParams} params\n\t * @returns {TransitionConfig}\n\t */\n\tfunction crossfade(from_node, node, params) {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = /** @param {number} d */ (d) => Math.sqrt(d) * 30,\n\t\t\teasing = cubic_out\n\t\t} = assign(assign({}, defaults), params);\n\t\tconst from = from_node.getBoundingClientRect();\n\t\tconst to = node.getBoundingClientRect();\n\t\tconst dx = from.left - to.left;\n\t\tconst dy = from.top - to.top;\n\t\tconst dw = from.width / to.width;\n\t\tconst dh = from.height / to.height;\n\t\tconst d = Math.sqrt(dx * dx + dy * dy);\n\t\tconst style = getComputedStyle(node);\n\t\tconst transform = style.transform === 'none' ? '' : style.transform;\n\t\tconst opacity = +style.opacity;\n\t\treturn {\n\t\t\tdelay,\n\t\t\tduration: typeof duration === 'function' ? duration(d) : duration,\n\t\t\teasing,\n\t\t\tcss: (t, u) => `\n\t\t\t   opacity: ${t * opacity};\n\t\t\t   transform-origin: top left;\n\t\t\t   transform: ${transform} translate(${u * dx}px,${u * dy}px) scale(${t + (1 - t) * dw}, ${\n\t\t\t\t\t\tt + (1 - t) * dh\n\t\t\t\t\t});\n\t\t   `\n\t\t};\n\t}\n\n\t/**\n\t * @param {Map<any, Element>} items\n\t * @param {Map<any, Element>} counterparts\n\t * @param {boolean} intro\n\t * @returns {(node: any, params: CrossfadeParams & { key: any; }) => () => TransitionConfig}\n\t */\n\tfunction transition(items, counterparts, intro) {\n\t\t// @ts-expect-error TODO improve typings (are the public types wrong?)\n\t\treturn (node, params) => {\n\t\t\titems.set(params.key, node);\n\t\t\treturn () => {\n\t\t\t\tif (counterparts.has(params.key)) {\n\t\t\t\t\tconst other_node = counterparts.get(params.key);\n\t\t\t\t\tcounterparts.delete(params.key);\n\t\t\t\t\treturn crossfade(/** @type {Element} */ (other_node), node, params);\n\t\t\t\t}\n\t\t\t\t// if the node is disappearing altogether\n\t\t\t\t// (i.e. wasn't claimed by the other list)\n\t\t\t\t// then we need to supply an outro\n\t\t\t\titems.delete(params.key);\n\t\t\t\treturn fallback && fallback(node, params, intro);\n\t\t\t};\n\t\t};\n\t}\n\treturn [transition(to_send, to_receive, false), transition(to_receive, to_send, true)];\n}\n","<script lang=\"ts\">\n  import type { Snippet } from 'svelte';\n  import { flip } from 'svelte/animate';\n  import { crossfade } from 'svelte/transition';\n\n  const [send, receive] = crossfade({});\n\n  type TItem = $$Generic;\n  interface Props {\n    items: TItem[];\n    labelProp: keyof TItem;\n    valueProp: keyof TItem;\n    selectedItemIndex?: number | null;\n    draggable?: boolean;\n    itemTemplate?: Snippet<[any]>;\n    onselect?: (selectedIndex: number) => void;\n    onkeydown?: (event: KeyboardEvent & { currentTarget: HTMLElement }) => void;\n    ondragstart?: (detail: {\n      item: TItem;\n      index: number;\n      event: DragEvent;\n    }) => void;\n    ondragend?: (detail: {\n      item: TItem;\n      index: number;\n      event: DragEvent;\n    }) => void;\n    onlistboxDrop?: (event: DragEvent) => void;\n    ondrop?: (detail: { item: TItem; index: number; event: DragEvent }) => void;\n    ondragover?: (detail: {\n      item: TItem;\n      index: number;\n      event: DragEvent;\n    }) => void;\n    ondragenter?: (detail: {\n      item: TItem;\n      index: number;\n      event: DragEvent;\n    }) => void;\n    ondragleave?: (detail: {\n      item: TItem;\n      index: number;\n      event: DragEvent;\n    }) => void;\n    [key: string]: any;\n  }\n\n  let {\n    items = $bindable([]),\n    labelProp,\n    valueProp,\n    selectedItemIndex = $bindable(null),\n    draggable = false,\n    itemTemplate,\n    onselect,\n    onkeydown,\n    ondragstart,\n    ondragend,\n    onlistboxDrop,\n    ondrop,\n    ondragover,\n    ondragenter,\n    ondragleave,\n    ...rest\n  }: Props = $props();\n\n  interface $$Slots {\n    itemTemplate: { item: TItem };\n  }\n\n  let idRandomizer = Math.random().toString().substring(2);\n\n  let listbox: HTMLElement;\n\n  function handleListboxKeyDown(\n    ev: KeyboardEvent & { currentTarget: HTMLElement },\n  ) {\n    if (items.length) {\n      const currentIndex = selectedItemIndex ?? -1;\n\n      if (ev.key === 'ArrowUp' && !ev.altKey) {\n        selectItemAt(Math.max(0, currentIndex - 1));\n        ev.preventDefault();\n      } else if (ev.key === 'ArrowDown' && !ev.altKey) {\n        selectItemAt(Math.min(items.length - 1, currentIndex + 1));\n        ev.preventDefault();\n      } else if (ev.key === 'Home') {\n        selectItemAt(0);\n        ev.preventDefault();\n      } else if (ev.key === 'End') {\n        selectItemAt(items.length - 1);\n        ev.preventDefault();\n      }\n\n      listbox\n        .querySelector(`#listbox-item-${selectedItemIndex}-${idRandomizer}`)\n        ?.scrollIntoView({ block: 'nearest' });\n    }\n\n    onkeydown?.(ev);\n  }\n\n  function selectItemAt(index: number) {\n    selectedItemIndex = index;\n    onselect?.(index);\n  }\n</script>\n\n<ul\n  bind:this={listbox}\n  role=\"listbox\"\n  class=\"listbox {rest.class ?? ''}\"\n  aria-activedescendant={selectedItemIndex !== null\n    ? `listbox-item-${selectedItemIndex}-${idRandomizer}`\n    : null}\n  tabindex=\"0\"\n  onkeydown={handleListboxKeyDown}\n  ondrop={(ev) => onlistboxDrop?.(ev)}\n>\n  {#each items as item, i (item[valueProp])}\n    <li\n      id=\"listbox-item-{i}-{idRandomizer}\"\n      role=\"option\"\n      aria-selected={selectedItemIndex === i}\n      class:focused={selectedItemIndex === i}\n      class=\"flex-row small-gap align-items-center\"\n      onclick={() => selectItemAt(i)}\n      onkeydown={(ev) => handleListboxKeyDown(ev)}\n      {draggable}\n      ondragstart={(ev) => ondragstart?.({ event: ev, item, index: i })}\n      ondragend={(ev) => ondragend?.({ event: ev, item, index: i })}\n      ondrop={(ev) => ondrop?.({ event: ev, item, index: i })}\n      ondragover={(ev) => ondragover?.({ event: ev, item, index: i })}\n      ondragenter={(ev) => ondragenter?.({ event: ev, item, index: i })}\n      ondragleave={(ev) => ondragleave?.({ event: ev, item, index: i })}\n      animate:flip={{ duration: 150 }}\n      in:receive={{ key: item[valueProp] }}\n      out:send={{ key: item[valueProp] }}\n    >\n      {#if draggable}\n        <i class=\"drag-grip fa-solid fa-grip-lines fa-fw\"></i>\n      {/if}\n      {#if itemTemplate}{@render itemTemplate({ item })}{:else}\n        {item[labelProp]}\n      {/if}\n    </li>\n  {/each}\n</ul>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n  interface Props {\n    moveAllToTheLeftDisabled: boolean;\n    moveUpDisabled: boolean;\n    moveDownDisabled: boolean;\n    moveLeftDisabled: boolean;\n    moveRightDisabled: boolean;\n    moveAllToTheRightDisabled: boolean;\n    onMoveAllToTheLeft?: () => void;\n    onMoveUp?: () => void;\n    onMoveDown?: () => void;\n    onMoveLeft?: () => void;\n    onMoveRight?: () => void;\n    onMoveAllToTheRight?: () => void;\n    [key: string]: any;\n  }\n\n  let {\n    onMoveAllToTheLeft,\n    onMoveUp,\n    onMoveDown,\n    onMoveLeft,\n    onMoveRight,\n    onMoveAllToTheRight,\n    ...props\n  }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"selection-listbox-toolbar {props.class ?? ''}\">\n  <button\n    title={localize('TIDY5E.Listbox.MoveUp')}\n    type=\"button\"\n    disabled={props.moveUpDisabled}\n    onclick={() => onMoveUp?.()}\n  >\n    <i class=\"fas fa-angle-up\"></i>\n  </button>\n  <button\n    title={localize('TIDY5E.Listbox.MoveDown')}\n    type=\"button\"\n    disabled={props.moveDownDisabled}\n    onclick={() => onMoveDown?.()}\n  >\n    <i class=\"fas fa-angle-down\"></i>\n  </button>\n  <button\n    title={localize('TIDY5E.Listbox.MoveLeft')}\n    type=\"button\"\n    disabled={props.moveLeftDisabled}\n    onclick={() => onMoveLeft?.()}\n  >\n    <i class=\"fas fa-angle-left\"></i>\n  </button>\n  <button\n    title={localize('TIDY5E.Listbox.MoveRight')}\n    type=\"button\"\n    disabled={props.moveRightDisabled}\n    onclick={() => onMoveRight?.()}\n  >\n    <i class=\"fas fa-angle-right\"></i>\n  </button>\n  <button\n    title={localize('TIDY5E.Listbox.MoveAllLeft')}\n    type=\"button\"\n    disabled={props.moveAllToTheLeftDisabled}\n    onclick={() => onMoveAllToTheLeft?.()}\n  >\n    <i class=\"fas fa-angles-left\"></i>\n  </button>\n  <button\n    title={localize('TIDY5E.Listbox.MoveAllRight')}\n    type=\"button\"\n    disabled={props.moveAllToTheRightDisabled}\n    onclick={() => onMoveAllToTheRight?.()}\n  >\n    <i class=\"fas fa-angles-right\"></i>\n  </button>\n</div>\n","<script lang=\"ts\">\n  import type { Snippet } from 'svelte';\n  import Listbox from './Listbox.svelte';\n  import SelectionListboxToolbar from './SelectionListboxToolbar.svelte';\n\n  type TItem = $$Generic;\n\n  interface Props {\n    leftItems: TItem[];\n    selectedLeftItemIndex?: number | null;\n    rightItems: TItem[];\n    selectedRightItemIndex?: number | null;\n    labelProp: keyof TItem;\n    valueProp: keyof TItem;\n    listboxCssClass?: string;\n    leftHeader?: Snippet;\n    rightHeader?: Snippet;\n    leftItemTemplate?: Snippet<[any]>;\n    rightItemTemplate?: Snippet<[any]>;\n    [key: string]: any;\n  }\n\n  let {\n    leftItems = $bindable(),\n    selectedLeftItemIndex = $bindable(null),\n    rightItems = $bindable(),\n    selectedRightItemIndex = $bindable(null),\n    labelProp,\n    valueProp,\n    listboxCssClass = '',\n    leftHeader,\n    rightHeader,\n    leftItemTemplate,\n    rightItemTemplate,\n    ...rest\n  }: Props = $props();\n\n  interface $$Slots {\n    leftHeader: any;\n    rightHeader: any;\n    leftItemTemplate: { item: TItem };\n    rightItemTemplate: { item: TItem };\n  }\n\n  let selectedItemIndex = $derived(\n    selectedLeftItemIndex ?? selectedRightItemIndex,\n  );\n\n  let selectedArray = $derived(\n    selectedLeftItemIndex !== null\n      ? leftItems\n      : selectedRightItemIndex !== null\n        ? rightItems\n        : null,\n  );\n\n  function moveAllToTheLeft() {\n    leftItems = [...leftItems, ...rightItems];\n    rightItems = [];\n    itemsMoved();\n  }\n\n  function moveUp() {\n    if (\n      selectedItemIndex === null ||\n      selectedItemIndex === 0 ||\n      selectedArray === null\n    ) {\n      return;\n    }\n\n    const topValue = selectedArray[selectedItemIndex - 1];\n    const bottomValue = selectedArray[selectedItemIndex];\n    selectedArray[selectedItemIndex - 1] = bottomValue;\n    selectedArray[selectedItemIndex] = topValue;\n\n    if (selectedLeftItemIndex) {\n      selectedLeftItemIndex -= 1;\n      leftItems = leftItems;\n    } else if (selectedRightItemIndex) {\n      selectedRightItemIndex -= 1;\n      rightItems = rightItems;\n    }\n\n    itemsMoved();\n  }\n\n  function moveDown() {\n    if (\n      selectedArray === null ||\n      selectedItemIndex === null ||\n      selectedItemIndex >= selectedArray.length - 1\n    ) {\n      return;\n    }\n\n    const topValue = selectedArray[selectedItemIndex];\n    const bottomValue = selectedArray[selectedItemIndex + 1];\n    selectedArray[selectedItemIndex] = bottomValue;\n    selectedArray[selectedItemIndex + 1] = topValue;\n\n    if (selectedLeftItemIndex !== null) {\n      selectedLeftItemIndex += 1;\n      leftItems = leftItems;\n    } else if (selectedRightItemIndex !== null) {\n      selectedRightItemIndex += 1;\n      rightItems = rightItems;\n    }\n\n    itemsMoved();\n  }\n\n  function moveLeft() {\n    if (selectedRightItemIndex === null) {\n      return;\n    }\n\n    const itemToMove = rightItems.splice(selectedRightItemIndex, 1)[0];\n\n    if (!itemToMove) {\n      return;\n    }\n\n    rightItems = rightItems;\n    leftItems.push(itemToMove);\n    leftItems = leftItems;\n    itemsMoved({ scrollToEnd: 'left' });\n  }\n\n  function moveRight() {\n    if (selectedLeftItemIndex === null) {\n      return;\n    }\n\n    const itemToMove = leftItems.splice(selectedLeftItemIndex, 1)[0];\n\n    if (!itemToMove) {\n      return;\n    }\n\n    leftItems = leftItems;\n    rightItems.push(itemToMove);\n    rightItems = rightItems;\n    itemsMoved({ scrollToEnd: 'right' });\n  }\n\n  function moveAllToTheRight() {\n    rightItems = [...rightItems, ...leftItems];\n    leftItems = [];\n    itemsMoved();\n  }\n\n  function itemsMoved(options?: { scrollToEnd?: 'left' | 'right' }) {\n    if (\n      selectedLeftItemIndex !== null &&\n      leftItems.at(selectedLeftItemIndex) === undefined\n    ) {\n      selectedLeftItemIndex = leftItems.length ? leftItems.length - 1 : null;\n    }\n\n    if (\n      selectedRightItemIndex !== null &&\n      rightItems.at(selectedRightItemIndex) === undefined\n    ) {\n      selectedRightItemIndex = rightItems.length ? rightItems.length - 1 : null;\n    }\n  }\n\n  function handleLeftListboxKeydown(\n    e: KeyboardEvent & { currentTarget: HTMLElement },\n  ): void {\n    if (e.code === 'Space') {\n      moveRight();\n      e.preventDefault();\n    } else if (e.key === 'ArrowUp' && e.altKey) {\n      moveUp();\n    } else if (e.key === 'ArrowDown' && e.altKey) {\n      moveDown();\n    }\n  }\n  function handleRightListboxKeydown(\n    e: KeyboardEvent & { currentTarget: HTMLElement },\n  ): void {\n    if (e.code === 'Space') {\n      moveLeft();\n      e.preventDefault();\n    } else if (e.key === 'ArrowUp' && e.altKey) {\n      moveUp();\n    } else if (e.key === 'ArrowDown' && e.altKey) {\n      moveDown();\n    }\n  }\n</script>\n\n<div class=\"selection-listbox {rest.class ?? ''}\">\n  {#if leftHeader || rightHeader}\n    <div class=\"column-1\">\n      {@render leftHeader?.()}\n    </div>\n    <div class=\"column-3\">\n      {@render rightHeader?.()}\n    </div>\n  {/if}\n  <Listbox\n    bind:items={leftItems}\n    {labelProp}\n    {valueProp}\n    bind:selectedItemIndex={selectedLeftItemIndex}\n    onselect={() => {\n      selectedRightItemIndex = null;\n    }}\n    onkeydown={handleLeftListboxKeydown}\n    class=\"column-1 {listboxCssClass}\"\n  >\n    {#snippet itemTemplate({ item })}\n      {#if leftItemTemplate}{@render leftItemTemplate({ item })}{:else}\n        {item[labelProp]}\n      {/if}\n    {/snippet}\n  </Listbox>\n  <SelectionListboxToolbar\n    moveUpDisabled={selectedItemIndex === null || selectedItemIndex === 0}\n    onMoveUp={moveUp}\n    moveDownDisabled={selectedItemIndex === null ||\n      selectedArray === null ||\n      selectedItemIndex >= selectedArray.length - 1}\n    onMoveDown={moveDown}\n    moveLeftDisabled={selectedLeftItemIndex !== null ||\n      selectedRightItemIndex === null}\n    onMoveLeft={moveLeft}\n    moveRightDisabled={selectedLeftItemIndex === null ||\n      selectedRightItemIndex !== null}\n    onMoveRight={moveRight}\n    moveAllToTheLeftDisabled={rightItems.length === 0}\n    onMoveAllToTheLeft={moveAllToTheLeft}\n    moveAllToTheRightDisabled={leftItems.length === 0}\n    onMoveAllToTheRight={moveAllToTheRight}\n    class=\"column-2\"\n  />\n  <Listbox\n    bind:items={rightItems}\n    {labelProp}\n    {valueProp}\n    bind:selectedItemIndex={selectedRightItemIndex}\n    onselect={() => {\n      selectedLeftItemIndex = null;\n    }}\n    onkeydown={handleRightListboxKeydown}\n    class=\"column-3 {listboxCssClass}\"\n  >\n    {#snippet itemTemplate({ item })}\n      {#if rightItemTemplate}{@render rightItemTemplate({ item })}{:else}\n        {item[labelProp]}\n      {/if}\n    {/snippet}\n  </Listbox>\n</div>\n","<script lang=\"ts\">\n  import SelectionListbox from 'src/components/listbox/SelectionListbox.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { Snippet } from 'svelte';\n\n  interface Props {\n    name: string;\n    hint: string;\n    leftHeaderText?: string;\n    leftItems: any[];\n    rightHeaderText?: string;\n    rightItems: any[];\n    labelProp: string;\n    valueProp: string;\n    belowListbox?: Snippet;\n  }\n\n  let {\n    name,\n    hint,\n    leftHeaderText = '',\n    leftItems = $bindable(),\n    rightHeaderText = '',\n    rightItems = $bindable(),\n    labelProp,\n    valueProp,\n    belowListbox,\n  }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<article class=\"setting group\">\n  <div class=\"description flex-1\">\n    <b>{localize(name)}</b>\n    <p>\n      {localize(hint)}\n    </p>\n    <div class=\"flex-column small-gap\">\n      <SelectionListbox bind:leftItems bind:rightItems {labelProp} {valueProp}>\n        {#snippet leftHeader()}\n          <b>{localize(leftHeaderText)}</b>\n        {/snippet}\n        {#snippet rightHeader()}\n          <b>{localize(rightHeaderText)}</b>\n        {/snippet}\n      </SelectionListbox>\n      {@render belowListbox?.()}\n    </div>\n  </div>\n</article>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import CheckboxSetting from 'src/applications/settings/parts/CheckboxSetting.svelte';\n  import { getContext } from 'svelte';\n  import { SettingsProvider } from 'src/settings/settings.svelte';\n  import SelectSetting from 'src/applications/settings/parts/SelectSetting.svelte';\n  import type {\n    WorldSettingsContext,\n    WorldSettingsFunctions,\n  } from '../WorldSettings.types';\n  import ListboxSetting from '../../parts/ListboxSetting.svelte';\n  import { CONSTANTS } from 'src/constants';\n\n  const context = getContext<WorldSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n  let functions = getContext<WorldSettingsFunctions>(\n    CONSTANTS.SVELTE_CONTEXT.FUNCTIONS,\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"settings-form\">\n  <SelectSetting\n    options={SettingsProvider.settings.initialCharacterSheetTab.options.choices()}\n    bind:value={context.settings.initialCharacterSheetTab}\n    name={SettingsProvider.settings.initialCharacterSheetTab.options.name}\n    hint={SettingsProvider.settings.initialCharacterSheetTab.options.hint}\n    id=\"initialCharacterSheetTab\"\n  />\n\n  <ListboxSetting\n    name={SettingsProvider.settings.defaultCharacterSheetTabs.options.name}\n    hint={SettingsProvider.settings.defaultCharacterSheetTabs.options.hint}\n    leftHeaderText=\"TIDY5E.Settings.DefaultSheetTabs.AvailableHeader\"\n    bind:leftItems={context.defaultCharacterTabs.available}\n    rightHeaderText=\"TIDY5E.Settings.DefaultSheetTabs.SelectedHeader\"\n    bind:rightItems={context.defaultCharacterTabs.selected}\n    labelProp=\"label\"\n    valueProp=\"id\"\n  >\n    {#snippet belowListbox()}\n      <div>\n        <button\n          type=\"button\"\n          onclick={() =>\n            functions.resetDefaultTabs(CONSTANTS.SHEET_TYPE_CHARACTER)}\n        >\n          <i class=\"fas fa-rotate-right\"></i>\n          {localize('TIDY5E.Reset')}\n        </button>\n      </div>\n    {/snippet}\n  </ListboxSetting>\n\n  <CheckboxSetting\n    bind:value={context.settings.useCharacterEncumbranceBar}\n    name={SettingsProvider.settings.useCharacterEncumbranceBar.options.name}\n    hint={SettingsProvider.settings.useCharacterEncumbranceBar.options.hint}\n    id=\"useCharacterEncumbranceBar\"\n  />\n\n  <CheckboxSetting\n    bind:value={context.settings.showPlayerName}\n    name={'TIDY5E.Settings.ShowPlayerName.name'}\n    hint={'TIDY5E.Settings.ShowPlayerName.hint'}\n    id=\"showPlayerName\"\n  />\n\n  <CheckboxSetting\n    bind:value={context.settings.useCharacterInspiration}\n    name={'TIDY5E.Settings.UseInspiration.name'}\n    hint={'TIDY5E.Settings.UseInspiration.hint'}\n    id=\"useCharacterInspiration\"\n  />\n\n  <CheckboxSetting\n    bind:value={context.settings.allowHpMaxOverride}\n    name={'TIDY5E.Settings.AllowHpMaxOverride.name'}\n    hint={'TIDY5E.Settings.AllowHpMaxOverride.hint'}\n    id=\"allowHpMaxOverride\"\n  />\n</div>\n\n<style lang=\"scss\">\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import CheckboxSetting from 'src/applications/settings/parts/CheckboxSetting.svelte';\n  import { getContext } from 'svelte';\n  import { SettingsProvider } from 'src/settings/settings.svelte';\n  import SelectSetting from 'src/applications/settings/parts/SelectSetting.svelte';\n  import type {\n    WorldSettingsContext,\n    WorldSettingsFunctions,\n  } from '../WorldSettings.types';\n  import ListboxSetting from '../../parts/ListboxSetting.svelte';\n  import { CONSTANTS } from 'src/constants';\n\n  const context = getContext<WorldSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n  let functions = getContext<WorldSettingsFunctions>(\n    CONSTANTS.SVELTE_CONTEXT.FUNCTIONS,\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"settings-form\">\n  <SelectSetting\n    options={SettingsProvider.settings.initialNpcSheetTab.options.choices()}\n    bind:value={context.settings.initialNpcSheetTab}\n    name={SettingsProvider.settings.initialNpcSheetTab.options.name}\n    hint={SettingsProvider.settings.initialNpcSheetTab.options.hint}\n    id=\"initialNpcSheetTab\"\n  />\n\n  <ListboxSetting\n    name={SettingsProvider.settings.defaultNpcSheetTabs.options.name}\n    hint={SettingsProvider.settings.defaultNpcSheetTabs.options.hint}\n    leftHeaderText=\"TIDY5E.Settings.DefaultSheetTabs.AvailableHeader\"\n    bind:leftItems={context.defaultNpcTabs.available}\n    rightHeaderText=\"TIDY5E.Settings.DefaultSheetTabs.SelectedHeader\"\n    bind:rightItems={context.defaultNpcTabs.selected}\n    labelProp=\"label\"\n    valueProp=\"id\"\n  >\n    {#snippet belowListbox()}\n      <div>\n        <button\n          type=\"button\"\n          onclick={() => functions.resetDefaultTabs(CONSTANTS.SHEET_TYPE_NPC)}\n        >\n          <i class=\"fas fa-rotate-right\"></i>\n          {localize('TIDY5E.Reset')}\n        </button>\n      </div>\n    {/snippet}\n  </ListboxSetting>\n\n  <CheckboxSetting\n    bind:value={context.settings.showNpcRestInChat}\n    name={'TIDY5E.Settings.ShowNPCRestInChat.name'}\n    hint={'TIDY5E.Settings.ShowNPCRestInChat.hint'}\n    id=\"showNpcRestInChat\"\n  />\n\n  <SelectSetting\n    options={{\n      default: 'TIDY5E.Settings.ShowNPCActorLinkMarker.default',\n      unlinked: 'TIDY5E.Settings.ShowNPCActorLinkMarker.unlinked',\n      both: 'TIDY5E.Settings.ShowNPCActorLinkMarker.both',\n    }}\n    bind:value={context.settings.showNpcActorLinkMarker}\n    name=\"TIDY5E.Settings.ShowNPCActorLinkMarker.name\"\n    hint=\"TIDY5E.Settings.ShowNPCActorLinkMarker.hint\"\n    id=\"showNpcActorLinkMarker\"\n  />\n\n  <CheckboxSetting\n    bind:value={context.settings.useNpcEncumbranceBar}\n    name={SettingsProvider.settings.useNpcEncumbranceBar.options.name}\n    hint={SettingsProvider.settings.useNpcEncumbranceBar.options.hint}\n    id=\"useNpcEncumbranceBar\"\n  />\n</div>\n\n<style lang=\"scss\">\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import CheckboxSetting from 'src/applications/settings/parts/CheckboxSetting.svelte';\n  import { getContext } from 'svelte';\n  import { SettingsProvider } from 'src/settings/settings.svelte';\n  import SelectSetting from 'src/applications/settings/parts/SelectSetting.svelte';\n  import type {\n    WorldSettingsContext,\n    WorldSettingsFunctions,\n  } from '../WorldSettings.types';\n  import ListboxSetting from '../../parts/ListboxSetting.svelte';\n  import { CONSTANTS } from 'src/constants';\n\n  const context = getContext<WorldSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n  let functions = getContext<WorldSettingsFunctions>(\n    CONSTANTS.SVELTE_CONTEXT.FUNCTIONS,\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"settings-form\">\n  <SelectSetting\n    options={SettingsProvider.settings.initialVehicleSheetTab.options.choices()}\n    bind:value={context.settings.initialVehicleSheetTab}\n    name={SettingsProvider.settings.initialVehicleSheetTab.options.name}\n    hint={SettingsProvider.settings.initialVehicleSheetTab.options.hint}\n    id=\"initialVehicleSheetTab\"\n  />\n\n  <ListboxSetting\n    name={SettingsProvider.settings.defaultVehicleSheetTabs.options.name}\n    hint={SettingsProvider.settings.defaultVehicleSheetTabs.options.hint}\n    leftHeaderText=\"TIDY5E.Settings.DefaultSheetTabs.AvailableHeader\"\n    bind:leftItems={context.defaultVehicleTabs.available}\n    rightHeaderText=\"TIDY5E.Settings.DefaultSheetTabs.SelectedHeader\"\n    bind:rightItems={context.defaultVehicleTabs.selected}\n    labelProp=\"label\"\n    valueProp=\"id\"\n  >\n    {#snippet belowListbox()}\n      <div>\n        <button\n          type=\"button\"\n          onclick={() =>\n            functions.resetDefaultTabs(CONSTANTS.SHEET_TYPE_VEHICLE)}\n        >\n          <i class=\"fas fa-rotate-right\"></i>\n          {localize('TIDY5E.Reset')}\n        </button>\n      </div>\n    {/snippet}\n  </ListboxSetting>\n\n  <CheckboxSetting\n    bind:value={context.settings.useVehicleEncumbranceBar}\n    name={SettingsProvider.settings.useVehicleEncumbranceBar.options.name}\n    hint={SettingsProvider.settings.useVehicleEncumbranceBar.options.hint}\n    id=\"useVehicleEncumbranceBar\"\n  />\n\n  <CheckboxSetting\n    bind:value={context.settings.useVehicleMotion}\n    name={'TIDY5E.Settings.UseVehicleMotion.name'}\n    hint={'TIDY5E.Settings.UseVehicleMotion.hint'}\n    id=\"useVehicleMotion\"\n  />\n</div>\n\n<style lang=\"scss\">\n</style>\n","<script lang=\"ts\">\n  import { getContext } from 'svelte';\n  import { SettingsProvider } from 'src/settings/settings.svelte';\n  import SelectSetting from 'src/applications/settings/parts/SelectSetting.svelte';\n  import type { WorldSettingsContext } from '../WorldSettings.types';\n  import CheckboxSetting from '../../parts/CheckboxSetting.svelte';\n  import { CONSTANTS } from 'src/constants';\n\n  const context = getContext<WorldSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n</script>\n\n<div class=\"settings-form\">\n  <CheckboxSetting\n    name={SettingsProvider.settings.includeTidySectionFieldsInDefaultSheets\n      .options.name}\n    hint={SettingsProvider.settings.includeTidySectionFieldsInDefaultSheets\n      .options.hint}\n    bind:value={context.settings.includeTidySectionFieldsInDefaultSheets}\n    id=\"includeTidySectionFieldsInDefaultSheets\"\n  />\n\n  <SelectSetting\n    options={SettingsProvider.settings.itemIdentificationPermission.options\n      .choices}\n    bind:value={context.settings.itemIdentificationPermission}\n    name={SettingsProvider.settings.itemIdentificationPermission.options.name}\n    hint={SettingsProvider.settings.itemIdentificationPermission.options.hint}\n    id=\"initialCharacterSheetTab\"\n  />\n\n  <CheckboxSetting\n    name={SettingsProvider.settings.includeFlagsInSpellScrollCreation.options\n      .name}\n    hint={SettingsProvider.settings.includeFlagsInSpellScrollCreation.options\n      .hint}\n    bind:value={context.settings.includeFlagsInSpellScrollCreation}\n    id=\"includeFlagsInSpellScrollCreation\"\n  />\n</div>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getContext } from 'svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import type { ExhaustionConfig } from 'src/features/exhaustion/exhaustion.types';\n  import { CONSTANTS } from 'src/constants';\n  import { coalesce } from 'src/utils/formatting';\n\n  interface Props {\n    name: string;\n    hint: string;\n    config: ExhaustionConfig;\n  }\n\n  let { name, hint, config = $bindable() }: Props = $props();\n\n  let appId = getContext(CONSTANTS.SVELTE_CONTEXT.APP_ID);\n\n  let levelsIterator = $derived(\n    config.type === 'specific' ? Array(config.levels + 1).fill(0) : [],\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<article class=\"setting group\">\n  <section>\n    <div class=\"description\">\n      <label for=\"exhaustionConfigType-{appId}\">{localize(name)}</label>\n      <p class=\"tidy5e-notes\">{localize(hint)}</p>\n    </div>\n    <div class=\"settings-group\">\n      <select id=\"exhaustionConfigType-{appId}\" bind:value={config.type}>\n        <SelectOptions\n          data={{\n            specific: 'TIDY5E.WorldSettings.Exhaustion.options.specific.text',\n            open: 'TIDY5E.WorldSettings.Exhaustion.options.open.text',\n          }}\n        ></SelectOptions>\n      </select>\n      {#if config.type === 'open'}\n        <p class=\"tidy5e-notes\">\n          {localize('TIDY5E.WorldSettings.Exhaustion.options.open.explanation')}\n        </p>\n      {/if}\n    </div>\n  </section>\n</article>\n\n{#if config.type === 'specific'}\n  <article class=\"setting group\">\n    <section>\n      <div class=\"description\">\n        <label for=\"exhaustionConfigTypeLevels-{appId}\"\n          >{localize(\n            'TIDY5E.WorldSettings.Exhaustion.options.specific.levels.name',\n          )}</label\n        >\n        <p class=\"tidy5e-notes\">\n          {localize(\n            'TIDY5E.WorldSettings.Exhaustion.options.specific.levels.hint',\n          )}\n        </p>\n      </div>\n      <div class=\"settings-group\">\n        <input type=\"number\" bind:value={config.levels} min=\"1\" />\n      </div>\n    </section>\n  </article>\n\n  {#if config.type === 'specific'}\n    {#each levelsIterator as _, i (i)}\n      {@const hint = localize(\n        coalesce(config.hints[i], 'TIDY5E.ExhaustionLevelTooltip'),\n        { level: i },\n      )}\n      <article class=\"setting group\">\n        <section class=\"\">\n          <div class=\"description\">\n            <label\n              for=\"exhaustion-level-{i}-{appId}\"\n              title={hint}\n              class=\"flex-row small-gap align-items-center\"\n            >\n              {localize(\n                'TIDY5E.WorldSettings.Exhaustion.options.specific.levels.tooltip.name',\n                {\n                  level: i,\n                },\n              )}\n              <i class=\"fas fa-info-circle\"></i>\n            </label>\n            <p class=\"tidy5e-notes\">\n              {localize(\n                'TIDY5E.WorldSettings.Exhaustion.options.specific.levels.tooltip.hint',\n              )}\n            </p>\n          </div>\n          <div class=\"settings-group\">\n            <input\n              type=\"text\"\n              id=\"exhaustion-level-{i}-{appId}\"\n              bind:value={config.hints[i]}\n              placeholder={localize('TIDY5E.ExhaustionLevelTooltip', {\n                level: i,\n              })}\n            />\n          </div>\n        </section>\n      </article>\n    {/each}\n  {/if}\n{/if}\n","import type {\n  ExhaustionConfig,\n  IconWithSeverity,\n} from 'src/features/exhaustion/exhaustion.types';\n\nexport function getDefaultExhaustionConfig(): ExhaustionConfig {\n  return {\n    type: 'specific',\n    levels: 6,\n    hints: [],\n  };\n}\n\nconst iconsWithSeverity: IconWithSeverity[] = [\n  { iconCssClass: 'far fa-grin', severity: 0 },\n  { iconCssClass: 'far fa-smile', severity: 1 },\n  { iconCssClass: 'far fa-meh', severity: 1 },\n  { iconCssClass: 'far fa-frown', severity: 2 },\n  { iconCssClass: 'far fa-frown-open', severity: 2 },\n  { iconCssClass: 'far fa-tired', severity: 3 },\n  { iconCssClass: 'far fa-dizzy', severity: 3 },\n];\n\nexport function getExhaustionIconsWithSeverity(\n  levels: number\n): IconWithSeverity[] {\n  const levelsIncludingZero = levels + 1;\n\n  if (levelsIncludingZero === 0) {\n    return [];\n  }\n\n  const lastIconWithSeverity = iconsWithSeverity[iconsWithSeverity.length - 1];\n\n  if (levelsIncludingZero === 1) {\n    return [iconsWithSeverity[0]];\n  }\n\n  if (levelsIncludingZero === 2) {\n    return [iconsWithSeverity[0], lastIconWithSeverity];\n  }\n\n  const middleIcons = iconsWithSeverity.slice(1, iconsWithSeverity.length - 1);\n  const middleIconsLength = middleIcons.length;\n\n  let distributedIcons: {\n    iconWithSeverity: IconWithSeverity;\n    order: number;\n  }[] = [];\n\n  for (let index = 0; index < levelsIncludingZero - 2; index++) {\n    const iconIndex = index % middleIconsLength;\n    distributedIcons.push({\n      iconWithSeverity: middleIcons[iconIndex],\n      order: iconIndex,\n    });\n  }\n\n  return [\n    iconsWithSeverity[0],\n    ...distributedIcons\n      .sort((a, b) => a.order - b.order)\n      .map((q) => q.iconWithSeverity),\n    lastIconWithSeverity,\n  ];\n}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import CheckboxSetting from 'src/applications/settings/parts/CheckboxSetting.svelte';\n  import { getContext } from 'svelte';\n  import type { WorldSettingsContext } from '../WorldSettings.types';\n  import ExhaustionSetting from '../../parts/ExhaustionSetting.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { getDefaultExhaustionConfig } from 'src/features/exhaustion/exhaustion';\n\n  const context = getContext<WorldSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"settings-form\">\n  <CheckboxSetting\n    bind:value={context.settings.useExhaustion}\n    name={'TIDY5E.Settings.UseExhaustion.name'}\n    hint={'TIDY5E.Settings.UseExhaustion.hint'}\n    id=\"useExhaustion\"\n  />\n\n  <h2>{localize('TIDY5E.WorldSettings.Exhaustion.Header')}</h2>\n\n  <article class=\"setting buttons\">\n    <button\n      type=\"button\"\n      onclick={() => (context.exhaustionConfig = getDefaultExhaustionConfig())}\n    >\n      {localize('TIDY5E.UseDefault')}\n    </button>\n  </article>\n\n  <ExhaustionSetting\n    name=\"TIDY5E.WorldSettings.Exhaustion.name\"\n    hint=\"TIDY5E.WorldSettings.Exhaustion.hint\"\n    bind:config={context.exhaustionConfig}\n  />\n\n  <h2>{localize('TIDY5E.WorldSettings.VehicleExhaustion.Header')}</h2>\n\n  <article class=\"setting buttons\">\n    <button\n      type=\"button\"\n      onclick={() =>\n        (context.vehicleExhaustionConfig = getDefaultExhaustionConfig())}\n    >\n      {localize('TIDY5E.UseDefault')}\n    </button>\n  </article>\n\n  <ExhaustionSetting\n    name=\"TIDY5E.WorldSettings.VehicleExhaustion.name\"\n    hint=\"TIDY5E.WorldSettings.VehicleExhaustion.hint\"\n    bind:config={context.vehicleExhaustionConfig}\n  />\n</div>\n\n<style lang=\"scss\">\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import CheckboxSetting from 'src/applications/settings/parts/CheckboxSetting.svelte';\n  import { getContext } from 'svelte';\n  import type { WorldSettingsContext } from '../WorldSettings.types';\n  import { CONSTANTS } from 'src/constants';\n\n  const context = getContext<WorldSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"settings-form\">\n  <CheckboxSetting\n    bind:value={context.settings.permanentlyUnlockCharacterSheetForGm}\n    name={'TIDY5E.Settings.PermanentlyUnlockCharacterSheetForGM.name'}\n    hint={'TIDY5E.Settings.PermanentlyUnlockCharacterSheetForGM.hint'}\n    id=\"permanentlyUnlockCharacterSheetForGm\"\n  />\n\n  <CheckboxSetting\n    bind:value={context.settings.permanentlyUnlockNpcSheetForGm}\n    name={'TIDY5E.Settings.PermanentlyUnlockNPCSheetForGM.name'}\n    hint={'TIDY5E.Settings.PermanentlyUnlockNPCSheetForGM.hint'}\n    id=\"permanentlyUnlockNpcSheetForGm\"\n  />\n\n  <CheckboxSetting\n    bind:value={context.settings.permanentlyUnlockVehicleSheetForGm}\n    name={'TIDY5E.Settings.PermanentlyUnlockVehicleSheetForGM.name'}\n    hint={'TIDY5E.Settings.PermanentlyUnlockVehicleSheetForGM.hint'}\n    id=\"permanentlyUnlockVehicleSheetForGm\"\n  />\n\n  <h2>{localize('TIDY5E.WorldSettings.TabSheetLock.header')}</h2>\n  <p class=\"tab-notes\">{localize('TIDY5E.WorldSettings.TabSheetLock.hint')}</p>\n  <p class=\"tab-notes\">{localize('TIDY5E.WorldSettings.TabSheetLock.hint2')}</p>\n\n  <CheckboxSetting\n    bind:value={context.settings.useTotalSheetLock}\n    name={'TIDY5E.Settings.UseTotalSheetLock.name'}\n    hint={'TIDY5E.Settings.UseTotalSheetLock.hint'}\n    id=\"useTotalSheetLock\"\n  />\n\n  <h3>{localize('TIDY5E.WorldSettings.TabSheetLock.labelGeneralLocks')}</h3>\n\n  <CheckboxSetting\n    bind:value={context.settings.lockExpChanges}\n    name={'TIDY5E.Settings.LockExpChanges.name'}\n    hint={'TIDY5E.Settings.LockExpChanges.hint'}\n    id=\"lockExpChanges\"\n  />\n\n  <CheckboxSetting\n    bind:value={context.settings.lockHpMaxChanges}\n    name={'TIDY5E.Settings.LockHpMaxChanges.name'}\n    hint={'TIDY5E.Settings.LockHpMaxChanges.hint'}\n    id=\"lockHpMaxChanges\"\n  />\n\n  <CheckboxSetting\n    bind:value={context.settings.lockConfigureSheet}\n    name={'TIDY5E.Settings.LockConfigureSheet.name'}\n    hint={'TIDY5E.Settings.LockConfigureSheet.hint'}\n    id=\"lockConfigureSheet\"\n  />\n\n  <h3>{localize('TIDY5E.WorldSettings.TabSheetLock.labelInventoryLocks')}</h3>\n\n  <CheckboxSetting\n    bind:value={context.settings.lockMoneyChanges}\n    name={'TIDY5E.Settings.LockMoneyChanges.name'}\n    hint={'TIDY5E.Settings.LockMoneyChanges.hint'}\n    id=\"lockMoneyChanges\"\n  />\n\n  <h3>{localize('TIDY5E.WorldSettings.TabSheetLock.labelFeaturesLocks')}</h3>\n\n  <CheckboxSetting\n    bind:value={context.settings.lockLevelSelector}\n    name={'TIDY5E.Settings.LockLevelSelector.name'}\n    hint={'TIDY5E.Settings.LockLevelSelector.hint'}\n    id=\"lockLevelSelector\"\n  />\n\n  <CheckboxSetting\n    bind:value={context.settings.lockItemQuantity}\n    name={'TIDY5E.Settings.LockItemQuantity.name'}\n    hint={'TIDY5E.Settings.LockItemQuantity.hint'}\n    id=\"lockItemQuantity\"\n  />\n</div>\n\n<style lang=\"scss\">\n</style>\n","<script lang=\"ts\">\n  import { SettingsProvider } from 'src/settings/settings.svelte';\n  import CheckboxSetting from '../../parts/CheckboxSetting.svelte';\n  import { getContext } from 'svelte';\n  import type { WorldSettingsContext } from '../WorldSettings.types';\n  import { CONSTANTS } from 'src/constants';\n\n  const context = getContext<WorldSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n</script>\n\n<div class=\"settings-form\">\n  <CheckboxSetting\n    bind:value={context.settings.useTidySpellSchoolIcons}\n    name={SettingsProvider.settings.useTidySpellSchoolIcons.options.name}\n    hint={SettingsProvider.settings.useTidySpellSchoolIcons.options.hint}\n    id=\"useTidySpellSchoolIcons\"\n  />\n</div>\n","export function clickOutside(\n  node: HTMLElement,\n  { callback }: { callback?: (event: MouseEvent, node: HTMLElement) => void }\n) {\n  $effect(() => {\n    const controller = new AbortController();\n\n    setTimeout(() => {\n      window.addEventListener(\n        'click',\n        (e: MouseEvent) => {\n          if (e.target instanceof Node && !node.contains(e.target)) {\n            callback?.(e, node);\n          }\n        },\n        { signal: controller.signal }\n      );\n    });\n\n    return () => {\n      controller.abort();\n    };\n  });\n}\n","import type {\n  ButtonMenuAnchor,\n  ButtonMenuPosition,\n  ButtonMenuPositionStyleInPixels,\n} from './button-menu-types';\n\nexport function getPositionStyles(\n  openerEl: HTMLElement,\n  menuEl: HTMLElement,\n  position: ButtonMenuPosition,\n  anchor: ButtonMenuAnchor,\n  gap: string | false\n): string {\n  let styleObj =\n    position === 'bottom'\n      ? getBottomPositionStyles(openerEl, menuEl)\n      : position === 'left'\n      ? getLeftPositionStyles(openerEl, menuEl)\n      : position === 'top'\n      ? getTopPositionStyles(openerEl, menuEl)\n      : position === 'right'\n      ? getRightPositionStyles(openerEl, menuEl)\n      : null;\n\n  if (!styleObj) {\n    return '';\n  }\n\n  if (anchor !== 'center') {\n    styleObj = anchorMenu(styleObj, anchor, openerEl, menuEl);\n  }\n\n  let styleString = Object.entries({ ...styleObj })\n    .map((x) => `${x[0]}: ${x[1]}px`)\n    .join('; ');\n\n  const gapTransform = getGapTransform(position, gap);\n\n  if (gapTransform) {\n    styleString += `; transform: ${gapTransform}`;\n  }\n\n  return styleString;\n}\n\nfunction getBottomPositionStyles(\n  openerEl: HTMLElement,\n  menuEl: HTMLElement\n): ButtonMenuPositionStyleInPixels {\n  const openerCenterX = Math.ceil(\n    openerEl.offsetLeft + Math.max(openerEl.offsetWidth, 1) / 2\n  );\n\n  return {\n    left: Math.ceil(openerCenterX - menuEl.offsetWidth / 2),\n    top: Math.ceil(openerEl.offsetTop + openerEl.offsetHeight),\n  };\n}\n\nfunction getLeftPositionStyles(\n  openerEl: HTMLElement,\n  menuEl: HTMLElement\n): ButtonMenuPositionStyleInPixels {\n  const openerCenterY = Math.ceil(\n    openerEl.offsetTop + Math.max(openerEl.offsetHeight, 1) / 2\n  );\n\n  return {\n    left: Math.ceil(openerEl.offsetLeft - menuEl.offsetWidth),\n    top: Math.ceil(openerCenterY - menuEl.offsetHeight / 2),\n  };\n}\n\nfunction getRightPositionStyles(\n  openerEl: HTMLElement,\n  menuEl: HTMLElement\n): ButtonMenuPositionStyleInPixels {\n  const openerCenterY = Math.ceil(\n    openerEl.offsetTop + Math.max(openerEl.offsetHeight, 1) / 2\n  );\n\n  return {\n    left: Math.ceil(openerEl.offsetLeft + openerEl.offsetWidth),\n    top: Math.ceil(openerCenterY - menuEl.offsetHeight / 2),\n  };\n}\n\nfunction getTopPositionStyles(\n  openerEl: HTMLElement,\n  menuEl: HTMLElement\n): ButtonMenuPositionStyleInPixels {\n  const openerCenterX = Math.ceil(\n    openerEl.offsetLeft + Math.max(openerEl.offsetWidth, 1) / 2\n  );\n\n  return {\n    left: Math.ceil(openerCenterX - menuEl.offsetWidth / 2),\n    top: Math.ceil(openerEl.offsetTop - menuEl.offsetHeight),\n  };\n}\n\nfunction anchorMenu(\n  styleObj: ButtonMenuPositionStyleInPixels,\n  anchor: ButtonMenuAnchor,\n  openerEl: HTMLElement,\n  menuEl: HTMLElement\n): ButtonMenuPositionStyleInPixels {\n  switch (anchor) {\n    case 'top':\n      styleObj.top = openerEl.offsetTop;\n      break;\n    case 'right':\n      const anchoredMenuLeftPixels =\n        openerEl.offsetLeft + openerEl.offsetWidth - menuEl.offsetWidth;\n      styleObj.left = anchoredMenuLeftPixels;\n      break;\n    case 'bottom':\n      const anchoredMenuTopPixels =\n        openerEl.offsetTop + openerEl.offsetHeight - menuEl.offsetHeight;\n      styleObj.top = anchoredMenuTopPixels;\n      break;\n    case 'left':\n      styleObj.left = openerEl.offsetLeft;\n      break;\n  }\n\n  return styleObj;\n}\n\nfunction getGapTransform(position: ButtonMenuPosition, gap: string | false) {\n  const translation =\n    position === 'top'\n      ? `translateY(-${gap})`\n      : position === 'right'\n      ? `translateX(${gap})`\n      : position === 'bottom'\n      ? `translateY(${gap})`\n      : position === 'left'\n      ? `translateX(-${gap})`\n      : null;\n\n  if (translation && gap) {\n    return translation;\n  }\n\n  return null;\n}\n","<script lang=\"ts\">\n  import { setContext, type Snippet } from 'svelte';\n  import { clickOutside } from '../../events/clickOutside.svelte';\n  import type {\n    ButtonMenuAnchor,\n    ButtonMenuContext,\n    ButtonMenuPosition,\n  } from './button-menu-types';\n  import { getPositionStyles } from './button-menu-position';\n  import { settings } from 'src/settings/settings.svelte';\n  import { CONSTANTS } from 'src/constants';\n\n  type StatefulIconClass = {\n    opened: string | null;\n    closed: string | null;\n  };\n\n  interface Props {\n    open?: boolean;\n    buttonText?: string;\n    iconClass?: string | StatefulIconClass | null;\n    wrapperClass?: string | null;\n    listClass?: string | null;\n    buttonClass?: string | null;\n    openerPadding?: string | null;\n    ariaLabel?: string | null;\n    title?: string | null;\n    gap?: string | false;\n    position?: ButtonMenuPosition;\n    anchor?: ButtonMenuAnchor;\n    menuElement?: keyof HTMLElementTagNameMap;\n    buttonStyle?: 'solid' | 'transparent-inline' | 'transparent-inline-icon';\n    children?: Snippet;\n  }\n\n  let {\n    open = $bindable(false),\n    buttonText = '',\n    iconClass = null,\n    wrapperClass = null,\n    listClass = null,\n    buttonClass = null,\n    openerPadding = null,\n    ariaLabel = null,\n    title = null,\n    gap = '0.25rem',\n    position = 'bottom',\n    anchor = 'center',\n    menuElement = 'ul',\n    buttonStyle = 'solid',\n    children,\n  }: Props = $props();\n\n  let openerEl: HTMLElement;\n  let menuStyles: string = $state('');\n\n  setContext<ButtonMenuContext>(CONSTANTS.SVELTE_CONTEXT.BUTTON_MENU_CONTEXT, {\n    close: close,\n  });\n\n  function close() {\n    open = false;\n  }\n\n  function positionMenu(menuEl: HTMLElement) {\n    menuStyles = getPositionStyles(openerEl, menuEl, position, anchor, gap);\n  }\n\n  let actualIconClass: string | null = $derived.by(() => {\n    if (iconClass !== null) {\n      if (typeof iconClass === 'string') {\n        return iconClass;\n      } else {\n        let potentialClass = open ? iconClass.opened : iconClass.closed;\n        potentialClass ??= iconClass.opened ?? iconClass.closed;\n        return potentialClass;\n      }\n    }\n    return null;\n  });\n</script>\n\n<div class=\"button-menu-wrapper {wrapperClass ?? ''}\">\n  <button\n    type=\"button\"\n    onclick={() => (open = !open)}\n    aria-label={ariaLabel}\n    bind:this={openerEl}\n    {title}\n    class=\"button-menu-opener {buttonClass ?? ''} {buttonStyle}\"\n    style:padding={openerPadding}\n    tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n  >\n    {#if iconClass}\n      <i class={actualIconClass}></i>\n    {/if}\n    {buttonText}\n  </button>\n\n  {#if open}\n    <svelte:element\n      this={menuElement}\n      class=\"button-menu-list {listClass ?? ''}\"\n      use:clickOutside={{ callback: () => close() }}\n      style={menuStyles}\n      use:positionMenu\n    >\n      {@render children?.()}\n    </svelte:element>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import type { Snippet } from 'svelte';\n\n  interface Props {\n    cssClass?: string;\n    children?: Snippet;\n  }\n\n  let { cssClass = '', children }: Props = $props();\n</script>\n\n<li class=\"button-menu-item {cssClass}\">\n  {@render children?.()}\n</li>\n","<script lang=\"ts\">\n  import { getContext, type Snippet } from 'svelte';\n  import ButtonMenuItem from './ButtonMenuItem.svelte';\n  import type { ButtonMenuContext } from './button-menu-types';\n  import { settings } from 'src/settings/settings.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import type { MouseEventHandler } from 'svelte/elements';\n\n  interface Props {\n    iconClass?: string;\n    useIconColumn?: boolean;\n    title?: string | null;\n    size?: 'standard' | 'compact';\n    disabled?: boolean;\n    onMenuClick?: MouseEventHandler<HTMLElement>;\n    children?: Snippet;\n  }\n\n  let {\n    iconClass = '',\n    useIconColumn = true,\n    title = null,\n    size = 'standard',\n    disabled = false,\n    onMenuClick,\n    children,\n  }: Props = $props();\n\n  const buttonMenuContext = getContext<ButtonMenuContext>(\n    CONSTANTS.SVELTE_CONTEXT.BUTTON_MENU_CONTEXT,\n  );\n\n  function handleClick(\n    event: MouseEvent & { currentTarget: HTMLButtonElement },\n  ) {\n    buttonMenuContext.close();\n    onMenuClick?.(event);\n  }\n</script>\n\n<ButtonMenuItem cssClass=\"button-menu-command-li\">\n  <button\n    type=\"button\"\n    class=\"button-menu-command {size}\"\n    onclick={handleClick}\n    {title}\n    {disabled}\n    tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n  >\n    {#if useIconColumn}\n      <span class=\"icon-container\">\n        {#if iconClass}\n          <i class={iconClass} role=\"presentation\"></i>\n        {/if}\n      </span>\n    {/if}\n    <span class=\"command-text\">\n      {@render children?.()}\n    </span>\n  </button>\n</ButtonMenuItem>\n","<script lang=\"ts\">\n  import type { DropdownListOption } from 'src/types/types';\n  import ButtonMenu from '../button-menu/ButtonMenu.svelte';\n  import ButtonMenuCommand from '../button-menu/ButtonMenuCommand.svelte';\n\n  interface Props {\n    options: DropdownListOption[];\n    selected: DropdownListOption;\n    isOpen?: boolean;\n    title?: string | null;\n    buttonClass?: string;\n    onOptionClicked: (option: DropdownListOption) => void;\n  }\n\n  let {\n    options,\n    selected,\n    isOpen = $bindable(false),\n    title = null,\n    buttonClass = '',\n    onOptionClicked,\n  }: Props = $props();\n\n  function optionClicked(selection: DropdownListOption): void {\n    onOptionClicked?.({ ...selection });\n    isOpen = false;\n  }\n</script>\n\n<ButtonMenu\n  position=\"bottom\"\n  ariaLabel={title}\n  {title}\n  buttonText={selected.text}\n  buttonClass=\"primary {buttonClass}\"\n  buttonStyle=\"transparent-inline\"\n>\n  {#each options as option}\n    <ButtonMenuCommand\n      useIconColumn={false}\n      onMenuClick={() => optionClicked(option)}\n      size=\"compact\"\n    >\n      {option.text}\n    </ButtonMenuCommand>\n  {/each}\n</ButtonMenu>\n","import type { ActiveEffect5e } from 'src/types/types';\nimport { isNil } from './data';\nimport { debug, error } from './logging';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\nexport class ActiveEffectsHelper {\n  static isActiveEffectAppliedToField(document: any, field: string) {\n    try {\n      return (\n        document?.overrides &&\n        !isNil(field) &&\n        foundry.utils.getProperty(document.overrides, field)\n      );\n    } catch (e) {\n      error(\n        'An error occurred while checking if a field has an active effect applied',\n        false,\n        e\n      );\n      debug('Active effect error troubleshooting info', { document, field });\n      return false;\n    }\n  }\n\n  static getActiveEffectPills(activeEffect: ActiveEffect5e) {\n    let result = [];\n\n    if (activeEffect.disabled) {\n      result.push('EFFECT.Disabled');\n    }\n\n    if (activeEffect.transfer) {\n      result.push('EFFECT.Transfer');\n    }\n\n    if (activeEffect.isSuppressed) {\n      result.push('DND5E.Suppressed');\n    }\n\n    Array.from<string>(activeEffect.statuses)\n      .map(\n        (x: string) => CONFIG.statusEffects.find((y) => y.id === x)?.name ?? x\n      )\n      .forEach((e) => {\n        result.push(e);\n      });\n\n    return result;\n  }\n\n  static findMode(mode: number, fallback = '') {\n    const entry = Object.entries(CONST.ACTIVE_EFFECT_MODES).find(\n      ([_, value]) => value === mode\n    );\n\n    if (!entry) {\n      return fallback;\n    }\n\n    return FoundryAdapter.localize(`EFFECT.MODE_${entry[0]}`);\n  }\n}\n","<script lang=\"ts\">\n  import InlineTextDropdownList from 'src/components/inputs/InlineTextDropdownList.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { Actor5e, DropdownListOption } from 'src/types/types';\n  import type { CharacterSheetContext, NpcSheetContext } from 'src/types/types';\n  import { ActiveEffectsHelper } from 'src/utils/active-effect';\n  import { formatAsModifier } from 'src/utils/formatting';\n  import { warn } from 'src/utils/logging';\n\n  interface Props {\n    toggleable?: boolean;\n    actor: Actor5e;\n    expanded?: boolean;\n    toggleField?: string | null;\n  }\n\n  let {\n    toggleable = false,\n    actor,\n    expanded = true,\n    toggleField = null,\n  }: Props = $props();\n\n  let context =\n    $derived(getSheetContext<CharacterSheetContext | NpcSheetContext>());\n\n  type SkillRef = {\n    key: string;\n    label: string;\n    ability: string;\n    skill: any | null;\n  };\n\n  let skillRefs: SkillRef[] = $derived(\n    Array.from(Object.entries(context.config.skills)).reduce<SkillRef[]>(\n      (prev, [key, configSkill]: [string, any]) => {\n        const skill = getSkill(key);\n\n        if (!skill) {\n          warn(\n            'Unable to find skill. Ensure custom skills are added at \"init\" time.',\n            false,\n            { key, configSkill },\n          );\n          return prev;\n        }\n\n        prev.push({\n          key: key,\n          label: configSkill.label,\n          ability: skill.ability,\n          skill: skill,\n        });\n\n        return prev;\n      },\n      [],\n    ),\n  );\n\n  const localize = FoundryAdapter.localize;\n\n  function getSkill(key: string): any | null {\n    if (key in context.actor.system.skills) {\n      return context.skills[key];\n    }\n\n    return null;\n  }\n\n  function toggleShowAllSkills() {\n    if (toggleField === null) {\n      return;\n    }\n\n    actor.update({ [toggleField]: !expanded });\n  }\n\n  function onSkillAbilityChange(\n    option: DropdownListOption,\n    skillRef: {\n      key: string;\n      label: string;\n      ability: string;\n      skill: any | null;\n    },\n  ): void {\n    context.actor.update({\n      system: {\n        skills: {\n          [skillRef.key]: {\n            ability: option,\n          },\n        },\n      },\n    });\n  }\n  let showAllSkills = $derived(!toggleable || expanded);\n\n  let abilities = $derived(\n    FoundryAdapter.getAbilitiesAsDropdownOptions(context.abilities),\n  );\n</script>\n\n<div class=\"skills-list-container\">\n  <ul\n    class=\"skills-list\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.SKILLS_LIST}\n  >\n    {#each skillRefs as skillRef (skillRef.key)}\n      {@const showSkill =\n        skillRef.skill &&\n        (showAllSkills || skillRef.skill.prof.hasProficiency > 0)}\n\n      {#if showSkill}\n        <li\n          class=\"proficiency-row skill\"\n          class:proficient={skillRef.skill.prof.hasProficiency}\n          data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.SKILL_CONTAINER}\n          data-key={skillRef.key}\n        >\n          {#if context.editable && context.unlocked}\n            {@const activeEffectApplied =\n              ActiveEffectsHelper.isActiveEffectAppliedToField(\n                context.actor,\n                `system.skills.${skillRef.key}.value`,\n              )}\n            <button\n              type=\"button\"\n              class=\"configure-proficiency inline-icon-button\"\n              onclick={() =>\n                FoundryAdapter.renderSkillToolConfig(\n                  context.actor,\n                  'skills',\n                  skillRef.key,\n                )}\n              title={localize('DND5E.SkillConfigure')}\n              data-tidy-sheet-part={CONSTANTS.SHEET_PARTS\n                .SKILL_CONFIGURATION_CONTROL}\n              tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n            >\n              <i class=\"fas fa-cog\"></i>\n            </button>\n            <button\n              type=\"button\"\n              class=\"skill-proficiency-toggle inline-icon-button\"\n              onclick={() =>\n                FoundryAdapter.cycleProficiency(\n                  context.actor,\n                  skillRef.key,\n                  skillRef.skill?.value,\n                  'skills',\n                )}\n              oncontextmenu={() =>\n                FoundryAdapter.cycleProficiency(\n                  context.actor,\n                  skillRef.key,\n                  skillRef.skill?.value,\n                  'skills',\n                  true,\n                )}\n              title={skillRef.skill.hover}\n              data-tidy-sheet-part={CONSTANTS.SHEET_PARTS\n                .SKILL_PROFICIENCY_TOGGLE}\n              tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n              disabled={activeEffectApplied}\n              data-tooltip={activeEffectApplied\n                ? localize('DND5E.ActiveEffectOverrideWarning')\n                : null}>{@html skillRef.skill.icon}</button\n            >\n          {:else}\n            <span class=\"skill-proficiency\" title={skillRef.skill.hover}\n              >{@html skillRef.skill.icon}</span\n            >\n          {/if}\n          {#if context.editable}\n            <button\n              type=\"button\"\n              class=\"tidy5e-skill-name transparent-button rollable\"\n              onclick={(event) =>\n                context.actor.rollSkill({ skill: skillRef.key, event })}\n              data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.SKILL_ROLLER}\n              tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n              title={skillRef.skill.label}\n            >\n              {skillRef.skill.label}\n            </button>\n          {:else}\n            <span class=\"tidy5e-skill-name\" title={skillRef.skill.label}>\n              {skillRef.skill.label}\n            </span>\n          {/if}\n          {#if context.unlocked && context.editable}\n            <InlineTextDropdownList\n              options={abilities}\n              selected={{\n                text: skillRef.skill.abbreviation,\n                value: skillRef.skill.abbreviation,\n              }}\n              buttonClass=\"skill-ability\"\n              title={context.abilities?.[skillRef.ability]?.label}\n              onOptionClicked={(option) =>\n                onSkillAbilityChange(option, skillRef)}\n            />\n          {:else}\n            <span class=\"skill-ability\">{skillRef.skill.abbreviation}</span>\n          {/if}\n\n          <span class=\"skill-mod\">{formatAsModifier(skillRef.skill.total)}</span\n          >\n          <span\n            class=\"skill-passive\"\n            title=\"{skillRef.skill.label} ({localize('DND5E.Passive')})\"\n            >({skillRef.skill.passive})</span\n          >\n        </li>\n      {/if}\n    {/each}\n  </ul>\n  {#if toggleable && context.editable}\n    <div style=\"text-align:center;\">\n      <a\n        class=\"toggle-proficient\"\n        onclick={toggleShowAllSkills}\n        data-tidy-sheet-part={CONSTANTS.SHEET_PARTS\n          .SKILLS_SHOW_PROFICIENT_TOGGLE}\n        tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n      >\n        {#if showAllSkills}\n          {localize('TIDY5E.HideNotProficientSkills')}\n        {:else}\n          {localize('TIDY5E.ShowNotProficientSkills')}\n        {/if}\n      </a>\n    </div>\n  {/if}\n</div>\n\n<style lang=\"scss\">\n  .skills-list {\n    border: 0.0625rem solid var(--t5e-faint-color);\n    border-radius: 0.3125rem;\n    overflow: visible;\n    padding: 0;\n    display: flex;\n    flex-direction: column;\n    flex: 0 0 auto;\n\n    .skill {\n      flex: 0 0 1.125rem;\n      display: flex;\n      gap: 0.25rem;\n      font-size: 0.75rem;\n      line-height: 0.875rem;\n      align-items: center;\n      padding: 0.1875rem 0.25rem 0.0625rem 0.25rem;\n      height: 1.125rem;\n      flex-wrap: nowrap;\n\n      &:nth-child(even) {\n        background: var(--t5e-faint-color);\n      }\n\n      .tidy5e-skill-name {\n        font-size: 0.75rem;\n        line-height: 0.875rem;\n        overflow: hidden;\n        white-space: nowrap;\n        text-overflow: ellipsis;\n        flex: 1;\n        text-align: left;\n        font-weight: 400;\n      }\n\n      .configure-proficiency {\n        margin: 0;\n        padding: 0;\n        font-size: 0.625rem;\n        color: var(--t5e-tertiary-color);\n        &:hover {\n          color: var(--t5e-primary-color);\n        }\n      }\n\n      &.proficient .tidy5e-skill-name {\n        font-weight: 700;\n      }\n\n      .skill-proficiency {\n        font-size: 0.625rem;\n        color: var(--t5e-tertiary-color);\n      }\n\n      .skill-proficiency-toggle {\n        font-size: 0.625rem;\n        color: var(--t5e-tertiary-color);\n\n        &:hover {\n          color: var(--t5e-primary-font-color);\n        }\n\n        i {\n          vertical-align: baseline;\n        }\n      }\n\n      .skill-mod,\n      .skill-passive {\n        text-align: right;\n        flex: 0 0 1.5rem;\n      }\n\n      .skill-passive {\n        color: var(--t5e-tertiary-color);\n      }\n\n      :global(.skill-ability) {\n        flex: 0 0 1.5rem;\n        width: 1.5rem;\n        text-transform: capitalize;\n        text-align: left;\n      }\n    }\n  }\n\n  .skills-list-container .toggle-proficient {\n    font-size: 0.625rem;\n    text-transform: capitalize;\n    border: 0.0625rem solid var(--t5e-faint-color);\n    border-top: none;\n    padding: 0.125rem 0.5rem;\n    border-radius: 0 0 0.3125rem 0.3125rem;\n    cursor: pointer;\n    color: var(--t5e-secondary-color);\n    white-space: nowrap;\n\n    &:hover {\n      color: var(--t5e-primary-font-color);\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n  import { type Snippet } from 'svelte';\n  import type { MouseEventHandler } from 'svelte/elements';\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  interface Props {\n    title: string;\n    configureButtonTitle?: string;\n    configureButtonAction?: string;\n    useConfigureButton: boolean;\n    iconCssClass?: string | undefined;\n    traitCssClass?: string | undefined;\n    show: boolean;\n    customIcon?: Snippet;\n    onConfigureClicked?: MouseEventHandler<HTMLElement>;\n    children?: Snippet;\n  }\n\n  let {\n    title,\n    configureButtonTitle,\n    configureButtonAction,\n    useConfigureButton,\n    iconCssClass = undefined,\n    traitCssClass = '',\n    show,\n    customIcon,\n    onConfigureClicked,\n    children,\n  }: Props = $props();\n</script>\n\n{#if show}\n  <div\n    class=\"trait-form-group {traitCssClass ?? ''}\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ACTOR_TRAIT}\n  >\n    <span class=\"trait-icon\" aria-label={title} {title}>\n      {#if iconCssClass !== undefined}\n        <i class={iconCssClass}></i>\n      {/if}\n      {@render customIcon?.()}\n    </span>\n    <div\n      class=\"trait-label-and-list\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ACTOR_TRAIT_DETAILS}\n    >\n      {#if settings.value.showTraitLabels}\n        <span class=\"trait-label\">{title}</span>\n      {/if}\n      {@render children?.()}\n    </div>\n    {#if context.unlocked && useConfigureButton}\n      <button\n        type=\"button\"\n        class=\"trait-editor inline-icon-button flex-row align-items-flex-start justify-content-center\"\n        title={configureButtonTitle}\n        data-action={configureButtonAction}\n        onclick={(event) => {\n          event.preventDefault();\n          event.stopPropagation();\n          onConfigureClicked?.(event);\n        }}\n        tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n      >\n        <i class=\"fas fa-pencil-alt\"></i>\n      </button>\n    {/if}\n  </div>\n{/if}\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n  import { ActiveEffectsHelper } from 'src/utils/active-effect';\n\n  interface Props {\n    tools?: [key: string, value: any][];\n  }\n\n  let { tools = [] }: Props = $props();\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<ul\n  class=\"trait-list tools\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.TOOLS_LIST}\n>\n  {#each tools as [key, tool]}\n    <li\n      class=\"tool\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.TOOL_CONTAINER}\n      data-key={key}\n    >\n      {#if context.editable && !context.lockSensitiveFields}\n        {@const activeEffectApplied =\n          ActiveEffectsHelper.isActiveEffectAppliedToField(\n            context.actor,\n            `system.tools.${key}.value`,\n          )}\n        <button\n          type=\"button\"\n          class=\"tool-proficiency-toggle inline-transparent-button\"\n          title={tool.hover}\n          onclick={(event) => {\n            event.preventDefault();\n            event.stopPropagation();\n            FoundryAdapter.cycleProficiency(\n              context.actor,\n              key,\n              tool.value,\n              'tools',\n            );\n          }}\n          oncontextmenu={(event) => {\n            event.preventDefault();\n            event.stopPropagation();\n            FoundryAdapter.cycleProficiency(\n              context.actor,\n              key,\n              tool.value,\n              'tools',\n              true,\n            );\n          }}\n          data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.TOOL_PROFICIENCY_TOGGLE}\n          tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n          disabled={activeEffectApplied}\n          data-tooltip={activeEffectApplied\n            ? localize('DND5E.ActiveEffectOverrideWarning')\n            : null}\n        >\n          {@html tool.icon}\n        </button>\n      {:else}\n        <span title={tool.hover} class=\"tool-proficiency-readonly\"\n          >{@html tool.icon}</span\n        >\n      {/if}\n\n      {#if context.editable}\n        <button\n          type=\"button\"\n          class=\"tool-check-roller inline-transparent-button rollable\"\n          onclick={(event) => context.actor.rollToolCheck({ tool: key, event })}\n          data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.TOOL_ROLLER}\n          tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n        >\n          {tool.label}\n        </button>\n      {:else}\n        <span class=\"tool-check-roller\">\n          {tool.label}\n        </span>\n      {/if}\n\n      {#if context.unlocked}\n        <button\n          type=\"button\"\n          class=\"tool-proficiency-editor inline-icon-button\"\n          title={localize('DND5E.ToolConfigure')}\n          onclick={(event) => {\n            event.preventDefault();\n            event.stopPropagation();\n            FoundryAdapter.renderSkillToolConfig(context.actor, 'tools', key);\n          }}\n          data-tidy-sheet-part={CONSTANTS.SHEET_PARTS\n            .TOOL_CONFIGURATION_CONTROL}\n          tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n        >\n          <i class=\"fas fa-cog\"></i>\n        </button>\n      {/if}\n    </li>\n  {/each}\n</ul>\n","<script lang=\"ts\">\n  import type { Snippet } from 'svelte';\n\n  interface Props {\n    tags?: [key: string, value: string][];\n    tagCssClass?: string;\n    children?: Snippet<[any]>;\n  }\n\n  let { tags = [], tagCssClass = '', children }: Props = $props();\n</script>\n\n<ul class=\"trait-list\">\n  {#each tags as [key, value]}\n    <li class=\"trait-tag {key} {tagCssClass}\">\n      {#if children}{@render children({ key, value })}{:else}{value}{/if}\n    </li>\n  {/each}\n</ul>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type {\n    ActorSheetContextV1,\n    DamageModificationContextEntry,\n  } from 'src/types/types';\n\n  interface Props {\n    modifications: DamageModificationContextEntry[];\n  }\n\n  let { modifications }: Props = $props();\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<ul class=\"damage-modifications\">\n  {#each modifications as modification}\n    <li\n      class=\"damage-modification {modification.consequence} flex-row extra-small-gap\"\n    >\n      {#each modification.icons ?? [] as icon}\n        {@const propertyLabel =\n          context.config.itemProperties[icon]?.label ?? ''}\n        <i\n          class=\"damage-modification-icon {icon}\"\n          title={localize('DND5E.DamagePhysicalBypassesShort', {\n            type: propertyLabel,\n          })}\n        ></i>\n      {/each}\n      {modification.label}\n    </li>\n  {/each}\n</ul>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n  import TraitSection from './TraitSection.svelte';\n  import TraitSectionTools from './TraitSectionTools.svelte';\n  import { error } from 'src/utils/logging';\n  import TraitSectionTags from './TraitSectionTags.svelte';\n  import TraitSectionModifications from './TraitSectionModifications.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import { isNil } from 'src/utils/data';\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n  interface Props {\n    useSenses?: boolean;\n    enableSpecialTraitsConfiguration?: boolean;\n  }\n\n  let { useSenses = true }: Props = $props();\n\n  // TODO: When Tidy takes over all data prep, give typings to tags\n  function getTags(obj: any): [key: string, value: string][] {\n    return Object.entries<string>(obj);\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"traits\">\n  {#if context.actor.system.traits.important}\n    <TraitSection\n      title={localize('DND5E.HitDice')}\n      iconCssClass=\"fa-solid fa-dice-d{context.system.attributes.hd\n        .denomination}\"\n      show={true}\n      useConfigureButton={false}\n      traitCssClass=\"counter\"\n    >\n      <span class=\"hit-dice-counter\">\n        {context.system.attributes.hd.value}/{context.system.attributes.hd.max}\n      </span>\n    </TraitSection>\n  {/if}\n  {#if context.system.attributes?.death && (context.isCharacter || context.actor.system.traits.important)}\n    <TraitSection\n      title={localize('DND5E.DeathSave')}\n      iconCssClass=\"fa-solid fa-skull\"\n      show={context.unlocked}\n      useConfigureButton={context.editable}\n      configureButtonAction=\"death\"\n      configureButtonTitle={localize('DND5E.DeathSaveConfigure')}\n      onConfigureClicked={(event) => context.actor.sheet._onConfigMenu(event)}\n    />\n  {/if}\n  {#if useSenses && context.senses}\n    {@const senses = getTags(context.senses)}\n    <TraitSection\n      title={localize('DND5E.Senses')}\n      iconCssClass=\"fas fa-eye\"\n      configureButtonTitle={localize('DND5E.SensesConfig')}\n      onConfigureClicked={() =>\n        FoundryAdapter.renderMovementSensesConfig(context.actor, 'senses')}\n      show={context.unlocked || !!senses.length}\n      useConfigureButton={context.editable}\n    >\n      <TraitSectionTags tags={senses} />\n    </TraitSection>\n  {/if}\n\n  {#if context.traits?.languages}\n    <TraitSection\n      traitCssClass={context.traits?.languages?.cssClass ?? ''}\n      title={localize('DND5E.Languages')}\n      iconCssClass=\"fas fa-comment\"\n      configureButtonTitle={localize('DND5e.TraitConfig', {\n        trait: localize('DND5E.Languages'),\n      })}\n      onConfigureClicked={() =>\n        new dnd5e.applications.actor.LanguagesConfig({\n          document: context.actor,\n        }).render({ force: true })}\n      show={context.unlocked || !!context.traits.languages.length}\n      useConfigureButton={context.editable}\n    >\n      <ul class=\"trait-list\">\n        {#each context.traits.languages as { label, value }}\n          <li class=\"trait-tag\">\n            {label}\n            {#if !isNil(value)}\n              <span class=\"text-secondary\">|</span>\n              {value}\n            {/if}\n          </li>\n        {/each}\n      </ul>\n    </TraitSection>\n  {/if}\n\n  {#if context.traits.traits?.di}\n    {@const damageImmunities = getTags(context.traits.traits.di.selected)}\n    <TraitSection\n      traitCssClass={context.traits.traits?.di?.cssClass ?? ''}\n      title={localize('DND5E.DamImm')}\n      iconCssClass=\"fas fa-heart\"\n      configureButtonTitle={localize('DND5E.TraitConfig', {\n        trait: localize('DND5E.DamImm'),\n      })}\n      onConfigureClicked={() =>\n        FoundryAdapter.openDamagesConfig(context.actor, 'di')}\n      show={context.unlocked || !!damageImmunities.length}\n      useConfigureButton={context.editable}\n    >\n      <TraitSectionTags tags={damageImmunities} />\n    </TraitSection>\n  {/if}\n\n  {#if context.traits.traits?.dr}\n    {@const damageResistances = getTags(context.traits.traits.dr.selected)}\n    <TraitSection\n      traitCssClass={context.traits.traits?.dr?.cssClass ?? ''}\n      title={localize('DND5E.DamRes')}\n      iconCssClass=\"far fa-heart\"\n      configureButtonTitle={localize('DND5E.TraitConfig', {\n        trait: localize('DND5E.DamRes'),\n      })}\n      onConfigureClicked={() =>\n        FoundryAdapter.openDamagesConfig(context.actor, 'dr')}\n      show={context.unlocked || !!damageResistances.length}\n      useConfigureButton={context.editable}\n    >\n      <TraitSectionTags tags={damageResistances} />\n    </TraitSection>\n  {/if}\n\n  {#if context.traits.traits?.dv}\n    {@const vulnerabilities = getTags(context.traits.traits.dv.selected)}\n    <TraitSection\n      traitCssClass={context.traits.traits?.dv?.cssClass ?? ''}\n      title={localize('DND5E.DamVuln')}\n      iconCssClass=\"fas fa-heart-broken\"\n      configureButtonTitle={localize('DND5E.TraitConfig', {\n        trait: localize('DND5E.DamVuln'),\n      })}\n      onConfigureClicked={() =>\n        FoundryAdapter.openDamagesConfig(context.actor, 'dv')}\n      show={context.unlocked || !!vulnerabilities.length}\n      useConfigureButton={context.editable}\n    >\n      <TraitSectionTags tags={vulnerabilities} />\n    </TraitSection>\n  {/if}\n\n  {#if context.traits.traits?.dm}\n    <TraitSection\n      title={localize('DND5E.DamageModification.Label')}\n      iconCssClass=\"fas fa-heart-circle-plus\"\n      configureButtonTitle={localize('DND5E.TraitConfig', {\n        trait: localize('DND5E.DamageModification.Label'),\n      })}\n      onConfigureClicked={() =>\n        FoundryAdapter.openDamagesConfig(context.actor, 'dm')}\n      show={context.unlocked || !!context.traits.traits.dm.length}\n      useConfigureButton={context.editable}\n    >\n      <TraitSectionModifications modifications={context.traits.traits?.dm} />\n    </TraitSection>\n  {/if}\n\n  {#if context.traits.traits?.ci}\n    {@const conditionImmunities = getTags(context.traits.traits.ci.selected)}\n    <TraitSection\n      traitCssClass={context.traits.traits?.ci?.cssClass ?? ''}\n      title={localize('DND5E.ConImm')}\n      iconCssClass=\"fas fa-shield-virus\"\n      configureButtonTitle={localize('DND5E.TraitConfig', {\n        trait: localize('DND5E.ConImm'),\n      })}\n      onConfigureClicked={() =>\n        FoundryAdapter.renderTraitsConfig(context.actor, 'ci')}\n      show={context.unlocked || !!conditionImmunities.length}\n      useConfigureButton={context.editable}\n    >\n      <TraitSectionTags tags={conditionImmunities} />\n    </TraitSection>\n  {/if}\n\n  {#if context.traits.traits?.weaponProf}\n    {@const weaponProfs = getTags(context.traits.traits.weaponProf.selected)}\n    <TraitSection\n      traitCssClass={context.traits.traits?.weaponProf?.cssClass ?? ''}\n      title={localize('DND5E.TraitWeaponProf')}\n      configureButtonTitle={localize('DND5E.TraitConfig', {\n        trait: localize('DND5E.TraitWeaponProf'),\n      })}\n      onConfigureClicked={() =>\n        FoundryAdapter.renderWeaponsConfig(context.actor)}\n      show={context.unlocked || !!weaponProfs.length}\n      useConfigureButton={context.editable}\n    >\n      {#snippet customIcon()}\n        <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\" xml:space=\"preserve\">\n          <path\n            d=\"M443.7,2.6c-2.2-2.5-5.8-3.3-8.8-1.8C417.9,9,358.8,36.1,304.4,43.5c-4.1,0.6-8-0.3-11.3-2.1c-1.5-0.8-2.4-2.5-2.4-4.2v0\n          c0-10.7-8.7-19.4-19.5-19.4h-30.5c-10.7,0-19.5,8.7-19.5,19.4v0c0,1.7-0.9,3.4-2.4,4.2c-3.3,1.8-7.2,2.7-11.3,2.1\n          C153.2,36.1,94.2,9,77.1,0.7c-3-1.5-6.6-0.7-8.8,1.8C56.3,16.4,21,64.9,21,154.9c0,83.4,30.3,143.6,44.3,166.9\n          c2.9,4.9,10,4.7,12.8-0.2c10.5-19,34-59.1,62-91.7c0.4-0.5,0.9-1,1.3-1.5c28.3-30.7,79.9-9.8,79.9,32v232.2\n          c0,10.7,8.7,19.4,19.5,19.4h30.5c10.7,0,19.5-8.7,19.5-19.4V260.4c0-41.8,51.5-62.7,79.9-32c0.4,0.5,0.9,1,1.3,1.5\n          c28,32.6,51.5,72.7,62,91.7c2.8,5,9.9,5.1,12.8,0.2c14-23.3,44.3-83.4,44.3-166.9C491,64.9,455.7,16.4,443.7,2.6z\"\n          />\n        </svg>\n      {/snippet}\n\n      <TraitSectionTags tags={weaponProfs}>\n        {#snippet children({ key, value })}\n          {#if context.traits.traits.weaponProf.mastery.value.has(key)}\n            <i\n              title={localize('DND5E.WEAPON.Mastery.Label')}\n              class=\"fas fa-medal\"\n            ></i>\n          {/if}\n          {value}\n        {/snippet}\n      </TraitSectionTags>\n    </TraitSection>\n  {/if}\n\n  {#if context.traits.traits?.armorProf}\n    {@const armorProfs = getTags(context.traits.traits.armorProf.selected)}\n    <TraitSection\n      traitCssClass={context.traits.traits?.armorProf?.cssClass ?? ''}\n      title={localize('DND5E.TraitArmorProf')}\n      configureButtonTitle={localize('DND5E.TraitConfig', {\n        trait: localize('DND5E.TraitArmorProf'),\n      })}\n      onConfigureClicked={() =>\n        FoundryAdapter.renderTraitsConfig(context.actor, 'armor')}\n      show={context.unlocked || !!armorProfs.length}\n      useConfigureButton={context.editable}\n    >\n      {#snippet customIcon()}\n        <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\" xml:space=\"preserve\">\n          <path\n            d=\"M471.7,198.8c0-56.6-37.8-107.3-81.7-147.1c-76-68.9-191.9-68.9-268,0c-43.9,39.8-81.7,90.5-81.7,147.1\n        c0,93-3.2,163.9-12.5,203c-3.9,16.2,4,33,18.3,39.6l113.6,66.3c27.9,13.6,60.3-6.7,60.3-37.7V258.3c0-5.2-3.3-9.8-8.3-11.5\n        l-91.3-30.4c-4.9-1.6-8.3-6.3-8.3-11.5v-15.1c0-6.7,5.4-12.1,12.1-12.1h263.4c6.7,0,12.1,5.4,12.1,12.1v15.1c0,5.2-3.3,9.8-8.3,11.5\n        l-91.3,30.4c-4.9,1.6-8.3,6.3-8.3,11.5V470c0,31,32.5,51.3,60.3,37.7l113.6-66.3c14.3-6.6,22.2-23.4,18.3-39.6\n        C474.9,362.7,471.7,291.8,471.7,198.8L471.7,198.8z\"\n          />\n        </svg>\n      {/snippet}\n\n      <TraitSectionTags tags={armorProfs} />\n    </TraitSection>\n  {/if}\n\n  {#if context.traits.tools}\n    {@const tools = Object.entries(context.tools)}\n    <TraitSection\n      traitCssClass={context.traits.tools?.toolProf?.cssClass ?? ''}\n      title={localize('DND5E.TraitToolProf')}\n      iconCssClass=\"fas fa-hammer\"\n      configureButtonTitle={localize('DND5E.TraitConfig', {\n        trait: localize('DND5E.TraitToolProf'),\n      })}\n      onConfigureClicked={() => FoundryAdapter.renderToolsConfig(context.actor)}\n      show={context.unlocked || !!tools.length}\n      useConfigureButton={context.editable}\n    >\n      {#if tools.length}\n        <TraitSectionTools {tools} />\n      {/if}\n    </TraitSection>\n  {/if}\n\n  {#if context.isNPC}\n    <TraitSection\n      title={localize('DND5E.Treasure.Configuration.Label')}\n      iconCssClass=\"fa-solid fa-gem\"\n      configureButtonTitle={localize('DND5E.Treasure.Configuration.Title')}\n      onConfigureClicked={() =>\n        new dnd5e.applications.actor.TreasureConfig({\n          document: context.actor,\n        }).render({ force: true })}\n      show={context.unlocked || !!context.treasure}\n      useConfigureButton={context.editable}\n    >\n      <ul class=\"trait-list\">\n        {#each context.treasure as { label }}\n          <li class=\"trait-tag\">\n            {label}\n          </li>\n        {/each}\n      </ul>\n    </TraitSection>\n  {/if}\n\n  {#if context.customActorTraits?.length}\n    {#each context.customActorTraits as trait}\n      <TraitSection\n        title={trait.title}\n        iconCssClass={trait.iconClass}\n        configureButtonTitle={trait.openConfigurationTooltip ?? ''}\n        onConfigureClicked={(ev) => {\n          try {\n            trait.openConfiguration?.({\n              app: context.actor.sheet,\n              data: context,\n              element: FoundryAdapter.getElementFromAppV1OrV2(\n                context.actor.sheet.element,\n              ),\n              event: ev,\n            });\n          } catch (e) {\n            error(\n              'An error occurred while handling trait configuration click event',\n              false,\n              e,\n            );\n          }\n        }}\n        show={trait.alwaysShow || context.unlocked}\n        useConfigureButton={!!trait.openConfiguration}\n      />\n    {/each}\n  {/if}\n</div>\n\n<style lang=\"scss\">\n  .traits {\n    border: 0.0625rem solid var(--t5e-faint-color);\n    border-radius: 0.3125rem 0.3125rem 0 0;\n    overflow: visible;\n    position: relative;\n    margin-bottom: 0.75rem; // Accounts for floating button to configure flags\n\n    :global(.trait-form-group:nth-child(odd)) {\n      background: none;\n    }\n\n    :global(.trait-form-group:nth-child(even)) {\n      background: var(--t5e-faint-color);\n    }\n\n    svg {\n      height: 0.75rem;\n      width: 0.875rem;\n\n      path {\n        fill: var(--t5e-tertiary-color);\n      }\n    }\n\n    .toggle-traits {\n      position: absolute;\n      display: inline-block;\n      top: calc(100% + 0.0625rem);\n      left: -0.0625rem;\n      border: 0.0625rem solid var(--t5e-faint-color);\n      border-top: 0;\n      border-radius: 0 0 0.1875rem 0.1875rem;\n      padding: 0.125rem 0.25rem;\n      font-size: 0.625rem;\n      color: var(--t5e-secondary-color);\n    }\n\n    .toggle-traits:hover {\n      color: var(--t5e-primary-font-color);\n    }\n\n    .configure-special-traits {\n      flex: 0;\n      position: absolute;\n      display: inline-block;\n      top: calc(100% + 0.0625rem);\n      right: -0.0625rem;\n      border: 0.0625rem solid var(--t5e-faint-color);\n      border-top: 0;\n      border-radius: 0 0 0.1875rem 0.1875rem;\n      padding: 0.125rem 0.25rem;\n      font-size: 0.625rem;\n    }\n\n    .configure-special-traits i.fas {\n      line-height: 0.625rem;\n      vertical-align: baseline;\n    }\n\n    :global(.counter .trait-label-and-list) {\n      display: flex;\n      align-items: end;\n    }\n\n    :global(.counter .trait-label) {\n      flex: 1;\n    }\n\n    :global(.counter .hit-dice-counter) {\n      flex: 0;\n      margin-inline-start: auto;\n      margin-inline-end: 0.25rem;\n      font-size: 0.75rem;\n    }\n\n    .text-secondary {\n      color: var(--t5e-tertiary-color);\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { onMount, type Snippet } from 'svelte';\n\n  interface Props {\n    expanded?: boolean;\n    children?: Snippet;\n    [key: string]: any;\n  }\n\n  let { expanded = true, children, ...rest }: Props = $props();\n\n  let overflowYHidden = $state(!expanded);\n  let expandableContainer: HTMLElement;\n\n  onMount(() => {\n    const controller = new AbortController();\n\n    expandableContainer.addEventListener(\n      'transitionstart',\n      (ev) => {\n        if (ev.target === expandableContainer) {\n          overflowYHidden = true;\n        }\n      },\n      {\n        signal: controller.signal,\n      },\n    );\n\n    expandableContainer.addEventListener(\n      'transitionend',\n      (ev) => {\n        if (ev.target === expandableContainer) {\n          overflowYHidden = !expanded;\n        }\n      },\n      {\n        signal: controller.signal,\n      },\n    );\n\n    return () => {\n      controller.abort();\n    };\n  });\n</script>\n\n<div\n  bind:this={expandableContainer}\n  class=\"expandable {rest.class ?? ''}\"\n  class:expanded\n  class:overflow-y-hidden={overflowYHidden}\n  role=\"presentation\"\n>\n  <div role=\"presentation\" class=\"expandable-child-animation-wrapper\">\n    {@render children?.()}\n  </div>\n</div>\n\n<style lang=\"scss\">\n  .expandable {\n    display: grid;\n    grid-template-rows: 0fr;\n    transition: grid-template-rows 0.2s ease;\n\n    &.expanded {\n      grid-template-rows: 1fr;\n    }\n  }\n\n  .overflow-y-hidden :global(> *) {\n    overflow-y: hidden;\n  }\n</style>\n","import { CONSTANTS } from 'src/constants';\nimport { debug, warn } from 'src/utils/logging';\nimport { getContext, setContext } from 'svelte';\n\ninterface ExpansionState {\n  expanded: boolean;\n}\n\ninterface TrackedTabs {\n  [tabId: string]: {\n    [location: string]: {\n      [entityId: string]: ExpansionState;\n    };\n  };\n}\n\ninterface TabStats {\n  topHasExpansion: boolean;\n  topAllExpanded: boolean;\n  hasExpansion: boolean;\n  allExpanded: boolean;\n  topLevelLocation: string;\n}\n\nexport type ExpansionTrackerToggleProvider = () => {\n  expanded: boolean;\n  toggle: Function;\n};\n\nexport class ExpansionTracker {\n  #tabs = $state<TrackedTabs>({});\n  #initialState: boolean;\n  #locationSegment: string;\n\n  tabStats = $derived.by(() => {\n    return this.getTabStats();\n  });\n\n  constructor(initialState: boolean, locationSegment: string = '') {\n    this.#initialState = initialState;\n    this.#locationSegment = locationSegment;\n  }\n\n  toggle(entityId: string, tabId: string, location: string, value?: boolean) {\n    const expansionState = this.#tabs[tabId]?.[location]?.[entityId];\n\n    if (!expansionState) {\n      warn('Expansion State not found :| (TODO: Delete after implementing)');\n      return;\n    }\n\n    expansionState.expanded = value ?? !expansionState.expanded;\n  }\n\n  getContextKeys() {\n    const tabId =\n      getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID) ?? 'DefaultTab';\n    const location =\n      getContext<string>(CONSTANTS.SVELTE_CONTEXT.LOCATION) ??\n      'DefaultLocation';\n    return { tabId, location };\n  }\n\n  register(\n    entityId: string,\n    tabId: string,\n    location: string,\n    expanded: boolean = true\n  ) {\n    const expansionState = this.getOrCreateExpansionState(\n      tabId,\n      location,\n      entityId\n    );\n\n    expansionState.expanded = expanded;\n\n    debug('ExpansionTracker: Registered tracked entity with ID ' + entityId);\n  }\n\n  private getOrCreateExpansionState(\n    tabId: string,\n    location: string,\n    entityId: string\n  ) {\n    let tabMap = this.#tabs[tabId];\n    if (!tabMap) {\n      this.#tabs[tabId] = {};\n      tabMap = this.#tabs[tabId];\n    }\n\n    let locationMap = tabMap[location];\n    if (!locationMap) {\n      tabMap[location] = {};\n      locationMap = tabMap[location];\n    }\n\n    let expansionState = locationMap[entityId];\n    if (!expansionState) {\n      locationMap[entityId] = {\n        expanded: this.#initialState,\n      };\n      expansionState = locationMap[entityId];\n    }\n\n    return expansionState;\n  }\n\n  unregister(entityId: string, tabId: string, location: string) {\n    delete this.#tabs[tabId]?.[location]?.[entityId];\n\n    debug('ExpansionTracker: Unregistered tracked entity with ID ' + entityId);\n  }\n\n  isExpanded(entityId: string, tabId: string, location: string) {\n    return (\n      this.#tabs[tabId]?.[location]?.[entityId]?.expanded ?? this.#initialState\n    );\n  }\n\n  setAll(tabId: string, value: boolean, mode: 'shallow' | 'deep' = 'shallow') {\n    let locationSegmentFilter: string | undefined = undefined;\n\n    if (mode === 'shallow') {\n      locationSegmentFilter = this.tabStats[tabId]?.topLevelLocation;\n    }\n\n    const tabMap = this.#tabs[tabId] ?? {};\n    for (let [location, entities] of Object.entries(tabMap)) {\n      for (let state of Object.values(entities)) {\n        if (\n          locationSegmentFilter !== undefined &&\n          !this.locationSegmentsMatch(location, locationSegmentFilter)\n        ) {\n          continue;\n        }\n        state.expanded = value;\n      }\n    }\n  }\n\n  locationSegmentsMatch(left: string, right: string) {\n    return this.getLocationSegment(left) === this.getLocationSegment(right);\n  }\n\n  getLocationSegment(value?: string) {\n    return value !== undefined\n      ? value.slice(0, value.lastIndexOf(this.#locationSegment))\n      : value;\n  }\n\n  getTabStats() {\n    let tabStats: Record<string, TabStats> = {};\n\n    for (let [tabId, locations] of Object.entries(this.#tabs)) {\n      let expansionStatesAtIndex: {\n        expanded: number;\n        collapsed: number;\n        location: string;\n      }[] = [];\n\n      for (let [location, expansions] of Object.entries(locations)) {\n        const lastTargetLocationSegmentIndex = location.lastIndexOf(\n          this.#locationSegment\n        );\n\n        let targetLocationSegment =\n          lastTargetLocationSegmentIndex >= 0\n            ? location.slice(0, lastTargetLocationSegmentIndex)\n            : null;\n\n        if (targetLocationSegment === null) {\n          continue;\n        }\n\n        for (let [_, expansion] of Object.entries(expansions)) {\n          expansionStatesAtIndex[targetLocationSegment.length] ??= {\n            collapsed: 0,\n            expanded: 0,\n            location: location,\n          };\n\n          if (expansion.expanded) {\n            expansionStatesAtIndex[targetLocationSegment.length].expanded++;\n          } else {\n            expansionStatesAtIndex[targetLocationSegment.length].collapsed++;\n          }\n        }\n      }\n\n      let expansions = expansionStatesAtIndex.filter((x) => x !== undefined);\n\n      tabStats[tabId] = {\n        hasExpansion: expansions.some((x) => x),\n        topAllExpanded: expansions[0]?.collapsed === 0,\n        topHasExpansion: !!expansions[0],\n        allExpanded: expansions.every((e) => e.collapsed === 0),\n        topLevelLocation: expansions[0]?.location,\n      };\n    }\n\n    debug('ExpansionTracker: Recalculated tab stats.');\n\n    return tabStats;\n  }\n\n  /**\n   * Initializes to or gets existing Expansion Tracker from Context.\n   * **Important**: Use this only within component initialization.\n   * @param contextKey the context key for getting this tracker\n   * @param initialState denotes whether it should initially be expanded (true) or collapsed (false)\n   * @returns\n   */\n  static getOrInit(\n    contextKey: string,\n    initialState: boolean = true,\n    locationSegment: string = ''\n  ) {\n    let tracker = getContext<ExpansionTracker>(contextKey);\n\n    if (!tracker) {\n      tracker = new ExpansionTracker(initialState, locationSegment);\n      setContext(contextKey, tracker);\n    }\n\n    return tracker;\n  }\n}\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import ExpandableContainer from 'src/components/expandable/ExpandableContainer.svelte';\n  import { declareLocation } from 'src/types/location-awareness.types';\n  import { setContext, type Snippet } from 'svelte';\n  import {\n    ExpansionTracker,\n    type ExpansionTrackerToggleProvider,\n  } from 'src/features/expand-collapse/ExpansionTracker.svelte';\n\n  interface Props {\n    /**\n     * A unique identifier for this table when viewed amongst other tables in the same logical grouping of tables, such as a tab.\n     */\n    key: string;\n    /**\n     * Denotes whether the table can be expanded and collapsed.\n     */\n    toggleable?: boolean;\n    header?: Snippet;\n    body?: Snippet;\n    [key: string]: any;\n  }\n\n  let { key, toggleable = true, header, body, ...rest }: Props = $props();\n\n  let { class: cssClass, ...attributes } = rest;\n\n  declareLocation(CONSTANTS.LOCATION_SECTION, key);\n\n  const sectionExpansionTracker = ExpansionTracker.getOrInit(\n    CONSTANTS.SVELTE_CONTEXT.SECTION_EXPANSION_TRACKER,\n  );\n  const { tabId, location } = sectionExpansionTracker.getContextKeys();\n\n  if (toggleable) {\n    sectionExpansionTracker.register(key, tabId, location);\n\n    setContext<ExpansionTrackerToggleProvider>(\n      CONSTANTS.SVELTE_CONTEXT.SECTION_EXPANSION_TOGGLE_PROVIDER,\n      () => {\n        return {\n          expanded,\n          toggle: () => sectionExpansionTracker.toggle(key, tabId, location),\n        };\n      },\n    );\n\n    $effect(() => {\n      return () => {\n        sectionExpansionTracker.unregister(key, tabId, location);\n      };\n    });\n  }\n\n  let expanded = $derived(\n    !toggleable || sectionExpansionTracker.isExpanded(key, tabId, location),\n  );\n</script>\n\n<section\n  class=\"item-table {cssClass ?? ''}\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_TABLE}\n  data-tidy-section-key={key}\n  {...attributes}\n>\n  {@render header?.()}\n  <ExpandableContainer {expanded}>\n    <div class=\"item-table-body\">\n      {@render body?.()}\n    </div>\n  </ExpandableContainer>\n</section>\n","const inputTagNames = new Set([\n  'INPUT',\n  'BUTTON',\n  'SELECT',\n  'COLOR',\n  'DATE',\n  'DATETIME-LOCAL',\n  'EMAIL',\n  'FILE',\n  'HIDDEN',\n  'A',\n]);\nconst inputTabNamesSelector = Array.from(inputTagNames)\n  .map((i) => i.toLowerCase())\n  .join(', ');\n\n/**\n * Determines whether an HTML element is known to be user interactablee.g., the user can click, input, or otherwise interact with the element.\n * @param el the element to evaluate\n * @returns whether the element is a standard user-interactable element\n */\nexport function isUserInteractable(el: HTMLElement) {\n  return (\n    // Is it one of the known interactables?\n    inputTagNames.has(el.tagName) ||\n    // Is it contained within an interactable?\n    el.closest(inputTabNamesSelector)\n  );\n}\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { isUserInteractable } from 'src/utils/element';\n  import { getContext, type Snippet } from 'svelte';\n\n  interface Props {\n    children?: Snippet;\n  }\n\n  let { children }: Props = $props();\n\n  let toggleable = getContext<() => { expanded: boolean; toggle: Function }>(\n    CONSTANTS.SVELTE_CONTEXT.SECTION_EXPANSION_TOGGLE_PROVIDER,\n  );\n\n  function handleHeaderRowClick(ev: MouseEvent) {\n    if (!toggleable) {\n      return;\n    }\n\n    if (\n      ev.target instanceof HTMLElement &&\n      isUserInteractable(ev.target) &&\n      ev.target.getAttribute(CONSTANTS.SHEET_PART_ATTRIBUTE) !==\n        CONSTANTS.SHEET_PARTS.EXPANSION_TOGGLE\n    ) {\n      // Avoid eagerly toggling expansion when a contained interactable element is being clicked.\n      return;\n    }\n\n    ev.stopPropagation();\n\n    toggleable().toggle();\n  }\n</script>\n\n<header\n  class=\"item-table-header-row\"\n  class:toggleable={!!toggleable}\n  onclick={handleHeaderRowClick}\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_TABLE_HEADER_ROW}\n>\n  {#if !!toggleable}\n    <i\n      class=\"expand-indicator fas fa-angle-right\"\n      class:expanded={toggleable().expanded}\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.EXPANSION_TOGGLE}\n    ></i>\n  {/if}\n  {@render children?.()}\n</header>\n\n<style lang=\"scss\">\n  .item-table-header-row {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0.25rem 0 0.125rem 0.375rem;\n    line-height: 0.75rem;\n    font-size: 0.75rem;\n    background: var(--t5e-table-header-row-color);\n    box-shadow: 0 0 0.1875rem inset var(--t5e-table-header-row-border-color);\n    border-radius: 0.3125rem;\n\n    &.toggleable {\n      cursor: pointer;\n    }\n\n    .expand-indicator {\n      margin-right: 0.325rem;\n    }\n  }\n</style>\n","import type { ItemSummaryCommand } from 'src/api/api.types';\nimport type { RegisteredItemSummaryCommand } from './types';\nimport type { Item5e } from 'src/types/item.types';\n\nexport class ItemSummaryRuntime {\n  private static _itemSummaryCommands: RegisteredItemSummaryCommand[] = [\n    {\n      execute: (params) => params.item.displayCard(),\n      label: 'TIDY5E.ItemSummaryCommands.ShowDescriptionInChatLabel',\n      tooltip: 'TIDY5E.ItemSummaryCommands.ShowDescriptionInChatTooltip',\n      iconClass: 'fa-solid fa-message',\n      enabled: (params) => !!params.item.actor,\n    },\n  ];\n\n  static registerItemSummaryCommands(commands: ItemSummaryCommand[]) {\n    ItemSummaryRuntime._itemSummaryCommands.push(...commands);\n  }\n\n  static getItemSummaryCommands(item: Item5e): RegisteredItemSummaryCommand[] {\n    return [...ItemSummaryRuntime._itemSummaryCommands].filter(\n      (c) => item && (c.enabled?.({ item }) ?? true)\n    );\n  }\n}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { RegisteredItemSummaryCommand } from 'src/runtime/types';\n  import { settings } from 'src/settings/settings.svelte';\n  import type { Item5e } from 'src/types/item.types';\n\n  interface Props {\n    command: RegisteredItemSummaryCommand;\n    item: Item5e;\n  }\n\n  let { command, item }: Props = $props();\n</script>\n\n<button\n  type=\"button\"\n  class=\"item-summary-command\"\n  title={FoundryAdapter.localize(command.tooltip ?? '')}\n  onclick={() => command.execute?.({ item: item })}\n  tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n>\n  {#if command.iconClass}\n    <i class={command.iconClass}></i>\n  {/if}\n  {FoundryAdapter.localize(command.label ?? '')}\n</button>\n\n<style lang=\"scss\">\n  .item-summary-command {\n    width: auto;\n    line-height: 1rem;\n    padding: 0.125rem 0.25rem;\n    border-radius: 0.3125rem;\n    background: var(--t5e-content-entity-link-background);\n    color: var(--t5e-content-entity-link-color);\n    border: 0.0625rem solid var(--t5e-separator-color);\n    font-size: 0.75rem;\n    margin: 0;\n\n    display: inline-flex;\n    align-items: center;\n    gap: 0.25rem;\n\n    i {\n      color: var(--t5e-content-entity-link-color);\n    }\n\n    &:hover {\n      color: var(--t5e-content-entity-link-hover-color);\n      background: var(--t5e-content-entity-link-hover-background);\n\n      i {\n        color: var(--t5e-content-entity-link-hover-color);\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { ItemSummaryRuntime } from 'src/runtime/ItemSummaryRuntime';\n  import ItemSummaryCommandButton from './ItemSummaryCommandButton.svelte';\n  import type { Item5e } from 'src/types/item.types';\n\n  interface Props {\n    item: Item5e;\n  }\n\n  let { item }: Props = $props();\n\n  let itemSummaryCommands = $derived(\n    ItemSummaryRuntime.getItemSummaryCommands(item),\n  );\n</script>\n\n{#each itemSummaryCommands as command}\n  <ItemSummaryCommandButton {item} {command} />\n{/each}\n","<script lang=\"ts\">\n  interface Props {\n    borderColor?: 'faint' | 'light' | 'separator';\n    [key: string]: any;\n  }\n\n  let { borderColor = 'faint', ...rest }: Props = $props();\n</script>\n\n<div\n  aria-hidden=\"true\"\n  role=\"presentation\"\n  class=\"horizontal-line-separator {borderColor} {rest.class ?? ''}\"\n></div>\n\n<style lang=\"scss\">\n  .horizontal-line-separator {\n    height: 0.0625rem;\n    flex: 0 0 auto;\n  }\n\n  .faint {\n    background: var(--t5e-faint-color);\n  }\n\n  .light {\n    background: var(--t5e-separator-color);\n  }\n\n  .separator {\n    background: var(--t5e-separator-color);\n  }\n</style>\n","export class Enrichers {\n    static reference(uuid: string, text: string) {\n        return `@UUID[${uuid}]{${text}}`;\n    }\n}","<script module>\n  export type TidyTableColumns = {\n    name: string;\n    width: string;\n  }[];\n</script>\n\n<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import ExpandableContainer from 'src/components/expandable/ExpandableContainer.svelte';\n  import { declareLocation } from 'src/types/location-awareness.types';\n  import { getContext, setContext, type Snippet } from 'svelte';\n  import {\n    ExpansionTracker,\n    type ExpansionTrackerToggleProvider,\n  } from 'src/features/expand-collapse/ExpansionTracker.svelte';\n\n  interface Props {\n    key: string;\n    toggleable?: boolean;\n    gridTemplateColumns?: TidyTableColumns;\n    header?: Snippet;\n    body?: Snippet;\n    [key: string]: any;\n  }\n\n  let {\n    key,\n    toggleable = true,\n    gridTemplateColumns = [],\n    header,\n    body,\n    ...rest\n  }: Props = $props();\n\n  let templateColumnsValue = $derived(\n    gridTemplateColumns.map((c) => `/* ${c.name} */ ${c.width}`).join(' '),\n  );\n\n  let { class: cssClass, ...attributes } = rest;\n\n  declareLocation(CONSTANTS.LOCATION_SECTION, key);\n\n  const sectionExpansionTracker = ExpansionTracker.getOrInit(\n    CONSTANTS.SVELTE_CONTEXT.SECTION_EXPANSION_TRACKER,\n  );\n  const { tabId, location } = sectionExpansionTracker.getContextKeys();\n\n  if (toggleable) {\n    sectionExpansionTracker.register(key, tabId, location);\n\n    setContext<ExpansionTrackerToggleProvider>(\n      CONSTANTS.SVELTE_CONTEXT.SECTION_EXPANSION_TOGGLE_PROVIDER,\n      () => {\n        return {\n          expanded,\n          toggle: () => sectionExpansionTracker.toggle(key, tabId, location),\n        };\n      },\n    );\n\n    $effect(() => {\n      return () => {\n        sectionExpansionTracker.unregister(key, tabId, location);\n      };\n    });\n  }\n\n  let expanded = $derived(\n    !toggleable || sectionExpansionTracker.isExpanded(key, tabId, location),\n  );\n</script>\n\n<section\n  class=\"tidy-table {cssClass ?? ''}\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_TABLE}\n  data-tidy-section-key={key}\n  {...attributes}\n  style=\"--grid-template-columns: {templateColumnsValue}\"\n>\n  {@render header?.()}\n  <ExpandableContainer {expanded}>\n    <div class=\"item-table-body\">\n      {@render body?.()}\n    </div>\n  </ExpandableContainer>\n</section>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import type { Snippet } from 'svelte';\n  import type { DragEventHandler, MouseEventHandler } from 'svelte/elements';\n\n  interface Props {\n    hidden?: boolean;\n    rowContainerClass?: string;\n    rowClass?: string;\n    rowContainerAttributes?: Record<string, unknown>;\n    rowAttributes?: Record<string, unknown>;\n    children?: Snippet;\n    afterRow?: Snippet;\n    onmousedown?: MouseEventHandler<HTMLElement>;\n    onmouseenter?: MouseEventHandler<HTMLElement>;\n    onmouseleave?: MouseEventHandler<HTMLElement>;\n    ondragstart?: DragEventHandler<HTMLElement>;\n  }\n\n  let {\n    hidden = false,\n    rowContainerClass = '',\n    rowClass = '',\n    rowContainerAttributes = {},\n    rowAttributes = {},\n    children,\n    afterRow,\n    onmousedown,\n    onmouseenter,\n    onmouseleave,\n    ondragstart,\n  }: Props = $props();\n</script>\n\n<div\n  class=\"tidy-table-row-container {rowContainerClass ?? ''}\"\n  class:hidden\n  aria-hidden={hidden}\n  {...rowContainerAttributes}\n>\n  <div\n    class=\"tidy-table-row {rowClass ?? ''}\"\n    data-tidy-table-row\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.TABLE_ROW}\n    {...rowAttributes}\n    {onmousedown}\n    {onmouseenter}\n    {onmouseleave}\n    {ondragstart}\n  >\n    {@render children?.()}\n  </div>\n\n  <!-- Consider an alternative: don't require content to be nested within this component in order to be associated visually with the target row. -->\n  {@render afterRow?.()}\n</div>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import type { Snippet } from 'svelte';\n\n  interface Props {\n    primary?: boolean;\n    title?: string | undefined;\n    baseWidth?: string | null;\n    children?: Snippet<[any]>;\n    [key: string]: any;\n  }\n\n  let {\n    primary = false,\n    title = undefined,\n    baseWidth = null,\n    children,\n    ...rest\n  }: Props = $props();\n\n  let isHovering = $state(false);\n\n  function mouseEnter(ev: MouseEvent) {\n    isHovering = true;\n  }\n\n  function mouseLeave(ev: MouseEvent) {\n    isHovering = false;\n  }\n</script>\n\n<div\n  class=\"tidy-table-cell {rest.class ?? ''}\"\n  class:primary\n  {title}\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.TABLE_CELL}\n  onmouseenter={mouseEnter}\n  onmouseleave={mouseLeave}\n  style:flex-basis={baseWidth}\n  {...rest.attributes}\n>\n  {@render children?.({ isHovering })}\n</div>\n","<!--\n @component\n A wrapper for the system-specific `<dnd5e-icon />` element. \n At the time of this writing, the component does not change images when the `src`\n attribute is changed, so re-rendering is required each time the `src` changes.\n -->\n\n<script lang=\"ts\">\n  interface Props {\n    src: string;\n    [key: string]: any;\n  }\n\n  let { ...props }: Props = $props();\n</script>\n\n{#key props.src}\n  <dnd5e-icon {...props}></dnd5e-icon>\n{/key}\n","<script lang=\"ts\">\n  import type { Activity5e } from 'src/foundry/dnd5e.types';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n  interface Props {\n    activity: any;\n  }\n\n  let { activity }: Props = $props();\n\n  function onUsesMaxChanged(\n    event: Event & {\n      currentTarget: EventTarget & HTMLInputElement;\n    },\n    activity: Activity5e,\n  ) {\n    let uses = parseInt(event.currentTarget.value ?? activity.uses.max ?? 0);\n\n    if (isNaN(uses)) {\n      uses = 0;\n    }\n\n    return activity.update({ 'uses.max': uses });\n  }\n</script>\n\n<div class=\"activity-uses\">\n  <input\n    class=\"uses-value\"\n    type=\"text\"\n    value={activity.uses.value}\n    onchange={(event) => {\n      event.preventDefault();\n      event.stopPropagation();\n      FoundryAdapter.handleActivityUsesChanged(event, activity);\n    }}\n    disabled={!activity.item.isOwner}\n    onfocus={(ev) => ev.currentTarget.select()}\n    data-tidy-field=\"uses.value\"\n  />\n  /\n  <input\n    class=\"uses-max\"\n    type=\"text\"\n    value={activity.uses.max}\n    onchange={(event) => {\n      event.preventDefault();\n      event.stopPropagation();\n      onUsesMaxChanged(event, activity);\n    }}\n    disabled={!activity.item.isOwner}\n    onfocus={(ev) => ev.currentTarget.select()}\n    data-tidy-field=\"uses.max\"\n  />\n</div>\n\n<style lang=\"scss\">\n  .activity-uses {\n    justify-self: center;\n    text-align: center;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    input {\n      width: 50%;\n      padding: 0 0.125rem 0 0;\n      color: var(--t5e-secondary-color);\n      line-height: 1;\n      height: 100%;\n\n      &.uses-value {\n        text-align: right;\n      }\n\n      &.uses-max {\n        text-align: left;\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  interface Props {\n    src: string;\n    alt?: string;\n    classes?: string;\n  }\n\n  let { src, alt = '', classes }: Props = $props();\n</script>\n\n<img class=\"item-image {classes}\" {src} {alt} />\n\n<style lang=\"scss\">\n  .item-image {\n    flex: 0 0 var(--t5e-image-size-override, 1.5rem);\n    height: var(--t5e-image-size-override, 1.5rem);\n    border-radius: 0.3125rem 0 0 0.3125rem;\n  }\n</style>\n","import type { Tidy5eSheetsApi } from 'src/api';\nimport type { ContextMenuPositionInfo } from 'src/context-menu/context-menu.types';\nimport type {\n  ActiveEffect5e,\n  Actor5e,\n  ActorSheetContextV1,\n  ActorSheetContextV2,\n  CharacterSheetContext,\n  NpcSheetContext,\n  VehicleSheetContext,\n} from 'src/types/types';\nimport type { ContextMenuEntry } from './foundry.types';\nimport type {\n  ContainerSheetClassicContext,\n  ContainerSheetQuadroneContext,\n  Item5e,\n  ItemSheetContext,\n} from 'src/types/item.types';\nimport type { Group5e } from 'src/types/group.types';\nimport type { Activity5e } from './dnd5e.types';\n\n/** Manages all Hook usage in Tidy 5e Sheets */\nexport class TidyHooks {\n  /**\n   * The active effect context menu has established its options and is about to show.\n   * @param {ActiveEffect5e} effect The active effect document instance.\n   * @param {ContextMenuEntry[]} menuItems The menu items for this active effect.\n   * @returns {boolean} `true` to allow the menu to show, `false` to prevent the default menu from showing.\n   *\n   * @example\n   * ```js\n   * Hooks.on('dnd5e.getActiveEffectContextOptions', (effect, menuItems) => {\n   *   return true;\n   * });\n   * ```\n   */\n  static dnd5eGetActiveEffectContextOptions(\n    effect: ActiveEffect5e,\n    menuItems: ContextMenuEntry[]\n  ): boolean {\n    return Hooks.call('dnd5e.getActiveEffectContextOptions', effect, menuItems);\n  }\n\n  /**\n   * Something has been dropped on an item or container sheet. Return `false` to prevent default behavior.\n   * @param item the target item\n   * @param app the target item sheet\n   * @param data the drop data\n   * @returns `false` to prevent default behavior, else the result is discarded\n   */\n  static dnd5eDropItemSheetData(item: Item5e, app: any, data: any): boolean {\n    return Hooks.call('dnd5e.dropItemSheetData', item, app, data);\n  }\n\n  /**\n   * The context menu for the advancements list has been constructed.\n   * @param {jQuery} html The HTML element to which the context options are attached.\n   * @param {ContextMenuEntry[]} contextOptions The context menu entries.\n   * @returns {boolean} `true` to allow the menu to show, `false` to prevent the default menu from showing.\n   *\n   * @example\n   * ```js\n   * Hooks.on('dnd5e.getItemAdvancementContext', (html, contextOptions) => {\n   *   return true;\n   * });\n   * ```\n   */\n  static dnd5eGetItemAdvancementContext(\n    html: any,\n    contextOptions: ContextMenuEntry[]\n  ): boolean {\n    return Hooks.call('dnd5e.getItemAdvancementContext', html, contextOptions);\n  }\n\n  /**\n   * The item context menu has established its options and is about to show.\n   * @param {Item5e} item The item document instance.\n   * @param {ContextMenuEntry[]} menuItems The menu items for this item.\n   * @returns {boolean} `true` to allow the menu to show, `false` to prevent the default menu from showing.\n   *\n   * @example\n   * ```js\n   * Hooks.on('dnd5e.getItemContextOptions', (item, menuItems) => {\n   *   return true;\n   * });\n   * ```\n   */\n  static dnd5eGetItemContextOptions(\n    item: Item5e,\n    menuItems: ContextMenuEntry[]\n  ): boolean {\n    return Hooks.call('dnd5e.getItemContextOptions', item, menuItems);\n  }\n\n  /**\n   * The context menu is about to show for a given item on a sheet.\n   * @param {Item5e} item The item document instance.\n   * @param {object} options The mouse event which triggered the context menu.\n   *\n   * @example\n   * ```js\n   * Hooks.on('tidy5e-sheet.actorItemUseContextMenu', (item, options) => {\n   *   // Your code here\n   * });\n   * ```\n   */\n  static tidy5eSheetsActorItemUseContextMenu(\n    item: Item5e,\n    options: { event: Event }\n  ) {\n    Hooks.callAll('tidy5e-sheet.actorItemUseContextMenu', item, options);\n  }\n\n  /**\n   * An item is about to be used by an actor.\n   * @param {Item5e} item The affected item document instance.\n   * @param {any} config Any configuration for the item use.\n   * @param {any} options Any options for the item use.\n   * @returns {boolean} `true` to allow the item use, `false` to prevent it.\n   *\n   * @example\n   * ```js\n   * Hooks.on('tidy5e-sheet.actorPreUseItem', (item, config, options) => {\n   *   return true;\n   * });\n   * ```\n   */\n  static tidy5eSheetsActorPreUseItem(item: Item5e, options: any): boolean {\n    return Hooks.call('tidy5e-sheet.actorPreUseItem', item, options);\n  }\n\n  /**\n   * The facility add button has been clicked for the specified facility type. Normally, this prompts the Compendium Browser.\n   * @param event     The inciting event.\n   * @param actor     The affected actor who will own the facility.\n   * @param type      The type of facility that is intended to be added.\n   * @returns         `true` to allow the default behavior, `false` to prevent it.\n   */\n  static tidy5eSheetsAddFacilityClicked(\n    event: Event,\n    actor: Actor5e,\n    type: string\n  ): boolean {\n    return Hooks.call('tidy5e-sheet.addFacilityClicked', event, actor, type);\n  }\n\n  /**\n   * An empty slot on a facility was clicked. Normally, this opens the Compendium Browser, scoped to actors of any type.\n   * @param event The inciting click event\n   * @param item The affected facility\n   * @param occupantType The intended occupant type\n   * @param prop The property path on the target facility to which changes would be applied\n   * @returns `true` to allow the default behavior, `false` to prevent it.\n   */\n  static tidy5eSheetsFacilityEmptyOccupantSlotClicked(\n    event: Event,\n    item: Item5e,\n    occupantType: string,\n    prop: string\n  ) {\n    return Hooks.call(\n      'tidy5e-sheet.facilityEmptyOccupantSlotClicked',\n      event,\n      item,\n      occupantType,\n      prop\n    );\n  }\n\n  /**\n   * The facility occupant context menu has established its options and is about to show.\n   * @param actor           The affected actor.\n   * @param facility        The affected facility.\n   * @param occupantUuid    The occupant UUID.\n   * @param prop            The property for saving changes to the target occupant.\n   * @param index           The index of the occupant.\n   * @param contextOptions  The menu items for this occupant.\n   * @returns               `true` to allow the menu to show, `false` to prevent the default menu from showing.\n   */\n  static dnd5eGetFacilityOccupantContextOptions(\n    actor: Actor5e,\n    facility: Item5e,\n    occupantUuid: string | null,\n    prop: string | null,\n    index: number | null,\n    contextOptions: ContextMenuEntry[]\n  ): boolean {\n    return Hooks.call(\n      'tidy5e-sheet.getFacilityOccupantContextOptions',\n      actor,\n      facility,\n      occupantUuid,\n      prop,\n      index,\n      contextOptions\n    );\n  }\n\n  /**\n   * The group member context menu has established its options and is about to show.\n   * @param group             The affected group document instance.\n   * @param member            The actor which is a member of the group.\n   * @param contextOptions    The menu items for this group member.\n   *\n   * @returns {boolean}       `true` to allow the menu to show, `false` to prevent the default menu from showing.\n   * \n   * @example\n   * ```js\n   * Hooks.on('tidy5e-sheet.getGroupMemberContextOptions', (group, member, contextOptions) => {\n   *    // Your code here\n   * });\n   * ```\n   */\n  static tidy5eSheetsGetGroupMemberContextOptions(\n    group: Group5e,\n    member: Actor5e,\n    contextOptions: ContextMenuEntry[]\n  ): boolean {\n    return Hooks.call(\n      'tidy5e-sheet.getGroupMemberContextOptions',\n      group,\n      member,\n      contextOptions\n    );\n  }\n\n  /**\n   * A list of visible activities has been prepared for showing on a sheet for gameplay. This is in contrast to showing activities for maintenance in a place like the Item Activities tab.\n   * @param parent             The document (usually an item) which owns the activities.\n   * @param data               A containing object with a filtered array of activities to show.\n   *\n   * @example\n   * ```js\n   * Hooks.on('tidy5e-sheet.getActivitiesForPlay', (parent, data) => {\n   *    data.activities = data.activities.filter(a => a.name === \"Hide me!\");\n   *    data.activities.push(mySecretActivity);\n   * });\n   * ```\n   */\n  static tidy5eSheetsGetActivitiesForPlay(\n    parent: any,\n    data: { activities: Activity5e[] }\n  ) {\n    Hooks.callAll('tidy5e-sheet.getActivitiesForPlay', parent, data);\n  }\n\n  /**\n   * A user has hovered off an item, typically from an item table row.\n   * @param {Event} event The triggering mouse event.\n   * @param {any} item The item which is no longer hovered.\n   *\n   * @example\n   * ```js\n   * Hooks.on('tidy5e-sheet.itemHoverOff', (event, item) => {\n   *   // Your code here\n   * });\n   * ```\n   */\n  static tidy5eSheetsItemHoverOff(event: Event, item: any) {\n    Hooks.callAll('tidy5e-sheet.itemHoverOff', event, item);\n  }\n\n  /**\n   * A user has hovered over an item, typically on an item table row.\n   * @param {Event} event The triggering mouse event.\n   * @param {any} item The hovered-over item.\n   *\n   * @example\n   * ```js\n   * Hooks.on('tidy5e-sheet.itemHoverOn', (event, item) => {\n   *   // Your code here\n   * });\n   * ```\n   */\n  static tidy5eSheetsItemHoverOn(event: Event, item: any) {\n    Hooks.callAll('tidy5e-sheet.itemHoverOn', event, item);\n  }\n\n  /**\n   * Sheet item/effect sections are about to be configured. Use this hook to inject additional items, sections, etc., or to adjust context data.\n   * @param {any} app The sheet application instance.\n   * @param {HTMLElement} element The sheet HTML element.\n   * @param {CharacterSheetContext | NpcSheetContext | ContainerSheetClassicContext} data The data context from `getData()`.\n   *\n   * @example\n   * ```js\n   * Hooks.on('tidy5e-sheet.preConfigureSections', (app, element, data) => {\n   *   // Your code here\n   * });\n   * ```\n   */\n  static tidy5eSheetsPreConfigureSections(\n    app: any,\n    element: HTMLElement,\n    data:\n      | CharacterSheetContext\n      | NpcSheetContext\n      | ContainerSheetClassicContext\n      | ContainerSheetQuadroneContext\n  ) {\n    Hooks.callAll('tidy5e-sheet.preConfigureSections', app, element, data);\n  }\n\n  /**\n   * An active effect is about to be created for an owning document.\n   * This was initiated specifically through Tidy 5e Sheets,\n   * whether directly by the user, or indirectly through some user interaction.\n   * @param {any} owner The owning document instance which will receive the created effect.\n   * @param {object} createData The data used to create it.\n   * @param {string} userId The user who initiated the creation.\n   * @returns {boolean} `true` to allow the effect creation, `false` to prevent it.\n   *\n   * @example\n   * ```js\n   * Hooks.on('tidy5e-sheet.preCreateActiveEffect', (owner, createData, userId) => {\n   *   return true;\n   * });\n   * ```\n   */\n  static tidy5eSheetsPreCreateActiveEffect(\n    owner: any,\n    createData: object,\n    userId: string\n  ): boolean {\n    return Hooks.call(\n      'tidy5e-sheet.preCreateActiveEffect',\n      owner,\n      createData,\n      userId\n    );\n  }\n\n  /**\n   * An item is about to be created for an owning document.\n   * This was initiated specifically through Tidy 5e Sheets,\n   * whether directly by the user, or indirectly through some user interaction.\n   * @param {any} owner The owning document instance which will receive the created item.\n   * @param {object} createData The data used to create it.\n   * @param {string} userId The user who initiated the creation.\n   * @returns {boolean} `true` to allow the item creation, `false` to prevent it.\n   *\n   * @example\n   * ```js\n   * Hooks.on('tidy5e-sheet.preCreateItem', (owner, createData, userId) => {\n   *   return true;\n   * });\n   * ```\n   */\n  static tidy5eSheetsPreCreateItem(\n    owner: any,\n    createData: object,\n    userId: string\n  ): boolean {\n    return Hooks.call('tidy5e-sheet.preCreateItem', owner, createData, userId);\n  }\n\n  /**\n   * The portrait picker is about to open.\n   * @param {ActorSheetContextV1 | ActorSheetContextV2} context The actor sheet data from `getData()`.\n   * @param {MouseEvent & { currentTarget: EventTarget & HTMLElement }} event The triggering event.\n   * @returns {boolean} `true` to allow the picker to open, `false` to prevent it.\n   *\n   * @example\n   * ```js\n   * Hooks.on('tidy5e-sheet.preOpenActorPortraitFilePicker', (context, event) => {\n   *   return true;\n   * });\n   * ```\n   */\n  static tidy5eSheetsPreOpenActorPortraitFilePicker(\n    context: ActorSheetContextV1 | ActorSheetContextV2,\n    event: MouseEvent & { currentTarget: EventTarget & HTMLElement }\n  ): boolean {\n    return Hooks.call(\n      'tidy5e-sheet.preOpenActorPortraitFilePicker',\n      context,\n      event\n    );\n  }\n\n  /**\n   * The floating context menu's positioning is being determined.\n   * @param {ContextMenuPositionInfo} positionInfo Context menu positioning info, used for determining where to put the context menu.\n   * @returns {boolean} `true` to allow the menu to show, `false` to prevent the default menu from showing.\n   *\n   * @example\n   * ```js\n   * Hooks.on('tidy5e-sheet.prepareFloatingContextMenuPosition', (positionInfo) => {\n   *   return true;\n   * });\n   * ```\n   */\n  static tidy5eSheetsPrepareFloatingContextMenuPosition(\n    positionInfo: ContextMenuPositionInfo\n  ): boolean {\n    return Hooks.call(\n      'tidy5e-sheet.prepareFloatingContextMenuPosition',\n      positionInfo\n    );\n  }\n\n  /**\n   * A tab is about to be selected.\n   * @param {any} app The sheet application instance.\n   * @param {HTMLElement} element The sheet's HTML element.\n   * @param {object} data The current tab ID before selecting the new tab, and the new tab ID to be selected.\n   * @returns {boolean} `false` to cancel tabbing.\n   *\n   * @example\n   * ```js\n   * Hooks.on('tidy5e-sheet.preSelectTab', (app, element, data) => {\n   *   return true;\n   * });\n   * ```\n   */\n  static tidy5eSheetsPreSelectTab(\n    app: any,\n    element: HTMLElement,\n    data: { currentTab: any; newTab: string }\n  ): boolean {\n    return Hooks.call('tidy5e-sheet.preSelectTab', app, element, data);\n  }\n\n  /**\n   * Tidy 5e Sheets is ready to be used and customized.\n   * @param {Tidy5eSheetsApi} api The Tidy 5e Sheets API, used for customizing and registering content with Tidy 5e Sheets.\n   *\n   * @example\n   * ```js\n   * Hooks.on('tidy5e-sheet.ready', (api) => {\n   *   // Your code here\n   * });\n   * ```\n   */\n  static tidy5eSheetsReady(api: Tidy5eSheetsApi): void {\n    Hooks.callAll('tidy5e-sheet.ready', api);\n  }\n\n  /**\n   * The actor sheet has rendered all content and registered custom content. Is called on partial and full renders.\n   * @param {any} app The sheet application instance.\n   * @param {HTMLElement} element The sheet's HTML element.\n   * @param {CharacterSheetContext | NpcSheetContext | VehicleSheetContext} data The data context from `getData()`.\n   * @param {boolean} forced `true` when performing a full re-render; `false` when performing a partial re-render.\n   *\n   * @example\n   * ```js\n   * Hooks.on('tidy5e-sheet.renderActorSheet', (app, element, data, forced) => {\n   *   // Your code here\n   * });\n   * ```\n   */\n  static tidy5eSheetsRenderActorSheet(\n    app: any,\n    element: HTMLElement,\n    data: CharacterSheetContext | NpcSheetContext | VehicleSheetContext,\n    forced: boolean\n  ) {\n    Hooks.callAll('tidy5e-sheet.renderActorSheet', app, element, data, forced);\n  }\n\n  /**\n   * A tab has been selected on the sheet.\n   * @param {any} app The sheet application instance.\n   * @param {HTMLElement} element The sheet's HTML element.\n   * @param {string} newTabId The selected tab ID.\n   *\n   * @example\n   * ```js\n   * Hooks.on('tidy5e-sheet.selectTab', (app, element, newTabId) => {\n   *   // Your code here\n   * });\n   * ```\n   */\n  static tidy5eSheetsSelectTab(\n    app: any,\n    element: HTMLElement,\n    newTabId: string\n  ) {\n    Hooks.callAll('tidy5e-sheet.selectTab', app, element, newTabId);\n  }\n}\n","import type { Activity5e } from 'src/foundry/dnd5e.types';\nimport { TidyHooks } from 'src/foundry/TidyHooks';\nimport type { Item5e } from 'src/types/item.types';\nimport type {\n  ActivityItemContext,\n  Actor5e,\n  CharacterItemContext,\n  NpcItemContext,\n} from 'src/types/types';\n\nexport class Activities {\n  static isConfigurable(activity: Activity5e) {\n    return CONFIG.DND5E.activityTypes[activity.type]?.configurable !== false;\n  }\n\n  static getVisibleActivities(\n    item: Item5e,\n    activities: Activity5e[]\n  ): Activity5e[] {\n    // To allow the array to be completely swapped during hook calls, contain within an object.\n    const visibleActivities = {\n      activities:\n        activities?.filter(\n          (a: Activity5e) =>\n            !item.getFlag('dnd5e', 'riders.activity')?.includes(a.id)\n        ) ?? [],\n    };\n\n    TidyHooks.tidy5eSheetsGetActivitiesForPlay(item, visibleActivities);\n\n    return visibleActivities.activities;\n  }\n\n  static activationMap: Record<string, string> = {\n    action: 'DND5E.ActionAbbr',\n    bonus: 'DND5E.BonusActionAbbr',\n    reaction: 'DND5E.ReactionAbbr',\n    minute: 'DND5E.TimeMinuteAbbr',\n    hour: 'DND5E.TimeHourAbbr',\n    day: 'DND5E.TimeDayAbbr',\n  };\n\n  static getActivityItemContext(activity: Activity5e): ActivityItemContext {\n    // To Hit\n    const toHit = parseInt(activity.labels.toHit);\n\n    // Activation\n    const activationAbbr =\n      Activities.activationMap[activity.activation?.type || ''];\n\n    // Limited Uses / Recharge\n    const hasRecharge =\n      activity.uses?.max && activity.uses.recovery?.[0]?.period === 'recharge';\n    const isOnCooldown = hasRecharge && activity.uses.value < 1;\n\n    return {\n      id: activity.id,\n      activity,\n      hasRecharge,\n      isOnCooldown,\n      activation: activationAbbr\n        ? `${activity.activation.value ?? ''}${game.i18n.localize(\n            activationAbbr\n          )}`\n        : activity.labels.activation,\n      save: activity.save\n        ? {\n            ability: activity.save.ability?.size\n              ? activity.save.ability.size === 1\n                ? CONFIG.DND5E.abilities[activity.save.ability.first()]\n                    ?.abbreviation\n                : game.i18n.localize('DND5E.AbbreviationDC')\n              : null,\n          }\n        : null,\n      toHit: isNaN(toHit) ? null : toHit,\n    };\n  }\n\n  static applyLinkedUses(\n    item: Item5e,\n    actor: Actor5e,\n    context: CharacterItemContext | NpcItemContext\n  ) {\n    const cachedFor = fromUuidSync(item.flags.dnd5e?.cachedFor, {\n      relative: actor,\n      strict: false,\n    });\n    if (cachedFor) {\n      context.linkedUses = cachedFor.consumption?.targets.find(\n        (t: any) => t.type === 'activityUses'\n      )\n        ? {\n            ...cachedFor.uses,\n            valueProp: 'uses.value',\n            spentProp: 'uses.spent',\n            maxProp: 'uses.max',\n            doc: cachedFor,\n          }\n        : cachedFor.consumption?.targets.find((t: any) => t.type === 'itemUses')\n        ? {\n            ...cachedFor.item.system.uses,\n            valueProp: 'system.uses.value',\n            spentProp: 'system.uses.spent',\n            maxProp: 'system.uses.max',\n            doc: cachedFor.item,\n          }\n        : null;\n    }\n  }\n}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n\n  interface Props {\n    document: any;\n    uses: any; // TODO: Give it types\n    field: string;\n  }\n\n  let { document, uses, field }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n\n  let rechargeLabel = $derived(\n    localize('TIDY5E.RollRecharge.Hint', {\n      rechargeLabel: document.labels?.recharge ?? '',\n    }),\n  );\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  let recovery = $derived(uses?.recovery[0]);\n\n  let disabled = $derived(!context.owner);\n\n  function onRechargeClicked(ev: MouseEvent) {\n    ev.shiftKey ? document.update({ [field]: 0 }) : uses.rollRecharge();\n  }\n</script>\n\n<a\n  class=\"item-list-button\"\n  class:disabled\n  title={rechargeLabel}\n  onclick={(ev) => !disabled && onRechargeClicked(ev)}\n  tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n>\n  <i class=\"fas fa-dice-six\"></i>\n  {recovery?.formula}{#if recovery?.value !== 6}+{/if}\n</a>\n","<script lang=\"ts\">\n  import type { Item5e } from 'src/types/item.types';\n  import TidyTable, { type TidyTableColumns } from '../table/TidyTable.svelte';\n  import TidyTableRow from '../table/TidyTableRow.svelte';\n  import TidyTableCell from '../table/TidyTableCell.svelte';\n  import type { Activity5e } from 'src/foundry/dnd5e.types';\n  import Dnd5eIcon from '../icon/Dnd5eIcon.svelte';\n  import ActivityUses from './ActivityUses.svelte';\n  import { getContext } from 'svelte';\n  import { CONSTANTS } from 'src/constants';\n  import ItemImage from './ItemImage.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { Activities } from 'src/features/activities/activities';\n  import type { ActivityItemContext } from 'src/types/types';\n  import RechargeControl from './controls/RechargeControl.svelte';\n\n  interface Props {\n    item?: Item5e | null;\n    activities: ActivityItemContext[] | undefined;\n  }\n\n  let { item = null, activities = [] }: Props = $props();\n\n  let tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  const gridTemplateColumns: TidyTableColumns = [\n    {\n      name: 'Name',\n      width: '1fr',\n    },\n    {\n      name: 'Uses',\n      width: '2.5rem',\n    },\n    {\n      name: 'Usage',\n      width: '5rem',\n    },\n  ];\n\n  function rollActivity(activity: Activity5e, event: MouseEvent) {\n    activity.use({ event });\n  }\n\n  function getActivityUsageLabel(activity: Activity5e) {\n    return (\n      // @ts-expect-error\n      CONFIG.DND5E.activityActivationTypes[activity.activation?.type]?.label ??\n      activity.activation?.type ??\n      ''\n    );\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"inline-activities-container\" data-item-id={item.id}>\n  <TidyTable\n    key=\"activities-{item.name}\"\n    toggleable={false}\n    {gridTemplateColumns}\n  >\n    {#snippet body()}\n      {#each activities as ctx (ctx.activity.id)}\n        {@const configurable = Activities.isConfigurable(ctx.activity)}\n        <TidyTableRow\n          rowAttributes={{\n            'data-activity-id': ctx.activity.id,\n            'data-configurable': configurable,\n            'data-info-card': 'activity',\n            'data-info-card-entity-uuid': ctx.activity.uuid,\n            'data-context-menu': CONSTANTS.CONTEXT_MENU_TYPE_ACTIVITIES,\n          }}\n          rowClass=\"activity\"\n          onmousedown={(event) =>\n            FoundryAdapter.editOnMiddleClick(event, ctx.activity)}\n        >\n          <TidyTableCell primary={true}>\n            <span class=\"inline-activity-arrow\">\n              <i class=\"fa-solid fa-turn-up fa-fw\"></i>\n            </span>\n            <a\n              class=\"inline-activity-roll-button highlight-on-hover\"\n              onclick={(ev) => item.isOwner && rollActivity(ctx.activity, ev)}\n              tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n            >\n              {#if ctx.activity.img?.endsWith('.svg')}\n                <Dnd5eIcon src={ctx.activity.img} />\n              {:else}\n                <ItemImage\n                  classes=\"always-visible\"\n                  src={ctx.activity.img}\n                  alt={ctx.activity.name}\n                />\n              {/if}\n              {ctx.activity.name}\n            </a>\n          </TidyTableCell>\n          <TidyTableCell>\n            {#if configurable}\n              {#if ctx.isOnCooldown}\n                <RechargeControl\n                  document={ctx.activity}\n                  field={'uses.spent'}\n                  uses={ctx.activity.uses}\n                />\n              {:else if ctx.hasRecharge}\n                {@const remaining =\n                  ctx.activity.uses.max - ctx.activity.uses.spent}\n                {#if remaining > 1}\n                  <span>{remaining}</span>\n                {/if}\n                <i class=\"fas fa-bolt\" title={localize('DND5E.Charged')}></i>\n              {:else if !!ctx.activity.uses?.max}\n                <ActivityUses activity={ctx.activity} />\n              {:else}\n                <span class=\"text-body-tertiary\">&mdash;</span>\n              {/if}\n            {/if}\n          </TidyTableCell>\n          <TidyTableCell>\n            {getActivityUsageLabel(ctx.activity)}\n          </TidyTableCell>\n        </TidyTableRow>\n      {/each}\n    {/snippet}\n  </TidyTable>\n</div>\n","<script lang=\"ts\">\n  import ItemSummaryCommandButtonList from '../item-summary/ItemSummaryCommandButtonList.svelte';\n  import type { Item5e, ItemChatData } from 'src/types/item.types';\n  import { ItemSummaryRuntime } from 'src/runtime/ItemSummaryRuntime';\n  import HorizontalLineSeparator from '../layout/HorizontalLineSeparator.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { CONSTANTS } from 'src/constants';\n  import { Enrichers } from 'src/features/enrichers/Enrichers';\n  import InlineActivitiesList from './InlineActivitiesList.svelte';\n  import { Activities } from 'src/features/activities/activities';\n  import type { ActivityItemContext } from 'src/types/types';\n  import { settings, SettingsProvider } from 'src/settings/settings.svelte';\n\n  interface Props {\n    chatData: ItemChatData;\n    item?: Item5e | undefined;\n  }\n\n  let { chatData, item }: Props = $props();\n\n  let itemSummaryCommands = $derived(\n    ItemSummaryRuntime.getItemSummaryCommands(item),\n  );\n  let concealDetails = $derived(FoundryAdapter.concealDetails(item));\n\n  let linked = $derived<Item5e>(item?.system?.linkedActivity?.item);\n\n  const localize = FoundryAdapter.localize;\n\n  let activities = $derived.by(() => {\n    return item\n      ? Activities.getVisibleActivities(\n          item,\n          item.system.activities,\n        ).map<ActivityItemContext>(Activities.getActivityItemContext)\n      : [];\n  });\n</script>\n\n{#if activities.length > 0 && settings.value.inlineActivitiesPosition === CONSTANTS.INLINE_ACTIVITIES_POSITION_TOP}\n  <InlineActivitiesList {item} {activities} />\n  <HorizontalLineSeparator />\n{/if}\n<div\n  class=\"item-summary\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_SUMMARY}\n>\n  {#if linked}\n    {#await FoundryAdapter.enrichHtml(Enrichers.reference(linked.uuid, linked.name)) then enriched}\n      <div class=\"item-summary-linked-source\">\n        {@html localize('TIDY5E.Activities.Cast.SourceHintText', {\n          itemName: enriched,\n        })}\n      </div>\n    {/await}\n    <HorizontalLineSeparator />\n  {/if}\n\n  {@html chatData.description}\n\n  {#if itemSummaryCommands.length}\n    <HorizontalLineSeparator />\n    <div class=\"inline-wrapped-elements\">\n      <ItemSummaryCommandButtonList {item} />\n    </div>\n  {/if}\n\n  {#if chatData.properties}\n    <HorizontalLineSeparator />\n    <div\n      class=\"inline-wrapped-elements\"\n      class:conceal-content={concealDetails}\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_PROPERTY_LIST}\n    >\n      {#each chatData.properties as prop}<span class=\"tag\">{prop}</span>{/each}\n    </div>\n  {/if}\n</div>\n{#if activities.length > 0 && settings.value.inlineActivitiesPosition === CONSTANTS.INLINE_ACTIVITIES_POSITION_BOTTOM}\n  <HorizontalLineSeparator />\n  <InlineActivitiesList {item} {activities} />\n{/if}\n","<script lang=\"ts\">\n  import { type Actor5e, type OnItemToggledFn } from 'src/types/types';\n  import ItemSummary from '../ItemSummary.svelte';\n  import { warn } from 'src/utils/logging';\n  import { getContext, type Snippet } from 'svelte';\n  import type {\n    ActivityItemContext,\n    ExpandedItemData,\n    ExpandedItemIdToLocationsMap,\n  } from 'src/types/types';\n  import type { Item5e, ItemChatData } from 'src/types/item.types';\n  import { CONSTANTS } from 'src/constants';\n  import { TidyHooks } from 'src/foundry/TidyHooks';\n  import ExpandableContainer from 'src/components/expandable/ExpandableContainer.svelte';\n  import type { MouseEventHandler } from 'svelte/elements';\n  import { Activities } from 'src/features/activities/activities';\n\n  interface Props {\n    item?: Item5e | null;\n    favoriteId?: string | null;\n    contextMenu?: { type: string; uuid: string } | null;\n    cssClass?: string;\n    hidden?: boolean;\n    getDragData?: (() => any) | null;\n    onMouseDown?: MouseEventHandler<HTMLElement>;\n    containerAttributes?: Record<string, any>;\n    rowAttributes?: Record<string, any>;\n    children?: Snippet<[any]>;\n  }\n\n  let {\n    item = null,\n    favoriteId = null,\n    contextMenu = null,\n    cssClass = '',\n    hidden = false,\n    getDragData = null,\n    onMouseDown,\n    containerAttributes,\n    rowAttributes,\n    children,\n  }: Props = $props();\n\n  let draggable = $derived(item);\n\n  const emptyChatData: ItemChatData = {\n    description: { value: '' },\n    properties: [],\n    unidentified: { description: '' },\n  };\n\n  const expandedItemData = getContext<ExpandedItemData>(\n    CONSTANTS.SVELTE_CONTEXT.EXPANDED_ITEM_DATA,\n  );\n\n  const expandedItems = getContext<ExpandedItemIdToLocationsMap>(\n    CONSTANTS.SVELTE_CONTEXT.EXPANDED_ITEMS,\n  );\n\n  const onItemToggled = getContext<OnItemToggledFn>(\n    CONSTANTS.SVELTE_CONTEXT.ON_ITEM_TOGGLED,\n  );\n\n  const location = getContext<string>(CONSTANTS.SVELTE_CONTEXT.LOCATION);\n\n  let showSummary = $state(false);\n  let chatData: ItemChatData | undefined = $state();\n\n  async function toggleSummary(actor: Actor5e) {\n    if (!item) {\n      warn('Unable to show summary. No item was provided.');\n      showSummary = false;\n      return;\n    }\n\n    chatData = await item.getChatData({ secrets: actor.isOwner });\n    showSummary = !showSummary;\n    onItemToggled?.(item.id, showSummary, location);\n  }\n\n  async function onMouseEnter(event: Event) {\n    TidyHooks.tidy5eSheetsItemHoverOn(event, item);\n  }\n\n  async function onMouseLeave(event: Event) {\n    TidyHooks.tidy5eSheetsItemHoverOff(event, item);\n  }\n\n  function handleDragStart(event: DragEvent) {\n    if (!draggable) {\n      return;\n    }\n\n    onMouseLeave(event);\n\n    const dragData = getDragData?.() ?? draggable.toDragData?.();\n    if (dragData) {\n      event.dataTransfer?.setData('text/plain', JSON.stringify(dragData));\n    }\n  }\n\n  function restoreItemSummaryIfExpanded() {\n    if (!item) {\n      return;\n    }\n\n    const isExpandedAtThisLocation = expandedItems?.get(item.id)?.has(location);\n\n    if (isExpandedAtThisLocation) {\n      chatData = expandedItemData.get(item.id);\n      showSummary = true;\n    }\n  }\n\n  let first = true;\n\n  $effect(() => {\n    (async function () {\n      if (first) {\n        first = false;\n        restoreItemSummaryIfExpanded();\n        return;\n      }\n\n      if (item && showSummary) {\n        chatData = await item.getChatData({ secrets: item.actor.isOwner });\n      }\n    })();\n  });\n\n  let activities = $derived.by(() => {\n    return item\n      ? Activities.getVisibleActivities(\n          item,\n          item.system.activities,\n        ).map<ActivityItemContext>(Activities.getActivityItemContext)\n      : [];\n  });\n</script>\n\n<div\n  class=\"item-table-row-container\"\n  data-item-id={item?.id}\n  class:hidden\n  aria-hidden={hidden}\n  {...containerAttributes}\n>\n  <div\n    class=\"item-table-row {cssClass ?? ''}\"\n    data-context-menu={contextMenu?.type}\n    onmousedown={onMouseDown}\n    onmouseenter={onMouseEnter}\n    onmouseleave={onMouseLeave}\n    ondragstart={handleDragStart}\n    draggable={!!draggable}\n    data-tidy-table-row\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_TABLE_ROW}\n    data-tidy-item-type={item?.type ?? 'unknown'}\n    data-favorite-id={favoriteId ?? null}\n    data-info-card={item ? 'item' : null}\n    data-info-card-entity-uuid={item?.uuid ?? null}\n    {...rowAttributes}\n  >\n    {@render children?.({ toggleSummary })}\n  </div>\n  <ExpandableContainer expanded={showSummary}>\n    <ItemSummary chatData={chatData ?? emptyChatData} {item} />\n  </ExpandableContainer>\n</div>\n\n<style lang=\"scss\">\n  .item-table-row-container {\n    position: relative;\n    border-radius: 0.3125rem;\n    margin: 0 0 0.125rem 0.5rem;\n    background: var(--t5e-faintest-color);\n\n    &:global(.context) {\n      box-shadow: 0 0 0.1875rem 0.0625rem var(--t5e-primary-accent-color) inset;\n    }\n\n    .item-table-row {\n      display: flex;\n      flex-direction: row;\n      flex-wrap: wrap;\n      border-radius: 0.3125rem;\n\n      // TODO: Eliminate the CSS class injection; set the background color CSS variable via an inline style with a color taken from a function, rather than using the classes. Put the variable assignment outside of the item table row so that scripters can set the CSS variable on the row itself.\n      --t5e-item-table-row-background: transparent;\n      &.prepared {\n        --t5e-item-table-row-background: var(--t5e-prepared-background);\n      }\n\n      &.always-prepared {\n        --t5e-item-table-row-background: var(--t5e-alwaysprepared-background);\n      }\n\n      &.pact {\n        --t5e-item-table-row-background: var(--t5e-pact-background);\n      }\n\n      &.at-will {\n        --t5e-item-table-row-background: var(--t5e-atwill-background);\n      }\n\n      &.ritual-only {\n        --t5e-item-table-row-background: var(--t5e-ritual-only-background);\n      }\n\n      &.innate {\n        --t5e-item-table-row-background: var(--t5e-innate-background);\n      }\n\n      &.equipped {\n        --t5e-item-table-row-background: var(--t5e-equipped-background);\n      }\n\n      &.magic-item {\n        box-shadow: 0 0 0 0.0625rem var(--t5e-magic-accent-color) inset;\n      }\n\n      & {\n        background: linear-gradient(\n          to right,\n          var(--t5e-item-table-row-background),\n          transparent 120%\n        );\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { type Actor5e } from 'src/types/types';\n\n  interface Props {\n    dataset: any;\n    actor: Actor5e;\n    create?: (() => void) | undefined;\n  }\n\n  let { dataset, actor, create = defaultCreateFunction }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n\n  function defaultCreateFunction() {\n    return FoundryAdapter.createItem(dataset, actor);\n  }\n</script>\n\n<button\n  type=\"button\"\n  class=\"item-list-footer-button\"\n  onclick={create}\n  title={localize('DND5E.FeatureAdd')}\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_CREATE_COMMAND}\n  tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n>\n  <i class=\"fas fa-plus-circle\"></i>\n  {localize('DND5E.Add')}\n</button>\n","import type { ActorItemSectionFooterCommand } from 'src/api/api.types';\nimport type {\n  RegisteredActorItemSectionFooterCommand,\n  RegisteredActorItemSectionFooterCommandEnabledParams,\n} from './types';\nimport type { Actor5e } from 'src/types/types';\nimport { error } from 'src/utils/logging';\n\nexport class ActorItemRuntime {\n  private static _actorItemSectionCommands: RegisteredActorItemSectionFooterCommand[] =\n    [];\n\n  static registerActorItemSectionCommands(\n    commands: ActorItemSectionFooterCommand[]\n  ) {\n    ActorItemRuntime._actorItemSectionCommands.push(...commands);\n  }\n\n  static getActorItemSectionCommands({\n    section,\n    actor,\n  }: RegisteredActorItemSectionFooterCommandEnabledParams): RegisteredActorItemSectionFooterCommand[] {\n    return [...ActorItemRuntime._actorItemSectionCommands].filter((c) => {\n      try {\n        return section && (c.enabled?.({ section, actor }) ?? true);\n      } catch (e) {\n        error(\n          'Failed to check if actor item section command is enabled',\n          false,\n          { error: e, actor, section }\n        );\n        return false;\n      }\n    });\n  }\n}\n","<script lang=\"ts\" generics=\"TSection extends TidySectionBase\">\n  import { TidyHooks } from 'src/foundry/TidyHooks';\n  import type {\n    Actor5e,\n    CustomSectionOptions,\n    TidySectionBase,\n  } from 'src/types/types';\n  import ItemCreateButton from '../item-list/ItemCreateButton.svelte';\n  import { ActorItemRuntime } from 'src/runtime/ActorItemRuntime';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n\n  interface Props {\n    section: TSection;\n    actor: Actor5e;\n    canCreate?: boolean;\n    /**\n     * Override for the underlying create button's `create()` function.\n     */\n    create?: (() => void) | undefined;\n    isItem: boolean;\n  }\n\n  let {\n    section,\n    actor,\n    canCreate = true,\n    create = undefined,\n    isItem,\n  }: Props = $props();\n\n  let customCommands = isItem\n    ? ActorItemRuntime.getActorItemSectionCommands({ actor, section })\n    : [];\n\n  function createForCustom(custom: CustomSectionOptions) {\n    if (!custom.creationItemTypes.length) {\n      return;\n    }\n\n    if (custom.creationItemTypes.length === 1) {\n      FoundryAdapter.createItem(\n        { type: custom.creationItemTypes[0], ...section.dataset },\n        actor,\n      );\n    } else {\n      const createData = { ...section.dataset };\n\n      if (\n        !TidyHooks.tidy5eSheetsPreCreateItem(actor, createData, game.user.id)\n      ) {\n        return;\n      }\n\n      Item.implementation.createDialog(createData, {\n        parent: actor,\n        pack: actor.pack,\n        types: custom.creationItemTypes,\n      });\n    }\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<footer class=\"item-table-footer-row\">\n  <!-- TODO: Handle custom section item creation -->\n  {#if canCreate}\n    {@const custom = section.custom}\n    {#if custom}\n      <ItemCreateButton\n        dataset={section.dataset}\n        {actor}\n        create={() => createForCustom(custom)}\n      />\n    {:else}\n      <ItemCreateButton dataset={section.dataset} {actor} {create} />\n    {/if}\n  {/if}\n  {#each customCommands as command}\n    <button\n      type=\"button\"\n      class=\"item-list-footer-button\"\n      onclick={(ev) => command.execute?.({ section, event: ev, actor: actor })}\n      title={localize(command.tooltip ?? '')}\n      tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n    >\n      {#if (command.iconClass ?? '') !== ''}\n        <i class={command.iconClass}></i>\n      {/if}\n      {localize(command.label ?? '')}\n    </button>\n  {/each}\n</footer>\n\n<style lang=\"scss\">\n  .item-table-footer-row {\n    display: flex;\n    justify-content: flex-end;\n    flex: 1;\n    margin-left: 0.5rem;\n    border-radius: 0 0 0.3125rem 0.3125rem;\n  }\n</style>\n","<script lang=\"ts\">\n  import type { Snippet } from 'svelte';\n\n  interface Props {\n    primary?: boolean;\n    baseWidth?: string | null;\n    title?: string | null;\n    cssClass?: string | null;\n    children?: Snippet;\n  }\n\n  let {\n    primary = false,\n    baseWidth = null,\n    title = null,\n    cssClass = '',\n    children,\n  }: Props = $props();\n</script>\n\n<div\n  class=\"item-table-column {cssClass}\"\n  class:primary\n  style:flex-basis={baseWidth}\n  {title}\n>\n  {@render children?.()}\n</div>\n\n<style lang=\"scss\">\n  .item-table-column {\n    color: var(--t5e-tertiary-color);\n    font-family: var(--t5e-body-font-family);\n    font-size: 0.75rem;\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n\n    :global(i) {\n      font-size: 0.625rem;\n      color: var(--t5e-light-color);\n    }\n\n    &.primary {\n      color: var(--t5e-primary-font-color);\n      font-weight: 700;\n      font-size: 0.75rem;\n      flex: 1;\n      justify-content: flex-start;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { type Snippet } from 'svelte';\n\n  interface Props {\n    baseWidth?: string | undefined;\n    primary?: boolean;\n    cssClass?: string;\n    title?: string | undefined;\n    children?: Snippet;\n    [key: string]: any;\n  }\n\n  let {\n    baseWidth = undefined,\n    primary = false,\n    cssClass = '',\n    title = undefined,\n    children,\n    ...rest\n  }: Props = $props();\n</script>\n\n<div\n  class=\"item-table-cell {cssClass}\"\n  class:primary\n  style:flex-basis={baseWidth}\n  {title}\n  {...rest.attributes}\n>\n  {@render children?.()}\n</div>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { type Snippet } from 'svelte';\n\n  interface Props {\n    item: any;\n    imgUrlOverride?: string | undefined;\n    disabled?: boolean;\n    showDiceIconOnHover?: boolean;\n    afterRollButton?: Snippet;\n  }\n\n  let {\n    item,\n    imgUrlOverride = undefined,\n    disabled = false,\n    showDiceIconOnHover = true,\n    afterRollButton,\n  }: Props = $props();\n</script>\n\n<a\n  class=\"item-use-button\"\n  onclick={(event) => !disabled && FoundryAdapter.actorTryUseItem(item, event)}\n  oncontextmenu={(event) =>\n    FoundryAdapter.onActorItemButtonContextMenu(item, { event })}\n>\n  <img\n    class=\"item-image\"\n    class:conceal={item.system.identified === false}\n    alt={item.name}\n    src={imgUrlOverride ?? item.img}\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.GROUP_MEMBER_PORTRAIT}\n  />\n\n  <div\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    class=\"unidentified-glyph no-transition\"\n    class:conceal={item.system.identified === false}\n  >\n    <i class=\"fas fa-question\"></i>\n  </div>\n\n  {#if showDiceIconOnHover}\n    <i class=\"roll-indicator fa fa-dice-d20\"></i>\n  {/if}\n\n  {@render afterRollButton?.()}\n</a>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<span class=\"ae-marker\" title={localize('TIDY5E.ActiveEffectsMarkerTitle')}>\n  \n</span>\n\n<style lang=\"scss\">\n  .ae-marker {\n    display: inline-block;\n    padding: 0.0625rem 0.1875rem 0 0.1875rem;\n    font-size: 0.75rem;\n    line-height: 0.9375rem;\n    font-weight: 600;\n    background: var(--t5e-warning-accent-color);\n    color: var(--t5e-warning-accent-contrast-color);\n    border-radius: 0.1875rem;\n    flex: 0;\n    align-self: center;\n    margin: 0 0.25rem;\n  }\n</style>\n","<script lang=\"ts\">\n  import { settings } from 'src/settings/settings.svelte';\n  import type { Item5e } from 'src/types/item.types';\n  import ActiveEffectsMarker from './ActiveEffectsMarker.svelte';\n  import type { Snippet } from 'svelte';\n\n  interface Props {\n    cssClass?: string;\n    hasChildren?: boolean;\n    item: Item5e;\n    useActiveEffectsMarker?: boolean;\n    onToggle?: (event: Event) => void;\n    children?: Snippet;\n  }\n\n  let {\n    cssClass = '',\n    hasChildren = true,\n    item,\n    useActiveEffectsMarker = true,\n    onToggle,\n    children,\n  }: Props = $props();\n\n  let hasActiveEffects = $derived(!!item.effects?.size);\n</script>\n\n<a\n  onclick={(ev) => onToggle?.(ev)}\n  class=\"item-name truncate {cssClass}\"\n  class:has-children={hasChildren}\n  class:italic={item.system.identified === false}\n>\n  {@render children?.()}\n</a>\n{#if useActiveEffectsMarker && settings.value.showActiveEffectsMarker && hasActiveEffects}\n  <ActiveEffectsMarker />\n{/if}\n\n<style lang=\"scss\">\n  .item-name {\n    flex: 1 1 0.0625rem;\n    min-width: 0;\n\n    &:not(.has-children) {\n      align-self: center;\n    }\n    &.has-children {\n      display: flex;\n      align-items: center;\n    }\n\n    &:focus-visible {\n      outline: 0.0625rem solid var(--t5e-primary-accent-color);\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n  interface Props {\n    item: any;\n  }\n\n  let { item }: Props = $props();\n\n  function onUsesMaxChanged(\n    event: Event & {\n      currentTarget: EventTarget & HTMLInputElement;\n    },\n    item: any,\n  ) {\n    let uses = parseInt(event.currentTarget.value ?? item.system.uses.max ?? 0);\n\n    if (isNaN(uses)) {\n      uses = 0;\n    }\n\n    return item.update({ 'system.uses.max': uses });\n  }\n</script>\n\n<div class=\"inline-item-uses\">\n  <input\n    class=\"uses-value\"\n    type=\"text\"\n    value={item.system.uses.value}\n    onchange={(event) => {\n      event.preventDefault();\n      event.stopPropagation();\n      FoundryAdapter.handleItemUsesChanged(event, item);\n    }}\n    disabled={!item.isOwner}\n    onfocus={(ev) => ev.currentTarget.select()}\n    data-tidy-field=\"system.uses.value\"\n  />\n  /\n  <input\n    class=\"uses-max\"\n    type=\"text\"\n    value={item.system.uses.max}\n    onchange={(event) => {\n      event.preventDefault();\n      event.stopPropagation();\n      onUsesMaxChanged(event, item);\n    }}\n    disabled={!item.isOwner}\n    onfocus={(ev) => ev.currentTarget.select()}\n    data-tidy-field=\"system.uses.max\"\n  />\n</div>\n","<script lang=\"ts\">\n  import Dnd5eIcon from 'src/components/icon/Dnd5eIcon.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n\n  interface Props {\n    iconCssClass?: string | undefined;\n    iconSrc?: string | undefined;\n    title?: string | undefined;\n    active?: boolean;\n    onclick?:\n      | ((\n          ev: MouseEvent & {\n            currentTarget: EventTarget & HTMLButtonElement;\n          },\n        ) => any)\n      | undefined;\n    [key: string]: any;\n  }\n\n  let {\n    iconCssClass = undefined,\n    iconSrc = undefined,\n    title = undefined,\n    active = true,\n    onclick = undefined,\n    ...rest\n  }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<button\n  type=\"button\"\n  class=\"item-list-button {rest.class ?? ''}\"\n  class:inactive={!active}\n  {onclick}\n  title={title !== undefined ? localize(title) : ''}\n  tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n>\n  {#if iconCssClass}\n    <i class={iconCssClass}></i>\n  {/if}\n  {#if iconSrc}\n    <Dnd5eIcon src={iconSrc} />\n  {/if}\n</button>\n\n<style lang=\"scss\">\n  .item-list-button {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    align-self: stretch;\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemControl from './ItemControl.svelte';\n\n  type OnDelete = () => boolean;\n\n  interface Props {\n    item: any;\n    onDelete?: OnDelete;\n    deleteFn?: Function;\n    [key: string]: any;\n  }\n\n  let {\n    item,\n    onDelete = () => true,\n    deleteFn = () => FoundryAdapter.onActorItemDelete(item.actor, item),\n    ...rest\n  }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<ItemControl\n  iconCssClass=\"fas fa-trash fa-fw\"\n  class={rest.class ?? ''}\n  onclick={() => onDelete() && deleteFn()}\n  title={localize('DND5E.ItemDelete')}\n/>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemControl from './ItemControl.svelte';\n\n  interface Props {\n    item: any;\n    [key: string]: any;\n  }\n\n  let { item, ...rest }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<ItemControl\n  iconCssClass=\"fas fa-edit fa-fw {rest.class ?? ''}\"\n  class={rest.class ?? ''}\n  title={localize('DND5E.ItemEdit')}\n  onclick={() => item.sheet.render(true)}\n/>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemControl from './ItemControl.svelte';\n\n  interface Props {\n    ctx: any;\n    item: any;\n  }\n\n  let { ctx, item }: Props = $props();\n\n  function toggleEquipped() {\n    const value = FoundryAdapter.getProperty(item, 'system.equipped');\n\n    item.update({\n      'system.equipped': !value,\n    });\n  }\n</script>\n\n<ItemControl\n  title={ctx?.toggleTitle}\n  iconCssClass=\"fas fa-user-alt\"\n  active={item.system.equipped}\n  onclick={toggleEquipped}\n/>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemControl from './ItemControl.svelte';\n  import type { Item5e } from 'src/types/item.types';\n\n  interface Props {\n    item: Item5e;\n    ctx: any;\n  }\n\n  let { item, ctx }: Props = $props();\n\n  let isAttuned = $derived(item.system.attuned);\n\n  function toggleAttuned() {\n    const actor = item.actor;\n    if (!actor) {\n      return;\n    }\n\n    const currentAttunementCount = actor.system.attributes.attunement.value;\n\n    if (item.system.attuned) {\n      item.update({ 'system.attuned': false });\n    } else {\n      if (currentAttunementCount >= actor.system.attributes.attunement.max) {\n        ui.notifications.warn(\n          `${FoundryAdapter.localize('TIDY5E.AttunementWarning', {\n            number: currentAttunementCount,\n          })}`,\n        );\n      } else {\n        item.update({ 'system.attuned': true });\n      }\n    }\n  }\n</script>\n\n<ItemControl\n  title={ctx?.attunement?.title}\n  iconCssClass=\"fas fa-sun {ctx?.attunement?.cls}\"\n  active={isAttuned}\n  onclick={toggleAttuned}\n/>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"is-favorite\" title={localize('TIDY5E.Favorite')}>\n  <i class=\"fas fa-bookmark icon-fav fa-fw\"></i>\n</div>\n\n<style lang=\"scss\">\n  .is-favorite {\n    font-size: 0.75rem;\n    color: var(--t5e-secondary-color);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n</style>\n","<script lang=\"ts\">\n  import type { Item5e } from 'src/types/item.types';\n  import ItemControl from './ItemControl.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n  interface Props {\n    item: Item5e;\n  }\n\n  let { item }: Props = $props();\n\n  let active = $derived(FoundryAdapter.isItemFavorited(item));\n  let title = $derived(\n    FoundryAdapter.localize(\n      active ? 'TIDY5E.RemoveFavorite' : 'TIDY5E.AddFavorite',\n    ),\n  );\n</script>\n\n<ItemControl\n  iconCssClass=\"fas fa-bookmark\"\n  {active}\n  {title}\n  onclick={() => FoundryAdapter.toggleFavoriteItem(item)}\n/>\n","export class ActionListRuntime {\n  private static _activationTypeMappings: Record<string, string> = {};\n\n  static addActivationTypeMappings(mappings: Record<string, string>) {\n    ActionListRuntime._activationTypeMappings = foundry.utils.mergeObject(\n      ActionListRuntime._activationTypeMappings,\n      mappings\n    );\n  }\n\n  static getActivationTypeMappings() {\n    return { ...ActionListRuntime._activationTypeMappings };\n  }\n}\n","import type { Item5e } from 'src/types/item.types';\nimport type { SheetTabSectionConfigs } from 'src/features/sections/sections.types';\nimport { CONSTANTS } from 'src/constants';\nimport { isNil } from 'src/utils/data';\nimport type { Actor5e } from 'src/types/types';\nimport type {\n  AttributePinFlag,\n  TidyFlagNamedNotes,\n  TidyFlagUnnamedNotes,\n} from './TidyFlags.types';\n\n/** Manages Tidy flags. */\nexport class TidyFlags {\n  static getFlagPropertyPath(key: string) {\n    return `flags.${CONSTANTS.MODULE_ID}.${key}`;\n  }\n\n  /**\n   * Determines whether an item whose default Action List behavior has been overridden\n   * to be included (`true`) or excluded (`false`).\n   * `undefined` means there is no override and standard Action List logic should be used.\n   * */\n  static actionFilterOverride = {\n    key: 'action-filter-override' as const,\n    prop: TidyFlags.getFlagPropertyPath('action-filter-override'),\n    /** Gets the item's Action Filter Override setting. */\n    get(item: Item5e): boolean | undefined {\n      return (\n        TidyFlags.tryGetFlag<boolean>(\n          item,\n          TidyFlags.actionFilterOverride.key\n        ) ?? undefined\n      );\n    },\n    /** Sets the item's Action Filter Override setting. */\n    set(item: Item5e, value: boolean): Promise<void> {\n      return TidyFlags.setFlag(item, TidyFlags.actionFilterOverride.key, value);\n    },\n    /**\n     * Clears the item's Action Filter Override setting,\n     * meaning the item should use the standard Action List logic\n     * for inclusion or exclusion. */\n    unset(item: Item5e) {\n      return TidyFlags.unsetFlag(item, TidyFlags.actionFilterOverride.key);\n    },\n  };\n\n  /**\n   * Indicates a custom section name for a given item,\n   * which determines the item's section placement\n   * in the Actions tab.\n   */\n  static actionSection = {\n    key: 'actionSection' as const,\n    prop: TidyFlags.getFlagPropertyPath('actionSection'),\n    /** Gets the item's Action Section setting. */\n    get(item: Item5e): string | undefined {\n      const actionSection = TidyFlags.tryGetFlag<string>(\n        item,\n        TidyFlags.actionSection.key\n      )?.trim();\n\n      return !isNil(actionSection, '') ? actionSection : undefined;\n    },\n    /** Sets the item's Action Section setting. */\n    set(item: Item5e, value: string) {\n      return TidyFlags.setFlag(item, TidyFlags.actionSection.key, value);\n    },\n    /**\n     * Clears the item's Action Section setting,\n     * meaning the item should use its default action section\n     * in the Actions tab.\n     */\n    unset(item: Item5e) {\n      return TidyFlags.unsetFlag(item, TidyFlags.actionSection.key);\n    },\n  };\n\n  /**\n   * The age of an actor.\n   * For this module, it is only an informational biographical field.\n   */\n  static age = {\n    key: 'age' as const,\n    prop: TidyFlags.getFlagPropertyPath('age'),\n    /** Gets the actor's age. */\n    get(actor: Actor5e): string | undefined {\n      return (\n        TidyFlags.tryGetFlag<string>(actor, TidyFlags.age.key) ?? undefined\n      );\n    },\n    /** Sets the actor's age. */\n    set(actor: Actor5e, value: string): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.age.key, value);\n    },\n    /** Clears the actor's age. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.age.key);\n    },\n  };\n\n  /**\n   * Determines whether an actor's sheet should be editable per the sheet lock feature (default `true`).\n   * @param actor the actor\n   * @returns whether the sheet should be editable per the sheet lock feature\n   */\n  static allowEdit = {\n    key: 'allow-edit',\n    prop: TidyFlags.getFlagPropertyPath('allow-edit'),\n    /** Denotes whether the sheet is in edit mode. */\n    get(document: any): boolean {\n      return TidyFlags.tryGetFlag<boolean>(document, 'allow-edit') ?? true;\n    },\n    /** Sets whether the sheet is in edit mode. */\n    set(document: any, value: boolean) {\n      return TidyFlags.setFlag(document, TidyFlags.allowEdit.key, value);\n    },\n    /** Removes the actor's edit mode setting. */\n    unset(document: any) {\n      return TidyFlags.unsetFlag(document, TidyFlags.allowEdit.key);\n    },\n  };\n\n  /**\n   * The appearance of an actor.\n   * For this module, it is only an informational biographical field.\n   */\n  static appearance = {\n    key: 'appearance' as const,\n    prop: TidyFlags.getFlagPropertyPath('appearance'),\n    /** Gets the actor's appearance. */\n    get(actor: Actor5e): string | undefined {\n      return (\n        TidyFlags.tryGetFlag<string>(actor, TidyFlags.appearance.key) ??\n        undefined\n      );\n    },\n    /** Sets the actor's appearance. */\n    set(actor: Actor5e, value: string): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.appearance.key, value);\n    },\n    /** Clears the actor's appearance. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.appearance.key);\n    },\n  };\n\n  /**\n   * Denotes the items and activities which have been pinned to the attributes tab.\n   */\n  static attributePins = {\n    key: 'attributePins' as const,\n    prop: TidyFlags.getFlagPropertyPath('attributePins'),\n    /** Gets the actor's Attribute tab pins. */\n    get(actor: Actor5e): AttributePinFlag[] {\n      return (\n        TidyFlags.tryGetFlag<AttributePinFlag[]>(\n          actor,\n          TidyFlags.attributePins.key\n        ) ?? []\n      );\n    },\n    /** Sets the actor's Attribute tab pins. */\n    set(actor: Actor5e, value: AttributePinFlag[]): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.attributePins.key, value);\n    },\n  };\n\n  /**\n   * A field used to filter spells based on an indicated class,\n   * showing only spells whose `system.sourceClass` property matches\n   * this `classFilter` selection.\n   */\n  static classFilter = {\n    key: 'classFilter' as const,\n    prop: TidyFlags.getFlagPropertyPath('classFilter'),\n    /** Gets the actor's class filter. */\n    get(actor: Actor5e): string | undefined {\n      return (\n        TidyFlags.tryGetFlag<string>(actor, TidyFlags.classFilter.key) ??\n        undefined\n      );\n    },\n    /** Sets the actor's class filter. */\n    set(actor: Actor5e, value: string): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.classFilter.key, value);\n    },\n    /** Clears the actor's class filter. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.classFilter.key);\n    },\n  };\n\n  /**\n   * The level exhaustion for a given actor.\n   * This flag applies to actors which don't yet possess\n   * standard exhaustion schema from the dnd5e system.\n   */\n  static exhaustion = {\n    key: 'exhaustion' as const,\n    prop: TidyFlags.getFlagPropertyPath('exhaustion'),\n    /** Gets the actor's exhaustion level. */\n    get(actor: Actor5e): number | undefined {\n      return (\n        TidyFlags.tryGetFlag<number>(actor, TidyFlags.exhaustion.key) ??\n        undefined\n      );\n    },\n    /** Sets the actor's exhaustion level. */\n    set(actor: Actor5e, value: number): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.exhaustion.key, value);\n    },\n    /** Clears the actor's exhaustion level. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.exhaustion.key);\n    },\n  };\n\n  /**\n   * The eyes of an actor.\n   * For this module, it is only an informational biographical field.\n   */\n  static eyes = {\n    key: 'eyes' as const,\n    prop: TidyFlags.getFlagPropertyPath('eyes'),\n    /** Gets the actor's eyes. */\n    get(actor: Actor5e): string | undefined {\n      return (\n        TidyFlags.tryGetFlag<string>(actor, TidyFlags.eyes.key) ?? undefined\n      );\n    },\n    /** Sets the actor's eyes. */\n    set(actor: Actor5e, value: string): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.eyes.key, value);\n    },\n    /** Clears the actor's eyes. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.eyes.key);\n    },\n  };\n\n  /**\n   * The faith of an actor.\n   * For this module, it is only an informational biographical field.\n   */\n  static faith = {\n    key: 'faith' as const,\n    prop: TidyFlags.getFlagPropertyPath('faith'),\n    /** Gets the actor's faith. */\n    get(actor: Actor5e): string | undefined {\n      return (\n        TidyFlags.tryGetFlag<string>(actor, TidyFlags.faith.key) ?? undefined\n      );\n    },\n    /** Sets the actor's faith. */\n    set(actor: Actor5e, value: string): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.faith.key, value);\n    },\n    /** Clears the actor's faith. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.faith.key);\n    },\n  };\n\n  /**\n   * The gender of an actor.\n   * For this module, it is only an informational biographical field.\n   */\n  static gender = {\n    key: 'gender' as const,\n    prop: TidyFlags.getFlagPropertyPath('gender'),\n    /** Gets the actor's gender. */\n    get(actor: Actor5e): string | undefined {\n      return (\n        TidyFlags.tryGetFlag<string>(actor, TidyFlags.gender.key) ?? undefined\n      );\n    },\n    /** Sets the actor's gender. */\n    set(actor: Actor5e, value: string): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.gender.key, value);\n    },\n    /** Clears the actor's gender. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.gender.key);\n    },\n  };\n\n  /**\n   * The hair of an actor.\n   * For this module, it is only an informational biographical field.\n   */\n  static hair = {\n    key: 'hair' as const,\n    prop: TidyFlags.getFlagPropertyPath('hair'),\n    /** Gets the actor's hair. */\n    get(actor: Actor5e): string | undefined {\n      return (\n        TidyFlags.tryGetFlag<string>(actor, TidyFlags.hair.key) ?? undefined\n      );\n    },\n    /** Sets the actor's hair. */\n    set(actor: Actor5e, value: string): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.hair.key, value);\n    },\n    /** Clears the actor's hair. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.hair.key);\n    },\n  };\n\n  /**\n   * The height of an actor.\n   * For this module, it is only an informational biographical field.\n   */\n  static height = {\n    key: 'height' as const,\n    prop: TidyFlags.getFlagPropertyPath('height'),\n    /** Gets the actor's height. */\n    get(actor: Actor5e): string | undefined {\n      return (\n        TidyFlags.tryGetFlag<string>(actor, TidyFlags.height.key) ?? undefined\n      );\n    },\n    /** Sets the actor's height. */\n    set(actor: Actor5e, value: string): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.height.key, value);\n    },\n    /** Clears the actor's height. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.height.key);\n    },\n  };\n\n  /**\n   * Denotes whether to include all ritual spells in the \"Can Cast\" filter.\n   */\n  static includeRitualsInCanCast = {\n    key: 'includeRitualsInCanCast',\n    prop: TidyFlags.getFlagPropertyPath('includeRitualsInCanCast'),\n    /** Gets whether to include rituals in the \"Can Cast\" spell filter. */\n    get(document: any): boolean {\n      return (\n        TidyFlags.tryGetFlag<boolean>(\n          document,\n          TidyFlags.includeRitualsInCanCast.key\n        ) === true\n      );\n    },\n    /** Sets whether to include rituals in the \"Can Cast\" spell filter. */\n    set(document: any, value: boolean = true) {\n      return TidyFlags.setFlag(\n        document,\n        TidyFlags.includeRitualsInCanCast.key,\n        value\n      );\n    },\n    /** Clears whether to include rituals in the \"Can Cast\" spell filter. */\n    unset(document: any) {\n      return TidyFlags.unsetFlag(\n        document,\n        TidyFlags.includeRitualsInCanCast.key\n      );\n    },\n  };\n\n  /**\n   * Denotes whether to show a grid for a given inventory screen.\n   */\n  static inventoryGrid = {\n    key: 'inventory-grid',\n    prop: TidyFlags.getFlagPropertyPath('inventory-grid'),\n    /** Gets whether to show a grid for a given inventory screen. */\n    get(document: any): boolean {\n      return (\n        TidyFlags.tryGetFlag<boolean>(document, TidyFlags.inventoryGrid.key) ===\n        true\n      );\n    },\n    /** Sets whether to show a grid for a given inventory screen. */\n    set(document: any) {\n      return TidyFlags.setFlag(document, TidyFlags.inventoryGrid.key, true);\n    },\n    /** Clears whether to show a grid for a given inventory screen. */\n    unset(document: any) {\n      return TidyFlags.unsetFlag(document, TidyFlags.inventoryGrid.key);\n    },\n  };\n\n  /**\n   * Denotes whether a vehicle is moving.\n   */\n  static motion = {\n    key: 'motion' as const,\n    prop: TidyFlags.getFlagPropertyPath('motion'),\n    /** Gets whether a vehicle is moving. */\n    get(actor: Actor5e): boolean | undefined {\n      return (\n        TidyFlags.tryGetFlag<boolean>(actor, TidyFlags.motion.key) ?? undefined\n      );\n    },\n    /** Sets whether a vehicle is moving. */\n    set(actor: Actor5e, value: boolean): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.motion.key, value);\n    },\n    /** Clears whether a vehicle is moving. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.motion.key);\n    },\n  };\n\n  /**\n   * Journal notes for an actor.\n   * This flag is for actors which don't yet have the standard notes schema.\n   */\n  static notes = {\n    key: 'notes' as const,\n    prop: TidyFlags.getFlagPropertyPath('notes'),\n    /** Gets the actor's journal notes. */\n    get(actor: Actor5e): TidyFlagUnnamedNotes | undefined {\n      return (\n        TidyFlags.tryGetFlag<TidyFlagUnnamedNotes>(\n          actor,\n          TidyFlags.notes.key\n        ) ?? undefined\n      );\n    },\n    /** Sets the actor's journal notes. */\n    set(actor: Actor5e, value: TidyFlagUnnamedNotes): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.notes.key, value);\n    },\n    /** Clears the actor's journal notes. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.notes.key);\n    },\n    /** The individual members of this flag. For flags that are not primitive values. */\n    members: {\n      /** The notes HTML. */\n      value: {\n        key: 'notes.value' as const,\n        prop: TidyFlags.getFlagPropertyPath('notes.value'),\n        /** Gets the actor's notes HTML. */\n        get(actor: Actor5e): string | undefined {\n          return (\n            TidyFlags.tryGetFlag<string>(\n              actor,\n              TidyFlags.notes.members.value.key\n            ) ?? undefined\n          );\n        },\n        /** Sets the actor's notes HTML. */\n        set(actor: Actor5e, value: string): Promise<void> {\n          return TidyFlags.setFlag(\n            actor,\n            TidyFlags.notes.members.value.key,\n            value\n          );\n        },\n        /** Clears the actor's notes HTML. */\n        unset(actor: Actor5e) {\n          return TidyFlags.unsetFlag(actor, TidyFlags.notes.members.value.key);\n        },\n      },\n    },\n  };\n\n  /**\n   * Named journal notes for an actor.\n   * These notes represent extra notes that are available\n   * to actors for compartmentalizing notes.\n   */\n  static notes1 = {\n    key: 'notes1' as const,\n    prop: TidyFlags.getFlagPropertyPath('notes1'),\n    /** Gets the actor's first named journal notes. */\n    get(actor: Actor5e): TidyFlagNamedNotes | undefined {\n      return (\n        TidyFlags.tryGetFlag<TidyFlagNamedNotes>(actor, TidyFlags.notes1.key) ??\n        undefined\n      );\n    },\n    /** Sets the actor's first named journal notes. */\n    set(actor: Actor5e, value: TidyFlagNamedNotes): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.notes1.key, value);\n    },\n    /** Clears the actor's first named journal notes. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.notes1.key);\n    },\n    /** The individual members of this flag. For flags that are not primitive values. */\n    members: {\n      /** The notes name. */\n      name: {\n        key: 'notes1.name' as const,\n        prop: TidyFlags.getFlagPropertyPath('notes1.name'),\n        /** Gets the actor's first named journal notes name. */\n        get(actor: Actor5e): string | undefined {\n          return (\n            TidyFlags.tryGetFlag<string>(\n              actor,\n              TidyFlags.notes1.members.name.key\n            ) ?? undefined\n          );\n        },\n        /** Sets the actor's first named journal notes name. */\n        set(actor: Actor5e, value: string): Promise<void> {\n          return TidyFlags.setFlag(\n            actor,\n            TidyFlags.notes1.members.name.key,\n            value\n          );\n        },\n        /** Clears the actor's first named journal notes name. */\n        unset(actor: Actor5e) {\n          return TidyFlags.unsetFlag(actor, TidyFlags.notes1.members.name.key);\n        },\n      },\n      /** The notes HTML. */\n      value: {\n        key: 'notes1.value' as const,\n        prop: TidyFlags.getFlagPropertyPath('notes1.value'),\n        /** Gets the actor's first named journal notes HTML. */\n        get(actor: Actor5e): string | undefined {\n          return (\n            TidyFlags.tryGetFlag<string>(\n              actor,\n              TidyFlags.notes1.members.value.key\n            ) ?? undefined\n          );\n        },\n        /** Sets the actor's first named journal notes HTML. */\n        set(actor: Actor5e, value: string): Promise<void> {\n          return TidyFlags.setFlag(\n            actor,\n            TidyFlags.notes1.members.value.key,\n            value\n          );\n        },\n        /** Clears the actor's first named journal notes HTML. */\n        unset(actor: Actor5e) {\n          return TidyFlags.unsetFlag(actor, TidyFlags.notes1.members.value.key);\n        },\n      },\n    },\n  };\n\n  /**\n   * Named journal notes for an actor.\n   * These notes represent extra notes that are available\n   * to actors for compartmentalizing notes.\n   */\n  static notes2 = {\n    key: 'notes2' as const,\n    prop: TidyFlags.getFlagPropertyPath('notes2'),\n    /** Gets the actor's second named journal notes. */\n    get(actor: Actor5e): TidyFlagNamedNotes | undefined {\n      return (\n        TidyFlags.tryGetFlag<TidyFlagNamedNotes>(actor, TidyFlags.notes2.key) ??\n        undefined\n      );\n    },\n    /** Sets the actor's second named journal notes. */\n    set(actor: Actor5e, value: TidyFlagNamedNotes): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.notes2.key, value);\n    },\n    /** Clears the actor's second named journal notes. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.notes2.key);\n    },\n    /** The individual members of this flag. For flags that are not primitive values. */\n    members: {\n      /** The notes name. */\n      name: {\n        key: 'notes2.name' as const,\n        prop: TidyFlags.getFlagPropertyPath('notes2.name'),\n        /** Gets the actor's second named journal notes name. */\n        get(actor: Actor5e): string | undefined {\n          return (\n            TidyFlags.tryGetFlag<string>(\n              actor,\n              TidyFlags.notes2.members.name.key\n            ) ?? undefined\n          );\n        },\n        /** Sets the actor's second named journal notes name. */\n        set(actor: Actor5e, value: string): Promise<void> {\n          return TidyFlags.setFlag(\n            actor,\n            TidyFlags.notes2.members.name.key,\n            value\n          );\n        },\n        /** Clears the actor's second named journal notes name. */\n        unset(actor: Actor5e) {\n          return TidyFlags.unsetFlag(actor, TidyFlags.notes2.members.name.key);\n        },\n      },\n      /** The notes HTML. */\n      value: {\n        key: 'notes2.value' as const,\n        prop: TidyFlags.getFlagPropertyPath('notes2.value'),\n        /** Gets the actor's second named journal notes HTML. */\n        get(actor: Actor5e): string | undefined {\n          return (\n            TidyFlags.tryGetFlag<string>(\n              actor,\n              TidyFlags.notes2.members.value.key\n            ) ?? undefined\n          );\n        },\n        /** Sets the actor's second named journal notes HTML. */\n        set(actor: Actor5e, value: string): Promise<void> {\n          return TidyFlags.setFlag(\n            actor,\n            TidyFlags.notes2.members.value.key,\n            value\n          );\n        },\n        /** Clears the actor's second named journal notes HTML. */\n        unset(actor: Actor5e) {\n          return TidyFlags.unsetFlag(actor, TidyFlags.notes2.members.value.key);\n        },\n      },\n    },\n  };\n\n  /**\n   * Named journal notes for an actor.\n   * These notes represent extra notes that are available\n   * to actors for compartmentalizing notes.\n   */\n  static notes3 = {\n    key: 'notes3' as const,\n    prop: TidyFlags.getFlagPropertyPath('notes3'),\n    /** Gets the actor's third named journal notes. */\n    get(actor: Actor5e): TidyFlagNamedNotes | undefined {\n      return (\n        TidyFlags.tryGetFlag<TidyFlagNamedNotes>(actor, TidyFlags.notes3.key) ??\n        undefined\n      );\n    },\n    /** Sets the actor's third named journal notes. */\n    set(actor: Actor5e, value: TidyFlagNamedNotes): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.notes3.key, value);\n    },\n    /** Clears the actor's third named journal notes. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.notes3.key);\n    },\n    members: {\n      name: {\n        key: 'notes3.name' as const,\n        prop: TidyFlags.getFlagPropertyPath('notes3.name'),\n        /** Gets the actor's third named journal notes name. */\n        get(actor: Actor5e): string | undefined {\n          return (\n            TidyFlags.tryGetFlag<string>(\n              actor,\n              TidyFlags.notes3.members.name.key\n            ) ?? undefined\n          );\n        },\n        /** Sets the actor's third named journal notes name. */\n        set(actor: Actor5e, value: string): Promise<void> {\n          return TidyFlags.setFlag(\n            actor,\n            TidyFlags.notes3.members.name.key,\n            value\n          );\n        },\n        /** Clears the actor's third named journal notes name. */\n        unset(actor: Actor5e) {\n          return TidyFlags.unsetFlag(actor, TidyFlags.notes3.members.name.key);\n        },\n      },\n      value: {\n        key: 'notes3.value' as const,\n        prop: TidyFlags.getFlagPropertyPath('notes3.value'),\n        /** Gets the actor's third named journal notes HTML. */\n        get(actor: Actor5e): string | undefined {\n          return (\n            TidyFlags.tryGetFlag<string>(\n              actor,\n              TidyFlags.notes3.members.value.key\n            ) ?? undefined\n          );\n        },\n        /** Sets the actor's third named journal notes HTML. */\n        set(actor: Actor5e, value: string): Promise<void> {\n          return TidyFlags.setFlag(\n            actor,\n            TidyFlags.notes3.members.value.key,\n            value\n          );\n        },\n        /** Clears the actor's third named journal notes HTML. */\n        unset(actor: Actor5e) {\n          return TidyFlags.unsetFlag(actor, TidyFlags.notes3.members.value.key);\n        },\n      },\n    },\n  };\n\n  /**\n   * Named journal notes for an actor.\n   * These notes represent extra notes that are available\n   * to actors for compartmentalizing notes.\n   */\n  static notes4 = {\n    key: 'notes4' as const,\n    prop: TidyFlags.getFlagPropertyPath('notes4'),\n    /** Gets the actor's fourth named journal notes. */\n    get(actor: Actor5e): TidyFlagNamedNotes | undefined {\n      return (\n        TidyFlags.tryGetFlag<TidyFlagNamedNotes>(actor, TidyFlags.notes4.key) ??\n        undefined\n      );\n    },\n    /** Sets the actor's fourth named journal notes. */\n    set(actor: Actor5e, value: TidyFlagNamedNotes): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.notes4.key, value);\n    },\n    /** Clears the actor's fourth named journal notes. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.notes4.key);\n    },\n    /** The individual members of this flag. For flags that are not primitive values. */\n    members: {\n      /** The notes name. */\n      name: {\n        key: 'notes4.name' as const,\n        prop: TidyFlags.getFlagPropertyPath('notes4.name'),\n        /** Gets the actor's fourth named journal notes name. */\n        get(actor: Actor5e): string | undefined {\n          return (\n            TidyFlags.tryGetFlag<string>(\n              actor,\n              TidyFlags.notes4.members.name.key\n            ) ?? undefined\n          );\n        },\n        /** Sets the actor's fourth named journal notes name. */\n        set(actor: Actor5e, value: string): Promise<void> {\n          return TidyFlags.setFlag(\n            actor,\n            TidyFlags.notes4.members.name.key,\n            value\n          );\n        },\n        /** Clears the actor's fourth named journal notes name. */\n        unset(actor: Actor5e) {\n          return TidyFlags.unsetFlag(actor, TidyFlags.notes4.members.name.key);\n        },\n      },\n      /** The notes HTML. */\n      value: {\n        key: 'notes4.value' as const,\n        prop: TidyFlags.getFlagPropertyPath('notes4.value'),\n        /** Gets the actor's fourth named journal notes HTML. */\n        get(actor: Actor5e): string | undefined {\n          return (\n            TidyFlags.tryGetFlag<string>(\n              actor,\n              TidyFlags.notes4.members.value.key\n            ) ?? undefined\n          );\n        },\n        /** Sets the actor's fourth named journal notes HTML. */\n        set(actor: Actor5e, value: string): Promise<void> {\n          return TidyFlags.setFlag(\n            actor,\n            TidyFlags.notes4.members.value.key,\n            value\n          );\n        },\n        /** Clears the actor's fourth named journal notes HTML. */\n        unset(actor: Actor5e) {\n          return TidyFlags.unsetFlag(actor, TidyFlags.notes4.members.value.key);\n        },\n      },\n    },\n  };\n\n  /**\n   * The name of the player who owns the actor.\n   * This is informational and not used for game logic.\n   */\n  static playerName = {\n    key: 'playerName' as const,\n    prop: TidyFlags.getFlagPropertyPath('playerName'),\n    /** Gets the name of the player who owns the actor. */\n    get(actor: Actor5e): string | undefined {\n      return (\n        TidyFlags.tryGetFlag<string>(actor, TidyFlags.playerName.key) ??\n        undefined\n      );\n    },\n    /** Sets the name of the player who owns the actor. */\n    set(actor: Actor5e, value: string): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.playerName.key, value);\n    },\n    /** Clears the name of the player who owns the actor. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.playerName.key);\n    },\n  };\n\n  /**\n   * Indicates a custom section name for a given item\n   * which determines the item's section placement\n   * in the item's default tab, as well as any other locations\n   * that aren't the Actions tab.\n   */\n  static section = {\n    key: 'section' as const,\n    prop: TidyFlags.getFlagPropertyPath('section'),\n    unsetProp: TidyFlags.getFlagPropertyPath('-=section'),\n    /** Gets the custom section name for an item. */\n    get(item: Item5e): string | undefined {\n      const section = TidyFlags.tryGetFlag<string>(\n        item,\n        TidyFlags.section.key\n      )?.trim();\n\n      return !isNil(section, '') ? section : undefined;\n    },\n    /** Sets the custom section name for an item. */\n    set(item: Item5e, value: string) {\n      return TidyFlags.setFlag(item, TidyFlags.section.key, value);\n    },\n    /**\n     * Clears the item's custom section setting,\n     * meaning the item should use its default section\n     * in the item's default tab, as well as any other locations\n     * that aren't the Actions tab.\n     */\n    unset(item: Item5e) {\n      return TidyFlags.unsetFlag(item, TidyFlags.section.key);\n    },\n  };\n\n  /** Determines the order of item table sections for a given document sheet. */\n  static sectionConfig = {\n    key: 'sheet-section-config' as const,\n    prop: TidyFlags.getFlagPropertyPath('sheet-section-config'),\n    /** Gets the document sheet's section configuration. `undefined` means to use the default settings. */\n    get(document: any): SheetTabSectionConfigs | undefined {\n      const sectionConfigs = TidyFlags.tryGetFlag<SheetTabSectionConfigs>(\n        document,\n        TidyFlags.sectionConfig.key\n      );\n\n      if (!sectionConfigs) {\n        return undefined;\n      }\n\n      for (let section of Object.values(sectionConfigs)) {\n        // Account for how localized keys are stored. For each top-level property, flatten until SheetTabSectionConfigs shape achieved.\n        for (let [key, value] of Object.entries(section)) {\n          if (Object.getOwnPropertyNames(value).length > 1) {\n            continue;\n          }\n\n          let newKey = key;\n          let newValue: any = value;\n\n          while (true) {\n            const propNames = Object.getOwnPropertyNames(newValue);\n\n            let currentPropAtDepth = propNames[0];\n            if (isNil(currentPropAtDepth) || propNames.length > 1) {\n              break;\n            }\n\n            newKey += '.' + currentPropAtDepth;\n            newValue = newValue[currentPropAtDepth];\n          }\n\n          delete section[key];\n          section[newKey] = newValue;\n        }\n      }\n\n      return sectionConfigs;\n    },\n    /** Sets the document sheet's configuration. */\n    set(document: any, value: SheetTabSectionConfigs) {\n      return TidyFlags.setFlag(document, TidyFlags.sectionConfig.key, value);\n    },\n    /**\n     * Clears the document sheet's section config,\n     * meaning the target actor should use default settings.\n     * */\n    unset(document: any) {\n      return TidyFlags.unsetFlag(document, TidyFlags.sectionConfig.key);\n    },\n  };\n\n  /**\n   * The tabs that are currently selected for a given actor.\n   * This is used to determine which tabs are visible\n   * in the actor's sheet.\n   * When this field is empty, the actor uses the default tabs.\n   */\n  static selectedTabs = {\n    key: 'selected-tabs' as const,\n    prop: TidyFlags.getFlagPropertyPath('selected-tabs'),\n    /** Gets the selected tabs for an actor. */\n    get(actor: Actor5e): string[] | undefined {\n      return (\n        TidyFlags.tryGetFlag<string[]>(actor, TidyFlags.selectedTabs.key) ??\n        undefined\n      );\n    },\n    /** Sets the selected tabs for an actor. */\n    set(actor: Actor5e, value: string[]): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.selectedTabs.key, value);\n    },\n    /** Clears the selected tabs for an actor. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.selectedTabs.key);\n    },\n  };\n\n  /**\n   * Indicates whether the container panel should be shown for a given actor.\n   * This is used to determine whether the container panel is visible\n   * in the actor's inventory tab.\n   */\n  static showContainerPanel = {\n    key: 'showContainerPanel' as const,\n    prop: TidyFlags.getFlagPropertyPath('showContainerPanel'),\n    /** Gets whether the container panel should be shown for an actor. */\n    get(actor: Actor5e): boolean | undefined {\n      return (\n        TidyFlags.tryGetFlag<boolean>(\n          actor,\n          TidyFlags.showContainerPanel.key\n        ) ?? undefined\n      );\n    },\n    /** Sets whether the container panel should be shown for an actor. */\n    set(actor: Actor5e, value: boolean): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.showContainerPanel.key, value);\n    },\n    /** Clears whether the container panel should be shown for an actor. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.showContainerPanel.key);\n    },\n  };\n\n  /**\n   * Indicates whether the group member tab info panel should be shown for a given Group Sheet.\n   */\n  static showGroupMemberTabInfoPanel = {\n    key: 'showGroupMemberTabInfoPanel' as const,\n    prop: TidyFlags.getFlagPropertyPath('showGroupMemberTabInfoPanel'),\n    /** Gets whether the group member tab info panel should be shown for a group. */\n    get(actor: Actor5e): boolean {\n      return (\n        TidyFlags.tryGetFlag<boolean>(\n          actor,\n          TidyFlags.showGroupMemberTabInfoPanel.key\n        ) ?? false\n      );\n    },\n    /** Sets whether the group member tab info panel should be shown for a group. */\n    set(actor: Actor5e, value: boolean): Promise<void> {\n      return TidyFlags.setFlag(\n        actor,\n        TidyFlags.showGroupMemberTabInfoPanel.key,\n        value\n      );\n    },\n    /** Clears whether the group member tab info panel should be shown for a group. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(\n        actor,\n        TidyFlags.showGroupMemberTabInfoPanel.key\n      );\n    },\n  };\n\n  /**\n   * Indicates whether the additional personality info should be shown\n   * for a given NPC on the biography tab.\n   */\n  static showNpcPersonalityInfo = {\n    key: 'showNpcPersonalityInfo' as const,\n    prop: TidyFlags.getFlagPropertyPath('showNpcPersonalityInfo'),\n    /** Gets whether the additional personality info should be shown for an NPC. */\n    get(actor: Actor5e): boolean | undefined {\n      return (\n        TidyFlags.tryGetFlag<boolean>(\n          actor,\n          TidyFlags.showNpcPersonalityInfo.key\n        ) ?? undefined\n      );\n    },\n    /** Sets whether the additional personality info should be shown for an NPC. */\n    set(actor: Actor5e, value: boolean): Promise<void> {\n      return TidyFlags.setFlag(\n        actor,\n        TidyFlags.showNpcPersonalityInfo.key,\n        value\n      );\n    },\n    /** Clears whether the additional personality info should be shown for an NPC. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.showNpcPersonalityInfo.key);\n    },\n  };\n\n  /**\n   * Indicates whether the skills section should be expanded for a given actor.\n   * If this is set to `true`, all skills are shown.\n   * If this is set to `false`, unproficient skills are hidden and the rest are shown.\n   */\n  static skillsExpanded = {\n    key: 'skillsExpanded' as const,\n    prop: TidyFlags.getFlagPropertyPath('skillsExpanded'),\n    /** Gets whether the skills section should be expanded for an actor. */\n    get(actor: Actor5e): boolean | undefined {\n      return (\n        TidyFlags.tryGetFlag<boolean>(actor, TidyFlags.skillsExpanded.key) ??\n        undefined\n      );\n    },\n    /** Sets whether the skills section should be expanded for an actor. */\n    set(actor: Actor5e, value: boolean): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.skillsExpanded.key, value);\n    },\n    /** Clears whether the skills section should be expanded for an actor. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.skillsExpanded.key);\n    },\n  };\n\n  /**\n   * The skin of an actor.\n   * This is informational and not used for game logic.\n   */\n  static skin = {\n    key: 'skin' as const,\n    prop: TidyFlags.getFlagPropertyPath('skin'),\n    /** Gets the skin of an actor. */\n    get(actor: Actor5e): string | undefined {\n      return (\n        TidyFlags.tryGetFlag<string>(actor, TidyFlags.skin.key) ?? undefined\n      );\n    },\n    /** Sets the skin of an actor. */\n    set(actor: Actor5e, value: string): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.skin.key, value);\n    },\n    /** Clears the skin of an actor. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.skin.key);\n    },\n  };\n\n  /**\n   * Denotes whether to show a grid for a given spellbook screen.\n   */\n  static spellbookGrid = {\n    key: 'spellbook-grid',\n    prop: TidyFlags.getFlagPropertyPath('spellbook-grid'),\n    /** Gets whether to show a grid for a given spellbook screen. */\n    get(document: any): boolean {\n      return (\n        TidyFlags.tryGetFlag<boolean>(document, TidyFlags.spellbookGrid.key) ===\n        true\n      );\n    },\n    /** Sets whether to show a grid for a given spellbook screen. */\n    set(document: any) {\n      return TidyFlags.setFlag(document, TidyFlags.spellbookGrid.key, true);\n    },\n    /** Clears whether to show a grid for a given spellbook screen. */\n    unset(document: any) {\n      return TidyFlags.unsetFlag(document, TidyFlags.spellbookGrid.key);\n    },\n  };\n\n  /**\n   * The trait of an actor.\n   * This is informational and not used for game logic.\n   */\n  static trait = {\n    key: 'trait' as const,\n    prop: TidyFlags.getFlagPropertyPath('trait'),\n    /** Gets the trait of an actor. */\n    get(actor: Actor5e): string | undefined {\n      return (\n        TidyFlags.tryGetFlag<string>(actor, TidyFlags.trait.key) ?? undefined\n      );\n    },\n    /** Sets the trait of an actor. */\n    set(actor: Actor5e, value: string): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.trait.key, value);\n    },\n    /** Clears the trait of an actor. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.trait.key);\n    },\n  };\n\n  /**\n   * The weight of an actor.\n   * For this module, it is only an informational biographical field.\n   */\n  static weight = {\n    key: 'weight' as const,\n    prop: TidyFlags.getFlagPropertyPath('weight'),\n    /** Gets the weight of an actor. */\n    get(actor: Actor5e): string | undefined {\n      return (\n        TidyFlags.tryGetFlag<string>(actor, TidyFlags.weight.key) ?? undefined\n      );\n    },\n    /** Sets the weight of an actor. */\n    set(actor: Actor5e, value: string): Promise<void> {\n      return TidyFlags.setFlag(actor, TidyFlags.weight.key, value);\n    },\n    /** Clears the weight of an actor. */\n    unset(actor: Actor5e) {\n      return TidyFlags.unsetFlag(actor, TidyFlags.weight.key);\n    },\n  };\n\n  /**\n   * Attempts to get a flag from a document.\n   * @param flagged A document which supports flags.\n   * @param flagName The name of the flag to get.\n   * @returns The flag's value, or `undefined` if the flag is not set.\n   *\n   * @remarks\n   * This function is generic, but it is not performing parsing of the flag's value.\n   * It is simply doing an optimistic cast to the target type.\n   */\n  static tryGetFlag<T>(flagged: any, flagName: string) {\n    return flagged.getFlag(CONSTANTS.MODULE_ID, flagName) as\n      | T\n      | null\n      | undefined;\n  }\n\n  /**\n   * Sets a flag on a document.\n   * @param flagged A document to set the flag on.\n   * @param flagName The name of the flag to set.\n   * @param value The value to set the flag to.\n   * @returns A promise that resolves when the flag is set.\n   */\n  static setFlag(\n    flagged: any,\n    flagName: string,\n    value: unknown\n  ): Promise<void> {\n    return flagged.setFlag(CONSTANTS.MODULE_ID, flagName, value);\n  }\n\n  /**\n   * Clears a flag from a document.\n   * @param flagged A document to clear the flag from.\n   * @param flagName The name of the flag to clear.\n   * @returns A promise that resolves when the flag is cleared.\n   */\n  static unsetFlag(flagged: any, flagName: string): Promise<void> {\n    return flagged.unsetFlag(CONSTANTS.MODULE_ID, flagName);\n  }\n}\n","import type { Item5e } from 'src/types/item.types';\nimport { debug, error, warn } from './logging';\nimport type {\n  Actor5e,\n  MaxPreparedSpellFormula,\n  SpellCalculations,\n} from 'src/types/types';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { isNil } from './data';\nimport type {\n  BasicRollConfiguration,\n  BasicRollDialogConfiguration,\n  BasicRollMessageConfiguration,\n  BasicRollProcessConfiguration,\n} from 'src/foundry/foundry.types';\nimport { TidyFlags } from 'src/foundry/TidyFlags';\nimport { coalesce } from './formatting';\nimport { CONSTANTS } from 'src/constants';\n\nexport function scaleCantripDamageFormula(spell: Item5e, formula: string) {\n  try {\n    const scaledFormula = spell._scaleCantripDamage(\n      [formula],\n      spell.system.scaling.formula,\n      spell.actor.type === 'character'\n        ? spell.actor.system.details.level ?? 0\n        : spell.system.preparation.mode === 'innate'\n        ? Math.ceil(spell.actor.system.details.cr ?? 0)\n        : spell.actor.system.details.spellLevel ?? 0,\n      spell.getRollData()\n    );\n\n    return scaledFormula;\n  } catch (e) {\n    error(\n      'An error occurred while scaling cantrip damage. Returning original formula.',\n      false,\n      e\n    );\n    return formula;\n  }\n}\n\nexport function simplifyFormula(\n  formula: string,\n  removeFlavor: boolean = false\n): string {\n  try {\n    if (removeFlavor) {\n      formula = formula\n        ?.replace(foundry.dice.terms.RollTerm.FLAVOR_REGEXP, '')\n        ?.replace(foundry.dice.terms.RollTerm.FLAVOR_REGEXP_STRING, '')\n        ?.trim();\n    }\n\n    if (formula?.trim() === '') {\n      return '';\n    }\n\n    const roll = Roll.create(formula);\n\n    const simplifiedTerms = roll.terms.map((t: any) =>\n      t.isIntermediate\n        ? new foundry.dice.terms.NumericTerm({\n            number: t.evaluate({ allowInteractive: false }).total,\n            options: t.options,\n          })\n        : t\n    );\n\n    let simplifiedFormula = Roll.fromTerms(simplifiedTerms).formula;\n\n    return simplifiedFormula;\n  } catch (e) {\n    error('Unable to simplify formula due to an error.', false, e);\n    return formula;\n  }\n}\n\nexport function getMaxPreparedSpellsSampleFormulas(): MaxPreparedSpellFormula[] {\n  return [\n    {\n      label: 'TIDY5E.Class.Artificer',\n      value: '@abilities.int.mod + floor(@classes.artificer.levels / 2)',\n    },\n    {\n      label: 'TIDY5E.Class.Bard',\n      value:\n        'max(@classes.bard.levels + 3 - floor(@classes.bard.levels/20), (min(floor(@classes.bard.levels/10),1) * (14 + min(floor(@classes.bard.levels/11),1) + min(floor(@classes.bard.levels/13),1) + (min(floor(@classes.bard.levels/14),1) * 2) + min(floor(@classes.bard.levels/15),1) + min(floor(@classes.bard.levels/17),1) + (min(floor(@classes.bard.levels/18),1) * 2))))',\n    },\n    {\n      label: 'TIDY5E.Class.Cleric',\n      value: '@abilities.wis.mod + @classes.cleric.levels',\n    },\n    {\n      label: 'TIDY5E.Class.Druid',\n      value: '@abilities.wis.mod + @classes.druid.levels',\n    },\n    {\n      label: 'TIDY5E.Class.Paladin',\n      value: '@abilities.cha.mod + floor(@classes.paladin.levels / 2)',\n    },\n    { label: 'TIDY5E.Class.Ranger', value: 'ceil(@classes.ranger.levels/2)+1' },\n    {\n      label: 'TIDY5E.Class.Sorcerer',\n      value:\n        'min(@classes.sorcerer.levels + 1, 12 + min(floor(@classes.sorcerer.levels/13),1) + min(floor(@classes.sorcerer.levels/15),1) + min(floor(@classes.sorcerer.levels/17),1))',\n    },\n    {\n      label: 'TIDY5E.Class.Wizard',\n      value: '@abilities.int.mod + @classes.wizard.levels',\n    },\n  ];\n}\n\nexport function calculateSpellAttackAndDc(\n  actor: Actor5e,\n  spellClass: Item5e\n): SpellCalculations {\n  try {\n    const rollData = actor.getRollData();\n\n    const prof = actor.system.attributes.prof ?? 0;\n    const spellAbility = coalesce(\n      spellClass?.system?.spellcasting?.ability,\n      actor.system.attributes.spellcasting\n    );\n    const abilityMod =\n      (spellAbility != ''\n        ? actor.system.abilities[spellAbility].mod\n        : actor.system.attributes.spellmod) ?? 0;\n    const spellAttackMod = prof + abilityMod;\n\n    const rawRsak = Roll.replaceFormulaData(\n      actor.system.bonuses.rsak.attack,\n      rollData,\n      { missing: 0, warn: false }\n    );\n\n    const rsakBonusTotal = calculateDeterministicBonus(rawRsak);\n\n    let rsakTotal = (spellAttackMod + rsakBonusTotal).toString();\n\n    if (!rsakTotal.startsWith('-')) {\n      rsakTotal = '+' + rsakTotal;\n    }\n\n    let rawMsak = Roll.replaceFormulaData(\n      actor.system.bonuses.msak.attack,\n      rollData,\n      { missing: 0, warn: false }\n    );\n\n    let msakBonusTotal = calculateDeterministicBonus(rawMsak);\n\n    let msakTotal = (spellAttackMod + msakBonusTotal).toString();\n\n    if (!msakTotal.startsWith('-')) {\n      msakTotal = '+' + msakTotal;\n    }\n\n    const abilityName =\n      CONFIG.DND5E.abilities[\n        spellAbility as keyof typeof CONFIG.DND5E.abilities\n      ]?.label ?? FoundryAdapter.localize('DND5E.None');\n\n    return {\n      dc:\n        spellClass?.system.spellcasting.progression !==\n        CONSTANTS.SPELLCASTING_PROGRESSION_NONE\n          ? spellClass?.system.spellcasting.save\n          : actor.system.attributes.spelldc,\n      dcTooltip: getDcTooltip(actor, spellAbility),\n      meleeMod: msakTotal,\n      meleeTooltip: buildAttackModTooltip(\n        abilityName,\n        abilityMod,\n        prof,\n        msakBonusTotal\n      ),\n      meleeHasBonus: msakBonusTotal !== 0,\n      rangedMod: rsakTotal,\n      rangedTooltip: buildAttackModTooltip(\n        abilityName,\n        abilityMod,\n        prof,\n        rsakBonusTotal\n      ),\n      rangedHasBonus: rsakBonusTotal !== 0,\n    };\n  } catch (e) {\n    error('An error occurred while calculating spell attack bonus', false, e);\n    debug('Spell attack bonus error troubleshooting details', {\n      bonuses: actor.system.bonuses,\n      actor: actor,\n    });\n\n    return {\n      dc: actor.system.attributes.spelldc,\n      dcTooltip: '',\n      meleeMod: '',\n      meleeTooltip: '',\n      meleeHasBonus: false,\n      rangedMod: '',\n      rangedTooltip: '',\n      rangedHasBonus: false,\n    };\n  }\n}\n\nfunction buildAttackModTooltip(\n  abilityName: string,\n  abilityMod: number,\n  proficiency: number,\n  bonusTotal: number\n) {\n  let tooltip = '';\n  if (abilityMod !== 0) {\n    tooltip += abilityMod < 0 ? ' - ' : ' + ';\n    tooltip += `${Math.abs(abilityMod)} (${abilityName})`;\n  }\n\n  if (proficiency !== 0) {\n    tooltip += proficiency < 0 ? ' - ' : ' + ';\n    tooltip += `${Math.abs(proficiency)} (${FoundryAdapter.localize(\n      'DND5E.ProficiencyBonus'\n    )})`;\n  }\n\n  if (bonusTotal !== 0) {\n    tooltip += bonusTotal < 0 ? ' - ' : ' + ';\n    tooltip += `${Math.abs(bonusTotal)} (${FoundryAdapter.localize(\n      'DND5E.Bonus'\n    )})`;\n  }\n\n  return tooltip.trim();\n}\n\nfunction calculateDeterministicBonus(rawBonus: string): number {\n  if (!Roll.validate(rawBonus)) {\n    return 0;\n  }\n\n  const deterministicRawBonus = new Roll(rawBonus).terms.filter(\n    (t: any) => t.isDeterministic\n  );\n\n  // `Roll.fromTerms` doesn't allow an empty array since it expects a sequence\n  // of tokens that it can parse into a syntax tree. Therefore, we need to be\n  // careful about what we pass into it.\n  //\n  // TODO: To correctly prune non-deterministic terms from the formula, we need\n  // to invoke the RollParser and prune elements from the syntax tree.\n  //\n  // This `if` statement handles the most common failure case, wherein the whole\n  // formula is non-deterministic, but it's just a temporary band-aid; the real\n  // fix will be considerably more complicated to implement.\n  //\n  // Currently, an expression like `1 + 1d4 * 2` would prune the `1d4` and\n  // attempt to roll `1 + * 2`, causing an error. The try/catch block below\n  // anticipates that possibility and logs it as a warning since it's a known\n  // issue, but it should ideally be replaced with a more rigorous fix.\n  if (deterministicRawBonus.length == 0) {\n    return 0;\n  }\n\n  let bonusRoll = Roll.fromTerms([new foundry.dice.terms.NumericTerm(0)]);\n  try {\n    bonusRoll = Roll.fromTerms(deterministicRawBonus);\n\n    let bonusTotal = 0;\n    if (Roll.validate(bonusRoll.formula)) {\n      bonusTotal = bonusRoll.evaluateSync({ allowInteractive: false }).total;\n    }\n    return bonusTotal;\n  } catch (e: any) {\n    warn(e.toString());\n    return 0;\n  }\n}\n\nexport function getDcTooltip(actor: Actor5e, spellAbility: string) {\n  const base = 8;\n\n  const abilityMod =\n    (spellAbility != '' ? actor.system.abilities[spellAbility].mod : 0) ?? 0;\n  const abilityName =\n    CONFIG.DND5E.abilities[spellAbility as keyof typeof CONFIG.DND5E.abilities]\n      ?.label ?? FoundryAdapter.localize('DND5E.None');\n  const prof = actor.system.attributes.prof ?? 0;\n\n  let tooltip = base.toString();\n\n  if (abilityMod !== 0) {\n    tooltip += abilityMod < 0 ? ' - ' : ' + ';\n    tooltip += `${Math.abs(abilityMod)} (${abilityName})`;\n  }\n\n  if (prof !== 0) {\n    tooltip += prof < 0 ? ' - ' : ' + ';\n    tooltip += `${Math.abs(prof)} (${FoundryAdapter.localize(\n      'DND5E.ProficiencyBonus'\n    )})`;\n  }\n\n  const rawBonus = actor.system.bonuses.spell.dc?.toString()?.trim();\n  if (!isNil(rawBonus, '') && Roll.validate(rawBonus)) {\n    const bonusRoll = new Roll(rawBonus);\n    bonusRoll.evaluateSync({ allowInteractive: false });\n    const bonusTotal = bonusRoll.total;\n\n    if (bonusTotal !== 0) {\n      tooltip += bonusTotal < 0 ? ' - ' : ' + ';\n      tooltip += `${Math.abs(bonusTotal)} (${FoundryAdapter.localize(\n        'DND5E.Bonus'\n      )})`;\n    }\n  }\n\n  return tooltip;\n}\n\ntype RawSpellAttackType = 'rsak' | 'msak';\n\nexport async function rollRawSpellAttack(\n  ev: MouseEvent,\n  actor: Actor5e,\n  attackType?: RawSpellAttackType,\n  spellcastingAbility?: string\n) {\n  const rollConfig: BasicRollProcessConfiguration = {\n    evaluate: true,\n    event: ev,\n    hookNames: ['rawSpellAttack', 'd20Test'],\n    rolls: [getSpellAttackRoll(actor, attackType, spellcastingAbility)],\n    subject: actor,\n  };\n\n  let flavorKey =\n    attackType === 'rsak'\n      ? 'TIDY5E.ActorRangedSpellAttackFlavorText'\n      : attackType === 'msak'\n      ? 'TIDY5E.ActorMeleeSpellAttackFlavorText'\n      : 'TIDY5E.ActorSpellAttackFlavorText';\n\n  let flavor = FoundryAdapter.localize(flavorKey);\n\n  const messageConfig: BasicRollMessageConfiguration = {\n    rollMode: game.settings.get('core', 'rollMode'),\n    data: {\n      'flags.dnd5e.roll': {\n        type: 'attack',\n      },\n      speaker: ChatMessage.getSpeaker({ actor: actor }),\n      flavor,\n    },\n  };\n\n  let titleKey =\n    attackType === 'rsak'\n      ? 'TIDY5E.ActorRangedSpellAttackTitle'\n      : attackType === 'msak'\n      ? 'TIDY5E.ActorMeleeSpellAttackTitle'\n      : 'TIDY5E.ActorSpellAttackTitle';\n\n  let title = FoundryAdapter.localize(titleKey, {\n    actorName: actor.name,\n  });\n\n  const dialog: BasicRollDialogConfiguration = {\n    options: { title },\n  };\n\n  const rolls = await CONFIG.Dice.D20Roll.build(\n    rollConfig,\n    dialog,\n    messageConfig\n  );\n\n  debug(rolls);\n}\n\nfunction getSpellAttackRoll(\n  actor: any,\n  attackType: string | undefined,\n  spellcastingAbility: string | undefined\n): BasicRollConfiguration {\n  const effectiveAttackType = attackType ?? 'rsak';\n\n  const rollData: Record<string, any> = {};\n\n  const parts: string[] = [];\n\n  // Ability score modifier\n  const filteredClass = TidyFlags.classFilter.get(actor);\n\n  spellcastingAbility ??= actor.itemTypes.class.find(\n    (x: Item5e) => x.system.identifier === filteredClass\n  )?.system.spellcasting?.ability;\n\n  const spellcastingMod = actor.system.abilities[spellcastingAbility!]?.mod;\n\n  if (spellcastingAbility !== 'none' && spellcastingMod) {\n    parts.push('@mod');\n    rollData.mod = spellcastingMod;\n  }\n\n  // Add proficiency bonus.\n  parts.push('@prof');\n  rollData.prof = actor.system.attributes.prof;\n\n  // Actor-level global bonus to attack rolls\n  const actorBonusAttack = actor.system.bonuses?.[effectiveAttackType]?.attack;\n  if (actorBonusAttack) {\n    parts.push(actorBonusAttack);\n  }\n\n  return {\n    parts,\n    data: rollData,\n    options: {\n      elvenAccuracy: actor.flags['dnd5e']?.elvenAccuracy ?? false,\n      halflingLucky: actor.flags['dnd5e']?.halflingLucky ?? false,\n    },\n    subject: actor,\n  };\n}\n","import type { Item5e } from 'src/types/item.types';\nimport type { SortMode } from 'src/types/types';\nimport { isNil } from './data';\n\nexport class ItemUtils {\n  static canUse(item: any): boolean {\n    return (\n      ItemUtils.hasActivationType(item) &&\n      (ItemUtils.hasUnlimitedUses(item) ||\n        ItemUtils.hasSufficientLimitedUses(item)) &&\n      (!ItemUtils.hasConsumptionRequirements(item) ||\n        ItemUtils.hasSufficientConsumptionAmount(item)) &&\n      (!item.hasRecharge || !item.isOnCooldown) &&\n      ItemUtils.atLeastOneExists(item)\n    );\n  }\n  static atLeastOneExists(item: any): boolean {\n    return (item.system.quantity ?? 1) >= 1;\n  }\n  static hasActivationType(item: any): boolean {\n    return !!item.system.activities?.size;\n  }\n  static hasSpecificActivationType(item: Item5e, type: string) {\n    return !!item.system.activities?.some(\n      (a: any) => a.activation.type === type\n    );\n  }\n  static hasUnlimitedUses(item: any): boolean {\n    return !item.system.hasLimitedUses;\n  }\n  static hasSufficientLimitedUses(item: any): any {\n    return ItemUtils.hasConfiguredUses(item) && item.system.uses?.value > 0;\n  }\n  static hasConfiguredUses(item: any) {\n    return item.system.hasLimitedUses && item.system.uses.recovery.length;\n  }\n  static hasConsumptionRequirements(item: any): boolean {\n    return !isNil(item.system.consume?.type, '');\n  }\n  static hasSufficientConsumptionAmount(item: any): boolean {\n    const consumeTarget = item.parent?.items?.get(item.system.consume.target);\n    return (\n      // If there's no consume target, then we'll be permissive and allow the system to deal with whether it's usable\n      // Note: this is intentionally ignoring non-item / non-item-use consumption scenarios like consuming attributes\n      isNil(item.system.consume?.target, '') ||\n      (consumeTarget?.system.quantity ??\n        consumeTarget?.system.uses?.value ??\n        0) >= item.system.consume?.amount\n    );\n  }\n  static getMaxUses(item: Item5e) {\n    return item.system.uses?.max;\n  }\n\n  static sortItems(items: Item5e[], sortMode: SortMode) {\n    if (sortMode === 'a') {\n      items.sort((a, b) => a.name.localeCompare(b.name, game.i18n.lang));\n    } else if (sortMode === 'm') {\n      items.sort((a, b) => (a.sort || 0) - (b.sort || 0));\n    }\n  }\n\n  static getSortedItems(items: Item5e[], sortMode: SortMode) {\n    if (sortMode === 'a') {\n      return items.toSorted((a, b) =>\n        a.name.localeCompare(b.name, game.i18n.lang)\n      );\n    } else if (sortMode === 'm') {\n      return items.toSorted((a, b) => (a.sort || 0) - (b.sort || 0));\n    }\n    return items;\n  }\n}\n","import { CONSTANTS } from 'src/constants';\n\n/** @category Constants */\nconst ApiConstants = {\n  TAB_ID_CHARACTER_ATTRIBUTES: CONSTANTS.TAB_CHARACTER_ATTRIBUTES,\n  TAB_ID_CHARACTER_INVENTORY: CONSTANTS.TAB_ACTOR_INVENTORY,\n  TAB_ID_CHARACTER_SPELLBOOK: CONSTANTS.TAB_ACTOR_SPELLBOOK,\n  TAB_ID_CHARACTER_FEATURES: CONSTANTS.TAB_CHARACTER_FEATURES,\n  TAB_ID_CHARACTER_EFFECTS: CONSTANTS.TAB_CHARACTER_EFFECTS,\n  TAB_ID_CHARACTER_BIOGRAPHY: CONSTANTS.TAB_CHARACTER_BIOGRAPHY,\n  TAB_ID_CHARACTER_JOURNAL: CONSTANTS.TAB_CHARACTER_JOURNAL,\n  TAB_ID_GROUP_MEMBERS: CONSTANTS.TAB_GROUP_MEMBERS,\n  TAB_ID_GROUP_INVENTORY: CONSTANTS.TAB_ACTOR_INVENTORY,\n  TAB_ID_GROUP_DESCRIPTION: CONSTANTS.TAB_GROUP_DESCRIPTION,\n  TAB_ID_NPC_ABILITIES: CONSTANTS.TAB_NPC_ABILITIES,\n  TAB_ID_NPC_SPELLBOOK: CONSTANTS.TAB_ACTOR_SPELLBOOK,\n  TAB_ID_NPC_EFFECTS: CONSTANTS.TAB_NPC_EFFECTS,\n  TAB_ID_NPC_BIOGRAPHY: CONSTANTS.TAB_NPC_BIOGRAPHY,\n  TAB_ID_NPC_JOURNAL: CONSTANTS.TAB_NPC_JOURNAL,\n  TAB_ID_VEHICLE_ATTRIBUTES: CONSTANTS.TAB_VEHICLE_ATTRIBUTES,\n  TAB_ID_VEHICLE_CARGO_AND_CREW: CONSTANTS.TAB_VEHICLE_CARGO_AND_CREW,\n  TAB_ID_VEHICLE_EFFECTS: CONSTANTS.TAB_VEHICLE_EFFECTS,\n  TAB_ID_VEHICLE_DESCRIPTION: CONSTANTS.TAB_VEHICLE_DESCRIPTION,\n  TAB_ID_ACTOR_ACTIONS: CONSTANTS.TAB_ACTOR_ACTIONS,\n  /** The attribute which indicates a particular part of a sheet. */\n  SHEET_PART_ATTRIBUTE: CONSTANTS.SHEET_PART_ATTRIBUTE,\n  /**\n   * Values used in conjunction with the attribute `api.constants.SHEET_PART_ATTRIBUTE` to identify a part of a Tidy 5e sheet.\n   *\n   * @example an element which is tagged with a sheet part value\n   * ```html\n   * <div class=\"actor-name\" data-tidy-sheet-part=\"name-container\">...</div>\n   * ```\n   *\n   * @example targeting a sheet part for content injection during Tidy render\n   * ```js\n   * // Every time Tidy renders, whether a full render or a partial\n   * Hooks.on(\"tidy5e-sheet.renderActorSheet\", (sheet, element, data) => {\n   *   const api = game.modules.get('tidy5e-sheet').api;\n   *   const selector = api.getSheetPartSelector(\n   *     api.constants.SHEET_PARTS.NAME_CONTAINER\n   *   );\n   *   // get the name container of the target actor sheet\n   *   element\n   *     .querySelector(selector)\n   *     // inject some HTML\n   *     ?.insertAdjacentHTML(\n   *       // put it as the first element inside the name container; see https://developer.mozilla.org/en-US/docs/Web/API/Element/insertAdjacentHTML#afterbegin\n   *       \"afterbegin\",\n   *       // here's my content\n   *       // pro tip: `data-tidy-render-scheme=\"handlebars\"` causes this content to re-render on every Tidy render, full or partial\n   *       `<div style=\"display: contents;\" data-tidy-render-scheme=\"handlebars\">\n   *           <h2 type=\"button\" style=\"width: 100%;\"><i class=\"fa-solid fa-star\"></i></h2>\n   *         </div>`\n   *     );\n   * });\n   * ```\n   *\n   * @remarks\n   * Tidy 5e Sheets are tagged with `data-tidy-sheet-part` attributes\n   * so that most parts of the sheet can be generally identified.\n   * This module uses specific attributes rather than classes because of\n   * HTML classes' multiple purposes, including use for CSS styling.\n   * Using sheet part attributes allows for identifying the same general thing\n   * even when considering a potentially alternate Tidy sheet layout.\n   */\n  SHEET_PARTS: CONSTANTS.SHEET_PARTS,\n};\n\nexport default ApiConstants;\n","import { ActionListRuntime } from 'src/runtime/action-list/ActionListRuntime';\n\n/**\n * API functionality related to the Actions List feature.\n * \n * @category Configuration\n */\nexport class ActionListApi {\n  /**\n   * Remap how activation types are treated when the Action List organizes items into sections.\n   * @param mappings an object with `key`s and `value`s representing a mapping from source activation type to intended target activation type.\n   * @example Treating Midi-QoL reaction sub-types like a reaction\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.config.actionList.mapActivationTypesToSections({\n   *     reactionpreattack: 'reaction',\n   *     reactiondamage: 'reaction',\n   *     reactionmanual: 'reaction',\n   *   });\n   * });\n   * ```\n   * @remarks\n   * In terms of UI, the `key` and `value` fields are the `value` attribute on the Activation Type dropdown, or the database value.\n   * \n   * Multiple calls to this API function merge the latest results in, resulting in last-come, last-server.\n   * If multiple modules remap the same activation type, the last caller's remapping will be the winner.\n   */\n  mapActivationTypesToSections(mappings: Record<string, string>) {\n    ActionListRuntime.addActivationTypeMappings(mappings);\n  }\n}\n","import { ActorItemRuntime } from 'src/runtime/ActorItemRuntime';\nimport type { ActorItemSectionFooterCommand } from '../../api.types';\n\n/**\n * API functionality related to Actor-owned items.\n * \n * @category Configuration\n */\nexport class ActorItemApi {\n  /**\n   * Registers actor item section commands which Tidy 5e can render at select locations on the sheet.\n   * @param commands actor item section commands for Tidy 5e to render\n   *\n   * @example Registering a command that sorts items\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.config.actorItem.registerSectionFooterCommands([\n   *     {\n   *       enabled: (params) =>\n   *         params.section.items?.length > 1 || params.section.spells?.length > 1,\n   *       iconClass: 'fa-solid fa-arrow-up-a-z',\n   *       tooltip: 'Sort by Name Ascending',\n   *       execute: async (params) => {\n   *         const actor = params.actor;\n   *         const itemsToSort = params.section.items ?? params.section.spells;\n   *         await actor.updateEmbeddedDocuments(\n   *           'Item',\n   *           [...itemsToSort]\n   *             .sort((a, b) => {\n   *               return a.name.localeCompare(b.name, game.i18n.lang);\n   *             })\n   *             .map((item, idx) => {\n   *               return { _id: item.id, sort: idx };\n   *             })\n   *         );\n   *       },\n   *     },\n   *   ]);\n   * });\n   * ```\n   */\n  registerSectionFooterCommands(commands: ActorItemSectionFooterCommand[]) {\n    ActorItemRuntime.registerActorItemSectionCommands(commands);\n  }\n}\n","import { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport type { Actor5e } from 'src/types/types';\nimport type {\n  RegisteredPortraitMenuCommand,\n  RegisteredPortraitMenuCommandExecuteParams,\n} from './types';\nimport { error } from 'src/utils/logging';\n\nexport class ActorPortraitRuntime {\n  private static _portraitMenuCommands: RegisteredPortraitMenuCommand[] = [\n    {\n      label: 'TIDY5E.ShowPortraitArt',\n      execute: (params: RegisteredPortraitMenuCommandExecuteParams) => {\n        FoundryAdapter.renderImagePopout(params.actor.img, {\n          title: FoundryAdapter.localize('TIDY5E.PortraitTitle', {\n            subject: params.actor.name,\n          }),\n          shareable: true,\n          uuid: params.actor.uuid,\n        });\n      },\n      iconClass: 'fa-solid fa-image fa-fw',\n    },\n    {\n      label: 'TIDY5E.ShowTokenArt',\n      execute: async (params: RegisteredPortraitMenuCommandExecuteParams) => {\n        // Typically, if this token is on the canvas, then this is the image we want to see.\n        let imageSrc = params.actor.token?.texture?.src;\n\n        if (!imageSrc) {\n          // Account for the possibility of wildcard tokens.\n          let images = (await params.actor.getTokenImages()) as string[];\n\n          imageSrc =\n            images.length > 1\n              ? // Grab a random wildcard token upon request... for chaos.\n                images[Math.floor(Math.random() * images.length)]\n              : images[0];\n        }\n\n        FoundryAdapter.renderImagePopout(imageSrc, {\n          title: FoundryAdapter.localize('TIDY5E.PortraitTitle', {\n            subject: params.actor.name,\n          }),\n          shareable: true,\n          uuid: params.actor.uuid,\n        });\n      },\n      iconClass: 'fa-regular fa-circle-user fa-fw',\n    },\n  ];\n\n  static registerMenuCommands(commands: RegisteredPortraitMenuCommand[]) {\n    ActorPortraitRuntime._portraitMenuCommands.push(...commands);\n  }\n\n  static getEnabledPortraitMenuCommands(actor: Actor5e) {\n    return ActorPortraitRuntime._portraitMenuCommands.filter((c) => {\n      try {\n        return c.enabled?.({ actor }) ?? true;\n      } catch (e) {\n        error(\n          'Failed to check if actor portrait menu command is enabled',\n          false,\n          { error: e, actor }\n        );\n        return false;\n      }\n    });\n  }\n}\n","import type { PortraitMenuCommand } from '../..';\nimport { ActorPortraitRuntime } from 'src/runtime/ActorPortraitRuntime';\n\n/**\n * API functionality related to Actor portraits.\n *\n * @category Configuration\n */\nexport class ActorPortraitApi {\n  /**\n   * Register actor portrait menu commands which Tidy 5e can render on the sheet when appropriate.\n   * @param commands actor portrait menu commands for Tidy 5e to render\n   *\n   * @example Registering a command\n   * ```js\n   * Hooks.once(\"tidy5e-sheet.ready\", (api) => {\n   *   api.config.actorPortrait.registerMenuCommands([\n   *     {\n   *       label: \"Test\",\n   *       iconClass: \"fa-solid fa-flask\",\n   *       tooltip: \"Click for test result\",\n   *       enabled: (params) => params.actor.type !== \"vehicle\",\n   *       execute: (params) => {\n   *         console.log(params);\n   *         ui.notifications.info(\n   *           \"Hello, Test Portrait Menu Command for \" + params.actor.name\n   *         );\n   *       },\n   *     },\n   *   ]);\n   * });\n   * ```\n   */\n  registerMenuCommands(commands: PortraitMenuCommand[]) {\n    ActorPortraitRuntime.registerMenuCommands([...commands]);\n  }\n}\n","import type { CustomActorTrait } from 'src/api/config/actor-traits/types';\nimport type { RegisteredCustomActorTrait } from '../types';\nimport { debug, error } from 'src/utils/logging';\n\nexport class CustomActorTraitsRuntime {\n  protected static _traits: RegisteredCustomActorTrait[] = [];\n\n  static registerCustomActorTraits(traits: CustomActorTrait[]) {\n    const registeredTraits = traits.map<RegisteredCustomActorTrait>((t) => ({\n      title: t.title,\n      iconClass: t.iconClass,\n      alwaysShow: t.alwaysShow,\n      openConfiguration: t.openConfiguration,\n      openConfigurationTooltip: t.openConfigurationTooltip,\n      enabled: t.enabled,\n    }));\n\n    CustomActorTraitsRuntime._traits.push(...registeredTraits);\n  }\n\n  static getEnabledTraits(context: any) {\n    return this._traits.filter((t) => {\n      try {\n        return t.enabled?.({ context }) ?? true;\n      } catch (e) {\n        error(\n          'An error occurred while determining if a custom actor trait is enabled.',\n          false,\n          e\n        );\n        debug('Custom actor trait enabled error details', {\n          context,\n          trait: t,\n        });\n        return false;\n      }\n    });\n  }\n}\n","import { CustomActorTraitsRuntime } from 'src/runtime/actor-traits/CustomActorTraitsRuntime';\nimport type { CustomActorTrait } from './types';\n\n/**\n * API functionality related to the Actor Traits section (languages, senses, tools, etc.) of the actor sheet.\n */\n/** @category Configuration */\nexport class ActorTraitsApi {\n  /**\n   * Registers multiple custom traits to the actor traits section of the actor sheet.\n   * @param traits traits to register\n   *\n   * @example Registering vehicle traits\n   * ```js\n   * Hooks.once(\"tidy5e-sheet.ready\", (api) => {\n   *   api.config.actorTraits.registerActorTraits([\n   *     {\n   *       title: \"Vehicle Customization Options\",\n   *       iconClass: \"fa-solid fa-ferry\",\n   *       enabled: (params) => params.context.actor.type === \"vehicle\",\n   *       openConfiguration: (params) => {\n   *         // TODO: Open totally awesome config dialog for setting custom vehicle stuff.\n   *       },\n   *       openConfigurationTooltip: \"Click to customize!\",\n   *     },\n   *     {\n   *       title: \"Vehicle Tribble Manager\",\n   *       iconClass: \"fa-solid fa-ghost\",\n   *       enabled: (params) => params.context.actor.type === \"vehicle\",\n   *       openConfiguration: (params) => {\n   *         // TODO: Open a hopeless manager dialog for dealing with a tribble infestation.\n   *       },\n   *       openConfigurationTooltip: \"Click to manage the unmanageable tribble problem \",\n   *       alwaysShow: true,\n   *     },\n   *   ]);\n   * });\n   * ```\n   */\n  registerActorTraits(traits: CustomActorTrait[]) {\n    CustomActorTraitsRuntime.registerCustomActorTraits(traits);\n  }\n\n  /**\n   * Registers a custom actor trait to the actor traits section of the actor sheet.\n   * @param trait the trait to register\n   *\n   * @example Registering an actor trait\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.config.actorTraits.registerActorTrait({\n   *     title: \"Configure My Module\",\n   *     iconClass: \"fa-solid fa-spaghetti-monster-flying\",\n   *     enabled: (params) =>\n   *       [\"character\", \"npc\"].includes(params.context.actor.type),\n   *     openConfiguration: (params) => {\n   *       // TODO: For example, open another form to input some data.\n   *     },\n   *     openConfigurationTooltip: \"Click to configure my module\",\n   *   });\n   * });\n   * ```\n   *\n   * @remarks\n   * The actor traits section is a good place to put a configuration button for opening another dialog for a custom module.\n   */\n  registerActorTrait(trait: CustomActorTrait) {\n    this.registerActorTraits([trait]);\n  }\n}\n","import type { SupportedSpellSchoolIcon } from 'src/api/config/spell-school/spell-school.types';\nimport { settings } from 'src/settings/settings.svelte';\n\nexport class SpellSchool {\n  protected static _iconsMap: Record<string, SupportedSpellSchoolIcon> = {\n    abj: 'ra ra-shield',\n    con: 'ra ra-tentacle',\n    div: 'ra ra-crystal-ball',\n    enc: 'ra ra-aware',\n    evo: 'ra ra-burning-meteor',\n    ill: 'ra ra-bleeding-eye',\n    nec: 'ra ra-skull',\n    trs: 'ra ra-cycle',\n  };\n\n  static fallbackIcon = 'fas fa-hat-wizard';\n\n  static getIcon(schoolKey: string): SupportedSpellSchoolIcon {\n    if (settings.value.useTidySpellSchoolIcons) {\n      return SpellSchool._iconsMap[schoolKey] ?? SpellSchool.fallbackIcon;\n    }\n\n    const dnd5eConfigIcon =\n      CONFIG.DND5E.spellSchools[\n        schoolKey as keyof typeof CONFIG.DND5E.spellSchools\n      ]?.icon;\n\n    if (dnd5eConfigIcon) {\n      return {\n        iconSrc: dnd5eConfigIcon,\n      };\n    }\n\n    return SpellSchool.fallbackIcon;\n  }\n\n  static setIcon(schoolKey: string, iconClass: SupportedSpellSchoolIcon) {\n    SpellSchool._iconsMap[schoolKey] = iconClass;\n  }\n}\n","import { SpellSchool } from 'src/features/spell-school/SpellSchool';\nimport type { SupportedSpellSchoolIcon } from './spell-school.types';\n\n/**\n * Allows for configuration related to Spell Schools.\n * Currently, [FontAwesome](https://fontawesome.com/) and [RPG Awesome](https://nagoshiashumari.github.io/Rpg-Awesome/) icons are officially supported.\n *\n * @category Configuration\n */\nexport class SpellSchoolApi {\n  /**\n   * Sets an icon class for a target school key.\n   * @param schoolKey the key that represents a spell school, e.g. \"abj\" for Abjuration, \"nec\" for Necromancy, and \"trs\" for Transmutation\n   * @param iconClass a class string for an `<i>` element\n   *\n   * @example Changing the transmutation icon to some nice coins.\n   * ```js\n   * Hooks.once(\"tidy5e-sheet.ready\", (api) => {\n   *   api.config.spellSchool.setIcon('trs', 'fa-solid fa-coins');\n   * });\n   * ```\n   */\n  setIcon(schoolKey: string, iconClass: SupportedSpellSchoolIcon) {\n    SpellSchool.setIcon(schoolKey, iconClass);\n  }\n}\n","import { ItemSummaryRuntime } from 'src/runtime/ItemSummaryRuntime';\nimport type { ItemSummaryCommand } from '../../api.types';\n\n/**\n * API functionality related to the Item Summary.\n *\n * @remarks\n * The item summary makes multiple appearances in Tidy 5e Sheets.\n * Particularly, it shows up when expanding an item table row or when\n * flying out an item info card.\n * \n * @category Configuration\n */\nexport class ItemSummaryApi {\n  /**\n   * Registers item summary commands which Tidy 5e can render at select locations on the sheet.\n   * @param commands item summary commands for Tidy 5e to render\n   *\n   * @example Registering commands that show for specific actor types\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.config.itemSummary.registerCommands([\n   *     {\n   *       label: 'Character Button',\n   *       enabled: (params) => params.item.actor?.type === 'character',\n   *       iconClass: 'fas fa-dice-d20',\n   *       execute: (params) => {\n   *         console.log('Clicked Character button', params.item);\n   *       },\n   *     },\n   *     {\n   *       label: 'NPC Button',\n   *       enabled: (params) => params.item.actor?.type === 'npc',\n   *       execute: (params) => {\n   *         console.log('Clicked NPC button', params.item);\n   *       },\n   *     },\n   *     {\n   *       label: 'Vehicle Button',\n   *       enabled: (params) => params.item.actor?.type === 'vehicle',\n   *       execute: (params) => {\n   *         console.log('Clicked Vehicle button', params.item);\n   *       },\n   *     },\n   *   ]);\n   * });\n   * ```\n   *\n   * @example Displaying a button for versatile weapons only\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.config.itemSummary.registerCommands([\n   *     {\n   *       label: 'Versatile Weapon Button',\n   *       enabled: (params) =>\n   *         params.item.type === 'weapon' &&\n   *         params.item.system?.properties?.has('ver') &&\n   *         params.item.system?.damage?.versatile,\n   *       iconClass: 'fa-solid fa-hands-praying',\n   *       execute: (params) => {\n   *         console.log('Do something versatile', params.item);\n   *       },\n   *     },\n   *   ]);\n   * });\n   * ```\n   */\n  registerCommands(commands: ItemSummaryCommand[] = []) {\n    ItemSummaryRuntime.registerItemSummaryCommands(commands);\n  }\n}\n","import { settings, SettingsProvider } from 'src/settings/settings.svelte';\nimport type { UseSpecificLevelExhaustionParams } from '../../api.types';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport type {\n  OpenExhaustionConfig,\n  SpecificExhaustionConfig,\n} from 'src/features/exhaustion/exhaustion.types';\n\n/**\n * API functionality related to the Exhaustion feature.\n *\n * @category Configuration\n */\nexport class ExhaustionApi {\n  /**\n   * Configures exhaustion to use an open number field,\n   * rather than a constrained set of levels.\n   *\n   * @example\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', async (api) => {\n   *   await api.config.exhaustion.useOpenNumberExhaustion();\n   * });\n   * ```\n   */\n  async useOpenNumberExhaustion(): Promise<void> {\n    const config: OpenExhaustionConfig = {\n      type: 'open',\n    };\n    await FoundryAdapter.setTidySetting('exhaustionConfig', config);\n  }\n\n  /**\n   * Configures exhaustion to use a constrained set of levels\n   * with optional hints (usually rendered as tooltips).\n   * @param params information needed to configure specific-level exhaustion\n   *\n   * @example Setting 3-level exhaustion\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', async (api) => {\n   *   await api.config.exhaustion.useSpecificLevelExhaustion({\n   *     totalLevels: 3,\n   *     hints: [\n   *       'No exhaustion',\n   *       'You are kind of tired',\n   *       'You look unwell',\n   *       'Dead ',\n   *     ],\n   *   });\n   * });\n   * ```\n   */\n  async useSpecificLevelExhaustion(\n    params?: UseSpecificLevelExhaustionParams\n  ): Promise<void> {\n    const exhaustion = settings.value.exhaustionConfig;\n\n    const fallbackHints =\n      exhaustion.type === 'specific' ? exhaustion.hints : [];\n\n    const config: SpecificExhaustionConfig = {\n      type: 'specific',\n      hints: params?.hints ?? fallbackHints,\n      levels: Math.max(params?.totalLevels ?? 1, 1),\n    };\n\n    await FoundryAdapter.setTidySetting('exhaustionConfig', config);\n  }\n\n  /**\n   * Configures vehicle exhaustion to use an open number field,\n   * rather than a constrained set of levels.\n   *\n   * @example\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', async (api) => {\n   *   await api.config.exhaustion.useOpenNumberVehicleExhaustion();\n   * });\n   * ```\n   */\n  async useOpenNumberVehicleExhaustion(): Promise<void> {\n    const config: OpenExhaustionConfig = {\n      type: 'open',\n    };\n    await FoundryAdapter.setTidySetting('vehicleExhaustionConfig', config);\n  }\n\n  /**\n   * Configures vehicle exhaustion to use a constrained set of levels\n   * with optional hints (usually rendered as tooltips).\n   * @param params information needed to configure specific-level vehicle exhaustion\n   *\n   * @example Setting 3-level vehicle exhaustion\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', async (api) => {\n   *   await api.config.exhaustion.useSpecificLevelVehicleExhaustion({\n   *     totalLevels: 3,\n   *     hints: ['Ship shape', 'A shape', \"Uh oh, it's falling apart\", 'Borked'],\n   *   });\n   * });\n   * ```\n   */\n  async useSpecificLevelVehicleExhaustion(\n    params?: UseSpecificLevelExhaustionParams\n  ): Promise<void> {\n    const exhaustion = settings.value.vehicleExhaustionConfig;\n\n    const fallbackHints =\n      exhaustion.type === 'specific' ? exhaustion.hints : [];\n\n    const config: SpecificExhaustionConfig = {\n      type: 'specific',\n      hints: params?.hints ?? fallbackHints,\n      levels: Math.max(params?.totalLevels ?? 1, 1),\n    };\n    await FoundryAdapter.setTidySetting('vehicleExhaustionConfig', config);\n  }\n}\n","import { CONSTANTS } from 'src/constants';\nimport type { ContextMenuPositionInfo } from './context-menu.types';\nimport { TidyHooks } from 'src/foundry/TidyHooks';\n\n/**\n * A specialized subclass of ContextMenu that places the menu in a fixed position.\n * @extends {ContextMenu}\n */\nexport default class FloatingContextMenu extends ContextMenu {\n  constructor(...args: any[]) {\n    super(...args);\n  }\n\n  /** @override */\n  _setPosition([html]: [html: HTMLElement], [target]: [target: HTMLElement]) {\n    const positionInfo: ContextMenuPositionInfo = {\n      insertTarget: document.body,\n      html: html,\n      target: target,\n    };\n\n    if (\n      !TidyHooks.tidy5eSheetsPrepareFloatingContextMenuPosition(positionInfo)\n    ) {\n      return;\n    }\n\n    positionInfo.insertTarget.appendChild(html);\n    const { clientWidth, clientHeight } = positionInfo.insertTarget;\n    const { width, height } = html.getBoundingClientRect();\n\n    const { clientX, clientY } = window.event as MouseEvent;\n    const left = Math.min(clientX + 1, clientWidth - width);\n    this._expandUp = clientY + height > clientHeight;\n    html.classList.add('floating');\n    html.classList.add('tidy5e-sheet');\n    html.classList.toggle('expand-up', this._expandUp);\n    html.classList.toggle('expand-down', !this._expandUp);\n    html.style.visibility = '';\n    html.style.left = `${left}px`;\n    if (this._expandUp) html.style.bottom = `${clientHeight - clientY}px`;\n    else html.style.top = `${clientY}px`;\n    target.classList.add('context');\n  }\n}\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { Item5e } from 'src/types/item.types';\n  import type { ContextMenuEntry } from 'src/foundry/foundry.types';\n  import FloatingContextMenu from 'src/context-menu/FloatingContextMenu';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  const localize = FoundryAdapter.localize;\n\n  function openItemImagePicker(target: HTMLImageElement, item: Item5e) {\n    const rect = target.getBoundingClientRect();\n    const current = item.img;\n    return FoundryAdapter.browseFilePicker({\n      type: 'image',\n      current,\n      callback: (path: string) => {\n        item.update({ img: path });\n      },\n      top: rect.top + 40,\n      left: rect.left + 10,\n    });\n  }\n\n  function showItemArt(item: Item5e) {\n    FoundryAdapter.renderImagePopout(item.img, {\n      title: FoundryAdapter.localize('TIDY5E.ItemImageTitle', {\n        subject: item.name,\n      }),\n      shareable: true,\n      uuid: item.uuid,\n    });\n  }\n\n  let itemImageContainer: HTMLElement;\n  let contextMenuOptions: ContextMenuEntry[] = $derived([\n    {\n      name: 'TIDY5E.ShowItemArt',\n      icon: '<i class=\"fa-solid fa-image fa-fw\"></i>',\n      callback: () => showItemArt(context.item),\n    },\n  ]);\n\n  $effect(() => {\n    new FloatingContextMenu(\n      FoundryAdapter.getJqueryWrappedElement(itemImageContainer),\n      `[data-tidy-sheet-part=${CONSTANTS.SHEET_PARTS.ITEM_IMAGE_CONTAINER}]`,\n      [],\n      {\n        onOpen: () => {\n          ui.context.menuItems = contextMenuOptions;\n        },\n      },\n    );\n  });\n</script>\n\n<div\n  class=\"item-image item-image-show-item-art\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_IMAGE_CONTAINER}\n  bind:this={itemImageContainer}\n>\n  <img\n    class=\"profile\"\n    class:conceal={context.item.system.identified === false}\n    src={context.item.img}\n    alt={context.item.name}\n    title=\"{localize('TIDY5E.EditSheetImageHint')} / {localize(\n      'TIDY5E.SheetImageOptionsHint',\n    )}\"\n    onclick={(event) => openItemImagePicker(event.currentTarget, context.item)}\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_IMAGE}\n  />\n  <div\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    class=\"unidentified-glyph\"\n    class:conceal={context.item.system.identified === false}\n  >\n    <i class=\"fas fa-question\"></i>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type {\n    ContainerSheetClassicContext,\n    ItemSheetContext,\n  } from 'src/types/item.types';\n  import type {\n    CharacterSheetContext,\n    NpcSheetContext,\n    VehicleSheetContext,\n  } from 'src/types/types';\n  import { ActiveEffectsHelper } from 'src/utils/active-effect';\n  import { buildDataset } from 'src/utils/data';\n  import { type Snippet } from 'svelte';\n\n  interface Props {\n    value: unknown;\n    tooltip?: string | null;\n    field: string;\n    document: any;\n    id?: string | null;\n    dataset?: Record<string, unknown> | null;\n    title?: string | null;\n    disabled?: boolean;\n    blankValue?: any;\n    children?: Snippet;\n    [key: string]: any;\n  }\n\n  let {\n    value,\n    tooltip = null,\n    field,\n    document,\n    id = null,\n    dataset = null,\n    title = null,\n    disabled = false,\n    blankValue = null,\n    children,\n    ...rest\n  }: Props = $props();\n\n  let draftValue = $state('');\n\n  $effect(() => {\n    draftValue = value?.toString() ?? '';\n  });\n\n  async function saveChange(\n    event: Event & {\n      currentTarget: EventTarget & HTMLSelectElement;\n    },\n  ) {\n    const targetValue = event.currentTarget.value;\n\n    await document.update({\n      [field]: targetValue !== '' ? targetValue : blankValue,\n    });\n  }\n\n  const context =\n    $derived(\n      getSheetContext<\n        | CharacterSheetContext\n        | NpcSheetContext\n        | VehicleSheetContext\n        | ContainerSheetClassicContext\n        | ItemSheetContext\n      >(),\n    );\n\n  const localize = FoundryAdapter.localize;\n\n  let datasetAttributes = $derived(buildDataset(dataset));\n  let activeEffectApplied = $derived(\n    ActiveEffectsHelper.isActiveEffectAppliedToField(document, field),\n  );\n  let isEnchanted = $derived(\n    context.itemOverrides instanceof Set && context.itemOverrides.has(field),\n  );\n  let overrideTooltip = $derived(\n    isEnchanted\n      ? localize('DND5E.ENCHANTMENT.Warning.Override')\n      : localize('DND5E.ActiveEffectOverrideWarning'),\n  );\n</script>\n\n<select\n  {id}\n  bind:value={draftValue}\n  data-tooltip={activeEffectApplied ? overrideTooltip : tooltip}\n  onchange={document && saveChange}\n  {title}\n  {...datasetAttributes}\n  disabled={disabled || activeEffectApplied}\n  data-tidy-field={field}\n  class={rest.class ?? ''}\n>\n  {@render children?.()}\n</select>\n","import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\nexport function processInputChangeDelta(\n  value: string,\n  entity: unknown,\n  field: string\n) {\n  if (['+', '-'].includes(value[0])) {\n    const delta = parseFloat(value);\n    return Number(FoundryAdapter.getProperty(entity, field)) + delta;\n  } else if (value[0] === '=') {\n    return Number(value.slice(1));\n  }\n  return Number(value);\n}\n\nexport function processInputChangeDeltaFromValues(\n  newValue: string,\n  originalValue: unknown\n) {\n  if (['+', '-'].includes(newValue[0])) {\n    const delta = parseFloat(newValue);\n    return Number(originalValue) + delta;\n  } else if (newValue[0] === '=') {\n    return Number(newValue.slice(1));\n  }\n  return Number(newValue);\n}","<script lang=\"ts\">\n  import { processInputChangeDelta } from 'src/utils/form';\n  import { buildDataset } from 'src/utils/data';\n  import { ActiveEffectsHelper } from 'src/utils/active-effect';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type {\n    ContainerSheetClassicContext,\n    ItemSheetContext,\n  } from 'src/types/item.types';\n  import type {\n    CharacterSheetContext,\n    NpcSheetContext,\n    VehicleSheetContext,\n  } from 'src/types/types';\n  import type {\n    KeyboardEventHandler,\n    MouseEventHandler,\n  } from 'svelte/elements';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  type OnSaveChangeFn = (\n    event: Event & {\n      currentTarget: EventTarget & HTMLInputElement;\n    },\n  ) => boolean;\n\n  interface Props {\n    value?: string | number | null;\n    placeholder?: string | null;\n    field: string;\n    document: any;\n    tooltip?: string | null;\n    id?: string | null;\n    dataset?: Record<string, unknown> | null;\n    maxlength?: number | null;\n    ariaDescribedBy?: string | null;\n    selectOnFocus?: boolean;\n    saveEmptyAsNull?: boolean;\n    title?: string | null;\n    allowDeltaChanges?: boolean;\n    disabled?: boolean;\n    onSaveChange?: OnSaveChangeFn;\n    /**\n     * There are cases where related data must be updated together,\n     * else odd behaviors will result.\n     */\n    additionalDataToSave?: Record<string, any>;\n    /**\n     * Stop propagation on input change event.\n     * Useful for cases when outside listeners like\n     * the FormApplication are clearing an input\n     * during a change event, since these inputs\n     * do not use the `[name]` attribute.\n     */\n    stopChangePropagation?: boolean;\n    onclick?: MouseEventHandler<HTMLElement>;\n    onkeypress?: KeyboardEventHandler<HTMLElement>;\n    [key: string]: any;\n  }\n\n  let {\n    value = null,\n    placeholder = null,\n    field,\n    document,\n    tooltip = null,\n    id = null,\n    dataset = null,\n    maxlength = null,\n    ariaDescribedBy = null,\n    selectOnFocus = false,\n    saveEmptyAsNull = false,\n    title = null,\n    allowDeltaChanges = false,\n    disabled = false,\n    onSaveChange = () => true,\n    additionalDataToSave = {},\n    stopChangePropagation = false,\n    onclick,\n    onkeypress,\n    ...rest\n  }: Props = $props();\n\n  let theInput: HTMLInputElement | undefined = $state();\n\n  async function saveChange(\n    event: Event & {\n      currentTarget: EventTarget & HTMLInputElement;\n    },\n  ) {\n    stopChangePropagation && event.stopPropagation();\n\n    const targetValue = event.currentTarget.value;\n\n    let valueToSave =\n      saveEmptyAsNull && targetValue === ''\n        ? null\n        : !isNaN(parseInt(targetValue)) && allowDeltaChanges\n          ? processInputChangeDelta(targetValue, document, field)\n          : targetValue;\n\n    await document.update({\n      ...additionalDataToSave,\n      [field]: valueToSave,\n    });\n\n    value = value?.toString() ?? '';\n\n    setTimeout(() => {\n      if (selectOnFocus && theInput === window.document.activeElement) {\n        theInput.select();\n      }\n    });\n  }\n\n  const context = $derived(getSheetContext<\n    | CharacterSheetContext\n    | NpcSheetContext\n    | VehicleSheetContext\n    | ContainerSheetClassicContext\n    | ItemSheetContext\n  >());\n\n  const localize = FoundryAdapter.localize;\n\n  let actualDataset = $derived(buildDataset(dataset));\n  let activeEffectApplied = $derived(\n    ActiveEffectsHelper.isActiveEffectAppliedToField(document, field),\n  );\n  let isEnchanted = $derived(\n    context.itemOverrides instanceof Set && context.itemOverrides.has(field),\n  );\n  let overrideTooltip = $derived(\n    isEnchanted\n      ? localize('DND5E.ENCHANTMENT.Warning.Override')\n      : localize('DND5E.ActiveEffectOverrideWarning'),\n  );\n</script>\n\n<input\n  bind:this={theInput}\n  type=\"text\"\n  {id}\n  {value}\n  {placeholder}\n  data-tooltip={activeEffectApplied ? overrideTooltip : tooltip}\n  {...actualDataset}\n  {...rest.attributes}\n  class={rest.class ?? ''}\n  {maxlength}\n  aria-describedby={ariaDescribedBy}\n  {title}\n  disabled={disabled || activeEffectApplied}\n  onchange={(ev) => onSaveChange(ev) && saveChange(ev)}\n  {onclick}\n  {onkeypress}\n  onfocus={(ev) => selectOnFocus && ev.currentTarget.select()}\n  data-tidy-field={field}\n/>\n","<script lang=\"ts\">\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n\n  interface Props {\n    document: any;\n    keyPath: string;\n    editable: boolean;\n  }\n\n  let { document, keyPath, editable }: Props = $props();\n\n  let keyPathToCustom = $derived(`${keyPath}.custom`);\n\n  let source = $derived(FoundryAdapter.getProperty<any>(document, keyPath));\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"source-container flex-row extra-small-gap align-items-center\">\n  {#if source?.directlyEditable}\n    <TextInput\n      {document}\n      field={keyPathToCustom}\n      value={source?.custom}\n      placeholder={localize('DND5E.SOURCE.FIELDS.source.label')}\n      class=\"source-custom\"\n    />\n  {:else}\n    <span class=\"source-label truncate\" title={source?.label ?? ''}\n      >{source?.label ?? ''}</span\n    >\n  {/if}\n  {#if editable}\n    <button\n      type=\"button\"\n      class=\"inline-icon-button config-button\"\n      onclick={() => FoundryAdapter.renderSourceConfig(document, keyPath)}\n      tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n      ><i class=\"fas fa-cog\"></i></button\n    >\n  {/if}\n</div>\n\n<style lang=\"scss\">\n  .source-container {\n    width: 100%;\n    line-height: inherit;\n\n    .source-label,\n    :global(.source-custom) {\n      flex: 1;\n      line-height: inherit;\n      height: inherit;\n    }\n\n    &:not(:hover) .config-button:not(:focus-visible) {\n      opacity: 0;\n      position: absolute;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n{#if context.system.identified}\n  <TextInput\n    id=\"{appId}-name\"\n    document={context.item}\n    field=\"name\"\n    value={context.item.name}\n    attributes={{ 'data-tidy-item-name': context.item.name }}\n    placeholder={localize('DND5E.ItemName')}\n    disabled={!context.editable}\n    title={context.item.name}\n  />\n{:else}\n  <TextInput\n    id=\"{appId}-name\"\n    document={context.item}\n    field=\"system.unidentified.name\"\n    value={context.system.unidentified.name}\n    attributes={{\n      'data-tidy-item-name': context.system.unidentified.name,\n    }}\n    placeholder={localize('DND5E.NameUnidentified')}\n    disabled={!context.editable}\n    title={context.identifiedName}\n  />\n{/if}\n","<script lang=\"ts\">\n  import type { Snippet } from 'svelte';\n  import type { ChangeEventHandler } from 'svelte/elements';\n\n  interface Props {\n    checked?: boolean;\n    disabled?: boolean;\n    thumbIconClass?: string | undefined;\n    onChange?: ChangeEventHandler<HTMLInputElement>;\n    children?: Snippet;\n    [key: string]: any;\n  }\n\n  let {\n    checked = $bindable(false),\n    disabled = false,\n    thumbIconClass = undefined,\n    onChange,\n    children,\n    ...rest\n  }: Props = $props();\n\n  const switchLabelId = `switch-${foundry.utils.randomID()}-label`;\n</script>\n\n<label\n  class=\"tidy-switch {rest.class ?? ''}\"\n  class:disabled\n  id={switchLabelId}\n  title={rest.title ?? null}\n>\n  {@render children?.()}\n  <div role=\"switch\" aria-checked={checked} aria-labelledby={switchLabelId}>\n    {#if thumbIconClass}\n      <i class=\"thumb-icon {thumbIconClass}\"></i>\n    {/if}\n  </div>\n\n  <input\n    type=\"checkbox\"\n    onchange={onChange}\n    {checked}\n    {disabled}\n    class=\"hidden\"\n  />\n</label>\n","<script lang=\"ts\">\n  import TidySwitch from './TidySwitch.svelte';\n  import Dnd5eIcon from 'src/components/icon/Dnd5eIcon.svelte';\n  import { debug, error } from 'src/utils/logging';\n  import type { Snippet } from 'svelte';\n\n  interface Props {\n    document: any;\n    field: string;\n    checked: boolean;\n    title?: string;\n    disabled?: boolean;\n    iconSrc?: string | null;\n    iconClass?: string | null;\n    children?: Snippet;\n  }\n\n  let {\n    document,\n    field,\n    checked = $bindable(false),\n    title = '',\n    disabled = false,\n    iconSrc = null,\n    iconClass = null,\n    children,\n  }: Props = $props();\n\n  async function handleChange(newValue: boolean) {\n    try {\n      const result = await document.update({\n        [field]: newValue,\n      });\n    } catch (e) {\n      error('An error occurred while toggling a property', false, e);\n      debug('Property toggle error troubleshooting info', {\n        originalValue: !newValue,\n        state: checked,\n      });\n    }\n  }\n</script>\n\n<TidySwitch\n  class=\"flex-row small-gap tidy-property-toggle {checked\n    ? 'active'\n    : 'inactive'}\"\n  bind:checked\n  onChange={(ev) => handleChange(ev.currentTarget.checked)}\n  {title}\n  {disabled}\n>\n  {#if iconSrc}\n    <Dnd5eIcon src={iconSrc} />\n  {/if}\n  {#if iconClass}\n    <i class={iconClass}></i>\n  {/if}\n  {@render children?.()}\n</TidySwitch>\n","<script lang=\"ts\">\n  import PropertyToggle from 'src/components/toggles/PropertyToggle.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type {\n    ContainerSheetClassicContext,\n    ItemSheetContext,\n  } from 'src/types/item.types';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getSheetContext<\n    ItemSheetContext | ContainerSheetClassicContext\n  >());\n\n  const localize = FoundryAdapter.localize;\n\n  let equipLabelWidthCh = $derived(\n    Math.max(\n      localize('DND5E.Equipped').length,\n      localize('DND5E.Unequipped').length,\n    ),\n  );\n  let identifiedLabelWidthCh = $derived(\n    Math.max(\n      localize('DND5E.Identified').length,\n      localize('DND5E.Unidentified.Title').length,\n    ),\n  );\n</script>\n\n<div class=\"flex-row extra-small-gap flex-wrap\">\n  <PropertyToggle\n    document={context.item}\n    field=\"system.equipped\"\n    checked={context.system.equipped}\n    disabled={!context.editable}\n    title={context.system.equipped\n      ? localize('DND5E.Equipped')\n      : localize('DND5E.Unequipped')}\n    iconClass=\"fas fa-user-alt fa-fw\"\n  >\n    <div style=\"width: {equipLabelWidthCh}ch\">\n      {context.system.equipped\n        ? localize('DND5E.Equipped')\n        : localize('DND5E.Unequipped')}\n    </div>\n  </PropertyToggle>\n\n  {#if FoundryAdapter.canIdentify(context.item)}\n    <PropertyToggle\n      document={context.item}\n      field=\"system.identified\"\n      checked={context.system.identified}\n      disabled={!context.editable}\n      title={context.system.identified\n        ? localize('DND5E.Identified')\n        : localize('DND5E.Unidentified.Title')}\n      iconClass=\"fas fa-magnifying-glass fa-fw\"\n    >\n      <div style=\"width: {identifiedLabelWidthCh}ch\">\n        {context.system.identified\n          ? localize('DND5E.Identified')\n          : localize('DND5E.Unidentified.Title')}\n      </div>\n    </PropertyToggle>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemProfilePicture from './parts/ItemProfilePicture.svelte';\n  import Select from 'src/components/inputs/Select.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import Source from '../shared/Source.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import ItemIdentifiableName from './parts/ItemIdentifiableName.svelte';\n  import ItemHeaderToggles from './parts/ItemHeaderToggles.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  let selectedTabId: string = $state('');\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<header class=\"sheet-header flexrow gap\">\n  <ItemProfilePicture />\n\n  <div\n    class=\"header-details flexrow small-gap\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n  >\n    <h1\n      class=\"charname\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n    >\n      <ItemIdentifiableName />\n    </h1>\n\n    <div class=\"item-subtitle\">\n      <h4 class=\"item-type\">{context.itemType ?? ''}</h4>\n    </div>\n\n    <ul class=\"summary flexrow\">\n      <li>{context.system.type.label}</li>\n      <li>\n        {#if context.concealDetails}\n          <span>{localize('DND5E.Unidentified.Title')}</span>\n        {:else}\n          <Select\n            id=\"{appId}-rarity\"\n            document={context.item}\n            field=\"system.rarity\"\n            class=\"item-rarity\"\n            value={context.system.rarity}\n            disabled={!context.editable}\n            blankValue=\"\"\n          >\n            <SelectOptions\n              data={context.config.itemRarity}\n              blank={localize('DND5E.Rarity')}\n            />\n          </Select>\n        {/if}\n      </li>\n      <li class=\"flex-row\">\n        <Source\n          document={context.item}\n          keyPath=\"system.source\"\n          editable={context.editable && !context.concealDetails}\n        />\n      </li>\n    </ul>\n    <ItemHeaderToggles />\n  </div>\n</header>\n<Tabs bind:selectedTabId tabs={context.tabs} sheet={context.item.sheet} />\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type {\n    ContainerSheetClassicContext,\n    ItemSheetContext,\n  } from 'src/types/item.types';\n  import type {\n    CharacterSheetContext,\n    NpcSheetContext,\n    VehicleSheetContext,\n  } from 'src/types/types';\n  import { ActiveEffectsHelper } from 'src/utils/active-effect';\n  import { buildDataset } from 'src/utils/data';\n\n  interface Props {\n    value?: number | null;\n    step?: string;\n    placeholder?: string | null;\n    field: string;\n    document: any;\n    tooltip?: string | null;\n    min?: string | number | null | undefined;\n    max?: string | number | null | undefined;\n    id?: string | null;\n    disabled?: boolean | null;\n    dataset?: Record<string, unknown> | null;\n    readonly?: boolean | null;\n    cssClass?: string | null;\n    maxlength?: HTMLInputElement['maxLength'] | null;\n    selectOnFocus?: boolean;\n    title?: string | null;\n    stopClickPropagation?: boolean;\n  }\n\n  let {\n    value = null,\n    step = 'any',\n    placeholder = null,\n    field,\n    document,\n    tooltip = null,\n    min = null,\n    max = null,\n    id = null,\n    disabled = null,\n    dataset = null,\n    readonly = null,\n    cssClass = null,\n    maxlength = null,\n    selectOnFocus = false,\n    title = null,\n    stopClickPropagation = false,\n  }: Props = $props();\n\n  let theInput: HTMLInputElement | undefined = $state();\n\n  async function saveChange(\n    event: Event & {\n      currentTarget: EventTarget & HTMLInputElement;\n    },\n  ) {\n    const proposedValueToSave = parseFloat(event.currentTarget.value);\n\n    const parsedValueToSave = !isNaN(proposedValueToSave)\n      ? proposedValueToSave\n      : null;\n\n    await document.update({\n      [field]: parsedValueToSave,\n    });\n\n    if (selectOnFocus && theInput === window.document.activeElement) {\n      theInput.select();\n    }\n  }\n\n  const context =\n    $derived(\n      getSheetContext<\n        | CharacterSheetContext\n        | NpcSheetContext\n        | VehicleSheetContext\n        | ContainerSheetClassicContext\n        | ItemSheetContext\n      >(),\n    );\n\n  const localize = FoundryAdapter.localize;\n\n  let datasetAttributes = $derived(buildDataset(dataset));\n  let activeEffectApplied = $derived(\n    ActiveEffectsHelper.isActiveEffectAppliedToField(document, field),\n  );\n  let isEnchanted = $derived(\n    context.itemOverrides instanceof Set && context.itemOverrides.has(field),\n  );\n  let overrideTooltip = $derived(\n    isEnchanted\n      ? localize('DND5E.ENCHANTMENT.Warning.Override')\n      : localize('DND5E.ActiveEffectOverrideWarning'),\n  );\n</script>\n\n<input\n  bind:this={theInput}\n  type=\"number\"\n  {id}\n  {step}\n  {value}\n  {min}\n  {max}\n  {placeholder}\n  onchange={saveChange}\n  data-tooltip={activeEffectApplied ? overrideTooltip : tooltip}\n  disabled={disabled || activeEffectApplied}\n  {readonly}\n  class={cssClass}\n  {maxlength}\n  {...datasetAttributes}\n  onfocus={(ev) => selectOnFocus && ev.currentTarget.select()}\n  onclick={(ev) => stopClickPropagation && ev.stopPropagation()}\n  {title}\n  data-tidy-field={field}\n/>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type {\n    ContainerSheetClassicContext,\n    ItemSheetContext,\n  } from 'src/types/item.types';\n  import type {\n    CharacterSheetContext,\n    NpcSheetContext,\n    VehicleSheetContext,\n  } from 'src/types/types';\n  import { ActiveEffectsHelper } from 'src/utils/active-effect';\n  import { buildDataset } from 'src/utils/data';\n  import { type Snippet } from 'svelte';\n\n  // TODO: File this away somewhere.\n  type SvelteInputEvent = (\n    event: Event & {\n      currentTarget: EventTarget & HTMLInputElement;\n    },\n  ) => any;\n\n  interface Props {\n    value?: number | string | null;\n    checked?: boolean;\n    field: string;\n    document: any;\n    title?: string | null;\n    tooltip?: string | null;\n    id?: string | null;\n    disabled?: boolean | null;\n    dataset?: Record<string, unknown> | null;\n    labelCssClass?: string | null;\n    checkboxCssClass?: string | null;\n    onDataPreparing?: SvelteInputEvent | null;\n    // TODO: Get rid of the these horrendous green checkboxes and remove all the code that barely props them up.\n    greenCheckboxWidthOverride?: string | null;\n    children?: Snippet;\n    [key: string]: any;\n  }\n\n  let {\n    value = null,\n    checked = false,\n    field,\n    document,\n    title = null,\n    tooltip = null,\n    id = null,\n    disabled = null,\n    dataset = null,\n    labelCssClass = null,\n    checkboxCssClass = null,\n    onDataPreparing = null,\n    greenCheckboxWidthOverride = null,\n    children,\n    ...rest\n  }: Props = $props();\n\n  async function saveChange(\n    event: Event & {\n      currentTarget: EventTarget & HTMLInputElement;\n    },\n  ) {\n    let data: any = onDataPreparing?.(event) ?? {\n      [field]: value ?? event.currentTarget.checked,\n    };\n\n    await document.update(data);\n  }\n\n  const context =\n    $derived(\n      getSheetContext<\n        | CharacterSheetContext\n        | NpcSheetContext\n        | VehicleSheetContext\n        | ContainerSheetClassicContext\n        | ItemSheetContext\n      >(),\n    );\n\n  const localize = FoundryAdapter.localize;\n  let greenCheckboxStyle = $derived(\n    greenCheckboxWidthOverride !== null\n      ? `width: ${greenCheckboxWidthOverride}`\n      : '',\n  );\n\n  let datasetAttributes = $derived(buildDataset(dataset));\n  let activeEffectApplied = $derived(\n    ActiveEffectsHelper.isActiveEffectAppliedToField(document, field),\n  );\n  let isEnchanted = $derived(\n    context.itemOverrides instanceof Set && context.itemOverrides.has(field),\n  );\n  let overrideTooltip = $derived(\n    isEnchanted\n      ? localize('DND5E.ENCHANTMENT.Warning.Override')\n      : localize('DND5E.ActiveEffectOverrideWarning'),\n  );\n</script>\n\n{#snippet checkboxInput()}\n  <input\n    type=\"checkbox\"\n    {id}\n    {value}\n    {checked}\n    {title}\n    onchange={saveChange}\n    disabled={disabled || activeEffectApplied}\n    {...datasetAttributes}\n    class={checkboxCssClass}\n    data-tidy-field={field}\n    {...rest.attributes}\n    data-tooltip={activeEffectApplied ? overrideTooltip : tooltip}\n  />\n{/snippet}\n\n{#if children}\n  <label\n    class={labelCssClass}\n    {title}\n    style={greenCheckboxStyle}\n    data-tooltip={activeEffectApplied ? overrideTooltip : tooltip}\n  >\n    {@render checkboxInput()}\n    {@render children?.()}\n  </label>\n{:else}\n  {@render checkboxInput()}\n{/if}\n\n<style lang=\"scss\">\n  label {\n    --tidy-checkbox-width-internal: var(--tidy-checkbox-width, unset);\n    width: var(--tidy-checkbox-width-internal);\n  }\n</style>\n","import type { ItemSheetContext } from 'src/types/item.types';\n\n// TODO: Eliminate these specific mappers for more generalized versions, as needed.\nexport function mapPropertiesToSave(\n  context: ItemSheetContext,\n  ev: Event & { currentTarget: HTMLInputElement },\n  keyToSave: string\n) {\n  const allProperties = context.properties;\n\n  const propertiesToSave = allProperties.options\n    .filter(\n      (property) =>\n        property.value !== keyToSave &&\n        property.selected &&\n        !context.itemOverrides.has(`system.properties.${property.value}`)\n    )\n    .map((property) => property.value);\n\n  if (ev.currentTarget.checked) {\n    propertiesToSave.push(keyToSave);\n  }\n\n  return {\n    'system.properties': propertiesToSave,\n  };\n}\n\n// TODO: Eliminate these specific mappers for more generalized versions, as needed.\nexport function mapMulticlassingAbilitiesToSave(\n  context: ItemSheetContext,\n  ev: Event & { currentTarget: HTMLInputElement }\n) {\n  const selectedAbilities: Set<string> = new Set<string>(\n    context.system.primaryAbility.value\n  );\n\n  if (ev.currentTarget.checked) {\n    selectedAbilities.add(ev.currentTarget.value);\n  } else {\n    selectedAbilities.delete(ev.currentTarget.value);\n  }\n\n  return {\n    'system.primaryAbility.value': selectedAbilities,\n  };\n}\n\n// TODO: Eliminate these specific mappers for more generalized versions, as needed.\nexport function mapSystemDamageTypesToSave(\n  context: ItemSheetContext,\n  prefix: string,\n  source: any,\n  ev: Event & { currentTarget: HTMLInputElement }\n) {\n  const selectedAbilities: Set<string> = new Set<string>(\n    source.types\n  );\n\n  if (ev.currentTarget.checked) {\n    selectedAbilities.add(ev.currentTarget.value);\n  } else {\n    selectedAbilities.delete(ev.currentTarget.value);\n  }\n\n  return {\n    [`${prefix}types`]: selectedAbilities,\n  };\n}\n","<script lang=\"ts\">\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n  import { mapPropertiesToSave } from 'src/utils/system-properties';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n{#each context.properties.options as property}\n  {@const field = `system.properties.${property.value}`}\n  {@const isEnchanted = context.itemOverrides.has(field)}\n  {@const enchantedTooltip = isEnchanted\n    ? localize('DND5E.ENCHANTMENT.Warning.Override')\n    : null}\n\n  <Checkbox\n    id=\"{appId}-properties-{property.value?.slugify()}\"\n    labelCssClass=\"checkbox\"\n    document={context.item}\n    {field}\n    checked={property.selected}\n    disabled={!context.editable || isEnchanted}\n    onDataPreparing={(ev) => mapPropertiesToSave(context, ev, property.value)}\n    tooltip={enchantedTooltip}\n  >\n    {property.label}\n  </Checkbox>\n{/each}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import Select from 'src/components/inputs/Select.svelte';\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import ItemProperties from 'src/sheets/classic/item/parts/ItemProperties.svelte';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { getContainerSheetClassicContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getContainerSheetClassicContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<fieldset>\n  <div class=\"form-group\">\n    <label for=\"{appId}-weight-value\">\n      {localize('DND5E.Weight')}\n    </label>\n    <div class=\"form-fields\">\n      <NumberInput\n        id=\"{appId}-weight-value\"\n        value={context.source.weight.value}\n        step=\"any\"\n        field=\"system.weight.value\"\n        document={context.item}\n        disabled={!context.editable}\n        selectOnFocus={true}\n      />\n      <Select\n        document={context.item}\n        field=\"system.weight.units\"\n        value={context.source.weight.units}\n      >\n        <SelectOptions\n          data={context.config.weightUnits}\n          labelProp=\"abbreviation\"\n        />\n      </Select>\n    </div>\n  </div>\n  <div class=\"form-group\">\n    <label for=\"{appId}-price-value\">\n      {localize('DND5E.Price')}\n    </label>\n    <div class=\"form-fields\">\n      <NumberInput\n        id=\"{appId}-price-value\"\n        value={context.source.price.value}\n        step=\"any\"\n        field=\"system.price.value\"\n        document={context.item}\n        disabled={!context.editable}\n        selectOnFocus={true}\n        cssClass=\"large-value\"\n      />\n      <Select\n        value={context.source.price.denomination}\n        field=\"system.price.denomination\"\n        document={context.item}\n        disabled={!context.editable}\n      >\n        <SelectOptions\n          data={context.config.currencies}\n          labelProp=\"abbreviation\"\n        />\n      </Select>\n    </div>\n  </div>\n</fieldset>\n\n<fieldset>\n  <legend>\n    {localize('DND5E.CONTAINER.Details')}\n  </legend>\n\n  <div class=\"form-group stacked container-properties\">\n    <label for=\"\">{localize('DND5E.CONTAINER.FIELDS.properties.label')}</label>\n    <ItemProperties />\n  </div>\n\n  {#if context.properties.object.mgc}\n    <div class=\"form-group\">\n      <label for=\"{appId}-attunement\">{localize('DND5E.Attunement')}</label>\n      <div class=\"form-fields\">\n        <Checkbox\n          id=\"{appId}-attuned\"\n          document={context.item}\n          field=\"system.attuned\"\n          checked={context.source.attuned}\n          disabled={!context.editable ||\n            // @ts-expect-error\n            !context.config.attunementTypes[context.system.attunement]}\n          title={localize('DND5E.AttunementAttuned')}\n        />\n        <Select\n          id=\"{appId}-attunement\"\n          document={context.item}\n          field=\"system.attunement\"\n          value={context.source.attunement}\n          disabled={!context.editable}\n        >\n          <SelectOptions\n            data={context.config.attunementTypes}\n            blank={localize('DND5E.AttunementNone')}\n          />\n        </Select>\n      </div>\n    </div>\n  {/if}\n</fieldset>\n\n<fieldset>\n  <legend>\n    {localize('DND5E.CONTAINER.FIELDS.capacity.label')}\n  </legend>\n\n  <div class=\"form-group\">\n    <div class=\"form-group\">\n      <label>{localize('DND5E.CONTAINER.FIELDS.capacity.count.label')}</label>\n      <div class=\"form-fields\">\n        <NumberInput\n          document={context.item}\n          field=\"system.capacity.count\"\n          value={context.source.capacity.count}\n          step=\"1\"\n          min=\"0\"\n          placeholder=\"\"\n        />\n      </div>\n    </div>\n  </div>\n\n  <!-- Volume Capacity -->\n\n  <div class=\"form-group split-group\">\n    <label>{localize('DND5E.CONTAINER.FIELDS.capacity.volume.label')}</label>\n    <div class=\"form-fields\">\n      <div class=\"form-group label-top\">\n        <label>{localize('DND5E.Amount')}</label>\n        <div class=\"form-fields\">\n          <NumberInput\n            document={context.item}\n            field=\"system.capacity.volume.value\"\n            value={context.source.capacity.volume.value}\n            step=\"any\"\n            min=\"0\"\n            placeholder=\"\"\n          />\n        </div>\n      </div>\n\n      <div class=\"form-group label-top\">\n        <label>{localize('DND5E.Unit')}</label>\n        <div class=\"form-fields\">\n          <Select\n            document={context.item}\n            field=\"system.capacity.volume.units\"\n            value={context.source.capacity.volume.units}\n            blankValue=\"\"\n          >\n            <SelectOptions\n              data={context.config.volumeUnits}\n              labelProp=\"label\"\n            />\n          </Select>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- Weight Capacity -->\n  <div class=\"form-group split-group\">\n    <label>{localize('DND5E.CONTAINER.FIELDS.capacity.weight.label')}</label>\n    <div class=\"form-fields\">\n      <div class=\"form-group label-top\">\n        <label>{localize('DND5E.Amount')}</label>\n        <div class=\"form-fields\">\n          <NumberInput\n            document={context.item}\n            field=\"system.capacity.weight.value\"\n            value={context.source.capacity.weight.value}\n            step=\"any\"\n            min=\"0\"\n            placeholder=\"\"\n          />\n        </div>\n      </div>\n\n      <div class=\"form-group label-top\">\n        <label>{localize('DND5E.Unit')}</label>\n        <div class=\"form-fields\">\n          <Select\n            document={context.item}\n            field=\"system.capacity.weight.units\"\n            value={context.source.capacity.weight.units}\n            blankValue=\"\"\n          >\n            <SelectOptions\n              data={context.config.weightUnits}\n              labelProp=\"label\"\n            />\n          </Select>\n        </div>\n      </div>\n    </div>\n  </div>\n</fieldset>\n\n<!-- TODO: Extract to shared component -->\n<fieldset>\n  <legend>{FoundryAdapter.localize('TIDY5E.Tidy5eSettings')}</legend>\n  <div class=\"form-group custom-section\">\n    <label for=\"{appId}-custom-section\">\n      {FoundryAdapter.localize('TIDY5E.Section.Label')}\n    </label>\n    <div class=\"form-fields\">\n      <TextInput\n        document={context.item}\n        field={TidyFlags.section.prop}\n        value={TidyFlags.section.get(context.item)}\n        selectOnFocus={true}\n        disabled={!context.editable}\n        id=\"{appId}-custom-section\"\n      />\n    </div>\n  </div>\n  <div class=\"form-group custom-action-section\">\n    <label for=\"{appId}-custom-action-section\">\n      {FoundryAdapter.localize('TIDY5E.Section.ActionLabel')}\n    </label>\n    <div class=\"form-fields\">\n      <TextInput\n        document={context.item}\n        field={TidyFlags.actionSection.prop}\n        value={TidyFlags.actionSection.get(context.item)}\n        selectOnFocus={true}\n        disabled={!context.editable}\n        id=\"{appId}-custom-action-section\"\n      />\n    </div>\n  </div>\n</fieldset>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { fade } from 'svelte/transition';\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"unidentified-notice\" transition:fade={{ delay: 0, duration: 750 }}>\n  <div>\n    <strong>{localize('DND5E.Unidentified.Title')}</strong>\n    <p>{localize('DND5E.Unidentified.Notice')}</p>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import ContentConcealer from 'src/components/content-concealment/ContentConcealer.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { ItemSheetContext } from 'src/types/item.types';\n  import type { CharacterSheetContext } from 'src/types/types';\n\n  let context =\n    $derived(getSheetContext<ItemSheetContext | CharacterSheetContext>());\n\n  let effects = $derived(\n    Object.entries(context.effects) as Iterable<[string, any]>,\n  );\n\n  const localize = FoundryAdapter.localize;\n\n  function onAddClicked(section: any) {\n    const owner = context.item;\n    return FoundryAdapter.addEffect(section.type, owner);\n  }\n\n  function handleMiddleClickToEdit(event: MouseEvent, effect: any) {\n    if (event.button === CONSTANTS.MOUSE_BUTTON_AUXILIARY) {\n      effect.sheet.render(true);\n    }\n  }\n\n  function handleDragStart(event: DragEvent, effect: any) {\n    if (!effect) {\n      return;\n    }\n\n    const dragData = effect.toDragData();\n    event.dataTransfer?.setData('text/plain', JSON.stringify(dragData));\n  }\n</script>\n\n<ContentConcealer conceal={context.concealDetails}>\n  <ol\n    class=\"items-list effects-list\"\n    ondrop={(ev) => context.item.sheet._onDrop(ev)}\n  >\n    {#each effects as [_, section]}\n      {@const effectEntries = section.effects.map((effect: any) => ({\n        effect,\n      }))}\n\n      {#if !section.hidden}\n        <li class=\"items-header flexrow\" data-effect-type={section.type}>\n          <h3 class=\"item-name effect-name flexrow\">\n            {localize(section.label)}\n          </h3>\n          <div class=\"effect-source\">\n            {localize('DND5E.SOURCE.FIELDS.source.label')}\n          </div>\n          <div class=\"effect-source\">{localize('DND5E.Duration')}</div>\n          <div class=\"item-controls active-effect-controls flexrow\">\n            {#if context.editable}\n              <button\n                type=\"button\"\n                class=\"active-effect-control inline-icon-button\"\n                title={localize('DND5E.EffectCreate')}\n                onclick={(event) => onAddClicked(section)}\n                tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n              >\n                <i class=\"fas fa-plus\"></i>\n                {localize('DND5E.Add')}\n              </button>\n            {/if}\n          </div>\n        </li>\n\n        {#if section.info}\n          <ol class=\"info\">\n            {#each section.info as info}\n              <li class=\"notification info\">{info ?? ''}</li>\n            {/each}\n          </ol>\n        {/if}\n\n        <ol class=\"item-list\">\n          {#each effectEntries as { effect }}\n            <li\n              class=\"item effect flexrow\"\n              data-effect-id={effect.id}\n              onmousedown={(event) => handleMiddleClickToEdit(event, effect)}\n              ondragstart={(ev) => handleDragStart(ev, effect)}\n              draggable={context.owner}\n              data-context-menu={CONSTANTS.CONTEXT_MENU_TYPE_EFFECTS}\n              data-info-card=\"effect\"\n              data-info-card-entity-uuid={effect.uuid}\n            >\n              <div class=\"item-name effect-name flexrow\">\n                <img\n                  class=\"item-image\"\n                  src={effect.img ?? effect.icon}\n                  alt={effect.name ?? ''}\n                />\n                <span class=\"truncate\" title={effect.name ?? ''}>\n                  {effect.name ?? ''}\n                </span>\n              </div>\n              <div\n                class=\"effect-source truncate\"\n                title={effect.sourceName ?? ''}\n              >\n                {effect.sourceName ?? ''}\n              </div>\n              <div\n                class=\"effect-duration truncate\"\n                title={effect.duration.label ?? ''}\n              >\n                {effect.duration.label ?? ''}\n              </div>\n              <div class=\"item-controls active-effect-controls flexrow\">\n                {#if context.editable}\n                  {#if section.type !== 'enchantment'}\n                    <button\n                      type=\"button\"\n                      class=\"active-effect-control inline-icon-button\"\n                      title={effect.disabled\n                        ? 'DND5E.EffectEnable'\n                        : 'DND5E.EffectDisable'}\n                      onclick={() =>\n                        effect.update({ disabled: !effect.disabled })}\n                      tabindex={settings.value.useAccessibleKeyboardSupport\n                        ? 0\n                        : -1}\n                    >\n                      <i\n                        class=\"fas\"\n                        class:fa-check={effect.disabled}\n                        class:fa-times={!effect.disabled}\n                      ></i>\n                    </button>\n                  {/if}\n                  <button\n                    type=\"button\"\n                    class=\"active-effect-control inline-icon-button\"\n                    title={localize('DND5E.EffectEdit')}\n                    onclick={() => effect.sheet.render(true)}\n                    tabindex={settings.value.useAccessibleKeyboardSupport\n                      ? 0\n                      : -1}\n                  >\n                    <i class=\"fas fa-edit\"></i>\n                  </button>\n                  <button\n                    type=\"button\"\n                    class=\"active-effect-control inline-icon-button\"\n                    title={localize('DND5E.EffectDelete')}\n                    onclick={() => effect.deleteDialog()}\n                    tabindex={settings.value.useAccessibleKeyboardSupport\n                      ? 0\n                      : -1}\n                  >\n                    <i class=\"fas fa-trash\"></i>\n                  </button>\n                {/if}\n              </div>\n            </li>\n          {/each}\n        </ol>\n      {/if}\n    {/each}\n  </ol>\n</ContentConcealer>\n","<script lang=\"ts\">\n  import { error } from 'src/utils/logging';\n\n  interface Props {\n    svgUrl: string;\n    removeInlineStyles?: boolean;\n    [key: string]: any;\n  }\n\n  let { svgUrl, removeInlineStyles = true, ...rest }: Props = $props();\n\n  let svgHtml: string = $state('');\n\n  $effect(() => {\n    if (!svgUrl) {\n      return;\n    }\n\n    (async () => {\n      try {\n        const response = await fetch(svgUrl);\n        if (response.ok) {\n          svgHtml = await response.text();\n        }\n      } catch (e) {\n        error(\n          'An error occurred while getting SVG images. See devtools console for more details.',\n          true,\n          e,\n        );\n        svgHtml = `<img src=\"${svgUrl}\" alt=\"\" />`;\n      }\n    })();\n  });\n\n  function preprocessSvg(node: HTMLElement) {\n    removeInlineStyles && node.querySelector('svg')?.removeAttribute('style');\n  }\n</script>\n\n{#key svgHtml}\n  <div use:preprocessSvg class={rest.class ?? ''}>\n    {@html svgHtml}\n  </div>\n{/key}\n","<script lang=\"ts\">\n  import InlineSvg from 'src/components/utility/InlineSvg.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { Item5e } from 'src/types/item.types';\n\n  let context = $derived(getItemSheetContext());\n\n  let advancements = $derived(\n    Object.entries(context.advancement) as Iterable<[string, any]>,\n  );\n\n  const localize = FoundryAdapter.localize;\n\n  function toggleAdvancementLock(item: Item5e) {\n    context.toggleAdvancementLock();\n  }\n\n  const basicSvgFilePathRegex = /\\.svg$/i;\n\n  function isSvg(iconPath: string) {\n    return basicSvgFilePathRegex.test(iconPath?.trim());\n  }\n\n  function handleAdvancementDragStart(event: DragEvent, advancement: any) {\n    if (!advancement) {\n      return;\n    }\n\n    const dragData =\n      context.item.advancement.byId[advancement.id]?.toDragData();\n    event.dataTransfer?.setData('text/plain', JSON.stringify(dragData));\n  }\n</script>\n\n<ol\n  class=\"items-list flex-1\"\n  ondrop={(ev) => context.owner && context.item.sheet._onDrop(ev)}\n>\n  {#if context.editable}\n    <li\n      class=\"items-header main-controls advancement flex-row justify-content-space-between\"\n    >\n      <div class=\"item-controls configuration-mode-control\">\n        {#if context.editable && context.isEmbedded}\n          <button\n            class=\"inline-icon-button\"\n            onclick={() => toggleAdvancementLock(context.item)}\n            title={localize('DND5E.AdvancementConfigurationActionDisable')}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n          >\n            {#if context.advancementEditable}\n              <i class=\"fas fa-lock-open\"></i>\n              {localize('DND5E.AdvancementConfigurationModeEnabled')}\n            {:else}\n              <i class=\"fas fa-lock\"></i>\n              {localize('DND5E.AdvancementConfigurationModeDisabled')}\n            {/if}\n          </button>\n        {/if}\n      </div>\n      {#if context.editable && context.advancementEditable}\n        <div class=\"item-controls add-button\">\n          <button\n            type=\"button\"\n            class=\"inline-icon-button\"\n            title={localize('DND5E.AdvancementControlCreate')}\n            aria-label={localize('DND5E.AdvancementControlCreate')}\n            onclick={() =>\n              FoundryAdapter.createAdvancementSelectionDialog(context.item)}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n          >\n            <i class=\"fas fa-plus\"></i>\n            {localize('DND5E.Add')}\n          </button>\n        </div>\n      {:else}\n        <div role=\"presentation\"></div>\n      {/if}\n    </li>\n  {/if}\n\n  {#each advancements as [level, data]}\n    <li class=\"items-header flexrow\" data-level={level}>\n      <h3 class=\"item-name flexrow\">\n        {#if level === '0'}\n          {localize('DND5E.AdvancementLevelAnyHeader')}\n        {:else if level === 'unconfigured'}\n          {localize('DND5E.AdvancementLevelNoneHeader')}\n        {:else}\n          {localize('DND5E.AdvancementLevelHeader', { level })}\n        {/if}\n      </h3>\n\n      {#if context.editable && data.configured && level !== 'unconfigured'}\n        <div>\n          <button\n            type=\"button\"\n            class=\"inline-transparent-button\"\n            onclick={() =>\n              FoundryAdapter.modifyAdvancementChoices(level, context.item)}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n          >\n            {localize('DND5E.AdvancementModifyChoices')}\n          </button>\n        </div>\n      {/if}\n\n      {#if data.configured === 'full'}\n        <div\n          class=\"item-checkmark\"\n          title={localize('DND5E.AdvancementConfiguredComplete')}\n        >\n          <i class=\"fas fa-check-circle\"></i>\n        </div>\n      {:else if data.configured === 'partial'}\n        <div\n          class=\"item-warning\"\n          title={localize('DND5E.AdvancementConfiguredIncomplete')}\n        >\n          <i class=\"fas fa-exclamation-triangle\"></i>\n        </div>\n      {/if}\n    </li>\n    <ol class=\"item-list\">\n      {#each data.items as advancement}\n        {@const isSvgIcon = isSvg(advancement.icon)}\n        <li\n          class=\"advancement-item item flexrow\"\n          data-id={advancement.id}\n          ondragstart={(ev) => handleAdvancementDragStart(ev, advancement)}\n          draggable={context.editable}\n        >\n          <div class=\"item-name flexrow\">\n            <div class=\"item-image\" class:svg={isSvgIcon}>\n              {#if isSvgIcon}\n                <InlineSvg svgUrl={advancement.icon} />\n              {:else}\n                <img src={advancement.icon} alt=\"\" />\n              {/if}\n            </div>\n            <span class=\"title truncate\" title={advancement.title}\n              >{@html advancement.title}</span\n            >\n          </div>\n          {#if context.advancementEditable || !context.isEmbedded}\n            <div class=\"flexrow\">\n              {#if advancement.classRestriction === 'primary'}\n                {localize('DND5E.AdvancementClassRestrictionPrimary')}\n              {:else if advancement.classRestriction === 'secondary'}\n                {localize('DND5E.AdvancementClassRestrictionSecondary')}\n              {/if}\n            </div>\n          {/if}\n          {#if context.editable && context.advancementEditable}\n            <div class=\"item-controls flexrow\">\n              <button\n                type=\"button\"\n                class=\"inline-icon-button\"\n                title={localize('DND5E.AdvancementControlEdit')}\n                aria-label={localize('DND5E.AdvancementControlEdit')}\n                onclick={() =>\n                  FoundryAdapter.editAdvancement(advancement.id, context.item)}\n                tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n              >\n                <i class=\"fas fa-edit\"></i>\n              </button>\n              <button\n                type=\"button\"\n                class=\"inline-icon-button\"\n                title={localize('DND5E.AdvancementControlDelete')}\n                aria-label={localize('DND5E.AdvancementControlDelete')}\n                onclick={() =>\n                  FoundryAdapter.deleteAdvancement(\n                    advancement.id,\n                    context.item,\n                  )}\n                tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n              >\n                <i class=\"fas fa-trash\"></i>\n              </button>\n            </div>\n          {/if}\n          {#if advancement.summary}\n            <div class=\"item-summary\">\n              {@html advancement.summary}\n            </div>\n          {/if}\n        </li>\n      {/each}\n    </ol>\n  {/each}\n</ol>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { coalesce } from 'src/utils/formatting';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<h3 class=\"form-header flex-row justify-content-space-between\">\n  {localize('DND5E.StartingEquipment.Title')}\n  {#if context.editable}\n    <span>\n      <button\n        type=\"button\"\n        class=\"configure-starting-equipment inline-icon-button\"\n        title={localize('DND5E.StartingEquipment.Action.Configure')}\n        aria-label={localize('DND5E.StartingEquipment.Action.Configure')}\n        onclick={() => FoundryAdapter.openStartingEquipmentConfig(context.item)}\n        tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n      >\n        <i class=\"fas fa-gear\"></i>\n      </button>\n    </span>\n  {/if}\n</h3>\n\n<div class=\"starting-equipment-text\">\n  {@html coalesce(\n    context.system.startingEquipmentDescription,\n    localize('None'),\n  )}\n</div>\n\n<div class=\"form-group\">\n  <label for=\"{appId}-wealth\"\n    >{localize('DND5E.StartingEquipment.Wealth.Label')}</label\n  >\n  <div class=\"form-fields\">\n    <TextInput\n      id=\"{appId}-wealth\"\n      document={context.item}\n      field=\"system.wealth\"\n      value={context.source.wealth}\n      disabled={!context.editable}\n    />\n  </div>\n  <p class=\"hint\">{localize('DND5E.StartingEquipment.Wealth.Hint')}</p>\n</div>\n\n<style lang=\"scss\">\n  span:has(:global(.configure-starting-equipment)) {\n    font-size: 0.875rem;\n  }\n\n  .starting-equipment-text {\n    line-height: 1.75;\n  }\n</style>\n","<script lang=\"ts\">\n  import ItemStartingEquipment from '../parts/ItemStartingEquipment.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"form-group\">\n  <label for=\"{appId}-identifier\">{localize('DND5E.Identifier')}</label>\n  <div class=\"form-fields\">\n    <TextInput\n      id=\"{appId}-identifier\"\n      document={context.item}\n      field=\"system.identifier\"\n      value={context.source.identifier}\n      placeholder={context.item.identifier}\n      disabled={!context.editable}\n    />\n  </div>\n  <p class=\"hint\">{localize('DND5E.IdentifierError')}</p>\n</div>\n\n<ItemStartingEquipment />\n","<script lang=\"ts\">\n  import { getContext } from 'svelte';\n  import type { MaxPreparedSpellsConfigContext } from './MaxPreparedSpellsConfigFormApplication.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { CONSTANTS } from 'src/constants';\n\n  const appId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.APP_ID);\n  const context = getContext<MaxPreparedSpellsConfigContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<section class=\"flex-column\">\n  <div class=\"form-field\">\n    <label for=\"max-prepared-spells-edit-{appId}\"\n      >{localize('DND5E.Formula')}</label\n    >\n    <input\n      id=\"max-prepared-spells-edit-{appId}\"\n      type=\"text\"\n      placeholder=\"0\"\n      bind:value={context.maxPreparedSpells}\n    />\n  </div>\n  <div role=\"presentation\">\n    <h3>{localize('TIDY5E.MaxPreparedSpellsConfig.ExamplesHeader')}</h3>\n    <p class=\"flex-row flex-wrap sample-formulas\">\n      {#each context.formulas as formula}\n        <button\n          type=\"button\"\n          class=\"highlight-on-hover\"\n          onclick={() => {\n            context.maxPreparedSpells = formula.value;\n          }}>{localize(formula.label)}</button\n        >\n      {/each}\n    </p>\n    <p>\n      <a\n        target=\"_blank\"\n        href=\"https://github.com/kgar/foundry-vtt-tidy-5e-sheets/wiki/Max-Prepared-Spells-Formulas\"\n        >{localize('TIDY5E.MaxPreparedSpellsConfig.MoreFormulas')}</a\n      >\n    </p>\n  </div>\n  <button type=\"submit\">\n    <i class=\"far fa-save\"></i>\n    {localize('Save')}\n  </button>\n</section>\n\n<style lang=\"scss\">\n  .sample-formulas {\n    button {\n      flex: 0 0 1rem;\n    }\n  }\n</style>\n","import { mount } from 'svelte';\nimport SvelteFormApplicationBase from '../SvelteFormApplicationBase';\nimport MaxPreparedSpellsConfig from './MaxPreparedSpellsConfig.svelte';\nimport type { Actor5e, MaxPreparedSpellFormula } from 'src/types/types';\nimport type { Item5e } from 'src/types/item.types';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { getMaxPreparedSpellsSampleFormulas } from 'src/utils/formula';\n\nexport type MaxPreparedSpellsConfigContext = {\n  maxPreparedSpells: string;\n  formulas: MaxPreparedSpellFormula[];\n};\n\nexport class MaxPreparedSpellsConfigFormApplication extends SvelteFormApplicationBase {\n  context = $state<MaxPreparedSpellsConfigContext>();\n  actor: Actor5e;\n  classToUpdate: Item5e;\n\n  constructor(documentName: string, classToUpdate: Item5e, ...args: any[]) {\n    super(...args);\n    this.documentName = documentName;\n    this.classToUpdate = classToUpdate;\n\n    this.context = {\n      maxPreparedSpells: '',\n      formulas: getMaxPreparedSpellsSampleFormulas(),\n    };\n  }\n\n  createComponent(node: HTMLElement): Record<string, any> {\n    this.context = this.getData();\n\n    return mount(MaxPreparedSpellsConfig, {\n      target: node,\n      context: new Map<any, any>([\n        ['context', this.context],\n        ['appId', this.appId],\n      ]),\n    });\n  }\n\n  getData(): MaxPreparedSpellsConfigContext {\n    return {\n      maxPreparedSpells:\n        this.classToUpdate?.system?.spellcasting?.preparation?.formula ?? '',\n      formulas: getMaxPreparedSpellsSampleFormulas(),\n    };\n  }\n\n  static get defaultOptions() {\n    return FoundryAdapter.mergeObject(super.defaultOptions, {\n      width: 500,\n      height: 'auto',\n      sheetConfig: false,\n      resizable: false,\n    });\n  }\n\n  get title() {\n    return FoundryAdapter.localize('TIDY5E.MaxPreparedSpellsConfig.Title', {\n      documentName: this.documentName,\n    });\n  }\n\n  async _updateObject(): Promise<void> {\n    await this.classToUpdate.update({\n      'system.spellcasting.preparation.formula':\n        this.context?.maxPreparedSpells ?? '',\n    });\n    this.close();\n  }\n}\n","<script lang=\"ts\">\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import Select from 'src/components/inputs/Select.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n  import { MaxPreparedSpellsConfigFormApplication } from 'src/applications/max-prepared-spells-config/MaxPreparedSpellsConfigFormApplication.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"form-group\">\n  <label for=\"{appId}-spellcasting-progression\"\n    >{localize('DND5E.SpellProgression')}</label\n  >\n  <div class=\"form-fields\">\n    <Select\n      id=\"{appId}-spellcasting-progression\"\n      document={context.item}\n      field=\"system.spellcasting.progression\"\n      value={context.system.spellcasting.progression}\n      disabled={!context.editable}\n    >\n      <SelectOptions data={context.config.spellProgression} />\n    </Select>\n  </div>\n</div>\n\n<div class=\"form-group\">\n  <label for=\"{appId}-spellcasting-ability\"\n    >{localize('DND5E.SpellAbility')}</label\n  >\n  <div class=\"form-fields\">\n    <Select\n      id=\"{appId}-spellcasting-ability\"\n      document={context.item}\n      field=\"system.spellcasting.ability\"\n      value={context.system.spellcasting.ability}\n      disabled={!context.editable}\n    >\n      <SelectOptions\n        data={context.config.abilities}\n        labelProp=\"label\"\n        blank=\"\"\n      />\n    </Select>\n  </div>\n</div>\n\n<div class=\"form-group\">\n  <label for=\"{appId}-spellcasting-preparation-formula\"\n    >{localize('DND5E.SpellPreparation.Formula')}</label\n  >\n  <div class=\"form-fields\">\n    <TextInput\n      id=\"{appId}-spellcasting-preparation-formula\"\n      document={context.item}\n      field=\"system.spellcasting.preparation.formula\"\n      value={context.system.spellcasting.preparation.formula}\n      dataset={{ formulaEditor: true }}\n      disabled={!context.editable}\n    />\n    <a\n      title={localize('TIDY5E.MaxPreparedSpellsConfig.ExamplesHeader')}\n      class=\"spell-preparation-search inline-icon-button\"\n      onclick={() => {\n        new MaxPreparedSpellsConfigFormApplication(\n          context.item.name,\n          context.item,\n        ).render(true);\n      }}><i class=\"fa-solid fa-search fa-fw\"></i></a\n    >\n  </div>\n</div>\n","<script lang=\"ts\">\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import Select from 'src/components/inputs/Select.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import DetailsSpellcasting from '../parts/DetailsSpellcasting.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import ItemStartingEquipment from '../parts/ItemStartingEquipment.svelte';\n  import { mapMulticlassingAbilitiesToSave } from 'src/utils/system-properties';\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  let abilities = $derived(\n    Object.entries<any>(context.config.abilities).map(([key, value]) => ({\n      key: key,\n      label: value.label,\n    })),\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<h3 class=\"form-header\">{localize('DND5E.ItemClassDetails')}</h3>\n\n<div class=\"form-group\">\n  <label for=\"{appId}-identifier\">{localize('DND5E.Identifier')}</label>\n  <div class=\"form-fields\">\n    <TextInput\n      id=\"{appId}-identifier\"\n      document={context.item}\n      field=\"system.identifier\"\n      value={context.source.identifier}\n      placeholder={context.item.identifier}\n      disabled={!context.editable}\n    />\n  </div>\n  <p class=\"hint\">\n    {@html localize('DND5E.ClassIdentifierHint', {\n      identifier: context.item.identifier,\n    })}\n    {localize('DND5E.IdentifierError')}\n  </p>\n</div>\n\n<div class=\"form-group split-group\">\n  <label for=\"{appId}-hit-dice\">{localize('DND5E.CLASS.FIELDS.hd.label')}</label\n  >\n  <div class=\"form-fields\">\n    <div class=\"form-group label-top\">\n      <label for=\"{appId}-hit-dice\">{localize('DND5E.Denomination')}</label>\n      <Select\n        id=\"{appId}-hit-dice\"\n        document={context.item}\n        field=\"system.hd.denomination\"\n        value={context.source.hd.denomination}\n        disabled={!context.editable}\n      >\n        {#each context.config.hitDieTypes as type}\n          <option value={type}>{type}</option>\n        {/each}\n      </Select>\n    </div>\n\n    <div class=\"form-group label-top\">\n      <label for=\"{appId}-hit-dice-spent\"\n        >{localize('DND5E.CLASS.FIELDS.hd.spent.label')}</label\n      >\n      <NumberInput\n        id=\"{appId}-hitDiceUsed\"\n        document={context.item}\n        field=\"system.hd.spent\"\n        value={context.source.hd.spent}\n        placeholder=\"0\"\n        disabled={!context.editable}\n      />\n    </div>\n  </div>\n</div>\n\n<div class=\"form-group\">\n  <label>{localize('DND5E.CLASS.FIELDS.hd.additional.label')}</label>\n  <div class=\"form-fields\">\n    <TextInput\n      document={context.item}\n      field=\"system.hd.additional\"\n      value={context.source.hd.additional}\n    />\n  </div>\n  <p class=\"hint\">\n    {localize('DND5E.CLASS.FIELDS.hd.additional.hint')}\n  </p>\n</div>\n\n<h3 class=\"form-header\">{localize('DND5E.ItemClassDetails')}</h3>\n\n<div class=\"form-group stacked primary-abilities\">\n  <label for=\"\"\n    >{localize('DND5E.CLASS.FIELDS.primaryAbility.value.label')}</label\n  >\n  {#each abilities as { key, label } (key)}\n    <Checkbox\n      id=\"{appId}-primaryAbility-value-{key?.slugify()}\"\n      labelCssClass=\"checkbox\"\n      document={context.item}\n      field=\"system.primaryAbility.value\"\n      checked={context.system.primaryAbility.value.has(key)}\n      value={key}\n      disabled={!context.editable}\n      onDataPreparing={(ev) => mapMulticlassingAbilitiesToSave(context, ev)}\n    >\n      {label}\n    </Checkbox>\n  {/each}\n  <p class=\"hint\">{localize('DND5E.CLASS.FIELDS.primaryAbility.value.hint')}</p>\n</div>\n\n{#if context.source.primaryAbility.value.size > 1}\n  <div class=\"form-group\">\n    <label for=\"{appId}-primaryAbility-fields-all\"\n      >{localize('DND5E.CLASS.FIELDS.primaryAbility.all.label')}</label\n    >\n    <Checkbox\n      id=\"{appId}-primaryAbility-fields-all\"\n      document={context.item}\n      field=\"system.primaryAbility.fields.all\"\n      checked={context.source.primaryAbility.all}\n      disabled={!context.editable}\n    />\n\n    <p class=\"hint\">{localize('DND5E.CLASS.FIELDS.primaryAbility.all.hint')}</p>\n  </div>\n{/if}\n\n<h3 class=\"form-header\">{localize('DND5E.Spellcasting')}</h3>\n<DetailsSpellcasting />\n\n<ItemStartingEquipment />\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import Select from 'src/components/inputs/Select.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import { mapSystemDamageTypesToSave } from 'src/utils/system-properties';\n  import type { GroupableSelectOption } from 'src/types/types';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    source: any;\n    prefix: string;\n    denominationOptions: GroupableSelectOption[];\n    numberPlaceholder?: string;\n    types?: { label: string; value: string; selected: boolean }[] | undefined;\n  }\n\n  let {\n    source,\n    prefix,\n    denominationOptions,\n    numberPlaceholder = '',\n    types = undefined,\n  }: Props = $props();\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n  let idPrefix = $derived(`${appId}-${prefix.replaceAll('.', '-')}`);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<!-- Custom Formula -->\n<div class=\"form-group split-group\">\n  <label for=\"{idPrefix}custom-enabled\">Formula</label>\n  <div class=\"form-fields\">\n    <Checkbox\n      id=\"{idPrefix}custom-enabled\"\n      document={context.item}\n      field=\"{prefix}custom.enabled\"\n      checked={source.custom.enabled}\n      disabled={!context.editable}\n    />\n\n    {#if source.custom.enabled}\n      <TextInput\n        id=\"{idPrefix}custom-formula\"\n        document={context.item}\n        field=\"{prefix}custom.formula\"\n        value={source.custom.formula}\n        disabled={!context.editable}\n      />\n    {/if}\n  </div>\n</div>\n\n<!-- Simple Input -->\n{#if !source.custom.enabled}\n  <div class=\"form-group split-group\">\n    <label for=\"{idPrefix}number\"\n      >{context.system.damage.heal\n        ? localize('DND5E.HEAL.Title')\n        : localize('DND5E.DAMAGE.Title')}</label\n    >\n    <div class=\"form-fields\">\n      <div class=\"form-group label-top\">\n        <label for=\"{idPrefix}number\">{localize('DND5E.Number')}</label>\n        <!-- Number -->\n        <NumberInput\n          id=\"{idPrefix}number\"\n          document={context.item}\n          field=\"{prefix}number\"\n          value={source.number}\n          placeholder={numberPlaceholder}\n          min=\"0\"\n          step=\"1\"\n          disabled={!context.editable}\n        />\n      </div>\n\n      <!-- Die -->\n      <div class=\"form-group label-top\">\n        <label for=\"{idPrefix}denomination\">{localize('DND5E.Die')}</label>\n        <Select\n          id=\"{idPrefix}denomination\"\n          document={context.item}\n          field=\"{prefix}denomination\"\n          value={source.denomination}\n          blankValue=\"\"\n          disabled={!context.editable}\n        >\n          <SelectOptions\n            data={denominationOptions}\n            labelProp=\"label\"\n            valueProp=\"value\"\n          />\n        </Select>\n      </div>\n\n      <!-- Bonus -->\n      <div class=\"form-group label-top\">\n        <label for=\"{idPrefix}bonus\">\n          {localize('DND5E.Bonus')}\n        </label>\n        <TextInput\n          id=\"{idPrefix}bonus\"\n          document={context.item}\n          field=\"{prefix}bonus\"\n          value={source.bonus}\n          disabled={!context.editable}\n        />\n      </div>\n    </div>\n  </div>\n{/if}\n\n<!-- Types -->\n{#if types}\n  <div class=\"form-group stacked damage-types\">\n    <label for=\"\">{localize('DND5E.Type')}</label>\n    {#each types as { value, label, selected } (value)}\n      <Checkbox\n        id=\"{idPrefix}types-{value?.slugify()}\"\n        labelCssClass=\"checkbox\"\n        document={context.item}\n        field=\"{prefix}types\"\n        checked={selected}\n        {value}\n        disabled={!context.editable}\n        onDataPreparing={(ev) =>\n          mapSystemDamageTypesToSave(context, prefix, source, ev)}\n      >\n        {label}\n      </Checkbox>\n    {/each}\n  </div>\n{/if}\n","<script lang=\"ts\">\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<h3 class=\"form-header\">{localize('DND5E.Usage')}</h3>\n\n<!-- Uses -->\n<div class=\"form-group split-group\">\n  <label for=\"{appId}-uses-spent\">{localize('DND5E.LimitedUses')}</label>\n  <div class=\"form-fields\">\n    <!-- Spent  -->\n    <div class=\"form-group label-top\">\n      <label for=\"{appId}-uses-spent\">{localize('DND5E.Spent')}</label>\n      <NumberInput\n        id=\"{appId}-uses-spent\"\n        document={context.item}\n        field=\"system.uses.spent\"\n        value={context.source.uses.spent}\n        disabled={!context.editable}\n      />\n    </div>\n\n    <!-- Max -->\n    <div class=\"form-group label-top\">\n      <label for=\"{appId}-uses-max\">{localize('DND5E.Max')}</label>\n      <TextInput\n        id=\"{appId}-uses-max\"\n        document={context.item}\n        field=\"system.uses.max\"\n        value={context.source.uses.max}\n        disabled={!context.editable}\n      />\n    </div>\n  </div>\n</div>\n\n<!-- Auto-Destroy -->\n{#if context.system.schema.fields.uses?.fields?.autoDestroy}\n  <div class=\"form-group\">\n    <label for=\"{appId}-uses-autoDestroy\"\n      >{localize('DND5E.CONSUMABLE.FIELDS.uses.autoDestroy.label')}</label\n    >\n    <Checkbox\n      id=\"{appId}-uses-autoDestroy\"\n      document={context.item}\n      field=\"system.uses.autoDestroy\"\n      checked={context.source.uses.autoDestroy}\n      disabled={!context.editable}\n    />\n    <p class=\"hint\">\n      {localize('DND5E.CONSUMABLE.FIELDS.uses.autoDestroy.hint')}\n    </p>\n  </div>\n{/if}\n\n{#if context.item.hasLimitedUses}\n  <h3 class=\"form-header\">\n    <span>\n      {localize('DND5E.Recovery')}\n    </span>\n    {#if context.editable}\n      <button\n        type=\"button\"\n        class=\"inline-icon-button create-recovery-button\"\n        data-tooltip=\"DND5E.USES.Recovery.Action.Create\"\n        aria-label={localize('DND5E.USES.Recovery.Action.Create')}\n        onclick={() => context.item.sheet.addRecovery()}\n        tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n      >\n        <i class=\"fas fa-plus\"></i>\n      </button>\n    {/if}\n  </h3>\n\n  {#each context.usesRecovery as recovery, index}\n    <div class=\"form-group split-group full-width card\" data-index={index}>\n      <div class=\"form-fields\">\n        <!-- Period -->\n        <div class=\"form-group label-top\">\n          <label for=\"{appId}-uses-recovery-{index}-period\">\n            {localize('DND5E.USES.FIELDS.uses.recovery.FIELDS.period.label')}\n          </label>\n          <select\n            id=\"{appId}-uses-recovery-{index}-period\"\n            data-tidy-field=\"system.uses.recovery.{index}.period\"\n            value={recovery.data.period}\n            onchange={(ev) =>\n              context.item.sheet.updateRecovery(\n                index,\n                'period',\n                ev.currentTarget.value,\n              )}\n            disabled={!context.editable}\n          >\n            <SelectOptions\n              data={context.recoveryPeriods}\n              labelProp=\"label\"\n              valueProp=\"value\"\n            />\n          </select>\n        </div>\n\n        <!-- Type -->\n        {#if recovery.data.period !== 'recharge'}\n          <div class=\"form-group label-top\">\n            <label for=\"{appId}-uses-recovery-{index}-type\">\n              {localize('DND5E.USES.FIELDS.uses.recovery.FIELDS.type.label')}\n            </label>\n            <select\n              id=\"{appId}-uses-recovery-{index}-type\"\n              data-tidy-field=\"system.uses.recovery.{index}.type\"\n              value={recovery.data.type}\n              onchange={(ev) =>\n                context.item.sheet.updateRecovery(\n                  index,\n                  'type',\n                  ev.currentTarget.value,\n                )}\n              disabled={!context.editable}\n            >\n              <SelectOptions\n                data={context.recoveryTypes}\n                labelProp=\"label\"\n                valueProp=\"value\"\n              />\n            </select>\n          </div>\n        {/if}\n\n        <!-- Formula -->\n        {#if recovery.data.type === 'formula' || recovery.formulaOptions}\n          <div class=\"form-group label-top\">\n            <label for=\"{appId}-uses-recovery-{index}-formula\">\n              {localize('DND5E.USES.FIELDS.uses.recovery.FIELDS.formula.label')}\n            </label>\n            {#if recovery.formulaOptions}\n              <select\n                id=\"{appId}-uses-recovery-{index}-formula\"\n                data-tidy-field=\"system.uses.recovery.{index}.formula\"\n                onchange={(ev) =>\n                  context.item.sheet.updateRecovery(\n                    index,\n                    'formula',\n                    ev.currentTarget.value,\n                  )}\n                value={recovery.data.formula}\n                disabled={!context.editable}\n              >\n                <SelectOptions\n                  data={recovery.formulaOptions}\n                  labelProp=\"label\"\n                  valueProp=\"value\"\n                />\n              </select>\n            {:else if recovery.data.type === 'formula'}\n              <input\n                type=\"text\"\n                id=\"{appId}-uses-recovery-{index}-formula\"\n                data-tidy-field=\"system.uses.recovery.{index}.formula\"\n                onchange={(ev) =>\n                  context.item.sheet.updateRecovery(\n                    index,\n                    'formula',\n                    ev.currentTarget.value,\n                  )}\n                disabled={!context.editable}\n                value={recovery.data.formula ?? ''}\n              />\n            {/if}\n          </div>\n        {/if}\n\n        {#if context.editable}\n          <button\n            type=\"button\"\n            class=\"inline-icon-button align-self-stretch\"\n            data-action=\"deleteRecovery\"\n            title={localize('DND5E.USES.Recovery.Action.Delete')}\n            aria-label={localize('DND5E.USES.Recovery.Action.Delete')}\n            onclick={() => context.item.sheet.deleteRecovery(index)}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n          >\n            <i class=\"fas fa-minus\"></i>\n          </button>\n        {/if}\n      </div>\n    </div>\n  {:else}\n    <div class=\"empty\">{localize('DND5E.USES.Recovery.Never')}</div>\n  {/each}\n{/if}\n","<script lang=\"ts\">\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import Select from 'src/components/inputs/Select.svelte';\n  import ItemProperties from '../parts/ItemProperties.svelte';\n  import ContentConcealer from 'src/components/content-concealment/ContentConcealer.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import FieldDamage from '../parts/FieldDamage.svelte';\n  import FieldUses from '../parts/FieldUses.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<ContentConcealer conceal={context.concealDetails}>\n  <h3 class=\"form-header\">{localize('DND5E.ItemConsumableDetails')}</h3>\n\n  <div class=\"form-group\">\n    <label for=\"{appId}-type-value\"\n      >{localize('DND5E.ItemConsumableType')}</label\n    >\n    <Select\n      id=\"{appId}-type-value\"\n      document={context.item}\n      field=\"system.type.value\"\n      value={context.system.type.value}\n      disabled={!context.editable}\n      blankValue=\"\"\n    >\n      <SelectOptions\n        data={context.config.consumableTypes}\n        labelProp=\"label\"\n        blank=\"\"\n      />\n    </Select>\n  </div>\n  {#if context.itemSubtypes}\n    {@const consumableSubTypeLabel = localize('DND5E.ItemConsumableSubtype', {\n      category:\n        // @ts-expect-error\n        context.config.consumableTypes[context.system.type.value]?.label,\n    })}\n\n    <div class=\"form-group\">\n      <label for=\"{appId}-type-subtype\">{consumableSubTypeLabel}</label>\n      <Select\n        id=\"{appId}-type-subtype\"\n        document={context.item}\n        field=\"system.type.subtype\"\n        value={context.system.type.subtype}\n        disabled={!context.editable}\n      >\n        <SelectOptions data={context.itemSubtypes} blank=\"\" />\n      </Select>\n    </div>\n  {/if}\n\n  <div class=\"form-group stacked consumable-properties\">\n    <label for=\"\"\n      >{context.system.type.value === 'ammo'\n        ? localize('DND5E.ItemAmmoProperties')\n        : localize('DND5E.ItemConsumableProperties')}</label\n    >\n    <ItemProperties />\n  </div>\n\n  {#if context.properties.object.mgc}\n    <!-- Attunement -->\n    <div class=\"form-group\">\n      <label for=\"${appId}-system-attunement\"\n        >{localize('DND5E.Item.Property.Magical')}</label\n      >\n      <div class=\"form-fields\">\n        <div class=\"form-group label-top no-gap\">\n          <label for=\"${appId}-system-attuned\">\n            {localize('DND5E.Attunement')}\n          </label>\n          <div class=\"form-fields\">\n            <!-- Attuned -->\n            <Checkbox\n              id=\"${appId}-system-attuned\"\n              document={context.item}\n              field=\"system.attuned\"\n              checked={context.source.attuned}\n              disabled={!context.editable ||\n                // @ts-expect-error\n                !context.config.attunementTypes[context.system.attunement]}\n              title={localize('DND5E.AttunementAttuned')}\n            />\n            <!-- Attunement -->\n            <Select\n              id=\"${appId}-system-attunement\"\n              document={context.item}\n              field=\"system.attunement\"\n              value={context.system.attunement}\n              disabled={!context.editable}\n              class=\"flex-1\"\n            >\n              <SelectOptions\n                data={context.config.attunementTypes}\n                blank={localize('DND5E.AttunementNone')}\n              />\n            </Select>\n          </div>\n        </div>\n        <!-- Magical Bonus for Ammo -->\n        {#if context.system.type.value === CONSTANTS.ITEM_SYSTEM_TYPE_AMMO}\n          <div class=\"form-group label-top\">\n            <label for=\"{appId}-magical-bonus\">{localize('DND5E.Bonus')}</label>\n            <NumberInput\n              id=\"{appId}-magical-bonus\"\n              value={context.system.magicalBonus}\n              field=\"system.magicalBonus\"\n              document={context.item}\n              disabled={!context.editable}\n              min=\"0\"\n              step=\"1\"\n              placeholder=\"0\"\n            />\n          </div>\n        {/if}\n      </div>\n    </div>\n  {/if}\n\n  <h3 class=\"form-header\">\n    {localize('DND5E.CONSUMABLE.FIELDS.damage.label')}\n  </h3>\n\n  <div class=\"form-group\">\n    <label for=\"{appId}-damage-replace\"\n      >{localize('DND5E.CONSUMABLE.FIELDS.damage.replace.label')}</label\n    >\n    <Checkbox\n      id=\"{appId}-damage-replace\"\n      document={context.item}\n      field=\"system.damage.replace\"\n      checked={context.source.damage.replace}\n      disabled={!context.editable}\n    />\n    <p class=\"hint\">\n      {localize('DND5E.CONSUMABLE.FIELDS.damage.replace.hint')}\n    </p>\n  </div>\n\n  {#if context.system.type.value === CONSTANTS.ITEM_SYSTEM_TYPE_AMMO}\n    <FieldDamage\n      prefix=\"system.damage.base.\"\n      source={context.source.damage.base}\n      denominationOptions={context.denominationOptions}\n      types={context.damageTypes}\n    />\n  {/if}\n\n  <FieldUses />\n</ContentConcealer>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { Item5e } from 'src/types/item.types';\n  import type { ContainerCapacityContext } from 'src/types/types';\n\n  interface Props {\n    container: Item5e;\n    capacity: ContainerCapacityContext;\n    showLabel?: boolean;\n  }\n\n  let { container, capacity, showLabel = true }: Props = $props();\n\n  let readableValue = $derived(\n    container.system.capacity.type === CONSTANTS.ITEM_CAPACITY_TYPE_WEIGHT\n      ? (capacity.value ?? 0).toFixed(2)\n      : Math.ceil(capacity.value ?? 0),\n  );\n\n  let capacityMaxLabel = $derived(\n    capacity.max === Infinity ? '' : capacity.max,\n  );\n\n  let capacityLabel = $derived(\n    `${readableValue}/${capacityMaxLabel} ${capacity.units ?? ''}`,\n  );\n\n  let percentage = $derived(Math.round(capacity.pct));\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div\n  class=\"tidy-capacity\"\n  role=\"meter\"\n  aria-label={localize('DND5E.CONTAINER.FIELDS.capacity.label')}\n  title={capacityLabel}\n  aria-valuetext={capacityLabel}\n  aria-valuemin=\"0\"\n  aria-valuenow={capacity.value}\n  aria-valuemax={capacity.max}\n  style=\"--percentage: {percentage}%\"\n  class:empty={percentage === 0}\n>\n  {#if showLabel}\n    <span class=\"capacity-label\">\n      <span>{readableValue}</span>\n      <span>/</span>\n      <span>{capacityMaxLabel}</span>\n      {#if capacity.units}\n        <span>{capacity.units}</span>\n      {/if}\n    </span>\n  {/if}\n</div>\n\n<style lang=\"scss\">\n  .tidy-capacity {\n    position: relative;\n    height: var(--capacity-bar-height, 1.25rem);\n    border-radius: var(--capacity-bar-container-border-radius, 0.1875rem);\n    background: var(--t5e-light-color);\n    border: 0.0625rem solid var(--t5e-separator-color);\n\n    &:not(.empty)::before {\n      content: '';\n      position: absolute;\n      inline-size: var(--percentage);\n      inset: 0;\n      max-inline-size: calc(100% - 0.25rem);\n      margin: 0.0625rem;\n      border: 0.0625rem solid var(--t5e-encumbrance-bar-outline-color);\n      border-radius: 0.125rem;\n      background: var(--t5e-encumbrance-bar-background);\n      transition: width 0.5s ease;\n    }\n\n    .capacity-label {\n      font-size: 0.8125rem;\n      display: flex;\n      gap: 0.25rem;\n      align-items: center;\n      justify-content: center;\n      line-height: normal;\n      \n      position: relative;\n      width: 100%;\n      text-align: center;\n      color: var(--t5e-encumbrance-text-color);\n      text-shadow:\n        0 0 0.125rem var(--t5e-encumbrance-bar-text-shadow-color),\n        0 0 0.125rem var(--t5e-encumbrance-bar-text-shadow-color),\n        0 0 0.125rem var(--t5e-encumbrance-bar-text-shadow-color);\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type {\n    ContainerSheetClassicContext,\n    Item5e,\n  } from 'src/types/item.types';\n  import type { Actor5e } from 'src/types/types';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n\n  interface Props {\n    document: Actor5e | Item5e;\n  }\n\n  let { document }: Props = $props();\n\n  let context = $derived(getSheetContext<\n    ActorSheetContextV1 | ContainerSheetClassicContext\n  >());\n\n  let currencies = $derived(\n    Object.keys(CONFIG.DND5E.currencies).map((key) => ({\n      key: key,\n      value: (document.system.currency[key] ?? 0) as number,\n    })),\n  );\n\n  function confirmConvertCurrency() {\n    new dnd5e.applications.CurrencyManager(document).render(true);\n  }\n\n  function abbreviateCurrency(currencyKey: string) {\n    return (\n      CONFIG.DND5E.currencies[\n        currencyKey as keyof typeof CONFIG.DND5E.currencies\n      ]?.abbreviation ?? currencyKey\n    );\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"inventory-currency\">\n  <ol class=\"currency\">\n    {#each currencies as currency}\n      <li\n        class=\"currency-item {currency.key}\"\n        title={context.config.currencies[currency.key]?.label}\n      >\n        <TextInput\n          {document}\n          field=\"system.currency.{currency.key}\"\n          id=\"{document.id}-system.currency.{currency.key}\"\n          value={currency.value}\n          allowDeltaChanges={true}\n          selectOnFocus={true}\n          disabled={!context.editable || context.lockMoneyChanges}\n        />\n        <label\n          for=\"{document.id}-system.currency.{currency.key}\"\n          class=\"denomination {currency.key}\"\n          data-denom={currency.key}>{abbreviateCurrency(currency.key)}</label\n        >\n      </li>\n    {/each}\n    <li class=\"currency-item convert\">\n      <button\n        type=\"button\"\n        class=\"currency-convert\"\n        title={localize('DND5E.CurrencyManager.Title')}\n        onclick={(event) => {\n          event.preventDefault();\n          event.stopPropagation();\n          confirmConvertCurrency();\n        }}\n        disabled={!context.editable}\n        tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n      >\n        <i class=\"fas fa-coins\"></i>\n      </button>\n    </li>\n  </ol>\n</div>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import type { Snippet } from 'svelte';\n  \n  interface Props {\n    children?: Snippet;\n    [key: string]: any;\n  }\n\n  let { ...props }: Props = $props();\n</script>\n\n<section\n  class=\"utility-toolbar {props.class ?? ''}\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.UTILITY_TOOLBAR}\n>\n  {@render props.children?.()}\n</section>\n\n<style lang=\"scss\">\n  .utility-toolbar {\n    --vertical-padding-internal: 0.375rem;\n    display: flex;\n    gap: 0.5rem;\n    align-items: center;\n    border-bottom: 0.0625rem solid var(--t5e-separator-color);\n    margin-bottom: var(--utility-toolbar-margin-bottom, 0.25rem);\n    margin-left: var(--utility-toolbar-margin-left, -1rem);\n    margin-right: var(--utility-toolbar-margin-right, -0.25rem);\n    margin-top: var(\n      --utility-toolbar-margin-top,\n      calc(\n        var(--vertical-padding-internal) - var(\n            --t5e-classic-tab-contents-padding-top\n          )\n      )\n    );\n    padding-bottom: var(--vertical-padding-internal);\n    padding-left: var(--utility-toolbar-padding-left, 1rem);\n    padding-right: var(--utility-toolbar-padding-right, 1.75rem);\n  }\n</style>\n","<script lang=\"ts\">\n  import { isNil } from 'src/utils/data';\n  import type { UtilityToolbarCommandExecuteEvent } from './types';\n  import { settings } from 'src/settings/settings.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { TidySectionBase } from 'src/types/types';\n\n  interface Props {\n    title?: string | undefined;\n    iconClass?: string | undefined;\n    text?: string | undefined;\n    visible?: boolean;\n    sections?: TidySectionBase[];\n    onExecute?: (event: UtilityToolbarCommandExecuteEvent) => void;\n  }\n\n  let {\n    title = undefined,\n    iconClass = undefined,\n    text = undefined,\n    visible = true,\n    sections = [],\n    onExecute,\n  }: Props = $props();\n\n  const context = $derived(getSheetContext<unknown>());\n</script>\n\n<button\n  type=\"button\"\n  class=\"inline-icon-button\"\n  class:hidden={!visible}\n  onclick={(ev) => onExecute?.({ event: ev, context: context, sections })}\n  {title}\n  tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.UTILITY_TOOLBAR_COMMAND}\n>\n  {#if !isNil(iconClass, '')}\n    <i class={iconClass}></i>\n  {/if}\n  {#if !isNil(text, '')}\n    {text}\n  {/if}\n</button>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import type { LocationToSearchTextMap, OnSearchFn } from 'src/types/types';\n  import { getContext, onMount } from 'svelte';\n\n  interface Props {\n    value: string;\n  }\n\n  let { value = $bindable() }: Props = $props();\n\n  async function rememberSearch() {\n    onSearch?.(location, value);\n  }\n\n  async function clearSearch() {\n    value = '';\n    rememberSearch();\n  }\n\n  const searchFilters = getContext<LocationToSearchTextMap>(\n    CONSTANTS.SVELTE_CONTEXT.SEARCH_FILTERS,\n  );\n  const onSearch = getContext<OnSearchFn>(CONSTANTS.SVELTE_CONTEXT.ON_SEARCH);\n  const location = getContext<string>(CONSTANTS.SVELTE_CONTEXT.LOCATION);\n\n  const localize = FoundryAdapter.localize;\n\n  onMount(() => {\n    value = searchFilters?.get(location) ?? '';\n  });\n</script>\n\n<div\n  class=\"search-container\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.SEARCH_CONTAINER}\n>\n  <input\n    class=\"search\"\n    type=\"text\"\n    title={localize('TIDY5E.SearchHint')}\n    placeholder={localize('TIDY5E.Search')}\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.SEARCH_INPUT}\n    bind:value\n    onblur={(event) => {\n      event.preventDefault();\n      event.stopPropagation();\n      rememberSearch();\n    }}\n  />\n  {#if value?.trim() !== ''}\n    <button\n      class=\"inline-icon-button search-close-button\"\n      onclick={() => clearSearch()}\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.SEARCH_CLEAR}\n      tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n    >\n      <i class=\"fas fa-times\"></i>\n    </button>\n  {/if}\n</div>\n\n<style lang=\"scss\">\n  .search-container {\n    flex-grow: 1;\n    position: relative;\n    align-self: stretch;\n    display: flex;\n    align-items: stretch;\n\n    .search {\n      height: unset;\n      border-radius: 0.3125rem;\n      padding-left: 0.25rem;\n      padding-right: 0.25rem;\n      border: 0.0625rem solid var(--t5e-light-color);\n      font-size: 0.75rem;\n\n      &:focus,\n      &:hover {\n        border-color: none;\n      }\n    }\n\n    .search-close-button {\n      position: absolute;\n      right: 0.375rem;\n      top: 0.5rem;\n      color: var(--t5e-tertiary-color);\n      font-size: 0.75rem;\n    }\n  }\n</style>\n","const filterCycle = [null, true, false] as const;\n\nexport function cycleNullTrueFalseForward(currentValue: boolean | null) {\n  const currentValueIndex = filterCycle.indexOf(currentValue);\n  return filterCycle[(currentValueIndex + 1) % filterCycle.length];\n}\n\nexport function cycleNullTrueFalseBackward(currentValue: boolean | null) {\n  const currentValueIndex = filterCycle.indexOf(currentValue);\n  return filterCycle.at(currentValueIndex - 1) ?? null;\n}\n","<script lang=\"ts\">\n  import type { ItemFilterService } from 'src/features/filtering/ItemFilterService.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { ConfiguredItemFilter } from 'src/runtime/item/item.types';\n  import { settings } from 'src/settings/settings.svelte';\n  import {\n    cycleNullTrueFalseForward,\n    cycleNullTrueFalseBackward,\n  } from 'src/utils/value-cycling';\n  import { getContext, type Snippet } from 'svelte';\n\n  interface Props {\n    filter: ConfiguredItemFilter;\n    filterGroupName: string;\n    children?: Snippet;\n  }\n\n  let { filter, filterGroupName, children }: Props = $props();\n  const onFilter = getContext<ItemFilterService['onFilter']>('onFilter');\n\n  function cycleFilterForward(name: string, currentValue: boolean | null) {\n    onFilter(filterGroupName, name, cycleNullTrueFalseForward(currentValue));\n  }\n\n  function cycleFilterBackward(name: string, currentValue: boolean | null) {\n    onFilter(filterGroupName, name, cycleNullTrueFalseBackward(currentValue));\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<button\n  type=\"button\"\n  class=\"filter-toggle-button pill-button truncate\"\n  class:include={filter.value === true}\n  class:exclude={filter.value === false}\n  onclick={() => cycleFilterForward(filter.name, filter.value)}\n  oncontextmenu={() => cycleFilterBackward(filter.name, filter.value)}\n  tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n  title={localize(filter.text)}\n>\n  {@render children?.()}\n</button>\n","<script lang=\"ts\">\n  import ButtonMenu from '../button-menu/ButtonMenu.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getContext, type Snippet } from 'svelte';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n  import FilterToggleButton from './FilterToggleButton.svelte';\n  import type { ItemFilterService } from 'src/features/filtering/ItemFilterService.svelte';\n  import ButtonMenuDivider from 'src/components/button-menu/ButtonMenuDivider.svelte';\n  import type { ContainerSheetClassicContext } from 'src/types/item.types';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    tabId: string;\n    beforeClearButton?: Snippet;\n  }\n\n  let { tabId, beforeClearButton }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n  const context =\n    $derived(\n      getSheetContext<ActorSheetContextV1 | ContainerSheetClassicContext>(),\n    );\n  const onFilterClearAll =\n    getContext<ItemFilterService['onFilterClearAll']>('onFilterClearAll');\n  let categories = $derived(context.filterData[tabId] ?? {});\n  let hasActiveFilters = $derived(\n    Object.entries(categories).some(([_, filters]) =>\n      filters.some((f) => f.value !== null),\n    ),\n  );\n\n  let menuOpen = $state(false);\n</script>\n\n<div role=\"presentation\" class=\"filter-menu\">\n  <ButtonMenu\n    iconClass=\"fas fa-filter\"\n    buttonClass=\"filter-menu-button {hasActiveFilters\n      ? 'has-active-filters'\n      : ''} {menuOpen ? 'menu-is-open' : ''}\"\n    position=\"bottom\"\n    anchor=\"right\"\n    title={localize('TIDY5E.ItemFilters.MenuTooltip.Filters')}\n    bind:open={menuOpen}\n    menuElement=\"div\"\n    buttonStyle=\"transparent-inline-icon\"\n  >\n    {#each Object.entries(categories) as [category, filters] (category)}\n      <section class=\"filter-group\">\n        <h4 class=\"filter-group-header\">\n          {localize(category)}\n        </h4>\n        <div class=\"filters\">\n          {#each filters as filter (filter.text)}\n            <FilterToggleButton filterGroupName={tabId} {filter}>\n              {localize(filter.text)}\n            </FilterToggleButton>\n          {/each}\n        </div>\n      </section>\n    {/each}\n\n    {#if beforeClearButton}\n      <ButtonMenuDivider />\n      {@render beforeClearButton()}\n    {/if}\n\n    <ButtonMenuDivider />\n    <section class=\"filter-footer flex-row justify-content-center\">\n      <button\n        type=\"button\"\n        class=\"clear-all-button pill-button flex-row extra-small-gap align-items-center\"\n        onclick={(ev) => {\n          onFilterClearAll(tabId);\n          menuOpen = false;\n        }}\n      >\n        <i class=\"fas fa-filter-slash\"></i>\n        {localize('TIDY5E.ItemFilters.ClearAll')}</button\n      >\n    </section>\n  </ButtonMenu>\n</div>\n","<script lang=\"ts\">\n  import type { ItemFilterService } from 'src/features/filtering/ItemFilterService.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { ConfiguredItemFilter } from 'src/runtime/item/item.types';\n  import { settings } from 'src/settings/settings.svelte';\n  import {\n    cycleNullTrueFalseForward,\n    cycleNullTrueFalseBackward,\n  } from 'src/utils/value-cycling';\n  import { getContext, type Snippet } from 'svelte';\n\n  interface Props {\n    filter: ConfiguredItemFilter;\n    filterGroupName: string;\n    children?: Snippet;\n  }\n\n  let { filter, filterGroupName, children }: Props = $props();\n  const onFilter = getContext<ItemFilterService['onFilter']>('onFilter');\n\n  function cycleFilterForward(name: string, currentValue: boolean | null) {\n    onFilter(filterGroupName, name, cycleNullTrueFalseForward(currentValue));\n  }\n\n  function cycleFilterBackward(name: string, currentValue: boolean | null) {\n    onFilter(filterGroupName, name, cycleNullTrueFalseBackward(currentValue));\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<button\n  type=\"button\"\n  class=\"pinned-filter-toggle truncate\"\n  class:include={filter.value === true}\n  class:exclude={filter.value === false}\n  onclick={() => cycleFilterForward(filter.name, filter.value)}\n  oncontextmenu={() => cycleFilterBackward(filter.name, filter.value)}\n  tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n  title={localize(filter.text)}\n>\n  {@render children?.()}\n</button>\n","<script lang=\"ts\">\n  import type { ConfiguredItemFilter } from 'src/runtime/item/item.types';\n  import PinnedFilterToggle from './PinnedFilterToggle.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n  interface Props {\n    filters: ConfiguredItemFilter[];\n    filterGroupName: string;\n  }\n\n  let { filters, filterGroupName }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n{#if filters.length}\n  <div role=\"presentation\" class=\"pinned-filter-toggles\">\n    {#each filters as filter (filter.name)}\n      <PinnedFilterToggle {filterGroupName} {filter}>\n        {localize(filter.abbreviation ?? filter.text)}\n      </PinnedFilterToggle>\n    {/each}\n  </div>\n{/if}\n","import { CONSTANTS } from 'src/constants';\nimport type { FilterCategoriesToFilters, ItemFilter } from './item.types';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { SpellUtils } from 'src/utils/SpellUtils';\nimport { ItemUtils } from 'src/utils/ItemUtils';\n\nexport const defaultItemFilters = {\n  activationCostAction: {\n    name: 'activationCostAction',\n    predicate: (item) =>\n      !!item.system.activities?.some(\n        (a: any) => a.activation?.type === CONSTANTS.ACTIVATION_COST_ACTION\n      ),\n    text: 'DND5E.Action',\n  },\n  activationCostBonus: {\n    name: 'activationCostBonus',\n    predicate: (item) =>\n      !!item.system.activities?.some(\n        (a: any) => a.activation?.type === CONSTANTS.ACTIVATION_COST_BONUS\n      ),\n    text: 'DND5E.BonusAction',\n  },\n  activationCostReaction: {\n    name: 'activationCostReaction',\n    predicate: (item) =>\n      !!item.system.activities?.some(\n        (a: any) => a.activation?.type === CONSTANTS.ACTIVATION_COST_REACTION\n      ),\n    text: 'DND5E.Reaction',\n  },\n  activationCostLegendary: {\n    name: 'activationCostLegendary',\n    predicate: (item) =>\n      !!item.system.activities?.some(\n        (a: any) => a.activation?.type === CONSTANTS.ACTIVATION_COST_LEGENDARY\n      ),\n    text: 'DND5E.LegendaryAction.Label',\n  },\n  activationCostMythic: {\n    name: 'activationCostMythic',\n    predicate: (item) =>\n      !!item.system.activities?.some(\n        (a: any) => a.activation?.type === CONSTANTS.ACTIVATION_COST_MYTHIC\n      ),\n    text: 'DND5E.MythicActionLabel',\n  },\n  activationCostLair: {\n    name: 'activationCostLair',\n    predicate: (item) =>\n      !!item.system.activities?.some(\n        (a: any) => a.activation?.type === CONSTANTS.ACTIVATION_COST_LAIR\n      ),\n    text: 'DND5E.LAIR.Action.Label',\n  },\n  activationCostCrew: {\n    name: 'activationCostCrew',\n    predicate: (item) =>\n      !!item.system.activities?.some(\n        (a: any) => a.activation?.type === CONSTANTS.ACTIVATION_COST_CREW\n      ),\n    text: 'DND5E.VehicleCrewAction',\n  },\n  activationCostSpecial: {\n    name: 'activationCostSpecial',\n    predicate: (item) =>\n      !!item.system.activities?.some(\n        (a: any) => a.activation?.type === CONSTANTS.ACTIVATION_COST_SPECIAL\n      ),\n    text: 'DND5E.Special',\n  },\n  activationCostOther: {\n    name: 'activationCostOther',\n    predicate: (item) =>\n      !!item.system.activities?.every(\n        (a: any) =>\n          ![\n            CONSTANTS.ACTIVATION_COST_ACTION,\n            CONSTANTS.ACTIVATION_COST_BONUS,\n            CONSTANTS.ACTIVATION_COST_REACTION,\n          ].includes(a.activation?.type)\n      ),\n    text: 'TIDY5E.ItemFilters.Filter.Other',\n  },\n  ritual: {\n    name: 'ritual',\n    predicate: (item) => item.system.properties?.has('ritual') === true,\n    text: 'DND5E.Ritual',\n  },\n  concentration: {\n    name: 'concentration',\n    predicate: (item) => item.system.properties?.has('concentration') === true,\n    text: 'DND5E.Concentration',\n    abbreviation: 'DND5E.AbbreviationConc',\n  },\n  verbal: {\n    name: 'verbal',\n    predicate: (item) => item.system.properties?.has('vocal') === true,\n    text: 'DND5E.ComponentVerbal',\n  },\n  somatic: {\n    name: 'somatic',\n    predicate: (item) => item.system.properties?.has('somatic') === true,\n    text: 'DND5E.ComponentSomatic',\n  },\n  material: {\n    name: 'material',\n    predicate: (item) => item.system.properties?.has('material') === true,\n    text: 'DND5E.ComponentMaterial',\n  },\n  prepared: {\n    name: 'prepared',\n    predicate: (item) => {\n      const isPreparedCantrip =\n        SpellUtils.isCantrip(item) && SpellUtils.isCantripPrepared(item);\n\n      return (\n        isPreparedCantrip ||\n        SpellUtils.isAlwaysPrepared(item) ||\n        SpellUtils.isInnate(item) ||\n        SpellUtils.isPrepared(item)\n      );\n    },\n    text: 'DND5E.Prepared',\n  },\n  canCastSpell: {\n    name: 'canCastSpell',\n    predicate: (item) => {\n      return (\n        item.type === CONSTANTS.ITEM_TYPE_SPELL &&\n        (SpellUtils.isCastableCantrip(item) || SpellUtils.isCastableSpell(item))\n      );\n    },\n    text: 'TIDY5E.ItemFilters.CanCast',\n  },\n  canUse: {\n    name: 'canUse',\n    predicate: (item) => ItemUtils.canUse(item),\n    text: 'TIDY5E.ItemFilters.CanUse',\n  },\n  equipped: {\n    name: 'equipped',\n    predicate: (item) => item.system.equipped === true,\n    text: 'DND5E.Equipped',\n  },\n} as const satisfies Record<string, ItemFilter>;\n\nexport function getItemRarityFilters(): ItemFilter[] {\n  const itemRarity = CONFIG.DND5E.itemRarity as Record<string, string>;\n\n  return Object.entries(itemRarity).map<ItemFilter>(\n    ([key, text]) =>\n      ({\n        name: key,\n        predicate: (item) =>\n          !FoundryAdapter.concealDetails(item) && item.system.rarity === key,\n        text: text,\n      } satisfies ItemFilter)\n  );\n}\n\nexport function getItemRarityFiltersAsObject(): Record<string, ItemFilter> {\n  return getItemRarityFilters().reduce<Record<string, ItemFilter>>(\n    (prev, curr) => {\n      prev[curr.name] = curr;\n      return prev;\n    },\n    {}\n  );\n}\n\nexport function getSpellSchoolFilters(): ItemFilter[] {\n  const spellSchools = CONFIG.DND5E.spellSchools as Record<string, any>;\n\n  return Object.entries(spellSchools).map<ItemFilter>(\n    ([key, schoolData]) =>\n      ({\n        name: key,\n        predicate: (item) => item.system.school === key,\n        text: schoolData.label,\n      } satisfies ItemFilter)\n  );\n}\n\nexport function getSpellSchoolFiltersAsObject(): Record<string, ItemFilter> {\n  return getSpellSchoolFilters().reduce<Record<string, ItemFilter>>(\n    (prev, curr) => {\n      prev[curr.name] = curr;\n      return prev;\n    },\n    {}\n  );\n}\n\nexport function getAttunementFilters(): ItemFilter[] {\n  return [\n    {\n      name: 'attunement-optional',\n      predicate: (item) =>\n        !FoundryAdapter.concealDetails(item) &&\n        item.system.attunement === CONSTANTS.ATTUNEMENT_OPTIONAL,\n      text: CONFIG.DND5E.attunementTypes[CONSTANTS.ATTUNEMENT_OPTIONAL],\n    },\n    {\n      name: 'attunement-required',\n      predicate: (item) =>\n        !FoundryAdapter.concealDetails(item) &&\n        item.system.attunement === CONSTANTS.ATTUNEMENT_REQUIRED,\n      text: CONFIG.DND5E.attunementTypes[CONSTANTS.ATTUNEMENT_REQUIRED],\n    },\n    {\n      name: 'attuned',\n      predicate: (item) =>\n        !FoundryAdapter.concealDetails(item) &&\n        !!CONFIG.DND5E.attunementTypes[\n          item.system.attunement as keyof typeof CONFIG.DND5E.attunementTypes\n        ] &&\n        item.system.attuned,\n      text: 'DND5E.AttunementAttuned',\n    },\n  ];\n}\n\nexport function getAttunementFiltersAsObject(): Record<string, ItemFilter> {\n  return getAttunementFilters().reduce<Record<string, ItemFilter>>(\n    (prev, curr) => {\n      prev[curr.name] = curr;\n      return prev;\n    },\n    {}\n  );\n}\n\nexport function getStandardSpellSchoolFilterCategories(): FilterCategoriesToFilters {\n  return {\n    'DND5E.SpellComponents': [\n      defaultItemFilters.verbal,\n      defaultItemFilters.somatic,\n      defaultItemFilters.material,\n      defaultItemFilters.concentration,\n      defaultItemFilters.ritual,\n    ],\n    'DND5E.SpellPreparation.Mode': [\n      defaultItemFilters.prepared,\n      defaultItemFilters.canCastSpell,\n    ],\n    'DND5E.SpellSchool': () => getSpellSchoolFilters(),\n  };\n}\n\nexport function getActionListFilterCategories(): FilterCategoriesToFilters {\n  return {\n    'DND5E.ItemActivationCost': [\n      defaultItemFilters.activationCostAction,\n      defaultItemFilters.activationCostBonus,\n      defaultItemFilters.activationCostReaction,\n      defaultItemFilters.activationCostLegendary,\n      defaultItemFilters.activationCostMythic,\n      defaultItemFilters.activationCostLair,\n      defaultItemFilters.activationCostCrew,\n      defaultItemFilters.activationCostSpecial,\n    ],\n    ...getStandardSpellSchoolFilterCategories(),\n  };\n}\n","import { CONSTANTS } from 'src/constants';\nimport type {\n  ConfiguredItemFilter,\n  DocumentFilters,\n  DocumentTypesToFilterTabs,\n  FilterTabsToCategories,\n  ItemFilter,\n} from './item.types';\nimport {\n  defaultItemFilters,\n  getActionListFilterCategories,\n  getAttunementFilters,\n  getAttunementFiltersAsObject,\n  getItemRarityFilters,\n  getItemRarityFiltersAsObject,\n  getSpellSchoolFiltersAsObject,\n  getStandardSpellSchoolFilterCategories,\n} from './default-item-filters';\nimport { debug, error } from 'src/utils/logging';\n\nexport class ItemFilterRuntime {\n  static _registeredItemFilters: Record<string, ItemFilter> = {};\n\n  static init() {\n    ItemFilterRuntime._registeredItemFilters = {\n      ...defaultItemFilters,\n      ...getAttunementFiltersAsObject(),\n      ...getItemRarityFiltersAsObject(),\n      ...getSpellSchoolFiltersAsObject(),\n    };\n  }\n\n  static defaultFilterPins: Record<string, Record<string, Set<string>>> = {\n    [CONSTANTS.SHEET_TYPE_CHARACTER]: {\n      [CONSTANTS.TAB_CHARACTER_ATTRIBUTES]: new Set<string>([\n        defaultItemFilters.activationCostAction.name,\n        defaultItemFilters.activationCostBonus.name,\n        defaultItemFilters.activationCostReaction.name,\n        defaultItemFilters.canUse.name,\n        defaultItemFilters.canCastSpell.name,\n      ]),\n      [CONSTANTS.TAB_ACTOR_INVENTORY]: new Set<string>([\n        defaultItemFilters.activationCostAction.name,\n        defaultItemFilters.activationCostBonus.name,\n        defaultItemFilters.activationCostReaction.name,\n        defaultItemFilters.equipped.name,\n      ]),\n      [CONSTANTS.TAB_CHARACTER_FEATURES]: new Set<string>([\n        defaultItemFilters.activationCostAction.name,\n        defaultItemFilters.activationCostBonus.name,\n        defaultItemFilters.activationCostReaction.name,\n        defaultItemFilters.canUse.name,\n      ]),\n      [CONSTANTS.TAB_ACTOR_SPELLBOOK]: new Set<string>([\n        defaultItemFilters.activationCostAction.name,\n        defaultItemFilters.activationCostBonus.name,\n        defaultItemFilters.activationCostReaction.name,\n        defaultItemFilters.concentration.name,\n        defaultItemFilters.ritual.name,\n        defaultItemFilters.canCastSpell.name,\n      ]),\n      [CONSTANTS.TAB_ACTOR_ACTIONS]: new Set<string>([\n        defaultItemFilters.activationCostAction.name,\n        defaultItemFilters.activationCostBonus.name,\n        defaultItemFilters.activationCostReaction.name,\n      ]),\n    },\n    [CONSTANTS.SHEET_TYPE_NPC]: {\n      [CONSTANTS.TAB_NPC_ABILITIES]: new Set<string>([\n        defaultItemFilters.activationCostAction.name,\n        defaultItemFilters.activationCostBonus.name,\n        defaultItemFilters.activationCostReaction.name,\n      ]),\n      [CONSTANTS.TAB_ACTOR_SPELLBOOK]: new Set<string>([\n        defaultItemFilters.activationCostAction.name,\n        defaultItemFilters.activationCostBonus.name,\n        defaultItemFilters.activationCostReaction.name,\n        defaultItemFilters.concentration.name,\n        defaultItemFilters.ritual.name,\n        defaultItemFilters.canCastSpell.name,\n      ]),\n      [CONSTANTS.TAB_ACTOR_ACTIONS]: new Set<string>([\n        defaultItemFilters.activationCostAction.name,\n        defaultItemFilters.activationCostBonus.name,\n        defaultItemFilters.activationCostReaction.name,\n      ]),\n      [CONSTANTS.TAB_ACTOR_INVENTORY]: new Set<string>([\n        defaultItemFilters.activationCostAction.name,\n        defaultItemFilters.activationCostBonus.name,\n        defaultItemFilters.activationCostReaction.name,\n        defaultItemFilters.equipped.name,\n      ]),\n    },\n    [CONSTANTS.SHEET_TYPE_VEHICLE]: {\n      [CONSTANTS.TAB_ACTOR_ACTIONS]: new Set<string>([\n        defaultItemFilters.activationCostAction.name,\n        defaultItemFilters.activationCostBonus.name,\n        defaultItemFilters.activationCostReaction.name,\n      ]),\n    },\n    [CONSTANTS.SHEET_TYPE_CONTAINER]: {\n      [CONSTANTS.TAB_CONTAINER_CONTENTS]: new Set<string>([\n        defaultItemFilters.activationCostAction.name,\n        defaultItemFilters.activationCostBonus.name,\n        defaultItemFilters.activationCostReaction.name,\n        defaultItemFilters.equipped.name,\n      ]),\n    },\n    [CONSTANTS.SHEET_TYPE_GROUP]: {\n      [CONSTANTS.TAB_ACTOR_INVENTORY]: new Set<string>([\n        defaultItemFilters.activationCostAction.name,\n        defaultItemFilters.activationCostBonus.name,\n        defaultItemFilters.activationCostReaction.name,\n        defaultItemFilters.equipped.name,\n      ]),\n    },\n  };\n\n  static _documentTabFilters: DocumentTypesToFilterTabs = {\n    [CONSTANTS.SHEET_TYPE_CHARACTER]: {\n      [CONSTANTS.TAB_CHARACTER_ATTRIBUTES]: {\n        'DND5E.ItemActivationCost': [\n          defaultItemFilters.activationCostAction,\n          defaultItemFilters.activationCostBonus,\n          defaultItemFilters.activationCostReaction,\n          defaultItemFilters.activationCostOther,\n        ],\n        'DND5E.SpellComponents': [\n          defaultItemFilters.verbal,\n          defaultItemFilters.somatic,\n          defaultItemFilters.material,\n          defaultItemFilters.concentration,\n          defaultItemFilters.ritual,\n        ],\n        'DND5E.SpellPreparation.Mode': [\n          defaultItemFilters.prepared,\n          defaultItemFilters.canCastSpell,\n        ],\n        'TIDY5E.ItemFilters.Category.Miscellaneous': () => [\n          defaultItemFilters.equipped,\n          defaultItemFilters.canUse,\n        ],\n      },\n      [CONSTANTS.TAB_ACTOR_INVENTORY]: {\n        'DND5E.ItemActivationCost': [\n          defaultItemFilters.activationCostAction,\n          defaultItemFilters.activationCostBonus,\n          defaultItemFilters.activationCostReaction,\n        ],\n        'DND5E.Rarity': () => getItemRarityFilters(),\n        'TIDY5E.ItemFilters.Category.Miscellaneous': () => [\n          defaultItemFilters.equipped,\n          ...getAttunementFilters(),\n        ],\n      },\n      [CONSTANTS.TAB_ACTOR_SPELLBOOK]: {\n        'DND5E.ItemActivationCost': [\n          defaultItemFilters.activationCostAction,\n          defaultItemFilters.activationCostBonus,\n          defaultItemFilters.activationCostReaction,\n          defaultItemFilters.activationCostOther,\n        ],\n        ...getStandardSpellSchoolFilterCategories(),\n      },\n      [CONSTANTS.TAB_CHARACTER_FEATURES]: {\n        'DND5E.ItemActivationCost': [\n          defaultItemFilters.activationCostAction,\n          defaultItemFilters.activationCostBonus,\n          defaultItemFilters.activationCostReaction,\n        ],\n        'TIDY5E.ItemFilters.Category.Miscellaneous': () => [\n          defaultItemFilters.canUse,\n        ],\n      },\n      [CONSTANTS.TAB_ACTOR_ACTIONS]: { ...getActionListFilterCategories() },\n    },\n    [CONSTANTS.SHEET_TYPE_NPC]: {\n      [CONSTANTS.TAB_ACTOR_SPELLBOOK]: {\n        'DND5E.ItemActivationCost': [\n          defaultItemFilters.activationCostAction,\n          defaultItemFilters.activationCostBonus,\n          defaultItemFilters.activationCostReaction,\n          defaultItemFilters.activationCostOther,\n        ],\n        ...getStandardSpellSchoolFilterCategories(),\n      },\n      [CONSTANTS.TAB_NPC_ABILITIES]: {\n        // TODO: Upgrade the filter system so that it's easier to dynamically graft in additional filter sets rather than hardcoding them in\n        'DND5E.ItemActivationCost': [\n          defaultItemFilters.activationCostAction,\n          defaultItemFilters.activationCostBonus,\n          defaultItemFilters.activationCostReaction,\n          defaultItemFilters.activationCostLegendary,\n          defaultItemFilters.activationCostMythic,\n          defaultItemFilters.activationCostLair,\n          defaultItemFilters.activationCostOther,\n        ],\n        ...getStandardSpellSchoolFilterCategories(),\n      },\n      [CONSTANTS.TAB_ACTOR_INVENTORY]: {\n        'DND5E.ItemActivationCost': [\n          defaultItemFilters.activationCostAction,\n          defaultItemFilters.activationCostBonus,\n          defaultItemFilters.activationCostReaction,\n        ],\n        'DND5E.Rarity': () => getItemRarityFilters(),\n        'TIDY5E.ItemFilters.Category.Miscellaneous': () => [\n          defaultItemFilters.equipped,\n          ...getAttunementFilters(),\n        ],\n      },\n      [CONSTANTS.TAB_ACTOR_ACTIONS]: { ...getActionListFilterCategories() },\n    },\n    [CONSTANTS.SHEET_TYPE_VEHICLE]: {\n      [CONSTANTS.TAB_ACTOR_ACTIONS]: { ...getActionListFilterCategories() },\n    },\n    [CONSTANTS.SHEET_TYPE_CONTAINER]: {\n      [CONSTANTS.TAB_CONTAINER_CONTENTS]: {\n        'DND5E.ItemActivationCost': [\n          defaultItemFilters.activationCostAction,\n          defaultItemFilters.activationCostBonus,\n          defaultItemFilters.activationCostReaction,\n        ],\n        'DND5E.Rarity': () => getItemRarityFilters(),\n        'TIDY5E.ItemFilters.Category.Miscellaneous': () => [\n          defaultItemFilters.equipped,\n          ...getAttunementFilters(),\n        ],\n      },\n    },\n    [CONSTANTS.SHEET_TYPE_GROUP]: {\n      [CONSTANTS.TAB_ACTOR_INVENTORY]: {\n        'DND5E.ItemActivationCost': [\n          defaultItemFilters.activationCostAction,\n          defaultItemFilters.activationCostBonus,\n          defaultItemFilters.activationCostReaction,\n        ],\n        'DND5E.Rarity': () => getItemRarityFilters(),\n        'TIDY5E.ItemFilters.Category.Miscellaneous': () => [\n          defaultItemFilters.equipped,\n          ...getAttunementFilters(),\n        ],\n      },\n    },\n  };\n\n  static getFilter(filterName: ItemFilter['name']): ItemFilter | undefined {\n    return ItemFilterRuntime._registeredItemFilters[filterName];\n  }\n\n  static getDocumentFilters(document: any): FilterTabsToCategories {\n    return ItemFilterRuntime._documentTabFilters[document.type] ?? {};\n  }\n\n  static getPinnedFiltersForTab(\n    filterPins: Record<string, Set<string>>,\n    filterData: DocumentFilters,\n    tabId: string\n  ) {\n    let pinnedFilters = new Map<string, ConfiguredItemFilter>();\n\n    try {\n      let tabFilterPins = filterPins[tabId] ?? new Set<string>();\n\n      for (let categoryFilters of Object.values(filterData[tabId] ?? {})) {\n        for (let filter of categoryFilters) {\n          if (tabFilterPins.has(filter.name)) {\n            pinnedFilters.set(filter.name, filter);\n          }\n        }\n      }\n    } catch (e) {\n      error(\n        `An error occurred while searching for pinned filters on the ${tabId} tab.`,\n        false,\n        e\n      );\n      debug('Filter pins error troubleshooting info', {\n        filterData,\n        filterPins,\n        tabId,\n      });\n    }\n\n    return Array.from(pinnedFilters.values());\n  }\n}\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n\n  interface Props {\n    expanded?: boolean;\n  }\n\n  let { expanded = true }: Props = $props();\n</script>\n\n<i\n  class=\"expand-indicator fas fa-angle-right\"\n  class:expanded\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.EXPANSION_TOGGLE}\n></i>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import TidyTableToggleIcon from 'src/components/table/TidyTableToggleIcon.svelte';\n  import { getContext, type Snippet } from 'svelte';\n  import type { ExpansionTrackerToggleProvider } from 'src/features/expand-collapse/ExpansionTracker.svelte';\n\n  interface Props {\n    primary?: boolean;\n    baseWidth?: string | null;\n    title?: string | null;\n    children?: Snippet;\n    [key: string]: any;\n  }\n\n  let {\n    primary = false,\n    baseWidth = null,\n    title = null,\n    children,\n    ...rest\n  }: Props = $props();\n\n  let toggleable = getContext<ExpansionTrackerToggleProvider>(\n    CONSTANTS.SVELTE_CONTEXT.SECTION_EXPANSION_TOGGLE_PROVIDER,\n  );\n</script>\n\n<div\n  class=\"tidy-table-header-cell {rest.class ?? ''}\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.TABLE_HEADER_CELL}\n  class:primary\n  style:flex-basis={baseWidth}\n  {title}\n>\n  {#if primary && !!toggleable}\n    <TidyTableToggleIcon expanded={toggleable().expanded} />\n  {/if}\n  {@render children?.()}\n</div>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import type { ExpansionTrackerToggleProvider } from 'src/features/expand-collapse/ExpansionTracker.svelte';\n  import { isUserInteractable } from 'src/utils/element';\n  import { getContext, type Snippet } from 'svelte';\n\n  interface Props {\n    children?: Snippet;\n  }\n\n  let { children }: Props = $props();\n\n  let toggleable = getContext<ExpansionTrackerToggleProvider>(\n    CONSTANTS.SVELTE_CONTEXT.SECTION_EXPANSION_TOGGLE_PROVIDER,\n  );\n\n  function handleHeaderRowClick(ev: MouseEvent) {\n    if (!toggleable) {\n      return;\n    }\n\n    if (\n      ev.target instanceof HTMLElement &&\n      isUserInteractable(ev.target) &&\n      ev.target.getAttribute(CONSTANTS.SHEET_PART_ATTRIBUTE) !==\n        CONSTANTS.SHEET_PARTS.EXPANSION_TOGGLE\n    ) {\n      // Avoid eagerly toggling expansion when a contained interactable element is being clicked.\n      return;\n    }\n\n    ev.stopPropagation();\n\n    toggleable().toggle();\n  }\n</script>\n\n<header\n  class=\"tidy-table-header-row\"\n  class:toggleable={!!toggleable}\n  onclick={handleHeaderRowClick}\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.TABLE_HEADER_ROW}\n>\n  {@render children?.()}\n</header>\n","<script lang=\"ts\">\n  import TidyTableRow from 'src/components/table/TidyTableRow.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import type { Item5e, ItemChatData } from 'src/types/item.types';\n  import type {\n    ExpandedItemData,\n    ExpandedItemIdToLocationsMap,\n    OnItemToggledFn,\n  } from 'src/types/types';\n  import { warn } from 'src/utils/logging';\n  import { getContext, type Snippet } from 'svelte';\n  import ItemSummary from '../ItemSummary.svelte';\n  import ExpandableContainer from 'src/components/expandable/ExpandableContainer.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { TidyHooks } from 'src/foundry/TidyHooks';\n\n  interface Props {\n    item?: Item5e | null;\n    contextMenu?: { type: string; uuid: string } | null;\n    rowClass?: string;\n    hidden?: boolean;\n    draggable?: boolean;\n    children?: Snippet<[any]>;\n  }\n\n  let {\n    item = null,\n    contextMenu = null,\n    rowClass = '',\n    hidden = false,\n    draggable = true,\n    children,\n  }: Props = $props();\n\n  const emptyChatData: ItemChatData = {\n    description: { value: '' },\n    properties: [],\n    unidentified: { description: '' },\n  };\n\n  const expandedItemData = getContext<ExpandedItemData>(\n    CONSTANTS.SVELTE_CONTEXT.EXPANDED_ITEM_DATA,\n  );\n\n  const expandedItems = getContext<ExpandedItemIdToLocationsMap>(\n    CONSTANTS.SVELTE_CONTEXT.EXPANDED_ITEMS,\n  );\n\n  const onItemToggled = getContext<OnItemToggledFn>(\n    CONSTANTS.SVELTE_CONTEXT.ON_ITEM_TOGGLED,\n  );\n\n  const location = getContext<string>(CONSTANTS.SVELTE_CONTEXT.LOCATION);\n\n  let showSummary = $state(false);\n  let chatData: ItemChatData | undefined = $state();\n\n  async function toggleSummary() {\n    if (!item) {\n      warn('Unable to show summary. No item was provided.');\n      showSummary = false;\n      return;\n    }\n\n    chatData ??= await item.getChatData({ secrets: item.isOwner });\n    showSummary = !showSummary;\n    onItemToggled?.(item.id, showSummary, location);\n  }\n\n  async function onMouseEnter(event: Event) {\n    TidyHooks.tidy5eSheetsItemHoverOn(event, item);\n  }\n\n  async function onMouseLeave(event: Event) {\n    TidyHooks.tidy5eSheetsItemHoverOff(event, item);\n  }\n\n  function handleDragStart(event: DragEvent) {\n    if (!item) {\n      return;\n    }\n\n    onMouseLeave(event);\n\n    const dragData = item.toDragData();\n    event.dataTransfer?.setData('text/plain', JSON.stringify(dragData));\n  }\n\n  function restoreItemSummaryIfExpanded() {\n    if (!item) {\n      return;\n    }\n\n    const isExpandedAtThisLocation = expandedItems?.get(item.id)?.has(location);\n\n    if (isExpandedAtThisLocation) {\n      chatData = expandedItemData.get(item.id);\n      showSummary = true;\n    }\n  }\n\n  $effect(() => {\n    let first = true;\n\n    (async () => {\n      if (first) {\n        first = false;\n        restoreItemSummaryIfExpanded();\n        return;\n      }\n\n      if (item && showSummary) {\n        chatData = await item.getChatData({ secrets: item.actor.isOwner });\n      } else if (item && !showSummary && chatData) {\n        // Reset chat data for non-expanded, hydrated chatData\n        // so it rehydrates on next open\n        chatData = undefined;\n      }\n    })();\n  });\n</script>\n\n<TidyTableRow\n  {hidden}\n  rowContainerAttributes={{\n    ['data-item-id']: item?.id,\n  }}\n  rowAttributes={{\n    ['data-context-menu']: contextMenu?.type,\n    ['data-tidy-table-row']: '',\n    ['data-tidy-sheet-part']: CONSTANTS.SHEET_PARTS.ITEM_TABLE_ROW,\n    ['data-tidy-item-type']: item?.type ?? 'unknown',\n    ['data-info-card']: item ? 'item' : null,\n    ['data-info-card-entity-uuid']: item?.uuid ?? null,\n    draggable: draggable,\n  }}\n  rowClass=\"tidy-table-row-v2 {rowClass ?? ''}\"\n  onmousedown={(event) => item && FoundryAdapter.editOnMiddleClick(event, item)}\n  onmouseenter={onMouseEnter}\n  onmouseleave={onMouseLeave}\n  ondragstart={handleDragStart}\n>\n  {@render children?.({ toggleSummary })}\n\n  {#snippet afterRow()}\n    <ExpandableContainer expanded={showSummary}>\n      <ItemSummary chatData={chatData ?? emptyChatData} {item} />\n    </ExpandableContainer>\n  {/snippet}\n</TidyTableRow>\n","/** @import { Source } from '#client' */\nimport { set } from '../internal/client/reactivity/sources.js';\n\n/** @param {Source<number>} source */\nexport function increment(source) {\n\tset(source, source.v + 1);\n}\n","/** @import { Source } from '#client' */\nimport { DEV } from 'esm-env';\nimport { source, set } from '../internal/client/reactivity/sources.js';\nimport { get } from '../internal/client/runtime.js';\nimport { increment } from './utils.js';\n\nvar read_methods = ['forEach', 'isDisjointFrom', 'isSubsetOf', 'isSupersetOf'];\nvar set_like_methods = ['difference', 'intersection', 'symmetricDifference', 'union'];\n\nvar inited = false;\n\n/**\n * @template T\n * @extends {Set<T>}\n */\nexport class SvelteSet extends Set {\n\t/** @type {Map<T, Source<boolean>>} */\n\t#sources = new Map();\n\t#version = source(0);\n\t#size = source(0);\n\n\t/**\n\t * @param {Iterable<T> | null | undefined} [value]\n\t */\n\tconstructor(value) {\n\t\tsuper();\n\n\t\t// If the value is invalid then the native exception will fire here\n\t\tif (DEV) value = new Set(value);\n\n\t\tif (value) {\n\t\t\tfor (var element of value) {\n\t\t\t\tsuper.add(element);\n\t\t\t}\n\t\t\tthis.#size.v = super.size;\n\t\t}\n\n\t\tif (!inited) this.#init();\n\t}\n\n\t// We init as part of the first instance so that we can treeshake this class\n\t#init() {\n\t\tinited = true;\n\n\t\tvar proto = SvelteSet.prototype;\n\t\tvar set_proto = Set.prototype;\n\n\t\tfor (const method of read_methods) {\n\t\t\t// @ts-ignore\n\t\t\tproto[method] = function (...v) {\n\t\t\t\tget(this.#version);\n\t\t\t\t// @ts-ignore\n\t\t\t\treturn set_proto[method].apply(this, v);\n\t\t\t};\n\t\t}\n\n\t\tfor (const method of set_like_methods) {\n\t\t\t// @ts-ignore\n\t\t\tproto[method] = function (...v) {\n\t\t\t\tget(this.#version);\n\t\t\t\t// @ts-ignore\n\t\t\t\tvar set = /** @type {Set<T>} */ (set_proto[method].apply(this, v));\n\t\t\t\treturn new SvelteSet(set);\n\t\t\t};\n\t\t}\n\t}\n\n\t/** @param {T} value */\n\thas(value) {\n\t\tvar has = super.has(value);\n\t\tvar sources = this.#sources;\n\t\tvar s = sources.get(value);\n\n\t\tif (s === undefined) {\n\t\t\tif (!has) {\n\t\t\t\t// If the value doesn't exist, track the version in case it's added later\n\t\t\t\t// but don't create sources willy-nilly to track all possible values\n\t\t\t\tget(this.#version);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\ts = source(true);\n\t\t\tsources.set(value, s);\n\t\t}\n\n\t\tget(s);\n\t\treturn has;\n\t}\n\n\t/** @param {T} value */\n\tadd(value) {\n\t\tif (!super.has(value)) {\n\t\t\tsuper.add(value);\n\t\t\tset(this.#size, super.size);\n\t\t\tincrement(this.#version);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/** @param {T} value */\n\tdelete(value) {\n\t\tvar deleted = super.delete(value);\n\t\tvar sources = this.#sources;\n\t\tvar s = sources.get(value);\n\n\t\tif (s !== undefined) {\n\t\t\tsources.delete(value);\n\t\t\tset(s, false);\n\t\t}\n\n\t\tif (deleted) {\n\t\t\tset(this.#size, super.size);\n\t\t\tincrement(this.#version);\n\t\t}\n\n\t\treturn deleted;\n\t}\n\n\tclear() {\n\t\tif (super.size === 0) {\n\t\t\treturn;\n\t\t}\n\t\t// Clear first, so we get nice console.log outputs with $inspect\n\t\tsuper.clear();\n\t\tvar sources = this.#sources;\n\n\t\tfor (var s of sources.values()) {\n\t\t\tset(s, false);\n\t\t}\n\n\t\tsources.clear();\n\t\tset(this.#size, 0);\n\t\tincrement(this.#version);\n\t}\n\n\tkeys() {\n\t\treturn this.values();\n\t}\n\n\tvalues() {\n\t\tget(this.#version);\n\t\treturn super.values();\n\t}\n\n\tentries() {\n\t\tget(this.#version);\n\t\treturn super.entries();\n\t}\n\n\t[Symbol.iterator]() {\n\t\treturn this.keys();\n\t}\n\n\tget size() {\n\t\treturn get(this.#size);\n\t}\n}\n","/** @import { Source } from '#client' */\nimport { DEV } from 'esm-env';\nimport { set, source } from '../internal/client/reactivity/sources.js';\nimport { get } from '../internal/client/runtime.js';\nimport { increment } from './utils.js';\n\n/**\n * @template K\n * @template V\n * @extends {Map<K, V>}\n */\nexport class SvelteMap extends Map {\n\t/** @type {Map<K, Source<number>>} */\n\t#sources = new Map();\n\t#version = source(0);\n\t#size = source(0);\n\n\t/**\n\t * @param {Iterable<readonly [K, V]> | null | undefined} [value]\n\t */\n\tconstructor(value) {\n\t\tsuper();\n\n\t\t// If the value is invalid then the native exception will fire here\n\t\tif (DEV) value = new Map(value);\n\n\t\tif (value) {\n\t\t\tfor (var [key, v] of value) {\n\t\t\t\tsuper.set(key, v);\n\t\t\t}\n\t\t\tthis.#size.v = super.size;\n\t\t}\n\t}\n\n\t/** @param {K} key */\n\thas(key) {\n\t\tvar sources = this.#sources;\n\t\tvar s = sources.get(key);\n\n\t\tif (s === undefined) {\n\t\t\tvar ret = super.get(key);\n\t\t\tif (ret !== undefined) {\n\t\t\t\ts = source(0);\n\t\t\t\tsources.set(key, s);\n\t\t\t} else {\n\t\t\t\t// We should always track the version in case\n\t\t\t\t// the Set ever gets this value in the future.\n\t\t\t\tget(this.#version);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tget(s);\n\t\treturn true;\n\t}\n\n\t/**\n\t * @param {(value: V, key: K, map: Map<K, V>) => void} callbackfn\n\t * @param {any} [this_arg]\n\t */\n\tforEach(callbackfn, this_arg) {\n\t\tthis.#read_all();\n\t\tsuper.forEach(callbackfn, this_arg);\n\t}\n\n\t/** @param {K} key */\n\tget(key) {\n\t\tvar sources = this.#sources;\n\t\tvar s = sources.get(key);\n\n\t\tif (s === undefined) {\n\t\t\tvar ret = super.get(key);\n\t\t\tif (ret !== undefined) {\n\t\t\t\ts = source(0);\n\t\t\t\tsources.set(key, s);\n\t\t\t} else {\n\t\t\t\t// We should always track the version in case\n\t\t\t\t// the Set ever gets this value in the future.\n\t\t\t\tget(this.#version);\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}\n\n\t\tget(s);\n\t\treturn super.get(key);\n\t}\n\n\t/**\n\t * @param {K} key\n\t * @param {V} value\n\t * */\n\tset(key, value) {\n\t\tvar sources = this.#sources;\n\t\tvar s = sources.get(key);\n\t\tvar prev_res = super.get(key);\n\t\tvar res = super.set(key, value);\n\t\tvar version = this.#version;\n\n\t\tif (s === undefined) {\n\t\t\tsources.set(key, source(0));\n\t\t\tset(this.#size, super.size);\n\t\t\tincrement(version);\n\t\t} else if (prev_res !== value) {\n\t\t\tincrement(s);\n\n\t\t\t// if not every reaction of s is a reaction of version we need to also include version\n\t\t\tvar v_reactions = version.reactions === null ? null : new Set(version.reactions);\n\t\t\tvar needs_version_increase =\n\t\t\t\tv_reactions === null ||\n\t\t\t\t!s.reactions?.every((r) =>\n\t\t\t\t\t/** @type {NonNullable<typeof v_reactions>} */ (v_reactions).has(r)\n\t\t\t\t);\n\t\t\tif (needs_version_increase) {\n\t\t\t\tincrement(version);\n\t\t\t}\n\t\t}\n\n\t\treturn res;\n\t}\n\n\t/** @param {K} key */\n\tdelete(key) {\n\t\tvar sources = this.#sources;\n\t\tvar s = sources.get(key);\n\t\tvar res = super.delete(key);\n\n\t\tif (s !== undefined) {\n\t\t\tsources.delete(key);\n\t\t\tset(this.#size, super.size);\n\t\t\tset(s, -1);\n\t\t\tincrement(this.#version);\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tclear() {\n\t\tif (super.size === 0) {\n\t\t\treturn;\n\t\t}\n\t\t// Clear first, so we get nice console.log outputs with $inspect\n\t\tsuper.clear();\n\t\tvar sources = this.#sources;\n\t\tset(this.#size, 0);\n\t\tfor (var s of sources.values()) {\n\t\t\tset(s, -1);\n\t\t}\n\t\tincrement(this.#version);\n\t\tsources.clear();\n\t}\n\n\t#read_all() {\n\t\tget(this.#version);\n\n\t\tvar sources = this.#sources;\n\t\tif (this.#size.v !== sources.size) {\n\t\t\tfor (var key of super.keys()) {\n\t\t\t\tif (!sources.has(key)) {\n\t\t\t\t\tsources.set(key, source(0));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (var [, s] of this.#sources) {\n\t\t\tget(s);\n\t\t}\n\t}\n\n\tkeys() {\n\t\tget(this.#version);\n\t\treturn super.keys();\n\t}\n\n\tvalues() {\n\t\tthis.#read_all();\n\t\treturn super.values();\n\t}\n\n\tentries() {\n\t\tthis.#read_all();\n\t\treturn super.entries();\n\t}\n\n\t[Symbol.iterator]() {\n\t\treturn this.entries();\n\t}\n\n\tget size() {\n\t\tget(this.#size);\n\t\treturn super.size;\n\t}\n}\n","import { SvelteMap, SvelteSet } from 'svelte/reactivity';\n\n/** Service for tracking which inline entities are currently expanded to show their contents. */\nexport class InlineToggleService {\n  /** A map of tab IDs to set of entity IDs, typically Items. */\n  map = new SvelteMap<string, SvelteSet<string>>();\n\n  /** Toggle an entity to be expanded or collapsed, based on its current state. */\n  toggle(tabId: string, entityId: string, value?: boolean) {\n    // const tabs = this.map;\n\n    if (!this.map.has(tabId)) {\n      this.map.set(tabId, new SvelteSet<string>());\n    }\n\n    const tab = this.map.get(tabId)!;\n\n    if (value === false) {\n      tab.delete(entityId);\n    } else if (value === true) {\n      tab.add(entityId);\n    } else if (tab.has(entityId)) {\n      tab.delete(entityId);\n    } else {\n      tab.add(entityId);\n    }\n  }\n}\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import type { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import type { Item5e } from 'src/types/item.types';\n  import { getContext } from 'svelte';\n\n  interface Props {\n    inlineToggleService: InlineToggleService;\n    entityId: Item5e;\n    iconClass?: string;\n  }\n\n  let { inlineToggleService, entityId, iconClass = '' }: Props = $props();\n\n  let tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  let toggleServiceMap = $derived(inlineToggleService.map);\n</script>\n\n<button\n  type=\"button\"\n  class=\"inline-toggle inline-transparent-button px-1\"\n  onclick={() => inlineToggleService.toggle(tabId, entityId)}\n  tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.INLINE_CONTAINER_TOGGLE}\n>\n  <i\n    class=\"fa-solid fa-angle-right expand-indicator {iconClass}\"\n    class:expanded={toggleServiceMap.get(tabId)?.has(entityId)}\n  ></i>\n</button>\n","import { CONSTANTS } from 'src/constants';\nimport type {\n  SheetPreferences,\n  SheetTypeTabPreferences,\n  SheetPreference,\n} from './user-preferences.types';\n\n/**\n * A service for managing sheet preferences that are cached on the user document under this module's flags.\n *\n * @example What the data looks like\n * ```json\n * {\n *   \"flags\": {\n *     \"tidy5e-sheet\": {\n *       \"sheetPreferences\": {\n *         \"character\": {\n *           \"tabs\": {\n *             \"inventory\": {\n *               \"sort\": \"m\"\n *             }\n *           },\n *           \"width\": 900,\n *           \"height\": 1000\n *         },\n *         \"npc\": {\n *           \"tabs\": {\n *             \"spellbook\": {\n *               \"sort\": \"a\"\n *             }\n *           },\n *           \"width\": 1080\n *         }\n *       }\n *     }\n *   }\n * }\n * ```\n */\nexport class SheetPreferencesService {\n\n  static async setDocumentTypeTabPreference<\n    K extends keyof SheetTypeTabPreferences,\n    V extends SheetTypeTabPreferences[K]\n  >(documentType: string, tabId: string, property: K, value: V) {\n    await game.user.setFlag(\n      CONSTANTS.MODULE_ID,\n      `sheetPreferences.${documentType}.tabs.${tabId}.${property}`,\n      value\n    );\n  }\n\n  static async setDocumentTypePreference<\n    K extends keyof SheetPreference,\n    V extends SheetPreference[K]\n  >(documentType: string, property: K, value: V) {\n    await game.user.setFlag(\n      CONSTANTS.MODULE_ID,\n      `sheetPreferences.${documentType}.${property}`,\n      value\n    );\n  }\n\n  static get(): SheetPreferences {\n    return (\n      foundry.utils.getProperty(\n        game.user,\n        `flags.${CONSTANTS.MODULE_ID}.sheetPreferences`\n      ) ?? {}\n    );\n  }\n\n  static getByType(documentType: string): SheetPreference {\n    return (\n      foundry.utils.getProperty(\n        game.user,\n        `flags.${CONSTANTS.MODULE_ID}.sheetPreferences.${documentType}`\n      ) ?? {}\n    );\n  }\n}\n","import { CONSTANTS } from 'src/constants';\nimport { TidyFlags } from 'src/foundry/TidyFlags';\nimport type { Tidy5eCharacterSheet } from 'src/sheets/classic/Tidy5eCharacterSheet.svelte';\nimport type { Tidy5eNpcSheet } from 'src/sheets/classic/Tidy5eNpcSheet.svelte';\nimport type { Item5e } from 'src/types/item.types';\nimport type {\n  ActionSection,\n  Actor5e,\n  CharacterFeatureSection,\n  CharacterSheetContext,\n  CustomSectionOptions,\n  FavoriteSection,\n  FeatureSection,\n  InventorySection,\n  NpcAbilitySection,\n  NpcSheetContext,\n  SpellbookSection,\n  TidySectionBase,\n} from 'src/types/types';\nimport { isNil } from 'src/utils/data';\nimport type { SectionConfig } from './sections.types';\nimport { ItemUtils } from 'src/utils/ItemUtils';\nimport { SheetPreferencesService } from '../user-preferences/SheetPreferencesService';\nimport type { SheetPreference } from '../user-preferences/user-preferences.types';\nimport type { Activity5e, CharacterFavorite } from 'src/foundry/dnd5e.types';\nimport { error } from 'src/utils/logging';\nimport { getSortedActions } from '../actions/actions.svelte';\nimport { SpellUtils } from 'src/utils/SpellUtils';\nimport { settings } from 'src/settings/settings.svelte';\n\nexport class SheetSections {\n  static applySpellToSection(\n    spellbook: Record<string, SpellbookSection>,\n    spell: Item5e,\n    options: Partial<SpellbookSection>\n  ) {\n    const customSectionName = TidyFlags.section.get(spell);\n\n    if (!customSectionName) {\n      // TODO: Eventually absorb core spellbook section prep to this service\n      return;\n    }\n\n    const section: SpellbookSection = (spellbook[customSectionName] ??=\n      SheetSections.createSpellbookSection(customSectionName, options));\n\n    section.spells.push(spell);\n  }\n\n  static createSpellbookSection(\n    customSectionName: string,\n    options: Partial<SpellbookSection>\n  ): SpellbookSection {\n    return {\n      dataset: {\n        [TidyFlags.section.prop]: customSectionName,\n      },\n      spells: [],\n      label: customSectionName,\n      canCreate: true,\n      canPrepare: true,\n      usesSlots: false,\n      key: customSectionName,\n      custom: {\n        section: customSectionName,\n        creationItemTypes: [CONSTANTS.ITEM_TYPE_SPELL],\n      },\n      show: true,\n      ...options,\n    };\n  }\n\n  static sortKeyedSections<\n    T extends { key: string; custom?: CustomSectionOptions }\n  >(sections: T[], sectionConfigs: Record<string, SectionConfig> | undefined) {\n    const sortMap = new Map(\n      Object.values(sectionConfigs ?? {}).map((e) => [e.key, e.order])\n    );\n    const defaultSortMap = new Map(\n      SheetSections.getDefaultSortOrder(sections).map((e, i) => [e, i])\n    );\n\n    const maxLength = sections.length;\n\n    return sections.toSorted(\n      (a, b) =>\n        (sortMap.get(a.key) ?? defaultSortMap.get(a.key) ?? maxLength) -\n        (sortMap.get(b.key) ?? defaultSortMap.get(b.key) ?? maxLength)\n    );\n  }\n\n  static getDefaultSortOrder<\n    T extends { key: string; custom?: CustomSectionOptions }\n  >(sections: T[]): string[] {\n    const { defaultSections, customSections } = sections.reduce<{\n      defaultSections: string[];\n      customSections: string[];\n    }>(\n      (prev, curr) => {\n        curr.custom\n          ? prev.customSections.push(curr.key)\n          : prev.defaultSections.push(curr.key);\n\n        return prev;\n      },\n      { defaultSections: [], customSections: [] }\n    );\n\n    var sortedCustomSections = customSections.toSorted((a, b) =>\n      a.localeCompare(b, game.i18n.lang)\n    );\n\n    return [...defaultSections, ...sortedCustomSections];\n  }\n\n  static prepareTidySpellbook(\n    context: CharacterSheetContext | NpcSheetContext,\n    tabId: string,\n    spells: Item5e[],\n    options: Partial<SpellbookSection> = {},\n    app: Tidy5eCharacterSheet | Tidy5eNpcSheet\n  ): SpellbookSection[] {\n    const customSectionSpells = spells.filter((s) => TidyFlags.section.get(s));\n    spells = spells.filter((s) => !TidyFlags.section.get(s));\n\n    const spellbook: SpellbookSection[] = app\n      ._prepareSpellbook(context, spells)\n      .map(\n        (s: SpellbookSection) =>\n          ({\n            ...s,\n            key: s.key ?? s.prop,\n            show: true,\n          } satisfies SpellbookSection)\n      );\n\n    const spellbookMap = spellbook.reduce<Record<string, SpellbookSection>>(\n      (prev, curr) => {\n        let key = curr.prop ?? '';\n\n        // Handle \"Additional Spells\" section\n        if (curr.order === 'item') {\n          key = 'dnd5e-cast-activity-additional-spells';\n          curr.canCreate = false;\n        }\n\n        curr.key = key;\n\n        // Tidy passes the dataset directly to the item creation code, rather than planting it on the HTML.\n        // When Tidy fully takes over its own spellbook preparation, eliminate the need for this correcting patch.\n        curr.dataset['system'] = {\n          level: curr.dataset.level,\n          preparationMode: curr.dataset.preparationMode,\n        };\n        delete curr.dataset.level;\n        delete curr.dataset.preparationMode;\n\n        prev[key] = curr;\n        return prev;\n      },\n      {}\n    );\n\n    customSectionSpells.forEach((spell) => {\n      SheetSections.applySpellToSection(spellbookMap, spell, options);\n    });\n\n    SheetSections.getFilteredGlobalSectionsToShowWhenEmpty(\n      context.actor,\n      tabId\n    ).forEach((s) => {\n      spellbookMap[s] ??= SheetSections.createSpellbookSection(s, {\n        canCreate: true,\n        ...options,\n      });\n    });\n\n    return Object.values(spellbookMap);\n  }\n\n  static prepareClassItems(\n    context: CharacterSheetContext | NpcSheetContext,\n    classes: Item5e[],\n    subclasses: Item5e[],\n    actor: Actor5e\n  ) {\n    const maxLevelDelta = CONFIG.DND5E.maxLevel - actor.system.details.level;\n    return classes.reduce((arr, cls) => {\n      arr.push(cls);\n      const ctx = (context.itemContext[cls.id] ??= {});\n      ctx.availableLevels = Array.fromRange(CONFIG.DND5E.maxLevel + 1)\n        .slice(1)\n        .map((level) => {\n          const delta = level - cls.system.levels;\n          return { level, delta, disabled: delta > maxLevelDelta };\n        });\n      const identifier =\n        cls.system.identifier || cls.name.slugify({ strict: true });\n      const subclass = subclasses.findSplice(\n        (s: Item5e) => s.system.classIdentifier === identifier\n      );\n      if (subclass) {\n        arr.push(subclass);\n        const subclassCtx = (context.itemContext[subclass.id] ??= {});\n        subclassCtx.parent = cls;\n      } else {\n        const subclassAdvancement = cls.advancement.byType.Subclass?.[0];\n        if (\n          subclassAdvancement &&\n          subclassAdvancement.level <= cls.system.levels\n        )\n          ctx.needsSubclass = true;\n      }\n      return arr;\n    }, []);\n  }\n\n  static collocateSubItems(\n    context: CharacterSheetContext | NpcSheetContext,\n    items: Item5e[]\n  ): Item5e[] {\n    const itemContext = context.itemContext;\n    const { parents, parentIdToChildren } = items.reduce<{\n      parents: Item5e[];\n      parentIdToChildren: Map<string, Item5e[]>;\n    }>(\n      (prev, item) => {\n        const parentItem = itemContext[item.id]?.parent;\n        const isChild = !!parentItem;\n        if (isChild) {\n          const children = prev.parentIdToChildren.get(parentItem.id) ?? [];\n          children.push(item);\n          prev.parentIdToChildren.set(parentItem.id, children);\n        } else {\n          prev.parents.push(item);\n        }\n        return prev;\n      },\n      { parents: [], parentIdToChildren: new Map<string, Item5e[]>() }\n    );\n\n    if (parents.length === items.length) {\n      return items;\n    }\n\n    return parents.reduce<Item5e[]>((result, item) => {\n      result.push(item);\n\n      const children = parentIdToChildren.get(item.id);\n\n      if (children) {\n        result.push(...children);\n      }\n\n      return result;\n    }, []);\n  }\n\n  static accountForExternalSections(\n    props: string[],\n    data: Record<string, any>\n  ) {\n    props.forEach((prop) => {\n      const sectionCollection = data[prop];\n      sectionCollection?.forEach((section: any) => {\n        if (!isNil(section.key)) {\n          return;\n        }\n\n        section.key = SheetSections.getSectionKey(section);\n        section.canCreate = false;\n        section.show = true;\n      });\n    });\n  }\n\n  static getSectionKey(section: TidySectionBase) {\n    if (isNil(section.key)) {\n      return `${section.label}-external`;\n    }\n\n    return section.key;\n  }\n\n  static configureInventory(\n    sections: InventorySection[],\n    tabId: string,\n    sheetPreferences: SheetPreference,\n    sectionConfig?: Record<string, SectionConfig>\n  ) {\n    try {\n      sections = SheetSections.sortKeyedSections(sections, sectionConfig);\n\n      const sortMode = sheetPreferences.tabs?.[tabId]?.sort ?? 'm';\n\n      return sections.map(({ ...section }) => {\n        section.items = ItemUtils.getSortedItems(section.items, sortMode);\n\n        // Apply visibility from configuration\n        section.show = sectionConfig?.[section.key]?.show !== false;\n\n        return section;\n      });\n    } catch (e) {\n      error('An error occurred while configuring inventory', false, e);\n    }\n\n    return sections;\n  }\n\n  static configureSpellbook(\n    document: any,\n    tabId: string,\n    sections: SpellbookSection[],\n    spellClassFilter: string = ''\n  ) {\n    try {\n      const sectionConfigs = TidyFlags.sectionConfig.get(document);\n\n      sections = SheetSections.sortKeyedSections(\n        sections,\n        sectionConfigs?.[tabId]\n      );\n\n      const characterPreferences = SheetPreferencesService.getByType(\n        document.type\n      );\n\n      const sortMode = characterPreferences.tabs?.[tabId]?.sort ?? 'm';\n\n      return sections.map(({ ...section }) => {\n        // Filter Spellbook by Class Filter, if needed\n        section.spells = SpellUtils.tryFilterByClass(\n          section.spells,\n          spellClassFilter\n        );\n\n        // Sort Spellbook\n        section.spells = ItemUtils.getSortedItems(section.spells, sortMode);\n\n        // TODO: Collocate Spellbook Sub Items\n\n        // Apply visibility from configuration\n        section.show =\n          sectionConfigs?.[CONSTANTS.TAB_ACTOR_SPELLBOOK]?.[section.key]\n            ?.show !== false;\n\n        return section;\n      });\n    } catch (e) {\n      error('An error occurred while configuring spells', false, e);\n    }\n\n    return sections;\n  }\n\n  static configureFavorites(\n    favoriteSections: FavoriteSection[],\n    actor: Actor5e,\n    tabId: string,\n    sheetPreferences: SheetPreference,\n    sectionConfig?: Record<string, SectionConfig>\n  ) {\n    let configuredFavorites: FavoriteSection[] = [];\n\n    try {\n      configuredFavorites = SheetSections.sortKeyedSections(\n        favoriteSections,\n        sectionConfig\n      );\n\n      const sortMode = sheetPreferences.tabs?.[tabId]?.sort ?? 'm';\n\n      const favoritesIdMap = actor.system.favorites.reduce(\n        (map: Map<string, CharacterFavorite>, f: CharacterFavorite) => {\n          map.set(f.id, f);\n          return map;\n        },\n        new Map<string, CharacterFavorite>()\n      );\n\n      return (configuredFavorites as FavoriteSection[]).map(\n        ({ ...section }) => {\n          if ('effects' in section) {\n            let effectContexts = section.effects;\n\n            // Sort Favorite Effects\n            if (sortMode === 'm') {\n              const getSort = (effects: Item5e) =>\n                favoritesIdMap.get(effects.getRelativeUUID(actor))?.sort ??\n                Number.MAX_SAFE_INTEGER;\n\n              effectContexts = effectContexts.toSorted(\n                (a, b) => getSort(a.effect) - getSort(b.effect)\n              );\n            } else {\n              effectContexts = effectContexts.toSorted((a, b) =>\n                a.effect.name.localeCompare(b.effect.name, game.i18n.lang)\n              );\n            }\n\n            // TODO: Filter Favorite Effects ?\n          } else if ('activities' in section) {\n            let activities = section.activities;\n\n            // Sort Favorite Activities\n            if (sortMode === 'm') {\n              const getSort = (activity: Activity5e) =>\n                favoritesIdMap.get(activity.relativeUUID)?.sort ??\n                Number.MAX_SAFE_INTEGER;\n\n              activities = activities.toSorted(\n                (a, b) => getSort(a) - getSort(b)\n              );\n            } else {\n              activities = activities.toSorted((a, b) =>\n                a.name.localeCompare(b.name, game.i18n.lang)\n              );\n            }\n\n            // TODO: Filter Favorite Activities?\n          } else {\n            let items = 'spells' in section ? section.spells : section.items;\n            // Sort Favorites Items\n            if (sortMode === 'm') {\n              const getSort = (item: Item5e) =>\n                favoritesIdMap.get(item.getRelativeUUID(actor))?.sort ??\n                Number.MAX_SAFE_INTEGER;\n\n              items = items.toSorted((a, b) => getSort(a) - getSort(b));\n            } else {\n              items = ItemUtils.getSortedItems(items, sortMode);\n            }\n\n            // TODO: Collocate Favorite Sub Items\n\n            if ('spells' in section) {\n              section.spells = items;\n            } else {\n              section.items = items;\n            }\n          }\n\n          // Apply visibility from configuration\n          section.show = sectionConfig?.[section.key]?.show !== false;\n\n          return section;\n        }\n      );\n    } catch (e) {\n      error('An error occurred while configuring favorites', false, e);\n    }\n\n    return configuredFavorites;\n  }\n\n  static configureFeatures<\n    TSection extends\n      | CharacterFeatureSection\n      | FeatureSection\n      | NpcAbilitySection\n  >(\n    features: TSection[],\n    context: CharacterSheetContext | NpcSheetContext,\n    tabId: string,\n    sheetPreferences: SheetPreference,\n    sectionConfig?: Record<string, SectionConfig>\n  ): TSection[] {\n    try {\n      features = SheetSections.sortKeyedSections(features, sectionConfig);\n\n      const sortMode = sheetPreferences.tabs?.[tabId]?.sort ?? 'm';\n\n      return features.map(({ ...section }) => {\n        // Sort Features\n        section.items = ItemUtils.getSortedItems(section.items, sortMode);\n\n        // Collocate Feature Sub Items\n        section.items = SheetSections.collocateSubItems(context, section.items);\n\n        // Apply visibility from configuration\n        section.show = sectionConfig?.[section.key]?.show !== false;\n\n        return section;\n      });\n    } catch (e) {\n      error('An error occurred while configuring features', false, e);\n    }\n\n    return features;\n  }\n\n  static configureActions(\n    sections: ActionSection[],\n    tabId: string,\n    sheetPreferences: SheetPreference,\n    sectionConfigs: Record<string, SectionConfig> | undefined\n  ) {\n    try {\n      sections = SheetSections.sortKeyedSections(sections, sectionConfigs);\n\n      const sortMode = sheetPreferences.tabs?.[tabId]?.sort ?? 'm';\n\n      return sections.map(({ ...section }) => {\n        section.actions = getSortedActions(section, sortMode);\n\n        section.show = sectionConfigs?.[section.key]?.show !== false;\n\n        return section;\n      });\n    } catch (e) {\n      error('An error occurred while configuring actions', false, e);\n    }\n\n    return sections;\n  }\n\n  static getKnownCustomSections(document: any) {\n    const useParentCollection =\n      !!document.parent && !document.compendium?.locked;\n\n    const itemCollection = useParentCollection\n      ? document.parent.items\n      : game.items;\n\n    const sectionSet = itemCollection.reduce((prev: Item5e, curr: Item5e) => {\n      prev.add(TidyFlags.section.get(curr));\n      prev.add(TidyFlags.actionSection.get(curr));\n      return prev;\n    }, new Set<string>());\n\n    settings.value.globalCustomSections.forEach((defaultSectionConfig) =>\n      sectionSet.add(defaultSectionConfig.section)\n    );\n\n    return Array.from<string>(sectionSet)\n      .filter((x) => !isNil(x, ''))\n      .toSorted((left, right) => left.localeCompare(right, game.i18n.lang));\n  }\n\n  static getFilteredGlobalSectionsToShowWhenEmpty(\n    document: any,\n    tabId: string\n  ) {\n    const sheetType = document.type;\n    return settings.value.globalCustomSections\n      .filter((x) => {\n        if (!x.showWhenEmpty) {\n          return false;\n        }\n\n        const isUnfiltered =\n          Object.entries(x.showWhenEmptyFilters).length === 0;\n\n        if (isUnfiltered) {\n          return true;\n        }\n\n        const filters = x.showWhenEmptyFilters[sheetType];\n        const sheetTypeIsIncluded = filters !== undefined;\n\n        return (\n          sheetTypeIsIncluded &&\n          (filters.length === 0 || filters.includes(tabId))\n        );\n      })\n      .map((x) => x.section);\n  }\n}\n","import { CONSTANTS } from 'src/constants';\nimport { getContext, setContext } from 'svelte';\n\nexport type MaybeSearchResults = Set<string> | undefined;\n\nexport function createSearchResultsState() {\n  let uuids = $state<MaybeSearchResults>();\n\n  return {\n    get uuids() {\n      return uuids;\n    },\n    set uuids(value: MaybeSearchResults) {\n      uuids = value;\n    },\n    show(uuid: string) {\n      return !uuids || uuids.has(uuid);\n    },\n  };\n}\n\nlet searchKey = Symbol(CONSTANTS.SVELTE_CONTEXT.SEARCH_RESULTS_STATE);\n\nexport function getSearchResultsContext() {\n  return (\n    getContext<ReturnType<typeof createSearchResultsState>>(searchKey) ??\n    createSearchResultsState()\n  );\n}\n\nexport function setSearchResultsContext(\n  value: ReturnType<typeof createSearchResultsState>\n) {\n  setContext(searchKey, value);\n}\n","<script lang=\"ts\">\n  import ExpandableContainer from 'src/components/expandable/ExpandableContainer.svelte';\n  import CapacityBar from './CapacityBar.svelte';\n  import ContainerContentsSections from './ContainerContentsSections.svelte';\n  import type { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import { getContext } from 'svelte';\n  import type { ContainerContents, Item5e } from 'src/types/item.types';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { CONSTANTS } from 'src/constants';\n  import { getSearchResultsContext } from 'src/features/search/search.svelte';\n\n  interface Props {\n    container: Item5e;\n    containerContents: ContainerContents;\n    editable: boolean;\n    inlineToggleService: InlineToggleService;\n    lockItemQuantity: boolean;\n    sheetDocument: any;\n    unlocked?: boolean;\n  }\n\n  let {\n    container,\n    containerContents,\n    editable,\n    inlineToggleService,\n    lockItemQuantity,\n    sheetDocument,\n    unlocked = true,\n  }: Props = $props();\n\n  let toggleServiceMap = $derived(inlineToggleService.map);\n\n  const searchResults = getSearchResultsContext();\n\n  let tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  async function onDrop(\n    event: DragEvent & { currentTarget: EventTarget & HTMLElement },\n  ) {\n    container.sheet._onDrop(event);\n\n    event.preventDefault();\n    event.stopImmediatePropagation();\n  }\n</script>\n\n<ExpandableContainer\n  expanded={toggleServiceMap.get(tabId)?.has(container.id) === true}\n  class={!searchResults.show(container.uuid) ? 'hidden' : ''}\n>\n  <div\n    class=\"flex-column extra-small-gap flex-1 inline-container-view\"\n    data-tidy-container-id={container.id}\n    ondrop={onDrop}\n  >\n    <CapacityBar {container} capacity={containerContents.capacity} />\n    <ContainerContentsSections\n      contents={containerContents.contents}\n      {container}\n      {editable}\n      itemContext={containerContents.itemContext}\n      {lockItemQuantity}\n      {inlineToggleService}\n      {sheetDocument}\n      {unlocked}\n    />\n    {#if !containerContents.contents.some((c) => c.items.length > 0)}\n      <div class=\"empty-container\">\n        <span class=\"empty-container-text\"\n          >{FoundryAdapter.localize('TIDY5E.EmptyContainer')}</span\n        >\n      </div>\n    {/if}\n  </div>\n</ExpandableContainer>\n","<script lang=\"ts\">\n  import TidyTable, {\n    type TidyTableColumns,\n  } from 'src/components/table/TidyTable.svelte';\n  import TidyTableHeaderCell from 'src/components/table/TidyTableHeaderCell.svelte';\n  import TidyTableHeaderRow from 'src/components/table/TidyTableHeaderRow.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { ContainerItemContext, Item5e } from 'src/types/item.types';\n  import type { Actor5e, InventorySection } from 'src/types/types';\n  import ItemDeleteControl from 'src/components/item-list/controls/ItemDeleteControl.svelte';\n  import ItemEditControl from 'src/components/item-list/controls/ItemEditControl.svelte';\n  import ItemTableRowV2 from 'src/components/item-list/v2/ItemTableRowV2.svelte';\n  import TidyTableCell from 'src/components/table/TidyTableCell.svelte';\n  import ItemUseButton from 'src/components/item-list/ItemUseButton.svelte';\n  import ItemName from 'src/components/item-list/ItemName.svelte';\n  import InlineFavoriteIcon from 'src/components/item-list/InlineFavoriteIcon.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import InlineToggleControl from 'src/sheets/classic/shared/InlineToggleControl.svelte';\n  import { SheetSections } from 'src/features/sections/SheetSections';\n  import { getContext, type Component } from 'svelte';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\n  import InlineContainerView from './InlineContainerView.svelte';\n  import ItemUses from 'src/components/item-list/ItemUses.svelte';\n  import { getSearchResultsContext } from 'src/features/search/search.svelte';\n\n  interface Props {\n    contents: InventorySection[];\n    container: Item5e;\n    editable: boolean;\n    itemContext: Record<string, ContainerItemContext>;\n    inlineToggleService: InlineToggleService;\n    lockItemQuantity: boolean;\n    /** The sheet which is rendering this recursive set of container contents. */\n    sheetDocument: Actor5e | Item5e;\n    unlocked?: boolean;\n  }\n\n  let {\n    contents,\n    container,\n    editable,\n    itemContext,\n    inlineToggleService,\n    lockItemQuantity,\n    sheetDocument,\n    unlocked = true,\n  }: Props = $props();\n\n  const tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  let configuredContents = $derived(\n    SheetSections.configureInventory(\n      contents.filter((i) => i.items.length),\n      tabId,\n      SheetPreferencesService.getByType(sheetDocument.type),\n      TidyFlags.sectionConfig.get(container)?.[\n        CONSTANTS.TAB_CONTAINER_CONTENTS\n      ],\n    ),\n  );\n\n  const searchResults = getSearchResultsContext();\n\n  let classicControls: {\n    component: Component<any>;\n    getProps: (item: Item5e) => any;\n  }[] = $derived.by(() => {\n    let result: {\n      component: Component<any>;\n      getProps: (item: Item5e) => any;\n    }[] = [];\n\n    result.push({\n      component: ItemEditControl,\n      getProps: (item: Item5e) => ({ item }),\n    });\n\n    if (unlocked) {\n      result.push({\n        component: ItemDeleteControl,\n        getProps: (item: Item5e) => ({\n          item,\n          deleteFn: () => item.deleteDialog(),\n        }),\n      });\n    }\n\n    return result;\n  });\n\n  const weightUnit = FoundryAdapter.getWeightUnit();\n\n  const classicControlWidthRems = 1.5;\n\n  let useClassicControls = $derived(\n    FoundryAdapter.useClassicControls(container),\n  );\n\n  let gridTemplateColumns = $derived.by(() => {\n    let result: TidyTableColumns = [\n      {\n        name: 'Name',\n        width: '1fr',\n      },\n      {\n        name: 'Uses',\n        width: '3.125rem',\n      },\n      {\n        name: 'Weight',\n        width: '3rem',\n      },\n      {\n        name: 'Quantity',\n        width: '3rem',\n      },\n    ];\n\n    if (useClassicControls) {\n      result.push({\n        name: 'Controls',\n        width: `${classicControlWidthRems * classicControls.length}rem`,\n      });\n    }\n\n    return result;\n  });\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n{#each configuredContents as section (section.key)}\n  {#if section.show}\n    {@const itemEntries = section.items.map((item) => ({\n      item,\n      ctx: itemContext[item.id],\n    }))}\n\n    <section class=\"container-contents-list-section\">\n      <TidyTable\n        key={section.key}\n        data-custom-section={section.custom ? true : null}\n        {gridTemplateColumns}\n      >\n        {#snippet header()}\n          <TidyTableHeaderRow>\n            <TidyTableHeaderCell primary={true}>\n              {localize(section.label)} ({itemEntries.length})\n            </TidyTableHeaderCell>\n            <TidyTableHeaderCell title={localize('DND5E.Charges')}>\n              <i class=\"fas fa-bolt\"></i>\n            </TidyTableHeaderCell>\n            <TidyTableHeaderCell>\n              {localize('DND5E.Weight')}\n            </TidyTableHeaderCell>\n            <TidyTableHeaderCell>\n              {localize('DND5E.QuantityAbbr')}\n            </TidyTableHeaderCell>\n            {#if editable && useClassicControls}\n              <TidyTableHeaderCell></TidyTableHeaderCell>\n            {/if}\n          </TidyTableHeaderRow>\n        {/snippet}\n        {#snippet body()}\n          {#each itemEntries as { item, ctx } (item.id)}\n            {@const weight = ctx?.totalWeight ?? item.system.weight.value}\n\n            <ItemTableRowV2\n              {item}\n              hidden={!searchResults.show(item.uuid)}\n              rowClass={FoundryAdapter.getInventoryRowClasses(\n                item,\n                itemContext[item.id]?.attunement,\n              )}\n              contextMenu={{\n                type: CONSTANTS.CONTEXT_MENU_TYPE_ITEMS,\n                uuid: item.uuid,\n              }}\n              draggable={editable}\n            >\n              {#snippet children({ toggleSummary })}\n                <TidyTableCell class=\"flex-row extra-small-gap\" primary={true}>\n                  <ItemUseButton\n                    disabled={!FoundryAdapter.canUseItem(item)}\n                    {item}\n                  />\n                  {#if ('containerContents' in ctx && !!ctx.containerContents)}\n                    <InlineToggleControl\n                      entityId={item.id}\n                      {inlineToggleService}\n                    />\n                  {/if}\n                  <!-- This is generally what we want in Tidy Tables / Item Table V2; consider breaking off ItemNameV2 to propagate and replace the old ItemName gradually. -->\n                  <ItemName\n                    onToggle={() => toggleSummary()}\n                    cssClass=\"align-self-stretch flex-row align-items-center\"\n                    {item}\n                  >\n                    <span\n                      class=\"truncate flex-1\"\n                      data-tidy-item-name={item.name}\n                      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_NAME}\n                      >{item.name}</span\n                    >\n                  </ItemName>\n\n                  {#if !FoundryAdapter.concealDetails(item)}\n                    {@const attunementContext =\n                      FoundryAdapter.getAttunementContext(item)}\n\n                    {#if attunementContext}\n                      <i\n                        style=\"margin-left: auto; align-self: center;\"\n                        class=\"item-state-icon fas {attunementContext.icon} {attunementContext.cls} fa-fw\"\n                        title={localize(attunementContext.title)}\n                      ></i>\n                    {/if}\n                  {/if}\n                  {#if !!ctx.favoriteId}\n                    <InlineFavoriteIcon />\n                  {/if}\n                </TidyTableCell>\n                <TidyTableCell>\n                  {#if item.hasLimitedUses}\n                    <ItemUses {item} />\n                  {:else}\n                    <span class=\"text-body-tertiary\">&mdash;</span>\n                  {/if}\n                </TidyTableCell>\n                <TidyTableCell\n                  title={localize('TIDY5E.Inventory.Weight.Text', {\n                    weight: weight,\n                    weightUnit: weightUnit,\n                  })}\n                >\n                  <span class=\"truncate\">\n                    {weight}\n                  </span>\n                </TidyTableCell>\n                <TidyTableCell>\n                  <!-- Qty -->\n                  <TextInput\n                    document={item}\n                    field=\"system.quantity\"\n                    value={item.system.quantity}\n                    selectOnFocus={true}\n                    disabled={!editable || lockItemQuantity}\n                    placeholder=\"0\"\n                    allowDeltaChanges={true}\n                  />\n                </TidyTableCell>\n                {#if editable && useClassicControls}\n                  <TidyTableCell>\n                    {#each classicControls as control}\n                      <control.component\n                        {...control.getProps(item)}\n                        class=\"tidy-table-control\"\n                      ></control.component>\n                    {/each}\n                  </TidyTableCell>\n                {/if}\n              {/snippet}\n            </ItemTableRowV2>\n            {#if 'containerContents' in ctx && !!ctx.containerContents}\n              <InlineContainerView\n                container={item}\n                containerContents={ctx.containerContents}\n                {editable}\n                {inlineToggleService}\n                {lockItemQuantity}\n                {sheetDocument}\n                {unlocked}\n              />\n            {/if}\n          {/each}\n        {/snippet}\n      </TidyTable>\n    </section>\n  {/if}\n{/each}\n","import { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\nimport type { DocumentFilters, ItemFilter } from 'src/runtime/item/item.types';\nimport type { Item5e } from 'src/types/item.types';\nimport { isNil } from 'src/utils/data';\nimport { debug, error } from 'src/utils/logging';\n\n/*\n// Filter Data\n{\n  inventory: {\n    action: true,\n    reaction: false,\n    // nulls are just excluded\n    equipped: true,\n  },\n  spellbook: {\n    canCast: true,\n  },\n  features: {\n    action: true,\n  },\n}\n*/\n\ntype ItemFilterName = ItemFilter['name'];\ntype ItemFilters = Record<ItemFilterName, boolean | undefined>;\ntype ItemFilterGroupName = string;\ntype ItemFilterData = Record<ItemFilterGroupName, ItemFilters>;\n\nexport class ItemFilterService {\n  private _filterData = $state<ItemFilterData>()!;\n\n  private _document: any;\n\n  // TODO: Have sheets send in what they have in session storage upon construction\n  constructor(filterData: ItemFilterData = {}, document: any) {\n    this._filterData = filterData;\n    this._document = document;\n  }\n\n  // TODO: Better yet, have composed store ready to use, and have it update whenever the filters update\n  compose(filterGroup: ItemFilterGroupName) {\n    const group = this._getGroup(filterGroup) ?? {};\n\n    const composition = Object.entries(group)\n      .map(([filterName, value]) => {\n        return {\n          filter: ItemFilterRuntime.getFilter(filterName),\n          value,\n        };\n      })\n      .filter((f) => typeof f.filter?.predicate === 'function')\n      .reduce(\n        (prev, curr) => {\n          return (item: Item5e) =>\n            prev(item) && curr.filter?.predicate?.(item) == curr.value;\n        },\n        (item: Item5e) => true\n      );\n\n    return (item: Item5e) => {\n      try {\n        return composition(item);\n      } catch (e) {\n        error('An error occurred while filtering an item', false, e);\n        debug('Item filtering error troubleshooting info', {\n          item,\n          filters: group,\n        });\n      }\n\n      return true;\n    };\n  }\n\n  onFilter(\n    filterGroup: ItemFilterGroupName,\n    filterName: ItemFilterName,\n    value: boolean | null\n  ) {\n    try {\n      let group = this._getGroup(filterGroup);\n\n      if (value === null) {\n        delete group[filterName];\n        return;\n      }\n\n      group[filterName] = value;\n    } finally {\n      this._document.render();\n    }\n  }\n\n  onFilterClearAll(filterGroup?: ItemFilterGroupName) {\n    if (!isNil(filterGroup, '')) {\n      delete this._filterData[filterGroup!];\n    } else {\n      this._filterData = {};\n    }\n\n    this._document.render();\n  }\n\n  private _getGroup(filterGroup: ItemFilterGroupName) {\n    let group = this._filterData[filterGroup];\n\n    if (!group) {\n      this._filterData[filterGroup] = group = {};\n    }\n\n    return group;\n  }\n\n  getDocumentItemFilterData(): DocumentFilters {\n    const documentFilters = ItemFilterRuntime.getDocumentFilters(\n      this._document\n    );\n    const documentItemFilterData: DocumentFilters = {};\n\n    for (let [tab, categories] of Object.entries(documentFilters)) {\n      documentItemFilterData[tab] ??= {};\n\n      for (let [category, filters] of Object.entries(categories)) {\n        documentItemFilterData[tab][category] ??= [];\n        const effectiveFilters = Array.isArray(filters) ? filters : filters();\n\n        for (let filter of effectiveFilters) {\n          try {\n            documentItemFilterData[tab][category].push({\n              ...filter,\n              value: this._filterData[tab]?.[filter.name] ?? null,\n            });\n          } catch (e) {\n            error(\n              'An error occurred while setting up document item filter data',\n              false,\n              e\n            );\n            debug('Document item filter data error troubleshooting info', {\n              tab,\n              category,\n              filter,\n              effectiveFilters,\n            });\n          }\n        }\n      }\n    }\n\n    return documentItemFilterData;\n  }\n\n  get filterData() {\n    return this._filterData;\n  }\n}\n","import type { ContainerContents, Item5e } from 'src/types/item.types';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { getContext } from 'svelte';\nimport { ItemFilterService } from '../filtering/ItemFilterService.svelte';\nimport { debug } from 'src/utils/logging';\nimport type { ActionItem } from 'src/types/types';\n\nexport class ItemVisibility {\n  static countVisibleItems(items: Item5e[], uuids?: Set<string>) {\n    if (!uuids) {\n      return items.length;\n    }\n\n    return items.reduce(\n      (prev, curr) => prev + (uuids.has(curr.uuid) ? 1 : 0),\n      0\n    );\n  }\n\n  static getItemsToShowAtDepth(args: {\n    tabId: string;\n    criteria: string;\n    sections: (\n      | { items: Item5e[] }\n      | { spells: Item5e[] }\n      | { actions: ActionItem[] }\n    )[];\n    itemContext: Record<string, { containerContents?: ContainerContents }>;\n  }) {\n    const itemFilterService = getContext<ItemFilterService | undefined>(\n      'itemFilterService'\n    );\n\n    // TODO: Have composed store always ready to use\n    const filter = itemFilterService?.compose(args.tabId) ?? (() => true);\n\n    // Is there a better way to do this? We are iterating over these items quite a lot.\n    const items = args.sections.flatMap((x) =>\n      'items' in x\n        ? x.items\n        : 'spells' in x\n        ? x.spells\n        : x.actions.map((y) => y.item)\n    );\n\n    const results = new Set(\n      ItemVisibility.recursivelyFindEligibleItems({\n        criteria: args.criteria,\n        filter: filter,\n        itemContext: args.itemContext,\n        items: items,\n      })\n    );\n\n    debug('Item IDs to show', { results, ...args });\n\n    return results;\n  }\n\n  private static recursivelyFindEligibleItems(args: {\n    criteria: string;\n    filter: (item: Item5e) => boolean;\n    items: Item5e[];\n    itemContext: Record<string, { containerContents?: ContainerContents }>;\n  }): string[] {\n    let results: string[] = [];\n\n    for (let item of args.items) {\n      const containerContents = args.itemContext[item.id]?.containerContents;\n      let containedItemsToInclude: string[] = [];\n      if (containerContents) {\n        containedItemsToInclude = ItemVisibility.recursivelyFindEligibleItems({\n          criteria: args.criteria,\n          filter: args.filter,\n          itemContext: containerContents.itemContext,\n          items: containerContents.contents.flatMap((s) => s.items),\n        });\n\n        results = results.concat(containedItemsToInclude);\n      }\n\n      const includeItem =\n        (FoundryAdapter.searchItem(item, args.criteria) && args.filter(item)) ||\n        !!containedItemsToInclude.length;\n      if (includeItem) {\n        results.push(item.uuid);\n      }\n    }\n\n    return results;\n  }\n}\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getContext } from 'svelte';\n  import CapacityBar from 'src/sheets/classic/container/CapacityBar.svelte';\n  import Currency from 'src/sheets/classic/actor/Currency.svelte';\n  import UtilityToolbar from 'src/components/utility-bar/UtilityToolbar.svelte';\n  import UtilityToolbarCommand from 'src/components/utility-bar/UtilityToolbarCommand.svelte';\n  import Search from 'src/components/utility-bar/Search.svelte';\n  import FilterMenu from 'src/components/filter/FilterMenu.svelte';\n  import ButtonMenu from 'src/components/button-menu/ButtonMenu.svelte';\n  import ButtonMenuCommand from 'src/components/button-menu/ButtonMenuCommand.svelte';\n  import PinnedFilterToggles from 'src/components/filter/PinnedFilterToggles.svelte';\n  import { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\n  import ContainerContentsSections from 'src/sheets/classic/container/ContainerContentsSections.svelte';\n  import { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import { ItemVisibility } from 'src/features/sections/ItemVisibility';\n  import {\n    createSearchResultsState,\n    setSearchResultsContext,\n  } from 'src/features/search/search.svelte';\n  import { getContainerSheetClassicContext } from 'src/sheets/sheet-context.svelte';\n  import { TidyFlags } from 'src/api';\n  import { SheetSections } from 'src/features/sections/SheetSections';\n  import { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\n\n  let context = $derived(getContainerSheetClassicContext());\n\n  let tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  let inlineToggleService = getContext<InlineToggleService>(\n    CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n  );\n\n  let searchCriteria = $state('');\n\n  let allItems = $derived(\n    context.containerContents.contents.flatMap((x) => x.items),\n  );\n\n  const searchResults = createSearchResultsState();\n  setSearchResultsContext(searchResults);\n\n  $effect(() => {\n    searchResults.uuids = ItemVisibility.getItemsToShowAtDepth({\n      criteria: searchCriteria,\n      itemContext: context.itemContext,\n      sections: context.containerContents.contents,\n      tabId: tabId,\n    });\n  });\n\n  const localize = FoundryAdapter.localize;\n\n  let utilityBarCommands = $derived(\n    context.utilities[tabId]?.utilityToolbarCommands ?? [],\n  );\n\n  let menuOpen = $state(false);\n\n  // TODO: Figure out how to avoid duplicating the recursive inline container section config :/\n  let configuredContents = $derived(\n    SheetSections.configureInventory(\n      context.containerContents.contents.filter((i) => i.items.length),\n      tabId,\n      SheetPreferencesService.getByType(context.item.type),\n      TidyFlags.sectionConfig.get(context.item)?.[\n        CONSTANTS.TAB_CONTAINER_CONTENTS\n      ],\n    ),\n  );\n</script>\n\n<div class=\"container-contents-wrapper\">\n  <div role=\"presentation\" class=\"currency-wrapper\">\n    <Currency document={context.item} />\n  </div>\n\n  <UtilityToolbar>\n    <Search bind:value={searchCriteria}></Search>\n    <PinnedFilterToggles\n      filterGroupName={tabId}\n      filters={ItemFilterRuntime.getPinnedFiltersForTab(\n        context.filterPins,\n        context.filterData,\n        tabId,\n      )}\n    />\n    <FilterMenu {tabId} />\n    {#each utilityBarCommands as command (command.title)}\n      <UtilityToolbarCommand\n        title={command.title}\n        iconClass={command.iconClass}\n        text={command.text}\n        visible={command.visible ?? true}\n        onExecute={(ev) => command.execute?.(ev)}\n        sections={configuredContents}\n      />\n    {/each}\n\n    {#if FoundryAdapter.userIsGm()}\n      <ButtonMenu\n        iconClass=\"ra ra-fairy-wand\"\n        buttonClass={menuOpen ? 'menu-is-open' : ''}\n        position=\"bottom\"\n        anchor=\"right\"\n        title={localize('TIDY5E.Utilities.GMTools')}\n        bind:open={menuOpen}\n        menuElement=\"div\"\n        buttonStyle=\"transparent-inline-icon\"\n      >\n        <!-- TODO: identify all items recursively -->\n        <ButtonMenuCommand\n          onMenuClick={() => {\n            FoundryAdapter.identifyAllItemsForContainer(context.item, allItems);\n          }}\n          iconClass=\"fas fa-magnifying-glass\"\n        >\n          {localize('TIDY5E.Utilities.IdentifyAll')}\n        </ButtonMenuCommand>\n        <ButtonMenuCommand\n          onMenuClick={() => {\n            FoundryAdapter.markAllItemsAsUnidentifiedForContainer(\n              context.item,\n              allItems,\n            );\n          }}\n          iconClass=\"fas fa-question\"\n        >\n          {localize('TIDY5E.Utilities.MarkAllAsUnidentified')}\n        </ButtonMenuCommand>\n      </ButtonMenu>\n    {/if}\n  </UtilityToolbar>\n\n  <div\n    class=\"tidy-container-contents scroll-container flex-column small-gap\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEMS_CONTAINER}\n  >\n    <ContainerContentsSections\n      contents={context.containerContents.contents}\n      container={context.item}\n      editable={context.editable}\n      itemContext={context.containerContents.itemContext}\n      {inlineToggleService}\n      lockItemQuantity={context.lockItemQuantity}\n      sheetDocument={context.item}\n    />\n  </div>\n  <footer class=\"container-contents-footer\">\n    <CapacityBar container={context.item} capacity={context.capacity} />\n  </footer>\n</div>\n\n<style lang=\"scss\">\n  .container-contents-wrapper {\n    height: 100%;\n    padding-left: 1rem;\n    padding-right: 0.25rem;\n    display: flex;\n    flex-direction: column;\n    --utility-toolbar-margin-top: 0;\n    --utility-toolbar-margin-right: -0.75rem;\n    --utility-toolbar-padding-right: 1.25rem;\n  }\n\n  .scroll-container {\n    padding-bottom: 0;\n    padding-right: 0.75rem;\n  }\n\n  .container-contents-footer {\n    padding: 0.25rem 0.75rem 0.25rem 0;\n    display: flex;\n    gap: 0.25rem;\n    flex-direction: column;\n  }\n\n  .currency-wrapper {\n    padding-right: 0.75rem;\n    padding-top: 0.25rem;\n    margin-block-end: 0.25rem;\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import Select from 'src/components/inputs/Select.svelte';\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import ItemProperties from '../parts/ItemProperties.svelte';\n  import ContentConcealer from 'src/components/content-concealment/ContentConcealer.svelte';\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import { getContainerSheetClassicContext } from 'src/sheets/sheet-context.svelte';\n  import NumberInputSetting from 'src/applications/settings/parts/NumberInputSetting.svelte';\n\n  let context = $derived(getContainerSheetClassicContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<ContentConcealer conceal={context.concealDetails}>\n  <h3 class=\"form-header\">{localize('DND5E.CONTAINER.Details')}</h3>\n\n  <div class=\"form-group stacked container-properties\">\n    <label for=\"\">{localize('DND5E.CONTAINER.FIELDS.properties.label')}</label>\n    <ItemProperties />\n  </div>\n\n  {#if context.properties.object.mgc}\n    <div class=\"form-group\">\n      <label for=\"{appId}-attunement\">{localize('DND5E.Attunement')}</label>\n      <div class=\"form-fields\">\n        <Checkbox\n          id=\"{appId}-attuned\"\n          document={context.item}\n          field=\"system.attuned\"\n          checked={context.source.attuned}\n          disabled={!context.editable ||\n            // @ts-expect-error\n            !context.config.attunementTypes[context.system.attunement]}\n          title={localize('DND5E.AttunementAttuned')}\n        />\n        <Select\n          id=\"{appId}-attunement\"\n          document={context.item}\n          field=\"system.attunement\"\n          value={context.source.attunement}\n          disabled={!context.editable}\n        >\n          <SelectOptions\n            data={context.config.attunementTypes}\n            blank={localize('DND5E.AttunementNone')}\n          />\n        </Select>\n      </div>\n    </div>\n  {/if}\n\n  <h3 class=\"form-header\">\n    {localize('DND5E.CONTAINER.FIELDS.capacity.label')}\n  </h3>\n\n  <div class=\"form-group\">\n    <div class=\"form-group\">\n      <label>{localize('DND5E.CONTAINER.FIELDS.capacity.count.label')}</label>\n      <div class=\"form-fields\">\n        <NumberInput\n          document={context.item}\n          field=\"system.capacity.count\"\n          value={context.source.capacity.count}\n          step=\"1\"\n          min=\"0\"\n          placeholder=\"\"\n        />\n      </div>\n    </div>\n  </div>\n\n  <!-- Volume Capacity -->\n\n  <div class=\"form-group split-group\">\n    <label>{localize('DND5E.CONTAINER.FIELDS.capacity.volume.label')}</label>\n    <div class=\"form-fields\">\n      <div class=\"form-group label-top\">\n        <label>{localize('DND5E.Amount')}</label>\n        <div class=\"form-fields\">\n          <NumberInput\n            document={context.item}\n            field=\"system.capacity.volume.value\"\n            value={context.source.capacity.volume.value}\n            step=\"any\"\n            min=\"0\"\n            placeholder=\"\"\n          />\n        </div>\n      </div>\n\n      <div class=\"form-group label-top\">\n        <label>{localize('DND5E.Unit')}</label>\n        <div class=\"form-fields\">\n          <Select\n            document={context.item}\n            field=\"system.capacity.volume.units\"\n            value={context.source.capacity.volume.units}\n            blankValue=\"\"\n          >\n            <SelectOptions\n              data={context.config.volumeUnits}\n              labelProp=\"label\"\n            />\n          </Select>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- Weight Capacity -->\n  <div class=\"form-group split-group\">\n    <label>{localize('DND5E.CONTAINER.FIELDS.capacity.weight.label')}</label>\n    <div class=\"form-fields\">\n      <div class=\"form-group label-top\">\n        <label>{localize('DND5E.Amount')}</label>\n        <div class=\"form-fields\">\n          <NumberInput\n            document={context.item}\n            field=\"system.capacity.weight.value\"\n            value={context.source.capacity.weight.value}\n            step=\"any\"\n            min=\"0\"\n            placeholder=\"\"\n          />\n        </div>\n      </div>\n\n      <div class=\"form-group label-top\">\n        <label>{localize('DND5E.Unit')}</label>\n        <div class=\"form-fields\">\n          <Select\n            document={context.item}\n            field=\"system.capacity.weight.units\"\n            value={context.source.capacity.weight.units}\n            blankValue=\"\"\n          >\n            <SelectOptions\n              data={context.config.weightUnits}\n              labelProp=\"label\"\n            />\n          </Select>\n        </div>\n      </div>\n    </div>\n  </div>\n</ContentConcealer>\n","<script lang=\"ts\">\n  import { onMount } from 'svelte';\n\n  type EditorOptions =\n    any /*foundry.applications.elements.HTMLProseMirrorElement.ProseMirrorInputConfig*/;\n\n  interface Props {\n    field: string;\n    content: string;\n    enriched?: string | null;\n    editorOptions?: EditorOptions;\n    documentUuid: string;\n    manageSecrets?: boolean;\n    onSave?: () => void;\n    [key: string]: any;\n  }\n\n  let {\n    field,\n    content,\n    enriched = null,\n    editorOptions = {},\n    documentUuid,\n    manageSecrets = false,\n    onSave,\n    ...rest\n  }: Props = $props();\n\n  let proseMirrorContainerEl: HTMLElement;\n\n  let actualEditorOptions = $derived(\n    foundry.utils.mergeObject(\n      {\n        name: field,\n        collaborate: false,\n        compact: false,\n        documentUUID: documentUuid,\n        editable: true,\n        height: 200,\n        toggled: true,\n        value: content,\n        enriched: enriched ?? content,\n      },\n      editorOptions,\n    ) as EditorOptions,\n  );\n\n  function onEditorActivation(node: HTMLElement) {\n    node.addEventListener('click', (ev: MouseEvent) => {\n      if (\n        ev.target instanceof HTMLElement &&\n        ev.target.closest('[data-action=\"save\"]')\n      ) {\n        handleSave();\n      }\n    });\n    node.addEventListener('keydown', (event) => {\n      if (\n        game.keyboard.isModifierActive(KeyboardManager.MODIFIER_KEYS.CONTROL) &&\n        event.key === 's'\n      ) {\n        handleSave();\n      }\n    });\n  }\n\n  function handleSave() {\n    onSave?.();\n    bindSecretUi();\n  }\n\n  function bindSecretUi() {\n    if (!manageSecrets || !actualEditorOptions.toggled) {\n      return;\n    }\n\n    const secret = new HTMLSecret({\n      parentSelector: `prose-mirror`,\n      callbacks: {\n        content: (_secret: HTMLElement) => content,\n        update: (secret: HTMLElement, content: string) => {\n          secret.closest<HTMLElement & { value: string }>(\n            'prose-mirror',\n          )!.value = content;\n        },\n      },\n    });\n\n    queueMicrotask(() => {\n      secret.bind(proseMirrorContainerEl);\n    });\n  }\n\n  // Create Editor element and put it in the contents element.\n  onMount(() => {\n    const element =\n      foundry.applications.elements.HTMLProseMirrorElement.create(\n        actualEditorOptions,\n      );\n\n    proseMirrorContainerEl.innerHTML = element.outerHTML;\n\n    bindSecretUi();\n  });\n</script>\n\n<div\n  style=\"display: contents;\"\n  class={rest.class ?? ''}\n  bind:this={proseMirrorContainerEl}\n  use:onEditorActivation\n></div>\n","<script lang=\"ts\">\n  import SheetEditorV2 from 'src/components/editor/SheetEditorV2.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n</script>\n\n{#key context.item.system.description.value}\n  <article class=\"editor-container\">\n    <SheetEditorV2\n      content={context.item.system.description.value}\n      enriched={context.enriched.description}\n      field=\"system.description.value\"\n      editorOptions={{\n        editable: context.editable,\n      }}\n      documentUuid={context.document.uuid}\n      manageSecrets={context.document.isOwner}\n    />\n  </article>\n{/key}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"form-group\">\n  <div class=\"form-group\">\n    <label for=\"{appId}-identifier\">{localize('DND5E.Identifier')}</label>\n    <div class=\"form-fields\">\n      <TextInput\n        id=\"{appId}-identifier\"\n        document={context.item}\n        field=\"system.identifier\"\n        value={context.source.identifier}\n        placeholder={context.item.identifier}\n        disabled={!context.editable}\n      />\n    </div>\n    <p class=\"hint\">{localize('DND5E.IdentifierError')}</p>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import type { Snippet } from 'svelte';\n\n  interface Props {\n    children?: Snippet;\n    [key: string]: any;\n  }\n\n  let { children, ...rest }: Props = $props();\n</script>\n\n<div class=\"accordion {rest.class}\">\n  {@render children?.()}\n</div>\n","<script lang=\"ts\">\n  import { type Snippet } from 'svelte';\n  import ExpandableContainer from 'src/components/expandable/ExpandableContainer.svelte';\n  import { CONSTANTS } from 'src/constants';\n\n  interface Props {\n    open?: boolean;\n    header?: Snippet;\n    children?: Snippet;\n    [key: string]: any;\n  }\n\n  let { open = $bindable(false), header, children, ...rest }: Props = $props();\n</script>\n\n<section class=\"accordion-item {rest.class ?? ''}\">\n  <h2 class=\"accordion-item-header\" class:open>\n    <a\n      class=\"accordion-item-toggle\"\n      type=\"button\"\n      onclick={() => (open = !open)}\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.EXPANSION_TOGGLE}\n    >\n      <span class=\"accordion-arrow\" class:open\n        ><i class=\"fas fa-chevron-right\"></i></span\n      >\n      {@render header?.()}\n    </a>\n  </h2>\n\n  <ExpandableContainer expanded={open}>\n    <div class=\"accordion-item-content\">\n      {@render children?.()}\n    </div>\n  </ExpandableContainer>\n</section>\n","<script lang=\"ts\">\n  import Accordion from 'src/components/accordion/Accordion.svelte';\n  import AccordionItem from 'src/components/accordion/AccordionItem.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    /**\n     * When true, descriptions are rendered to the DOM; else, they are excluded.\n     *\n     * @remarks\n     * This is a compatibility feature to allow for the singleton active editor\n     * while preventing unwanted additional data saving from readonly editor content\n     * which has compatibility tags allowing it to render secret buttons.\n     *\n     * When showing the active editor and when saving active editor changes,\n     * readonly editors should not be in the form / DOM, else strange side effects occur.\n     */\n    renderDescriptions?: boolean;\n    onEdit?: (detail: {\n      contentToEdit: string;\n      enrichedText: string;\n      fieldToEdit: string;\n    }) => void;\n  }\n\n  let { renderDescriptions = true, onEdit }: Props = $props();\n\n  let context = $derived(getItemSheetContext());\n\n  let accordionItemOpenStates = $state<boolean[]>([]);\n\n  $effect(() => {\n    if (context.itemDescriptions.length !== accordionItemOpenStates.length) {\n      accordionItemOpenStates = context.itemDescriptions.map(\n        (_, i) => accordionItemOpenStates[i] ?? i === 0,\n      );\n    }\n  });\n\n  function manageSecrets(node: HTMLElement) {\n    if (!context.item.isOwner) {\n      return;\n    }\n\n    const secret = new HTMLSecret({\n      parentSelector: `[data-edit]`,\n      callbacks: {\n        content: (secret: HTMLElement) =>\n          foundry.utils.getProperty(\n            context.item,\n            secret.closest<HTMLElement>('[data-edit]')!.dataset.edit,\n          ),\n        update: (secret: HTMLElement, content: string) =>\n          context.item.update({\n            [secret.closest<HTMLElement>('[data-edit]')!.dataset.edit!]:\n              content,\n          }),\n      },\n    });\n\n    queueMicrotask(() => {\n      secret.bind(node);\n    });\n  }\n</script>\n\n{#if renderDescriptions}\n  <div class=\"item-descriptions-container\">\n    <Accordion>\n      {#each accordionItemOpenStates, i}\n        {@const itemDescription = context.itemDescriptions[i]}\n        {#key itemDescription.content}\n          <div use:manageSecrets>\n            <AccordionItem\n              bind:open={accordionItemOpenStates[i]}\n              class=\"editor\"\n            >\n              {#snippet header()}\n                <span class=\"flex-1 flex-row justify-content-space-between\">\n                  {itemDescription.label}\n\n                  {#if context.editable}\n                    <button\n                      type=\"button\"\n                      class=\"inline-icon-button edit-item-description\"\n                      onclick={(event) => {\n                        event.stopPropagation();\n                        onEdit?.({\n                          contentToEdit: itemDescription.content,\n                          enrichedText: itemDescription.enriched,\n                          fieldToEdit: itemDescription.field,\n                        });\n                      }}\n                      tabindex={settings.value.useAccessibleKeyboardSupport\n                        ? 0\n                        : -1}><i class=\"fas fa-feather\"></i></button\n                    >\n                  {/if}\n                </span>\n              {/snippet}\n              <div\n                data-edit={itemDescription.field}\n                class=\"item-editor-descriptions-html-container user-select-text\"\n              >\n                {@html itemDescription.enriched}\n              </div>\n            </AccordionItem>\n          </div>\n        {/key}\n      {/each}\n    </Accordion>\n  </div>\n{/if}\n\n<style lang=\"scss\">\n  .item-descriptions-container {\n    padding-right: 0.3125rem;\n\n    .edit-item-description {\n      padding-left: 2rem;\n      padding-right: 0.125rem;\n    }\n  }\n</style>\n","import { getThemes } from 'src/theme/theme-reference';\nimport { debug } from './logging';\nimport { CONSTANTS } from 'src/constants';\nimport { settings, type CurrentSettings } from 'src/settings/settings.svelte';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\nexport function applyTitleToWindow(title: string, element: HTMLElement) {\n  if (!element) {\n    return;\n  }\n\n  let windowTitle: HTMLElement | ChildNode | null =\n    element.querySelector('.window-title');\n\n  if (windowTitle?.hasChildNodes()) {\n    windowTitle = windowTitle.childNodes[0];\n  }\n\n  if (!windowTitle) {\n    return;\n  }\n\n  if (windowTitle.textContent !== title) {\n    windowTitle.textContent = title;\n  }\n}\n\nexport function applyMutableSettingAttributesToWindow(\n  currentSettings: CurrentSettings,\n  element?: HTMLElement\n) {\n  if (!element) {\n    return;\n  }\n\n  const theme = getCurrentTheme(currentSettings);\n\n  if (theme) {\n    debug(`Applying theme type ${theme.type} to window`);\n    element.setAttribute('data-tidy-theme-type', theme.type);\n  }\n\n  if (currentSettings.lockConfigureSheet && !FoundryAdapter.userIsGm()) {\n    element.setAttribute('data-tidy-lock-configure-sheet', 'true');\n  } else {\n    element.removeAttribute('data-tidy-lock-configure-sheet');\n  }\n}\n\nexport function getCurrentTheme(currentSettings: CurrentSettings) {\n  let themeId = currentSettings.colorScheme;\n\n  themeId =\n    themeId === CONSTANTS.THEME_ID_DEFAULT\n      ? settings.value.defaultTheme\n      : themeId;\n\n  const themes = getThemes();\n  const theme = themes[themeId];\n  return theme;\n}\n\nexport function applySheetAttributesToWindow(\n  documentName: string,\n  documentUuid: string,\n  type: string,\n  element?: HTMLElement\n) {\n  element?.setAttribute('data-sheet-module', 'tidy5e-sheet');\n  element?.setAttribute('data-document-name', documentName);\n  element?.setAttribute('data-document-type', type);\n  element?.setAttribute('data-document-uuid', documentUuid);\n  applyMutableSettingAttributesToWindow(settings.value, element);\n}\n\nexport async function maintainCustomContentInputFocus(\n  app: any,\n  asyncRender: () => Promise<unknown>\n) {\n  // TODO: Eliminate jQuery\n  let focus = globalThis.$(app.element).find(':focus');\n  focus = focus.length ? focus[0] : null;\n\n  await asyncRender();\n\n  if (focus && focus.name) {\n    const input = app.form?.[focus.name];\n    if (input && input.focus instanceof Function) input.focus();\n  }\n}\n\nexport function blurUntabbableButtonsOnClick(element: HTMLElement) {\n  element.removeEventListener('click', blurUntabbableButton);\n  element.addEventListener('click', blurUntabbableButton);\n}\n\nfunction blurUntabbableButton(event: MouseEvent) {\n  const target = event.target;\n\n  if (!(target instanceof HTMLElement)) {\n    return;\n  }\n\n  const button = target.closest('button');\n\n  if (button?.tabIndex === -1) {\n    target.blur();\n  }\n}\n","import { error } from 'src/utils/logging';\n\nexport class HandlebarsTemplateRenderer {\n  path: string;\n\n  constructor(props: Partial<HandlebarsTemplateRenderer>) {\n    this.path = props?.path ?? '';\n  }\n\n  async render(data: any) {\n    try {\n      return await renderTemplate(this.path, data);\n    } catch (e) {\n      error('Failed to render handlebars template', false, e);\n      return '';\n    }\n  }\n}\n","import type {\n  CustomContentInjectParams,\n  OnContentReadyParams,\n  OnRenderParams,\n  RenderScheme,\n} from '../api.types';\n\n/** @category Content */\nexport abstract class CustomContentBase {\n  /** {@inheritDoc CustomContentInjectParams} */\n  abstract injectParams?: CustomContentInjectParams;\n\n  /**\n   * Optionally determines whether to refresh content each time an application render occurs.\n   *\n   * For svelte-based content, the default is \"force\". For HTML and Handlebars content, the default is \"handlebars\".\n   */\n  abstract renderScheme?: RenderScheme;\n\n  /**\n   * Optional function to determine whether the content should be rendered. When excluded, it defaults to `true`.\n   */\n  abstract enabled?: (context: any) => boolean;\n\n  /**\n   * After the custom content has been prepared for rendering and is ready to inject into the sheet,\n   * this callback is invoked.\n   *\n   * @remarks\n   * For more complex HTML insertion scenarios, one can skip {@link CustomContentInjectParams}\n   * and simply inject the prepared content with this callback.\n   *\n   * This callback is also useful for quick debug logging of the content to be rendered.\n   */\n  abstract onContentReady?: (params: OnContentReadyParams) => void;\n\n  /**\n   * Optional function which is called each time a change detection cycle occurs on the sheet. This is any time a FormApplication would normally call `render()`.\n   */\n  abstract onRender?: (params: OnRenderParams) => void;\n\n  /**\n   * An optional override to whether the target content should use default sheet event listeners.\n   * Defaults to `false`.\n   *\n   * @deprecated Tidy is moving to Application V2, and there will no longer be any default sheet listeners. Be sure to provide your own event handling for the content that is injected.\n   */\n  abstract activateDefaultSheetListeners?: boolean;\n}\n","import { warn } from 'src/utils/logging';\nimport type {\n  CustomContentInjectParams,\n  OnContentReadyParams,\n  OnRenderParams,\n  RenderScheme,\n} from '../api.types';\nimport { CustomContentBase } from './CustomContentBase';\n\n/** @category Content */\nexport class HandlebarsContent extends CustomContentBase {\n  injectParams?: CustomContentInjectParams | undefined;\n  /**\n   * The path to the handlebars template. Use a leading slash to look in the UserData directory.\n   * @example A template in a module's templates directory\n   * ```\"/modules/my-module-id/templates/my-module-template.hbs\"```\n   */\n  path: string = '';\n  renderScheme: RenderScheme = 'handlebars';\n  \n  private _activateDefaultSheetListeners?: boolean | undefined = false;\n  public get activateDefaultSheetListeners(): boolean | undefined {\n    return this._activateDefaultSheetListeners;\n  }\n  public set activateDefaultSheetListeners(value: boolean | undefined) {\n    warn(\n      'Tidy is moving to Application V2, and there will no longer be any default sheet listeners. Be sure to provide your own event handling for the content that is injected.'\n    );\n    this._activateDefaultSheetListeners = value;\n  }\n\n  constructor(props?: Partial<HandlebarsContent>) {\n    super();\n\n    const merged = foundry.utils.mergeObject(this, props);\n    Object.assign(this, merged);\n  }\n\n  onContentReady?: (params: OnContentReadyParams) => void;\n\n  /**\n   * An optional function that provides the relevant application context\n   * (item sheet context, character sheet context, NPC sheet context, etc.)\n   * and expects the same data or a replacement object in return.\n   * The return value is passed to the Handlebars template.\n   */\n  getData?: (context: any) => any | Promise<any>;\n\n  enabled?: (context: any) => boolean;\n\n  onRender?: (params: OnRenderParams) => void;\n}\n","import type { CustomContent, HtmlRuntimeContent } from 'src/types/types';\nimport type { RegisteredContent, SheetLayout } from '../types';\nimport { HandlebarsTemplateRenderer } from 'src/runtime/HandlebarsTemplateRenderer';\nimport { error } from 'src/utils/logging';\nimport { HandlebarsContent } from 'src/api/content/HandlebarsContent';\nimport type { SupportedContent } from 'src/api/api.types';\n\nexport class CustomContentManager {\n  static async prepareContentForRender(\n    context: any,\n    registeredContent: RegisteredContent<any>[]\n  ): Promise<CustomContent[]> {\n    let enabledContent = getEnabledContent(context, registeredContent);\n\n    let customContent: CustomContent[] = [];\n\n    for (let content of enabledContent) {\n      let c: CustomContent = {\n        content: await mapRenderableContent(context, content),\n        position: content.injectParams?.position,\n        selector: content.injectParams?.selector,\n        activateDefaultSheetListeners: content.activateDefaultSheetListeners,\n        onContentReady: content.onContentReady,\n        onRender: content.onRender,\n      };\n      customContent.push(c);\n    }\n\n    return customContent;\n  }\n\n  static mapToRegisteredContent(\n    content: SupportedContent,\n    layout?: SheetLayout | SheetLayout[]\n  ) {\n    let mappedContent: HtmlRuntimeContent | HandlebarsTemplateRenderer =\n      content instanceof HandlebarsContent\n        ? new HandlebarsTemplateRenderer({\n            path: content.path,\n          })\n        : ({\n            html: content.html,\n            renderScheme: content.renderScheme,\n            type: 'html',\n          } satisfies HtmlRuntimeContent);\n\n    return {\n      content: mappedContent,\n      activateDefaultSheetListeners: content.activateDefaultSheetListeners,\n      enabled: content.enabled,\n      injectParams: content.injectParams,\n      layout: layout ?? 'all',\n      renderScheme: content.renderScheme,\n      getData:\n        content instanceof HandlebarsContent ? content.getData : undefined,\n      onContentReady: content.onContentReady,\n      onRender: content.onRender,\n    } satisfies RegisteredContent<any>;\n  }\n}\n\nfunction getEnabledContent<TContext>(\n  context: TContext,\n  registeredContent: RegisteredContent<any>[]\n) {\n  return [...registeredContent].filter((c) => {\n    try {\n      return c.enabled?.(context) ?? true;\n    } catch (e) {\n      error(\n        'Unable to check custom content to determine if it is enabled because of an error',\n        false,\n        e\n      );\n      return false;\n    }\n  });\n}\n\nasync function mapRenderableContent(\n  data: any,\n  registeredContent: RegisteredContent<any>\n) {\n  if (\n    'type' in registeredContent.content &&\n    registeredContent.content.type === 'html'\n  ) {\n    return registeredContent.content;\n  }\n\n  if (registeredContent.content instanceof HandlebarsTemplateRenderer) {\n    const handlebarsData =\n      typeof registeredContent.getData === 'function'\n        ? await registeredContent.getData(data)\n        : data;\n\n    return {\n      html: await registeredContent.content.render(handlebarsData),\n      renderScheme: registeredContent.renderScheme ?? 'handlebars',\n      type: 'html',\n    } satisfies HtmlRuntimeContent;\n  }\n\n  error(\n    'Unble to get custom content. The provided custom content information is unable to be rendered.',\n    false,\n    registeredContent\n  );\n\n  return {\n    html: '',\n    renderScheme: 'force',\n    type: 'html',\n  } satisfies HtmlRuntimeContent;\n}\n","import type {\n  OnContentReadyParams,\n  OnRenderParams,\n  RenderScheme,\n} from 'src/api';\nimport { CONSTANTS } from 'src/constants';\nimport type { ApplicationRenderOptions } from 'src/types/application.types';\nimport { CustomContentManager } from 'src/runtime/content/CustomContentManager';\nimport type { RegisteredContent } from 'src/runtime/types';\nimport type { CustomContent, Tab } from 'src/types/types';\nimport { isNil } from 'src/utils/data';\nimport { debug, error, warn } from 'src/utils/logging';\n\nexport type RenderedSheetPart = {\n  position?: string;\n  selector?: string;\n  renderScheme: RenderScheme;\n  content: string;\n  onContentReady?: (params: OnContentReadyParams) => void;\n  onRender?: (params: OnRenderParams) => void;\n  tabSelector?: string;\n};\n\nexport class CustomContentRendererV2 {\n  async renderCustomContent(\n    registeredContent: RegisteredContent<any>[],\n    context: unknown,\n    options: ApplicationRenderOptions\n  ): Promise<RenderedSheetPart[]> {\n    let customContents: CustomContent[] =\n      await this.#prepareContentForRendering(\n        context,\n        registeredContent,\n        options\n      );\n\n    let parts: RenderedSheetPart[] = [];\n    for (let content of customContents) {\n      try {\n        let contentHtml =\n          typeof content.content.html === 'function'\n            ? content.content.html(context)\n            : content.content.html;\n\n        parts.push({\n          content: contentHtml,\n          position: content.position,\n          selector: content.selector,\n          renderScheme: content.content.renderScheme,\n          onContentReady: content.onContentReady,\n          onRender: content.onRender,\n        });\n      } catch (e) {\n        error('An error occurred while rendering custom content', false, {\n          error: e,\n          context,\n          content,\n          options,\n        });\n      }\n    }\n\n    return parts;\n  }\n\n  async #prepareContentForRendering(\n    context: unknown,\n    registeredContent: RegisteredContent<any>[],\n    options: ApplicationRenderOptions\n  ) {\n    let customContents: CustomContent[] = [];\n    try {\n      customContents = await CustomContentManager.prepareContentForRender(\n        context,\n        registeredContent\n      );\n    } catch (e) {\n      error(\n        'An error occurred while preparing custom content for render',\n        false,\n        {\n          error: e,\n          context,\n          options,\n        }\n      );\n    }\n    return customContents;\n  }\n\n  async renderTabContents(\n    tabs: Tab[],\n    context: unknown,\n    options: ApplicationRenderOptions\n  ): Promise<RenderedSheetPart[]> {\n    // prepare tabs for render\n\n    // render tabs\n    const promises = tabs.map<Promise<RenderedSheetPart | undefined>>(\n      async (tab) => {\n        try {\n          let content: string = '';\n          let renderScheme: RenderScheme = 'force';\n\n          if (\n            tab.content.type === 'html' &&\n            (options.isFirstRender || tab.content.renderScheme === 'handlebars')\n          ) {\n            content = tab.content.html;\n            renderScheme = tab.content.renderScheme;\n          }\n          const selector = `[data-tab-contents-for=\"${tab.id}\"]`;\n          const position: InsertPosition = 'afterbegin';\n          return {\n            content: content,\n            renderScheme: renderScheme,\n            position: position,\n            selector: selector,\n            onRender: (params) =>\n              // Retrofit tab render to satisfy unified structure\n              tab.onRender?.({\n                app: params.app,\n                data: params.data,\n                element: params.element,\n                isFullRender: params.isFullRender,\n                tabContentsElement:\n                  params.element.querySelector<HTMLElement>(selector)!,\n              }),\n            tabSelector: selector,\n          } satisfies RenderedSheetPart;\n        } catch (e) {\n          error('Failed to render custom content due to an error', false, e);\n          debug('Custom content error debug details', {\n            error: e,\n            tab,\n            context,\n            options,\n          });\n        }\n      }\n    );\n\n    return (await Promise.all(promises)).filter((t) => !!t);\n  }\n\n  replaceCustomContent(\n    parts: RenderedSheetPart[],\n    sheet: any,\n    context: unknown,\n    options: ApplicationRenderOptions\n  ) {\n    sheet.element\n      .querySelectorAll(CONSTANTS.HTML_DYNAMIC_RENDERING_ATTRIBUTE_SELECTOR)\n      .forEach((el: HTMLElement) => el.remove());\n\n    for (let part of parts) {\n      try {\n        part.onContentReady?.({\n          app: sheet,\n          content: part.content,\n          data: context,\n          element: sheet.element,\n          isFullRender: !!options.isFirstRender,\n        });\n      } catch (e) {\n        error(\n          'An error occurred while invoking the onContentReady callback for custom content',\n          false,\n          { error: e, part, sheet }\n        );\n      }\n\n      const canInsertHtml = !isNil(part.position) && !isNil(part.selector);\n\n      if (canInsertHtml) {\n        const anchorElements = Array.from<HTMLElement>(\n          sheet.element.querySelectorAll(part.selector)\n        );\n\n        if (part.tabSelector && part.renderScheme === 'handlebars') {\n          const tabContentsElement = sheet.element.querySelector(\n            part.tabSelector\n          );\n          tabContentsElement.innerHTML = part.content;\n        } else {\n          const wrappedContent = part.tabSelector\n            ? part.content\n            : this.#wrapCustomHtmlForRendering(part.content, part.renderScheme);\n\n          for (let el of anchorElements) {\n            el.insertAdjacentHTML(\n              part.position as InsertPosition,\n              wrappedContent\n            );\n          }\n        }\n      }\n\n      try {\n        part.onRender?.({\n          app: sheet,\n          data: context,\n          element: sheet.element,\n          isFullRender: !!options.isFirstRender,\n        });\n      } catch (e) {\n        error(\n          'An error occurred while invoking the onRender callback for custom content',\n          false,\n          { error: e, part, sheet }\n        );\n      }\n    }\n  }\n\n  #wrapCustomHtmlForRendering(html: string, renderScheme: RenderScheme) {\n    const renderingAttribute =\n      renderScheme === 'handlebars'\n        ? ` ${CONSTANTS.HTML_DYNAMIC_RENDERING_ATTRIBUTE}`\n        : '';\n    return `<div style=\"display: contents;\"${renderingAttribute}>${html}</div>`;\n  }\n}\n","export const delay = (ms: number): Promise<void> => {\n  return new Promise<void>((resolve) => {\n    setTimeout(() => {\n      resolve();\n    }, ms);\n  });\n};\n","import type { CustomHeaderControlsEntry } from 'src/api';\n\nexport class HeaderControlsRuntime {\n  private static _headerControls: RegisteredCustomHeaderControlsEntry[] = [];\n\n  static registerHeaderControls(\n    controls: RegisteredCustomHeaderControlsEntry[]\n  ) {\n    this._headerControls.push(...controls);\n  }\n\n  static getHeaderControls(params: GetHeaderControlsParams) {\n    return this._headerControls.filter(\n      (c) =>\n        (!c.documentTypes || c.documentTypes.includes(params.documentType)) &&\n        (!c.supportedDocuments ||\n          c.supportedDocuments.includes(params.documentName))\n    );\n  }\n}\n\ntype SupportedDocument = 'Item' | 'Actor' | string;\n\n/**\n * Not specifying supported documents or types means to skip filtering and include in all applications.\n */\ntype RegisteredCustomHeaderControlsEntry = CustomHeaderControlsEntry & {\n  supportedDocuments?: SupportedDocument[];\n  documentTypes?: string[];\n};\n\ntype GetHeaderControlsParams = {\n  documentName: string;\n  documentType: string;\n};\n","/**\n * Provides coarse-grained reactivity to a type. This is useful for applying blanket reactivity to third-party classes like Actor5e.\n * This class is best used for `context`-like properties found in sheets, because the `data` property can be re-assigned to trigger\n * invalidation across the sheet.\n * \n * @see\n * As seen on https://github.com/sveltejs/svelte/issues/10560#issuecomment-2057092046\n * \n */\nexport class CoarseReactivityProvider<T> {\n  #data;\n  #version = $state(0);\n\n  constructor(data: T) {\n    this.#data = data;\n  }\n  get data() {\n    this.#version;\n    return this.#data;\n  }\n  set data(_data) {\n    this.#version++;\n    this.#data = _data;\n  }\n  invalidate() {\n    this.#version++;\n  }\n}\n","export const tidyHeaderAttribute = 'data-tidy-header-control';\n\nexport function createHeaderButton(\n  label: string,\n  action: string,\n  icon: string\n) {\n  return `<button type=\"button\" class=\"header-control ${icon}\" data-action=\"${action}\" data-tooltip=\"${label}\" aria-label=\"${label}\" ${tidyHeaderAttribute}></button>`;\n}\n\nexport function insertHeaderButton(\n  app: any,\n  header: HTMLElement,\n  html: string\n) {\n  let anchor =\n    header.querySelector('[data-action=\"copyUuid\"]') ??\n    header.querySelector('[data-action=\"configureSheet\"]') ??\n    app.window.close;\n\n  if (anchor) {\n    anchor.insertAdjacentHTML('beforebegin', html);\n  }\n}\n\nexport function removeTidyHeaderButtons(header: HTMLElement) {\n  header\n    .querySelectorAll<HTMLElement>(`[${tidyHeaderAttribute}]`)\n    .forEach((el: HTMLElement) => el.remove());\n}\n","import { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { settings } from 'src/settings/settings.svelte';\nimport {\n  applySheetAttributesToWindow,\n  applyMutableSettingAttributesToWindow,\n  blurUntabbableButtonsOnClick,\n} from 'src/utils/applications.svelte';\nimport { debug, error } from 'src/utils/logging';\nimport {\n  CustomContentRendererV2,\n  type RenderedSheetPart,\n} from 'src/sheets/CustomContentRendererV2';\nimport type { Tab } from 'src/types/types';\nimport { delay } from 'src/utils/asynchrony';\nimport type { RegisteredContent } from 'src/runtime/types';\nimport type {\n  ApplicationRenderOptions,\n  ApplicationClosingOptions,\n  ApplicationConfiguration,\n  ApplicationHeaderControlsEntry,\n  ApplicationClickAction,\n} from 'src/types/application.types';\nimport { HeaderControlsRuntime } from 'src/runtime/header-controls/HeaderControlsRuntime';\nimport type {\n  CustomHeaderControlsEntry,\n  SheetHeaderControlPosition,\n} from 'src/api/api.types';\nimport { tick, unmount } from 'svelte';\nimport { CoarseReactivityProvider } from 'src/features/reactivity/CoarseReactivityProvider.svelte';\nimport { coalesce } from 'src/utils/formatting';\nimport {\n  createHeaderButton,\n  insertHeaderButton,\n  removeTidyHeaderButtons,\n} from 'src/features/sheet-header-controls/header-controls';\nimport { processInputChangeDelta } from 'src/utils/form';\nimport { isNil } from 'src/utils/data';\n\ntype RenderResult<TContext> = {\n  customContents: RenderedSheetPart[];\n  context: TContext;\n};\n\nconst HEADER_CONTROLS_DROPDOWN_SELECTOR = '.controls-dropdown';\nconst HEADER_CONTROLS_DROPDOWN_EXPANDED_SELECTOR = '.expanded';\nconst HEADER_CONTROLS_DROPDOWN_TOGGLE_SELECTOR =\n  '[data-action=\"toggleControls\"]';\n\n/**\n * A context-oriented Svelte mixin to provide Application V2 windows with Svelte integration.\n *\n * @param BaseApplication the application which should adopt this mixin functionality.\n * @returns the resulting application with this mixin functionality applied.\n */\nexport function SvelteApplicationMixin<\n  TContext extends Partial<{\n    tabs: Tab[];\n    customContent: RegisteredContent<TContext>[];\n  }>\n>(BaseApplication: any) {\n  class SvelteApplication extends BaseApplication {\n    constructor(...args: any[]) {\n      super(...args);\n    }\n\n    /**\n     * An array of selectors within this sheet whose scroll positions should\n     * be persisted during a re-render operation.\n     */\n    static SCROLLABLE: string[] = [\n      '.scroll-container',\n      '[data-tidy-track-scroll-y]',\n    ];\n\n    /**\n     * Determines whether to use a sheet lock svelte component in the header.\n     * This requires the application to mount another svelte component.\n     */\n    static USE_HEADER_SHEET_LOCK: boolean = false;\n\n    /** The component which represents the UI. */\n    #components: Record<string, any>[] = [];\n\n    #customHTMLTags: string[] = ['PROSE-MIRROR'];\n\n    #customContentRenderer: CustomContentRendererV2 =\n      new CustomContentRendererV2();\n\n    #scrollPositions: Record<string, PriorElementScrollPosition[]> = {};\n\n    #focusedInputSelector: string | undefined = '';\n\n    /**\n     * Compatibility shim from Application V1.\n     */\n    get object() {\n      return this.document;\n    }\n\n    get windowContent() {\n      return this.hasFrame\n        ? this.element.querySelector('.window-content')\n        : this.element;\n    }\n\n    /* -------------------------------------------- */\n    /*  Svelte-specific                             */\n    /* -------------------------------------------- */\n\n    /**\n     * The context store which underpins the application Svelte component.\n     * This store is made available as Svelte context to the component\n     * and can be retrieved from any child component within.\n     */\n    _context = new CoarseReactivityProvider<TContext | undefined>(undefined);\n\n    /** Creates the component which represents the window content area. */\n    _createComponent(node: HTMLElement): Record<string, any> {\n      const errorMessage =\n        'Unable to render Svelte application. To implement a Svelte application, override _createComponent and provide context data matching the specified sheet context type.';\n      throw new Error(errorMessage);\n    }\n\n    _createAdditionalComponents(content: HTMLElement): Record<string, any>[] {\n      return [];\n    }\n\n    /**\n     * Allows for configuring any effects related to the sheet.\n     */\n    _configureEffects(): void {}\n\n    /* -------------------------------------------- */\n    /*  Rendering                                   */\n    /* -------------------------------------------- */\n\n    /** Prepares context data which matches the request data type. */\n    async _prepareContext(\n      options: ApplicationRenderOptions\n    ): Promise<TContext> {\n      const errorMessage =\n        'Unable to render Svelte application. To implement a Svelte application, override _prepareContext and provide context data matching the specified sheet context type.';\n      error(errorMessage, false, { options });\n      throw new Error(errorMessage);\n    }\n\n    /**\n     * Triggers possible reactive rendering by updating the application store\n     * with the latest context data.\n     *\n     * Renders non-Svelte sheet parts in preparation for injecting custom content during the HTML replacement phase.\n     *\n     * @returns any non-Svelte sheet parts that need to be rendered to the sheet.\n     */\n    async _renderHTML(\n      context: TContext,\n      options: ApplicationRenderOptions\n    ): Promise<RenderResult<TContext>> {\n      this._context.data = context;\n\n      if (options.isFirstRender) {\n        const content = this.windowContent;\n        this.#components.push(this._createComponent(content));\n        this.#components.push(...this._createAdditionalComponents(content));\n      }\n\n      // Allow svelte to process its synchronous microtask changes before entertaining custom content.\n      await tick();\n\n      let result: RenderResult<TContext> = {\n        context: context,\n        customContents: [],\n      };\n\n      try {\n        const renderedTabParts = context.tabs\n          ? await this.#customContentRenderer.renderTabContents(\n              context.tabs,\n              context,\n              options\n            )\n          : [];\n        const renderedContentParts = context.customContent\n          ? await this.#customContentRenderer.renderCustomContent(\n              context.customContent,\n              context,\n              options\n            )\n          : [];\n        result.customContents = [...renderedTabParts, ...renderedContentParts];\n      } catch (e) {\n        error(\n          'An error occurred while rendering custom tabs and content.',\n          false,\n          e\n        );\n      }\n\n      return result;\n    }\n\n    /**\n     * Creates and mounts the Svelte component on first render.\n     * Removes handlebars content so that it can be reinserted on the appropriate render hook.\n     * @param result rendered sheets parts which are ready to be placed on the page\n     * @param content the window content area\n     * @param options render options\n     */\n    _replaceHTML(\n      result: RenderResult<TContext>,\n      content: HTMLElement,\n      options: ApplicationRenderOptions\n    ) {\n      try {\n        this.#saveScrollPositions(content);\n        this.#saveInputFocus(content);\n        this.#customContentRenderer.replaceCustomContent(\n          result.customContents,\n          this,\n          result.context,\n          options\n        );\n      } catch (e) {\n        error(\n          'An error occured while replacing custom content on the sheet.',\n          false,\n          e\n        );\n      }\n    }\n\n    async _renderFrame(options: ApplicationRenderOptions) {\n      const element = await super._renderFrame(options);\n\n      if (this.document) {\n        try {\n          // Support Tidy's common window attributes\n          applySheetAttributesToWindow(\n            this.document.documentName,\n            this.document.uuid,\n            this.document.type,\n            element\n          );\n\n          // Support injected named inputs\n          element.addEventListener(\n            'change',\n            async (ev: InputEvent & { target: HTMLInputElement }) => {\n              if (\n                ev.target.matches('input[name], textarea[name], select[name]')\n              ) {\n                await this.submit();\n                return;\n              }\n\n              if (\n                ev.target.matches(\n                  'input[data-name], textarea[data-name], select[data-name]'\n                )\n              ) {\n                await this._submitEmbeddedDocumentChange(ev);\n              }\n            }\n          );\n        } catch (e) {\n          error(\n            'An error occurred while preparing the rendered frame of the application.',\n            false,\n            { error: e, sheet: this }\n          );\n        }\n      } else {\n        debug(\n          'Skipping common window attributes and form submit shim. No document provided.'\n        );\n      }\n\n      return element;\n    }\n\n    async _submitEmbeddedDocumentChange(\n      event: InputEvent & { target: HTMLInputElement }\n    ) {\n      const itemId =\n        event.target.closest<HTMLElement>('[data-item-id]')?.dataset.itemId;\n      if (itemId) {\n        await this._submitEmbeddedItemChange(event, itemId);\n      }\n    }\n\n    async _submitEmbeddedItemChange(\n      event: InputEvent & { target: HTMLInputElement },\n      itemId: string\n    ) {\n      event.stopImmediatePropagation();\n\n      const item = await this.getItem(itemId);\n      const field = event.target.getAttribute('data-name')!;\n\n      let valueToSave: string | number = event.target.value;\n\n      // For deltas, parse the resulting delta value\n      if (event.target.matches('[inputmode=\"numeric\"]')) {\n        valueToSave = processInputChangeDelta(\n          event.target.value,\n          item,\n          field\n        )?.toString();\n      }\n\n      // For numeric changes, enforce min/max on the value to save\n      if (event.target.matches('[inputmode=\"numeric\"], [type=\"number\"]')) {\n        const minAttribute = event.target.getAttribute('min');\n        const min = !isNil(minAttribute, '') ? Number(minAttribute) : -Infinity;\n\n        const maxAttribute = event.target.getAttribute('max');\n        const max = !isNil(maxAttribute, '') ? Number(maxAttribute) : Infinity;\n\n        const valueAsNumber = Number(valueToSave);\n        valueToSave = Math.clamp(valueAsNumber, min, max);\n\n        if (item && !Number.isNaN(valueToSave)) {\n          event.target.value = valueToSave?.toString();\n        }\n      }\n\n      // Save the value to the document, whatever that value ultimately became\n      await item.update({ [field]: valueToSave });\n    }\n\n    getItem(id: string) {\n      if (this.document.type === 'container')\n        return this.document.system.getContainedItem(id);\n      return this.document.items.get(id);\n    }\n\n    _updateFrame(options: ApplicationRenderOptions) {\n      options ??= {};\n\n      // Remove header bar controls\n      removeTidyHeaderButtons(this.window.header);\n\n      // Add header bar controls\n      this._getVisibleHeaderControlsForPosition('header').forEach((x) =>\n        insertHeaderButton(\n          this,\n          this.window.header,\n          createHeaderButton(x.label, x.action ?? '', x.icon)\n        )\n      );\n\n      // For whatever reason, application v2 titles don't update themselves on _updateFrame without an implementing class specifiying window settings.\n      FoundryAdapter.mergeObject(options, {\n        window: {\n          title: this.title,\n          // TODO: Determine whether it's bad to keep this true always\n          controls: true,\n        },\n      });\n\n      super._updateFrame(options);\n    }\n\n    /* -------------------------------------------- */\n    /*  Closing                                     */\n    /* -------------------------------------------- */\n\n    async close(options: ApplicationClosingOptions = {}) {\n      this._effectCleanup?.();\n      // Trigger saving of the form if configured and allowed\n      const submit = this.options.submitOnClose && this.document.isOwner;\n      if (submit) {\n        await this.submit({ preventClose: true, preventRender: true });\n      }\n\n      await super.close(options);\n\n      this.#components.forEach((c) => unmount(c));\n      this.#components = [];\n    }\n\n    /* -------------------------------------------- */\n    /*  Rendering Life-Cycle Methods                */\n    /* -------------------------------------------- */\n\n    _onRender(context: TContext, options: ApplicationRenderOptions) {\n      super._onRender(context, options);\n\n      // Some integrations will insert HTML even beyond this point,\n      // so breaking off the current task gives another chance to restore state.\n      setTimeout(() => {\n        this.#restoreScrollPositions(this.element);\n        this.#restoreInputFocus(this.element);\n      });\n    }\n\n    /* -------------------------------------------- */\n    /*  Event Listeners and Handlers                */\n    /* -------------------------------------------- */\n    _effectCleanup?: () => void;\n    _attachFrameListeners() {\n      super._attachFrameListeners();\n\n      try {\n        // Support Foundry's hotkeys feature by blurring tabindex -1 clicked elements\n        blurUntabbableButtonsOnClick(this.element);\n\n        // Manage application effects\n        this._effectCleanup?.();\n        this._effectCleanup = $effect.root(() => {\n          this._configureEffects();\n\n          $effect(() => {\n            applyMutableSettingAttributesToWindow(settings.value, this.element);\n          });\n        });\n\n        // If a controls dropdown button is clicked, close the controls dropdown.\n        this.element.addEventListener('click', (ev: MouseEvent) => {\n          const target = ev.target;\n          if (!(target instanceof HTMLElement)) {\n            return;\n          }\n\n          if (target.closest(`${HEADER_CONTROLS_DROPDOWN_SELECTOR} button`)) {\n            this.toggleControls(false);\n          }\n        });\n        this.element\n          .querySelector(HEADER_CONTROLS_DROPDOWN_SELECTOR)\n          ?.addEventListener(\n            'focusout',\n            (\n              ev: FocusEvent & {\n                currentTarget: HTMLElement;\n                relatedTarget?: HTMLElement;\n              }\n            ) => {\n              if (\n                ev.relatedTarget?.closest(\n                  `${HEADER_CONTROLS_DROPDOWN_SELECTOR}, ${HEADER_CONTROLS_DROPDOWN_TOGGLE_SELECTOR}`\n                )\n              ) {\n                return;\n              }\n\n              if (\n                !ev.currentTarget.matches(\n                  HEADER_CONTROLS_DROPDOWN_EXPANDED_SELECTOR\n                )\n              ) {\n                return;\n              }\n\n              this.toggleControls(false);\n            },\n            {}\n          );\n      } catch (e) {\n        error(\n          'An error occurred while attaching frame listeners for the application.',\n          false,\n          { error: e, sheet: this }\n        );\n      }\n    }\n\n    _onChangeForm(formConfig: unknown, event: any) {\n      super._onChangeForm(formConfig, event);\n\n      if (event.type !== 'change') {\n        return;\n      }\n\n      if (!this.document) {\n        return;\n      }\n\n      const { target } = event;\n      if (!target) {\n        return;\n      }\n\n      if (!this.#customHTMLTags.includes(target.tagName)) {\n        return;\n      }\n\n      const value = target._getValue();\n      this.document.update({ [target.name]: value });\n    }\n\n    /**\n     * Augments the base toggleControls with handling for closing menu when focus is lost.\n     */\n    toggleControls(expanded: boolean | undefined) {\n      super.toggleControls(expanded);\n\n      const controlsDropdown = this.element.querySelector(\n        HEADER_CONTROLS_DROPDOWN_SELECTOR\n      );\n      const menuIsExpanded = controlsDropdown?.matches(\n        HEADER_CONTROLS_DROPDOWN_EXPANDED_SELECTOR\n      );\n      if (menuIsExpanded) {\n        debug('App V2 - On Menu Opened');\n        controlsDropdown.tabIndex = 0;\n        controlsDropdown.focus();\n      } else if (controlsDropdown) {\n        debug('App V2 - On Menu Closed');\n        controlsDropdown.blur();\n        controlsDropdown.tabIndex = -1;\n      }\n    }\n\n    /* -------------------------------------------- */\n    /*  Prior Element State                         */\n    /* -------------------------------------------- */\n\n    /**\n     * Persist the scroll positions of containers within the app before re-rendering the content\n     * @param element the application window element\n     */\n    #saveScrollPositions(element: HTMLElement) {\n      const selectors = SvelteApplication.SCROLLABLE || [];\n      this.#scrollPositions = selectors.reduce<\n        Record<string, PriorElementScrollPosition[]>\n      >((state, sel) => {\n        const scrollableElements = element.querySelectorAll<HTMLElement>(sel);\n        state[sel] = Array.from(\n          scrollableElements\n        ).map<PriorElementScrollPosition>((el) => ({\n          scrollTop: el.scrollTop,\n          scrollLeft: el.scrollLeft,\n        }));\n        return state;\n      }, {});\n    }\n\n    /**\n     * Restore the scroll positions of containers within the app after re-rendering the content\n     * @param element the application window element\n     */\n    #restoreScrollPositions(element: HTMLElement) {\n      const selectors = SvelteApplication.SCROLLABLE || [];\n      const positions = this.#scrollPositions || {};\n      for (let sel of selectors) {\n        const scrollableElements = element.querySelectorAll(sel);\n        for (let [index, el] of Array.from(scrollableElements).entries()) {\n          Object.assign(el, positions[sel]?.[index]);\n        }\n      }\n    }\n\n    /**\n     * Persist the currently focused element, if any.\n     * @param element the application window element\n     */\n    #saveInputFocus(element: HTMLElement) {\n      const focusedElement = element.querySelector<\n        HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement\n      >(':is(input, select, textarea):focus');\n\n      this.#focusedInputSelector = focusedElement?.name\n        ? `${focusedElement.tagName}[name=\"${focusedElement.name}\"]`\n        : focusedElement?.id\n        ? `[id=\"${focusedElement.id}\"]`\n        : undefined;\n    }\n\n    /**\n     * Restore focus to the prior focused element, if able.\n     * @param element the application window element\n     */\n    #restoreInputFocus(element: HTMLElement) {\n      if (this.#focusedInputSelector) {\n        const newFocus = element.querySelector<\n          HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement\n        >(this.#focusedInputSelector);\n\n        if (newFocus) {\n          newFocus.focus?.();\n        }\n      }\n    }\n\n    _initializeApplicationOptions(options: ApplicationConfiguration) {\n      const updatedOptions = super._initializeApplicationOptions(\n        options\n      ) as ApplicationConfiguration;\n\n      try {\n        const customControls = this._getCustomHeaderControls(options.document);\n\n        /* \n          Rather than update the source object, make a new one and spread the actions across.\n          Otherwise, it has a chance of updating DEFAULT_OPTIONS.\n          For controls, that causes the same control to be added each time the constructor fires.\n          Assigning a new set of actions and controls will avoid any surprise mutations.\n        */\n        updatedOptions.actions = {\n          ...updatedOptions.actions,\n          ...customControls.actions,\n        };\n        updatedOptions.window.controls = [\n          ...(updatedOptions.window.controls ?? []),\n          ...customControls.controls,\n        ];\n      } catch (e) {\n        error('An error occurred while setting up custom controls.', false, {\n          error: e,\n          app: this,\n          options: updatedOptions,\n        });\n      }\n\n      return updatedOptions;\n    }\n\n    _getCustomHeaderControls(document: any): { controls: any[]; actions: any } {\n      const controls: ApplicationHeaderControlsEntry[] = [];\n      const actions: Record<\n        string,\n        | ApplicationClickAction\n        | {\n            handler: ApplicationClickAction;\n            buttons: number[];\n          }\n      > = {};\n\n      // TODO: Figure out how we're going to handle this for apps without documents. Having it in the core mixin seems wrong.\n      if (!document) {\n        debug('Skipping custom header controls. No document provided');\n        return {\n          actions,\n          controls,\n        };\n      }\n\n      const customControls = HeaderControlsRuntime.getHeaderControls({\n        documentName: document.documentName,\n        documentType: document.type,\n      });\n\n      for (let control of customControls) {\n        const actionId = `custom-control-action-${foundry.utils.randomID()}`;\n\n        control.action = control.action ?? actionId;\n\n        if (control.onClickAction) {\n          actions[control.action ?? actionId] =\n            control.onClickAction?.bind(this);\n        }\n\n        controls.push(control as ApplicationHeaderControlsEntry);\n      }\n\n      return {\n        controls,\n        actions,\n      };\n    }\n\n    /**\n     * Configure the array of header control menu options\n     */\n    _getHeaderControls() {\n      return this._getVisibleHeaderControlsForPosition('menu');\n    }\n\n    _getVisibleHeaderControlsForPosition(\n      position: SheetHeaderControlPosition\n    ): CustomHeaderControlsEntry[] {\n      const controls = super._getHeaderControls();\n      return controls.filter((c: CustomHeaderControlsEntry) => {\n        try {\n          return (\n            (typeof c.visible !== 'function' || c.visible.call(this)) &&\n            coalesce(c.position, 'menu') === position\n          );\n        } catch (e) {\n          error('Failed to get custom control', false, {\n            control: c,\n            error: e,\n          });\n          return false;\n        }\n      });\n    }\n  }\n\n  return SvelteApplication;\n}\n\ninterface PriorElementScrollPosition {\n  scrollTop: number;\n  scrollLeft: number;\n}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type {\n    SectionSelectorApplication,\n    SectionSelectorContext,\n  } from './SectionSelectorApplication.svelte';\n  import type { CoarseReactivityProvider } from 'src/features/reactivity/CoarseReactivityProvider.svelte';\n\n  interface Props {\n    sheet: SectionSelectorApplication;\n    context: CoarseReactivityProvider<SectionSelectorContext | undefined>;\n  }\n\n  let { sheet, context }: Props = $props();\n\n  async function onOptionSelected(name: string) {\n    if (name.trim() !== '') {\n      await sheet.selectSection(name);\n    }\n    await sheet.close();\n  }\n\n  async function useDefault() {\n    await sheet.useDefaultSection();\n    await sheet.close();\n  }\n\n  const localize = FoundryAdapter.localize;\n\n  let sections = $derived(context.data?.sections ?? []);\n  let freeText = $state('');\n  let searchCriteria = $state('');\n\n  let filteredResults = $derived(\n    searchCriteria.trim() === ''\n      ? sections\n      : sections.filter((s) =>\n          s.toLocaleLowerCase().includes(searchCriteria.toLocaleLowerCase()),\n        ),\n  );\n</script>\n\n<fieldset class=\"card\">\n  <legend>{localize('TIDY5E.Section.SectionSelectorExistingSections')}</legend>\n\n  <search>\n    <input\n      type=\"search\"\n      class=\"interface-only\"\n      placeholder={localize('TIDY5E.Search')}\n      bind:value={searchCriteria}\n    />\n  </search>\n\n  <section class=\"existing-sections\">\n    {#each filteredResults as section (section)}\n      {@const isSelected = context.data?.currentSection === section}\n      <div class=\"form-group\">\n        <button\n          type=\"button\"\n          onclick={() => onOptionSelected(section)}\n          class=\"button\"\n          class:selected={isSelected}\n        >\n          {#if isSelected}\n            <i class=\"fa-solid fa-check\"></i>\n          {/if}\n          {localize(section)}\n        </button>\n      </div>\n    {/each}\n  </section>\n</fieldset>\n\n<fieldset class=\"card\">\n  <legend>{localize('TIDY5E.Section.SectionSelectorCreateNewSection')}</legend>\n  <input\n    type=\"text\"\n    bind:value={freeText}\n    placeholder={localize('TIDY5E.Section.SectionSelectorNewSectionName')}\n  />\n  <div class=\"button-bar flexrow\">\n    <button type=\"button\" onclick={() => useDefault()}\n      >{localize('TIDY5E.UseDefault')}</button\n    >\n    <button type=\"button\" onclick={() => onOptionSelected(freeText)}\n      >{localize('TIDY5E.Section.SectionSelectorSaveNewSection')}</button\n    >\n  </div>\n</fieldset>\n\n<style>\n  .existing-sections {\n    flex: 1 1 auto;\n    padding: 1px;\n    overflow: auto;\n    min-height: 0;\n    display: flex;\n    flex-direction: column;\n    gap: 2px;\n  }\n\n  .new-section {\n    display: flex;\n    flex-direction: column;\n    gap: 0.125rem;\n  }\n</style>\n","import { CONSTANTS } from 'src/constants';\nimport { SvelteApplicationMixin } from 'src/mixins/SvelteApplicationMixin.svelte';\nimport type {\n  ApplicationClosingOptions,\n  ApplicationConfiguration,\n  ApplicationRenderOptions,\n} from 'src/types/application.types';\nimport { mount } from 'svelte';\nimport SectionSelector from './SectionSelector.svelte';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport type { Tab } from 'src/types/types';\nimport { SheetSections } from 'src/features/sections/SheetSections';\nimport { settings } from 'src/settings/settings.svelte';\n\nexport type SectionSelectorContext = {\n  sections: string[];\n  currentSection: string | undefined;\n  // TODO: Eliminate the need for this. It's not relevant for this application.\n  tabs: Tab[];\n};\n\nexport class SectionSelectorApplication extends SvelteApplicationMixin<SectionSelectorContext>(\n  foundry.applications.api.ApplicationV2\n) {\n  _document: any;\n  _prop: string;\n  _sectionType: string;\n\n  constructor(\n    document: any,\n    flag: string,\n    sectionType: string,\n\n    ...rest: any[]\n  ) {\n    super(...rest);\n    this._document = document;\n    this._prop = flag;\n    this._sectionType = sectionType;\n  }\n\n  static DEFAULT_OPTIONS: Partial<ApplicationConfiguration> = {\n    classes: [\n      CONSTANTS.MODULE_ID,\n      'application',\n      'sheet',\n      'dnd5e2',\n      'standard-form',\n      'config-sheet',\n      'tidy-section-selector-application',\n      'app-v2',\n    ],\n    tag: 'div',\n    window: {\n      frame: true,\n      positioned: true,\n      resizable: true,\n      controls: [],\n    },\n    position: {\n      width: 600,\n      height: 600,\n    },\n    actions: {},\n    submitOnClose: false,\n  };\n\n  _configureEffects(): void {\n    $effect(() => {\n      settings.value;\n\n      this.render(true);\n    });\n  }\n\n  _createComponent(node: HTMLElement): Record<string, any> {\n    const component = mount(SectionSelector, {\n      target: node,\n      props: {\n        sheet: this,\n        context: this._context,\n      },\n    });\n\n    return component;\n  }\n\n  get title() {\n    return FoundryAdapter.localize('TIDY5E.Section.SectionSelectorTitle', {\n      sectionType: this._sectionType,\n      documentName: this._document.name,\n    });\n  }\n\n  async _renderHTML(\n    context: SectionSelectorContext,\n    options: ApplicationRenderOptions\n  ) {\n    game.user.apps[this.id] = this;\n    this._document.apps[this.id] = this;\n\n    return await super._renderHTML(context, options);\n  }\n\n  async close(options: ApplicationClosingOptions = {}) {\n    delete game.user.apps[this.id];\n    delete this._document.apps[this.id];\n\n    return await super.close(options);\n  }\n\n  async _prepareContext() {\n    const sections = SheetSections.getKnownCustomSections(this._document);\n\n    const currentSection = FoundryAdapter.getProperty<string>(\n      this._document,\n      this._prop\n    );\n\n    return {\n      sections,\n      currentSection,\n      tabs: [],\n    };\n  }\n\n  async selectSection(name: string) {\n    await this._document.update({\n      [this._prop]: name,\n    });\n  }\n\n  async useDefaultSection() {\n    await this._document.update({\n      [this._prop]: null,\n    });\n  }\n}\n","<script lang=\"ts\">\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import Select from 'src/components/inputs/Select.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type {\n    ContainerSheetClassicContext,\n    ItemSheetContext,\n  } from 'src/types/item.types';\n  import HorizontalLineSeparator from 'src/components/layout/HorizontalLineSeparator.svelte';\n  import VerticalLineSeparator from 'src/components/layout/VerticalLineSeparator.svelte';\n  import ItemDescriptions from '../parts/ItemDescriptions.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import SheetEditorV2 from 'src/components/editor/SheetEditorV2.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import { SectionSelectorApplication } from 'src/applications/section-selector/SectionSelectorApplication.svelte';\n  import TidySwitch from 'src/components/toggles/TidySwitch.svelte';\n\n  let context =\n    $derived(\n      getSheetContext<ItemSheetContext | ContainerSheetClassicContext>(),\n    );\n\n  let appId = $derived(context.document.id);\n\n  let editing = $state(false);\n  let contentToEdit: string = $state('');\n  let enrichedText: string = $state('');\n  let fieldToEdit: string = $state('');\n\n  function stopEditing() {\n    editing = false;\n  }\n\n  function edit(value: string, enriched: string, field: string) {\n    contentToEdit = value;\n    fieldToEdit = field;\n    enrichedText = enriched;\n    editing = true;\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div\n  class=\"item-description flexrow align-items-stretch small-gap\"\n  class:hidden={editing}\n>\n  <div\n    class=\"item-properties\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_SHEET_PROPERTIES}\n  >\n    {#if context.isPhysical}\n      {#if context.item.type !== CONSTANTS.ITEM_TYPE_CONTAINER}\n        <div class=\"form-group\">\n          <label for=\"{appId}-quantity\">{localize('DND5E.Quantity')}</label>\n          <NumberInput\n            id=\"{appId}-quantity\"\n            value={context.source.quantity}\n            field=\"system.quantity\"\n            document={context.item}\n            step=\"1\"\n            disabled={!context.editable || context.lockItemQuantity}\n            selectOnFocus={true}\n          />\n        </div>\n\n        <HorizontalLineSeparator borderColor=\"separator\" />\n      {/if}\n\n      <div class=\"form-group stacked\">\n        <label for=\"{appId}-weight-value\">{localize('DND5E.Weight')}</label>\n        <NumberInput\n          id=\"{appId}-weight-value\"\n          value={context.source.weight.value}\n          step=\"any\"\n          field=\"system.weight.value\"\n          document={context.item}\n          disabled={!context.editable}\n          selectOnFocus={true}\n          cssClass=\"large-value\"\n        />\n        <Select\n          document={context.item}\n          field=\"system.weight.units\"\n          value={context.source.weight.units}\n        >\n          <SelectOptions\n            data={context.config.weightUnits}\n            labelProp=\"abbreviation\"\n          />\n        </Select>\n      </div>\n\n      <HorizontalLineSeparator borderColor=\"separator\" />\n\n      <div class=\"form-group stacked\">\n        <label for=\"{appId}-price-value\">{localize('DND5E.Price')}</label>\n        {#if context.concealDetails}\n          <span>{localize('DND5E.Unidentified.Value')}</span>\n        {:else}\n          <NumberInput\n            id=\"{appId}-price-value\"\n            value={context.source.price.value}\n            step=\"any\"\n            field=\"system.price.value\"\n            document={context.item}\n            disabled={!context.editable}\n            selectOnFocus={true}\n            cssClass=\"large-value\"\n          />\n          <Select\n            value={context.source.price.denomination}\n            field=\"system.price.denomination\"\n            document={context.item}\n            disabled={!context.editable}\n          >\n            <SelectOptions\n              data={context.config.currencies}\n              labelProp=\"abbreviation\"\n            />\n          </Select>\n        {/if}\n      </div>\n    {/if}\n\n    {#if context.labels.toHit || context.labels.damages.length}\n      <h4 class=\"properties-header\">\n        {localize('DND5E.Attack')}/{localize('DND5E.Damage')}\n      </h4>\n      <ol\n        class=\"properties-list animate-concealed-content\"\n        class:conceal-content={context.concealDetails}\n      >\n        {#if context.labels.save}\n          <li>\n            {context.labels.save}\n          </li>\n        {/if}\n\n        {#if context.labels.toHit}\n          <li>\n            {context.labels.toHit}\n            {localize('DND5E.ToHit')}\n          </li>\n        {/if}\n\n        {#each context.labels.damages ?? [] as damage}\n          {@const label = damage.label}\n          <li>\n            {label}\n          </li>\n        {/each}\n      </ol>\n    {/if}\n\n    {#if context.properties.active.length}\n      <section class=\"concealed-content-animation-container\">\n        <h4 class=\"properties-header\">{localize('DND5E.Properties')}</h4>\n        <ol\n          class=\"properties-list\"\n          class:conceal-details={context.concealDetails}\n        >\n          {#each context.properties.active as prop}\n            {#if prop !== null && prop !== undefined}\n              <li>{prop}</li>\n            {/if}\n          {/each}\n        </ol>\n      </section>\n    {/if}\n\n    <div class=\"flex-column small-gap\">\n      <div class=\"form-group section stretch\">\n        <div\n          class=\"properties-header flex-grow-1 flex-row extra-small-gap justify-content-space-between align-items-center\"\n        >\n          <label for=\"{appId}-tidy-section\"\n            >{localize('TIDY5E.Section.Label')}\n          </label>\n          <a\n            title={localize(\n              'TIDY5E.Section.SectionSelectorChooseActionSectionTooltip',\n            )}\n            class=\"inline-icon-button\"\n            onclick={() =>\n              new SectionSelectorApplication(\n                context.item,\n                TidyFlags.section.prop,\n                localize('TIDY5E.Section.Label'),\n              ).render(true)}\n          >\n            <i class=\"fa-solid fa-search\"></i>\n          </a>\n        </div>\n        <TextInput\n          id=\"{appId}-tidy-section\"\n          document={context.item}\n          field={TidyFlags.section.prop}\n          placeholder={localize('TIDY5E.Section.Default')}\n          value={TidyFlags.section.get(context.item) ?? ''}\n          selectOnFocus={true}\n          title={localize('TIDY5E.Section.Tooltip')}\n          disabled={!context.editable}\n        />\n      </div>\n      <div class=\"form-group section stretch\">\n        <div\n          class=\"properties-header flex-grow-1 flex-row extra-small-gap justify-content-space-between align-items-center\"\n        >\n          <label for=\"{appId}-tidy-action-section\"\n            >{localize('TIDY5E.Section.ActionLabel')}</label\n          >\n          <a\n            title={localize(\n              'TIDY5E.Section.SectionSelectorChooseSectionTooltip',\n            )}\n            class=\"inline-icon-button\"\n            onclick={() =>\n              new SectionSelectorApplication(\n                context.item,\n                TidyFlags.actionSection.prop,\n                localize('TIDY5E.Section.ActionLabel'),\n              ).render(true)}\n          >\n            <i class=\"fa-solid fa-search\"></i>\n          </a>\n        </div>\n\n        <TextInput\n          id=\"{appId}-tidy-action-section\"\n          document={context.item}\n          field={TidyFlags.actionSection.prop}\n          placeholder={localize('TIDY5E.Section.Default')}\n          value={TidyFlags.actionSection.get(context.item) ?? ''}\n          selectOnFocus={true}\n          title={localize('TIDY5E.Section.ActionTooltip')}\n          disabled={!context.editable}\n        />\n      </div>\n    </div>\n  </div>\n\n  <VerticalLineSeparator />\n\n  {#if FoundryAdapter.userIsGm() || context.isIdentified}\n    <ItemDescriptions\n      onEdit={(detail) =>\n        edit(detail.contentToEdit, detail.enrichedText, detail.fieldToEdit)}\n      renderDescriptions={!editing}\n    />\n  {:else if context.editable || context.system.unidentified.description}\n    {#key context.enriched.unidentified}\n      <article class=\"editor-container\">\n        <SheetEditorV2\n          content={context.system.unidentified.description}\n          enriched={context.enriched.unidentified}\n          field=\"system.unidentified.description\"\n          editorOptions={{\n            editable: context.editable,\n          }}\n          documentUuid={context.item.uuid}\n          manageSecrets={context.document.isOwner}\n        />\n      </article>\n    {/key}\n  {/if}\n</div>\n\n{#if editing}\n  {#key contentToEdit}\n    <article class=\"editor-container\">\n      <SheetEditorV2\n        enriched={enrichedText}\n        content={contentToEdit}\n        field={fieldToEdit}\n        editorOptions={{\n          editable: context.editable,\n          toggled: false,\n        }}\n        documentUuid={context.item.uuid}\n        onSave={() => stopEditing()}\n        manageSecrets={context.document.isOwner}\n      />\n    </article>\n  {/key}\n{/if}\n\n<style lang=\"scss\">\n  .item-properties {\n    flex: 0 0 7.5rem;\n    padding-top: 0.0625rem;\n  }\n\n  .editor-container {\n    width: 100%;\n  }\n</style>\n","<script lang=\"ts\">\n  import ExpandableContainer from 'src/components/expandable/ExpandableContainer.svelte';\n  import { isNil } from 'src/utils/data';\n  import GoldHeaderUnderline from './GoldHeaderUnderline.svelte';\n  import type { ItemDescription } from 'src/types/item.types';\n\n  interface Props {\n    expanded: boolean;\n    document: any;\n    itemDescription: ItemDescription;\n    onEdit?: (detail: {\n      document: any;\n      itemDescription: ItemDescription;\n    }) => void;\n  }\n\n  let {\n    expanded = $bindable(),\n    document,\n    itemDescription,\n    onEdit,\n  }: Props = $props();\n\n  let showIndicator = $derived(!isNil(itemDescription.enriched, ''));\n\n  function manageSecrets(node: HTMLElement) {\n    if (!document.isOwner) {\n      return;\n    }\n\n    const secret = new HTMLSecret({\n      parentSelector: `[data-edit]`,\n      callbacks: {\n        content: (secret: HTMLElement) =>\n          foundry.utils.getProperty(\n            document,\n            secret.closest<HTMLElement>('[data-edit]')!.dataset.edit,\n          ),\n        update: (secret: HTMLElement, content: string) =>\n          document.update({\n            [secret.closest<HTMLElement>('[data-edit]')!.dataset.edit!]:\n              content,\n          }),\n      },\n    });\n\n    queueMicrotask(() => {\n      secret.bind(node);\n    });\n  }\n</script>\n\n<section class=\"collapsible-editor\">\n  <!-- Header -->\n  <header>\n    <a class=\"title\" onclick={() => (expanded = !expanded)}>\n      <!-- Title -->\n      {itemDescription.label}\n      {#if showIndicator}\n        <!-- Expand Indicator, if there's nonblank content -->\n        <i class=\"fas fa-angle-right fa-fw expand-indicator\" class:expanded></i>\n      {/if}\n    </a>\n    <!-- Journal Edit Button -->\n    <a\n      class=\"edit icon-button\"\n      onclick={() => onEdit?.({ document, itemDescription })}\n    >\n      <i class=\"fas fa-feather fa-fw\"></i>\n    </a>\n    <GoldHeaderUnderline />\n  </header>\n\n  <!-- Body -->\n  <ExpandableContainer {expanded}>\n    {#key itemDescription.enriched}\n      <div class=\"editor\" use:manageSecrets>\n        <div data-edit={itemDescription.field} class=\"user-select-text\">\n          {@html itemDescription.enriched}\n        </div>\n      </div>\n    {/key}\n  </ExpandableContainer>\n</section>\n","<script lang=\"ts\">\n  import type { ItemDescription } from 'src/types/item.types';\n  import CollapsibleEditorSection from './CollapsibleEditorSection.svelte';\n  import SheetEditorV2 from 'src/components/editor/SheetEditorV2.svelte';\n\n  interface Props {\n    itemDescriptions: ItemDescription[];\n    editing?: boolean;\n    document: any;\n  }\n\n  let {\n    itemDescriptions,\n    editing = $bindable(false),\n    document,\n  }: Props = $props();\n\n  let sectionItemOpenStates = $state(itemDescriptions.map((_, i) => i === 0));\n  let itemDescriptionToEdit = $state<ItemDescription>();\n\n  function handleEdit(detail: {\n    document: any;\n    itemDescription: ItemDescription;\n  }): void {\n    itemDescriptionToEdit = detail.itemDescription;\n    editing = true;\n  }\n</script>\n\n<!-- Collapsible sections -->\n{#if !editing}\n  <section class=\"item-descriptions\">\n    {#each itemDescriptions as itemDescription, i (itemDescription.field)}\n      <CollapsibleEditorSection\n        {document}\n        bind:expanded={sectionItemOpenStates[i]}\n        {itemDescription}\n        onEdit={(detail) => handleEdit(detail)}\n      />\n    {/each}\n  </section>\n{:else if !!itemDescriptionToEdit}\n  <SheetEditorV2\n    documentUuid={document.uuid}\n    content={itemDescriptionToEdit.content}\n    editorOptions={{ toggled: false }}\n    manageSecrets={true}\n    field={itemDescriptionToEdit.field}\n    enriched={itemDescriptionToEdit.enriched}\n    onSave={() => (editing = false)}\n  ></SheetEditorV2>\n{/if}\n","<script lang=\"ts\">\n  import ItemDescriptions from '../../shared/ItemDescriptions.svelte';\n  import { getContainerSheetQuadroneContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getContainerSheetQuadroneContext());\n</script>\n\n<ItemDescriptions\n  document={context.document}\n  itemDescriptions={context.itemDescriptions}\n/>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n  import Select from 'src/components/inputs/Select.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<h3 class=\"form-header\">\n  {#if context.item.type === CONSTANTS.ITEM_TYPE_WEAPON}\n    {localize('DND5E.ItemSiegeProperties')}\n  {:else if context.item.type === CONSTANTS.ITEM_TYPE_EQUIPMENT}\n    {localize('DND5E.ItemVehicleProperties')}\n  {/if}\n</h3>\n\n<!-- Armor Class -->\n<div class=\"form-group\">\n  <label for=\"{appId}-armor-value\">{localize('DND5E.ArmorClass')}</label>\n  <NumberInput\n    id=\"{appId}-armor-value\"\n    document={context.item}\n    field=\"system.armor.value\"\n    value={context.source.armor.value}\n    disabled={!context.editable}\n    step=\"1\"\n  />\n</div>\n\n<!-- Cover -->\n<div class=\"form-group\">\n  <label for=\"{appId}-cover\"\n    >{localize('DND5E.FEATURE.FIELDS.cover.label')}</label\n  >\n  <Select\n    id=\"{appId}-cover\"\n    document={context.item}\n    field=\"system.cover\"\n    value={context.source.cover}\n    disabled={!context.editable}\n  >\n    <SelectOptions\n      data={context.coverOptions}\n      labelProp=\"label\"\n      valueProp=\"value\"\n      blank=\"\"\n    />\n  </Select>\n  <p class=\"hint\">\n    {localize('DND5E.FEATURE.FIELDS.cover.hint')}\n  </p>\n</div>\n\n<!-- Hit Points -->\n<div class=\"form-group split-group\">\n  <label for=\"{appId}-hp-value\">{localize('DND5E.HitPoints')}</label>\n  <div class=\"form-fields\">\n    <!-- Current -->\n    <div class=\"form-group label-top\">\n      <label for=\"{appId}-hp-value\">{localize('DND5E.Current')}</label>\n      <NumberInput\n        id=\"{appId}-hp-value\"\n        document={context.item}\n        field=\"system.hp.value\"\n        value={context.source.hp.value}\n        disabled={!context.editable}\n        placeholder=\"0\"\n        min=\"0\"\n      />\n    </div>\n\n    <!-- Max -->\n    <div class=\"form-group label-top\">\n      <label for=\"{appId}-hp-max\">{localize('DND5E.Max')}</label>\n      <NumberInput\n        id=\"{appId}-hp-max\"\n        document={context.item}\n        field=\"system.hp.max\"\n        value={context.source.hp.max}\n        disabled={!context.editable}\n        placeholder=\"0\"\n        min=\"0\"\n      />\n    </div>\n\n    <!-- Threshold -->\n    <div class=\"form-group label-top\">\n      <label for=\"{appId}-hp-dt\">{localize('DND5E.Threshold')}</label>\n      <NumberInput\n        id=\"{appId}-hp-dt\"\n        document={context.item}\n        field=\"system.hp.dt\"\n        value={context.source.hp.dt}\n        disabled={!context.editable}\n        placeholder=\"\"\n        min=\"0\"\n      />\n    </div>\n  </div>\n  <!-- Conditions -->\n  <TextInput\n    id=\"{appId}-hp-conditions\"\n    document={context.item}\n    field=\"system.hp.conditions\"\n    value={context.item.system.hp.conditions}\n    placeholder={localize('DND5E.VEHICLE.MOUNTABLE.FIELDS.hp.conditions.label')}\n    class=\"full-width\"\n    disabled={!context.editable}\n  />\n</div>\n\n<!-- Speed -->\n{#if context.item.type === CONSTANTS.ITEM_TYPE_EQUIPMENT}\n  <div class=\"form-group split-group\">\n    <label for=\"{appId}-speed-value\">{localize('DND5E.Speed')}</label>\n    <div class=\"form-fields\">\n      <!-- Value -->\n      <div class=\"form-group label-top\">\n        <label for=\"{appId}-speed-value\">\n          {localize('DND5E.Value')}\n        </label>\n        <NumberInput\n          id=\"{appId}-speed-value\"\n          document={context.item}\n          field=\"system.speed.value\"\n          value={context.item.system.speed.value}\n          min=\"0\"\n          placeholder=\"0\"\n          disabled={!context.editable}\n        />\n      </div>\n    </div>\n    <!-- Conditions -->\n    <TextInput\n      id=\"{appId}-speed-conditions\"\n      document={context.item}\n      field=\"system.speed.conditions\"\n      value={context.item.system.speed.conditions}\n      placeholder={localize(\n        'DND5E.VEHICLE.MOUNTABLE.FIELDS.speed.conditions.label',\n      )}\n      class=\"full-width\"\n      disabled={!context.editable}\n    />\n  </div>\n{/if}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import Select from 'src/components/inputs/Select.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import ItemProperties from '../parts/ItemProperties.svelte';\n  import ContentConcealer from 'src/components/content-concealment/ContentConcealer.svelte';\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import DetailsMountable from '../parts/DetailsMountable.svelte';\n  import FieldUses from '../parts/FieldUses.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<ContentConcealer conceal={context.concealDetails}>\n  <h3 class=\"form-header\">\n    {localize('DND5E.ItemEquipmentDetails')}\n  </h3>\n\n  <!-- Equipment Type -->\n  <div class=\"form-group\">\n    <label for=\"{appId}-type-value\">{localize('DND5E.ItemEquipmentType')}</label\n    >\n    <Select\n      id=\"{appId}-type-value\"\n      document={context.item}\n      field=\"system.type.value\"\n      value={context.source.type.value}\n      blankValue=\"\"\n      disabled={!context.editable}\n    >\n      <SelectOptions\n        data={context.equipmentTypes}\n        labelProp=\"label\"\n        valueProp=\"value\"\n        blank=\"\"\n      />\n    </Select>\n  </div>\n\n  <!-- Equipment Base -->\n  {#if Object.keys(context.baseItems).length}\n    <div class=\"form-group\">\n      <label for=\"{appId}-type-baseItem\"\n        >{localize('DND5E.ItemEquipmentBase')}</label\n      >\n      <Select\n        id=\"{appId}-type-baseItem\"\n        document={context.item}\n        field=\"system.type.baseItem\"\n        value={context.source.type.baseItem}\n        blankValue=\"\"\n        disabled={!context.editable}\n      >\n        <SelectOptions\n          data={context.baseItems}\n          labelProp=\"label\"\n          valueProp=\"value\"\n          blank=\"\"\n        />\n      </Select>\n    </div>\n  {/if}\n\n  <!-- Proficiency -->\n  <div class=\"form-group\">\n    <label for=\"{appId}-proficient\">{localize('DND5E.ProficiencyLevel')}</label>\n    <Select\n      id=\"{appId}-proficient\"\n      document={context.item}\n      field=\"system.proficient\"\n      value={context.source.proficient}\n      blankValue=\"\"\n      disabled={!context.editable}\n    >\n      <SelectOptions\n        data={context.config.weaponAndArmorProficiencyLevels}\n        labelProp=\"label\"\n        valueProp=\"value\"\n        blank={localize('DND5E.Automatic')}\n      />\n    </Select>\n  </div>\n\n  <!-- Armor -->\n  {#if context.system.isArmor}\n    <div class=\"form-group split-group\">\n      <label for=\"{appId}-armor-value\">{localize('DND5E.Armor')}</label>\n\n      <div class=\"form-fields\">\n        <div class=\"form-group label-top\">\n          <label for=\"{appId}-armor-value\">{localize('DND5E.AC')}</label>\n          <NumberInput\n            id=\"{appId}-armor-value\"\n            document={context.item}\n            field=\"system.armor.value\"\n            value={context.source.armor.value}\n            step=\"1\"\n            disabled={!context.editable}\n          />\n        </div>\n\n        {#if context.hasDexModifier}\n          <div class=\"form-group label-top\">\n            <label for=\"{appId}-armor-dex\"\n              >{localize('DND5E.ItemEquipmentDexModAbbr')}</label\n            >\n            <NumberInput\n              id=\"{appId}-armor-dex\"\n              document={context.item}\n              field=\"system.armor.dex\"\n              value={context.source.armor.dex}\n              step=\"1\"\n              placeholder=\"\"\n              disabled={!context.editable}\n            />\n          </div>\n        {/if}\n\n        <div class=\"form-group label-top\">\n          <label for=\"{appId}-armor-strength\"\n            >{localize('DND5E.AbilityStr')}</label\n          >\n          <NumberInput\n            id=\"{appId}-armor-strength\"\n            document={context.item}\n            field=\"system.strength\"\n            value={context.source.strength}\n            step=\"1\"\n            placeholder=\"\"\n            disabled={!context.editable}\n          />\n        </div>\n      </div>\n    </div>\n  {/if}\n\n  <!-- Properties -->\n  <div class=\"form-group stacked equipment-properties\">\n    <label for=\"\">{localize('DND5E.ItemEquipmentProperties')}</label>\n    <ItemProperties />\n  </div>\n\n  <!-- Magical Properties -->\n  {#if context.properties.object.mgc}\n    <div class=\"form-group\">\n      <label for=\"{appId}-attunement\"\n        >{localize('DND5E.Item.Property.Magical')}</label\n      >\n      <div class=\"form-fields\">\n        {#if !context.item.isMountable}\n          <div class=\"form-group label-top no-gap\">\n            <label for=\"{appId}-attuned\">\n              {localize('DND5E.Attunement')}\n            </label>\n            <div class=\"form-fields\">\n              <!-- Attuned -->\n              <Checkbox\n                id={`${appId}-system-attuned`}\n                document={context.item}\n                field=\"system.attuned\"\n                checked={context.source.attuned}\n                disabled={!context.editable ||\n                  // @ts-expect-error\n                  !context.config.attunementTypes[context.system.attunement]}\n                title={localize('DND5E.AttunementAttuned')}\n              />\n              <!-- Attunement -->\n              <Select\n                id=\"{appId}-attunement\"\n                document={context.item}\n                field=\"system.attunement\"\n                value={context.source.attunement}\n                disabled={!context.editable}\n                class=\"flex-1\"\n              >\n                <SelectOptions\n                  data={context.config.attunementTypes}\n                  blank={localize('DND5E.AttunementNone')}\n                />\n              </Select>\n            </div>\n          </div>\n        {/if}\n        <div class=\"form-group label-top\">\n          <label for=\"{appId}-magical-bonus\">{localize('DND5E.Bonus')}</label>\n          <NumberInput\n            id=\"{appId}-magical-bonus\"\n            value={context.source.armor.magicalBonus}\n            field=\"system.armor.magicalBonus\"\n            document={context.item}\n            disabled={!context.editable}\n            min=\"0\"\n            step=\"1\"\n            placeholder=\"0\"\n          />\n        </div>\n      </div>\n    </div>\n  {/if}\n\n  {#if context.system.isMountable}\n    <DetailsMountable />\n  {/if}\n\n  <FieldUses />\n</ContentConcealer>\n","<script lang=\"ts\">\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import Select from 'src/components/inputs/Select.svelte';\n  import ItemProperties from '../parts/ItemProperties.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import FieldUses from '../parts/FieldUses.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<h3 class=\"form-header\">{localize('DND5E.ItemFeatureDetails')}</h3>\n\n<div class=\"form-group\">\n  <label for=\"{appId}-type-value\">{localize('DND5E.Type')}</label>\n  <Select\n    id=\"{appId}-type-value\"\n    document={context.item}\n    field=\"system.type.value\"\n    value={context.source.type.value}\n    disabled={!context.editable}\n  >\n    <SelectOptions\n      data={context.config.featureTypes}\n      labelProp=\"label\"\n      blank=\"\"\n    />\n  </Select>\n</div>\n\n{#if context.itemSubtypes}\n  {@const category =\n    context.config.featureTypes[context.system.type.value]?.label}\n\n  <div class=\"form-group\">\n    <label for=\"{appId}-type-subtype\"\n      >{localize('DND5E.ItemFeatureSubtype', { category })}</label\n    >\n    <Select\n      id=\"{appId}-type-subtype\"\n      document={context.item}\n      field=\"system.type.subtype\"\n      value={context.source.type.subtype}\n      disabled={!context.editable}\n    >\n      <SelectOptions data={context.itemSubtypes} blank=\"\" />\n    </Select>\n  </div>\n{/if}\n\n{#if context.system.type.value === CONSTANTS.FEAT_TYPE_VEHICLE}\n  <div class=\"form-group\">\n    <label for=\"{appId}-cover\"\n      >{localize('DND5E.FEATURE.FIELDS.cover.label')}</label\n    >\n    <Select\n      id=\"{appId}-cover\"\n      document={context.item}\n      field=\"system.cover\"\n      value={context.source.cover}\n      disabled={!context.editable}\n    >\n      <SelectOptions\n        data={context.coverOptions}\n        labelProp=\"label\"\n        valueProp=\"value\"\n        blank=\"\"\n      />\n    </Select>\n    <p class=\"hint\">\n      {localize('DND5E.FEATURE.FIELDS.cover.hint')}\n    </p>\n  </div>\n{/if}\n\n<div class=\"form-group\">\n  <label for=\"{appId}-prerequisites-level\"\n    >{localize('DND5E.Prerequisites.FIELDS.prerequisites.level.label')}</label\n  >\n  <NumberInput\n    id=\"{appId}-prerequisites-level\"\n    document={context.item}\n    field=\"system.prerequisites.level\"\n    value={context.source.prerequisites.level}\n    disabled={!context.editable}\n    step=\"1\"\n  />\n\n  <p class=\"hint\">\n    {localize('DND5E.Prerequisites.FIELDS.prerequisites.level.hint')}\n  </p>\n</div>\n\n<div class=\"form-group\">\n  <label id=\"prerequisites-repeatable-{appId}\">\n    {localize('DND5E.Prerequisites.FIELDS.prerequisites.repeatable.label')}\n  </label>\n  <div class=\"form-fields\">\n    <Checkbox\n      id=\"prerequisites-repeatable-{appId}\"\n      document={context.item}\n      field=\"system.prerequisites.repeatable\"\n      checked={context.source.prerequisites.repeatable}\n    />\n  </div>\n  <p class=\"hint\">\n    {localize('DND5E.Prerequisites.FIELDS.prerequisites.repeatable.hint')}\n  </p>\n</div>\n\n<div class=\"form-group stacked feature-properties\">\n  <label for=\"\">{localize('DND5E.ItemFeatureProperties')}</label>\n  <ItemProperties />\n</div>\n\n{#if context.system.isEnchantmentSource}\n  <h3 class=\"form-header\">{localize('DND5E.ENCHANTMENT.Label')}</h3>\n\n  <!-- Max Enchantments -->\n  <div class=\"form-group\">\n    <label for=\"{appId}-enchant-max\"\n      >{localize('DND5E.ENCHANTMENT.FIELDS.enchantment.items.max.label')}</label\n    >\n    <TextInput\n      id=\"{appId}-enchant-max\"\n      document={context.item}\n      field=\"system.enchant.max\"\n      value={context.source.enchant.max}\n      disabled={!context.editable}\n    />\n\n    <p class=\"hint\">\n      {localize('DND5E.ENCHANTMENT.FIELDS.enchantment.items.max.hint')}\n    </p>\n  </div>\n\n  <!-- Enchantment Replacement -->\n  <div class=\"form-group\">\n    <label for=\"{appId}-enchant-period\"\n      >{localize(\n        'DND5E.ENCHANTMENT.FIELDS.enchantment.items.period.label',\n      )}</label\n    >\n    <Select\n      id=\"{appId}-enchant-period\"\n      document={context.item}\n      field=\"system.enchant.period\"\n      value={context.source.enchant.period}\n      blankValue=\"\"\n      disabled={!context.editable}\n    >\n      <SelectOptions\n        data={context.config.enchantmentPeriods}\n        blank={localize('DND5E.USES.Recovery.Never')}\n        labelProp=\"label\"\n        valueProp=\"value\"\n      />\n    </Select>\n\n    <p class=\"hint\">\n      {localize('DND5E.ENCHANTMENT.FIELDS.enchantment.items.period.hint')}\n    </p>\n  </div>\n{/if}\n\n<FieldUses />\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import Select from 'src/components/inputs/Select.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import ItemProperties from '../parts/ItemProperties.svelte';\n  import ContentConcealer from 'src/components/content-concealment/ContentConcealer.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<ContentConcealer conceal={context.concealDetails}>\n  <h3 class=\"form-header\">{localize('DND5E.ItemLootDetails')}</h3>\n\n  <!-- Loot Type -->\n  <div class=\"form-group\">\n    <label for=\"{appId}-type-value\">{localize('DND5E.ItemLootType')}</label>\n    <Select\n      id=\"{appId}-type-value\"\n      document={context.item}\n      field=\"system.type.value\"\n      value={context.source.type.value}\n      disabled={!context.editable}\n    >\n      <SelectOptions\n        data={context.config.lootTypes}\n        labelProp=\"label\"\n        blank=\"\"\n      />\n    </Select>\n  </div>\n\n  <!-- Loot Subtype -->\n  {#if context.itemSubtypes}\n    {@const subtypeLabel = localize('DND5E.ItemLootSubtype', {\n      category:\n        // @ts-expect-error\n        context.config.lootTypes[context.system.type.value]?.label ?? '',\n    })}\n    <div class=\"form-group\">\n      <label for=\"{appId}-type-subtype\">{subtypeLabel}</label>\n      <Select\n        id=\"{appId}-type-subtype\"\n        document={context.item}\n        field=\"system.type.subtype\"\n        value={context.source.type.subtype}\n        disabled={!context.editable}\n        blankValue=\"\"\n      >\n        <SelectOptions data={context.itemSubtypes} blank=\"\" />\n      </Select>\n    </div>\n  {/if}\n\n  <!-- Loot Properties -->\n  <div class=\"form-group stacked loot-properties\">\n    <label for=\"\">{localize('DND5E.ItemLootProperties')}</label>\n    <ItemProperties />\n  </div>\n</ContentConcealer>\n","<script lang=\"ts\">\n  import VerticalLineSeparator from 'src/components/layout/VerticalLineSeparator.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemDescription from './ItemDescriptionTab.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let movementLabels = $derived(\n    Object.values(context.item.system.movementLabels) as string[],\n  );\n\n  let sensesLabels = $derived(context.item.system.sensesLabels);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"item-description flexrow align-items-stretch small-gap\">\n  <div\n    class=\"item-properties\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_SHEET_PROPERTIES}\n  >\n    <h4 class=\"properties-header flex-row justify-content-space-between\">\n      {localize('DND5E.Type')}\n      {#if context.editable}\n        <button\n          class=\"inline-icon-button hidden-config-button\"\n          type=\"button\"\n          onclick={() => FoundryAdapter.renderCreatureTypeConfig(context.item)}\n          tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n        >\n          <i class=\"fas fa-cog\"></i>\n        </button>\n      {/if}\n    </h4>\n    <ol class=\"properties-list\">\n      <li>{context.item.system.typeLabel}</li>\n    </ol>\n    <h4 class=\"properties-header flex-row justify-content-space-between\">\n      {localize('DND5E.Movement')}\n      {#if context.editable}\n        <button\n          type=\"button\"\n          class=\"inline-icon-button hidden-config-button\"\n          data-action=\"movement\"\n          onclick={() =>\n            FoundryAdapter.renderMovementSensesConfig(context.item, 'movement')}\n          tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n        >\n          <i class=\"fas fa-cog\"></i>\n        </button>\n      {/if}\n    </h4>\n    <ol class=\"properties-list\">\n      {#each movementLabels as label}\n        <li>{label}</li>\n      {:else}\n        <li>{localize('DND5E.None')}</li>\n      {/each}\n    </ol>\n    <h4 class=\"properties-header flex-row justify-content-space-between\">\n      {localize('DND5E.Senses')}\n      {#if context.editable}\n        <button\n          type=\"button\"\n          class=\"inline-icon-button hidden-config-button\"\n          data-action=\"senses\"\n          onclick={() =>\n            FoundryAdapter.renderMovementSensesConfig(context.item, 'senses')}\n          tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n        >\n          <i class=\"fas fa-cog\"></i>\n        </button>\n      {/if}\n    </h4>\n    <ol class=\"properties-list\">\n      {#each sensesLabels as label}\n        <li>{label}</li>\n      {:else}\n        <li>{localize('DND5E.None')}</li>\n      {/each}\n    </ol>\n  </div>\n\n  <VerticalLineSeparator />\n\n  <ItemDescription />\n</div>\n\n<style lang=\"scss\">\n  .item-properties {\n    flex: 0 0 7.5rem;\n  }\n</style>\n","<script lang=\"ts\">\n  import Select from 'src/components/inputs/Select.svelte';\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<h3 class=\"form-header\">\n  {localize('DND5E.TargetPl')}\n</h3>\n\n<!-- Target Type -->\n<div class=\"form-group split-group\">\n  <label for=\"{appId}-target-affects-type\">{localize('DND5E.Type')}</label>\n  <div class=\"form-fields\">\n    <!-- Amount -->\n    {#if context.system.target.affects.scalar}\n      <div class=\"form-group label-top\">\n        <label for=\"{appId}-target-affects-count\"\n          >{localize('DND5E.Amount')}</label\n        >\n        <TextInput\n          id=\"{appId}-target-affects-count\"\n          document={context.item}\n          field=\"system.target.affects.count\"\n          value={context.source.target.affects.count}\n          placeholder={context.affectsPlaceholder}\n          disabled={!context.editable}\n        />\n      </div>\n    {/if}\n\n    <!-- Type -->\n    <div class=\"form-group label-top\">\n      <label for=\"{appId}-target-affects-type\">{localize('DND5E.Type')}</label>\n      <Select\n        id=\"{appId}-target-affects-type\"\n        document={context.item}\n        field=\"system.target.affects.type\"\n        value={context.source.target.affects.type}\n        blankValue=\"\"\n        disabled={!context.editable}\n      >\n        <SelectOptions\n          data={context.config.individualTargetTypes}\n          labelProp=\"label\"\n          blank=\"\"\n        />\n      </Select>\n    </div>\n  </div>\n\n  <!-- Special -->\n  {#if context.source.target.affects.type}\n    <TextInput\n      id=\"{appId}-target-affects-special\"\n      document={context.item}\n      field=\"system.target.affects.special\"\n      value={context.source.target.affects.special}\n      class=\"full-width\"\n      placeholder={localize('DND5E.TARGET.FIELDS.target.affects.special.label')}\n      disabled={!context.editable}\n    />\n  {/if}\n</div>\n\n<!-- Choose Targets  -->\n{#if context.system.target.template.type}\n  <div class=\"form-group\">\n    <label for=\"{appId}-target-affects-choice\"\n      >{localize('DND5E.TARGET.FIELDS.target.affects.choice.label')}</label\n    >\n    <Checkbox\n      id=\"{appId}-target-affects-choice\"\n      document={context.item}\n      field=\"system.target.affects.choice\"\n      checked={context.source.target.affects.choice}\n      disabled={!context.editable}\n    />\n\n    <p class=\"hint\">\n      {localize('DND5E.TARGET.FIELDS.target.affects.choice.hint')}\n    </p>\n  </div>\n{/if}\n\n<h3 class=\"form-header\">\n  {localize('DND5E.TargetTypeArea')}\n</h3>\n\n<!-- Template Type -->\n<div class=\"form-group\">\n  <label for=\"{appId}-target-template-type\">{localize('DND5E.Shape')}</label>\n  <Select\n    id=\"{appId}-target-template-type\"\n    document={context.item}\n    field=\"system.target.template.type\"\n    value={context.source.target.template.type}\n    disabled={!context.editable}\n  >\n    <SelectOptions\n      data={context.config.areaTargetOptions}\n      labelProp=\"label\"\n      valueProp=\"value\"\n    />\n  </Select>\n</div>\n\n<!-- Dimensions -->\n{#if context.system.target.template.type && context.dimensions}\n  <div class=\"form-group split-group\">\n    <label for=\"\">{localize('DND5E.Dimensions')}</label>\n    <div class=\"form-fields\">\n      <!-- Size -->\n      <div class=\"form-group label-top\">\n        <label for=\"{appId}-target-template-size\"\n          >{localize(context.dimensions.size)}</label\n        >\n        <TextInput\n          id=\"{appId}-target-template-size\"\n          document={context.item}\n          field=\"system.target.template.size\"\n          value={context.source.target.template.size}\n          disabled={!context.editable}\n        />\n      </div>\n\n      <!-- Width -->\n      {#if context.dimensions?.width}\n        <div class=\"form-group label-top\">\n          <label for=\"{appId}-target-template-width\"\n            >{localize(context.dimensions.width)}</label\n          >\n          <TextInput\n            id=\"{appId}-target-template-width\"\n            document={context.item}\n            field=\"system.target.template.width\"\n            value={context.source.target.template.width}\n            disabled={!context.editable}\n          />\n        </div>\n      {/if}\n\n      <!-- Height -->\n      {#if context.dimensions?.height}\n        <div class=\"form-group label-top\">\n          <label for=\"{appId}-target-template-height\"\n            >{localize(context.dimensions.height)}</label\n          >\n          <TextInput\n            id=\"{appId}-target-template-height\"\n            document={context.item}\n            field=\"system.target.template.height\"\n            value={context.source.target.template.height}\n            disabled={!context.editable}\n          />\n        </div>\n      {/if}\n\n      <!-- Units -->\n      <div class=\"form-group label-top\">\n        <label for=\"{appId}-target-template-units\"\n          >{localize('DND5E.MovementUnits')}</label\n        >\n        <Select\n          id=\"{appId}-target-template-units\"\n          document={context.item}\n          field=\"system.target.template.units\"\n          value={context.source.target.template.units}\n          disabled={!context.editable}\n        >\n          <SelectOptions\n            data={context.config.movementUnits}\n            labelProp=\"label\"\n          />\n        </Select>\n      </div>\n    </div>\n  </div>\n\n  <!-- Multiple -->\n  <div class=\"form-group split-group\">\n    <label for=\"{appId}-target-template-count\"\n      >{localize('DND5E.Multiple')}</label\n    >\n    <div class=\"form-fields\">\n      <!-- Amount -->\n      <div class=\"form-field label-top\">\n        <label for=\"{appId}-target-template-count\"\n          >{localize('DND5E.Amount')}</label\n        >\n        <TextInput\n          id=\"{appId}-target-template-count\"\n          document={context.item}\n          field=\"system.target.template.count\"\n          value={context.source.target.template.count}\n          placeholder=\"1\"\n          disabled={!context.editable}\n        />\n      </div>\n\n      <!-- Contiguous -->\n      {#if context.system.target.template.type && context.system.target.template.count > 1}\n        <div class=\"form-group checkbox\">\n          <label for=\"{appId}-target-template-contiguous\"\n            >{localize('DND5E.Contiguous')}</label\n          >\n          <Checkbox\n            id=\"{appId}-target-template-contiguous\"\n            document={context.item}\n            field=\"system.target.template.contiguous\"\n            checked={context.source.target.template.contiguous}\n            disabled={!context.editable}\n          />\n        </div>\n      {/if}\n    </div>\n  </div>\n{/if}\n","<script lang=\"ts\">\n  import Select from 'src/components/inputs/Select.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"form-group split-group\">\n  <label for=\"{appId}-activation-value\">{localize('DND5E.SpellCastTime')}</label\n  >\n\n  <div class=\"form-fields\">\n    <!-- Amount -->\n    {#if context.system.activation.scalar}\n      <div class=\"form-group label-top\">\n        <label for=\"{appId}-activation-value\">\n          {localize('DND5E.Amount')}\n        </label>\n        <NumberInput\n          id=\"{appId}-activation-value\"\n          document={context.item}\n          field=\"system.activation.value\"\n          value={context.source.activation.value}\n          placeholder=\"\"\n          min=\"0\"\n          disabled={!context.editable}\n        />\n      </div>\n    {/if}\n\n    <!-- Type -->\n    <div class=\"form-group label-top\">\n      <label for=\"{appId}-activation-type\">\n        {localize('DND5E.Cost')}\n      </label>\n      <Select\n        id=\"{appId}-activation-type\"\n        document={context.item}\n        field=\"system.activation.type\"\n        value={context.source.activation.type}\n        disabled={!context.editable}\n      >\n        <SelectOptions\n          data={context.activationTypes}\n          labelProp=\"label\"\n          valueProp=\"value\"\n        />\n      </Select>\n    </div>\n  </div>\n\n  <!-- Condition -->\n  <TextInput\n    id=\"{appId}-activation-condition\"\n    document={context.item}\n    field=\"system.activation.condition\"\n    value={context.source.activation.condition}\n    placeholder={localize('DND5E.ItemActivationCondition')}\n    class=\"full-width\"\n    disabled={!context.editable}\n  />\n</div>\n","<script lang=\"ts\">\n  import Select from 'src/components/inputs/Select.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<!-- Range -->\n<div class=\"form-group split-group\">\n  <label for=\"{appId}-range-units\">{localize('DND5E.Range')}</label>\n  <div class=\"form-fields\">\n    <!-- Value -->\n    {#if context.system.range.scalar}\n      <div class=\"form-group label-top\">\n        <label for=\"{appId}-range-value\">{localize('DND5E.Value')}</label>\n        <TextInput\n          id=\"{appId}-range-value\"\n          document={context.item}\n          field=\"system.range.value\"\n          value={context.source.range.value}\n          disabled={!context.editable}\n        />\n      </div>\n    {/if}\n\n    <!-- Units -->\n    <div class=\"form-group label-top\">\n      <label for=\"{appId}-range-units\">{localize('DND5E.MovementUnits')}</label>\n      <Select\n        id=\"{appId}-range-units\"\n        document={context.item}\n        field=\"system.range.units\"\n        value={context.source.range.units}\n        disabled={!context.editable}\n      >\n        <SelectOptions\n          data={context.rangeTypes}\n          labelProp=\"label\"\n          valueProp=\"value\"\n        />\n      </Select>\n    </div>\n  </div>\n\n  <!-- Condition -->\n  <TextInput\n    id=\"{appId}-range-special\"\n    document={context.item}\n    field=\"system.range.special\"\n    value={context.source.range.special}\n    class=\"full-width\"\n    placeholder={localize('DND5E.RANGE.FIELDS.range.special.label')}\n    disabled={!context.editable}\n  />\n</div>\n","<script lang=\"ts\">\n  import Select from 'src/components/inputs/Select.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<!-- Duration -->\n<div class=\"form-group split-group\">\n  <label for=\"{appId}-duration-units\">{localize('DND5E.Duration')}</label>\n  <div class=\"form-fields\">\n    <!-- Amount -->\n    {#if context.system.duration.scalar}\n      <div class=\"form-group label-top\">\n        <label for=\"{appId}-duration-value\">{localize('DND5E.Amount')}</label>\n        <TextInput\n          id=\"{appId}-duration-value\"\n          document={context.item}\n          field=\"system.duration.value\"\n          value={context.source.duration.value}\n          placeholder=\"\"\n          disabled={!context.editable}\n        />\n      </div>\n    {/if}\n\n    <!-- Time -->\n    <div class=\"form-group label-top\">\n      <label for=\"{appId}-duration-units\"\n        >{localize('DND5E.DurationTime')}</label\n      >\n      <Select\n        id=\"{appId}-duration-units\"\n        document={context.item}\n        field=\"system.duration.units\"\n        value={context.source.duration.units}\n        disabled={!context.editable}\n      >\n        <SelectOptions\n          data={context.durationUnits}\n          labelProp=\"label\"\n          valueProp=\"value\"\n        />\n      </Select>\n    </div>\n  </div>\n\n  <!-- Conditions -->\n  {#if context.system.duration.units === 'spec'}\n    <TextInput\n      id=\"{appId}-duration-special\"\n      document={context.item}\n      field=\"system.duration.special\"\n      value={context.source.duration.special}\n      placeholder={localize('DND5E.DURATION.FIELDS.duration.special.label')}\n      class=\"full-width\"\n      disabled={!context.editable}\n    />\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import Select from 'src/components/inputs/Select.svelte';\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { CONSTANTS } from 'src/constants';\n  import ItemProperties from '../parts/ItemProperties.svelte';\n  import FieldUses from '../parts/FieldUses.svelte';\n  import FieldTargets from '../parts/FieldTargets.svelte';\n  import FieldActivation from '../parts/FieldActivation.svelte';\n  import FieldRange from '../parts/FieldRange.svelte';\n  import FieldDuration from '../parts/FieldDuration.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<h3 class=\"form-header\">{localize('DND5E.SpellDetails')}</h3>\n\n<!-- Spell Level -->\n<div class=\"form-group\">\n  <label for=\"{appId}-level\">{localize('DND5E.SpellLevel')}</label>\n  <Select\n    id=\"{appId}-level\"\n    document={context.item}\n    field=\"system.level\"\n    value={context.source.level}\n    disabled={!context.editable}\n  >\n    <SelectOptions data={context.config.spellLevels} />\n  </Select>\n</div>\n\n<!-- Spell School -->\n<div class=\"form-group\">\n  <label for=\"{appId}-school\">{localize('DND5E.SpellSchool')}</label>\n  <Select\n    id=\"{appId}-school\"\n    document={context.item}\n    field=\"system.school\"\n    value={context.source.school}\n    disabled={!context.editable}\n  >\n    <SelectOptions\n      data={context.config.spellSchools}\n      labelProp=\"label\"\n      blank=\"\"\n    />\n  </Select>\n</div>\n\n<!-- Spell Components -->\n<div class=\"form-group spell-components stacked\">\n  <label for=\"\">\n    {localize('DND5E.SpellComponents')}\n  </label>\n  <ItemProperties />\n</div>\n\n<!-- Material Components -->\n{#if context.properties.object.material}\n  <div class=\"form-group split-group\">\n    <label for=\"\">{localize('DND5E.SpellMaterials')}</label>\n\n    <div class=\"form-fields\">\n      <!-- Material Supply -->\n      <div class=\"form-group label-top\">\n        <label for=\"{appId}-materials-supply\">{localize('DND5E.Supply')}</label>\n        <NumberInput\n          id=\"{appId}-materials-supply\"\n          document={context.item}\n          field=\"system.materials.supply\"\n          value={context.source.materials.supply}\n          min=\"0\"\n          disabled={!context.editable}\n        />\n      </div>\n\n      <!-- Material Cost -->\n      <div class=\"form-group label-top\">\n        <label\n          for=\"{appId}-materials-cost\"\n          class=\"label-icon currency gp\"\n          aria-label={localize('DND5E.CostGP')}\n        >\n          {localize('DND5E.Cost')}\n        </label>\n\n        <div class=\"form-fields\">\n          <NumberInput\n            id=\"{appId}-materials-cost\"\n            document={context.item}\n            field=\"system.materials.cost\"\n            value={context.source.materials.cost}\n            min=\"0\"\n            placeholder=\"\"\n            disabled={!context.editable}\n          />\n        </div>\n      </div>\n\n      <!-- Material Consumption -->\n      <div class=\"form-group checkbox\">\n        <label for=\"{appId}-materials-consumed\"\n          >{localize('DND5E.Consumed')}</label\n        >\n        <Checkbox\n          id=\"{appId}-materials-consumed\"\n          document={context.item}\n          field=\"system.materials.consumed\"\n          checked={context.source.materials.consumed}\n          disabled={!context.editable}\n        />\n      </div>\n    </div>\n\n    <!-- Material Description -->\n    <TextInput\n      id=\"{appId}-materials-value\"\n      document={context.item}\n      field=\"system.materials.value\"\n      value={context.source.materials.value}\n      class=\"full-width\"\n      disabled={!context.editable}\n    />\n  </div>\n{/if}\n\n<!-- Preparation Mode -->\n<div class=\"form-group\">\n  <label for=\"{appId}-preparation-mode\"\n    >{localize('DND5E.SpellPreparation.Mode')}</label\n  >\n  <div class=\"form-fields\">\n    <!-- Prepared -->\n    {#if context.source.preparation.mode === CONSTANTS.SPELL_PREPARATION_MODE_PREPARED}\n      <Checkbox\n        id=\"{appId}-preparation-prepared\"\n        document={context.item}\n        field=\"system.preparation.prepared\"\n        checked={context.source.preparation.prepared}\n        title={localize('DND5E.Prepared')}\n        attributes={{\n          ['aria-label']: localize('DND5E.Prepared'),\n        }}\n        disabled={!context.editable}\n      />\n    {/if}\n\n    <!-- Mode -->\n    <Select\n      id=\"{appId}-preparation-mode\"\n      document={context.item}\n      field=\"system.preparation.mode\"\n      value={context.source.preparation.mode}\n      disabled={!context.editable}\n    >\n      <SelectOptions\n        data={context.config.spellPreparationModes}\n        labelProp=\"label\"\n      />\n    </Select>\n  </div>\n</div>\n\n<!-- Source Class -->\n{#if context.isEmbedded}\n  <div class=\"form-group\">\n    <label for=\"{appId}-sourceClass\">{localize('DND5E.SpellSourceClass')}</label\n    >\n    <Select\n      id=\"{appId}-sourceClass\"\n      document={context.item}\n      field=\"system.sourceClass\"\n      value={context.source.sourceClass}\n      disabled={!context.editable}\n      blankValue=\"\"\n    >\n      <SelectOptions\n        data={context.document.parent.spellcastingClasses}\n        labelProp=\"name\"\n        blank=\"\"\n      />\n    </Select>\n  </div>\n\n  <Select\n    id=\"{appId}-ability\"\n    document={context.item}\n    field=\"system.ability\"\n    value={context.source.ability}\n    disabled={!context.editable}\n    blankValue=\"\"\n  >\n    <SelectOptions\n      data={context.config.abilities}\n      labelProp=\"label\"\n      blank={context.defaultAbility}\n    />\n  </Select>\n{:else}\n  <div class=\"form-group\">\n    <label for=\"{appId}-sourceClass\">{localize('DND5E.SpellSourceClass')}</label\n    >\n    <TextInput\n      id=\"{appId}-sourceClass\"\n      document={context.item}\n      field=\"system.sourceClass\"\n      value={context.source.sourceClass}\n      disabled={!context.editable}\n    />\n  </div>\n{/if}\n\n<h3 class=\"form-header\">{localize('DND5E.Casting')}</h3>\n\n<!-- Activation -->\n<FieldActivation />\n\n<!-- Range -->\n<FieldRange />\n\n<!-- Duration -->\n<FieldDuration />\n\n<!-- Targets -->\n<FieldTargets />\n\n<FieldUses />\n","<script lang=\"ts\">\n  import DetailsSpellcasting from '../parts/DetailsSpellcasting.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"form-group\">\n  <label for=\"{appId}-identifier\">{localize('DND5E.Identifier')}</label>\n  <div class=\"form-fields\">\n    <TextInput\n      id=\"{appId}-identifier\"\n      document={context.item}\n      field=\"system.identifier\"\n      value={context.source.identifier}\n      placeholder={context.item.identifier}\n      disabled={!context.editable}\n    />\n  </div>\n  <p class=\"hint\">{localize('DND5E.IdentifierError')}</p>\n</div>\n\n<div class=\"form-group\">\n  <label for=\"{appId}-classIdentifier\"\n    >{localize('DND5E.ClassIdentifier')}</label\n  >\n  <div class=\"form-fields\">\n    <TextInput\n      id=\"{appId}-classIdentifier\"\n      document={context.item}\n      field=\"system.classIdentifier\"\n      value={context.source.classIdentifier}\n      disabled={!context.editable}\n    />\n  </div>\n  <p class=\"hint\">\n    {localize('DND5E.SubclassIdentifierHint')}\n  </p>\n</div>\n\n<h3 class=\"form-header\">{localize('DND5E.Spellcasting')}</h3>\n<DetailsSpellcasting />\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import Select from 'src/components/inputs/Select.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import ItemProperties from '../parts/ItemProperties.svelte';\n  import ContentConcealer from 'src/components/content-concealment/ContentConcealer.svelte';\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import FieldUses from '../parts/FieldUses.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  const localize = FoundryAdapter.localize;\n\n  let appId = $derived(context.document.id);\n</script>\n\n<ContentConcealer conceal={context.concealDetails}>\n  <!-- Tool Type -->\n  <div class=\"form-group\">\n    <label for=\"{appId}-type-value\">{localize('DND5E.ItemToolType')}</label>\n    <Select\n      id=\"{appId}-type-value\"\n      document={context.item}\n      field=\"system.type.value\"\n      value={context.source.type.value}\n      disabled={!context.editable}\n    >\n      <SelectOptions data={context.config.toolTypes} blank=\"\" />\n    </Select>\n  </div>\n\n  <!-- Base Tool -->\n  {#if Object.keys(context.baseItems).length}\n    <div class=\"form-group\">\n      <label for=\"{appId}-type-baseItem\">{localize('DND5E.ItemToolBase')}</label\n      >\n      <Select\n        id=\"{appId}-type-baseItem\"\n        document={context.item}\n        field=\"system.type.baseItem\"\n        value={context.source.type.baseItem}\n        disabled={!context.editable}\n      >\n        <SelectOptions data={context.baseItems} blank=\"\" />\n      </Select>\n    </div>\n  {/if}\n\n  <!-- Tool Properties -->\n  <div class=\"form-group stacked tool-properties\">\n    <label for=\"\">{localize('DND5E.ItemToolProperties')}</label>\n    <ItemProperties />\n  </div>\n\n  <!-- Ability Check -->\n  <div class=\"form-group\">\n    <label for=\"{appId}-proficient\">{localize('DND5E.ActionAbil')}</label>\n    <div class=\"form-fields\">\n      <!-- Proficiency -->\n      <div class=\"form-group label-top\">\n        <label for=\"\">{localize('DND5E.Proficiency')}</label>\n        <Select\n          id=\"{appId}-proficient\"\n          document={context.item}\n          field=\"system.proficient\"\n          value={context.source.proficient}\n          disabled={!context.editable}\n        >\n          <SelectOptions\n            data={context.config.proficiencyLevels}\n            blank={localize('DND5E.Automatic')}\n          />\n        </Select>\n      </div>\n\n      <!-- Ability -->\n      <div class=\"form-group label-top\">\n        <label for=\"{appId}-ability\">{localize('DND5E.Ability')}</label>\n        <Select\n          id=\"{appId}-ability\"\n          document={context.item}\n          field=\"system.ability\"\n          value={context.source.ability}\n          disabled={!context.editable}\n        >\n          <SelectOptions\n            data={context.config.abilities}\n            labelProp=\"label\"\n            blank={localize('DND5E.Default')}\n          />\n        </Select>\n      </div>\n    </div>\n  </div>\n\n  <!-- Tool Bonus -->\n  <div class=\"form-group\">\n    <label for=\"{appId}-bonus\">{localize('DND5E.ItemToolBonus')}</label>\n    <TextInput\n      id={`${appId}-system-bonus`}\n      document={context.item}\n      field=\"system.bonus\"\n      value={context.source.bonus}\n      disabled={!context.editable}\n    />\n  </div>\n\n  <!-- Attunement -->\n  {#if context.properties.object.mgc}\n    <div class=\"form-group\">\n      <label for=\"{appId}-attunement\">{localize('DND5E.Attunement')}</label>\n      <div class=\"form-fields no-gap\">\n        <!-- Attuned -->\n        <Checkbox\n          id={`${appId}-system-attuned`}\n          document={context.item}\n          field=\"system.attuned\"\n          checked={context.source.attuned}\n          disabled={!context.editable ||\n            // @ts-expect-error\n            !context.config.attunementTypes[context.source.attunement]}\n          title={localize('DND5E.Attuned')}\n        />\n\n        <!-- Attunement -->\n        <Select\n          id=\"{appId}-attunement\"\n          document={context.item}\n          field=\"system.attunement\"\n          value={context.source.attunement}\n          disabled={!context.editable}\n        >\n          <SelectOptions\n            data={context.config.attunementTypes}\n            blank={localize('DND5E.AttunementNone')}\n          />\n        </Select>\n      </div>\n    </div>\n  {/if}\n\n  <FieldUses />\n</ContentConcealer>\n","<script lang=\"ts\">\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import Select from 'src/components/inputs/Select.svelte';\n  import ItemProperties from '../parts/ItemProperties.svelte';\n  import ContentConcealer from 'src/components/content-concealment/ContentConcealer.svelte';\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import DetailsMountable from '../parts/DetailsMountable.svelte';\n  import FieldDamage from '../parts/FieldDamage.svelte';\n  import FieldUses from '../parts/FieldUses.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<ContentConcealer conceal={context.concealDetails}>\n  <h3 class=\"form-header\">{localize('DND5E.ItemWeaponDetails')}</h3>\n\n  <!-- Weapon Type -->\n  <div class=\"form-group\">\n    <label for=\"{appId}-type-value\">{localize('DND5E.ItemWeaponType')}</label>\n    <Select\n      id=\"{appId}-type-value\"\n      document={context.item}\n      field=\"system.type.value\"\n      value={context.source.type.value}\n      disabled={!context.editable}\n      blankValue=\"\"\n    >\n      <SelectOptions data={context.config.weaponTypes} blank=\"\" />\n    </Select>\n  </div>\n\n  <!-- Weapon Base -->\n  {#if Object.keys(context.baseItems).length}\n    <div class=\"form-group\">\n      <label for=\"{appId}-type-baseItem\"\n        >{localize('DND5E.ItemWeaponBase')}</label\n      >\n      <Select\n        id=\"{appId}-type-baseItem\"\n        document={context.item}\n        field=\"system.type.baseItem\"\n        value={context.source.type.baseItem}\n        disabled={!context.editable}\n      >\n        <SelectOptions data={context.baseItems} blank=\"\" />\n      </Select>\n    </div>\n  {/if}\n\n  <!-- Proficiency -->\n  {#if !context.item.isMountable}\n    <div class=\"form-group\">\n      <label for=\"{appId}-proficient\"\n        >{localize('DND5E.ProficiencyLevel')}</label\n      >\n      <Select\n        id=\"{appId}-proficient\"\n        document={context.item}\n        field=\"system.proficient\"\n        value={context.source.proficient}\n        disabled={!context.editable}\n      >\n        <SelectOptions\n          data={context.config.weaponAndArmorProficiencyLevels}\n          blank={localize('DND5E.Automatic')}\n        />\n      </Select>\n    </div>\n  {/if}\n\n  <!-- Weapon Mastery -->\n  <div class=\"form-group\">\n    <label for=\"{appId}-weapon-mastery\">\n      {localize('DND5E.WEAPON.FIELDS.mastery.label')}\n    </label>\n    <Select\n      id=\"{appId}-weapon-mastery\"\n      document={context.item}\n      field=\"system.mastery\"\n      value={context.source.mastery}\n      blankValue=\"\"\n      disabled={!context.editable}\n    >\n      <SelectOptions\n        data={context.config.weaponMasteries}\n        labelProp=\"label\"\n        blank=\"\"\n      />\n    </Select>\n    <p class=\"hint\">{localize('DND5E.WEAPON.FIELDS.mastery.hint')}</p>\n  </div>\n\n  <!-- Weapon Properties -->\n  <div class=\"form-group stacked weapon-properties\">\n    <label for=\"\">{localize('DND5E.ItemWeaponProperties')}</label>\n    <ItemProperties />\n  </div>\n\n  <!-- Magical Properties -->\n  {#if context.properties.object.mgc}\n    <!-- Attunement -->\n    <div class=\"form-group split-group\">\n      <label for=\"{appId}-attunement\"\n        >{localize('DND5E.Item.Property.Magical')}</label\n      >\n      <div class=\"form-fields\">\n        <!-- Attunement -->\n        {#if !context.item.isMountable}\n          <div class=\"form-group label-top no-gap\">\n            <label for=\"\">\n              {localize('DND5E.Attunement')}\n            </label>\n            <div class=\"form-fields\">\n              <!-- Attuned -->\n              <Checkbox\n                id=\"{appId}-attuned\"\n                document={context.item}\n                field=\"system.attuned\"\n                checked={context.source.attuned}\n                disabled={!context.editable ||\n                  // @ts-expect-error\n                  !context.config.attunementTypes[context.system.attunement]}\n                title={localize('DND5E.AttunementAttuned')}\n              />\n              <!-- Attunement -->\n              <Select\n                id=\"{appId}-attunement\"\n                document={context.item}\n                field=\"system.attunement\"\n                value={context.system.attunement}\n                disabled={!context.editable}\n                class=\"flex-1\"\n              >\n                <SelectOptions\n                  data={context.config.attunementTypes}\n                  blank={localize('DND5E.AttunementNone')}\n                />\n              </Select>\n            </div>\n          </div>\n        {/if}\n        <!-- Magical Bonus -->\n        <div class=\"form-group label-top\">\n          <label for=\"{appId}-magical-bonus\">{localize('DND5E.Bonus')}</label>\n          <NumberInput\n            id=\"{appId}-magical-bonus\"\n            value={context.system.magicalBonus}\n            field=\"system.magicalBonus\"\n            document={context.item}\n            disabled={!context.editable}\n            min=\"0\"\n            step=\"1\"\n            placeholder=\"0\"\n          />\n        </div>\n      </div>\n    </div>\n  {/if}\n\n  <!-- Ammunition Type -->\n  {#if context.properties.object.amm}\n    <div class=\"form-group\">\n      <label for=\"\"\n        >{localize('DND5E.WEAPON.FIELDS.ammunition.type.label')}</label\n      >\n      <Select\n        document={context.item}\n        field=\"system.ammunition.type\"\n        value={context.source.ammunition.type}\n        blankValue=\"\"\n        disabled={!context.editable}\n      >\n        <SelectOptions\n          data={context.config.consumableTypes.ammo.subtypes}\n          blank=\"\"\n        />\n      </Select>\n    </div>\n  {/if}\n\n  <h3 class=\"form-header\">{localize('DND5E.Range')}</h3>\n\n  {#if context.system.hasRange || !context.system.attackType}\n    <div class=\"form-group split-group\">\n      <label for=\"\">{localize('DND5E.RangeDistance')}</label>\n      <div class=\"form-fields\">\n        <!-- Normal -->\n        <div class=\"form-group label-top\">\n          <label for=\"{appId}-range-value\">{localize('DND5E.Normal')}</label>\n          <NumberInput\n            id=\"{appId}-range-value\"\n            document={context.item}\n            field=\"system.range.value\"\n            value={context.source.range.value}\n            min=\"0\"\n            disabled={!context.editable}\n          />\n        </div>\n\n        <!-- Long -->\n        <div class=\"form-group label-top\">\n          <label for=\"{appId}-range-long\">{localize('DND5E.Long')}</label>\n          <NumberInput\n            id=\"{appId}-range-long\"\n            document={context.item}\n            field=\"system.range.long\"\n            value={context.source.range.long}\n            min=\"0\"\n            disabled={!context.editable}\n          />\n        </div>\n\n        <!-- Reach -->\n        {#if context.system.attackType !== 'ranged'}\n          <div class=\"form-group label-top\">\n            <label for=\"{appId}-range-reach\"\n              >{localize('DND5E.RANGE.FIELDS.range.reach.label')}</label\n            >\n            <NumberInput\n              id=\"{appId}-range-reach\"\n              document={context.item}\n              field=\"system.range.reach\"\n              value={context.source.range.reach}\n              min=\"0\"\n              placeholder={context.system.range.reach === null\n                ? ''\n                : context.system.range.reach}\n              disabled={!context.editable}\n            />\n          </div>\n        {/if}\n      </div>\n    </div>\n\n    <!-- Units -->\n    <div class=\"form-group\">\n      <label for=\"\">{localize('DND5E.MovementUnits')}</label>\n      <Select\n        document={context.item}\n        field=\"system.range.units\"\n        value={context.source.range.units}\n        blankValue=\"\"\n        disabled={!context.editable}\n      >\n        <SelectOptions\n          data={context.config.movementUnits}\n          labelProp=\"label\"\n          blank=\"\"\n        />\n      </Select>\n    </div>\n  {:else}\n    <div class=\"form-group split-group\">\n      <label for=\"\">{localize('DND5E.RangeDistance')}</label>\n      <div class=\"form-fields\">\n        <!-- Reach -->\n        {#if context.system.attackType === 'melee'}\n          <div class=\"form-group label-top\">\n            <label for=\"{appId}-range-reach\"\n              >{localize('DND5E.RANGE.FIELDS.range.reach.label')}</label\n            >\n            <NumberInput\n              id=\"{appId}-range-reach\"\n              document={context.item}\n              field=\"system.range.reach\"\n              value={context.source.range.reach}\n              min=\"0\"\n              placeholder={context.system.range.reach === null\n                ? ''\n                : context.system.range.reach}\n              disabled={!context.editable}\n            />\n          </div>\n        {/if}\n\n        <!-- Units -->\n        <div class=\"form-group label-top\">\n          <label for=\"\">{localize('DND5E.MovementUnits')}</label>\n          <Select\n            document={context.item}\n            field=\"system.range.units\"\n            value={context.source.range.units}\n            disabled={!context.editable}\n          >\n            <SelectOptions\n              data={context.config.movementUnits}\n              labelProp=\"label\"\n            />\n          </Select>\n        </div>\n      </div>\n    </div>\n  {/if}\n\n  {#if context.system.isMountable}\n    <DetailsMountable />\n  {/if}\n\n  <h3 class=\"form-header\">{localize('DND5E.DAMAGE.Title')}</h3>\n\n  <div class=\"form-fields\">\n    <p class=\"hint\">{localize('DND5E.WEAPON.FIELDS.damage.hint')}</p>\n  </div>\n\n  <FieldDamage\n    prefix=\"system.damage.base.\"\n    source={context.source.damage.base}\n    denominationOptions={context.denominationOptions.base}\n    types={context.damageTypes}\n  />\n\n  {#if context.properties.object.ver}\n    <h3 class=\"form-header\">{localize('DND5E.Versatile')}</h3>\n    <FieldDamage\n      denominationOptions={context.denominationOptions.base}\n      source={context.source.damage.versatile}\n      prefix=\"system.damage.versatile.\"\n      numberPlaceholder={context.source.damage.base.number}\n    />\n  {/if}\n\n  <FieldUses />\n</ContentConcealer>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import Dnd5eIcon from 'src/components/icon/Dnd5eIcon.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import { Activities } from 'src/features/activities/activities';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n  import { CONSTANTS } from 'src/constants';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  const localize = FoundryAdapter.localize;\n\n  function handleDragStart(ev: DragEvent, activityId: string) {\n    const activity = context.item.system.activities?.get(activityId);\n\n    ev.dataTransfer?.setData(\n      'text/plain',\n      JSON.stringify(activity.toDragData()),\n    );\n  }\n</script>\n\n<section class=\"flex-1 flex-column extra-small-gap\">\n  <header class=\"header\">\n    {#if context.editable}\n      <button\n        type=\"button\"\n        class=\"add-activity-button\"\n        onclick={() => context.item.sheet.addActivity()}\n        tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n      >\n        <i class=\"fas fa-plus\"></i>\n        {localize('DND5E.Add')}\n      </button>\n    {/if}\n  </header>\n  <div class=\"scroll-container activities\">\n    {#each context.activities as activity (activity.id)}\n      <div\n        class=\"activity card\"\n        data-activity-id={activity.id}\n        data-configurable={Activities.isConfigurable(activity)}\n        data-context-menu={CONSTANTS.CONTEXT_MENU_TYPE_ACTIVITIES}\n        draggable=\"true\"\n        ondragstart={(ev) => handleDragStart(ev, activity.id)}\n        data-info-card=\"activity\"\n        data-info-card-entity-uuid={activity.uuid}\n      >\n        <div class=\"icon\" class:svg={activity.img.svg}>\n          {#if activity.img.svg}\n            <Dnd5eIcon src={activity.img.src} />\n          {:else}\n            <img\n              src={activity.img.src}\n              class=\"activity-icon\"\n              alt={activity.name}\n            />\n          {/if}\n        </div>\n        <button\n          type=\"button\"\n          class=\"transparent-button highlight-on-hover name\"\n          onclick={() =>\n            context.system.activities?.get(activity.id).sheet.render(true)}\n          disabled={!context.editable}\n          tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n        >\n          {activity.name}\n        </button>\n        {#if context.editable}\n          <button\n            type=\"button\"\n            class=\"inline-icon-button\"\n            title={localize('DND5E.ACTIVITY.Action.Delete')}\n            onclick={() =>\n              context.system.activities?.get(activity.id)?.deleteDialog()}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n          >\n            <i class=\"fas fa-trash\"></i>\n          </button>\n        {/if}\n      </div>\n    {/each}\n  </div>\n</section>\n\n<style lang=\"scss\">\n  .add-activity-button {\n    background: var(--t5e-faintest-color);\n  }\n\n  .card {\n    border: 0.0625rem solid var(--t5e-separator-color);\n    border-radius: 0.25rem;\n  }\n\n  .activities {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n    padding-top: 0.625rem;\n  }\n\n  .activity {\n    padding: 0.375rem;\n    display: flex;\n    gap: 0.5rem;\n    align-items: center;\n    box-shadow: 0 0 6px var(--dnd5e-shadow-15);\n\n    & > .icon {\n      --icon-size: 1.5rem;\n      --icon-fill: var(--t5e-primary-font-color);\n      flex: 0 0 50px;\n      height: 1.5rem;\n\n      .activity-icon {\n        width: var(--icon-size);\n        height: var(--icon-fill);\n        object-fit: cover;\n      }\n    }\n\n    .name {\n      flex: 1;\n      text-align: center;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import Select from 'src/components/inputs/Select.svelte';\n  import ContentConcealer from 'src/components/content-concealment/ContentConcealer.svelte';\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  let source = $derived(context.source);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<ContentConcealer conceal={context.concealDetails}>\n  <h3 class=\"form-header\">\n    {localize('DND5E.ItemFacilityDetails')}\n  </h3>\n\n  <!-- Type -->\n  <div class=\"form-group\">\n    <label for=\"{appId}-system-type-value\">\n      {localize('DND5E.FACILITY.FIELDS.type.value.label')}\n    </label>\n    <div class=\"form-fields\">\n      <Select\n        document={context.document}\n        field=\"system.type.value\"\n        value={source.type.value}\n        id=\"{appId}-system-type-value\"\n        blankValue={null}\n      >\n        <SelectOptions\n          data={context.config.facilities.types}\n          labelProp=\"label\"\n          valueProp=\"value\"\n        ></SelectOptions>\n      </Select>\n    </div>\n  </div>\n\n  <!-- Sub-Type -->\n  <div class=\"form-group\">\n    <label for=\"{appId}-system-type-subtype\">\n      {localize('DND5E.FACILITY.FIELDS.type.subtype.label')}\n    </label>\n    <div class=\"form-fields\">\n      <Select\n        document={context.document}\n        field=\"system.type.subtype\"\n        value={source.type.subtype}\n        id=\"{appId}-system-type-subtype\"\n      >\n        <SelectOptions\n          data={context.facilitySubtypes ?? {}}\n          labelProp=\"label\"\n          valueProp=\"value\"\n          blank=\"\"\n        ></SelectOptions>\n      </Select>\n    </div>\n  </div>\n\n  <!-- Size -->\n  <div class=\"form-group\">\n    <label for=\"{appId}-system-size\">\n      {localize('DND5E.FACILITY.FIELDS.size.label')}\n    </label>\n    <div class=\"form-fields\">\n      <Select\n        document={context.document}\n        field=\"system.size\"\n        value={source.size}\n        id=\"{appId}-system-size\"\n      >\n        <SelectOptions data={context.config.facilities.sizes} labelProp=\"label\"\n        ></SelectOptions>\n      </Select>\n    </div>\n  </div>\n\n  <!-- Level -->\n  {#if source.type.value === CONSTANTS.FACILITY_TYPE_BASIC}\n    <div class=\"form-group\">\n      <label for=\"{appId}-system-level\">\n        {localize('DND5E.FACILITY.FIELDS.level.label')}\n      </label>\n      <div class=\"form-fields\">\n        <NumberInput\n          id=\"{appId}-system-level\"\n          document={context.document}\n          field=\"system.level\"\n          value={source.level}\n          selectOnFocus={true}\n          min=\"1\"\n          step=\"1\"\n        ></NumberInput>\n      </div>\n    </div>\n  {/if}\n\n  {#if source.type.value === CONSTANTS.FACILITY_TYPE_SPECIAL}\n    <!-- Properties -->\n    <div class=\"form-group split-group\">\n      <label for=\"{appId}-system-level\">\n        {localize('DND5E.FACILITY.Properties')}\n      </label>\n      <div class=\"form-fields\">\n        <!-- Level -->\n        <div class=\"form-group label-top\">\n          <label for=\"{appId}-system-level\">\n            {localize('DND5E.FACILITY.FIELDS.level.label')}\n          </label>\n          <div class=\"form-fields\">\n            <NumberInput\n              id=\"{appId}-system-level\"\n              document={context.document}\n              field=\"system.level\"\n              value={source.level}\n              selectOnFocus={true}\n              min=\"1\"\n              step=\"1\"\n            ></NumberInput>\n          </div>\n        </div>\n\n        <!-- Order -->\n        <div class=\"form-group label-top\">\n          <label for=\"{appId}-system-order\">\n            {localize('DND5E.FACILITY.FIELDS.order.label')}\n          </label>\n          <div class=\"form-fields\">\n            <Select\n              document={context.document}\n              field=\"system.order\"\n              value={source.order}\n              id=\"{appId}-system-order\"\n            >\n              <SelectOptions\n                data={context.orders?.available ?? []}\n                blank=\"\"\n                labelProp=\"label\"\n                valueProp=\"value\"\n              ></SelectOptions>\n            </Select>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Occupants -->\n    <div class=\"form-group split-group\">\n      <label for=\"{appId}-system-hirelings-max\">\n        {localize('DND5E.FACILITY.Occupants')}\n      </label>\n      <div class=\"form-fields\">\n        <!-- Hirelings -->\n        <div class=\"form-group label-top\">\n          <label for=\"{appId}-system-hirelings-max\">\n            {localize('DND5E.FACILITY.FIELDS.hirelings.max.label')}\n          </label>\n          <div class=\"form-fields\">\n            <NumberInput\n              id=\"{appId}-system-hirelings-max\"\n              document={context.document}\n              field=\"system.hirelings.max\"\n              value={source.hirelings.max}\n              selectOnFocus={true}\n              min=\"1\"\n              step=\"1\"\n              placeholder=\"\"\n            ></NumberInput>\n          </div>\n        </div>\n\n        <!-- Defenders -->\n        <div class=\"form-group label-top\">\n          <label for=\"\">\n            {localize('DND5E.FACILITY.FIELDS.defenders.max.label')}\n          </label>\n          <div class=\"form-fields\">\n            <div class=\"form-fields\">\n              <NumberInput\n                id=\"{appId}-system-defenders-max\"\n                document={context.document}\n                field=\"system.defenders.max\"\n                value={source.defenders.max}\n                selectOnFocus={true}\n                min=\"1\"\n                step=\"1\"\n                placeholder=\"\"\n              ></NumberInput>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Free Facility -->\n    <div class=\"form-group\">\n      <label for=\"{appId}-system-free\">\n        {localize('DND5E.FACILITY.FIELDS.free.label')}\n      </label>\n      <div class=\"form-fields\">\n        <Checkbox\n          id=\"{appId}-system-free\"\n          document={context.document}\n          field=\"system.free\"\n          checked={source.free}\n        ></Checkbox>\n      </div>\n      <p class=\"hint\">\n        {localize('DND5E.FACILITY.FIELDS.free.hint')}\n      </p>\n    </div>\n\n    <!-- Enlargeable -->\n    <div class=\"form-group\">\n      <label for=\"{appId}-system-enlargeable\">\n        {localize('DND5E.FACILITY.FIELDS.enlargeable.label')}\n      </label>\n      <div class=\"form-fields\">\n        <Checkbox\n          id=\"{appId}-system-enlargeable\"\n          document={context.document}\n          field=\"system.enlargeable\"\n          checked={source.enlargeable}\n        ></Checkbox>\n      </div>\n      <p class=\"hint\">\n        {localize('DND5E.FACILITY.FIELDS.enlargeable.hint')}\n      </p>\n    </div>\n\n    <!-- Disabled -->\n    <div class=\"form-group\">\n      <label for=\"{appId}-system-disabled\">\n        {localize('DND5E.FACILITY.FIELDS.disabled.label')}\n      </label>\n      <div class=\"form-fields\">\n        <Checkbox\n          id=\"{appId}-system-disabled\"\n          document={context.document}\n          field=\"system.disabled\"\n          checked={source.disabled}\n        ></Checkbox>\n      </div>\n      <p class=\"hint\">\n        {localize('DND5E.FACILITY.FIELDS.disabled.hint')}\n      </p>\n    </div>\n  {:else}\n    <!-- Built -->\n    <div class=\"form-group\">\n      <label for=\"{appId}-system-building-built\">\n        {localize('DND5E.FACILITY.FIELDS.building.built.label')}\n      </label>\n      <div class=\"form-fields\">\n        <Checkbox\n          id=\"{appId}-system-building-built\"\n          document={context.document}\n          field=\"system.building.built\"\n          checked={source.building.built}\n        ></Checkbox>\n      </div>\n      <p class=\"hint\">\n        {localize('DND5E.FACILITY.FIELDS.building.built.hint')}\n      </p>\n    </div>\n  {/if}\n\n  <h3 class=\"form-header\">\n    {localize('DND5E.FACILITY.Orders.Label')}\n  </h3>\n\n  <!-- Executing -->\n  <div class=\"form-group\">\n    <label for=\"{appId}-system-progress-order\">\n      {localize('DND5E.FACILITY.FIELDS.progress.order.label')}\n    </label>\n    <div class=\"form-fields\">\n      <Select\n        document={context.document}\n        field=\"system.progress.order\"\n        value={source.progress.order}\n        id=\"{appId}-system-progress-order\"\n      >\n        <SelectOptions\n          data={context.orders?.executable ?? []}\n          blank=\"\"\n          labelProp=\"label\"\n          valueProp=\"value\"\n        ></SelectOptions>\n      </Select>\n    </div>\n  </div>\n\n  <!-- Progress -->\n  <div class=\"form-group split-group\">\n    <label for=\"{appId}-system-progress-value\">\n      {localize('DND5E.FACILITY.Progress')}\n    </label>\n    <div class=\"form-fields\">\n      <!-- Current -->\n      <div class=\"form-group label-top\">\n        <label for=\"{appId}-system-progress-value\">\n          {localize('DND5E.FACILITY.FIELDS.progress.value.label')}\n        </label>\n        <div class=\"form-fields\">\n          <div class=\"form-fields\">\n            <NumberInput\n              id=\"{appId}-system-progress-value\"\n              document={context.document}\n              field=\"system.progress.value\"\n              value={source.progress.value}\n              selectOnFocus={true}\n              min=\"0\"\n              step=\"0\"\n              placeholder=\"\"\n            ></NumberInput>\n          </div>\n        </div>\n      </div>\n\n      <!-- Total -->\n      <div class=\"form-group label-top\">\n        <label for=\"{appId}-system-progress-max\">\n          {localize('DND5E.FACILITY.FIELDS.progress.max.label')}\n        </label>\n        <div class=\"form-fields\">\n          <div class=\"form-fields\">\n            <NumberInput\n              id=\"{appId}-system-progress-max\"\n              document={context.document}\n              field=\"system.progress.max\"\n              value={source.progress.max}\n              selectOnFocus={true}\n              min=\"1\"\n              step=\"1\"\n              placeholder=\"\"\n            ></NumberInput>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  {#if context.canCraft}\n    <h3 class=\"form-header\">\n      {localize(`DND5E.FACILITY.Orders.${source.order}.present`)}\n    </h3>\n\n    <p class=\"hint\">\n      {localize('DND5E.FACILITY.Craft.Hint')}\n    </p>\n\n    <div class:harvesting={context.isHarvesting}>\n      <ul class=\"separated-list single-item facility-craft\">\n        <li>\n          {#if context.craft}\n            <div class=\"details flexrow\">\n              <img src={context.craft.img} alt={context.craft.name} />\n              {@html context.craft.contentLink}\n              <div class=\"list-controls flexrow\">\n                <button\n                  type=\"button\"\n                  class=\"icon-button\"\n                  onclick={() =>\n                    context.item.sheet.submit({\n                      updateData: { 'system.craft': null },\n                    })}\n                  data-tooltip={localize('DND5E.FACILITY.Action.RemoveCraft')}\n                  aria-label={localize('DND5E.FACILITY.Action.RemoveCraft')}\n                >\n                  <i class=\"fa-solid fa-trash\"></i>\n                </button>\n              </div>\n            </div>\n          {:else}\n            <document-tags\n              name=\"system.craft.item\"\n              single\n              onchange={async () => await context.item.sheet.submit()}\n            ></document-tags>\n          {/if}\n        </li>\n      </ul>\n      {#if context.isHarvesting}\n        <div class=\"quantity\">\n          <span class=\"separator\">&times;</span>\n          <NumberInput\n            id=\"{appId}-system-craft-quantity\"\n            document={context.document}\n            field=\"system.craft.quantity\"\n            value={source.craft.quantity}\n            selectOnFocus={true}\n          ></NumberInput>\n        </div>\n      {/if}\n    </div>\n  {/if}\n\n  {#if source.type.value === CONSTANTS.FACILITY_TYPE_SPECIAL && source.order === 'trade'}\n    <h3 class=\"form-header\">\n      {localize('DND5E.FACILITY.Orders.trade.present')}\n    </h3>\n\n    <!-- Stocked -->\n    <div class=\"form-group\">\n      <label for=\"{appId}-system-trade-stock-stocked\">\n        {localize('DND5E.FACILITY.FIELDS.trade.stock.stocked.label')}\n      </label>\n      <div class=\"form-fields\">\n        <Checkbox\n          id=\"{appId}-system-trade-stock-stocked\"\n          document={context.document}\n          field=\"system.trade.stock.stocked\"\n          checked={source.trade.stock.stocked}\n        ></Checkbox>\n      </div>\n    </div>\n\n    <!-- Goods -->\n    <div class=\"form-group split-group\">\n      <label for=\"{appId}-\">\n        {localize('DND5E.FACILITY.Goods')}\n      </label>\n      <div class=\"form-fields\">\n        <!-- Value -->\n        <div class=\"form-group label-top\">\n          <label for=\"{appId}-system-trade-stock-value\">\n            {localize('DND5E.FACILITY.FIELDS.trade.stock.value.label')}\n          </label>\n          <div class=\"form-fields\">\n            <div class=\"form-fields\">\n              <NumberInput\n                id=\"{appId}-system-trade-stock-value\"\n                document={context.document}\n                field=\"system.trade.stock.value\"\n                value={source.trade.stock.value}\n                selectOnFocus={true}\n                min=\"0\"\n                step=\"0\"\n                placeholder=\"\"\n              ></NumberInput>\n            </div>\n          </div>\n        </div>\n\n        <!-- Max -->\n        <div class=\"form-group label-top\">\n          <label for=\"{appId}-system-trade-stock-max\">\n            {localize('DND5E.FACILITY.FIELDS.trade.stock.max.label')}\n          </label>\n          <div class=\"form-fields\">\n            <div class=\"form-fields\">\n              <NumberInput\n                id=\"{appId}-system-trade-stock-max\"\n                document={context.document}\n                field=\"system.trade.stock.max\"\n                value={source.trade.stock.max}\n                selectOnFocus={true}\n                min=\"1\"\n                step=\"1\"\n                placeholder=\"\"\n              ></NumberInput>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Creatures -->\n    <div class=\"form-group\">\n      <label for=\"{appId}-system-trade-creatures-max\">\n        {localize('DND5E.FACILITY.FIELDS.trade.creatures.max.label')}\n      </label>\n      <div class=\"form-fields\">\n        <NumberInput\n          id=\"{appId}-system-trade-creatures-max\"\n          document={context.document}\n          field=\"system.trade.creatures.max\"\n          value={source.trade.creatures.max}\n          selectOnFocus={true}\n          min=\"1\"\n          step=\"1\"\n          placeholder=\"\"\n        ></NumberInput>\n      </div>\n    </div>\n\n    <!-- Profit Factor -->\n    <div class=\"form-group\">\n      <label for=\"{appId}-system-trade-profit\">\n        {localize('DND5E.FACILITY.FIELDS.trade.profit.label')}\n      </label>\n      <div class=\"form-fields\">\n        <NumberInput\n          id=\"{appId}-system-trade-profit\"\n          document={context.document}\n          field=\"system.trade.profit\"\n          value={source.trade.profit}\n          selectOnFocus={true}\n          min=\"0\"\n          step=\"0\"\n          placeholder=\"\"\n        ></NumberInput>\n        <span class=\"sep unit\">&percnt;</span>\n      </div>\n    </div>\n  {/if}\n</ContentConcealer>\n","<script module lang=\"ts\">\n  // TODO: Should I somehow make these thresholds configurable?\n  const encumberedPct = (1 / 3) * 100;\n  const heavilyEncumberedPct = (2 / 3) * 100;\n</script>\n\n<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { Item5e } from 'src/types/item.types';\n  import type { ContainerCapacityContext } from 'src/types/types';\n\n  interface Props {\n    container: Item5e;\n    capacity: ContainerCapacityContext;\n  }\n\n  let { container, capacity }: Props = $props();\n\n  let readableValue = $derived(\n    container.system.capacity.type === CONSTANTS.ITEM_CAPACITY_TYPE_WEIGHT\n      ? (capacity.value ?? 0).toFixed(1)\n      : Math.ceil(capacity.value ?? 0).toString(),\n  );\n\n  let percentage = $derived(Math.round(capacity.pct));\n\n  const localize = FoundryAdapter.localize;\n\n  let barSeverity = $derived(\n    percentage > heavilyEncumberedPct\n      ? `high`\n      : percentage > encumberedPct\n        ? `medium`\n        : `low`,\n  );\n\n  let capacityMaxText = $derived(\n    capacity.max === Infinity ? '' : capacity.max,\n  );\n</script>\n\n<div\n  class=\"meter progress\"\n  role=\"meter\"\n  aria-label={localize('DND5E.CONTAINER.FIELDS.capacity.label')}\n  aria-valuemin=\"0\"\n  aria-valuenow={capacity.pct}\n  aria-valuetext={readableValue}\n  aria-valuemax={capacity.max}\n  style=\"--bar-percentage: {percentage}%;\"\n  data-bar-severity={barSeverity}\n>\n  <div class=\"label\">\n    <i class=\"fas fa-weight-hanging\"></i>\n    <span class=\"value\">{readableValue}</span>\n    <span class=\"separator\">/</span>\n    <span class=\"max\">{capacityMaxText}</span>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import ExpandableContainer from 'src/components/expandable/ExpandableContainer.svelte';\n  import ContainerContentsSections from './ContainerContentsSections.svelte';\n  import type { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import { getContext } from 'svelte';\n  import type { ContainerContents, Item5e } from 'src/types/item.types';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { CONSTANTS } from 'src/constants';\n  import VerticalFiligreeGuideline from '../../shared/VerticalFiligreeGuideline.svelte';\n  import { getSearchResultsContext } from 'src/features/search/search.svelte';\n  import type { MessageBus } from 'src/types/types';\n\n  interface Props {\n    container: Item5e;\n    containerContents: ContainerContents;\n    editable: boolean;\n    inlineToggleService: InlineToggleService;\n    lockItemQuantity: boolean;\n    sheetDocument: any;\n    unlocked?: boolean;\n  }\n\n  let {\n    container,\n    containerContents,\n    editable,\n    inlineToggleService,\n    lockItemQuantity,\n    sheetDocument,\n    unlocked = true,\n  }: Props = $props();\n\n  let toggleServiceMap = $derived(inlineToggleService.map);\n\n  const searchResults = getSearchResultsContext();\n\n  let tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  let messageBus = getContext<MessageBus>(CONSTANTS.SVELTE_CONTEXT.MESSAGE_BUS);\n\n  async function onDrop(\n    event: DragEvent & { currentTarget: EventTarget & HTMLElement },\n  ) {\n    container.sheet._onDrop(event);\n\n    event.preventDefault();\n    event.stopImmediatePropagation();\n  }\n\n  $effect(() => {\n    if (\n      messageBus?.message?.tabId === tabId &&\n      messageBus?.message?.message === CONSTANTS.MESSAGE_BUS_EXPAND_ALL &&\n      messageBus?.message?.options?.includeInlineToggles\n    ) {\n      inlineToggleService.toggle(tabId, container.id, true);\n    }\n    if (\n      messageBus?.message?.tabId === tabId &&\n      messageBus?.message?.message === CONSTANTS.MESSAGE_BUS_COLLAPSE_ALL &&\n      messageBus?.message?.options?.includeInlineToggles\n    ) {\n      inlineToggleService.toggle(tabId, container.id, false);\n    }\n  });\n</script>\n\n<ExpandableContainer\n  expanded={toggleServiceMap.get(tabId)?.has(container.id) === true}\n  class={!searchResults.show(container.uuid) ? 'hidden' : ''}\n>\n  <div class=\"inline-content-view filigree-guideline-and-contents full-height\">\n    <VerticalFiligreeGuideline />\n    <div\n      class=\"flex-column extra-small-gap flex-1 inline-container-view\"\n      data-tidy-container-id={container.id}\n      ondrop={onDrop}\n    >\n      <ContainerContentsSections\n        contents={containerContents.contents}\n        {container}\n        {editable}\n        itemContext={containerContents.itemContext}\n        {lockItemQuantity}\n        {inlineToggleService}\n        {sheetDocument}\n        {unlocked}\n      />\n      {#if !containerContents.contents.some((c) => c.items.length > 0)}\n        <div class=\"empty-container\">\n          <span class=\"empty-container-text\"\n            >{FoundryAdapter.localize('TIDY5E.EmptyContainer')}</span\n          >\n        </div>\n      {/if}\n    </div>\n  </div>\n</ExpandableContainer>\n","<script lang=\"ts\">\n  import type { Item5e } from 'src/types/item.types';\n  import TextInput from '../inputs/TextInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { isNil } from 'src/utils/data';\n\n  interface Props {\n    item: Item5e;\n    field?: string;\n    disabled?: boolean;\n  }\n\n  let { item, field = 'system.quantity', disabled = false }: Props = $props();\n\n  let quantity = $derived(FoundryAdapter.getProperty<number>(item, field));\n\n  async function increment() {\n    if (!isNil(quantity)) {\n      await item.update({\n        [field]: quantity + 1,\n      });\n    }\n  }\n\n  async function decrement() {\n    if (!isNil(quantity)) {\n      await item.update({\n        [field]: quantity - 1,\n      });\n    }\n  }\n</script>\n\n<article class=\"tidy-inline-item-quantity-tracker\" class:disabled>\n  <a class=\"command decrementer\" onclick={() => !disabled && decrement()}>\n    <i class=\"fa-solid fa-minus\"></i>\n  </a>\n  <span class=\"item-quantity-tracker-input-wrapper\">\n    <TextInput\n      class=\"item-quantity-tracker-input\"\n      document={item}\n      {field}\n      value={quantity}\n      {disabled}\n      allowDeltaChanges={true}\n      selectOnFocus={true}\n    ></TextInput>\n  </span>\n  <a class=\"command incrementer\" onclick={() => !disabled && increment()}>\n    <i class=\"fa-solid fa-plus\"></i>\n  </a>\n</article>\n\n<!-- TODO: Make a generic counter that can be injected onto the sheet for things like `So Inspired!`  -->\n","<script lang=\"ts\">\n  import TidyTable, {\n    type TidyTableColumns,\n  } from 'src/components/table/TidyTable.svelte';\n  import TidyTableHeaderCell from 'src/components/table/TidyTableHeaderCell.svelte';\n  import TidyTableHeaderRow from 'src/components/table/TidyTableHeaderRow.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { ContainerItemContext, Item5e } from 'src/types/item.types';\n  import type { Actor5e, InventorySection } from 'src/types/types';\n  import ItemTableRowV2 from 'src/components/item-list/v2/ItemTableRowV2.svelte';\n  import TidyTableCell from 'src/components/table/TidyTableCell.svelte';\n  import { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import { SheetSections } from 'src/features/sections/SheetSections';\n  import { getContext } from 'svelte';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\n  import InlineContainerView from './InlineContainerView.svelte';\n  import { getSearchResultsContext } from 'src/features/search/search.svelte';\n  import InlineItemQuantityTracker from 'src/components/trackers/InlineItemQuantityTracker.svelte';\n\n  interface Props {\n    contents: InventorySection[];\n    container: Item5e;\n    editable: boolean;\n    itemContext: Record<string, ContainerItemContext>;\n    inlineToggleService: InlineToggleService;\n    lockItemQuantity: boolean;\n    /** The sheet which is rendering this recursive set of container contents. */\n    sheetDocument: Actor5e | Item5e;\n    unlocked?: boolean;\n  }\n\n  let {\n    contents,\n    container,\n    editable,\n    itemContext,\n    inlineToggleService,\n    lockItemQuantity,\n    sheetDocument,\n    unlocked = true,\n  }: Props = $props();\n\n  const tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  let configuredContents = $derived(\n    SheetSections.configureInventory(\n      contents.filter((i) => i.items.length),\n      tabId,\n      SheetPreferencesService.getByType(sheetDocument.type),\n      TidyFlags.sectionConfig.get(container)?.[\n        CONSTANTS.TAB_CONTAINER_CONTENTS\n      ],\n    ),\n  );\n\n  const searchResults = getSearchResultsContext();\n\n  // let itemActions: {\n  //   component: Component;\n  //   getProps: (item: Item5e) => any;\n  // }[] = [];\n\n  // $: {\n  //   itemActions = [];\n\n  //   if (unlocked) {\n  //     itemActions.push({\n  //       component: ItemEditControl,\n  //       getProps: (item: Item5e) => ({ item }),\n  //     });\n\n  //     itemActions.push({\n  //       component: ItemDeleteControl,\n  //       getProps: (item: Item5e) => ({\n  //         item,\n  //         deleteFn: () => item.deleteDialog(),\n  //       }),\n  //     });\n  //   }\n  // }\n\n  const weightUnit = FoundryAdapter.getWeightUnit();\n\n  let useClassicControls = $derived(\n    FoundryAdapter.useClassicControls(container),\n  );\n\n  // TODO: Allow the user to choose which icons are priority and can be shown in the actions column\n\n  let gridTemplateColumns: TidyTableColumns = $derived.by(() => {\n    let result: TidyTableColumns = [\n      {\n        name: 'Name',\n        width: '1fr',\n      },\n      {\n        name: 'Quantity',\n        width: '4.125rem',\n      },\n      {\n        name: 'Weight',\n        width: '2.25rem',\n      },\n    ];\n\n    if (useClassicControls) {\n      result.push({\n        name: 'Actions',\n        width: `${1.5 * (unlocked ? 3 : 1)}rem`,\n      });\n    }\n\n    return result;\n  });\n\n  let containerToggleMap = $derived(inlineToggleService.map);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n{#each configuredContents as section (section.key)}\n  {@const itemEntries = section.items.map((item) => ({\n    item,\n    ctx: itemContext[item.id],\n  }))}\n\n  {#if section.show}\n    <TidyTable\n      key={section.key}\n      data-custom-section={section.custom ? true : null}\n      {gridTemplateColumns}\n    >\n      {#snippet header()}\n        <TidyTableHeaderRow>\n          <TidyTableHeaderCell primary={true}>\n            {localize(section.label)}\n            <span class=\"count\">{section.items.length}</span>\n          </TidyTableHeaderCell>\n          <TidyTableHeaderCell>\n            {localize('DND5E.Quantity')}\n          </TidyTableHeaderCell>\n          <TidyTableHeaderCell>\n            {localize('DND5E.Weight')}\n          </TidyTableHeaderCell>\n          <TidyTableHeaderCell class=\"item-actions\">\n            <!-- Actions -->\n          </TidyTableHeaderCell>\n        </TidyTableHeaderRow>\n      {/snippet}\n      {#snippet body()}\n        {#each itemEntries as { item, ctx }, i (item.id)}\n          {@const weight = ctx?.totalWeight ?? item.system.weight.value}\n          {@const itemBorderColor = item.system.rarity\n            ? `var(--t5e-color-rarity-${item.system.rarity.slugify()})`\n            : 'var(--t5e-color-gold)'}\n          {@const showRarityBoxShadow = [\n            'veryRare',\n            'legendary',\n            'artifact',\n          ].includes(item.system.rarity)}\n\n          <!-- TODO: Put 1px margin top on first row -->\n\n          <ItemTableRowV2\n            {item}\n            hidden={!searchResults.show(item.uuid)}\n            rowClass={FoundryAdapter.getInventoryRowClasses(\n              item,\n              itemContext[item.id]?.attunement,\n            )}\n            contextMenu={{\n              type: CONSTANTS.CONTEXT_MENU_TYPE_ITEMS,\n              uuid: item.uuid,\n            }}\n          >\n            {#snippet children({ toggleSummary })}\n              <TidyTableCell primary={true} class=\"truncate\">\n                <a\n                  class=\"item-image\"\n                  style=\"--item-img: url({item.img}); --item-border-color: {itemBorderColor};\"\n                  class:special-rarity={showRarityBoxShadow}\n                  onclick={(ev) => FoundryAdapter.actorTryUseItem(item, ev)}\n                >\n                  <span class=\"roll-prompt\">\n                    <i class=\"fa fa-dice-d20\"></i>\n                  </span>\n                </a>\n                {#if ('containerContents' in ctx && !!ctx.containerContents)}\n                  <a\n                    class=\"expand-indicator-button\"\n                    onclick={() => inlineToggleService.toggle(tabId, item.id)}\n                  >\n                    <i\n                      class=\"fa-solid fa-angle-right expand-indicator\"\n                      class:expanded={containerToggleMap\n                        .get(tabId)\n                        ?.has(item.id)}\n                    >\n                    </i>\n                  </a>\n                {/if}\n                <a class=\"item-name truncate\" onclick={(ev) => toggleSummary()}>\n                  <span class=\"truncate\">{item.name}</span>\n                </a>\n              </TidyTableCell>\n              <TidyTableCell>\n                <InlineItemQuantityTracker {item} disabled={!item.isOwner} />\n              </TidyTableCell>\n              <TidyTableCell>\n                {weight}\n              </TidyTableCell>\n              <TidyTableCell class=\"item-actions\">\n                {#if unlocked}\n                  <a class=\"item-action\">\n                    <i class=\"fas fa-edit\"></i>\n                  </a>\n                  <a class=\"item-action\">\n                    <i class=\"fas fa-trash\"></i>\n                  </a>\n                {/if}\n                <a class=\"item-action\">\n                  <i class=\"fas fa-ellipsis-vertical\"></i>\n                </a>\n              </TidyTableCell>\n            {/snippet}\n          </ItemTableRowV2>\n\n          {#if 'containerContents' in ctx && !!ctx.containerContents}\n            <InlineContainerView\n              container={item}\n              containerContents={ctx.containerContents}\n              {editable}\n              {inlineToggleService}\n              {lockItemQuantity}\n              {sheetDocument}\n              {unlocked}\n            />\n          {/if}\n\n          <hr class=\"table-row-divider\" />\n        {/each}\n      {/snippet}\n    </TidyTable>\n  {/if}\n{/each}\n","<script lang=\"ts\">\n  import type { Snippet } from 'svelte';\n  import type { ChangeEventHandler } from 'svelte/elements';\n\n  interface Props {\n    checked?: boolean;\n    disabled?: boolean;\n    children?: Snippet;\n    onchange?: ChangeEventHandler<HTMLInputElement>;\n    [key: string]: any;\n  }\n\n  let {\n    checked = false,\n    disabled = false,\n    children,\n    onchange,\n    ...rest\n  }: Props = $props();\n</script>\n\n<label class=\"button toggle-button {rest.class ?? ''}\" class:disabled>\n  {@render children?.()}\n  <input\n    type=\"checkbox\"\n    class=\"hidden toggle\"\n    {checked}\n    {onchange}\n    {disabled}\n  />\n</label>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { isNil } from 'src/utils/data';\n\n  interface Props {\n    searchCriteria?: string;\n    disabled?: boolean;\n  }\n\n  let { searchCriteria = $bindable(''), disabled = false }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<search>\n  <span class=\"icon-and-input\">\n    <i class=\"fas fa-magnifying-glass fa-fw\"></i>\n    <input\n      type=\"text\"\n      placeholder={localize('TIDY5E.Search')}\n      bind:value={searchCriteria}\n      {disabled}\n    />\n  </span>\n  {#if !isNil(searchCriteria, '')}\n    <a class=\"cancel-search\" onclick={() => (searchCriteria = '')}>\n      <i class=\"fas fa-x fa-fw\"></i>\n    </a>\n  {/if}\n</search>\n","export type LongpressEventCallback = (node: HTMLElement) => void;\n\nexport function longpress(\n  node: HTMLElement,\n  options: { callback?: LongpressEventCallback; threshold?: number } = {}\n) {\n  const threshold = options?.threshold ?? 500;\n\n  $effect(() => {\n    const handleMouseDown = () => {\n      const controller = new AbortController();\n      const timeout = setTimeout(() => {\n        options?.callback?.(node);\n      }, threshold);\n\n      const cancel = () => {\n        clearTimeout(timeout);\n        controller.abort();\n      };\n\n      let cancellableActions: (keyof HTMLElementEventMap)[] = [\n        'mouseleave',\n        'mouseup',\n        'touchend',\n        'touchmove', // TODO: use `touchleave` whenever it's widely available\n      ];\n\n      cancellableActions.forEach((a) =>\n        node.addEventListener(a, cancel, {\n          signal: controller.signal,\n        })\n      );\n    };\n\n    const controller = new AbortController();\n\n    node.addEventListener('mousedown', handleMouseDown, {\n      signal: controller.signal,\n    });\n    node.addEventListener('touchstart', handleMouseDown, {\n      signal: controller.signal,\n    });\n\n    return () => {\n      controller.abort();\n    };\n  });\n}\n","<script lang=\"ts\">\n  import { longpress } from 'src/actions/longpress.svelte';\n  import { tick, type Snippet } from 'svelte';\n  import type { MouseEventHandler } from 'svelte/elements';\n\n  interface Props {\n    expanded?: boolean;\n    active?: boolean;\n    disabled?: boolean;\n    anchor?: 'left' | 'right';\n    children?: Snippet;\n    options?: Snippet;\n    onclick?: MouseEventHandler<HTMLElement>;\n    [key: string]: any;\n  }\n\n  let {\n    expanded = $bindable(false),\n    active = false,\n    disabled = false,\n    anchor = 'left',\n    children,\n    options,\n    onclick,\n    ...rest\n  }: Props = $props();\n\n  let menuEl: HTMLElement;\n  let menuOpenerEl: HTMLElement;\n\n  function handleFocusOut(\n    event: FocusEvent & { currentTarget: EventTarget & HTMLElement },\n  ) {\n    const relatedTarget = event.relatedTarget;\n    const nearestMenuElement =\n      relatedTarget instanceof HTMLElement\n        ? relatedTarget.closest<HTMLElement>('menu, .button.with-options')\n        : null;\n\n    if (\n      nearestMenuElement &&\n      [menuEl, menuOpenerEl].includes(nearestMenuElement)\n    ) {\n      return;\n    }\n\n    menuEl.blur();\n    expanded = false;\n  }\n\n  async function toggleMenu(expand?: boolean): Promise<void> {\n    expanded = expand ?? !expanded;\n\n    if (expanded) {\n      await tick();\n      menuOpenerEl.focus();\n    }\n  }\n</script>\n\n<div class=\"button-with-options-wrapper\">\n  <a\n    class=\"button with-options {rest.class ?? ''}\"\n    class:expanded\n    class:active\n    class:disabled\n    use:longpress={{ callback: () => toggleMenu() }}\n    {onclick}\n    oncontextmenu={() => toggleMenu(true)}\n    onfocusout={handleFocusOut}\n    tabindex={expanded ? 0 : null}\n    bind:this={menuOpenerEl}\n  >\n    {@render children?.()}\n    {#if expanded}\n      <i class=\"expand-indicator fas fa-caret-up\"></i>\n    {:else}\n      <i class=\"expand-indicator fas fa-caret-down\"></i>\n    {/if}\n  </a>\n\n  <menu\n    class:expanded\n    class=\"anchor-{anchor}\"\n    onfocusout={handleFocusOut}\n    tabindex={expanded ? 0 : null}\n    bind:this={menuEl}\n  >\n    {@render options?.()}\n  </menu>\n</div>\n","<script lang=\"ts\">\n  interface Props {\n    root?: IntersectionObserverInit['root'];\n    rootMargin?: IntersectionObserverInit['rootMargin'];\n    toObserve?: HTMLElement[];\n    toAffect?: 'self' | HTMLElement[];\n    trackWhenOnScreen?: boolean;\n    onScreenClass?: string;\n    trackWhenOffScreen?: boolean;\n    offScreenClass?: string;\n  }\n\n  let {\n    root,\n    rootMargin,\n    toObserve,\n    toAffect,\n    trackWhenOnScreen = false,\n    onScreenClass = 'on-screen',\n    trackWhenOffScreen = false,\n    offScreenClass = 'off-screen',\n  }: Props = $props();\n\n  $effect(() => {\n    const observer = new IntersectionObserver(\n      (entries) => {\n        for (var entry of entries) {\n          const elementsToUpdate =\n            toAffect === 'self' ? [entry.target] : (toAffect ?? []);\n\n          elementsToUpdate.forEach((el) => {\n            if (trackWhenOffScreen) {\n              el.classList.toggle(offScreenClass, !entry.isIntersecting);\n            }\n\n            if (trackWhenOnScreen) {\n              el.classList.toggle(onScreenClass, entry.isIntersecting);\n            }\n          });\n        }\n      },\n      {\n        root,\n        rootMargin,\n      },\n    );\n\n    console.log(toObserve);\n\n    toObserve?.forEach((el) => !!el && observer.observe(el));\n\n    return () => {\n      observer.disconnect();\n    };\n  });\n</script>\n","import { CONSTANTS } from 'src/constants';\nimport { TidyFlags } from 'src/foundry/TidyFlags';\nimport type { Item5e } from 'src/types/item.types';\nimport type {\n  ContainerCapacityContext,\n  ContainerPanelItemContext,\n  InventorySection,\n} from 'src/types/types';\nimport { error } from 'src/utils/logging';\nimport { SheetSections } from './SheetSections';\n\nexport class Inventory {\n  static getDefaultInventoryTypes(): string[] {\n    return Object.entries(CONFIG.Item.dataModels)\n      .filter(([, model]: [string, any]) => model.metadata?.inventoryItem)\n      .sort(\n        ([, lhs]: [string, any], [, rhs]: [string, any]) =>\n          lhs.metadata.inventoryOrder - rhs.metadata.inventoryOrder\n      )\n      .map((entry) => entry[0]);\n  }\n\n  static isInventoryType(item: Item5e) {\n    return !!CONFIG.Item.dataModels[item.type]?.metadata?.inventoryItem;\n  }\n\n  static getDefaultInventorySections(\n    options: Partial<InventorySection> = {}\n  ): Record<string, InventorySection> {\n    const inventoryTypes = Inventory.getDefaultInventoryTypes();\n\n    const inventory: Record<string, InventorySection> = {};\n\n    for (const type of inventoryTypes) {\n      inventory[type] = {\n        canCreate: true,\n        dataset: { type },\n        items: [],\n        key: type,\n        label: `${\n          CONFIG.Item.typeLabels[type as keyof typeof CONFIG.Item.typeLabels]\n        }Pl`,\n        show: true,\n        custom: undefined,\n        isExternal: false,\n        ...options,\n      };\n    }\n\n    return inventory;\n  }\n\n  static applyInventoryItemToSection(\n    inventory: Record<string, InventorySection>,\n    item: Item5e,\n    defaultInventoryTypes: string[],\n    customSectionOptions: Partial<InventorySection>\n  ) {\n    const customSectionName = TidyFlags.section.get(item);\n\n    if (!customSectionName) {\n      inventory[item.type].items.push(item);\n      return;\n    }\n\n    const customSection: InventorySection = (inventory[customSectionName] ??=\n      Inventory.createInventorySection(\n        customSectionName,\n        defaultInventoryTypes,\n        customSectionOptions\n      ));\n\n    customSection.items.push(item);\n  }\n\n  static createInventorySection(\n    customSectionName: string,\n    defaultInventoryTypes: string[],\n    customSectionOptions: Partial<InventorySection>\n  ): InventorySection {\n    return {\n      dataset: { [TidyFlags.section.prop]: customSectionName },\n      items: [],\n      label: customSectionName,\n      canCreate: true,\n      key: customSectionName,\n      custom: {\n        section: customSectionName,\n        creationItemTypes: [...defaultInventoryTypes],\n      },\n      show: true,\n      ...customSectionOptions,\n    };\n  }\n\n  static async getContainerPanelItems(items: Item5e[]) {\n    let containerPanelItems: ContainerPanelItemContext[] = [];\n    try {\n      let containers = items\n        .filter((i: Item5e) => i.type === CONSTANTS.ITEM_TYPE_CONTAINER)\n        .toSorted((a: Item5e, b: Item5e) => a.sort - b.sort);\n\n      for (let container of containers) {\n        const capacity =\n          (await container.system.computeCapacity()) as ContainerCapacityContext;\n        containerPanelItems.push({\n          container,\n          ...capacity,\n        });\n      }\n    } catch (e) {\n      error(\n        'An error occurred while preparing containers for the container panel',\n        false,\n        e\n      );\n    }\n    return containerPanelItems;\n  }\n\n  static async getContainerContentsInventory(\n    container: Item5e,\n    options: Partial<InventorySection> = {\n      canCreate: false,\n    }\n  ): Promise<InventorySection[]> {\n    const containerItems = (await container.system.contents).values();\n\n    const inventory = Inventory.getDefaultInventorySections();\n\n    const inventoryTypes = Inventory.getDefaultInventoryTypes();\n\n    for (let item of containerItems) {\n      Inventory.applyInventoryItemToSection(\n        inventory,\n        item,\n        inventoryTypes,\n        options\n      );\n    }\n\n    return Object.values(inventory);\n  }\n}\n","import type {\n  ContainerContents,\n  ContainerItemContext,\n  Item5e,\n} from 'src/types/item.types';\nimport { Inventory } from '../sections/Inventory';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { CONSTANTS } from 'src/constants';\nimport type { CharacterFavorite } from 'src/foundry/dnd5e.types';\nimport { Activities } from '../activities/activities';\nimport { TidyHooks } from 'src/foundry/TidyHooks';\nimport type { ContainerCapacityContext } from 'src/types/types';\n\nexport class Container {\n  static async getContainerContents(\n    container: Item5e\n  ): Promise<ContainerContents> {\n    const containerContentsInventory =\n      await Inventory.getContainerContentsInventory(container);\n\n    return {\n      capacity: await container.system.computeCapacity(),\n      currency: container.system.currency,\n      contents: containerContentsInventory,\n      itemContext: await Container.getContainerItemContext(container),\n    };\n  }\n\n  static async getContainerItemContext(\n    container: Item5e\n  ): Promise<Record<string, ContainerItemContext>> {\n    const itemContext: Record<string, ContainerItemContext> = {};\n\n    const favorites: CharacterFavorite[] | undefined =\n      container.actor?.system.favorites;\n\n    const containerValues = (await container.system.contents).values();\n\n    for (const item of containerValues) {\n      const ctx = (itemContext[item.id] ??= {});\n      ctx.totalWeight = (await item.system.totalWeight).toNearest(0.1);\n      ctx.isStack = item.system.quantity > 1;\n      ctx.attunement = FoundryAdapter.getAttunementContext(item);\n\n      if (favorites) {\n        const relativeUuid = item.getRelativeUUID(container.actor);\n        // TODO: Determine if this looped array traversal is going to be an issue; if so, consider passing in a context object with a favorites map.\n        ctx.favoriteId = item.actor.system.favorites?.find(\n          (f: CharacterFavorite) => f.id === relativeUuid\n        )?.id;\n      }\n\n      if (item.type === CONSTANTS.ITEM_TYPE_CONTAINER) {\n        ctx.containerContents = await Container.getContainerContents(item);\n      }\n\n      ctx.activities = Activities.getVisibleActivities(\n        item,\n        item.system.activities\n      )?.map(Activities.getActivityItemContext);\n    }\n\n    return itemContext;\n  }\n\n  static promptCreateInventoryItem(container: Item5e) {\n    const actor = container.actor;\n\n    const folder = !!actor ? undefined : container.folder;\n\n    const createData = {\n      folder: folder,\n      'system.container': container.id,\n    };\n\n    if (!TidyHooks.tidy5eSheetsPreCreateItem(actor, createData, game.user.id)) {\n      return;\n    }\n\n    Item.implementation.createDialog(createData, {\n      parent: actor,\n      pack: container.pack,\n      types: Inventory.getDefaultInventoryTypes(),\n      keepId: true,\n    });\n  }\n\n  static async computeCapacity(\n    container: Item5e\n  ): Promise<ContainerCapacityContext> {\n    const context = await container.system.computeCapacity();\n\n    if (container.system.capacity.type === 'weight') {\n      context.units = FoundryAdapter.getWeightUnit();\n    }\n\n    return context;\n  }\n}\n","import { CONSTANTS } from 'src/constants';\nimport type { UserPreferences } from './user-preferences.types';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\nclass UserPreferencesService {\n  async setPreference<\n    K extends keyof UserPreferences,\n    V extends UserPreferences[K]\n  >(property: K, value: V) {\n    await game.user.setFlag(\n      CONSTANTS.MODULE_ID,\n      `userPreferences.${property}`,\n      value\n    );\n  }\n\n  get(): UserPreferences {\n    return {\n      expandCollapseBehavior: 'top-level',\n\n      ...FoundryAdapter.getProperty<UserPreferences>(\n        game.user,\n        `flags.${CONSTANTS.MODULE_ID}.userPreferences`\n      ),\n    };\n  }\n}\n\nexport default new UserPreferencesService();\n","<script lang=\"ts\">\n  import ButtonWithOptionPanel from 'src/components/buttons/ButtonWithOptionPanel.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { ExpansionTracker } from 'src/features/expand-collapse/ExpansionTracker.svelte';\n  import type { ExpandCollapseBehavior } from 'src/features/user-preferences/user-preferences.types';\n  import UserPreferencesService from 'src/features/user-preferences/UserPreferencesService';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getContainerSheetQuadroneContext } from 'src/sheets/sheet-context.svelte';\n  import { getContext } from 'svelte';\n\n  const sectionExpansionTracker = ExpansionTracker.getOrInit(\n    CONSTANTS.SVELTE_CONTEXT.SECTION_EXPANSION_TRACKER,\n  );\n\n  const localize = FoundryAdapter.localize;\n\n  let context = $derived(getContainerSheetQuadroneContext());\n  let tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  let allExpanded = $derived(\n    context.userPreferences.expandCollapseBehavior === 'top-level'\n      ? sectionExpansionTracker.tabStats[tabId]?.topAllExpanded === true\n      : sectionExpansionTracker.tabStats[tabId]?.allExpanded === true,\n  );\n\n  function toggleContents() {\n    sectionExpansionTracker.setAll(\n      tabId,\n      !allExpanded,\n      context.userPreferences.expandCollapseBehavior === 'top-level'\n        ? 'shallow'\n        : 'deep',\n    );\n  }\n\n  function onExpandCollapseBehaviorChanged(\n    event: Event & { currentTarget: EventTarget & HTMLInputElement },\n  ) {\n    UserPreferencesService.setPreference(\n      'expandCollapseBehavior',\n      event.currentTarget.value as ExpandCollapseBehavior,\n    );\n  }\n</script>\n\n<ButtonWithOptionPanel\n  class=\"icon-button expand-button {allExpanded ? 'expanded' : 'collapsed'}\"\n  onclick={() => toggleContents()}\n>\n  <i class=\"expand-button-indicator fas fa-angles-down fa-fw\"></i>\n  {#snippet options()}\n    <h4>{localize('TIDY5E.ExpandCollapseMenu.OptionTitle')}</h4>\n    <label\n      for=\"{context.document.id}-expand-collapse-behavior-top-level-sections\"\n    >\n      <input\n        id=\"{context.document.id}-expand-collapse-behavior-top-level-sections\"\n        type=\"radio\"\n        checked={context.userPreferences.expandCollapseBehavior === 'top-level'}\n        value={'top-level' satisfies ExpandCollapseBehavior}\n        onchange={onExpandCollapseBehaviorChanged}\n      />\n      {localize('TIDY5E.ExpandCollapseMenu.OptionTopLevel')}\n    </label>\n    <label for=\"{context.document.id}-expand-collapse-behavior-all-sections\">\n      <input\n        type=\"radio\"\n        id=\"{context.document.id}-expand-collapse-behavior-all-sections\"\n        checked={context.userPreferences.expandCollapseBehavior === 'all'}\n        value={'all' satisfies ExpandCollapseBehavior}\n        onchange={onExpandCollapseBehaviorChanged}\n      />\n      {localize('TIDY5E.ExpandCollapseMenu.OptionAllSections')}\n    </label>\n  {/snippet}\n</ButtonWithOptionPanel>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getContext } from 'svelte';\n  import CapacityBar from 'src/sheets/quadrone/container/parts/CapacityBar.svelte';\n  import ContainerContentsSections from 'src/sheets/quadrone/container/parts/ContainerContentsSections.svelte';\n  import { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import { ItemVisibility } from 'src/features/sections/ItemVisibility';\n  import ToggleButton from 'src/components/buttons/ToggleButton.svelte';\n  import Search from '../../shared/Search.svelte';\n  import ButtonWithOptionPanel from 'src/components/buttons/ButtonWithOptionPanel.svelte';\n  import {\n    createSearchResultsState,\n    setSearchResultsContext,\n  } from 'src/features/search/search.svelte';\n  import { getContainerSheetQuadroneContext } from 'src/sheets/sheet-context.svelte';\n  import TidyVisibilityObserver from 'src/components/utility/TidyVisibilityObserver.svelte';\n  import { Container } from 'src/features/containers/Container';\n  import ExpandCollapseButton from '../../shared/ExpandCollapseButton.svelte';\n\n  let context = $derived(getContainerSheetQuadroneContext());\n  let tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  let inlineToggleService = getContext<InlineToggleService>(\n    CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n  );\n\n  let searchCriteria = $state('');\n\n  const searchResults = createSearchResultsState();\n  setSearchResultsContext(searchResults);\n\n  $effect(() => {\n    searchResults.uuids = ItemVisibility.getItemsToShowAtDepth({\n      criteria: searchCriteria,\n      itemContext: context.itemContext,\n      sections: context.containerContents.contents,\n      tabId: tabId,\n    });\n  });\n\n  const localize = FoundryAdapter.localize;\n\n  let utilityBarCommands = $derived(\n    context.utilities[tabId]?.utilityToolbarCommands ?? [],\n  );\n\n  let menuOpen = $derived(false);\n\n  let markerEl: HTMLElement | undefined = $state();\n  let footerEl: HTMLElement | undefined = $state();\n</script>\n\n{#if !!markerEl && !!footerEl}\n  <TidyVisibilityObserver\n    root={context.item.sheet.windowContent}\n    trackWhenOffScreen={true}\n    toObserve={[markerEl]}\n    toAffect={[footerEl]}\n    rootMargin=\"-12px\"\n  />\n{/if}\n\n<section\n  class=\"action-bar\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ACTION_BAR}\n>\n  <!-- TODO: Extract to component. -->\n  <ExpandCollapseButton />\n\n  <Search bind:searchCriteria />\n\n  <div class=\"button-group\">\n    <ToggleButton class=\"hide-under-450\">Action</ToggleButton>\n    <ToggleButton class=\"hide-under-550\">Bonus Action</ToggleButton>\n    <ToggleButton class=\"hide-under-600\">Reaction</ToggleButton>\n    <ToggleButton class=\"hide-under-400\">Can Use</ToggleButton>\n    <ToggleButton>Magical</ToggleButton>\n  </div>\n\n  <a class=\"button icon-button\">\n    <i class=\"fas fa-filter\"></i>\n  </a>\n\n  <ButtonWithOptionPanel class=\"icon-button\" anchor=\"right\">\n    <i class=\"fas fa-arrow-down-a-z fa-fw\"></i>\n    {#snippet options()}\n      <label for=\"{context.document.id}-sort-option-alphabetical\">\n        <input\n          type=\"radio\"\n          id=\"{context.document.id}-sort-option-alphabetical\"\n          checked={true}\n        />\n        {localize('TIDY5E.SortMenu.OptionAlphabetical')}\n      </label>\n      <label for=\"{context.document.id}-sort-option-manual\">\n        <input\n          type=\"radio\"\n          id=\"{context.document.id}-sort-option-manual\"\n          checked={false}\n        />\n        {localize('TIDY5E.SortMenu.OptionManual')}\n      </label>\n      <label for=\"{context.document.id}-sort-option-equipped\">\n        <input\n          type=\"radio\"\n          id=\"{context.document.id}-sort-option-equipped\"\n          checked={false}\n        />\n        {localize('TIDY5E.SortMenu.OptionEquipped')}\n      </label>\n    {/snippet}\n  </ButtonWithOptionPanel>\n\n  <a class=\"button icon-button\" class:disabled={!context.editable}>\n    <i class=\"fas fa-gear\"></i>\n  </a>\n</section>\n\n<!-- Tables -->\n<!-- New Container Contents Sections > New Inline Container View (requires options for column specification, classic controls)  -->\n<!-- Column specification needs to have options for spanning -->\n<!-- These options should be conditional accepted here, since this will also be reused for actor inventories -->\n<!-- ? DO we have to reuse the same components, or can we make curated versions for container and actor? -->\n<div class=\"container-contents-wrapper\">\n  <ContainerContentsSections\n    contents={context.containerContents.contents}\n    container={context.item}\n    editable={context.editable}\n    itemContext={context.containerContents.itemContext}\n    {inlineToggleService}\n    lockItemQuantity={context.lockItemQuantity}\n    sheetDocument={context.item}\n    unlocked={context.unlocked}\n  />\n</div>\n\n<hr class=\"golden-fade\" />\n\n<div bind:this={markerEl} class=\"contents-footer-scroll-marker\"></div>\n<footer bind:this={footerEl} class=\"contents-footer\">\n  <!-- Capacity Bar -->\n  <CapacityBar container={context.item} capacity={context.capacity} />\n  <a\n    title={localize('DND5E.ItemCreate')}\n    class=\"button icon-button attention item-create\"\n    class:disabled={!context.editable}\n    onclick={() => Container.promptCreateInventoryItem(context.item)}\n  >\n    <i class=\"fas fa-plus\"></i>\n  </a>\n</footer>\n","import { CONSTANTS } from 'src/constants';\nimport ContainerDetailsTab from 'src/sheets/quadrone/container/tabs/ContainerDetailsTab.svelte';\nimport ItemActiveEffectsTab from '../../sheets/classic/item/tabs/ItemActiveEffectsTab.svelte';\nimport ItemAdvancementTab from '../../sheets/classic/item/tabs/ItemAdvancementTab.svelte';\nimport ItemBackgroundDetailsTab from '../../sheets/classic/item/tabs/ItemBackgroundDetailsTab.svelte';\nimport ItemClassDetailsTab from '../../sheets/classic/item/tabs/ItemClassDetailsTab.svelte';\nimport ItemConsumableDetailsTab from '../../sheets/classic/item/tabs/ItemConsumableDetailsTab.svelte';\nimport ItemContainerContentsTab from '../../sheets/classic/item/tabs/ItemContainerContentsTab.svelte';\nimport ItemContainerDetailsTab from '../../sheets/classic/item/tabs/ItemContainerDetailsTab.svelte';\nimport ItemDescriptionTab from '../../sheets/classic/item/tabs/ItemDescriptionTab.svelte';\nimport ItemSpeciesDetailsTab from '../../sheets/classic/item/tabs/ItemSpeciesDetailsTab.svelte';\nimport ItemDescriptionWithSidebarTab from '../../sheets/classic/item/tabs/ItemDescriptionWithSidebarTab.svelte';\nimport QuadroneItemDescriptionsTab from '../../sheets/quadrone/item/tabs/ItemDescriptionsTab.svelte';\nimport ItemEquipmentDetailsTab from '../../sheets/classic/item/tabs/ItemEquipmentDetailsTab.svelte';\nimport ItemFeatDetailsTab from '../../sheets/classic/item/tabs/ItemFeatDetailsTab.svelte';\nimport ItemLootDetailsTab from '../../sheets/classic/item/tabs/ItemLootDetailsTab.svelte';\nimport ItemSpeciesDescriptionTab from '../../sheets/classic/item/tabs/ItemSpeciesDescriptionTab.svelte';\nimport ItemSpellDetailsTab from '../../sheets/classic/item/tabs/ItemSpellDetailsTab.svelte';\nimport ItemSubclassDetailsTab from '../../sheets/classic/item/tabs/ItemSubclassDetailsTab.svelte';\nimport ItemToolDetailsTab from '../../sheets/classic/item/tabs/ItemToolDetailsTab.svelte';\nimport ItemWeaponDetailsTab from '../../sheets/classic/item/tabs/ItemWeaponDetailsTab.svelte';\nimport ItemActivitiesTab from '../../sheets/classic/item/tabs/ItemActivitiesTab.svelte';\nimport type { Tab } from 'src/types/types';\nimport ItemFacilityDetailsTab from 'src/sheets/classic/item/tabs/ItemFacilityDetailsTab.svelte';\nimport ContainerContentsTab from 'src/sheets/quadrone/container/tabs/ContainerContentsTab.svelte';\n\nconst itemSheetTabs = {\n  /**\n   * Interface for managing activities for an item.\n   */\n  activities: {\n    id: CONSTANTS.TAB_ITEM_ACTIVITIES_ID,\n    title: 'DND5E.ACTIVITY.Title.other',\n    content: {\n      component: ItemActivitiesTab,\n      cssClass: 'activities-tab-contents',\n      type: 'svelte',\n    },\n  },\n  /**\n   * Advancement create/read/update/delete interface.\n   */\n  advancement: {\n    id: CONSTANTS.TAB_ITEM_ADVANCEMENT_ID,\n    title: 'DND5E.AdvancementTitle',\n    content: {\n      component: ItemAdvancementTab,\n      cssClass: 'detail-tab-contents items-list-container',\n      type: 'svelte',\n    },\n  },\n  /**\n   * Details form for background items.\n   */\n  backgroundDetails: {\n    id: CONSTANTS.TAB_ITEM_DETAILS_ID,\n    title: 'DND5E.Details',\n    content: {\n      component: ItemBackgroundDetailsTab,\n      cssClass: 'detail-tab-contents',\n      type: 'svelte',\n    },\n    autoHeight: true,\n  },\n  /**\n   * Details form for class items.\n   */\n  classDetails: {\n    id: CONSTANTS.TAB_ITEM_DETAILS_ID,\n    title: 'DND5E.Details',\n    content: {\n      component: ItemClassDetailsTab,\n      cssClass: 'detail-tab-contents',\n      type: 'svelte',\n    },\n    autoHeight: true,\n  },\n  /**\n   * Details form for consumable items.\n   */\n  consumableDetails: {\n    id: CONSTANTS.TAB_ITEM_DETAILS_ID,\n    title: 'DND5E.Details',\n    content: {\n      component: ItemConsumableDetailsTab,\n      cssClass: 'detail-tab-contents',\n      type: 'svelte',\n    },\n    autoHeight: true,\n  },\n  containerContents: {\n    id: CONSTANTS.TAB_CONTAINER_CONTENTS,\n    title: 'DND5E.Contents',\n    content: {\n      component: ItemContainerContentsTab,\n      cssClass: 'detail-tab-contents',\n      type: 'svelte',\n    },\n  },\n  containerDetails: {\n    id: CONSTANTS.TAB_ITEM_DETAILS_ID,\n    title: 'DND5E.Details',\n    content: {\n      component: ItemContainerDetailsTab,\n      cssClass: 'detail-tab-contents',\n      type: 'svelte',\n    },\n    autoHeight: true,\n  },\n  /**\n   * Description editor and a header for mechanics/flavor.\n   */\n  description: {\n    id: CONSTANTS.TAB_ITEM_DESCRIPTION_ID,\n    title: 'DND5E.Description',\n    content: {\n      component: ItemDescriptionTab,\n      cssClass: 'flexcol',\n      type: 'svelte',\n    },\n  },\n  /**\n   * A sidebar with item inputs and properties, and a description editor.\n   */\n  descriptionWithSidebar: {\n    id: CONSTANTS.TAB_ITEM_DESCRIPTION_ID,\n    title: 'DND5E.Description',\n    content: {\n      component: ItemDescriptionWithSidebarTab,\n      cssClass: 'flexrow',\n      type: 'svelte',\n    },\n  },\n  /**\n   * Active Effects create/read/update/delete interface.\n   */\n  effects: {\n    id: CONSTANTS.TAB_ITEM_EFFECTS_ID,\n    title: 'DND5E.Effects',\n    content: {\n      component: ItemActiveEffectsTab,\n      cssClass: 'flexcol items-list-container',\n      type: 'svelte',\n    },\n  },\n  /**\n   * Details form for equipment items.\n   */\n  equipmentDetails: {\n    id: CONSTANTS.TAB_ITEM_DETAILS_ID,\n    title: 'DND5E.Details',\n    content: {\n      component: ItemEquipmentDetailsTab,\n      cssClass: 'detail-tab-contents',\n      type: 'svelte',\n    },\n    autoHeight: true,\n  },\n  facilityDetails: {\n    id: CONSTANTS.TAB_ITEM_DETAILS_ID,\n    title: 'DND5E.Details',\n    content: {\n      component: ItemFacilityDetailsTab,\n      type: 'svelte',\n    },\n  },\n  /**\n   * Details form for feat items.\n   */\n  featDetails: {\n    id: CONSTANTS.TAB_ITEM_DETAILS_ID,\n    title: 'DND5E.Details',\n    content: {\n      component: ItemFeatDetailsTab,\n      cssClass: 'detail-tab-contents',\n      type: 'svelte',\n    },\n    autoHeight: true,\n  },\n  quadroneContainerContents: {\n    id: CONSTANTS.TAB_CONTAINER_CONTENTS,\n    title: 'DND5E.Contents',\n    content: {\n      component: ContainerContentsTab,\n      type: 'svelte',\n    },\n  },\n  /**\n   * Details form for containers.\n   */\n  quadroneContainerDetails: {\n    id: CONSTANTS.TAB_ITEM_DETAILS_ID,\n    title: 'DND5E.Details',\n    content: {\n      component: ContainerDetailsTab,\n      type: 'svelte',\n    },\n  },\n  /**\n   * Three-descriptions interface for items\n   */\n  quadroneDescription: {\n    id: CONSTANTS.TAB_ITEM_DESCRIPTION_ID,\n    title: 'DND5E.Description',\n    content: {\n      component: QuadroneItemDescriptionsTab,\n      type: 'svelte',\n    },\n  },\n  /**\n   * Details form for loot.\n   */\n  lootDetails: {\n    id: CONSTANTS.TAB_ITEM_DETAILS_ID,\n    title: 'DND5E.Details',\n    content: {\n      component: ItemLootDetailsTab,\n      cssClass: 'detail-tab-contents',\n      type: 'svelte',\n    },\n    autoHeight: true,\n  },\n  /**\n   * A sidebar with species properties and configuration buttons, and a description editor.\n   */\n  speciesDescription: {\n    id: CONSTANTS.TAB_ITEM_DESCRIPTION_ID,\n    title: 'DND5E.Description',\n    content: {\n      component: ItemSpeciesDescriptionTab,\n      cssClass: 'flexrow',\n      type: 'svelte',\n    },\n  },\n  /**\n   * Details form for species items.\n   */\n  speciesDetails: {\n    id: CONSTANTS.TAB_ITEM_DETAILS_ID,\n    title: 'DND5E.Details',\n    content: {\n      component: ItemSpeciesDetailsTab,\n      cssClass: 'detail-tab-contents',\n      type: 'svelte',\n    },\n  },\n  /**\n   * Details form for spell items.\n   */\n  spellDetails: {\n    id: CONSTANTS.TAB_ITEM_DETAILS_ID,\n    title: 'DND5E.Details',\n    content: {\n      component: ItemSpellDetailsTab,\n      cssClass: 'detail-tab-contents',\n      type: 'svelte',\n    },\n    autoHeight: true,\n  },\n  /**\n   * Details form for subclass items.\n   */\n  subclassDetails: {\n    id: CONSTANTS.TAB_ITEM_DETAILS_ID,\n    title: 'DND5E.Details',\n    content: {\n      component: ItemSubclassDetailsTab,\n      cssClass: 'detail-tab-contents',\n      type: 'svelte',\n    },\n    autoHeight: true,\n  },\n  /**\n   * Details form for tool items.\n   */\n  toolDetails: {\n    id: CONSTANTS.TAB_ITEM_DETAILS_ID,\n    title: 'DND5E.Details',\n    content: {\n      component: ItemToolDetailsTab,\n      cssClass: 'detail-tab-contents',\n      type: 'svelte',\n    },\n    autoHeight: true,\n  },\n  /**\n   * Details form for weapon items.\n   */\n  weaponDetails: {\n    id: CONSTANTS.TAB_ITEM_DETAILS_ID,\n    title: 'DND5E.Details',\n    content: {\n      component: ItemWeaponDetailsTab,\n      cssClass: 'detail-tab-contents',\n      type: 'svelte',\n    },\n    autoHeight: true,\n  },\n} satisfies Record<string, Tab>;\n\nexport default itemSheetTabs;\n","<script lang=\"ts\">\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import ItemProfilePicture from './parts/ItemProfilePicture.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import Source from '../shared/Source.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  interface Props {\n    selectedTabId?: string;\n  }\n\n  let { selectedTabId = $bindable('description') }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<header class=\"sheet-header flexrow gap\">\n  <ItemProfilePicture />\n  <div\n    class=\"header-details flexrow small-gap\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n  >\n    <h1\n      class=\"charname\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n    >\n      <TextInput\n        id=\"{appId}-name\"\n        field=\"name\"\n        document={context.item}\n        value={context.item.name}\n        attributes={{ 'data-tidy-item-name': context.item.name }}\n        placeholder={localize('DND5E.BackgroundName')}\n        disabled={!context.editable}\n        title={context.item.name}\n      />\n    </h1>\n\n    <div class=\"item-subtitle\">\n      <h4 class=\"item-type\">{context.itemType ?? ''}</h4>\n      <span class=\"item-status\">{context.itemStatus ?? ''}</span>\n    </div>\n\n    <ul class=\"summary flexrow\">\n      <li class=\"flex-row\">\n        <Source\n          document={context.item}\n          keyPath=\"system.source\"\n          editable={context.editable}\n        />\n      </li>\n    </ul>\n  </div>\n</header>\n<Tabs bind:selectedTabId tabs={context.tabs} sheet={context.item.sheet} />\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n","<script lang=\"ts\">\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemProfilePicture from './parts/ItemProfilePicture.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import Source from '../shared/Source.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  let selectedTabId: string = $state('');\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<header class=\"sheet-header flexrow gap\">\n  <ItemProfilePicture />\n  <div\n    class=\"header-details flexrow small-gap\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n  >\n    <h1\n      class=\"charname\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n    >\n      <TextInput\n        id=\"{appId}-name\"\n        field=\"name\"\n        document={context.item}\n        value={context.item.name}\n        attributes={{ 'data-tidy-item-name': context.item.name }}\n        placeholder={localize('DND5E.ClassName')}\n        disabled={!context.editable}\n        title={context.item.name}\n      />\n    </h1>\n\n    <div class=\"item-subtitle\">\n      <h4 class=\"item-type\">{context.itemType ?? ''}</h4>\n      <span class=\"item-status\">{context.itemStatus ?? ''}</span>\n    </div>\n\n    <ul class=\"summary flexrow\">\n      <li class=\"flex-row\">\n        <Source\n          document={context.item}\n          keyPath=\"system.source\"\n          editable={context.editable}\n        />\n      </li>\n    </ul>\n  </div>\n</header>\n<Tabs bind:selectedTabId tabs={context.tabs} sheet={context.item.sheet} />\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n","<script lang=\"ts\">\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemProfilePicture from './parts/ItemProfilePicture.svelte';\n  import Select from 'src/components/inputs/Select.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import Source from '../shared/Source.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import ItemIdentifiableName from './parts/ItemIdentifiableName.svelte';\n  import ItemHeaderToggles from './parts/ItemHeaderToggles.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  let selectedTabId: string = $state('');\n  const localize = FoundryAdapter.localize;\n</script>\n\n<header class=\"sheet-header flexrow gap\">\n  <ItemProfilePicture />\n\n  <div\n    class=\"header-details flexrow small-gap\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n  >\n    <h1\n      class=\"charname\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n    >\n      <ItemIdentifiableName />\n    </h1>\n\n    <div class=\"item-subtitle\">\n      <h4 class=\"item-type\">{context.itemType ?? ''}</h4>\n      {#if context.itemStatus && context.itemStatus !== context.itemType}\n        <span class=\"item-status\">{context.itemStatus ?? ''}</span>\n      {/if}\n    </div>\n\n    <ul class=\"summary flexrow\">\n      <li>{context.itemType}</li>\n      <li>\n        {#if context.concealDetails}\n          <span>{localize('DND5E.Unidentified.Title')}</span>\n        {:else}\n          <Select\n            id=\"{appId}-rarity\"\n            document={context.item}\n            field=\"system.rarity\"\n            class=\"item-rarity\"\n            value={context.system.rarity}\n            disabled={!context.editable}\n            blankValue=\"\"\n          >\n            <SelectOptions\n              data={context.config.itemRarity}\n              blank={localize('DND5E.Rarity')}\n            />\n          </Select>\n        {/if}\n      </li>\n      <li class=\"flex-row\">\n        <Source\n          document={context.item}\n          keyPath=\"system.source\"\n          editable={context.editable && !context.concealDetails}\n        />\n      </li>\n    </ul>\n    <ItemHeaderToggles />\n  </div>\n</header>\n<Tabs bind:selectedTabId tabs={context.tabs} sheet={context.item.sheet} />\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import ItemProfilePicture from './parts/ItemProfilePicture.svelte';\n  import ItemIdentifiableName from './parts/ItemIdentifiableName.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import Select from 'src/components/inputs/Select.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import Source from '../shared/Source.svelte';\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import ItemHeaderToggles from './parts/ItemHeaderToggles.svelte';\n  import { getContainerSheetClassicContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getContainerSheetClassicContext());\n\n  let appId = $derived(context.document.id);\n\n  let selectedTabId: string = $state('');\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<header class=\"sheet-header container-header flexrow gap\">\n  <ItemProfilePicture />\n\n  <div\n    class=\"header-details flexrow small-gap\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n  >\n    <h1\n      class=\"charname\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n    >\n      <ItemIdentifiableName />\n    </h1>\n\n    <div class=\"item-subtitle\">\n      <h4 class=\"item-type\">{context.itemType ?? ''}</h4>\n    </div>\n\n    <ul class=\"summary flexrow\">\n      <li>\n        {#if context.concealDetails}\n          <span>{localize('DND5E.Unidentified.Title')}</span>\n        {:else}\n          <Select\n            id=\"{appId}-rarity\"\n            document={context.item}\n            field=\"system.rarity\"\n            class=\"item-rarity\"\n            value={context.system.rarity}\n            disabled={!context.editable}\n            blankValue=\"\"\n          >\n            <SelectOptions\n              data={context.config.itemRarity}\n              blank={localize('DND5E.Rarity')}\n            />\n          </Select>\n        {/if}\n      </li>\n      <li class=\"flex-row\">\n        <Source\n          document={context.item}\n          keyPath=\"system.source\"\n          editable={context.editable && !context.concealDetails}\n        />\n      </li>\n    </ul>\n    <ItemHeaderToggles />\n  </div>\n</header>\n\n<Tabs bind:selectedTabId tabs={context.tabs} sheet={context.item.sheet} />\n\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n\n<style lang=\"scss\">\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import ItemProfilePicture from './parts/ItemProfilePicture.svelte';\n  import Source from '../shared/Source.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  let selectedTabId: string = $state('');\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<header class=\"sheet-header flexrow gap\">\n  <ItemProfilePicture />\n  <div\n    class=\"header-details flexrow small-gap\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n  >\n    <h1\n      class=\"charname\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n    >\n      <TextInput\n        id=\"{appId}-name\"\n        field=\"name\"\n        document={context.item}\n        value={context.item.name}\n        attributes={{ 'data-tidy-item-name': context.item.name }}\n        disabled={!context.editable}\n        title={context.item.name}\n      />\n    </h1>\n\n    <div class=\"item-subtitle\">\n      <h4 class=\"item-type\">{context.itemType ?? ''}</h4>\n    </div>\n\n    <ul class=\"summary flexrow\">\n      <li class=\"flex-row\">\n        <div class=\"quantity\">\n          <span class=\"value\">\n            {localize('DND5E.FACILITY.Squares', {\n              squares: context.system.squares,\n            })}\n          </span>\n        </div>\n      </li>\n      {#if context.system.type.value === CONSTANTS.FACILITY_TYPE_BASIC}\n        <li>\n          <div class=\"price\">\n            <span class=\"value\">{context.system.price.value}</span>\n            <i\n              class=\"currency gp\"\n              aria-label={context.config.currencies.gp.label}\n            ></i>\n          </div>\n        </li>\n      {/if}\n      <li class=\"flex-row\">\n        <Source\n          document={context.item}\n          keyPath=\"system.source\"\n          editable={context.editable}\n        />\n      </li>\n    </ul>\n  </div>\n</header>\n<Tabs bind:selectedTabId tabs={context.tabs} sheet={context.item.sheet} />\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import ItemProfilePicture from './parts/ItemProfilePicture.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import Source from '../shared/Source.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  let selectedTabId: string = $state('');\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<header class=\"sheet-header flexrow gap\">\n  <ItemProfilePicture />\n\n  <div\n    class=\"header-details flexrow small-gap\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n  >\n    <h1\n      class=\"charname\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n    >\n      <TextInput\n        id=\"{appId}-name\"\n        document={context.item}\n        field=\"name\"\n        placeholder={localize('DND5E.ItemName')}\n        value={context.item.name}\n        attributes={{ 'data-tidy-item-name': context.item.name }}\n        disabled={!context.editable}\n        title={context.item.name}\n      />\n    </h1>\n\n    <div class=\"item-subtitle\">\n      <h4 class=\"item-type\">{context.itemType ?? ''}</h4>\n      <span class=\"item-status\">{context.itemStatus ?? ''}</span>\n    </div>\n\n    <ul class=\"summary flexrow\">\n      <li>\n        {context.labels.featType ?? ''}\n      </li>\n      <li>\n        <TextInput\n          id=\"{appId}-name\"\n          document={context.item}\n          field=\"system.requirements\"\n          value={context.system.requirements}\n          placeholder={localize('DND5E.Requirements')}\n          disabled={!context.editable}\n        />\n      </li>\n      <li class=\"flex-row\">\n        <Source\n          document={context.item}\n          keyPath=\"system.source\"\n          editable={context.editable}\n        />\n      </li>\n    </ul>\n  </div>\n</header>\n<Tabs bind:selectedTabId tabs={context.tabs} sheet={context.item.sheet} />\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n","<script lang=\"ts\">\n  import ItemProfilePicture from './parts/ItemProfilePicture.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import Select from 'src/components/inputs/Select.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import Source from '../shared/Source.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import ItemIdentifiableName from './parts/ItemIdentifiableName.svelte';\n  import PropertyToggle from 'src/components/toggles/PropertyToggle.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let selectedTabId: string = $state('');\n\n  const localize = FoundryAdapter.localize;\n  let appId = $derived(context.document.id);\n  let identifiedLabelWidthCh = $derived(\n    Math.max(\n      localize('DND5E.Identified').length,\n      localize('DND5E.Unidentified.Title').length,\n    ),\n  );\n</script>\n\n<header class=\"sheet-header loot-header flexrow gap\">\n  <ItemProfilePicture />\n  <div\n    class=\"header-details flexrow small-gap\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n  >\n    <h1\n      class=\"charname\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n    >\n      <ItemIdentifiableName />\n    </h1>\n\n    <div class=\"item-subtitle\">\n      <h4 class=\"item-type\">{context.itemType ?? ''}</h4>\n      <span class=\"item-status\">{context.itemStatus ?? ''}</span>\n    </div>\n\n    <ul class=\"summary flexrow\">\n      <li>\n        {#if context.concealDetails}\n          <span>{localize('DND5E.Unidentified.Title')}</span>\n        {:else}\n          <Select\n            id=\"{appId}-rarity\"\n            document={context.item}\n            field=\"system.rarity\"\n            class=\"item-rarity\"\n            value={context.system.rarity}\n            disabled={!context.editable}\n            blankValue=\"\"\n          >\n            <SelectOptions\n              data={context.config.itemRarity}\n              blank={localize('DND5E.Rarity')}\n            />\n          </Select>\n        {/if}\n      </li>\n      <li class=\"flex-row\">\n        <Source\n          document={context.item}\n          keyPath=\"system.source\"\n          editable={context.editable && !context.concealDetails}\n        />\n      </li>\n    </ul>\n    <div class=\"flex-row no-gap\">\n      {#if FoundryAdapter.canIdentify(context.item)}\n        <PropertyToggle\n          document={context.item}\n          field=\"system.identified\"\n          checked={context.system.identified}\n          disabled={!context.editable}\n          title={context.system.identified\n            ? localize('DND5E.Identified')\n            : localize('DND5E.Unidentified.Title')}\n          iconClass=\"fas fa-magnifying-glass fa-fw\"\n        >\n          <div style=\"width: {identifiedLabelWidthCh}ch\">\n            {context.system.identified\n              ? localize('DND5E.Identified')\n              : localize('DND5E.Unidentified.Title')}\n          </div>\n        </PropertyToggle>\n      {/if}\n    </div>\n  </div>\n</header>\n<Tabs bind:selectedTabId tabs={context.tabs} sheet={context.item.sheet} />\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n","<script lang=\"ts\">\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemProfilePicture from './parts/ItemProfilePicture.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import Source from '../shared/Source.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  let selectedTabId: string = $state('');\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<header class=\"sheet-header flexrow gap\">\n  <ItemProfilePicture />\n\n  <div\n    class=\"header-details flexrow small-gap\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n  >\n    <h1\n      class=\"charname\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n    >\n      <TextInput\n        id=\"{appId}-name\"\n        document={context.item}\n        field=\"name\"\n        value={context.item.name}\n        attributes={{ 'data-tidy-item-name': context.item.name }}\n        placeholder={localize('DND5E.SpellName')}\n        disabled={!context.editable}\n        title={context.item.name}\n      />\n    </h1>\n\n    <div class=\"item-subtitle\">\n      <h4 class=\"item-type\">{context.itemType ?? ''}</h4>\n      <span class=\"item-status\">{context.itemStatus ?? ''}</span>\n    </div>\n\n    <ul class=\"summary flexrow\">\n      <li>{context.labels.level ?? ''}</li>\n      <li>{context.labels.school ?? ''}</li>\n      <li class=\"flex-row\">\n        <Source\n          document={context.item}\n          keyPath=\"system.source\"\n          editable={context.editable}\n        />\n      </li>\n    </ul>\n    <span class=\"spell-classes\">{context.labels?.classes ?? ''}</span>\n  </div>\n</header>\n<Tabs bind:selectedTabId tabs={context.tabs} sheet={context.item.sheet} />\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import ItemProfilePicture from './parts/ItemProfilePicture.svelte';\n  import Source from '../shared/Source.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  let selectedTabId: string = $state('');\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<header class=\"sheet-header flexrow gap\">\n  <ItemProfilePicture />\n  <div\n    class=\"header-details flexrow small-gap\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n  >\n    <h1\n      class=\"charname\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n    >\n      <TextInput\n        id=\"{appId}-name\"\n        field=\"name\"\n        document={context.item}\n        value={context.item.name}\n        attributes={{ 'data-tidy-item-name': context.item.name }}\n        placeholder={localize('DND5E.SubclassName')}\n        disabled={!context.editable}\n        title={context.item.name}\n      />\n    </h1>\n\n    <div class=\"item-subtitle\">\n      <h4 class=\"item-type\">{context.itemType ?? ''}</h4>\n      <span class=\"item-status\">{context.itemStatus ?? ''}</span>\n    </div>\n\n    <ul class=\"summary flexrow\">\n      <li class=\"flex-row\">\n        <Source\n          document={context.item}\n          keyPath=\"system.source\"\n          editable={context.editable}\n        />\n      </li>\n    </ul>\n  </div>\n</header>\n<Tabs bind:selectedTabId tabs={context.tabs} sheet={context.item.sheet} />\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n","<script lang=\"ts\">\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemProfilePicture from './parts/ItemProfilePicture.svelte';\n  import Select from 'src/components/inputs/Select.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import Source from '../shared/Source.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import ItemIdentifiableName from './parts/ItemIdentifiableName.svelte';\n  import ItemHeaderToggles from './parts/ItemHeaderToggles.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  let selectedTabId: string = $state('');\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<header class=\"sheet-header flexrow gap\">\n  <ItemProfilePicture />\n\n  <div\n    class=\"header-details flexrow small-gap\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n  >\n    <h1\n      class=\"charname\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n    >\n      <ItemIdentifiableName />\n    </h1>\n\n    <div class=\"item-subtitle\">\n      <h4 class=\"item-type\">{context.itemType ?? ''}</h4>\n    </div>\n\n    <ul class=\"summary flexrow\">\n      <li>\n        {context.system.type.label}\n      </li>\n      <li>\n        {#if context.concealDetails}\n          <span>{localize('DND5E.Unidentified.Title')}</span>\n        {:else}\n          <Select\n            id=\"{appId}-rarity\"\n            document={context.item}\n            field=\"system.rarity\"\n            class=\"item-rarity\"\n            value={context.system.rarity}\n            disabled={!context.editable}\n            blankValue=\"\"\n          >\n            <SelectOptions\n              data={context.config.itemRarity}\n              blank={localize('DND5E.Rarity')}\n            />\n          </Select>\n        {/if}\n      </li>\n      <li class=\"flex-row\">\n        <Source\n          document={context.item}\n          keyPath=\"system.source\"\n          editable={context.editable && !context.concealDetails}\n        />\n      </li>\n    </ul>\n    <ItemHeaderToggles />\n  </div>\n</header>\n<Tabs bind:selectedTabId tabs={context.tabs} sheet={context.item.sheet} />\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n","<script lang=\"ts\">\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemProfilePicture from './parts/ItemProfilePicture.svelte';\n  import Select from 'src/components/inputs/Select.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import Source from '../shared/Source.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import ItemIdentifiableName from './parts/ItemIdentifiableName.svelte';\n  import ItemHeaderToggles from './parts/ItemHeaderToggles.svelte';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  let selectedTabId: string = $state('');\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<header class=\"sheet-header flexrow gap\">\n  <ItemProfilePicture />\n\n  <div\n    class=\"header-details flexrow small-gap\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n  >\n    <h1\n      class=\"charname\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n    >\n      <ItemIdentifiableName />\n    </h1>\n\n    <div class=\"item-subtitle\">\n      <h4 class=\"item-type\">{context.itemType ?? ''}</h4>\n    </div>\n\n    <ul class=\"summary flexrow\">\n      <li>{context.system.type.label}</li>\n      <li>\n        {#if context.concealDetails}\n          <span>{localize('DND5E.Unidentified.Title')}</span>\n        {:else}\n          <Select\n            id=\"{appId}-rarity\"\n            document={context.item}\n            field=\"system.rarity\"\n            class=\"item-rarity\"\n            value={context.system.rarity}\n            disabled={!context.editable}\n            blankValue=\"\"\n          >\n            <SelectOptions\n              data={context.config.itemRarity}\n              blank={localize('DND5E.Rarity')}\n            />\n          </Select>\n        {/if}\n      </li>\n      <li class=\"flex-row\">\n        <Source\n          document={context.item}\n          keyPath=\"system.source\"\n          editable={context.editable && !context.concealDetails}\n        />\n      </li>\n    </ul>\n    <ItemHeaderToggles />\n  </div>\n</header>\n<Tabs bind:selectedTabId tabs={context.tabs} sheet={context.item.sheet} />\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n","<script lang=\"ts\">\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemProfilePicture from './parts/ItemProfilePicture.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import Source from '../shared/Source.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n\n  let appId = $derived(context.document.id);\n\n  let selectedTabId: string = $state('');\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<header class=\"sheet-header flexrow gap\">\n  <ItemProfilePicture />\n  <div\n    class=\"header-details flexrow small-gap\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n  >\n    <h1\n      class=\"charname\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n    >\n      <TextInput\n        id=\"{appId}-name\"\n        field=\"name\"\n        document={context.item}\n        value={context.item.name}\n        attributes={{ 'data-tidy-item-name': context.item.name }}\n        placeholder={localize('DND5E.ClassName')}\n        disabled={!context.editable}\n        title={context.item.name}\n      />\n    </h1>\n\n    <div class=\"item-subtitle\">\n      <h4 class=\"item-type\">{context.itemType ?? ''}</h4>\n      <span class=\"item-status\">{context.itemStatus ?? ''}</span>\n    </div>\n\n    <ul class=\"summary flexrow\">\n      <li class=\"flex-row\">\n        <Source\n          document={context.item}\n          keyPath=\"system.source\"\n          editable={context.editable}\n        />\n      </li>\n    </ul>\n  </div>\n</header>\n<Tabs bind:selectedTabId tabs={context.tabs} sheet={context.item.sheet} />\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n","import { CONSTANTS } from 'src/constants';\nimport EquipmentSheet from 'src/sheets/classic/item/EquipmentSheet.svelte';\nimport type { CustomContent, Tab } from 'src/types/types';\nimport itemSheetTabs from './item-sheet-tabs';\nimport BackgroundSheet from 'src/sheets/classic/item/BackgroundSheet.svelte';\nimport ClassSheet from 'src/sheets/classic/item/ClassSheet.svelte';\nimport ConsumableSheet from 'src/sheets/classic/item/ConsumableSheet.svelte';\nimport ContainerSheet from 'src/sheets/classic/item/ContainerSheet.svelte';\nimport FacilitySheet from 'src/sheets/classic/item/FacilitySheet.svelte';\nimport FeatSheet from 'src/sheets/classic/item/FeatSheet.svelte';\nimport LootSheet from 'src/sheets/classic/item/LootSheet.svelte';\nimport SpellSheet from 'src/sheets/classic/item/SpellSheet.svelte';\nimport SubclassSheet from 'src/sheets/classic/item/SubclassSheet.svelte';\nimport ToolSheet from 'src/sheets/classic/item/ToolSheet.svelte';\nimport WeaponSheet from 'src/sheets/classic/item/WeaponSheet.svelte';\nimport SpeciesSheet from 'src/sheets/classic/item/SpeciesSheet.svelte';\nimport type { RegisteredContent, RegisteredTab } from '../types';\nimport type {\n  ContainerSheetClassicContext,\n  ContainerSheetQuadroneContext,\n  ItemSheetContext,\n} from 'src/types/item.types';\nimport { CustomContentManager } from '../content/CustomContentManager';\nimport type { RegisteredEquipmentTypeGroup } from './item.types';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { debug, error } from 'src/utils/logging';\nimport type { Component } from 'svelte';\n\nexport class ItemSheetRuntime {\n  private static _content: RegisteredContent<ItemSheetContext>[] = [];\n  private static _customTabs: RegisteredTab<ItemSheetContext>[] = [];\n  private static _customItemEquipmentTypeGroups: RegisteredEquipmentTypeGroup[] =\n    [];\n\n  static async getContent(\n    context:\n      | ItemSheetContext\n      | ContainerSheetClassicContext\n      | ContainerSheetQuadroneContext\n  ): Promise<CustomContent[]> {\n    return await CustomContentManager.prepareContentForRender(\n      context,\n      ItemSheetRuntime._content\n    );\n  }\n\n  static registerContent(\n    registeredContent: RegisteredContent<ItemSheetContext>\n  ) {\n    this._content.push(registeredContent);\n  }\n\n  static registerTab(tab: RegisteredTab<ItemSheetContext>) {\n    ItemSheetRuntime._customTabs.push(tab);\n  }\n\n  static getCustomItemTabs(context: any) {\n    return ItemSheetRuntime._customTabs.filter(\n      (s) => s.enabled === undefined || s.enabled(context)\n    );\n  }\n\n  static sheets: Record<string, ItemSheetInfo> = {\n    [CONSTANTS.ITEM_TYPE_BACKGROUND]: {\n      Sheet: BackgroundSheet,\n      defaultTabs: () => [\n        itemSheetTabs.description,\n        itemSheetTabs.backgroundDetails,\n        itemSheetTabs.advancement,\n      ],\n    },\n    [CONSTANTS.ITEM_TYPE_CLASS]: {\n      Sheet: ClassSheet,\n      defaultTabs: () => [\n        itemSheetTabs.description,\n        itemSheetTabs.classDetails,\n        itemSheetTabs.advancement,\n      ],\n    },\n    [CONSTANTS.ITEM_TYPE_CONSUMABLE]: {\n      Sheet: ConsumableSheet,\n      defaultTabs: () => [\n        itemSheetTabs.descriptionWithSidebar,\n        itemSheetTabs.consumableDetails,\n        itemSheetTabs.activities,\n        itemSheetTabs.effects,\n      ],\n    },\n    [CONSTANTS.ITEM_TYPE_CONTAINER]: {\n      Sheet: ContainerSheet,\n      defaultTabs: () => [\n        itemSheetTabs.containerContents,\n        itemSheetTabs.descriptionWithSidebar,\n        itemSheetTabs.containerDetails,\n      ],\n      tempQuadroneTabs: () => [\n        itemSheetTabs.quadroneContainerContents,\n        itemSheetTabs.quadroneDescription,\n        // TODO: Only show to GMs and users when identified\n        itemSheetTabs.quadroneContainerDetails,\n      ],\n    },\n    [CONSTANTS.ITEM_TYPE_EQUIPMENT]: {\n      Sheet: EquipmentSheet,\n      defaultTabs: () => [\n        itemSheetTabs.descriptionWithSidebar,\n        itemSheetTabs.equipmentDetails,\n        itemSheetTabs.activities,\n        itemSheetTabs.effects,\n      ],\n    },\n    [CONSTANTS.ITEM_TYPE_FACILITY]: {\n      Sheet: FacilitySheet,\n      defaultTabs: () => [\n        itemSheetTabs.description,\n        itemSheetTabs.facilityDetails,\n        itemSheetTabs.activities,\n      ],\n    },\n    [CONSTANTS.ITEM_TYPE_FEAT]: {\n      Sheet: FeatSheet,\n      defaultTabs: () => [\n        itemSheetTabs.descriptionWithSidebar,\n        itemSheetTabs.featDetails,\n        itemSheetTabs.activities,\n        itemSheetTabs.effects,\n        itemSheetTabs.advancement\n      ],\n    },\n    [CONSTANTS.ITEM_TYPE_LOOT]: {\n      Sheet: LootSheet,\n      defaultTabs: () => [\n        itemSheetTabs.descriptionWithSidebar,\n        itemSheetTabs.lootDetails,\n      ],\n    },\n    [CONSTANTS.ITEM_TYPE_SPELL]: {\n      Sheet: SpellSheet,\n      defaultTabs: () => [\n        itemSheetTabs.descriptionWithSidebar,\n        itemSheetTabs.spellDetails,\n        itemSheetTabs.activities,\n        itemSheetTabs.effects,\n      ],\n    },\n    [CONSTANTS.ITEM_TYPE_SUBCLASS]: {\n      Sheet: SubclassSheet,\n      defaultTabs: () => [\n        itemSheetTabs.description,\n        itemSheetTabs.subclassDetails,\n        itemSheetTabs.advancement,\n      ],\n    },\n    [CONSTANTS.ITEM_TYPE_TOOL]: {\n      Sheet: ToolSheet,\n      defaultTabs: () => [\n        itemSheetTabs.descriptionWithSidebar,\n        itemSheetTabs.toolDetails,\n        itemSheetTabs.activities,\n        itemSheetTabs.effects,\n      ],\n    },\n    [CONSTANTS.ITEM_TYPE_WEAPON]: {\n      Sheet: WeaponSheet,\n      defaultTabs: () => [\n        itemSheetTabs.descriptionWithSidebar,\n        itemSheetTabs.weaponDetails,\n        itemSheetTabs.activities,\n        itemSheetTabs.effects,\n      ],\n    },\n    [CONSTANTS.ITEM_TYPE_RACE]: {\n      Sheet: SpeciesSheet,\n      defaultTabs: () => [\n        itemSheetTabs.speciesDescription,\n        itemSheetTabs.speciesDetails,\n        itemSheetTabs.advancement,\n      ],\n    },\n  };\n\n  static registerCustomEquipmentTypeGroup(group: RegisteredEquipmentTypeGroup) {\n    this._customItemEquipmentTypeGroups.push(group);\n  }\n\n  static getCustomEquipmentTypeGroups() {\n    return [...this._customItemEquipmentTypeGroups];\n  }\n\n  static getTabTitle(tabId: string) {\n    try {\n      let tabs = [...this._customTabs, ...Object.values(itemSheetTabs)];\n      let tabTitle = tabs.find((t) => t.id === tabId)?.title;\n      if (typeof tabTitle === 'function') {\n        tabTitle = tabTitle();\n      }\n      return tabTitle ? FoundryAdapter.localize(tabTitle) : tabId;\n    } catch (e) {\n      error('An error occurred while searching for a tab title.', false, e);\n      debug('Tab title error troubleshooting information', { tabId });\n    }\n  }\n}\n\ntype ItemSheetInfo = {\n  Sheet: Component;\n  defaultTabs(): Tab[];\n  // TODO: Remove after replacing item sheets\n  tempQuadroneTabs?: () => Tab[];\n};\n","import type { EquipmentTypeGroup } from 'src/api/api.types';\nimport { ItemSheetRuntime } from 'src/runtime/item/ItemSheetRuntime';\n\n/**\n * APIs related to the configuration of items.\n */\nexport class ItemConfigApi {\n  /**\n   * Registers a custom group of equipment types, to be rendered on the item sheet as their own section of options within the Equipment Type input.\n   *\n   * @param group the group to add\n   *\n   * @example Registering custom helmets\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.config.item.registerCustomEquipmentTypeGroup({\n   *     label: 'Helmet',\n   *     types: {\n   *       clothhat: 'Clothings Helmet',\n   *       lighthat: 'Light Helmet',\n   *       mediumhat: 'Medium Helmet',\n   *       heavyhat: 'Heavy Helmet',\n   *     },\n   *   });\n   * });\n   * ```\n   */\n  registerCustomEquipmentTypeGroup(group: EquipmentTypeGroup) {\n    ItemSheetRuntime.registerCustomEquipmentTypeGroup(group);\n  }\n}\n","import { ActorItemApi } from './actor-item/ActorItemApi';\nimport { ActorPortraitApi } from './actor-portrait/ActorPortraitApi';\nimport { ActionListApi } from './action-list/ActionListApi';\nimport { SpellSchoolApi } from './spell-school/SpellSchoolApi';\nimport { ItemSummaryApi } from './item-summary/ItemSummaryApi';\nimport { ExhaustionApi } from './exhaustion/ExhaustionApi.svelte';\nimport { ActorTraitsApi } from './actor-traits/ActorTraitsApi';\nimport { ItemConfigApi } from './item/ItemConfigApi';\n\n/**\n * Provides extensibility APIs for customizing various aspects of Tidy 5e Sheets.\n *\n * @category Configuration\n */\nexport class ConfigApi {\n  /** {@inheritDoc ActionListApi} */\n  actionList = new ActionListApi();\n\n  /** {@inheritDoc ActorItemApi} */\n  actorItem = new ActorItemApi();\n\n  /** {@inheritDoc ActorPortraitApi} */\n  actorPortrait = new ActorPortraitApi();\n\n  /** {@inheritDoc ActorTraitsApi} */\n  actorTraits = new ActorTraitsApi();\n  \n  /** {@inheritDoc ExhaustionApi} */\n  exhaustion = new ExhaustionApi();\n  \n  /** {@inheritDoc ItemConfigApi} */\n  item = new ItemConfigApi();\n\n  /** {@inheritDoc ItemSummaryApi} */\n  itemSummary = new ItemSummaryApi();\n\n  /**{@inheritDoc SpellSchoolApi} */\n  spellSchool = new SpellSchoolApi();\n}\n","import { warn } from 'src/utils/logging';\nimport type {\n  CustomContentInjectParams,\n  OnContentReadyParams,\n  OnRenderParams,\n  RenderScheme,\n} from '../api.types';\nimport { CustomContentBase } from './CustomContentBase';\n\n/** @category Content */\nexport class HtmlContent extends CustomContentBase {\n  injectParams?: CustomContentInjectParams | undefined;\n  /**\n   * The HTML to be injected into the sheet.\n   */\n  html: string | ((data: any) => string) = '';\n  renderScheme: RenderScheme = 'handlebars';\n  \n  private _activateDefaultSheetListeners?: boolean | undefined = false;\n  public get activateDefaultSheetListeners(): boolean | undefined {\n    return this._activateDefaultSheetListeners;\n  }\n  public set activateDefaultSheetListeners(value: boolean | undefined) {\n    warn(\n      'Tidy is moving to Application V2, and there will no longer be any default sheet listeners. Be sure to provide your own event handling for the content that is injected.'\n    );\n    this._activateDefaultSheetListeners = value;\n  }\n\n  constructor(props?: Partial<HtmlContent>) {\n    super();\n\n    const merged = foundry.utils.mergeObject(this, props);\n    Object.assign(this, merged);\n  }\n\n  onContentReady?: (params: OnContentReadyParams) => void;\n\n  enabled?: (context: any) => boolean;\n\n  onRender?: (params: OnRenderParams) => void;\n}\n","import type { OnRenderTabParams } from 'src/types/types';\nimport type { RenderScheme } from '../api.types';\n\n/**\n * The required static ID associated with a tab.\n *\n * @remarks\n * A `tabId` is a unique string of text that identifies your tab.\n * It needs to be in a format that can be put into an HTML attribute.\n * The tab ID is always required to register a tab.\n *\n * A `tabId` must be unique to the target sheet. For example,\n * the character sheet can only have one \"my-module-id-my-spellbook-tab\" ID,\n * and the NPC sheet can also only have one \"my-module-id-my-spellbook-tab\" ID, etc.\n *\n * Advice for crafting a unique tab ID:\n * - for modules, use your module ID as a prefix (e.g., \"my-module-id\")\n *   - for world scripts, use your game world name (e.g., \"my-game-world\")\n * - add a hyphenated version of the tab title (e.g., for a tab titled \"My Spellbook Tab\", use \"my-spellbook-tab\")\n * - join these two pieces together with a hyphen:\n * ```\n * \"my-module-id-my-spellbook-tab\"\n * ```\n *\n * @category Tabs\n */\nexport type TabId = string;\n\n/** @category Tabs */\nexport type CustomTabTitle = string | (() => string);\n\n/**\n * The basis of all custom registered tabs.\n */\n/** @category Tabs */\nexport abstract class CustomTabBase {\n  /**\n   * The title to display on the tab. Accepts localization keys and plain text.\n   */\n  abstract title: CustomTabTitle;\n\n  /** {@inheritDoc TabId} */\n  abstract tabId: TabId;\n\n  /**\n   * Optionally determines whether to refresh content each time an application render occurs.\n   *\n   * For svelte-based content, the default is \"force\". For HTML and Handlebars content, the default is \"handlebars\".\n   */\n  abstract renderScheme?: RenderScheme;\n\n  /**\n   * Optional function to determine whether the tab should be visible when viewing the sheet. When excluded, it defaults to `true`.\n   */\n  abstract enabled?: (context: any) => boolean;\n\n  /**\n   * Optional function which is called each time a change detection cycle occurs on the sheet. This is any time a FormApplication would normally call `render()`.\n   */\n  abstract onRender?: (params: OnRenderTabParams) => void;\n\n  /**\n   * An optional array of CSS classes to apply to the tab contents container.\n   */\n  abstract tabContentsClasses?: string[];\n\n  /**\n   * An optional override to whether the target tab should use default sheet event listeners.\n   * Defaults to `false`.\n   *\n   * @deprecated Tidy is moving to Application V2, and there will no longer be any default sheet listeners. Be sure to provide your own event handling for the content that is injected.\n   */\n  abstract activateDefaultSheetListeners?: boolean;\n}\n","import type { OnRenderTabParams } from 'src/types/types';\nimport type { RenderScheme } from '../api.types';\nimport {\n  CustomTabBase,\n  type CustomTabTitle,\n  type TabId,\n} from './CustomTabBase';\nimport { warn } from 'src/utils/logging';\n\n/**\n * The information necessary for rendering a handlebars-based tab.\n *\n * @example Getting the API and creating a handlebars-based item tab that only shows on spells\n * ```js\n * Hooks.once('tidy5e-sheet.ready', (api) => {\n *   const myTab = new api.models.HandlebarsTab({\n *     title: 'My Tab',\n *     tabId: 'my-module-id-my-example-handlebars-tab',\n *     path: '/modules/my-module-id/my-item-tab.hbs',\n *     enabled: (data) => data.item.type === 'spell',\n *     getData: (data) => {\n *       data['my-extra-data'] = 'Hello, world! ';\n *       return data;\n *     },\n *     onRender(params) {\n *       const myTab = $(params.tabContentsElement);\n *       myTab.find('.my-control').click(_myHandler.bind(params.app));\n *     },\n *   });\n *   // To Do: Register this handlebars-based item tab!\n * });\n * ```\n */\n/** @category Tabs */\nexport class HandlebarsTab extends CustomTabBase {\n  title: CustomTabTitle = '';\n  tabId: TabId = '';\n  /**\n   * The path to the handlebars template. Use a leading slash to look in the UserData directory.\n   * @example A template in a module's templates directory\n   * ```\"/modules/my-module-id/templates/my-module-template.hbs\"```\n   */\n  path: string = '';\n  renderScheme: RenderScheme = 'handlebars';\n  tabContentsClasses: string[] = [];\n\n  private _activateDefaultSheetListeners?: boolean | undefined = false;\n  public get activateDefaultSheetListeners(): boolean | undefined {\n    return this._activateDefaultSheetListeners;\n  }\n  public set activateDefaultSheetListeners(value: boolean | undefined) {\n    warn(\n      'Tidy is moving to Application V2, and there will no longer be any default sheet listeners. Be sure to provide your own event handling for the content that is injected.'\n    );\n    this._activateDefaultSheetListeners = value;\n  }\n\n  constructor(props?: Partial<HandlebarsTab>) {\n    super();\n\n    const merged = foundry.utils.mergeObject(this, props);\n    Object.assign(this, merged);\n  }\n\n  /**\n   * An optional function that provides the relevant application context\n   * (item sheet context, character sheet context, NPC sheet context, etc.)\n   * and expects the same data or a replacement object in return.\n   * The return value is passed to the Handlebars template.\n   */\n  getData?: (context: any) => any | Promise<any>;\n\n  /**\n   * Optional function to determine whether the tab should be visible when viewing the sheet. When excluded, it defaults to `true`.\n   * The `context` field is the relevant application context (item sheet, character sheet, etc.).\n   */\n  enabled?: (context: any) => boolean;\n\n  /**\n   * Optional function which is called each time a change detection cycle occurs on the sheet.\n   * It is called after this tab's content is optionally re-rendered to the DOM.\n   */\n  onRender?: (params: OnRenderTabParams) => void;\n}\n","import type { OnRenderTabParams } from 'src/types/types';\nimport type { RenderScheme } from '../api.types';\nimport {\n  CustomTabBase,\n  type CustomTabTitle,\n  type TabId,\n} from './CustomTabBase';\nimport { warn } from 'src/utils/logging';\n\n/**\n * The information necessary for rendering an HTML-based tab.\n * @example Getting the API and creating an HTML tab that wires an even on render\n * ```js\n * Hooks.once('tidy5e-sheet.ready', (api) => {\n *   const myTab = new api.models.HtmlTab({\n *     title: 'My Tab',\n *     tabId: \"my-module-id-my-example-html-tab\",\n *     html: `<button type=\"button\" class=\"my-button\">My button</button>`,\n *     onRender(params) {\n *       params.element\n *         .querySelector('.my-button')\n *         ?.addEventListener('click', () => {\n *           alert('clicked');\n *         });\n *     },\n *   });\n *   // To Do: Register this HTML-based tab!\n * });\n * ```\n */\n/** @category Tabs */\nexport class HtmlTab extends CustomTabBase {\n  title: CustomTabTitle = '';\n  tabId: TabId = '';\n  html: string = '';\n  renderScheme: RenderScheme = 'handlebars';\n  tabContentsClasses: string[] = [];\n\n  private _activateDefaultSheetListeners?: boolean | undefined = false;\n  public get activateDefaultSheetListeners(): boolean | undefined {\n    return this._activateDefaultSheetListeners;\n  }\n  public set activateDefaultSheetListeners(value: boolean | undefined) {\n    warn(\n      'Tidy is moving to Application V2, and there will no longer be any default sheet listeners. Be sure to provide your own event handling for the content that is injected.'\n    );\n    this._activateDefaultSheetListeners = value;\n  }\n\n  constructor(props?: Partial<HtmlTab>) {\n    super();\n\n    const merged = foundry.utils.mergeObject(this, props);\n    Object.assign(this, merged);\n  }\n\n  enabled?: (context: any) => boolean;\n\n  onRender?: (params: OnRenderTabParams) => void;\n}\n","import type { Component } from 'svelte';\nimport type { OnRenderTabParams } from 'src/types/types';\nimport type { RenderScheme } from '../api.types';\nimport { CustomTabBase, type CustomTabTitle } from './CustomTabBase';\nimport { warn } from 'src/utils/logging';\n\n/**\n * The information necessary for rendering a svelte-based tab.\n *\n * @example Getting the API and creating a svelte-based tab with custom props and an extended context map.\n * ```js\n * Hooks.once('tidy5e-sheet.ready', (api) => {\n *   const myTab = new api.models.SvelteTab({\n *     tabId: 'my-module-id-my-example-svelte-tab',\n *     title: 'My Tab',\n *     component: MyCustomSvelteComponent,\n *     getProps(data) {\n *       return {\n *         message: `Hello, ${data.actor.name}! `,\n *       };\n *     },\n *     getContext(context) {\n *       context.set(\n *         'custom-context',\n *         `This text came from some custom context that I injected during tab setup. It was rendered at ${new Date()}`\n *       );\n *       return context;\n *     },\n *   });\n *\n *   // To Do: Register this svelte-based tab!\n * });\n * ```\n */\n/** @category Tabs */\nexport class SvelteTab extends CustomTabBase {\n  /**\n   * A reference to the `.svelte` component.\n   */\n  component?: Component = undefined;\n  title: CustomTabTitle = '';\n  tabId: string = '';\n  /**\n   * For svelte-based tabs, the render scheme is set to 'force' and generally ignored.\n   */\n  renderScheme?: RenderScheme = 'force';\n  tabContentsClasses?: string[] = [];\n\n  private _activateDefaultSheetListeners?: boolean | undefined = false;\n  public get activateDefaultSheetListeners(): boolean | undefined {\n    return this._activateDefaultSheetListeners;\n  }\n  public set activateDefaultSheetListeners(value: boolean | undefined) {\n    warn(\n      'Tidy is moving to Application V2, and there will no longer be any default sheet listeners. Be sure to provide your own event handling for the content that is injected.'\n    );\n    this._activateDefaultSheetListeners = value;\n  }\n\n  constructor(props?: Partial<SvelteTab>) {\n    super();\n\n    const merged = foundry.utils.mergeObject(this, props);\n    Object.assign(this, merged);\n  }\n\n  /**\n   * An optional function that provides the relevant application context\n   * (item sheet context, character sheet context, NPC sheet context, etc.)\n   * and expects an object in return.\n   * The return value is passed to the svelte component as its props.\n   */\n  getProps?: (data: any) => Record<string, any>;\n\n  /**\n   * An optional function that provides the relevant svelte context map and\n   * expects the component's ideal context map in return.\n   *\n   * @remarks\n   * For most sheets, a guaranteed entry in the context map is a readable store\n   * of the sheet's application context\n   * (item sheet context, character sheet context, NPC sheet context, etc.).\n   */\n  getContext?: (context: Map<any, any>) => Map<any, any>;\n\n  enabled?: (data: any) => boolean;\n\n  onRender?: (params: OnRenderTabParams) => void;\n}\n","<script lang=\"ts\">\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import TidySwitch from 'src/components/toggles/TidySwitch.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getNpcSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getNpcSheetContext());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"counters\">\n  <div class=\"counter legendary\">\n    <h4>{localize('DND5E.LegendaryAction.Label')}</h4>\n    <div class=\"counter-value\">\n      <NumberInput\n        document={context.actor}\n        field=\"system.resources.legact.value\"\n        value={context.system.resources.legact.value}\n        step=\"any\"\n        placeholder=\"0\"\n        title={localize('DND5E.LegendaryAction.Remaining')}\n        selectOnFocus={true}\n        disabled={!context.editable}\n      />\n      <span class=\"sep\">/</span>\n      <NumberInput\n        document={context.actor}\n        field=\"system.resources.legact.max\"\n        value={context.system.resources.legact.max}\n        min={0}\n        step=\"1\"\n        placeholder=\"0\"\n        selectOnFocus={true}\n        disabled={!context.unlocked}\n      />\n    </div>\n  </div>\n  <div class=\"counter legendary\">\n    <h4>{localize('DND5E.LegendaryResistance.Label')}</h4>\n    <div class=\"counter-value\">\n      <NumberInput\n        document={context.actor}\n        field=\"system.resources.legres.value\"\n        value={context.system.resources.legres.value}\n        step=\"any\"\n        placeholder=\"0\"\n        title={localize('DND5E.LegendaryResistance.Remaining')}\n        selectOnFocus={true}\n        disabled={!context.editable}\n      />\n      <span class=\"sep\">/</span>\n      <NumberInput\n        document={context.actor}\n        field=\"system.resources.legres.max\"\n        value={context.system.resources.legres.max}\n        min=\"0\"\n        step=\"1\"\n        placeholder=\"0\"\n        selectOnFocus={true}\n        disabled={!context.unlocked}\n      />\n    </div>\n  </div>\n  {#if context.modernRules && context.unlocked}\n    <div class=\"counter lair\">\n      <h4>{localize('DND5E.LAIR.HasLair')}</h4>\n      <div class=\"counter-value\">\n        <Checkbox\n          document={context.actor}\n          field=\"system.resources.lair.value\"\n          checked={context.system.resources.lair.value}\n          disabled={!context.editable}\n        />\n      </div>\n    </div>\n  {:else if context.modernRules && !context.unlocked && context.system.resources.lair.value}\n    <div class=\"counter lair\">\n      <h4>{localize('DND5E.LAIR.Inside')}</h4>\n      <div class=\"counter-value\">\n        <TidySwitch\n          class=\"flex-row small-gap inside-lair-toggle\"\n          checked={context.system.resources.lair.inside}\n          onChange={(ev) =>\n            context.actor.update({\n              ['system.resources.lair.inside']: ev.currentTarget.checked,\n            })}\n          disabled={!context.editable}\n        />\n      </div>\n    </div>\n  {:else if !context.modernRules}\n    <div class=\"counter lair\">\n      <h4>{localize('DND5E.LAIR.Action.Label')}</h4>\n      <div class=\"counter-value\">\n        <TextInput\n          document={context.actor}\n          field=\"system.resources.lair.initiative\"\n          value={context.system.resources.lair.initiative ?? ''}\n          placeholder=\"Init.\"\n          allowDeltaChanges={true}\n          selectOnFocus={true}\n          saveEmptyAsNull={true}\n          disabled={!context.unlocked}\n          title={localize('DND5E.LAIR.Action.Initiative')}\n        />\n      </div>\n    </div>\n  {/if}\n</div>\n\n<style lang=\"scss\">\n  .counters {\n    display: flex;\n    flex: none;\n    padding: 0;\n    border-bottom: none;\n    border: 0.0625rem solid var(--t5e-faint-color);\n    border-radius: 0.3125rem;\n\n    .counter {\n      height: auto;\n      line-height: 1rem;\n      flex: 1;\n      text-align: center;\n\n      .counter-value {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        padding-bottom: 0.125rem;\n        margin-top: 0.1875rem;\n        font-size: 1.5625rem;\n      }\n\n      :global(input) {\n        min-width: 1.875rem;\n        max-width: 3.125rem;\n      }\n\n      :global(input[type='text']:first-of-type) {\n        text-align: right;\n      }\n\n      :global(input[type='text']:last-of-type) {\n        text-align: left;\n      }\n\n      :global(input[type='text']),\n      :global(input[type='number']) {\n        height: 1.5625rem;\n        max-width: 1.25rem;\n      }\n\n      :global(input[type='text'][disabled]) {\n        border-width: 0;\n      }\n\n      :global(input[type='checkbox']) {\n        width: 0.875rem;\n        height: 1.5625rem;\n        margin: 0;\n      }\n\n      h4 {\n        font-size: 0.75rem;\n        line-height: 0.75rem;\n        padding-top: 0.25rem;\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  interface Props {\n    spell: any;\n    spellComponentLabels: Record<string, string>;\n  }\n\n  let { spell, spellComponentLabels }: Props = $props();\n</script>\n\n{#each spell.labels.components.all as component}\n  <span\n    class=\"spell-component\"\n    class:spell-tag={component.tag}\n    title={spellComponentLabels[component.abbr] ?? component.abbr}\n    >{component.abbr}</span\n  >\n{/each}\n\n<style lang=\"scss\">\n  .spell-component.spell-tag {\n    color: var(--t5e-background);\n    background: var(--t5e-tertiary-color);\n    border-radius: 0.125rem;\n    padding: 0.0625rem 0.0625rem 0 0.0625rem;\n    margin: 0 0 0 0.0625rem;\n    line-height: 0.75rem;\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemControl from '../item-list/controls/ItemControl.svelte';\n\n  interface Props {\n    ctx: any;\n    spell: any;\n  }\n\n  let { ctx, spell }: Props = $props();\n\n  function toggleSpellPreparation() {\n    const value = FoundryAdapter.getProperty(\n      spell,\n      'system.preparation.prepared',\n    );\n\n    spell.update({\n      'system.preparation.prepared': !value,\n    });\n  }\n</script>\n\n<ItemControl\n  title={ctx?.toggleTitle}\n  iconCssClass=\"fas fa-book\"\n  active={spell.system.preparation.prepared}\n  onclick={toggleSpellPreparation}\n/>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { CharacterSheetContext, NpcSheetContext } from 'src/types/types';\n\n  let context = $derived(getSheetContext<CharacterSheetContext | NpcSheetContext>());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<button\n  type=\"button\"\n  class=\"spell-slot-config inline-icon-button\"\n  title={localize('DND5E.SpellSlotsConfig')}\n  aria-label={localize('DND5E.SpellSlotsConfig')}\n  onclick={() => FoundryAdapter.openSpellSlotsConfig(context.actor)}\n  tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n>\n  <i class=\"fas fa-pencil\"></i>\n</button>\n","<script lang=\"ts\">\n  import {\n    type CharacterSheetContext,\n    type NpcSheetContext,\n    type SpellbookSection,\n  } from 'src/types/types';\n  import TextInput from '../inputs/TextInput.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    section: SpellbookSection;\n  }\n\n  let { section }: Props = $props();\n\n  let context = $derived(getSheetContext<CharacterSheetContext | NpcSheetContext>());\n</script>\n\n<div class=\"spell-slots-detail\">\n  <TextInput\n    document={context.actor}\n    field=\"system.spells.{section.prop}.value\"\n    class=\"spell-slot-uses\"\n    value={section.uses}\n    placeholder=\"0\"\n    selectOnFocus={true}\n    allowDeltaChanges={true}\n    disabled={!context.editable}\n  />\n  <span class=\"sep\"> / </span>\n\n  <span class=\"spell-max\" data-level={section.prop} data-slots={section.slots}>\n    {section.slots}\n  </span>\n</div>\n\n<style lang=\"scss\">\n  .spell-slots-detail {\n    display: flex;\n    flex: 0 0 0.0625rem;\n    align-items: center;\n    color: var(--t5e-secondary-color);\n    border-radius: 0.3125rem;\n    padding: 0 0.3125rem;\n\n    :global(input) {\n      text-align: right;\n      height: 0.8125rem;\n      margin-top: -0.0625rem;\n      min-width: 1rem;\n    }\n\n    .spell-max {\n      display: flex;\n      align-items: center;\n      line-height: 0.75rem;\n      text-align: left;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import type { MouseEventHandler } from 'svelte/elements';\n\n  interface Props {\n    uses: number;\n    index: number;\n    onclick?: MouseEventHandler<HTMLAnchorElement>;\n    onmouseenter?: MouseEventHandler<HTMLAnchorElement>;\n    onmouseleave?: MouseEventHandler<HTMLAnchorElement>;\n  }\n\n  let {\n    uses,\n    index,\n    onclick,\n    onmouseenter,\n    onmouseleave,\n  }: Props = $props();\n\n  let isEmpty = $derived(index >= uses);\n  let previousIsEmpty = $state<boolean | null>(null);\n\n  let pipEl: HTMLElement;\n\n  $effect(() => {\n    if (previousIsEmpty === null) {\n      previousIsEmpty = isEmpty;\n      return;\n    }\n\n    if (previousIsEmpty !== isEmpty) {\n      let className = !isEmpty ? 'animate-restored' : 'animate-expended';\n      let controller = new AbortController();\n\n      // Trigger onetime animation, remove the class, and stop listening to events.\n      pipEl.addEventListener(\n        'transitionend',\n        () => {\n          pipEl.classList.remove(className);\n          controller.abort();\n        },\n        { signal: controller.signal },\n      );\n\n      pipEl.classList.add(className);\n\n      previousIsEmpty = isEmpty;\n    }\n  });\n</script>\n\n<a\n  bind:this={pipEl}\n  class=\"pip spell-pip\"\n  class:inactive={isEmpty}\n  class:active={!isEmpty}\n  {onclick}\n  {onmouseenter}\n  {onmouseleave}\n></a>\n","<script lang=\"ts\">\n  import type { ActorSheetContextV2, SpellbookSection } from 'src/types/types';\n  import SpellPip from './SpellPip.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    section: SpellbookSection;\n  }\n\n  let { section }: Props = $props();\n\n  let context = $derived(getSheetContext<ActorSheetContextV2>());\n\n  function onPipClick(index: number) {\n    let isEmpty = index >= (section.uses ?? 0);\n\n    let value = isEmpty ? index + 1 : index;\n\n    context.actor.update({\n      [`system.spells.${section.prop}.value`]: value,\n    });\n  }\n</script>\n\n<div class=\"pips spell-pips\">\n  {#each { length: section.slots ?? 0 }, index}\n    <SpellPip\n      uses={section.uses ?? 0}\n      {index}\n      onclick={() => context.editable && onPipClick(index)}\n    />\n  {/each}\n  <span class=\"pip-end\"></span>\n</div>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import type {\n    CharacterSheetContext,\n    NpcSheetContext,\n    SpellbookSection,\n  } from 'src/types/types';\n  import SpellSlotConfigButton from './SpellSlotConfigButton.svelte';\n  import SpellSlotUses from './SpellSlotUses.svelte';\n  import SpellPips from '../pips/SpellPips.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    section: SpellbookSection;\n  }\n\n  let { section }: Props = $props();\n\n  let context = $derived(getSheetContext<CharacterSheetContext | NpcSheetContext>());\n</script>\n\n<div class=\"flex-row extra-small-gap\">\n  {#if context.spellSlotTrackerMode === CONSTANTS.SPELL_SLOT_TRACKER_MODE_PIPS}\n    <SpellPips {section} />\n  {/if}\n  {#if context.spellSlotTrackerMode === CONSTANTS.SPELL_SLOT_TRACKER_MODE_VALUE_MAX}\n    <SpellSlotUses {section} />\n  {/if}\n  {#if context.unlocked}\n    <SpellSlotConfigButton />\n  {/if}\n</div>\n","<script lang=\"ts\" generics=\"TParam\">\n  import type { RenderableClassicControl } from 'src/types/types';\n\n  interface Props {\n    controls: RenderableClassicControl<TParam>[];\n    params: TParam;\n  }\n\n  let { controls, params }: Props = $props();\n</script>\n\n<div class=\"tidy5e-classic-controls\">\n  {#each controls as control}\n    {#if control.visible === undefined || control.visible(params)}\n      <control.component {...control.props?.(params)} />\n    {:else}\n      <span>&nbsp;</span>\n    {/if}\n  {/each}\n</div>\n\n<style lang=\"scss\">\n  .tidy5e-classic-controls {\n    flex: 1;\n    align-self: stretch;\n    display: flex;\n    flex-direction: row;\n    justify-content: flex-end;\n    font-size: 0.75rem;\n    gap: 0.125rem;\n\n    :global(> *) {\n      flex: 1;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n  interface Props {\n    ctx: any;\n  }\n\n  let { ctx }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n{#if ctx.concentration}\n  <i\n    class=\"concentration-overlay fas fa-arrow-rotate-left fa-spin fa-spin-reverse\"\n    aria-label={localize('DND5E.Concentration')}\n  ></i>\n{/if}\n\n<style lang=\"scss\">\n  .concentration-overlay {\n    --tidy-icon-font-size-internal: var(--tidy-icon-font-size, 1rem);\n    position: absolute;\n    opacity: 0.8;\n    font-size: var(--tidy-icon-font-size-internal);\n    pointer-events: none;\n\n    color: white;\n    text-shadow:\n      #000 0.0625rem 0 0.25rem,\n      #000 0.0625rem 0 0.25rem,\n      #000 0.0625rem 0 0.25rem;\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemControl from './ItemControl.svelte';\n  import type { Item5e } from 'src/types/item.types';\n\n  interface Props {\n    item: Item5e;\n    [key: string]: any;\n  }\n\n  let { item, ...rest }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<ItemControl\n  iconCssClass=\"fas fa-gear\"\n  class={rest.class ?? ''}\n  onclick={() => item.system.linkedActivity.sheet.render(true)}\n  title={localize('DOCUMENT.DND5E.Activity')}\n/>\n","<script lang=\"ts\">\n  import type { Item5e } from 'src/types/item.types';\n  import SpellOpenCastActivityControl from './SpellOpenCastActivityControl.svelte';\n  import ItemDeleteControl from './ItemDeleteControl.svelte';\n\n  interface Props {\n    item: Item5e;\n  }\n\n  let { item }: Props = $props();\n</script>\n\n{#if item.canDelete || !item.system.linkedActivity}\n  <ItemDeleteControl {item} />\n{:else}\n  <SpellOpenCastActivityControl {item} />\n{/if}\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import {\n    type CharacterSheetContext,\n    type NpcSheetContext,\n    type RenderableClassicControl,\n    type SpellbookSection,\n  } from 'src/types/types';\n  import ItemEditControl from '../item-list/controls/ItemEditControl.svelte';\n  import ItemName from '../item-list/ItemName.svelte';\n  import ItemTable from '../item-list/v1/ItemTable.svelte';\n  import ItemTableCell from '../item-list/v1/ItemTableCell.svelte';\n  import ItemTableColumn from '../item-list/v1/ItemTableColumn.svelte';\n  import ItemTableFooter from '../item-list/ItemTableFooter.svelte';\n  import ItemTableHeaderRow from '../item-list/v1/ItemTableHeaderRow.svelte';\n  import ItemTableRow from '../item-list/v1/ItemTableRow.svelte';\n  import ItemUseButton from '../item-list/ItemUseButton.svelte';\n  import ItemUses from '../item-list/ItemUses.svelte';\n  import SpellComponents from './SpellComponents.svelte';\n  import SpellPrepareControl from '../spellbook/SpellPrepareControl.svelte';\n  import InlineFavoriteIcon from '../item-list/InlineFavoriteIcon.svelte';\n  import ItemFavoriteControl from '../item-list/controls/ItemFavoriteControl.svelte';\n  import { getContext } from 'svelte';\n  import ActionFilterOverrideControl from '../item-list/controls/ActionFilterOverrideControl.svelte';\n  import { SpellSchool } from 'src/features/spell-school/SpellSchool';\n  import { declareLocation } from 'src/types/location-awareness.types';\n  import Dnd5eIcon from '../icon/Dnd5eIcon.svelte';\n  import SpellSlotManagement from './SpellSlotManagement.svelte';\n  import type { Item5e } from 'src/types/item.types';\n  import ClassicControls from 'src/sheets/classic/shared/ClassicControls.svelte';\n  import ConcentrationOverlayIcon from './ConcentrationOverlayIcon.svelte';\n  import DeleteOrOpenActivity from '../item-list/controls/DeleteOrOpenActivity.svelte';\n  import ActivityUses from '../item-list/ActivityUses.svelte';\n  import { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import { getSearchResultsContext } from 'src/features/search/search.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context =\n    $derived(getSheetContext<CharacterSheetContext | NpcSheetContext>());\n\n  interface Props {\n    section: SpellbookSection;\n    allowFavorites?: boolean;\n    cssClass?: string | null;\n    // TODO: replace this with column specification array default and then allow the caller to customize the table.\n    includeSchool?: boolean;\n    includeRange?: boolean;\n    spellComponentsBaseWidth?: string;\n    targetBaseWidth?: string;\n    usageBaseWidth?: string;\n  }\n\n  let {\n    section,\n    allowFavorites = true,\n    cssClass = null,\n    includeSchool = true,\n    includeRange = true,\n    spellComponentsBaseWidth = '3.75rem',\n    targetBaseWidth = '7.5rem',\n    usageBaseWidth = '7.5rem',\n  }: Props = $props();\n\n  let inlineToggleService = getContext<InlineToggleService>(\n    CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n  );\n\n  let spellEntries = $derived(\n    section.spells.map((s) => ({\n      spell: s,\n      spellImgUrl: FoundryAdapter.getSpellImageUrl(context, s),\n      ctx: context.itemContext[s.id],\n    })),\n  );\n\n  const searchResults = getSearchResultsContext();\n\n  var spellSchoolBaseWidth = '2rem';\n\n  let controls: RenderableClassicControl<{ item: Item5e; ctx: any }>[] =\n    $derived.by(() => {\n      let result: RenderableClassicControl<{ item: Item5e; ctx: any }>[] = [\n        {\n          component: SpellPrepareControl,\n          props: ({ item, ctx }) => ({\n            spell: item,\n            ctx,\n          }),\n          visible: ({ item }) => FoundryAdapter.canPrepareSpell(item),\n        },\n      ];\n\n      if (allowFavorites) {\n        result.push({\n          component: ItemFavoriteControl,\n          props: ({ item }) => ({\n            item,\n          }),\n        });\n      }\n\n      result.push({\n        component: ItemEditControl,\n        props: ({ item }) => ({\n          item,\n        }),\n      });\n\n      if (context.unlocked) {\n        result.push({\n          component: DeleteOrOpenActivity,\n          props: ({ item }) => ({\n            item,\n          }),\n        });\n      }\n\n      if (context.useActionsFeature) {\n        result.push({\n          component: ActionFilterOverrideControl,\n          props: ({ item }) => ({\n            item,\n          }),\n        });\n      }\n\n      return result;\n    });\n\n  const localize = FoundryAdapter.localize;\n\n  let classicControlsColumnWidth = $derived(`${controls.length * 1.25}rem`);\n\n  declareLocation('spellbook-list-view');\n</script>\n\n<section class=\"spellbook-list-section {cssClass}\">\n  <ItemTable\n    key={section.key}\n    data-custom-section={section.custom ? true : null}\n  >\n    {#snippet header()}\n      <ItemTableHeaderRow>\n        <ItemTableColumn primary={true}>\n          <span class=\"spell-primary-column-label\">\n            {localize(section.label)}\n          </span>\n          {#if section.usesSlots}\n            <SpellSlotManagement {section} />\n          {/if}\n        </ItemTableColumn>\n        <ItemTableColumn\n          baseWidth={spellComponentsBaseWidth}\n          title={localize('DND5E.SpellComponents')}\n        >\n          <i class=\"fas fa-mortar-pestle\"></i>\n        </ItemTableColumn>\n        {#if includeSchool}\n          <ItemTableColumn\n            baseWidth={spellSchoolBaseWidth}\n            title={localize('DND5E.SpellSchool')}\n          >\n            <i class=\"fas fa-hat-wizard\"></i>\n          </ItemTableColumn>\n        {/if}\n        <ItemTableColumn\n          baseWidth={targetBaseWidth}\n          title={localize('DND5E.SpellTarget')}\n        >\n          {localize('DND5E.Target')}\n        </ItemTableColumn>\n        {#if includeRange}\n          <ItemTableColumn baseWidth=\"4.375rem\" title={localize('DND5E.Range')}>\n            {localize('DND5E.Range')}\n          </ItemTableColumn>\n        {/if}\n        <ItemTableColumn\n          title={localize('DND5E.SpellUsage')}\n          baseWidth={usageBaseWidth}\n        >\n          {localize('DND5E.Usage')}\n        </ItemTableColumn>\n        {#if context.editable && context.useClassicControls}\n          <ItemTableColumn baseWidth={classicControlsColumnWidth} />\n        {/if}\n      </ItemTableHeaderRow>\n    {/snippet}\n    {#snippet body()}\n      {#each spellEntries as { spell, spellImgUrl, ctx } (spell.id)}\n        <ItemTableRow\n          item={spell}\n          onMouseDown={(event) =>\n            FoundryAdapter.editOnMiddleClick(event, spell)}\n          contextMenu={{\n            type: CONSTANTS.CONTEXT_MENU_TYPE_ITEMS,\n            uuid: spell.uuid,\n          }}\n          cssClass={FoundryAdapter.getSpellRowClasses(spell)}\n          hidden={!searchResults.show(spell.uuid)}\n        >\n          {#snippet children({ toggleSummary })}\n            <ItemTableCell primary={true}>\n              <ItemUseButton\n                disabled={!context.editable}\n                item={spell}\n                imgUrlOverride={spellImgUrl}\n                showDiceIconOnHover={!ctx.concentration}\n              >\n                {#snippet afterRollButton()}\n                  <ConcentrationOverlayIcon {ctx} />\n                {/snippet}\n              </ItemUseButton>\n              <ItemName\n                onToggle={() => toggleSummary(context.actor)}\n                item={spell}\n              >\n                <span\n                  class=\"truncate flex-1\"\n                  data-tidy-item-name={spell.name}\n                  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_NAME}\n                >\n                  {spell.name}\n                  {#if spell.system.linkedActivity?.item}\n                    <i\n                      class=\"linked-source-tooltip-icon fa-solid fa-circle-info fa-fw\"\n                      title={localize('TIDY5E.Activities.Cast.SourceHintText', {\n                        itemName: spell.system.linkedActivity.item.name,\n                      })}\n                    ></i>\n                  {/if}\n                </span>\n              </ItemName>\n\n              <div class=\"primary-cell-extras\">\n                {#if ctx.hasUses}\n                  <span class=\"primary-cell-uses\">\n                    <ItemUses item={spell} />\n                  </span>\n                {:else if ctx.linkedUses}\n                  <span class=\"primary-cell-uses\">\n                    <span class=\"inline-item-uses\">\n                      <span class=\"uses-value\">\n                        {ctx.linkedUses.value}\n                      </span>\n                      /\n                      <span class=\"uses-max\">\n                        {ctx.linkedUses.max}\n                      </span>\n                    </span>\n                  </span>\n                {:else if (spell.system.linkedActivity?.uses?.max ?? 0) > 0}\n                  <span class=\"primary-cell-uses\">\n                    <ActivityUses activity={spell.system.linkedActivity} />\n                  </span>\n                {/if}\n                {#if allowFavorites && !context.useClassicControls && 'favoriteId' in ctx && !!ctx.favoriteId}\n                  <InlineFavoriteIcon />\n                {/if}\n              </div>\n            </ItemTableCell>\n            <ItemTableCell\n              baseWidth={spellComponentsBaseWidth}\n              cssClass=\"no-gap\"\n            >\n              <SpellComponents\n                {spell}\n                spellComponentLabels={context.spellComponentLabels}\n              />\n            </ItemTableCell>\n            {#if includeSchool}\n              {@const icon = SpellSchool.getIcon(spell.system.school)}\n              <ItemTableCell\n                baseWidth={spellSchoolBaseWidth}\n                title={spell.labels.school ?? ''}\n              >\n                {#if typeof icon === 'string'}\n                  <i class=\"spell-school-icon {icon}\"></i>\n                {:else}\n                  <Dnd5eIcon\n                    --icon-fill=\"var(--t5e-secondary-color)\"\n                    --icon-width=\"1rem\"\n                    --icon-height=\"1rem\"\n                    src={icon.iconSrc}\n                  />\n                {/if}\n              </ItemTableCell>\n            {/if}\n            <ItemTableCell\n              baseWidth={targetBaseWidth}\n              title=\"{localize('DND5E.Target')}: {spell.labels.target}\"\n            >\n              {#if spell.labels.target}\n                {spell.labels.target}\n              {:else}\n                {localize('DND5E.None')}\n              {/if}\n            </ItemTableCell>\n            {#if includeRange}\n              <ItemTableCell\n                baseWidth=\"4.375rem\"\n                title=\"{localize('DND5E.Range')}: {spell.labels.range}\"\n              >\n                {spell.labels.range}\n              </ItemTableCell>\n            {/if}\n            <ItemTableCell\n              baseWidth={usageBaseWidth}\n              title={localize('DND5E.SpellUsage')}\n            >\n              {spell.labels.activation}\n            </ItemTableCell>\n            {#if context.editable && context.useClassicControls}\n              <ItemTableCell baseWidth={classicControlsColumnWidth}>\n                <ClassicControls\n                  {controls}\n                  params={{ item: spell, ctx: ctx }}\n                />\n              </ItemTableCell>\n            {/if}\n          {/snippet}\n        </ItemTableRow>\n      {/each}\n      {#if context.unlocked}\n        <ItemTableFooter\n          actor={context.actor}\n          {section}\n          canCreate={section.canCreate}\n          isItem={true}\n        />\n      {/if}\n    {/snippet}\n  </ItemTable>\n</section>\n\n<style lang=\"scss\">\n  .spell-primary-column-label {\n    font-size: 0.75rem;\n    line-height: 0.75rem;\n    flex: 0 0 3.75rem;\n    white-space: nowrap;\n  }\n\n  .spellbook-list-section {\n    .spell-school-icon {\n      color: var(--t5e-secondary-color);\n      font-size: 1rem;\n      margin: 0;\n      padding: 0;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import type { Snippet } from 'svelte';\n\n  interface Props {\n    cssClass?: string | null;\n    children?: Snippet;\n  }\n\n  let { cssClass = null, children }: Props = $props();\n</script>\n\n<div class=\"notice {cssClass}\">\n  {@render children?.()}\n</div>\n\n<style lang=\"scss\">\n  .notice {\n    display: block;\n    background: var(--t5e-warning-accent-color);\n    padding: 0.625rem;\n    font-size: 0.75rem;\n    color: var(--t5e-warning-accent-contrast-color);\n    border-radius: 0.3125rem;\n  }\n</style>\n","<script lang=\"ts\">\n  import Notice from 'src/components/notice/Notice.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { CharacterSheetContext, NpcSheetContext } from 'src/types/types';\n\n  interface Props {\n    editable: boolean;\n    cssClass?: string | null;\n  }\n\n  let { editable, cssClass = null }: Props = $props();\n\n  let context = $derived(getSheetContext<CharacterSheetContext | NpcSheetContext>());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"no-spells-container {cssClass}\">\n  <Notice>{localize('DND5E.NoSpellLevels')}</Notice>\n  {#if context.editable && editable}\n    <button\n      type=\"button\"\n      class=\"create-spell-btn flex-row align-items-center extra-small-gap\"\n      onclick={() =>\n        FoundryAdapter.createItem({ type: 'spell', level: '' }, context.actor)}\n      tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n    >\n      <i class=\"fas fa-plus-circle\"></i>\n      {localize('DND5E.SpellCreate')}\n    </button>\n  {/if}\n</div>\n\n<style lang=\"scss\">\n  .no-spells-container {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n\n    .create-spell-btn {\n      text-align: center;\n      min-width: 7.5rem;\n      align-self: center;\n      font-size: 0.75rem;\n      border-radius: 0.3125rem;\n      line-height: 1.5;\n      width: auto;\n      padding: 0.125rem 1.5rem;\n      border: none;\n      color: var(--t5e-secondary-color);\n      background-color: var(--t5e-faintest-color);\n\n      &:hover {\n        background-color: var(--t5e-light-color);\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import type { Snippet } from 'svelte';\n\n  interface Props {\n    cssClass?: string | null;\n    mode: 'vertical' | 'horizontal';\n    appV2?: boolean;\n    children?: Snippet;\n  }\n\n  let { cssClass = null, mode, appV2 = false, children }: Props = $props();\n</script>\n\n<footer class=\"tab-footer {cssClass} {mode}\" class:app-v2={appV2}>\n  {@render children?.()}\n</footer>\n\n<style lang=\"scss\">\n  .tab-footer {\n    background-color: var(--t5e-header-background);\n    box-shadow: 0 0 0.1875rem 0 var(--t5e-tertiary-color);\n    padding: 0.25rem 1.5rem 0.5rem 0.75rem;\n    margin: 0 -0.25rem -1rem -1rem;\n    border-top: 0.0625rem solid var(--t5e-light-color);\n    display: flex;\n    gap: 0.25rem;\n\n    &.app-v2 {\n      margin-bottom: 0;\n    }\n\n    &.vertical {\n      flex-direction: column;\n    }\n\n    &.horizontal {\n      flex-direction: row;\n      justify-content: space-between;\n      align-items: center;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { CharacterSheetContext, NpcSheetContext } from 'src/types/types';\n  import NumberInput from '../inputs/NumberInput.svelte';\n  import Select from '../inputs/Select.svelte';\n  import TabFooter from 'src/sheets/classic/actor/TabFooter.svelte';\n  import { MaxPreparedSpellsConfigFormApplication } from 'src/applications/max-prepared-spells-config/MaxPreparedSpellsConfigFormApplication.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { settings } from 'src/settings/settings.svelte';\n  import { rollRawSpellAttack } from 'src/utils/formula';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getSheetContext<CharacterSheetContext | NpcSheetContext>());\n  interface Props {\n    cssClass?: string | null;\n    includeAttackMod?: boolean;\n    includePreparedSpells?: boolean;\n  }\n\n  let {\n    cssClass = null,\n    includeAttackMod = true,\n    includePreparedSpells = true,\n  }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n\n  let abilities = $derived(\n    FoundryAdapter.getAbilitiesAsDropdownOptions(context.abilities),\n  );\n</script>\n\n<TabFooter cssClass=\"{cssClass} spellbook-footer\" mode=\"horizontal\">\n  <h3 class=\"spell-dc spell-mod flex-row extra-small-gap\">\n    <div class=\"flex-row extra-small-gap\" style=\"align-items: baseline;\">\n      <div>{FoundryAdapter.localize('DND5E.AbbreviationDC')}:</div>\n      <div\n        class=\"dc-container\"\n        data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.SPELL_DC}\n        data-tooltip=\"{FoundryAdapter.localize('DND5E.SpellDC')}: {context\n          .spellcastingInfo.calculations.dcTooltip}\"\n      >\n        {context.spellcastingInfo.calculations.dc}\n      </div>\n\n      {#if includeAttackMod}\n        <span>|</span>\n        <span>{FoundryAdapter.localize('TIDY5E.AttackMod')}:</span>\n\n        {#if context.spellcastingInfo.calculations.rangedMod !== context.spellcastingInfo.calculations.meleeMod}\n          <button\n            type=\"button\"\n            onclick={async (ev) =>\n              await rollRawSpellAttack(\n                ev,\n                context.actor,\n                'rsak',\n                context.spellcastingInfo.currentFilteredClass?.system\n                  ?.spellcasting?.ability,\n              )}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n            data-tooltip=\"{FoundryAdapter.localize(\n              'TIDY5E.RangedSpellAttackMod',\n            )}: {context.spellcastingInfo.calculations.rangedTooltip}\"\n            class=\"inline-transparent-button spell-attack-mod-button rollable\"\n          >\n            <i class=\"fa-solid fa-wand-magic-sparkles\"></i>\n            <span\n              class=\"spell-attack-mod\"\n              data-tidy-mod-has-bonus={context.spellcastingInfo.calculations\n                .rangedHasBonus}\n              data-tidy-sheet-part={CONSTANTS.SHEET_PARTS\n                .RANGED_SPELL_ATTACK_MOD}\n            >\n              {context.spellcastingInfo.calculations.rangedMod}\n            </span>\n          </button>\n          <button\n            type=\"button\"\n            onclick={async (ev) =>\n              await rollRawSpellAttack(\n                ev,\n                context.actor,\n                'msak',\n                context.spellcastingInfo.currentFilteredClass?.system\n                  ?.spellcasting?.ability,\n              )}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n            data-tooltip=\"{FoundryAdapter.localize(\n              'TIDY5E.MeleeSpellAttackMod',\n            )}: {context.spellcastingInfo.calculations.meleeTooltip}\"\n            class=\"inline-transparent-button spell-attack-mod-button rollable\"\n          >\n            <i class=\"fa-solid fa-hand-sparkles\"></i>\n            <span\n              class=\"spell-attack-mod\"\n              data-tidy-mod-has-bonus={context.spellcastingInfo.calculations\n                .meleeHasBonus}\n              data-tidy-sheet-part={CONSTANTS.SHEET_PARTS\n                .MELEE_SPELL_ATTACK_MOD}\n            >\n              {context.spellcastingInfo.calculations.meleeMod}\n            </span>\n          </button>\n        {:else}\n          <button\n            type=\"button\"\n            onclick={async (ev) =>\n              await rollRawSpellAttack(\n                ev,\n                context.actor,\n                undefined,\n                context.spellcastingInfo.currentFilteredClass?.system\n                  ?.spellcasting?.ability,\n              )}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n            data-tooltip=\"{FoundryAdapter.localize(\n              'TIDY5E.SpellAttackMod',\n            )}: {context.spellcastingInfo.calculations.rangedTooltip}\"\n            class=\"inline-transparent-button spell-attack-mod-button rollable\"\n          >\n            <span\n              class=\"spell-attack-mod\"\n              data-tidy-mod-has-bonus={context.spellcastingInfo.calculations\n                .rangedHasBonus}\n              data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.SPELL_ATTACK_MOD}\n            >\n              {context.spellcastingInfo.calculations.rangedMod}\n            </span>\n          </button>\n        {/if}\n      {/if}\n    </div>\n  </h3>\n\n  {#if includePreparedSpells && context.spellcastingInfo.currentFilteredClass && (context.spellcastingInfo.prepared?.value || context.spellcastingInfo.prepared?.max)}\n    <button\n      type=\"button\"\n      class=\"transparent-button secondary-footer-field highlight-on-hover\"\n      onclick={() =>\n        new MaxPreparedSpellsConfigFormApplication(\n          context.spellcastingInfo.currentFilteredClass.name,\n          context.spellcastingInfo.currentFilteredClass,\n        ).render(true)}\n      title={localize('TIDY5E.MaxPreparedSpellsConfig.ButtonTooltip')}\n      disabled={!context.editable || context.lockSensitiveFields}\n      tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n    >\n      <p>{localize('TIDY5E.PreparedSpells')}</p>\n      <span class=\"spells-prepared\"\n        >{context.spellcastingInfo.prepared?.value ?? 0}</span\n      >\n      /\n      <span class=\"spells-max-prepared\"\n        >{context.spellcastingInfo.prepared?.max ?? 0}</span\n      >\n    </button>\n  {/if}\n  <div class=\"spellcasting-attribute secondary-footer-field\">\n    <p>{localize('DND5E.SpellAbility')}</p>\n    <Select\n      document={context.actor}\n      field=\"system.attributes.spellcasting\"\n      value={context.system.attributes.spellcasting}\n      disabled={!context.editable || context.lockSensitiveFields}\n      blankValue=\"\"\n    >\n      <option value=\"\" selected={!context.system.attributes.spellcasting}\n        >{localize('DND5E.None')}</option\n      >\n      {#each abilities as ability}\n        <option value={ability.value}>{ability.text}</option>\n      {/each}\n    </Select>\n  </div>\n  {#if context.isNPC}\n    <div class=\"spellcasting-level-container secondary-footer-field\">\n      <p class=\"truncate\">{localize('DND5E.SpellcasterLevel')}</p>\n      <NumberInput\n        cssClass=\"spellcasting-level\"\n        document={context.actor}\n        field=\"system.details.spellLevel\"\n        value={context.system.details.spellLevel}\n        placeholder=\"0\"\n        min=\"0\"\n        step=\"1\"\n        selectOnFocus={true}\n        disabled={!context.editable || context.lockSensitiveFields}\n      />\n    </div>\n  {/if}\n</TabFooter>\n\n<style lang=\"scss\">\n  :global(.tidy5e-sheet .spellbook-footer) {\n    min-height: 2.5rem;\n  }\n\n  .secondary-footer-field {\n    flex: 0;\n    display: flex;\n    align-items: center;\n    font-size: 0.75rem;\n  }\n\n  .spell-attack-mod-button,\n  .dc-container {\n    display: flex;\n    align-items: center;\n    gap: 0.125rem;\n  }\n\n  .spell-attack-mod-button {\n    font-family: var(--t5e-title-font-family);\n    font-weight: 700;\n  }\n\n  .spell-attack-mod-button i {\n    font-size: 1rem;\n  }\n\n  h3 {\n    font-size: 1.25rem;\n    font-family: var(--t5e-title-font-family);\n  }\n\n  p {\n    font-weight: 700;\n    margin: 0 0.25rem 0 0;\n    white-space: nowrap;\n  }\n\n  .spellcasting-attribute :global(select) {\n    height: 1.1875rem;\n    font-size: 0.75rem;\n    font-family: var(--t5e-body-font-family);\n  }\n\n  .spellcasting-level-container :global(.spellcasting-level) {\n    width: 1.25rem;\n    height: 1.25rem;\n    flex: 0;\n    text-align: center;\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import type { ItemLayoutMode } from 'src/types/types';\n\n  interface Props {\n    mode: ItemLayoutMode;\n    element?: HTMLElement['tagName'];\n    onToggle?: () => void;\n  }\n\n  let { mode, element = 'li', onToggle }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n  let toggleButtonPresentation = $derived(\n    mode === 'grid'\n      ? {\n          title: localize('TIDY5E.ListLayout'),\n          iconClass: 'fas fa-th-list fa-fw toggle-list',\n        }\n      : mode === 'list'\n        ? {\n            title: localize('TIDY5E.GridLayout'),\n            iconClass: 'fas fa-th-large fa-fw toggle-grid',\n          }\n        : null,\n  );\n</script>\n\n<svelte:element this={element} class=\"toggle-layout\">\n  {#if mode === 'grid' || mode === 'list'}\n    <button\n      type=\"button\"\n      class=\"icon-button\"\n      title={toggleButtonPresentation?.title}\n      onclick={() => onToggle?.()}\n      tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n    >\n      <i class={toggleButtonPresentation?.iconClass}></i>\n    </button>\n  {:else}\n    <span title={localize('TIDY5E.LayoutNotSupported')}></span>\n  {/if}\n</svelte:element>\n\n<style lang=\"scss\">\n  .toggle-layout {\n    margin: 0 0.25rem;\n    padding: 0 0.125rem;\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<i\n  class=\"fas fa-bookmark icon-fav no-pointer-events\"\n  title={localize('TIDY5E.Favorite')}\n></i>\n\n<style lang=\"scss\">\n  .icon-fav {\n    position: absolute;\n    top: -0.125rem;\n    left: 0.25rem;\n    color: var(--t5e-grid-pane-favorite-icon-color);\n    text-shadow: 0 0 0.125rem var(--t5e-primary-color);\n    font-size: 0.625rem;\n  }\n</style>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import {\n    type CharacterSheetContext,\n    type NpcSheetContext,\n    type SpellbookSection,\n  } from 'src/types/types';\n  import ItemTable from '../item-list/v1/ItemTable.svelte';\n  import ItemTableColumn from '../item-list/v1/ItemTableColumn.svelte';\n  import ItemTableHeaderRow from '../item-list/v1/ItemTableHeaderRow.svelte';\n  import type { Item5e } from 'src/types/item.types';\n  import GridPaneFavoriteIcon from '../item-grid/GridPaneFavoriteIcon.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import { ActorItemRuntime } from 'src/runtime/ActorItemRuntime';\n  import { declareLocation } from 'src/types/location-awareness.types';\n  import SpellSlotManagement from './SpellSlotManagement.svelte';\n  import ConcentrationOverlayIcon from './ConcentrationOverlayIcon.svelte';\n  import { TidyHooks } from 'src/foundry/TidyHooks';\n  import { getSearchResultsContext } from 'src/features/search/search.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    section: SpellbookSection;\n    cssClass?: string | null;\n  }\n\n  let { section, cssClass = null }: Props = $props();\n\n  let context =\n    $derived(getSheetContext<CharacterSheetContext | NpcSheetContext>());\n\n  let searchResultContext = getSearchResultsContext();\n\n  let spellEntries = $derived(\n    section.spells.map((s) => ({\n      spell: s,\n      ctx: context.itemContext[s.id],\n      spellImgUrl: FoundryAdapter.getSpellImageUrl(context, s),\n    })),\n  );\n\n  let customCommands = $derived(\n    ActorItemRuntime.getActorItemSectionCommands({\n      actor: context.actor,\n      section,\n    }),\n  );\n\n  const localize = FoundryAdapter.localize;\n\n  async function onMouseEnter(event: Event, item: Item5e) {\n    TidyHooks.tidy5eSheetsItemHoverOn(event, item);\n  }\n\n  async function onMouseLeave(event: Event, item: Item5e) {\n    TidyHooks.tidy5eSheetsItemHoverOff(event, item);\n  }\n\n  function handleDragStart(event: DragEvent, item: Item5e) {\n    if (!item) {\n      return;\n    }\n\n    onMouseLeave(event, item);\n\n    const dragData = item.toDragData();\n    event.dataTransfer?.setData('text/plain', JSON.stringify(dragData));\n  }\n\n  declareLocation('spellbook-grid-view');\n</script>\n\n<section class=\"spellbook-grid {cssClass}\">\n  <ItemTable\n    key={section.key}\n    data-custom-section={section.custom ? true : null}\n  >\n    {#snippet header()}\n      <ItemTableHeaderRow>\n        <ItemTableColumn primary={true}>\n          <span class=\"spell-primary-column-label\">\n            {localize(section.label)}\n          </span>\n          {#if section.usesSlots}\n            <SpellSlotManagement {section} />\n          {/if}\n        </ItemTableColumn>\n      </ItemTableHeaderRow>\n    {/snippet}\n    {#snippet body()}\n      <div class=\"spells\">\n        {#each spellEntries as { spell, ctx, spellImgUrl } (spell.id)}\n          {@const hidden = !searchResultContext.show(spell.uuid)}\n          <a\n            class=\"spell {FoundryAdapter.getSpellRowClasses(spell)}\"\n            class:hidden\n            aria-hidden={hidden}\n            data-context-menu={CONSTANTS.CONTEXT_MENU_TYPE_ITEMS}\n            onclick={(event) => FoundryAdapter.actorTryUseItem(spell, event)}\n            oncontextmenu={(event) =>\n              FoundryAdapter.onActorItemButtonContextMenu(spell, { event })}\n            onmousedown={(event) =>\n              FoundryAdapter.editOnMiddleClick(event, spell)}\n            onmouseenter={(ev) => onMouseEnter(ev, spell)}\n            onmouseleave={(ev) => onMouseLeave(ev, spell)}\n            ondragstart={(ev) => handleDragStart(ev, spell)}\n            draggable={true}\n            data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_USE_COMMAND}\n            data-item-id={spell.id}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n            data-tidy-grid-item\n            data-info-card={spell ? 'item' : null}\n            data-info-card-entity-uuid={spell?.uuid ?? null}\n          >\n            {#if 'favoriteId' in ctx && !!ctx.favoriteId}\n              <GridPaneFavoriteIcon />\n            {/if}\n            <div class=\"spell-name\">\n              <div\n                class=\"spell-image\"\n                style=\"background-image: url('{spellImgUrl}');\"\n              >\n                {#if !ctx.concentration}\n                  <i class=\"fa fa-dice-d20\"></i>\n                {/if}\n                <ConcentrationOverlayIcon\n                  --tidy-icon-font-size=\"1.25rem\"\n                  {ctx}\n                />\n              </div>\n            </div>\n          </a>\n        {/each}\n        {#if context.unlocked}\n          <div class=\"spells-footer\">\n            {#if section.canCreate}\n              <button\n                type=\"button\"\n                class=\"footer-command icon-button\"\n                title={localize('DND5E.SpellCreate')}\n                onclick={(event) => {\n                  event.preventDefault();\n                  event.stopPropagation();\n                  FoundryAdapter.createItem(section.dataset, context.actor);\n                }}\n                data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_CREATE_COMMAND}\n                tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n              >\n                <i class=\"fas fa-plus-circle\"></i>\n              </button>\n            {/if}\n            {#each customCommands as command}\n              <button\n                type=\"button\"\n                class=\"footer-command icon-button\"\n                onclick={(ev) =>\n                  command.execute?.({\n                    section,\n                    event: ev,\n                    actor: context.actor,\n                  })}\n                title={localize(command.tooltip ?? '')}\n                tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n              >\n                {#if (command.iconClass ?? '') !== ''}\n                  <i class={command.iconClass}></i>\n                {/if}\n                {localize(command.label ?? '')}\n              </button>\n            {/each}\n          </div>\n        {/if}\n      </div>\n    {/snippet}\n  </ItemTable>\n</section>\n\n<style lang=\"scss\">\n  .spell-primary-column-label {\n    font-size: 0.75rem;\n    line-height: 0.75rem;\n    flex: 0 0 3.75rem;\n    white-space: nowrap;\n  }\n\n  .spellbook-grid {\n    .spells {\n      padding: 0;\n      display: flex;\n      flex-wrap: wrap;\n\n      .spell {\n        width: 3.125rem;\n        height: 3.125rem;\n        position: relative;\n        margin: 0.1875rem;\n        box-shadow: 0 0 0.0625rem 0.0625rem var(--t5e-light-color);\n        border-radius: 0.3125rem;\n\n        &.context {\n          border: 0.0625rem solid var(--t5e-primary-accent-color);\n        }\n\n        &.preparable {\n          .spell-image {\n            box-shadow: 0 0 0 0.125rem inset var(--t5e-prepareable-color);\n            border-radius: 0.3125rem;\n          }\n        }\n\n        &.prepared {\n          box-shadow: 0 0 0 0.125rem\n            var(--t5e-prepared-item-grid-tile-outline-color);\n          background-color: var(--t5e-equipped-background);\n\n          .spell-image {\n            box-shadow: 0 0 0.0625rem 0.0625rem inset\n              var(--t5e-prepared-item-grid-tile-accent-color);\n            border-radius: 0.3125rem;\n          }\n        }\n\n        &.pact {\n          box-shadow: 0 0 0 0.125rem var(--t5e-pact-outline-color);\n          background-color: var(--t5e-pact-background);\n\n          .spell-image {\n            box-shadow: 0 0 0.0625rem 0.0625rem inset\n              var(--t5e-pact-accent-color);\n            border-radius: 0.3125rem;\n          }\n        }\n\n        &.at-will {\n          box-shadow: 0 0 0 0.125rem var(--t5e-atwill-outline-color);\n          background-color: var(--t5e-atwill-background);\n\n          .spell-image {\n            box-shadow: 0 0 0.0625rem 0.0625rem inset\n              var(--t5e-atwill-accent-color);\n            border-radius: 0.3125rem;\n          }\n        }\n\n        &.ritual-only {\n          box-shadow: 0 0 0 0.125rem var(--t5e-ritual-only-outline-color);\n          background-color: var(--t5e-ritual-only-background);\n\n          .spell-image {\n            box-shadow: 0 0 0.0625rem 0.0625rem inset\n              var(--t5e-ritual-only-accent-color);\n            border-radius: 0.3125rem;\n          }\n        }\n\n        &.innate {\n          box-shadow: 0 0 0 0.125rem var(--t5e-innate-outline);\n          background-color: var(--t5e-innate-background);\n\n          .spell-image {\n            box-shadow: 0 0 0.0625rem 0.0625rem inset var(--t5e-innate-accent);\n            border-radius: 0.3125rem;\n          }\n        }\n\n        &.always-prepared {\n          box-shadow: 0 0 0 0.125rem var(--t5e-alwaysprepared-outline-color);\n          background-color: var(--t5e-alwaysprepared-background);\n\n          .spell-image {\n            box-shadow: 0 0 0.0625rem 0.0625rem inset\n              var(--t5e-alwaysprepared-accent-color);\n          }\n        }\n\n        .spell-name {\n          display: block;\n          flex: unset;\n          width: 100%;\n          height: 100%;\n          border-radius: 0.3125rem;\n          overflow: hidden;\n        }\n\n        .spell-image {\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          width: 100%;\n          height: 100%;\n          margin: 0;\n          border-radius: 0;\n          background-repeat: no-repeat;\n          background-size: cover;\n          background-position: 50% 0;\n\n          i {\n            color: var(--t5e-tertiary-color);\n            text-align: center;\n            font-size: 1.125rem;\n            display: none;\n          }\n        }\n\n        &:not([disabled]):hover .spell-name .spell-image {\n          background-image: none !important; // TODO: Figure out a way to avoid !important\n\n          i {\n            display: initial;\n          }\n        }\n\n        .spell-name:hover .spell-image:hover i {\n          color: var(--t5e-primary-font-color);\n        }\n      }\n      .spells-footer {\n        flex: 0 0 auto;\n        height: 3.125rem;\n        margin: 0.125rem;\n        display: flex;\n\n        .footer-command {\n          display: flex;\n          flex: 0 0 3.125rem;\n          justify-content: center;\n          align-items: center;\n          white-space: nowrap;\n          height: 100%;\n          font-size: 1.5rem;\n          color: var(--t5e-faint-color);\n\n          &:hover {\n            color: var(--t5e-tertiary-color);\n          }\n        }\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div\n  class=\"encumbrance\"\n  class:encumbered={context.encumbrance.encumbered}\n  title={localize('TIDY5E.Encumbrance')}\n  style=\"\n    --encumbrance-low: {context.encumbrance.stops?.encumbered ??\n    (1 / 3) * 100}%; \n    --encumbrance-high: {context.encumbrance.stops?.heavilyEncumbered ??\n    (2 / 3) * 100}%\n  \"\n>\n  <span class=\"encumbrance-bar\" style=\"width:{context.encumbrance.pct}%\"\n  ></span>\n  <span class=\"encumbrance-label\"\n    >{context.encumbrance.value} / {context.encumbrance.max}</span\n  >\n  <i class=\"encumbrance-breakpoint encumbrance-low arrow-up\"></i>\n  <i class=\"encumbrance-breakpoint encumbrance-low arrow-down\"></i>\n  <i class=\"encumbrance-breakpoint encumbrance-high arrow-up\"></i>\n  <i class=\"encumbrance-breakpoint encumbrance-high arrow-down\"></i>\n</div>\n\n<style lang=\"scss\">\n  .encumbrance {\n    background: var(--t5e-light-color);\n    border-radius: 0.3125rem;\n    position: relative;\n    box-shadow: 0 0 0 0.0625rem var(--t5e-encumbrance-outline-color) inset;\n\n    .encumbrance-bar {\n      position: absolute;\n      top: 0.0625rem;\n      left: 0.0625rem;\n      bottom: 0.0625rem;\n      max-width: calc(100% - 0.125rem);\n      border: 0.0625rem solid var(--t5e-encumbrance-bar-outline-color);\n      background: var(--t5e-encumbrance-bar-background);\n      border-radius: 0.25rem;\n      transition: width 0.3s ease;\n    }\n\n    .encumbrance-label {\n      display: block;\n      position: relative;\n      width: 100%;\n      text-align: center;\n      font-weight: 700;\n      color: var(--t5e-encumbrance-text-color);\n      text-shadow: 0 0 0.125rem var(--t5e-encumbrance-bar-text-shadow-color);\n    }\n\n    .encumbrance-breakpoint {\n      position: absolute;\n      width: 0;\n      height: 0;\n      transform: translateX(-50%);\n      border: 0.25rem solid transparent;\n    }\n\n    .encumbrance-low {\n      inset-inline-start: var(--encumbrance-low, 33%);\n    }\n\n    .encumbrance-high {\n      inset-inline-start: var(--encumbrance-high, 66%);\n    }\n\n    .arrow-up {\n      bottom: 0;\n      border-bottom-color: var(--t5e-encumbrance-outline-color);\n    }\n\n    .arrow-down {\n      top: 0;\n      border-top-color: var(--t5e-encumbrance-outline-color);\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { AvailableClassLevel } from 'src/types/types';\n  import { formatAsModifier } from 'src/utils/formatting';\n\n  interface Props {\n    availableLevels?: AvailableClassLevel[];\n    disabled?: boolean;\n    item: any;\n  }\n\n  let { availableLevels = [], disabled = false, item }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<select\n  onchange={(event) => FoundryAdapter.onLevelChange(event, item, item.actor)}\n  {disabled}\n>\n  {#each availableLevels as availableLevel}\n    <option\n      value={availableLevel.delta}\n      disabled={availableLevel.disabled || undefined}\n      selected={availableLevel.delta === 0}\n    >\n      {localize('DND5E.LevelNumber', {\n        level: availableLevel.level,\n      })}\n      {#if availableLevel.delta}\n        ({formatAsModifier(availableLevel.delta)})\n      {/if}\n    </option>\n  {/each}\n</select>\n","export function arrayMove(arr: any[], fromIndex: number, toIndex: number) {\n  var element = arr[fromIndex];\n  arr.splice(fromIndex, 1);\n  arr.splice(toIndex, 0, element);\n}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import Listbox from './Listbox.svelte';\n  import type { Snippet } from 'svelte';\n  import { arrayMove } from 'src/utils/array';\n\n  type TItem = $$Generic;\n\n  interface Props {\n    items: TItem[];\n    selectedItemIndex?: number | null;\n    labelProp: keyof TItem;\n    valueProp: keyof TItem;\n    listboxCssClass?: string | null;\n    itemTemplate?: Snippet<[any]>;\n    [key: string]: any;\n  }\n\n  let {\n    items = $bindable(),\n    selectedItemIndex = $bindable(null),\n    labelProp,\n    valueProp,\n    listboxCssClass = null,\n    itemTemplate,\n    ...rest\n  }: Props = $props();\n\n  interface $$Slots {\n    itemTemplate: { item: TItem };\n  }\n\n  function handleListboxKeydown(\n    e: KeyboardEvent & { currentTarget: HTMLElement },\n  ): void {\n    if (e.key === 'ArrowUp' && e.altKey) {\n      moveUp();\n    } else if (e.key === 'ArrowDown' && e.altKey) {\n      moveDown();\n    }\n  }\n\n  function moveUp() {\n    if (\n      selectedItemIndex === null ||\n      selectedItemIndex === 0 ||\n      items === null\n    ) {\n      return;\n    }\n\n    const topValue = items[selectedItemIndex - 1];\n    const bottomValue = items[selectedItemIndex];\n    items[selectedItemIndex - 1] = bottomValue;\n    items[selectedItemIndex] = topValue;\n\n    if (selectedItemIndex) {\n      selectedItemIndex -= 1;\n      items = items;\n    }\n\n    itemsMoved();\n  }\n\n  function moveDown() {\n    if (\n      items === null ||\n      selectedItemIndex === null ||\n      selectedItemIndex >= items.length - 1\n    ) {\n      return;\n    }\n\n    const topValue = items[selectedItemIndex];\n    const bottomValue = items[selectedItemIndex + 1];\n    items[selectedItemIndex] = bottomValue;\n    items[selectedItemIndex + 1] = topValue;\n\n    if (selectedItemIndex !== null) {\n      selectedItemIndex += 1;\n      items = items;\n    }\n\n    itemsMoved();\n  }\n\n  function itemsMoved() {\n    if (\n      selectedItemIndex !== null &&\n      items.at(selectedItemIndex) === undefined\n    ) {\n      selectedItemIndex = items.length ? items.length - 1 : null;\n    }\n  }\n\n  function onDragStart(ev: { item: TItem; index: number; event: DragEvent }) {\n    selectedItemIndex = ev.index;\n    ev.event.dataTransfer?.setData('text/plain', ev.index.toString());\n  }\n\n  function onDrop(ev: { item: TItem; index: number; event: DragEvent }) {\n    ev.event.stopPropagation();\n    ev.event.preventDefault();\n\n    const draggedIndex = parseInt(\n      ev.event.dataTransfer?.getData('text/plain') ?? '',\n    );\n\n    if (isNaN(draggedIndex)) {\n      return;\n    }\n\n    const theDragged = items.at(draggedIndex);\n\n    if (!theDragged) {\n      return;\n    }\n\n    const dropTargetIndex = ev.index;\n\n    arrayMove(items, draggedIndex, dropTargetIndex);\n\n    selectedItemIndex = items.indexOf(theDragged);\n  }\n\n  function onListboxDrop(ev: DragEvent) {\n    const draggedIndex = parseInt(ev.dataTransfer?.getData('text/plain') ?? '');\n\n    if (isNaN(draggedIndex)) {\n      return;\n    }\n\n    const theDragged = items.splice(draggedIndex, 1);\n\n    items.push(...theDragged);\n    items = items;\n  }\n\n  const localize = FoundryAdapter.localize;\n\n  const itemTemplate_render = $derived(itemTemplate);\n</script>\n\n<div class=\"sorting-listbox flex-row small-gap {rest.class ?? ''}\">\n  <div class=\"controls\">\n    <button\n      title={localize('TIDY5E.Listbox.MoveUp')}\n      type=\"button\"\n      disabled={selectedItemIndex === null || selectedItemIndex === 0}\n      aria-keyshortcuts=\"Alt+ArrowUp\"\n      data-testid=\"sorting-listbox-move-up\"\n      onclick={() => moveUp()}\n    >\n      <i class=\"fas fa-angle-up\"></i>\n    </button>\n    <button\n      title={localize('TIDY5E.Listbox.MoveDown')}\n      type=\"button\"\n      disabled={selectedItemIndex === null ||\n        items === null ||\n        selectedItemIndex >= items.length - 1}\n      aria-keyshortcuts=\"Alt+ArrowDown\"\n      onclick={() => moveDown()}\n      data-testid=\"sorting-listbox-move-down\"\n    >\n      <i class=\"fas fa-angle-down\"></i>\n    </button>\n  </div>\n  <Listbox\n    bind:items\n    {labelProp}\n    {valueProp}\n    bind:selectedItemIndex\n    onkeydown={handleListboxKeydown}\n    class=\"flex-1 {listboxCssClass ?? ''}\"\n    draggable={true}\n    ondragstart={(ev) => onDragStart(ev)}\n    ondrop={(ev) => onDrop(ev)}\n    onlistboxDrop={(ev) => onListboxDrop(ev)}\n  >\n    {#snippet itemTemplate({ item })}\n      {#if itemTemplate_render}{@render itemTemplate_render({ item })}{:else}\n        {item[labelProp]}\n      {/if}\n    {/snippet}\n  </Listbox>\n</div>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import SortingListbox from 'src/components/listbox/SortingListbox.svelte';\n  import type { DocumentTabSectionConfigItem } from './section-config.types';\n\n  interface Props {\n    sections: DocumentTabSectionConfigItem[];\n    onSaveChanges: (\n      sections: DocumentTabSectionConfigItem[],\n    ) => void | Promise<void>;\n    onApply: (sections: DocumentTabSectionConfigItem[]) => void | Promise<void>;\n    useDefault: () => void | Promise<void>;\n  }\n\n  let {\n    sections = $bindable(),\n    onSaveChanges,\n    onApply,\n    useDefault,\n  }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<section class=\"document-tab-section-config flex-column small-gap full-height\">\n  <SortingListbox\n    bind:items={sections}\n    labelProp=\"label\"\n    valueProp=\"key\"\n    listboxCssClass=\"scroll-container\"\n    class=\"flex-1 overflow-y-hidden\"\n  >\n    {#snippet itemTemplate({ item })}\n      <span\n        data-section-key={item['key']}\n        data-testid=\"section-config-item-label\"\n        class=\"flex-1\"\n        class:marked-as-hidden={item.show === false}>{item.label}</span\n      >\n      {#if item.show !== false}\n        <button\n          type=\"button\"\n          class=\"inline-icon-button\"\n          title={localize('TIDY5E.Section.ConfigDialog.hideTooltip')}\n          data-testid=\"section-config-hide\"\n          onclick={() => {\n            item.show = false;\n            sections = sections;\n          }}\n        >\n          <i class=\"far fa-eye fa-fw\"></i>\n        </button>\n      {:else}\n        <button\n          type=\"button\"\n          class=\"inline-icon-button\"\n          title={localize('TIDY5E.Section.ConfigDialog.showTooltip')}\n          data-testid=\"section-config-show\"\n          onclick={() => {\n            item.show = true;\n            sections = sections;\n          }}\n        >\n          <i class=\"far fa-eye-slash fa-fw\"></i>\n        </button>\n      {/if}\n    {/snippet}\n  </SortingListbox>\n\n  <div class=\"flex-row small-gap\">\n    <button\n      type=\"button\"\n      class=\"use-default-btn\"\n      data-testid=\"section-config-use-default\"\n      onclick={(ev) => useDefault()}\n    >\n      <i class=\"fas fa-rotate-right\"></i>\n      {localize('TIDY5E.UseDefault')}\n    </button>\n    <button\n      type=\"button\"\n      data-testid=\"section-config-save-changes\"\n      onclick={(ev) => onSaveChanges(sections)}\n      class=\"save-changes-btn\"\n    >\n      <i class=\"fas fa-save\"></i>\n      {localize('TIDY5E.SaveChanges')}\n    </button>\n    <button\n      type=\"button\"\n      class=\"apply-changes-btn\"\n      data-testid=\"section-config-apply-changes\"\n      onclick={() => onApply(sections)}\n    >\n      <i class=\"fas fa-check\"></i>\n      {localize('TIDY5E.ApplyChanges')}\n    </button>\n  </div>\n</section>\n","import { mount } from 'svelte';\nimport SvelteFormApplicationBase from '../SvelteFormApplicationBase';\nimport DocumentTabSectionConfig from './DocumentTabSectionConfig.svelte';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport type { Actor5e, TidySectionBase } from 'src/types/types';\nimport type { DocumentTabSectionConfigItem } from './section-config.types';\nimport type { Item5e } from 'src/types/item.types';\nimport { TidyFlags } from 'src/foundry/TidyFlags';\nimport type { SectionConfig } from 'src/features/sections/sections.types';\n\ntype SectionConfigConstructorArgs = {\n  document: Actor5e | Item5e;\n  sections: TidySectionBase[];\n  tabId: string;\n  tabTitle: string;\n};\n\nexport class DocumentTabSectionConfigApplication extends SvelteFormApplicationBase {\n  document: Actor5e | Item5e;\n  sections = $state<DocumentTabSectionConfigItem[]>()!;\n  tabId: string;\n  tabTitle: string;\n\n  constructor({\n    document,\n    sections,\n    tabId,\n    tabTitle,\n  }: SectionConfigConstructorArgs) {\n    super();\n    this.document = document;\n    this.sections = sections.map((section) => ({\n      key: section.key,\n      label: FoundryAdapter.localize(section.label),\n      show: section.show !== false,\n    }));\n    this.tabId = tabId;\n    this.tabTitle = tabTitle;\n  }\n\n  static get defaultOptions() {\n    return FoundryAdapter.mergeObject(super.defaultOptions, {\n      width: 650,\n      height: 500,\n      id: 'tidy-5e-sheets-section-configuration',\n      popOut: true,\n    });\n  }\n\n  get title() {\n    return FoundryAdapter.localize('TIDY5E.Section.ConfigDialog.title', {\n      tabTitle: this.tabTitle,\n    });\n  }\n\n  createComponent(node: HTMLElement): Record<string, any> {\n    return mount(DocumentTabSectionConfig, {\n      target: node,\n      props: {\n        sections: this.sections,\n        onSaveChanges: this._onSaveChanges.bind(this),\n        onApply: this._onApply.bind(this),\n        useDefault: this._useDefault.bind(this),\n      },\n    });\n  }\n\n  private async _onSaveChanges(sections: DocumentTabSectionConfigItem[]) {\n    await this._onApply(sections);\n    this.close();\n  }\n\n  private async _onApply(sections: DocumentTabSectionConfigItem[]) {\n    const sectionConfig = TidyFlags.sectionConfig.get(this.document) ?? {};\n    sectionConfig[this.tabId] = sections.reduce<Record<string, SectionConfig>>(\n      (result, curr, i) => {\n        result[curr.key] = {\n          key: curr.key,\n          order: i,\n          show: curr.show !== false,\n        };\n        return result;\n      },\n      {}\n    );\n    await TidyFlags.sectionConfig.set(this.document, sectionConfig);\n  }\n\n  private _useDefault() {\n    Dialog.confirm({\n      title: FoundryAdapter.localize('TIDY5E.UseDefaultDialog.title'),\n      content: `<p>${FoundryAdapter.localize(\n        'TIDY5E.UseDefaultDialog.text'\n      )}</p>`,\n      yes: () => {\n        const sectionConfig = TidyFlags.sectionConfig.get(this.document) ?? {};\n        delete sectionConfig[this.tabId];\n        sectionConfig[`-=${this.tabId}`] = {};\n        TidyFlags.sectionConfig.set(this.document, sectionConfig);\n        this.close();\n      },\n      no: () => {},\n      defaultYes: false,\n    });\n  }\n}\n","<script lang=\"ts\">\n  import SkillsList from 'src/sheets/classic/actor/SkillsList.svelte';\n  import Traits from '../../actor/traits/Traits.svelte';\n  import { getContext } from 'svelte';\n  import type {\n    ItemLayoutMode,\n    RenderableClassicControl,\n  } from 'src/types/types';\n  import Currency from '../../actor/Currency.svelte';\n  import ItemTableHeaderRow from 'src/components/item-list/v1/ItemTableHeaderRow.svelte';\n  import ItemTable from 'src/components/item-list/v1/ItemTable.svelte';\n  import ItemTableColumn from 'src/components/item-list/v1/ItemTableColumn.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemTableRow from 'src/components/item-list/v1/ItemTableRow.svelte';\n  import ItemTableCell from 'src/components/item-list/v1/ItemTableCell.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import ItemUseButton from 'src/components/item-list/ItemUseButton.svelte';\n  import ItemName from 'src/components/item-list/ItemName.svelte';\n  import ItemDeleteControl from 'src/components/item-list/controls/ItemDeleteControl.svelte';\n  import ItemEditControl from 'src/components/item-list/controls/ItemEditControl.svelte';\n  import ItemUses from 'src/components/item-list/ItemUses.svelte';\n  import ItemTableFooter from 'src/components/item-list/ItemTableFooter.svelte';\n  import NpcLegendaryActions from '../parts/NpcLegendaryActions.svelte';\n  import SpellbookList from 'src/components/spellbook/SpellbookList.svelte';\n  import NoSpells from '../../actor/NoSpells.svelte';\n  import SpellbookFooter from 'src/components/spellbook/SpellbookFooter.svelte';\n  import ItemFilterLayoutToggle from 'src/components/item-list/ItemFilterLayoutToggle.svelte';\n  import SpellbookGrid from 'src/components/spellbook/SpellbookGrid.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import EncumbranceBar from '../../actor/EncumbranceBar.svelte';\n  import TabFooter from '../../actor/TabFooter.svelte';\n  import RechargeControl from 'src/components/item-list/controls/RechargeControl.svelte';\n  import ActionFilterOverrideControl from 'src/components/item-list/controls/ActionFilterOverrideControl.svelte';\n  import { declareLocation } from 'src/types/location-awareness.types';\n  import UtilityToolbar from 'src/components/utility-bar/UtilityToolbar.svelte';\n  import UtilityToolbarCommand from 'src/components/utility-bar/UtilityToolbarCommand.svelte';\n  import Search from 'src/components/utility-bar/Search.svelte';\n  import FilterMenu from 'src/components/filter/FilterMenu.svelte';\n  import { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\n  import PinnedFilterToggles from 'src/components/filter/PinnedFilterToggles.svelte';\n  import ExpandableContainer from 'src/components/expandable/ExpandableContainer.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import ClassicControls from 'src/sheets/classic/shared/ClassicControls.svelte';\n  import type { Item5e } from 'src/types/item.types';\n  import LevelUpDropdown from 'src/sheets/classic/actor/LevelUpDropdown.svelte';\n  import { DocumentTabSectionConfigApplication } from 'src/applications/section-config/DocumentTabSectionConfigApplication.svelte';\n  import ItemControl from 'src/components/item-list/controls/ItemControl.svelte';\n  import NpcSheetRuntime from 'src/runtime/NpcSheetRuntime.svelte';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import InlineToggleControl from 'src/sheets/classic/shared/InlineToggleControl.svelte';\n  import type { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import { SheetSections } from 'src/features/sections/SheetSections';\n  import { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\n  import { ItemVisibility } from 'src/features/sections/ItemVisibility';\n  import InlineContainerView from 'src/sheets/classic/container/InlineContainerView.svelte';\n  import { ItemUtils } from 'src/utils/ItemUtils';\n  import {\n    createSearchResultsState,\n    setSearchResultsContext,\n  } from 'src/features/search/search.svelte';\n  import { getNpcSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getNpcSheetContext());\n  let tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  let inlineToggleService = getContext<InlineToggleService>(\n    CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n  );\n\n  let noSpellLevels = $derived(!context.spellbook.length);\n\n  let utilityBarCommands = $derived(\n    context.utilities[tabId]?.utilityToolbarCommands ?? [],\n  );\n\n  let features = $derived(\n    SheetSections.configureFeatures(\n      context.features,\n      context,\n      tabId,\n      SheetPreferencesService.getByType(context.actor.type),\n      TidyFlags.sectionConfig.get(context.actor)?.[tabId],\n    ),\n  );\n\n  let searchCriteria: string = $state('');\n\n  const searchResults = createSearchResultsState();\n  setSearchResultsContext(searchResults);\n\n  let spellbook = $derived(\n    !settings.value.showSpellbookTabNpc\n      ? SheetSections.configureSpellbook(\n          context.actor,\n          tabId,\n          context.spellbook,\n        )\n      : [],\n  );\n\n  $effect(() => {\n    searchResults.uuids = ItemVisibility.getItemsToShowAtDepth({\n      criteria: searchCriteria,\n      itemContext: context.itemContext,\n      sections: [...features, ...spellbook],\n      tabId: tabId,\n    });\n  });\n\n  function toggleLayout() {\n    if (layoutMode === 'grid') {\n      TidyFlags.spellbookGrid.unset(context.actor);\n      return;\n    }\n\n    TidyFlags.spellbookGrid.set(context.actor);\n  }\n\n  let layoutMode: ItemLayoutMode = $derived(\n    TidyFlags.spellbookGrid.get(context.actor) ? 'grid' : 'list',\n  );\n\n  let showNoSpellsView = $state(false);\n  const localize = FoundryAdapter.localize;\n\n  declareLocation('abilities');\n\n  let controls: RenderableClassicControl<{ item: Item5e }>[] = $derived.by(\n    () => {\n      let result: RenderableClassicControl<{ item: Item5e }>[] = [\n        {\n          component: ItemEditControl,\n          props: ({ item }) => ({ item }),\n        },\n      ];\n\n      if (context.unlocked) {\n        result.push({\n          component: ItemDeleteControl,\n          props: ({ item }) => ({ item }),\n          visible: ({ item }) => item.canDelete,\n        });\n      }\n\n      if (context.useActionsFeature) {\n        result.push({\n          component: ActionFilterOverrideControl,\n          props: ({ item }) => ({ item }),\n        });\n      }\n\n      return result;\n    },\n  );\n\n  let classicControlsIconWidth = 1.25;\n  let classicControlsColumnWidth = $derived(\n    `${classicControlsIconWidth * controls.length}rem`,\n  );\n</script>\n\n<UtilityToolbar class=\"abilities-toolbar\">\n  <Search bind:value={searchCriteria} />\n  <PinnedFilterToggles\n    filterGroupName={tabId}\n    filters={ItemFilterRuntime.getPinnedFiltersForTab(\n      context.filterPins,\n      context.filterData,\n      tabId,\n    )}\n  />\n  <FilterMenu {tabId} />\n  {#each utilityBarCommands as command (command.title)}\n    <UtilityToolbarCommand\n      title={command.title}\n      iconClass={command.iconClass}\n      text={command.text}\n      visible={command.visible ?? true}\n      onExecute={(ev) => command.execute?.(ev)}\n      sections={features}\n    />\n  {/each}\n</UtilityToolbar>\n\n<section class=\"npc-abilities-content\" data-tidy-track-scroll-y>\n  <div class=\"side-panel\">\n    <SkillsList\n      actor={context.actor}\n      toggleable={!settings.value.alwaysShowNpcSkills}\n      expanded={!!TidyFlags.skillsExpanded.get(context.actor)}\n      toggleField={TidyFlags.skillsExpanded.prop}\n    />\n    {#if !settings.value.moveNpcTraitsToRightOfSkills}\n      <Traits />\n    {/if}\n  </div>\n  <div\n    class=\"main-panel\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NPC_ABILITIES_CONTAINER}\n  >\n    {#if context.hasLegendaries || context.unlocked}\n      <NpcLegendaryActions />\n    {/if}\n    {#if settings.value.moveNpcTraitsToRightOfSkills}\n      <Traits />\n    {/if}\n    {#each features as section (section.key)}\n      {#if section.show}\n        {@const featureEntries = section.items.map((item) => ({\n          item,\n          ctx: context.itemContext[item.id],\n        }))}\n        {@const visibleItemCount = ItemVisibility.countVisibleItems(\n          section.items,\n          searchResults.uuids,\n        )}\n        {#if context.unlocked || visibleItemCount > 0}\n          <ItemTable\n            key={section.key}\n            data-custom-section={section.custom ? true : null}\n          >\n            {#snippet header()}\n              <ItemTableHeaderRow>\n                <ItemTableColumn primary={true}>\n                  {localize(section.label)}\n                </ItemTableColumn>\n                {#if section.hasActions}\n                  <ItemTableColumn baseWidth=\"3.125rem\">\n                    {localize('DND5E.Uses')}\n                  </ItemTableColumn>\n                  <ItemTableColumn baseWidth=\"7.5rem\">\n                    {localize('DND5E.Usage')}\n                  </ItemTableColumn>\n                {/if}\n                {#if section.dataset.type === 'loot'}\n                  <ItemTableColumn baseWidth=\"3rem\">\n                    {localize('DND5E.QuantityAbbr')}\n                  </ItemTableColumn>\n                {/if}\n                {#if context.editable && context.useClassicControls}\n                  <ItemTableColumn baseWidth={classicControlsColumnWidth} />\n                {/if}\n              </ItemTableHeaderRow>\n            {/snippet}\n            {#snippet body()}\n              {#each featureEntries as { item, ctx } (item.id)}\n                <ItemTableRow\n                  onMouseDown={(event) =>\n                    FoundryAdapter.editOnMiddleClick(event, item)}\n                  contextMenu={{\n                    type: CONSTANTS.CONTEXT_MENU_TYPE_ITEMS,\n                    uuid: item.uuid,\n                  }}\n                  {item}\n                  cssClass={FoundryAdapter.getInventoryRowClasses(item, ctx)}\n                  hidden={!searchResults.show(item.uuid)}\n                >\n                  {#snippet children({ toggleSummary })}\n                    <ItemTableCell primary={true}>\n                      <ItemUseButton disabled={!context.editable} {item} />\n                      {#if 'containerContents' in ctx && !!ctx.containerContents}\n                        <InlineToggleControl\n                          entityId={item.id}\n                          {inlineToggleService}\n                        />\n                      {/if}\n                      <ItemName\n                        onToggle={() => toggleSummary(context.actor)}\n                        cssClass=\"extra-small-gap\"\n                        {item}\n                      >\n                        {#if ctx.parent}&rdsh;{/if}\n                        {#if !section.isClass && item.type === 'subclass'}\n                          <i class=\"fa-solid fa-link-slash align-self-center\"\n                          ></i>\n                        {/if}\n                        <span\n                          class=\"truncate flex-1\"\n                          data-tidy-item-name={item.name}\n                          data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_NAME}\n                          >{item.name}</span\n                        >\n                      </ItemName>\n                      {#if item.type === 'class'}\n                        <LevelUpDropdown\n                          availableLevels={ctx?.availableLevels}\n                          {item}\n                          disabled={!context.editable ||\n                            context.lockLevelSelector}\n                        />\n                      {/if}\n                    </ItemTableCell>\n                    {#if section.hasActions}\n                      <ItemTableCell baseWidth=\"3.125rem\">\n                        {#if item.isOnCooldown}\n                          <RechargeControl\n                            document={item}\n                            field={'system.uses.spent'}\n                            uses={item.system.uses}\n                          />\n                        {:else if item.hasRecharge}\n                          {@const remaining =\n                            item.system.uses.max - item.system.uses.spent}\n                          {#if remaining > 1}\n                            <span>{remaining}</span>\n                          {/if}\n                          <i\n                            class=\"fas fa-bolt\"\n                            title={localize('DND5E.Charged')}\n                          ></i>\n                        {:else if ctx?.hasUses}\n                          <ItemUses {item} />\n                        {:else}\n                          <span class=\"text-body-tertiary\">&mdash;</span>\n                        {/if}\n                      </ItemTableCell>\n                      <ItemTableCell baseWidth=\"7.5rem\">\n                        {#if ItemUtils.hasActivationType(item)}\n                          {item.labels?.activation ?? ''}\n                        {/if}\n                      </ItemTableCell>\n                    {/if}\n                    {#if section.dataset.type === 'loot'}\n                      <ItemTableCell baseWidth=\"3rem\">\n                        <TextInput\n                          document={item}\n                          field=\"system.quantity\"\n                          value={item.system.quantity}\n                          selectOnFocus={true}\n                          disabled={!context.editable ||\n                            context.lockItemQuantity}\n                          placeholder=\"0\"\n                          allowDeltaChanges={true}\n                          class=\"text-align-center\"\n                        />\n                      </ItemTableCell>\n                    {/if}\n                    {#if context.editable && context.useClassicControls}\n                      <ItemTableCell baseWidth={classicControlsColumnWidth}>\n                        <ClassicControls {controls} params={{ item }} />\n                      </ItemTableCell>\n                    {/if}\n                  {/snippet}\n                </ItemTableRow>\n                {#if 'containerContents' in ctx && !!ctx.containerContents}\n                  <InlineContainerView\n                    container={item}\n                    containerContents={ctx.containerContents}\n                    editable={context.editable}\n                    {inlineToggleService}\n                    lockItemQuantity={context.lockItemQuantity}\n                    sheetDocument={context.actor}\n                    unlocked={context.unlocked}\n                  />\n                {/if}\n              {/each}\n              {#if context.unlocked && section.dataset}\n                <ItemTableFooter\n                  actor={context.actor}\n                  {section}\n                  isItem={true}\n                />\n              {/if}\n            {/snippet}\n          </ItemTable>\n        {/if}\n      {/if}\n    {/each}\n    {#if !settings.value.showSpellbookTabNpc}\n      {#if noSpellLevels}\n        <h2>\n          <button\n            type=\"button\"\n            class=\"transparent-button spellbook-title toggle-spellbook\"\n            onclick={() => (showNoSpellsView = !showNoSpellsView)}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n          >\n            {localize('DND5E.Spellbook')}\n            {#if showNoSpellsView}\n              <i class=\"fas fa-caret-up\"></i>\n            {:else}\n              <i class=\"fas fa-caret-down\"></i>\n            {/if}\n          </button>\n        </h2>\n      {:else}\n        <h2 class=\"spellbook-title\">\n          <span>{localize('DND5E.Spellbook')}</span>\n          <span class=\"flex-row extra-small-gap\">\n            <ItemFilterLayoutToggle\n              mode={layoutMode}\n              element=\"span\"\n              onToggle={() => toggleLayout()}\n            />\n            <ItemControl\n              iconCssClass=\"fas fa-cog\"\n              title=\"TIDY5E.Utilities.ConfigureSections\"\n              onclick={() =>\n                new DocumentTabSectionConfigApplication({\n                  document: context.actor,\n                  sections: context.spellbook,\n                  tabId: CONSTANTS.TAB_ACTOR_SPELLBOOK,\n                  tabTitle: NpcSheetRuntime.getTabTitle(\n                    CONSTANTS.TAB_ACTOR_SPELLBOOK,\n                  ),\n                }).render(true)}\n            />\n          </span>\n        </h2>\n      {/if}\n\n      <div\n        class=\"flex-1 flex-column small-padding-bottom no-gap\"\n        class:hidden={noSpellLevels && !showNoSpellsView}\n      >\n        {#if noSpellLevels}\n          <NoSpells cssClass=\"flex-1\" editable={context.unlocked} />\n        {:else}\n          <div class=\"flex-1 small-padding-bottom flex-column small-gap\">\n            {#each spellbook as section (section.key)}\n              {#if section.show}\n                {#if layoutMode === 'list'}\n                  <SpellbookList\n                    {section}\n                    allowFavorites={false}\n                    includeRange={false}\n                    includeSchool={false}\n                    spellComponentsBaseWidth=\"3.125rem\"\n                    targetBaseWidth=\"5.625rem\"\n                    usageBaseWidth=\"5.625rem\"\n                  />\n                {:else}\n                  <SpellbookGrid {section} />\n                {/if}\n              {/if}\n            {/each}\n          </div>\n        {/if}\n\n        <SpellbookFooter\n          includeAttackMod={false}\n          includePreparedSpells={false}\n          cssClass=\"npc-abilities-spellbook-footer\"\n        />\n      </div>\n    {/if}\n  </div>\n</section>\n<TabFooter mode=\"vertical\" cssClass=\"abilities-footer\">\n  <Currency document={context.actor} />\n  {#if settings.value.useNpcEncumbranceBar}\n    <EncumbranceBar />\n  {/if}\n</TabFooter>\n\n<style lang=\"scss\">\n  section {\n    flex: 1;\n  }\n\n  :global(.tidy5e-sheet .abilities-footer) {\n    flex: 0;\n  }\n\n  .npc-abilities-content {\n    display: flex;\n    flex-direction: row;\n    gap: 0.5rem;\n    padding-right: 0.75rem;\n    overflow-y: scroll;\n\n    > .side-panel {\n      flex: 0 0 13.75rem;\n      display: flex;\n      flex-direction: column;\n      gap: 0.5rem;\n    }\n\n    > .main-panel {\n      display: flex;\n      flex-direction: column;\n      flex: 1;\n      padding: 0;\n      height: auto;\n      gap: 0.5rem;\n    }\n\n    .spellbook-title {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 0 0.25rem 0.125rem 0;\n      margin-top: 0.5rem;\n      line-height: 1;\n      border: 0.0625rem solid var(--t5e-light-color);\n      border-left: none;\n      border-right: none;\n      font-family: var(--t5e-title-font-family);\n      font-weight: 700;\n      font-size: 1.125rem;\n\n      &.toggle-spellbook {\n        opacity: 0.4;\n        transition: opacity 0.3s ease;\n        cursor: pointer;\n\n        &:hover {\n          opacity: 1;\n        }\n      }\n\n      :global(.toggle-layout) {\n        list-style: none;\n        margin: 0;\n        padding: 0;\n        padding-top: 0.125rem;\n        line-height: 0.75;\n        font-size: 0.875rem;\n      }\n    }\n\n    :global(.npc-abilities-spellbook-footer) {\n      margin: 0 0 -0.5rem 0;\n      padding: 0.375rem 0.25rem;\n    }\n    :global(.npc-abilities-spellbook-footer h3) {\n      font-size: 1.125rem;\n    }\n    :global(.npc-abilities-spellbook-footer input) {\n      height: 1.125rem;\n    }\n  }\n\n  .main-panel :global(.legendary-wrapper:not(.legendary-expanded)) {\n    margin-bottom: -0.5rem;\n  }\n</style>\n","<script lang=\"ts\">\n  import type { SpellSourceClassAssignmentsContext } from './SpellSourceClassAssignmentsFormApplication.svelte';\n  import { getContext } from 'svelte';\n  import { CONSTANTS } from 'src/constants';\n  import Search from 'src/components/utility-bar/Search.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import TidyTable, {\n    type TidyTableColumns,\n  } from 'src/components/table/TidyTable.svelte';\n  import type { Item5e } from 'src/types/item.types';\n  import TidyTableHeaderCell from 'src/components/table/TidyTableHeaderCell.svelte';\n  import TidyTableHeaderRow from 'src/components/table/TidyTableHeaderRow.svelte';\n  import TidyTableRow from 'src/components/table/TidyTableRow.svelte';\n  import TidyTableCell from 'src/components/table/TidyTableCell.svelte';\n  import TidySwitch from 'src/components/toggles/TidySwitch.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import type { CoarseReactivityProvider } from 'src/features/reactivity/CoarseReactivityProvider.svelte';\n\n  let context = $derived(\n    getContext<CoarseReactivityProvider<SpellSourceClassAssignmentsContext>>(\n      CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n    ).data,\n  );\n\n  let searchCriteria: string = $state('');\n\n  let visibleSelectablesIdSubset = $derived(\n    new Set<string>(\n      context.assignments\n        .filter(\n          (s) =>\n            searchCriteria.trim() === '' ||\n            s.item.name?.toLowerCase().includes(searchCriteria.toLowerCase()),\n        )\n        .map((d) => d.item.id),\n    ),\n  );\n\n  let classColumns = $derived(\n    Object.entries<Item5e>(context.actor.spellcastingClasses).map(\n      ([key, value]) => ({\n        key: key,\n        item: value,\n      }),\n    ),\n  );\n\n  let gridTemplateColumns: TidyTableColumns = $derived.by(() => {\n    let columns: TidyTableColumns = [\n      { name: 'Spell Name', width: 'minmax(12.5rem, 1fr)' },\n    ];\n\n    let standardClassColumnWidth = '10rem';\n    classColumns.forEach((column) => {\n      columns.push({ name: column.item.name, width: standardClassColumnWidth });\n    });\n\n    columns.push({ name: 'Identifier', width: '12.5rem' });\n\n    return columns;\n  });\n\n  async function setItemSourceClass(item: Item5e, sourceClass: string) {\n    await item.update({\n      'system.sourceClass': sourceClass,\n    });\n  }\n\n  const localize = FoundryAdapter.localize;\n\n  var showUnassignedOnly = $state(false);\n</script>\n\n<section class=\"flex-column small-gap full-height\">\n  <div role=\"presentation\" class=\"flex-row small-gap\">\n    <Search bind:value={searchCriteria} />\n    <label class=\"flex-row extra-small-gap align-items-center\">\n      <input type=\"checkbox\" bind:checked={showUnassignedOnly} />\n      {localize('TIDY5E.SpellSourceClassAssignments.ShowUnassignedOnly.Text')}\n    </label>\n  </div>\n  <div role=\"presentation\" class=\"scroll-container flex-1\">\n    <TidyTable\n      key=\"spell-source-class-assignments-matrix\"\n      toggleable={false}\n      {gridTemplateColumns}\n    >\n      {#snippet header()}\n        <TidyTableHeaderRow>\n          <TidyTableHeaderCell primary={true} class=\"p-1 capitalize\">\n            {localize('DND5E.spell')}\n          </TidyTableHeaderCell>\n          {#each classColumns as classColumn}\n            <TidyTableHeaderCell>\n              {classColumn.item.name}\n            </TidyTableHeaderCell>\n          {/each}\n          <TidyTableHeaderCell class=\"flex-row small-gap\">\n            <span\n              >{localize('TIDY5E.SpellSourceClassAssignments.Identifier')}</span\n            >\n            <i\n              class=\"fas fa-question-circle\"\n              title={localize(\n                'TIDY5E.SpellSourceClassAssignments.IdentifierHint',\n              )}\n            ></i>\n          </TidyTableHeaderCell>\n        </TidyTableHeaderRow>\n      {/snippet}\n      {#snippet body()}\n        {#each context.assignments as assignment (assignment.item.id)}\n          {@const sourceClassIsUnassigned =\n            (assignment.item.system.sourceClass?.trim() ?? '') === ''}\n          {@const hideRow =\n            !visibleSelectablesIdSubset.has(assignment.item.id) ||\n            (showUnassignedOnly && !sourceClassIsUnassigned)}\n          <TidyTableRow hidden={hideRow}>\n            <TidyTableCell primary={true} class=\"p-1 semibold\">\n              <button\n                type=\"button\"\n                class=\"inline-transparent-button highlight-on-hover\"\n                onclick={async () =>\n                  FoundryAdapter.renderSheetFromUuid(assignment.item.uuid)}\n              >\n                {assignment.item.name}\n              </button>\n            </TidyTableCell>\n            {#each classColumns as classColumn}\n              {@const selected =\n                assignment.item.system.sourceClass === classColumn.key}\n              <TidyTableHeaderCell>\n                <TidySwitch\n                  checked={selected}\n                  onChange={(ev) =>\n                    setItemSourceClass(\n                      assignment.item,\n                      ev.currentTarget.checked ? classColumn.key : '',\n                    )}\n                />\n              </TidyTableHeaderCell>\n            {/each}\n            <TidyTableCell>\n              <TextInput\n                document={assignment.item}\n                disabled={!assignment.item.isOwner}\n                field=\"system.sourceClass\"\n                selectOnFocus={true}\n                value={assignment.item.system.sourceClass}\n              />\n            </TidyTableCell>\n          </TidyTableRow>\n        {/each}\n      {/snippet}\n    </TidyTable>\n  </div>\n</section>\n","import { mount } from 'svelte';\nimport AssignSpellsToSourceClasses from './SpellSourceClassAssignments.svelte';\nimport SvelteFormApplicationBase from '../SvelteFormApplicationBase';\nimport type { Actor5e } from 'src/types/types';\nimport type { Item5e } from 'src/types/item.types';\nimport { CONSTANTS } from 'src/constants';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { CoarseReactivityProvider } from 'src/features/reactivity/CoarseReactivityProvider.svelte';\n\nexport type SpellSourceClassAssignment = {\n  /**\n   * The spell to receive an assignment.\n   */\n  item: Item5e;\n  /**\n   * Represents the chosen source class.\n   */\n  sourceClass: string;\n};\n\nexport type SpellSourceClassAssignmentsContext = {\n  actor: Actor5e;\n  assignments: SpellSourceClassAssignment[];\n};\n\nexport default class SpellSourceClassAssignmentsFormApplication extends SvelteFormApplicationBase {\n  context = new CoarseReactivityProvider<\n    SpellSourceClassAssignmentsContext | undefined\n  >(undefined);\n  actor: Actor5e;\n  updateHook: number | undefined;\n\n  constructor(actor: Actor5e, ...args: any[]) {\n    super(...args);\n    this.actor = actor;\n  }\n\n  createComponent(node: HTMLElement): Record<string, any> {\n    this.context.data = this.getData();\n\n    return mount(AssignSpellsToSourceClasses, {\n      target: node,\n      context: new Map<any, any>([\n        ['appId', this.appId],\n        ['context', this.context],\n      ]),\n    });\n  }\n\n  getData(): SpellSourceClassAssignmentsContext {\n    return {\n      actor: this.actor,\n      assignments: this.actor.items\n        .filter((item: Item5e) => item.type === CONSTANTS.ITEM_TYPE_SPELL)\n        .map((item: Item5e) => ({\n          item,\n          sourceClass: 'test',\n        })),\n    };\n  }\n\n  activateListeners(html: any): void {\n    if (this.updateHook !== undefined) {\n      Hooks.off('updateItem', this.updateHook);\n    }\n    this.trackActorChanges();\n    super.activateListeners(html);\n  }\n\n  private trackActorChanges() {\n    this.updateHook = Hooks.on('updateItem', (item: Item5e) => {\n      if (item.actor?.id !== this.actor.id) {\n        return;\n      }\n\n      this.context.data = this.getData();\n    });\n  }\n\n  get title() {\n    return FoundryAdapter.localize('TIDY5E.Utilities.AssignSpellsToClasses');\n  }\n\n  close(options: unknown = {}) {\n    Hooks.off('updateItem', this.updateHook);\n    return super.close(options);\n  }\n}\n","<script lang=\"ts\">\n  import SpellbookFooter from 'src/components/spellbook/SpellbookFooter.svelte';\n  import SpellbookGrid from 'src/components/spellbook/SpellbookGrid.svelte';\n  import SpellbookList from 'src/components/spellbook/SpellbookList.svelte';\n  import type { ItemLayoutMode } from 'src/types/types';\n  import { getContext } from 'svelte';\n  import NoSpells from '../../actor/NoSpells.svelte';\n  import UtilityToolbar from 'src/components/utility-bar/UtilityToolbar.svelte';\n  import Search from 'src/components/utility-bar/Search.svelte';\n  import UtilityToolbarCommand from 'src/components/utility-bar/UtilityToolbarCommand.svelte';\n  import FilterMenu from 'src/components/filter/FilterMenu.svelte';\n  import PinnedFilterToggles from 'src/components/filter/PinnedFilterToggles.svelte';\n  import { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import { SheetSections } from 'src/features/sections/SheetSections';\n  import { ItemVisibility } from 'src/features/sections/ItemVisibility';\n  import { CONSTANTS } from 'src/constants';\n  import ButtonMenu from 'src/components/button-menu/ButtonMenu.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ButtonMenuCommand from 'src/components/button-menu/ButtonMenuCommand.svelte';\n  import SpellSourceClassAssignmentsFormApplication from 'src/applications/spell-source-class-assignments/SpellSourceClassAssignmentsFormApplication.svelte';\n  import {\n    createSearchResultsState,\n    setSearchResultsContext,\n  } from 'src/features/search/search.svelte';\n  import { getNpcSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getNpcSheetContext());\n  let tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  let searchCriteria: string = $state('');\n\n  let spellbook = $derived(\n    SheetSections.configureSpellbook(context.actor, tabId, context.spellbook),\n  );\n\n  const searchResults = createSearchResultsState();\n  setSearchResultsContext(searchResults);\n\n  $effect(() => {\n    searchResults.uuids = ItemVisibility.getItemsToShowAtDepth({\n      criteria: searchCriteria,\n      itemContext: context.itemContext,\n      sections: spellbook,\n      tabId: tabId,\n    });\n  });\n\n  let layoutMode: ItemLayoutMode = $derived(\n    TidyFlags.spellbookGrid.get(context.actor) ? 'grid' : 'list',\n  );\n\n  let noSpellLevels = $derived(!context.spellbook.length);\n\n  let utilityBarCommands = $derived(\n    context.utilities[tabId]?.utilityToolbarCommands ?? [],\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<UtilityToolbar>\n  <Search bind:value={searchCriteria} />\n  <PinnedFilterToggles\n    filterGroupName={tabId}\n    filters={ItemFilterRuntime.getPinnedFiltersForTab(\n      context.filterPins,\n      context.filterData,\n      tabId,\n    )}\n  />\n  <FilterMenu {tabId}>\n    {#snippet beforeClearButton()}\n      <div class=\"filter-option-group\">\n        <label class=\"filter-option flex-row no-gap align-items-center\">\n          <input\n            type=\"checkbox\"\n            checked={TidyFlags.includeRitualsInCanCast.get(context.actor)}\n            onchange={(ev) =>\n              TidyFlags.includeRitualsInCanCast.set(\n                context.actor,\n                ev.currentTarget.checked,\n              )}\n          />\n          <span\n            >{localize('TIDY5E.ItemFilters.Options.IncludeRitualsInCanCast')}</span\n          >\n        </label>\n      </div>\n    {/snippet}\n  </FilterMenu>\n  <ButtonMenu\n    iconClass=\"ra ra-fairy-wand\"\n    buttonStyle=\"transparent-inline-icon\"\n    position=\"bottom\"\n    anchor=\"right\"\n    title={localize('TIDY5E.Utilities.Tools')}\n    menuElement=\"div\"\n  >\n    <ButtonMenuCommand\n      onMenuClick={() => {\n        new SpellSourceClassAssignmentsFormApplication(context.actor).render(\n          true,\n        );\n      }}\n      iconClass=\"fas fa-list-check\"\n      disabled={!context.editable}\n    >\n      {localize('TIDY5E.Utilities.AssignSpellsToClasses')}\n    </ButtonMenuCommand>\n  </ButtonMenu>\n  {#each utilityBarCommands as command (command.title)}\n    <UtilityToolbarCommand\n      title={command.title}\n      iconClass={command.iconClass}\n      text={command.text}\n      visible={command.visible ?? true}\n      onExecute={(ev) => command.execute?.(ev)}\n      sections={spellbook}\n    />\n  {/each}\n</UtilityToolbar>\n\n<div class=\"scroll-container flex-column small-gap\">\n  {#if noSpellLevels}\n    <NoSpells editable={context.unlocked} />\n  {:else}\n    {#each spellbook as section (section.key)}\n      {#if section.show}\n        {@const visibleItemCount = ItemVisibility.countVisibleItems(\n          section.spells,\n          searchResults.uuids,\n        )}\n        {#if (searchCriteria.trim() === '' && context.unlocked) || visibleItemCount > 0 || !!section.slots}\n          {#if layoutMode === 'list'}\n            <SpellbookList allowFavorites={false} {section} />\n          {:else}\n            <SpellbookGrid {section} />\n          {/if}\n        {/if}\n      {/if}\n    {/each}\n  {/if}\n</div>\n<SpellbookFooter />\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n  interface Props {\n    /**\n     * The HTML to render or to edit.\n     */\n    content: string;\n    /**\n     * The data field to update via form post, which will be applied to the entity the form represents (e.g., to the Actor).\n     */\n    target: string;\n    /**\n     * Whether or not the editor is editable or readonly.\n     */\n    editable: boolean;\n  }\n\n  let { content, target, editable }: Props = $props();\n</script>\n\n{@html FoundryAdapter.createEditorHtml(content, target, editable)}\n","export function isRealNumber(inNumber: number | undefined | null): boolean {\n  return (\n    inNumber !== undefined &&\n    inNumber !== null &&\n    !isNaN(inNumber) &&\n    typeof inNumber === 'number' &&\n    isFinite(inNumber)\n  );\n}\n\nexport function clamp<T extends number>(num: T, min: T, max: T) {\n  return Math.min(Math.max(num, min), max);\n}\n\nexport function getPercentage(\n  value: number | null | undefined,\n  max: number | null | undefined\n) {\n  max ??= 0;\n  value ??= 0;\n\n  if (max <= 0) {\n    return 0;\n  }\n\n  const percentage = Math.ceil((value / max) * 100);\n\n  return clamp(percentage, 0, 100);\n}\n\nexport function toNumber(str: string) {\n  if (str.includes('/')) {\n    const pieces = str.split('/');\n    return parseInt(pieces[0]) / parseInt(pieces[1]);\n  }\n  return +str;\n}\n\nexport function isLessThanOneIsOne(inNumber: number) {\n  return inNumber < 1 ? 1 : inNumber;\n}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type {\n    ContainerSheetClassicContext,\n    ItemSheetContext,\n  } from 'src/types/item.types';\n  import type {\n    CharacterSheetContext,\n    NpcSheetContext,\n    VehicleSheetContext,\n  } from 'src/types/types';\n  import { ActiveEffectsHelper } from 'src/utils/active-effect';\n  import { toNumber } from 'src/utils/numbers';\n\n  interface Props {\n    element: keyof HTMLElementTagNameMap;\n    document: any;\n    field: string;\n    value: string;\n    editable: boolean;\n    cssClass?: string;\n    spellcheck?: boolean;\n    dataMaxLength?: number;\n    placeholder?: string | null;\n    saveAs?: 'string' | 'number';\n    title?: string | null;\n    selectOnFocus?: boolean;\n  }\n\n  let {\n    element,\n    document,\n    field,\n    value,\n    editable,\n    cssClass = '',\n    spellcheck = false,\n    dataMaxLength = 40,\n    placeholder = null,\n    saveAs = 'string',\n    title = null,\n    selectOnFocus = false,\n  }: Props = $props();\n\n  let draftValue = $state('');\n\n  $effect(() => {\n    draftValue = value;\n  });\n\n  async function update() {\n    draftValue = new DOMParser().parseFromString(draftValue, 'text/html').body\n      .textContent ?? '';\n      \n    if (draftValue.length > dataMaxLength) {\n      draftValue = draftValue.substring(0, dataMaxLength)?.replaceAll('\\n', '');\n    }\n\n    const valueToSave = saveAs === 'number' ? toNumber(draftValue) : draftValue;\n\n    await document.update({ [field]: valueToSave });\n  }\n\n  function submitWhenEnterKey(e: KeyboardEvent) {\n    if (e.key == 'Enter') {\n      e.preventDefault();\n      update();\n    }\n  }\n\n  // svelte-ignore non_reactive_update\n  let _el: HTMLElement;\n\n  // [contenteditable] pasting can include HTML\n  // Only the text content is appropriate for this component\n  function handlePaste(ev: ClipboardEvent) {\n    setTimeout(() => {\n      value = _el.textContent?.replaceAll('\\n', '') ?? '';\n    }, 0);\n  }\n\n  function onFocus(ev: Event & { currentTarget: HTMLElement }) {\n    if (selectOnFocus && window.getSelection) {\n      const selection = window.getSelection();\n      const range = window.document.createRange();\n      range.selectNodeContents(ev.currentTarget);\n      selection?.removeAllRanges();\n      selection?.addRange(range);\n    }\n  }\n\n  const context =\n    $derived(\n      getSheetContext<\n        | CharacterSheetContext\n        | NpcSheetContext\n        | VehicleSheetContext\n        | ContainerSheetClassicContext\n        | ItemSheetContext\n      >(),\n    );\n\n  const localize = FoundryAdapter.localize;\n\n  let activeEffectApplied = $derived(\n    ActiveEffectsHelper.isActiveEffectAppliedToField(document, field),\n  );\n  let isEnchanted = $derived(\n    context.itemOverrides instanceof Set && context.itemOverrides.has(field),\n  );\n  let overrideTooltip = $derived(\n    isEnchanted\n      ? localize('DND5E.ENCHANTMENT.Warning.Override')\n      : localize('DND5E.ActiveEffectOverrideWarning'),\n  );\n</script>\n\n{#if editable && !activeEffectApplied}\n  <svelte:element\n    this={element}\n    bind:this={_el}\n    contenteditable=\"true\"\n    class={cssClass}\n    bind:innerHTML={draftValue}\n    onblur={update}\n    onkeypress={submitWhenEnterKey}\n    onpaste={handlePaste}\n    onfocus={onFocus}\n    role=\"textbox\"\n    tabindex=\"0\"\n    {spellcheck}\n    data-max-length={dataMaxLength}\n    data-placeholder={placeholder}\n    {title}\n    data-tidy-field={field}\n  ></svelte:element>\n{:else}\n  <svelte:element\n    this={element}\n    class={cssClass}\n    {title}\n    data-tidy-field={field}\n    data-tooltip={activeEffectApplied ? overrideTooltip : null}\n  >\n    {value}\n  </svelte:element>\n{/if}\n\n<style lang=\"scss\">\n  [contenteditable] {\n    border: none;\n    outline: none;\n    border-radius: 0.1875rem;\n    -moz-user-select: text;\n    -khtml-user-select: text;\n    -webkit-user-select: text;\n    -o-user-select: text;\n    user-select: text;\n\n    &:empty::before {\n      content: attr(data-placeholder);\n      pointer-events: none;\n      display: block; // For Firefox\n      color: var(--t5e-tertiary-color);\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { getContext, type Snippet } from 'svelte';\n  import type { SheetStats } from 'src/types/types';\n  import { CONSTANTS } from 'src/constants';\n\n  let stats = getContext<SheetStats>(CONSTANTS.SVELTE_CONTEXT.STATS);\n\n  interface Props {\n    andOnValueChange?: unknown | null;\n    children?: Snippet;\n  }\n\n  let { andOnValueChange = null, children }: Props = $props();\n</script>\n\n{#key stats.lastSubmissionTime}\n  {#key andOnValueChange}\n    {@render children?.()}\n  {/key}\n{/key}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import SheetEditor from 'src/components/editor/SheetEditor.svelte';\n  import ContentEditableFormField from 'src/components/inputs/ContentEditableFormField.svelte';\n  import RerenderAfterFormSubmission from 'src/components/utility/RerenderAfterFormSubmission.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import SheetEditorV2 from 'src/components/editor/SheetEditorV2.svelte';\n  import { getNpcSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getNpcSheetContext());\n\n  const localize = FoundryAdapter.localize;\n\n  let showNpcPersonalityInfo = $derived(\n    TidyFlags.showNpcPersonalityInfo.get(context.actor) ?? false,\n  );\n\n  function togglePersonalityInfo() {\n    TidyFlags.setFlag(\n      context.actor,\n      'showNpcPersonalityInfo',\n      !showNpcPersonalityInfo,\n    );\n  }\n\n  type FlagBioField = {\n    prop: string;\n    value: string | undefined | null;\n    text: string;\n  };\n\n  let bioFields: FlagBioField[] = $derived([\n    {\n      prop: TidyFlags.gender.prop,\n      value: TidyFlags.gender.get(context.actor),\n      text: 'DND5E.Gender',\n    },\n    {\n      prop: TidyFlags.age.prop,\n      value: TidyFlags.age.get(context.actor),\n      text: 'DND5E.Age',\n    },\n    {\n      prop: TidyFlags.height.prop,\n      value: TidyFlags.height.get(context.actor),\n      text: 'DND5E.Height',\n    },\n    {\n      prop: TidyFlags.weight.prop,\n      value: TidyFlags.weight.get(context.actor),\n      text: 'DND5E.Weight',\n    },\n    {\n      prop: TidyFlags.eyes.prop,\n      value: TidyFlags.eyes.get(context.actor),\n      text: 'DND5E.Eyes',\n    },\n    {\n      prop: TidyFlags.skin.prop,\n      value: TidyFlags.skin.get(context.actor),\n      text: 'DND5E.Skin',\n    },\n    {\n      prop: TidyFlags.hair.prop,\n      value: TidyFlags.hair.get(context.actor),\n      text: 'DND5E.Hair',\n    },\n    {\n      prop: TidyFlags.faith.prop,\n      value: TidyFlags.faith.get(context.actor),\n      text: 'DND5E.Faith',\n    },\n  ]);\n\n  let editing = $state(false);\n  let contentToEdit: string = $state('');\n  let enrichedText: string = $state('');\n  let fieldToEdit: string = $state('');\n\n  async function stopEditing() {\n    await context.actor.sheet.submit();\n    editing = false;\n  }\n\n  function edit(value: string, enriched: string, field: string) {\n    contentToEdit = value;\n    fieldToEdit = field;\n    enrichedText = enriched;\n    editing = true;\n  }\n</script>\n\n<div class=\"scroll-container\">\n  {#if editing}\n    {#key contentToEdit}\n      <article class=\"editor-container flex-column full-height singleton\">\n        <SheetEditorV2\n          enriched={enrichedText}\n          content={contentToEdit}\n          field={fieldToEdit}\n          editorOptions={{\n            editable: context.editable,\n            toggled: false,\n          }}\n          documentUuid={context.actor.uuid}\n          onSave={() => stopEditing()}\n          manageSecrets={context.actor.isOwner}\n        />\n      </article>\n    {/key}\n  {/if}\n  <div class=\"notes-container\" class:hidden={editing}>\n    <div\n      class=\"top-notes note-entries\"\n      class:limited={context.showLimitedSheet}\n    >\n      <article>\n        <ul class=\"character-details\">\n          {#each bioFields as bioField (bioField.prop)}\n            <li>\n              <span>{localize(bioField.text)}:</span>\n              <ContentEditableFormField\n                selectOnFocus={true}\n                element=\"span\"\n                editable={context.editable && !context.lockSensitiveFields}\n                document={context.actor}\n                field={bioField.prop}\n                value={bioField.value ?? ''}\n                cssClass=\"detail-input\"\n              />\n            </li>\n          {/each}\n        </ul>\n      </article>\n    </div>\n    <div class=\"bottom-notes\">\n      <button\n        type=\"button\"\n        onclick={togglePersonalityInfo}\n        class=\"toggle-personality-info\"\n        title={localize('TIDY5E.TogglePersonalityInfo')}\n        tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n      >\n        {#if showNpcPersonalityInfo}\n          <i class=\"fas fa-angle-double-left\"></i>\n        {:else}\n          <i class=\"fas fa-angle-double-right\"></i>\n        {/if}\n      </button>\n      <div class=\"main-notes\">\n        {#if showNpcPersonalityInfo}\n          <div\n            class=\"left-notes note-entries hide-editor-edit\"\n            class:limited={context.showLimitedSheet}\n          >\n            {@render biopage(\n              'DND5E.PersonalityTraits',\n              TidyFlags.trait.get(context.actor) ?? '',\n              context.traitEnrichedHtml,\n              TidyFlags.trait.prop,\n            )}\n\n            {@render biopage(\n              'DND5E.Ideals',\n              context.system.details.ideal,\n              context.idealEnrichedHtml,\n              'system.details.ideal',\n            )}\n\n            {@render biopage(\n              'DND5E.Bonds',\n              context.system.details.bond,\n              context.bondEnrichedHtml,\n              'system.details.bond',\n            )}\n\n            {@render biopage(\n              'DND5E.Flaws',\n              context.system.details.flaw,\n              context.flawEnrichedHtml,\n              'system.details.flaw',\n            )}\n          </div>\n        {/if}\n        <div\n          class=\"right-notes note-entries hide-editor-edit\"\n          class:limited={context.showLimitedSheet}\n        >\n          <!-- TODO: Offload this kind of thing to itemContext -->\n          <RerenderAfterFormSubmission\n            andOnValueChange={TidyFlags.appearance.get(context.actor) ?? ''}\n          >\n            <article class=\"appearance-notes\" use:context.activateEditors>\n              <div\n                class=\"section-titles biopage flex-row justify-content-space-between\"\n              >\n                <span>\n                  {localize('DND5E.Appearance')}\n                </span>\n                <a\n                  class=\"icon-button\"\n                  onclick={(ev) =>\n                    context.editable &&\n                    edit(\n                      TidyFlags.appearance.get(context.actor) ?? '',\n                      context.appearanceEnrichedHtml,\n                      TidyFlags.appearance.prop,\n                    )}\n                >\n                  <i class=\"fa-solid fa-feather\"></i>\n                </a>\n              </div>\n              <SheetEditor\n                content={context.appearanceEnrichedHtml}\n                target={TidyFlags.appearance.prop}\n                editable={context.editable}\n              />\n            </article>\n          </RerenderAfterFormSubmission>\n          <RerenderAfterFormSubmission\n            andOnValueChange={context.system.details.biography.value}\n          >\n            <article class=\"biography-notes\" use:context.activateEditors>\n              <div\n                class=\"section-titles flex-row justify-content-space-between\"\n              >\n                <span>\n                  {localize('DND5E.Background')}/{localize('DND5E.Biography')}\n                </span>\n                <a\n                  class=\"icon-button\"\n                  onclick={(ev) =>\n                    context.editable &&\n                    edit(\n                      context.system.details.biography.value,\n                      context.biographyEnrichedHtml,\n                      'system.details.biography.value',\n                    )}\n                >\n                  <i class=\"fa-solid fa-feather\"></i>\n                </a>\n              </div>\n              <SheetEditor\n                content={context.biographyEnrichedHtml}\n                target=\"system.details.biography.value\"\n                editable={context.editable}\n              />\n            </article>\n          </RerenderAfterFormSubmission>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n{#snippet biopage(\n  label: string,\n  value: string,\n  content: string,\n  target: string,\n)}\n  <RerenderAfterFormSubmission andOnValueChange={value ?? ''}>\n    <article use:context.activateEditors>\n      <div\n        class=\"section-titles biopage flex-row justify-content-space-between\"\n      >\n        <span>{localize(label)}</span>\n        <a\n          class=\"icon-button\"\n          onclick={(ev) => context.editable && edit(value, content, target)}\n        >\n          <i class=\"fa-solid fa-feather\"></i>\n        </a>\n      </div>\n      <SheetEditor {content} {target} editable={context.editable} />\n    </article>\n  </RerenderAfterFormSubmission>\n{/snippet}\n\n<style lang=\"scss\">\n  .notes-container {\n    display: flex;\n    flex: 1;\n    flex-direction: column;\n    height: 100%;\n  }\n\n  .main-notes {\n    display: flex;\n    flex: 1;\n    gap: 0.5rem;\n  }\n\n  .left-notes,\n  .right-notes {\n    flex: 1;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n    > * {\n      flex: 1;\n      overflow: auto;\n    }\n  }\n\n  .left-notes {\n    max-width: 21.875rem;\n  }\n\n  .top-notes {\n    width: 100%;\n    margin-bottom: 0.5rem;\n\n    .character-details {\n      margin: 0;\n      padding: 0;\n      display: flex;\n      gap: 0.25rem;\n      flex-wrap: wrap;\n    }\n\n    li {\n      display: flex;\n      flex: 0 0 calc(100% / 3 - 0.25rem);\n\n      :global(span) {\n        flex: 1;\n        margin: 0 0.5rem 0 0.25rem;\n      }\n\n      :global(span:first-child) {\n        flex: 0 0 0.0625rem;\n        font-weight: 600;\n        margin: 0;\n      }\n    }\n  }\n\n  .character-details :global(.detail-input) {\n    flex: 1;\n    margin: 0 0.5rem 0 0.25rem;\n  }\n\n  .toggle-personality-info {\n    width: auto;\n    border: none;\n    align-self: flex-start;\n    transition:\n      color 0.3s ease,\n      transform 0.3s ease;\n    padding: 1.25rem 0.25rem;\n    background: var(--t5e-faint-color);\n    border-radius: 0.1875rem;\n    margin-right: 0.25rem;\n    color: var(--t5e-tertiary-color);\n    cursor: pointer;\n\n    &:hover {\n      color: var(--t5e-secondary-color);\n    }\n  }\n\n  .singleton :global(.editor.prosemirror) {\n    flex: 1;\n  }\n\n  .bottom-notes {\n    display: flex;\n    gap: 0.25rem;\n    height: 100%;\n    min-height: 0;\n  }\n</style>\n","<script lang=\"ts\">\n  import type { Dnd5eActorCondition } from 'src/foundry/foundry-and-system';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n  import TidySwitch from './TidySwitch.svelte';\n  import Dnd5eIcon from 'src/components/icon/Dnd5eIcon.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { debug, error } from 'src/utils/logging';\n  import { CONSTANTS } from 'src/constants';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  const context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  interface Props {\n    condition: Dnd5eActorCondition;\n  }\n\n  let { condition }: Props = $props();\n\n  async function handleChange(newValue: boolean) {\n    try {\n      await FoundryAdapter.toggleCondition(context.actor, condition);\n    } catch (e) {\n      error('An error occurred while toggling a condition', false, e);\n      debug('Condition toggle error troubleshooting info', {\n        condition,\n      });\n      context.actor.sheet.render();\n    }\n  }\n</script>\n\n<TidySwitch\n  class=\"flex-row small-gap tidy-condition-toggle {!condition.disabled\n    ? 'active'\n    : 'inactive'}\"\n  checked={!condition.disabled}\n  onChange={(ev) => handleChange(ev.currentTarget.checked)}\n  title={condition.name}\n  disabled={!context.editable}\n  data-uuid={condition.reference}\n  data-condition-id={condition.id}\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.CONDITION_TOGGLE}\n>\n  <Dnd5eIcon src={condition.icon} />\n  <span class=\"flex-1 truncate\">{condition.name}</span>\n</TidySwitch>\n","<script lang=\"ts\">\n  import ItemTable from 'src/components/item-list/v1/ItemTable.svelte';\n  import ItemTableColumn from 'src/components/item-list/v1/ItemTableColumn.svelte';\n  import ItemTableHeaderRow from 'src/components/item-list/v1/ItemTableHeaderRow.svelte';\n  import ConditionToggle from 'src/components/toggles/ConditionToggle.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { CharacterSheetContext, NpcSheetContext } from 'src/types/types';\n\n  let context = $derived(getSheetContext<CharacterSheetContext | NpcSheetContext>());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<ItemTable key=\"conditions\">\n  {#snippet header()}\n    <ItemTableHeaderRow>\n      <ItemTableColumn primary={true}>\n        {localize('DND5E.Conditions')}\n      </ItemTableColumn>\n    </ItemTableHeaderRow>\n  {/snippet}\n  {#snippet body()}\n    <ul class=\"conditions-list\">\n      {#each context.conditions as condition (condition.id)}\n        <li\n          class=\"condition\"\n          class:active={!condition.disabled}\n          data-uuid={condition.reference}\n          data-condition-id={condition.id}\n        >\n          <ConditionToggle {condition} />\n        </li>\n      {/each}\n    </ul>\n  {/snippet}\n</ItemTable>\n\n<style lang=\"scss\">\n  .conditions-list {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(12.5rem, 1fr));\n    gap: 0.125rem;\n  }\n</style>\n","<!-- \n  @component\nFor effects only.\nA special item control which swaps between an Enable/Disable control and a special \"Break Concentration\" control.\nBecause the controls are mutually exclusive, it is more ergonomic to distinguish them in this component than to try to smartly toggle them inline while spinning up item controls for a give Effects component.\n -->\n<script lang=\"ts\">\n  import type { ActiveEffect5e, ActorSheetContextV1 } from 'src/types/types';\n  import ItemControl from './ItemControl.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    effect: ActiveEffect5e;\n  }\n\n  let { effect }: Props = $props();\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  /** Character effects are not the full ActiveEffect5e instance;\n   * they are instead a subset of contextual data.\n   * Also, there are cases when, such as with deleting effects,\n   * that this logic fires immediately as an effect deletion is occurring.\n   * This seems related specifically to character sheets.\n   */\n  let actualEffect = $derived(\n    effect instanceof dnd5e.documents.ActiveEffect5e\n      ? effect\n      : !!effect\n        ? FoundryAdapter.getEffect({\n            document: context.actor,\n            effectId: effect.id,\n            parentId: effect.parentId,\n          })\n        : undefined,\n  );\n\n  const localize = FoundryAdapter.localize;\n\n  let isConcentration = $derived(\n    FoundryAdapter.isConcentrationEffect(actualEffect, context.actor.sheet),\n  );\n</script>\n\n{#if actualEffect}\n  {#if isConcentration}\n    <ItemControl\n      iconSrc={`systems/dnd5e/icons/svg/break-concentration.svg`}\n      onclick={() => context.actor.endConcentration(actualEffect)}\n      title={localize('DND5E.ConcentrationBreak')}\n    />\n  {:else}\n    <ItemControl\n      iconCssClass={`fas ${actualEffect.disabled ? 'fa-check' : 'fa-times'}`}\n      onclick={() => actualEffect.update({ disabled: !actualEffect.disabled })}\n      title={actualEffect.disabled\n        ? localize('DND5E.EffectEnable')\n        : localize('DND5E.EffectDisable')}\n    />\n  {/if}\n{:else}\n  <span>&nbsp;</span>\n{/if}\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { ActiveEffect5e } from 'src/types/types';\n  import HorizontalLineSeparator from '../layout/HorizontalLineSeparator.svelte';\n  import { ActiveEffectsHelper } from 'src/utils/active-effect';\n\n  interface Props {\n    activeEffect: ActiveEffect5e;\n  }\n\n  let { activeEffect }: Props = $props();\n\n  let descriptionPromise = $derived(\n    FoundryAdapter.enrichHtml(activeEffect.description ?? ''),\n  );\n\n  let pills = $derived.by(() =>\n    ActiveEffectsHelper.getActiveEffectPills(activeEffect),\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div\n  class=\"item-summary\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_SUMMARY}\n>\n  {#await descriptionPromise then description}\n    {@html description}\n    <HorizontalLineSeparator />\n    {#if activeEffect.changes.length}\n      <table class=\"effect-summary-changes-table\">\n        <colgroup>\n          <col width=\"50%\" />\n          <col width=\"25%\" />\n          <col width=\"25%\" />\n        </colgroup>\n        <thead>\n          <tr>\n            <th>\n              {localize('EFFECT.ChangeKey')}\n            </th>\n            <th>\n              {localize('EFFECT.ChangeMode')}\n            </th>\n            <th>\n              {localize('EFFECT.ChangeValue')}\n            </th>\n          </tr>\n        </thead>\n        <tbody>\n          {#each activeEffect.changes as change}\n            {@const modeLabel = ActiveEffectsHelper.findMode(change.mode)}\n\n            <tr>\n              <td\n                title={change.key}\n                class=\"truncate\"\n                style=\"word-wrap: break-all\"\n              >\n                {change.key}\n              </td>\n              <td>\n                {modeLabel}\n              </td>\n              <td title={change.value} class=\"break-word\">\n                {change.value}\n              </td>\n            </tr>\n          {/each}\n        </tbody>\n      </table>\n    {/if}\n    {#if pills.length}\n      <HorizontalLineSeparator />\n      <div\n        class=\"inline-wrapped-elements\"\n        data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_PROPERTY_LIST}\n      >\n        {#each pills as pill}<span class=\"tag\">{localize(pill)}</span>{/each}\n      </div>\n    {/if}\n  {/await}\n</div>\n\n<style lang=\"scss\">\n  .effect-summary-changes-table {\n    table-layout: fixed;\n\n    th {\n      text-align: left;\n    }\n\n    th,\n    td {\n      padding: 0.25rem;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { type OnItemToggledFn } from 'src/types/types';\n  import { getContext, type Snippet } from 'svelte';\n  import type { ActiveEffect5e, ActiveEffectContext } from 'src/types/types';\n  import { CONSTANTS } from 'src/constants';\n  import ExpandableContainer from 'src/components/expandable/ExpandableContainer.svelte';\n  import EffectSummary from '../EffectSummary.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n  interface Props {\n    activeEffect?: ActiveEffect5e | ActiveEffectContext | null;\n    cssClass?: string;\n    hidden?: boolean;\n    attributes?: Record<string, any>;\n    children?: Snippet<[any]>;\n  }\n\n  let {\n    activeEffect = null,\n    cssClass = '',\n    hidden = false,\n    attributes,\n    children,\n  }: Props = $props();\n\n  let effectDocument = $derived(activeEffect?.effect ?? activeEffect);\n\n  const onEffectToggled = getContext<OnItemToggledFn>(\n    CONSTANTS.SVELTE_CONTEXT.ON_ITEM_TOGGLED,\n  );\n\n  const location = getContext<string>(CONSTANTS.SVELTE_CONTEXT.LOCATION);\n\n  let showSummary = $state(false);\n\n  async function toggleSummary() {\n    showSummary = !showSummary;\n    onEffectToggled?.(effectDocument.id, showSummary, location);\n  }\n\n  function handleDragStart(event: DragEvent) {\n    const dragData = effectDocument.toDragData?.();\n    if (dragData) {\n      event.dataTransfer?.setData('text/plain', JSON.stringify(dragData));\n    }\n  }\n</script>\n\n<div\n  class=\"effect-table-row-container\"\n  class:hidden\n  aria-hidden={hidden}\n  data-context-menu={CONSTANTS.CONTEXT_MENU_TYPE_EFFECTS}\n  data-effect-id={activeEffect?.id}\n  data-parent-id={activeEffect?.parentId ?? activeEffect?.parent?.id}\n  onmousedown={(event) =>\n    FoundryAdapter.editOnMiddleClick(event, effectDocument)}\n  ondragstart={handleDragStart}\n  draggable={true}\n  data-tidy-table-row\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.EFFECT_TABLE_ROW}\n  data-info-card=\"effect\"\n  data-info-card-entity-uuid={activeEffect.uuid}\n  {...attributes}\n>\n  <div class=\"effect-table-row {cssClass ?? ''}\">\n    {@render children?.({ toggleSummary })}\n  </div>\n  <ExpandableContainer expanded={showSummary}>\n    <EffectSummary activeEffect={effectDocument} />\n  </ExpandableContainer>\n</div>\n\n<style lang=\"scss\">\n  .effect-table-row-container {\n    position: relative;\n    border-radius: 0.3125rem;\n    margin: 0 0 0.125rem 0.5rem;\n    background: var(--t5e-faintest-color);\n\n    .effect-table-row {\n      display: flex;\n      flex-direction: row;\n      flex-wrap: wrap;\n      border-radius: 0.3125rem;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import {\n    type ActorSheetContextV1,\n    type RenderableClassicControl,\n  } from 'src/types/types';\n  import ItemTable from '../../../../components/item-list/v1/ItemTable.svelte';\n  import ItemTableHeaderRow from '../../../../components/item-list/v1/ItemTableHeaderRow.svelte';\n  import ItemTableRow from '../../../../components/item-list/v1/ItemTableRow.svelte';\n  import ItemTableColumn from '../../../../components/item-list/v1/ItemTableColumn.svelte';\n  import ItemTableFooter from '../../../../components/item-list/ItemTableFooter.svelte';\n  import ItemImage from '../../../../components/item-list/ItemImage.svelte';\n  import ItemTableCell from '../../../../components/item-list/v1/ItemTableCell.svelte';\n  import ItemControl from '../../../../components/item-list/controls/ItemControl.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import Notice from 'src/components/notice/Notice.svelte';\n  import { declareLocation } from 'src/types/location-awareness.types';\n  import ActorConditions from '../../actor/ActorConditions.svelte';\n  import ClassicControls from 'src/sheets/classic/shared/ClassicControls.svelte';\n  import ActorEffectToggleControl from 'src/components/item-list/controls/ActorEffectToggleControl.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import EffectTableRow from 'src/components/item-list/v1/EffectTableRow.svelte';\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  const localize = FoundryAdapter.localize;\n\n  let effectSections = $derived(Object.values<any>(context.effects));\n\n  let noEffects = $derived(\n    effectSections.some((section: any) => section.effects.length > 0) === false,\n  );\n\n  declareLocation('effects');\n\n  let controls: RenderableClassicControl<{ effect: any }>[] = $derived.by(\n    () => {\n      let result: RenderableClassicControl<{ effect: any }>[] = [];\n      result.push(\n        {\n          component: ActorEffectToggleControl,\n          props: ({ effect }) => ({\n            effect: effect,\n          }),\n        },\n        {\n          component: ItemControl,\n          props: ({ effect }) => ({\n            onclick: () =>\n              FoundryAdapter.getEffect({\n                document: context.actor,\n                effectId: effect.id,\n                parentId: effect.parentId,\n              }).sheet.render(true),\n            title: localize('DND5E.EffectEdit'),\n            iconCssClass: 'fas fa-edit',\n          }),\n        },\n      );\n\n      if (context.unlocked) {\n        result.push({\n          component: ItemControl,\n          props: ({ effect }) => ({\n            onclick: () =>\n              FoundryAdapter.getEffect({\n                document: context.actor,\n                effectId: effect.id,\n                parentId: effect.parentId,\n              }).deleteDialog(),\n            title: localize('DND5E.EffectDelete'),\n            iconCssClass: 'fas fa-trash',\n          }),\n        });\n      }\n\n      return result;\n    },\n  );\n\n  let classicControlsIconWidth = 1.25;\n\n  let classicControlsColumnWidth = $derived(\n    `${classicControlsIconWidth * controls.length}rem`,\n  );\n</script>\n\n<div class=\"scroll-container flex-column small-gap\">\n  {#if !context.allowEffectsManagement && context.unlocked}\n    <Notice>{localize('TIDY5E.GMOnlyEdit')}</Notice>\n  {/if}\n\n  {#if noEffects && !context.unlocked && context.allowEffectsManagement}\n    <Notice>{localize('TIDY5E.EmptySection')}</Notice>\n  {:else}\n    {#each effectSections as section}\n      {#if !section.hidden}\n        {#if (context.unlocked && context.allowEffectsManagement) || section.effects.length > 0}\n          <ItemTable key={section.label}>\n            {#snippet header()}\n              <ItemTableHeaderRow>\n                <ItemTableColumn primary={true}>\n                  {localize(section.label)}\n                </ItemTableColumn>\n                <ItemTableColumn baseWidth=\"12.5rem\">\n                  {localize('DND5E.SOURCE.FIELDS.source.label')}\n                </ItemTableColumn>\n                <ItemTableColumn baseWidth=\"7.5rem\">\n                  {localize('DND5E.Duration')}\n                </ItemTableColumn>\n                {#if context.editable && context.useClassicControls && context.allowEffectsManagement}\n                  <ItemTableColumn baseWidth={classicControlsColumnWidth} />\n                {/if}\n              </ItemTableHeaderRow>\n            {/snippet}\n            {#snippet body()}\n              {#each section.effects as effectContext}\n                <EffectTableRow\n                  activeEffect={effectContext}\n                  attributes={{\n                    'data-info-card': 'effect',\n                    'data-info-card-entity-uuid': effectContext.uuid,\n                  }}\n                >\n                  {#snippet children({ toggleSummary })}\n                    <ItemTableCell\n                      primary={true}\n                      attributes={{\n                        'data-tidy-effect-name-container': true,\n                        'data-effect-id': effectContext.id,\n                      }}\n                    >\n                      <ItemImage src={effectContext.img} />\n                      <a\n                        onclick={(ev) => toggleSummary()}\n                        class=\"truncate flex-row align-items-center flex-1\"\n                      >\n                        <span\n                          class=\"align-self-center truncate flex-1\"\n                          data-tidy-effect-name={effectContext.name}\n                          title={effectContext.name}>{effectContext.name}</span\n                        >\n                      </a>\n                    </ItemTableCell>\n                    <ItemTableCell baseWidth=\"12.5rem\">\n                      <span\n                        class=\"truncate\"\n                        title={effectContext.source?.name ?? ''}\n                        >{effectContext.source?.name ?? ''}</span\n                      >\n                    </ItemTableCell>\n                    <ItemTableCell baseWidth=\"7.5rem\">\n                      <span\n                        class=\"truncate\"\n                        title={effectContext.duration?.label ?? ''}\n                        >{effectContext.duration?.label ?? ''}</span\n                      >\n                    </ItemTableCell>\n                    {#if context.editable && context.useClassicControls && context.allowEffectsManagement}\n                      <ItemTableCell baseWidth={classicControlsColumnWidth}>\n                        <ClassicControls\n                          {controls}\n                          params={{ effect: effectContext }}\n                        />\n                      </ItemTableCell>\n                    {/if}\n                  {/snippet}\n                </EffectTableRow>\n              {/each}\n              {#if context.unlocked && context.allowEffectsManagement}\n                <ItemTableFooter\n                  actor={context.actor}\n                  {section}\n                  create={() =>\n                    FoundryAdapter.addEffect(section.type, context.actor)}\n                  isItem={false}\n                />\n              {/if}\n            {/snippet}\n          </ItemTable>\n        {/if}\n      {/if}\n    {/each}\n  {/if}\n  {#if context.conditions}\n    <ActorConditions />\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import SheetEditor from 'src/components/editor/SheetEditor.svelte';\n  import RerenderAfterFormSubmission from '../../../../components/utility/RerenderAfterFormSubmission.svelte';\n  import TextInput from '../../../../components/inputs/TextInput.svelte';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import SheetEditorV2 from 'src/components/editor/SheetEditorV2.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getCharacterSheetContext());\n\n  let editing = $state(false);\n  let contentToEdit: string = $state('');\n  let enrichedText: string = $state('');\n  let fieldToEdit: string = $state('');\n\n  async function stopEditing() {\n    await context.actor.sheet.submit();\n    editing = false;\n  }\n\n  function edit(value: string, enriched: string, field: string) {\n    contentToEdit = value;\n    fieldToEdit = field;\n    enrichedText = enriched;\n    editing = true;\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"scroll-container journal-container\">\n  {#if editing}\n    {#key contentToEdit}\n      <article class=\"editor-container flex-column full-height singleton\">\n        <SheetEditorV2\n          enriched={enrichedText}\n          content={contentToEdit}\n          field={fieldToEdit}\n          editorOptions={{\n            editable: context.editable,\n            toggled: false,\n          }}\n          documentUuid={context.actor.uuid}\n          onSave={() => stopEditing()}\n          manageSecrets={context.actor.isOwner}\n        />\n      </article>\n    {/key}\n  {/if}\n  <div\n    class=\"left-notes note-entries hide-editor-edit\"\n    class:hidden={editing}\n    class:limited={context.showLimitedSheet}\n  >\n    <RerenderAfterFormSubmission\n      andOnValueChange={TidyFlags.notes1.members.value.get(context.actor) ?? ''}\n    >\n      <article use:context.activateEditors>\n        <div class=\"section-titles flex-row\">\n          <TextInput\n            document={context.actor}\n            field={TidyFlags.notes1.members.name.prop}\n            value={TidyFlags.notes1.members.name.get(context.actor) ?? ''}\n            placeholder={localize('TIDY5E.JournalPersonsOfInterest')}\n            selectOnFocus={true}\n            stopChangePropagation={true}\n            disabled={!context.editable}\n          />\n          <a\n            class=\"icon-button\"\n            onclick={(ev) =>\n              context.editable &&\n              edit(\n                TidyFlags.notes1.members.value.get(context.actor) ?? '',\n                context.notes1EnrichedHtml,\n                TidyFlags.notes1.members.value.prop,\n              )}\n          >\n            <i class=\"fa-solid fa-feather\"></i>\n          </a>\n        </div>\n        <SheetEditor\n          content={context.notes1EnrichedHtml}\n          target={TidyFlags.notes1.members.value.prop}\n          editable={context.editable}\n        />\n      </article>\n    </RerenderAfterFormSubmission>\n    <RerenderAfterFormSubmission\n      andOnValueChange={TidyFlags.notes2.members.value.get(context.actor) ?? ''}\n    >\n      <article use:context.activateEditors>\n        <div class=\"section-titles flex-row\">\n          <TextInput\n            document={context.actor}\n            field={TidyFlags.notes2.members.name.prop}\n            value={TidyFlags.notes2.members.name.get(context.actor) ?? ''}\n            placeholder={localize('TIDY5E.JournalLocationsOfInterest')}\n            selectOnFocus={true}\n            stopChangePropagation={true}\n            disabled={!context.editable}\n          />\n          <a\n            class=\"icon-button\"\n            onclick={(ev) =>\n              context.editable &&\n              edit(\n                TidyFlags.notes2.members.value.get(context.actor) ?? '',\n                context.notes2EnrichedHtml,\n                TidyFlags.notes2.members.value.prop,\n              )}\n          >\n            <i class=\"fa-solid fa-feather\"></i>\n          </a>\n        </div>\n        <SheetEditor\n          content={context.notes2EnrichedHtml}\n          target={TidyFlags.notes2.members.value.prop}\n          editable={context.editable}\n        />\n      </article>\n    </RerenderAfterFormSubmission>\n    <RerenderAfterFormSubmission\n      andOnValueChange={TidyFlags.notes3.members.value.get(context.actor) ?? ''}\n    >\n      <article use:context.activateEditors>\n        <div class=\"section-titles flex-row\">\n          <TextInput\n            document={context.actor}\n            field={TidyFlags.notes3.members.name.prop}\n            value={TidyFlags.notes3.members.name.get(context.actor) ?? ''}\n            placeholder={localize('TIDY5E.JournalQuests')}\n            selectOnFocus={true}\n            stopChangePropagation={true}\n            disabled={!context.editable}\n          />\n          <a\n            class=\"icon-button\"\n            onclick={(ev) =>\n              context.editable &&\n              edit(\n                TidyFlags.notes3.members.value.get(context.actor) ?? '',\n                context.notes3EnrichedHtml,\n                TidyFlags.notes3.members.value.prop,\n              )}\n          >\n            <i class=\"fa-solid fa-feather\"></i>\n          </a>\n        </div>\n        <SheetEditor\n          content={context.notes3EnrichedHtml}\n          target={TidyFlags.notes3.members.value.prop}\n          editable={context.editable}\n        />\n      </article>\n    </RerenderAfterFormSubmission>\n    <RerenderAfterFormSubmission\n      andOnValueChange={TidyFlags.notes4.members.value.get(context.actor) ?? ''}\n    >\n      <article use:context.activateEditors>\n        <div class=\"section-titles flex-row\">\n          <TextInput\n            document={context.actor}\n            field={TidyFlags.notes4.members.name.prop}\n            value={TidyFlags.notes4.members.name.get(context.actor) ?? ''}\n            placeholder={localize('TIDY5E.JournalMisc')}\n            selectOnFocus={true}\n            stopChangePropagation={true}\n            disabled={!context.editable}\n          />\n          <a\n            class=\"icon-button\"\n            onclick={(ev) =>\n              context.editable &&\n              edit(\n                TidyFlags.notes4.members.value.get(context.actor) ?? '',\n                context.notes4EnrichedHtml,\n                TidyFlags.notes4.members.value.prop,\n              )}\n          >\n            <i class=\"fa-solid fa-feather\"></i>\n          </a>\n        </div>\n        <SheetEditor\n          content={context.notes4EnrichedHtml}\n          target={TidyFlags.notes4.members.value.prop}\n          editable={context.editable}\n        />\n      </article>\n    </RerenderAfterFormSubmission>\n  </div>\n  <div\n    class=\"right-notes note-entries hide-editor-edit\"\n    class:hidden={editing}\n    class:limited={context.showLimitedSheet}\n  >\n    <RerenderAfterFormSubmission\n      andOnValueChange={TidyFlags.notes.members.value.get(context.actor) ?? ''}\n    >\n      <article class=\"journal-notes\" use:context.activateEditors>\n        <div class=\"section-titles flex-row justify-content-space-between\">\n          <span>\n            {localize('TIDY5E.JournalEntries')}\n          </span>\n          <a\n            class=\"icon-button\"\n            onclick={(ev) =>\n              context.editable &&\n              edit(\n                TidyFlags.notes.members.value.get(context.actor) ?? '',\n                context.notesEnrichedHtml,\n                TidyFlags.notes.members.value.prop,\n              )}\n          >\n            <i class=\"fa-solid fa-feather\"></i>\n          </a>\n        </div>\n        <SheetEditor\n          content={context.notesEnrichedHtml}\n          target={TidyFlags.notes.members.value.prop}\n          editable={context.editable}\n        />\n      </article>\n    </RerenderAfterFormSubmission>\n  </div>\n</div>\n\n<style lang=\"scss\">\n  .journal-container {\n    display: flex;\n    align-items: flex-start;\n    flex-direction: row;\n    overflow-x: inherit;\n    gap: 0.5rem;\n  }\n\n  .left-notes,\n  .right-notes {\n    flex: 1;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n    > * {\n      flex: 1;\n      overflow: auto;\n    }\n  }\n\n  .left-notes {\n    max-width: 21.875rem;\n  }\n\n  .singleton {\n    flex: 1;\n\n    & :global(.editor.prosemirror) {\n      flex: 1;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import ItemTable from 'src/components/item-list/v1/ItemTable.svelte';\n  import ItemTableColumn from 'src/components/item-list/v1/ItemTableColumn.svelte';\n  import ItemTableHeaderRow from 'src/components/item-list/v1/ItemTableHeaderRow.svelte';\n  import ItemTableRow from 'src/components/item-list/v1/ItemTableRow.svelte';\n  import ItemTableCell from 'src/components/item-list/v1/ItemTableCell.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n  import { getContext } from 'svelte';\n  import ItemName from 'src/components/item-list/ItemName.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import ItemUseButton from 'src/components/item-list/ItemUseButton.svelte';\n  import RechargeControl from 'src/components/item-list/controls/RechargeControl.svelte';\n  import ActionFilterOverrideControl from 'src/components/item-list/controls/ActionFilterOverrideControl.svelte';\n  import { declareLocation } from 'src/types/location-awareness.types';\n  import UtilityToolbar from 'src/components/utility-bar/UtilityToolbar.svelte';\n  import UtilityToolbarCommand from 'src/components/utility-bar/UtilityToolbarCommand.svelte';\n  import Search from 'src/components/utility-bar/Search.svelte';\n  import FilterMenu from 'src/components/filter/FilterMenu.svelte';\n  import { Actions } from 'src/features/actions/actions.svelte';\n  import Dnd5eIcon from 'src/components/icon/Dnd5eIcon.svelte';\n  import { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\n  import PinnedFilterToggles from 'src/components/filter/PinnedFilterToggles.svelte';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import { SheetSections } from 'src/features/sections/SheetSections';\n  import { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\n  import { ItemVisibility } from 'src/features/sections/ItemVisibility';\n  import InlineToggleControl from 'src/sheets/classic/shared/InlineToggleControl.svelte';\n  import { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import InlineContainerView from 'src/sheets/classic/container/InlineContainerView.svelte';\n  import { ItemUtils } from 'src/utils/ItemUtils';\n  import {\n    createSearchResultsState,\n    setSearchResultsContext,\n  } from 'src/features/search/search.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n  let tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n  let inlineToggleService = getContext<InlineToggleService>(\n    CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n  );\n\n  let actions = $derived(\n    SheetSections.configureActions(\n      context.actions,\n      tabId,\n      SheetPreferencesService.getByType(context.actor.type),\n      TidyFlags.sectionConfig.get(context.actor)?.[tabId],\n    ),\n  );\n\n  let searchCriteria: string = $state('');\n\n  const searchResults = createSearchResultsState();\n  setSearchResultsContext(searchResults);\n\n  $effect(() => {\n    searchResults.uuids = ItemVisibility.getItemsToShowAtDepth({\n      criteria: searchCriteria,\n      itemContext: context.itemContext,\n      sections: actions,\n      tabId: tabId,\n    });\n  });\n\n  let utilityBarCommands = $derived(\n    context.utilities[tabId]?.utilityToolbarCommands ?? [],\n  );\n\n  const localize = FoundryAdapter.localize;\n\n  declareLocation('actions');\n\n  const damageHealingTypeIconMap = Actions.damageAndHealingTypesIconSrcMap;\n</script>\n\n<UtilityToolbar class=\"abilities-toolbar\">\n  <Search bind:value={searchCriteria} />\n  <PinnedFilterToggles\n    filterGroupName={tabId}\n    filters={ItemFilterRuntime.getPinnedFiltersForTab(\n      context.filterPins,\n      context.filterData,\n      tabId,\n    )}\n  />\n  <FilterMenu {tabId} />\n  {#each utilityBarCommands as command (command.title)}\n    <UtilityToolbarCommand\n      title={command.title}\n      iconClass={command.iconClass}\n      text={command.text}\n      visible={command.visible ?? true}\n      onExecute={(ev) => command.execute?.(ev)}\n      sections={actions}\n    />\n  {/each}\n</UtilityToolbar>\n\n<div class=\"actions-tab-container scroll-container flex-column small-gap\">\n  {#each actions as section (section.key)}\n    {@const visibleItemCount = ItemVisibility.countVisibleItems(\n      section.actions.map((a) => a.item),\n      searchResults.uuids,\n    )}\n    {#if visibleItemCount > 0 && section.show}\n      <ItemTable key={section.key}>\n        {#snippet header()}\n          <ItemTableHeaderRow>\n            <ItemTableColumn primary={true}>\n              {section.label}\n            </ItemTableColumn>\n            <ItemTableColumn baseWidth=\"6.25rem\"\n              >{localize('DND5E.Range')}</ItemTableColumn\n            >\n            <ItemTableColumn baseWidth=\"5rem\"\n              >{localize('TIDY5E.HitDC')}</ItemTableColumn\n            >\n            <ItemTableColumn baseWidth=\"7.5rem\"\n              >{localize('DND5E.Damage')}</ItemTableColumn\n            >\n            {#if context.editable && context.useClassicControls}\n              <ItemTableColumn baseWidth=\"1.5rem\"></ItemTableColumn>\n            {/if}\n          </ItemTableHeaderRow>\n        {/snippet}\n        {#snippet body()}\n          {#each section.actions as actionItem (actionItem.item.id)}\n            <ItemTableRow\n              item={actionItem.item}\n              onMouseDown={(event) =>\n                FoundryAdapter.editOnMiddleClick(event, actionItem.item)}\n              contextMenu={{\n                type: CONSTANTS.CONTEXT_MENU_TYPE_ITEMS,\n                uuid: actionItem.item.uuid,\n              }}\n              hidden={!searchResults.show(actionItem.item.uuid)}\n            >\n              {#snippet children({ toggleSummary })}\n                <ItemTableCell primary={true}>\n                  <ItemUseButton\n                    disabled={!context.editable}\n                    item={actionItem.item}\n                  />\n                  {#if 'containerContents' in actionItem && !!actionItem.containerContents}\n                    <InlineToggleControl\n                      iconClass=\"fa-lg\"\n                      entityId={actionItem.item.id}\n                      {inlineToggleService}\n                    />\n                  {/if}\n                  <ItemName\n                    item={actionItem.item}\n                    onToggle={() => toggleSummary(context.actor)}\n                    useActiveEffectsMarker={false}\n                  >\n                    {@const sourceClassText =\n                      context.actor.spellcastingClasses?.[\n                        actionItem.item.system.sourceClass\n                      ]?.name ?? ''}\n                    <div class=\"flex-1 min-width-0\">\n                      <div\n                        data-tidy-item-name={actionItem.item.name}\n                        data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_NAME}\n                        class=\"truncate flex-1\"\n                        title={actionItem.item.name}\n                      >\n                        {actionItem.item.name}\n                      </div>\n                      <small>\n                        {#if actionItem.item.type !== CONSTANTS.ITEM_TYPE_SPELL}\n                          {actionItem.typeLabel}\n                        {:else if actionItem.item.system.level !== 0}\n                          {actionItem.item.labels?.level ?? ''}\n                          {actionItem.item.labels?.school ?? ''}\n                          {#if sourceClassText}\n                             {localize(sourceClassText)}\n                          {/if}\n                        {:else}\n                          {actionItem.item.labels?.school ?? ''}\n                          {actionItem.item.labels?.level ?? ''}\n                          {#if sourceClassText}\n                             {localize(sourceClassText)}\n                          {/if}\n                        {/if}\n                      </small>\n                    </div>\n                  </ItemName>\n                  {#if actionItem.item.hasRecharge || actionItem.item.hasLimitedUses || ItemUtils.hasSpecificActivationType(actionItem.item, CONSTANTS.ACTIVATION_COST_LEGENDARY)}\n                    <div class=\"item-uses\" title={localize('DND5E.Uses')}>\n                      {#if actionItem.item.hasRecharge && !actionItem.item.isOnCooldown}\n                        {@const remaining =\n                          actionItem.item.system.uses.max -\n                          actionItem.item.system.uses.spent}\n                        {#if remaining > 1}\n                          <span>{remaining}</span>\n                        {/if}\n                        <i class=\"fas fa-bolt\" title={localize('DND5E.Charged')}\n                        ></i>\n                      {:else if actionItem.item.isOnCooldown}\n                        <RechargeControl\n                          document={actionItem.item}\n                          field={'system.uses.spent'}\n                          uses={actionItem.item.system.uses}\n                        />\n                      {:else if actionItem.item.hasLimitedUses}\n                        {#if actionItem.item.system.uses?.value === actionItem.item.system.uses?.max && actionItem.item.system.uses?.autoDestroy}\n                          <div title={actionItem.item.system.quantity}>\n                            {actionItem.item.system.quantity ?? 0}\n                          </div>\n                          <small>{localize('DND5E.Quantity')}</small>\n                        {:else}\n                          <div>\n                            {actionItem.item.system.uses.value ?? 0} / {actionItem\n                              .item.system.uses.max ?? 0}\n                          </div>\n                          <small>{localize('DND5E.Uses')}</small>\n                        {/if}\n                      {/if}\n                      {#if ItemUtils.hasSpecificActivationType(actionItem.item, CONSTANTS.ACTIVATION_COST_LEGENDARY)}\n                        {actionItem.item.system.activation.cost}\n                      {/if}\n                    </div>\n                  {/if}\n                </ItemTableCell>\n                <ItemTableCell\n                  baseWidth=\"6.25rem\"\n                  cssClass=\"truncate flex-column no-gap\"\n                >\n                  <!-- Range -->\n                  {#if actionItem.rangeTitle !== null}\n                    <div\n                      title={actionItem.rangeTitle}\n                      class=\"flex-column-truncate\"\n                    >\n                      {actionItem.rangeTitle ?? ''}\n                    </div>\n                  {/if}\n                  {#if actionItem.rangeSubtitle !== null}\n                    <small\n                      title={actionItem.rangeSubtitle}\n                      class=\"flex-column-truncate\"\n                    >\n                      {actionItem.rangeSubtitle ?? ''}\n                    </small>\n                  {/if}\n                </ItemTableCell>\n                <ItemTableCell baseWidth=\"5rem\" cssClass=\"flex-column no-gap\">\n                  <!-- HIT / DC -->\n                  {#if actionItem.item.labels?.save || actionItem.item.labels?.toHit}\n                    {#if actionItem.item.labels?.save !== '' && actionItem.item.labels?.save !== undefined}\n                      {@const saveAbilityLabel =\n                        FoundryAdapter.lookupAbility(\n                          actionItem.item.system.save.ability,\n                        )?.label ?? ''}\n                      <span\n                        title={actionItem.item.labels?.save ?? ''}\n                        class=\"flex-column-truncate\"\n                      >\n                        {localize('DND5E.AbbreviationDC')}\n                        {actionItem.item.system.save.dc ?? ''}\n                      </span>\n                      <small\n                        title={saveAbilityLabel}\n                        class=\"flex-column-truncate\">{saveAbilityLabel}</small\n                      >\n                    {:else}\n                      <span title={actionItem.item.labels?.toHit ?? ''}\n                        >{actionItem.item.labels?.toHit ?? ''}</span\n                      >\n                    {/if}\n                  {/if}\n                </ItemTableCell>\n                <ItemTableCell\n                  baseWidth=\"7.5rem\"\n                  cssClass=\"flex-wrap flex-row small-gap extra-small-row-gap\"\n                >\n                  <!-- Damage -->\n                  {#each actionItem.calculatedDerivedDamage ?? [] as entry, i}\n                    {@const iconSrc =\n                      damageHealingTypeIconMap[entry.damageType]}\n                    <div\n                      title={entry.label ??\n                        entry.formula + entry.damageHealingTypeLabel}\n                      class=\"truncate flex-row align-items-flex-end extra-small-gap\"\n                    >\n                      <span>{entry.formula}</span>\n                      {#if iconSrc}\n                        <Dnd5eIcon src={iconSrc} />\n                      {/if}\n                    </div>\n                  {/each}\n                </ItemTableCell>\n                {#if context.editable && context.useClassicControls}\n                  <ItemTableCell baseWidth=\"1.5rem\">\n                    <ActionFilterOverrideControl item={actionItem.item} />\n                  </ItemTableCell>\n                {/if}\n              {/snippet}\n            </ItemTableRow>\n            {#if 'containerContents' in actionItem && !!actionItem.containerContents}\n              <InlineContainerView\n                container={actionItem.item}\n                containerContents={actionItem.containerContents}\n                editable={context.editable}\n                {inlineToggleService}\n                lockItemQuantity={context.lockItemQuantity}\n                sheetDocument={context.actor}\n                --t5e-image-size-override=\"1.5rem\"\n                unlocked={context.unlocked}\n              />\n            {/if}\n          {/each}\n        {/snippet}\n      </ItemTable>\n    {/if}\n  {/each}\n</div>\n\n<style lang=\"scss\">\n  .actions-tab-container {\n    --t5e-image-size-override: 2rem;\n    --icon-fill: var(--t5e-secondary-color);\n    --icon-width: 1rem;\n    --icon-height: 1rem;\n\n    :global(.item-table-row) {\n      min-height: 2rem;\n    }\n  }\n\n  .flex-column-truncate {\n    text-align: center;\n    width: 100%;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n\n  .item-uses {\n    align-self: center;\n    text-align: center;\n    flex-basis: 4.25rem;\n  }\n\n  small {\n    color: var(--t5e-tertiary-color);\n  }\n</style>\n","import { HandlebarsTemplateRenderer } from 'src/runtime/HandlebarsTemplateRenderer';\nimport { HandlebarsTab } from 'src/api/tab/HandlebarsTab';\nimport { HtmlTab } from 'src/api/tab/HtmlTab';\nimport type { HtmlTabContent, Tab } from 'src/types/types';\nimport { debug, error } from 'src/utils/logging';\nimport { CONSTANTS } from 'src/constants';\nimport { isNil } from 'src/utils/data';\nimport type { RegisteredTab, SheetLayout } from '../types';\nimport type { CustomTabTitle } from 'src/api/tab/CustomTabBase';\nimport type { SupportedTab } from 'src/api/api.types';\nimport { SvelteTab } from 'src/api/tab/SvelteTab';\n\nexport class TabManager {\n  static async prepareTabsForRender(\n    context: any,\n    registeredTabs: RegisteredTab<any>[]\n  ): Promise<Tab[]> {\n    let enabledTabs = getOrderedEnabledSheetTabs(context, registeredTabs);\n\n    let tabs: Tab[] = [];\n\n    for (let sheetTab of enabledTabs) {\n      try {\n        let tab: Tab = {\n          id: sheetTab.id,\n          title: TabManager.getTabTitle(sheetTab),\n          onRender: sheetTab.onRender,\n          content: await getTabContent(context, sheetTab),\n          activateDefaultSheetListeners: sheetTab.activateDefaultSheetListeners,\n          autoHeight: sheetTab.autoHeight,\n        };\n\n        tabs.push(tab);\n      } catch (e) {\n        error('Unable to prepare tab for rendering', false, {\n          error: e,\n          tab: sheetTab,\n        });\n      }\n    }\n    return tabs;\n  }\n\n  static getTabsAsConfigOptions<TContext>(\n    tabs: RegisteredTab<TContext>[]\n  ): Record<string, string> {\n    return tabs.reduce<Record<string, string>>((prev, curr) => {\n      prev[curr.id] = TabManager.getTabTitle(curr);\n      return prev;\n    }, {});\n  }\n\n  static validateTab(tab: SupportedTab) {\n    if (isNil(tab.tabId?.trim(), '')) {\n      error('A tab ID is required for registered tabs.', true);\n      return false;\n    }\n\n    // Add any other validation as needed.\n    \n    return true;\n  }\n\n  static mapCustomTabToRegisteredTab(\n    tab: SupportedTab,\n    layout?: SheetLayout | SheetLayout[]\n  ): RegisteredTab<any> | undefined {\n    let registeredTab: RegisteredTab<any> | undefined;\n    layout ??= CONSTANTS.SHEET_LAYOUT_ALL;\n\n    if (tab instanceof HandlebarsTab) {\n      registeredTab = {\n        content: new HandlebarsTemplateRenderer({ path: tab.path }),\n        id: tab.tabId,\n        title: tab.title,\n        enabled: tab.enabled,\n        layout: layout,\n        onRender: tab.onRender,\n        renderScheme: tab.renderScheme,\n        tabContentsClasses: tab.tabContentsClasses,\n        getData: tab.getData,\n        activateDefaultSheetListeners: tab.activateDefaultSheetListeners,\n      };\n    } else if (tab instanceof HtmlTab) {\n      registeredTab = {\n        content: {\n          html: tab.html,\n          type: 'html',\n          renderScheme: tab.renderScheme,\n          cssClass: tab.tabContentsClasses.join(' '),\n        },\n        id: tab.tabId,\n        title: tab.title,\n        enabled: tab.enabled,\n        layout: layout,\n        onRender: tab.onRender,\n        renderScheme: tab.renderScheme,\n        tabContentsClasses: tab.tabContentsClasses,\n        activateDefaultSheetListeners: tab.activateDefaultSheetListeners,\n      };\n    } else if (tab instanceof SvelteTab) {\n      // An external svelte tab should be instantiated\n      if (tab.component) {\n        registeredTab = {\n          content: {\n            type: 'svelte',\n            component: tab.component,\n            cssClass: tab.tabContentsClasses?.join(' ') ?? '',\n            getProps: tab.getProps,\n            getContext: tab.getContext,\n          },\n          id: tab.tabId,\n          title: tab.title,\n          enabled: tab.enabled,\n          layout: layout,\n          onRender: tab.onRender,\n          renderScheme: 'force',\n          tabContentsClasses: tab.tabContentsClasses,\n          activateDefaultSheetListeners: tab.activateDefaultSheetListeners,\n        };\n      }\n    }\n\n    return registeredTab;\n  }\n\n  static getTabTitle(tab: { title: CustomTabTitle }) {\n    try {\n      return typeof tab.title === 'function' ? tab.title() : tab.title;\n    } catch (e) {\n      error('An error occurred while getting the tab title', false, e);\n      debug('Tab title error troubleshooting info', { tab });\n      return '';\n    }\n  }\n}\n\nfunction getOrderedEnabledSheetTabs<TContext>(\n  context: TContext,\n  registeredTabs: RegisteredTab<TContext>[]\n) {\n  return [...registeredTabs].filter((t) => {\n    try {\n      return (\n        isNil(t.enabled) ||\n        (typeof t.enabled === 'function' && t.enabled(context))\n      );\n    } catch (e) {\n      error(\n        'An error occurred while determining if a tab should be enabled.',\n        false,\n        e\n      );\n      debug('Tab-enabled error troubleshooting info', { tab: t });\n      return false;\n    }\n  });\n}\n\nasync function getTabContent(data: any, tab: RegisteredTab<any>) {\n  if ('type' in tab.content && tab.content.type === 'svelte') {\n    return tab.content;\n  }\n\n  if ('type' in tab.content && tab.content.type === 'html') {\n    return tab.content;\n  }\n\n  if (tab.content instanceof HandlebarsTemplateRenderer) {\n    const handlebarsData =\n      typeof tab.getData === 'function' ? await tab.getData(data) : data;\n\n    return {\n      html: await tab.content.render(handlebarsData),\n      renderScheme: tab.renderScheme ?? 'handlebars',\n      type: 'html',\n      cssClass: tab.tabContentsClasses?.join(' '),\n    } satisfies HtmlTabContent;\n  }\n\n  error(\n    'Unble to get tab content. The provided tab information is unable to be rendered.',\n    false,\n    tab\n  );\n\n  return {\n    html: '',\n    renderScheme: 'force',\n    type: 'html',\n  } satisfies HtmlTabContent;\n}\n","<script lang=\"ts\">\n  import type {\n    CharacterSheetContext,\n    InventorySection,\n    NpcSheetContext,\n  } from 'src/types/types';\n  import type { Item5e } from 'src/types/item.types';\n  import ItemTable from '../../../components/item-list/v1/ItemTable.svelte';\n  import ItemTableHeaderRow from '../../../components/item-list/v1/ItemTableHeaderRow.svelte';\n  import ItemTableColumn from '../../../components/item-list/v1/ItemTableColumn.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { CONSTANTS } from 'src/constants';\n  import GridPaneFavoriteIcon from '../../../components/item-grid/GridPaneFavoriteIcon.svelte';\n  import TextInput from '../../../components/inputs/TextInput.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import { ActorItemRuntime } from 'src/runtime/ActorItemRuntime';\n  import { declareLocation } from 'src/types/location-awareness.types';\n  import { TidyHooks } from 'src/foundry/TidyHooks';\n  import { ItemVisibility } from 'src/features/sections/ItemVisibility';\n  import { getSearchResultsContext } from 'src/features/search/search.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    section: InventorySection;\n  }\n\n  let { section }: Props = $props();\n\n  let context =\n    $derived(getSheetContext<CharacterSheetContext | NpcSheetContext>());\n\n  let itemEntries = $derived(\n    section.items.map((item) => ({\n      item: item,\n      ctx: context.itemContext[item.id],\n    })),\n  );\n\n  let customCommands = $derived(\n    ActorItemRuntime.getActorItemSectionCommands({\n      actor: context.actor,\n      section,\n    }),\n  );\n\n  const searchResults = getSearchResultsContext();\n\n  const localize = FoundryAdapter.localize;\n\n  function getInventoryRowClasses(item: Item5e) {\n    const extras: string[] = [];\n\n    return FoundryAdapter.getInventoryRowClasses(\n      item,\n      context.itemContext[item.id],\n      extras,\n    );\n  }\n\n  function preventUseItemEvent(ev: Event) {\n    ev.stopPropagation();\n  }\n\n  async function onMouseEnter(event: Event, item: Item5e) {\n    TidyHooks.tidy5eSheetsItemHoverOn(event, item);\n  }\n\n  async function onMouseLeave(event: Event, item: Item5e) {\n    TidyHooks.tidy5eSheetsItemHoverOff(event, item);\n  }\n\n  function handleDragStart(event: DragEvent, item: Item5e) {\n    if (!item) {\n      return;\n    }\n\n    onMouseLeave(event, item);\n\n    const dragData = item.toDragData();\n    event.dataTransfer?.setData('text/plain', JSON.stringify(dragData));\n  }\n\n  declareLocation('inventory-grid');\n</script>\n\n<ItemTable key={section.key} data-custom-section={section.custom ? true : null}>\n  {#snippet header()}\n    <ItemTableHeaderRow>\n      <ItemTableColumn primary={true}>\n        <span class=\"inventory-primary-column-label\">\n          {localize(section.label)} ({ItemVisibility.countVisibleItems(\n            section.items,\n            searchResults.uuids,\n          )})\n        </span>\n      </ItemTableColumn>\n    </ItemTableHeaderRow>\n  {/snippet}\n  {#snippet body()}\n    <div class=\"items\">\n      {#each itemEntries as { item, ctx } (item.id)}\n        {@const hidden = !searchResults.show(item.uuid)}\n        <a\n          class=\"item {getInventoryRowClasses(item)}\"\n          class:hidden\n          aria-hidden={hidden}\n          data-context-menu={CONSTANTS.CONTEXT_MENU_TYPE_ITEMS}\n          onclick={(event) =>\n            context.editable && FoundryAdapter.actorTryUseItem(item, event)}\n          oncontextmenu={(event) =>\n            FoundryAdapter.onActorItemButtonContextMenu(item, { event })}\n          onmousedown={(event) => FoundryAdapter.editOnMiddleClick(event, item)}\n          onmouseenter={(ev) => onMouseEnter(ev, item)}\n          onmouseleave={(ev) => onMouseLeave(ev, item)}\n          ondragstart={(ev) => handleDragStart(ev, item)}\n          draggable={true}\n          data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_USE_COMMAND}\n          data-item-id={item.id}\n          tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n          data-tidy-grid-item\n          data-info-card={item ? 'item' : null}\n          data-info-card-entity-uuid={item?.uuid ?? null}\n        >\n          <div class=\"item-name\">\n            <div\n              class=\"item-image\"\n              class:conceal={item.system.identified === false}\n              style=\"background-image: url('{item.img}');\"\n            >\n              <i class=\"fa fa-dice-d20\"></i>\n            </div>\n            <div\n              role=\"presentation\"\n              aria-hidden=\"true\"\n              class=\"unidentified-glyph no-transition\"\n              class:conceal={item.system.identified === false}\n            >\n              <i class=\"fas fa-question\"></i>\n            </div>\n          </div>\n\n          {#if ctx.attunement && !FoundryAdapter.concealDetails(item)}\n            <i\n              class=\"fas fa-sun icon-attuned {ctx.attunement?.cls ??\n                ''} no-pointer-events\"\n              title={localize(ctx.attunement?.title ?? '')}\n            ></i>\n          {/if}\n\n          {#if 'favoriteId' in ctx && !!ctx.favoriteId}\n            <GridPaneFavoriteIcon />\n          {/if}\n\n          {#if context.editable}\n            <button\n              type=\"button\"\n              class=\"item-control item-edit\"\n              style=\"display:none\"\n              data-action=\"itemEdit\"\n              title={localize('DND5E.ItemEdit')}\n              tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n            >\n              <i class=\"fas fa-edit fa-fw\"></i>\n            </button>\n          {/if}\n\n          <div class=\"item-stats\">\n            <div\n              class=\"item-detail item-uses\"\n              title=\"{localize('DND5E.Uses')}: {item.system.uses?.value}/{item\n                .system.uses?.max} \"\n            >\n              {#if ctx?.hasUses}\n                <i class=\"fas fa-bolt\"></i>\n                <TextInput\n                  document={item}\n                  field=\"system.uses.value\"\n                  value={item.system.uses?.value}\n                  placeholder=\"0\"\n                  maxlength={2}\n                  allowDeltaChanges={true}\n                  selectOnFocus={true}\n                  onclick={preventUseItemEvent}\n                  disabled={!context.editable}\n                  onSaveChange={(ev) =>\n                    FoundryAdapter.handleItemUsesChanged(ev, item) && false}\n                />\n              {/if}\n            </div>\n            <span\n              class=\"item-quantity\"\n              class:isStack={item.isStack}\n              title={localize('DND5E.Quantity')}\n            >\n              <TextInput\n                document={item}\n                field=\"system.quantity\"\n                class=\"item-count\"\n                value={item.system.quantity}\n                maxlength={2}\n                disabled={!context.editable || context.lockItemQuantity}\n                allowDeltaChanges={true}\n                selectOnFocus={true}\n                onclick={preventUseItemEvent}\n              />\n            </span>\n          </div>\n        </a>\n      {/each}\n      {#if context.unlocked}\n        <div class=\"items-footer\">\n          <button\n            type=\"button\"\n            class=\"footer-command icon-button\"\n            title={localize('DND5E.ItemCreate')}\n            onclick={(event) => {\n              event.preventDefault();\n              event.stopPropagation();\n              FoundryAdapter.createItem(\n                {\n                  ...section.dataset,\n                  action: 'itemCreate',\n                  tooltip: 'DND5E.ItemCreate',\n                },\n                context.actor,\n              );\n            }}\n            data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_CREATE_COMMAND}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n          >\n            <i class=\"fas fa-plus-circle\"></i>\n          </button>\n          {#each customCommands as command}\n            <button\n              type=\"button\"\n              class=\"footer-command icon-button\"\n              onclick={(ev) =>\n                command.execute?.({\n                  section,\n                  event: ev,\n                  actor: context.actor,\n                })}\n              tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n              title={localize(command.tooltip ?? '')}\n            >\n              {#if (command.iconClass ?? '') !== ''}\n                <i class={command.iconClass}></i>\n              {/if}\n              {localize(command.label ?? '')}\n            </button>\n          {/each}\n        </div>\n      {/if}\n    </div>\n  {/snippet}\n</ItemTable>\n\n<style lang=\"scss\">\n  .inventory-primary-column-label {\n    font-size: 0.75rem;\n    line-height: 0.75rem;\n    flex: 0 0 3.75rem;\n    white-space: nowrap;\n  }\n\n  .items {\n    padding: 0;\n    display: flex;\n    flex-wrap: wrap;\n\n    --item-width-height: 3.125rem;\n\n    .item {\n      width: var(--item-width-height);\n      height: var(--item-width-height);\n      position: relative;\n      margin: 0.1875rem;\n      box-shadow: 0 0 0.0625rem 0.0625rem var(--t5e-light-color);\n      border-radius: 0.3125rem;\n\n      &.context {\n        border: 0.0625rem solid var(--t5e-primary-accent-color);\n      }\n\n      &.equipped {\n        box-shadow: 0 0 0 0.125rem\n          var(--t5e-equipped-item-grid-tile-outline-color);\n        background: var(--t5e-equipped-background);\n\n        .item-image {\n          box-shadow: 0 0 0.0625rem 0.0625rem inset\n            var(--t5e-equipped-item-grid-tile-accent-color);\n          border-radius: 0.3125rem;\n        }\n      }\n\n      // TODO: Determine the best longterm way to support this...\n      &.magic-item {\n        .item-image {\n          box-shadow:\n            0 0 0 0.0625rem var(--t5e-magic-accent-color) inset,\n            0 0 0.1875rem 0.125rem var(--t5e-magic-accent-color) inset;\n          border-radius: 0.3125rem;\n        }\n\n        &.equipped .item-image {\n          box-shadow:\n            0 0 0rem 0.0625rem var(--t5e-magic-accent-color) inset,\n            0 0 0 0.0625rem var(--t5e-magic-accent-color) inset,\n            0 0 0.1875rem 0.125rem var(--t5e-magic-accent-color) inset;\n          border: none;\n        }\n      }\n\n      .icon-attuned {\n        font-size: 0.7188rem;\n        overflow: hidden;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        color: var(--t5e-attuned-item-grid-icon-color);\n        width: 0.8125rem;\n        height: 0.8125rem;\n        background: var(--t5e-magic-accent-color);\n        position: absolute;\n        top: -0.0625rem;\n        right: -0.0625rem;\n        border-radius: 50%;\n        box-shadow: 0 0 0.1875rem 0.0625rem var(--t5e-magic-accent-color);\n\n        &.not-attuned {\n          background: var(--t5e-attunement-required-color);\n          box-shadow: 0 0 0.1875rem 0.0625rem\n            var(--t5e-attunement-required-color);\n        }\n      }\n\n      .item-name {\n        display: block;\n        flex: unset;\n        width: 100%;\n        height: 100%;\n        border-radius: 0.3125rem;\n        overflow: hidden;\n      }\n\n      .item-image {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        width: 100%;\n        height: 100%;\n        margin: 0;\n        border-radius: 0;\n        background-repeat: no-repeat;\n        background-size: cover;\n        background-position: 50% 0;\n\n        i {\n          color: var(--t5e-tertiary-color);\n          text-align: center;\n          font-size: 1.125rem;\n          display: none;\n        }\n\n        &.conceal {\n          filter: grayscale(100%);\n        }\n      }\n\n      &:not([disabled]):hover .item-name .item-image {\n        background-image: none !important; // TODO: Figure out a way to avoid !important\n\n        i {\n          display: initial;\n        }\n      }\n\n      &:hover {\n        .unidentified-glyph {\n          display: none;\n        }\n      }\n\n      .unidentified-glyph {\n        font-size: calc(var(--item-width-height) - 1.5rem);\n      }\n\n      .item-name:hover {\n        .item-image:hover i {\n          color: var(--t5e-primary-font-color);\n        }\n      }\n\n      .item-stats {\n        position: absolute;\n        right: 0;\n        bottom: 0;\n        left: 0;\n        padding: 0 0.125rem 0 0.1875rem;\n        height: 0.875rem;\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n\n        .item-quantity,\n        .item-uses {\n          border: none;\n          font-size: 0.75rem;\n\n          :global(input) {\n            height: 0.875rem;\n            text-shadow: 0 0 0.3125rem\n              var(--t5e-inventory-grid-image-contrast-text-shadow-color);\n            text-align: right;\n            min-width: 0;\n            width: 1rem;\n            padding: 0;\n          }\n        }\n\n        .item-uses {\n          line-height: 1;\n          display: flex;\n          align-items: center;\n\n          :global(input) {\n            text-align: left;\n          }\n\n          .fa-bolt {\n            font-size: 0.5rem;\n            margin-right: 0.0625rem;\n            text-shadow: 0 0 0.3125rem\n              var(--t5e-inventory-grid-image-contrast-text-shadow-color);\n          }\n        }\n      }\n\n      .item-name:hover ~ .item-stats :global(input) {\n        color: var(--t5e-primary-font-color);\n        text-shadow: 0 0 0.3125rem\n          var(--t5e-inventory-grid-hover-use-item-contrast-text-shadow-color);\n      }\n    }\n\n    .items-footer {\n      flex: 0 0 auto;\n      height: 3.125rem;\n      margin: 0.125rem;\n      display: flex;\n\n      .footer-command {\n        display: flex;\n        flex: 0 0 3.125rem;\n        justify-content: center;\n        align-items: center;\n        white-space: nowrap;\n        height: 100%;\n        font-size: 1.5rem;\n        color: var(--t5e-faint-color);\n\n        &:hover {\n          color: var(--t5e-tertiary-color);\n        }\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import type { ContainerPanelItemContext } from 'src/types/types';\n  import CapacityBar from '../container/CapacityBar.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import type { Item5e } from 'src/types/item.types';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { coalesce } from 'src/utils/formatting';\n  import { TidyHooks } from 'src/foundry/TidyHooks';\n  import { getSearchResultsContext } from 'src/features/search/search.svelte';\n\n  interface Props {\n    containerPanelItems?: ContainerPanelItemContext[];\n    searchCriteria?: string;\n  }\n\n  let { containerPanelItems = [] }: Props = $props();\n\n  let searchResults = getSearchResultsContext();\n\n  async function onMouseEnter(event: Event, item: Item5e) {\n    TidyHooks.tidy5eSheetsItemHoverOn(event, item);\n  }\n\n  async function onMouseLeave(event: Event, item: Item5e) {\n    TidyHooks.tidy5eSheetsItemHoverOff(event, item);\n  }\n\n  function handleDragStart(event: DragEvent, item: Item5e) {\n    // Don't show cards while dragging\n    onMouseLeave(event, item);\n\n    const dragData = item.toDragData();\n    event.dataTransfer?.setData('text/plain', JSON.stringify(dragData));\n  }\n</script>\n\n<ul class=\"containers\">\n  {#each containerPanelItems as { container, ...capacity } (container.id)}\n    <li\n      draggable=\"true\"\n      data-item-id={container.id}\n      ondragstart={(ev) => handleDragStart(ev, container)}\n      onmouseenter={(ev) => onMouseEnter(ev, container)}\n      onmouseleave={(ev) => onMouseLeave(ev, container)}\n      class=\"container\"\n      title={container.system.identified === false\n        ? coalesce(\n            container.system.unidentified.name,\n            FoundryAdapter.localize('DND5E.Unidentified.Title'),\n          )\n        : container.name}\n      class:hidden={!searchResults.show(container.uuid)}\n      aria-hidden={!searchResults.show(container.uuid)}\n      data-info-card={'item'}\n      data-info-card-entity-uuid={container.uuid}\n    >\n      <a\n        type=\"button\"\n        class=\"container-image-button\"\n        onclick={() =>\n          (FoundryAdapter.userIsGm() || container.isOwner) &&\n          container.sheet.render(true)}\n        data-context-menu={CONSTANTS.CONTEXT_MENU_TYPE_ITEMS}\n      >\n        <div\n          class=\"container-image\"\n          class:conceal={container.system.identified === false}\n          style=\"background-image: url('{container.img}')\"\n        >\n          <div\n            role=\"presentation\"\n            aria-hidden=\"true\"\n            class=\"unidentified-glyph\"\n            class:conceal={container.system.identified === false}\n          >\n            <i class=\"fas fa-question\"></i>\n          </div>\n        </div>\n      </a>\n      <CapacityBar\n        showLabel={false}\n        {container}\n        {capacity}\n        --capacity-bar-height=\"0.5rem\"\n        --capacity-bar-container-border-radius=\"0 0 0.1875rem 0.1875rem\"\n      />\n    </li>\n  {/each}\n</ul>\n\n<style lang=\"scss\">\n  .containers {\n    --t5e-container-panel-item-size: 3.125rem;\n\n    flex: 1;\n    display: grid;\n    grid-template-columns: repeat(\n      auto-fit,\n      minmax(var(--t5e-container-panel-item-size), max-content)\n    );\n    gap: 0.375rem;\n    margin-left: 0.1875rem;\n\n    .container {\n      position: relative; //  required for correct drag preview\n      display: flex;\n      flex-direction: column;\n      height: 100%;\n\n      &.hidden {\n        display: none;\n      }\n    }\n\n    .container-image-button {\n      display: block;\n    }\n\n    .container-image {\n      aspect-ratio: 1;\n      border: 0.0625rem solid var(--t5e-separator-color);\n      border-radius: 0.1875rem 0.1875rem 0 0;\n      background-color: var(--t5e-light-color);\n      background-size: cover;\n      background-position: 50% 0;\n      transition: filter 0.75s;\n\n      &.conceal {\n        filter: grayscale(100%);\n      }\n    }\n\n    .unidentified-glyph {\n      font-size: calc(var(--t5e-container-panel-item-size) / 2);\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { Item5e } from 'src/types/item.types';\n\n  interface Props {\n    attunedItems?: Item5e[];\n  }\n\n  let { attunedItems = [] }: Props = $props();\n\n  let tooltip: HTMLElement;\n\n  export function getMarkup() {\n    return tooltip.outerHTML;\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div bind:this={tooltip} class=\"document-list-summary-tooltip\">\n  <h3>{localize('TIDY5E.AttunementItems')}</h3>\n  <hr />\n  <ul>\n    {#each attunedItems as item}\n      <li class=\"flex-row extra-small-gap align-items-center\">\n        <img class=\"item-image\" src={item.img} />\n        <div class=\"item-name truncate\">{item.name}</div>\n      </li>\n    {/each}\n  </ul>\n</div>\n","export class Tooltip {\n  static show(target: HTMLElement, markup: string) {\n    game.tooltip.activate(target, {\n      text: markup,\n      cssClass: 'tidy5e-sheet app-v1 app-v2 classic',\n    });\n  }\n}\n","<script lang=\"ts\">\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import AttunementSummaryTooltip from 'src/tooltips/AttunementSummaryTooltip.svelte';\n  import { Tooltip } from 'src/tooltips/Tooltip';\n  import type { Item5e } from 'src/types/item.types';\n  import type { CharacterSheetContext, NpcSheetContext } from 'src/types/types';\n\n  interface Props {\n    [key: string]: any;\n  }\n\n  let { ...rest }: Props = $props();\n\n  let context = $derived(getSheetContext<CharacterSheetContext | NpcSheetContext>());\n  const localize = FoundryAdapter.localize;\n\n  let attunedItems = $derived(\n    context.actor.items\n      .filter((i: Item5e) => i.system.attuned)\n      .sort((a: Item5e, b: Item5e) =>\n        a.name.localeCompare(b.name, game.i18n.lang),\n      ),\n  );\n\n  let attunementSummaryTooltip: AttunementSummaryTooltip;\n\n  function showAttunementSummaryTooltip(\n    event: MouseEvent & { currentTarget: EventTarget & HTMLElement },\n  ): any {\n    if (!attunedItems.length) {\n      return;\n    }\n\n    Tooltip.show(event?.currentTarget, attunementSummaryTooltip.getMarkup());\n  }\n</script>\n\n<div class=\"hidden\">\n  <AttunementSummaryTooltip\n    bind:this={attunementSummaryTooltip}\n    {attunedItems}\n  />\n</div>\n\n<div\n  class=\"attunement-tracker {rest.class ?? ''}\"\n  class:overattuned={context.actor.system.attributes.attunement.value >\n    context.actor.system.attributes.attunement.max}\n  data-tooltip-direction=\"UP\"\n  onmouseover={(ev) => showAttunementSummaryTooltip(ev)}\n>\n  <i class=\"attunement-icon fas fa-sun\"></i>\n  <span class=\"attuned-items-current\" title={localize('TIDY5E.AttunementItems')}\n    >{context.system.attributes.attunement.value}</span\n  >\n  /\n  {#if context.editable && FoundryAdapter.userIsGm()}\n    <NumberInput\n      selectOnFocus={true}\n      document={context.actor}\n      field=\"system.attributes.attunement.max\"\n      cssClass=\"attuned-items-max\"\n      value={context.system.attributes.attunement.max}\n      placeholder=\"0\"\n      title={localize('TIDY5E.AttunementMax')}\n      disabled={!context.editable || context.lockSensitiveFields}\n    />\n  {:else}\n    <span class=\"attuned-items-max\" title={localize('TIDY5E.AttunementMax')}\n      >{context.system.attributes.attunement.max}</span\n    >\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { type CharacterSheetContext } from 'src/types/types';\n  import type {\n    InventorySection,\n    ItemLayoutMode,\n    NpcSheetContext,\n  } from 'src/types/types';\n  import InventoryList from '../InventoryList.svelte';\n  import InventoryGrid from '../InventoryGrid.svelte';\n  import Currency from 'src/sheets/classic/actor/Currency.svelte';\n  import Notice from '../../../../components/notice/Notice.svelte';\n  import EncumbranceBar from 'src/sheets/classic/actor/EncumbranceBar.svelte';\n  import TabFooter from 'src/sheets/classic/actor/TabFooter.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import UtilityToolbar from 'src/components/utility-bar/UtilityToolbar.svelte';\n  import Search from 'src/components/utility-bar/Search.svelte';\n  import UtilityToolbarCommand from 'src/components/utility-bar/UtilityToolbarCommand.svelte';\n  import FilterMenu from 'src/components/filter/FilterMenu.svelte';\n  import ContainerPanel from 'src/sheets/classic/shared/ContainerPanel.svelte';\n  import ExpandableContainer from 'src/components/expandable/ExpandableContainer.svelte';\n  import PinnedFilterToggles from 'src/components/filter/PinnedFilterToggles.svelte';\n  import { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import { SheetSections } from 'src/features/sections/SheetSections';\n  import { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\n  import { ItemVisibility } from 'src/features/sections/ItemVisibility';\n  import AttunementTracker from '../AttunementTracker.svelte';\n  import {\n    createSearchResultsState,\n    setSearchResultsContext,\n  } from 'src/features/search/search.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    tabId: string;\n  }\n\n  let { tabId }: Props = $props();\n\n  let context =\n    $derived(getSheetContext<CharacterSheetContext | NpcSheetContext>());\n\n  let inventory = $derived(\n    SheetSections.configureInventory(\n      context.inventory,\n      tabId,\n      SheetPreferencesService.getByType(context.actor.type),\n      TidyFlags.sectionConfig.get(context.actor)?.[tabId],\n    ),\n  );\n\n  let searchCriteria: string = $state('');\n\n  const searchResults = createSearchResultsState();\n  setSearchResultsContext(searchResults);\n\n  $effect(() => {\n    searchResults.uuids = ItemVisibility.getItemsToShowAtDepth({\n      criteria: searchCriteria,\n      itemContext: context.itemContext,\n      sections: inventory,\n      tabId: tabId,\n    });\n  });\n\n  const localize = FoundryAdapter.localize;\n\n  let layoutMode: ItemLayoutMode = $derived(\n    TidyFlags.inventoryGrid.get(context.actor) ? 'grid' : 'list',\n  );\n\n  let noItems = $derived(\n    inventory.some((section: InventorySection) => section.items.length > 0) ===\n      false,\n  );\n\n  let utilityBarCommands = $derived(\n    context.utilities[tabId]?.utilityToolbarCommands ?? [],\n  );\n</script>\n\n<UtilityToolbar>\n  <Search bind:value={searchCriteria} />\n  <PinnedFilterToggles\n    filterGroupName={tabId}\n    filters={ItemFilterRuntime.getPinnedFiltersForTab(\n      context.filterPins,\n      context.filterData,\n      tabId,\n    )}\n  />\n  <FilterMenu {tabId} />\n  {#each utilityBarCommands as command (command.title)}\n    <UtilityToolbarCommand\n      title={command.title}\n      iconClass={command.iconClass}\n      text={command.text}\n      visible={command.visible ?? true}\n      onExecute={(ev) => command.execute?.(ev)}\n      sections={inventory}\n    />\n  {/each}\n</UtilityToolbar>\n\n<div\n  class=\"tidy-inventory-container scroll-container flex-column small-gap\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEMS_CONTAINER}\n>\n  {#if noItems && !context.unlocked}\n    <Notice>{localize('TIDY5E.EmptySection')}</Notice>\n  {:else}\n    {@const containerPanelExpanded =\n      context.showContainerPanel && !!context.containerPanelItems.length}\n    <ExpandableContainer\n      expanded={containerPanelExpanded}\n      class=\"container-panel-wrapper {containerPanelExpanded\n        ? 'container-panel-expanded'\n        : ''}\"\n    >\n      <ContainerPanel containerPanelItems={context.containerPanelItems} />\n    </ExpandableContainer>\n    {#each inventory as section (section.key)}\n      {@const visibleItemCount = ItemVisibility.countVisibleItems(\n        section.items,\n        searchResults.uuids,\n      )}\n      {#if section.show}\n        {#if (searchCriteria.trim() === '' && context.unlocked) || visibleItemCount > 0}\n          {#if layoutMode === 'list'}\n            <InventoryList\n              primaryColumnName=\"{localize(section.label)} ({visibleItemCount})\"\n              {section}\n            />\n          {:else}\n            <InventoryGrid {section} />\n          {/if}\n        {/if}\n      {/if}\n    {/each}\n  {/if}\n</div>\n\n<TabFooter mode=\"vertical\">\n  <div class=\"attunement-and-currency\">\n    <AttunementTracker class=\"align-self-center\" />\n    <Currency document={context.actor} />\n  </div>\n\n  {#if settings.value.useCharacterEncumbranceBar}\n    <EncumbranceBar />\n  {/if}\n</TabFooter>\n\n<style lang=\"scss\">\n  .attunement-and-currency {\n    display: flex;\n    flex: 0 0 1.875rem;\n    gap: 0.5rem;\n  }\n\n  .tidy-inventory-container\n    :global(.container-panel-wrapper:not(.container-panel-expanded)) {\n    margin-bottom: -0.5rem;\n  }\n</style>\n","import type {\n  CharacterSheetContext,\n  CustomContent,\n  NpcSheetContext,\n  Tab,\n} from 'src/types/types';\nimport { CONSTANTS } from 'src/constants';\nimport NpcAbilitiesTab from 'src/sheets/classic/npc/tabs/NpcAbilitiesTab.svelte';\nimport NpcSpellbookTab from 'src/sheets/classic/npc/tabs/NpcSpellbookTab.svelte';\nimport NpcBiographyTab from 'src/sheets/classic/npc/tabs/NpcBiographyTab.svelte';\nimport NpcEffectsTab from 'src/sheets/classic/npc/tabs/NpcEffectsTab.svelte';\nimport ActorJournalTab from 'src/sheets/classic/actor/tabs/ActorJournalTab.svelte';\nimport ActorActionsTab from 'src/sheets/classic/actor/tabs/ActorActionsTab.svelte';\nimport type { RegisteredContent, RegisteredTab } from './types';\nimport { debug, error, warn } from 'src/utils/logging';\nimport { TabManager } from './tab/TabManager';\nimport type { ActorTabRegistrationOptions } from 'src/api/api.types';\nimport { CustomContentManager } from './content/CustomContentManager';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport ActorInventoryTab from 'src/sheets/classic/actor/tabs/ActorInventoryTab.svelte';\n\nclass NpcSheetRuntime {\n  private _content = $state<RegisteredContent<NpcSheetContext>[]>([]);\n  private _tabs = $state<RegisteredTab<NpcSheetContext>[]>([\n    {\n      title: 'TIDY5E.Actions.TabName',\n      content: {\n        component: ActorActionsTab,\n        type: 'svelte',\n      },\n      id: CONSTANTS.TAB_ACTOR_ACTIONS,\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_NPC_ABILITIES,\n      title: 'TIDY5E.Abilities',\n      content: {\n        component: NpcAbilitiesTab,\n        type: 'svelte',\n      },\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_ACTOR_SPELLBOOK,\n      title: 'DND5E.Spellbook',\n      content: {\n        component: NpcSpellbookTab,\n        type: 'svelte',\n      },\n      enabled: (context) =>\n        !context.hideEmptySpellbook && context.showSpellbookTab,\n      layout: 'classic',\n    },\n    {\n      id: 'effects',\n      title: 'DND5E.Effects',\n      content: {\n        component: NpcEffectsTab,\n        type: 'svelte',\n      },\n      layout: 'classic',\n    },\n    {\n      id: 'biography',\n      title: 'DND5E.Biography',\n      content: {\n        component: NpcBiographyTab,\n        type: 'svelte',\n      },\n      layout: 'classic',\n    },\n    {\n      id: 'journal',\n      title: 'TIDY5E.JournalTabName',\n      content: {\n        component: ActorJournalTab,\n        type: 'svelte',\n      },\n      enabled: (context) => context.owner,\n      layout: 'classic',\n    },\n    {\n      id: 'inventory',\n      title: 'DND5E.Inventory',\n      content: {\n        component: ActorInventoryTab,\n        type: 'svelte',\n        getProps() {\n          return {\n            tabId: CONSTANTS.TAB_ACTOR_INVENTORY,\n          };\n        },\n      },\n      enabled: (context) => context.owner,\n      layout: 'classic',\n    },\n  ]);\n  tabMap = $derived(\n    this._tabs.reduce<Map<string, RegisteredTab<NpcSheetContext>>>(\n      (map, curr) => {\n        map.set(curr.id, curr);\n        return map;\n      },\n      new Map<string, RegisteredTab<NpcSheetContext>>()\n    )\n  );\n\n  async getContent(context: CharacterSheetContext): Promise<CustomContent[]> {\n    return await CustomContentManager.prepareContentForRender(\n      context,\n      this._content\n    );\n  }\n\n  getTabs(context: NpcSheetContext): Promise<Tab[]> {\n    return TabManager.prepareTabsForRender(context, this._tabs);\n  }\n\n  getAllRegisteredTabs(): RegisteredTab<NpcSheetContext>[] {\n    return [...this._tabs];\n  }\n\n  registerContent(registeredContent: RegisteredContent<NpcSheetContext>) {\n    this._content.push(registeredContent);\n  }\n\n  registerTab(\n    tab: RegisteredTab<NpcSheetContext>,\n    options?: ActorTabRegistrationOptions\n  ) {\n    const tabExists = this._tabs.some((t) => t.id === tab.id);\n\n    if (tabExists) {\n      warn(`Tab with id ${tab.id} already exists.`);\n      return;\n    }\n\n    if (tabExists && options?.overrideExisting) {\n      const index = this._tabs.findIndex((t) => t.id === tab.id);\n      if (index >= 0) {\n        this._tabs.splice(index, 1);\n      }\n    }\n\n    this._tabs.push(tab);\n  }\n\n  getTabTitle(tabId: string) {\n    try {\n      let tabTitle = this._tabs.find((t) => t.id === tabId)?.title;\n      if (typeof tabTitle === 'function') {\n        tabTitle = tabTitle();\n      }\n      return tabTitle ? FoundryAdapter.localize(tabTitle) : tabId;\n    } catch (e) {\n      error('An error occurred while searching for a tab title.', false, e);\n      debug('Tab title error troubleshooting information', { tabId });\n    }\n  }\n}\n\nconst singleton = new NpcSheetRuntime();\n\nexport default singleton;\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import {\n    type ActorSheetContextV1,\n    type RenderableClassicControl,\n  } from 'src/types/types';\n  import ItemTable from '../../../components/item-list/v1/ItemTable.svelte';\n  import ItemTableHeaderRow from '../../../components/item-list/v1/ItemTableHeaderRow.svelte';\n  import ItemTableColumn from '../../../components/item-list/v1/ItemTableColumn.svelte';\n  import ItemTableFooter from '../../../components/item-list/ItemTableFooter.svelte';\n  import ItemImage from '../../../components/item-list/ItemImage.svelte';\n  import ItemTableCell from '../../../components/item-list/v1/ItemTableCell.svelte';\n  import ItemControl from '../../../components/item-list/controls/ItemControl.svelte';\n  import Notice from 'src/components/notice/Notice.svelte';\n  import { declareLocation } from 'src/types/location-awareness.types';\n  import ClassicControls from '../shared/ClassicControls.svelte';\n  import ActorEffectToggleControl from 'src/components/item-list/controls/ActorEffectToggleControl.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import EffectTableRow from 'src/components/item-list/v1/EffectTableRow.svelte';\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  const localize = FoundryAdapter.localize;\n\n  let effectSections = $derived(Object.values<any>(context.effects));\n\n  let noEffects = $derived(\n    effectSections.some((section: any) => section.effects.length > 0) === false,\n  );\n\n  declareLocation('effects');\n\n  let controls: RenderableClassicControl<{ effect: any }>[] = $derived.by(\n    () => {\n      let result: RenderableClassicControl<{ effect: any }>[] = [];\n\n      result.push(\n        {\n          component: ActorEffectToggleControl,\n          props: ({ effect }) => ({\n            effect: effect,\n          }),\n        },\n        {\n          component: ItemControl,\n          props: ({ effect }) => ({\n            onclick: () => effect.sheet.render(true),\n            title: localize('DND5E.EffectEdit'),\n            iconCssClass: 'fas fa-edit',\n          }),\n        },\n      );\n\n      if (context.unlocked) {\n        result.push({\n          component: ItemControl,\n          props: ({ effect }) => ({\n            onclick: () => effect.deleteDialog(),\n            title: localize('DND5E.EffectDelete'),\n            iconCssClass: 'fas fa-trash',\n          }),\n        });\n      }\n\n      return result;\n    },\n  );\n\n  let classicControlsIconWidth = 1.25;\n\n  let classicControlsColumnWidth = $derived(\n    `${classicControlsIconWidth * controls.length}rem`,\n  );\n</script>\n\n<div class=\"scroll-container flex-column small-gap\">\n  {#if !context.allowEffectsManagement && context.unlocked}\n    <Notice>{localize('TIDY5E.GMOnlyEdit')}</Notice>\n  {/if}\n\n  {#if noEffects && !context.unlocked && context.allowEffectsManagement}\n    <Notice>{localize('TIDY5E.EmptySection')}</Notice>\n  {:else}\n    {#each effectSections as section}\n      {#if !section.hidden}\n        {#if (context.unlocked && context.allowEffectsManagement) || section.effects.length > 0}\n          {@const effectEntries = section.effects.map((e: any) => ({\n            effect: e,\n          }))}\n\n          <ItemTable key={section.label}>\n            {#snippet header()}\n              <ItemTableHeaderRow>\n                <ItemTableColumn primary={true}>\n                  {localize(section.label)}\n                </ItemTableColumn>\n                <ItemTableColumn baseWidth=\"12.5rem\">\n                  {localize('DND5E.SOURCE.FIELDS.source.label')}\n                </ItemTableColumn>\n                <ItemTableColumn baseWidth=\"7.5rem\">\n                  {localize('DND5E.Duration')}\n                </ItemTableColumn>\n                {#if context.editable && context.useClassicControls && context.allowEffectsManagement}\n                  <ItemTableColumn baseWidth={classicControlsColumnWidth} />\n                {/if}\n              </ItemTableHeaderRow>\n            {/snippet}\n            {#snippet body()}\n              {#each effectEntries as { effect } (effect.id)}\n                <EffectTableRow\n                  activeEffect={effect}\n                  attributes={{\n                    'data-info-card': 'effect',\n                    'data-info-card-entity-uuid': effect.uuid,\n                  }}\n                >\n                  {#snippet children({ toggleSummary })}\n                    <ItemTableCell\n                      primary={true}\n                      attributes={{\n                        'data-tidy-effect-name-container': true,\n                        'data-effect-id': effect.id,\n                      }}\n                    >\n                      <ItemImage src={effect.img ?? effect.icon} />\n                      <a\n                        onclick={() => toggleSummary()}\n                        class=\"truncate flex-row align-items-center flex-1\"\n                      >\n                        <span\n                          class=\"align-self-center truncate flex-1\"\n                          title={effect.name}\n                          data-tidy-effect-name={effect.name}\n                          >{effect.name}</span\n                        >\n                      </a>\n                    </ItemTableCell>\n                    <ItemTableCell baseWidth=\"12.5rem\">\n                      <span class=\"truncate\" title={effect.sourceName ?? ''}\n                        >{effect.sourceName ?? ''}</span\n                      >\n                    </ItemTableCell>\n                    <ItemTableCell baseWidth=\"7.5rem\">\n                      <span class=\"truncate\" title={effect.duration.label ?? ''}\n                        >{effect.duration.label ?? ''}</span\n                      >\n                    </ItemTableCell>\n                    {#if context.editable && context.useClassicControls && context.allowEffectsManagement}\n                      <ItemTableCell baseWidth={classicControlsColumnWidth}>\n                        <ClassicControls\n                          {controls}\n                          params={{ effect: effect }}\n                        />\n                      </ItemTableCell>\n                    {/if}\n                  {/snippet}\n                </EffectTableRow>\n              {/each}\n              {#if context.unlocked && context.allowEffectsManagement}\n                <ItemTableFooter\n                  actor={context.actor}\n                  {section}\n                  create={() =>\n                    FoundryAdapter.addEffect(section.type, context.actor)}\n                  isItem={false}\n                />\n              {/if}\n            {/snippet}\n          </ItemTable>\n        {/if}\n      {/if}\n    {/each}\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import ContentEditableFormField from 'src/components/inputs/ContentEditableFormField.svelte';\n  import HorizontalLineSeparator from 'src/components/layout/HorizontalLineSeparator.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { quadInOut } from 'svelte/easing';\n  import { slide } from 'svelte/transition';\n  import { getVehicleSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getVehicleSheetContext());\n\n  const localize = FoundryAdapter.localize;\n  let totalCrew = $derived(\n    context.system.cargo.crew.reduce(\n      (count: number, c: { quantity: number }) => count + c.quantity,\n      0,\n    ),\n  );\n  let totalActions = $derived(context.system.attributes.actions.value ?? 0);\n  let actionsPerTurn = $derived(\n    totalCrew >= context.system.attributes.actions.thresholds[2]\n      ? totalActions\n      : totalCrew >= context.system.attributes.actions.thresholds[1]\n        ? Math.max(totalActions - 1, 0)\n        : totalCrew >= context.system.attributes.actions.thresholds[0]\n          ? Math.max(totalActions - 2, 0)\n          : 0,\n  );\n  let crewTallyDescription = $derived(\n    actionsPerTurn === totalActions\n      ? localize('DND5E.VehicleActionThresholdsFull')\n      : actionsPerTurn === totalActions - 1\n        ? localize('DND5E.VehicleActionThresholdsMid')\n        : actionsPerTurn === totalActions - 2\n          ? localize('DND5E.VehicleActionThresholdsMin')\n          : null,\n  );\n</script>\n\n<div class=\"counters counter-flex\">\n  <div class=\"counter creature-cap\">\n    <h4>{localize('DND5E.VehicleCreatureCapacity')}</h4>\n    <div class=\"counter-value\">\n      <ContentEditableFormField\n        element=\"div\"\n        document={context.actor}\n        field=\"system.attributes.capacity.creature\"\n        editable={context.editable && !context.lockSensitiveFields}\n        placeholder=\"\"\n        value={context.system.attributes.capacity.creature}\n        dataMaxLength={1000}\n      />\n    </div>\n  </div>\n  <HorizontalLineSeparator />\n  <div class=\"counter cargo-cap\">\n    <h4 class=\"flex-1\">{localize('DND5E.VehicleCargoCapacity')}</h4>\n    <div class=\"counter-value\">\n      <NumberInput\n        document={context.actor}\n        field=\"system.attributes.capacity.cargo\"\n        value={context.system.attributes.capacity.cargo}\n        min=\"0\"\n        placeholder=\"0\"\n        selectOnFocus={true}\n        disabled={!context.editable || context.lockSensitiveFields}\n      />\n    </div>\n  </div>\n  <HorizontalLineSeparator />\n  <div class=\"counter stations\">\n    <div class=\"counter-value\">\n      <Checkbox\n        document={context.actor}\n        field=\"system.attributes.actions.stations\"\n        checked={context.system.attributes.actions.stations}\n        labelCssClass=\"action-stations-label\"\n        disabled={!context.editable || context.lockSensitiveFields}\n      >\n        <span>{localize('DND5E.VehicleActionStations')}</span>\n      </Checkbox>\n    </div>\n  </div>\n  {#if !context.system.attributes.actions.stations}\n    <div\n      class=\"counter-flex\"\n      transition:slide={{ duration: 200, easing: quadInOut }}\n    >\n      <HorizontalLineSeparator />\n      <div class=\"counter actions\">\n        <h4>{localize('DND5E.ActionPl')}</h4>\n        <div class=\"counter-value\">\n          <NumberInput\n            document={context.actor}\n            field=\"system.attributes.actions.value\"\n            value={context.system.attributes.actions.value}\n            step=\"1\"\n            min=\"0\"\n            placeholder=\"0\"\n            title={localize('DND5E.VehicleActionsHint')}\n            selectOnFocus={true}\n            disabled={!context.editable || context.lockSensitiveFields}\n          />\n        </div>\n      </div>\n      <HorizontalLineSeparator />\n      <div class=\"counter action-thresholds\">\n        <h4>{localize('DND5E.VehicleActionThresholds')}</h4>\n        <div class=\"counter-value\">\n          <span class=\"sep\">&lt;</span>\n\n          <NumberInput\n            document={context.actor}\n            field=\"system.attributes.actions.thresholds.2\"\n            value={context.system.attributes.actions.thresholds['2']}\n            min=\"0\"\n            step=\"1\"\n            placeholder=\"\"\n            title={localize('DND5E.VehicleActionThresholdsFull')}\n            selectOnFocus={true}\n            disabled={!context.editable || context.lockSensitiveFields}\n          />\n\n          <span class=\"sep\">&lt;</span>\n          <NumberInput\n            document={context.actor}\n            field=\"system.attributes.actions.thresholds.1\"\n            value={context.system.attributes.actions.thresholds['1']}\n            min=\"0\"\n            step=\"1\"\n            placeholder=\"\"\n            title={localize('DND5E.VehicleActionThresholdsMid')}\n            selectOnFocus={true}\n            disabled={!context.editable || context.lockSensitiveFields}\n          />\n\n          <span class=\"sep\">&lt;</span>\n          <NumberInput\n            document={context.actor}\n            field=\"system.attributes.actions.thresholds.0\"\n            value={context.system.attributes.actions.thresholds['0']}\n            min=\"0\"\n            step=\"1\"\n            placeholder=\"\"\n            title={localize('DND5E.VehicleActionThresholdsMin')}\n            selectOnFocus={true}\n            disabled={!context.editable || context.lockSensitiveFields}\n          />\n        </div>\n      </div>\n      <HorizontalLineSeparator />\n      <div class=\"counter action-summary\">\n        <h4>{localize('TIDY5E.TotalCrewCount')}</h4>\n        <div class=\"counter-value\" title={crewTallyDescription}>\n          {totalCrew}\n        </div>\n      </div>\n      <HorizontalLineSeparator />\n      <div class=\"counter action-summary\">\n        <h4>{localize('TIDY5E.ActionsPerTurn')}</h4>\n        <div class=\"counter-value\">\n          {actionsPerTurn}\n        </div>\n      </div>\n    </div>\n  {/if}\n</div>\n\n<style lang=\"scss\">\n  .counter-flex {\n    display: flex;\n    flex-direction: column;\n    gap: 0.25rem;\n  }\n\n  .counters {\n    background: var(--t5e-faint-color);\n    border-radius: 0.3125rem;\n    padding: 0.25rem 0.5rem;\n    font-size: 0.75rem;\n\n    .counter-value :global(input[type='number']) {\n      height: 1.25rem;\n    }\n\n    .stations .counter-value :global(.action-stations-label) {\n      display: flex;\n      align-items: center;\n    }\n\n    .stations .counter-value :global(.action-stations-label input) {\n      margin-left: 0;\n    }\n\n    .action-thresholds .counter-value {\n      display: flex;\n      align-items: center;\n\n      :global(input) {\n        width: 2rem;\n        text-align: center;\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { getPercentage } from 'src/utils/numbers';\n\n  interface Props {\n    value?: number | null | undefined;\n    max?: number | null | undefined;\n    percentage?: number | null;\n    color?: string;\n    cssClass?: string | null;\n  }\n\n  let {\n    value = null,\n    max = null,\n    percentage = null,\n    color = 'var(--t5e-hp-bar-color)',\n    cssClass = null,\n  }: Props = $props();\n\n  let barPercentage = $derived(percentage ?? getPercentage(value, max));\n</script>\n\n<div\n  class=\"bar {cssClass}\"\n  style=\"width: {barPercentage}%; --bar-color: {color}\"\n></div>\n\n<style lang=\"scss\">\n  .bar {\n    position: absolute;\n    top: 0;\n    left: 0;\n    height: 100%;\n    background: var(--bar-color);\n    transition: width 0.5s ease;\n  }\n</style>\n","<script lang=\"ts\">\n  import Bar from './Bar.svelte';\n\n  interface Props {\n    value?: number | null | undefined;\n    max?: number | null | undefined;\n    percentage?: number | null;\n  }\n\n  let { value = null, max = null, percentage = null }: Props = $props();\n</script>\n\n<Bar {value} {max} {percentage} color=\"var(--t5e-hp-bar-color)\" />\n","<script lang=\"ts\">\n  import type { Component } from 'svelte';\n  import TextInput from '../inputs/TextInput.svelte';\n\n  interface Props {\n    document: any;\n    value: number;\n    valueField: string;\n    valueTitle?: string | null;\n    valueDisabled?: boolean;\n    max: number;\n    maxField: string;\n    maxTitle?: string | null;\n    maxDisabled?: boolean;\n    percentage?: number | null;\n    Bar?: Component<any> | null;\n  }\n\n  let {\n    document,\n    value,\n    valueField,\n    valueTitle = null,\n    valueDisabled = false,\n    max,\n    maxField,\n    maxTitle = null,\n    maxDisabled = false,\n    percentage = null,\n    Bar = null,\n  }: Props = $props();\n</script>\n\n<div class=\"resource-container\">\n  {#if Bar}\n    <Bar {percentage} {value} {max} />\n  {/if}\n  {#if !valueDisabled}\n    <TextInput\n      class=\"resource-value\"\n      {document}\n      field={valueField}\n      {value}\n      placeholder=\"0\"\n      title={valueTitle}\n      selectOnFocus={true}\n      allowDeltaChanges={true}\n      maxlength={5}\n      ariaDescribedBy=\"tooltip\"\n    />\n  {:else}\n    <span class=\"resource-value\" title={valueTitle}>{value}</span>\n  {/if}\n  <span class=\"resource-separator\">/</span>\n  {#if !maxDisabled}\n    <TextInput\n      class=\"resource-max\"\n      {document}\n      field={maxField}\n      value={max}\n      placeholder=\"0\"\n      title={maxTitle}\n      selectOnFocus={true}\n      allowDeltaChanges={true}\n      maxlength={5}\n      ariaDescribedBy=\"tooltip\"\n      disabled={maxDisabled}\n    />\n  {:else}\n    <span class=\"resource-max\" title={maxTitle}>{max}</span>\n  {/if}\n</div>\n\n<style lang=\"scss\">\n  .resource-container {\n    position: absolute;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background: var(--t5e-icon-background);\n    box-shadow: 0 0 0.3125rem var(--t5e-icon-shadow-color) inset;\n    border: 0.0625rem solid var(--t5e-icon-outline-color);\n    width: inherit;\n    height: inherit;\n    font-family: inherit;\n    font-weight: inherit;\n    border-radius: inherit;\n\n    :global(:not(.bar)) {\n      position: relative;\n    }\n\n    :global(.resource-value) {\n      text-align: right;\n    }\n\n    :global(.resource-max) {\n      text-align: left;\n    }\n\n    :global(.resource-max),\n    :global(.resource-value) {\n      flex: 1 1 0;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import type { Item5e } from 'src/types/item.types';\n  import ItemControl from 'src/components/item-list/controls/ItemControl.svelte';\n\n  interface Props {\n    item: Item5e;\n    ctx: any;\n  }\n\n  let { item, ctx }: Props = $props();\n</script>\n\n<ItemControl\n  iconCssClass=\"fas fa-user-alt {ctx?.toggleClass}\"\n  title={ctx?.toggleTitle}\n  active={ctx?.toggleClass === 'active'}\n  onclick={() =>\n    item.update({\n      ['system.crewed']: !item.system.crewed,\n    })}\n/>\n","<script lang=\"ts\">\n  import { getContext } from 'svelte';\n  import Traits from '../../actor/traits/Traits.svelte';\n  import VehicleAttributes from '../parts/VehicleAttributes.svelte';\n  import type {\n    RenderableClassicControl,\n    VehicleFeatureSection,\n  } from 'src/types/types';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ItemTable from 'src/components/item-list/v1/ItemTable.svelte';\n  import ItemTableHeaderRow from 'src/components/item-list/v1/ItemTableHeaderRow.svelte';\n  import ItemTableColumn from 'src/components/item-list/v1/ItemTableColumn.svelte';\n  import ItemTableRow from 'src/components/item-list/v1/ItemTableRow.svelte';\n  import ItemTableCell from 'src/components/item-list/v1/ItemTableCell.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import ItemName from 'src/components/item-list/ItemName.svelte';\n  import ItemUseButton from 'src/components/item-list/ItemUseButton.svelte';\n  import ItemTableFooter from 'src/components/item-list/ItemTableFooter.svelte';\n  import ItemUses from 'src/components/item-list/ItemUses.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import ItemDeleteControl from 'src/components/item-list/controls/ItemDeleteControl.svelte';\n  import ItemEditControl from 'src/components/item-list/controls/ItemEditControl.svelte';\n  import Notice from 'src/components/notice/Notice.svelte';\n  import HpBar from '../../../../components/bar/HpBar.svelte';\n  import ResourceWithBar from 'src/components/bar/ResourceWithBar.svelte';\n  import RechargeControl from 'src/components/item-list/controls/RechargeControl.svelte';\n  import ActionFilterOverrideControl from 'src/components/item-list/controls/ActionFilterOverrideControl.svelte';\n  import { declareLocation } from 'src/types/location-awareness.types';\n  import ItemCrewedControl from 'src/sheets/classic/vehicle/parts/ItemCrewedControl.svelte';\n  import type { Item5e } from 'src/types/item.types';\n  import ClassicControls from 'src/sheets/classic/shared/ClassicControls.svelte';\n  import { ItemUtils } from 'src/utils/ItemUtils';\n  import InlineToggleControl from 'src/sheets/classic/shared/InlineToggleControl.svelte';\n  import type { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import { getVehicleSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getVehicleSheetContext());\n\n  let inlineToggleService = getContext<InlineToggleService>(\n    CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n  );\n\n  const localize = FoundryAdapter.localize;\n\n  let baseWidths: Record<string, string> = {\n    cover: '3.125rem',\n    'system.quantity': '4.375rem',\n    'system.armor.value': '2.5rem',\n    'system.hp.value': '4.375rem',\n    threshold: '2.5rem',\n  };\n\n  let alternateColumnHeaderContent: Record<string, string> = {\n    threshold: `<i class=\"fas fa-heart-crack\" title=\"${localize(\n      'DND5E.Threshold',\n    )}\"></i>`,\n  };\n\n  let noFeatures = $derived(\n    !context.features.some(\n      (section: VehicleFeatureSection) => section.items.length,\n    ),\n  );\n\n  declareLocation('attributes');\n\n  let controls: RenderableClassicControl<{ item: Item5e; ctx: any }>[] =\n    $derived.by(() => {\n      let result: RenderableClassicControl<{ item: Item5e; ctx: any }>[] = [];\n      result.push(\n        {\n          component: ItemCrewedControl,\n          props: ({ item, ctx }) => ({\n            item,\n            ctx,\n          }),\n        },\n        {\n          component: ItemEditControl,\n          props: ({ item }) => ({\n            item,\n          }),\n        },\n      );\n\n      if (context.unlocked) {\n        result.push({\n          component: ItemDeleteControl,\n          props: ({ item }) => ({\n            item,\n          }),\n        });\n      }\n\n      if (context.useActionsFeature) {\n        result.push({\n          component: ActionFilterOverrideControl,\n          props: ({ item }) => ({\n            item,\n          }),\n        });\n      }\n\n      return result;\n    });\n\n  let classicControlsIconWidth = 1.25;\n\n  let classicControlsColumnWidth = $derived(\n    `${classicControlsIconWidth * controls.length}rem`,\n  );\n</script>\n\n<div class=\"attributes-tab-contents\" data-tidy-track-scroll-y>\n  <div class=\"side-panel\">\n    <VehicleAttributes />\n    <Traits\n      useSenses={false}\n      enableSpecialTraitsConfiguration={false}\n    />\n  </div>\n  <div class=\"main-panel flex-column small-gap\">\n    {#if noFeatures && !context.unlocked}\n      <Notice>\n        {localize('TIDY5E.EmptySection')}\n      </Notice>\n    {:else}\n      {#each context.features as section (section.key)}\n        {#if context.unlocked || section.items.length}\n          {@const itemEntries = section.items.map((item) => ({\n            item,\n            ctx: context.itemContext[item.id],\n          }))}\n\n          <ItemTable key={section.key}>\n            {#snippet header()}\n              <ItemTableHeaderRow>\n                <ItemTableColumn primary={true}>\n                  {localize(section.label)}\n                </ItemTableColumn>\n                {#if section.hasActions}\n                  <ItemTableColumn baseWidth=\"3.125rem\">\n                    {localize('DND5E.Uses')}\n                  </ItemTableColumn>\n                  <ItemTableColumn baseWidth=\"7.5rem\">\n                    {localize('DND5E.Usage')}\n                  </ItemTableColumn>\n                {/if}\n                {#if section.columns}\n                  {#each section.columns as column}\n                    <ItemTableColumn\n                      cssClass=\"items-header-{column.css}\"\n                      baseWidth={baseWidths[column.property] ?? '3.125rem'}\n                    >\n                      {#if alternateColumnHeaderContent[column.property]}\n                        {@html alternateColumnHeaderContent[column.property]}\n                      {:else}\n                        {column.label}\n                      {/if}\n                    </ItemTableColumn>\n                  {/each}\n                {/if}\n                {#if context.editable && context.useClassicControls}\n                  <ItemTableColumn baseWidth={classicControlsColumnWidth} />\n                {/if}\n              </ItemTableHeaderRow>\n            {/snippet}\n            {#snippet body()}\n              {#each itemEntries as { item, ctx } (item.id)}\n                <ItemTableRow\n                  onMouseDown={(event) =>\n                    FoundryAdapter.editOnMiddleClick(event, item)}\n                  contextMenu={{\n                    type: CONSTANTS.CONTEXT_MENU_TYPE_ITEMS,\n                    uuid: item.uuid,\n                  }}\n                  {item}\n                  cssClass={FoundryAdapter.getInventoryRowClasses(item, ctx)}\n                >\n                  {#snippet children({ toggleSummary })}\n                    <ItemTableCell primary={true}>\n                      <ItemUseButton disabled={!context.editable} {item} />\n                      <ItemName\n                        onToggle={() => toggleSummary(context.actor)}\n                        cssClass=\"extra-small-gap\"\n                        {item}\n                      >\n                        <span\n                          class=\"truncate flex-1\"\n                          data-tidy-item-name={item.name}\n                          data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_NAME}\n                          >{item.name}</span\n                        >\n                      </ItemName>\n                    </ItemTableCell>\n                    {#if section.hasActions}\n                      <ItemTableCell baseWidth=\"3.125rem\">\n                        {#if item.isOnCooldown}\n                          <RechargeControl\n                            document={item}\n                            field={'system.uses.spent'}\n                            uses={item.system.uses}\n                          />\n                        {:else if item.hasRecharge}\n                          {@const remaining =\n                            item.system.uses.max - item.system.uses.spent}\n                          {#if remaining > 1}\n                            <span>{remaining}</span>\n                          {/if}\n                          <i\n                            class=\"fas fa-bolt\"\n                            title={localize('DND5E.Charged')}\n                          ></i>\n                        {:else if ctx?.hasUses}\n                          <ItemUses {item} />\n                        {:else}\n                          <span class=\"text-body-tertiary\">&mdash;</span>\n                        {/if}\n                      </ItemTableCell>\n                      <ItemTableCell baseWidth=\"7.5rem\">\n                        {#if ItemUtils.hasActivationType(item)}\n                          <span>{item.labels?.activation ?? ''}</span>\n                        {/if}\n                      </ItemTableCell>\n                    {/if}\n                    {#if section.columns}\n                      {#each section.columns as column}\n                        {#if column.property === 'system.hp.value'}\n                          <!-- TODO: Extract to its own component; formalize this feature of overriding specific columns based on property matching -->\n                          <ItemTableCell baseWidth=\"4.375rem\">\n                            <div\n                              class=\"item-hp\"\n                              title={localize('DND5E.HitPoints')}\n                            >\n                              <ResourceWithBar\n                                document={item}\n                                value={item.system.hp.value}\n                                valueField=\"system.hp.value\"\n                                valueTitle={localize('DND5E.HitPointsCurrent')}\n                                valueDisabled={!context.editable}\n                                max={item.system.hp.max}\n                                maxField=\"system.hp.max\"\n                                maxTitle={localize('DND5E.HitPointsMax')}\n                                maxDisabled={!context.editable ||\n                                  context.lockSensitiveFields}\n                                Bar={HpBar}\n                              />\n                            </div>\n                          </ItemTableCell>\n                        {:else}\n                          {@const isNumber = column.editable === 'Number'}\n                          {@const fallback = isNumber ? '0' : ''}\n                          {@const value =\n                            FoundryAdapter.getProperty(\n                              item,\n                              column.property,\n                            )?.toString() ??\n                            FoundryAdapter.getProperty(\n                              ctx,\n                              column.property,\n                            )?.toString() ??\n                            fallback}\n                          <ItemTableCell\n                            baseWidth={baseWidths[column.property] ??\n                              '3.125rem'}\n                          >\n                            {#if column.editable}\n                              <TextInput\n                                document={item}\n                                field={column.property}\n                                allowDeltaChanges={isNumber}\n                                selectOnFocus={true}\n                                {value}\n                                disabled={!context.editable}\n                              />\n                            {:else}\n                              {FoundryAdapter.getProperty(\n                                item,\n                                column.property,\n                              ) ??\n                                FoundryAdapter.getProperty(\n                                  ctx,\n                                  column.property,\n                                ) ??\n                                fallback}\n                            {/if}\n                          </ItemTableCell>\n                        {/if}\n                      {/each}\n                    {/if}\n                    {#if context.editable && context.useClassicControls}\n                      <ItemTableCell baseWidth={classicControlsColumnWidth}>\n                        <ClassicControls\n                          {controls}\n                          params={{ item: item, ctx: ctx }}\n                        />\n                      </ItemTableCell>\n                    {/if}\n                  {/snippet}\n                </ItemTableRow>\n              {/each}\n              {#if context.unlocked && section.dataset}\n                <ItemTableFooter\n                  actor={context.actor}\n                  {section}\n                  isItem={true}\n                />\n              {/if}\n            {/snippet}\n          </ItemTable>\n        {/if}\n      {/each}\n    {/if}\n  </div>\n</div>\n\n<style lang=\"scss\">\n  .attributes-tab-contents {\n    flex: 1;\n    display: flex;\n    flex-direction: row;\n    gap: 1rem;\n    padding-right: 0.75rem;\n    overflow-y: scroll;\n    .side-panel {\n      display: flex;\n      flex-direction: column;\n      gap: 0.5rem;\n      width: 13.75rem;\n    }\n\n    .main-panel {\n      flex: 1;\n    }\n\n    :global(.items-header-item-threshold) {\n      align-self: flex-start;\n    }\n\n    .item-hp {\n      align-self: center;\n      position: relative;\n      width: calc(100% - 0.25rem);\n      margin-left: 0.125rem;\n      margin-right: 0.125rem;\n      height: 1.325rem;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type {\n    RenderableClassicControl,\n    VehicleCargoSection,\n  } from 'src/types/types';\n  import { getContext } from 'svelte';\n  import ItemTable from 'src/components/item-list/v1/ItemTable.svelte';\n  import ItemTableColumn from 'src/components/item-list/v1/ItemTableColumn.svelte';\n  import ItemTableRow from 'src/components/item-list/v1/ItemTableRow.svelte';\n  import ItemTableHeaderRow from 'src/components/item-list/v1/ItemTableHeaderRow.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import ItemTableCell from 'src/components/item-list/v1/ItemTableCell.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import ItemUseButton from 'src/components/item-list/ItemUseButton.svelte';\n  import ItemName from 'src/components/item-list/ItemName.svelte';\n  import ItemTableFooter from 'src/components/item-list/ItemTableFooter.svelte';\n  import ItemDeleteControl from 'src/components/item-list/controls/ItemDeleteControl.svelte';\n  import ItemEditControl from 'src/components/item-list/controls/ItemEditControl.svelte';\n  import ActionFilterOverrideControl from 'src/components/item-list/controls/ActionFilterOverrideControl.svelte';\n  import type { Item5e } from 'src/types/item.types';\n  import ClassicControls from 'src/sheets/classic/shared/ClassicControls.svelte';\n  import type { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import InlineToggleControl from 'src/sheets/classic/shared/InlineToggleControl.svelte';\n  import InlineContainerView from 'src/sheets/classic/container/InlineContainerView.svelte';\n  import { getVehicleSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    section: VehicleCargoSection;\n  }\n\n  let { section }: Props = $props();\n\n  let context = $derived(getVehicleSheetContext());\n\n  let itemEntries = $derived(\n    section.items.map((item) => ({ item, ctx: context.itemContext[item.id] })),\n  );\n\n  let inlineToggleService = getContext<InlineToggleService>(\n    CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n  );\n\n  let baseWidths: Record<string, string> = {\n    quantity: '5rem',\n    price: '4.375rem',\n    weight: '3.75rem',\n  };\n\n  let controls: RenderableClassicControl<{ item: Item5e }>[] = $derived.by(\n    () => {\n      let result: RenderableClassicControl<{ item: Item5e }>[] = [\n        {\n          component: ItemEditControl,\n          props: ({ item }) => ({\n            item,\n          }),\n        },\n      ];\n\n      if (context.unlocked) {\n        result.push({\n          component: ItemDeleteControl,\n          props: ({ item }) => ({\n            item,\n          }),\n        });\n      }\n\n      if (context.useActionsFeature) {\n        result.push({\n          component: ActionFilterOverrideControl,\n          props: ({ item }) => ({\n            item,\n          }),\n        });\n      }\n\n      return result;\n    },\n  );\n\n  let classicControlsIconWidth = 1.25;\n\n  let classicControlsColumnWidth = $derived(\n    `${classicControlsIconWidth * controls.length}rem`,\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<ItemTable key={section.key}>\n  {#snippet header()}\n    <ItemTableHeaderRow>\n      <ItemTableColumn primary={true}>\n        {localize(section.label)}\n      </ItemTableColumn>\n      {#each section.columns as column}\n        <ItemTableColumn\n          cssClass=\"items-header-{column.css}\"\n          baseWidth={baseWidths[column.property] ?? '3.125rem'}\n        >\n          {column.label}\n        </ItemTableColumn>\n      {/each}\n      {#if context.editable && context.useClassicControls}\n        <ItemTableColumn baseWidth={classicControlsColumnWidth} />\n      {/if}\n    </ItemTableHeaderRow>\n  {/snippet}\n  {#snippet body()}\n    {#each itemEntries as { item, ctx }, index (item.id ?? index)}\n      <ItemTableRow\n        onMouseDown={(event) => FoundryAdapter.editOnMiddleClick(event, item)}\n        contextMenu={{\n          type: CONSTANTS.CONTEXT_MENU_TYPE_ITEMS,\n          uuid: item.uuid,\n        }}\n        {item}\n        cssClass={FoundryAdapter.getInventoryRowClasses(item, ctx)}\n      >\n        {#snippet children({ toggleSummary })}\n          <ItemTableCell primary={true}>\n            <ItemUseButton disabled={!context.editable} {item} />\n            {#if 'containerContents' in ctx && !!ctx.containerContents}\n              <InlineToggleControl entityId={item.id} {inlineToggleService} />\n            {/if}\n            <ItemName\n              onToggle={() => toggleSummary(context.actor)}\n              cssClass=\"extra-small-gap\"\n              {item}\n            >\n              <span\n                class=\"truncate flex-1\"\n                data-tidy-item-name={item.name}\n                data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_NAME}\n                >{item.name}</span\n              >\n            </ItemName>\n          </ItemTableCell>\n          {#if section.columns}\n            {#each section.columns as column}\n              {@const isNumber = column.editable === 'Number'}\n              {@const fallback = isNumber ? '0' : ''}\n              {@const value =\n                FoundryAdapter.getProperty(item, column.property)?.toString() ??\n                FoundryAdapter.getProperty(ctx, column.property)?.toString() ??\n                fallback}\n              <ItemTableCell\n                baseWidth={baseWidths[column.property] ?? '3.125rem'}\n              >\n                {#if column.editable}\n                  <TextInput\n                    document={item}\n                    field={column.property}\n                    allowDeltaChanges={isNumber}\n                    selectOnFocus={true}\n                    {value}\n                    disabled={!context.editable ||\n                      (column.property === 'quantity' &&\n                        context.lockItemQuantity)}\n                  />\n                {:else}\n                  {FoundryAdapter.getProperty(item, column.property) ??\n                    FoundryAdapter.getProperty(ctx, column.property) ??\n                    fallback}\n                {/if}\n              </ItemTableCell>\n            {/each}\n          {/if}\n          {#if context.editable && context.useClassicControls}\n            <ItemTableCell baseWidth={classicControlsColumnWidth}>\n              <ClassicControls {controls} params={{ item: item }} />\n            </ItemTableCell>\n          {/if}\n        {/snippet}\n      </ItemTableRow>\n      {#if 'containerContents' in ctx && !!ctx.containerContents}\n        <InlineContainerView\n          container={item}\n          containerContents={ctx.containerContents}\n          editable={context.editable}\n          {inlineToggleService}\n          lockItemQuantity={context.lockItemQuantity}\n          sheetDocument={context.actor}\n          unlocked={context.unlocked}\n        />\n      {/if}\n    {/each}\n    {#if context.unlocked && section.dataset}\n      <ItemTableFooter\n        actor={context.actor}\n        {section}\n        create={() =>\n          FoundryAdapter.createItem(\n            { type: section.dataset.type },\n            context.actor,\n          )}\n        isItem={section.dataset.type !== 'crew' &&\n          section.dataset.type !== 'passengers'}\n      />\n    {/if}\n  {/snippet}\n</ItemTable>\n","<script lang=\"ts\">\n  import ItemTableFooter from 'src/components/item-list/ItemTableFooter.svelte';\n  import ItemDeleteControl from 'src/components/item-list/controls/ItemDeleteControl.svelte';\n  import ItemTable from 'src/components/item-list/v1/ItemTable.svelte';\n  import ItemTableCell from 'src/components/item-list/v1/ItemTableCell.svelte';\n  import ItemTableColumn from 'src/components/item-list/v1/ItemTableColumn.svelte';\n  import ItemTableHeaderRow from 'src/components/item-list/v1/ItemTableHeaderRow.svelte';\n  import ItemTableRow from 'src/components/item-list/v1/ItemTableRow.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type {\n    CargoOrCrewItem,\n    RenderableClassicControl,\n    VehicleCargoSection,\n  } from 'src/types/types';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import ClassicControls from 'src/sheets/classic/shared/ClassicControls.svelte';\n  import { getVehicleSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    section: VehicleCargoSection;\n  }\n\n  let { section }: Props = $props();\n\n  let baseWidths: Record<string, string> = {\n    quantity: '5rem',\n    price: '4.375rem',\n    weight: '3.75rem',\n  };\n\n  let context = $derived(getVehicleSheetContext());\n\n  let itemEntries = $derived(\n    section.items.map((item) => ({ item, ctx: context.itemContext[item.id] })),\n  );\n\n  const classicControlsEditableRowBaseWidth = '1.5rem';\n\n  function saveNonItemSectionData(\n    ev: Event & { currentTarget: HTMLInputElement },\n    index: number,\n    field: string,\n    section: VehicleCargoSection,\n  ) {\n    const cargo = foundry.utils.deepClone(\n      context.actor.system.cargo[section.dataset.type],\n    );\n\n    const value = ev.currentTarget.value;\n\n    const item = cargo[index];\n\n    if (item) {\n      item[field] = ev.currentTarget.type === 'number' ? Number(value) : value;\n\n      context.actor.update({\n        [`system.cargo.${section.dataset.type}`]: cargo,\n      });\n    }\n\n    return false;\n  }\n\n  function deleteCrewOrPassenger(section: VehicleCargoSection, index: number) {\n    const cargo = foundry.utils\n      .deepClone(context.actor.system.cargo[section.dataset.type])\n      .filter((_: unknown, i: number) => i !== index);\n\n    context.actor.update({\n      [`system.cargo.${section.dataset.type}`]: cargo,\n    });\n\n    return false;\n  }\n\n  async function onItemCreate(type: string) {\n    const actor = context.actor;\n    const cargo = foundry.utils.deepClone(actor.system.cargo[type]);\n    cargo.push(FoundryAdapter.getNewCargo());\n    return actor.update({ [`system.cargo.${type}`]: cargo });\n  }\n\n  let controls: RenderableClassicControl<{\n    item: CargoOrCrewItem;\n    index: number;\n    section: VehicleCargoSection;\n  }>[] = $derived.by(() => {\n    let result: RenderableClassicControl<{\n      item: CargoOrCrewItem;\n      index: number;\n      section: VehicleCargoSection;\n    }>[] = [];\n\n    if (context.unlocked) {\n      result.push({\n        component: ItemDeleteControl,\n        props: ({ item, index, section }) => ({\n          onDelete: () => deleteCrewOrPassenger(section, index),\n          item: item,\n        }),\n      });\n    }\n\n    return result;\n  });\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div style=\"display: contents;\" class=\"passenger-crew-list-container\">\n  <ItemTable key={section.key}>\n    {#snippet header()}\n      <ItemTableHeaderRow>\n        <ItemTableColumn primary={true}>\n          {localize(section.label)}\n        </ItemTableColumn>\n        {#each section.columns as column}\n          <ItemTableColumn\n            cssClass=\"items-header-{column.css}\"\n            baseWidth={baseWidths[column.property] ?? '3.125rem'}\n          >\n            {column.label}\n          </ItemTableColumn>\n        {/each}\n        {#if context.editable && context.unlocked}\n          <ItemTableColumn baseWidth={classicControlsEditableRowBaseWidth} />\n        {/if}\n      </ItemTableHeaderRow>\n    {/snippet}\n    {#snippet body()}\n      {#each itemEntries as { item, ctx }, index (item.id ?? index)}\n        <ItemTableRow>\n          <ItemTableCell primary={true}>\n            <TextInput\n              document={item}\n              field=\"name\"\n              selectOnFocus={true}\n              onSaveChange={(ev) =>\n                saveNonItemSectionData(ev, index, 'name', section)}\n              value={item.name}\n              class=\"editable-name\"\n              disabled={!context.editable}\n              attributes={{ 'data-tidy-item-name': item.name }}\n            />\n          </ItemTableCell>\n          {#if section.columns}\n            {#each section.columns as column}\n              {@const isNumber = column.editable === 'Number'}\n              {@const fallback = isNumber ? '0' : ''}\n              {@const value =\n                FoundryAdapter.getProperty(item, column.property)?.toString() ??\n                FoundryAdapter.getProperty(ctx, column.property)?.toString() ??\n                fallback}\n              <ItemTableCell\n                baseWidth={baseWidths[column.property] ?? '3.125rem'}\n              >\n                {#if column.editable && !item.id}\n                  <TextInput\n                    document={item}\n                    field={column.property}\n                    allowDeltaChanges={isNumber}\n                    selectOnFocus={true}\n                    {value}\n                    onSaveChange={(ev) =>\n                      saveNonItemSectionData(\n                        ev,\n                        index,\n                        column.property,\n                        section,\n                      )}\n                    disabled={!context.editable ||\n                      (column.property === 'quantity' &&\n                        context.lockItemQuantity)}\n                  />\n                {:else}\n                  {FoundryAdapter.getProperty(item, column.property) ??\n                    FoundryAdapter.getProperty(ctx, column.property) ??\n                    fallback}\n                {/if}\n              </ItemTableCell>\n            {/each}\n          {/if}\n          {#if context.editable && context.unlocked}\n            <ItemTableCell baseWidth={classicControlsEditableRowBaseWidth}>\n              <ClassicControls\n                {controls}\n                params={{ item: item, index: index, section: section }}\n              />\n            </ItemTableCell>\n          {/if}\n        </ItemTableRow>\n      {/each}\n      {#if context.unlocked && section.dataset}\n        <ItemTableFooter\n          actor={context.actor}\n          {section}\n          create={() => onItemCreate(section.dataset.type)}\n          isItem={section.dataset.type !== 'crew' &&\n            section.dataset.type !== 'passengers'}\n        />\n      {/if}\n    {/snippet}\n  </ItemTable>\n</div>\n\n<style lang=\"scss\">\n  .passenger-crew-list-container :global(input.editable-name) {\n    padding: 0 0.25rem;\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { VehicleCargoSection } from 'src/types/types';\n  import Notice from 'src/components/notice/Notice.svelte';\n  import Currency from '../../actor/Currency.svelte';\n  import EncumbranceBar from '../../actor/EncumbranceBar.svelte';\n  import TabFooter from '../../actor/TabFooter.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import CargoList from '../parts/CargoList.svelte';\n  import PassengerOrCrewList from '../parts/PassengerOrCrewList.svelte';\n  import { getVehicleSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getVehicleSheetContext());\n\n  let noCargoOrCrew = $derived(\n    context.cargo.some(\n      (section: VehicleCargoSection) => section.items.length > 0,\n    ) === false,\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n{#if noCargoOrCrew && !context.unlocked}\n  <Notice>\n    {localize('TIDY5E.EmptySection')}\n  </Notice>\n{/if}\n\n<div class=\"scroll-container flex-column small-gap\">\n  {#each context.cargo as section (section.key)}\n    {#if context.unlocked || section.items.length}\n      {#if section.editableName}\n        <PassengerOrCrewList {section} />\n      {:else}\n        <CargoList {section} />\n      {/if}\n    {/if}\n  {/each}\n</div>\n\n<TabFooter mode=\"vertical\">\n  <div class=\"currency\">\n    <Currency document={context.actor} />\n  </div>\n\n  {#if settings.value.useVehicleEncumbranceBar}\n    <EncumbranceBar />\n  {/if}\n</TabFooter>\n","<script lang=\"ts\">\n  import SheetEditor from '../../../../components/editor/SheetEditor.svelte';\n  import RerenderAfterFormSubmission from 'src/components/utility/RerenderAfterFormSubmission.svelte';\n  import { getVehicleSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getVehicleSheetContext());\n</script>\n\n<div class=\"note-entries\" data-tidy-track-scroll-y>\n  <RerenderAfterFormSubmission\n    andOnValueChange={context.system.details.biography.value}\n  >\n    <article class=\"biography-notes\" use:context.activateEditors>\n      <SheetEditor\n        content={context.biographyHTML}\n        target=\"system.details.biography.value\"\n        editable={context.editable}\n      />\n    </article>\n  </RerenderAfterFormSubmission>\n</div>\n\n<style lang=\"scss\">\n  .note-entries {\n    flex: 1;\n    overflow-y: scroll;\n    padding-right: 0.75rem;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n\n    :global(.editor) {\n      height: unset;\n    }\n  }\n</style>\n","import type { CustomContent, Tab, VehicleSheetContext } from 'src/types/types';\nimport { CONSTANTS } from 'src/constants';\nimport ActorEffectsTab from 'src/sheets/classic/actor/ActorEffectsTab.svelte';\nimport VehicleAttributesTab from 'src/sheets/classic/vehicle/tabs/VehicleAttributesTab.svelte';\nimport VehicleCargoAndCrewTab from 'src/sheets/classic/vehicle/tabs/VehicleCargoAndCrewTab.svelte';\nimport VehicleDescriptionTab from 'src/sheets/classic/vehicle/tabs/VehicleDescriptionTab.svelte';\nimport ActorActionsTab from 'src/sheets/classic/actor/tabs/ActorActionsTab.svelte';\nimport type { RegisteredContent, RegisteredTab } from './types';\nimport { debug, error, warn } from 'src/utils/logging';\nimport { TabManager } from './tab/TabManager';\nimport type { ActorTabRegistrationOptions } from 'src/api/api.types';\nimport { CustomContentManager } from './content/CustomContentManager';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\nexport class VehicleSheetRuntime {\n  private static _content: RegisteredContent<VehicleSheetContext>[] = [];\n  private static _tabs: RegisteredTab<VehicleSheetContext>[] = [\n    {\n      title: 'TIDY5E.Actions.TabName',\n      content: {\n        component: ActorActionsTab,\n        type: 'svelte',\n      },\n      id: CONSTANTS.TAB_ACTOR_ACTIONS,\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_VEHICLE_ATTRIBUTES,\n      title: 'DND5E.Attributes',\n      content: {\n        component: VehicleAttributesTab,\n        type: 'svelte',\n      },\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_VEHICLE_CARGO_AND_CREW,\n      title: 'DND5E.VehicleCargoCrew',\n      content: {\n        component: VehicleCargoAndCrewTab,\n        type: 'svelte',\n      },\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_NPC_EFFECTS,\n      title: 'DND5E.Effects',\n      content: {\n        component: ActorEffectsTab,\n        type: 'svelte',\n      },\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_VEHICLE_DESCRIPTION,\n      title: 'DND5E.Description',\n      content: {\n        component: VehicleDescriptionTab,\n        type: 'svelte',\n      },\n      layout: 'classic',\n    },\n  ];\n\n  static async getContent(\n    context: VehicleSheetContext\n  ): Promise<CustomContent[]> {\n    return await CustomContentManager.prepareContentForRender(\n      context,\n      VehicleSheetRuntime._content\n    );\n  }\n\n  static getTabs(context: VehicleSheetContext): Promise<Tab[]> {\n    return TabManager.prepareTabsForRender(context, VehicleSheetRuntime._tabs);\n  }\n\n  static getAllRegisteredTabs(): RegisteredTab<VehicleSheetContext>[] {\n    return [...VehicleSheetRuntime._tabs];\n  }\n\n  static registerContent(\n    registeredContent: RegisteredContent<VehicleSheetContext>\n  ) {\n    this._content.push(registeredContent);\n  }\n\n  static registerTab(\n    tab: RegisteredTab<VehicleSheetContext>,\n    options?: ActorTabRegistrationOptions\n  ) {\n    const tabExists = VehicleSheetRuntime._tabs.some((t) => t.id === tab.id);\n\n    if (tabExists) {\n      warn(`Tab with id ${tab.id} already exists.`);\n      return;\n    }\n\n    if (tabExists && options?.overrideExisting) {\n      const index = VehicleSheetRuntime._tabs.findIndex((t) => t.id === tab.id);\n      if (index >= 0) {\n        VehicleSheetRuntime._tabs.splice(index, 1);\n      }\n    }\n\n    VehicleSheetRuntime._tabs.push(tab);\n  }\n\n  static getTabTitle(tabId: string) {\n    try {\n      let tabTitle = this._tabs.find((t) => t.id === tabId)?.title;\n      if (typeof tabTitle === 'function') {\n        tabTitle = tabTitle();\n      }\n      return tabTitle ? FoundryAdapter.localize(tabTitle) : tabId;\n    } catch (e) {\n      error('An error occurred while searching for a tab title.', false, e);\n      debug('Tab title error troubleshooting information', { tabId });\n    }\n  }\n}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getGroupSheetClassicContext } from 'src/sheets/sheet-context.svelte';\n  import type { Actor5e } from 'src/types/types';\n\n  const context = $derived(getGroupSheetClassicContext());\n\n  interface Props {\n    member: Actor5e;\n  }\n\n  let { member }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<button\n  type=\"button\"\n  class=\"inline-icon-button\"\n  onclick={() => context.actor.system.removeMember(member.id)}\n  title={localize('TIDY5E.Group.RemoveMemberFromGroup')}\n  tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n>\n  <i class=\"fas fa-xmark\"></i>\n</button>\n","<script lang=\"ts\">\n  import type { Snippet } from 'svelte';\n\n  interface Props {\n    /**\n     * Optional CSS class list string to apply to the AC Shield container element.\n     */\n    cssClass?: string;\n    children?: Snippet;\n  }\n\n  let { cssClass = '', children }: Props = $props();\n</script>\n\n<div class=\"ac-display {cssClass}\">\n  <div class=\"ac-shield\">\n    <svg\n      version=\"1.1\"\n      x=\"0px\"\n      y=\"0px\"\n      viewBox=\"0 0 90 100\"\n      xml:space=\"preserve\"\n    >\n      <path\n        d=\"M45,100C-2.6,79.3,0,12.6,0,12.6c0-2.2,1.8-4,4.4-4.6l39.1-7.9C44,0,44.5,0,45,0c0.5,0,1,0,1.4,0.1L85.5,8\n                  c2.6,0.5,4.4,2.4,4.4,4.6C90,12.6,92.6,79.3,45,100L45,100z\"\n      />\n    </svg>\n  </div>\n  {@render children?.()}\n</div>\n\n<style lang=\"scss\">\n  .ac-display {\n    position: relative;\n\n    .ac-shield {\n      width: 3.75rem;\n      height: 100%;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      margin: 0 auto;\n      svg {\n        path {\n          fill: var(--t5e-light-color);\n        }\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import HpBar from 'src/components/bar/HpBar.svelte';\n  import ResourceWithBar from 'src/components/bar/ResourceWithBar.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import type { Actor5e } from 'src/types/types';\n  import { getPercentage } from 'src/utils/numbers';\n\n  interface Props {\n    member: Actor5e;\n    showHp: boolean;\n  }\n\n  let { member, showHp }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div role=\"presentation\" class=\"member-list-item-image-wrapper\">\n  <button\n    class=\"transparent-button\"\n    type=\"button\"\n    onclick={() =>\n      FoundryAdapter.renderImagePopout(member.img, {\n        title: FoundryAdapter.localize('TIDY5E.PortraitTitle', {\n          subject: member.name,\n        }),\n        shareable: true,\n        uuid: member.uuid,\n      })}\n    tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n  >\n    <img\n      class=\"member-list-item-image\"\n      src={member.img}\n      alt={member.name}\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.GROUP_MEMBER_PORTRAIT}\n    />\n  </button>\n\n  {#if showHp}\n    <div class=\"member-list-item-hp-bar\">\n      <ResourceWithBar\n        document={member}\n        value={member.system.attributes.hp.value}\n        valueField=\"system.attributes.hp.value\"\n        valueTitle={localize('DND5E.HitPointsCurrent')}\n        valueDisabled={true}\n        max={member.system.attributes.hp.max}\n        maxField=\"system.attributes.hp.max\"\n        maxTitle={localize('DND5E.HitPointsMax')}\n        maxDisabled={true}\n        percentage={getPercentage(\n          member.system.attributes.hp.value,\n          member.system.attributes.hp.max,\n        )}\n        Bar={HpBar}\n      />\n    </div>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import type { Actor5e } from 'src/types/types';\n  import RemoveMemberControl from './RemoveMemberControl.svelte';\n  import AcShieldBase from 'src/sheets/classic/actor/AcShieldBase.svelte';\n  import type { GroupMemberContext } from 'src/types/group.types';\n  import { CONSTANTS } from 'src/constants';\n  import GroupMemberListItemProfile from './GroupMemberListItemProfile.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getGroupSheetClassicContext } from 'src/sheets/sheet-context.svelte';\n\n  const context = $derived(getGroupSheetClassicContext());\n\n  interface Props {\n    member: Actor5e;\n    ctx: GroupMemberContext;\n  }\n\n  let { member, ctx }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n\n  function onPerceptionClicked(\n    event: MouseEvent & {\n      currentTarget: EventTarget & HTMLButtonElement;\n    },\n  ) {\n    if (ctx.perception) {\n      member.rollSkill(\n        {\n          skill: ctx.perception.key,\n          event: event,\n        },\n        {\n          options: {\n            default: {\n              rollMode: CONST.DICE_ROLL_MODES.BLIND,\n            },\n          },\n        },\n      );\n    }\n  }\n</script>\n\n<div\n  class=\"group-member-list-item flex-row small-gap align-items-flex-start\"\n  data-member-drag\n  data-member-id={member.id}\n  data-context-menu={CONSTANTS.CONTEXT_MENU_TYPE_GROUP_MEMBER}\n>\n  <GroupMemberListItemProfile {member} showHp={ctx.canObserve} />\n  <div class=\"flex-column extra-small-gap flex-1 align-self-center\">\n    <div\n      class=\"flex-row small-gap align-items-center justify-content-space-between\"\n    >\n      <button\n        type=\"button\"\n        class=\"inline-transparent-button highlight-on-hover ff-title fs-lg\"\n        onclick={() => member.sheet.render(true)}\n        disabled={!ctx.canObserve}\n        tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n      >\n        {member.name}\n      </button>\n      {#if context.unlocked}\n        <RemoveMemberControl {member} />\n      {/if}\n    </div>\n\n    {#if ctx.canObserve}\n      <div class=\"flex-row extra-small-gap\">\n        <AcShieldBase cssClass=\"group-ac-shield\">\n          <span class=\"ac-value\">{member.system.attributes.ac.value}</span>\n        </AcShieldBase>\n        <div class=\"flex-1\">\n          <div class=\"flex-row extra-small-gap\">\n            <span>\n              <i\n                class=\"fas fa-eye fa-fw text-body-secondary\"\n                title={localize('DND5E.Senses')}\n              ></i>\n            </span>\n            <span>\n              {#if ctx.senses.length}\n                {ctx.senses.join(', ')}\n              {:else}\n                <i>{localize('TIDY5E.NoSpecialSenses')}</i>\n              {/if}\n            </span>\n          </div>\n          {#if ctx.conditionImmunities.length}\n            <div class=\"flex-row extra-small-gap\">\n              <span>\n                <i\n                  class=\"fas fa-shield-virus fa-fw text-body-secondary\"\n                  title={localize('DND5E.ConImm')}\n                ></i>\n              </span>\n              <span>\n                {ctx.conditionImmunities.join(', ')}\n              </span>\n            </div>\n          {/if}\n        </div>\n      </div>\n\n      <div class=\"flex-row flex-wrap skills\">\n        {#if ctx.perception}\n          <button\n            type=\"button\"\n            class=\"skill\"\n            disabled={!context.isGM}\n            onclick={(event) => onPerceptionClicked(event)}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n          >\n            {localize(ctx.perception?.label ?? '')}\n            {ctx.perception?.formattedTotal} ({ctx.perception?.passive})\n          </button>\n        {/if}\n        {#each ctx.topSkills as skill (skill.key)}\n          <span class=\"skill\">\n            {localize(skill?.label ?? '')}\n            {skill?.formattedTotal}\n          </span>\n        {/each}\n      </div>\n    {/if}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import GroupMemberListItem from './GroupMemberListItem.svelte';\n  import { getContext } from 'svelte';\n  import type { GroupMemberSection } from 'src/types/group.types';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import TidyTable from 'src/components/table/TidyTable.svelte';\n  import TidyTableHeaderRow from 'src/components/table/TidyTableHeaderRow.svelte';\n  import TidyTableHeaderCell from 'src/components/table/TidyTableHeaderCell.svelte';\n  import HorizontalLineSeparator from 'src/components/layout/HorizontalLineSeparator.svelte';\n  import { getGroupSheetClassicContext } from 'src/sheets/sheet-context.svelte';\n  import { getSearchResultsContext } from 'src/features/search/search.svelte';\n\n  interface Props {\n    section: GroupMemberSection;\n  }\n\n  let { section }: Props = $props();\n\n  const searchResults = getSearchResultsContext();\n\n  const context = $derived(getGroupSheetClassicContext());\n\n  const memberEntries = $derived(section.members.map((member) => ({ member })));\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<TidyTable key={section.key} data-custom-section={section.custom ? true : null}>\n  {#snippet header()}\n    <TidyTableHeaderRow>\n      <TidyTableHeaderCell primary={true}>\n        {localize(section.label)}\n      </TidyTableHeaderCell>\n    </TidyTableHeaderRow>\n  {/snippet}\n  {#snippet body()}\n    <div class=\"flex-column small-gap mt-2\">\n      {#each memberEntries as { member }, index (member.uuid)}\n        {#if searchResults.show(member.uuid)}\n          <GroupMemberListItem\n            {member}\n            ctx={context.memberContext[member.id]}\n          />\n\n          {#if section.members.length > 1 && index !== section.members.length - 1}\n            <HorizontalLineSeparator class=\"mx-1\" borderColor=\"separator\" />\n          {/if}\n        {/if}\n      {/each}\n    </div>\n  {/snippet}\n</TidyTable>\n","import type { GroupMemberSection } from 'src/types/group.types';\nimport type { SheetPreference } from '../user-preferences/user-preferences.types';\nimport { ItemUtils } from 'src/utils/ItemUtils';\nimport { error } from 'src/utils/logging';\n\nexport class GroupSheetSections {\n  static configureMemberSections(\n    sections: GroupMemberSection[],\n    tabId: string,\n    sheetPreferences: SheetPreference\n    /* TODO: sectionConfig?: Record<string, SectionConfig> */\n  ) {\n    try {\n      const sortMode = sheetPreferences.tabs?.[tabId]?.sort ?? 'm';\n\n      // Members are already in sorted order when sorting is set to manual.\n      if (sortMode === 'a') {\n        sections.forEach((section) => {\n          ItemUtils.sortItems(section.members, sortMode);\n        });\n      }\n    } catch (e) {\n      error('An error occurred while configuring group members', false, e);\n    }\n    return sections;\n  }\n}\n","<script lang=\"ts\">\n  import TidyTable, {\n    type TidyTableColumns,\n  } from 'src/components/table/TidyTable.svelte';\n  import TidyTableHeaderCell from 'src/components/table/TidyTableHeaderCell.svelte';\n  import TidyTableHeaderRow from 'src/components/table/TidyTableHeaderRow.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import {\n    type GroupSheetClassicContext,\n    type Group5eMember,\n    type GroupMemberSection,\n  } from 'src/types/group.types';\n  import RemoveMemberControl from './RemoveMemberControl.svelte';\n  import TidyTableCell from 'src/components/table/TidyTableCell.svelte';\n  import TidyTableRow from 'src/components/table/TidyTableRow.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSearchResultsContext } from 'src/features/search/search.svelte';\n  import { getGroupSheetClassicContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    section: GroupMemberSection;\n  }\n\n  let { section }: Props = $props();\n\n  const searchResults = getSearchResultsContext();\n\n  const context = $derived(getGroupSheetClassicContext());\n\n  const memberEntries = $derived(section.members.map((member) => ({ member })));\n\n  const localize = FoundryAdapter.localize;\n\n  const classicControlWidthRems = 1.5;\n\n  const classicControls = [\n    {\n      component: RemoveMemberControl,\n      getProps: (member: Group5eMember) => ({ member }),\n    },\n  ];\n\n  let useClassicControls = $derived(\n    FoundryAdapter.useClassicControls(context.actor),\n  );\n\n  let gridTemplateColumns = $derived.by(() => {\n    let result: TidyTableColumns = [\n      {\n        name: 'Image and name',\n        width: '1fr',\n      },\n      {\n        name: 'Quantity',\n        width: '5rem',\n      },\n      {\n        name: 'Formula',\n        width: '7rem',\n      },\n    ];\n\n    if (section.showCrColumn) {\n      result.push({\n        name: 'CR',\n        width: '7rem',\n      });\n    }\n\n    if (useClassicControls) {\n      result.push({\n        name: 'Controls',\n        width: `${classicControlWidthRems * classicControls.length}rem`,\n      });\n    }\n\n    return result;\n  });\n\n  function saveQuantityChange(\n    context: GroupSheetClassicContext,\n    ev: Event & { currentTarget: HTMLInputElement },\n    memberActorId: string,\n  ) {\n    context.actor.sheet.updateMemberQuantity(memberActorId, ev);\n    return false;\n  }\n\n  function saveFormulaChange(\n    context: GroupSheetClassicContext,\n    ev: Event & { currentTarget: HTMLInputElement },\n    memberActorId: string,\n  ) {\n    context.actor.sheet.updateMemberFormula(memberActorId, ev);\n    return false;\n  }\n</script>\n\n<section class=\"encounter-member-list-section\">\n  <TidyTable\n    key={section.key}\n    data-custom-section={section.custom ? true : null}\n    {gridTemplateColumns}\n  >\n    {#snippet header()}\n      <TidyTableHeaderRow>\n        <TidyTableHeaderCell primary={true}>\n          {localize(section.label)}\n        </TidyTableHeaderCell>\n        <TidyTableHeaderCell>\n          <span>{localize('DND5E.QuantityAbbr')}</span>&nbsp;\n          <button\n            type=\"button\"\n            class=\"inline-icon-button\"\n            title={localize('DND5E.QuantityRoll')}\n            onclick={() => context.actor.system.rollQuantities()}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n          >\n            <i class=\"fas fa-dice\"></i>\n          </button>\n        </TidyTableHeaderCell>\n        <TidyTableHeaderCell>\n          <!-- Formula -->\n        </TidyTableHeaderCell>\n        {#if section.showCrColumn}\n          <TidyTableHeaderCell>\n            {localize('DND5E.Group.Challenge')}\n          </TidyTableHeaderCell>\n        {/if}\n        <TidyTableHeaderCell>\n          <!-- Controls -->\n        </TidyTableHeaderCell>\n      </TidyTableHeaderRow>\n    {/snippet}\n    {#snippet body()}\n      <div class=\"flex-column no-gap\">\n        {#each memberEntries as { member }, index (member.uuid)}\n          {@const ctx = context.memberContext[member.id]}\n          {#if searchResults.show(member.uuid)}\n            <TidyTableRow\n              rowContainerAttributes={{\n                ['data-member-drag']: '',\n                ['data-context-menu']: CONSTANTS.CONTEXT_MENU_TYPE_GROUP_MEMBER,\n                ['data-member-id']: member.id,\n              }}\n            >\n              <TidyTableCell class=\"flex-row small-gap\" primary={true}>\n                <button\n                  type=\"button\"\n                  class=\"inline-transparent-button\"\n                  disabled={!ctx.canObserve}\n                  onclick={() =>\n                    FoundryAdapter.renderImagePopout(member.img, {\n                      title: FoundryAdapter.localize('TIDY5E.PortraitTitle', {\n                        subject: member.name,\n                      }),\n                      shareable: true,\n                      uuid: member.uuid,\n                    })}\n                  tabindex={settings.value.useAccessibleKeyboardSupport\n                    ? 0\n                    : -1}\n                >\n                  <img\n                    class=\"encounter-member-list-item-image\"\n                    alt={member.name}\n                    src={member.img}\n                    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS\n                      .GROUP_MEMBER_PORTRAIT}\n                  />\n                </button>\n                <button\n                  type=\"button\"\n                  class=\"encounter-member-name transparent-button highlight-on-hover\"\n                  onclick={() => member.sheet.render(true)}\n                  tabindex={settings.value.useAccessibleKeyboardSupport\n                    ? 0\n                    : -1}\n                >\n                  {member.name}\n                </button>\n              </TidyTableCell>\n              <TidyTableCell>\n                <TextInput\n                  document={context.actor}\n                  field=\"system.members.{ctx.index}.quantity.value\"\n                  value={context.system.members[ctx.index].quantity.value}\n                  allowDeltaChanges={true}\n                  selectOnFocus={true}\n                  onSaveChange={(ev) =>\n                    saveQuantityChange(context, ev, member.id)}\n                  placeholder=\"1\"\n                />\n              </TidyTableCell>\n              <TidyTableCell>\n                <TextInput\n                  document={context.actor}\n                  field=\"system.members.{ctx.index}.quantity.formula\"\n                  value={context.system.members[ctx.index].quantity.formula}\n                  allowDeltaChanges={true}\n                  selectOnFocus={true}\n                  onSaveChange={(ev) =>\n                    saveFormulaChange(context, ev, member.id)}\n                  placeholder={localize('DND5E.Formula')}\n                />\n              </TidyTableCell>\n              {#if section.showCrColumn}\n                <TidyTableCell>\n                  {#if member.type === CONSTANTS.SHEET_TYPE_NPC}\n                    <abbr class=\"text-body-secondary\"\n                      >{localize('DND5E.AbbreviationCR')}</abbr\n                    >&nbsp;\n                    <span class=\"text-body semibold\"\n                      >{FoundryAdapter.formatCr(member.system.details.cr)}</span\n                    >\n                    {#if !context.disableExperience}\n                      &nbsp;&nbsp;\n                      <span class=\"text-body semibold\">\n                        {FoundryAdapter.formatNumber(\n                          member.system.details.xp.value *\n                            (ctx.quantity?.value ?? 1),\n                        )}\n                      </span>&nbsp;\n                      <abbr>{localize('DND5E.ExperiencePoints.Abbreviation')}</abbr>\n                    {/if}\n                  {/if}\n                </TidyTableCell>\n              {/if}\n              <TidyTableCell>\n                {#if context.unlocked}\n                  <RemoveMemberControl {member} />\n                {/if}\n              </TidyTableCell>\n            </TidyTableRow>\n          {/if}\n        {/each}\n      </div>\n    {/snippet}\n  </TidyTable>\n</section>\n","<script lang=\"ts\">\n  import type { Actor5e } from 'src/types/types';\n\n  interface Props {\n    members: Actor5e[];\n    language: string;\n  }\n\n  let { members, language }: Props = $props();\n\n  let tooltip: HTMLElement;\n\n  export function getMarkup() {\n    return tooltip.outerHTML;\n  }\n</script>\n\n<div bind:this={tooltip} class=\"document-list-summary-tooltip\">\n  <h3>{language}</h3>\n  <hr />\n  <ul>\n    {#each members as member}\n      <li class=\"flex-row extra-small-gap align-items-center\">\n        <div\n          class=\"item-image\"\n          style=\"background-image: url('{member.img}')\"\n        ></div>\n        <div class=\"item-name truncate\">{member.name}</div>\n      </li>\n    {/each}\n  </ul>\n</div>\n","<script lang=\"ts\">\n  import { getGroupSheetClassicContext } from 'src/sheets/sheet-context.svelte';\n  import GroupLanguageTooltip from 'src/tooltips/GroupLanguageTooltip.svelte';\n  import { Tooltip } from 'src/tooltips/Tooltip';\n  import type { GroupLanguage } from 'src/types/group.types';\n  import type { Actor5e } from 'src/types/types';\n  import { tick } from 'svelte';\n\n  let context = $derived(getGroupSheetClassicContext());\n\n  let groupLanguageTooltip: GroupLanguageTooltip;\n  let hoveredLanguage = $state('');\n  let hoveredMembers: Actor5e[] = $state([]);\n\n  async function showGroupLanguageTooltip(\n    event: MouseEvent & { currentTarget: EventTarget & HTMLElement },\n    groupLanguage: GroupLanguage,\n  ): Promise<any> {\n    if (!groupLanguage.members.length) {\n      return;\n    }\n\n    hoveredLanguage = groupLanguage.label;\n    hoveredMembers = groupLanguage.members;\n\n    const target = event?.currentTarget;\n\n    await tick();\n\n    Tooltip.show(target, groupLanguageTooltip.getMarkup());\n  }\n</script>\n\n<div class=\"flex-row extra-small-gap flex-wrap\">\n  {#each context.groupLanguages as groupLanguage}\n    <span\n      data-tooltip-direction=\"UP\"\n      class=\"tag\"\n      onmouseover={(ev) => showGroupLanguageTooltip(ev, groupLanguage)}\n    >\n      {groupLanguage.label}\n      {#if groupLanguage.members.length > 1}\n        ({groupLanguage.members.length})\n      {/if}\n    </span>\n  {/each}\n</div>\n<div class=\"hidden\">\n  <GroupLanguageTooltip\n    bind:this={groupLanguageTooltip}\n    language={hoveredLanguage}\n    members={hoveredMembers}\n  />\n</div>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { GroupSkill } from 'src/types/group.types';\n  import { formatAsModifier } from 'src/utils/formatting';\n\n  interface Props {\n    skill: GroupSkill;\n  }\n\n  let { skill }: Props = $props();\n\n  let tooltip: HTMLElement;\n\n  export function getMarkup() {\n    return tooltip.outerHTML;\n  }\n</script>\n\n<div bind:this={tooltip} class=\"document-list-summary-tooltip\">\n  <h3>{skill.label}</h3>\n  <hr />\n  <ul>\n    {#each skill.members as member}\n      <li class=\"group-skill-grid\">\n        <div\n          class=\"item-image\"\n          style=\"background-image: url('{member.img}')\"\n        ></div>\n        <div class=\"item-name truncate\">{member.name}</div>\n        <div class=\"text-align-center\">\n          {formatAsModifier(member.system.skills[skill.key]?.total)}\n        </div>\n        <div class=\"text-align-center\">\n          ({member.system.skills[skill.key]?.passive})\n        </div>\n        <div class=\"text-align-center\">\n          <i\n            class=\"{FoundryAdapter.getProficiencyIconClass(\n              member.system.skills[skill.key]?.proficient,\n            )} fa-fw\"\n          ></i>\n        </div>\n      </li>\n    {/each}\n  </ul>\n</div>\n","<script lang=\"ts\">\n  import { getGroupSheetClassicContext } from 'src/sheets/sheet-context.svelte';\n  import GroupSkillTooltip from 'src/tooltips/GroupSkillTooltip.svelte';\n  import { Tooltip } from 'src/tooltips/Tooltip';\n  import type { GroupSkill } from 'src/types/group.types';\n  import { formatAsModifier } from 'src/utils/formatting';\n  import { tick } from 'svelte';\n\n  const context = $derived(getGroupSheetClassicContext());\n\n  let groupSkillTooltip: GroupSkillTooltip;\n  let hoveredSkill: GroupSkill = $state({\n    key: '',\n    label: '',\n    members: [],\n    total: Number.NEGATIVE_INFINITY,\n  });\n\n  async function showGroupLanguageTooltip(\n    event: MouseEvent & { currentTarget: EventTarget & HTMLElement },\n    groupSkill: GroupSkill,\n  ): Promise<any> {\n    if (!groupSkill.members.length) {\n      return;\n    }\n\n    hoveredSkill = groupSkill;\n\n    const target = event?.currentTarget;\n\n    await tick();\n\n    Tooltip.show(target, groupSkillTooltip.getMarkup());\n  }\n</script>\n\n<div class=\"flex-row extra-small-gap flex-wrap\">\n  {#each context.groupSkills as groupSkill}\n    <span\n      class=\"tag\"\n      data-tooltip-direction=\"UP\"\n      onmouseover={(ev) => showGroupLanguageTooltip(ev, groupSkill)}\n    >\n      {groupSkill.label}\n      {formatAsModifier(groupSkill.total)}\n    </span>\n  {/each}\n</div>\n<div class=\"hidden\">\n  <GroupSkillTooltip bind:this={groupSkillTooltip} skill={hoveredSkill} />\n</div>\n","<script lang=\"ts\">\n  import { settings } from 'src/settings/settings.svelte';\n\n  interface Props {\n    tabs: string[];\n    selected: string;\n    [key: string]: any;\n  }\n\n  let { tabs, selected = $bindable(), ...rest }: Props = $props();\n</script>\n\n<div class=\"underlined-tab-strip flex-row no-gap {rest.class ?? ''}\">\n  {#each tabs as tab (tab)}\n    <button\n      type=\"button\"\n      class=\"underlined-tab\"\n      class:active={selected === tab}\n      onclick={() => (selected = tab)}\n      tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n    >\n      {tab}\n    </button>\n  {/each}\n</div>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { getContext } from 'svelte';\n  import GroupMemberList from '../parts/GroupMemberList.svelte';\n  import UtilityToolbar from 'src/components/utility-bar/UtilityToolbar.svelte';\n  import Search from 'src/components/utility-bar/Search.svelte';\n  import UtilityToolbarCommand from 'src/components/utility-bar/UtilityToolbarCommand.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { GroupSheetSections } from 'src/features/sections/GroupSheetSections';\n  import { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\n  import EncounterMemberList from '../parts/EncounterMemberList.svelte';\n  import GroupLanguages from '../parts/GroupLanguages.svelte';\n  import GroupSkills from '../parts/GroupSkills.svelte';\n  import UnderlinedTabStrip from 'src/components/tabs/UnderlinedTabStrip.svelte';\n  import ExpandableContainer from 'src/components/expandable/ExpandableContainer.svelte';\n  import { getGroupSheetClassicContext } from 'src/sheets/sheet-context.svelte';\n  import {\n    createSearchResultsState,\n    setSearchResultsContext,\n  } from 'src/features/search/search.svelte';\n\n  const tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  const context = $derived(getGroupSheetClassicContext());\n\n  const localize = FoundryAdapter.localize;\n\n  let searchCriteria: string = $state('');\n\n  let utilityBarCommands = $derived(\n    context.utilities[tabId]?.utilityToolbarCommands ?? [],\n  );\n\n  let searchResults = createSearchResultsState();\n  setSearchResultsContext(searchResults);\n\n  $effect(() => {\n    searchResults.uuids = FoundryAdapter.searchActors(\n      searchCriteria,\n      context.system.members.map((m) => m.actor),\n    );\n  });\n\n  let memberSections = $derived(\n    GroupSheetSections.configureMemberSections(\n      context.memberSections,\n      tabId,\n      SheetPreferencesService.getByType(context.actor.type),\n    ),\n  );\n\n  let aggregateTabs = {\n    languages: localize('DND5E.Languages'),\n    skills: localize('DND5E.Skills'),\n  } as const;\n\n  let selectedAggregateTab = $state(aggregateTabs.languages);\n</script>\n\n<UtilityToolbar>\n  <Search bind:value={searchCriteria} />\n  <!-- Filters? Pinned Filters? Perhaps filters related to senses, immunities, etc. -->\n  {#each utilityBarCommands as command (command.title)}\n    <UtilityToolbarCommand\n      title={command.title}\n      iconClass={command.iconClass}\n      text={command.text}\n      visible={command.visible ?? true}\n      onExecute={(ev) => command.execute?.(ev)}\n      sections={memberSections}\n    />\n  {/each}\n</UtilityToolbar>\n\n<section\n  class=\"scroll-container flex-column small-gap\"\n  data-tidy-track-scroll-y\n>\n  {#if context.memberSections.length > 0}\n    {#if context.isGM}\n      <ExpandableContainer expanded={context.showGroupMemberTabInfoPanel}>\n        <UnderlinedTabStrip\n          tabs={Object.values(aggregateTabs)}\n          bind:selected={selectedAggregateTab}\n        />\n        <div class=\"group-member-info-panel\">\n          <div class:hidden={selectedAggregateTab !== aggregateTabs.languages}>\n            <GroupLanguages />\n          </div>\n          <div class:hidden={selectedAggregateTab !== aggregateTabs.skills}>\n            <GroupSkills />\n          </div>\n        </div>\n      </ExpandableContainer>\n    {/if}\n\n    {#if context.actor.system.type.value !== CONSTANTS.GROUP_TYPE_ENCOUNTER}\n      {#each memberSections as section (section.key)}\n        <GroupMemberList {section} />\n      {/each}\n    {:else}\n      {#each memberSections as section (section.key)}\n        <EncounterMemberList {section} />\n      {/each}\n    {/if}\n  {:else}\n    <div class=\"drop-zone full-height\">\n      {localize('TIDY5E.Group.EmptyMembersTabHint')}\n    </div>\n  {/if}\n</section>\n","<script lang=\"ts\">\n  import ExpandableContainer from 'src/components/expandable/ExpandableContainer.svelte';\n  import FilterMenu from 'src/components/filter/FilterMenu.svelte';\n  import PinnedFilterToggles from 'src/components/filter/PinnedFilterToggles.svelte';\n  import Notice from 'src/components/notice/Notice.svelte';\n  import Search from 'src/components/utility-bar/Search.svelte';\n  import UtilityToolbar from 'src/components/utility-bar/UtilityToolbar.svelte';\n  import UtilityToolbarCommand from 'src/components/utility-bar/UtilityToolbarCommand.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import {\n    createSearchResultsState,\n    setSearchResultsContext,\n  } from 'src/features/search/search.svelte';\n  import { ItemVisibility } from 'src/features/sections/ItemVisibility';\n  import { SheetSections } from 'src/features/sections/SheetSections';\n  import { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\n  import Currency from 'src/sheets/classic/actor/Currency.svelte';\n  import InventoryGrid from 'src/sheets/classic/actor/InventoryGrid.svelte';\n  import InventoryList from 'src/sheets/classic/actor/InventoryList.svelte';\n  import ContainerPanel from 'src/sheets/classic/shared/ContainerPanel.svelte';\n  import { getGroupSheetClassicContext } from 'src/sheets/sheet-context.svelte';\n  import type { InventorySection, ItemLayoutMode } from 'src/types/types';\n  import { getContext } from 'svelte';\n\n  let tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  const context = $derived(getGroupSheetClassicContext());\n\n  let inventory = $derived(\n    SheetSections.configureInventory(\n      context.inventory,\n      tabId,\n      SheetPreferencesService.getByType(context.actor.type),\n      TidyFlags.sectionConfig.get(context.actor)?.[tabId],\n    ),\n  );\n\n  let searchCriteria: string = $state('');\n\n  const searchResults = createSearchResultsState();\n  setSearchResultsContext(searchResults);\n\n  $effect(() => {\n    searchResults.uuids = ItemVisibility.getItemsToShowAtDepth({\n      criteria: searchCriteria,\n      itemContext: context.itemContext,\n      sections: inventory,\n      tabId: tabId,\n    });\n  });\n\n  const localize = FoundryAdapter.localize;\n\n  let layoutMode: ItemLayoutMode = $derived(\n    TidyFlags.inventoryGrid.get(context.actor) ? 'grid' : 'list',\n  );\n\n  let noItems = $derived(\n    inventory.some((section: InventorySection) => section.items.length > 0) ===\n      false,\n  );\n\n  let utilityBarCommands = $derived(\n    context.utilities[tabId]?.utilityToolbarCommands ?? [],\n  );\n</script>\n\n<UtilityToolbar>\n  <Search bind:value={searchCriteria} />\n  <PinnedFilterToggles\n    filterGroupName={tabId}\n    filters={ItemFilterRuntime.getPinnedFiltersForTab(\n      context.filterPins,\n      context.filterData,\n      tabId,\n    )}\n  />\n  <FilterMenu {tabId} />\n  {#each utilityBarCommands as command (command.title)}\n    <UtilityToolbarCommand\n      title={command.title}\n      iconClass={command.iconClass}\n      text={command.text}\n      visible={command.visible ?? true}\n      onExecute={(ev) => command.execute?.(ev)}\n      sections={inventory}\n    />\n  {/each}\n</UtilityToolbar>\n\n<div\n  class=\"tidy-inventory-container scroll-container flex-column small-gap\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEMS_CONTAINER}\n>\n  <Currency document={context.actor} />\n\n  {#if noItems && !context.unlocked}\n    <Notice>{localize('TIDY5E.EmptySection')}</Notice>\n  {:else}\n    {@const containerPanelExpanded =\n      context.showContainerPanel && !!context.containerPanelItems.length}\n\n    <ExpandableContainer\n      expanded={containerPanelExpanded}\n      class=\"container-panel-wrapper {containerPanelExpanded\n        ? 'container-panel-expanded'\n        : ''}\"\n    >\n      <ContainerPanel containerPanelItems={context.containerPanelItems} />\n    </ExpandableContainer>\n    {#each inventory as section (section.key)}\n      {@const visibleItemCount = ItemVisibility.countVisibleItems(\n        section.items,\n        searchResults.uuids,\n      )}\n      {#if section.show}\n        {#if (searchCriteria.trim() === '' && context.unlocked) || visibleItemCount > 0}\n          {#if layoutMode === 'list'}\n            <InventoryList\n              primaryColumnName=\"{localize(section.label)} ({visibleItemCount})\"\n              {section}\n              allowAttuneControl={false}\n              allowFavoriteIconNextToName={false}\n              allowEquipControl={false}\n            />\n          {:else}\n            <InventoryGrid {section} />\n          {/if}\n        {/if}\n      {/if}\n    {/each}\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import SheetEditorV2 from 'src/components/editor/SheetEditorV2.svelte';\n  import { getGroupSheetClassicContext } from 'src/sheets/sheet-context.svelte';\n\n  const context = $derived(getGroupSheetClassicContext());\n</script>\n\n<div class=\"flex-1 full-height flex-column me-1\">\n  {#key context.actor.system.description.full}\n    <article class=\"editor-container mt-3\">\n      <SheetEditorV2\n        content={context.system.description.full}\n        enriched={context.descriptionFullEnrichedHtml}\n        field=\"system.description.full\"\n        editorOptions={{\n          editable: context.editable,\n        }}\n        documentUuid={context.actor.uuid}\n        manageSecrets={context.document.isOwner}\n      />\n    </article>\n  {/key}\n</div>\n","import type { CustomContent, Tab } from 'src/types/types';\nimport type { RegisteredContent, RegisteredTab } from './types';\nimport { CONSTANTS } from 'src/constants';\nimport { debug, error, warn } from 'src/utils/logging';\nimport { TabManager } from './tab/TabManager';\nimport type { ActorTabRegistrationOptions } from 'src/api/api.types';\nimport { CustomContentManager } from './content/CustomContentManager';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport GroupMembersTab from 'src/sheets/classic/group/tabs/GroupMembersTab.svelte';\nimport GroupInventoryTab from 'src/sheets/classic/group/tabs/GroupInventoryTab.svelte';\nimport GroupDescriptionTab from 'src/sheets/classic/group/tabs/GroupDescriptionTab.svelte';\nimport type { GroupSheetClassicContext } from 'src/types/group.types';\n\nclass GroupSheetRuntime {\n  private _content = $state<RegisteredContent<GroupSheetClassicContext>[]>([]);\n  private _tabs = $state<RegisteredTab<GroupSheetClassicContext>[]>([\n    {\n      id: CONSTANTS.TAB_GROUP_MEMBERS,\n      title: 'DND5E.Group.Member.other',\n      content: {\n        component: GroupMembersTab,\n        type: 'svelte',\n      },\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_ACTOR_INVENTORY,\n      title: 'DND5E.Inventory',\n      content: {\n        component: GroupInventoryTab,\n        type: 'svelte',\n      },\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_GROUP_DESCRIPTION,\n      title: 'DND5E.Description',\n      content: {\n        component: GroupDescriptionTab,\n        type: 'svelte',\n      },\n      layout: 'classic',\n    },\n  ]);\n  tabMap = $derived(\n    this._tabs.reduce<Map<string, RegisteredTab<GroupSheetClassicContext>>>(\n      (map, curr) => {\n        map.set(curr.id, curr);\n        return map;\n      },\n      new Map<string, RegisteredTab<GroupSheetClassicContext>>()\n    )\n  );\n\n  get content(): RegisteredContent<GroupSheetClassicContext>[] {\n    return this._content;\n  }\n\n  async getTabs(context: GroupSheetClassicContext): Promise<Tab[]> {\n    return await TabManager.prepareTabsForRender(context, this._tabs);\n  }\n\n  getAllRegisteredTabs(): RegisteredTab<GroupSheetClassicContext>[] {\n    return [...this._tabs];\n  }\n\n  registerContent(\n    registeredContent: RegisteredContent<GroupSheetClassicContext>\n  ) {\n    this._content.push(registeredContent);\n  }\n\n  registerTab(\n    tab: RegisteredTab<GroupSheetClassicContext>,\n    options?: ActorTabRegistrationOptions\n  ) {\n    const tabExists = this._tabs.some((t) => t.id === tab.id);\n\n    if (tabExists && !options?.overrideExisting) {\n      warn(`Tab with id ${tab.id} already exists.`);\n      return;\n    }\n\n    if (tabExists && options?.overrideExisting) {\n      const index = this._tabs.findIndex((t) => t.id === tab.id);\n      if (index >= 0) {\n        this._tabs.splice(index, 1);\n      }\n    }\n\n    this._tabs.push(tab);\n  }\n\n  getTabTitle(tabId: string) {\n    try {\n      let tabTitle = this._tabs.find((t) => t.id === tabId)?.title;\n      if (typeof tabTitle === 'function') {\n        tabTitle = tabTitle();\n      }\n      return tabTitle ? FoundryAdapter.localize(tabTitle) : tabId;\n    } catch (e) {\n      error('An error occurred while searching for a tab title.', false, e);\n      debug('Tab title error troubleshooting information', { tabId });\n    }\n  }\n\n  // TODO: Move this to a world setting\n  getDefaultTabs(): string[] {\n    return [\n      CONSTANTS.TAB_GROUP_MEMBERS,\n      CONSTANTS.TAB_ACTOR_INVENTORY,\n      CONSTANTS.TAB_GROUP_DESCRIPTION,\n    ];\n  }\n}\n\nconst singleton = new GroupSheetRuntime();\n\nexport default singleton;\n","import { HandlebarsTab } from './tab/HandlebarsTab';\nimport { HtmlTab } from './tab/HtmlTab';\nimport { ItemSheetRuntime } from 'src/runtime/item/ItemSheetRuntime';\nimport type { CustomTabBase } from './tab/CustomTabBase';\nimport { warn } from 'src/utils/logging';\nimport CharacterSheetRuntime from 'src/runtime/CharacterSheetRuntime.svelte';\nimport NpcSheetRuntime from 'src/runtime/NpcSheetRuntime.svelte';\nimport { VehicleSheetRuntime } from 'src/runtime/VehicleSheetRuntime';\nimport { TabManager } from 'src/runtime/tab/TabManager';\nimport type { TabId } from './tab/CustomTabBase';\nimport { SvelteTab } from './tab/SvelteTab';\nimport type {\n  SupportedTab,\n  ActorTabRegistrationOptions,\n  ContentRegistrationOptions,\n  SupportedContent,\n  ItemTabRegistrationOptions,\n  HeaderControlRegistrationParams,\n} from './api.types';\nimport ApiConstants from './ApiConstants';\nimport { HtmlContent } from './content/HtmlContent';\nimport { HandlebarsContent } from './content/HandlebarsContent';\nimport { CONSTANTS } from 'src/constants';\nimport { CustomContentManager } from 'src/runtime/content/CustomContentManager';\nimport { ConfigApi } from './config/ConfigApi';\nimport GroupSheetRuntime from 'src/runtime/GroupSheetRuntime.svelte';\nimport { HeaderControlsRuntime } from 'src/runtime/header-controls/HeaderControlsRuntime';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n/**\n * The Tidy 5e Sheets API. The API becomes available after the hook `tidy5e-sheet.ready` is called.\n * When the hook fires, it provides an instance of the API.\n * @example Getting the API for extending Tidy 5e Sheets\n * ```js\n * Hooks.once('tidy5e-sheet.ready', (api) => {\n *   // Do something awesome!\n * });\n * ```\n *\n * @example Getting the API from the module\n * ```js\n * game.modules.get('tidy5e-sheet').api\n * ```\n *\n * @remarks\n * It is recommended to retrieve the API from the `tidy5e-sheet.ready` hook, since the hook guarantees that the API has been initialized.\n *\n * @category Main\n */\nexport class Tidy5eSheetsApi {\n  private static _instance: Tidy5eSheetsApi;\n\n  private constructor() {}\n\n  /**\n   * Gets an instance of the Tidy 5e Sheets API\n   * @returns instance of the Tidy 5e Sheets API\n   * @internal\n   */\n  static _getApi() {\n    Tidy5eSheetsApi._instance ??= new Tidy5eSheetsApi();\n    return this._instance;\n  }\n\n  /** {@inheritDoc ActionListApi} */\n  /** @deprecated api.actionList API has been moved to api.config.actionList */\n  get actionList() {\n    warn('api.actionList API has been moved to api.config.actionList');\n    return this.config.actionList;\n  }\n\n  /** {@inheritDoc ActorItemApi} */\n  /** @deprecated api.actorItem API has been moved to api.config.actorItem */\n  get actorItem() {\n    warn('api.actorItem API has been moved to api.config.actorItem');\n    return this.config.actorItem;\n  }\n\n  /** {@inheritDoc ActorPortraitApi} */\n  /** @deprecated api.actorPortrait API has been moved to api.config.actorPortrait */\n  get actorPortrait() {\n    warn('api.actorPortrait API has been moved to api.config.actorPortrait');\n    return this.config.actorPortrait;\n  }\n\n  /** {@inheritDoc ConfigApi} */\n  config = new ConfigApi();\n\n  /**\n   * Constants for a variety of uses.\n   *\n   * @remarks\n   * When APIs call for specific IDs or selectors related to Tidy 5e Sheets,\n   * using the related constant when available will insulate against breakage\n   * when Tidy has internal changes.\n   */\n  constants = ApiConstants;\n\n  /**\n   * Creates a selector which allows for locating a part of a given sheet.\n   * @param sheetPart a part of the sheet as found in `api.constants.SHEET_PARTS`\n   * @returns an HTML selector valid for use with JavaScript query selectors\n   */\n  getSheetPartSelector(sheetPart: string) {\n    return `[${CONSTANTS.SHEET_PART_ATTRIBUTE}=\"${sheetPart}\"]`;\n  }\n\n  /** {@inheritDoc ExhaustionApi} */\n  /** @deprecated api.exhaustion API has been moved to api.config.exhaustion */\n  get exhaustion() {\n    warn('api.exhaustion API has been moved to api.config.exhaustion');\n    return this.config.exhaustion;\n  }\n\n  /**\n   * Determines whether the provided sheet is a Tidy 5e Character sheet.\n   * @param app an actor sheet\n   * @returns boolean indicating if the sheet is a Tidy 5e Character sheet\n   */\n  isTidy5eCharacterSheet(app: any) {\n    const element = FoundryAdapter.getElementFromAppV1OrV2(app.element);\n    return !!element?.matches(`.tidy5e-sheet.sheet.character`);\n  }\n\n  /**\n   * Determines whether the provided sheet is a Tidy 5e Container sheet.\n   * @param app a container sheet\n   * @returns boolean indicating if the sheet is a Tidy 5e Container sheet\n   */\n  isTidy5eContainerSheet(app: any) {\n    const element = FoundryAdapter.getElementFromAppV1OrV2(app.element);\n    return !!element?.matches(`.tidy5e-sheet.sheet.container`);\n  }\n\n  /**\n   * Determines whether the provided sheet is a Tidy 5e Group sheet.\n   * @param app a group sheet\n   * @returns boolean indicating if the sheet is a Tidy 5e Group sheet\n   */\n  isTidy5eGroupSheet(app: any) {\n    const element = FoundryAdapter.getElementFromAppV1OrV2(app.element);\n    return !!element?.matches(`.tidy5e-sheet.sheet.group`);\n  }\n\n  /**\n   * Determines whether the provided sheet is a Tidy 5e Item sheet.\n   * @param app an item sheet\n   * @returns boolean indicating if the sheet is a Tidy 5e Item sheet\n   */\n  isTidy5eItemSheet(app: any) {\n    const element = FoundryAdapter.getElementFromAppV1OrV2(app.element);\n    return !!element?.matches(`.tidy5e-sheet.sheet.item`);\n  }\n\n  /**\n   * Determines whether the provided sheet is a Tidy 5e NPC sheet.\n   * @param app an actor sheet\n   * @returns boolean indicating if the sheet is a Tidy 5e NPC sheet\n   */\n  isTidy5eNpcSheet(app: any) {\n    const element = FoundryAdapter.getElementFromAppV1OrV2(app.element);\n    return !!element?.matches(`.tidy5e-sheet.sheet.npc`);\n  }\n\n  /**\n   * Determines whether the provided sheet is any Tidy 5e sheet.\n   * @param app an actor sheet\n   * @returns boolean indicating if the sheet is any Tidy 5e sheet\n   */\n  isTidy5eSheet(app: any) {\n    const element = FoundryAdapter.getElementFromAppV1OrV2(app.element);\n    return !!element?.matches(`.tidy5e-sheet.sheet`);\n  }\n\n  /**\n   * Determines whether the provided sheet is a Tidy 5e Vehicle sheet.\n   * @param app an actor sheet\n   * @returns boolean indicating if the sheet is a Tidy 5e Vehicle sheet\n   */\n  isTidy5eVehicleSheet(app: any) {\n    const element = FoundryAdapter.getElementFromAppV1OrV2(app.element);\n    return !!element?.matches(`.tidy5e-sheet.sheet.vehicle`);\n  }\n\n  /**{@inheritDoc ItemSummaryApi} */\n  /** @deprecated api.itemSummary API has been moved to api.config.actorPortrait */\n  get itemSummary() {\n    warn('api.itemSummary API has been moved to api.config.actorPortrait');\n    return this.config.itemSummary;\n  }\n\n  /**\n   * Various models can be used for API calls.\n   */\n  models = {\n    HandlebarsTab: HandlebarsTab,\n    HtmlTab: HtmlTab,\n    SvelteTab: SvelteTab,\n    HandlebarsContent: HandlebarsContent,\n    HtmlContent: HtmlContent,\n  };\n\n  /**\n   * Adds a tab to the available sheet tabs for all actor types that Tidy 5e supports.\n   * @param {SupportedTab} tab the information necessary to render a tab\n   * @param {object} [options] sheet registration options\n   * @param {string} [options.layout] an optional sheet layout or layouts (default: 'all')\n   * @param {string} [options.overrideExisting] if a tab with this ID already exists, override it\n   * @returns void\n   */\n  registerActorTab(tab: SupportedTab, options?: ActorTabRegistrationOptions) {\n    this.registerCharacterTab(tab, options);\n    this.registerGroupTab(tab, options);\n    this.registerNpcTab(tab, options);\n    this.registerVehicleTab(tab, options);\n  }\n\n  /**\n   * Adds a tab to the available Character sheet tabs.\n   * @param {SupportedTab} tab the information necessary to render a tab\n   * @param {object} [options] sheet registration options\n   * @param {string} [options.layout] an optional sheet layout or layouts (default: 'all')\n   * @param {string} [options.overrideExisting] if a tab with this ID already exists, override it\n   * @returns void\n   *\n   * @example Registering a handlebars-based character sheet tab\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.registerCharacterTab(\n   *     new api.models.HandlebarsTab({\n   *       title: 'My Tab',\n   *       path: '/modules/my-module-id/templates/my-handlebars-template.hbs',\n   *       tabId: 'my-module-id-registered-character-tab',\n   *       getData: async (data) => {\n   *         data['my-message'] = 'Hello, world! ';\n   *         return Promise.resolve(data);\n   *       },\n   *       onRender(params) {\n   *         const myTab = $(params.tabContentsElement);\n   *         myTab.find('.my-control').click(_myHandler.bind(params.app));\n   *       },\n   *     })\n   *   );\n   * });\n   * ```\n   *\n   * @example Overriding an existing sheet tab\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.registerCharacterTab(\n   *     new api.models.HandlebarsTab({\n   *       title: 'The New Inventory Tab',\n   *       path: '/modules/my-module-id/templates/my-handlebars-template.hbs',\n   *       tabId: api.constants.TAB_ID_CHARACTER_INVENTORY,\n   *       getData: async (data) => {\n   *         data['my-message'] = 'Hello, world! ';\n   *         return Promise.resolve(data);\n   *       },\n   *       onRender(params) {\n   *         const myTab = $(params.tabContentsElement);\n   *         myTab.find('.my-control').click(_myHandler.bind(params.app));\n   *       },\n   *     }),\n   *     {\n   *       overrideExisting: true,\n   *     }\n   *   );\n   * });\n   * ```\n   *\n   * @remarks\n   * A tab ID is always required (see {@link TabId}).\n   */\n  registerCharacterTab(\n    tab: SupportedTab,\n    options?: ActorTabRegistrationOptions\n  ): void {\n    if (!TabManager.validateTab(tab)) {\n      return;\n    }\n\n    const registeredTab = TabManager.mapCustomTabToRegisteredTab(\n      tab,\n      options?.layout\n    );\n\n    if (!registeredTab) {\n      warn('Unable to register tab. Tab type not supported');\n      return;\n    }\n\n    CharacterSheetRuntime.registerTab(registeredTab, options);\n  }\n\n  /**\n   * Adds a tab to the available Group sheet tabs.\n   * @param {SupportedTab} tab the information necessary to render a tab\n   * @param {object} [options] sheet registration options\n   * @param {string} [options.layout] an optional sheet layout or layouts (default: 'all')\n   * @param {string} [options.overrideExisting] if a tab with this ID already exists, override it\n   * @returns void\n   *\n   * @example Registering a handlebars-based group sheet tab\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.registerGroupTab(\n   *     new api.models.HandlebarsTab({\n   *       title: 'My Tab',\n   *       path: '/modules/my-module-id/templates/my-handlebars-template.hbs',\n   *       tabId: 'my-module-id-registered-group-tab',\n   *       getData: async (data) => {\n   *         data['my-message'] = 'Hello, world! ';\n   *         return Promise.resolve(data);\n   *       },\n   *       onRender(params) {\n   *         const myTab = $(params.tabContentsElement);\n   *         myTab.find('.my-control').click(_myHandler.bind(params.app));\n   *       },\n   *     })\n   *   );\n   * });\n   * ```\n   *\n   * @example Overriding an existing sheet tab\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.registerGroupTab(\n   *     new api.models.HandlebarsTab({\n   *       title: 'The New Inventory Tab',\n   *       path: '/modules/my-module-id/templates/my-handlebars-template.hbs',\n   *       tabId: api.constants.TAB_ID_GROUP_INVENTORY,\n   *       getData: async (data) => {\n   *         data['my-message'] = 'Hello, world! ';\n   *         return Promise.resolve(data);\n   *       },\n   *       onRender(params) {\n   *         const myTab = $(params.tabContentsElement);\n   *         myTab.find('.my-control').click(_myHandler.bind(params.app));\n   *       },\n   *     }),\n   *     {\n   *       overrideExisting: true,\n   *     }\n   *   );\n   * });\n   * ```\n   *\n   * @remarks\n   * A tab ID is always required (see {@link TabId}).\n   */\n  registerGroupTab(\n    tab: SupportedTab,\n    options?: ActorTabRegistrationOptions\n  ): void {\n    if (!TabManager.validateTab(tab)) {\n      return;\n    }\n\n    const registeredTab = TabManager.mapCustomTabToRegisteredTab(\n      tab,\n      options?.layout\n    );\n\n    if (!registeredTab) {\n      warn('Unable to register tab. Tab type not supported');\n      return;\n    }\n\n    GroupSheetRuntime.registerTab(registeredTab, options);\n  }\n\n  /**\n   * Adds custom content to all actor sheets at `position` relative to `selector`.\n   *\n   * @param content the information necessary to render custom content\n   * @param options custom content registration options\n   * @returns void\n   *\n   * @example registering an icon next to the actor sheet name\n   * ```js\n   * Hooks.once(\"tidy5e-sheet.ready\", (api) => {\n   *   api.registerActorContent(\n   *     new api.models.HtmlContent({\n   *       html: `<a title=\"Example Button\" class=\"my-custom-icon\"><i class=\"fas fa-user\"></i></a>`,\n   *       injectParams: {\n   *         selector: `[data-tidy-sheet-part=\"${api.constants.SHEET_PARTS.NAME_CONTAINER}\"]`\n   *         position: \"beforebegin\",\n   *       },\n   *       onContentReady: (params) => {\n   *         console.log(\"content ready to render\", params);\n   *         console.log(\"my content\", params.content);\n   *       },\n   *       onRender: (params) => {\n   *         params.element\n   *           .querySelector(\".my-custom-icon\")\n   *           .addEventListener(\"click\", () => alert(\"Clicked custom actor icon\"));\n   *       },\n   *     })\n   *   );\n   * });\n   * ```\n   */\n  registerActorContent(\n    content: SupportedContent,\n    options?: ContentRegistrationOptions\n  ) {\n    const registeredContent = CustomContentManager.mapToRegisteredContent(\n      content,\n      options?.layout\n    );\n\n    if (!registeredContent) {\n      warn('Unable to register content. Content type not supported.');\n      return;\n    }\n\n    CharacterSheetRuntime.registerContent(registeredContent);\n    NpcSheetRuntime.registerContent(registeredContent);\n    VehicleSheetRuntime.registerContent(registeredContent);\n  }\n\n  /**\n   * Adds custom content to player character sheets at `position` relative to `selector`.\n   *\n   * @param content the information necessary to render custom content\n   * @param options custom content registration options\n   * @returns void\n   *\n   * @example registering an icon next to the character sheet name\n   * ```js\n   * Hooks.once(\"tidy5e-sheet.ready\", (api) => {\n   *   api.registerCharacterContent(\n   *     new api.models.HtmlContent({\n   *       html: `<a title=\"Example Button\" class=\"my-custom-icon\"><i class=\"fas fa-user\"></i></a>`,\n   *       injectParams: {\n   *         selector: `[data-tidy-sheet-part=\"${api.constants.SHEET_PARTS.NAME_CONTAINER}\"]`\n   *         position: \"beforebegin\",\n   *       },\n   *       onContentReady: (params) => {\n   *         console.log(\"content ready to render\", params);\n   *         console.log(\"my content\", params.content);\n   *       },\n   *       onRender: (params) => {\n   *         params.element\n   *           .querySelector(\".my-custom-icon\")\n   *           .addEventListener(\"click\", () => alert(\"Clicked custom PC icon\"));\n   *       },\n   *     })\n   *   );\n   * });\n   * ```\n   */\n  registerCharacterContent(\n    content: SupportedContent,\n    options?: ContentRegistrationOptions\n  ) {\n    const registeredContent = CustomContentManager.mapToRegisteredContent(\n      content,\n      options?.layout\n    );\n\n    if (!registeredContent) {\n      warn('Unable to register content. Content type not supported.');\n      return;\n    }\n\n    CharacterSheetRuntime.registerContent(registeredContent);\n  }\n\n  /**\n   * Adds custom content to group sheets at `position` relative to `selector`.\n   *\n   * @param content the information necessary to render custom content\n   * @param options custom content registration options\n   * @returns void\n   *\n   * @example registering an icon next to the group sheet name\n   * ```js\n   * Hooks.once(\"tidy5e-sheet.ready\", (api) => {\n   *   api.registerGroupContent(\n   *     new api.models.HtmlContent({\n   *       html: `<a title=\"Example Button\" class=\"my-custom-icon\"><i class=\"fas fa-user\"></i></a>`,\n   *       injectParams: {\n   *         selector: `[data-tidy-sheet-part=\"${api.constants.SHEET_PARTS.NAME_CONTAINER}\"]`\n   *         position: \"beforebegin\",\n   *       },\n   *       onContentReady: (params) => {\n   *         console.log(\"content ready to render\", params);\n   *         console.log(\"my content\", params.content);\n   *       },\n   *       onRender: (params) => {\n   *         params.element\n   *           .querySelector(\".my-custom-icon\")\n   *           .addEventListener(\"click\", () => alert(\"Clicked custom PC icon\"));\n   *       },\n   *     })\n   *   );\n   * });\n   * ```\n   */\n  registerGroupContent(\n    content: SupportedContent,\n    options?: ContentRegistrationOptions\n  ) {\n    const registeredContent = CustomContentManager.mapToRegisteredContent(\n      content,\n      options?.layout\n    );\n\n    if (!registeredContent) {\n      warn('Unable to register content. Content type not supported.');\n      return;\n    }\n\n    GroupSheetRuntime.registerContent(registeredContent);\n  }\n\n  /**\n   * Adds custom content to item sheets at `position` relative to `selector`.\n   *\n   * @param content the information necessary to render custom content\n   * @param options custom content registration options\n   * @returns void\n   *\n   * @example registering an icon next to the item sheet name\n   * ```js\n   * Hooks.once(\"tidy5e-sheet.ready\", (api) => {\n   *   api.registerItemContent(\n   *     new api.models.HtmlContent({\n   *       html: `<a title=\"Example Button\" class=\"my-custom-icon\"><i class=\"fas fa-flask\"></i></a>`,\n   *       injectParams: {\n   *         selector: `[data-tidy-sheet-part=\"${api.constants.SHEET_PARTS.NAME_CONTAINER}\"]`\n   *         position: \"beforebegin\",\n   *       },\n   *       onContentReady: (params) => {\n   *         console.log(\"content ready to render\", params);\n   *         console.log(\"my content\", params.content);\n   *       },\n   *       onRender: (params) => {\n   *         params.element\n   *           .querySelector(\".my-custom-icon\")\n   *           .addEventListener(\"click\", () => alert(\"Clicked custom item icon\"));\n   *       },\n   *     })\n   *   );\n   * });\n   * ```\n   */\n  registerItemContent(\n    content: SupportedContent,\n    options?: ContentRegistrationOptions\n  ) {\n    const registeredContent = CustomContentManager.mapToRegisteredContent(\n      content,\n      options?.layout\n    );\n\n    if (!registeredContent) {\n      warn('Unable to register content. Content type not supported.');\n      return;\n    }\n\n    ItemSheetRuntime.registerContent(registeredContent);\n  }\n\n  /**\n   * Adds custom content to NPC sheets at `position` relative to `selector`.\n   *\n   * @param content the information necessary to render custom content\n   * @param options custom content registration options\n   * @returns void\n   *\n   * @example registering an icon next to the NPC sheet name\n   * ```js\n   * Hooks.once(\"tidy5e-sheet.ready\", (api) => {\n   *   api.registerNpcContent(\n   *     new api.models.HtmlContent({\n   *       html: `<a title=\"Example Button\" class=\"my-custom-icon\"><i class=\"fas fa-user\"></i></a>`,\n   *       injectParams: {\n   *         selector: `[data-tidy-sheet-part=\"${api.constants.SHEET_PARTS.NAME_CONTAINER}\"]`\n   *         position: \"beforebegin\",\n   *       },\n   *       onContentReady: (params) => {\n   *         console.log(\"content ready to render\", params);\n   *         console.log(\"my content\", params.content);\n   *       },\n   *       onRender: (params) => {\n   *         params.element\n   *           .querySelector(\".my-custom-icon\")\n   *           .addEventListener(\"click\", () => alert(\"Clicked custom NPC icon\"));\n   *       },\n   *     })\n   *   );\n   * });\n   * ```\n   */\n  registerNpcContent(\n    content: SupportedContent,\n    options?: ContentRegistrationOptions\n  ) {\n    const registeredContent = CustomContentManager.mapToRegisteredContent(\n      content,\n      options?.layout\n    );\n\n    if (!registeredContent) {\n      warn('Unable to register content. Content type not supported.');\n      return;\n    }\n\n    NpcSheetRuntime.registerContent(registeredContent);\n  }\n\n  /**\n   * Adds custom content to vehicle sheets at `position` relative to `selector`.\n   *\n   * @param content the information necessary to render custom content\n   * @param options custom content registration options\n   * @returns void\n   *\n   * @example registering an icon next to the vehicle sheet name\n   * ```js\n   * Hooks.once(\"tidy5e-sheet.ready\", (api) => {\n   *   api.registerVehicleContent(\n   *     new api.models.HtmlContent({\n   *       html: `<a title=\"Example Button\" class=\"my-custom-icon\"><i class=\"fas fa-user\"></i></a>`,\n   *       injectParams: {\n   *         selector: `[data-tidy-sheet-part=\"${api.constants.SHEET_PARTS.NAME_CONTAINER}\"]`\n   *         position: \"beforebegin\",\n   *       },\n   *       onContentReady: (params) => {\n   *         console.log(\"content ready to render\", params);\n   *         console.log(\"my content\", params.content);\n   *       },\n   *       onRender: (params) => {\n   *         params.element\n   *           .querySelector(\".my-custom-icon\")\n   *           .addEventListener(\"click\", () => alert(\"Clicked Vehicle custom icon\"));\n   *       },\n   *     })\n   *   );\n   * });\n   * ```\n   */\n  registerVehicleContent(\n    content: SupportedContent,\n    options?: ContentRegistrationOptions\n  ) {\n    const registeredContent = CustomContentManager.mapToRegisteredContent(\n      content,\n      options?.layout\n    );\n\n    if (!registeredContent) {\n      warn('Unable to register content. Content type not supported.');\n      return;\n    }\n\n    VehicleSheetRuntime.registerContent(registeredContent);\n  }\n\n  /**\n   * Adds a tab to all relevant item sheets.\n   * @see {@link CustomTabBase} for options related to all tabs.\n   * @param tab the custom tab settings to use when incorporating this tab.\n   * @example Register an item tab for spell items only, adding some custom data to the Item Sheet Context object before rendering my handlebars template\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.registerItemTab(\n   *     new api.models.HandlebarsTab({\n   *       title: 'My Item Tab',\n   *       tabId: 'my-module-id-my-item-tab',\n   *       path: '/modules/my-module-id/my-item-tab.hbs',\n   *       enabled: (data) => data.item.type === 'spell',\n   *       getData: (data) => {\n   *         data['my-extra-data'] = 'Hello, world! ';\n   *         return data;\n   *       },\n   *       onRender(params) {\n   *         const myTab = $(params.tabContentsElement);\n   *         myTab.find('.my-control').click(_myHandler.bind(params.app));\n   *       },\n   *     }));\n   * });\n   * ```\n   *\n   * @example Register an item tab with autoHeight, similar to how Details item tabs work.\n   * ```js\n   * Hooks.once(\"tidy5e-sheet.ready\", (api) => {\n   *   api.registerItemTab(\n   *     new api.models.HtmlTab({\n   *       title: \"My Item Tab\",\n   *       tabId: \"my-module-id-my-item-tab\",\n   *       html: \"<h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h1>LOREM! IPSUM! FIREBALLLLLL!!</h1><h2></h2>\",\n   *     }),\n   *     { autoHeight: true } //  With Auto Height set to `true`, the item window will stretch as tall as it can to match the content height when this tab is viewed.\n   *   );\n   * });\n   * ```\n   *\n   * @remarks\n   * A tab ID is always required (see {@link TabId}).\n   */\n  registerItemTab(\n    tab: SupportedTab,\n    options?: ItemTabRegistrationOptions\n  ): void {\n    if (!TabManager.validateTab(tab)) {\n      return;\n    }\n\n    const registeredTab = TabManager.mapCustomTabToRegisteredTab(tab);\n\n    if (!registeredTab) {\n      warn('Unable to register tab. Tab type not supported');\n      return;\n    }\n\n    if (options?.autoHeight) {\n      registeredTab.autoHeight = options.autoHeight;\n    }\n\n    ItemSheetRuntime.registerTab(registeredTab);\n  }\n\n  /**\n   * Adds a tab to the available NPC sheet tabs.\n   * @param {SupportedTab} tab the information necessary to render a tab\n   * @param {object} [options] sheet registration options\n   * @param {string} [options.layout] an optional sheet layout or layouts (default: 'all')\n   * @param {string} [options.overrideExisting] if a tab with this ID already exists, override it\n   * @returns void\n   * @example Registering a handlebars-based NPC sheet tab\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.registerNpcTab(\n   *     new api.models.HandlebarsTab({\n   *       title: 'My Tab',\n   *       path: '/modules/my-module-id/templates/my-handlebars-template.hbs',\n   *       tabId: 'my-module-id-registered-npc-tab',\n   *       getData: async (data) => {\n   *         data['my-message'] = 'Hello, world! ';\n   *         return Promise.resolve(data);\n   *       },\n   *       onRender(params) {\n   *         const myTab = $(params.tabContentsElement);\n   *         myTab.find('.my-control').click(_myHandler.bind(params.app));\n   *       },\n   *     })\n   *   );\n   * });\n   * ```\n   *\n   * @remarks\n   * A tab ID is always required (see {@link TabId}).\n   */\n  registerNpcTab(\n    tab: SupportedTab,\n    options?: ActorTabRegistrationOptions\n  ): void {\n    if (!TabManager.validateTab(tab)) {\n      return;\n    }\n    const registeredTab = TabManager.mapCustomTabToRegisteredTab(\n      tab,\n      options?.layout\n    );\n\n    if (!registeredTab) {\n      warn('Unable to register tab. Tab type not supported');\n      return;\n    }\n\n    NpcSheetRuntime.registerTab(registeredTab);\n  }\n\n  /**\n   * Adds a tab to the available Vehicle sheet tabs.\n   * @param {SupportedTab} tab the information necessary to render a tab\n   * @param {object} [options] sheet registration options\n   * @param {string} [options.layout] an optional sheet layout or layouts (default: 'all')\n   * @param {string} [options.overrideExisting] if a tab with this ID already exists, override it\n   * @returns void\n   * @example Registering a handlebars-based vehicle sheet tab\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.registerVehicleTab(\n   *     new api.models.HandlebarsTab({\n   *       title: 'My Tab',\n   *       path: '/modules/my-module-id/templates/my-handlebars-template.hbs',\n   *       tabId: 'my-module-id-registered-vehicle-tab',\n   *       getData: async (data) => {\n   *         data['my-message'] = 'Hello, world! ';\n   *         return Promise.resolve(data);\n   *       },\n   *       onRender(params) {\n   *         const myTab = $(params.tabContentsElement);\n   *         myTab.find('.my-control').click(_myHandler.bind(params.app));\n   *       },\n   *     })\n   *   );\n   * });\n   * ```\n   *\n   * @remarks\n   * A tab ID is always required (see {@link TabId}).\n   */\n  registerVehicleTab(\n    tab: SupportedTab,\n    options?: ActorTabRegistrationOptions\n  ): void {\n    if (!TabManager.validateTab(tab)) {\n      return;\n    }\n    const registeredTab = TabManager.mapCustomTabToRegisteredTab(\n      tab,\n      options?.layout\n    );\n\n    if (!registeredTab) {\n      warn('Unable to register tab. Tab type not supported');\n      return;\n    }\n\n    VehicleSheetRuntime.registerTab(registeredTab);\n  }\n\n  /**\n   * Registers header controls for all Tidy Application V2 Actor sheets.\n   *\n   * @param params parameters for registering header controls\n   *\n   * @example Registering a header with an icon, a label, and a handler\n   *\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.registerActorHeaderControls({\n   *     controls: [\n   *       {\n   *         icon: 'fas fa-hand-sparkles',\n   *         label: 'Say Hello',\n   *         async onClickAction() {\n   *           ui.notifications.info(`Hello, Foundry!`);\n   *         },\n   *       },\n   *     ],\n   *   });\n   * });\n   * ```\n   *\n   * @example Registering a header control with a lot of settings.\n   *\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.registerActorHeaderControls({\n   *     controls: [\n   *       {\n   *         icon: 'fas fa-broom',\n   *         label: 'Debug Button',\n   *         visible() {\n   *           return !this.document.compendium?.locked;\n   *         },\n   *         async onClickAction(event) {\n   *           ui.notifications.info(\n   *             `Logged document data for ${this.document.name} to console for review.`\n   *           );\n   *           console.log(this.document);\n   *           console.log(await this.document.sheet._prepareContext());\n   *         },\n   *         ownership: CONST.DOCUMENT_OWNERSHIP_LEVELS.OWNER,\n   *       },\n   *     ],\n   *   });\n   * });\n   * ```\n   */\n  registerActorHeaderControls(params: HeaderControlRegistrationParams) {\n    HeaderControlsRuntime.registerHeaderControls(\n      params.controls.map((c) => ({\n        ...c,\n        supportedDocuments: ['Actor'],\n      }))\n    );\n  }\n\n  /**\n   * Registers header controls for all Tidy Application V2 Character sheets.\n   *\n   * @param params parameters for registering header controls\n   *\n   * @example Registering a header control with a lot of settings.\n   *\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.registerCharacterHeaderControls({\n   *     controls: [\n   *       {\n   *         icon: 'fas fa-broom',\n   *         label: 'Debug Button',\n   *         visible() {\n   *           return !this.document.compendium?.locked;\n   *         },\n   *         async onClickAction(event) {\n   *           ui.notifications.info(\n   *             `Logged document data for ${this.document.name} to console for review.`\n   *           );\n   *           console.log(this.document);\n   *           console.log(await this.document.sheet._prepareContext());\n   *         },\n   *         ownership: CONST.DOCUMENT_OWNERSHIP_LEVELS.OWNER,\n   *       },\n   *     ],\n   *   });\n   * });\n   * ```\n   */\n  registerCharacterHeaderControls(params: HeaderControlRegistrationParams) {\n    HeaderControlsRuntime.registerHeaderControls(\n      params.controls.map((c) => ({\n        ...c,\n        supportedDocuments: ['Actor'],\n        documentTypes: [CONSTANTS.SHEET_TYPE_CHARACTER],\n      }))\n    );\n  }\n\n  /**\n   * Registers header controls for all Tidy Application V2 Group sheets.\n   *\n   * @param params parameters for registering header controls\n   *\n   * @example Registering a header control with a lot of settings.\n   *\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.registerGroupHeaderControls({\n   *     controls: [\n   *       {\n   *         icon: 'fas fa-broom',\n   *         label: 'Debug Button',\n   *         visible() {\n   *           return !this.document.compendium?.locked;\n   *         },\n   *         async onClickAction(event) {\n   *           ui.notifications.info(\n   *             `Logged document data for ${this.document.name} to console for review.`\n   *           );\n   *           console.log(this.document);\n   *           console.log(await this.document.sheet._prepareContext());\n   *         },\n   *         ownership: CONST.DOCUMENT_OWNERSHIP_LEVELS.OWNER,\n   *       },\n   *     ],\n   *   });\n   * });\n   * ```\n   */\n  registerGroupHeaderControls(params: HeaderControlRegistrationParams) {\n    HeaderControlsRuntime.registerHeaderControls(\n      params.controls.map((c) => ({\n        ...c,\n        supportedDocuments: ['Actor'],\n        documentTypes: [CONSTANTS.SHEET_TYPE_GROUP],\n      }))\n    );\n  }\n\n  /**\n   * Registers header controls for all Tidy Application V2 Item sheets.\n   *\n   * @param params parameters for registering header controls\n   *\n   * @example Registering a header control for containers only and with fairly involved usage of the parameters.\n   *\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.registerItemHeaderControls({\n   *     controls: [\n   *       {\n   *         icon: 'fas fa-coins',\n   *         label: 'Take all the coin!',\n   *         visible() {\n   *           return (\n   *             this.document.type === 'container' &&\n   *             this.document.actor &&\n   *             this.document.isOwner\n   *           );\n   *         },\n   *         async onClickAction(event) {\n   *           ui.notifications.info(`Taking all the money out of the bag!`);\n   *           const actorCurrency = this.actor.toObject().system.currency;\n   *           const containerCurrency = this.document.toObject().system.currency;\n   *           for (let [key, value] of Object.entries(containerCurrency)) {\n   *             actorCurrency[key] += containerCurrency[key];\n   *             containerCurrency[key] = 0;\n   *           }\n   *           this.actor.update({\n   *             system: {\n   *               currency: actorCurrency,\n   *             },\n   *           });\n   *           this.document.update({\n   *             system: {\n   *               currency: containerCurrency,\n   *             },\n   *           });\n   *         },\n   *         ownership: CONST.DOCUMENT_OWNERSHIP_LEVELS.OWNER,\n   *       },\n   *     ],\n   *   });\n   * });\n   * ```\n   */\n  registerItemHeaderControls(params: HeaderControlRegistrationParams) {\n    HeaderControlsRuntime.registerHeaderControls(\n      params.controls.map((c) => ({\n        ...c,\n        supportedDocuments: ['Item'],\n      }))\n    );\n  }\n\n  /**\n   * Registers header controls for all Tidy Application V2 NPC sheets.\n   *\n   * @param params parameters for registering header controls\n   *\n   * @example Registering a header control with a lot of settings.\n   *\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.registerNpcHeaderControls({\n   *     controls: [\n   *       {\n   *         icon: 'fas fa-broom',\n   *         label: 'Debug Button',\n   *         visible() {\n   *           return !this.document.compendium?.locked;\n   *         },\n   *         async onClickAction(event) {\n   *           ui.notifications.info(\n   *             `Logged document data for ${this.document.name} to console for review.`\n   *           );\n   *           console.log(this.document);\n   *           console.log(await this.document.sheet._prepareContext());\n   *         },\n   *         ownership: CONST.DOCUMENT_OWNERSHIP_LEVELS.OWNER,\n   *       },\n   *     ],\n   *   });\n   * });\n   * ```\n   */\n  registerNpcHeaderControls(params: HeaderControlRegistrationParams) {\n    HeaderControlsRuntime.registerHeaderControls(\n      params.controls.map((c) => ({\n        ...c,\n        supportedDocuments: ['Actor'],\n        documentTypes: [CONSTANTS.SHEET_TYPE_NPC],\n      }))\n    );\n  }\n\n  /**\n   * Registers header controls for all Tidy Application V2 Vehicle sheets.\n   *\n   * @param params parameters for registering header controls\n   *\n   * @example Registering a header control with a lot of settings.\n   *\n   * ```js\n   * Hooks.once('tidy5e-sheet.ready', (api) => {\n   *   api.registerVehicleHeaderControls({\n   *     controls: [\n   *       {\n   *         icon: 'fas fa-broom',\n   *         label: 'Debug Button',\n   *         visible() {\n   *           return !this.document.compendium?.locked;\n   *         },\n   *         async onClickAction(event) {\n   *           ui.notifications.info(\n   *             `Logged document data for ${this.document.name} to console for review.`\n   *           );\n   *           console.log(this.document);\n   *           console.log(await this.document.sheet._prepareContext());\n   *         },\n   *         ownership: CONST.DOCUMENT_OWNERSHIP_LEVELS.OWNER,\n   *       },\n   *     ],\n   *   });\n   * });\n   * ```\n   */\n  registerVehicleHeaderControls(params: HeaderControlRegistrationParams) {\n    HeaderControlsRuntime.registerHeaderControls(\n      params.controls.map((c) => ({\n        ...c,\n        supportedDocuments: ['Actor'],\n        documentTypes: [CONSTANTS.SHEET_TYPE_VEHICLE],\n      }))\n    );\n  }\n\n  /**\n   * Wraps the provided HTML so that Tidy will remove the content when handling document changes.\n   * @param html any HTML string that needs to be re-rendered in the style of Foundry Handlebars (usually, this is any time the target document or its embedded documents change).\n   * @returns the original HTML with a transparent element wrapped around which indicates to Tidy that this should be removed and re-rendered.\n   *\n   * @remarks\n   * The intended use of this function is to accompany the use of the `tidy5e-sheet.renderActorSheet` hook in App V1 (PCs, NPCs, Vehicles) \n   * or the standard sheet render hooks in App V2 (Items, Containers, Groups).\n   * Any content injected through those hooks needs to be wrapped in this way so that the old version\n   * of the HTML can be removed before adding it back in.\n   * Handlebars refreshes content in this way, but for Tidy purposes, the module needs to know when an arbitrary\n   * segment of HTML is meant to be removed. This function provides that information to Tidy for your HTML.\n   *\n   * @example Injecting dynamic HTML through Tidy actor sheet render hook\n   * ```js\n   * Hooks.on('tidy5e-sheet.renderActorSheet', (app, element, data) => {\n   *   const api = game.modules.get('tidy5e-sheet').api;\n   *   const actorEmoji = data.actor.system.currency.pp > 0 ? '' : '';\n   *   let iconHtml = api.useHandlebarsRendering(`<h1>${actorEmoji}</h1>`);\n   *   //  This HTML looks like `<div style=\"display: contents;\" data-tidy-render-scheme=\"handlebars\"><h1></h1></div>`\n   *   // if the actor doesn't have at least 1 platinum.\n   *   // Tidy will remove this each time the sheet would normally re-render, and it will add it back.\n   *   // When the actor have more than 0 platinum, stonks will rise.\n   *\n   *   let actorNameElement = element.querySelector(`[data-tidy-field=\"name\"]`);\n   *   actorNameElement?.insertAdjacentHTML('afterend', iconHtml);\n   * });\n   * ```\n   */\n  useHandlebarsRendering(html: string): string {\n    return `<div style=\"display: contents;\" ${CONSTANTS.HTML_DYNAMIC_RENDERING_ATTRIBUTE}>${html}</div>`;\n  }\n}\n","import { settings } from 'src/settings/settings.svelte';\nimport type { Item5e } from 'src/types/item.types';\nimport { ItemUtils } from './ItemUtils';\nimport { CONSTANTS } from 'src/constants';\nimport { TidyFlags } from 'src/api';\n\nexport class SpellUtils {\n  /** Is a cantrip. */\n  static isCantrip(item: Item5e) {\n    return item.type === CONSTANTS.ITEM_TYPE_SPELL && item.system.level === 0;\n  }\n\n  /** The cantrip is castable. If cantrip preparation is turned on, then require the cantrip to be prepared to be castable. */\n  static isCastableCantrip(item: Item5e) {\n    return (\n      SpellUtils.isCantrip(item) &&\n      (SpellUtils.isCantripPrepared(item) ||\n        SpellUtils.isAlwaysPrepared(item) ||\n        SpellUtils.isUnlimitedAtWill(item) ||\n        SpellUtils.isUnlimitedInnate(item) ||\n        ItemUtils.hasSufficientLimitedUses(item))\n    );\n  }\n\n  /** While the Cantrip Formulas rule is enabled, this cantrip must have prepared status. If the rule is not enabled, a cantrip is always prepared.  */\n  static isCantripPrepared(item: Item5e) {\n    const prepareCantrips = settings.value.allowCantripsToBePrepared;\n\n    return !prepareCantrips || (prepareCantrips && SpellUtils.isPrepared(item));\n  }\n\n  /** Spell is castable in this moment. */\n  static isCastableSpell(item: Item5e) {\n    return (\n      SpellUtils.isSpell(item) &&\n      (SpellUtils.isPrepared(item) ||\n        SpellUtils.isAlwaysPrepared(item) ||\n        SpellUtils.isUnlimitedAtWill(item) ||\n        SpellUtils.isUnlimitedInnate(item) ||\n        ItemUtils.hasSufficientLimitedUses(item) ||\n        SpellUtils.isPactMagic(item) ||\n        SpellUtils.isRitualSpellForRitualCaster(item))\n    );\n  }\n\n  static isRitualSpellForRitualCaster(item: any) {\n    return (\n      item.system.properties.has(CONSTANTS.SPELL_PROPERTY_RITUAL) &&\n      item.parent &&\n      TidyFlags.includeRitualsInCanCast.get(item.parent)\n    );\n  }\n\n  /** A spell item with a non-cantrip level. */\n  static isSpell(item: any) {\n    return item.type === CONSTANTS.ITEM_TYPE_SPELL && item.system.level > 0;\n  }\n\n  /** Spell is always prepared. */\n  static isAlwaysPrepared(item: any): any {\n    return (\n      item.system.preparation?.mode === CONSTANTS.SPELL_PREPARATION_MODE_ALWAYS\n    );\n  }\n\n  /** Is an At-Will spell with no limit on uses. */\n  static isUnlimitedAtWill(item: any): boolean {\n    return SpellUtils.isAtWill(item) && !ItemUtils.hasConfiguredUses(item);\n  }\n\n  /** Is an At-Will spell. */\n  static isAtWill(item: any): boolean {\n    return (\n      item.system.preparation?.mode === CONSTANTS.SPELL_PREPARATION_MODE_ATWILL\n    );\n  }\n\n  /** Is an Innate spell with no limit on uses. */\n  static isUnlimitedInnate(item: any): boolean {\n    return SpellUtils.isInnate(item) && !ItemUtils.hasConfiguredUses(item);\n  }\n\n  /** Is an Innate spell. */\n  static isInnate(item: any): boolean {\n    return (\n      item.system.preparation?.mode === CONSTANTS.SPELL_PREPARATION_MODE_INNATE\n    );\n  }\n\n  /** Is pact magic. */\n  static isPactMagic(item: Item5e) {\n    return (\n      item.system.preparation?.mode === CONSTANTS.SPELL_PREPARATION_MODE_PACT\n    );\n  }\n\n  /** Is a spell that requires preparation and is prepared. */\n  static isPrepared(item: Item5e) {\n    return (\n      item.system.preparation?.mode === 'prepared' &&\n      item.system.preparation?.prepared\n    );\n  }\n\n  /** Is a spell that requires preparation but is unprepared. */\n  static isUnprepared(item: Item5e) {\n    return (\n      item.system.preparation?.mode === 'prepared' &&\n      !item.system.preparation?.prepared\n    );\n  }\n\n  static getToggleTitle(item: Item5e) {\n    const prep = item.system.preparation || {};\n    const isAlways = prep.mode === 'always';\n    const isPrepared = !!prep.prepared;\n\n    if (isAlways) {\n      return CONFIG.DND5E.spellPreparationModes.always.label;\n    } else if (isPrepared) {\n      return CONFIG.DND5E.spellPreparationModes.prepared.label;\n    }\n\n    return game.i18n.localize('DND5E.SpellUnprepared');\n  }\n\n  static tryFilterByClass(spells: any[], selectedClassFilter?: string) {\n    if (\n      !settings.value.useMulticlassSpellbookFilter ||\n      selectedClassFilter === ''\n    ) {\n      return spells;\n    }\n\n    return spells.filter(\n      (spell) =>\n        spell.system.sourceClass?.trim() === selectedClassFilter?.trim()\n    );\n  }\n}\n","import { CONSTANTS } from 'src/constants';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { ActionListRuntime } from 'src/runtime/action-list/ActionListRuntime';\nimport { settings } from 'src/settings/settings.svelte';\nimport type { ContainerContents, Item5e } from 'src/types/item.types';\nimport type {\n  ActionItem,\n  ActionSection,\n  Actor5e,\n  SortMode,\n} from 'src/types/types';\nimport { isNil } from 'src/utils/data';\nimport { simplifyFormula } from 'src/utils/formula';\nimport { debug, error } from 'src/utils/logging';\nimport { SpellUtils } from 'src/utils/SpellUtils';\nimport { TidyFlags } from 'src/foundry/TidyFlags';\nimport { Container } from '../containers/Container';\n\nexport type ActionSets = Record<string, Set<ActionItem>>;\n\nconst itemTypeSortValues: Record<string, number> = {\n  weapon: 1,\n  equipment: 2,\n  feat: 3,\n  spell: 4,\n  consumable: 5,\n  tool: 6,\n  class: 8,\n  loot: 9,\n};\n\nconst activationTypeSortValues: Record<string, number> = {\n  action: 1,\n  bonus: 2,\n  reaction: 3,\n  legendary: 4,\n  mythic: 5,\n  lair: 6,\n  crew: 7,\n  special: 8,\n};\n\nexport async function getActorActionSections(\n  actor: Actor5e\n): Promise<ActionSection[]> {\n  try {\n    let eligibleItems: ActionItem[] = [];\n\n    for (let item of actor.items) {\n      if (!isItemInActionList(item)) {\n        continue;\n      }\n\n      eligibleItems.push(await mapActionItem(item));\n    }\n\n    return buildActionSections(actor, eligibleItems);\n  } catch (e) {\n    error('An error occurred while getting actions', false, e);\n    return [];\n  }\n}\n\nexport function getSortedActions(section: ActionSection, sortMode: SortMode) {\n  return section.actions.toSorted(({ item: a }, { item: b }) => {\n    if (sortMode === 'a') {\n      return a.name.localeCompare(b.name, game.i18n.lang);\n    }\n\n    // Sort by Arbitrary Action List Rules\n    if (a.type !== b.type) {\n      return itemTypeSortValues[a.type] - itemTypeSortValues[b.type];\n    }\n    if (a.type === 'spell' && b.type === 'spell') {\n      return a.system.level - b.system.level;\n    }\n    return (a.sort || 0) - (b.sort || 0);\n  });\n}\n\nfunction buildActionSections(\n  actor: Actor5e,\n  actionItems: ActionItem[]\n): ActionSection[] {\n  const customMappings = ActionListRuntime.getActivationTypeMappings();\n\n  let actionSections: Record<string, ActionSection> = {};\n\n  // Initialize the default sections in their default order.\n  Object.keys(activationTypeSortValues).forEach((activationType) => {\n    actionSections[activationType] = {\n      actions: [],\n      dataset: {},\n      label: FoundryAdapter.getActivationTypeLabel(activationType),\n      key: activationType,\n      show: true,\n    };\n  });\n\n  // partition items into sections\n  for (let actionItem of actionItems) {\n    const customSectionName = TidyFlags.actionSection.get(actionItem.item);\n    if (customSectionName) {\n      const customSection = (actionSections[customSectionName] ??= {\n        actions: [],\n        dataset: {},\n        key: customSectionName,\n        label: FoundryAdapter.localize(customSectionName),\n        show: true,\n        custom: {\n          creationItemTypes: [],\n          section: customSectionName,\n        },\n      });\n      customSection.actions.push(actionItem);\n    } else {\n      const activationType = getActivationType(\n        actionItem.item.system.activities?.contents[0]?.activation.type,\n        customMappings\n      );\n      const section = (actionSections[activationType] ??= {\n        actions: [],\n        dataset: {},\n        key: activationType,\n        label: FoundryAdapter.getActivationTypeLabel(activationType),\n        show: true,\n      });\n      section.actions.push(actionItem);\n    }\n  }\n\n  return Object.values(actionSections);\n}\n\nexport function isItemInActionList(item: Item5e): boolean {\n  // check our override\n  const override = TidyFlags.actionFilterOverride.get(item);\n\n  if (override !== undefined && override !== null) {\n    return override;\n  }\n\n  // perform normal filtering logic\n  switch (item.type) {\n    case CONSTANTS.ITEM_TYPE_WEAPON: {\n      return item.system.equipped;\n    }\n    case CONSTANTS.ITEM_TYPE_EQUIPMENT: {\n      return (\n        item.system.equipped &&\n        isActiveItem(item.system.activities?.contents[0]?.activation.type)\n      );\n    }\n    case CONSTANTS.ITEM_TYPE_CONSUMABLE: {\n      return (\n        settings.value.actionListIncludeConsumables &&\n        isActiveItem(item.system.activities?.contents[0]?.activation.type)\n      );\n    }\n    case CONSTANTS.ITEM_TYPE_SPELL: {\n      const limitToCantrips = settings.value.actionListLimitActionsToCantrips;\n\n      // only exclude spells which need to be prepared but aren't\n      if (\n        !SpellUtils.isCantrip(item) &&\n        (limitToCantrips || SpellUtils.isUnprepared(item))\n      ) {\n        return false;\n      }\n      const isReaction =\n        item.system.activities?.contents[0]?.activation.type ===\n        CONSTANTS.ACTIVATION_COST_REACTION;\n      const isBonusAction =\n        item.system.activities?.contents[0]?.activation.type ===\n        CONSTANTS.ACTIVATION_COST_BONUS;\n\n      //ASSUMPTION: If the spell causes damage, it will have damageParts\n      const damage = getActivityFirstDamage(item);\n      const isDamageDealer = damage?.parts?.length > 0;\n      let shouldInclude = isReaction || isBonusAction || isDamageDealer;\n      if (settings.value.actionListIncludeMinuteLongSpellsAsActions) {\n        const isOneMinuter =\n          item.system?.duration?.units === 'minute' &&\n          item.system?.duration?.value === 1;\n        const isOneRounder =\n          item.system?.duration?.units === 'round' &&\n          item.system?.duration?.value === 1;\n        shouldInclude = shouldInclude || isOneMinuter || isOneRounder;\n      }\n      if (settings.value.actionListIncludeSpellsWithActiveEffects) {\n        const hasEffects = !!item.effects.size;\n        shouldInclude = shouldInclude || hasEffects;\n      }\n      return shouldInclude;\n    }\n    case CONSTANTS.ITEM_TYPE_FEAT: {\n      return !!item.system.activities?.contents[0]?.activation.type;\n    }\n    default: {\n      return false;\n    }\n  }\n}\n\nfunction getActivityFirstDamage(item: Item5e) {\n  const activity =\n    item.system.activities?.getByType('attack')[0] ||\n    item.system.activities?.getByType('damage')[0] ||\n    item.system.activities?.getByType('save')[0];\n  return {\n    parts:\n      activity?.damage.parts.map((d: any) => [\n        d.formula,\n        d.types.first() ?? '',\n      ]) ?? [],\n    versatile: '',\n  };\n}\n\nasync function mapActionItem(item: Item5e): Promise<ActionItem> {\n  try {\n    let calculatedDerivedDamage = Array.isArray(item.labels.damages)\n      ? [...item.labels.damages].map(\n          ({ formula, label, damageType }: any, i: number) => {\n            const damage = getActivityFirstDamage(item);\n            const rawDamagePartFormula = damage.parts?.[0]?.[0];\n\n            if (rawDamagePartFormula?.trim() === '') {\n              formula = '';\n            }\n\n            const formulaBeforeSimplificaton = formula;\n\n            formula = simplifyFormula(formula, true);\n\n            if (formula.includes('NaN')) {\n              formula = formulaBeforeSimplificaton;\n            }\n\n            const damageHealingTypeLabel =\n              FoundryAdapter.lookupDamageType(damageType) ??\n              FoundryAdapter.lookupHealingType(damageType) ??\n              '';\n\n            /*\n            TODO:\n            When revisiting how to represent damage rolls, \n            pursue activity.getDamageConfig() for each activity.\n            It provides damage parts and types.            \n            */\n\n            return {\n              label,\n              formula,\n              damageType,\n              damageHealingTypeLabel,\n            };\n          }\n        )\n      : [];\n\n    let containerContents: ContainerContents | undefined = undefined;\n    if (item.type === CONSTANTS.ITEM_TYPE_CONTAINER) {\n      containerContents = await Container.getContainerContents(item);\n    }\n\n    return {\n      item,\n      typeLabel: FoundryAdapter.localize(`TYPES.Item.${item.type}`),\n      calculatedDerivedDamage,\n      containerContents,\n      ...getRangeTitles(item),\n    };\n  } catch (e) {\n    error(\n      'An error occurred while processing an item for the action list',\n      false,\n      e\n    );\n    debug('Action list mapping error troubleshooting info', { item });\n\n    return {\n      item,\n      typeLabel: FoundryAdapter.localize(`TYPES.Item.${item.type}`),\n      calculatedDerivedDamage: [],\n      rangeTitle: '',\n      rangeSubtitle: '',\n    };\n  }\n}\n\nfunction getRangeTitles(item: Item5e): {\n  rangeTitle: string | null;\n  rangeSubtitle: string | null;\n} {\n  const firstActivity = item.system.activities?.contents[0] ?? {};\n\n  const rangeSubtitle =\n    (firstActivity.target?.affects?.type ??\n      firstActivity.target?.template?.type) &&\n    item.labels?.target\n      ? item.labels.target\n      : null;\n\n  const rangeTitle =\n    firstActivity.target?.type === 'self'\n      ? item.labels.target\n      : hasRange(item)\n      ? item.labels.range\n      : rangeSubtitle !== null\n      ? ''\n      : null;\n\n  return {\n    rangeTitle,\n    rangeSubtitle,\n  };\n}\n\nfunction hasRange(item: Item5e): boolean {\n  return !isNil(item.system.activities?.contents[0]?.range?.units);\n}\n\nfunction getActivationType(\n  activationType: string,\n  customMappings: Record<string, string>\n) {\n  const customMapping = customMappings[activationType];\n  if (customMapping) {\n    return customMapping;\n  }\n\n  if (activationType in activationTypeSortValues) {\n    return activationType;\n  }\n\n  return 'other';\n}\n\nfunction isActiveItem(activationType: string) {\n  if (!activationType) {\n    return false;\n  }\n  if (['minute', 'hour', 'day', 'none'].includes(activationType)) {\n    return false;\n  }\n  return true;\n}\n\n// TODO: Put more Actions stuff into the static class\nexport class Actions {\n  static get damageAndHealingTypesIconSrcMap(): Record<string, string> {\n    const damageTypes = Object.entries(CONFIG.DND5E.damageTypes).reduce<\n      Record<string, string>\n    >((obj, [key, damageType]: [string, any]) => {\n      obj[key] = damageType.icon;\n      return obj;\n    }, {});\n    const healingTypes = Object.entries(CONFIG.DND5E.healingTypes).reduce<\n      Record<string, string>\n    >((obj, [key, damageType]: [string, any]) => {\n      obj[key] = damageType.icon;\n      return obj;\n    }, {});\n    return {\n      ...damageTypes,\n      ...healingTypes,\n    };\n  }\n}\n\nexport function actorUsesActionFeature(actor: Actor5e) {\n  const selectedTabIds = TidyFlags.selectedTabs.get(actor);\n\n  if (selectedTabIds) {\n    return selectedTabIds.includes(CONSTANTS.TAB_ACTOR_ACTIONS);\n  }\n\n  const defaultTabIds =\n    actor.type === CONSTANTS.SHEET_TYPE_CHARACTER\n      ? settings.value.defaultCharacterSheetTabs\n      : actor.type === CONSTANTS.SHEET_TYPE_NPC\n      ? settings.value.defaultNpcSheetTabs\n      : actor.type === CONSTANTS.SHEET_TYPE_VEHICLE\n      ? settings.value.defaultVehicleSheetTabs\n      : [];\n\n  return defaultTabIds.includes(CONSTANTS.TAB_ACTOR_ACTIONS);\n}\n","<script lang=\"ts\">\n  import type { Item5e } from 'src/types/item.types';\n  import ItemControl from './ItemControl.svelte';\n  import { isItemInActionList } from 'src/features/actions/actions.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n\n  interface Props {\n    item: Item5e;\n  }\n\n  let { item }: Props = $props();\n\n  let title: string = $derived.by(() => {\n    const flagValue = TidyFlags.actionFilterOverride.get(item);\n    const titleKey =\n      flagValue === true\n        ? 'TIDY5E.Actions.OverriddenSetOverrideFalse'\n        : flagValue === false\n          ? 'TIDY5E.Actions.OverriddenSetOverrideTrue'\n          : isItemInActionList(item)\n            ? 'TIDY5E.Actions.SetOverrideFalse'\n            : 'TIDY5E.Actions.SetOverrideTrue';\n\n    return localize(titleKey);\n  });\n\n  const localize = FoundryAdapter.localize;\n  let active = $derived(isItemInActionList(item));\n</script>\n\n<ItemControl\n  iconCssClass=\"fas fa-fist-raised\"\n  {active}\n  {title}\n  onclick={(ev) =>\n    ev.shiftKey\n      ? TidyFlags.actionFilterOverride.unset(item)\n      : TidyFlags.actionFilterOverride.set(item, !isItemInActionList(item))}\n/>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { Item5e } from 'src/types/item.types';\n  import ItemTable from '../../../components/item-list/v1/ItemTable.svelte';\n  import ItemTableHeaderRow from '../../../components/item-list/v1/ItemTableHeaderRow.svelte';\n  import ItemTableRow from '../../../components/item-list/v1/ItemTableRow.svelte';\n  import ItemTableFooter from '../../../components/item-list/ItemTableFooter.svelte';\n  import ItemTableColumn from '../../../components/item-list/v1/ItemTableColumn.svelte';\n  import ItemTableCell from '../../../components/item-list/v1/ItemTableCell.svelte';\n  import ItemUseButton from '../../../components/item-list/ItemUseButton.svelte';\n  import ItemName from '../../../components/item-list/ItemName.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import ItemUses from '../../../components/item-list/ItemUses.svelte';\n  import ItemDeleteControl from '../../../components/item-list/controls/ItemDeleteControl.svelte';\n  import ItemEditControl from '../../../components/item-list/controls/ItemEditControl.svelte';\n  import EquipControl from '../../../components/item-list/controls/EquipControl.svelte';\n  import AttuneControl from '../../../components/item-list/controls/AttuneControl.svelte';\n  import InlineFavoriteIcon from '../../../components/item-list/InlineFavoriteIcon.svelte';\n  import ItemFavoriteControl from '../../../components/item-list/controls/ItemFavoriteControl.svelte';\n  import { getContext } from 'svelte';\n  import type {\n    CharacterSheetContext,\n    InventorySection,\n    NpcSheetContext,\n    RenderableClassicControl,\n  } from 'src/types/types';\n  import ActionFilterOverrideControl from 'src/components/item-list/controls/ActionFilterOverrideControl.svelte';\n  import { coalesce } from 'src/utils/formatting';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import ClassicControls from 'src/sheets/classic/shared/ClassicControls.svelte';\n  import InlineContainerView from '../container/InlineContainerView.svelte';\n  import { ItemUtils } from 'src/utils/ItemUtils';\n  import InlineToggleControl from 'src/sheets/classic/shared/InlineToggleControl.svelte';\n  import { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import { getSearchResultsContext } from 'src/features/search/search.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    primaryColumnName: string;\n    section: InventorySection;\n    extraInventoryRowClasses?: string;\n    lockControls?: boolean;\n    allowFavoriteIconNextToName?: boolean;\n    includeWeightColumn?: boolean;\n    allowAttuneControl?: boolean;\n    allowEquipControl?: boolean;\n  }\n\n  let {\n    primaryColumnName,\n    section,\n    extraInventoryRowClasses = '',\n    lockControls = false,\n    allowFavoriteIconNextToName = true,\n    includeWeightColumn = true,\n    allowAttuneControl = true,\n    allowEquipControl = true,\n  }: Props = $props();\n\n  let inlineToggleService = getContext<InlineToggleService>(\n    CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n  );\n\n  let context =\n    $derived(getSheetContext<CharacterSheetContext | NpcSheetContext>());\n\n  let itemEntries = $derived(\n    section.items.map((item) => ({\n      item: item,\n      ctx: context.itemContext[item.id],\n      // TODO: Determine if this is needed any longer\n      itemName:\n        item.system.identified === false\n          ? coalesce(\n              item.system.unidentified.name,\n              localize('DND5E.Unidentified.Title'),\n            )\n          : item.name,\n    })),\n  );\n\n  const searchResults = getSearchResultsContext();\n\n  const localize = FoundryAdapter.localize;\n  const weightUnit = FoundryAdapter.getWeightUnit();\n\n  // TODO: Assign these controls to the inventory prop in `getData()`. Leave room for the API to inject additional controls.\n  let controls: RenderableClassicControl<{ item: Item5e; ctx: any }>[] =\n    $derived.by(() => {\n      let result: RenderableClassicControl<{ item: Item5e; ctx: any }>[] = [];\n\n      if (allowAttuneControl) {\n        result.push({\n          component: AttuneControl,\n          props: ({ item, ctx }) => ({\n            item,\n            ctx,\n          }),\n          visible: ({ item, ctx }) =>\n            ctx?.attunement && !FoundryAdapter.concealDetails(item),\n        });\n      }\n\n      if (allowEquipControl) {\n        result.push({\n          component: EquipControl,\n          props: ({ item, ctx }) => ({\n            item,\n            ctx,\n          }),\n          visible: ({ ctx }) => ctx?.canToggle === true,\n        });\n      }\n\n      if ('favorites' in context.actor.system) {\n        result.push({\n          component: ItemFavoriteControl,\n          props: ({ item }) => ({\n            item,\n          }),\n        });\n      }\n\n      result.push({\n        component: ItemEditControl,\n        props: ({ item }) => ({\n          item,\n        }),\n      });\n\n      if (context.unlocked) {\n        result.push({\n          component: ItemDeleteControl,\n          props: ({ item }) => ({\n            item,\n          }),\n        });\n      }\n\n      if (context.useActionsFeature) {\n        result.push({\n          component: ActionFilterOverrideControl,\n          props: ({ item }) => ({\n            item,\n          }),\n        });\n      }\n\n      return result;\n    });\n\n  let classicControlsIconWidth = 1.25;\n\n  let classicControlsColumnWidth = $derived(\n    `${classicControlsIconWidth * controls.length}rem`,\n  );\n\n  function getInventoryRowClasses(item: Item5e) {\n    const extras: string[] = [];\n\n    if (extraInventoryRowClasses) {\n      extras.push(extraInventoryRowClasses);\n    }\n\n    return FoundryAdapter.getInventoryRowClasses(\n      item,\n      context.itemContext[item.id],\n      extras,\n    );\n  }\n</script>\n\n<section class=\"inventory-list-section\">\n  <ItemTable\n    key={section.key}\n    data-custom-section={section.custom ? true : null}\n  >\n    {#snippet header()}\n      <ItemTableHeaderRow>\n        <ItemTableColumn primary={true}>\n          {primaryColumnName}\n        </ItemTableColumn>\n        {#if includeWeightColumn}\n          <ItemTableColumn\n            title=\"{localize('DND5E.Weight')} ({weightUnit})\"\n            baseWidth=\"4rem\"\n          >\n            <i class=\"fas fa-weight-hanging\"></i>\n          </ItemTableColumn>\n        {/if}\n        <ItemTableColumn title={localize('DND5E.Charges')} baseWidth=\"3.125rem\">\n          <i class=\"fas fa-bolt\"></i>\n        </ItemTableColumn>\n        <ItemTableColumn baseWidth=\"7.5rem\">\n          {localize('DND5E.Usage')}\n        </ItemTableColumn>\n        <ItemTableColumn baseWidth=\"3rem\">\n          {localize('DND5E.QuantityAbbr')}\n        </ItemTableColumn>\n        {#if context.editable && context.useClassicControls && !lockControls}\n          <ItemTableColumn baseWidth={classicControlsColumnWidth} />\n        {/if}\n      </ItemTableHeaderRow>\n    {/snippet}\n    {#snippet body()}\n      {#each itemEntries as { item, ctx, itemName } (item.id)}\n        <ItemTableRow\n          {item}\n          onMouseDown={(event) => FoundryAdapter.editOnMiddleClick(event, item)}\n          contextMenu={{\n            type: CONSTANTS.CONTEXT_MENU_TYPE_ITEMS,\n            uuid: item.uuid,\n          }}\n          cssClass={getInventoryRowClasses(item)}\n          hidden={!searchResults.show(item.uuid)}\n          favoriteId={'favoriteId' in ctx ? ctx.favoriteId : null}\n        >\n          {#snippet children({ toggleSummary })}\n            <ItemTableCell primary={true}>\n              <ItemUseButton disabled={!context.editable} {item} />\n              {#if 'containerContents' in ctx && !!ctx.containerContents}\n                <InlineToggleControl entityId={item.id} {inlineToggleService} />\n              {/if}\n              <ItemName\n                onToggle={() => toggleSummary(context.actor)}\n                cssClass=\"extra-small-gap\"\n                {item}\n              >\n                <span\n                  class=\"truncate flex-1\"\n                  data-tidy-item-name={itemName}\n                  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_NAME}\n                  >{itemName}</span\n                >\n              </ItemName>\n              <div class=\"primary-cell-extras\">\n                {#if !context.useClassicControls}\n                  {#if ctx?.attunement && !FoundryAdapter.concealDetails(item)}\n                    <div class=\"item-detail attunement\">\n                      <i\n                        class=\"item-state-icon fas {ctx.attunement.icon} {ctx\n                          .attunement.cls}\"\n                        title={localize(ctx.attunement.title)}\n                      ></i>\n                    </div>\n                  {/if}\n\n                  {#if 'favoriteId' in ctx && !!ctx.favoriteId && allowFavoriteIconNextToName}\n                    <InlineFavoriteIcon />\n                  {/if}\n                {/if}\n              </div>\n            </ItemTableCell>\n            {#if includeWeightColumn}\n              {@const weight = ctx?.totalWeight ?? item.system.weight.value}\n              <ItemTableCell\n                baseWidth=\"4rem\"\n                title={localize('TIDY5E.Inventory.Weight.Tooltip', {\n                  weight: weight,\n                  weightUnit: weightUnit,\n                })}\n              >\n                <span class=\"truncate\">\n                  {localize('TIDY5E.Inventory.Weight.Text', {\n                    weight: weight,\n                    weightUnit: weightUnit,\n                  })}\n                </span>\n              </ItemTableCell>\n            {/if}\n            <ItemTableCell baseWidth=\"3.125rem\" title={localize('DND5E.Uses')}>\n              {#if ctx?.hasUses}\n                <ItemUses {item} />\n              {:else}\n                <span class=\"text-body-tertiary\">&mdash;</span>\n              {/if}\n            </ItemTableCell>\n            <ItemTableCell baseWidth=\"7.5rem\" title={localize('DND5E.Usage')}>\n              {#if ItemUtils.hasActivationType(item)}\n                {item.labels?.activation ?? ''}\n              {/if}\n            </ItemTableCell>\n            <ItemTableCell baseWidth=\"3rem\">\n              <TextInput\n                document={item}\n                field=\"system.quantity\"\n                value={item.system.quantity}\n                selectOnFocus={true}\n                disabled={!context.editable || context.lockItemQuantity}\n                placeholder=\"0\"\n                allowDeltaChanges={true}\n                class=\"text-align-center\"\n              />\n            </ItemTableCell>\n            {#if context.editable && context.useClassicControls && !lockControls}\n              <ItemTableCell baseWidth={classicControlsColumnWidth}>\n                <ClassicControls {controls} params={{ item: item, ctx: ctx }} />\n              </ItemTableCell>\n            {/if}\n          {/snippet}\n        </ItemTableRow>\n\n        {#if 'containerContents' in ctx && !!ctx.containerContents}\n          <InlineContainerView\n            container={item}\n            containerContents={ctx.containerContents}\n            editable={context.editable}\n            {inlineToggleService}\n            lockItemQuantity={context.lockItemQuantity}\n            sheetDocument={context.actor}\n            unlocked={context.unlocked}\n          />\n        {/if}\n      {/each}\n      {#if context.unlocked && section.canCreate}\n        <ItemTableFooter actor={context.actor} {section} isItem={true} />\n      {/if}\n    {/snippet}\n  </ItemTable>\n</section>\n\n<style lang=\"scss\">\n  .inventory-list-section {\n    .item-detail.attunement {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      padding: 0 0.25rem;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import type { CharacterFeatureSection } from 'src/types/types';\n  import ItemTable from '../../../../components/item-list/v1/ItemTable.svelte';\n  import ItemTableHeaderRow from '../../../../components/item-list/v1/ItemTableHeaderRow.svelte';\n  import ItemTableColumn from '../../../../components/item-list/v1/ItemTableColumn.svelte';\n  import ItemTableRow from '../../../../components/item-list/v1/ItemTableRow.svelte';\n  import ItemTableCell from '../../../../components/item-list/v1/ItemTableCell.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { CONSTANTS } from 'src/constants';\n  import ItemName from '../../../../components/item-list/ItemName.svelte';\n  import ItemUseButton from '../../../../components/item-list/ItemUseButton.svelte';\n  import ItemUses from '../../../../components/item-list/ItemUses.svelte';\n  import { getContext } from 'svelte';\n  import RechargeControl from 'src/components/item-list/controls/RechargeControl.svelte';\n  import { ItemUtils } from 'src/utils/ItemUtils';\n  import type { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import InlineToggleControl from 'src/sheets/classic/shared/InlineToggleControl.svelte';\n  import { getSearchResultsContext } from 'src/features/search/search.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    section: CharacterFeatureSection;\n  }\n\n  let { section }: Props = $props();\n\n  let context = $derived(getCharacterSheetContext());\n\n  let itemEntries = $derived(\n    section.items.map((item) => ({ item, ctx: context.itemContext[item.id] })),\n  );\n\n  const searchResults = getSearchResultsContext();\n\n  let inlineToggleService = getContext<InlineToggleService>(\n    CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<ItemTable key={section.key} data-custom-section={section.custom ? true : null}>\n  {#snippet header()}\n    <ItemTableHeaderRow>\n      <ItemTableColumn primary={true}>\n        {localize(section.label ?? 'DND5E.Features')}\n      </ItemTableColumn>\n      <ItemTableColumn baseWidth=\"3.125rem\">\n        {localize('DND5E.Uses')}\n      </ItemTableColumn>\n      <ItemTableColumn baseWidth=\"7.5rem\">\n        {localize('DND5E.Usage')}\n      </ItemTableColumn>\n    </ItemTableHeaderRow>\n  {/snippet}\n  {#snippet body()}\n    {#each itemEntries as { item, ctx } (item.id)}\n      <ItemTableRow\n        {item}\n        onMouseDown={(event) => FoundryAdapter.editOnMiddleClick(event, item)}\n        contextMenu={{\n          type: CONSTANTS.CONTEXT_MENU_TYPE_ITEMS,\n          uuid: item.uuid,\n        }}\n        hidden={!searchResults.show(item.uuid)}\n        favoriteId={ctx.favoriteId}\n      >\n        {#snippet children({ toggleSummary })}\n          <ItemTableCell primary={true}>\n            <ItemUseButton disabled={!context.editable} {item} />\n            <ItemName\n              onToggle={() => toggleSummary(context.actor)}\n              hasChildren={false}\n              {item}\n            >\n              <span\n                data-tidy-item-name={item.name}\n                data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_NAME}\n                class=\"truncate flex-1\">{item.name}</span\n              >\n            </ItemName>\n          </ItemTableCell>\n          <ItemTableCell baseWidth=\"3.125rem\">\n            {#if item.isOnCooldown}\n              <RechargeControl\n                document={item}\n                field={'system.uses.spent'}\n                uses={item.system.uses}\n              />\n            {:else if item.hasRecharge}\n              {@const remaining = item.system.uses.max - item.system.uses.spent}\n              {#if remaining > 1}\n                <span>{remaining}</span>\n              {/if}\n              <i class=\"fas fa-bolt\" title={localize('DND5E.Charged')}></i>\n            {:else if ctx?.hasUses}\n              <ItemUses {item} />\n            {:else}\n              <span class=\"text-body-tertiary\">&mdash;</span>\n            {/if}\n          </ItemTableCell>\n          <ItemTableCell baseWidth=\"7.5rem\">\n            {#if ItemUtils.hasActivationType(item)}\n              {item.labels?.activation ?? ''}\n            {/if}\n          </ItemTableCell>\n        {/snippet}\n      </ItemTableRow>\n    {/each}\n  {/snippet}\n</ItemTable>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { type SpellbookSection } from 'src/types/types';\n  import ItemName from '../../../../components/item-list/ItemName.svelte';\n  import ItemTable from '../../../../components/item-list/v1/ItemTable.svelte';\n  import ItemTableCell from '../../../../components/item-list/v1/ItemTableCell.svelte';\n  import ItemTableColumn from '../../../../components/item-list/v1/ItemTableColumn.svelte';\n  import ItemTableHeaderRow from '../../../../components/item-list/v1/ItemTableHeaderRow.svelte';\n  import ItemTableRow from '../../../../components/item-list/v1/ItemTableRow.svelte';\n  import ItemUseButton from '../../../../components/item-list/ItemUseButton.svelte';\n  import ItemUses from '../../../../components/item-list/ItemUses.svelte';\n  import SpellComponents from '../../../../components/spellbook/SpellComponents.svelte';\n  import { getContext } from 'svelte';\n  import SpellSlotManagement from 'src/components/spellbook/SpellSlotManagement.svelte';\n  import ConcentrationOverlayIcon from 'src/components/spellbook/ConcentrationOverlayIcon.svelte';\n  import { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import { getSearchResultsContext } from 'src/features/search/search.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n  import ActivityUses from 'src/components/item-list/ActivityUses.svelte';\n\n  interface Props {\n    section: SpellbookSection;\n  }\n\n  let { section }: Props = $props();\n\n  let inlineToggleService = getContext<InlineToggleService>(\n    CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n  );\n\n  let context = $derived(getCharacterSheetContext());\n\n  let spellEntries = $derived(\n    section.spells.map((spell) => ({\n      spell,\n      ctx: context.itemContext[spell.id],\n      spellImgUrl: FoundryAdapter.getSpellImageUrl(context, spell),\n    })),\n  );\n\n  const searchResults = getSearchResultsContext();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<section class=\"spellbook-list-section\">\n  <ItemTable\n    key={section.key}\n    data-custom-section={section.custom ? true : null}\n  >\n    {#snippet header()}\n      <ItemTableHeaderRow>\n        <ItemTableColumn primary={true}>\n          {#if section.dataset['preparation.mode'] === CONSTANTS.SPELL_PREPARATION_MODE_PREPARED && section.dataset.level > 0}\n            {localize('TIDY5E.FavoriteSpellLevelLabel', {\n              number: section.dataset.level,\n            })}\n          {:else}\n            <span class=\"spell-primary-column-label\">\n              {localize(section.label)}\n            </span>\n          {/if}\n          {#if section.usesSlots}\n            <SpellSlotManagement {section} />\n          {/if}\n        </ItemTableColumn>\n        <ItemTableColumn\n          baseWidth=\"4.375rem\"\n          title={localize('DND5E.SpellComponents')}\n        >\n          <i class=\"fas fa-mortar-pestle\"></i>\n        </ItemTableColumn>\n        <ItemTableColumn\n          title={localize('DND5E.SpellUsage')}\n          baseWidth=\"7.5rem\"\n        >\n          {localize('DND5E.Usage')}\n        </ItemTableColumn>\n      </ItemTableHeaderRow>\n    {/snippet}\n    {#snippet body()}\n      {#each spellEntries as { spell, ctx, spellImgUrl } (spell.id)}\n        <ItemTableRow\n          item={spell}\n          onMouseDown={(event) =>\n            FoundryAdapter.editOnMiddleClick(event, spell)}\n          contextMenu={{\n            type: CONSTANTS.CONTEXT_MENU_TYPE_ITEMS,\n            uuid: spell.uuid,\n          }}\n          cssClass={FoundryAdapter.getSpellRowClasses(spell)}\n          hidden={!searchResults.show(spell.uuid)}\n          favoriteId={ctx.favoriteId}\n        >\n          {#snippet children({ toggleSummary })}\n            <ItemTableCell primary={true}>\n              <ItemUseButton\n                disabled={!context.editable}\n                item={spell}\n                imgUrlOverride={spellImgUrl}\n              >\n                {#snippet afterRollButton()}\n                  <ConcentrationOverlayIcon {ctx} />\n                {/snippet}\n              </ItemUseButton>\n              <ItemName\n                onToggle={() => toggleSummary(context.actor)}\n                item={spell}\n              >\n                <span\n                  class=\"truncate flex-1\"\n                  data-tidy-item-name={spell.name}\n                  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_NAME}\n                  >{spell.name}</span\n                >\n              </ItemName>\n              {#if ctx.hasUses}\n                <div class=\"primary-cell-uses\">\n                  <ItemUses item={spell} />\n                </div>\n              {:else if ctx.linkedUses}\n                <div class=\"primary-cell-uses\">\n                  <div class=\"inline-item-uses\">\n                    <span class=\"uses-value\">\n                      {ctx.linkedUses.value}\n                    </span>\n                    /\n                    <span class=\"uses-max\">\n                      {ctx.linkedUses.max}\n                    </span>\n                  </div>\n                </div>\n              {:else if (spell.system.linkedActivity?.uses?.max ?? 0) > 0}\n                <span class=\"primary-cell-uses\">\n                  <ActivityUses activity={spell.system.linkedActivity} />\n                </span>\n              {/if}\n            </ItemTableCell>\n            <ItemTableCell baseWidth=\"4.375rem\" cssClass=\"no-gap\">\n              <SpellComponents\n                {spell}\n                spellComponentLabels={context.spellComponentLabels}\n              />\n            </ItemTableCell>\n            <ItemTableCell\n              baseWidth=\"7.5rem\"\n              title={localize('DND5E.SpellUsage')}\n            >\n              {spell.labels.activation}\n            </ItemTableCell>\n          {/snippet}\n        </ItemTableRow>\n      {/each}\n    {/snippet}\n  </ItemTable>\n</section>\n\n<style lang=\"scss\">\n  .spell-primary-column-label {\n    font-size: 0.75rem;\n    line-height: 0.75rem;\n    flex: 0 0 3.75rem;\n    white-space: nowrap;\n  }\n</style>\n","<script lang=\"ts\">\n  import ItemImage from 'src/components/item-list/ItemImage.svelte';\n  import EffectTableRow from 'src/components/item-list/v1/EffectTableRow.svelte';\n  import ItemTable from 'src/components/item-list/v1/ItemTable.svelte';\n  import ItemTableCell from 'src/components/item-list/v1/ItemTableCell.svelte';\n  import ItemTableColumn from 'src/components/item-list/v1/ItemTableColumn.svelte';\n  import ItemTableHeaderRow from 'src/components/item-list/v1/ItemTableHeaderRow.svelte';\n  import TidySwitch from 'src/components/toggles/TidySwitch.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type {\n    EffectFavoriteSection,\n    FavoriteEffectContext,\n  } from 'src/types/types';\n\n  interface Props {\n    section: EffectFavoriteSection;\n    /**\n     * An optional subset of item IDs which will hide all other items not included in this set.\n     * Useful for showing only search results, for example.\n     */\n    visibleEffectIdSubset?: Set<string> | null;\n  }\n\n  let { section, visibleEffectIdSubset = null }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n\n  function toggleEffect(context: FavoriteEffectContext): void {\n    context.effect.update({ disabled: !context.effect.disabled });\n  }\n\n  const subtitleColumnWidth = '5rem';\n  const controlsColumnWidth = '3rem';\n</script>\n\n<ItemTable key={section.key} class=\"favorite-effects\">\n  {#snippet header()}\n    <ItemTableHeaderRow>\n      <ItemTableColumn primary={true}>\n        {localize(section.label ?? 'DND5E.Effect')}\n      </ItemTableColumn>\n      <ItemTableColumn baseWidth={subtitleColumnWidth}>\n        <!-- Subtitle -->\n      </ItemTableColumn>\n      <ItemTableColumn baseWidth={controlsColumnWidth}>\n        <!-- Controls -->\n      </ItemTableColumn>\n    </ItemTableHeaderRow>\n  {/snippet}\n  {#snippet body()}\n    {#each section.effects as effectContext (effectContext.effectId)}\n      <EffectTableRow\n        hidden={visibleEffectIdSubset !== null &&\n          !visibleEffectIdSubset.has(effectContext.effect.id)}\n        cssClass={effectContext.suppressed ? 'suppressed' : ''}\n        attributes={{\n          'data-favorite-id': effectContext.id,\n          'data-info-card': 'effect',\n          'data-info-card-entity-uuid': effectContext.effect.uuid,\n        }}\n        activeEffect={effectContext.effect}\n      >\n        <ItemTableCell\n          primary={true}\n          attributes={{\n            'data-tidy-effect-name-container': true,\n            'data-effect-id': effectContext.id,\n          }}\n        >\n          <ItemImage src={effectContext.img} />\n          <span\n            class=\"align-self-center truncate\"\n            data-tidy-effect-name={effectContext.effect.name}\n            >{effectContext.effect.name}</span\n          >\n        </ItemTableCell>\n        <ItemTableCell baseWidth={subtitleColumnWidth}>\n          {effectContext.subtitle ?? ''}\n        </ItemTableCell>\n        <ItemTableCell baseWidth={controlsColumnWidth}>\n          <TidySwitch\n            disabled={effectContext.suppressed}\n            checked={effectContext.toggle.value}\n            onChange={() => toggleEffect(effectContext)}\n          />\n        </ItemTableCell>\n      </EffectTableRow>\n    {/each}\n  {/snippet}\n</ItemTable>\n","export function getTidyFacilityIcon(\n    order: string\n  ): Dnd5eIconSrc | FontAwesomeIconClass | null {\n    const tidyIcon = TidyFacilityIconsMap[order];\n  \n    if (tidyIcon) {\n      return {\n        type: 'fa-icon-class',\n        className: tidyIcon,\n      };\n    }\n  \n    const dnd5eIconSrc = CONFIG.DND5E.facilities.orders[order]?.icon;\n  \n    if (dnd5eIconSrc) {\n      return {\n        type: 'dnd5e-icon',\n        src: dnd5eIconSrc,\n      };\n    }\n  \n    return null;\n  }\n  \n  export const TidyFacilityIconsMap: Record<string, string> = {\n    build: 'fas fa-trowel-bricks',\n    change: 'fas fa-rotate',\n    craft: 'fas fa-hammer-crash',\n    empower: 'fas fa-wreath-laurel',\n    enlarge: 'fas fa-maximize',\n    harvest: 'fas fa-wheat',\n    maintain: 'fas fa-hammer-brush',\n    recruit: 'fas fa-handshake-angle',\n    repair: 'fas fa-screwdriver-wrench',\n    research: 'fas fa-flask',\n    trade: 'fas fa-coins',\n  };\n  \n  type Dnd5eIconSrc = {\n    type: 'dnd5e-icon';\n    src: string;\n  };\n  \n  type FontAwesomeIconClass = {\n    type: 'fa-icon-class';\n    className: string;\n  };","<script lang=\"ts\">\n  import Dnd5eIcon from 'src/components/icon/Dnd5eIcon.svelte';\n  import { getTidyFacilityIcon } from 'src/features/facility/facility';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { ChosenFacilityContext } from 'src/types/types';\n\n  interface Props {\n    chosen: ChosenFacilityContext;\n    showCraftName?: boolean;\n    [key: string]: any;\n  }\n\n  let { chosen, showCraftName = true, ...rest }: Props = $props();\n\n  let icon = $derived(getTidyFacilityIcon(chosen.progress.order));\n\n  let orderLabel = $derived(\n    CONFIG.DND5E.facilities.orders[chosen.progress.order]?.label ??\n      chosen.progress.order,\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div\n  class=\"facility-progress-meter {rest.class ?? ''}\"\n  role=\"meter\"\n  aria-valuemin=\"0\"\n  aria-valuenow={chosen.progress.pct}\n  aria-valuetext={chosen.progress.value?.toString()}\n  aria-valuemax={chosen.progress.max}\n  style=\"--bar-percentage: {chosen.progress.pct}%\"\n>\n  <div class=\"label\">\n    {#if !chosen.disabled}\n      <span class=\"order\">\n        {#if icon?.type === 'fa-icon-class'}\n          <i class={icon.className}></i>\n        {:else if icon?.type === 'dnd5e-icon'}\n          <Dnd5eIcon src={icon.src}></Dnd5eIcon>\n        {/if}\n        <span class=\"progress-meter-label truncate\">\n          {#if chosen.craft && showCraftName}\n            {localize('TIDY5E.Facilities.Progress.OrderAndCraftLabel', {\n              orderName: orderLabel,\n              craftingItemName: chosen.craft.name,\n            })}\n          {:else}\n            {orderLabel}\n          {/if}\n        </span>\n      </span>\n      <span class=\"counter\">\n        <span class=\"value\">{chosen.progress.value}</span> &sol;\n        <span class=\"max\">{chosen.progress.max}</span>\n      </span>\n    {:else}\n      <span class=\"order\">\n        {#if icon?.type === 'fa-icon-class'}\n          <i class={icon.className}></i>\n        {:else if icon?.type === 'dnd5e-icon'}\n          <Dnd5eIcon src={icon.src}></Dnd5eIcon>\n        {/if}\n        <span class=\"progress-meter-label truncate\">\n          {orderLabel}\n        </span>\n      </span>\n    {/if}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import type { Actor5e } from 'src/types/types';\n\n  interface Props {\n    occupants?: Actor5e[];\n    title?: string;\n  }\n\n  let { occupants = [], title = '' }: Props = $props();\n\n  let tooltip: HTMLElement;\n\n  export function getMarkup() {\n    return tooltip.outerHTML;\n  }\n</script>\n\n<div bind:this={tooltip} class=\"document-list-summary-tooltip\">\n  <h3>{title}</h3>\n  <hr />\n  <ul>\n    {#each occupants as occupant}\n      <li class=\"flex-row extra-small-gap align-items-center\">\n        <div\n          class=\"item-image\"\n          style=\"background-image: url('{occupant.img}')\"\n        ></div>\n        <div class=\"item-name truncate\">{occupant.name}</div>\n      </li>\n    {/each}\n  </ul>\n</div>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { type Actor5e, type FacilitySection } from 'src/types/types';\n  import ItemName from '../../../../components/item-list/ItemName.svelte';\n  import ItemTable from '../../../../components/item-list/v1/ItemTable.svelte';\n  import ItemTableCell from '../../../../components/item-list/v1/ItemTableCell.svelte';\n  import ItemTableColumn from '../../../../components/item-list/v1/ItemTableColumn.svelte';\n  import ItemTableHeaderRow from '../../../../components/item-list/v1/ItemTableHeaderRow.svelte';\n  import ItemTableRow from '../../../../components/item-list/v1/ItemTableRow.svelte';\n  import ItemUseButton from '../../../../components/item-list/ItemUseButton.svelte';\n  import { getContext, tick } from 'svelte';\n  import InlineToggleControl from 'src/sheets/classic/shared/InlineToggleControl.svelte';\n  import { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import FacilityOrderProgressMeter from './FacilityOrderProgressMeter.svelte';\n  import { Tooltip } from 'src/tooltips/Tooltip';\n  import OccupantSummaryTooltip from 'src/tooltips/OccupantSummaryTooltip.svelte';\n  import { getSearchResultsContext } from 'src/features/search/search.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    section: FacilitySection;\n  }\n\n  let { section }: Props = $props();\n\n  let inlineToggleService = getContext<InlineToggleService>(\n    CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n  );\n\n  let context = $derived(getCharacterSheetContext());\n\n  let itemEntries = $derived(\n    section.items.map((item) => ({ item, ctx: context.itemContext[item.id] })),\n  );\n\n  let tooltipOccupants = $state<Actor5e[]>([]);\n  let tooltipTitle = $state('');\n\n  const searchResults = getSearchResultsContext();\n\n  const ordersWidth = '10rem';\n  const defendersWidth = '2.5rem';\n  const hirelingsWidth = '2.5rem';\n  const creaturesWidth = '2.5rem';\n\n  const localize = FoundryAdapter.localize;\n\n  let occupantSummaryTooltip: OccupantSummaryTooltip;\n\n  async function showOccupantSummaryTooltip(\n    event: MouseEvent & { currentTarget: EventTarget & HTMLDivElement },\n    uuids: string[],\n    title: string,\n  ) {\n    if (!uuids.length) {\n      return;\n    }\n\n    const occupants: Actor5e[] = [];\n    for (const uuid of uuids) {\n      occupants.push(await fromUuid(uuid));\n    }\n\n    tooltipOccupants = occupants;\n    tooltipTitle = title;\n\n    await tick();\n\n    Tooltip.show(\n      (event?.target as HTMLElement | null) ?? event.currentTarget,\n      occupantSummaryTooltip.getMarkup(),\n    );\n  }\n</script>\n\n<div class=\"hidden\">\n  <OccupantSummaryTooltip\n    bind:this={occupantSummaryTooltip}\n    occupants={tooltipOccupants}\n    title={tooltipTitle}\n  />\n</div>\n\n<section class=\"facility-list-section\">\n  <ItemTable key={section.key}>\n    {#snippet header()}\n      <ItemTableHeaderRow>\n        <!-- Name -->\n        <ItemTableColumn primary={true}>\n          {localize(section.label)}\n        </ItemTableColumn>\n        <!-- Orders -->\n        <ItemTableColumn baseWidth={ordersWidth}>\n          {localize('DND5E.FACILITY.FIELDS.order.label')}\n        </ItemTableColumn>\n        <!-- Defenders -->\n        <ItemTableColumn\n          baseWidth={defendersWidth}\n          title={localize('TIDY5E.Facilities.Defenders.Label')}\n        >\n          <i class=\"fas fa-shield\"></i>\n        </ItemTableColumn>\n        <!-- Hirelings -->\n        <ItemTableColumn\n          baseWidth={hirelingsWidth}\n          title={localize('TIDY5E.Facilities.Hirelings.Label')}\n        >\n          <i class=\"fas fa-user\"></i>\n        </ItemTableColumn>\n        <!-- Creatures -->\n        <ItemTableColumn\n          baseWidth={creaturesWidth}\n          title={localize('TIDY5E.Facilities.Creatures.Label')}\n        >\n          <i class=\"fas fa-horse-head\"></i>\n        </ItemTableColumn>\n      </ItemTableHeaderRow>\n    {/snippet}\n    {#snippet body()}\n      {#each itemEntries as { item, ctx } (item.id)}\n        {@const disabledClass =\n          ctx?.chosen?.disabled === true ? 'disabled' : ''}\n\n        <ItemTableRow\n          {item}\n          cssClass=\"favorite-facility-row {disabledClass}\"\n          onMouseDown={(event) => FoundryAdapter.editOnMiddleClick(event, item)}\n          contextMenu={{\n            type: CONSTANTS.CONTEXT_MENU_TYPE_ITEMS,\n            uuid: item.uuid,\n          }}\n          hidden={!searchResults.show(item.uuid)}\n          favoriteId={ctx.favoriteId}\n        >\n          {#snippet children({ toggleSummary })}\n            <!-- Name -->\n            <ItemTableCell primary={true}>\n              <ItemUseButton\n                disabled={!context.editable &&\n                  (!ctx?.chosen?.disabled || FoundryAdapter.userIsGm())}\n                {item}\n              ></ItemUseButton>\n              <ItemName onToggle={() => toggleSummary(context.actor)} {item}>\n                <span\n                  class=\"truncate flex-1\"\n                  data-tidy-item-name={item.name}\n                  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_NAME}\n                  >{item.name}</span\n                >\n              </ItemName>\n            </ItemTableCell>\n            <!-- Orders -->\n            <ItemTableCell\n              baseWidth={ordersWidth}\n              cssClass=\"justify-content-stretch\"\n            >\n              {@const chosen = ctx?.chosen}\n\n              {#if chosen?.progress?.max || chosen?.executing}\n                <FacilityOrderProgressMeter class=\"flex-1\" {chosen}\n                ></FacilityOrderProgressMeter>\n              {/if}\n            </ItemTableCell>\n            <!-- Defenders -->\n            <ItemTableCell baseWidth={defendersWidth}>\n              <div\n                onmouseover={(ev) =>\n                  showOccupantSummaryTooltip(\n                    ev,\n                    item.system.defenders.value ?? [],\n                    localize('TIDY5E.Facilities.Defenders.Label'),\n                  )}\n                data-tooltip-direction=\"UP\"\n              >\n                {#if item.system.type.value === CONSTANTS.FACILITY_TYPE_SPECIAL && item.system.defenders.max}\n                  {item.system.defenders.value.length}/{item.system.defenders\n                    .max}\n                {:else}\n                  \n                {/if}\n              </div>\n            </ItemTableCell>\n            <!-- Hirelings -->\n            <ItemTableCell baseWidth={hirelingsWidth}>\n              <div\n                onmouseover={(ev) =>\n                  showOccupantSummaryTooltip(\n                    ev,\n                    item.system.hirelings.value ?? [],\n                    localize('TIDY5E.Facilities.Hirelings.Label'),\n                  )}\n                data-tooltip-direction=\"UP\"\n              >\n                {#if item.system.type.value === CONSTANTS.FACILITY_TYPE_SPECIAL && item.system.hirelings.max}\n                  {item.system.hirelings.value.length}/{item.system.hirelings\n                    .max}\n                {:else}\n                  \n                {/if}\n              </div>\n            </ItemTableCell>\n            <!-- Creatures -->\n            <ItemTableCell baseWidth={creaturesWidth}>\n              <div\n                onmouseover={(ev) =>\n                  showOccupantSummaryTooltip(\n                    ev,\n                    item.system.trade.creatures.value ?? [],\n                    localize('TIDY5E.Facilities.Creatures.Label'),\n                  )}\n                data-tooltip-direction=\"UP\"\n              >\n                {#if item.system.type.value === CONSTANTS.FACILITY_TYPE_SPECIAL && item.system.trade.creatures.max}\n                  {item.system.trade.creatures.value.length}/{item.system.trade\n                    .creatures.max}\n                {:else}\n                  \n                {/if}\n              </div>\n            </ItemTableCell>\n          {/snippet}\n        </ItemTableRow>\n      {/each}\n    {/snippet}\n  </ItemTable>\n</section>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { type ActivitySection } from 'src/types/types';\n  import type { Activity5e } from 'src/foundry/dnd5e.types';\n  import { Activities } from 'src/features/activities/activities';\n  import TidyTable, {\n    type TidyTableColumns,\n  } from 'src/components/table/TidyTable.svelte';\n  import TidyTableHeaderRow from 'src/components/table/TidyTableHeaderRow.svelte';\n  import TidyTableHeaderCell from 'src/components/table/TidyTableHeaderCell.svelte';\n  import TidyTableRow from 'src/components/table/TidyTableRow.svelte';\n  import TidyTableCell from 'src/components/table/TidyTableCell.svelte';\n  import ActivityUses from 'src/components/item-list/ActivityUses.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    section: ActivitySection;\n    visibleActivityUuidSubset: Set<string>;\n  }\n\n  let { section, visibleActivityUuidSubset }: Props = $props();\n\n  const gridTemplateColumns: TidyTableColumns = [\n    {\n      name: 'Name',\n      width: '1fr',\n    },\n    {\n      name: 'Item Source',\n      width: '10rem',\n    },\n    {\n      name: 'Uses',\n      width: '2.5rem',\n    },\n    {\n      name: 'Usage',\n      width: '5rem',\n    },\n    {\n      name: 'Mod/Save',\n      width: '3.5rem',\n    },\n  ];\n\n  const localize = FoundryAdapter.localize;\n\n  let context = $derived(getCharacterSheetContext());\n\n  let activityEntries = $derived(\n    section.activities.map((activity) => ({\n      activity,\n    })),\n  );\n\n  function activityHasUses(activity: Activity5e) {\n    return (activity.consumption?.targets ?? []).some(\n      (t: any) => (t.value ?? 0) > 0 && t.type === 'activityUses',\n    );\n  }\n</script>\n\n<TidyTable key={section.key} class=\"favorite-activities\" {gridTemplateColumns}>\n  {#snippet header()}\n    <TidyTableHeaderRow>\n      <TidyTableHeaderCell primary={true}>\n        {localize(section.label ?? 'DND5E.Effect')}\n      </TidyTableHeaderCell>\n      <TidyTableHeaderCell>\n        {localize('DOCUMENT.Item')}\n      </TidyTableHeaderCell>\n      <TidyTableHeaderCell>\n        <i class=\"fas fa-bolt\"></i>\n      </TidyTableHeaderCell>\n      <TidyTableHeaderCell>\n        {localize('DND5E.Usage')}\n      </TidyTableHeaderCell>\n      <TidyTableHeaderCell>\n        <i class=\"fas fa-wand-sparkles\"></i>\n        <i class=\"fas fa-shield\"></i>\n      </TidyTableHeaderCell>\n    </TidyTableHeaderRow>\n  {/snippet}\n  {#snippet body()}\n    {#each activityEntries as { activity } (activity.uuid)}\n      <TidyTableRow\n        rowClass=\"activity\"\n        rowAttributes={{\n          'data-activity-id': activity.id,\n          'data-configurable': Activities.isConfigurable(activity),\n          'data-item-id': activity.item.id,\n          'data-info-card': 'activity',\n          'data-info-card-entity-uuid': activity.uuid,\n          'data-context-menu': CONSTANTS.CONTEXT_MENU_TYPE_ACTIVITIES,\n        }}\n        onmousedown={(ev) => FoundryAdapter.editOnMiddleClick(ev, activity)}\n        hidden={visibleActivityUuidSubset !== null &&\n          !visibleActivityUuidSubset.has(activity.uuid)}\n      >\n        <TidyTableCell primary={true}>\n          <a\n            class=\"item-table-image-button\"\n            onclick={(event) => context.editable && activity.use({ event })}\n          >\n            <img src={activity.img} />\n            <i class=\"fa fa-dice-d20 roll-indicator\"></i>\n          </a>\n\n          <span\n            class=\"truncate\"\n            data-tidy-activity-name={activity.name}\n            data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_NAME}\n          >\n            {activity.name}\n          </span>\n        </TidyTableCell>\n        <TidyTableCell>\n          <a\n            class=\"activity-item-link truncate align-self-stretch align-content-center flex-1\"\n            class:highlight-on-hover={context.editable}\n            onclick={(ev) =>\n              context.editable && activity.item.sheet.render(true)}\n            title={activity.item.name}\n          >\n            {activity.item.name}\n          </a>\n        </TidyTableCell>\n        <TidyTableCell>\n          {@const hasActivityUses = activityHasUses(activity)}\n          {#if hasActivityUses}\n            <ActivityUses {activity}></ActivityUses>\n          {:else}\n            <span></span>\n          {/if}\n        </TidyTableCell>\n        <TidyTableCell>\n          {#if activity.activation?.type}\n            <span class=\"truncate\">\n              {activity.activationLabels?.activation ?? ''}\n            </span>\n          {/if}\n        </TidyTableCell>\n        <TidyTableCell>\n          {@const label = activity.labels.toHit\n            ? activity.labels.toHit\n            : activity.save?.ability && activity.save?.dc?.value\n              ? `${FoundryAdapter.getSaveAbilityAbbreviation(activity.save)} ${activity.save.dc.value}`.toLocaleUpperCase()\n              : ''}\n\n          <span class=\"truncate\" title={label}>\n            {label}\n          </span>\n        </TidyTableCell>\n      </TidyTableRow>\n    {/each}\n  {/snippet}\n</TidyTable>\n","<script lang=\"ts\">\n  import InventoryList from '../../actor/InventoryList.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import FavoriteFeaturesList from './FavoriteFeaturesList.svelte';\n  import FavoriteSpellsList from 'src/sheets/classic/character/parts/FavoriteSpellsList.svelte';\n  import { getContext } from 'svelte';\n  import { CONSTANTS } from 'src/constants';\n  import FavoriteEffectsList from './FavoriteEffectsList.svelte';\n  import { ItemVisibility } from 'src/features/sections/ItemVisibility';\n  import FavoriteFacilitiesList from './FavoriteFacilitiesList.svelte';\n  import FavoriteActivitiesList from './FavoriteActivitiesList.svelte';\n  import {\n    createSearchResultsState,\n    setSearchResultsContext,\n  } from 'src/features/search/search.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { FavoriteSection } from 'src/types/types';\n\n  interface Props {\n    searchCriteria?: string;\n    favorites: FavoriteSection[];\n  }\n\n  let { searchCriteria = '', favorites }: Props = $props();\n\n  let context = $derived(getCharacterSheetContext());\n\n  let tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  const searchResults = createSearchResultsState();\n  setSearchResultsContext(searchResults);\n\n  $effect(() => {\n    const sections = favorites.filter(\n      (x) =>\n        x.type !== CONSTANTS.FAVORITES_SECTION_TYPE_EFFECT &&\n        x.type !== CONSTANTS.FAVORITES_SECTION_TYPE_ACTIVITY,\n    );\n\n    searchResults.uuids = ItemVisibility.getItemsToShowAtDepth({\n      criteria: searchCriteria,\n      itemContext: context.itemContext,\n      sections: sections,\n      tabId: tabId,\n    });\n  });\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"flex-column small-gap\" data-tidy-favorites>\n  <!--  TODO: Sort favorites based on setting during data item preparation -->\n  {#each favorites as section}\n    {#if section.show}\n      {#if section.type === CONSTANTS.TAB_ACTOR_INVENTORY}\n        <InventoryList\n          {section}\n          primaryColumnName={localize(section.label)}\n          lockControls={true}\n          allowFavoriteIconNextToName={false}\n          includeWeightColumn={false}\n        />\n      {/if}\n      <!-- TODO: Cut a copy of the Favorite Features component and custom tailor it for the generic section -->\n      {#if section.type === CONSTANTS.FAVORITES_SECTION_TYPE_FEATURE || section.type === CONSTANTS.FAVORITES_SECTION_TYPE_GENERIC}\n        <FavoriteFeaturesList {section} />\n      {/if}\n      {#if section.type === CONSTANTS.FAVORITES_SECTION_TYPE_SPELLBOOK}\n        <FavoriteSpellsList {section} />\n      {/if}\n      {#if section.type === CONSTANTS.FAVORITES_SECTION_TYPE_EFFECT}\n        {@const visibleEffectIdSubset = FoundryAdapter.searchEffects(\n          searchCriteria,\n          section.effects.map((e) => e.effect),\n        )}\n        <FavoriteEffectsList {section} {visibleEffectIdSubset} />\n      {/if}\n      {#if section.type === CONSTANTS.FAVORITES_SECTION_TYPE_FACILITY}\n        <FavoriteFacilitiesList {section} />\n      {/if}\n      {#if section.type === CONSTANTS.FAVORITES_SECTION_TYPE_ACTIVITY}\n        {@const visibleActivityUuidSubset = FoundryAdapter.searchActivities(\n          searchCriteria,\n          section.activities,\n        )}\n        <FavoriteActivitiesList {section} {visibleActivityUuidSubset} />\n      {/if}\n    {/if}\n  {/each}\n</div>\n","import { TidyFlags } from 'src/api';\nimport type { Item5e } from 'src/types/item.types';\nimport { error } from 'src/utils/logging';\nimport type {\n  AttributeItemPinFlag,\n  AttributePinFlag,\n} from 'src/foundry/TidyFlags.types';\nimport type { Activity5e } from 'src/foundry/dnd5e.types';\nimport { CONSTANTS } from 'src/constants';\n\nexport class AttributePins {\n  static isPinnable(\n    doc: Item5e | Activity5e,\n    type: AttributePinFlag['type']\n  ): boolean {\n    return type === 'item'\n      ? !!doc.system.schema.fields.uses\n      : type === 'activity'\n      ? !!doc.schema.fields.uses\n      : false;\n  }\n\n  static isPinned(doc: any): boolean {\n    const flagPins = doc.actor ? TidyFlags.attributePins.get(doc.actor) : [];\n\n    const relativeUuid = this.getRelativeUUID(doc);\n\n    return flagPins.some((x) => x.id === relativeUuid);\n  }\n\n  static pin(doc: any, type: AttributePinFlag['type']) {\n    if (!doc.actor || this.isPinned(doc)) {\n      return;\n    }\n\n    const relativeUuid = this.getRelativeUUID(doc);\n\n    if (\n      relativeUuid.startsWith('.') &&\n      fromUuidSync(relativeUuid, { relative: doc.actor }) === null\n    ) {\n      // Assume that an ID starting with a \".\" is a relative ID.\n      error(`The item with id ${doc.id} is not owned by actor ${doc.actor.id}`);\n      return;\n    }\n\n    const flagPins = TidyFlags.attributePins.get(doc.actor);\n\n    let maxSort = 0;\n    let newPins = flagPins.map((p) => {\n      if (p.sort > maxSort) maxSort = p.sort;\n      return { ...p };\n    });\n\n    if (type === 'activity') {\n      newPins.push({\n        type: 'activity',\n        id: relativeUuid,\n        sort: maxSort + CONST.SORT_INTEGER_DENSITY,\n        resource: 'limited-uses',\n      });\n    } else if (type === 'item') {\n      newPins.push({\n        type: 'item',\n        id: relativeUuid,\n        sort: maxSort + CONST.SORT_INTEGER_DENSITY,\n        resource:\n          doc.type === CONSTANTS.ITEM_TYPE_CONSUMABLE\n            ? 'quantity'\n            : 'limited-uses',\n      });\n    }\n\n    newPins = this.preparePinsForForSaving(doc, newPins);\n\n    return TidyFlags.attributePins.set(doc.actor, newPins);\n  }\n\n  static unpin(doc: Item5e | Activity5e) {\n    if (!doc.actor || !this.isPinned(doc)) {\n      return;\n    }\n\n    const flagPins = TidyFlags.attributePins.get(doc.actor);\n\n    const relativeUuid = this.getRelativeUUID(doc);\n\n    let newPins = flagPins.filter((x) => x.id !== relativeUuid);\n\n    newPins = this.preparePinsForForSaving(doc, newPins);\n\n    return TidyFlags.attributePins.set(doc.actor, newPins);\n  }\n\n  static getRelativeUUID(doc: any) {\n    return doc.getRelativeUUID?.(doc.actor) ?? doc.relativeUUID;\n  }\n\n  static setItemResourceType(\n    item: Item5e,\n    resourceType: AttributeItemPinFlag['resource']\n  ) {\n    let pins = TidyFlags.attributePins.get(item.actor);\n\n    const relativeUuid = this.getRelativeUUID(item);\n\n    const pinToUpdate = pins.find((x) => x.id === relativeUuid);\n\n    if (pinToUpdate) {\n      pinToUpdate.resource = resourceType;\n    }\n\n    pins = this.preparePinsForForSaving(item, pins);\n\n    return TidyFlags.attributePins.set(item.actor, pins);\n  }\n\n  static setAlias(doc: Item5e, alias: string) {\n    let pins = TidyFlags.attributePins.get(doc.actor);\n\n    const relativeUuid = this.getRelativeUUID(doc);\n\n    const pinToUpdate = pins.find((x) => x.id === relativeUuid);\n\n    if (pinToUpdate) {\n      pinToUpdate.alias = alias;\n    }\n\n    pins = this.preparePinsForForSaving(doc, pins);\n\n    return TidyFlags.attributePins.set(doc.actor, pins);\n  }\n\n  static preparePinsForForSaving(pinnedDoc: any, pins: AttributePinFlag[]) {\n    return pins.filter(\n      (x) => !!fromUuidSync(x.id, { relative: pinnedDoc.actor })\n    );\n  }\n\n  static getResourceType(doc: any): string | undefined {\n    const relativeUuid = this.getRelativeUUID(doc);\n\n    return TidyFlags.attributePins\n      .get(doc.actor)\n      ?.find((x) => x.id === relativeUuid)?.resource;\n  }\n}\n","export class EventHelper {\n  static triggerContextMenu(\n    event: (MouseEvent | PointerEvent) & { currentTarget: HTMLElement },\n    targetSelector: string\n  ) {\n    event.preventDefault();\n    event.stopPropagation();\n    const { clientX, clientY } = event;\n    event.currentTarget.closest(targetSelector)?.dispatchEvent(\n      new PointerEvent('contextmenu', {\n        view: window,\n        bubbles: true,\n        cancelable: true,\n        clientX,\n        clientY,\n      })\n    );\n  }\n}\n","<script lang=\"ts\">\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import RechargeControl from 'src/components/item-list/controls/RechargeControl.svelte';\n  import ItemUseButton from 'src/components/item-list/ItemUseButton.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { AttributePins } from 'src/features/attribute-pins/AttributePins';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { AttributeItemPinContext } from 'src/types/types';\n  import { isNil } from 'src/utils/data';\n  import { EventHelper } from 'src/utils/events';\n  import { coalesce } from 'src/utils/formatting';\n\n  interface Props {\n    ctx: AttributeItemPinContext;\n  }\n\n  let { ctx }: Props = $props();\n\n  let { usesDocument, valueProp, spentProp, maxProp, value, maxText, uses } =\n    $derived.by(() => {\n      if (ctx.linkedUses) {\n        return {\n          usesDocument: ctx.linkedUses.doc,\n          maxProp: ctx.linkedUses.maxProp,\n          maxText: isNil(ctx.linkedUses.max, '')\n            ? ''\n            : ctx.linkedUses.max.toString(),\n          spentProp: ctx.linkedUses.spentProp,\n          uses: ctx.linkedUses,\n          value: ctx.linkedUses.value,\n          valueProp: ctx.linkedUses.valueProp,\n        };\n      }\n\n      const primaryActivity = ctx.document.system.activities?.contents[0];\n      const usePrimaryActivity =\n        ctx.document.system.uses.max === '' &&\n        !isNil(primaryActivity?.uses?.max, '');\n      const uses = usePrimaryActivity\n        ? primaryActivity.uses\n        : ctx.document.system.uses;\n\n      return {\n        usesDocument: usePrimaryActivity ? primaryActivity : ctx.document,\n        uses: uses,\n        value: (uses.max ?? 0) - uses.spent,\n        maxText: isNil(uses.max, '') ? '' : uses.max.toString(),\n        valueProp: usePrimaryActivity ? 'uses.value' : 'system.uses.value',\n        spentProp: usePrimaryActivity ? 'uses.spent' : 'system.uses.spent',\n        maxProp: usePrimaryActivity ? 'uses.max' : 'system.uses.max',\n      };\n    });\n\n  function saveValueChange(\n    ev: Event & { currentTarget: EventTarget & HTMLInputElement },\n  ): boolean {\n    FoundryAdapter.handleItemUsesChanged(\n      ev,\n      usesDocument,\n      valueProp,\n      spentProp,\n      maxProp,\n    );\n    return false;\n  }\n\n  function onDragStart(event: DragEvent) {\n    const dragData = ctx.document.toDragData?.();\n\n    if (dragData) {\n      event.dataTransfer?.setData('text/plain', JSON.stringify(dragData));\n    }\n  }\n\n  let context = $derived(getCharacterSheetContext());\n\n  let localize = FoundryAdapter.localize;\n</script>\n\n<div\n  class=\"attribute-pin\"\n  data-item-id={ctx.document.id}\n  data-info-card={'item'}\n  data-info-card-entity-uuid={ctx.document.uuid}\n  data-context-menu={CONSTANTS.CONTEXT_MENU_TYPE_ITEMS}\n  data-pin-id={ctx.id}\n  onmousedown={(ev) => FoundryAdapter.editOnMiddleClick(ev, ctx.document)}\n  draggable={true}\n  ondragstart={onDragStart}\n>\n  <div class=\"attribute-document-image\">\n    <ItemUseButton item={ctx.document} />\n  </div>\n  <div class=\"attribute-pin-details\">\n    <div class=\"attribute-pin-name-container\" title={ctx.document.name}>\n      {#if context.unlocked}\n        <TextInput\n          class=\"attribute-pin-name\"\n          document={ctx.document}\n          field=\"name\"\n          value={ctx.alias}\n          selectOnFocus={true}\n          placeholder={ctx.document.name}\n          onSaveChange={(ev) => {\n            AttributePins.setAlias(ctx.document, ev.currentTarget.value);\n            return false;\n          }}\n        />\n        {#if !isNil(ctx.alias?.trim(), '')}\n          <i class=\"fa-solid fa-pencil\"></i>\n        {/if}\n      {:else}\n        <div class=\"attribute-pin-name truncate\" title={ctx.document.name}>\n          {coalesce(ctx.alias, ctx.document.name)}\n        </div>\n      {/if}\n    </div>\n    <div class=\"attribute-counter {ctx.resource}\">\n      {#if ctx.resource === 'limited-uses' && ctx.document.isOnCooldown}\n        <RechargeControl document={ctx.document} field={spentProp} {uses} />\n      {:else if ctx.resource === 'limited-uses' && ctx.document.hasRecharge}\n        <span class=\"charged-text\">\n          {#if value > 1}\n            <span>{value}</span>\n          {/if}\n          <i class=\"fas fa-bolt\" title={localize('DND5E.Charged')}></i>\n        </span>\n      {:else if ctx.resource === 'limited-uses'}\n        <TextInput\n          document={usesDocument}\n          field={spentProp}\n          {value}\n          onSaveChange={(ev) => saveValueChange(ev)}\n          selectOnFocus={true}\n        />\n        <span class=\"divider\">/</span>\n        <span class=\"max\">{maxText}</span>\n      {:else if ctx.resource === 'quantity'}\n        <TextInput\n          document={ctx.document}\n          field={'system.quantity'}\n          value={ctx.document.system.quantity}\n          selectOnFocus={true}\n        />\n      {/if}\n    </div>\n  </div>\n  {#if context.unlocked}\n    <a\n      class=\"attribute-pins-menu highlight-on-hover\"\n      onclick={(ev) => EventHelper.triggerContextMenu(ev, '[data-item-id]')}\n    >\n      <i class=\"fas fa-ellipsis-vertical\"></i>\n    </a>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n\n  interface Props {\n    activity: any;\n    disabled?: boolean;\n    showDiceIconOnHover?: boolean;\n  }\n\n  let {\n    activity,\n    disabled = false,\n    showDiceIconOnHover = true,\n  }: Props = $props();\n</script>\n\n<a\n  class=\"item-use-button\"\n  onclick={(event) => !disabled && activity.use({ event })}\n>\n  <img\n    class=\"item-image\"\n    alt={activity.name}\n    src={activity.img}\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.GROUP_MEMBER_PORTRAIT}\n  />\n\n  {#if showDiceIconOnHover}\n    <i class=\"roll-indicator fa fa-dice-d20\"></i>\n  {/if}\n</a>\n","<script lang=\"ts\">\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import ActivityUseButton from 'src/components/item-list/ActivityUseButton.svelte';\n  import RechargeControl from 'src/components/item-list/controls/RechargeControl.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { AttributePins } from 'src/features/attribute-pins/AttributePins';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { AttributeActivityPinContext } from 'src/types/types';\n  import { isNil } from 'src/utils/data';\n  import { EventHelper } from 'src/utils/events';\n  import { coalesce } from 'src/utils/formatting';\n\n  interface Props {\n    ctx: AttributeActivityPinContext;\n  }\n\n  let { ctx }: Props = $props();\n\n  let { usesDocument, valueProp, spentProp, maxProp, value, maxText, uses } =\n    $derived.by(() => {\n      const uses = ctx.document.uses;\n\n      return {\n        usesDocument: ctx.document,\n        uses: uses,\n        value: (uses.max ?? 0) - uses.spent,\n        maxText: isNil(uses.max, '') ? '' : uses.max.toString(),\n        valueProp: 'uses.value',\n        spentProp: 'uses.spent',\n        maxProp: 'uses.max',\n      };\n    });\n\n  function saveValueChange(\n    ev: Event & { currentTarget: EventTarget & HTMLInputElement },\n  ): boolean {\n    FoundryAdapter.handleItemUsesChanged(\n      ev,\n      usesDocument,\n      valueProp,\n      spentProp,\n      maxProp,\n    );\n    return false;\n  }\n\n  function onDragStart(event: DragEvent) {\n    const dragData = ctx.document.toDragData?.();\n\n    if (dragData) {\n      event.dataTransfer?.setData('text/plain', JSON.stringify(dragData));\n    }\n  }\n\n  let context = $derived(getCharacterSheetContext());\n\n  let localize = FoundryAdapter.localize;\n</script>\n\n<div\n  class=\"attribute-pin\"\n  data-item-id={ctx.document.item.id}\n  data-activity-id={ctx.document.id}\n  data-context-menu={CONSTANTS.CONTEXT_MENU_TYPE_ACTIVITIES}\n  data-info-card={'activity'}\n  data-info-card-entity-uuid={ctx.document.uuid}\n  data-configurable=\"true\"\n  data-pin-id={ctx.id}\n  onmousedown={(ev) => FoundryAdapter.editOnMiddleClick(ev, ctx.document)}\n  draggable={true}\n  ondragstart={onDragStart}\n>\n  <div class=\"attribute-document-image\">\n    <ActivityUseButton activity={ctx.document} />\n  </div>\n  <div class=\"attribute-pin-details\">\n    <div\n      class=\"attribute-pin-name-container\"\n      title=\"{ctx.document.name} | {ctx.document.item.name}\"\n    >\n      {#if context.unlocked}\n        <TextInput\n          class=\"attribute-pin-name\"\n          document={ctx.document}\n          field=\"name\"\n          value={ctx.alias}\n          selectOnFocus={true}\n          placeholder={ctx.document.name}\n          onSaveChange={(ev) => {\n            AttributePins.setAlias(ctx.document, ev.currentTarget.value);\n            return false;\n          }}\n        />\n        {#if !isNil(ctx.alias?.trim(), '')}\n          <i class=\"fa-solid fa-pencil\"></i>\n        {/if}\n      {:else}\n        <div class=\"attribute-pin-name truncate\">\n          {coalesce(ctx.alias, ctx.document.name)}\n        </div>\n      {/if}\n    </div>\n    <div class=\"attribute-counter {ctx.resource}\">\n      {#if ctx.resource === 'limited-uses' && ctx.document.isOnCooldown}\n        <RechargeControl document={ctx.document} field={spentProp} {uses} />\n      {:else if ctx.resource === 'limited-uses' && ctx.document.hasRecharge}\n        <span class=\"charged-text\">\n          {#if value > 1}\n            <span>{value}</span>\n          {/if}\n          <i class=\"fas fa-bolt\" title={localize('DND5E.Charged')}></i>\n        </span>\n      {:else if ctx.resource === 'limited-uses'}\n        <TextInput\n          document={usesDocument}\n          field={spentProp}\n          {value}\n          onSaveChange={(ev) => saveValueChange(ev)}\n          selectOnFocus={true}\n        />\n        <span class=\"divider\">/</span>\n        <span class=\"max\">{maxText}</span>\n      {:else if ctx.resource === 'quantity'}\n        <TextInput\n          document={ctx.document}\n          field={'system.quantity'}\n          value={ctx.document.system.quantity}\n          selectOnFocus={true}\n        />\n      {/if}\n    </div>\n  </div>\n  {#if context.unlocked}\n    <a\n      class=\"attribute-pins-menu highlight-on-hover\"\n      onclick={(ev) => EventHelper.triggerContextMenu(ev, '[data-activity-id]')}\n    >\n      <i class=\"fas fa-ellipsis-vertical\"></i>\n    </a>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import SkillsList from '../../actor/SkillsList.svelte';\n  import Traits from '../../actor/traits/Traits.svelte';\n  import Favorites from '../parts/Favorites.svelte';\n  import { getContext } from 'svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import UtilityToolbar from 'src/components/utility-bar/UtilityToolbar.svelte';\n  import UtilityToolbarCommand from 'src/components/utility-bar/UtilityToolbarCommand.svelte';\n  import Search from 'src/components/utility-bar/Search.svelte';\n  import PinnedFilterToggles from 'src/components/filter/PinnedFilterToggles.svelte';\n  import { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\n  import FilterMenu from 'src/components/filter/FilterMenu.svelte';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n  import { SheetSections } from 'src/features/sections/SheetSections';\n  import { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import AttributeItemPin from '../parts/AttributeItemPin.svelte';\n  import AttributeActivityPin from '../parts/AttributeActivityPin.svelte';\n  import { error } from 'src/utils/logging';\n\n  let context = $derived(getCharacterSheetContext());\n\n  let tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  let searchCriteria: string = $state('');\n\n  let utilityBarCommands = $derived(\n    context.utilities[tabId]?.utilityToolbarCommands ?? [],\n  );\n\n  let favorites = $derived(\n    SheetSections.configureFavorites(\n      context.favorites,\n      context.actor,\n      tabId,\n      SheetPreferencesService.getByType(context.actor.type),\n      TidyFlags.sectionConfig.get(context.actor)?.[tabId],\n    ),\n  );\n\n  let localize = FoundryAdapter.localize;\n</script>\n\n<UtilityToolbar>\n  <Search bind:value={searchCriteria} />\n  <PinnedFilterToggles\n    filterGroupName={tabId}\n    filters={ItemFilterRuntime.getPinnedFiltersForTab(\n      context.filterPins,\n      context.filterData,\n      tabId,\n    )}\n  />\n  <FilterMenu {tabId}>\n    {#snippet beforeClearButton()}\n      <div class=\"filter-option-group\">\n        <label class=\"filter-option flex-row no-gap align-items-center\">\n          <input\n            type=\"checkbox\"\n            checked={TidyFlags.includeRitualsInCanCast.get(context.actor)}\n            onchange={(ev) =>\n              TidyFlags.includeRitualsInCanCast.set(\n                context.actor,\n                ev.currentTarget.checked,\n              )}\n          />\n          <span\n            >{localize(\n              'TIDY5E.ItemFilters.Options.IncludeRitualsInCanCast',\n            )}</span\n          >\n        </label>\n      </div>\n    {/snippet}\n  </FilterMenu>\n  {#each utilityBarCommands as command (command.title)}\n    <UtilityToolbarCommand\n      title={command.title}\n      iconClass={command.iconClass}\n      text={command.text}\n      visible={command.visible ?? true}\n      onExecute={(ev) => command.execute?.(ev)}\n      sections={favorites}\n    />\n  {/each}\n</UtilityToolbar>\n\n<div class=\"scroll-container\">\n  <div class=\"attributes-tab-contents\">\n    <section class=\"side-panel\">\n      <SkillsList\n        actor={context.actor}\n        toggleable={settings.value.toggleEmptyCharacterSkills}\n        expanded={!!TidyFlags.skillsExpanded.get(context.actor)}\n        toggleField={TidyFlags.skillsExpanded.prop}\n      />\n      {#if !settings.value.moveCharacterTraitsToRightOfSkills}\n        <Traits />\n      {/if}\n    </section>\n    <section class=\"main-panel\">\n      {#if context.attributePins.length}\n        <div class=\"attribute-pins\">\n          {#each context.attributePins as ctx (ctx.id)}\n            <svelte:boundary\n              onerror={(e) =>\n                error(\n                  'An error occurred while rendering an attribute pin',\n                  false,\n                  e,\n                )}\n            >\n              {#if ctx.type === 'item'}\n                <AttributeItemPin {ctx} />\n              {:else if ctx.type === 'activity'}\n                <AttributeActivityPin {ctx} />\n              {/if}\n            </svelte:boundary>\n          {/each}\n        </div>\n      {/if}\n      {#if settings.value.moveCharacterTraitsToRightOfSkills}\n        <Traits />\n      {/if}\n      <Favorites {favorites} {searchCriteria} />\n    </section>\n  </div>\n</div>\n\n<style lang=\"scss\">\n  .attributes-tab-contents {\n    display: flex;\n    flex-direction: row;\n    gap: 1.5rem;\n  }\n\n  .side-panel {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n    width: 15rem;\n  }\n\n  .main-panel {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n    flex: 1;\n    padding: 0;\n    height: auto;\n    overflow-x: auto;\n  }\n</style>\n","<script lang=\"ts\">\n  import { TidyHooks } from 'src/foundry/TidyHooks';\n  import { CONSTANTS } from 'src/constants';\n  import type { Actor5e } from 'src/types/types';\n  import { EventHelper } from 'src/utils/events';\n  import { getContext } from 'svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { ContextPrimitive } from 'src/features/reactivity/reactivity.types';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n  interface Props {\n    occupant: Actor5e | undefined;\n    uuid: string | undefined;\n    index: number;\n    type: string;\n    iconClass: string;\n    facilityId: string;\n    facilityName: string;\n    prop: string;\n  }\n\n  let {\n    occupant,\n    index,\n    type,\n    iconClass,\n    facilityId,\n    facilityName,\n    prop,\n    uuid,\n  }: Props = $props();\n\n  let context = $derived(getCharacterSheetContext());\n\n  function onOccupantClick(\n    event: (MouseEvent | PointerEvent) & { currentTarget: HTMLElement },\n  ) {\n    if (context.unlocked) {\n      EventHelper.triggerContextMenu(event, '[data-actor-uuid]');\n      return;\n    }\n    occupant.sheet.render(true);\n  }\n\n  async function onSlotClick(ev: Event) {\n    if (\n      !TidyHooks.tidy5eSheetsFacilityEmptyOccupantSlotClicked(\n        ev,\n        context.actor.items.get(facilityId),\n        type,\n        prop,\n      )\n    ) {\n      return;\n    }\n\n    const result = await dnd5e.applications.CompendiumBrowser.selectOne({\n      filters: {\n        locked: {\n          documentClass: 'Actor',\n          types: new Set(['character', 'npc', 'vehicle', 'group']),\n        },\n      },\n    });\n\n    if (result) {\n      context.actor.sheet._onDropActorAddToFacility(\n        context.actor.items.get(facilityId),\n        prop,\n        result,\n      );\n    }\n  }\n\n  let hoveredFacilityOccupant = getContext<ContextPrimitive<string>>(\n    CONSTANTS.SVELTE_CONTEXT.HOVERED_FACILITY_OCCUPANT,\n  );\n\n  let localize = FoundryAdapter.localize;\n</script>\n\n{#if uuid}\n  {@const imageTypeClassName = occupant?.token ? 'token' : 'portrait'}\n  {@const imageSrc =\n    imageTypeClassName == 'token' ? occupant?.token.img : occupant?.img}\n  {@const name = occupant ? occupant.name : localize('TIDY5E.BrokenLink')}\n\n  <li\n    class:highlight={hoveredFacilityOccupant.value ===\n      `${facilityId}-${index}-${uuid}`}\n    class:unlocked={context.unlocked}\n    class=\"slot occupant-slot {type} {imageTypeClassName} occupant-with-menu\"\n    data-actor-uuid={uuid}\n    data-tooltip={name}\n    data-facility-id={facilityId}\n    data-facility-name={facilityName}\n    data-prop={prop}\n    data-index={index}\n    data-context-menu={CONSTANTS.CONTEXT_MENU_TYPE_FACILITY_OCCUPANTS}\n    onmouseenter={() =>\n      (hoveredFacilityOccupant.value = `${facilityId}-${index}-${uuid}`)}\n    onmouseleave={() => (hoveredFacilityOccupant.value = '')}\n  >\n    <a onclick={(ev) => context.editable && onOccupantClick(ev)}>\n      {#if occupant}\n        <img src={imageSrc} alt={name} />\n      {:else}\n        <i class=\"fa-solid fa-link-slash broken-link-icon\"></i>\n      {/if}\n\n      {#if context.unlocked}\n        <i class=\"fa-solid fa-cog occupant-menu-icon\"></i>\n      {/if}\n    </a>\n  </li>\n{:else}\n  <li class=\"slot occupant-slot {type} empty\" data-index={index}>\n    <a onclick={(ev) => context.editable && onSlotClick(ev)}>\n      <i class={iconClass}></i>\n    </a>\n  </li>\n{/if}\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import type { ContextPrimitive } from 'src/features/reactivity/reactivity.types';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { Actor5e } from 'src/types/types';\n  import { EventHelper } from 'src/utils/events';\n  import { getContext } from 'svelte';\n\n  interface Props {\n    occupant: Actor5e | undefined;\n    type: string;\n    index: number;\n    prop: string;\n    facilityId: string;\n    facilityName: string;\n    uuid: string;\n  }\n\n  let {\n    occupant,\n    type,\n    index,\n    prop,\n    facilityId,\n    facilityName,\n    uuid,\n  }: Props = $props();\n\n  let context = $derived(getCharacterSheetContext());\n\n  let hoveredFacilityOccupant = getContext<ContextPrimitive<string>>(\n    CONSTANTS.SVELTE_CONTEXT.HOVERED_FACILITY_OCCUPANT,\n  );\n\n  function onRosterMemberClicked(\n    event: (MouseEvent | PointerEvent) & { currentTarget: HTMLElement },\n  ): any {\n    if (context.unlocked) {\n      EventHelper.triggerContextMenu(event, '[data-actor-uuid]');\n      return;\n    }\n    occupant.sheet.render(true);\n  }\n\n  const localize = FoundryAdapter.localize;\n\n  let name = $derived(occupant ? occupant.name : localize('TIDY5E.BrokenLink'));\n</script>\n\n<li\n  class=\"roster-member {type} occupant-with-menu\"\n  class:highlight={hoveredFacilityOccupant.value ===\n    `${facilityId}-${index}-${uuid}`}\n  class:unlocked={context.unlocked}\n  data-actor-uuid={uuid}\n  data-tooltip={localize('TIDY5E.Facilities.RosterMember.Label', {\n    actorName: name,\n    facilityName: facilityName,\n  })}\n  data-facility-id={facilityId}\n  data-facility-name={facilityName}\n  data-prop={prop}\n  data-index={index}\n  data-context-menu={CONSTANTS.CONTEXT_MENU_TYPE_FACILITY_OCCUPANTS}\n  onmouseenter={() =>\n    (hoveredFacilityOccupant.value = `${facilityId}-${index}-${uuid}`)}\n  onmouseleave={() => (hoveredFacilityOccupant.value = '')}\n>\n  <a onclick={(ev) => context.editable && onRosterMemberClicked(ev)}>\n    {#if occupant}\n      <img src={occupant.img} alt={name} />\n    {:else}\n      <i class=\"fa-solid fa-link-slash broken-link-icon\"></i>\n    {/if}\n    {#if context.unlocked}\n      <i class=\"fa-solid fa-cog occupant-menu-icon\"></i>\n    {/if}\n  </a>\n</li>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { ChosenFacilityContext } from 'src/types/types';\n  import { TidyHooks } from 'src/foundry/TidyHooks';\n  import type { Item5e } from 'src/types/item.types';\n  import FacilityOrderProgressMeter from './FacilityOrderProgressMeter.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    chosen: ChosenFacilityContext;\n  }\n\n  let { chosen }: Props = $props();\n\n  let context = $derived(getCharacterSheetContext());\n\n  const localize = FoundryAdapter.localize;\n\n  function onMouseEnterCraft(event: Event, item: Item5e) {\n    TidyHooks.tidy5eSheetsItemHoverOn(event, item);\n  }\n\n  function onMouseLeaveCraft(event: Event, item: Item5e) {\n    TidyHooks.tidy5eSheetsItemHoverOff(event, item);\n  }\n\n  async function editCraftingItem(itemUuid: string) {\n    const item = await fromUuidSync(itemUuid);\n    item.sheet.render(true);\n  }\n</script>\n\n{#if chosen.progress.max || chosen.executing}\n  <div class=\"sub-header\">\n    {localize('DND5E.FACILITY.FIELDS.order.label')}\n  </div>\n  <div class=\"craft-and-meter\">\n    {#if chosen.craft}\n      <a\n        onclick={() => context.editable && editCraftingItem(chosen.craft.uuid)}\n        data-info-card={'item'}\n        data-info-card-entity-uuid={chosen.craft.uuid}\n      >\n        <img\n          class=\"crafting-item\"\n          data-uuid={chosen.craft.uuid}\n          onmouseenter={(ev) => onMouseEnterCraft(ev, chosen.craft)}\n          onmouseleave={(ev) => onMouseLeaveCraft(ev, chosen.craft)}\n          src={chosen.craft.img}\n          alt={chosen.craft.name}\n        />\n      </a>\n    {/if}\n\n    <FacilityOrderProgressMeter {chosen}></FacilityOrderProgressMeter>\n  </div>\n{/if}\n","export function applyDropzoneClass(\n  node: HTMLElement,\n  dropzoneClass: string\n): any {\n  let dragCounter = 0;\n\n  node.addEventListener('dragenter', () => {\n    dragCounter++;\n    node.classList.add(dropzoneClass);\n  });\n\n  node.addEventListener('dragleave', () => {\n    dragCounter--;\n    if (dragCounter === 0) {\n      node.classList.remove(dropzoneClass);\n    }\n  });\n\n  node.addEventListener('drop', () => {\n    dragCounter = 0;\n    node.classList.remove(dropzoneClass);\n  });\n}\n","<script lang=\"ts\">\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { ChosenFacilityContext } from 'src/types/types';\n  import { setContext } from 'svelte';\n  import FacilityOccupant from 'src/sheets/classic/character/parts/FacilityOccupant.svelte';\n  import FacilityRosterOccupant from 'src/sheets/classic/character/parts/FacilityRosterOccupant.svelte';\n  import FacilityOrderProgressTracker from '../parts/FacilityOrderProgressTracker.svelte';\n  import SheetEditor from 'src/components/editor/SheetEditor.svelte';\n  import RerenderAfterFormSubmission from 'src/components/utility/RerenderAfterFormSubmission.svelte';\n  import { EventHelper } from 'src/utils/events';\n  import { isNil } from 'src/utils/data';\n  import type { Item5e } from 'src/types/item.types';\n  import { TidyHooks } from 'src/foundry/TidyHooks';\n  import { applyDropzoneClass } from 'src/events/drag-and-drop';\n  import InlineSvg from 'src/components/utility/InlineSvg.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { ContextPrimitive } from 'src/features/reactivity/reactivity.types';\n\n  let context = $derived(getCharacterSheetContext());\n\n  function onMouseEnterFacility(event: Event, item: Item5e) {\n    TidyHooks.tidy5eSheetsItemHoverOn(event, item);\n  }\n\n  function onMouseLeaveFacility(event: Event, item: Item5e) {\n    TidyHooks.tidy5eSheetsItemHoverOff(event, item);\n  }\n\n  let hoveredFacilityOccupant = $state<ContextPrimitive<string>>({\n    value: '',\n  });\n\n  setContext<ContextPrimitive<string>>(\n    CONSTANTS.SVELTE_CONTEXT.HOVERED_FACILITY_OCCUPANT,\n    hoveredFacilityOccupant,\n  );\n\n  let hasDefenders = $derived(\n    context.facilities.special.chosen.some((c: ChosenFacilityContext) =>\n      c.defenders.some((d) => !!d.uuid),\n    ),\n  );\n\n  let hasHirelings = $derived(\n    context.facilities.special.chosen.some((c: ChosenFacilityContext) =>\n      c.hirelings.some((d) => !!d.uuid),\n    ),\n  );\n\n  let hasCreatures = $derived(\n    context.facilities.special.chosen.some((c: ChosenFacilityContext) =>\n      c.creatures.some((d) => !!d.uuid),\n    ),\n  );\n\n  // TODO: Extract and share between this and advancements\n  const basicSvgFilePathRegex = /\\.svg$/i;\n\n  function isSvg(iconPath: string) {\n    return basicSvgFilePathRegex.test(iconPath?.trim());\n  }\n\n  async function addFacility(ev: Event, type: string) {\n    if (!TidyHooks.tidy5eSheetsAddFacilityClicked(ev, context.actor, type)) {\n      return;\n    }\n\n    const otherType =\n      type === CONSTANTS.FACILITY_TYPE_BASIC\n        ? CONSTANTS.FACILITY_TYPE_SPECIAL\n        : CONSTANTS.FACILITY_TYPE_BASIC;\n\n    const result = await dnd5e.applications.CompendiumBrowser.selectOne({\n      filters: {\n        locked: {\n          types: new Set(['facility']),\n          additional: {\n            type: { [type]: 1, [otherType]: -1 },\n            level: { max: context.actor.system.details.level },\n          },\n        },\n      },\n    });\n\n    if (result) {\n      context.actor.sheet._onDropItemCreate(await fromUuid(result));\n    }\n  }\n\n  function useFacility(event: MouseEvent, chosen: ChosenFacilityContext) {\n    const facility = context.actor.items.get(chosen.id);\n    return facility?.use({ legacy: false, chooseActivity: true, event });\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"bastion-container scroll-container\">\n  <!-- Name -->\n\n  <section class=\"name\">\n    {#if context.unlocked}\n      <TextInput\n        document={context.actor}\n        field=\"system.bastion.name\"\n        value={context.system.bastion.name}\n        selectOnFocus={true}\n        placeholder={localize('DND5E.Bastion.Label')}\n      />\n    {:else if !isNil(context.system.bastion.name, '')}\n      <div class=\"document-name\">{context.system.bastion.name}</div>\n    {/if}\n  </section>\n\n  <!-- Facilities -->\n\n  <section class=\"facility-panels\">\n    <!-- Special Facilities -->\n\n    <section class=\"facilities special\">\n      <h3>\n        <i class=\"fas fa-building-columns\"></i>\n        {localize('DND5E.FACILITY.Types.Special.Label.other')}\n        <span class=\"counter\">\n          <span class=\"value\">{context.facilities.special.value}</span> /\n          <span class=\"max\">{context.facilities.special.max}</span>\n        </span>\n      </h3>\n      <ul class=\"facility-list\">\n        {#each context.facilities.special.chosen as chosen}\n          {@const bgImg = chosen.img.includes(\n            'systems/dnd5e/icons/svg/items/facility.svg',\n          )\n            ? '../../modules/tidy5e-sheet/images/facility-default-background.webp'\n            : chosen.img}\n\n          {@const img = !chosen.disabled\n            ? chosen.img\n            : context.config.facilities.orders.repair.icon}\n\n          <li\n            class=\"facility special\"\n            data-item-id={chosen.id}\n            data-facility-id={chosen.id}\n            class:disabled={chosen.disabled}\n            class:no-events={chosen.disabled && !FoundryAdapter.userIsGm()}\n            class:building={chosen.building}\n            data-context-menu={CONSTANTS.CONTEXT_MENU_TYPE_ITEMS}\n            style=\"--underlay: url('{bgImg}')\"\n            data-info-card={'item'}\n            data-info-card-entity-uuid={chosen.facility.uuid}\n          >\n            <div class=\"facility-header\">\n              <a\n                class=\"facility-header-details\"\n                onmouseenter={(ev) => onMouseEnterFacility(ev, chosen.facility)}\n                onmouseleave={(ev) => onMouseLeaveFacility(ev, chosen.facility)}\n                onmousedown={(ev) =>\n                  FoundryAdapter.editOnMiddleClick(ev, chosen.facility)}\n                onclick={(ev) => context.editable && useFacility(ev, chosen)}\n              >\n                <!-- <img class=\"facility-image\" src={img} alt={chosen.name} /> -->\n\n                {#if isSvg(img)}\n                  <InlineSvg class=\"facility-image\" svgUrl={img} />\n                {:else}\n                  <img class=\"facility-image\" src={img} alt={chosen.name} />\n                {/if}\n\n                <div class=\"title-and-subtitle\">\n                  <span class=\"title\"> {chosen.name} </span>\n                  <span class=\"subtitle\">\n                    {@html chosen.subtitle}\n                  </span>\n                </div>\n              </a>\n              <a\n                class=\"facility-menu highlight-on-hover\"\n                onclick={(ev) =>\n                  EventHelper.triggerContextMenu(ev, '[data-item-id]')}\n              >\n                <i class=\"fas fa-ellipsis-vertical\"></i>\n              </a>\n            </div>\n\n            {#if chosen.hirelings.length}\n              <div\n                class=\"facility-occupants\"\n                data-prop=\"system.hirelings\"\n                use:applyDropzoneClass={'occupant-dropzone'}\n              >\n                <div class=\"sub-header\">\n                  {localize('DND5E.FACILITY.FIELDS.hirelings.max.label')}\n                </div>\n                <ul class=\"slots hirelings\">\n                  {#each chosen.hirelings as { actor, uuid }, index}\n                    <FacilityOccupant\n                      occupant={actor}\n                      {index}\n                      type=\"hireling\"\n                      iconClass=\"far fa-user\"\n                      facilityId={chosen.id}\n                      facilityName={chosen.name}\n                      prop=\"system.hirelings\"\n                      {uuid}\n                    ></FacilityOccupant>\n                  {/each}\n                </ul>\n              </div>\n            {/if}\n            {#if chosen.defenders.length}\n              <div\n                class=\"facility-occupants\"\n                data-prop=\"system.defenders\"\n                use:applyDropzoneClass={'occupant-dropzone'}\n              >\n                <div class=\"sub-header\">\n                  {localize('DND5E.FACILITY.FIELDS.defenders.max.label')}\n                </div>\n                <ul class=\"slots facility-occupants defenders\">\n                  {#each chosen.defenders as { actor, uuid }, index}\n                    <FacilityOccupant\n                      occupant={actor}\n                      {index}\n                      type=\"defender\"\n                      iconClass=\"far fa-shield\"\n                      facilityId={chosen.id}\n                      facilityName={chosen.name}\n                      prop=\"system.defenders\"\n                      {uuid}\n                    ></FacilityOccupant>\n                  {/each}\n                </ul>\n              </div>\n            {/if}\n            {#if chosen.creatures.length}\n              <div\n                class=\"facility-occupants\"\n                data-prop=\"system.trade.creatures\"\n                use:applyDropzoneClass={'occupant-dropzone'}\n              >\n                <div class=\"sub-header\">\n                  {localize('TIDY5E.Facilities.Creatures.Label')}\n                </div>\n                <ul class=\"slots creatures\">\n                  {#each chosen.creatures as { actor, uuid }, index}\n                    <FacilityOccupant\n                      occupant={actor}\n                      {index}\n                      type=\"creature\"\n                      iconClass=\"far fa-horse-head\"\n                      facilityId={chosen.id}\n                      facilityName={chosen.name}\n                      prop=\"system.trade.creatures\"\n                      {uuid}\n                    ></FacilityOccupant>\n                  {/each}\n                </ul>\n              </div>\n            {/if}\n\n            <FacilityOrderProgressTracker {chosen} />\n          </li>\n        {/each}\n        {#each context.facilities.special.available as available}\n          <li class=\"facility empty\">\n            <a\n              class=\"highlight-on-hover\"\n              onclick={(ev) =>\n                context.editable &&\n                addFacility(ev, CONSTANTS.FACILITY_TYPE_SPECIAL)}\n            >\n              <i class=\"fas fa-building-columns\"></i>\n              {localize(available.label)}\n            </a>\n          </li>\n        {/each}\n      </ul>\n    </section>\n\n    <!-- Basic Facilities -->\n\n    <section class=\"facilities basic\">\n      <h3>\n        <i class=\"fas fa-chess-rook\"></i>\n        {localize('DND5E.FACILITY.Types.Basic.Label.other')}\n      </h3>\n      <ul class=\"facility-list\">\n        {#each context.facilities.basic.chosen as chosen}\n          {@const bgImg = chosen.img.includes(\n            'systems/dnd5e/icons/svg/items/facility.svg',\n          )\n            ? '../../modules/tidy5e-sheet/images/facility-default-background.webp'\n            : chosen.img}\n\n          {@const img = !chosen.disabled\n            ? chosen.img\n            : context.config.facilities.orders.repair.icon}\n\n          <li\n            class=\"facility basic\"\n            data-item-id={chosen.id}\n            data-facility-id={chosen.id}\n            class:disabled={chosen.disabled}\n            class:no-events={chosen.disabled && !FoundryAdapter.userIsGm()}\n            class:building={chosen.building}\n            data-context-menu={CONSTANTS.CONTEXT_MENU_TYPE_ITEMS}\n            style=\"--underlay: url('{bgImg}')\"\n            data-info-card={'item'}\n            data-info-card-entity-uuid={chosen.facility.uuid}\n          >\n            <div class=\"facility-header\">\n              <a\n                class=\"facility-header-details\"\n                onmouseenter={(ev) => onMouseEnterFacility(ev, chosen.facility)}\n                onmouseleave={(ev) => onMouseLeaveFacility(ev, chosen.facility)}\n                onmousedown={(ev) =>\n                  FoundryAdapter.editOnMiddleClick(ev, chosen.facility)}\n                onclick={(ev) => context.editable && useFacility(ev, chosen)}\n              >\n                {#if isSvg(img)}\n                  <InlineSvg class=\"facility-image\" svgUrl={img} />\n                {:else}\n                  <img class=\"facility-image\" src={img} alt={chosen.name} />\n                {/if}\n\n                <div class=\"title-and-subtitle\">\n                  <span class=\"title\">{chosen.name}</span>\n                  <span class=\"subtitle\">\n                    {@html chosen.subtitle}\n                  </span>\n                </div>\n              </a>\n              <a\n                class=\"facility-menu highlight-on-hover\"\n                onclick={(ev) =>\n                  EventHelper.triggerContextMenu(ev, '[data-item-id]')}\n              >\n                <i class=\"fas fa-ellipsis-vertical\"></i>\n              </a>\n            </div>\n\n            <FacilityOrderProgressTracker {chosen} />\n          </li>\n        {/each}\n        {#each context.facilities.basic.available as available}\n          <div class=\"facility empty\">\n            <a\n              class=\"highlight-on-hover\"\n              onclick={(ev) =>\n                context.editable &&\n                addFacility(ev, CONSTANTS.FACILITY_TYPE_BASIC)}\n            >\n              {#if available.label.includes('build')}\n                <i class=\"fa-solid fa-trowel\"></i>\n              {:else}\n                <i class=\"fas fa-chess-rook\"></i>\n              {/if}\n              {localize(available.label)}\n            </a>\n          </div>\n        {/each}\n      </ul>\n    </section>\n  </section>\n\n  <!-- Defender Roster -->\n\n  {#if hasDefenders}\n    <section class=\"roster defenders\">\n      <h3>\n        <i class=\"fa-solid fa-shield\"></i>\n        {localize('TIDY5E.Facilities.Defenders.Label')}\n      </h3>\n      <ul class=\"roster-list\">\n        {#each context.facilities.special.chosen as chosen}\n          {#each chosen.defenders as { actor, uuid }, index}\n            {#if uuid}\n              <FacilityRosterOccupant\n                occupant={actor}\n                type=\"defender\"\n                {index}\n                prop=\"system.defenders\"\n                facilityId={chosen.id}\n                facilityName={chosen.name}\n                {uuid}\n              />\n            {/if}\n          {/each}\n        {/each}\n      </ul>\n    </section>\n  {/if}\n\n  <!-- Hireling Roster -->\n\n  {#if hasHirelings}\n    <section class=\"roster hirelings\">\n      <h3>\n        <i class=\"fa-solid fa-users\"></i>\n        {localize('TIDY5E.Facilities.Hirelings.Label')}\n      </h3>\n      <ul class=\"roster-list\">\n        {#each context.facilities.special.chosen as chosen}\n          {#each chosen.hirelings as { actor, uuid }, index}\n            {#if uuid}\n              <FacilityRosterOccupant\n                occupant={actor}\n                type=\"hireling\"\n                {index}\n                prop=\"system.hirelings\"\n                facilityId={chosen.id}\n                facilityName={chosen.name}\n                {uuid}\n              />\n            {/if}\n          {/each}\n        {/each}\n      </ul>\n    </section>\n  {/if}\n\n  <!-- Creatures Roster -->\n\n  {#if hasCreatures}\n    <section class=\"roster creatures\">\n      <h3>\n        <i class=\"fa-solid fa-horse-head\"></i>\n        {localize('TIDY5E.Facilities.Creatures.Label')}\n      </h3>\n      <ul class=\"roster-list\">\n        {#each context.facilities.special.chosen as chosen}\n          {#each chosen.creatures as { actor, uuid }, index}\n            {#if uuid}\n              <FacilityRosterOccupant\n                occupant={actor}\n                type=\"creature\"\n                {index}\n                prop=\"system.trade.creatures\"\n                facilityId={chosen.id}\n                facilityName={chosen.name}\n                {uuid}\n              />\n            {/if}\n          {/each}\n        {/each}\n      </ul>\n    </section>\n  {/if}\n\n  <!-- Description -->\n\n  <RerenderAfterFormSubmission\n    andOnValueChange={context.bastion.description ?? ''}\n  >\n    <section class=\"description\" use:context.activateEditors>\n      <h3><i class=\"fa-solid fa-books\"></i> Description</h3>\n      <SheetEditor\n        content={context.bastion.description}\n        target=\"system.bastion.description\"\n        editable={context.editable}\n      />\n    </section>\n  </RerenderAfterFormSubmission>\n</div>\n","<script lang=\"ts\">\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { Item5e } from 'src/types/item.types';\n  import { type DropdownListOption } from 'src/types/types';\n\n  let context = $derived(getCharacterSheetContext());\n\n  let allClasses: DropdownListOption[] = $derived([\n    { text: 'DND5E.Spellbook', value: '' },\n    ...Object.entries(context.actor.spellcastingClasses).map(\n      ([key, value]: [string, Item5e]) => ({\n        text: value.name,\n        value: key,\n      }),\n    ),\n  ]);\n\n  const localize = FoundryAdapter.localize;\n\n  let selectedClassFilter = $derived(\n    TidyFlags.classFilter.get(context.actor) ?? '',\n  );\n</script>\n\n<select\n  class=\"class-filter\"\n  onchange={(event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    context.actor.update({\n      [TidyFlags.classFilter.prop]: event.currentTarget.value,\n    });\n  }}\n  disabled={!context.editable}\n  data-tidy-field={TidyFlags.classFilter.prop}\n>\n  {#each allClasses as option}\n    <option\n      value={option.value}\n      selected={option.value === (selectedClassFilter ?? undefined)}\n      >{localize(option.text)}</option\n    >\n  {/each}\n</select>\n\n<style lang=\"scss\">\n  .class-filter {\n    text-overflow: ellipsis;\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { ItemLayoutMode, SpellbookSection } from 'src/types/types';\n  import SpellbookList from '../../../../components/spellbook/SpellbookList.svelte';\n  import SpellbookFooter from '../../../../components/spellbook/SpellbookFooter.svelte';\n  import SpellbookGrid from '../../../../components/spellbook/SpellbookGrid.svelte';\n  import SpellbookClassFilter from '../../../../components/spellbook/SpellbookClassFilter.svelte';\n  import { getContext } from 'svelte';\n  import NoSpells from 'src/sheets/classic/actor/NoSpells.svelte';\n  import Notice from '../../../../components/notice/Notice.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import UtilityToolbar from 'src/components/utility-bar/UtilityToolbar.svelte';\n  import Search from 'src/components/utility-bar/Search.svelte';\n  import UtilityToolbarCommand from 'src/components/utility-bar/UtilityToolbarCommand.svelte';\n  import FilterMenu from 'src/components/filter/FilterMenu.svelte';\n  import PinnedFilterToggles from 'src/components/filter/PinnedFilterToggles.svelte';\n  import { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import { SheetSections } from 'src/features/sections/SheetSections';\n  import { ItemVisibility } from 'src/features/sections/ItemVisibility';\n  import ButtonMenu from 'src/components/button-menu/ButtonMenu.svelte';\n  import ButtonMenuCommand from 'src/components/button-menu/ButtonMenuCommand.svelte';\n  import SpellSourceClassAssignmentsFormApplication from 'src/applications/spell-source-class-assignments/SpellSourceClassAssignmentsFormApplication.svelte';\n  import {\n    createSearchResultsState,\n    setSearchResultsContext,\n  } from 'src/features/search/search.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getCharacterSheetContext());\n\n  let tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  const searchResults = createSearchResultsState();\n  setSearchResultsContext(searchResults);\n\n  const localize = FoundryAdapter.localize;\n\n  let searchCriteria: string = $state('');\n\n  let layoutMode: ItemLayoutMode = $derived(\n    TidyFlags.spellbookGrid.get(context.actor) ? 'grid' : 'list',\n  );\n\n  let spellbook = $derived(\n    SheetSections.configureSpellbook(\n      context.actor,\n      tabId,\n      context.spellbook,\n      TidyFlags.classFilter.get(context.actor) ?? '',\n    ),\n  );\n\n  $effect(() => {\n    searchResults.uuids = ItemVisibility.getItemsToShowAtDepth({\n      criteria: searchCriteria,\n      itemContext: context.itemContext,\n      sections: spellbook,\n      tabId: tabId,\n    });\n  });\n\n  let noSpellLevels = $derived(!context.spellbook.length);\n  let noSpells = $derived(\n    spellbook.reduce(\n      (count: number, section: SpellbookSection) =>\n        count + section.spells.length,\n      0,\n    ) === 0,\n  );\n  let utilityBarCommands = $derived(\n    context.utilities[tabId]?.utilityToolbarCommands ?? [],\n  );\n</script>\n\n<UtilityToolbar>\n  <Search bind:value={searchCriteria} />\n  {#if settings.value.useMulticlassSpellbookFilter}\n    <div class=\"spellbook-class-filter\">\n      <SpellbookClassFilter />\n    </div>\n  {/if}\n  <PinnedFilterToggles\n    filterGroupName={tabId}\n    filters={ItemFilterRuntime.getPinnedFiltersForTab(\n      context.filterPins,\n      context.filterData,\n      tabId,\n    )}\n  />\n  <FilterMenu {tabId}>\n    {#snippet beforeClearButton()}\n      <div class=\"filter-option-group\">\n        <label\n          class=\"filter-option flex-row no-gap align-items-center\"\n        >\n          <input\n            type=\"checkbox\"\n            checked={TidyFlags.includeRitualsInCanCast.get(context.actor)}\n            onchange={(ev) =>\n              TidyFlags.includeRitualsInCanCast.set(\n                context.actor,\n                ev.currentTarget.checked,\n              )}\n          />\n          <span\n            >{localize('TIDY5E.ItemFilters.Options.IncludeRitualsInCanCast')}</span\n          >\n        </label>\n      </div>\n    {/snippet}\n  </FilterMenu>\n  <ButtonMenu\n    iconClass=\"ra ra-fairy-wand\"\n    buttonStyle=\"transparent-inline-icon\"\n    position=\"bottom\"\n    anchor=\"right\"\n    title={localize('TIDY5E.Utilities.Tools')}\n    menuElement=\"div\"\n  >\n    <ButtonMenuCommand\n      onMenuClick={() => {\n        new SpellSourceClassAssignmentsFormApplication(context.actor).render(\n          true,\n        );\n      }}\n      iconClass=\"fas fa-list-check\"\n      disabled={!context.editable}\n    >\n      {localize('TIDY5E.Utilities.AssignSpellsToClasses')}\n    </ButtonMenuCommand>\n  </ButtonMenu>\n  {#each utilityBarCommands as command (command.title)}\n    <UtilityToolbarCommand\n      title={command.title}\n      iconClass={command.iconClass}\n      text={command.text}\n      visible={command.visible ?? true}\n      onExecute={(ev) => command.execute?.(ev)}\n      sections={spellbook}\n    />\n  {/each}\n</UtilityToolbar>\n<div\n  class=\"scroll-container flex-column small-gap\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEMS_CONTAINER}\n>\n  {#if noSpellLevels}\n    <NoSpells editable={context.unlocked} />\n  {:else}\n    {#each spellbook as section (section.key)}\n      {#if section.show}\n        {@const visibleItemCount = ItemVisibility.countVisibleItems(\n          section.spells,\n          searchResults.uuids,\n        )}\n\n        {#if (searchCriteria.trim() === '' && context.unlocked) || visibleItemCount > 0 || !!section.slots}\n          {#if layoutMode === 'list'}\n            <SpellbookList {section} />\n          {:else}\n            <SpellbookGrid {section} />\n          {/if}\n        {/if}\n      {/if}\n    {/each}\n  {/if}\n\n  {#if noSpells && !context.unlocked}\n    <Notice>{localize('TIDY5E.EmptySection')}</Notice>\n  {/if}\n</div>\n\n<SpellbookFooter />\n\n<style lang=\"scss\">\n  .spellbook-class-filter {\n    margin-left: 0.25rem;\n    margin-right: 0.25rem;\n    align-self: center;\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import {\n    type CharacterFeatureSection,\n    type RenderableClassicControl,\n  } from 'src/types/types';\n  import ItemEditControl from '../../../../components/item-list/controls/ItemEditControl.svelte';\n  import ItemDeleteControl from '../../../../components/item-list/controls/ItemDeleteControl.svelte';\n  import ItemTable from '../../../../components/item-list/v1/ItemTable.svelte';\n  import ItemTableHeaderRow from '../../../../components/item-list/v1/ItemTableHeaderRow.svelte';\n  import ItemTableRow from '../../../../components/item-list/v1/ItemTableRow.svelte';\n  import ItemTableFooter from '../../../../components/item-list/ItemTableFooter.svelte';\n  import ItemTableCell from '../../../../components/item-list/v1/ItemTableCell.svelte';\n  import ItemTableColumn from '../../../../components/item-list/v1/ItemTableColumn.svelte';\n  import ItemUseButton from '../../../../components/item-list/ItemUseButton.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import ItemName from '../../../../components/item-list/ItemName.svelte';\n  import ItemUses from '../../../../components/item-list/ItemUses.svelte';\n  import InlineFavoriteIcon from '../../../../components/item-list/InlineFavoriteIcon.svelte';\n  import ItemFavoriteControl from '../../../../components/item-list/controls/ItemFavoriteControl.svelte';\n  import { getContext } from 'svelte';\n  import Notice from '../../../../components/notice/Notice.svelte';\n  import RechargeControl from 'src/components/item-list/controls/RechargeControl.svelte';\n  import ActionFilterOverrideControl from 'src/components/item-list/controls/ActionFilterOverrideControl.svelte';\n  import { declareLocation } from 'src/types/location-awareness.types';\n  import UtilityToolbar from 'src/components/utility-bar/UtilityToolbar.svelte';\n  import Search from 'src/components/utility-bar/Search.svelte';\n  import UtilityToolbarCommand from 'src/components/utility-bar/UtilityToolbarCommand.svelte';\n  import FilterMenu from 'src/components/filter/FilterMenu.svelte';\n  import PinnedFilterToggles from 'src/components/filter/PinnedFilterToggles.svelte';\n  import { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\n  import type { Item5e } from 'src/types/item.types';\n  import ClassicControls from 'src/sheets/classic/shared/ClassicControls.svelte';\n  import LevelUpDropdown from 'src/sheets/classic/actor/LevelUpDropdown.svelte';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import { SheetSections } from 'src/features/sections/SheetSections';\n  import { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\n  import { ItemVisibility } from 'src/features/sections/ItemVisibility';\n  import { ItemUtils } from 'src/utils/ItemUtils';\n  import type { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\n  import {\n    createSearchResultsState,\n    setSearchResultsContext,\n  } from 'src/features/search/search.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getCharacterSheetContext());\n\n  let tabId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.TAB_ID);\n\n  let inlineToggleService = getContext<InlineToggleService>(\n    CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n  );\n\n  const localize = FoundryAdapter.localize;\n\n  const searchResults = createSearchResultsState();\n  setSearchResultsContext(searchResults);\n\n  let searchCriteria: string = $state('');\n\n  declareLocation('features');\n\n  let controls: RenderableClassicControl<{ item: Item5e }>[] = $derived.by(\n    () => {\n      let result: RenderableClassicControl<{ item: Item5e }>[] = [\n        {\n          component: ItemFavoriteControl,\n          props: ({ item }) => ({ item }),\n        },\n        {\n          component: ItemEditControl,\n          props: ({ item }) => ({ item }),\n        },\n      ];\n\n      if (context.unlocked) {\n        result.push({\n          component: ItemDeleteControl,\n          props: ({ item }) => ({ item }),\n        });\n      }\n\n      if (context.useActionsFeature) {\n        result.push({\n          component: ActionFilterOverrideControl,\n          props: ({ item }) => ({ item }),\n        });\n      }\n\n      return result;\n    },\n  );\n\n  let classicControlsIconWidth = 1.25;\n\n  let features = $derived(\n    SheetSections.configureFeatures(\n      context.features,\n      context,\n      tabId,\n      SheetPreferencesService.getByType(context.actor.type),\n      TidyFlags.sectionConfig.get(context.actor)?.[tabId],\n    ),\n  );\n  let noFeatures = $derived(\n    features.some(\n      (section: CharacterFeatureSection) => section.items.length > 0,\n    ) === false,\n  );\n\n  $effect(() => {\n    searchResults.uuids = ItemVisibility.getItemsToShowAtDepth({\n      criteria: searchCriteria,\n      itemContext: context.itemContext,\n      sections: features,\n      tabId: tabId,\n    });\n  });\n\n  let utilityBarCommands = $derived(\n    context.utilities[tabId]?.utilityToolbarCommands ?? [],\n  );\n\n  let classicControlsColumnWidth = $derived(\n    `${classicControlsIconWidth * controls.length}rem`,\n  );\n</script>\n\n<UtilityToolbar>\n  <Search bind:value={searchCriteria} />\n  <PinnedFilterToggles\n    filterGroupName={tabId}\n    filters={ItemFilterRuntime.getPinnedFiltersForTab(\n      context.filterPins,\n      context.filterData,\n      tabId,\n    )}\n  />\n  <FilterMenu {tabId} />\n  {#each utilityBarCommands as command (command.title)}\n    <UtilityToolbarCommand\n      title={command.title}\n      iconClass={command.iconClass}\n      text={command.text}\n      visible={command.visible ?? true}\n      onExecute={(ev) => command.execute?.(ev)}\n      sections={features}\n    />\n  {/each}\n</UtilityToolbar>\n<div\n  class=\"scroll-container flex-column small-gap\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEMS_CONTAINER}\n>\n  {#if noFeatures && !context.unlocked}\n    <Notice>{localize('TIDY5E.EmptySection')}</Notice>\n  {:else}\n    {#each features as section (section.key)}\n      {#if section.show}\n        {@const itemEntries = section.items.map((item) => ({\n          item,\n          ctx: context.itemContext[item.id],\n        }))}\n        {@const visibleItemCount = ItemVisibility.countVisibleItems(\n          section.items,\n          searchResults.uuids,\n        )}\n\n        {#if (searchCriteria.trim() === '' && context.unlocked) || visibleItemCount > 0}\n          <ItemTable\n            key={section.key}\n            data-custom-section={section.custom ? true : null}\n          >\n            {#snippet header()}\n              <ItemTableHeaderRow>\n                <ItemTableColumn primary={true}>\n                  {localize(section.label)}\n                </ItemTableColumn>\n                {#if section.showUsesColumn}\n                  <ItemTableColumn baseWidth=\"3.125rem\">\n                    {localize('DND5E.Uses')}\n                  </ItemTableColumn>\n                {/if}\n                {#if section.showUsagesColumn}\n                  <ItemTableColumn baseWidth=\"7.5rem\">\n                    {localize('DND5E.Usage')}\n                  </ItemTableColumn>\n                {/if}\n                {#if section.showLevelColumn}\n                  <ItemTableColumn baseWidth=\"7.5rem\">\n                    {localize('DND5E.Level')}\n                  </ItemTableColumn>\n                {/if}\n                {#if section.showFeatureTypeColumn}\n                  <ItemTableColumn baseWidth=\"7.5rem\">\n                    {localize('DND5E.Type')}\n                  </ItemTableColumn>\n                {/if}\n                {#if section.showRequirementsColumn}\n                  <ItemTableColumn baseWidth=\"7.5rem\">\n                    {localize('DND5E.Requirements')}\n                  </ItemTableColumn>\n                {/if}\n                {#if context.editable && context.useClassicControls}\n                  <ItemTableColumn baseWidth={classicControlsColumnWidth} />\n                {/if}\n              </ItemTableHeaderRow>\n            {/snippet}\n            {#snippet body()}\n              {#each itemEntries as { item, ctx } (item.id)}\n                <ItemTableRow\n                  {item}\n                  onMouseDown={(event) =>\n                    FoundryAdapter.editOnMiddleClick(event, item)}\n                  contextMenu={{\n                    type: CONSTANTS.CONTEXT_MENU_TYPE_ITEMS,\n                    uuid: item.uuid,\n                  }}\n                  hidden={!searchResults.show(item.uuid)}\n                >\n                  {#snippet children({ toggleSummary })}\n                    <ItemTableCell primary={true}>\n                      <ItemUseButton disabled={!context.editable} {item} />\n                      <ItemName\n                        onToggle={() => toggleSummary(context.actor)}\n                        hasChildren={false}\n                        {item}\n                      >\n                        {#if ctx.parent}&rdsh;{/if}\n                        {#if !section.isClass && item.type === 'subclass'}\n                          <i class=\"fa-solid fa-link-slash align-self-center\"\n                          ></i>\n                        {/if}\n                        <span\n                          data-tidy-item-name={item.name}\n                          data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_NAME}\n                          class=\"truncate flex-1\">{item.name}</span\n                        >\n                        {#if item.isOriginalClass}<i\n                            title={localize('DND5E.ClassOriginal')}\n                            class=\"fas fa-crown primary-accent-color\"\n                          ></i>{/if}\n                      </ItemName>\n                      <div class=\"primary-cell-extras\">\n                        {#if !context.useClassicControls && 'favoriteId' in ctx && !!ctx.favoriteId}\n                          <InlineFavoriteIcon />\n                        {/if}\n                      </div>\n                    </ItemTableCell>\n                    {#if section.showUsesColumn}\n                      <ItemTableCell baseWidth=\"3.125rem\">\n                        {#if item.isOnCooldown}\n                          <RechargeControl\n                            document={item}\n                            field={'system.uses.spent'}\n                            uses={item.system.uses}\n                          />\n                        {:else if item.hasRecharge}\n                          {@const remaining =\n                            item.system.uses.max - item.system.uses.spent}\n                          {#if remaining > 1}\n                            <span>{remaining}</span>\n                          {/if}\n                          <i\n                            class=\"fas fa-bolt\"\n                            title={localize('DND5E.Charged')}\n                          ></i>\n                        {:else if ctx?.hasUses}\n                          <ItemUses {item} />\n                        {:else}\n                          <span class=\"text-body-tertiary\">&mdash;</span>\n                        {/if}\n                      </ItemTableCell>\n                    {/if}\n                    {#if section.showUsagesColumn}\n                      <ItemTableCell baseWidth=\"7.5rem\">\n                        {#if ItemUtils.hasActivationType(item)}\n                          {item.labels?.activation ?? ''}\n                        {/if}\n                      </ItemTableCell>\n                    {/if}\n                    {#if section.showLevelColumn}\n                      <ItemTableCell baseWidth=\"7.5rem\">\n                        {#if item.type === 'class'}\n                          <LevelUpDropdown\n                            availableLevels={ctx?.availableLevels}\n                            {item}\n                            disabled={!context.editable ||\n                              context.lockLevelSelector}\n                          />\n                        {/if}\n                      </ItemTableCell>\n                    {/if}\n                    {#if section.showFeatureTypeColumn}\n                      {#if item.system.type}\n                        <!-- For now, unlinked subclasses fall into the Passive Features table, and this code causes the tab to crash because item.sytem.type.value triggers an error. -->\n                        {@const label =\n                          CONFIG.DND5E.featureTypes[item.system.type.value]\n                            ?.label ?? item.system.type.value}\n                        <ItemTableCell baseWidth=\"7.5rem\">\n                          <span\n                            class=\"truncate\"\n                            title={item.system.type.value ?? ''}\n                            >{label ?? ''}</span\n                          >\n                        </ItemTableCell>\n                      {:else}\n                        <!-- For broken/unlinked subclasses -->\n                        <ItemTableCell baseWidth=\"7.5rem\"></ItemTableCell>\n                      {/if}\n                    {/if}\n                    {#if section.showRequirementsColumn}\n                      <ItemTableCell baseWidth=\"7.5rem\">\n                        <span\n                          class=\"truncate\"\n                          title={item.system.requirements ?? ''}\n                          >{item.system.requirements ?? ''}</span\n                        >\n                      </ItemTableCell>\n                    {/if}\n                    {#if context.editable && context.useClassicControls}\n                      <ItemTableCell baseWidth={classicControlsColumnWidth}>\n                        <ClassicControls {controls} params={{ item: item }} />\n                      </ItemTableCell>\n                    {/if}\n                  {/snippet}\n                </ItemTableRow>\n              {/each}\n              {#if context.unlocked}\n                <ItemTableFooter\n                  {section}\n                  actor={context.actor}\n                  isItem={true}\n                />\n              {/if}\n            {/snippet}\n          </ItemTable>\n        {/if}\n      {/if}\n    {/each}\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import ItemControl from './ItemControl.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { ActiveEffectContext, Actor5e } from 'src/types/types';\n\n  interface Props {\n    effect: ActiveEffectContext;\n    actor: Actor5e;\n  }\n\n  let { effect, actor }: Props = $props();\n\n  let active = $derived(\n    FoundryAdapter.isActiveEffectContextFavorited(effect, actor),\n  );\n  let title = $derived(\n    FoundryAdapter.localize(\n      active ? 'TIDY5E.RemoveFavorite' : 'TIDY5E.AddFavorite',\n    ),\n  );\n</script>\n\n<ItemControl\n  iconCssClass=\"fas fa-bookmark\"\n  {active}\n  {title}\n  onclick={() => {\n    const actor = effect.source.actor ?? effect.source;\n    const document = FoundryAdapter.getEffect({\n      document: actor,\n      effectId: effect.id,\n      parentId: effect.parentId,\n    });\n    FoundryAdapter.toggleFavoriteEffect(document);\n  }}\n/>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import {\n    type ActorSheetContextV1,\n    type RenderableClassicControl,\n  } from 'src/types/types';\n  import ItemTable from '../../../../components/item-list/v1/ItemTable.svelte';\n  import ItemTableHeaderRow from '../../../../components/item-list/v1/ItemTableHeaderRow.svelte';\n  import ItemTableColumn from '../../../../components/item-list/v1/ItemTableColumn.svelte';\n  import ItemTableFooter from '../../../../components/item-list/ItemTableFooter.svelte';\n  import ItemImage from '../../../../components/item-list/ItemImage.svelte';\n  import ItemTableCell from '../../../../components/item-list/v1/ItemTableCell.svelte';\n  import ItemControl from '../../../../components/item-list/controls/ItemControl.svelte';\n  import Notice from 'src/components/notice/Notice.svelte';\n  import { declareLocation } from 'src/types/location-awareness.types';\n  import ActorConditions from '../../actor/ActorConditions.svelte';\n  import ClassicControls from 'src/sheets/classic/shared/ClassicControls.svelte';\n  import ActorEffectToggleControl from 'src/components/item-list/controls/ActorEffectToggleControl.svelte';\n  import EffectFavoriteControl from 'src/components/item-list/controls/EffectFavoriteControl.svelte';\n  import InlineFavoriteIcon from 'src/components/item-list/InlineFavoriteIcon.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import EffectTableRow from 'src/components/item-list/v1/EffectTableRow.svelte';\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  const localize = FoundryAdapter.localize;\n\n  let effectSections = $derived(Object.values<any>(context.effects));\n\n  let noEffects = $derived(\n    effectSections.some((section: any) => section.effects.length > 0) === false,\n  );\n\n  declareLocation('effects');\n\n  let controls: RenderableClassicControl<{ effect: any }>[] = $derived.by(\n    () => {\n      let result: RenderableClassicControl<{ effect: any }>[] = [];\n      result.push(\n        {\n          component: ActorEffectToggleControl,\n          props: ({ effect }) => ({\n            effect: effect,\n          }),\n        },\n        {\n          component: EffectFavoriteControl,\n          props: ({ effect }) => ({\n            effect: effect,\n            actor: context.actor,\n          }),\n        },\n        {\n          component: ItemControl,\n          props: ({ effect }) => ({\n            onclick: () =>\n              FoundryAdapter.getEffect({\n                document: context.actor,\n                effectId: effect.id,\n                parentId: effect.parentId,\n              }).sheet.render(true),\n            title: localize('DND5E.EffectEdit'),\n            iconCssClass: 'fas fa-edit',\n          }),\n        },\n      );\n\n      if (context.unlocked) {\n        result.push({\n          component: ItemControl,\n          props: ({ effect }) => ({\n            onclick: () =>\n              FoundryAdapter.getEffect({\n                document: context.actor,\n                effectId: effect.id,\n                parentId: effect.parentId,\n              }).deleteDialog(),\n            title: localize('DND5E.EffectDelete'),\n            iconCssClass: 'fas fa-trash',\n          }),\n        });\n      }\n\n      return result;\n    },\n  );\n\n  let classicControlsIconWidth = 1.25;\n\n  let classicControlsColumnWidth = $derived(\n    `${classicControlsIconWidth * controls.length}rem`,\n  );\n</script>\n\n<div class=\"scroll-container flex-column small-gap\">\n  {#if !context.allowEffectsManagement && context.unlocked}\n    <Notice>{localize('TIDY5E.GMOnlyEdit')}</Notice>\n  {/if}\n\n  {#if noEffects && !context.unlocked && context.allowEffectsManagement}\n    <Notice>{localize('TIDY5E.EmptySection')}</Notice>\n  {:else}\n    {#each effectSections as section}\n      {#if !section.hidden}\n        {#if (context.unlocked && context.allowEffectsManagement) || section.effects.length > 0}\n          <ItemTable key={section.label}>\n            {#snippet header()}\n              <ItemTableHeaderRow>\n                <ItemTableColumn primary={true}>\n                  {localize(section.label)}\n                </ItemTableColumn>\n                <ItemTableColumn baseWidth=\"12.5rem\">\n                  {localize('DND5E.SOURCE.FIELDS.source.label')}\n                </ItemTableColumn>\n                <ItemTableColumn baseWidth=\"7.5rem\">\n                  {localize('DND5E.Duration')}\n                </ItemTableColumn>\n                {#if context.editable && context.useClassicControls && context.allowEffectsManagement}\n                  <ItemTableColumn baseWidth={classicControlsColumnWidth} />\n                {/if}\n              </ItemTableHeaderRow>\n            {/snippet}\n            {#snippet body()}\n              {#each section.effects as effectContext}\n                <EffectTableRow\n                  activeEffect={effectContext}\n                  attributes={{\n                    'data-info-card': 'effect',\n                    'data-info-card-entity-uuid': effectContext.uuid,\n                  }}\n                >\n                  {#snippet children({ toggleSummary })}\n                    <ItemTableCell\n                      primary={true}\n                      attributes={{\n                        'data-tidy-effect-name-container': true,\n                        'data-effect-id': effectContext.id,\n                      }}\n                    >\n                      <ItemImage src={effectContext.img} />\n                      <a\n                        onclick={(ev) => toggleSummary()}\n                        class=\"truncate flex-row align-items-center flex-1\"\n                      >\n                        <span\n                          class=\"align-self-center truncate flex-1\"\n                          data-tidy-effect-name={effectContext.name}\n                          title={effectContext.name}\n                        >\n                          {effectContext.name}\n                        </span>\n                      </a>\n                      <div class=\"primary-cell-extras\">\n                        {#if FoundryAdapter.isActiveEffectContextFavorited(effectContext, context.actor) && !context.useClassicControls}\n                          <InlineFavoriteIcon />\n                        {/if}\n                      </div>\n                    </ItemTableCell>\n                    <ItemTableCell baseWidth=\"12.5rem\">\n                      <span\n                        class=\"truncate\"\n                        title={effectContext.source?.name ?? ''}\n                        >{effectContext.source?.name ?? ''}</span\n                      >\n                    </ItemTableCell>\n                    <ItemTableCell baseWidth=\"7.5rem\">\n                      <span\n                        class=\"truncate\"\n                        title={effectContext.duration?.label ?? ''}\n                        >{effectContext.duration?.label ?? ''}</span\n                      >\n                    </ItemTableCell>\n                    {#if context.editable && context.useClassicControls && context.allowEffectsManagement}\n                      <ItemTableCell baseWidth={classicControlsColumnWidth}>\n                        <ClassicControls\n                          {controls}\n                          params={{ effect: effectContext }}\n                        />\n                      </ItemTableCell>\n                    {/if}\n                  {/snippet}\n                </EffectTableRow>\n              {/each}\n              {#if context.unlocked && context.allowEffectsManagement}\n                <ItemTableFooter\n                  actor={context.actor}\n                  {section}\n                  create={() =>\n                    FoundryAdapter.addEffect(section.type, context.actor)}\n                  isItem={false}\n                />\n              {/if}\n            {/snippet}\n          </ItemTable>\n        {/if}\n      {/if}\n    {/each}\n  {/if}\n  {#if context.conditions}\n    <ActorConditions />\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import SheetEditor from 'src/components/editor/SheetEditor.svelte';\n  import ContentEditableFormField from '../../../../components/inputs/ContentEditableFormField.svelte';\n  import RerenderAfterFormSubmission from '../../../../components/utility/RerenderAfterFormSubmission.svelte';\n  import SheetEditorV2 from 'src/components/editor/SheetEditorV2.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getCharacterSheetContext());\n\n  const localize = FoundryAdapter.localize;\n\n  type SystemBioField = { field: string; value: string; text: string };\n\n  let bioFields: SystemBioField[] = $derived([\n    {\n      field: 'system.details.gender',\n      value: context.system.details.gender,\n      text: 'DND5E.Gender',\n    },\n    {\n      field: 'system.details.age',\n      value: context.system.details.age,\n      text: 'DND5E.Age',\n    },\n    {\n      field: 'system.details.height',\n      value: context.system.details.height,\n      text: 'DND5E.Height',\n    },\n    {\n      field: 'system.details.weight',\n      value: context.system.details.weight,\n      text: 'DND5E.Weight',\n    },\n    {\n      field: 'system.details.eyes',\n      value: context.system.details.eyes,\n      text: 'DND5E.Eyes',\n    },\n    {\n      field: 'system.details.skin',\n      value: context.system.details.skin,\n      text: 'DND5E.Skin',\n    },\n    {\n      field: 'system.details.hair',\n      value: context.system.details.hair,\n      text: 'DND5E.Hair',\n    },\n    {\n      field: 'system.details.faith',\n      value: context.system.details.faith,\n      text: 'DND5E.Faith',\n    },\n  ]);\n\n  let editing = $state(false);\n  let contentToEdit: string = $state('');\n  let enrichedText: string = $state('');\n  let fieldToEdit: string = $state('');\n\n  async function stopEditing() {\n    await context.actor.sheet.submit();\n    editing = false;\n  }\n\n  function edit(value: string, enriched: string, field: string) {\n    contentToEdit = value;\n    fieldToEdit = field;\n    enrichedText = enriched;\n    editing = true;\n  }\n</script>\n\n<div class=\"scroll-container\">\n  {#if editing}\n    {#key contentToEdit}\n      <article class=\"editor-container flex-column full-height singleton\">\n        <SheetEditorV2\n          enriched={enrichedText}\n          content={contentToEdit}\n          field={fieldToEdit}\n          editorOptions={{\n            editable: context.editable,\n            toggled: false,\n          }}\n          documentUuid={context.actor.uuid}\n          onSave={() => stopEditing()}\n          manageSecrets={context.actor.isOwner}\n        />\n      </article>\n    {/key}\n  {/if}\n  <div class=\"notes-container\" class:hidden={editing}>\n    <div\n      class=\"top-notes note-entries\"\n      class:limited={context.showLimitedSheet}\n    >\n      <article>\n        <ul class=\"character-details\">\n          {#each bioFields as bioField (bioField.field)}\n            <li>\n              <span>{localize(bioField.text)}:</span>\n              <ContentEditableFormField\n                selectOnFocus={true}\n                element=\"span\"\n                editable={context.editable && !context.lockSensitiveFields}\n                document={context.actor}\n                field={bioField.field}\n                value={bioField.value ?? ''}\n                cssClass=\"detail-input\"\n              />\n            </li>\n          {/each}\n        </ul>\n      </article>\n    </div>\n    <div\n      class=\"left-notes note-entries hide-editor-edit\"\n      class:limited={context.showLimitedSheet}\n    >\n      {@render biopage(\n        'DND5E.PersonalityTraits',\n        context.system.details.trait,\n        context.traitEnrichedHtml,\n        'system.details.trait',\n      )}\n\n      {@render biopage(\n        'DND5E.Ideals',\n        context.system.details.ideal,\n        context.idealEnrichedHtml,\n        'system.details.ideal',\n      )}\n\n      {@render biopage(\n        'DND5E.Bonds',\n        context.system.details.bond,\n        context.bondEnrichedHtml,\n        'system.details.bond',\n      )}\n\n      {@render biopage(\n        'DND5E.Flaws',\n        context.system.details.flaw,\n        context.flawEnrichedHtml,\n        'system.details.flaw',\n      )}\n    </div>\n\n    <div\n      class=\"right-notes note-entries hide-editor-edit\"\n      class:limited={context.showLimitedSheet}\n    >\n      <RerenderAfterFormSubmission\n        andOnValueChange={context.system.details.appearance}\n      >\n        <article class=\"appearance-notes\" use:context.activateEditors>\n          <div\n            class=\"section-titles biopage flex-row justify-content-space-between\"\n          >\n            <span>\n              {localize('DND5E.Appearance')}\n            </span>\n            <a\n              class=\"icon-button\"\n              onclick={(ev) =>\n                context.editable &&\n                edit(\n                  context.system.details.appearance,\n                  context.appearanceEnrichedHtml,\n                  'system.details.appearance',\n                )}\n            >\n              <i class=\"fa-solid fa-feather\"></i>\n            </a>\n          </div>\n          <SheetEditor\n            content={context.appearanceEnrichedHtml}\n            target=\"system.details.appearance\"\n            editable={context.editable}\n          />\n        </article>\n      </RerenderAfterFormSubmission>\n      <RerenderAfterFormSubmission\n        andOnValueChange={context.system.details.biography.value}\n      >\n        <article class=\"biography-notes\" use:context.activateEditors>\n          <div class=\"section-titles flex-row justify-content-space-between\">\n            <span>\n              {localize('DND5E.Background')}/{localize('DND5E.Biography')}\n            </span>\n            <a\n              class=\"icon-button\"\n              onclick={(ev) =>\n                context.editable &&\n                edit(\n                  context.system.details.biography.value,\n                  context.biographyEnrichedHtml,\n                  'system.details.biography.value',\n                )}\n            >\n              <i class=\"fa-solid fa-feather\"></i>\n            </a>\n          </div>\n          <SheetEditor\n            content={context.biographyEnrichedHtml}\n            target=\"system.details.biography.value\"\n            editable={context.editable}\n          />\n        </article>\n      </RerenderAfterFormSubmission>\n    </div>\n  </div>\n</div>\n\n{#snippet biopage(\n  label: string,\n  value: string,\n  content: string,\n  target: string,\n)}\n  <RerenderAfterFormSubmission andOnValueChange={value ?? ''}>\n    <article use:context.activateEditors>\n      <div\n        class=\"section-titles biopage flex-row justify-content-space-between\"\n      >\n        <span>{localize(label)}</span>\n        <a\n          class=\"icon-button\"\n          onclick={(ev) => context.editable && edit(value, content, target)}\n        >\n          <i class=\"fa-solid fa-feather\"></i>\n        </a>\n      </div>\n      <SheetEditor {content} {target} editable={context.editable} />\n    </article>\n  </RerenderAfterFormSubmission>\n{/snippet}\n\n<style lang=\"scss\">\n  .notes-container {\n    display: flex;\n    flex: 1;\n    flex-direction: column;\n    height: 100%;\n    gap: 0.5rem;\n  }\n\n  .notes-container {\n    display: grid;\n    grid-template-areas:\n      'top    top'\n      'left   right';\n    grid-template-columns: 21.5rem 1fr;\n    grid-template-rows: auto 1fr;\n    min-height: 31.25rem;\n  }\n\n  .top-notes {\n    grid-area: top;\n  }\n\n  .left-notes {\n    grid-area: left;\n  }\n\n  .right-notes {\n    grid-area: right;\n  }\n\n  .left-notes,\n  .right-notes {\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n    gap: 0.5rem;\n    > * {\n      flex: 1;\n      overflow: auto;\n    }\n  }\n\n  .top-notes {\n    width: 100%;\n\n    .character-details {\n      margin: 0;\n      padding: 0;\n      display: flex;\n      gap: 0.25rem;\n      flex-wrap: wrap;\n    }\n\n    li {\n      display: flex;\n      flex: 0 0 calc(100% / 3 - 0.25rem);\n\n      :global(span) {\n        flex: 1;\n        margin: 0 0.5rem 0 0.25rem;\n      }\n\n      :global(span:first-child) {\n        flex: 0 0 0.0625rem;\n        font-weight: 600;\n        margin: 0;\n      }\n    }\n  }\n\n  .character-details :global(.detail-input) {\n    flex: 1;\n    margin: 0 0.5rem 0 0.25rem;\n  }\n\n  .singleton :global(.editor.prosemirror) {\n    flex: 1;\n  }\n</style>\n","import type {\n  CharacterSheetContext,\n  CustomContent,\n  Tab,\n} from 'src/types/types';\nimport CharacterAttributesTab from 'src/sheets/classic/character/tabs/CharacterAttributesTab.svelte';\nimport CharacterBastionTab from 'src/sheets/classic/character/tabs/CharacterBastionTab.svelte';\nimport ActorInventoryTab from 'src/sheets/classic/actor/tabs/ActorInventoryTab.svelte';\nimport CharacterSpellbookTab from 'src/sheets/classic/character/tabs/CharacterSpellbookTab.svelte';\nimport CharacterFeaturesTab from 'src/sheets/classic/character/tabs/CharacterFeaturesTab.svelte';\nimport CharacterEffectsTab from 'src/sheets/classic/character/tabs/CharacterEffectsTab.svelte';\nimport CharacterBiographyTab from 'src/sheets/classic/character/tabs/CharacterBiographyTab.svelte';\nimport ActorJournalTab from 'src/sheets/classic/actor/tabs/ActorJournalTab.svelte';\nimport ActorActionsTab from 'src/sheets/classic/actor/tabs/ActorActionsTab.svelte';\nimport type { RegisteredContent, RegisteredTab } from './types';\nimport { CONSTANTS } from 'src/constants';\nimport { debug, error, warn } from 'src/utils/logging';\nimport { TabManager } from './tab/TabManager';\nimport type { ActorTabRegistrationOptions } from 'src/api/api.types';\nimport { CustomContentManager } from './content/CustomContentManager';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\nclass CharacterSheetRuntime {\n  private _content = $state<RegisteredContent<CharacterSheetContext>[]>([]);\n  private _tabs = $state<RegisteredTab<CharacterSheetContext>[]>([\n    {\n      title: 'TIDY5E.Actions.TabName',\n      content: {\n        component: ActorActionsTab,\n        type: 'svelte',\n      },\n      id: CONSTANTS.TAB_ACTOR_ACTIONS,\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_CHARACTER_ATTRIBUTES,\n      title: 'DND5E.Attributes',\n      content: {\n        component: CharacterAttributesTab,\n        type: 'svelte',\n      },\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_ACTOR_INVENTORY,\n      title: 'DND5E.Inventory',\n      content: {\n        component: ActorInventoryTab,\n        type: 'svelte',\n        getProps() {\n          return {\n            tabId: CONSTANTS.TAB_ACTOR_INVENTORY,\n          };\n        },\n      },\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_ACTOR_SPELLBOOK,\n      title: 'DND5E.Spellbook',\n      content: {\n        component: CharacterSpellbookTab,\n        type: 'svelte',\n      },\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_CHARACTER_FEATURES,\n      title: 'DND5E.Features',\n      content: {\n        component: CharacterFeaturesTab,\n        type: 'svelte',\n      },\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_CHARACTER_EFFECTS,\n      title: 'DND5E.Effects',\n      content: {\n        component: CharacterEffectsTab,\n        type: 'svelte',\n      },\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_CHARACTER_BIOGRAPHY,\n      title: 'DND5E.Biography',\n      content: {\n        component: CharacterBiographyTab,\n        type: 'svelte',\n      },\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_CHARACTER_JOURNAL,\n      title: 'TIDY5E.JournalTabName',\n      content: {\n        component: ActorJournalTab,\n        type: 'svelte',\n      },\n      enabled: (context) => context.owner,\n      layout: 'classic',\n    },\n    {\n      id: CONSTANTS.TAB_CHARACTER_BASTION,\n      title: 'DND5E.Bastion.Label',\n      content: {\n        component: CharacterBastionTab,\n        type: 'svelte',\n      },\n      enabled: (context) => {\n        const { enabled } = FoundryAdapter.getSystemSetting<{\n          enabled: boolean;\n        }>(CONSTANTS.SYSTEM_SETTING_BASTION_CONFIGURATION);\n        const { basic, special } = CONFIG.DND5E.facilities.advancement;\n        const threshold = Math.min(\n          ...Object.keys(basic).map(Number),\n          ...Object.keys(special).map(Number)\n        );\n\n        return context.actor.system.details.level >= threshold && enabled;\n      },\n      layout: 'classic',\n    },\n  ]);\n  tabMap = $derived(\n    this._tabs.reduce<Map<string, RegisteredTab<CharacterSheetContext>>>(\n      (map, curr) => {\n        map.set(curr.id, curr);\n        return map;\n      },\n      new Map<string, RegisteredTab<CharacterSheetContext>>()\n    )\n  );\n\n  async getContent(context: CharacterSheetContext): Promise<CustomContent[]> {\n    return await CustomContentManager.prepareContentForRender(\n      context,\n      this._content\n    );\n  }\n\n  async getTabs(context: CharacterSheetContext): Promise<Tab[]> {\n    return await TabManager.prepareTabsForRender(context, this._tabs);\n  }\n\n  getAllRegisteredTabs(): RegisteredTab<CharacterSheetContext>[] {\n    return [...this._tabs];\n  }\n\n  registerContent(registeredContent: RegisteredContent<CharacterSheetContext>) {\n    this._content.push(registeredContent);\n  }\n\n  registerTab(\n    tab: RegisteredTab<CharacterSheetContext>,\n    options?: ActorTabRegistrationOptions\n  ) {\n    const tabExists = this._tabs.some((t) => t.id === tab.id);\n\n    if (tabExists && !options?.overrideExisting) {\n      warn(`Tab with id ${tab.id} already exists.`);\n      return;\n    }\n\n    if (tabExists && options?.overrideExisting) {\n      const index = this._tabs.findIndex((t) => t.id === tab.id);\n      if (index >= 0) {\n        this._tabs.splice(index, 1);\n      }\n    }\n\n    this._tabs.push(tab);\n  }\n\n  getTabTitle(tabId: string) {\n    try {\n      let tabTitle = this._tabs.find((t) => t.id === tabId)?.title;\n      if (typeof tabTitle === 'function') {\n        tabTitle = tabTitle();\n      }\n      return tabTitle ? FoundryAdapter.localize(tabTitle) : tabId;\n    } catch (e) {\n      error('An error occurred while searching for a tab title.', false, e);\n      debug('Tab title error troubleshooting information', { tabId });\n    }\n  }\n}\n\nconst singleton = new CharacterSheetRuntime();\n\nexport default singleton;\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getContext } from 'svelte';\n  import { SettingsProvider } from 'src/settings/settings.svelte';\n  import type { WorldSettingsContext } from '../WorldSettings.types';\n  import { CONSTANTS } from 'src/constants';\n  import type { GlobalCustomSectionsetting as GlobalCustomSectionSetting } from 'src/settings/settings.types';\n  import CharacterSheetRuntime from 'src/runtime/CharacterSheetRuntime.svelte';\n  import { error } from 'src/utils/logging';\n  import type { RegisteredTab } from 'src/runtime/types';\n  import NpcSheetRuntime from 'src/runtime/NpcSheetRuntime.svelte';\n  import GroupSheetRuntime from 'src/runtime/GroupSheetRuntime.svelte';\n  import HorizontalLineSeparator from 'src/components/layout/HorizontalLineSeparator.svelte';\n\n  const context = getContext<WorldSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n\n  const appId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.APP_ID);\n\n  function createNewSection(): GlobalCustomSectionSetting {\n    return {\n      section: '',\n      showWhenEmpty: false,\n      showWhenEmptyFilters: {},\n    };\n  }\n\n  function removeSection(section: GlobalCustomSectionSetting) {\n    context.settings.globalCustomSections =\n      context.settings.globalCustomSections.filter((x) => x !== section);\n  }\n\n  const localize = FoundryAdapter.localize;\n\n  type TabFilterOption = { id: string; title: string };\n\n  type SheetFilterOption = {\n    type: string;\n    label: string;\n    tabs: TabFilterOption[];\n  };\n\n  let sheetTypes: SheetFilterOption[] = [\n    {\n      type: CONSTANTS.SHEET_TYPE_CHARACTER,\n      label: localize('TYPES.Actor.character'),\n      tabs: mapTabs(CharacterSheetRuntime.tabMap, [\n        CONSTANTS.TAB_ACTOR_INVENTORY,\n        CONSTANTS.TAB_ACTOR_SPELLBOOK,\n        CONSTANTS.TAB_CHARACTER_FEATURES,\n      ]),\n    },\n    {\n      type: CONSTANTS.SHEET_TYPE_NPC,\n      label: localize('DND5E.NPC.Label'),\n      tabs: mapTabs(NpcSheetRuntime.tabMap, [\n        CONSTANTS.TAB_NPC_ABILITIES,\n        CONSTANTS.TAB_ACTOR_INVENTORY,\n        CONSTANTS.TAB_ACTOR_SPELLBOOK,\n      ]),\n    },\n    {\n      type: CONSTANTS.SHEET_TYPE_GROUP,\n      label: localize('TYPES.Actor.group'),\n      tabs: mapTabs(GroupSheetRuntime.tabMap, [CONSTANTS.TAB_ACTOR_INVENTORY]),\n    },\n  ];\n\n  function mapTabs(\n    tabs: Map<string, RegisteredTab<any>>,\n    subset: string[] = [],\n  ) {\n    let mappedTabs: TabFilterOption[] = [];\n    try {\n      for (let [_, tab] of tabs) {\n        if (subset.length && !subset.includes(tab.id)) {\n          continue;\n        }\n        let title = localize(\n          typeof tab.title === 'function' ? tab.title() : tab.title,\n        );\n        mappedTabs.push({\n          id: tab.id,\n          title,\n        });\n      }\n    } catch (e) {\n      error('An error occurred while preparing a tab ');\n    }\n\n    return mappedTabs.sort((left, right) =>\n      left.title.localeCompare(right.title, game.i18n.lang),\n    );\n  }\n\n  function toggleSheetFilter(\n    sectionConfig: GlobalCustomSectionSetting,\n    sheetType: string,\n    checked: boolean,\n  ) {\n    if (!checked) {\n      delete sectionConfig.showWhenEmptyFilters[sheetType];\n    } else {\n      sectionConfig.showWhenEmptyFilters[sheetType] ??= [];\n    }\n  }\n\n  function toggleTab(\n    sectionConfig: GlobalCustomSectionSetting,\n    sheetType: string,\n    tabId: string,\n    checked: boolean,\n  ) {\n    if (!checked) {\n      sectionConfig.showWhenEmptyFilters[sheetType] =\n        sectionConfig.showWhenEmptyFilters[sheetType].filter(\n          (x) => x !== tabId,\n        );\n    } else {\n      sectionConfig.showWhenEmptyFilters[sheetType].push(tabId);\n    }\n  }\n</script>\n\n<div class=\"settings-form\">\n  <article class=\"setting group\">\n    <section class=\"flex-column small-gap\">\n      <div class=\"description\">\n        <label for=\"globalCustomSections-{appId}\"\n          >{localize(\n            SettingsProvider.settings.globalCustomSections.options.name,\n          )}</label\n        >\n        <p class=\"tidy5e-notes\">\n          {localize(\n            SettingsProvider.settings.globalCustomSections.options.hint,\n          )}\n        </p>\n      </div>\n      {#each context.settings.globalCustomSections as sectionConfig}\n        {@const hasAdvancedSettings = sectionConfig.showWhenEmpty}\n        <details>\n          <summary\n            class:has-advanced-settings={hasAdvancedSettings}\n            onkeyup={(ev) =>\n              ev.target === ev.currentTarget || ev.preventDefault()}\n          >\n            <span class=\"section-summary\">\n              <span class=\"input-group\">\n                <input\n                  type=\"text\"\n                  class=\"custom-section-name\"\n                  bind:value={sectionConfig.section}\n                  placeholder={localize('TIDY5E.Section.Label')}\n                />\n                {#if hasAdvancedSettings}\n                  <span class=\"customize-indicator\">\n                    {localize(\n                      'TIDY5E.WorldSettings.TabCustomSections.CustomizedIndicatorLabel',\n                    )}\n                  </span>\n                {/if}\n              </span>\n              <button\n                type=\"button\"\n                title={localize('TIDY5E.ContextMenuActionDelete')}\n                onclick={() => removeSection(sectionConfig)}\n                class=\"inline-icon-button\"\n              >\n                <i class=\"fa-solid fa-trash\"></i>\n              </button>\n            </span>\n          </summary>\n          <div\n            class=\"settings-group custom-section-settings flex-column small-gap\"\n          >\n            <div>\n              <label\n                title={localize(\n                  'TIDY5E.WorldSettings.TabCustomSections.ShowWhenEmptyTooltip',\n                )}\n                class=\"flex-row align-items-center extra-small-gap\"\n              >\n                <input\n                  type=\"checkbox\"\n                  bind:checked={sectionConfig.showWhenEmpty}\n                />\n                <span\n                  >{localize(\n                    'TIDY5E.WorldSettings.TabCustomSections.ShowWhenEmptyLabel',\n                  )}</span\n                >\n                <i class=\"fa-solid fa-info-circle\"></i>\n              </label>\n            </div>\n\n            {#if sectionConfig.showWhenEmpty}\n              <div class=\"custom-section-sheets\">\n                <div class=\"custom-section-setting-header\">\n                  {localize(\n                    'TIDY5E.WorldSettings.TabCustomSections.LimitToSpecificSheetsLabel',\n                  )}\n                </div>\n                {#each sheetTypes as sheetType}\n                  {@const sheetSelected =\n                    sheetType.type in sectionConfig.showWhenEmptyFilters}\n                  <div class=\"custom-section-sheet\">\n                    <label class=\"flex-row align-items-center extra-small-gap\">\n                      <input\n                        type=\"checkbox\"\n                        checked={sheetSelected}\n                        onchange={(ev) =>\n                          toggleSheetFilter(\n                            sectionConfig,\n                            sheetType.type,\n                            ev.currentTarget.checked,\n                          )}\n                      />\n                      {sheetType.label}\n                    </label>\n                    {#if sheetSelected && sheetType.tabs.length > 0}\n                      <div class=\"custom-section-sheet-tabs\">\n                        <div class=\"custom-section-setting-header\">\n                          {localize(\n                            'TIDY5E.WorldSettings.TabCustomSections.LimitToSpecificTabsLabel',\n                          )}\n                        </div>\n                        <div class=\"custom-section-sheet-tab-options\">\n                          {#each sheetType.tabs as tab (tab.id)}\n                            <label\n                              class=\"flex-row align-items-center extra-small-gap\"\n                            >\n                              <input\n                                type=\"checkbox\"\n                                checked={!!sectionConfig.showWhenEmptyFilters[\n                                  sheetType.type\n                                ]?.includes(tab.id)}\n                                onchange={(ev) =>\n                                  toggleTab(\n                                    sectionConfig,\n                                    sheetType.type,\n                                    tab.id,\n                                    ev.currentTarget.checked,\n                                  )}\n                              />\n                              {tab.title}\n                            </label>\n                          {/each}\n                        </div>\n                      </div>\n                    {/if}\n                  </div>\n                {/each}\n              </div>\n            {/if}\n          </div>\n        </details>\n\n        <HorizontalLineSeparator />\n      {/each}\n      <button\n        type=\"button\"\n        onclick={() =>\n          context.settings.globalCustomSections.push(createNewSection())}\n      >\n        <i class=\"fa-solid fa-plus\"></i>\n        {localize('TIDY5E.Section.SectionSelectorCreateNewSection')}\n      </button>\n    </section>\n  </article>\n</div>\n\n<style lang=\"scss\">\n  .section-summary {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.25rem;\n    width: calc(100% - 1.37em);\n  }\n\n  .custom-section-settings {\n    padding: 0.5rem;\n  }\n\n  .custom-section-setting-header {\n    font-weight: 500;\n  }\n\n  .custom-section-sheets {\n    display: flex;\n    flex-direction: column;\n    gap: 0.325rem;\n    margin-inline-start: 0.5rem;\n    padding-inline-start: 0.5rem;\n    border-left: 0.125rem solid var(--t5e-separator-color);\n  }\n\n  .custom-section-setting-header {\n    border-bottom: 1.5px solid var(--t5e-light-color);\n    margin-block-start: 0.25rem;\n    margin-block-end: 0.125rem;\n  }\n\n  .custom-section-sheet-tabs {\n    padding: 0.25rem 0.5rem 0.5rem 0.5rem;\n    margin-block: 0.5rem;\n    margin-inline-start: 0.5rem;\n    padding-inline-start: 0.5rem;\n    background-color: var(--t5e-faintest-color);\n    border-radius: 0.25rem;\n\n    .custom-section-setting-header {\n      margin-block-start: 0;\n      margin-block-end: 0.5rem;\n    }\n  }\n\n  .custom-section-sheet-tab-options {\n    display: flex;\n    column-gap: 0.75rem;\n    row-gap: 0.5rem;\n    flex-wrap: wrap;\n  }\n\n  .custom-section-name {\n    flex: 1;\n  }\n\n  .customize-indicator {\n    font-size: var(--font-size-12);\n    color: var(--t5e-tertiary-color);\n    align-self: center;\n  }\n\n  .input-group {\n    flex: 1;\n  }\n</style>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import type { Tab } from 'src/types/types';\n  import MiscWorldSettingsTab from './tabs/MiscWorldSettingsTab.svelte';\n  import CharacterWorldSettingsTab from './tabs/CharacterWorldSettingsTab.svelte';\n  import NpcWorldSettingsTab from './tabs/NpcWorldSettingsTab.svelte';\n  import VehicleWorldSettingsTab from './tabs/VehicleWorldSettingsTab.svelte';\n  import ItemWorldSettingsTab from './tabs/ItemWorldSettingsTab.svelte';\n  import ExhaustionWorldSettingsTab from './tabs/ExhaustionWorldSettingsTab.svelte';\n  import SheetLockWorldSettingsTab from './tabs/SheetLockWorldSettingsTab.svelte';\n  import { getContext } from 'svelte';\n  import type {\n    WorldSettingsContext,\n    WorldSettingsFunctions,\n  } from './WorldSettings.types';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import IconsWorldSettingsTab from './tabs/IconsWorldSettingsTab.svelte';\n  import CustomSectionsWorldSettingsTab from './tabs/CustomSectionsWorldSettingsTab.svelte';\n\n  let selectedTabId: string = $state('');\n  let functions = getContext<WorldSettingsFunctions>(\n    CONSTANTS.SVELTE_CONTEXT.FUNCTIONS,\n  );\n  let context = getContext<WorldSettingsContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n\n  let tabs: Tab[] = [\n    {\n      id: CONSTANTS.TAB_WORLD_SETTINGS_MISC,\n      title: 'TIDY5E.WorldSettings.TabMisc.tabLabel',\n      content: {\n        component: MiscWorldSettingsTab,\n        type: 'svelte',\n      },\n    },\n    {\n      id: CONSTANTS.TAB_WORLD_SETTINGS_CHARACTER,\n      title: 'TIDY5E.WorldSettings.TabCharacter.tabLabel',\n      content: {\n        component: CharacterWorldSettingsTab,\n        type: 'svelte',\n      },\n    },\n    {\n      id: CONSTANTS.TAB_WORLD_SETTINGS_NPC,\n      title: 'TIDY5E.WorldSettings.TabNpc.tabLabel',\n      content: {\n        component: NpcWorldSettingsTab,\n        type: 'svelte',\n      },\n    },\n    {\n      id: CONSTANTS.TAB_WORLD_SETTINGS_VEHICLE,\n      title: 'TIDY5E.WorldSettings.TabVehicle.tabLabel',\n      content: {\n        component: VehicleWorldSettingsTab,\n        type: 'svelte',\n      },\n    },\n    {\n      id: CONSTANTS.TAB_WORLD_SETTINGS_ITEM,\n      title: 'TIDY5E.WorldSettings.TabItem.tabLabel',\n      content: {\n        component: ItemWorldSettingsTab,\n        type: 'svelte',\n      },\n    },\n    {\n      id: CONSTANTS.TAB_WORLD_SETTINGS_EXHAUSTION,\n      title: 'TIDY5E.WorldSettings.TabExhaustion.tabLabel',\n      content: {\n        component: ExhaustionWorldSettingsTab,\n        type: 'svelte',\n      },\n    },\n    {\n      id: CONSTANTS.TAB_WORLD_SETTINGS_SHEETLOCK,\n      title: 'TIDY5E.WorldSettings.TabSheetLock.tabLabel',\n      content: {\n        component: SheetLockWorldSettingsTab,\n        type: 'svelte',\n      },\n    },\n    {\n      id: CONSTANTS.TAB_WORLD_SETTINGS_ICONS,\n      title: 'TIDY5E.WorldSettings.TabIcons.tabLabel',\n      content: {\n        component: IconsWorldSettingsTab,\n        type: 'svelte',\n      },\n    },\n    {\n      id: CONSTANTS.TAB_WORLD_SETTINGS_CUSTOM_SECTIONS,\n      title: 'TIDY5E.WorldSettings.TabCustomSections.tabLabel',\n      content: {\n        component: CustomSectionsWorldSettingsTab,\n        type: 'svelte',\n      },\n    },\n  ];\n\n  selectedTabId ??= tabs[0].id;\n\n  let applyingChanges = $state(false);\n\n  async function save() {\n    applyingChanges = true;\n\n    try {\n      await functions.save();\n    } finally {\n      applyingChanges = false;\n    }\n  }\n\n  async function apply() {\n    applyingChanges = true;\n\n    try {\n      await functions.apply();\n    } finally {\n      applyingChanges = false;\n    }\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"settings-form user-select-text\">\n  <div role=\"presentation\" class=\"vertical-tab-container flex-column no-gap\">\n    <Tabs {tabs} bind:selectedTabId orientation=\"vertical\" />\n    <div role=\"presentation\" class=\"remaining-vertical-space\"></div>\n  </div>\n\n  <TabContents {tabs} {selectedTabId} cssClass=\"tidy-sheet-body\" />\n  <div class=\"button-bar\">\n    <button\n      type=\"button\"\n      class=\"save-changes-btn\"\n      onclick={save}\n      disabled={applyingChanges}\n    >\n      <i class=\"fas fa-save\"></i>\n      {localize('TIDY5E.SaveChanges')}\n    </button>\n    <button\n      type=\"button\"\n      class=\"apply-changes-btn\"\n      onclick={apply}\n      disabled={applyingChanges}\n    >\n      <i class=\"fas fa-check\"></i>\n      {localize('TIDY5E.ApplyChanges')}\n    </button>\n  </div>\n</div>\n\n<style lang=\"scss\">\n  .settings-form {\n    height: 100%;\n    display: grid;\n    grid-template-areas:\n      'nav    body'\n      'nav    buttons';\n    grid-template-rows: 1fr auto;\n    grid-template-columns: 15rem 1fr;\n    gap: 0.5rem;\n\n    .vertical-tab-container {\n      grid-area: nav;\n      margin-top: -0.5rem;\n      margin-left: -0.5rem;\n      margin-bottom: -0.5rem;\n    }\n\n    :global(.tidy-sheet-body) {\n      grid-area: body;\n      overflow-y: scroll;\n      padding-top: 0;\n      padding-right: 0.5rem;\n      margin-right: -0.25rem;\n      flex: 1;\n    }\n\n    .button-bar {\n      grid-area: buttons;\n    }\n  }\n\n  .button-bar {\n    flex: 0;\n    display: flex;\n    padding-right: 0.5rem;\n  }\n\n  .remaining-vertical-space {\n    margin-right: -0.0625rem;\n    border-right: 0.0625rem solid var(--t5e-tab-strip-border-color);\n    flex: 1;\n    background-color: var(--t5e-header-background);\n  }\n</style>\n","import SvelteFormApplicationBase from 'src/applications/SvelteFormApplicationBase';\nimport { mount } from 'svelte';\nimport WorldSettings from './WorldSettings.svelte';\nimport {\n  SettingsProvider,\n  getCurrentSettings,\n  type Tidy5eSettingKey,\n  type CurrentSettings,\n} from 'src/settings/settings.svelte';\nimport type {\n  DefaultTabSelectionFields,\n  WorldSettingsContext,\n  WorldSettingsFunctions,\n} from './WorldSettings.types';\nimport type { RegisteredTab } from 'src/runtime/types';\nimport CharacterSheetRuntime from 'src/runtime/CharacterSheetRuntime.svelte';\nimport NpcSheetRuntime from 'src/runtime/NpcSheetRuntime.svelte';\nimport { VehicleSheetRuntime } from 'src/runtime/VehicleSheetRuntime';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { TabManager } from 'src/runtime/tab/TabManager';\nimport { debug, error } from 'src/utils/logging';\nimport { CONSTANTS } from 'src/constants';\n\nexport class WorldSettingsFormApplication extends SvelteFormApplicationBase {\n  unchangedSettings?: CurrentSettings;\n  context = $state<WorldSettingsContext>();\n\n  static get defaultOptions() {\n    return {\n      ...super.defaultOptions,\n      height: 750,\n      title: 'TIDY5E.WorldSettings.Menu.title',\n      width: 750,\n      classes: [\n        ...super.defaultOptions.classes,\n        'settings',\n        'app-v1',\n        CONSTANTS.SHEET_LAYOUT_CLASSIC,\n      ],\n      id: 'tidy-5e-sheets-world-settings',\n      popOut: true,\n    };\n  }\n\n  get template() {\n    return FoundryAdapter.getTemplate('empty-form-template.hbs');\n  }\n\n  getData(): WorldSettingsContext {\n    const currentSettings = getCurrentSettings();\n\n    return {\n      settings: {\n        hideDeathSavesFromPlayers: currentSettings.hideDeathSavesFromPlayers,\n        defaultDeathSaveRoll: currentSettings.defaultDeathSaveRoll,\n        useCharacterEncumbranceBar: currentSettings.useCharacterEncumbranceBar,\n        useNpcEncumbranceBar: currentSettings.useNpcEncumbranceBar,\n        useVehicleEncumbranceBar: currentSettings.useVehicleEncumbranceBar,\n        showPlayerName: currentSettings.showPlayerName,\n        showExpandedLimitedView: currentSettings.showExpandedLimitedView,\n        itemCardsFixKey: currentSettings.itemCardsFixKey,\n        useCircularPortraitStyle: currentSettings.useCircularPortraitStyle,\n        permanentlyUnlockCharacterSheetForGm:\n          currentSettings.permanentlyUnlockCharacterSheetForGm,\n        permanentlyUnlockNpcSheetForGm:\n          currentSettings.permanentlyUnlockNpcSheetForGm,\n        permanentlyUnlockVehicleSheetForGm:\n          currentSettings.permanentlyUnlockVehicleSheetForGm,\n        limitEffectsManagementToGm: currentSettings.limitEffectsManagementToGm,\n        useCharacterInspiration: currentSettings.useCharacterInspiration,\n        useVehicleMotion: currentSettings.useVehicleMotion,\n        useExhaustion: currentSettings.useExhaustion,\n        showTraitLabels: currentSettings.showTraitLabels,\n        allowCantripsToBePrepared: currentSettings.allowCantripsToBePrepared,\n        allowHpMaxOverride: currentSettings.allowHpMaxOverride,\n        showActiveEffectsMarker: currentSettings.showActiveEffectsMarker,\n        useTotalSheetLock: currentSettings.useTotalSheetLock,\n        lockExpChanges: currentSettings.lockExpChanges,\n        lockHpMaxChanges: currentSettings.lockHpMaxChanges,\n        lockConfigureSheet: currentSettings.lockConfigureSheet,\n        lockMoneyChanges: currentSettings.lockMoneyChanges,\n        lockLevelSelector: currentSettings.lockLevelSelector,\n        lockItemQuantity: currentSettings.lockItemQuantity,\n        initialNpcSheetTab: currentSettings.initialNpcSheetTab,\n        showNpcRestInChat: currentSettings.showNpcRestInChat,\n        showNpcActorLinkMarker: currentSettings.showNpcActorLinkMarker,\n        initialCharacterSheetTab: currentSettings.initialCharacterSheetTab,\n        initialVehicleSheetTab: currentSettings.initialVehicleSheetTab,\n        includeTidySectionFieldsInDefaultSheets:\n          currentSettings.includeTidySectionFieldsInDefaultSheets,\n        itemIdentificationPermission:\n          currentSettings.itemIdentificationPermission,\n        includeFlagsInSpellScrollCreation:\n          currentSettings.includeFlagsInSpellScrollCreation,\n        useTidySpellSchoolIcons: currentSettings.useTidySpellSchoolIcons,\n        globalCustomSections: currentSettings.globalCustomSections,\n      },\n      defaultCharacterTabs: this.mapTabSelectionFields(\n        CharacterSheetRuntime.getAllRegisteredTabs(),\n        currentSettings.defaultCharacterSheetTabs\n      ),\n      defaultNpcTabs: this.mapTabSelectionFields(\n        NpcSheetRuntime.getAllRegisteredTabs(),\n        currentSettings.defaultNpcSheetTabs\n      ),\n      defaultVehicleTabs: this.mapTabSelectionFields(\n        VehicleSheetRuntime.getAllRegisteredTabs(),\n        currentSettings.defaultVehicleSheetTabs\n      ),\n      exhaustionConfig: {\n        ...SettingsProvider.settings.exhaustionConfig.options.default,\n        ...currentSettings.exhaustionConfig,\n      },\n      vehicleExhaustionConfig: {\n        ...SettingsProvider.settings.vehicleExhaustionConfig.options.default,\n        ...currentSettings.vehicleExhaustionConfig,\n      },\n    };\n  }\n\n  createComponent(node: HTMLElement): Record<string, any> {\n    this.context = this.getData();\n\n    debug('World Settings context data', this.context);\n\n    return mount(WorldSettings, {\n      target: node,\n      context: new Map<any, any>([\n        ['context', this.context],\n        [\n          'functions',\n          {\n            save: this.saveChangedSettings.bind(this),\n            apply: this.applyChangedSettings.bind(this),\n            resetDefaultTabs: this.resetDefaultTabs.bind(this),\n          } satisfies WorldSettingsFunctions,\n        ],\n        ['appId', this.appId],\n      ]),\n    });\n  }\n\n  mapTabSelectionFields(\n    registeredTabs: RegisteredTab<any>[],\n    selectedTabIds: string[]\n  ): DefaultTabSelectionFields {\n    const available = registeredTabs\n      .filter((t) => !selectedTabIds.includes(t.id))\n      .map((t) => ({\n        id: t.id,\n        label: FoundryAdapter.localize(TabManager.getTabTitle(t)),\n      }));\n\n    const selected = registeredTabs\n      .filter((t) => selectedTabIds.includes(t.id))\n      .sort(\n        (a, b) => selectedTabIds.indexOf(a.id) - selectedTabIds.indexOf(b.id)\n      )\n      .map((t) => ({\n        id: t.id,\n        label: FoundryAdapter.localize(TabManager.getTabTitle(t)),\n      }));\n\n    return {\n      available,\n      selected,\n    };\n  }\n\n  validate(context: WorldSettingsContext) {\n    let valid = true;\n\n    if (\n      context.defaultCharacterTabs.selected.length === 0 ||\n      context.defaultNpcTabs.selected.length === 0 ||\n      context.defaultVehicleTabs.selected.length === 0\n    ) {\n      valid = false;\n      error(\n        FoundryAdapter.localize(\n          'TIDY5E.Settings.DefaultSheetTabs.AtLeastOneTabRequiredErrorMessage'\n        ),\n        true\n      );\n    }\n\n    if (\n      context.exhaustionConfig.type === 'specific' &&\n      context.exhaustionConfig.levels < 1\n    ) {\n      valid = false;\n      error(\n        FoundryAdapter.localize(\n          'TIDY5E.WorldSettings.Exhaustion.AtLeastOneLevelRequiredErrorMessage'\n        ),\n        true\n      );\n    }\n\n    if (\n      context.vehicleExhaustionConfig.type === 'specific' &&\n      context.vehicleExhaustionConfig.levels < 1\n    ) {\n      valid = false;\n      error(\n        FoundryAdapter.localize(\n          'TIDY5E.WorldSettings.VehicleExhaustion.AtLeastOneLevelRequiredErrorMessage'\n        ),\n        true\n      );\n    }\n\n    // Add more data validation here as needed\n\n    return valid;\n  }\n\n  async applyChangedSettings() {\n    if (!this.context || !this.validate(this.context)) {\n      return false;\n    }\n\n    if (this.context.exhaustionConfig.type === 'specific') {\n      this.context.exhaustionConfig.hints =\n        this.context.exhaustionConfig.hints.slice(\n          0,\n          this.context.exhaustionConfig.levels + 1\n        );\n    }\n\n    if (this.context.vehicleExhaustionConfig.type === 'specific') {\n      this.context.vehicleExhaustionConfig.hints =\n        this.context.vehicleExhaustionConfig.hints.slice(\n          0,\n          this.context.vehicleExhaustionConfig.levels + 1\n        );\n    }\n\n    const newSettings: Partial<CurrentSettings> = {\n      ...this.context.settings,\n      defaultCharacterSheetTabs: this.context.defaultCharacterTabs.selected.map(\n        (t) => t.id\n      ),\n      defaultNpcSheetTabs: this.context.defaultNpcTabs.selected.map(\n        (t) => t.id\n      ),\n      defaultVehicleSheetTabs: this.context.defaultVehicleTabs.selected.map(\n        (t) => t.id\n      ),\n      exhaustionConfig: this.context.exhaustionConfig,\n      vehicleExhaustionConfig: this.context.vehicleExhaustionConfig,\n    };\n\n    const currentSettings = getCurrentSettings();\n\n    const keys = Object.keys(newSettings) as Tidy5eSettingKey[];\n    for (let key of keys) {\n      const currentValue = currentSettings[key];\n      const newValue = newSettings[key];\n      if (currentValue !== newValue) {\n        await FoundryAdapter.setTidySetting(key, newValue);\n        debug(`Updated ${key} to ${newValue}`);\n      }\n    }\n\n    return true;\n  }\n\n  async saveChangedSettings() {\n    const changesApplied = await this.applyChangedSettings();\n\n    if (!changesApplied) {\n      return;\n    }\n\n    this.close();\n  }\n\n  resetDefaultTabs(actorType: string) {\n    if (!this.context) {\n      return;\n    }\n\n    switch (actorType) {\n      case CONSTANTS.SHEET_TYPE_CHARACTER:\n        this.context.defaultCharacterTabs = this.mapTabSelectionFields(\n          CharacterSheetRuntime.getAllRegisteredTabs(),\n          [\n            ...SettingsProvider.settings.defaultCharacterSheetTabs.options\n              .default,\n          ]\n        );\n        break;\n      case CONSTANTS.SHEET_TYPE_NPC:\n        this.context.defaultNpcTabs = this.mapTabSelectionFields(\n          NpcSheetRuntime.getAllRegisteredTabs(),\n          [...SettingsProvider.settings.defaultNpcSheetTabs.options.default]\n        );\n        break;\n      case CONSTANTS.SHEET_TYPE_VEHICLE:\n        this.context.defaultVehicleTabs = this.mapTabSelectionFields(\n          VehicleSheetRuntime.getAllRegisteredTabs(),\n          [...SettingsProvider.settings.defaultVehicleSheetTabs.options.default]\n        );\n        break;\n    }\n  }\n}\n","<script lang=\"ts\">\n  import ButtonMenuItem from 'src/components/button-menu/ButtonMenuItem.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getCoreThemes } from 'src/theme/theme-reference';\n\n  const themes = Object.entries(getCoreThemes(true));\n\n  const idSuffix = Date.now().toString();\n\n  function setTheme(value: string) {\n    FoundryAdapter.setTidySetting('colorScheme', value);\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<ButtonMenuItem cssClass=\"flex-column extra-small-gap\">\n  <label class=\"theme-label\" for=\"sheet-menu-{idSuffix}\">\n    {localize('TIDY5E.SheetMenu.themeLabel')}\n  </label>\n  <select\n    id=\"sheet-menu-{idSuffix}\"\n    onchange={(ev) => setTheme(ev.currentTarget.value)}\n    value={settings.value.colorScheme}\n  >\n    {#each themes as [key, value]}\n      <option value={key}>{localize(value)}</option>\n    {/each}\n  </select>\n</ButtonMenuItem>\n\n<style lang=\"scss\">\n  .theme-label {\n    font-weight: 600;\n    margin-top: -0.5rem;\n    font-size: 0.875rem;\n  }\n\n  select {\n    font-size: 0.875rem;\n  }\n</style>\n","<script lang=\"ts\">\n  import ButtonMenu from 'src/components/button-menu/ButtonMenu.svelte';\n  import ButtonMenuCommand from 'src/components/button-menu/ButtonMenuCommand.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getContext } from 'svelte';\n  import type { CurrentSettings } from 'src/settings/settings.svelte';\n  import ThemeSelectorButtonMenuCommand from 'src/sheets/classic/shared/ThemeSelectorButtonMenuCommand.svelte';\n  import ButtonMenuDivider from 'src/components/button-menu/ButtonMenuDivider.svelte';\n  import type { ThemeSettingsSheetFunctions } from './ThemeSettingsFormApplication.svelte';\n\n  interface Props {\n    onSelectFile?: (file: File) => void;\n    settings: CurrentSettings;\n  }\n\n  let { onSelectFile, settings }: Props = $props();\n\n  let functions = getContext<ThemeSettingsSheetFunctions>(\n    CONSTANTS.SVELTE_CONTEXT.FUNCTIONS,\n  );\n\n  let fileImportInput: HTMLInputElement;\n\n  const localize = FoundryAdapter.localize;\n\n  function onFileChanged(\n    ev: Event & {\n      currentTarget: EventTarget & HTMLInputElement;\n    },\n  ) {\n    const file = ev.currentTarget.files?.[0];\n\n    ev.currentTarget.value = '';\n\n    if (!file) {\n      return;\n    }\n\n    onSelectFile?.(file);\n  }\n</script>\n\n<ButtonMenu\n  iconClass={{\n    opened: 'fas fa-caret-up',\n    closed: 'fas fa-caret-down',\n  }}\n  position=\"bottom\"\n  anchor=\"right\"\n  openerPadding=\"0.125rem 0.5rem\"\n  buttonText={localize('TIDY5E.ThemeSettings.Sheet.menuLabel')}\n>\n  <ThemeSelectorButtonMenuCommand />\n  <ButtonMenuDivider />\n  <ButtonMenuCommand\n    onMenuClick={() => fileImportInput.click()}\n    iconClass=\"fas fa-file-import\"\n  >\n    {localize('TIDY5E.ThemeSettings.Sheet.import')}\n  </ButtonMenuCommand>\n  <ButtonMenuCommand\n    onMenuClick={() => functions.exportTheme(settings)}\n    iconClass=\"fas fa-file-export\"\n  >\n    {localize('TIDY5E.ThemeSettings.Sheet.export')}\n  </ButtonMenuCommand>\n  <ButtonMenuCommand\n    onMenuClick={() =>\n      functions.useExistingThemeColors(CONSTANTS.THEME_ID_DEFAULT_LIGHT)}\n    iconClass=\"fas fa-sun\"\n  >\n    {localize('TIDY5E.ThemeSettings.Sheet.useDefaultLightColors')}\n  </ButtonMenuCommand>\n  <ButtonMenuCommand\n    onMenuClick={() =>\n      functions.useExistingThemeColors(CONSTANTS.THEME_ID_DEFAULT_DARK)}\n    iconClass=\"fas fa-moon\"\n  >\n    {localize('TIDY5E.ThemeSettings.Sheet.useDefaultDarkColors')}\n  </ButtonMenuCommand>\n</ButtonMenu>\n<input\n  class=\"theme-import-input\"\n  type=\"file\"\n  accept={CONSTANTS.THEME_EXTENSION_WITH_DOT}\n  onchange={onFileChanged}\n  bind:this={fileImportInput}\n/>\n\n<style lang=\"scss\">\n  .theme-import-input {\n    display: none;\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { ThemeColorSetting } from 'src/types/theme.types';\n  import { getContext, onMount } from 'svelte';\n  import type { CurrentSettings } from 'src/settings/settings.svelte';\n  import {\n    settingValueToHexaString,\n    trySetRootCssVariable,\n  } from 'src/theme/theme';\n  import { CONSTANTS } from 'src/constants';\n\n  interface Props {\n    settings: CurrentSettings;\n    colorToConfigure: ThemeColorSetting;\n  }\n\n  let { colorToConfigure, settings }: Props = $props();\n\n  let appId = getContext(CONSTANTS.SVELTE_CONTEXT.APP_ID);\n\n  const eyeDropperEnabled = 'EyeDropper' in window;\n\n  function activateEyeDropper(colorToConfigure: ThemeColorSetting) {\n    if ('EyeDropper' in window) {\n      const EyeDropper = window.EyeDropper as any;\n      const eyeDropper = new EyeDropper();\n      eyeDropper.open().then(({ sRGBHex }: { sRGBHex: string }) => {\n        onColorSelected(colorToConfigure, sRGBHex);\n      });\n    }\n  }\n\n  function onColorSelected(colorToConfigure: ThemeColorSetting, value: string) {\n    const parsedColor = settingValueToHexaString(value);\n    if (!parsedColor) {\n      return;\n    }\n    trySetRootCssVariable(\n      colorToConfigure.cssVariable,\n      value,\n      settings.colorPickerEnabled,\n    );\n\n    //@ts-expect-error\n    settings[colorToConfigure.key] = value;\n  }\n\n  let article: HTMLElement;\n  onMount(() => {\n    // Required in order to prevent unwanted form submissions by the chosen Color Picker.\n    article.querySelectorAll('button').forEach((button) => {\n      if (button.type === 'submit') {\n        button.type = 'button';\n      }\n    });\n  });\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<article bind:this={article}>\n  <div class=\"description\">\n    <label for=\"{colorToConfigure.key}-{appId}\">\n      {localize(colorToConfigure.name)}\n    </label>\n  </div>\n  <div class=\"theme-settings-group flex-row align-items-center extra-small-gap\">\n    <label\n      for=\"{colorToConfigure.key}-{appId}\"\n      class=\"color-picker-preview\"\n      style=\"--bg-color: {settings[colorToConfigure.key]};\"\n    ></label>\n\n    <input\n      type=\"text\"\n      id=\"{colorToConfigure.key}-{appId}\"\n      value={settings[colorToConfigure.key]}\n      class=\"theme-color-textbox coloris\"\n      onchange={(ev) =>\n        onColorSelected(colorToConfigure, ev.currentTarget.value)}\n    />\n    {#if eyeDropperEnabled}\n      <button\n        type=\"button\"\n        class=\"eye-dropper\"\n        onclick={() => activateEyeDropper(colorToConfigure)}\n        ><i class=\"fas fa-eye-dropper\"></i></button\n      >\n    {/if}\n  </div>\n</article>\n\n<style lang=\"scss\">\n  article {\n    background: var(--t5e-faintest-color);\n    border-radius: 0.3125rem;\n    margin: 0.125rem 0;\n    padding: 0.25rem;\n\n    label {\n      font-weight: 600;\n      padding-left: 0.25rem;\n    }\n\n    .theme-settings-group {\n      height: 3rem;\n\n      .theme-color-textbox {\n        flex-basis: 10rem;\n        flex: 1;\n      }\n\n      .eye-dropper {\n        flex: 0;\n        line-height: 1.25;\n        padding: 0.25rem 0.375rem;\n      }\n    }\n\n    .color-picker-preview {\n      background: var(--bg-color);\n      width: 2rem;\n      height: 2rem;\n      border-radius: 50%;\n      cursor: pointer;\n    }\n  }\n</style>\n","export function downloadTextFile(filename: string, text: string) {\n  const a = document.createElement('a');\n  const blob = new Blob([text], { type: 'text/json;charset=utf-8;' });\n  const url = URL.createObjectURL(blob);\n  a.setAttribute('href', url);\n  a.setAttribute('download', filename);\n  a.click();\n}\n\nexport function getSingleFileFromDropEvent(\n  ev: DragEvent & {\n    currentTarget: EventTarget & HTMLElement;\n  }\n): File | null {\n  ev.preventDefault();\n\n  let file: File | null = null;\n  if (ev.dataTransfer?.items) {\n    file = ev.dataTransfer.items[0]?.getAsFile();\n  } else if (ev.dataTransfer?.files) {\n    file = ev.dataTransfer.files[0];\n  }\n\n  return file;\n}\n\nexport function readFileAsText(file: File): Promise<string> {\n  return new Promise<string>((resolve, reject) => {\n    const fileReader = new FileReader();\n    fileReader.addEventListener('load', (event) => {\n      try {\n        const result = event.target?.result?.toString();\n        resolve(result ?? '');\n      } catch (e) {\n        reject(e);\n      }\n    });\n\n    fileReader.readAsText(file);\n  });\n}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { CurrentSettings } from 'src/settings/settings.svelte';\n  import { getContext, onDestroy } from 'svelte';\n  import type {\n    ThemeColorSetting,\n    Tidy5eThemeDataV1,\n  } from 'src/types/theme.types';\n  import { applyCurrentTheme } from 'src/theme/theme';\n  import { error } from 'src/utils/logging';\n  import ThemeSettingSheetMenu from './ThemeSettingSheetMenu.svelte';\n  import ThemeSettingColorArticle from './ThemeSettingColorArticle.svelte';\n  import {\n    clearTidy5eRootCssVariables,\n    extractSettingsUpdateDeltaFromTheme,\n    trySetRootCssVariable,\n    validateImportFile,\n  } from 'src/theme/theme';\n  import { getSingleFileFromDropEvent, readFileAsText } from 'src/utils/file';\n  import { CONSTANTS } from 'src/constants';\n\n  interface Props {\n    themeableColors: ThemeColorSetting[];\n    settings: CurrentSettings;\n  }\n\n  let { themeableColors, settings }: Props = $props();\n\n  $effect(() => {\n    if (settings.colorPickerEnabled) {\n      themeableColors.forEach((color) =>\n        trySetRootCssVariable(\n          color.cssVariable,\n          settings[color.key]?.toString(),\n          settings.colorPickerEnabled,\n        ),\n      );\n    } else {\n      clearTidy5eRootCssVariables();\n      applyCurrentTheme(false);\n    }\n  });\n\n  let appId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.APP_ID);\n\n  const localize = FoundryAdapter.localize;\n\n  async function processImportFile(file: File) {\n    try {\n      let result = await readFileAsText(file);\n\n      // Provides backward compatibility with the alpha themes.\n      result = result.replaceAll(`\"--t5ek-`, `\"--t5e-`);\n\n      const theme = JSON.parse(result) as Tidy5eThemeDataV1;\n\n      const isValid = validateImportFile(theme);\n\n      if (!isValid) {\n        throw new Error(`Theme file ${file.name} is in an invalid format.`);\n      }\n\n      const updateDelta = extractSettingsUpdateDeltaFromTheme(\n        theme,\n        themeableColors,\n      );\n\n      Object.assign(settings, updateDelta);\n\n      ui.notifications.info(\n        localize('TIDY5E.ThemeSettings.Sheet.importSuccess'),\n      );\n    } catch (e) {\n      ui.notifications.error(\n        localize('TIDY5E.ThemeSettings.Sheet.importError'),\n      );\n      error(\n        'An error occurred while attempting to import a theme file. See the devtools console for more details.',\n        true,\n        e,\n      );\n    }\n  }\n\n  function onDrop(\n    ev: DragEvent & {\n      currentTarget: EventTarget & HTMLElement;\n    },\n  ) {\n    let file = getSingleFileFromDropEvent(ev);\n\n    if (file) {\n      processImportFile(file);\n    }\n  }\n\n  onDestroy(() => {\n    clearTidy5eRootCssVariables();\n  });\n</script>\n\n<section class=\"theme-settings-wrapper\" ondrop={onDrop} aria-label=\"dropzone\">\n  <div class=\"theme-settings-form scroll-container\">\n    <h2 class=\"header flex-row justify-content-space-between\">\n      {localize('TIDY5E.ThemeSettings.Sheet.header')}\n      <ThemeSettingSheetMenu {settings} onSelectFile={processImportFile} />\n    </h2>\n\n    <div>\n      <label\n        for=\"colorPickerEnabled-{appId}\"\n        class=\"flex-row align-items-center extra-small-gap\"\n      >\n        <input\n          type=\"checkbox\"\n          id=\"colorPickerEnabled-{appId}\"\n          bind:checked={settings.colorPickerEnabled}\n        />\n        {localize('TIDY5E.Settings.ColorPickerEnabled.name')}\n      </label>\n    </div>\n\n    <p class=\"explanation\">\n      {localize('TIDY5E.ThemeSettings.Sheet.explanation')}\n    </p>\n\n    <p class=\"explanation drop-hint\">\n      {localize('TIDY5E.ThemeSettings.Sheet.importDropHint')}\n    </p>\n\n    <div class=\"color-pickers\">\n      {#each themeableColors as colorToConfigure}\n        <ThemeSettingColorArticle {settings} {colorToConfigure} />\n      {/each}\n    </div>\n  </div>\n  <div class=\"button-bar\">\n    <button type=\"submit\" class=\"save-changes-btn\">\n      <i class=\"fas fa-save\"></i>\n      {localize('TIDY5E.SaveChanges')}\n    </button>\n  </div>\n</section>\n\n<style lang=\"scss\">\n  .theme-settings-wrapper {\n    display: flex;\n    flex-direction: column;\n    gap: 0.25rem;\n    height: 100%;\n    margin-right: -0.25rem;\n\n    .header {\n      margin: 0;\n    }\n\n    .explanation {\n      margin: 0 0.5rem;\n    }\n\n    .drop-hint {\n      font-size: 0.75rem;\n      color: var(--t5e-secondary-color);\n    }\n\n    .theme-settings-form {\n      flex: 1;\n      display: flex;\n      flex-direction: column;\n      gap: 0.5rem;\n      padding-right: 0.5rem;\n    }\n\n    .button-bar {\n      display: flex;\n      flex-direction: column;\n      gap: 0.25rem;\n      margin-right: 0.75rem;\n\n      button {\n        margin: 0;\n      }\n    }\n  }\n</style>\n","import { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport {\n  getCurrentSettings,\n  type CurrentSettings,\n} from 'src/settings/settings.svelte';\nimport {\n  applyCurrentTheme,\n  getThemeOrDefault,\n  getThemeableColors,\n} from 'src/theme/theme';\nimport type {\n  ThemeColorSetting,\n  Tidy5eThemeDataV1,\n} from 'src/types/theme.types';\nimport { mount } from 'svelte';\nimport ThemeSettingsSheet from './ThemeSettingsSheet.svelte';\nimport { downloadTextFile } from 'src/utils/file';\nimport { CONSTANTS } from 'src/constants';\nimport SvelteFormApplicationBase from 'src/applications/SvelteFormApplicationBase';\n\nexport type ThemeSettingsSheetFunctions = {\n  save(settings: CurrentSettings): Promise<unknown>;\n  useExistingThemeColors(themeId: string): void;\n  exportTheme(settings: CurrentSettings): void;\n};\n\nexport class ThemeSettingsFormApplication extends SvelteFormApplicationBase {\n  themeableColors: ThemeColorSetting[] = getThemeableColors();\n  settings = $state(getCurrentSettings());\n\n  static get defaultOptions() {\n    return {\n      ...super.defaultOptions,\n      height: 750,\n      width: 400,\n      submitOnClose: false,\n      minimizable: true,\n      id: 'tidy-5e-sheets-theme-settings',\n      popOut: true,\n      resizable: true,\n      closeOnSubmit: false,\n    };\n  }\n\n  get title() {\n    return FoundryAdapter.localize('TIDY5E.ThemeSettings.Sheet.title', {\n      userName: game.user.name,\n    });\n  }\n\n  createComponent(node: HTMLElement): Record<string, any> {\n    return mount(ThemeSettingsSheet, {\n      target: node,\n      props: {\n        themeableColors: this.themeableColors,\n        settings: this.settings,\n      },\n      context: new Map<any, any>([\n        [\n          'functions',\n          {\n            save: this.saveChangedSettings.bind(this),\n            useExistingThemeColors: this.useExistingThemeColors.bind(this),\n            exportTheme: this.exportTheme.bind(this),\n          } satisfies ThemeSettingsSheetFunctions,\n        ],\n        ['appId', this.appId],\n      ]),\n    });\n  }\n\n  refreshContext(): void {\n    Object.assign(this.settings, getCurrentSettings());\n  }\n\n  async saveChangedSettings(newSettings: CurrentSettings) {\n    for (let color of this.themeableColors) {\n      await FoundryAdapter.setTidySetting(color.key, newSettings[color.key]);\n    }\n\n    await FoundryAdapter.setTidySetting(\n      'colorPickerEnabled',\n      newSettings.colorPickerEnabled\n    );\n\n    applyCurrentTheme();\n\n    await this.close();\n  }\n\n  useExistingThemeColors(themeId: string) {\n    const targetTheme = getThemeOrDefault(themeId);\n\n    const colorsToUpdate = this.themeableColors.reduce<Record<string, unknown>>(\n      (prev, color) => {\n        prev[color.key] = targetTheme.variables[color.cssVariable];\n        return prev;\n      },\n      {}\n    );\n\n    Object.assign(this.settings, colorsToUpdate);\n  }\n\n  exportTheme(settings: CurrentSettings) {\n    const variables = this.themeableColors.reduce<Record<string, string>>(\n      (prev, curr) => {\n        prev[curr.cssVariable] = settings[curr.key]?.toString();\n        return prev;\n      },\n      {}\n    );\n\n    const exportData: Tidy5eThemeDataV1 = {\n      version: 1,\n      variables,\n    };\n\n    downloadTextFile(\n      'theme' + CONSTANTS.THEME_EXTENSION_WITH_DOT,\n      JSON.stringify(exportData, null, ' ')\n    );\n  }\n\n  async _updateObject() {\n    await this.saveChangedSettings(this.settings);\n  }\n}\n","<script lang=\"ts\">\n  import type { SelectableMigrationSelectionParams } from './migration-selection.types';\n  import TidyTable, {\n    type TidyTableColumns,\n  } from 'src/components/table/TidyTable.svelte';\n  import TidyTableCell from 'src/components/table/TidyTableCell.svelte';\n  import TidyTableHeaderCell from 'src/components/table/TidyTableHeaderCell.svelte';\n  import TidyTableHeaderRow from 'src/components/table/TidyTableHeaderRow.svelte';\n  import TidyTableRow from 'src/components/table/TidyTableRow.svelte';\n  import Search from 'src/components/utility-bar/Search.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n  interface Props {\n    params: SelectableMigrationSelectionParams<any>;\n  }\n\n  let { params }: Props = $props();\n\n  let searchCriteria: string = $state('');\n\n  let visibleSelectablesIdSubset = $derived(\n    new Set<string>(\n      params.selectables\n        .filter(\n          (s) =>\n            searchCriteria.trim() === '' ||\n            s.document.name\n              ?.toLowerCase()\n              .includes(searchCriteria.toLowerCase()),\n        )\n        .map((d) => d.document.id),\n    ),\n  );\n\n  let gridTemplateColumns: TidyTableColumns = $derived.by(() => {\n    let result: TidyTableColumns = [\n      {\n        name: 'Select',\n        width: '2.5rem',\n      },\n    ];\n\n    params.columns.forEach((c) => {\n      const measurement = c.cellWidth === 'primary' ? '1fr' : c.cellWidth;\n      result.push({\n        name: c.name,\n        width: measurement,\n      });\n    });\n    return result;\n  });\n\n  let totalSelected = $derived(\n    params.selectables.filter((t) => t.selected).length,\n  );\n  let allSelected = $derived(totalSelected >= params.selectables.length);\n\n  function onMigrateClicked() {\n    const selectedTargets = params.selectables\n      .filter((t) => t.selected)\n      .map((t) => t.document);\n    params.onConfirm(selectedTargets);\n  }\n\n  function toggleAll() {\n    const targetState = !allSelected;\n    params.selectables.forEach((o) => (o.selected = targetState));\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<section>\n  <div role=\"presentation\" class=\"search-container\">\n    <Search bind:value={searchCriteria} />\n  </div>\n  <div role=\"presentation\" class=\"scroll-container\">\n    <TidyTable key=\"bulk-selection\" toggleable={false} {gridTemplateColumns}>\n      {#snippet header()}\n        <TidyTableHeaderRow>\n          <TidyTableHeaderCell>\n            <input\n              type=\"checkbox\"\n              checked={allSelected}\n              onclick={() => toggleAll()}\n              title={localize(\n                'TIDY5E.Settings.Migrations.Selection.SelectAllNoneTooltip',\n              )}\n            />\n          </TidyTableHeaderCell>\n          {#each params.columns as column}\n            <TidyTableHeaderCell primary={column?.cellWidth === 'primary'}>\n              {column.name ?? ''}\n            </TidyTableHeaderCell>\n          {/each}\n        </TidyTableHeaderRow>\n      {/snippet}\n      {#snippet body()}\n        {#each params.selectables as selectable}\n          <TidyTableRow\n            hidden={!visibleSelectablesIdSubset.has(selectable.document.id)}\n          >\n            <TidyTableCell>\n              <input type=\"checkbox\" bind:checked={selectable.selected} />\n            </TidyTableCell>\n            {#each params.columns as column}\n              {@const field = column.field}\n              <TidyTableCell\n                primary={column?.cellWidth === 'primary'}\n                class=\"flex-row small-gap\"\n              >\n                {#if field.type === 'contextual'}\n                  {field.getText(selectable.document) ?? ''}\n                {:else if column.field.type === 'simple'}\n                  {@const text =\n                    FoundryAdapter.getProperty(\n                      selectable.document,\n                      field.propPath,\n                    ) ?? ''}\n                  {#if field.onClick}\n                    <button\n                      type=\"button\"\n                      onclick={() => field.onClick?.(selectable.document)}\n                      class=\"inline-transparent-button\"\n                    >\n                      {text}\n                    </button>\n                  {:else}\n                    <div>{text}</div>\n                  {/if}\n                {/if}\n              </TidyTableCell>\n            {/each}\n          </TidyTableRow>\n        {/each}\n      {/snippet}\n    </TidyTable>\n  </div>\n  <footer>\n    <p>\n      {localize('TIDY5E.Settings.Migrations.Selection.TotalSelectedLabel', {\n        total: totalSelected,\n      })}\n    </p>\n    <button onclick={() => onMigrateClicked()}\n      >{localize('TIDY5E.ButtonConfirm.Text')}</button\n    >\n  </footer>\n</section>\n\n<style lang=\"scss\">\n  section {\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 0rem;\n\n    > .scroll-container {\n      flex: 1;\n    }\n  }\n\n  .search-container {\n    margin-block-end: 0.5rem;\n  }\n\n  footer {\n    margin-left: -0.5rem;\n    margin-right: -0.5rem;\n    padding-left: 0.5rem;\n    padding-right: 0.5rem;\n    border-top: 0.0625rem solid var(--t5e-faint-color);\n  }\n\n  input[type='checkbox'] {\n    flex-basis: 0.75rem;\n    width: auto;\n    height: auto;\n    margin: 0;\n    padding: 0;\n    line-height: 0.75rem;\n  }\n</style>\n","import { mount } from 'svelte';\nimport SvelteFormApplicationBase from 'src/applications/SvelteFormApplicationBase';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport MigrationSelection from './MigrationSelection.svelte';\nimport type {\n  MigrationSelectionParams,\n  SelectableMigrationSelectionParams,\n} from './migration-selection.types';\n\nexport class MigrationSelectionApplication<\n  T\n> extends SvelteFormApplicationBase {\n  _params = $state<SelectableMigrationSelectionParams<T>>()!;\n  _onClose?: Function;\n  _title?: string;\n\n  constructor(\n    params: MigrationSelectionParams<T>,\n    onClose?: Function,\n    options?: any\n  ) {\n    super(\n      {},\n      FoundryAdapter.mergeObject(\n        MigrationSelectionApplication.defaultOptions,\n        options\n      )\n    );\n\n    this._params = {\n      ...params,\n      selectables: params.documents.map((d) => ({\n        document: d,\n        selected: true,\n      })),\n    };\n\n    this._title = params.title;\n\n    this._onClose = onClose;\n  }\n\n  static get defaultOptions() {\n    return FoundryAdapter.mergeObject(super.defaultOptions, {\n      width: 650,\n      height: 500,\n      id: 'tidy-5e-sheets-migration-selection',\n      popOut: true,\n      closeOnSubmit: true,\n    });\n  }\n\n  get title() {\n    return (\n      this._title ??\n      FoundryAdapter.localize('TIDY5E.Settings.Migrations.dialogTitle')\n    );\n  }\n\n  createComponent(node: HTMLElement): Record<string, any> {\n    return mount(MigrationSelection, {\n      target: node,\n      props: {\n        params: this._params,\n      },\n    });\n  }\n\n  close(...args: any[]) {\n    this._onClose?.();\n    super.close(...args);\n  }\n}\n","import { TidyFlags } from 'src/foundry/TidyFlags';\nimport type { Item5e } from 'src/types/item.types';\nimport { isNil } from 'src/utils/data';\nimport { debug, error } from 'src/utils/logging';\n\ntype CcssToTidyItemMigrationParams = {\n  item: Item5e;\n  overwrite: boolean;\n  clearCcssFlagData: boolean;\n};\n\nexport const ccssFlagPropPath =\n  'flags.custom-character-sheet-sections.sectionName' as const;\n\nexport async function migrateCcssToTidyForItem({\n  item,\n  overwrite,\n  clearCcssFlagData,\n}: CcssToTidyItemMigrationParams) {\n  try {\n    const sectionName = getCcssSectionName(item);\n\n    if (isNil(sectionName, '')) {\n      return;\n    }\n\n    const tidySection = TidyFlags.section.get(item);\n\n    const shouldUpdateTidy = isNil(tidySection, '') || overwrite;\n\n    if (shouldUpdateTidy) {\n      TidyFlags.section.set(item, sectionName);\n    }\n\n    if (clearCcssFlagData) {\n      item.update({\n        'flags.custom-character-sheet-sections.-=sectionName': null,\n      });\n    }\n  } catch (e) {\n    error('An error occurred while migrating CCSS data from item.', false, e);\n    debug('CCSS Item Migration troubleshooting info', {\n      item: item?.toObject?.(),\n      overwrite,\n      clearCcssFlagData,\n    });\n  }\n}\n\nexport function getCcssSectionName(item: Item5e) {\n  return foundry.utils.getProperty(item, ccssFlagPropPath)?.trim();\n}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { debug, error } from 'src/utils/logging';\n  import { MigrationSelectionApplication } from '../migration-selection/MigrationSelectionApplication.svelte';\n  import type { Item5e } from 'src/types/item.types';\n  import {\n    ccssFlagPropPath,\n    getCcssSectionName,\n    migrateCcssToTidyForItem,\n  } from './ccss-to-tidy';\n  import { isNil } from 'src/utils/data';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import type { CompendiumToMigrate } from '../migration.types';\n\n  let migrating = $state(false);\n  let overwrite = $state(false);\n  let deleteFlags = $state(false);\n\n  async function migrate() {\n    try {\n      const actorItemsToMigrate = Array.from<any>(game.actors)\n        .filter((a) => a.isOwner)\n        .map((a) => ({ actor: a, unlinked: false }))\n        .flatMap((value) =>\n          Array.from(value.actor.items).map((item) => ({\n            item,\n            unlinked: value.unlinked,\n          })),\n        );\n\n      const tokenActorItemsToMigrate = Array.from(canvas?.scene?.tokens ?? [])\n        .map((t: any) => ({ actor: t.actor, unlinked: true }))\n        .filter(\n          (a) =>\n            a.actor && !a.actor.prototypeToken?.actorLink && a.actor.isOwner,\n        )\n        .flatMap((value) =>\n          Array.from(value.actor.items).map((item) => ({\n            item,\n            unlinked: value.unlinked,\n          })),\n        );\n\n      const worldItemsToMigrate = Array.from<any>(game.items).map((item) => ({\n        item,\n        unlinked: true,\n      }));\n\n      const itemsToMigrate = [\n        ...tokenActorItemsToMigrate,\n        ...actorItemsToMigrate,\n        ...worldItemsToMigrate,\n      ].filter((value) => !isNil(getCcssSectionName(value.item), ''));\n\n      new MigrationSelectionApplication<{ item: Item5e; unlinked: boolean }>(\n        {\n          onConfirm: async (selected) => {\n            migrating = true;\n            ui.notifications.info(\n              localize('TIDY5E.Settings.Migrations.migrationBeginningMessage'),\n            );\n\n            for (let choice of selected) {\n              await migrateCcssToTidyForItem({\n                item: choice.item,\n                overwrite: overwrite,\n                clearCcssFlagData: deleteFlags,\n              });\n            }\n\n            migrating = false;\n            ui.notifications.info(\n              localize('TIDY5E.Settings.Migrations.migrationCompleteMessage'),\n            );\n            resetOptions();\n          },\n          columns: [\n            {\n              cellWidth: 'primary',\n              field: {\n                type: 'simple',\n                propPath: 'item.name',\n                onClick: (target) => target.item.sheet.render(true),\n              },\n              name: localize('TIDY5E.Settings.Migrations.Selection.ToMigrate'),\n            },\n            {\n              cellWidth: '8rem',\n              field: {\n                type: 'simple',\n                propPath: `item.${ccssFlagPropPath}`,\n              },\n              name: localize('TIDY5E.Settings.Migrations.CcssToTidy.ccss'),\n            },\n            {\n              cellWidth: '8rem',\n              field: {\n                type: 'simple',\n                propPath: `item.${TidyFlags.section.prop}`,\n              },\n              name: localize('TIDY5E.Settings.Migrations.CcssToTidy.section'),\n            },\n            {\n              cellWidth: '10rem',\n              field: {\n                type: 'simple',\n                propPath: `item.parent.name`,\n                onClick: (target) => target.item.parent?.sheet?.render(true),\n              },\n              name: localize('TIDY5E.Settings.Migrations.Parent'),\n            },\n            {\n              cellWidth: '10rem',\n              name: '',\n              field: {\n                type: 'contextual',\n                getText: ({ unlinked }) =>\n                  unlinked\n                    ? FoundryAdapter.localize('TIDY5E.TokenUnlinked')\n                    : FoundryAdapter.localize('DOCUMENT.Actor'),\n              },\n            },\n          ],\n          documents: itemsToMigrate,\n          title: FoundryAdapter.localize(\n            'TIDY5E.Settings.Migrations.CcssToTidy.selectionDialogTitle',\n          ),\n        },\n        () => {\n          migrating = false;\n        },\n        {\n          width: 960,\n        },\n      ).render(true);\n    } catch (e) {\n      error('An error occurred while preparing a bulk migration', false, e);\n    }\n  }\n\n  async function migrateCompendia() {\n    const compendiaForMigrating = Array.from(game.packs.values())\n      .filter((c: any) => !c.locked && c.documentName === 'Item')\n      .map((c: any) => ({\n        label: c.metadata.label,\n        type: c.metadata.type,\n        id: c.metadata.id,\n        size: c.index.size,\n      }));\n\n    new MigrationSelectionApplication<CompendiumToMigrate>({\n      onConfirm: async (selected) => {\n        ui.notifications.info(\n          localize(`TIDY5E.Settings.Migrations.migrationBeginningMessage`),\n        );\n        for (const compendium of selected) {\n          debug(`Migrating compendium \"${compendium.label}\"...`);\n          try {\n            const items = await game.packs.get(compendium.id).getDocuments();\n            for (const item of items) {\n              await migrateCcssToTidyForItem({\n                item: item,\n                overwrite: overwrite,\n                clearCcssFlagData: deleteFlags,\n              });\n            }\n            debug(`Compendium \"${compendium.label}\" migration successful.`);\n          } catch (e) {\n            error(\n              localize('TIDY5E.Settings.Migrations.migrationErrorMessage'),\n              true,\n            );\n            error(\n              `Error while migrating compendium \"${compendium.label}\"`,\n              false,\n              e,\n            );\n          }\n        }\n        ui.notifications.info(\n          localize(`TIDY5E.Settings.Migrations.migrationCompleteMessage`),\n        );\n      },\n      columns: [\n        {\n          cellWidth: 'primary',\n          field: {\n            type: 'simple',\n            propPath: 'label',\n            onClick: (target) => game.packs.get(target.id).render(true),\n          },\n          name: localize(\n            'TIDY5E.Settings.Migrations.MigrateCompendia.CompendiumLabel',\n          ),\n        },\n        {\n          cellWidth: '5rem',\n          field: {\n            type: 'contextual',\n            getText: (c) => localize(`DOCUMENT.${c.type}`),\n          },\n          name: localize('Type'),\n        },\n        {\n          cellWidth: '10rem',\n          field: {\n            type: 'simple',\n            propPath: 'size',\n          },\n          name: localize(\n            'TIDY5E.Settings.Migrations.MigrateCompendia.TotalEntriesLabel',\n          ),\n        },\n      ],\n      documents: compendiaForMigrating,\n      title: localize(\n        'TIDY5E.Settings.Migrations.MigrateCompendia.SelectionDialogTitle',\n      ),\n    }).render(true);\n  }\n\n  function resetOptions() {\n    overwrite = false;\n    deleteFlags = false;\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<section>\n  <h2>\n    {localize('TIDY5E.Settings.Migrations.CcssToTidy.sectionTitle')}\n  </h2>\n  <div class=\"callout-banner\">\n    <p>{localize('TIDY5E.Settings.Migrations.CcssToTidy.explanation1')}</p>\n  </div>\n  <p>{localize('TIDY5E.Settings.Migrations.UnlinkedExplanation')}</p>\n  <h3>{localize('TIDY5E.Settings.Migrations.OptionsHeader')}</h3>\n  <div class=\"options grid-auto-columns\">\n    <label\n      class=\"green-checkbox\"\n      data-tooltip={localize(\n        'TIDY5E.Settings.Migrations.CcssToTidy.overwriteTooltip',\n      )}\n    >\n      <input type=\"checkbox\" bind:checked={overwrite} disabled={migrating} />\n      {localize('TIDY5E.Settings.Migrations.CcssToTidy.overwrite')}\n    </label>\n    <label\n      class=\"green-checkbox\"\n      data-tooltip={localize(\n        'TIDY5E.Settings.Migrations.CcssToTidy.deleteFlagsTooltip',\n      )}\n    >\n      <input type=\"checkbox\" bind:checked={deleteFlags} disabled={migrating} />\n\n      {localize('TIDY5E.Settings.Migrations.CcssToTidy.deleteFlags')}\n    </label>\n  </div>\n\n  <footer class=\"flex-row extra-small-gap\">\n    <button\n      type=\"button\"\n      onclick={(ev) => migrateCompendia()}\n      disabled={migrating}\n      >{localize('TIDY5E.Settings.Migrations.MigrateCompendia.Title')}</button\n    >\n    <button type=\"button\" onclick={(ev) => migrate()} disabled={migrating}\n      >{localize('TIDY5E.Settings.Migrations.ButtonMigration.Text')}</button\n    >\n  </footer>\n</section>\n\n<style lang=\"scss\">\n  section {\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n  }\n\n  .options {\n    margin-top: 0.5rem;\n    margin-bottom: 0.5rem;\n  }\n\n  footer {\n    margin-top: auto;\n  }\n\n  .callout-banner {\n    background: var(--t5e-faintest-color);\n    margin: -0.5rem -0.5rem 1rem -0.5rem;\n    padding: 0.5rem 1rem;\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { Tab } from 'src/types/types';\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import Notice from 'src/components/notice/Notice.svelte';\n  import CcssToTidyMigration from './v3/CcssToTidyMigration.svelte';\n\n  interface Props {\n    selectedTabId?: string;\n  }\n\n  let {\n    selectedTabId = $bindable(CONSTANTS.TAB_MIGRATIONS_NPC_EXHAUSTION),\n  }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n\n  const tabs: Tab[] = [\n    {\n      id: CONSTANTS.TAB_MIGRATIONS_CCSS_TO_TIDY,\n      title: 'TIDY5E.Settings.Migrations.CcssToTidy.sectionTitle',\n      content: {\n        component: CcssToTidyMigration,\n        type: 'svelte',\n      },\n    },\n  ];\n</script>\n\n<div class=\"bulk-migrations-container\">\n  <div role=\"presentation\" class=\"vertical-tab-container flex-column no-gap\">\n    <Tabs {tabs} bind:selectedTabId orientation=\"vertical\" />\n    <div role=\"presentation\" class=\"remaining-vertical-space\"></div>\n    <Notice>\n      {localize('TIDY5E.ReminderToBackUp')}\n    </Notice>\n  </div>\n\n  <TabContents {tabs} {selectedTabId} cssClass=\"tidy-sheet-body\" />\n</div>\n\n<style lang=\"scss\">\n  .bulk-migrations-container {\n    height: 100%;\n    display: grid;\n    grid-template-areas:\n      'nav    body'\n      'nav    body';\n    grid-template-rows: 1fr auto;\n    grid-template-columns: 12.5rem 1fr;\n    gap: 0.5rem;\n  }\n\n  .vertical-tab-container {\n    grid-area: nav;\n    margin-top: -0.5rem;\n    margin-left: -0.5rem;\n    margin-bottom: -0.5rem;\n  }\n\n  :global(.tidy-sheet-body) {\n    grid-area: body;\n    overflow-y: scroll;\n    padding-top: 0.5rem;\n    padding-right: 0.5rem;\n    margin-right: -0.25rem;\n    flex: 1;\n  }\n\n  .remaining-vertical-space {\n    margin-right: -0.0625rem;\n    border-right: 0.0625rem solid var(--t5e-tab-strip-border-color);\n    flex: 1;\n    background-color: var(--t5e-header-background);\n  }\n</style>\n","import { mount } from 'svelte';\nimport SvelteFormApplicationBase from 'src/applications/SvelteFormApplicationBase';\nimport BulkMigrations from './BulkMigrations.svelte';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\nexport type ConfirmMigrationFunction = (onYes: () => void) => void;\n\ninterface ConfirmsMigrations {\n  confirm: ConfirmMigrationFunction;\n}\n\nexport class BulkMigrationsApplication\n  extends SvelteFormApplicationBase\n  implements ConfirmsMigrations\n{\n  _selectedTabId?: string;\n\n  constructor(selectedTabId?: string) {\n    super();\n\n    this._selectedTabId = selectedTabId;\n  }\n\n  static get defaultOptions() {\n    return FoundryAdapter.mergeObject(super.defaultOptions, {\n      title: FoundryAdapter.localize('TIDY5E.Settings.Migrations.dialogTitle'),\n      width: 650,\n      height: 500,\n      id: 'tidy-5e-sheets-bulk-migrations',\n      popOut: true,\n    });\n  }\n\n  createComponent(node: HTMLElement): Record<string, any> {\n    return mount(BulkMigrations, {\n      target: node,\n      context: new Map<any, any>([['confirm', this.confirm]]),\n      props: {\n        selectedTabId: this._selectedTabId,\n      },\n    });\n  }\n\n  confirm(onYes: () => void) {\n    const dlg = new Dialog({\n      title: FoundryAdapter.localize(\n        'TIDY5E.Settings.Migrations.migrateConfirmTitle'\n      ),\n      content: `\n        <p>${FoundryAdapter.localize(\n          'TIDY5E.Settings.Migrations.migrateConfirmMessage1'\n        )}</p>\n        <p><em>${FoundryAdapter.localize(\n          'TIDY5E.Settings.Migrations.migrateConfirmMessage2',\n          { boldStart: '<strong>', boldEnd: '</strong>' }\n        )}</em></p>\n      `,\n      buttons: {\n        yes: {\n          icon: '<i class=\"fas fa-right-left\"></i>',\n          label: FoundryAdapter.localize(\n            'TIDY5E.Settings.Migrations.migrateConfirmButtonYes'\n          ),\n          callback: () => {\n            onYes();\n          },\n        },\n        cancel: {\n          icon: '<i class=\"fas fa-times\"></i>',\n          label: FoundryAdapter.localize(\n            'TIDY5E.Settings.Migrations.migrateConfirmButtonNo'\n          ),\n        },\n      },\n      default: 'yes',\n      close: () => {},\n    });\n    dlg.render(true);\n  }\n}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"tidy-info-banner\">\n  <a href=\"https://foundryvtt.com/packages/tidy5e-sheet/\" target=\"_blank\">\n    <img\n      class=\"logo\"\n      src=\"../modules/tidy5e-sheet/images/tidy-5e-logo.svg\"\n      alt={localize('TIDY5E.Settings.About.logoAltText')}\n    />\n  </a>\n  <p class=\"banner-text\">\n    {@html localize('TIDY5E.Settings.About.MaintainerParagraph', {\n      urlStart: '<a href=\"https://github.com/kgar\" target=\"_blank\">',\n      urlEnd: '</a>',\n    })}\n  </p>\n</div>\n<p>\n  {@html localize('TIDY5E.Settings.About.GithubParagraph', {\n    urlStart:\n      '<a href=\"https://github.com/kgar/foundry-vtt-tidy-5e-sheets/issues\" target=\"_blank\">',\n    urlEnd: '</a>',\n  })}\n</p>\n\n<h3>{localize('TIDY5E.Settings.About.FinancialSupportHeader')}</h3>\n<p>\n  {@html localize('TIDY5E.Settings.About.DiscordParagraph', {\n    urlStart: '<a href=\"https://discord.gg/kdqbcWJrYU\" target=\"_blank\">',\n    urlEnd: '</a>',\n  })}\n</p>\n<p>\n  {@html localize('TIDY5E.Settings.About.LocalizationParagraph', {\n    urlStart:\n      '<a href=\"https://hosted.weblate.org/projects/foundry-vtt-tidy-5e-sheets/\" target=\"_blank\">',\n    urlEnd: '</a>',\n  })}\n</p>\n<p>\n  {localize('TIDY5E.Settings.About.FinancialSupportParagraph')}\n</p>\n<ul>\n  <li>\n    {@html localize('TIDY5E.Settings.About.BuyMeACoffeeLink', {\n      urlStart: '<a href=\"https://www.buymeacoffee.com/kgar\" target=\"_blank\">',\n      urlEnd: '</a>',\n    })}\n  </li>\n  <li>\n    {@html localize('TIDY5E.Settings.About.KoFiLink', {\n      urlStart: '<a href=\"https://ko-fi.com/iamkgar\" target=\"_blank\">',\n      urlEnd: '</a>',\n    })}\n  </li>\n  <li>\n    {@html localize('TIDY5E.Settings.About.PatreonLink', {\n      urlStart: '<a href=\"https://www.patreon.com/iamkgar\" target=\"_blank\">',\n      urlEnd: '</a>',\n    })}\n  </li>\n</ul>\n\n<style lang=\"scss\">\n  .tidy-info-banner {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    background-color: var(--t5e-header-background);\n    margin-top: -0.5rem;\n    margin-left: -0.5rem;\n    margin-right: -0.5rem;\n    margin-bottom: 1rem;\n    min-height: 10rem;\n    padding-left: 2rem;\n    padding-right: 2rem;\n  }\n\n  .logo {\n    max-width: 7.5rem;\n    animation: TheShining 16s infinite;\n  }\n\n  @keyframes TheShining {\n    0% {\n      filter: drop-shadow(0 0 0.625rem var(--t5e-primary-accent-color));\n    }\n    50% {\n      filter: drop-shadow(0 0 5rem var(--t5e-primary-accent-color))\n        hue-rotate(90deg);\n    }\n    100% {\n      filter: drop-shadow(0 0 0.625rem var(--t5e-primary-accent-color))\n        hue-rotate(360deg);\n    }\n  }\n</style>\n","import SvelteFormApplicationBase from 'src/applications/SvelteFormApplicationBase';\nimport { mount } from 'svelte';\nimport Info from './About.svelte';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\nexport class AboutApplication extends SvelteFormApplicationBase {\n  static get defaultOptions() {\n    return FoundryAdapter.mergeObject(super.defaultOptions, {\n      width: 450,\n      height: 'auto',\n      sheetConfig: false,\n      id: 'tidy-5e-sheets-about-window',\n      popOut: true,\n    });\n  }\n\n  get title() {\n    return FoundryAdapter.localize('TIDY5E.Settings.About.dialogTitle');\n  }\n\n  createComponent(node: HTMLElement): Record<string, any> {\n    return mount(Info, {\n      target: node,\n    });\n  }\n}\n","<script lang=\"ts\">\n  import { type SheetPreferenceOption } from './ApplyTidySheetPreferencesApplication.svelte';\n  import { ApplyTidySheetPreferencesApplication } from './ApplyTidySheetPreferencesApplication.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import TidyTable, {\n    type TidyTableColumns,\n  } from 'src/components/table/TidyTable.svelte';\n  import TidyTableHeaderRow from 'src/components/table/TidyTableHeaderRow.svelte';\n  import TidyTableHeaderCell from 'src/components/table/TidyTableHeaderCell.svelte';\n  import TidyTableRow from 'src/components/table/TidyTableRow.svelte';\n  import TidyTableCell from 'src/components/table/TidyTableCell.svelte';\n\n  interface Props {\n    options: SheetPreferenceOption[];\n    onConfirm: ApplyTidySheetPreferencesApplication['_onConfirm'];\n  }\n\n  let { options, onConfirm }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n\n  const gridTemplateColumns: TidyTableColumns = [\n    {\n      name: 'Select',\n      width: '2.5rem',\n    },\n    {\n      name: 'Label',\n      width: '1fr',\n    },\n  ];\n\n  let totalSelected = $derived(options.filter((t) => t.selected).length);\n  let allSelected = $derived(totalSelected >= options.length);\n\n  function toggleAll() {\n    const targetState = !allSelected;\n    options.forEach((o) => (o.selected = targetState));\n  }\n\n  function getRandomId() {\n    return foundry.utils.randomID();\n  }\n</script>\n\n<div class=\"sheet-preferences-container\">\n  <div class=\"p\">\n    {localize('TIDY5E.Settings.SheetPreferences.explanation')}\n  </div>\n  <div class=\"scroll-container\">\n    <TidyTable\n      key=\"default-sheet-preferences\"\n      toggleable={false}\n      {gridTemplateColumns}\n    >\n      {#snippet header()}\n        <TidyTableHeaderRow>\n          <TidyTableHeaderCell>\n            <input\n              type=\"checkbox\"\n              checked={allSelected}\n              onclick={() => toggleAll()}\n              title={localize(\n                'TIDY5E.Settings.Migrations.Selection.SelectAllNoneTooltip',\n              )}\n            />\n          </TidyTableHeaderCell>\n          <TidyTableHeaderCell primary={true}\n            >{localize('Sheet')}</TidyTableHeaderCell\n          >\n        </TidyTableHeaderRow>\n      {/snippet}\n      {#snippet body()}\n        {#each options as option}\n          {@const checkboxId = getRandomId()}\n          <TidyTableRow>\n            <TidyTableCell\n              ><input\n                type=\"checkbox\"\n                id={checkboxId}\n                bind:checked={option.selected}\n              /></TidyTableCell\n            >\n            <TidyTableCell primary={true}\n              ><label for={checkboxId}>{option.label}</label></TidyTableCell\n            >\n          </TidyTableRow>\n        {/each}\n      {/snippet}\n    </TidyTable>\n  </div>\n  <footer>\n    <p>\n      {localize('TIDY5E.Settings.Migrations.Selection.TotalSelectedLabel', {\n        total: totalSelected,\n      })}\n    </p>\n    <button type=\"button\" onclick={() => onConfirm()}\n      >{localize('TIDY5E.ButtonConfirm.Text')}</button\n    >\n  </footer>\n</div>\n\n<style lang=\"scss\">\n  .sheet-preferences-container {\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n\n    > .scroll-container {\n      flex: 1;\n    }\n  }\n\n  footer {\n    margin-left: -0.5rem;\n    margin-right: -0.5rem;\n    padding-left: 0.5rem;\n    padding-right: 0.5rem;\n    border-top: 0.0625rem solid var(--t5e-faint-color);\n  }\n\n  input[type='checkbox'] {\n    flex-basis: 0.75rem;\n    width: auto;\n    height: auto;\n    margin: 0;\n    padding: 0;\n    line-height: 0.75rem;\n  }\n\n  label {\n    flex: 1;\n    padding: 0.25rem 0;\n  }\n</style>\n","<script lang=\"ts\">\n  import { getExhaustionIconsWithSeverity } from 'src/features/exhaustion/exhaustion';\n  import type {\n    SpecificExhaustionConfig,\n    IconWithSeverity,\n  } from 'src/features/exhaustion/exhaustion.types';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type {\n    ActorSheetContextV1,\n    PortraitCharmRadiusClass,\n  } from 'src/types/types';\n  import { coalesce } from 'src/utils/formatting';\n\n  interface Props {\n    cssClass?: string;\n    radiusClass: PortraitCharmRadiusClass;\n    level: number;\n    onlyShowOnHover?: boolean;\n    exhaustionConfig: SpecificExhaustionConfig;\n    isActiveEffectApplied: boolean;\n    onLevelSelected?: (level: number) => void;\n  }\n\n  let {\n    cssClass = '',\n    radiusClass,\n    level,\n    onlyShowOnHover = false,\n    exhaustionConfig,\n    isActiveEffectApplied,\n    onLevelSelected,\n  }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n\n  let iconsWithSeverities: IconWithSeverity[] = $derived.by(() => {\n    return getExhaustionIconsWithSeverity(exhaustionConfig.levels);\n  });\n\n  let selectedLevel: IconWithSeverity | null = $derived(\n    iconsWithSeverities[level] ?? iconsWithSeverities.at(-1),\n  );\n\n  let severityClass: string = $derived(\n    `severity-${selectedLevel?.severity ?? 0}`,\n  );\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  let exhaustionOptionWidthRems = 1.25;\n\n  let exhaustionExpandedWidth = $derived(\n    `${exhaustionOptionWidthRems * (exhaustionConfig.levels + 1) + 2.125}rem`,\n  );\n</script>\n\n<div\n  class=\"exhaustion-container {severityClass} {cssClass}\"\n  class:only-show-on-hover={onlyShowOnHover}\n  style=\"--t5e-exhaustion-expanded-width: {exhaustionExpandedWidth}\"\n>\n  <div class=\"exhaustion-wrap {radiusClass}\">\n    <div\n      class=\"exhaustion-icon colorized\"\n      title={exhaustionConfig.hints[level] ??\n        localize('TIDY5E.ExhaustionLevelTooltip', { level: level })}\n    >\n      <i class={selectedLevel.iconCssClass ?? ''}></i>\n    </div>\n    <ul class=\"exhaustion-levels\">\n      {#each iconsWithSeverities as _, i}\n        <li>\n          <button\n            type=\"button\"\n            class=\"exhaustion-level-option transparent-button\"\n            class:colorized={i <= level}\n            title={localize(\n              coalesce(\n                exhaustionConfig.hints[i],\n                'TIDY5E.ExhaustionLevelTooltip',\n              ),\n              { level: i },\n            )}\n            onclick={() => onLevelSelected?.(i)}\n            disabled={!context.editable || isActiveEffectApplied}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n            data-tooltip={isActiveEffectApplied\n              ? localize('DND5E.ActiveEffectOverrideWarning')\n              : null}\n          >\n            {i}\n          </button>\n        </li>\n      {/each}\n    </ul>\n  </div>\n  <div class=\"level-display\" class:colorized={level > 0}>\n    {level}\n  </div>\n</div>\n\n<style lang=\"scss\">\n  .exhaustion-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    height: 2.125rem;\n    width: 2.125rem;\n    z-index: 1;\n    color: var(--t5e-icon-font-color);\n\n    .level-display {\n      display: block;\n      width: 1rem;\n      height: 1rem;\n      line-height: 0.875rem;\n      text-align: center;\n      font-size: 0.875rem;\n      position: absolute;\n      background: var(--t5e-icon-background);\n      box-shadow: 0 0 0.5rem var(--t5e-icon-shadow-color) inset;\n      border: 0.0625rem solid var(--t5e-icon-outline-color);\n      top: -0.125rem;\n      left: -0.125rem;\n      border-radius: 50%;\n      font-weight: 700;\n    }\n\n    &:hover .exhaustion-wrap,\n    .exhaustion-wrap:has(:global(button:focus-visible)) {\n      width: var(--t5e-exhaustion-expanded-width);\n    }\n\n    .exhaustion-wrap {\n      height: 2.125rem;\n      width: 2.125rem;\n      overflow: hidden;\n      transition: width 0.3s ease;\n      background: var(--t5e-icon-background);\n      display: flex;\n      box-shadow: 0 0 0.625rem var(--t5e-icon-shadow-color) inset;\n      border: 0.0625rem solid var(--t5e-icon-outline-color);\n\n      &.rounded {\n        border-radius: 1.25rem;\n      }\n\n      .exhaustion-icon {\n        display: block;\n        flex: 0 0 2rem;\n        width: 2rem;\n        height: 2rem;\n        line-height: 2.125rem;\n        text-align: center;\n        font-size: 1.5rem;\n        position: relative;\n      }\n\n      .exhaustion-levels {\n        list-style: none;\n        margin: 0;\n        padding: 0;\n        display: flex;\n        flex: 1;\n\n        li {\n          flex: 0 0 1.25rem;\n          text-align: center;\n          line-height: 2.125rem;\n          display: flex;\n\n          .exhaustion-level-option {\n            border-radius: 0;\n\n            &:is(:global(:hover, :focus-visible)) {\n              background: var(--t5e-tertiary-color);\n              color: var(--t5e-primary-font-color);\n            }\n          }\n        }\n      }\n    }\n\n    .exhaustion-levels .exhaustion-level-option:not(.colorized) {\n      background: var(--t5e-light-color);\n    }\n\n    &.severity-0 .colorized {\n      background: transparent;\n    }\n\n    &.severity-1 .colorized {\n      background: var(--t5e-exhaustion-severity1-background);\n      color: var(--t5e-exhaustion-severity1-color);\n    }\n\n    &.severity-2 .colorized {\n      background: var(--t5e-exhaustion-severity2-background);\n      color: var(--t5e-exhaustion-severity2-color);\n    }\n\n    &.severity-3 .colorized {\n      background: var(--t5e-exhaustion-severity3-background);\n      color: var(--t5e-exhaustion-severity3-color);\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type {\n    PortraitCharmRadiusClass,\n  } from 'src/types/types';\n  \n  let context = $derived(getCharacterSheetContext());\n\n  interface Props {\n    inspired: boolean;\n    cssClass?: string;\n    radiusClass: PortraitCharmRadiusClass;\n    onlyShowOnHover?: boolean;\n    animate?: boolean;\n  }\n\n  let {\n    inspired,\n    cssClass = '',\n    radiusClass,\n    onlyShowOnHover = false,\n    animate = true,\n  }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div\n  class=\"inspiration inspiration-{inspired ? 1 : 0} {cssClass}\"\n  class:only-show-on-hover={onlyShowOnHover}\n  title={localize('DND5E.Inspiration')}\n>\n  <Checkbox\n    checkboxCssClass=\"inspiration-toggle\"\n    labelCssClass=\"{inspired ? 'inspired' : ''} {radiusClass} {context.editable\n      ? 'pointer'\n      : ''}\"\n    document={context.actor}\n    field=\"system.attributes.inspiration\"\n    checked={inspired}\n    disabled={!context.editable}\n  >\n    <i class=\"inspiration-icon fas fa-dice-d20\" class:animate></i>\n  </Checkbox>\n</div>\n\n<style lang=\"scss\">\n  .inspiration {\n    position: absolute;\n    right: 0;\n    top: 0;\n    width: 2.125rem;\n    height: 2.125rem;\n\n    :global(input.inspiration-toggle) {\n      display: none;\n    }\n\n    :global(label) {\n      width: 100%;\n      height: 100%;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      font-size: 1.5rem;\n      color: var(--t5e-icon-font-color);\n      box-shadow: 0 0 0.625rem var(--t5e-icon-shadow-color) inset;\n      border: 0.0625rem solid var(--t5e-icon-outline-color);\n      background: var(--t5e-icon-background);\n    }\n\n    :global(label i) {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      border-radius: 50%;\n      text-align: center;\n      line-height: 2.125rem;\n    }\n\n    :global(label:hover) {\n      color: var(--t5e-inspiration-hover-color);\n      text-shadow: 0 0 0.3125rem var(--t5e-inspiration-text-shadow-hover-color);\n    }\n  }\n\n  .inspiration-1 {\n    :global(label) {\n      color: var(--t5e-activated-profile-toggle-color);\n      text-shadow: 0 0 0.625rem\n        var(--t5e-inspiration-inspired-text-shadow-color);\n      background: var(--t5e-inspiration-inspired-background);\n    }\n\n    :global(label i.animate) {\n      color: var(--t5e-activated-profile-toggle-color);\n      animation: glow 5s ease-in-out infinite alternate;\n    }\n  }\n\n  @keyframes glow {\n    0% {\n      transform: scale(1);\n    }\n    25% {\n      transform: scale(1.2);\n    }\n    60% {\n      transform: scale(1);\n    }\n    100% {\n      transform: scale(1.1);\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { CharacterSheetContext, NpcSheetContext } from 'src/types/types';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context =\n    $derived(getSheetContext<CharacterSheetContext | NpcSheetContext>());\n\n  interface Props {\n    hasHpOverlay: boolean;\n  }\n\n  let { hasHpOverlay }: Props = $props();\n\n  let hideDeathSaves = $derived(\n    settings.value.hideDeathSavesFromPlayers && !FoundryAdapter.userIsGm(),\n  );\n\n  function rollDeathSave(event: MouseEvent) {\n    context.actor.rollDeathSave(\n      {\n        event: event,\n        legacy: false,\n      },\n      {\n        options: {\n          default: {\n            rollMode: settings.value.defaultDeathSaveRoll,\n          },\n        },\n      },\n    );\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"death-saves\" class:rounded={context.useRoundedPortraitStyle}>\n  <div class=\"death-save-counters\" class:show-backdrop={!hasHpOverlay}>\n    <i class=\"fas fa-check\" class:hidden={hideDeathSaves}></i>\n    <TextInput\n      document={context.actor}\n      field=\"system.attributes.death.success\"\n      class=\"death-save-result {hideDeathSaves ? 'hidden' : ''}\"\n      selectOnFocus={true}\n      allowDeltaChanges={true}\n      placeholder=\"0\"\n      value={context.system.attributes.death.success}\n      maxlength={1}\n      title={localize('DND5E.DeathSaveSuccesses')}\n      disabled={!context.editable}\n      attributes={{\n        ['data-tidy-sheet-part']: CONSTANTS.SHEET_PARTS.DEATH_SAVE_SUCCESSES,\n      }}\n    />\n\n    <button\n      type=\"button\"\n      class=\"death-save rollable\"\n      onclick={(event) => rollDeathSave(event)}\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.DEATH_SAVE_ROLLER}\n      tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n    >\n      <i class=\"fas fa-skull\"></i>\n    </button>\n\n    <TextInput\n      document={context.actor}\n      field=\"system.attributes.death.failure\"\n      class=\"death-save-result {hideDeathSaves ? 'hidden' : ''}\"\n      selectOnFocus={true}\n      allowDeltaChanges={true}\n      placeholder=\"0\"\n      value={context.system.attributes.death.failure}\n      maxlength={1}\n      disabled={!context.editable}\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.DEATH_SAVE_FAILURES}\n      title={localize('DND5E.DeathSaveFailures')}\n      attributes={{\n        ['data-tidy-sheet-part']: CONSTANTS.SHEET_PARTS.DEATH_SAVE_FAILURES,\n      }}\n    />\n    <i class=\"fas fa-times\" class:hidden={hideDeathSaves}></i>\n  </div>\n</div>\n\n<style lang=\"scss\">\n  .death-saves {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    border-radius: 0.3125rem;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    text-shadow: 0 0 0.3125rem 0.0625rem var(--t5e-death-save-text-shadow-color);\n    pointer-events: none;\n\n    .death-save-counters {\n      pointer-events: auto;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      color: var(--t5e-death-save-text-color);\n\n      &.show-backdrop {\n        background: var(--t5e-death-save-backdrop-background);\n        padding: 0 0.5rem;\n        border-radius: 0.3125rem;\n      }\n\n      :global(input[type='text'].death-save-result) {\n        color: var(--t5e-death-save-text-color);\n        font-weight: 700;\n        font-size: 1rem;\n        height: 1.1875rem;\n        padding: 0.3125rem 0.25rem 0.25rem 0.25rem;\n        min-width: unset;\n        text-align: center;\n        width: 1.125rem;\n      }\n\n      :global(input:hover) {\n        border-color: var(--t5e-death-save-text-color);\n      }\n\n      :global(.death-save) {\n        position: relative;\n        margin: 0 0.25rem;\n        color: var(--t5e-death-save-icon-color);\n        font-size: 1.875rem;\n        transition: color 0.3s ease;\n        border: none;\n        padding: 0;\n      }\n\n      :global(.death-save:hover) {\n        background: none;\n        color: var(--t5e-death-save-text-color);\n      }\n    }\n  }\n\n  .rounded {\n    border-radius: 50%;\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getCharacterSheetContext());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"rest-container\" class:rounded={context.useRoundedPortraitStyle}>\n  <div class=\"resting\">\n    <span class=\"resting-icon\" title={localize('TIDY5E.RestHint')}\n      ><i class=\"rest-icon fas fa-bed\"></i></span\n    >\n    <button\n      type=\"button\"\n      class=\"rest icon-button\"\n      title={localize('TIDY5E.ShortRest')}\n      onclick={(event) => context.actor.sheet.onShortRest(event)}\n      disabled={!context.editable}\n      tabindex={!settings.value.useDefaultSheetHpTabbing &&\n      settings.value.useAccessibleKeyboardSupport\n        ? 0\n        : -1}\n    >\n      <i class=\"fas fa-hourglass-half\"></i>\n    </button>\n    <button\n      type=\"button\"\n      class=\"rest icon-button\"\n      title={localize('TIDY5E.LongRest')}\n      onclick={(event) => context.actor.sheet.onLongRest(event)}\n      disabled={!context.editable}\n      tabindex={!settings.value.useDefaultSheetHpTabbing &&\n      settings.value.useAccessibleKeyboardSupport\n        ? 0\n        : -1}\n    >\n      <i class=\"fas fa-hourglass-end\"></i>\n    </button>\n  </div>\n</div>\n\n<style lang=\"scss\">\n  .rest-container {\n    position: absolute;\n    left: 0;\n    bottom: 0;\n\n    &.rounded {\n      bottom: -0.4375rem;\n\n      .resting {\n        border-radius: 1.25rem;\n      }\n    }\n\n    .resting {\n      &:is(:global(:hover)),\n      &:has(:global(button:focus-visible)) {\n        width: 6.875rem;\n      }\n    }\n  }\n\n  .resting {\n    width: 2.125rem;\n    height: 2.125rem;\n    overflow: hidden;\n    border-radius: 0 0.3125rem 0 0.3125rem;\n    transition: width 0.3s ease;\n    background: var(--t5e-icon-background);\n    display: flex;\n    box-shadow: 0 0 0.625rem var(--t5e-icon-shadow-color) inset;\n    border: 0.0625rem solid var(--t5e-icon-outline-color);\n    color: var(--t5e-icon-font-color);\n\n    .resting-icon {\n      flex: 0 0 2rem;\n      display: flex;\n      width: 2rem;\n      height: 2rem;\n      margin-right: 0.5rem;\n      justify-content: center;\n      align-items: center;\n      border-radius: 50%;\n      font-size: 1rem;\n    }\n\n    .rest {\n      flex: 0 0 2rem;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      width: 2rem;\n      height: 2rem;\n      border-radius: 50%;\n      font-size: 1.125rem;\n      line-height: 2rem;\n      font-weight: 700;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getCharacterSheetContext());\n\n  let hitDice = $derived(context.system.attributes.hd);\n  let actorLevel = $derived(context.system.details.level);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div\n  class=\"portrait-hd\"\n  class:rounded={context.useRoundedPortraitStyle}\n  title=\"{localize('DND5E.HitDice')}: {hitDice}/{actorLevel}&#10;{localize(\n    'DND5E.HitDiceConfig',\n  )}\"\n>\n  <button\n    type=\"button\"\n    class=\"current-hd config-button transparent-button\"\n    onclick={context.editable &&\n      FoundryAdapter.renderHitDiceConfig(context.actor)}\n    disabled={!context.editable}\n    tabindex={!settings.value.useDefaultSheetHpTabbing &&\n    settings.value.useAccessibleKeyboardSupport\n      ? 0\n      : -1}\n  >\n    {hitDice}\n  </button>\n</div>\n\n<style lang=\"scss\">\n  .portrait-hd {\n    position: absolute;\n    right: 0;\n    bottom: 0;\n    width: 2.125rem;\n    height: 2.125rem;\n    background: var(--t5e-icon-background);\n    box-shadow: 0 0 0.625rem var(--t5e-icon-shadow-color) inset;\n    border: 0.0625rem solid var(--t5e-icon-outline-color);\n    border-radius: 0.3125rem 0 0.3125rem 0;\n    color: var(--t5e-icon-font-color);\n\n    &.rounded {\n      bottom: -0.4375rem;\n      border-radius: 50%;\n    }\n\n    .current-hd {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      height: 100%;\n      font-family: var(--t5e-title-font-family);\n      font-size: 1.25rem;\n      font-weight: 700;\n      border-radius: 50%;\n      color: var(--t5e-icon-font-color);\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { type Actor5e } from 'src/types/types';\n  import { settings } from 'src/settings/settings.svelte';\n  import HpBar from 'src/components/bar/HpBar.svelte';\n  import ResourceWithBar from 'src/components/bar/ResourceWithBar.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    value: number;\n    max: number;\n    actor: Actor5e;\n    incapacitated: boolean;\n  }\n\n  let { value, max, actor, incapacitated }: Props = $props();\n\n  let context = $derived(getCharacterSheetContext());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div\n  class=\"portrait-hp\"\n  class:incapacitated\n  class:widen-for-rounded-portrait={context.useRoundedPortraitStyle}\n  title={localize('DND5E.HitPoints')}\n>\n  <ResourceWithBar\n    document={actor}\n    {value}\n    valueField=\"system.attributes.hp.value\"\n    valueTitle={localize('DND5E.HitPointsCurrent')}\n    valueDisabled={!context.editable}\n    {max}\n    maxField=\"system.attributes.hp.max\"\n    maxTitle={localize('DND5E.HitPointsMax')}\n    maxDisabled={!context.allowMaxHpOverride ||\n      !context.editable ||\n      context.lockHpMaxChanges ||\n      context.lockSensitiveFields}\n    percentage={context.healthPercentage}\n    Bar={settings.value.useHpBar ? HpBar : null}\n  />\n</div>\n\n<style lang=\"scss\">\n  .portrait-hp {\n    position: absolute;\n    width: 5.25rem;\n    left: 50%;\n    height: 1.25rem;\n    font-size: 1.125rem;\n    transform: translateX(-50%);\n    bottom: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-family: var(--t5e-title-font-family);\n\n    :global(.resource-value),\n    :global(.resource-max) {\n      font-weight: 700;\n    }\n\n    &.widen-for-rounded-portrait {\n      width: 5.5rem;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import type { CharacterSheetContext, NpcSheetContext } from 'src/types/types';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context =\n    $derived(getSheetContext<CharacterSheetContext | NpcSheetContext>());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"profile-temp\">\n  <TextInput\n    document={context.actor}\n    field=\"system.attributes.hp.temp\"\n    class=\"temphp\"\n    placeholder=\"+{localize('DND5E.Temp')}\"\n    value={context.hp.temp?.toString() ?? ''}\n    allowDeltaChanges={true}\n    title={localize('DND5E.HitPointsTemp')}\n    disabled={!context.editable}\n    selectOnFocus={true}\n  />\n  <TextInput\n    document={context.actor}\n    field=\"system.attributes.hp.tempmax\"\n    class=\"max-temphp\"\n    placeholder=\"+{localize('DND5E.Max')}\"\n    value={context.hp.tempmax?.toString() ?? ''}\n    title={localize('DND5E.HitPointsTempMax')}\n    disabled={!context.editable}\n    selectOnFocus={true}\n  />\n  {#if context.editable && context.unlocked}\n    <button\n      type=\"button\"\n      class=\"inline-icon-button\"\n      title={localize('DND5E.HitPointsConfig')}\n      onclick={(event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        FoundryAdapter.renderHitPointsDialog(context.actor);\n      }}\n      tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n    >\n      <i class=\"fas fa-cog\"></i>\n    </button>\n  {/if}\n</div>\n\n<style lang=\"scss\">\n  .profile-temp {\n    display: flex;\n    justify-content: center;\n\n    :global(input) {\n      flex: 0 0 2.1875rem; // Or hard width\n      display: flex;\n      font-size: 0.75rem;\n      line-height: 0.75rem;\n      height: 0.875rem;\n      padding: 0.0625rem 0;\n    }\n\n    :global(input.temphp) {\n      text-align: center;\n    }\n\n    :global(input.max-temphp) {\n      text-align: center;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { type Actor5e } from 'src/types/types';\n  import type {\n    ActorSheetContextV1,\n    ActorSheetContextV2,\n  } from 'src/types/types';\n  import { isNil } from 'src/utils/data';\n  import { debug, error } from 'src/utils/logging';\n  import { TidyHooks } from 'src/foundry/TidyHooks';\n  import type { ContextMenuEntry } from 'src/foundry/foundry.types';\n  import FloatingContextMenu from 'src/context-menu/FloatingContextMenu';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    actor: Actor5e;\n    useHpOverlay: boolean;\n  }\n\n  let { actor, useHpOverlay }: Props = $props();\n\n  let context =\n    $derived(getSheetContext<ActorSheetContextV1 | ActorSheetContextV2<any>>());\n\n  const localize = FoundryAdapter.localize;\n\n  let actorImageTitle = $derived(\n    context.unlocked\n      ? `${localize('TIDY5E.EditSheetImageHint')} / ${localize('TIDY5E.SheetImageOptionsHint')}`\n      : `${localize('TIDY5E.PreviewSheetImageHint')} / ${localize('TIDY5E.SheetImageOptionsHint')}`,\n  );\n\n  function openPortraitPicker(\n    event: MouseEvent & { currentTarget: EventTarget & HTMLElement },\n  ) {\n    if (!TidyHooks.tidy5eSheetsPreOpenActorPortraitFilePicker(context, event)) {\n      return;\n    }\n    const rect = event.currentTarget.getBoundingClientRect();\n    const current = actor.img;\n    const fp = new FilePicker({\n      type: 'image',\n      current,\n      callback: (path: string) => {\n        actor.update({ img: path });\n      },\n      top: rect.top + 40,\n      left: rect.left + 10,\n    });\n    return fp.browse();\n  }\n\n  function onPortraitClick(\n    event: MouseEvent & { currentTarget: EventTarget & HTMLElement },\n  ) {\n    switch (event.button) {\n      case CONSTANTS.MOUSE_BUTTON_MAIN:\n        if (context.unlocked) {\n          openPortraitPicker(event);\n        } else {\n          FoundryAdapter.renderImagePopout(context.actor.img, {\n            title: FoundryAdapter.localize('TIDY5E.PortraitTitle', {\n              subject: context.actor.name,\n            }),\n            shareable: true,\n            uuid: context.actor.uuid,\n          });\n        }\n        break;\n    }\n  }\n\n  let portraitContainer: HTMLElement;\n\n  // TODO: Consider sending context menu options down through document context in the first place.\n  let contextMenuOptions: ContextMenuEntry[] = $derived.by(() => {\n    try {\n      return context.actorPortraitCommands.map((c) => ({\n        name: c.label ?? '',\n        icon: !isNil(c.iconClass, '') ? `<i class=\"${c.iconClass}\"></i>` : '',\n        callback: () => c.execute?.({ actor, context: context }),\n      }));\n    } catch (e) {\n      error('An error occurred while getting context menu options', false, e);\n      debug('Context menu option error troubleshooting info', {\n        portraitContainer,\n        commands: context.actorPortraitCommands,\n      });\n    }\n\n    return [];\n  });\n\n  $effect(() => {\n    new FloatingContextMenu(\n      FoundryAdapter.getJqueryWrappedElement(portraitContainer),\n      `[data-tidy-sheet-part=${CONSTANTS.SHEET_PARTS.ACTOR_PORTRAIT_CONTAINER}]`,\n      [],\n      {\n        onOpen: () => {\n          ui.context.menuItems = contextMenuOptions;\n        },\n      },\n    );\n  });\n</script>\n\n<div\n  bind:this={portraitContainer}\n  class=\"portrait\"\n  class:round-portrait={context.useRoundedPortraitStyle}\n  onmousedown={onPortraitClick}\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ACTOR_PORTRAIT_CONTAINER}\n>\n  <div\n    class=\"actor-image-wrap\"\n    class:overlay={useHpOverlay}\n    style=\"--overlay-height: calc(100% - {context.healthPercentage}%)\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ACTOR_PORTRAIT_HEALTH_OVERLAY}\n  >\n    <img\n      class=\"actor-image\"\n      src={actor.img}\n      alt={actor.name}\n      title={actorImageTitle}\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ACTOR_PORTRAIT_IMAGE}\n    />\n  </div>\n</div>\n\n<style lang=\"scss\">\n  .portrait,\n  .actor-image-wrap,\n  .actor-image {\n    width: 100%;\n    height: 100%;\n  }\n\n  .portrait {\n    border-radius: 0.3125rem;\n    overflow: hidden;\n  }\n\n  .actor-image-wrap {\n    position: relative;\n    overflow: hidden;\n  }\n\n  .actor-image-wrap.overlay::after {\n    content: '';\n    position: absolute;\n    left: 0;\n    bottom: 0;\n    width: 100%;\n    background: var(--t5e-hp-overlay-background);\n    transition: height 0.5s ease-in-out;\n    mix-blend-mode: multiply;\n    height: var(--overlay-height);\n  }\n\n  .actor-image {\n    background: var(--t5e-icon-background);\n    box-shadow: 0 0 0.625rem var(--t5e-icon-shadow-color) inset;\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    object-position: top;\n  }\n\n  .portrait,\n  .portrait .actor-image-wrap,\n  .portrait .actor-image {\n    border-radius: 0.3125rem;\n  }\n\n  .portrait.round-portrait,\n  .portrait.round-portrait .actor-image-wrap,\n  .portrait.round-portrait .actor-image {\n    border-radius: 50%;\n  }\n</style>\n","<script lang=\"ts\">\n  import { type Snippet } from 'svelte';\n  import ActorPortrait from './ActorPortrait.svelte';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    useHpOverlay: boolean;\n    size?: 'medium' | 'small';\n    children?: Snippet;\n  }\n\n  let { useHpOverlay, size = 'medium', children }: Props = $props();\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n</script>\n\n<div class=\"actor-profile-wrap\" class:small-profile={size === 'small'}>\n  <div class=\"profile\" class:round-portrait={context.useRoundedPortraitStyle}>\n    <ActorPortrait actor={context.actor} {useHpOverlay} />\n    {@render children?.()}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { PortraitCharmRadiusClass } from 'src/types/types';\n\n  interface Props {\n    cssClass?: string;\n    radiusClass: PortraitCharmRadiusClass;\n    level: number;\n    onlyShowOnHover?: boolean;\n    isActiveEffectApplied?: boolean;\n    onLevelSelected?: (level: number) => void;\n  }\n\n  let {\n    cssClass = '',\n    radiusClass,\n    level = $bindable(),\n    onlyShowOnHover = false,\n    isActiveEffectApplied = false,\n    onLevelSelected,\n  }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n\n  let fontScales = ['1.25rem', '1.125rem', '1rem'] as const;\n\n  let inputFontSize: string = $derived(\n    !level || level < 100\n      ? fontScales[0]\n      : level < 1000\n        ? fontScales[1]\n        : fontScales[2],\n  );\n</script>\n\n<div\n  class=\"exhaustion-container {cssClass}\"\n  class:only-show-on-hover={onlyShowOnHover}\n  title={localize('TIDY5E.WorldSettings.Exhaustion.Header')}\n  style=\"--t5e-exhaustion-input-font-size: {inputFontSize}\"\n>\n  <div class=\"exhaustion-wrap {radiusClass}\">\n    <input\n      type=\"number\"\n      onchange={() => onLevelSelected?.(level)}\n      bind:value={level}\n      placeholder=\"0\"\n      onfocus={(ev) => ev.currentTarget.select()}\n      disabled={isActiveEffectApplied}\n      data-tooltip={isActiveEffectApplied\n        ? localize('DND5E.ActiveEffectOverrideWarning')\n        : null}\n    />\n  </div>\n</div>\n\n<style lang=\"scss\">\n  .exhaustion-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    height: 2.125rem;\n    width: 2.125rem;\n    color: var(--t5e-icon-font-color);\n\n    .exhaustion-wrap {\n      height: 2.125rem;\n      width: 2.125rem;\n      overflow: hidden;\n      background: var(--t5e-icon-background);\n      display: flex;\n      align-items: center;\n      box-shadow: 0 0 0.625rem var(--t5e-icon-shadow-color) inset;\n      border: 0.0625rem solid var(--t5e-icon-outline-color);\n\n      &.rounded {\n        border-radius: 1.25rem;\n      }\n\n      input {\n        height: 100%;\n        width: 100%;\n        text-align: center;\n        font-size: var(--t5e-exhaustion-input-font-size);\n        border-radius: 1.25rem;\n        color: var(--t5e-tertiary-color);\n        transition: color 0.3s ease;\n        font-family: var(--t5e-title-font-family);\n\n        &:focus {\n          color: var(--t5e-primary-font-color);\n        }\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ExhaustionTracker from '../../actor/ExhaustionTracker.svelte';\n  import Inspiration from './Inspiration.svelte';\n  import DeathSaves from '../../actor/DeathSaves.svelte';\n  import Rest from './Rest.svelte';\n  import HitDice from './HitDice.svelte';\n  import CharacterHitPoints from './CharacterHitPoints.svelte';\n  import TempHp from '../../actor/TempHp.svelte';\n  import ActorProfile from 'src/sheets/classic/actor/ActorProfile.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import ExhaustionInput from 'src/sheets/classic/actor/ExhaustionInput.svelte';\n  import { ActiveEffectsHelper } from 'src/utils/active-effect';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getCharacterSheetContext());\n\n  let incapacitated = $derived(\n    (context.actor?.system?.attributes?.hp?.value ?? 0) <= 0 &&\n      context.actor?.system?.attributes?.hp?.max !== 0,\n  );\n\n  async function onLevelSelected(level: number) {\n    await context.actor.update({\n      'system.attributes.exhaustion': level,\n    });\n  }\n</script>\n\n<ActorProfile\n  useHpOverlay={settings.value.useHpOverlay &&\n    context.system.attributes.hp.max > 0}\n>\n  {#if incapacitated && context.owner}\n    <DeathSaves hasHpOverlay={settings.value.useHpOverlay} />\n  {/if}\n\n  {#if settings.value.useExhaustion && settings.value.exhaustionConfig.type === 'specific'}\n    <ExhaustionTracker\n      level={context.system.attributes.exhaustion}\n      radiusClass={context.useRoundedPortraitStyle ? 'rounded' : 'top-left'}\n      {onLevelSelected}\n      onlyShowOnHover={settings.value.showExhaustionOnHover ||\n        (settings.value.hideIfZero &&\n          context.system.attributes.exhaustion === 0)}\n      exhaustionConfig={settings.value.exhaustionConfig}\n      isActiveEffectApplied={ActiveEffectsHelper.isActiveEffectAppliedToField(\n        context.actor,\n        'system.attributes.exhaustion',\n      )}\n    />\n  {:else if settings.value.useExhaustion && settings.value.exhaustionConfig.type === 'open'}\n    <ExhaustionInput\n      level={context.system.attributes.exhaustion}\n      radiusClass={context.useRoundedPortraitStyle ? 'rounded' : 'top-left'}\n      {onLevelSelected}\n      onlyShowOnHover={settings.value.showExhaustionOnHover ||\n        (settings.value.hideIfZero &&\n          context.system.attributes.exhaustion === 0)}\n      isActiveEffectApplied={ActiveEffectsHelper.isActiveEffectAppliedToField(\n        context.actor,\n        'system.attributes.exhaustion',\n      )}\n    />\n  {/if}\n\n  {#if settings.value.useCharacterInspiration}\n    <Inspiration\n      inspired={context.actor.system.attributes.inspiration}\n      radiusClass={context.useRoundedPortraitStyle ? 'rounded' : 'top-right'}\n      onlyShowOnHover={settings.value.showInspirationOnHover ||\n        (settings.value.hideIfZero &&\n          !context.actor.system.attributes.inspiration)}\n      animate={settings.value.animateInspiration}\n    />\n  {/if}\n\n  <CharacterHitPoints\n    value={context.system.attributes.hp.value}\n    max={context.system.attributes.hp.max}\n    actor={context.actor}\n    {incapacitated}\n  />\n\n  <Rest />\n\n  <HitDice />\n</ActorProfile>\n<TempHp />\n","<script lang=\"ts\">\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n\n  interface Props {\n    warnings: any;\n  }\n\n  let { warnings }: Props = $props();\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  function onCloseWarnings(\n    event: MouseEvent & {\n      currentTarget: EventTarget & HTMLDialogElement;\n    },\n  ) {\n    if (event.target instanceof HTMLDialogElement) {\n      event.target.close();\n    }\n\n    if (event.target instanceof HTMLAnchorElement) {\n      event.target.closest('dialog')?.close();\n    }\n  }\n</script>\n\n<dialog class=\"warnings active\" onclick={(event) => onCloseWarnings(event)}>\n  <ol class=\"unlist\">\n    {#each warnings as warning, index}\n      <li class={warning.type}>\n        {#if warning.link}\n          <a\n            class=\"inline-transparent-button\"\n            onclick={(ev) => context.actor.sheet._onWarningLink(ev)}\n            data-target={warning.link}\n          >\n            {warning.message}\n          </a>\n        {:else}\n          {warning.message}\n        {/if}\n      </li>\n    {/each}\n  </ol>\n</dialog>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from '../../../foundry/foundry-adapter';\n  import Dnd5eIcon from 'src/components/icon/Dnd5eIcon.svelte';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n</script>\n\n{#if context.saves.concentration}\n  {@const save = context.saves.concentration}\n  <span class=\"special-save\">\n    <button\n      type=\"button\"\n      class=\"inline-transparent-button flex-row extra-small-gap align-items-center highlight-on-hover\"\n      onclick={(ev) =>\n        context.actor.rollConcentration({ event: ev, legacy: false })}\n    >\n      <Dnd5eIcon src=\"systems/dnd5e/icons/svg/statuses/concentrating.svg\" />\n      {save.label}:\n      <span class=\"special-save-mod\">{save.sign}{save.mod}</span>\n    </button>\n    {#if context.unlocked}\n      <button\n        type=\"button\"\n        class=\"inline-icon-button\"\n        onclick={() => FoundryAdapter.openConcentrationConfig(context.actor)}\n        ><i class=\"fas fa-cog\" style=\"font-size: var(--icon-size);\"></i></button\n      >\n    {/if}\n  </span>\n{/if}\n\n<style lang=\"scss\">\n  .special-save {\n    display: flex;\n    flex-direction: row;\n    gap: 0.25rem;\n    align-items: center;\n    font-size: 0.75rem;\n\n    --icon-fill: var(--t5e-icon-hover-color);\n\n    button {\n      font-weight: 700;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import TidySwitch from 'src/components/toggles/TidySwitch.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    hint?: string | null;\n    [key: string]: any;\n  }\n\n  let { hint = null, ...rest }: Props = $props();\n\n  let context = $derived(getSheetContext<{ document: any }>());\n\n  async function toggleLock() {\n    await TidyFlags.allowEdit.set(context.document, !allowEdit);\n  }\n\n  const localize = FoundryAdapter.localize;\n  let allowEdit = $derived(TidyFlags.allowEdit.get(context.document));\n  let descriptionVariable = $derived(\n    hint ??\n      (settings.value.useTotalSheetLock\n        ? localize('TIDY5E.SheetLock.Description')\n        : localize('TIDY5E.SheetEdit.Description')),\n  );\n  let lockHintVariable = $derived(\n    settings.value.useTotalSheetLock\n      ? 'TIDY5E.SheetLock.Unlock.Hint'\n      : 'TIDY5E.SheetEdit.Enable.Hint',\n  );\n  let unlockHintVariable = $derived(\n    settings.value.useTotalSheetLock\n      ? 'TIDY5E.SheetLock.Lock.Hint'\n      : 'TIDY5E.SheetEdit.Disable.Hint',\n  );\n  let unlockTitle = $derived(\n    localize(unlockHintVariable, {\n      description: descriptionVariable,\n    }),\n  );\n  let lockTitle = $derived(\n    localize(lockHintVariable, {\n      description: descriptionVariable,\n    }),\n  );\n</script>\n\n<div\n  class=\"sheet-edit-mode-toggle {rest.class ?? ''}\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.SHEET_LOCK_TOGGLE}\n>\n  <TidySwitch\n    --tidy-switch-scale=\"1\"\n    --tidy-switch-thumb-transform-duration=\"0.15s\"\n    title={allowEdit ? unlockTitle : lockTitle}\n    checked={allowEdit}\n    thumbIconClass=\"{allowEdit ? 'fas fa-unlock' : 'fas fa-lock'} fa-fw\"\n    onChange={() => toggleLock()}\n  ></TidySwitch>\n</div>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n\n  interface Props {\n    movementLabelKey?: string;\n    [key: string]: any;\n  }\n\n  let { movementLabelKey = 'DND5E.Speed', ...rest }: Props = $props();\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<section class=\"actor-movement flex-row small-gap {rest.class ?? ''}\">\n  <strong>{localize(movementLabelKey)}</strong>\n  {#if context.movement.primary}\n    <span title={context.movement.primary}>{context.movement.primary}</span>\n  {/if}\n  {#if context.movement.special}\n    |\n    <span title={context.movement.special}>{context.movement.special}</span>\n  {/if}\n  {#if context.movement.secondary}\n    |\n    <span title={context.movement.secondary}\n      >{context.movement.secondary}</span\n    >\n  {/if}\n  {#if context.unlocked}\n    <button\n      type=\"button\"\n      class=\"configure inline-icon-button\"\n      title={localize('DND5E.MovementConfig')}\n      onclick={() =>\n        FoundryAdapter.renderMovementSensesConfig(context.actor, 'movement')}\n      tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n      ><i class=\"fas fa-cog\"></i></button\n    >\n  {/if}\n</section>\n","<script lang=\"ts\">\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n  import type { MouseEventHandler } from 'svelte/elements';\n\n  interface Props {\n    title?: string | null;\n    text: string;\n    hideFromTabOrder?: boolean;\n    attributes?: Record<string, string>;\n    onRoll?: MouseEventHandler<HTMLElement>;\n  }\n\n  let {\n    title = null,\n    text,\n    hideFromTabOrder = false,\n    attributes = {},\n    onRoll,\n  }: Props = $props();\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n</script>\n\n<button\n  type=\"button\"\n  class:rollable={context.editable}\n  class=\"transparent-button\"\n  {title}\n  onclick={(ev) => onRoll?.(ev)}\n  disabled={!context.editable}\n  tabindex={!hideFromTabOrder ? 0 : -1}\n  {...attributes}\n>\n  <h4 class=\"block-title\">\n    {text}\n  </h4>\n</button>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { formatAsModifier } from 'src/utils/formatting';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import BlockTitle from './RollableBlockTitle.svelte';\n  import BlockScore from './BlockScore.svelte';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n  import { settings } from 'src/settings/settings.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { ActiveEffectsHelper } from 'src/utils/active-effect';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    id: string;\n    ability: any;\n    useSavingThrowProficiency: boolean;\n    useConfigurationOption: boolean;\n  }\n\n  let {\n    id,\n    ability,\n    useSavingThrowProficiency,\n    useConfigurationOption,\n  }: Props = $props();\n\n  let abbreviation = $derived(\n    CONFIG.DND5E.abilities[id as keyof typeof CONFIG.DND5E.abilities]\n      ?.abbreviation ?? id,\n  );\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  const localize = FoundryAdapter.localize;\n\n  let activeEffectApplied = $derived(\n    ActiveEffectsHelper.isActiveEffectAppliedToField(\n      context.actor,\n      `system.abilities.${id}.proficient`,\n    ),\n  );\n</script>\n\n<div\n  class=\"ability-score-container\"\n  data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ABILITY_SCORE_CONTAINER}\n  data-ability={id}\n>\n  <BlockTitle\n    title={ability.label}\n    text={abbreviation}\n    onRoll={(event) => context.actor.rollAbility({ ability: id, event: event })}\n    hideFromTabOrder={settings.value.useDefaultSheetAttributeTabbing ||\n      !settings.value.useAccessibleKeyboardSupport}\n    attributes={{\n      'data-tidy-sheet-part': CONSTANTS.SHEET_PARTS.ABILITY_ROLLER,\n    }}\n  />\n  <BlockScore>\n    <TextInput\n      document={context.actor}\n      field=\"system.abilities.{id}.value\"\n      value={ability.value}\n      placeholder=\"10\"\n      selectOnFocus={true}\n      allowDeltaChanges={true}\n      disabled={context.lockSensitiveFields}\n      attributes={{\n        'data-tidy-sheet-part': CONSTANTS.SHEET_PARTS.ABILITY_SCORE,\n      }}\n    />\n  </BlockScore>\n  <div class=\"ability-modifiers\">\n    <button\n      type=\"button\"\n      class=\"ability-mod transparent-button\"\n      class:rollable={context.editable}\n      title={localize('DND5E.AbilityModifier')}\n      onclick={(event) =>\n        context.actor.rollAbilityCheck({ ability: id, event })}\n      tabindex={!settings.value.useDefaultSheetAttributeTabbing &&\n      settings.value.useAccessibleKeyboardSupport\n        ? 0\n        : -1}\n      disabled={!context.editable}\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ABILITY_TEST_ROLLER}\n    >\n      {formatAsModifier(ability.mod)}\n    </button>\n    <button\n      type=\"button\"\n      class=\"ability-save transparent-button\"\n      class:rollable={context.editable}\n      title={localize('DND5E.ActionSave')}\n      onclick={(event) => context.actor.rollSavingThrow({ ability: id, event })}\n      tabindex={!settings.value.useDefaultSheetAttributeTabbing &&\n      settings.value.useAccessibleKeyboardSupport\n        ? 0\n        : -1}\n      disabled={!context.editable}\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ABILITY_SAVE_ROLLER}\n    >\n      {formatAsModifier(ability.save)}\n    </button>\n    {#if useSavingThrowProficiency}\n      {#if context.unlocked}\n        <button\n          type=\"button\"\n          title={ability.hover}\n          class=\"proficiency-toggle inline-icon-button\"\n          onclick={() =>\n            context.actor.update({\n              [`system.abilities.${id}.proficient`]:\n                1 - parseInt(ability.proficient),\n            })}\n          tabindex={!settings.value.useDefaultSheetAttributeTabbing &&\n          settings.value.useAccessibleKeyboardSupport\n            ? 0\n            : -1}\n          data-tidy-sheet-part={CONSTANTS.SHEET_PARTS\n            .ABILITY_SAVE_PROFICIENCY_TOGGLE}\n          disabled={activeEffectApplied}\n          data-tooltip={activeEffectApplied\n            ? localize('DND5E.ActiveEffectOverrideWarning')\n            : null}\n        >\n          {@html ability.icon}\n        </button>\n      {:else}\n        <span\n          title={ability.hover}\n          class=\"proficiency-toggle-readonly\"\n          data-tooltip={activeEffectApplied\n            ? localize('DND5E.ActiveEffectOverrideWarning')\n            : null}>{@html ability.icon}</span\n        >\n      {/if}\n    {/if}\n    {#if useConfigurationOption && context.editable && context.unlocked}\n      <button\n        type=\"button\"\n        class=\"config-button inline-icon-button\"\n        title={localize('DND5E.AbilityConfigure')}\n        onclick={() => FoundryAdapter.renderAbilityConfig(context.actor, id)}\n        tabindex={!settings.value.useDefaultSheetAttributeTabbing &&\n        settings.value.useAccessibleKeyboardSupport\n          ? 0\n          : -1}\n        data-tidy-sheet-part={CONSTANTS.SHEET_PARTS\n          .ABILITY_CONFIGURATION_CONTROL}\n      >\n        <i class=\"fas fa-cog\"></i>\n      </button>\n    {/if}\n  </div>\n  <span class=\"mod-label ability-mod-label\">{localize('TIDY5E.AbbrMod')}</span>\n  <span class=\"mod-label save-mod-label\"\n    >{localize('TIDY5E.AbbrSavingThrow')}</span\n  >\n</div>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { formatAsModifier } from 'src/utils/formatting';\n  import BlockTitle from './RollableBlockTitle.svelte';\n  import BlockScore from './BlockScore.svelte';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import D20Icon from '../shared/D20Icon.svelte';\n\n  interface Props {\n    initiative: { total: number; bonus: number };\n  }\n\n  let { initiative }: Props = $props();\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  let appId = $derived(context.actor.id);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"initiative-container\">\n  <div class=\"d20-icon-container\">\n    <D20Icon />\n  </div>\n  <div class=\"block-score-wrapper\">\n    <BlockTitle\n      title={localize('DND5E.Initiative')}\n      text={localize('TIDY5E.AbbrInitiative')}\n      onRoll={(event) => context.actor.rollInitiativeDialog({ event: event })}\n    />\n    <BlockScore>\n      <span class=\"ini-score\"\n        >{formatAsModifier(initiative.total)}\n\n        {#if context.editable && context.unlocked}\n          <a\n            class=\"config-button icon-button\"\n            title={localize('DND5E.InitiativeConfig')}\n            onclick={() => FoundryAdapter.renderInitiativeConfig(context.actor)}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n          >\n            <i class=\"fas fa-cog\"></i>\n          </a>\n        {/if}\n      </span>\n    </BlockScore>\n  </div>\n</div>","<script lang=\"ts\">\n  import AcShieldBase from './AcShieldBase.svelte';\n  import { onMount } from 'svelte';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import type { FocusEventHandler } from 'svelte/elements';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    /**\n     * The Armor Class value.\n     */\n    ac?: string | number;\n    /**\n     * Optional CSS class list string to apply to the AC Shield container element.\n     */\n    cssClass?: string;\n    onfocus?: FocusEventHandler<HTMLElement>;\n  }\n\n  let { ac = '0', cssClass = '', onfocus }: Props = $props();\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  let acShieldButton: HTMLElement;\n\n  onMount(() => {\n    context.actor.sheet._applyAttributionTooltips(acShieldButton);\n  });\n</script>\n\n<AcShieldBase {cssClass}>\n  <button\n    bind:this={acShieldButton}\n    type=\"button\"\n    onclick={() => FoundryAdapter.renderArmorConfig(context.actor)}\n    {onfocus}\n    class=\"config-button attribute-value transparent-button\"\n    data-attribution=\"attributes.ac\"\n    data-attribution-caption=\"DND5E.ArmorClass\"\n    data-tooltip-direction=\"DOWN\"\n    disabled={!context.editable}\n    tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n  >\n    {ac}\n  </button>\n</AcShieldBase>\n\n<style lang=\"scss\">\n  .attribute-value {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    font-size: 2.25rem;\n    font-weight: 700;\n  }\n</style>\n","<script lang=\"ts\">\n  import AttributeBlock from './AttributeBlock.svelte';\n  import InitiativeBlock from './InitiativeBlock.svelte';\n  import AcShield from './AcShield.svelte';\n  import VerticalLineSeparator from 'src/components/layout/VerticalLineSeparator.svelte';\n\n  interface Props {\n    ac: { value: string | number };\n    init: any;\n    abilities: any[];\n  }\n\n  let { ac, init, abilities }: Props = $props();\n</script>\n\n<section class=\"actor-stats\">\n  <AcShield ac={ac.value} />\n  {#each abilities as [id, ability]}\n    <VerticalLineSeparator />\n    <div>\n      <AttributeBlock\n        {id}\n        {ability}\n        useSavingThrowProficiency={true}\n        useConfigurationOption={true}\n      />\n    </div>\n  {/each}\n  <VerticalLineSeparator />\n  <div>\n    <InitiativeBlock initiative={init} />\n  </div>\n</section>\n","<script lang=\"ts\">\n  import { getContext } from 'svelte';\n  import SelectionListbox from '../../components/listbox/SelectionListbox.svelte';\n  import type { TabSelectionContext } from './TabSelectionFormApplication.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { CONSTANTS } from 'src/constants';\n\n  let context = getContext<TabSelectionContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n\n  const apply = getContext<() => Promise<void>>(CONSTANTS.SVELTE_CONTEXT.APPLY);\n  const validate = getContext<() => boolean>(CONSTANTS.SVELTE_CONTEXT.VALIDATE);\n  const useDefault = getContext<() => Promise<void>>(\n    CONSTANTS.SVELTE_CONTEXT.USE_DEFAULT,\n  );\n  const localize = FoundryAdapter.localize;\n</script>\n\n<section class=\"tab-selection-container full-height flex-column\">\n  <SelectionListbox\n    labelProp=\"label\"\n    valueProp=\"id\"\n    bind:leftItems={context.available}\n    bind:rightItems={context.selected}\n    listboxCssClass=\"scroll-container\"\n    class=\"flex-1\"\n  >\n    {#snippet leftHeader()}\n      <h2 class=\"minimal\">\n        {localize('TIDY5E.TabSelection.AvailableHeader')}\n      </h2>\n    {/snippet}\n    {#snippet rightHeader()}\n      <h2 class=\"minimal\">\n        {localize('TIDY5E.TabSelection.SelectedHeader')}\n      </h2>\n    {/snippet}\n  </SelectionListbox>\n  <p class=\"flex-row align-items-center no-gap\">\n    <span class=\"extra-info-icon-container\"\n      ><i class=\"fas fa-info-circle\"></i></span\n    >\n    <span>{localize('TIDY5E.TabSelection.Explanation')}</span>\n  </p>\n  <div class=\"flex-row small-gap\">\n    <button\n      type=\"button\"\n      class=\"use-default-btn\"\n      onclick={(ev) => useDefault()}\n    >\n      <i class=\"fas fa-rotate-right\"></i>\n      {localize('TIDY5E.UseDefault')}\n    </button>\n    <button\n      type=\"submit\"\n      class=\"save-changes-btn\"\n      onclick={(ev) => validate() || ev.preventDefault()}\n    >\n      <i class=\"fas fa-save\"></i>\n      {localize('TIDY5E.SaveChanges')}\n    </button>\n    <button\n      type=\"button\"\n      class=\"apply-changes-btn\"\n      onclick={() => validate() && apply()}\n    >\n      <i class=\"fas fa-check\"></i>\n      {localize('TIDY5E.ApplyChanges')}\n    </button>\n  </div>\n</section>\n\n<style lang=\"scss\">\n  .extra-info-icon-container {\n    width: 3.5rem;\n    text-align: center;\n    i {\n      font-size: 1.5rem;\n      color: var(--t5e-secondary-color);\n    }\n  }\n</style>\n","import { mount } from 'svelte';\nimport SvelteFormApplicationBase from '../SvelteFormApplicationBase';\nimport TabSelection from './TabSelection.svelte';\nimport type { Actor5e } from 'src/types/types';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { error } from 'src/utils/logging';\nimport type { RegisteredTab } from 'src/runtime/types';\nimport { CONSTANTS } from 'src/constants';\nimport { settings, SettingsProvider } from 'src/settings/settings.svelte';\nimport NpcSheetRuntime from 'src/runtime/NpcSheetRuntime.svelte';\nimport CharacterSheetRuntime from 'src/runtime/CharacterSheetRuntime.svelte';\nimport { VehicleSheetRuntime } from 'src/runtime/VehicleSheetRuntime';\nimport { TabManager } from 'src/runtime/tab/TabManager';\nimport { TidyFlags } from 'src/foundry/TidyFlags';\nimport GroupSheetRuntime from 'src/runtime/GroupSheetRuntime.svelte';\n\nexport type TabSelectionItem = {\n  id: string;\n  label: string;\n};\n\nexport type TabSelectionContext = {\n  available: TabSelectionItem[];\n  selected: TabSelectionItem[];\n};\n\nexport default class TabSelectionFormApplication extends SvelteFormApplicationBase {\n  actor: Actor5e;\n  context = $state<TabSelectionContext>({ available: [], selected: [] });\n  registeredTabs: RegisteredTab<any>[];\n\n  constructor(actor: Actor5e, ...args: any[]) {\n    super(...args);\n    this.actor = actor;\n    this.registeredTabs = this.getRegisteredTabs(actor);\n  }\n\n  getRegisteredTabs(actor: Actor5e): RegisteredTab<any>[] {\n    if (actor.type === CONSTANTS.SHEET_TYPE_CHARACTER) {\n      return CharacterSheetRuntime.getAllRegisteredTabs();\n    } else if (actor.type === CONSTANTS.SHEET_TYPE_NPC) {\n      return NpcSheetRuntime.getAllRegisteredTabs();\n    } else if (actor.type === CONSTANTS.SHEET_TYPE_VEHICLE) {\n      return VehicleSheetRuntime.getAllRegisteredTabs();\n    } else if (actor.type === CONSTANTS.SHEET_TYPE_GROUP) {\n      return GroupSheetRuntime.getAllRegisteredTabs();\n    }\n\n    error(\n      FoundryAdapter.localize(\n        'TIDY5E.TabSelection.UnsupportedDocumentErrorMessage',\n        { documentType: this.actor.type }\n      )\n    );\n    return [];\n  }\n\n  getDefaultTabIds(actor: Actor5e): string[] {\n    if (actor.type === CONSTANTS.SHEET_TYPE_CHARACTER) {\n      return settings.value.defaultCharacterSheetTabs;\n    } else if (actor.type === CONSTANTS.SHEET_TYPE_NPC) {\n      return settings.value.defaultNpcSheetTabs;\n    } else if (actor.type === CONSTANTS.SHEET_TYPE_VEHICLE) {\n      return settings.value.defaultVehicleSheetTabs;\n    } else if (actor.type === CONSTANTS.SHEET_TYPE_GROUP) {\n      return GroupSheetRuntime.getDefaultTabs();\n    }\n\n    error(\n      FoundryAdapter.localize(\n        'TIDY5E.TabSelection.UnsupportedDocumentErrorMessage',\n        { documentType: this.actor.type }\n      )\n    );\n    return [];\n  }\n\n  createComponent(node: HTMLElement): Record<string, any> {\n    return mount(TabSelection, {\n      target: node,\n      context: new Map<any, any>([\n        ['context', this.context],\n        ['appId', this.appId],\n        ['apply', this.apply.bind(this)],\n        ['useDefault', this.useDefault.bind(this)],\n        ['validate', this.validate.bind(this)],\n      ]),\n    });\n  }\n\n  static get defaultOptions() {\n    return {\n      ...super.defaultOptions,\n      height: 550,\n      width: 750,\n      classes: [\n        ...super.defaultOptions.classes,\n        'tab-selection',\n        'app-v1',\n        CONSTANTS.SHEET_LAYOUT_CLASSIC,\n      ],\n      resizable: false,\n    };\n  }\n\n  get title() {\n    return FoundryAdapter.localize('TIDY5E.TabSelection.Title', {\n      documentName: this.actor.name,\n    });\n  }\n\n  getData() {\n    const selectedTabIds =\n      TidyFlags.selectedTabs.get(this.actor) ??\n      this.getDefaultTabIds(this.actor);\n\n    let availableTabs: TabSelectionItem[] = this.registeredTabs\n      .filter((t) => !selectedTabIds.includes(t.id))\n      .map((t) => ({\n        id: t.id,\n        label: FoundryAdapter.localize(TabManager.getTabTitle(t)),\n      }));\n\n    let selectedTabs: TabSelectionItem[] = this.registeredTabs\n      .filter((t) => selectedTabIds.includes(t.id))\n      .map((t) => ({\n        id: t.id,\n        label: FoundryAdapter.localize(TabManager.getTabTitle(t)),\n      }))\n      .sort(\n        (a, b) => selectedTabIds.indexOf(a.id) - selectedTabIds.indexOf(b.id)\n      );\n\n    return {\n      available: availableTabs,\n      selected: selectedTabs,\n    } satisfies TabSelectionContext;\n  }\n\n  async useDefault() {\n    await TidyFlags.selectedTabs.unset(this.actor);\n    this.close();\n  }\n\n  validate() {\n    if (this.context.selected.length === 0) {\n      error(\n        FoundryAdapter.localize(\n          'TIDY5E.TabSelection.AtLeastOneRequiredErrorMessage'\n        ),\n        true\n      );\n      return false;\n    }\n\n    return true;\n  }\n\n  async save() {\n    await this.apply();\n    await this.close();\n  }\n\n  async _updateObject(): Promise<void> {\n    await this.save();\n  }\n\n  refreshContext() {\n    this.context = this.getData();\n  }\n\n  async apply() {\n    await TidyFlags.selectedTabs.set(\n      this.actor,\n      this.context.selected.map((t) => t.id)\n    );\n  }\n}\n","import { UserSettingsFormApplication } from './settings/user-settings/UserSettingsFormApplication.svelte';\nimport { ThemeSettingsFormApplication } from './theme/ThemeSettingsFormApplication.svelte';\nimport { CONSTANTS } from 'src/constants';\n\nexport class ApplicationsManager {\n  private static _themeSettings: ThemeSettingsFormApplication;\n  private static _userSettings: UserSettingsFormApplication;\n\n  /**\n   * Opens the Theme Settings window as a singleton.\n   * @returns the form application for theme settings.\n   */\n  static openThemeSettings(): ThemeSettingsFormApplication {\n    ApplicationsManager._themeSettings ??= new ThemeSettingsFormApplication();\n    const rendered = ApplicationsManager._themeSettings.render(true);\n    setTimeout(() => ApplicationsManager._themeSettings.bringToTop(), 150);\n    return rendered;\n  }\n\n  /**\n   * Opens the Sheet Settings window as a singleton.\n   * @param initialTab the initial tab to show\n   * @returns the form application for sheet settings\n   */\n  static openUserSettings(initialTab?: string): UserSettingsFormApplication {\n    ApplicationsManager._userSettings ??= new UserSettingsFormApplication(\n      CONSTANTS.TAB_USER_SETTINGS_PLAYERS\n    );\n\n    if (initialTab) {\n      ApplicationsManager._userSettings.initialTabId = initialTab;\n    }\n\n    const rendered = ApplicationsManager._userSettings.render(true);\n    setTimeout(() => ApplicationsManager._userSettings.bringToTop(), 150);\n    return rendered;\n  }\n}\n","<script lang=\"ts\">\n  import ButtonMenu from 'src/components/button-menu/ButtonMenu.svelte';\n  import ButtonMenuCommand from 'src/components/button-menu/ButtonMenuCommand.svelte';\n  import ButtonMenuDivider from 'src/components/button-menu/ButtonMenuDivider.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import ThemeSelectorButtonMenuCommand from '../shared/ThemeSelectorButtonMenuCommand.svelte';\n  import TabSelectionFormApplication from 'src/applications/tab-selection/TabSelectionFormApplication.svelte';\n  import type { ActorSheetContextV1 } from 'src/types/types';\n  import { ApplicationsManager } from 'src/applications/ApplicationsManager';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    defaultSettingsTab?: string | undefined;\n  }\n\n  let { defaultSettingsTab = undefined }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n</script>\n\n<ButtonMenu\n  position=\"bottom\"\n  anchor=\"right\"\n  ariaLabel={localize('TIDY5E.SheetMenu.label')}\n  title={localize('TIDY5E.SheetMenu.label')}\n  iconClass=\"fas fa-ellipsis-vertical\"\n>\n  <ThemeSelectorButtonMenuCommand />\n  <ButtonMenuDivider />\n  <ButtonMenuCommand\n    onMenuClick={() => ApplicationsManager.openUserSettings(defaultSettingsTab)}\n    iconClass=\"fas fa-cog\"\n  >\n    {localize('TIDY5E.UserSettings.Menu.label')}\n  </ButtonMenuCommand>\n  <ButtonMenuCommand\n    onMenuClick={() => ApplicationsManager.openThemeSettings()}\n    iconClass=\"fas fa-palette\"\n  >\n    {localize('TIDY5E.ThemeSettings.SheetMenu.buttonLabel')}\n  </ButtonMenuCommand>\n  {#if context.owner}\n    <ButtonMenuCommand\n      onMenuClick={() =>\n        new TabSelectionFormApplication(context.actor).render(true)}\n      iconClass=\"fas fa-file-invoice\"\n      disabled={!context.editable}\n    >\n      {localize('TIDY5E.TabSelection.MenuOptionText')}\n    </ButtonMenuCommand>\n  {/if}\n</ButtonMenu>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import { type ActorSheetContextV1 } from 'src/types/types';\n  import { coalesce } from 'src/utils/formatting';\n\n  let context = $derived(getSheetContext<ActorSheetContextV1>());\n\n  const localize = FoundryAdapter.localize;\n  let text = $derived(\n    coalesce(context.labels.type, localize('DND5E.CreatureType')),\n  );\n</script>\n\n{#if context.editable && (context.actor.type === 'npc' || context.system.details?.race?.id)}\n  <button\n    type=\"button\"\n    class=\"configure-creature-type inline-transparent-button highlight-on-hover truncate\"\n    onclick={() => FoundryAdapter.renderCreatureTypeConfig(context.actor)}\n    title={localize('DND5E.CreatureType')}\n    tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n  >\n    {text}\n  </button>\n{:else}\n  <span\n    class=\"creature-type-label truncate\"\n    title={localize('DND5E.CreatureType')}>{text}</span\n  >\n{/if}\n\n<style lang=\"scss\">\n  .creature-type-label,\n  .configure-creature-type {\n    flex: 1;\n    line-height: inherit;\n    height: inherit;\n  }\n</style>\n","<script lang=\"ts\">\n  import { getContext } from 'svelte';\n  import type { ActorOriginSummaryContext } from './ActorOriginSummaryConfigFormApplication.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { CONSTANTS } from 'src/constants';\n\n  let context = getContext<ActorOriginSummaryContext>(\n    CONSTANTS.SVELTE_CONTEXT.CONTEXT,\n  );\n  let appId = getContext<string>(CONSTANTS.SVELTE_CONTEXT.APP_ID);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<section class=\"flex-column\">\n  {#if context.isCharacter}\n    <div class=\"form-field\">\n      <label for=\"background-edit-{appId}\">{localize('DND5E.Background')}</label\n      >\n      {#if context.canEditBackground}\n        <input\n          id=\"background-edit-{appId}\"\n          type=\"text\"\n          placeholder={localize('DND5E.Background')}\n          bind:value={context.background}\n        />\n      {:else}\n        <span>{context.background}</span>\n      {/if}\n    </div>\n    <div class=\"form-field\">\n      <label for=\"pc-alignment-edit-{appId}\"\n        >{localize('DND5E.Alignment')}</label\n      >\n      <input\n        id=\"alignment-edit-{appId}\"\n        type=\"text\"\n        placeholder={localize('DND5E.Alignment')}\n        bind:value={context.alignment}\n      />\n    </div>\n  {:else if context.isNpc}\n    <div class=\"environment form-field\">\n      <label for=\"environment-edit-{appId}\"\n        >{localize('TIDY5E.Environment')}</label\n      >\n      <input\n        id=\"environment-edit-{appId}\"\n        type=\"text\"\n        placeholder={localize('TIDY5E.Environment')}\n        bind:value={context.environment}\n      />\n    </div>\n    <div class=\"form-field\">\n      <label for=\"alignment-edit-{appId}\">{localize('DND5E.Alignment')}</label>\n      <input\n        id=\"alignment-edit-{appId}\"\n        type=\"text\"\n        placeholder={localize('DND5E.Alignment')}\n        bind:value={context.alignment}\n      />\n    </div>\n  {:else if context.isVehicle}\n    <div class=\"form-field\">\n      <label for=\"dimensions-edit-{appId}\">{localize('DND5E.Dimensions')}</label\n      >\n      <textarea\n        id=\"dimensions-edit-{appId}\"\n        rows=\"4\"\n        cols=\"50\"\n        name=\"dimensions\"\n        placeholder={localize('DND5E.Dimensions')}\n        bind:value={context.dimensions}\n      ></textarea>\n    </div>\n  {/if}\n\n  <button type=\"submit\">\n    <i class=\"far fa-save\"></i>\n    {localize('Save')}\n  </button>\n</section>\n","import { mount } from 'svelte';\nimport ActorOriginSummaryConfig from './ActorOriginSummaryConfig.svelte';\nimport type { Actor5e } from 'src/types/types';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { CONSTANTS } from 'src/constants';\nimport { error } from 'src/utils/logging';\nimport SvelteFormApplicationBase from '../SvelteFormApplicationBase';\n\nexport type ActorOriginSummaryContext = {\n  isCharacter: boolean;\n  race: string;\n  canEditBackground: boolean;\n  background: boolean;\n  alignment: string;\n  isNpc: boolean;\n  environment: string;\n  isVehicle: boolean;\n  dimensions: string;\n};\n\nexport default class ActorOriginSummaryConfigFormApplication extends SvelteFormApplicationBase {\n  context = $state<ActorOriginSummaryContext>();\n  actor: Actor5e;\n  actorHook: number | undefined;\n\n  constructor(actor: Actor5e, ...args: any[]) {\n    super(...args);\n    this.actor = actor;\n  }\n\n  createComponent(node: HTMLElement): Record<string, any> {\n    this.context = this.getData();\n\n    return mount(ActorOriginSummaryConfig, {\n      target: node,\n      context: new Map<any, any>([\n        ['appId', this.appId],\n        ['context', this.context],\n      ]),\n    });\n  }\n\n  activateListeners(html: any): void {\n    this.refreshContextOnActorChanges();\n    super.activateListeners(html);\n  }\n\n  refreshContextOnActorChanges() {\n    if (this.actorHook !== undefined) {\n      return;\n    }\n\n    this.actorHook = Hooks.on('updateActor', (actor: Actor5e) => {\n      if (actor.id === this.actor.id) {\n        this.refreshContext();\n      }\n    });\n  }\n\n  getData() {\n    return {\n      race:\n        this.actor.system.details.race?.name ?? this.actor.system.details.race,\n      background:\n        this.actor.system.details.background?.name ??\n        this.actor.system.details.background,\n      environment: this.actor.system.details.environment,\n      alignment: this.actor.system.details.alignment,\n      dimensions: this.actor.system.traits.dimensions,\n\n      isCharacter: this.actor.type === CONSTANTS.SHEET_TYPE_CHARACTER,\n      canEditBackground: !this.actor.system.details.background?.name,\n      isNpc: this.actor.type === CONSTANTS.SHEET_TYPE_NPC,\n      isVehicle: this.actor.type === CONSTANTS.SHEET_TYPE_VEHICLE,\n    } satisfies ActorOriginSummaryContext;\n  }\n\n  static get defaultOptions() {\n    return FoundryAdapter.mergeObject(super.defaultOptions, {\n      width: 380,\n      height: 'auto',\n      sheetConfig: false,\n      resizable: false,\n    });\n  }\n\n  get title() {\n    return FoundryAdapter.localize('TIDY5E.OriginSummaryConfig', {\n      actorName: this.actor.name,\n    });\n  }\n\n  refreshContext() {\n    this.context = this.getData();\n  }\n\n  close(options?: unknown) {\n    Hooks.off('updateActor', this.actorHook);\n    this.actorHook = undefined;\n    super.close(options);\n  }\n\n  async save() {\n    if (!this.context) {\n      error('Unable to save data due to an error.', true);\n      console.error(\n        'Unable to save Actor Origin Summary Config because the context is unexpectedly null.',\n        this.actor,\n        this.context\n      );\n      return;\n    }\n\n    if (this.context.isCharacter) {\n      const update: Record<string, any> = {\n        'system.details.alignment': this.context.alignment,\n      };\n      if (this.context.canEditBackground) {\n        update['system.details.background'] = this.context.background;\n      }\n      await this.actor.update(update);\n    } else if (this.context.isNpc) {\n      await this.actor.update({\n        'system.details.environment': this.context.environment,\n        'system.details.alignment': this.context.alignment,\n      });\n    } else if (this.context.isVehicle) {\n      await this.actor.update({\n        'system.traits.dimensions': this.context.dimensions,\n      });\n    }\n    this.close();\n  }\n\n  async _updateObject(): Promise<void> {\n    await this.save();\n  }\n}\n","<script lang=\"ts\">\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type {\n    ActorSheetContextV1,\n    ActorSheetContextV2,\n  } from 'src/types/types';\n\n  let context = $derived(getSheetContext<ActorSheetContextV1 | ActorSheetContextV2>());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<TextInput\n  document={context.actor}\n  editable={context.editable && !context.lockSensitiveFields}\n  spellcheck={false}\n  placeholder={localize('DND5E.Name')}\n  value={context.actor.name}\n  field=\"name\"\n/>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from '../../../foundry/foundry-adapter';\n  import type { DropdownListOption } from 'src/types/types';\n  import CharacterProfile from './parts/CharacterProfile.svelte';\n  import InlineTextDropdownList from '../../../components/inputs/InlineTextDropdownList.svelte';\n  import ActorWarnings from '../actor/ActorWarnings.svelte';\n  import SpecialSaves from '../actor/SpecialSaves.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import SheetEditModeToggle from 'src/sheets/classic/actor/SheetEditModeToggle.svelte';\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import ContentEditableFormField from 'src/components/inputs/ContentEditableFormField.svelte';\n  import ActorMovement from '../actor/ActorMovement.svelte';\n  import ActorHeaderStats from '../actor/ActorHeaderStats.svelte';\n  import HorizontalLineSeparator from 'src/components/layout/HorizontalLineSeparator.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import SheetMenu from '../actor/SheetMenu.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import InlineCreatureType from '../shared/InlineCreatureType.svelte';\n  import ActorOriginSummaryConfigFormApplication from 'src/applications/actor-origin-summary/ActorOriginSummaryConfigFormApplication.svelte';\n  import ActorName from '../actor/ActorName.svelte';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let selectedTabId: string = $state('');\n  let context = $derived(getCharacterSheetContext());\n\n  const localize = FoundryAdapter.localize;\n\n  let playerName = $derived(TidyFlags.playerName.get(context.actor) ?? '');\n\n  let classAndSubclassSummaries = $derived(\n    Array.from(\n      FoundryAdapter.getClassAndSubclassSummaries(context.actor).values(),\n    ),\n  );\n\n  let characterSummaryEntries = $derived(\n    FoundryAdapter.getActorCharacterSummaryEntries(context),\n  );\n\n  let abilities = $derived(Object.entries<any>(context.abilities));\n\n  let sizes = $derived(\n    Object.entries(context.config.actorSizes).map(\n      ([abbreviation, size]: [string, any]) => ({\n        value: abbreviation,\n        text: size.label,\n      }),\n    ) satisfies DropdownListOption[],\n  );\n\n  let currentSize = $derived({\n    value: context.system.traits.size,\n    text: context.config.actorSizes[context.system.traits.size]?.label,\n  } satisfies DropdownListOption);\n</script>\n\n{#if context.viewableWarnings.length}\n  <ActorWarnings warnings={context.viewableWarnings} />\n{/if}\n<header class=\"tidy5e-sheet-header flex-row\">\n  <div class=\"flex-0\">\n    <CharacterProfile />\n  </div>\n\n  <div class=\"flex-grow-1\">\n    <div\n      class=\"flex-row justify-content-space-between align-items-center small-gap\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n    >\n      <div\n        class=\"actor-name\"\n        data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n      >\n        <ActorName />\n      </div>\n\n      <div class=\"flex-row extra-small-gap align-items-stretch\">\n        {#if !context.disableExperience}\n          <!-- XP / XP To Next Level -->\n          <div class=\"xp-tracker\">\n            <div class=\"experience flex-row no-gap\">\n              <TextInput\n                document={context.actor}\n                field=\"system.details.xp.value\"\n                class=\"current-xp\"\n                value={context.system.details.xp.value}\n                placeholder=\"0\"\n                selectOnFocus={true}\n                allowDeltaChanges={true}\n                maxlength={7}\n                disabled={!context.editable || context.lockExpChanges}\n              />\n\n              {#if !context.epicBoonsEarned}\n                <span class=\"sep\">/</span>\n                {#if context.editable && FoundryAdapter.userIsGm()}\n                  <TextInput\n                    document={context.actor}\n                    field=\"system.details.xp.max\"\n                    class=\"max-xp max\"\n                    value={context.system.details.xp.max}\n                    placeholder=\"0\"\n                    selectOnFocus={true}\n                    allowDeltaChanges={true}\n                    maxlength={7}\n                    disabled={!context.editable}\n                  />\n                {:else}\n                  <span class=\"max\">{context.system.details.xp.max}</span>\n                {/if}\n              {/if}\n            </div>\n            <div class=\"xp-bar\">\n              <div class=\"xp-bar-total\">\n                <span\n                  class=\"xp-bar-current\"\n                  style=\"width: {context.system.details.xp.pct}%\"\n                ></span>\n              </div>\n            </div>\n          </div>\n        {/if}\n        <h2 class=\"level\">\n          {localize('DND5E.AbbreviationLevel')}\n          {context.system.details.level}\n        </h2>\n        <a\n          class=\"sheet-header-button\"\n          class:disabled={!context.editable}\n          onclick={() =>\n            context.editable &&\n            new dnd5e.applications.actor.ActorSheetFlags(context.actor).render(\n              true,\n            )}\n          title={localize('DND5E.SpecialTraits')}\n        >\n          <i class=\"fa-solid fa-star fa-fw\"></i>\n        </a>\n        <SheetMenu defaultSettingsTab={CONSTANTS.TAB_USER_SETTINGS_PLAYERS} />\n      </div>\n    </div>\n\n    <section class=\"class-list\">\n      <!-- Player Name -->\n      {#if settings.value.showPlayerName}\n        <ContentEditableFormField\n          element=\"span\"\n          document={context.actor}\n          field={TidyFlags.playerName.prop}\n          value={playerName}\n          cssClass=\"player-name\"\n          placeholder={localize('TIDY5E.PlayerName')}\n          dataMaxLength={40}\n          editable={context.editable && !context.lockSensitiveFields}\n        />\n        <!-- <span>&#8226;</span> -->\n      {/if}\n\n      <!-- Class / Subclass -->\n      {#if context.owner && settings.value.showClassList}\n        <span class=\"flex-row extra-small-gap\">\n          {#each classAndSubclassSummaries as summary, i}\n            {#if i > 0}\n              <span class=\"flex-no-grow\">/</span>\n            {/if}\n            <span class=\"flex-no-grow\">\n              <span title=\"{summary.class} {summary.level ?? '0'}\"\n                >{summary.class}\n                {summary.level ?? '0'}\n              </span>\n              {#if summary.subclass}\n                <span title={summary.subclass} class=\"flex-no-grow\"\n                  >{summary.subclass}</span\n                >\n              {/if}\n            </span>\n          {/each}\n        </span>\n      {/if}\n\n      {#if context.actor.system.details.xp.boonsEarned}\n        <span class=\"ms-auto\">\n          {context.epicBoonsEarned}\n        </span>\n      {/if}\n    </section>\n\n    <!-- Origin Summary: Size , Race , Background , Alignment , Proficiency , Origin Summary Configuration Cog -->\n    <section class=\"origin-summary\">\n      <span class=\"origin-points\">\n        {#if context.editable}\n          <InlineTextDropdownList\n            options={sizes}\n            selected={currentSize}\n            onOptionClicked={(option) =>\n              context.actor.update({\n                'system.traits.size': option.value,\n              })}\n            title={localize('DND5E.Size')}\n          />\n        {:else}\n          <span title={localize('DND5E.Size')}>{currentSize.text}</span>\n        {/if}\n        <span>&#8226;</span>\n        <InlineCreatureType />\n        {#each characterSummaryEntries as entry}\n          <span>&#8226;</span>\n          <span title={entry} class=\"truncate\">{entry}</span>\n        {/each}\n      </span>\n      <span class=\"flex-row align-items-center extra-small-gap\">\n        <b>\n          {localize('DND5E.Proficiency')}: {context.labels.proficiency}\n        </b>\n        {#if context.unlocked}\n          <button\n            type=\"button\"\n            class=\"inline-icon-button\"\n            title={localize('TIDY5E.OriginSummaryConfig')}\n            onclick={() =>\n              new ActorOriginSummaryConfigFormApplication(context.actor).render(\n                true,\n              )}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n          >\n            <i class=\"fas fa-cog\"></i>\n          </button>\n        {/if}\n      </span>\n    </section>\n    <div\n      role=\"presentation\"\n      class=\"header-line-margin flex-row extra-small-gap justify-content-space-between\"\n    >\n      <ActorMovement />\n      {#if context.hasSpecialSaves}\n        <SpecialSaves />\n      {/if}\n    </div>\n    <HorizontalLineSeparator\n      class=\"header-line-margin-left\"\n      borderColor=\"light\"\n    />\n    <!-- AC  -->\n    <ActorHeaderStats\n      {abilities}\n      ac={context.system.attributes.ac}\n      init={context.system.attributes.init}\n    />\n  </div>\n</header>\n\n<Tabs tabs={context.tabs} bind:selectedTabId sheet={context.actor.sheet}>\n  {#snippet tabEnd()}\n    {#if context.editable}\n      <SheetEditModeToggle\n        hint={settings.value.permanentlyUnlockCharacterSheetForGm &&\n        FoundryAdapter.userIsGm()\n          ? localize(\n              'TIDY5E.Settings.value.PermanentlyUnlockCharacterSheetForGM.title',\n            )\n          : null}\n      />\n    {/if}\n  {/snippet}\n</Tabs>\n\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n\n<style lang=\"scss\">\n  .tidy5e-sheet-header {\n    display: flex;\n    justify-content: center;\n    padding: 0.625rem 1rem 1rem 1rem;\n    background: var(--t5e-header-background);\n\n    :global(.current-xp) {\n      height: 1rem;\n      width: calc(10.5ch + 0.3rem);\n      text-align: right;\n      padding: 0 0.25rem;\n    }\n\n    :global(.max-xp) {\n      height: 1rem;\n      width: calc(10.5ch + 0.3rem);\n      text-align: left;\n      padding: 0 0.25rem;\n    }\n\n    .xp-tracker {\n      max-width: 7.75rem;\n    }\n\n    .xp-bar-total {\n      width: 100%;\n      height: 0.3125rem;\n      border: 0.0625rem solid var(--t5e-tertiary-color);\n      border-radius: 0.125rem;\n      background: var(--t5e-light-color);\n      position: relative;\n    }\n\n    .xp-bar-current {\n      position: absolute;\n      top: 0;\n      left: 0;\n      height: 100%;\n      max-width: 100%;\n      background: var(--t5e-xp-bar-background);\n      transition: width 0.3s ease;\n    }\n\n    .level {\n      padding: 0.25rem 0.375rem;\n      border-radius: 0.1875rem;\n      background: var(--t5e-faint-color);\n      color: var(--t5e-secondary-color);\n      font-size: 1.25rem;\n      line-height: 1;\n      height: 1.5rem;\n      white-space: nowrap;\n    }\n\n    .class-list {\n      font-size: 0.75rem;\n      margin: 0;\n      padding: 0.1875rem 0 0 0;\n      color: var(--t5e-secondary-color);\n      margin-left: 0.25rem;\n      line-height: 1;\n      display: flex;\n      align-items: center;\n      gap: 0.25rem;\n      flex-wrap: wrap;\n\n      :global(.player-name) {\n        display: inline-block;\n        font-weight: 600;\n        margin-left: -0.25rem;\n        margin-right: 0.25rem;\n        min-width: 3.125rem;\n        padding: 0 0.25rem;\n        white-space: nowrap;\n        color: var(--t5e-primary-font-color);\n      }\n    }\n\n    .origin-summary {\n      margin-left: 0.25rem;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      gap: 0.25rem;\n      border-bottom: 0.0625rem solid var(--t5e-separator-color);\n      border-top: 0.0625rem solid var(--t5e-separator-color);\n      line-height: 1rem;\n      padding: 0.1875rem 0 0.125rem 0;\n      margin-top: 0.125rem;\n\n      &,\n      :global(button) {\n        font-size: 0.75rem;\n      }\n\n      .origin-points {\n        flex: 1;\n        display: grid;\n        grid-template-columns:\n          min-content /* Size */\n          min-content /* Bullet */\n          minmax(auto, min-content) /* Creature Type */\n          min-content /* Bullet */\n          minmax(auto, min-content) /* Species */\n          min-content /* Bullet */\n          minmax(auto, min-content) /* Background */\n          min-content /* Bullet */\n          minmax(auto, min-content) /* Alignment */;\n        gap: 0.25rem;\n        align-items: center;\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { getVehicleSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    rounded: boolean;\n  }\n\n  let { rounded }: Props = $props();\n\n  let context = $derived(getVehicleSheetContext());\n</script>\n\n<header>\n  <div class=\"profile\">\n    <div class=\"portrait\" class:rounded>\n      <img src={context.actor.img} alt={context.actor.name} data-edit=\"img\" />\n    </div>\n  </div>\n  <h1>{context.actor.name}</h1>\n</header>\n\n<style lang=\"scss\">\n  header {\n    --t5e-portrait-size: 9.375rem;\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    gap: 0.625rem;\n    padding: 0.625rem 1rem;\n    background: var(--t5e-header-background);\n\n    .profile {\n      flex: 0 0 auto;\n\n      .portrait {\n        width: 100%;\n        height: 100%;\n        border-radius: 0.3125rem;\n        overflow: hidden;\n        border: 0.0625rem solid var(--t5e-icon-outline-color);\n\n        &.rounded {\n          border-radius: 50%;\n        }\n\n        img {\n          background: var(--t5e-icon-background);\n        }\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import RerenderAfterFormSubmission from 'src/components/utility/RerenderAfterFormSubmission.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import SheetEditor from '../../../components/editor/SheetEditor.svelte';\n  import LimitedHeader from '../actor/LimitedHeader.svelte';\n  import { getNpcSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getNpcSheetContext());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"limited-character\">\n  <LimitedHeader rounded={context.useRoundedPortraitStyle} />\n  <section class=\"tidy-sheet-body\">\n    <div class=\"note-entries\">\n      <RerenderAfterFormSubmission\n        andOnValueChange={context.system.details.biography.value}\n      >\n        <article class=\"appearance-notes\" use:context.activateEditors>\n          <div class=\"section-titles biopage\">\n            {localize('DND5E.Appearance')}\n          </div>\n          <SheetEditor\n            content={context.system.details.appearance}\n            target=\"system.details.appearance\"\n            editable={context.editable}\n          />\n        </article>\n        <article class=\"biography-notes\" use:context.activateEditors>\n          <div class=\"section-titles\">\n            {localize('DND5E.Background')}/{localize('DND5E.Biography')}\n          </div>\n          <SheetEditor\n            content={context.biographyHTML}\n            target=\"system.details.biography.value\"\n            editable={context.editable}\n          />\n        </article>\n      </RerenderAfterFormSubmission>\n    </div>\n  </section>\n</div>\n\n<style lang=\"scss\">\n  .limited-character {\n    height: 100%;\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n  }\n\n  .tidy-sheet-body {\n    flex: 1;\n    margin-right: 1rem;\n\n    .note-entries {\n      height: 100%;\n      display: flex;\n      flex-direction: row;\n      gap: 0.5rem;\n\n      > * {\n        flex: 1;\n        min-width: 0;\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import CharacterSheetFull from './CharacterSheetFull.svelte';\n  import CharacterSheetLimited from './CharacterSheetLimited.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getCharacterSheetContext());\n</script>\n\n{#if context.showLimitedSheet}\n  <CharacterSheetLimited />\n{:else}\n  <CharacterSheetFull />\n{/if}\n","import {\n  actorUsesActionFeature,\n  isItemInActionList,\n} from 'src/features/actions/actions.svelte';\nimport { CONSTANTS } from 'src/constants';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { settings } from 'src/settings/settings.svelte';\nimport type { Item5e } from 'src/types/item.types';\nimport { warn } from 'src/utils/logging';\nimport { TidyFlags } from 'src/foundry/TidyFlags';\nimport type { ContextMenuEntry } from 'src/foundry/foundry.types';\nimport { AttributePins } from 'src/features/attribute-pins/AttributePins';\nimport { isNil } from 'src/utils/data';\nimport { TidyHooks } from 'src/foundry/TidyHooks';\n\nexport function configureItemContextMenu(element: HTMLElement, app: any) {\n  const id = element.closest('[data-item-id]')?.getAttribute('data-item-id');\n\n  let item =\n    app.document.type === CONSTANTS.ITEM_TYPE_CONTAINER\n      ? app.document.system.contents.get(id)\n      : app.document.items.get(id);\n\n  if (!item) return;\n\n  ui.context.menuItems = getItemContextOptions(app, item, element);\n  TidyHooks.dnd5eGetItemContextOptions(item, ui.context.menuItems);\n}\n\n/**\n * Prepare an array of context menu options which are available for owned Item documents.\n * @param {Item5e} item                   The Item for which the context menu is activated\n * @returns {ContextMenuEntry[]}          An array of context menu options offered for the Item\n * @returns                               Context menu options.\n */\nexport function getItemContextOptions(\n  app: any,\n  item: Item5e,\n  element: HTMLElement\n) {\n  if (!item?.isOwner || !settings.value.useContextMenu) {\n    return [];\n  }\n\n  const itemParent = item.actor ? item.actor : item.parent;\n  const itemParentIsActor =\n    itemParent?.documentName === CONSTANTS.DOCUMENT_NAME_ACTOR;\n\n  let options: ContextMenuEntry[] = [];\n\n  let toggleTitle = '';\n  let canToggle = false;\n  let isActive = false;\n  let canPrepare = false;\n\n  if (item.type === 'spell') {\n    const prep = item.system.preparation || {};\n    const isAlways = prep.mode === CONSTANTS.SPELL_PREPARATION_MODE_ALWAYS;\n    const isPrepared = !!prep.prepared;\n    isActive = isPrepared;\n    if (isAlways) toggleTitle = CONFIG.DND5E.spellPreparationModes.always.label;\n    else if (isPrepared)\n      toggleTitle = CONFIG.DND5E.spellPreparationModes.prepared.label;\n    else toggleTitle = FoundryAdapter.localize('DND5E.SpellUnprepared');\n\n    canPrepare = item.system.level >= 1;\n  } else {\n    isActive = !!item.system.equipped;\n    toggleTitle = FoundryAdapter.localize(\n      isActive ? 'DND5E.Equipped' : 'DND5E.Unequipped'\n    );\n    canToggle = 'equipped' in item.system;\n\n    canPrepare = item.system.level >= 1;\n  }\n\n  // Toggle Attunement State\n  if (\n    !!CONFIG.DND5E.attunementTypes[\n      item.system.attunement as keyof typeof CONFIG.DND5E.attunementTypes\n    ] &&\n    !FoundryAdapter.concealDetails(item)\n  ) {\n    options.push({\n      name: item.system.attuned\n        ? 'TIDY5E.ContextMenuActionUnattune'\n        : 'TIDY5E.ContextMenuActionAttune',\n      icon: item.system.attuned\n        ? \"<i class='fas fa-sun fa-fw' style='color: var(--t5e-warning-accent-color);'></i>\"\n        : \"<i class='fas fa-sun fa-fw'></i>\",\n      callback: () =>\n        item.update({\n          'system.attuned': !item.system.attuned,\n        }),\n      condition: () => item.isOwner && !item.compendium?.locked,\n    });\n  }\n\n  // Toggle Charged State\n\n  options.push({\n    name: !item.isOnCooldown\n      ? 'DND5E.ContextMenuActionExpendCharge'\n      : 'DND5E.ContextMenuActionCharge',\n    icon: '<i class=\"fa-solid fa-bolt\"></i>',\n    callback: () =>\n      item.update({\n        'system.uses.spent': !item.isOnCooldown ? item.system.uses.max : 0,\n      }),\n    condition: () =>\n      item.hasRecharge && item.isOwner && !item.compendium?.locked,\n    group: 'state',\n  });\n\n  // Toggle Equipped State\n  if ('equipped' in item.system) {\n    const isEquipped = item.system.equipped;\n    options.push({\n      name: isEquipped\n        ? 'TIDY5E.ContextMenuActionUnequip'\n        : 'TIDY5E.ContextMenuActionEquip',\n      icon: isEquipped\n        ? \"<i class='fas fa-user-alt fa-fw' style='color: var(--t5e-warning-accent-color);'></i> \"\n        : \"<i class='fas fa-user-alt fa-fw'></i> \",\n      callback: () => item.update({ 'system.equipped': !isEquipped }),\n      condition: () => item.isOwner && !item.compendium?.locked,\n    });\n  }\n\n  // Toggle Prepared State\n  if (\n    'preparation' in item.system &&\n    FoundryAdapter.canPrepareSpell(item) &&\n    !item.getFlag('dnd5e', 'cachedFor')\n  ) {\n    const isPrepared = item.system?.preparation?.prepared === true;\n    options.push({\n      name: isActive\n        ? 'TIDY5E.ContextMenuActionUnprepare'\n        : 'TIDY5E.ContextMenuActionPrepare',\n      icon: isActive\n        ? \"<i class='fas fa-book fa-fw'></i>\"\n        : \"<i class='fas fa-book fa-fw'></i>\",\n      callback: () =>\n        item.update({ 'system.preparation.prepared': !isPrepared }),\n      condition: () => item.isOwner && !item.compendium?.locked,\n    });\n  }\n\n  options.push({\n    name: 'DND5E.Identify',\n    icon: \"<i class='fas fa-magnifying-glass fa-fw'></i>\",\n    callback: () => item.update({ 'system.identified': true }),\n    condition: () =>\n      item.system.identified === false &&\n      FoundryAdapter.canIdentify(item) &&\n      !item.compendium?.locked,\n  });\n\n  const isCharacter =\n    itemParentIsActor && itemParent.type === CONSTANTS.SHEET_TYPE_CHARACTER;\n  if (isCharacter) {\n    // Add favorites to context menu\n    let isFav = FoundryAdapter.isItemFavorited(item);\n\n    const favoriteIcon = 'fa-bookmark';\n\n    options.push({\n      name: isFav ? 'TIDY5E.RemoveFavorite' : 'TIDY5E.AddFavorite',\n      icon: isFav\n        ? `<i class='fas ${favoriteIcon} fa-fw' style='color: var(--t5e-warning-accent-color)'></i>`\n        : `<i class='fas ${favoriteIcon} fa-fw inactive'></i>`,\n      callback: () => {\n        if (!item) {\n          warn(`tidy5e-context-menu | Item Not Found`);\n          return;\n        }\n        FoundryAdapter.toggleFavoriteItem(item);\n      },\n      condition: () =>\n        !!itemParent &&\n        'favorites' in itemParent.system &&\n        !item.compendium?.locked,\n    });\n\n    options.push({\n      name: 'TIDY5E.ContextMenuActionPinToAttributes',\n      icon: `<i class=\"fa-solid fa-thumbtack\"></i>`,\n      callback: () => AttributePins.pin(item, 'item'),\n      condition: () =>\n        item.isOwner &&\n        !item.compendium?.locked &&\n        AttributePins.isPinnable(item, 'item') &&\n        !AttributePins.isPinned(item),\n      group: 'pins',\n    });\n\n    options.push({\n      name: 'TIDY5E.ContextMenuActionUnpinFromAttributes',\n      icon: `<i class=\"fa-solid fa-xmark\" style='color: var(--t5e-warning-accent-color)'></i>`,\n      callback: () => AttributePins.unpin(item),\n      condition: () =>\n        item.isOwner &&\n        !item.compendium?.locked &&\n        AttributePins.isPinnable(item, 'item') &&\n        AttributePins.isPinned(item),\n      group: 'pins',\n    });\n\n    const isAttributeItemPin = !!element.closest('[data-pin-id]');\n\n    if (isAttributeItemPin) {\n      options.push({\n        name: 'TIDY5E.ContextMenuActionShowLimitedUses',\n        icon: '<i class=\"fa-solid fa-fw\"></i>',\n        callback: () => AttributePins.setItemResourceType(item, 'limited-uses'),\n        condition: () =>\n          item.isOwner &&\n          !item.compendium?.locked &&\n          !isNil(item.system.quantity) &&\n          AttributePins.getResourceType(item) !== 'limited-uses',\n        group: 'pins',\n      });\n      options.push({\n        name: 'TIDY5E.ContextMenuActionShowQuantity',\n        icon: '<i class=\"fa-solid fa-fw\"></i>',\n        callback: () => AttributePins.setItemResourceType(item, 'quantity'),\n        condition: () =>\n          item.isOwner &&\n          !item.compendium?.locked &&\n          !isNil(item.system.quantity) &&\n          AttributePins.getResourceType(item) !== 'quantity',\n        group: 'pins',\n      });\n    }\n  }\n\n  options.push({\n    name: 'TIDY5E.ContextMenuActionEdit',\n    icon: '<i class=\"fas fa-pencil-alt fa-fw\"></i>',\n    callback: () =>\n      item.sheet.render(true, FoundryAdapter.getItemSheetMode(app)),\n    condition: () => item.isOwner && !item.compendium?.locked,\n  });\n\n  options.push({\n    name: 'TIDY5E.ContextMenuActionView',\n    icon: '<i class=\"fas fa-eye fa-fw\"></i>',\n    callback: () =>\n      item.sheet.render(true, FoundryAdapter.getItemSheetMode(app)),\n    condition: () => !item.isOwner || item.compendium?.locked,\n  });\n\n  options.push({\n    name: 'DND5E.ContextMenuActionDuplicate',\n    icon: \"<i class='fas fa-copy fa-fw'></i>\",\n    condition: () =>\n      item.canDuplicate && item.isOwner && !item.compendium?.locked,\n\n    callback: () =>\n      item.clone(\n        {\n          name: FoundryAdapter.localize('DOCUMENT.CopyOf', {\n            name: item.name,\n          }),\n        },\n        { save: true }\n      ),\n  });\n\n  if (item.type === 'spell') {\n    options.push({\n      name: 'TIDY5E.ContextMenuActionDelete',\n      icon: \"<i class='fas fa-trash fa-fw' style='color: var(--t5e-warning-accent-color);'></i>\",\n      callback: () => FoundryAdapter.onActorItemDelete(itemParent, item),\n      condition: () =>\n        item.canDelete && item.isOwner && !item.compendium?.locked,\n    });\n    options.push({\n      name: 'DOCUMENT.DND5E.Activity',\n      icon: \"<i class='fas fa-gear fa-fw'></i>\",\n      callback: () => item.system.linkedActivity.sheet.render(true),\n      condition: () =>\n        !item.canDelete &&\n        item.system.linkedActivity &&\n        item.isOwner &&\n        !item.compendium?.locked,\n    });\n  } else {\n    options.push({\n      name: 'DND5E.ContextMenuActionDelete',\n      icon: \"<i class='fas fa-trash fa-fw' style='color: var(--t5e-warning-accent-color);'></i>\",\n      callback: () => {\n        return itemParent\n          ? FoundryAdapter.onActorItemDelete(itemParent, item)\n          : item.deleteDialog();\n      },\n      condition: () => item.isOwner && !item.compendium?.locked,\n    });\n  }\n\n  options.push({\n    name: 'DND5E.Scroll.CreateScroll',\n    icon: '<i class=\"fa-solid fa-scroll\"></i>',\n    callback: async () => {\n      const options: Record<string, unknown> = {};\n\n      if (settings.value.includeFlagsInSpellScrollCreation) {\n        options.flags = item.flags;\n      }\n\n      const scroll = await dnd5e.documents.Item5e.createScrollFromSpell(\n        item,\n        options\n      );\n      if (scroll) {\n        dnd5e.documents.Item5e.create(scroll, { parent: itemParent });\n      }\n    },\n    condition: () =>\n      item.type === 'spell' &&\n      !item.getFlag('dnd5e', 'cachedFor') &&\n      itemParent?.isOwner &&\n      !itemParent?.compendium?.locked,\n    group: 'action',\n  });\n\n  const active = isItemInActionList(item);\n  options.push({\n    name: active\n      ? 'TIDY5E.Actions.SetOverrideFalse'\n      : 'TIDY5E.Actions.SetOverrideTrue',\n    icon: active\n      ? '<i class=\"fas fa-fist-raised\" style=\"color: var(--t5e-warning-accent-color)\"></i>'\n      : '<i class=\"fas fa-fist-raised\"></i>',\n    callback: () => {\n      TidyFlags.actionFilterOverride.set(item, !isItemInActionList(item));\n    },\n    condition: () =>\n      item.type !== CONSTANTS.ITEM_TYPE_FACILITY &&\n      itemParentIsActor &&\n      actorUsesActionFeature(itemParent),\n  });\n\n  const overridden = TidyFlags.actionFilterOverride.get(item) !== undefined;\n\n  options.push({\n    name: 'TIDY5E.Actions.ResetActionDefault',\n    icon: '<i class=\"fas fa-fist-raised\" style=\"color: var(--t5e-warning-accent-color)\"></i>',\n    callback: () => {\n      TidyFlags.actionFilterOverride.unset(item);\n    },\n    condition: () =>\n      overridden && itemParentIsActor && actorUsesActionFeature(itemParent),\n  });\n\n  return options;\n}\n","import { CONSTANTS } from 'src/constants';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { settings } from 'src/settings/settings.svelte';\nimport { warn } from 'src/utils/logging';\nimport type { ContextMenuEntry } from 'src/foundry/foundry.types';\nimport { TidyHooks } from 'src/foundry/TidyHooks';\n\nexport function configureActiveEffectsContextMenu(\n  element: HTMLElement,\n  app: any\n) {\n  const effectId = element.getAttribute('data-effect-id') ?? '';\n  const parentId = element.getAttribute('data-parent-id') ?? '';\n\n  const effect = FoundryAdapter.getEffect({\n    document: app.document,\n    effectId: effectId,\n    parentId: parentId,\n  });\n\n  if (!effect) {\n    return;\n  }\n\n  // TODO: Leverage the API to aggregate any registered context menu options; pass in the context of the current item for reference.\n  ui.context.menuItems = getActiveEffectContextOptions(effect, app);\n  TidyHooks.dnd5eGetActiveEffectContextOptions(effect, ui.context.menuItems);\n}\n\nexport function getActiveEffectContextOptions(effect: any, app: any) {\n  const effectParent = effect.parent;\n\n  // Assumption: Either the effect belongs to the character or is transferred from an item.\n  const actor = effectParent.actor ?? effectParent;\n\n  if (!effectParent?.isOwner || !settings.value.useContextMenu) {\n    return [];\n  }\n\n  if (\n    actor.type === CONSTANTS.SHEET_TYPE_CHARACTER &&\n    !FoundryAdapter.allowCharacterEffectsManagement(actor)\n  ) {\n    return [];\n  }\n\n  const isConcentrationEffect = FoundryAdapter.isConcentrationEffect(\n    effect,\n    app\n  );\n\n  const isFav = FoundryAdapter.isEffectFavorited(effect, actor);\n  const favoriteIcon = 'fa-bookmark';\n\n  let tidy5eKgarContextOptions: ContextMenuEntry[] = [\n    {\n      name: 'DND5E.ContextMenuActionEdit',\n      icon: \"<i class='fas fas fa-pencil-alt fa-fw'></i>\",\n      callback: () => effect.sheet.render(true),\n    },\n    {\n      name: 'DND5E.ContextMenuActionDuplicate',\n      icon: \"<i class='fas fa-copy fa-fw'></i>\",\n      callback: () =>\n        effect.clone(\n          {\n            name: FoundryAdapter.localize('DOCUMENT.CopyOf', {\n              name: effect.name,\n            }),\n          },\n          { save: true }\n        ),\n      condition: () => canEditEffect(effect),\n    },\n    {\n      name: 'DND5E.ContextMenuActionDelete',\n      icon: `<i class=\"fas fa-trash fa-fw t5e-warning-color\"></i>`,\n      callback: () => effect.deleteDialog(),\n      condition: () => canEditEffect(effect) && !isConcentrationEffect,\n    },\n    {\n      name: effect.disabled\n        ? 'DND5E.ContextMenuActionEnable'\n        : 'DND5E.ContextMenuActionDisable',\n      icon: effect.disabled\n        ? \"<i class='fas fa-check fa-fw'></i>\"\n        : \"<i class='fas fa-times fa-fw'></i>\",\n      callback: () => effect.update({ disabled: !effect.disabled }),\n      condition: () => effect.isOwner && !isConcentrationEffect,\n      group: 'state',\n    },\n    {\n      name: 'DND5E.ConcentrationBreak',\n      icon: '<dnd5e-icon src=\"systems/dnd5e/icons/svg/break-concentration.svg\"></dnd5e-icon>',\n      condition: () => isConcentrationEffect,\n      callback: () => app.document.endConcentration(effect),\n      group: 'state',\n    },\n    {\n      name: isFav ? 'TIDY5E.RemoveFavorite' : 'TIDY5E.AddFavorite',\n      icon: isFav\n        ? `<i class='fas ${favoriteIcon} fa-fw' style='color: var(--t5e-warning-accent-color)'></i>`\n        : `<i class='fas ${favoriteIcon} fa-fw inactive'></i>`,\n      condition: () => 'favorites' in actor.system,\n      callback: () => {\n        if (!effect) {\n          warn(`tidy5e-context-menu | Effect Not Found.`);\n          return;\n        }\n        FoundryAdapter.toggleFavoriteEffect(effect);\n      },\n      group: 'state',\n    },\n  ];\n\n  return tidy5eKgarContextOptions;\n}\n\nfunction canEditEffect(effect: any) {\n  const actor = effect.actor ? effect.actor : effect.parent;\n  return FoundryAdapter.isSheetUnlocked(actor);\n}\n","import type { Actor5e } from 'src/types/types';\nimport type { ContextMenuEntry } from 'src/foundry/foundry.types';\nimport type { Group5eMember } from 'src/types/group.types';\nimport { TidyHooks } from 'src/foundry/TidyHooks';\n\nexport function configureGroupContextMenu(element: HTMLElement, app: any) {\n  const memberId = element.getAttribute('data-member-id');\n  const actor = app.document.system.members.find(\n    (m: Group5eMember) => m.actor.id === memberId\n  );\n\n  if (!actor) return;\n\n  ui.context.menuItems = getGroupMemberContextOptions(app.document, actor);\n  TidyHooks.tidy5eSheetsGetGroupMemberContextOptions(\n    app.document,\n    actor,\n    ui.context.menuItems\n  );\n}\n\n/**\n * Prepare an array of context menu options which are available for a member of a group.\n * @param group    The group for which the context menu is activated.\n * @param actor    The actor for whom the context menu is activate.\n * @returns        Context menu options.\n */\nfunction getGroupMemberContextOptions(group: Actor5e, actor: Actor5e) {\n  let options: ContextMenuEntry[] = [\n    {\n      name: 'TIDY5E.Group.RemoveMemberFromGroup',\n      icon: `<i class=\"fas fa-trash fa-fw t5e-warning-color\"></i>`,\n      callback: () => group.removeMember(actor.id),\n      condition: () => !group.compendium?.locked,\n    },\n  ];\n\n  return options;\n}\n","import { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport type { ContextMenuEntry } from 'src/foundry/foundry.types';\nimport { TidyHooks } from 'src/foundry/TidyHooks';\n\nexport function configureFacilityContextMenu(\n  element: HTMLElement,\n  app: any\n) {\n  const occupantUuid = element.getAttribute('data-actor-uuid');\n  const index = element.getAttribute('data-index');\n  const facilityId = element.getAttribute('data-facility-id');\n  const facilityName = element.getAttribute('data-facility-name');\n  const prop = element.getAttribute('data-prop');\n\n  let contextOptions: ContextMenuEntry[] = [\n    {\n      name: 'TIDY5E.ContextMenuActionEdit',\n      icon: \"<i class='fas fas fa-pencil-alt fa-fw'></i>\",\n      callback: async () => {\n        const actor = await fromUuid(occupantUuid);\n        actor?.sheet.render(true);\n      },\n      condition: () => app.actor.isOwner && !app.actor.compendium?.locked,\n    },\n    {\n      name: FoundryAdapter.localize(\n        'TIDY5E.Facilities.ContextMenuActionRemove',\n        { facilityName }\n      ),\n      icon: \"<i class='fas fas fa-trash t5e-warning-color fa-fw'></i>\",\n      callback: async () => {\n        await app.actor.sheet.deleteOccupant(facilityId, prop, Number(index));\n      },\n      condition: () => app.actor.isOwner && !app.actor.compendium?.locked,\n    },\n  ];\n\n  ui.context.menuItems = contextOptions;\n  TidyHooks.dnd5eGetFacilityOccupantContextOptions(\n    app.document,\n    app.document.items.get(facilityId),\n    occupantUuid,\n    prop,\n    index !== null ? Number(index) : null,\n    ui.context.menuItems\n  );\n}\n","import { AttributePins } from 'src/features/attribute-pins/AttributePins';\nimport type { Activity5e } from 'src/foundry/dnd5e.types';\n\nexport function configureActivitiesContextMenu(element: HTMLElement, app: any) {\n  const itemId = element.closest<HTMLElement>('[data-item-id]')?.dataset.itemId;\n  const item =\n    app.document.type === 'container'\n      ? app.document.system.getContainedItem(itemId)\n      : app.document.items.get(itemId);\n\n  // Parts of ContextMenu doesn't play well with promises, so don't show menus for containers in packs\n  if (!item || item instanceof Promise) {\n    return;\n  }\n\n  const activityElement = element.closest<HTMLElement>('[data-activity-id]');\n  const activityId = activityElement?.getAttribute('data-activity-id');\n\n  /**\n   * Activities are denoted as configurable or not.\n   * Non-configurable activities include special activities like facility orders.\n   */\n  const configurable =\n    activityElement?.matches('[data-configurable=\"true\"]') === true;\n\n  const activity = item.system.activities?.get(activityId);\n  if (!activity) {\n    return;\n  }\n\n  const menuItems = getContextMenuOptions(activity, app, configurable);\n\n  /**\n   * A hook even that fires when the context menu for an Activity is opened.\n   * @function dnd5e.getItemActivityContext\n   * @memberof hookEvents\n   * @param {Activity} activity             The Activity.\n   * @param {HTMLElement} target            The element that menu was triggered on.\n   * @param {ContextMenuEntry[]} menuItems  The context menu entries.\n   */\n  Hooks.callAll('dnd5e.getItemActivityContext', activity, element, menuItems);\n  ui.context.menuItems = menuItems;\n}\n\nfunction getContextMenuOptions(\n  activity: Activity5e,\n  app: any,\n  configurable: boolean\n) {\n  const entries = [];\n\n  if (activity.item.isOwner && !activity.item.compendium?.locked) {\n    entries.push(\n      {\n        name: 'DND5E.ContextMenuActionEdit',\n        icon: '<i class=\"fas fa-pen-to-square fa-fw\"></i>',\n        callback: () => activity.sheet.render({ force: true }),\n        condition: () => configurable,\n      },\n      {\n        name: 'DND5E.ContextMenuActionDuplicate',\n        icon: '<i class=\"fas fa-copy fa-fw\"></i>',\n        callback: () => {\n          const createData = activity.toObject();\n          delete createData._id;\n          activity.item.createActivity(createData.type, createData, {\n            renderSheet: false,\n          });\n        },\n        condition: () => configurable,\n      },\n      {\n        name: 'DND5E.ContextMenuActionDelete',\n        icon: '<i class=\"fas fa-trash fa-fw\"></i>',\n        callback: () => activity.deleteDialog(),\n        condition: () => configurable,\n      }\n    );\n  } else {\n    entries.push({\n      name: 'DND5E.ContextMenuActionView',\n      icon: '<i class=\"fas fa-eye fa-fw\"></i>',\n      callback: () => activity.sheet.render({ force: true }),\n      condition: () => configurable,\n    });\n  }\n\n  entries.push({\n    name: 'TIDY5E.ContextMenuActionPinToAttributes',\n    icon: `<i class=\"fa-solid fa-thumbtack\"></i>`,\n    callback: () => AttributePins.pin(activity, 'activity'),\n    condition: () =>\n      activity.item.isOwner &&\n      !activity.item.compendium?.locked &&\n      AttributePins.isPinnable(activity, 'activity') &&\n      !AttributePins.isPinned(activity),\n    group: 'pins',\n  });\n\n  entries.push({\n    name: 'TIDY5E.ContextMenuActionUnpinFromAttributes',\n    icon: `<i class=\"fa-solid fa-xmark\" style='color: var(--t5e-warning-accent-color)'></i>`,\n    callback: () => AttributePins.unpin(activity),\n    condition: () =>\n      activity.item.isOwner &&\n      !activity.item.compendium?.locked &&\n      AttributePins.isPinnable(activity, 'activity') &&\n      AttributePins.isPinned(activity),\n    group: 'pins',\n  });\n\n  if ('favorites' in (app.actor?.system ?? {})) {\n    const uuid = `${activity.item.getRelativeUUID(app.actor)}.Activity.${\n      activity.id\n    }`;\n    const isFavorited = app.actor.system.hasFavorite(uuid);\n    entries.push({\n      name: isFavorited ? 'DND5E.FavoriteRemove' : 'DND5E.Favorite',\n      icon: '<i class=\"fas fa-bookmark fa-fw\"></i>',\n      condition: () =>\n        activity.item.isOwner && !activity.item.compendium?.locked,\n      callback: () => {\n        if (isFavorited) app.actor.system.removeFavorite(uuid);\n        else app.actor.system.addFavorite({ type: 'activity', id: uuid });\n      },\n      group: 'state',\n    });\n  }\n\n  return entries;\n}\n","import { CONSTANTS } from 'src/constants';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { warn } from 'src/utils/logging';\nimport { configureItemContextMenu } from './tidy5e-item-context-menu';\nimport { configureActiveEffectsContextMenu } from './tidy5e-active-effect-context-menu';\nimport { configureGroupContextMenu } from './tidy5e-group-context-menu';\nimport { configureFacilityContextMenu } from './tidy5e-facility-context-menu';\nimport { configureActivitiesContextMenu } from './tidy5e-activities-context-menu';\n\nexport function initTidy5eContextMenu(\n  sheet: any,\n  html: any,\n  contextMenuSelector: string = '[data-context-menu]'\n) {\n  FoundryAdapter.createContextMenu(html, contextMenuSelector, [], {\n    onOpen: onItemContext.bind(sheet),\n  });\n}\n\n/**\n * Handle activation of a context menu for an embedded Item or ActiveEffect document.\n * Dynamically populate the array of context menu options.\n * @param {HTMLElement} element       The HTML element for which the context menu is activated\n * @protected\n */\nfunction onItemContext(this: any, element: HTMLElement) {\n  const contextMenuType = element.getAttribute('data-context-menu');\n\n  const app = this;\n\n  switch (contextMenuType) {\n    case CONSTANTS.CONTEXT_MENU_TYPE_ACTIVITIES:\n      configureActivitiesContextMenu(element, app);\n      break;\n    case CONSTANTS.CONTEXT_MENU_TYPE_EFFECTS:\n      configureActiveEffectsContextMenu(element, app);\n      break;\n    case CONSTANTS.CONTEXT_MENU_TYPE_FACILITY_OCCUPANTS:\n      configureFacilityContextMenu(element, app);\n      break;\n    case CONSTANTS.CONTEXT_MENU_TYPE_GROUP_MEMBER:\n      configureGroupContextMenu(element, app);\n      break;\n    case CONSTANTS.CONTEXT_MENU_TYPE_ITEMS:\n      configureItemContextMenu(element, app);\n      break;\n    default:\n      warn(\n        `Unable to show context menu. The menu type ${contextMenuType} is not supported. Put a [data-context-menu] attribute on the target entity and implement the handler where this warning appears.`\n      );\n      break;\n  }\n}\n","import type { RenderScheme } from 'src/api/api.types';\nimport { CONSTANTS } from 'src/constants';\n\nexport function wrapCustomHtmlForRendering(\n  html: string,\n  renderScheme: RenderScheme,\n  id: string,\n  activateDefaultSheetListeners?: boolean\n) {\n  const renderingAttribute =\n    renderScheme === 'handlebars'\n      ? ` ${CONSTANTS.HTML_DYNAMIC_RENDERING_ATTRIBUTE}`\n      : '';\n  const coreListenersTag = activateDefaultSheetListeners\n    ? ` class=\"${CONSTANTS.CLASS_TIDY_USE_CORE_LISTENERS}\"`\n    : '';\n  const groupId = getCustomContentGroupIdAttributeAndValue(id);\n  return `<div style=\"display: contents;\"${renderingAttribute}${coreListenersTag} ${groupId}>${html}</div>`;\n}\n\nfunction getCustomContentGroupIdAttributeAndValue(id: string) {\n  return `data-tidy-custom-content-group-id=\"${id}\"`;\n}\n\nexport function getCustomContentGroupIdSelector(id: string) {\n  return `[${getCustomContentGroupIdAttributeAndValue(id)}]`;\n}\n","import { CONSTANTS } from 'src/constants';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport type { CustomContent, Tab } from 'src/types/types';\nimport { delay } from 'src/utils/asynchrony';\nimport {\n  getCustomContentGroupIdSelector,\n  wrapCustomHtmlForRendering,\n} from 'src/utils/content';\nimport { isNil } from 'src/utils/data';\nimport { processInputChangeDelta } from 'src/utils/form';\nimport { debug, error, warn } from 'src/utils/logging';\n\ntype CustomContentRenderParams = {\n  app: any;\n  element: any; // jQuery\n  data: any;\n  tabs: Tab[];\n  isFullRender: boolean;\n  superActivateListeners: any;\n  customContent: CustomContent[];\n};\n\nexport class CustomContentRenderer {\n  static async render(params: CustomContentRenderParams) {\n    const {\n      app,\n      tabs,\n      element,\n      data,\n      isFullRender,\n      superActivateListeners,\n      customContent,\n    } = params;\n\n    const htmlElement = FoundryAdapter.getElementFromAppV1OrV2(element);\n    if (!htmlElement) {\n      debug('Element not available when it normally should be', params);\n      return;\n    }\n\n    htmlElement\n      .querySelectorAll<HTMLElement>(\n        CONSTANTS.HTML_DYNAMIC_RENDERING_ATTRIBUTE_SELECTOR\n      )\n      .forEach((el: HTMLElement) => el.remove());\n\n    const sheetEl = htmlElement;\n    await CustomContentRenderer._renderTabs(\n      tabs,\n      sheetEl,\n      isFullRender,\n      app,\n      data,\n      params\n    );\n\n    for (let c of customContent) {\n      try {\n        CustomContentRenderer._renderContent(\n          sheetEl,\n          c,\n          app,\n          data,\n          isFullRender,\n          superActivateListeners\n        );\n      } catch (e) {\n        error('Unable to render custom content', false, e);\n        debug('Custom content render failure context', {\n          content: c,\n          app,\n          data,\n          isFullRender,\n        });\n      }\n    }\n  }\n\n  private static _renderTabs(\n    tabs: Tab[],\n    sheetEl: HTMLElement,\n    isFullRender: boolean,\n    app: any,\n    data: any,\n    args: CustomContentRenderParams\n  ): Promise<unknown> {\n    const promises = tabs.map(async (tab) => {\n      try {\n        let tabEl = sheetEl.querySelector<HTMLElement>(\n          `[data-tab-contents-for=\"${tab.id}\"]`\n        );\n\n        if (!tabEl) {\n          // This content was added during a non-forced render (e.g., tab selection changes); wait a tick and re-attempt to set its HTML\n          await delay(0);\n          tabEl = sheetEl.querySelector<HTMLElement>(\n            `[data-tab-contents-for=\"${tab.id}\"]`\n          );\n        }\n\n        if (!tabEl) {\n          debug('Unable to find custom tab content container for render');\n          return;\n        }\n\n        if (\n          tab.content.type === 'html' &&\n          (isFullRender || tab.content.renderScheme === 'handlebars')\n        ) {\n          tabEl.innerHTML = tab.content.html;\n        }\n\n        if (tab.onRender) {\n          tab.onRender({\n            app: app,\n            data: data,\n            element: sheetEl,\n            tabContentsElement: tabEl,\n            isFullRender: isFullRender,\n          });\n        }\n      } catch (e) {\n        error('Failed to render custom content due to an error', false, e);\n        debug('Custom content error debug details', {\n          error: e,\n          erroredTab: tab,\n          args: args,\n        });\n      }\n    });\n    return Promise.all(promises);\n  }\n\n  private static _renderContent(\n    sheetEl: any,\n    customContent: CustomContent,\n    app: any,\n    data: any,\n    isFullRender: boolean,\n    superActivateListeners: any\n  ) {\n    const groupId = foundry.utils.randomID();\n\n    let contentHtml = '';\n    try {\n      contentHtml =\n        typeof customContent.content.html === 'function'\n          ? customContent.content.html(data)\n          : customContent.content.html;\n    } catch (e) {\n      error('Failed to render custom HTML', false, { e, customContent });\n    }\n\n    const wrappedContent = wrapCustomHtmlForRendering(\n      contentHtml,\n      customContent.content.renderScheme,\n      groupId,\n      customContent.activateDefaultSheetListeners\n    );\n\n    if (customContent.onContentReady) {\n      customContent.onContentReady({\n        app: app,\n        data: data,\n        element: sheetEl,\n        isFullRender: isFullRender,\n        content: wrappedContent,\n      });\n    }\n\n    if (!isNil(customContent.position)) {\n      const targetElements = Array.from(\n        sheetEl.querySelectorAll(customContent.selector)\n      ) as HTMLElement[];\n\n      if (!targetElements.length) {\n        debug('No target elements were found for injecting custom content', {\n          content: customContent,\n        });\n      }\n\n      targetElements.forEach((el: HTMLElement) => {\n        el.insertAdjacentHTML(\n          customContent.position as InsertPosition,\n          wrappedContent\n        );\n      });\n\n      if (customContent.activateDefaultSheetListeners) {\n        const groupSelector = getCustomContentGroupIdSelector(groupId);\n        sheetEl\n          .querySelectorAll(groupSelector)\n          .forEach((el: HTMLElement) => superActivateListeners(el));\n      }\n    }\n\n    if (customContent.onRender) {\n      customContent.onRender({\n        app: app,\n        data: data,\n        element: sheetEl,\n        isFullRender: isFullRender,\n      });\n    }\n  }\n\n  static wireCompatibilityEventListeners(\n    html: any,\n    superActivateListeners: any,\n    sheet: any\n  ) {\n    html\n      .find('input[name], textarea[name], select[name]')\n      .off('change.compatiblity-event-listeners')\n      .on('change.compatiblity-event-listeners', async function () {\n        //@ts-expect-error\n        if (!this.closest(CONSTANTS.CLASS_SELECTOR_TIDY_USE_CORE_LISTENERS)) {\n          await sheet.submit();\n        }\n      });\n\n    html\n      .find(CONSTANTS.CLASS_SELECTOR_TIDY_USE_CORE_LISTENERS)\n      .each((_: number, el: HTMLElement) => {\n        superActivateListeners.call(sheet, globalThis.$(el));\n      });\n\n    html\n      .find('input[data-name], textarea[data-name], select[data-name]')\n      .off('change.embedded-doc-compatiblity-event-listeners')\n      .on(\n        'change.embedded-doc-compatiblity-event-listeners',\n        async function (event: any) {\n          // TODO: is jquery giving me the raw event?\n          await _submitEmbeddedDocumentChange(sheet.document, event);\n        }\n      );\n  }\n}\n\n/*----------------------------------------------*/ \n/* Ported from App V2 Svelte Mixin as a stopgap */\n/*----------------------------------------------*/\nasync function _submitEmbeddedDocumentChange(\n  foundryDocument: any,\n  event: InputEvent & { target: HTMLInputElement }\n) {\n  const itemId =\n    event.target.closest<HTMLElement>('[data-item-id]')?.dataset.itemId;\n  if (itemId) {\n    await _submitEmbeddedItemChange(foundryDocument, event, itemId);\n  }\n}\n\nasync function _submitEmbeddedItemChange(\n  foundryDocument: any,\n  event: InputEvent & { target: HTMLInputElement },\n  itemId: string\n) {\n  event.stopImmediatePropagation();\n\n  const item = await getItem(foundryDocument, itemId);\n  const field = event.target.getAttribute('data-name')!;\n\n  let valueToSave: string | number = event.target.value;\n\n  // For deltas, parse the resulting delta value\n  if (event.target.matches('[inputmode=\"numeric\"]')) {\n    valueToSave = processInputChangeDelta(\n      event.target.value,\n      item,\n      field\n    )?.toString();\n  }\n\n  // For numeric changes, enforce min/max on the value to save\n  if (event.target.matches('[inputmode=\"numeric\"], [type=\"number\"]')) {\n    const minAttribute = event.target.getAttribute('min');\n    const min = !isNil(minAttribute, '') ? Number(minAttribute) : -Infinity;\n\n    const maxAttribute = event.target.getAttribute('max');\n    const max = !isNil(maxAttribute, '') ? Number(maxAttribute) : Infinity;\n\n    const valueAsNumber = Number(valueToSave);\n    valueToSave = Math.clamp(valueAsNumber, min, max);\n\n    if (item && !Number.isNaN(valueToSave)) {\n      event.target.value = valueToSave?.toString();\n    }\n  }\n\n  // Save the value to the document, whatever that value ultimately became\n  item.update({ [field]: valueToSave });\n}\n\nasync function getItem(foundryDocument: any, id: string) {\n  if (foundryDocument.type === 'container')\n    return foundryDocument.system.getContainedItem(id);\n  return foundryDocument.items.get(id);\n}\n","import { debug, error } from './logging';\n\nexport type UserDocumentSessionStorageKeyParams = {\n  userId: string;\n  documentId: string;\n  feature: string;\n};\n\nexport class SessionStorageManager {\n  private static _createKey(keyParams: UserDocumentSessionStorageKeyParams) {\n    return `user-${keyParams.userId}|document-${keyParams.documentId}|${keyParams.feature}`;\n  }\n\n  static storeMap<Key, Value>(\n    keyParams: UserDocumentSessionStorageKeyParams,\n    map: Map<Key, Value>\n  ) {\n    try {\n      const serializedMap = JSON.stringify(Array.from(map.entries()));\n      sessionStorage.setItem(\n        SessionStorageManager._createKey(keyParams),\n        serializedMap\n      );\n    } catch (e) {\n      error(\n        'An error occurred while storing cached data in session storage',\n        false,\n        e\n      );\n      debug('Troubleshooting information', { keyParams, map });\n    }\n  }\n\n  static getMap<Key, Value>(\n    keyParams: UserDocumentSessionStorageKeyParams\n  ): Map<Key, Value> | undefined {\n    try {\n      const data = sessionStorage.getItem(\n        SessionStorageManager._createKey(keyParams)\n      );\n      return data ? new Map(JSON.parse(data)) : undefined;\n    } catch (e) {\n      error(\n        'An error occurred while fetching cached data in session storage',\n        false,\n        e\n      );\n      debug('Troubleshooting information', { keyParams });\n    }\n  }\n}\n","import { debug } from 'src/utils/logging';\nimport {\n  SessionStorageManager,\n  type UserDocumentSessionStorageKeyParams,\n} from 'src/utils/session-storage';\n\ntype ItemTableToggleCacheServiceConstructorParams = {\n  userId: string;\n  documentId: string;\n};\n\nexport type OnItemTableToggleFn =\n  ItemTableToggleCacheService['onItemTableToggle'];\n\nexport class ItemTableToggleCacheService {\n  private _keyParams: UserDocumentSessionStorageKeyParams;\n\n  itemTableToggles: Map<string, boolean>;\n\n  constructor(params: ItemTableToggleCacheServiceConstructorParams) {\n    this._keyParams = {\n      ...params,\n      feature: 'item-table-toggles',\n    };\n    this.itemTableToggles = this.itemTableToggles =\n      SessionStorageManager.getMap(this._keyParams) ??\n      new Map<string, boolean>();\n  }\n\n  onItemTableToggle(location: string, expanded: boolean): void {\n    debug('Toggled Item Table', { location, expanded });\n    this.itemTableToggles.set(location, expanded);\n    SessionStorageManager.storeMap(this._keyParams, this.itemTableToggles);\n  }\n}\n","/**\n * A utility for guaranteeing mutually exclusive execution of asynchronous code.\n * This is useful for cases when async code is being called\n * by synchronous code which doesn't account for the asynchrony.\n */\nexport class AsyncMutex {\n  private _mutex: Promise<void>;\n\n  constructor() {\n    this._mutex = Promise.resolve();\n  }\n\n  /**\n   * Perform an action with guaranteed mutual exclusion.\n   * @param action the action to take\n   * @returns a promise representing the entirety of the operation\n   */\n  lock(action: () => Promise<any>) {\n    let currentMutex = this._mutex;\n    // take a place in line\n    this._mutex = new Promise(async (resolve) => {\n      try {\n        // await release of the existing lock\n        await currentMutex;\n        // execute mutually exclusive action\n        await action();\n      } finally {\n        // release the lock, allowing others to pass through\n        resolve();\n      }\n    });\n    // allow this whole process to be awaited\n    return this._mutex;\n  }\n}\n","import { CONSTANTS } from 'src/constants';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport type {\n  ActorSheetContextV1,\n  DamageModificationContextEntry,\n  DamageModificationData,\n} from 'src/types/types';\nimport { debug, error } from 'src/utils/logging';\n\n/**\n * Temporarily a utility class for common actor sheet functions.\n * Eventually planned to be a base class for Tidy 5e Sheet classes\n * after Tidy takes over all sheet logic.\n */\nexport class Tidy5eBaseActorSheet {\n  static applyCommonContext(context: ActorSheetContextV1) {\n    // Concentration\n    if (\n      [CONSTANTS.SHEET_TYPE_CHARACTER, CONSTANTS.SHEET_TYPE_NPC].includes(\n        context.actor.type\n      )\n    ) {\n      const attrConcentration = context.actor.system.attributes.concentration;\n      if (\n        context.actor.statuses.has(CONFIG.specialStatusEffects.CONCENTRATING) ||\n        (FoundryAdapter.isSheetUnlocked(context.actor) &&\n          attrConcentration)\n      ) {\n        (context.saves ??= {}).concentration = {\n          isConcentration: true,\n          label: game.i18n.localize('DND5E.Concentration'),\n          abbr: game.i18n.localize('DND5E.Concentration'),\n          mod: Math.abs(attrConcentration.save),\n          sign:\n            context.actor.system.attributes.concentration.save < 0 ? '-' : '+',\n        };\n      }\n    }\n\n    context.hasSpecialSaves = Object.keys(context.saves ?? {}).length > 0;\n\n    // Damage Modification\n    Tidy5eBaseActorSheet.applyDamageModifications(context);\n  }\n\n  static applyDamageModifications(context: ActorSheetContextV1) {\n    try {\n      // Damage modifications\n      const dm: DamageModificationData | undefined =\n        context.actor.system.traits?.dm;\n      if (dm) {\n        const rollData = context.actor.getRollData({ deterministic: true });\n        const mods = Object.entries(dm.amount)\n          .map(([key, value]) => {\n            const total = dnd5e.utils.simplifyBonus(value, rollData);\n            if (!total) return null;\n\n            const damageType =\n              CONFIG.DND5E.damageTypes[\n                key as keyof typeof CONFIG.DND5E.damageTypes\n              ] ?? {};\n\n            const mod: DamageModificationContextEntry = {\n              label: `${damageType?.label ?? key} ${dnd5e.utils.formatNumber(\n                total,\n                { signDisplay: 'always' }\n              )}`,\n              consequence: total > 0 ? 'detriment' : 'benefit',\n            };\n            const icons: string[] = (mod.icons = []);\n            if (\n              dm.bypasses.size &&\n              'isPhysical' in damageType &&\n              damageType?.isPhysical\n            )\n              icons.push(...dm.bypasses);\n            return mod;\n          })\n          .filter((f) => f);\n\n        context.traits.traits.dm = mods;\n      }\n    } catch (e) {\n      error(\n        'An error occurred while preparing Damage Modification data',\n        false,\n        e\n      );\n      debug('Damage Modification error troubleshooting info', { context });\n    }\n  }\n}\n","import { CONSTANTS } from 'src/constants';\nimport type { Item5e } from 'src/types/item.types';\nimport type {\n  ActorInventoryTypes,\n  CharacterFeatureSection,\n  CharacterItemPartitions,\n  FavoriteSection,\n  GenericFavoriteSection,\n  TypedActivityFavoriteSection,\n  TypedEffectFavoriteSection,\n} from 'src/types/types';\nimport { TidyFlags } from 'src/foundry/TidyFlags';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { SheetSections } from './SheetSections';\n\nexport class CharacterSheetSections {\n  static buildFeaturesSections(\n    actor: any,\n    tabId: string,\n    races: any[],\n    backgrounds: any[],\n    classes: any[],\n    feats: any[],\n    options: Partial<CharacterFeatureSection>\n  ): Record<string, CharacterFeatureSection> {\n    const customFeats = feats.filter((f) => TidyFlags.section.get(f));\n    feats = feats.filter((f) => !TidyFlags.section.get(f));\n\n    const features: Record<string, CharacterFeatureSection> = {\n      race: {\n        label: CONFIG.Item.typeLabels.race,\n        items: races,\n        hasActions: false,\n        dataset: { type: CONSTANTS.ITEM_TYPE_RACE },\n        showRequirementsColumn: true,\n        canCreate: true,\n        key: CONSTANTS.CHARACTER_FEAT_SECTION_RACE,\n        show: true,\n        ...options,\n      },\n      background: {\n        label: CONFIG.Item.typeLabels.background,\n        items: backgrounds,\n        hasActions: false,\n        dataset: { type: CONSTANTS.ITEM_TYPE_BACKGROUND },\n        showRequirementsColumn: true,\n        canCreate: true,\n        key: CONSTANTS.CHARACTER_FEAT_SECTION_BACKGROUND,\n        show: true,\n        ...options,\n      },\n      classes: {\n        label: `${CONFIG.Item.typeLabels.class}Pl`,\n        items: classes,\n        hasActions: false,\n        dataset: { type: CONSTANTS.ITEM_TYPE_CLASS },\n        isClass: true,\n        showLevelColumn: true,\n        canCreate: true,\n        key: CONSTANTS.CHARACTER_FEAT_SECTION_CLASSES,\n        show: true,\n        ...options,\n      },\n      active: {\n        label: 'DND5E.FeatureActive',\n        items: feats.filter((feat) => !!feat.system.activities?.size),\n        hasActions: true,\n        dataset: {\n          type: CONSTANTS.ITEM_TYPE_FEAT,\n        },\n        showFeatureTypeColumn: true,\n        showRequirementsColumn: true,\n        showUsagesColumn: true,\n        showUsesColumn: true,\n        canCreate: true,\n        key: CONSTANTS.CHARACTER_FEAT_SECTION_ACTIVE,\n        show: true,\n        ...options,\n      },\n      passive: {\n        label: 'DND5E.FeaturePassive',\n        items: feats.filter((feat) => !feat.system.activities?.size),\n        hasActions: false,\n        dataset: { type: CONSTANTS.ITEM_TYPE_FEAT },\n        showFeatureTypeColumn: true,\n        showRequirementsColumn: true,\n        showUsesColumn: true,\n        canCreate: true,\n        key: CONSTANTS.CHARACTER_FEAT_SECTION_PASSIVE,\n        show: true,\n        ...options,\n      },\n    };\n\n    customFeats.forEach((f) =>\n      CharacterSheetSections.applyCharacterFeatureToSection(\n        features,\n        f,\n        options\n      )\n    );\n\n    SheetSections.getFilteredGlobalSectionsToShowWhenEmpty(\n      actor,\n      tabId\n    ).forEach((s) => {\n      features[s] ??= CharacterSheetSections.createFeatureSection(s, {\n        canCreate: true,\n        ...options,\n      });\n    });\n\n    return features;\n  }\n\n  static applyCharacterFeatureToSection(\n    features: Record<string, CharacterFeatureSection>,\n    feat: Item5e,\n    customSectionOptions: Partial<CharacterFeatureSection>\n  ) {\n    const customSectionName = TidyFlags.section.get(feat);\n\n    if (!customSectionName) {\n      return;\n    }\n\n    const customSection: CharacterFeatureSection = (features[\n      customSectionName\n    ] ??= CharacterSheetSections.createFeatureSection(\n      customSectionName,\n      customSectionOptions\n    ));\n\n    customSection.items.push(feat);\n  }\n\n  static createFeatureSection(\n    customSectionName: string,\n    customSectionOptions: Partial<CharacterFeatureSection>\n  ): CharacterFeatureSection {\n    return {\n      label: customSectionName,\n      items: [],\n      hasActions: true,\n      dataset: {\n        [TidyFlags.section.prop]: customSectionName,\n      },\n      isClass: false,\n      canCreate: true,\n      showUsesColumn: true,\n      showUsagesColumn: true,\n      showFeatureTypeColumn: true,\n      showRequirementsColumn: true,\n      key: customSectionName,\n      custom: {\n        section: customSectionName,\n        creationItemTypes: [CONSTANTS.ITEM_TYPE_FEAT],\n      },\n      show: true,\n      ...customSectionOptions,\n    };\n  }\n\n  static partitionItem(\n    item: Item5e,\n    partitions: CharacterItemPartitions,\n    inventory: ActorInventoryTypes\n  ) {\n    if (item.type === CONSTANTS.ITEM_TYPE_SPELL) {\n      partitions.spells.push(item);\n    } else if (item.type === CONSTANTS.ITEM_TYPE_FEAT) {\n      partitions.feats.push(item);\n    } else if (item.type === CONSTANTS.ITEM_TYPE_RACE) {\n      partitions.species.push(item);\n    } else if (item.type === CONSTANTS.ITEM_TYPE_BACKGROUND) {\n      partitions.backgrounds.push(item);\n    } else if (item.type === CONSTANTS.ITEM_TYPE_CLASS) {\n      partitions.classes.push(item);\n    } else if (item.type === CONSTANTS.ITEM_TYPE_SUBCLASS) {\n      partitions.subclasses.push(item);\n    } else if (item.type === CONSTANTS.ITEM_TYPE_FACILITY) {\n      partitions.facilities.push(item);\n    } else if (Object.keys(inventory).includes(item.type)) {\n      partitions.items.push(item);\n    }\n  }\n\n  // TODO: Figure out how to handle effects with section names that collide with items\n  static mergeDuplicateFavoriteSections(sections: FavoriteSection[]) {\n    let sectionsMap: Record<\n      string,\n      Exclude<\n        FavoriteSection,\n        TypedEffectFavoriteSection | TypedActivityFavoriteSection\n      >\n    > = {};\n    for (let section of sections) {\n      if (\n        section.type === CONSTANTS.FAVORITES_SECTION_TYPE_EFFECT ||\n        section.type === CONSTANTS.FAVORITES_SECTION_TYPE_ACTIVITY\n      ) {\n        continue;\n      }\n\n      const mappedSection = sectionsMap[section.key];\n\n      if (!mappedSection) {\n        sectionsMap[section.key] = section;\n        continue;\n      }\n\n      const incomingItems =\n        CharacterSheetSections.getItemsFromFavoriteSection(section);\n\n      if (mappedSection.type !== CONSTANTS.FAVORITES_SECTION_TYPE_GENERIC) {\n        const mappedItems =\n          CharacterSheetSections.getItemsFromFavoriteSection(mappedSection);\n\n        sectionsMap[section.key] =\n          CharacterSheetSections.createGenericFavoriteSection(section.key, [\n            ...incomingItems,\n            ...mappedItems,\n          ]);\n\n        continue;\n      }\n\n      mappedSection.items.push(...incomingItems);\n    }\n\n    return Object.values(sectionsMap);\n  }\n\n  static getItemsFromFavoriteSection(\n    section: Exclude<\n      FavoriteSection,\n      TypedEffectFavoriteSection | TypedActivityFavoriteSection\n    >\n  ) {\n    return section.type === CONSTANTS.TAB_ACTOR_SPELLBOOK\n      ? section.spells\n      : section.items;\n  }\n\n  static createGenericFavoriteSection(\n    key: string,\n    items: Item5e[]\n  ): GenericFavoriteSection & { type: 'generic' } {\n    return {\n      canCreate: false,\n      dataset: [],\n      items: items,\n      key: key,\n      label: FoundryAdapter.localize(key),\n      custom: {\n        creationItemTypes: [],\n        section: key,\n      },\n      isExternal: false,\n      show: true,\n      type: 'generic',\n    };\n  }\n}\n","import { TidyFlags } from 'src/foundry/TidyFlags';\nimport type { Item5e } from 'src/types/item.types';\nimport type { Actor5e } from 'src/types/types';\nimport { isNil } from 'src/utils/data';\n\n/**\n * A function which returns the items that are visualized by the target sheet.\n */\ntype OwnedItemsFunction = (object: any) => Map<string, Item5e>;\n\n/**\n * A mixin which supports drag-and-drop behaviors specifically catered to\n * Tidy 5e sheets with item lists and custom sections.\n * @param itemsFn A function which returns the items that are visualized by the target sheet.\n * @param Base The base document to extend with this mixin.\n * @returns The base document with custom section logic mixed in.\n */\nexport function BaseSheetCustomSectionMixin<\n  T extends new (...args: any[]) => {\n    _onDropItemCreate(item: any, event: DragEvent): Promise<any> | void;\n    _onSortItem(\n      event: DragEvent,\n      itemData: Record<string, unknown>,\n      allowSectionTransfer?: boolean\n    ): Promise<any> | void;\n    actor: Actor5e;\n    object: any;\n  }\n>(itemsFn: OwnedItemsFunction, Base: T) {\n  return class extends Base {\n    async _onDropItem(event: DragEvent, data: any) {\n      if (!this.actor.isOwner) return false;\n      const item = await Item.implementation.fromDropData(data);\n\n      // Handle moving out of container & item sorting\n      if (this.actor.uuid === item.parent?.uuid) {\n        const removingFromContainer = !isNil(item.system.container);\n        if (removingFromContainer) {\n          await item.update({ 'system.container': null });\n        }\n        return this._onSortItem(event, item.toObject(), !removingFromContainer);\n      }\n\n      return this._onDropItemCreate(item, event);\n    }\n\n    async _onSortItem(\n      event: DragEvent,\n      itemData: Record<string, unknown>,\n      allowSectionTransfer: boolean = true\n    ) {\n      const sourceSection = foundry.utils.getProperty(\n        itemData,\n        TidyFlags.section.prop\n      );\n\n      const targetSection = (event.target as HTMLElement | null)\n        ?.closest('[data-tidy-section-key][data-custom-section=\"true\"]')\n        ?.getAttribute('data-tidy-section-key');\n\n      const isMovedToNewSection =\n        !isNil(targetSection?.trim(), '') && sourceSection !== targetSection;\n\n      const isMovedToDefaultSection =\n        !isNil(sourceSection?.trim(), '') && isNil(targetSection?.trim(), '');\n\n      const initialSortResult = await super._onSortItem(event, itemData);\n\n      if (!allowSectionTransfer) {\n        return initialSortResult;\n      }\n\n      const item = itemsFn(this.object).get(itemData._id as string);\n\n      return isMovedToNewSection\n        ? TidyFlags.section.set(item, targetSection)\n        : isMovedToDefaultSection\n        ? TidyFlags.section.unset(item)\n        : initialSortResult;\n    }\n  };\n}\n","import type { Dnd5eActorCondition } from 'src/foundry/foundry-and-system';\nimport type { Actor5e } from 'src/types/types';\n\n// TODO: In AppV2, consider a mixin for common data preparation between Actors, like in dnd5e.\nexport class ConditionsAndEffects {\n  static async getConditionsAndEffects(\n    actor: Actor5e,\n    object: any,\n    effectSections: any[]\n  ): Promise<{\n    conditions: Dnd5eActorCondition[];\n    effects: any;\n  }> {\n    const conditionIds = new Set();\n    const conditions = Object.entries<any>(CONFIG.DND5E.conditionTypes).reduce<\n      Dnd5eActorCondition[]\n    >((arr, [k, c]) => {\n      if (c.pseudo) return arr; // Filter out pseudo-conditions.\n      const { label: name, icon, reference } = c;\n      const id = dnd5e.utils.staticID(`dnd5e${k}`);\n      conditionIds.add(id);\n      const existing = actor.effects.get(id);\n      const { disabled, img } = existing ?? {};\n      arr.push({\n        name,\n        reference,\n        id: k,\n        icon: img ?? icon,\n        disabled: existing ? disabled : true,\n      });\n      return arr;\n    }, []);\n\n    for (const category of Object.values(effectSections)) {\n      category.effects = await category.effects.reduce(\n        async (arr: any[], effect: any) => {\n          effect.updateDuration();\n          if (conditionIds.has(effect.id) && !effect.duration.remaining)\n            return arr;\n          const { id, name, img, disabled, duration } = effect;\n          let source = (await effect.getSource()) ?? actor;\n          // If the source is an ActiveEffect from another Actor, note the source as that Actor instead.\n          if (source instanceof ActiveEffect) {\n            source = source.target;\n            if (\n              source instanceof Item &&\n              source.parent &&\n              source.parent !== object\n            ) {\n              source = source.parent;\n            }\n          }\n\n          arr = await arr;\n          arr.push({\n            id,\n            name,\n            img,\n            disabled,\n            duration,\n            source,\n            parentId: effect.target === effect.parent ? null : effect.parent.id,\n            durationParts: duration.remaining ? duration.label.split(', ') : [],\n            hasTooltip: source instanceof dnd5e.documents.Item5e,\n            uuid: effect.uuid,\n            effect: effect,\n          });\n          return arr;\n        },\n        []\n      );\n    }\n\n    return {\n      conditions,\n      effects: effectSections,\n    };\n  }\n}\n","import type { Component, ComponentProps } from 'svelte';\nimport { warn } from 'src/utils/logging';\nimport { clamp } from 'src/utils/numbers';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\nexport type InfoCardState<T extends Component<any>> = {\n  component: T;\n  props: ComponentProps<T>;\n  title: string;\n};\n\ntype InfoCardWatcherArgs = {\n  hoverOn: (event: MouseEvent, target: HTMLElement) => void;\n  hoverOff: (event: MouseEvent) => void;\n  dragStart: (event: DragEvent, isWatchedElement: boolean) => void;\n  inspectKeyUp: (event: KeyboardEvent) => void;\n  inspectKey: string;\n  selector: string;\n};\n\nconst cardWidthRem: number = 17.5;\nconst cardHeightRem: number = 28.75;\n\nexport type InfoCardDimensions = {\n  widthRem: string;\n  heightRem: string;\n  rootFontSize: number;\n  cardWidthAbsolute: number;\n  cardHeightAbsolute: number;\n  widthPx: string;\n  heightPx: string;\n};\n\nexport function getInfoCardDimensions(): InfoCardDimensions {\n  const rootFontSize = getRootFontSizePx();\n\n  return {\n    widthRem: `${cardWidthRem}rem`,\n    heightRem: `${cardHeightRem}rem`,\n    rootFontSize: rootFontSize,\n    cardWidthAbsolute: cardWidthRem * rootFontSize,\n    cardHeightAbsolute: cardHeightRem * rootFontSize,\n    widthPx: `${cardWidthRem * rootFontSize}px`,\n    heightPx: `${cardHeightRem * rootFontSize}px`,\n  };\n}\n\ntype FloatingPositionParams = {\n  event: MouseEvent;\n  dimensions: InfoCardDimensions;\n  sheet: any;\n};\n\ntype StaticCardPositionParams = {\n  dimensions: InfoCardDimensions;\n  sheetEl: HTMLElement;\n};\n\nconst mouseCursorCardGapRem = 1.5;\n\nexport function getStaticCardPosition({\n  sheetEl,\n  dimensions,\n}: StaticCardPositionParams): 'left' | 'right' {\n  return sheetEl.offsetLeft >\n    dimensions.cardWidthAbsolute +\n      mouseCursorCardGapRem * dimensions.rootFontSize\n    ? 'left'\n    : 'right';\n}\n\nexport function getInfoCardFloatingPosition(params: FloatingPositionParams) {\n  const { clientX: x, clientY: y } = params.event;\n  const { rootFontSize, cardWidthAbsolute, cardHeightAbsolute } =\n    params.dimensions;\n  const sheetEl = FoundryAdapter.getElementFromAppV1OrV2(params.sheet.element);\n\n  const cardHalfHeightPx = cardHeightAbsolute / 2;\n  const mouseCursorCardGapPx = rootFontSize * mouseCursorCardGapRem;\n\n  const relativeY = y - params.sheet.position.top;\n  const relativeX = x - params.sheet.position.left;\n\n  const putCardOnLeftSide =\n    x + mouseCursorCardGapPx + cardWidthAbsolute > window.innerWidth;\n\n  const minTop = sheetEl.offsetTop * -1 + mouseCursorCardGapPx;\n  const verticallyCenteredCardTop = relativeY - cardHalfHeightPx;\n  const maxTop =\n    window.innerHeight -\n    sheetEl.offsetTop -\n    cardHeightAbsolute -\n    mouseCursorCardGapPx;\n\n  let top = clamp(verticallyCenteredCardTop, minTop, maxTop);\n  let left = putCardOnLeftSide\n    ? relativeX - mouseCursorCardGapPx - cardWidthAbsolute\n    : relativeX + mouseCursorCardGapPx;\n\n  if (relativeY + cardHalfHeightPx > params.sheet.position.bottom) {\n    let diff = window.innerHeight - (relativeY + cardHalfHeightPx);\n    top = relativeY - cardHalfHeightPx + diff;\n  }\n\n  return { top: `${top}px`, left: `${left}px` };\n}\n\nfunction getRootFontSizePx(): number {\n  return document.documentElement.style.fontSize !== ''\n    ? parseFloat(document.documentElement.style.fontSize)\n    : parseFloat(getComputedStyle(document.documentElement).fontSize);\n}\n\n/**\n * Monitors the sheet for hover events of interest and triggers a callback for hovering on and off.\n * This is designed to work in concert with the Info Card to determine what content to show, if any.\n * @param node the info card\n * @param args parameters for wiring up info card hover watch behavior\n */\nexport function infoCardEventWatcher(\n  node: HTMLElement,\n  args: InfoCardWatcherArgs\n) {\n  $effect(() => {\n    const sheetNode = node.closest<HTMLElement>(`.tidy5e-sheet`);\n\n    if (!sheetNode) {\n      warn('Unable to wire up info card watcher. Sheet element not found.');\n      return;\n    }\n\n    const controller = new AbortController();\n\n    sheetNode?.addEventListener(\n      'mouseenter',\n      (ev) => {\n        const target = (\n          ev.target as HTMLElement | undefined\n        )?.closest<HTMLElement>(args.selector);\n\n        if (target) {\n          args.hoverOn(ev, target);\n        }\n      },\n      { passive: true, signal: controller.signal }\n    );\n\n    sheetNode?.addEventListener(\n      'mouseover',\n      (ev) => {\n        const target = (\n          ev.target as HTMLElement | undefined\n        )?.closest<HTMLElement>(args.selector);\n\n        if (target) {\n          args.hoverOn(ev, target);\n        } else {\n          args.hoverOff(ev);\n        }\n      },\n      { passive: true, signal: controller.signal }\n    );\n\n    sheetNode?.addEventListener(\n      'mouseleave',\n      (ev) => {\n        args.hoverOff(ev);\n      },\n      { passive: true, signal: controller.signal }\n    );\n\n    sheetNode?.addEventListener(\n      'dragstart',\n      (ev) => {\n        if (ev.target === null) {\n          return;\n        }\n\n        const target = (ev.target as HTMLElement | undefined)?.closest?.(\n          args.selector\n        );\n\n        args.dragStart(ev, !!target);\n      },\n      { signal: controller.signal }\n    );\n\n    document?.addEventListener(\n      'keyup',\n      (ev) => {\n        if (ev.key.toUpperCase() === args.inspectKey.toUpperCase()) {\n          args.inspectKeyUp(ev);\n        }\n      },\n      { passive: true, signal: controller.signal }\n    );\n\n    return () => {\n      controller.abort();\n    };\n  });\n}\n","<script lang=\"ts\">\n  import type { Item5e } from 'src/types/item.types';\n  import HorizontalLineSeparator from '../../layout/HorizontalLineSeparator.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import ItemSummaryCommandButtonList from '../../item-summary/ItemSummaryCommandButtonList.svelte';\n  import { ItemSummaryRuntime } from 'src/runtime/ItemSummaryRuntime';\n\n  interface Props {\n    item: Item5e;\n    chatData: any | undefined;\n  }\n\n  let { item, chatData }: Props = $props();\n\n  let specialProps = $derived(getSpecialProperties(item));\n  let itemProps = $derived(chatData?.properties ?? []);\n  let itemSummaryCommands = $derived(\n    ItemSummaryRuntime.getItemSummaryCommands(item),\n  );\n\n  function getSpecialProperties(item: Item5e | undefined): string[] {\n    const props: string[] = [];\n\n    if (item?.labels?.toHit) {\n      props.push(item.labels.toHit.replace('+ ', '+').replace('- ', '-'));\n    }\n    if (item?.labels?.damage && item.labels?.damages?.length > 0) {\n      props.push(\n        item.labels.damages[0].label.replace(' + ', '+').replace(' - ', '-'),\n      );\n    }\n    if (item?.labels?.save) {\n      props.push(item.labels.save);\n    }\n\n    return props;\n  }\n</script>\n\n{#if specialProps.length}\n  <HorizontalLineSeparator />\n  <div\n    class=\"inline-wrapped-elements\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_PROPERTY_LIST}\n  >\n    {#each specialProps as prop}\n      <span class=\"tag\">{prop}</span>\n    {/each}\n  </div>\n{/if}\n{#if itemProps.length}\n  <HorizontalLineSeparator />\n  <div\n    class=\"inline-wrapped-elements\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_PROPERTY_LIST}\n  >\n    {#each itemProps as prop}\n      <span class=\"tag\">{prop}</span>\n    {/each}\n  </div>\n{/if}\n{#if itemSummaryCommands.length}\n  <HorizontalLineSeparator />\n  <div class=\"inline-wrapped-elements\">\n    <ItemSummaryCommandButtonList {item} />\n  </div>\n{/if}\n","<script lang=\"ts\">\n  import type { Item5e } from 'src/types/item.types';\n  import ItemCardPills from '../Parts/ItemCardPills.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { coalesce } from 'src/utils/formatting';\n  import HorizontalLineSeparator from '../../layout/HorizontalLineSeparator.svelte';\n\n  interface Props {\n    item: Item5e;\n  }\n\n  let { item }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n{#if !FoundryAdapter.concealDetails(item)}\n  {#await item.getChatData({ secrets: item.actor?.isOwner }) then chatData}\n    <header>\n      {item.system.identified === false\n        ? coalesce(\n            item.system.unidentified.name,\n            localize('DND5E.Unidentified.Title'),\n          )\n        : item.name}\n    </header>\n    <div class=\"info-card-content\">\n      {#if item.hasLimitedUses}\n        <div class=\"info-card-amount\">\n          <span\n            ><i class=\"fas fa-bolt\"></i><b>{localize('DND5E.Charges')}:</b>\n            {item.system.uses.value}/{item.system.uses.max}</span\n          >\n        </div>\n        <HorizontalLineSeparator borderColor=\"faint\" />\n      {/if}\n      <div class=\"description-wrap\">\n        <div class=\"info-card-description user-select-text\">\n          {@html chatData.description}\n        </div>\n      </div>\n    </div>\n    <ItemCardPills {item} {chatData} />\n  {/await}\n{:else}\n  TODO: Show unidentified text, or blank.\n{/if}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { Item5e } from 'src/types/item.types';\n  import { coalesce } from 'src/utils/formatting';\n  import ItemCardPills from '../Parts/ItemCardPills.svelte';\n  import HorizontalLineSeparator from '../../layout/HorizontalLineSeparator.svelte';\n  import { getInventoryItemThemeBackground } from 'src/theme/theme';\n\n  interface Props {\n    item: Item5e;\n  }\n\n  let { item }: Props = $props();\n\n  const concealDetails = $derived(FoundryAdapter.concealDetails(item));\n  const attunementContext = $derived.by(() =>\n    FoundryAdapter.getAttunementContext(item),\n  );\n\n  const headerBackground = $derived.by(() => {\n    const variableName = getInventoryItemThemeBackground(item) ?? '';\n    if (variableName !== '') {\n      return `var(${variableName})`;\n    }\n    return null;\n  });\n\n  const localize = FoundryAdapter.localize;\n  const weightUnit = FoundryAdapter.getWeightUnit();\n</script>\n\n{#await item.getChatData({ secrets: item.actor?.isOwner }) then chatData}\n  <header style:--card-header-background={headerBackground}>\n    {item.system.identified === false\n      ? coalesce(\n          item.system.unidentified.name,\n          localize('DND5E.Unidentified.Title'),\n        )\n      : item.name}\n  </header>\n  <div class=\"info-card-content\">\n    {#if item.system.properties?.has('mgc') || attunementContext}\n      <div class=\"info-card-states\">\n        {#if item.system.properties?.has('mgc')}\n          <span class=\"flex-row extra-small-gap align-items-center\"\n            ><i class=\"fas fa-magic\"></i>Magic Item</span\n          >\n        {/if}\n        {#if attunementContext && !concealDetails}\n          <span\n            class=\"flex-row extra-small-gap align-items-center info-attuned {attunementContext.cls ??\n              ''}\"\n          >\n            <i class=\"fas fa-sun\"></i>\n            {localize(attunementContext.title)}\n          </span>\n        {/if}\n      </div>\n      <HorizontalLineSeparator borderColor=\"faint\" />\n    {/if}\n    <div class=\"info-card-amount\">\n      <span class=\"info-weight\"\n        ><b>{localize('DND5E.Weight')}:</b>\n        {item.system.weight.value}\n        {weightUnit}</span\n      >\n      <span class=\"info-quantity\"\n        ><b>{localize('DND5E.Quantity')}:</b>\n        {item.system.quantity}\n        {#if item.system.price.value}\n          &times;\n          {#if concealDetails}\n            {localize('DND5E.Unidentified.Value')}\n          {:else}\n            {item.system.price.value}\n            {item.system.price.denomination}\n          {/if}\n        {/if}\n      </span>\n    </div>\n    <HorizontalLineSeparator borderColor=\"faint\" />\n    {#if item.hasLimitedUses}\n      <div class=\"info-card-amount\">\n        <span\n          ><i class=\"fas fa-bolt\"></i><b>{localize('DND5E.Charges')}:</b>\n          {item.system.uses.value}/{item.system.uses.max}</span\n        >\n      </div>\n      <HorizontalLineSeparator borderColor=\"faint\" />\n    {/if}\n    <div class=\"description-wrap\">\n      <div class=\"info-card-description user-select-text\">\n        {@html chatData.description}\n      </div>\n    </div>\n  </div>\n  <ItemCardPills {item} {chatData} />\n{/await}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getSpellItemThemeBackground } from 'src/theme/theme';\n  import type { Item5e } from 'src/types/item.types';\n  import { coalesce } from 'src/utils/formatting';\n  import HorizontalLineSeparator from '../../layout/HorizontalLineSeparator.svelte';\n  import { SpellUtils } from 'src/utils/SpellUtils';\n  import ItemCardPills from '../Parts/ItemCardPills.svelte';\n  import { Enrichers } from 'src/features/enrichers/Enrichers';\n\n  interface Props {\n    item: Item5e;\n  }\n\n  let { item }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n\n  const headerBackground = $derived.by(() => {\n    const variableName = getSpellItemThemeBackground(item) ?? '';\n    if (variableName !== '') {\n      return `var(${variableName})`;\n    }\n    return null;\n  });\n\n  let canPrepare = $derived(FoundryAdapter.canPrepareSpell(item));\n  let toggleTitle = $derived(SpellUtils.getToggleTitle(item));\n  let owner = $derived<boolean>(item.actor?.isOwner ?? item.isOwner);\n  let linked = $derived<Item5e>(item.system.linkedActivity?.item);\n</script>\n\n{#await item.getChatData({ secrets: owner }) then chatData}\n  <header style:--card-header-background={headerBackground}>\n    {item.system.identified === false\n      ? coalesce(\n          item.system.unidentified.name,\n          localize('DND5E.Unidentified.Title'),\n        )\n      : item.name}\n  </header>\n  <div class=\"info-card-content\">\n    {#if item.labels?.school || (owner && canPrepare)}\n      <div class=\"info-card-states\">\n        <span>{item.labels?.school ?? ''}</span>\n        {#if owner}\n          {#if !canPrepare && item.system.level !== 0}\n            <span>\n              {CONFIG.DND5E.spellPreparationModes[item.system.preparation?.mode]\n                ?.label ?? item.system.preparation?.mode}\n            </span>\n          {:else if canPrepare}\n            <span>{toggleTitle ?? ''}</span>\n          {/if}\n        {/if}\n      </div>\n      <HorizontalLineSeparator borderColor=\"faint\" />\n    {/if}\n    {#if item.hasLimitedUses}\n      <div class=\"info-card-amount\">\n        <span\n          ><i class=\"fas fa-bolt\"></i><b>{localize('DND5E.Charges')}:</b>\n          {item.system.uses.value}/{item.system.uses.max}</span\n        >\n      </div>\n      <HorizontalLineSeparator borderColor=\"faint\" />\n    {/if}\n    <div class=\"description-wrap\">\n      <div class=\"info-card-description user-select-text\">\n        {@html chatData.description}\n      </div>\n    </div>\n  </div>\n  {#if linked}\n    <HorizontalLineSeparator borderColor=\"faint\" />\n    {#await FoundryAdapter.enrichHtml(Enrichers.reference(linked.uuid, linked.name)) then enriched}\n      <div class=\"info-card-linked-source\">\n        {@html localize('TIDY5E.Activities.Cast.SourceHintText', {\n          itemName: enriched,\n        })}\n      </div>\n    {/await}\n  {/if}\n  <ItemCardPills {item} {chatData} />\n{/await}\n","<script lang=\"ts\">\n  import HorizontalLineSeparator from 'src/components/layout/HorizontalLineSeparator.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type { ActiveEffect5e } from 'src/types/types';\n  import { ActiveEffectsHelper } from 'src/utils/active-effect';\n\n  interface Props {\n    activeEffect: ActiveEffect5e;\n  }\n\n  let { activeEffect }: Props = $props();\n\n  let enrichedDescriptionPromise = $derived(\n    FoundryAdapter.enrichHtml(activeEffect.description ?? '', {\n      secrets: activeEffect.isOwner,\n      relativeTo: activeEffect,\n      rollData: {},\n    }),\n  );\n\n  let pills = $derived.by(() =>\n    ActiveEffectsHelper.getActiveEffectPills(activeEffect),\n  );\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<header>\n  {activeEffect.name}\n</header>\n\n<div class=\"info-card-content\">\n  <div class=\"info-card-states\">\n    <span>{activeEffect.parent?.name}</span>\n  </div>\n  <HorizontalLineSeparator borderColor=\"faint\" />\n  <div class=\"info-card-states\">\n    <span>\n      <i class=\"fa-regular fa-clock\"></i>\n      {activeEffect.duration?.seconds ?? ''}\n    </span>\n    <span>\n      {#if activeEffect.type === 'enchantment'}\n        <i class=\"fa-solid fa-wand-sparkles\"></i>\n        {localize('DND5E.ENCHANTMENT.Label')}\n      {/if}\n    </span>\n  </div>\n  <HorizontalLineSeparator borderColor=\"faint\" />\n  <div class=\"description-wrap\">\n    {#await enrichedDescriptionPromise then description}\n      {@html description}\n    {/await}\n\n    <ul style=\"margin-block-start: 1rem;\" class=\"unlist flex-column small-gap\">\n      {#each activeEffect.changes as change}\n        {@const modeLabel = ActiveEffectsHelper.findMode(change.mode)}\n        <li>\n          <div>\n            <strong class=\"break-word\">{change.key}</strong>\n          </div>\n          <div>\n            <span>{modeLabel}</span>\n            <span class=\"text-body-tertiary break-word\">|</span>\n            {change.value}\n          </div>\n        </li>\n      {/each}\n    </ul>\n  </div>\n</div>\n{#if pills.length}\n  <HorizontalLineSeparator />\n  <div\n    class=\"inline-wrapped-elements\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.ITEM_PROPERTY_LIST}\n  >\n    {#each pills as pill}\n      <span class=\"tag\">{localize(pill)}</span>\n    {/each}\n  </div>\n{/if}\n","<script lang=\"ts\">\n  import type { InfoCardState } from 'src/components/info-card/info-card.svelte';\n  import { warn } from 'src/utils/logging';\n\n  interface Props {\n    cardState: InfoCardState<any>;\n  }\n\n  let { cardState }: Props = $props();\n\n  function onError(error: unknown) {\n    warn('An error occurred while managing the info card', false, {\n      error,\n      card: cardState,\n    });\n  }\n</script>\n\n<section class=\"tidy-info-card\">\n  <section class=\"info-card-body\">\n    <svelte:boundary onerror={onError}>\n      <cardState.component {...cardState.props} />\n    </svelte:boundary>\n  </section>\n</section>\n","import type { InfoCardState } from 'src/components/info-card/info-card.svelte';\nimport { CONSTANTS } from 'src/constants';\nimport { SvelteApplicationMixin } from 'src/mixins/SvelteApplicationMixin.svelte';\nimport type { ApplicationConfiguration } from 'src/types/application.types';\nimport { mount } from 'svelte';\nimport DetachedInfoCard from './DetachedInfoCard.svelte';\n\nexport class DetachedInfoCardApplication extends SvelteApplicationMixin<{}>(\n  foundry.applications.api.ApplicationV2\n) {\n  #cardState: InfoCardState<any>;\n\n  constructor(cardState: InfoCardState<any>, ...rest: any[]) {\n    super(...rest);\n\n    this.#cardState = cardState;\n  }\n\n  static DEFAULT_OPTIONS: Partial<\n    ApplicationConfiguration & { dragDrop: Partial<DragDropConfiguration>[] }\n  > = {\n    classes: [\n      CONSTANTS.MODULE_ID,\n      'application-shell',\n      'tidy-info-card-application',\n      'app-v2',\n      CONSTANTS.SHEET_LAYOUT_CLASSIC,\n    ],\n    tag: 'div',\n    window: {\n      frame: true,\n      positioned: true,\n      resizable: true,\n      controls: [],\n    },\n    position: {\n      width: 280,\n      height: 460,\n    },\n    actions: {},\n    submitOnClose: false,\n  };\n\n  _createComponent(node: HTMLElement): Record<string, any> {\n    const component = mount(DetachedInfoCard, {\n      target: node,\n      props: {\n        cardState: this.#cardState,\n      },\n    });\n\n    return component;\n  }\n\n  async _prepareContext() {\n    return {};\n  }\n}\n","<script lang=\"ts\">\n  import { warn } from 'src/utils/logging';\n  import {\n    getInfoCardDimensions,\n    getInfoCardFloatingPosition,\n    getStaticCardPosition,\n    infoCardEventWatcher,\n    type InfoCardDimensions,\n    type InfoCardState,\n  } from './info-card.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import DefaultItemCard from './Cards/DefaultItemCard.svelte';\n  import InventoryItemCard from './Cards/InventoryItemCard.svelte';\n  import SpellItemCard from './Cards/SpellItemCard.svelte';\n  import EffectInfoCard from './Cards/EffectInfoCard.svelte';\n  import { Inventory } from 'src/features/sections/Inventory';\n  import { CONSTANTS } from 'src/constants';\n  import type { Component, ComponentProps } from 'svelte';\n  import { isUserInteractable } from 'src/utils/element';\n  import { DetachedInfoCardApplication } from 'src/applications/info-card/DetachedInfoCardApplication';\n  import { settings } from 'src/settings/settings.svelte';\n\n  interface Props {\n    sheet: any;\n  }\n\n  let { sheet }: Props = $props();\n\n  let floating = $derived(settings.value.itemCardsAreFloating);\n  let inspectKey= $derived(settings.value.itemCardsFixKey);\n  let delay = $derived(settings.value.itemCardsDelay);\n\n  const localize = FoundryAdapter.localize;\n\n  const infoCardAttributeKey = 'data-info-card';\n  const selector = `[${infoCardAttributeKey}], .tidy-info-card`;\n  const uuidAttribute = 'data-info-card-entity-uuid';\n  const sheetEl = $derived<HTMLElement>(\n    FoundryAdapter.getElementFromAppV1OrV2(sheet.element),\n  );\n\n  let staticCardPosition = $derived.by<'left' | 'right'>(() => {\n    show;\n    return getStaticCardPosition({ dimensions, sheetEl });\n  });\n\n  let show = $state(false);\n\n  // When floating, reposition the card whenever shown and mousing over the sheet.\n  $effect(() => {\n    const controller = new AbortController();\n\n    if (floating) {\n      sheetEl.addEventListener(\n        'mousemove',\n        (event) => {\n          let { top, left } = getInfoCardFloatingPosition({\n            event,\n            sheet,\n            dimensions,\n          });\n          floatingLeft = left;\n          floatingTop = top;\n        },\n        { signal: controller.signal },\n      );\n    }\n\n    return () => {\n      controller.abort();\n    };\n  });\n\n  let card = $state<InfoCardState<any> | undefined>();\n  let floatingLeft = $state<string | undefined>();\n  let floatingTop = $state<string | undefined>();\n  let dimensions = $state<InfoCardDimensions>(getInfoCardDimensions());\n\n  // TODO: Find much better home\n  function withProps<TComponent extends Component<any>>(\n    component: TComponent,\n    props: ComponentProps<TComponent>,\n  ) {\n    return {\n      component: component,\n      props: props,\n    };\n  }\n\n  async function hoverOn(_event: MouseEvent, target: HTMLElement) {\n    // Get the card state\n    const cardType = target.getAttribute('data-info-card');\n    const uuid = target.getAttribute(uuidAttribute);\n\n    if (!uuid || !cardType) {\n      show = false;\n      return;\n    }\n\n    switch (cardType) {\n      case 'effect': {\n        if (!settings.value.useEffectCards) {\n          show = false;\n          return;\n        }\n\n        const entity = await fromUuid(uuid);\n\n        if (!entity) {\n          show = false;\n          return;\n        }\n\n        card = {\n          component: EffectInfoCard,\n          props: { activeEffect: entity },\n          title: entity.name,\n        } satisfies InfoCardState<typeof EffectInfoCard>;\n        break;\n      }\n      // case 'activity': {\n      //   card = {\n      //     component: ActivityInfoCard,\n      //     props: { activity: entity },\n      //     title: entity.name,\n      //   };\n      //   break;\n      // }\n      // TODO: Uncomment the above case when it's time to implement it\n\n      case 'item': {\n        if (\n          !settings.value.itemCardsForAllItems &&\n          !target.matches('[data-tidy-grid-item]')\n        ) {\n          show = false;\n          return;\n        }\n\n        const entity = await fromUuid(uuid);\n\n        if (!entity) {\n          show = false;\n          return;\n        }\n\n        if (Inventory.isInventoryType(entity)) {\n          card = {\n            ...withProps(InventoryItemCard, { item: entity }),\n            title: entity.name,\n          } satisfies InfoCardState<typeof InventoryItemCard>;\n        } else if (entity?.type === CONSTANTS.ITEM_TYPE_SPELL) {\n          card = {\n            ...withProps(SpellItemCard, { item: entity }),\n            title: entity.name,\n          } satisfies InfoCardState<typeof InventoryItemCard>;\n        } else {\n          card = {\n            ...withProps(DefaultItemCard, { item: entity }),\n            title: entity.name,\n          } satisfies InfoCardState<typeof InventoryItemCard>;\n        }\n\n        break;\n      }\n      default: {\n        show = false;\n        return;\n      }\n    }\n\n    show = true;\n  }\n\n  function hoverOff() {\n    show = false;\n  }\n\n  function dragStart() {\n    show = false;\n  }\n\n  function inspectKeyUp() {\n    if (!show || !card) {\n      return;\n    }\n\n    const focusedElement = sheetEl.ownerDocument.activeElement;\n\n    if (\n      focusedElement instanceof HTMLElement &&\n      isUserInteractable(focusedElement)\n    ) {\n      return;\n    }\n\n    new DetachedInfoCardApplication(\n      { ...card },\n      {\n        window: { title: card.title },\n        position: {\n          width: dimensions.cardWidthAbsolute,\n          height: dimensions.cardHeightAbsolute,\n        },\n      },\n    ).render(true);\n\n    hoverOff();\n  }\n\n  function onError(error: unknown) {\n    warn('An error occurred while managing the info card', false, {\n      error,\n      card,\n      sheet,\n    });\n  }\n</script>\n\n<section\n  class=\"tidy-info-card attached {!floating ? staticCardPosition : ''}\"\n  class:show\n  class:floating\n  data-tidy-info-card\n  style:top={floating ? floatingTop : undefined}\n  style:left={floating ? floatingLeft : undefined}\n  style:--card-width={dimensions.widthRem}\n  style:--card-height={dimensions.heightRem}\n  style:--transition-show-delay=\"{delay}ms\"\n  use:infoCardEventWatcher={{\n    hoverOn,\n    hoverOff,\n    dragStart,\n    inspectKeyUp,\n    selector: selector,\n    inspectKey: inspectKey,\n  }}\n>\n  {#if card?.component}\n    <section class=\"info-card-body\">\n      <svelte:boundary onerror={onError}>\n        <card.component {...card.props} />\n      </svelte:boundary>\n    </section>\n    <footer>\n      <span>\n        {@html localize('TIDY5E.InfoCardInspectHint', {\n          inspectKey: `<span class=\"key\">${inspectKey}</span>`,\n        })}\n      </span>\n      <span>\n        <i class=\"fas fa-mouse\"></i>\n        {localize('TIDY5E.ItemCardsMouseHint')}\n      </span>\n    </footer>\n  {/if}\n</section>\n","import { FoundryAdapter } from '../../foundry/foundry-adapter';\nimport CharacterSheet from './character/CharacterSheet.svelte';\nimport { debug, warn } from 'src/utils/logging';\nimport { settings } from 'src/settings/settings.svelte';\nimport { initTidy5eContextMenu } from 'src/context-menu/tidy5e-context-menu';\nimport { CONSTANTS } from 'src/constants';\nimport {\n  type CharacterSheetContext,\n  type SheetStats,\n  type Actor5e,\n  type SheetTabCacheable,\n  type SheetExpandedItemsCacheable,\n  type SearchFilterCacheable,\n  type LocationToSearchTextMap,\n  type ExpandedItemIdToLocationsMap,\n  type ExpandedItemData,\n  type MessageBus,\n  type Utilities,\n  type ActiveEffect5e,\n  type ActorInventoryTypes,\n  type CharacterItemPartitions,\n  type CharacterFeatureSection,\n  type CharacterItemContext,\n  type SpellbookSection,\n  type EffectFavoriteSection,\n  type FacilityOccupantContext,\n  type FacilitySection,\n  type ChosenFacilityContext,\n  type TypedActivityFavoriteSection,\n  type AttributePinContext,\n} from 'src/types/types';\nimport {\n  applySheetAttributesToWindow,\n  applyMutableSettingAttributesToWindow,\n  applyTitleToWindow,\n  blurUntabbableButtonsOnClick,\n  maintainCustomContentInputFocus,\n} from 'src/utils/applications.svelte';\nimport { mount, unmount } from 'svelte';\nimport type { Item5e, ItemChatData } from 'src/types/item.types';\nimport CharacterSheetRuntime from 'src/runtime/CharacterSheetRuntime.svelte';\nimport {\n  actorUsesActionFeature,\n  getActorActionSections,\n} from 'src/features/actions/actions.svelte';\nimport { isNil } from 'src/utils/data';\nimport { CustomContentRenderer } from '../CustomContentRenderer';\nimport { ActorPortraitRuntime } from 'src/runtime/ActorPortraitRuntime';\nimport { CustomActorTraitsRuntime } from 'src/runtime/actor-traits/CustomActorTraitsRuntime';\nimport { ItemTableToggleCacheService } from 'src/features/caching/ItemTableToggleCacheService';\nimport { ItemFilterService } from 'src/features/filtering/ItemFilterService.svelte';\nimport { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\nimport { AsyncMutex } from 'src/utils/mutex';\nimport { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\nimport { Tidy5eBaseActorSheet } from './Tidy5eBaseActorSheet.svelte';\nimport { CharacterSheetSections } from 'src/features/sections/CharacterSheetSections';\nimport { SheetSections } from 'src/features/sections/SheetSections';\nimport { DocumentTabSectionConfigApplication } from 'src/applications/section-config/DocumentTabSectionConfigApplication.svelte';\nimport { BaseSheetCustomSectionMixin } from './mixins/BaseSheetCustomSectionMixin';\nimport { Inventory } from 'src/features/sections/Inventory';\nimport type {\n  CharacterFavorite,\n  FacilityOccupants,\n  UnsortedCharacterFavorite,\n} from 'src/foundry/dnd5e.types';\nimport { TidyHooks } from 'src/foundry/TidyHooks';\nimport { TidyFlags } from 'src/foundry/TidyFlags';\nimport { Container } from 'src/features/containers/Container';\nimport { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\nimport { ConditionsAndEffects } from 'src/features/conditions-and-effects/ConditionsAndEffects';\nimport type { ContextMenuEntry } from 'src/foundry/foundry.types';\nimport { Activities } from 'src/features/activities/activities';\nimport { CoarseReactivityProvider } from 'src/features/reactivity/CoarseReactivityProvider.svelte';\nimport AttachedInfoCard from 'src/components/info-card/AttachedInfoCard.svelte';\nimport { ExpansionTracker } from 'src/features/expand-collapse/ExpansionTracker.svelte';\nimport { AttributePins } from 'src/features/attribute-pins/AttributePins';\nimport type { AttributePinFlag } from 'src/foundry/TidyFlags.types';\n\nexport class Tidy5eCharacterSheet\n  extends BaseSheetCustomSectionMixin(\n    (object) => object.items,\n    dnd5e.applications.actor.ActorSheet5eCharacter\n  )\n  implements\n    SheetTabCacheable,\n    SheetExpandedItemsCacheable,\n    SearchFilterCacheable\n{\n  context = new CoarseReactivityProvider<CharacterSheetContext | undefined>(\n    undefined\n  );\n\n  stats = $state<SheetStats>({\n    lastSubmissionTime: null,\n  });\n  currentTabId: string;\n  searchFilters: LocationToSearchTextMap = new Map<string, string>();\n  expandedItems: ExpandedItemIdToLocationsMap = new Map<string, Set<string>>();\n  expandedItemData: ExpandedItemData = new Map<string, ItemChatData>();\n  inlineToggleService = new InlineToggleService();\n  itemTableTogglesCache: ItemTableToggleCacheService;\n  itemFilterService: ItemFilterService;\n  messageBus = $state<MessageBus>({ message: undefined });\n  sectionExpansionTracker = new ExpansionTracker(\n    true,\n    CONSTANTS.LOCATION_SECTION\n  );\n\n  /**\n   * The cached concentration information for the character.\n   * @type {{items: Set<Item5e>, effects: Set<ActiveEffect5e>}}\n   * @internal\n   */\n  _concentration: { items: Set<Item5e>; effects: Set<ActiveEffect5e> } = {\n    items: new Set(),\n    effects: new Set(),\n  };\n\n  constructor(...args: any[]) {\n    super(...args);\n\n    this.itemTableTogglesCache = new ItemTableToggleCacheService({\n      userId: game.user.id,\n      documentId: this.actor.id,\n    });\n\n    this.itemFilterService = new ItemFilterService({}, this.actor);\n\n    this.currentTabId = settings.value.initialCharacterSheetTab;\n  }\n\n  get template() {\n    return FoundryAdapter.getTemplate('empty-form-template.hbs');\n  }\n\n  static get defaultOptions() {\n    return FoundryAdapter.mergeObject(super.defaultOptions, {\n      classes: [\n        CONSTANTS.MODULE_ID,\n        'sheet',\n        'actor',\n        CONSTANTS.SHEET_TYPE_CHARACTER,\n        CONSTANTS.SHEET_LAYOUT_CLASSIC,\n        'app-v1',\n      ],\n      width: 740,\n      height: 810,\n      scrollY: ['[data-tidy-track-scroll-y]', '.scroll-container'],\n    });\n  }\n\n  component: Record<string, any> | undefined;\n  additionalComponents: Record<string, any>[] = [];\n  _effectCleanup?: () => void;\n  activateListeners(html: { get: (index: 0) => HTMLElement }) {\n    // Document Apps Reactivity\n    game.user.apps[this.id] = this;\n\n    let first = true;\n\n    this._effectCleanup = $effect.root(() => {\n      $effect(() => {\n        if (first) return;\n        applyMutableSettingAttributesToWindow(\n          settings.value,\n          this.element.get(0)\n        );\n        this.render();\n      });\n\n      $effect(() => {\n        debug('Message bus message received', {\n          app: this,\n          actor: this.actor,\n          message: this.messageBus,\n        });\n      });\n    });\n\n    first = false;\n\n    const node = html.get(0);\n\n    this.component = mount(CharacterSheet, {\n      target: node,\n      context: new Map<any, any>([\n        [CONSTANTS.SVELTE_CONTEXT.APP_ID, this.appId],\n        [CONSTANTS.SVELTE_CONTEXT.CONTEXT, this.context],\n        [CONSTANTS.SVELTE_CONTEXT.MESSAGE_BUS, this.messageBus],\n        [CONSTANTS.SVELTE_CONTEXT.STATS, this.stats],\n        [CONSTANTS.SVELTE_CONTEXT.CURRENT_TAB_ID, this.currentTabId],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_TAB_SELECTED,\n          this.onTabSelected.bind(this),\n        ],\n        [CONSTANTS.SVELTE_CONTEXT.SEARCH_FILTERS, new Map(this.searchFilters)],\n        [\n          CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n          this.inlineToggleService,\n        ],\n        [CONSTANTS.SVELTE_CONTEXT.ITEM_FILTER_SERVICE, this.itemFilterService],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_FILTER,\n          this.itemFilterService.onFilter.bind(this.itemFilterService),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_FILTER_CLEAR_ALL,\n          this.itemFilterService.onFilterClearAll.bind(this.itemFilterService),\n        ],\n        [CONSTANTS.SVELTE_CONTEXT.ON_SEARCH, this.onSearch.bind(this)],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_ITEM_TOGGLED,\n          this.onItemToggled.bind(this),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ITEM_TABLE_TOGGLES,\n          new Map(this.itemTableTogglesCache.itemTableToggles),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_ITEM_TABLE_TOGGLE,\n          this.itemTableTogglesCache.onItemTableToggle.bind(\n            this.itemTableTogglesCache\n          ),\n        ],\n        [CONSTANTS.SVELTE_CONTEXT.LOCATION, ''],\n        [CONSTANTS.SVELTE_CONTEXT.EXPANDED_ITEMS, new Map(this.expandedItems)],\n        [\n          CONSTANTS.SVELTE_CONTEXT.EXPANDED_ITEM_DATA,\n          new Map(this.expandedItemData),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.SECTION_EXPANSION_TRACKER,\n          this.sectionExpansionTracker,\n        ],\n      ]),\n    });\n\n    const infoCard = mount(AttachedInfoCard, {\n      target: node,\n      props: {\n        sheet: this,\n      },\n    });\n\n    this.additionalComponents.push(infoCard);\n\n    initTidy5eContextMenu(this, html);\n  }\n\n  async getData(options = {}) {\n    this._concentration = this.actor.concentration;\n\n    const defaultDocumentContext = await super.getData(this.options);\n\n    Tidy5eBaseActorSheet.applyCommonContext(defaultDocumentContext);\n\n    const characterPreferences = SheetPreferencesService.getByType(\n      this.actor.type\n    );\n\n    const attributesSortMode =\n      characterPreferences.tabs?.[CONSTANTS.TAB_CHARACTER_ATTRIBUTES]?.sort ??\n      'm';\n    const inventorySortMode =\n      characterPreferences.tabs?.[CONSTANTS.TAB_ACTOR_INVENTORY]?.sort ?? 'm';\n    const spellbookSortMode =\n      characterPreferences.tabs?.[CONSTANTS.TAB_ACTOR_SPELLBOOK]?.sort ?? 'm';\n    const featureSortMode =\n      characterPreferences.tabs?.[CONSTANTS.TAB_CHARACTER_FEATURES]?.sort ??\n      'm';\n    const actionListSortMode =\n      characterPreferences.tabs?.[CONSTANTS.TAB_ACTOR_ACTIONS]?.sort ?? 'm';\n\n    const unlocked =\n      FoundryAdapter.isSheetUnlocked(this.actor) &&\n      defaultDocumentContext.editable;\n\n    // TODO: Make a builder for this\n    // TODO: Extract to runtime?\n    let utilities: Utilities<CharacterSheetContext> = {\n      [CONSTANTS.TAB_CHARACTER_ATTRIBUTES]: {\n        utilityToolbarCommands: [\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeAlpha'),\n            iconClass: 'fa-solid fa-arrow-down-a-z fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_CHARACTER_ATTRIBUTES,\n                'sort',\n                'm'\n              );\n            },\n            visible: attributesSortMode === 'a',\n          },\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeManual'),\n            iconClass: 'fa-solid fa-arrow-down-short-wide fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_CHARACTER_ATTRIBUTES,\n                'sort',\n                'a'\n              );\n            },\n            visible: attributesSortMode === 'm',\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.ExpandAll'),\n            iconClass: 'fas fa-angles-down',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_CHARACTER_ATTRIBUTES,\n                true\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.CollapseAll'),\n            iconClass: 'fas fa-angles-up',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_CHARACTER_ATTRIBUTES,\n                false\n              ),\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Utilities.ConfigureSections'\n            ),\n            iconClass: 'fas fa-cog',\n            execute: ({ context, sections }) => {\n              new DocumentTabSectionConfigApplication({\n                document: context.actor,\n                // Provide a way to build the necessary config, perhaps within the application constructor. We've got all the info we need in order to perform the operation.\n                sections: sections,\n                tabId: CONSTANTS.TAB_CHARACTER_ATTRIBUTES,\n                tabTitle: CharacterSheetRuntime.getTabTitle(\n                  CONSTANTS.TAB_CHARACTER_ATTRIBUTES\n                ),\n              }).render(true);\n            },\n          },\n        ],\n      },\n      [CONSTANTS.TAB_ACTOR_INVENTORY]: {\n        utilityToolbarCommands: [\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeAlpha'),\n            iconClass: 'fa-solid fa-arrow-down-a-z fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_INVENTORY,\n                'sort',\n                'm'\n              );\n            },\n            visible: inventorySortMode === 'a',\n          },\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeManual'),\n            iconClass: 'fa-solid fa-arrow-down-short-wide fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_INVENTORY,\n                'sort',\n                'a'\n              );\n            },\n            visible: inventorySortMode === 'm',\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Commands.HideContainerPanel'\n            ),\n            iconClass: `fas fa-boxes-stacked fa-fw`,\n            execute: () => {\n              TidyFlags.showContainerPanel.unset(this.actor);\n            },\n            visible: !!TidyFlags.showContainerPanel.get(this.actor),\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Commands.ShowContainerPanel'\n            ),\n            iconClass: `fas fa-box fa-fw`,\n            execute: () => {\n              TidyFlags.showContainerPanel.set(this.actor, true);\n            },\n            visible: !TidyFlags.showContainerPanel.get(this.actor),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.ExpandAll'),\n            iconClass: 'fas fa-angles-down',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_INVENTORY,\n                true\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.CollapseAll'),\n            iconClass: 'fas fa-angles-up',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_INVENTORY,\n                false\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.ListLayout'),\n            iconClass: 'fas fa-th-list fa-fw toggle-list',\n            visible: !TidyFlags.inventoryGrid.get(this.actor),\n            execute: () => {\n              TidyFlags.inventoryGrid.set(this.actor);\n            },\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.GridLayout'),\n            iconClass: 'fas fa-th-large fa-fw toggle-grid',\n            visible: !!TidyFlags.inventoryGrid.get(this.actor),\n            execute: () => {\n              TidyFlags.inventoryGrid.unset(this.actor);\n            },\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Utilities.ConfigureSections'\n            ),\n            iconClass: 'fas fa-cog',\n            execute: ({ context, sections }) => {\n              new DocumentTabSectionConfigApplication({\n                document: context.actor,\n                sections: sections,\n                tabId: CONSTANTS.TAB_ACTOR_INVENTORY,\n                tabTitle: CharacterSheetRuntime.getTabTitle(\n                  CONSTANTS.TAB_ACTOR_INVENTORY\n                ),\n              }).render(true);\n            },\n          },\n        ],\n      },\n      [CONSTANTS.TAB_ACTOR_SPELLBOOK]: {\n        utilityToolbarCommands: [\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeAlpha'),\n            iconClass: 'fa-solid fa-arrow-down-a-z fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_SPELLBOOK,\n                'sort',\n                'm'\n              );\n            },\n            visible: spellbookSortMode === 'a',\n          },\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeManual'),\n            iconClass: 'fa-solid fa-arrow-down-short-wide fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_SPELLBOOK,\n                'sort',\n                'a'\n              );\n            },\n            visible: spellbookSortMode === 'm',\n          },\n          {\n            title: 'Spell Pips',\n            iconClass: 'fa-regular fa-circle-dot fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypePreference(\n                this.actor.type,\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_PREFERENCE,\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_VALUE_MAX\n              );\n            },\n            visible:\n              (characterPreferences?.spellSlotTrackerMode ??\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_PIPS) ===\n              CONSTANTS.SPELL_SLOT_TRACKER_MODE_PIPS,\n          },\n          {\n            title: 'Spell Value/Max',\n            iconClass: 'fa-regular fa-square fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypePreference(\n                this.actor.type,\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_PREFERENCE,\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_PIPS\n              );\n            },\n            visible:\n              characterPreferences?.spellSlotTrackerMode ===\n              CONSTANTS.SPELL_SLOT_TRACKER_MODE_VALUE_MAX,\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.ExpandAll'),\n            iconClass: 'fas fa-angles-down',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_SPELLBOOK,\n                true\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.CollapseAll'),\n            iconClass: 'fas fa-angles-up',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_SPELLBOOK,\n                false\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.ListLayout'),\n            iconClass: 'fas fa-th-list fa-fw toggle-list',\n            visible: !TidyFlags.spellbookGrid.get(this.actor),\n            execute: () => {\n              TidyFlags.spellbookGrid.set(this.actor);\n            },\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.GridLayout'),\n            iconClass: 'fas fa-th-large fa-fw toggle-grid',\n            visible: !!TidyFlags.spellbookGrid.get(this.actor),\n            execute: () => {\n              TidyFlags.spellbookGrid.unset(this.actor);\n            },\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Utilities.ConfigureSections'\n            ),\n            iconClass: 'fas fa-cog',\n            execute: ({ context, sections }) => {\n              new DocumentTabSectionConfigApplication({\n                document: context.actor,\n                sections: sections,\n                tabId: CONSTANTS.TAB_ACTOR_SPELLBOOK,\n                tabTitle: CharacterSheetRuntime.getTabTitle(\n                  CONSTANTS.TAB_ACTOR_SPELLBOOK\n                ),\n              }).render(true);\n            },\n          },\n        ],\n      },\n      [CONSTANTS.TAB_CHARACTER_FEATURES]: {\n        utilityToolbarCommands: [\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeAlpha'),\n            iconClass: 'fa-solid fa-arrow-down-a-z fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_CHARACTER_FEATURES,\n                'sort',\n                'm'\n              );\n            },\n            visible: featureSortMode === 'a',\n          },\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeManual'),\n            iconClass: 'fa-solid fa-arrow-down-short-wide fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_CHARACTER_FEATURES,\n                'sort',\n                'a'\n              );\n            },\n            visible: featureSortMode === 'm',\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.ExpandAll'),\n            iconClass: 'fas fa-angles-down',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_CHARACTER_FEATURES,\n                true\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.CollapseAll'),\n            iconClass: 'fas fa-angles-up',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_CHARACTER_FEATURES,\n                false\n              ),\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Utilities.ConfigureSections'\n            ),\n            iconClass: 'fas fa-cog',\n            execute: ({ context, sections }) => {\n              new DocumentTabSectionConfigApplication({\n                document: context.actor,\n                sections: sections,\n                tabId: CONSTANTS.TAB_CHARACTER_FEATURES,\n                tabTitle: CharacterSheetRuntime.getTabTitle(\n                  CONSTANTS.TAB_CHARACTER_FEATURES\n                ),\n              }).render(true);\n            },\n          },\n        ],\n      },\n      [CONSTANTS.TAB_ACTOR_ACTIONS]: {\n        utilityToolbarCommands: [\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeAlpha'),\n            iconClass: 'fa-solid fa-arrow-down-a-z fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_ACTIONS,\n                'sort',\n                'm'\n              );\n            },\n            visible: actionListSortMode === 'a',\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.SortMode.ActionListDefault'),\n            iconClass: 'fa-solid fa-arrow-down-short-wide fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_ACTIONS,\n                'sort',\n                'a'\n              );\n            },\n            visible: actionListSortMode === 'm',\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.ExpandAll'),\n            iconClass: 'fas fa-angles-down',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_ACTIONS,\n                true\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.CollapseAll'),\n            iconClass: 'fas fa-angles-up',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_ACTIONS,\n                false\n              ),\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Utilities.ConfigureSections'\n            ),\n            iconClass: 'fas fa-cog',\n            execute: ({ context, sections }) => {\n              new DocumentTabSectionConfigApplication({\n                document: context.actor,\n                sections: sections,\n                tabId: CONSTANTS.TAB_ACTOR_ACTIONS,\n                tabTitle: CharacterSheetRuntime.getTabTitle(\n                  CONSTANTS.TAB_ACTOR_ACTIONS\n                ),\n              }).render(true);\n            },\n          },\n        ],\n      },\n    };\n\n    // Effects & Conditions\n    let { conditions, effects: enhancedEffectSections } =\n      await ConditionsAndEffects.getConditionsAndEffects(\n        this.actor,\n        this.object,\n        defaultDocumentContext.effects\n      );\n\n    const context: CharacterSheetContext = {\n      ...defaultDocumentContext,\n      activateEditors: (node, options) =>\n        FoundryAdapter.activateEditors(node, this, options?.bindSecrets),\n      actions: await getActorActionSections(this.actor),\n      actorClassesToImages: getActorClassesToImages(this.actor),\n      actorPortraitCommands:\n        ActorPortraitRuntime.getEnabledPortraitMenuCommands(this.actor),\n      allowEffectsManagement: FoundryAdapter.allowCharacterEffectsManagement(\n        this.actor\n      ),\n      allowMaxHpOverride:\n        settings.value.allowHpMaxOverride &&\n        (!settings.value.lockHpMaxChanges || FoundryAdapter.userIsGm()),\n      appearanceEnrichedHtml: await FoundryAdapter.enrichHtml(\n        this.actor.system.details.appearance,\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      appId: this.appId,\n      biographyEnrichedHtml: await FoundryAdapter.enrichHtml(\n        this.actor.system.details.biography.value,\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      bondEnrichedHtml: await FoundryAdapter.enrichHtml(\n        this.actor.system.details.bond,\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      conditions: conditions,\n      containerPanelItems: await Inventory.getContainerPanelItems(\n        defaultDocumentContext.items\n      ),\n      customActorTraits: CustomActorTraitsRuntime.getEnabledTraits(\n        defaultDocumentContext\n      ),\n      customContent: await CharacterSheetRuntime.getContent(\n        defaultDocumentContext\n      ),\n      document: this.document,\n      editable: defaultDocumentContext.editable,\n      effects: enhancedEffectSections,\n      filterData: this.itemFilterService.getDocumentItemFilterData(),\n      filterPins: ItemFilterRuntime.defaultFilterPins[this.actor.type],\n      flawEnrichedHtml: await FoundryAdapter.enrichHtml(\n        this.actor.system.details.flaw,\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      healthPercentage: this.actor.system.attributes.hp.pct.toNearest(0.1),\n      idealEnrichedHtml: await FoundryAdapter.enrichHtml(\n        this.actor.system.details.ideal,\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      lockExpChanges: FoundryAdapter.shouldLockExpChanges(),\n      lockHpMaxChanges: FoundryAdapter.shouldLockHpMaxChanges(),\n      lockItemQuantity: FoundryAdapter.shouldLockItemQuantity(),\n      lockLevelSelector: FoundryAdapter.shouldLockLevelSelector(),\n      lockMoneyChanges: FoundryAdapter.shouldLockMoneyChanges(),\n      lockSensitiveFields:\n        (!unlocked && settings.value.useTotalSheetLock) ||\n        !defaultDocumentContext.editable,\n      modernRules: FoundryAdapter.checkIfModernRules(this.actor),\n      notes1EnrichedHtml: await FoundryAdapter.enrichHtml(\n        TidyFlags.notes1.members.value.get(this.actor) ?? '',\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      notes2EnrichedHtml: await FoundryAdapter.enrichHtml(\n        TidyFlags.notes2.members.value.get(this.actor) ?? '',\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      notes3EnrichedHtml: await FoundryAdapter.enrichHtml(\n        TidyFlags.notes3.members.value.get(this.actor) ?? '',\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      notes4EnrichedHtml: await FoundryAdapter.enrichHtml(\n        TidyFlags.notes4.members.value.get(this.actor) ?? '',\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      notesEnrichedHtml: await FoundryAdapter.enrichHtml(\n        TidyFlags.notes.members.value.get(this.actor) ?? '',\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      originalContext: defaultDocumentContext,\n      owner: this.actor.isOwner,\n      showContainerPanel:\n        TidyFlags.showContainerPanel.get(this.actor) === true &&\n        Array.from(defaultDocumentContext.items).some(\n          (i: Item5e) => i.type === CONSTANTS.ITEM_TYPE_CONTAINER\n        ),\n      showLimitedSheet: FoundryAdapter.showLimitedSheet(this.actor),\n      spellComponentLabels: FoundryAdapter.getSpellComponentLabels(),\n      spellSlotTrackerMode:\n        characterPreferences.spellSlotTrackerMode ??\n        CONSTANTS.SPELL_SLOT_TRACKER_MODE_PIPS,\n      tabs: [],\n      traitEnrichedHtml: await FoundryAdapter.enrichHtml(\n        this.actor.system.details.trait,\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      unlocked: unlocked,\n      useActionsFeature: actorUsesActionFeature(this.actor),\n      useClassicControls: settings.value.useClassicControlsForCharacter,\n      useRoundedPortraitStyle: [\n        CONSTANTS.CIRCULAR_PORTRAIT_OPTION_ALL as string,\n        CONSTANTS.CIRCULAR_PORTRAIT_OPTION_CHARACTER as string,\n      ].includes(settings.value.useCircularPortraitStyle),\n      utilities: utilities,\n      viewableWarnings:\n        defaultDocumentContext.warnings?.filter(\n          (w: any) => !isNil(w.message?.trim(), '')\n        ) ?? [],\n    };\n\n    if (context.system.details.xp.boonsEarned !== undefined) {\n      const pluralRules = new Intl.PluralRules(game.i18n.lang);\n\n      context.epicBoonsEarned = FoundryAdapter.localize(\n        `DND5E.ExperiencePoints.Boons.${pluralRules.select(\n          this.actor.system.details.xp.boonsEarned ?? 0\n        )}`,\n        {\n          number: dnd5e.utils.formatNumber(\n            this.actor.system.details.xp.boonsEarned ?? 0,\n            { signDisplay: 'always' }\n          ),\n        }\n      );\n    }\n\n    for (const panelItem of context.containerPanelItems) {\n      const ctx = context.itemContext[panelItem.container.id];\n      ctx.containerContents = await Container.getContainerContents(\n        panelItem.container\n      );\n    }\n\n    context.bastion = {\n      description: await TextEditor.enrichHTML(\n        this.actor.system.bastion.description,\n        {\n          secrets: this.actor.isOwner,\n          rollData: context.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n    };\n\n    await this._prepareFacilities(context);\n\n    this._prepareAttributePins(context);\n\n    let tabs = await CharacterSheetRuntime.getTabs(context);\n\n    const selectedTabs = TidyFlags.selectedTabs.get(context.actor);\n\n    if (selectedTabs?.length) {\n      tabs = tabs\n        .filter((t) => selectedTabs?.includes(t.id))\n        .sort(\n          (a, b) => selectedTabs.indexOf(a.id) - selectedTabs.indexOf(b.id)\n        );\n    } else {\n      const defaultTabs = settings.value.defaultCharacterSheetTabs;\n      tabs = tabs\n        .filter((t) => defaultTabs?.includes(t.id))\n        .sort((a, b) => defaultTabs.indexOf(a.id) - defaultTabs.indexOf(b.id));\n    }\n\n    context.tabs = tabs;\n\n    TidyHooks.tidy5eSheetsPreConfigureSections(\n      this,\n      this.element.get(0),\n      context\n    );\n\n    // Apply Section Configs\n    // ------------------------------------------------------------\n\n    let effectsSection: EffectFavoriteSection = {\n      canCreate: false,\n      dataset: {},\n      effects: [],\n      key: 'tidy-favorite-effects',\n      label: 'DND5E.Effects',\n      show: true,\n    };\n    const favoriteEffects = (\n      this.actor.system.favorites as CharacterFavorite[]\n    ).filter((f) => f.type === 'effect');\n\n    // TODO: Do I need to remove active effects from favorites when they are no longer available on the sheet?\n    // Or does the system do this?\n    for (const favoriteEffect of favoriteEffects) {\n      const effect = fromUuidSync(favoriteEffect.id, { relative: this.actor });\n\n      if (!effect) {\n        continue;\n      }\n\n      const data = await effect.getFavoriteData();\n\n      if (data.suppressed) {\n        data.subtitle = game.i18n.localize('DND5E.Suppressed');\n      }\n\n      effectsSection.effects.push({\n        effectId: effect.id,\n        effect: effect,\n        id: favoriteEffect.id,\n        img: data.img,\n        sort: favoriteEffect.sort,\n        subtitle: data.subtitle,\n        suppressed: data.suppressed,\n        title: data.title,\n        toggle: { applicable: true, value: data.toggle },\n      });\n    }\n\n    const activitiesSection: TypedActivityFavoriteSection = {\n      activities: [],\n      dataset: {},\n      key: 'tidy-favorite-activities',\n      label: 'DND5E.ACTIVITY.Title.other',\n      show: true,\n      type: CONSTANTS.FAVORITES_SECTION_TYPE_ACTIVITY,\n    };\n\n    const favoriteActivities = (\n      this.actor.system.favorites as CharacterFavorite[]\n    ).filter((f) => f.type === 'activity');\n\n    for (const favoriteActivity of favoriteActivities) {\n      const activity = fromUuidSync(favoriteActivity.id, {\n        relative: this.actor,\n      });\n\n      if (!activity) {\n        continue;\n      }\n\n      activitiesSection.activities.push(activity);\n    }\n\n    // Favorites\n    context.favorites = CharacterSheetSections.mergeDuplicateFavoriteSections(\n      context.favorites\n    );\n\n    if (effectsSection.effects.length) {\n      context.favorites.push({\n        ...effectsSection,\n        type: CONSTANTS.FAVORITES_SECTION_TYPE_EFFECT,\n      });\n    }\n\n    if (activitiesSection.activities.length) {\n      context.favorites.push(activitiesSection);\n    }\n\n    debug('Character Sheet context data', context);\n\n    return context;\n  }\n\n  protected _prepareItems(context: CharacterSheetContext) {\n    // Categorize items as inventory, spellbook, features, and classes\n    const inventory: ActorInventoryTypes =\n      Inventory.getDefaultInventorySections();\n    const favoriteInventory: ActorInventoryTypes =\n      Inventory.getDefaultInventorySections({\n        canCreate: false,\n      });\n\n    const favoritesIdMap: Map<string, CharacterFavorite> =\n      this._getFavoritesIdMap();\n\n    // Partition items by category\n    let {\n      backgrounds,\n      classes,\n      favorites,\n      feats,\n      items,\n      species,\n      spells,\n      subclasses,\n    } = Array.from(this.actor.items).reduce(\n      (\n        obj: CharacterItemPartitions & { favorites: CharacterItemPartitions },\n        item: Item5e\n      ) => {\n        const { quantity } = item.system;\n\n        // Item details\n        const ctx = (context.itemContext[item.id] ??= {});\n        ctx.isStack = Number.isNumeric(quantity) && quantity !== 1;\n        ctx.attunement = FoundryAdapter.getAttunementContext(item);\n\n        // Item usage\n        ctx.hasUses = item.hasLimitedUses;\n        ctx.hasRecharge = item.hasRecharge;\n\n        // Unidentified items\n        ctx.concealDetails =\n          !game.user.isGM && item.system.identified === false;\n\n        // Item grouping\n        const [originId] =\n          item.getFlag('dnd5e', 'advancementOrigin')?.split('.') ?? [];\n        const group = this.actor.items.get(originId);\n        switch (group?.type) {\n          case 'race':\n            ctx.group = 'species';\n            break;\n          case 'background':\n            ctx.group = 'background';\n            break;\n          case 'class':\n            ctx.group = group.identifier;\n            break;\n          case 'subclass':\n            ctx.group = group.class?.identifier ?? 'other';\n            break;\n          default:\n            ctx.group = 'other';\n        }\n\n        // Individual item preparation\n        this._prepareItem(item, ctx);\n\n        const isWithinContainer = this.actor.items.has(item.system.container);\n\n        // Classify items into types\n        if (!isWithinContainer) {\n          CharacterSheetSections.partitionItem(item, obj, inventory);\n        }\n\n        const favoritedItem = favoritesIdMap.get(\n          item.getRelativeUUID(this.actor)\n        );\n        if (favoritedItem?.type === 'item') {\n          ctx.favoriteId = favoritedItem.id;\n          CharacterSheetSections.partitionItem(\n            item,\n            obj.favorites,\n            favoriteInventory\n          );\n        }\n\n        return obj;\n      },\n      {\n        items: [] as Item5e[],\n        spells: [] as Item5e[],\n        facilities: [] as Item5e[],\n        feats: [] as Item5e[],\n        species: [] as Item5e[],\n        backgrounds: [] as Item5e[],\n        classes: [] as Item5e[],\n        subclasses: [] as Item5e[],\n        favorites: {\n          items: [] as Item5e[],\n          spells: [] as Item5e[],\n          facilities: [] as Item5e[],\n          feats: [] as Item5e[],\n          species: [] as Item5e[],\n          backgrounds: [] as Item5e[],\n          classes: [] as Item5e[],\n          subclasses: [] as Item5e[],\n        },\n      }\n    );\n\n    const inventoryTypes = Inventory.getDefaultInventoryTypes();\n    // Organize items\n    // Section the items by type\n    for (let item of items) {\n      const ctx = (context.itemContext[item.id] ??= {});\n      ctx.totalWeight = item.system.totalWeight?.toNearest(0.1);\n      Inventory.applyInventoryItemToSection(inventory, item, inventoryTypes, {\n        canCreate: true,\n      });\n    }\n\n    SheetSections.getFilteredGlobalSectionsToShowWhenEmpty(\n      context.actor,\n      CONSTANTS.TAB_ACTOR_INVENTORY\n    ).forEach((s) => {\n      inventory[s] ??= Inventory.createInventorySection(s, inventoryTypes, {\n        canCreate: true,\n      });\n    });\n\n    // Section favorite items by type\n    for (let item of favorites.items) {\n      const ctx = (context.itemContext[item.id] ??= {});\n      ctx.totalWeight = item.system.totalWeight?.toNearest(0.1);\n      Inventory.applyInventoryItemToSection(\n        favoriteInventory,\n        item,\n        inventoryTypes,\n        {\n          canCreate: false,\n        }\n      );\n    }\n\n    context.spellcastingInfo = FoundryAdapter.getSpellcastingInfo(\n      this.actor,\n      spells\n    );\n\n    // Section spells\n    // TODO: Take over `_prepareSpellbook` and\n    // - have custom sectioning built right into the process\n    // - set up `key` in the spellbook prep code, just like `prop`\n    const spellbook = SheetSections.prepareTidySpellbook(\n      context,\n      CONSTANTS.TAB_ACTOR_SPELLBOOK,\n      spells,\n      {\n        canCreate: true,\n      },\n      this\n    );\n\n    // Section Favorite Spells\n    const favoriteSpellbook = SheetSections.prepareTidySpellbook(\n      context,\n      CONSTANTS.TAB_CHARACTER_ATTRIBUTES,\n      favorites.spells,\n      {\n        canCreate: false,\n      },\n      this\n    );\n\n    // Process Special Feature Item Context\n    classes = SheetSections.prepareClassItems(\n      context,\n      classes,\n      subclasses,\n      this.actor\n    );\n\n    // Put unmatched subclasses into features so they don't disappear\n    for (const subclass of subclasses) {\n      feats.push(subclass);\n      const message = game.i18n.format('DND5E.SubclassMismatchWarn', {\n        name: subclass.name,\n        class: subclass.system.classIdentifier,\n      });\n      context.warnings.push({ message, type: 'warning' });\n    }\n\n    // Process Special Favorite Feature Item Context\n    favorites.classes = SheetSections.prepareClassItems(\n      context,\n      favorites.classes,\n      favorites.subclasses,\n      this.actor\n    );\n\n    for (const subclass of favorites.subclasses) {\n      favorites.feats.push(subclass);\n    }\n\n    // Section Features\n    const features: Record<string, CharacterFeatureSection> =\n      CharacterSheetSections.buildFeaturesSections(\n        this.actor,\n        CONSTANTS.TAB_CHARACTER_FEATURES,\n        species,\n        backgrounds,\n        classes,\n        feats,\n        {\n          canCreate: true,\n        }\n      );\n\n    // Section favorite features\n    const favoriteFeatures: Record<string, CharacterFeatureSection> =\n      CharacterSheetSections.buildFeaturesSections(\n        this.actor,\n        CONSTANTS.TAB_CHARACTER_ATTRIBUTES,\n        favorites.species,\n        favorites.backgrounds,\n        favorites.classes,\n        favorites.feats,\n        { canCreate: false }\n      );\n\n    // Facility Favorites\n    let bastionFacilitiesLabel = !isNil(context.system.bastion.name, '')\n      ? context.system.bastion.name\n      : 'TYPES.Item.facilityPl';\n\n    let favoriteFacilities: FacilitySection[] = [\n      {\n        dataset: {},\n        items: favorites.facilities,\n        key: 'tidy-favorite-bastion-facilities',\n        label: bastionFacilitiesLabel,\n        show: true,\n      },\n    ];\n\n    // Apply sections to their section lists\n\n    context.inventory = Object.values(inventory);\n\n    context.spellbook = spellbook;\n\n    context.features = Object.values(features);\n\n    context.favorites = [\n      ...Object.values(favoriteInventory)\n        .filter((i) => i.items.length)\n        .map((i) => ({\n          ...i,\n          type: CONSTANTS.FAVORITES_SECTION_TYPE_INVENTORY,\n        })),\n      ...Object.values(favoriteFeatures)\n        .filter((i) => i.items.length)\n        .map((i) => ({\n          ...i,\n          type: CONSTANTS.FAVORITES_SECTION_TYPE_FEATURE,\n        })),\n      ...favoriteSpellbook\n        .filter((s: SpellbookSection) => s.spells.length)\n        .map((s: SpellbookSection) => ({\n          ...s,\n          type: CONSTANTS.FAVORITES_SECTION_TYPE_SPELLBOOK,\n        })),\n      ...favoriteFacilities\n        .filter((i) => i.items.length)\n        .map((i) => ({\n          ...i,\n          type: CONSTANTS.FAVORITES_SECTION_TYPE_FACILITY,\n        })),\n    ];\n  }\n\n  /**\n   * Prepare bastion facility data for display.\n   */\n  async _prepareFacilities(context: CharacterSheetContext): Promise<void> {\n    const allDefenders = [];\n    const basic = [];\n    const special = [];\n\n    // TODO: Consider batching compendium lookups. Most occupants are likely to all be from the same compendium.\n    for (const facility of Object.values<any>(this.actor.itemTypes.facility)) {\n      const { id, img, labels, name, system } = facility;\n      const {\n        building,\n        craft,\n        defenders,\n        disabled,\n        free,\n        hirelings,\n        level,\n        order,\n        progress,\n        size,\n        trade,\n        type,\n      } = system;\n      const subtitle = [];\n\n      if (!isNil(order, '')) {\n        subtitle.push(CONFIG.DND5E.facilities.orders[order]?.label ?? order);\n      }\n\n      if (trade.stock.max) {\n        subtitle.push(`${trade.stock.value ?? 0} &sol; ${trade.stock.max}`);\n      }\n\n      subtitle.push(\n        building.built\n          ? CONFIG.DND5E.facilities.sizes[size].label\n          : FoundryAdapter.localize('DND5E.FACILITY.Build.Unbuilt')\n      );\n\n      if (!isNil(level)) {\n        subtitle.push(\n          FoundryAdapter.localize('DND5E.LevelNumber', { level: level })\n        );\n      }\n\n      const chosenFacilityContext: ChosenFacilityContext = {\n        building,\n        craft: craft.item ? await fromUuid(craft.item) : null,\n        creatures: await this._prepareFacilityOccupants(trade.creatures),\n        defenders: await this._prepareFacilityOccupants(defenders),\n        disabled,\n        executing: CONFIG.DND5E.facilities.orders[progress.order]?.icon,\n        facility: facility,\n        free,\n        hirelings: await this._prepareFacilityOccupants(hirelings),\n        id,\n        img: foundry.utils.getRoute(img),\n        isSpecial: type.value === CONSTANTS.FACILITY_TYPE_SPECIAL,\n        labels,\n        name,\n        progress,\n        subtitle: subtitle.join(' &bull; '),\n      };\n      allDefenders.push(\n        ...chosenFacilityContext.defenders\n          .map(({ actor }) => {\n            if (!actor) return null;\n            const { img, name, uuid } = actor;\n            return { img, name, uuid, facility: facility.id };\n          })\n          .filter((_) => _)\n      );\n\n      if (chosenFacilityContext.isSpecial) {\n        special.push(chosenFacilityContext);\n      } else {\n        basic.push(chosenFacilityContext);\n      }\n\n      const itemContext = (context.itemContext[facility.id] ??= {});\n      itemContext.chosen = chosenFacilityContext;\n    }\n\n    context.defenders = allDefenders;\n    context.facilities = {\n      basic: { chosen: basic, available: [], value: 0, max: 0 },\n      special: { chosen: special, available: [], value: 0, max: 0 },\n    };\n    [CONSTANTS.FACILITY_TYPE_BASIC, CONSTANTS.FACILITY_TYPE_SPECIAL].forEach(\n      (type) => {\n        const facilities = context.facilities[type];\n        const config = CONFIG.DND5E.facilities.advancement[type];\n        let [, available] =\n          Object.entries(config)\n            .reverse()\n            .find(([level]) => {\n              return level <= this.actor.system.details.level;\n            }) ?? [];\n        facilities.value = facilities.chosen.filter(\n          ({ free }) => type === CONSTANTS.FACILITY_TYPE_BASIC || !free\n        ).length;\n        facilities.max = available ?? 0;\n        available = (available ?? 0) - facilities.value;\n        facilities.available = Array.fromRange(Math.max(0, available)).map(\n          () => {\n            return { label: `DND5E.FACILITY.AvailableFacility.${type}.free` };\n          }\n        );\n      }\n    );\n\n    if (!context.facilities.basic.available.length) {\n      context.facilities.basic.available.push({\n        label: 'DND5E.FACILITY.AvailableFacility.basic.build',\n      });\n    }\n  }\n\n  /**\n   * Prepare facility occupants for display.\n   */\n  _prepareFacilityOccupants(\n    occupants: FacilityOccupants\n  ): Promise<FacilityOccupantContext[]> {\n    const { max, value } = occupants;\n    return Promise.all(\n      Array.fromRange(max).map(async (i) => {\n        const uuid = value[i];\n        if (uuid) {\n          const actor = await fromUuid(uuid);\n          return {\n            actor,\n            uuid,\n          }; // an actor can be removed from the system and still be associated here\n        }\n        return {\n          actor: undefined,\n          uuid: undefined,\n        };\n      })\n    );\n  }\n\n  _prepareAttributePins(context: CharacterSheetContext) {\n    let flagPins = TidyFlags.attributePins\n      .get(this.actor)\n      .toSorted((a, b) => (a.sort || 0) - (b.sort || 0));\n\n    let pins: AttributePinContext[] = [];\n\n    for (let pin of flagPins) {\n      let document = fromUuidSync(pin.id, { relative: this.actor });\n\n      if (document) {\n        if (pin.type === 'item') {\n          pins.push({\n            ...pin,\n            linkedUses: context.itemContext[document.id]?.linkedUses,\n            document,\n          });\n        } else if (pin.type === 'activity') {\n          pins.push({\n            ...pin,\n            document,\n          });\n        }\n      } else {\n        warn(`Attribute pin item with ID ${pin.id} not found.`);\n      }\n    }\n\n    context.attributePins = pins;\n  }\n\n  private _getFavoritesIdMap(): Map<string, CharacterFavorite> {\n    return this.actor.system.favorites.reduce(\n      (map: Map<string, CharacterFavorite>, f: CharacterFavorite) => {\n        map.set(f.id, f);\n        return map;\n      },\n      new Map<string, CharacterFavorite>()\n    );\n  }\n\n  /**\n   * A helper method to establish the displayed preparation state for an item.\n   * @param {Item5e} item     Item being prepared for display.\n   * @param {object} context  Context data for display.\n   * @protected\n   */\n  protected _prepareItem(item: Item5e, context: CharacterItemContext) {\n    if (item.type === CONSTANTS.ITEM_TYPE_SPELL) {\n      const prep = item.system.preparation || {};\n      const isAlways = prep.mode === 'always';\n      const isPrepared = !!prep.prepared;\n      context.toggleClass = isPrepared ? 'active' : '';\n      if (isAlways) {\n        context.toggleClass = 'fixed';\n        context.toggleTitle = CONFIG.DND5E.spellPreparationModes.always.label;\n      } else if (isPrepared) {\n        context.toggleTitle = CONFIG.DND5E.spellPreparationModes.prepared.label;\n      } else {\n        context.toggleTitle = game.i18n.localize('DND5E.SpellUnprepared');\n      }\n\n      if (this._concentration.items.has(item)) {\n        context.concentration = true;\n      }\n    } else {\n      const isActive = !!item.system.equipped;\n      context.toggleClass = isActive ? 'active' : '';\n      context.toggleTitle = game.i18n.localize(\n        isActive ? 'DND5E.Equipped' : 'DND5E.Unequipped'\n      );\n      context.canToggle = 'equipped' in item.system;\n    }\n\n    // Activities\n    context.activities = Activities.getVisibleActivities(\n      item,\n      item.system.activities\n    )?.map(Activities.getActivityItemContext);\n\n    Activities.applyLinkedUses(item, this.actor, context);\n  }\n\n  private async setExpandedItemData() {\n    this.expandedItemData.clear();\n    for (const id of this.expandedItems.keys()) {\n      const item = this.actor.items.get(id);\n      if (item) {\n        this.expandedItemData.set(\n          id,\n          await item.getChatData({ secrets: this.actor.isOwner })\n        );\n      }\n    }\n  }\n\n  onToggleAbilityProficiency(event: Event) {\n    return this._onToggleAbilityProficiency(event);\n  }\n\n  onShortRest(event: Event) {\n    return this._onShortRest(event);\n  }\n\n  onLongRest(event: Event) {\n    return this._onLongRest(event);\n  }\n\n  async _onDropSingleItem(itemData: any, event: DragEvent) {\n    // Create a Consumable spell scroll on the Inventory tab\n    if (\n      itemData.type === CONSTANTS.ITEM_TYPE_SPELL &&\n      this.currentTabId === CONSTANTS.TAB_ACTOR_INVENTORY\n    ) {\n      const options: Record<string, unknown> = {};\n\n      if (settings.value.includeFlagsInSpellScrollCreation) {\n        options.flags = itemData.flags;\n      }\n\n      const scroll = await dnd5e.documents.Item5e.createScrollFromSpell(\n        itemData,\n        options\n      );\n\n      return scroll.toObject();\n    }\n\n    return super._onDropSingleItem(itemData, event);\n  }\n\n  close(options: unknown = {}) {\n    this._effectCleanup?.();\n    this._destroySvelteComponent();\n    delete game.user.apps[this.id];\n    return super.close(options);\n  }\n\n  submit(): Promise<Tidy5eCharacterSheet> {\n    return super.submit();\n  }\n\n  async _onSubmit(...args: any[]) {\n    await super._onSubmit(...args);\n    this.stats.lastSubmissionTime = new Date();\n  }\n\n  async _renderOuter() {\n    const html = await super._renderOuter();\n    if (!game.user.isGM && this.actor.limited) return html;\n    const header = html[0].querySelector('.window-header');\n\n    // Preparation warnings.\n    const warnings = document.createElement('a');\n    warnings.classList.add('preparation-warnings');\n    warnings.dataset.tooltip = 'Warnings';\n    warnings.setAttribute('aria-label', game.i18n.localize('Warnings'));\n    warnings.innerHTML = '<i class=\"fas fa-triangle-exclamation\"></i>';\n    warnings.addEventListener('click', this._onOpenWarnings.bind(this));\n    header\n      .querySelector('.window-title')\n      .insertAdjacentElement('afterend', warnings);\n\n    return html;\n  }\n\n  /**\n   * Handle opening the warnings dialog.\n   * @param {PointerEvent} event  The triggering event.\n   * @protected\n   */\n  _onOpenWarnings(event: MouseEvent) {\n    event.stopImmediatePropagation();\n    // @ts-expect-error\n    const { top, left, height } = event.currentTarget!.getBoundingClientRect();\n    const { clientWidth } = document.documentElement;\n    const dialog = this.form.querySelector('dialog.warnings');\n    Object.assign(dialog.style, {\n      top: `${top + height}px`,\n      left: `${Math.min(left - 16, clientWidth - 300)}px`,\n    });\n    dialog.showModal();\n  }\n\n  /**\n   * A boolean which gates double-rendering and prevents a second\n   * colliding render from triggering an infamous\n   * \"One of original or other are not Objects!\" error.\n   */\n  private tidyRendering = false;\n\n  render(...args: unknown[]) {\n    debug('Sheet render begin');\n    this.tidyRendering = true;\n    super.render(...args);\n\n    const [warnings] = this.element.find(\n      '.window-header .preparation-warnings'\n    );\n    warnings?.toggleAttribute(\n      'hidden',\n      !this.actor._preparationWarnings?.length\n    );\n  }\n\n  private _renderMutex = new AsyncMutex();\n  async _render(force?: boolean, options = {}) {\n    await this._renderMutex.lock(async () => {\n      const doubleRenderDetected =\n        this.options.token && this.tidyRendering === false;\n\n      if (doubleRenderDetected) {\n        return;\n      }\n\n      await this._renderSheet(force, options);\n    });\n    this.tidyRendering = false;\n    debug('Sheet render end');\n  }\n\n  private async _renderSheet(force?: boolean, options = {}) {\n    await this.setExpandedItemData();\n    const data = await this.getData();\n    SheetSections.accountForExternalSections(\n      ['actions', 'favorites', 'inventory', 'spellbook', 'features'],\n      data\n    );\n    this.context.data = data;\n\n    if (force) {\n      const { width, height } =\n        SheetPreferencesService.getByType(this.actor.type) ?? {};\n      this.position = {\n        ...this.position,\n        width: width ?? this.position.width,\n        height: height ?? this.position.height,\n      };\n\n      this._saveScrollPositions(this.element);\n      this._destroySvelteComponent();\n      await super._render(force, options);\n      applySheetAttributesToWindow(\n        this.actor.documentName,\n        this.actor.uuid,\n        this.actor.type,\n        this.element.get(0)\n      );\n      await this.renderCustomContent({ data, isFullRender: true });\n      TidyHooks.tidy5eSheetsRenderActorSheet(\n        this,\n        this.element.get(0),\n        data,\n        true\n      );\n      CustomContentRenderer.wireCompatibilityEventListeners(\n        this.element,\n        super.activateListeners,\n        this\n      );\n      blurUntabbableButtonsOnClick(this.element.get(0));\n      return;\n    }\n\n    await maintainCustomContentInputFocus(this, async () => {\n      applyTitleToWindow(this.title, this.element.get(0));\n      await this.renderCustomContent({ data, isFullRender: false });\n      TidyHooks.tidy5eSheetsRenderActorSheet(\n        this,\n        this.element.get(0),\n        data,\n        false\n      );\n      CustomContentRenderer.wireCompatibilityEventListeners(\n        this.element,\n        super.activateListeners,\n        this\n      );\n    });\n  }\n\n  private async renderCustomContent(args: {\n    data: CharacterSheetContext;\n    isFullRender: boolean;\n  }) {\n    await CustomContentRenderer.render({\n      app: this,\n      customContent: args.data.customContent,\n      data: args.data,\n      element: this.element,\n      isFullRender: args.isFullRender,\n      superActivateListeners: super.activateListeners,\n      tabs: args.data.tabs,\n    });\n  }\n\n  deleteOccupant(facilityId: string, prop: string, index: number) {\n    const facility = this.actor.items.get(facilityId);\n\n    if (!facility || !prop || index === undefined) {\n      return;\n    }\n\n    let { value } = foundry.utils.getProperty(facility, prop);\n\n    value = value.filter((_: any, i: number) => i !== index);\n\n    return facility.update({ [`${prop}.value`]: value });\n  }\n\n  _getHeaderButtons() {\n    const buttons = super._getHeaderButtons();\n    return FoundryAdapter.removeConfigureSettingsButtonWhenLockedForNonGm(\n      buttons\n    );\n  }\n\n  _destroySvelteComponent() {\n    if (this.component) {\n      unmount(this.component);\n    }\n    this.component = undefined;\n\n    this.additionalComponents.forEach((c) => unmount(c));\n    this.additionalComponents = [];\n  }\n\n  _saveScrollPositions(html: any) {\n    if (html.length && this.component) {\n      const save = super._saveScrollPositions(html);\n      debug('Saved scroll positions', this._scrollPositions);\n      return save;\n    }\n  }\n\n  _disableFields(...args: any[]) {\n    debug('Ignoring call to disable fields. Delegating to Tidy Sheets...');\n  }\n\n  _onResize(event: any) {\n    super._onResize(event);\n    const { width, height } = this.position;\n    SheetPreferencesService.setDocumentTypePreference(\n      this.actor.type,\n      'width',\n      width\n    );\n    SheetPreferencesService.setDocumentTypePreference(\n      this.actor.type,\n      'height',\n      height\n    );\n  }\n\n  async _onDrop(event: DragEvent & { target: HTMLElement }) {\n    if (!event.target.closest('[data-tidy-favorites], [data-pin-id]')) {\n      return super._onDrop(event);\n    }\n\n    const dragData = event.dataTransfer?.getData('text/plain');\n\n    if (!dragData) {\n      return super._onDrop(event);\n    }\n\n    let data;\n    try {\n      data = JSON.parse(dragData);\n    } catch (e) {\n      console.error(e);\n      return;\n    }\n\n    const doc = await fromUuid(data.uuid);\n    let relativeUuid = AttributePins.getRelativeUUID(doc);\n\n    if (event.target.closest('[data-pin-id]')) {\n      return this._onDropPin(event, { id: relativeUuid, doc });\n    }\n\n    let type = 'item' as const;\n\n    return this._onDropFavorite(event, { type, id: relativeUuid });\n  }\n\n  _prepareTraits(systemData: any) {\n    const traits = super._prepareTraits(systemData);\n\n    const selectedWeaponProfs = traits.traits?.weaponProf?.selected;\n    for (let key of systemData.traits?.weaponProf?.mastery?.value ?? []) {\n      if (!Object.hasOwn(selectedWeaponProfs, key)) {\n        selectedWeaponProfs[key] =\n          dnd5e.documents.Trait.keyLabel(key, { trait: 'weapon' }) ?? key;\n      }\n    }\n\n    FoundryAdapter.prepareLanguageTrait(this.actor, traits);\n\n    return traits;\n  }\n\n  /** @inheritDoc */\n  async _onDropActor(event: DragEvent & { target: HTMLElement }, data: any) {\n    if (!event.target.closest('.facility-occupants') || !data.uuid) {\n      return super._onDropActor(event, data);\n    }\n\n    const facilityId =\n      event.target.closest<HTMLElement>('[data-facility-id]')?.dataset?.[\n        'facilityId'\n      ];\n\n    const facility = this.actor.items.get(facilityId);\n\n    if (!facility) {\n      return;\n    }\n\n    const propDataset =\n      event.target.closest<HTMLElement>('[data-prop]')?.dataset;\n\n    const prop = propDataset?.['prop'];\n\n    if (!prop) {\n      return;\n    }\n\n    this._onDropActorAddToFacility(facility, prop, data.uuid);\n  }\n\n  _onDropActorAddToFacility(facility: Item5e, prop: string, actorUuid: string) {\n    const { max, value } = foundry.utils.getProperty(facility, prop);\n\n    if (value.length + 1 > max) {\n      return;\n    }\n\n    return facility.update({ [`${prop}.value`]: [...value, actorUuid] });\n  }\n\n  /* -------------------------------------------- */\n  /* Pins\n  /* -------------------------------------------- */\n\n  async _onDropPin(\n    event: DragEvent & { target: HTMLElement },\n    data: { id: string; doc: any }\n  ) {\n    // If not pinned, then pin it\n    const currentPins = TidyFlags.attributePins.get(this.actor);\n\n    const pinType: AttributePinFlag['type'] | undefined =\n      data.doc.documentName === CONSTANTS.DOCUMENT_NAME_ITEM\n        ? 'item'\n        : data.doc.documentName === CONSTANTS.DOCUMENT_NAME_ACTIVITY\n        ? 'activity'\n        : undefined;\n\n    if (!pinType) {\n      return;\n    }\n\n    if (!currentPins.find((x) => x.id === data.id)) {\n      AttributePins.pin(this.actor, pinType);\n      return;\n    }\n\n    return await this._onSortPins(event, data.id);\n  }\n\n  async _onSortPins(event: DragEvent & { target: HTMLElement }, srcId: string) {\n    const targetId = event.target\n      ?.closest('[data-pin-id]')\n      ?.getAttribute('data-pin-id');\n\n    if (!targetId || srcId === targetId) {\n      return;\n    }\n\n    let source;\n    let target;\n\n    const siblings = TidyFlags.attributePins\n      .get(this.actor)\n      .filter((f: AttributePinFlag) => {\n        if (f.id === targetId) target = f;\n        else if (f.id === srcId) source = f;\n        return f.id !== srcId;\n      });\n\n    const updates = SortingHelpers.performIntegerSort(source, {\n      target,\n      siblings,\n    });\n\n    const pins = TidyFlags.attributePins\n      .get(this.actor)\n      .reduce(\n        (map: Map<string, AttributePinFlag>, f: AttributePinFlag) =>\n          map.set(f.id, { ...f }),\n        new Map<string, AttributePinFlag>()\n      );\n\n    for (const { target, update } of updates) {\n      const pin = pins.get(target.id);\n      if (pin && update) {\n        foundry.utils.mergeObject(pin, update);\n      }\n    }\n\n    return await TidyFlags.attributePins.set(\n      this.actor,\n      Array.from(pins.values())\n    );\n  }\n\n  /* -------------------------------------------- */\n  /* Favorites\n  /* -------------------------------------------- */\n\n  /**\n   * Handle an owned item or effect being dropped in the favorites area.\n   * @param {PointerEvent} event         The triggering event.\n   * @param {ActorFavorites5e} favorite  The favorite that was dropped.\n   * @returns {Promise<Actor5e>|void}\n   * @protected\n   */\n  async _onDropFavorite(\n    event: DragEvent & { target: HTMLElement },\n    favorite: UnsortedCharacterFavorite\n  ) {\n    if (this.actor.system.hasFavorite(favorite.id))\n      return await this._onSortFavorites(event, favorite.id);\n    // If we don't own the item, handle onDrop and then turn around and add it as a favorite?\n    return await this.actor.system.addFavorite(favorite);\n  }\n\n  /**\n   * Handle re-ordering the favorites list.\n   * @param {DragEvent} event  The drop event.\n   * @param {string} srcId     The identifier of the dropped favorite.\n   * @returns {Promise<Actor5e>|void}\n   * @protected\n   */\n  async _onSortFavorites(\n    event: DragEvent & { target: HTMLElement },\n    srcId: string\n  ) {\n    const targetId = event.target\n      ?.closest('[data-favorite-id]')\n      ?.getAttribute('data-favorite-id');\n    if (!targetId) return;\n    let source;\n    let target;\n    if (srcId === targetId) return;\n    const siblings = this.actor.system.favorites.filter(\n      (f: CharacterFavorite) => {\n        if (f.id === targetId) target = f;\n        else if (f.id === srcId) source = f;\n        return f.id !== srcId;\n      }\n    );\n    const updates = SortingHelpers.performIntegerSort(source, {\n      target,\n      siblings,\n    });\n    const favorites = this.actor.system.favorites.reduce(\n      (map: Map<string, CharacterFavorite>, f: CharacterFavorite) =>\n        map.set(f.id, { ...f }),\n      new Map<string, CharacterFavorite>()\n    );\n    for (const { target, update } of updates) {\n      const favorite = favorites.get(target.id);\n      foundry.utils.mergeObject(favorite, update);\n    }\n    return await this.actor.update({\n      'system.favorites': Array.from(favorites.values()),\n    });\n  }\n\n  /* -------------------------------------------- */\n  /* SheetTabCacheable\n  /* -------------------------------------------- */\n\n  onTabSelected(tabId: string) {\n    this.currentTabId = tabId;\n  }\n\n  /* -------------------------------------------- */\n  /* SheetExpandedItemsCacheable\n  /* -------------------------------------------- */\n\n  onItemToggled(itemId: string, isVisible: boolean, location: string) {\n    const locationSet =\n      this.expandedItems.get(itemId) ??\n      this.expandedItems.set(itemId, new Set<string>()).get(itemId);\n\n    if (isVisible) {\n      locationSet?.add(location);\n    } else {\n      locationSet?.delete(location);\n    }\n\n    debug('Item Toggled', {\n      expandedItems: this.expandedItems,\n    });\n  }\n\n  /* -------------------------------------------- */\n  /* SearchFilterCacheable\n  /* -------------------------------------------- */\n\n  onSearch(location: string, text: string): void {\n    debug('Searched', {\n      location,\n      text,\n    });\n    this.searchFilters.set(location, text);\n  }\n}\n\nfunction getActorClassesToImages(actor: Actor5e): Record<string, string> {\n  let actorClassesToImages: Record<string, string> = {};\n  for (let item of actor.items) {\n    if (item.type == CONSTANTS.ITEM_TYPE_CLASS) {\n      let className = item.name.toLowerCase();\n      let classImg = item.img;\n      actorClassesToImages[className] = classImg;\n    }\n  }\n  return actorClassesToImages;\n}\n","<script lang=\"ts\">\n  import HpBar from 'src/components/bar/HpBar.svelte';\n  import ResourceWithBar from 'src/components/bar/ResourceWithBar.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getNpcSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getNpcSheetContext());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"portrait-hp\" title={localize('DND5E.HitPoints')}>\n  <ResourceWithBar\n    document={context.actor}\n    value={context.system.attributes.hp.value}\n    valueField=\"system.attributes.hp.value\"\n    valueTitle={localize('DND5E.HitPointsCurrent')}\n    valueDisabled={!context.editable}\n    max={context.system.attributes.hp.max}\n    maxField=\"system.attributes.hp.max\"\n    maxTitle={localize('DND5E.HitPointsMax')}\n    maxDisabled={!context.editable ||\n      context.system.details.level ||\n      context.lockHpMaxChanges ||\n      context.lockSensitiveFields}\n    percentage={context.healthPercentage}\n    Bar={settings.value.useHpBarNpc ? HpBar : null}\n  />\n</div>\n\n<style lang=\"scss\">\n  .portrait-hp {\n    border-radius: 0.3125rem;\n    position: absolute;\n    width: 8.5rem;\n    left: 50%;\n    height: 1.25rem;\n    font-size: 1.125rem;\n    transform: translateX(-50%);\n    bottom: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-family: var(--t5e-title-font-family);\n\n    :global(.resource-value),\n    :global(.resource-max) {\n      font-weight: 700;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getNpcSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getNpcSheetContext());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div\n  class=\"rest-container\"\n  class:has-rounded-portrait={context.useRoundedPortraitStyle}\n  title={localize('TIDY5E.RestHint')}\n>\n  <div class=\"resting\">\n    <span class=\"resting-icon\">\n      <i class=\"rest-icon fas fa-bed\"></i>\n    </span>\n    <button\n      type=\"button\"\n      class=\"rest short-rest inline-icon-button\"\n      title={localize('TIDY5E.ShortRest')}\n      onclick={(ev) => context.shortRest(ev)}\n      disabled={!context.editable}\n      tabindex={!settings.value.useDefaultSheetHpTabbing &&\n      settings.value.useAccessibleKeyboardSupport\n        ? 0\n        : -1}\n    >\n      <i class=\"fas fa-hourglass-half\"></i>\n    </button>\n    <button\n      type=\"button\"\n      class=\"rest long-rest inline-icon-button\"\n      title={localize('TIDY5E.LongRest')}\n      onclick={(ev) => context.longRest(ev)}\n      disabled={!context.editable}\n      tabindex={!settings.value.useDefaultSheetHpTabbing &&\n      settings.value.useAccessibleKeyboardSupport\n        ? 0\n        : -1}\n    >\n      <i class=\"fas fa-hourglass-end\"></i>\n    </button>\n  </div>\n</div>\n\n<style lang=\"scss\">\n  .rest-container {\n    display: block;\n    position: absolute;\n    left: 0;\n    bottom: 0;\n  }\n\n  .resting {\n    width: 1.5rem;\n    height: 1.25rem;\n    border-radius: 0 0 0 0.3125rem;\n    overflow: hidden;\n    transition: width 0.3s ease;\n    background: var(--t5e-icon-background);\n    display: flex;\n    box-shadow: 0 0 0.625rem var(--t5e-icon-shadow-color) inset;\n    border: 0.0625rem solid var(--t5e-icon-outline-color);\n    color: var(--t5e-icon-font-color);\n\n    &:hover,\n    &:focus-within {\n      width: 5.875rem;\n    }\n\n    .rest {\n      flex: 0 0 1.875rem;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      width: 1.875rem;\n      height: 1.125rem;\n      border-radius: 50%;\n      cursor: pointer;\n      border: none;\n      color: var(--t5e-tertiary-color);\n      padding: 0;\n      font-size: 0.75rem;\n      line-height: 1.125rem;\n      font-family: var(--t5e-body-font-family);\n      font-weight: 700;\n      transition:\n        color 0.3s ease,\n        transform 0.3s ease;\n\n      &:hover,\n      &:focus-within {\n        color: var(--t5e-primary-font-color);\n      }\n    }\n\n    .resting-icon {\n      flex: 0 0 1.5rem;\n      display: flex;\n\n      width: 1.5rem;\n      height: 1.125rem;\n      margin-right: 0.5rem;\n      justify-content: center;\n      align-items: center;\n      border-radius: 0;\n      font-size: 0.75rem;\n      color: var(--t5e-primary-font-color);\n    }\n  }\n\n  .rest-container.has-rounded-portrait {\n    left: 0.4375rem;\n    bottom: 0;\n\n    .resting {\n      border-radius: 0.3125rem 0 0 0.3125rem;\n      transition: all 0.3s ease;\n    }\n\n    .resting:not(:is(:hover, :focus-within)) {\n      background: transparent;\n      box-shadow: none;\n      border-color: transparent;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { debug } from 'src/utils/logging';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getNpcSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getNpcSheetContext());\n\n  async function rollNpcHp(event: Event) {\n    event.preventDefault();\n\n    const formula = context.actor.system.attributes.hp.formula;\n    if (!formula) return;\n    const roll_hp = await FoundryAdapter.roll(formula, undefined);\n    const hp = roll_hp.total;\n    FoundryAdapter.playDiceSound();\n    context.actor.update({\n      'system.attributes.hp.value': hp,\n      'system.attributes.hp.max': hp,\n    });\n  }\n\n  function calcAverageHitDie(event: Event) {\n    event.preventDefault();\n\n    let formula = context.actor.system.attributes.hp.formula;\n    debug(`tidy5e-npc | activateListeners | formula: ${formula}`);\n    const average = FoundryAdapter.calculateAverageFromFormula(formula);\n\n    context.actor.update({\n      ['system.attributes.hp.value']: average,\n      ['system.attributes.hp.max']: average,\n    });\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"portrait-hp-formula health\" title={localize('DND5E.HPFormula')}>\n  <button\n    type=\"button\"\n    title=\"{localize('DND5E.HitDiceRoll')}/{localize(\n      'TIDY5E.HitDiceRollAverage',\n    )}\"\n    onclick={rollNpcHp}\n    oncontextmenu={calcAverageHitDie}\n    class=\"roll-hp-formula highlight-on-hover\"\n    tabindex={!settings.value.useDefaultSheetHpTabbing &&\n    settings.value.useAccessibleKeyboardSupport\n      ? 0\n      : -1}\n  >\n    <i class=\"fas fa-dice-six\"></i>\n  </button>\n</div>\n\n<style lang=\"scss\">\n  .health {\n    position: absolute;\n    right: 0.4375rem;\n    bottom: 0rem;\n\n    .roll-hp-formula {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      height: 1.25rem;\n      width: 1.375rem;\n      border-radius: 0 0.3125rem 0.3125rem 0;\n      border: none;\n      padding: 0;\n      background: none;\n      transition: color 0.3s ease;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getNpcSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { PortraitCharmRadiusClass } from 'src/types/types';\n\n  interface Props {\n    cssClass?: string;\n    radiusClass: PortraitCharmRadiusClass;\n    onlyShowOnHover?: boolean;\n  }\n\n  let { cssClass = '', radiusClass, onlyShowOnHover = false }: Props = $props();\n\n  let context = $derived(getNpcSheetContext());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div\n  class=\"loyalty-container {cssClass} {radiusClass}\"\n  title={localize('DND5E.Loyalty')}\n>\n  {#if context.editable}\n    <TextInput\n      document={context.actor}\n      field=\"system.attributes.loyalty.value\"\n      value={context.source.attributes.loyalty.value ?? ''}\n      class=\"uninput loyalty-input\"\n      placeholder=\"\"\n      selectOnFocus={true}\n      saveEmptyAsNull={true}\n    />\n  {:else}\n    <span class=\"loyalty-text\">\n      {context.system.attributes.loyalty.value}\n    </span>\n  {/if}\n</div>\n\n<style lang=\"scss\">\n  .loyalty-container {\n    position: absolute;\n    top: 0;\n    right: 0;\n    height: 2.125rem;\n    width: 2.125rem;\n    overflow: hidden;\n    color: var(--t5e-icon-font-color);\n    background: var(--t5e-icon-background);\n    display: flex;\n    box-shadow: 0 0 0.625rem var(--t5e-icon-shadow-color) inset;\n    border: 0.0625rem solid var(--t5e-icon-outline-color);\n\n    :global(input.uninput) {\n      height: 100%;\n      width: 100%;\n      text-align: center;\n      font-size: 1.25rem;\n      border-radius: 1.25rem;\n      color: var(--t5e-tertiary-color);\n      transition: color 0.3s ease;\n      font-family: var(--t5e-title-font-family);\n      border: 1.5px dashed var(--t5e-secondary-color);\n\n      &:focus {\n        color: var(--t5e-primary-font-color);\n      }\n\n      &:hover,\n      &:focus {\n        border: 1.5px dashed var(--t5e-primary-accent-color);\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import DeathSaves from 'src/sheets/classic/actor/DeathSaves.svelte';\n  import ExhaustionTracker from 'src/sheets/classic/actor/ExhaustionTracker.svelte';\n  import NpcHitPoints from './NpcHitPoints.svelte';\n  import TempHp from 'src/sheets/classic/actor/TempHp.svelte';\n  import NpcRest from './NpcRest.svelte';\n  import NpcHealthFormulaRoller from './NpcHealthFormulaRoller.svelte';\n  import ActorProfile from 'src/sheets/classic/actor/ActorProfile.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import ExhaustionInput from 'src/sheets/classic/actor/ExhaustionInput.svelte';\n  import { ActiveEffectsHelper } from 'src/utils/active-effect';\n  import { getNpcSheetContext } from 'src/sheets/sheet-context.svelte';\n  import NpcLoyaltyTracker from './NpcLoyaltyTracker.svelte';\n  import type { PortraitCharmRadiusClass } from 'src/types/types';\n\n  let context = $derived(getNpcSheetContext());\n\n  let incapacitated = $derived(\n    (context.actor?.system?.attributes?.hp?.value ?? 0) <= 0 &&\n      context.actor?.system?.attributes?.hp?.max !== 0,\n  );\n\n  let exhaustionRadiusClass: PortraitCharmRadiusClass = $derived(\n    context.useRoundedPortraitStyle ? 'rounded' : 'top-left',\n  );\n\n  let loyaltyRadiusClass: PortraitCharmRadiusClass = $derived(\n    context.useRoundedPortraitStyle ? 'rounded' : 'top-right',\n  );\n\n  async function onLevelSelected(level: number) {\n    await context.actor.update({\n      'system.attributes.exhaustion': level,\n    });\n  }\n</script>\n\n<ActorProfile useHpOverlay={settings.value.useHpOverlayNpc}>\n  {#if incapacitated && context.owner && context.system.traits.important}\n    <DeathSaves hasHpOverlay={settings.value.useHpOverlayNpc} />\n  {/if}\n  {#if settings.value.useExhaustion && settings.value.exhaustionConfig.type === 'specific'}\n    <ExhaustionTracker\n      level={context.system.attributes.exhaustion}\n      radiusClass={exhaustionRadiusClass}\n      {onLevelSelected}\n      exhaustionConfig={settings.value.exhaustionConfig}\n      isActiveEffectApplied={ActiveEffectsHelper.isActiveEffectAppliedToField(\n        context.actor,\n        'system.attributes.exhaustion',\n      )}\n    />\n  {:else if settings.value.useExhaustion && settings.value.exhaustionConfig.type === 'open'}\n    <ExhaustionInput\n      level={context.system.attributes.exhaustion}\n      radiusClass={exhaustionRadiusClass}\n      {onLevelSelected}\n      isActiveEffectApplied={ActiveEffectsHelper.isActiveEffectAppliedToField(\n        context.actor,\n        'system.attributes.exhaustion',\n      )}\n    />\n  {/if}\n\n  {#if context.showLoyalty}\n    <NpcLoyaltyTracker radiusClass={loyaltyRadiusClass} />\n  {/if}\n\n  <NpcHitPoints />\n  <NpcRest />\n  {#if !context.system.details.level}\n    <NpcHealthFormulaRoller />\n  {/if}\n</ActorProfile>\n<TempHp />\n","<script lang=\"ts\">\n  import type { Snippet } from 'svelte';\n\n  interface Props {\n    delimiter?: string;\n    cssClass?: string | null;\n    children?: Snippet;\n  }\n\n  let {\n    delimiter = '<span>&#8226;</span>',\n    cssClass = null,\n    children,\n  }: Props = $props();\n\n  let dynamicStyles: string = $state('');\n\n  function contentWithGridStyles(node: HTMLElement) {\n    const childrenEntries = Array.from(node.children).entries();\n\n    for (let [index, el] of childrenEntries) {\n      var div = document.createElement('div');\n      div.innerHTML = delimiter;\n\n      if (index > 0 && div.firstChild) {\n        node.insertBefore(div.firstChild, el);\n      }\n    }\n\n    const nodesLength = node.children.length;\n    if (nodesLength) {\n      let columns: string[] = [];\n      for (let i = 0; i < nodesLength; i++) {\n        const target = node.children[i];\n        const isContentNode = i % 2 === 0;\n\n        if (isContentNode) {\n          target.classList.add('truncate');\n        }\n\n        const column = isContentNode\n          ? 'minmax(auto, min-content)'\n          : 'min-content';\n        columns.push(column);\n      }\n\n      dynamicStyles = 'grid-template-columns: ' + columns.join(' ');\n    }\n  }\n</script>\n\n<div\n  class=\"delimited-truncated-content {cssClass}\"\n  use:contentWithGridStyles\n  style={dynamicStyles}\n>\n  {@render children?.()}\n</div>\n\n<style lang=\"scss\">\n  .delimited-truncated-content {\n    display: grid;\n    gap: 0.25rem;\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { isNil } from 'src/utils/data';\n\n  interface Props {\n    document: any;\n    keyPath: string;\n    editable: boolean;\n  }\n\n  let { document, keyPath, editable }: Props = $props();\n\n  let source = $derived(FoundryAdapter.getProperty<any>(document, keyPath));\n\n  let text = $derived(!isNil(source?.label, '') ? source.label : 'Source');\n  let usePlaceholder = $derived(isNil(source?.label, ''));\n</script>\n\n{#if editable}\n  <button\n    type=\"button\"\n    class=\"configure-source inline-transparent-button highlight-on-hover truncate\"\n    class:placeholder={usePlaceholder}\n    onclick={() => FoundryAdapter.renderSourceConfig(document, keyPath)}\n    tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n  >\n    {text}\n  </button>\n{:else}\n  <span\n    class=\"source-label truncate\"\n    title={text}\n    class:placeholder={usePlaceholder}>{text}</span\n  >\n{/if}\n\n<style lang=\"scss\">\n  .source-label,\n  .configure-source {\n    flex: 1;\n    line-height: inherit;\n    height: inherit;\n\n    &.placeholder:not(:hover, :focus-visible) {\n      color: var(--t5e-tertiary-color);\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getNpcSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getNpcSheetContext());\n\n  let isLinked = $derived(\n    context.actor.token?.actorLink ?? context.actor.prototypeToken.actorLink,\n  );\n\n  let showUnlinked = $derived(\n    ['unlinked', 'both'].includes(settings.value.showNpcActorLinkMarker),\n  );\n\n  let showLinked = $derived(settings.value.showNpcActorLinkMarker === 'both');\n\n  async function togglePrototypeLinkState() {\n    const isNowLinked = context.actor.prototypeToken.actorLink;\n    await context.actor.prototypeToken.update({ actorLink: !isNowLinked });\n  }\n\n  async function tryUnlink() {\n    if (context.actor.sheet.token) {\n      await context.actor.sheet.token.update({ actorLink: false });\n      const newToken = context.actor.sheet.token;\n      await context.actor.sheet.close();\n      newToken.actor.sheet.render(true);\n    } else {\n      await togglePrototypeLinkState();\n    }\n  }\n\n  async function tryLink() {\n    await togglePrototypeLinkState();\n  }\n\n  let canLink = $derived(!context.actor.token);\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n{#if showLinked && isLinked}\n  <a\n    class=\"link-state-button\"\n    onclick={() => tryUnlink()}\n    class:disabled={!context.unlocked}\n  >\n    <i class=\"link-state fas fa-link\" title={localize('TIDY5E.TokenLinked')}\n    ></i>\n  </a>\n{:else if showUnlinked && !isLinked}\n  <a\n    class=\"link-state-button\"\n    class:disabled={!context.unlocked || !canLink}\n    onclick={() => canLink && tryLink()}\n  >\n    <i class=\"link-state fas fa-unlink\" title={localize('TIDY5E.TokenUnlinked')}\n    ></i>\n  </a>\n{/if}\n\n<style lang=\"scss\">\n  .link-state-button {\n    cursor: pointer;\n\n    &.disabled {\n      cursor: unset;\n    }\n  }\n\n  .link-state {\n    padding: 0.25rem 0.1875rem 0.1875rem 0.25rem;\n    margin-top: -0.0625rem;\n    border-radius: 0.3125rem;\n  }\n\n  .link-state.fa-link {\n    background: var(--t5e-linked-light-color);\n  }\n\n  .link-state.fa-unlink {\n    background: var(--t5e-unlinked-light-color);\n  }\n</style>\n","<script lang=\"ts\">\n  import SheetEditModeToggle from 'src/sheets/classic/actor/SheetEditModeToggle.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import type { DropdownListOption } from 'src/types/types';\n  import NpcProfile from './parts/NpcProfile.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import InlineTextDropdownList from '../../../components/inputs/InlineTextDropdownList.svelte';\n  import { formatAsModifier } from 'src/utils/formatting';\n  import DelimitedTruncatedContent from 'src/components/layout/DelimitedTruncatedContent.svelte';\n  import HorizontalLineSeparator from 'src/components/layout/HorizontalLineSeparator.svelte';\n  import ActorMovement from '../actor/ActorMovement.svelte';\n  import ActorHeaderStats from '../actor/ActorHeaderStats.svelte';\n  import SheetMenu from '../actor/SheetMenu.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import ActorWarnings from '../actor/ActorWarnings.svelte';\n  import InlineSource from '../shared/InlineSource.svelte';\n  import InlineCreatureType from '../shared/InlineCreatureType.svelte';\n  import ActorOriginSummaryConfigFormApplication from 'src/applications/actor-origin-summary/ActorOriginSummaryConfigFormApplication.svelte';\n  import ActorName from '../actor/ActorName.svelte';\n  import SpecialSaves from '../actor/SpecialSaves.svelte';\n  import { isNil } from 'src/utils/data';\n  import ActorLinkIndicator from 'src/components/actor-link-indicator/ActorLinkIndicator.svelte';\n  import { getNpcSheetContext } from 'src/sheets/sheet-context.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n\n  let selectedTabId: string = $state('');\n\n  let context = $derived(getNpcSheetContext());\n\n  let sizes = $derived(\n    Object.entries(context.config.actorSizes).map(\n      ([abbreviation, size]: [string, any]) => ({\n        value: abbreviation,\n        text: size.label,\n      }),\n    ) satisfies DropdownListOption[],\n  );\n\n  let currentSize = $derived({\n    value: context.system.traits.size,\n    text: context.config.actorSizes[context.system.traits.size]?.label,\n  } satisfies DropdownListOption);\n\n  let abilities = $derived(Object.entries<any>(context.abilities));\n\n  const localize = FoundryAdapter.localize;\n\n  let formattedCr = $derived(dnd5e.utils.formatCR(context.system.details.cr));\n\n  function calculateSaveCr(crValue: string): boolean {\n    const crs: Record<string, number> = {\n      '1/8': 0.125,\n      '': 0.125,\n      '1/4': 0.25,\n      '': 0.25,\n      '1/2': 0.5,\n      '': 0.5,\n    };\n    let cr: string | number | null = crValue;\n    if (cr === '' || cr === '') cr = null;\n    else {\n      cr = crs[cr] || parseFloat(cr);\n      if (Number.isNaN(cr)) {\n        cr = null;\n      } else {\n        cr = cr < 1 ? cr : parseInt(cr.toString());\n      }\n    }\n\n    context.actor.update({ 'system.details.cr': cr });\n\n    return false;\n  }\n</script>\n\n{#if context.viewableWarnings.length}\n  <ActorWarnings warnings={context.viewableWarnings} />\n{/if}\n<header>\n  <div class=\"flex-0\">\n    <NpcProfile />\n  </div>\n  <div class=\"flex-grow-1\">\n    <div\n      class=\"actor-name-row flex-row justify-content-space-between align-items-center small-gap\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n    >\n      <ActorLinkIndicator />\n\n      <div\n        class=\"actor-name\"\n        data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n      >\n        <ActorName />\n      </div>\n      <div class=\"level-information\">\n        <div class=\"xp\">\n          <span\n            >{localize('DND5E.ExperiencePoints.Format', {\n              value: FoundryAdapter.formatNumber(\n                context.system.details.xp.value ?? 0,\n              ),\n            })}</span\n          >\n        </div>\n        <div\n          class=\"challenge-rating\"\n          aria-label={localize('DND5E.CRLabel', {\n            cr: context.system.details.cr,\n          })}\n          title={!context.unlocked ? localize('DND5E.ChallengeRating') : ''}\n        >\n          <label\n            for=\"{context.appId}-system-details-cr\"\n            class=\"challenge-rating-label\"\n          >\n            {localize('DND5E.AbbreviationCR')}\n          </label>\n          {#if context.unlocked}\n            <TextInput\n              document={context.actor}\n              value={formattedCr}\n              field=\"system.details.cr\"\n              class=\"challenge-rating-input\"\n              selectOnFocus={true}\n              title={localize('DND5E.ChallengeRating')}\n              id=\"{context.appId}-system-details-cr\"\n              onSaveChange={(ev) => calculateSaveCr(ev.currentTarget.value)}\n            />\n          {:else}\n            <span class=\"challenge-rating-label\">{formattedCr}</span>\n          {/if}\n        </div>\n        <a\n          class=\"sheet-header-button\"\n          class:disabled={!context.editable}\n          onclick={() =>\n            context.editable &&\n            new dnd5e.applications.actor.ActorSheetFlags(context.actor).render(\n              true,\n            )}\n          title={localize('DND5E.SpecialTraits')}\n        >\n          <i class=\"fa-solid fa-star fa-fw\"></i>\n        </a>\n        <SheetMenu defaultSettingsTab={CONSTANTS.TAB_USER_SETTINGS_NPCS} />\n      </div>\n    </div>\n    <HorizontalLineSeparator\n      borderColor=\"light\"\n      class=\"header-line-margin-left\"\n    />\n    <div class=\"origin-summary\">\n      <div class=\"flex-row extra-small-gap\">\n        {#if context.editable}\n          <InlineTextDropdownList\n            options={sizes}\n            selected={currentSize}\n            onOptionClicked={(option) =>\n              context.actor.update({\n                'system.traits.size': option.value,\n              })}\n            title={localize('DND5E.Size')}\n          />\n        {:else}\n          <span title={localize('DND5E.Size')}>{currentSize.text}</span>\n        {/if}\n        <span>&#8226;</span>\n        {#key context.lockSensitiveFields}\n          <DelimitedTruncatedContent cssClass=\"flex-grow-1\">\n            <span class=\"flex-row extra-small-gap align-items-center\">\n              <InlineCreatureType />\n              {#if !isNil(context.system.details.environment, '')}\n                <span\n                  class=\"environment\"\n                  title={localize('TIDY5E.EnvironmentTooltip', {\n                    environment: context.system.details.environment,\n                  })}\n                >\n                  <i class=\"fas fa-tree\"></i>\n                </span>\n              {/if}\n            </span>\n\n            <span\n              class=\"origin-summary-text\"\n              title={context.system.details.alignment}\n              >{context.system.details.alignment}</span\n            >\n\n            <InlineSource\n              document={context.actor}\n              keyPath=\"system.source\"\n              editable={context.unlocked}\n            />\n          </DelimitedTruncatedContent>\n        {/key}\n      </div>\n      <div class=\"flex-row align-items-center extra-small-gap\">\n        <b class=\"proficiency\">\n          {localize('DND5E.Proficiency')}: {formatAsModifier(\n            context.system.attributes.prof,\n          )}\n        </b>\n        {#if context.unlocked}\n          <button\n            type=\"button\"\n            class=\"origin-summary-tidy inline-icon-button\"\n            onclick={() =>\n              new ActorOriginSummaryConfigFormApplication(context.actor).render(\n                true,\n              )}\n            title={localize('TIDY5E.OriginSummaryConfig')}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n          >\n            <i class=\"fas fa-cog\"></i>\n          </button>\n        {/if}\n      </div>\n    </div>\n    <HorizontalLineSeparator\n      borderColor=\"light\"\n      class=\"header-line-margin-left\"\n    />\n    <div\n      class=\"flex-row extra-small-gap justify-content-space-between header-line-margin\"\n    >\n      <ActorMovement class=\"flex-1\" />\n      {#if context.hasSpecialSaves}\n        <SpecialSaves />\n      {/if}\n    </div>\n    <HorizontalLineSeparator\n      borderColor=\"light\"\n      class=\"header-line-margin-left\"\n    />\n    <ActorHeaderStats\n      {abilities}\n      ac={context.system.attributes.ac}\n      init={context.system.attributes.init}\n    />\n  </div>\n</header>\n<Tabs tabs={context.tabs} bind:selectedTabId sheet={context.actor.sheet}>\n  {#snippet tabEnd()}\n    {#if context.editable}\n      <SheetEditModeToggle\n        hint={settings.value.permanentlyUnlockNpcSheetForGm &&\n        FoundryAdapter.userIsGm()\n          ? localize('TIDY5E.Settings.PermanentlyUnlockNPCSheetForGM.title')\n          : null}\n      />\n    {/if}\n  {/snippet}\n</Tabs>\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n\n<style lang=\"scss\">\n  header {\n    display: flex;\n    flex-direction: row;\n    gap: 1rem;\n    justify-content: center;\n    padding: 0.625rem 1rem 1rem 1rem;\n    background: var(--t5e-header-background);\n  }\n\n  .level-information {\n    display: flex;\n    flex-direction: row;\n    gap: 0.25rem;\n    align-items: stretch;\n    font-family: var(--t5e-title-font-family);\n    font-weight: 700;\n\n    .xp {\n      font-size: 1rem;\n      margin-right: 0.25rem;\n      color: var(--t5e-secondary-color);\n      white-space: nowrap;\n      align-self: center;\n    }\n    .challenge-rating {\n      padding: 0.25rem 0.375rem;\n      border-radius: 0.1875rem;\n      background: var(--t5e-faint-color);\n      color: var(--t5e-secondary-color);\n      font-size: 1.125rem;\n      line-height: 1;\n      height: 1.5rem;\n      white-space: nowrap;\n      display: flex;\n      align-items: center;\n      gap: 0.25rem;\n\n      .challenge-rating-label {\n        padding-top: 0.0625rem;\n        line-height: 1;\n        height: 1.25rem;\n      }\n\n      :global(.challenge-rating-input) {\n        max-width: 1.5rem;\n        text-align: center;\n        line-height: 1;\n        height: 1.25rem;\n        border: none;\n        background: var(--t5e-faint-color);\n      }\n    }\n    :global(.level [contenteditable]) {\n      color: var(--t5e-secondary-color);\n    }\n  }\n\n  .origin-summary {\n    margin-left: 0.25rem;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    gap: 0.25rem;\n    line-height: 1;\n    padding: 0.1875rem 0 0.125rem 0;\n    line-height: 1rem;\n\n    &,\n    :global(button) {\n      font-size: 0.75rem;\n    }\n  }\n\n  .actor-name-row {\n    margin-bottom: 0.125rem;\n  }\n\n  .proficiency {\n    white-space: nowrap;\n  }\n</style>\n","<script lang=\"ts\">\n  import RerenderAfterFormSubmission from 'src/components/utility/RerenderAfterFormSubmission.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import SheetEditor from '../../../components/editor/SheetEditor.svelte';\n  import LimitedHeader from '../actor/LimitedHeader.svelte';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import { getNpcSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getNpcSheetContext());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"limited-npc\">\n  <LimitedHeader rounded={context.useRoundedPortraitStyle} />\n  <section class=\"tidy-sheet-body\">\n    <div class=\"note-entries\">\n      <RerenderAfterFormSubmission\n        andOnValueChange={context.system.details.biography.value}\n      >\n        <article class=\"appearance-notes\" use:context.activateEditors>\n          <div class=\"section-titles biopage\">\n            {localize('DND5E.Appearance')}\n          </div>\n          <SheetEditor\n            content={TidyFlags.appearance.get(context.actor) ?? ''}\n            target={TidyFlags.appearance.prop}\n            editable={context.editable}\n          />\n        </article>\n        <article class=\"biography-notes\" use:context.activateEditors>\n          <div class=\"section-titles\">\n            {localize('DND5E.Background')}/{localize('DND5E.Biography')}\n          </div>\n          <SheetEditor\n            content={context.biographyHTML}\n            target=\"system.details.biography.value\"\n            editable={context.editable}\n          />\n        </article>\n      </RerenderAfterFormSubmission>\n    </div>\n  </section>\n</div>\n\n<style lang=\"scss\">\n  .limited-npc {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n  }\n\n  .tidy-sheet-body {\n    flex: 1;\n    margin-right: 1rem;\n\n    .note-entries {\n      height: 100%;\n      display: flex;\n      flex-direction: row;\n      gap: 0.5rem;\n\n      > * {\n        flex: 1;\n        min-width: 0;\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import NpcSheetFull from './NpcSheetFull.svelte';\n  import NpcSheetLimited from './NpcSheetLimited.svelte';\n  import { getNpcSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getNpcSheetContext());\n</script>\n\n{#if context.showLimitedSheet}\n  <NpcSheetLimited />\n{:else}\n  <NpcSheetFull />\n{/if}\n","import { CONSTANTS } from 'src/constants';\nimport { TidyFlags } from 'src/foundry/TidyFlags';\nimport type { Item5e } from 'src/types/item.types';\nimport type { NpcAbilitySection } from 'src/types/types';\n\nexport class NpcSheetSections {\n  static get abilitiesItemTypes() {\n    return [\n      CONSTANTS.ITEM_TYPE_WEAPON,\n      CONSTANTS.ITEM_TYPE_EQUIPMENT,\n      CONSTANTS.ITEM_TYPE_TOOL,\n      CONSTANTS.ITEM_TYPE_CONTAINER,\n      CONSTANTS.ITEM_TYPE_LOOT,\n      CONSTANTS.ITEM_TYPE_FEAT,\n    ];\n  }\n\n  static applyAbilityToSection(\n    abilities: Record<string, NpcAbilitySection>,\n    feat: Item5e,\n    customSectionOptions: Partial<NpcAbilitySection>\n  ) {\n    const customSectionName = TidyFlags.section.get(feat);\n\n    if (!customSectionName) {\n      return;\n    }\n\n    const customSection: NpcAbilitySection = (abilities[customSectionName] ??=\n      NpcSheetSections.createFeatureSection(\n        customSectionName,\n        customSectionOptions\n      ));\n\n    customSection.items.push(feat);\n  }\n\n  static createFeatureSection(\n    customSectionName: string,\n    customSectionOptions: Partial<NpcAbilitySection>\n  ): NpcAbilitySection {\n    return {\n      label: customSectionName,\n      items: [],\n      hasActions: true,\n      key: customSectionName,\n      dataset: {\n        [TidyFlags.section.prop]: customSectionName,\n      },\n      canCreate: true,\n      custom: {\n        section: customSectionName,\n        creationItemTypes: NpcSheetSections.abilitiesItemTypes,\n      },\n      show: true,\n      ...customSectionOptions,\n    };\n  }\n}\n","import { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport type {\n  NpcSheetContext,\n  SearchFilterCacheable,\n  LocationToSearchTextMap,\n  SheetExpandedItemsCacheable,\n  SheetStats,\n  SheetTabCacheable,\n  ExpandedItemIdToLocationsMap,\n  ExpandedItemData,\n  MessageBus,\n  Utilities,\n  ActiveEffect5e,\n  NpcAbilitySection,\n  ActorInventoryTypes,\n} from 'src/types/types';\nimport NpcSheet from './npc/NpcSheet.svelte';\nimport { CONSTANTS } from 'src/constants';\nimport {\n  applySheetAttributesToWindow,\n  applyMutableSettingAttributesToWindow,\n  applyTitleToWindow,\n  blurUntabbableButtonsOnClick,\n  maintainCustomContentInputFocus,\n} from 'src/utils/applications.svelte';\nimport { debug } from 'src/utils/logging';\nimport { settings } from 'src/settings/settings.svelte';\nimport { initTidy5eContextMenu } from 'src/context-menu/tidy5e-context-menu';\nimport { mount, unmount } from 'svelte';\nimport type { Item5e, ItemChatData } from 'src/types/item.types';\nimport NpcSheetRuntime from 'src/runtime/NpcSheetRuntime.svelte';\nimport {\n  actorUsesActionFeature,\n  getActorActionSections,\n} from 'src/features/actions/actions.svelte';\nimport { isNil } from 'src/utils/data';\nimport { CustomContentRenderer } from '../CustomContentRenderer';\nimport { ActorPortraitRuntime } from 'src/runtime/ActorPortraitRuntime';\nimport { CustomActorTraitsRuntime } from 'src/runtime/actor-traits/CustomActorTraitsRuntime';\nimport { ItemTableToggleCacheService } from 'src/features/caching/ItemTableToggleCacheService';\nimport { ItemFilterService } from 'src/features/filtering/ItemFilterService.svelte';\nimport { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\nimport { AsyncMutex } from 'src/utils/mutex';\nimport { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\nimport { Tidy5eBaseActorSheet } from './Tidy5eBaseActorSheet.svelte';\nimport { SheetSections } from 'src/features/sections/SheetSections';\nimport { NpcSheetSections } from 'src/features/sections/NpcSheetSections';\nimport { DocumentTabSectionConfigApplication } from 'src/applications/section-config/DocumentTabSectionConfigApplication.svelte';\nimport { BaseSheetCustomSectionMixin } from './mixins/BaseSheetCustomSectionMixin';\nimport { TidyFlags } from 'src/foundry/TidyFlags';\nimport { TidyHooks } from 'src/foundry/TidyHooks';\nimport { Inventory } from 'src/features/sections/Inventory';\nimport { Container } from 'src/features/containers/Container';\nimport { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\nimport { ConditionsAndEffects } from 'src/features/conditions-and-effects/ConditionsAndEffects';\nimport { ItemUtils } from 'src/utils/ItemUtils';\nimport { Activities } from 'src/features/activities/activities';\nimport type { Activity5e } from 'src/foundry/dnd5e.types';\nimport { CoarseReactivityProvider } from 'src/features/reactivity/CoarseReactivityProvider.svelte';\nimport AttachedInfoCard from 'src/components/info-card/AttachedInfoCard.svelte';\nimport { ExpansionTracker } from 'src/features/expand-collapse/ExpansionTracker.svelte';\n\nexport class Tidy5eNpcSheet\n  extends BaseSheetCustomSectionMixin(\n    (object) => object.items,\n    dnd5e.applications.actor.ActorSheet5eNPC\n  )\n  implements\n    SheetTabCacheable,\n    SheetExpandedItemsCacheable,\n    SearchFilterCacheable\n{\n  context = new CoarseReactivityProvider<NpcSheetContext | undefined>(\n    undefined\n  );\n  stats = $state<SheetStats>({\n    lastSubmissionTime: null,\n  });\n  currentTabId: string;\n  searchFilters: LocationToSearchTextMap = new Map<string, string>();\n  expandedItems: ExpandedItemIdToLocationsMap = new Map<string, Set<string>>();\n  expandedItemData: ExpandedItemData = new Map<string, ItemChatData>();\n  inlineToggleService = new InlineToggleService();\n  itemTableTogglesCache: ItemTableToggleCacheService;\n  itemFilterService: ItemFilterService;\n  messageBus = $state<MessageBus>({ message: undefined });\n  sectionExpansionTracker = new ExpansionTracker(\n    true,\n    CONSTANTS.LOCATION_SECTION\n  );\n\n  /**\n   * The cached concentration information for the character.\n   * @type {{items: Set<Item5e>, effects: Set<ActiveEffect5e>}}\n   * @internal\n   */\n  _concentration: { items: Set<Item5e>; effects: Set<ActiveEffect5e> } = {\n    items: new Set(),\n    effects: new Set(),\n  };\n\n  constructor(...args: any[]) {\n    super(...args);\n\n    this.itemTableTogglesCache = new ItemTableToggleCacheService({\n      userId: game.user.id,\n      documentId: this.actor.id,\n    });\n\n    this.itemFilterService = new ItemFilterService({}, this.actor);\n\n    this.currentTabId = settings.value.initialNpcSheetTab;\n  }\n\n  get template() {\n    return FoundryAdapter.getTemplate('empty-form-template.hbs');\n  }\n\n  static get defaultOptions() {\n    return FoundryAdapter.mergeObject(super.defaultOptions, {\n      classes: [\n        CONSTANTS.MODULE_ID,\n        'sheet',\n        'actor',\n        CONSTANTS.SHEET_TYPE_NPC,\n        CONSTANTS.SHEET_LAYOUT_CLASSIC,\n        'app-v1',\n      ],\n      width: 740,\n      height: 810,\n      scrollY: ['[data-tidy-track-scroll-y]', '.scroll-container'],\n    });\n  }\n\n  component: Record<string, any> | undefined;\n  additionalComponents: Record<string, any>[] = [];\n  _effectCleanup?: () => void;\n  activateListeners(html: { get: (index: 0) => HTMLElement }) {\n    // Document Apps Reactivity\n    game.user.apps[this.id] = this;\n\n    // Sheet effects\n    let first = true;\n\n    this._effectCleanup = $effect.root(() => {\n      $effect(() => {\n        if (first) return;\n        applyMutableSettingAttributesToWindow(\n          settings.value,\n          this.element.get(0)\n        );\n        this.render();\n      });\n\n      $effect(() => {\n        debug('Message bus message received', {\n          app: this,\n          actor: this.actor,\n          message: this.messageBus,\n        });\n      });\n    });\n\n    first = false;\n\n    const node = html.get(0);\n\n    this.component = mount(NpcSheet, {\n      target: node,\n      context: new Map<any, any>([\n        [CONSTANTS.SVELTE_CONTEXT.APP_ID, this.appId],\n        [CONSTANTS.SVELTE_CONTEXT.CONTEXT, this.context],\n        [CONSTANTS.SVELTE_CONTEXT.MESSAGE_BUS, this.messageBus],\n        [CONSTANTS.SVELTE_CONTEXT.STATS, this.stats],\n        [CONSTANTS.SVELTE_CONTEXT.CURRENT_TAB_ID, this.currentTabId],\n        [\n          CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n          this.inlineToggleService,\n        ],\n        [CONSTANTS.SVELTE_CONTEXT.ITEM_FILTER_SERVICE, this.itemFilterService],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_TAB_SELECTED,\n          this.onTabSelected.bind(this),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_ITEM_TOGGLED,\n          this.onItemToggled.bind(this),\n        ],\n        [CONSTANTS.SVELTE_CONTEXT.SEARCH_FILTERS, new Map(this.searchFilters)],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_FILTER,\n          this.itemFilterService.onFilter.bind(this.itemFilterService),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_FILTER_CLEAR_ALL,\n          this.itemFilterService.onFilterClearAll.bind(this.itemFilterService),\n        ],\n        [CONSTANTS.SVELTE_CONTEXT.ON_SEARCH, this.onSearch.bind(this)],\n        [CONSTANTS.SVELTE_CONTEXT.LOCATION, ''],\n        [CONSTANTS.SVELTE_CONTEXT.EXPANDED_ITEMS, new Map(this.expandedItems)],\n        [\n          CONSTANTS.SVELTE_CONTEXT.EXPANDED_ITEM_DATA,\n          new Map(this.expandedItemData),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ITEM_TABLE_TOGGLES,\n          new Map(this.itemTableTogglesCache.itemTableToggles),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_ITEM_TABLE_TOGGLE,\n          this.itemTableTogglesCache.onItemTableToggle.bind(\n            this.itemTableTogglesCache\n          ),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.SECTION_EXPANSION_TRACKER,\n          this.sectionExpansionTracker,\n        ],\n      ]),\n    });\n\n    const infoCard = mount(AttachedInfoCard, {\n      target: node,\n      props: {\n        sheet: this,\n      },\n    });\n\n    this.additionalComponents.push(infoCard);\n\n    initTidy5eContextMenu(this, html);\n  }\n\n  async getData(options = {}) {\n    this._concentration = this.actor.concentration;\n\n    const defaultDocumentContext = await super.getData(this.options);\n\n    Tidy5eBaseActorSheet.applyCommonContext(defaultDocumentContext);\n\n    const npcPreferences = SheetPreferencesService.getByType(this.actor.type);\n\n    const abilitiesSortMode =\n      npcPreferences.tabs?.[CONSTANTS.TAB_NPC_ABILITIES]?.sort ?? 'm';\n\n    const spellbookSortMode =\n      npcPreferences.tabs?.[CONSTANTS.TAB_ACTOR_SPELLBOOK]?.sort ?? 'm';\n\n    const actionListSortMode =\n      npcPreferences.tabs?.[CONSTANTS.TAB_ACTOR_ACTIONS]?.sort ?? 'm';\n\n    const inventorySortMode =\n      npcPreferences.tabs?.[CONSTANTS.TAB_ACTOR_INVENTORY]?.sort ?? 'm';\n\n    const unlocked =\n      FoundryAdapter.isSheetUnlocked(this.actor) &&\n      defaultDocumentContext.editable;\n\n    const lockSensitiveFields =\n      (!unlocked && settings.value.useTotalSheetLock) ||\n      !defaultDocumentContext.editable;\n\n    let utilities: Utilities<NpcSheetContext> = {\n      [CONSTANTS.TAB_NPC_ABILITIES]: {\n        utilityToolbarCommands: [\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeAlpha'),\n            iconClass: 'fa-solid fa-arrow-down-a-z fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_NPC_ABILITIES,\n                'sort',\n                'm'\n              );\n            },\n            visible: abilitiesSortMode === 'a',\n          },\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeManual'),\n            iconClass: 'fa-solid fa-arrow-down-short-wide fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_NPC_ABILITIES,\n                'sort',\n                'a'\n              );\n            },\n            visible: abilitiesSortMode === 'm',\n          },\n          {\n            title: 'Spell Pips',\n            iconClass: 'fa-regular fa-circle-dot fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypePreference(\n                this.actor.type,\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_PREFERENCE,\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_VALUE_MAX\n              );\n            },\n            visible:\n              !settings.value.showSpellbookTabNpc &&\n              (npcPreferences?.spellSlotTrackerMode ??\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_PIPS) ===\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_PIPS,\n          },\n          {\n            title: 'Spell Value/Max',\n            iconClass: 'fa-regular fa-square fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypePreference(\n                this.actor.type,\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_PREFERENCE,\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_PIPS\n              );\n            },\n            visible:\n              !settings.value.showSpellbookTabNpc &&\n              npcPreferences?.spellSlotTrackerMode ===\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_VALUE_MAX,\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.ExpandAll'),\n            iconClass: 'fas fa-angles-down',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_NPC_ABILITIES,\n                true\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.CollapseAll'),\n            iconClass: 'fas fa-angles-up',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_NPC_ABILITIES,\n                false\n              ),\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Utilities.ConfigureSections'\n            ),\n            iconClass: 'fas fa-cog',\n            execute: ({ context, sections }) => {\n              new DocumentTabSectionConfigApplication({\n                document: context.actor,\n                sections: sections,\n                tabId: CONSTANTS.TAB_NPC_ABILITIES,\n                tabTitle: NpcSheetRuntime.getTabTitle(\n                  CONSTANTS.TAB_NPC_ABILITIES\n                ),\n              }).render(true);\n            },\n          },\n        ],\n      },\n      [CONSTANTS.TAB_ACTOR_SPELLBOOK]: {\n        utilityToolbarCommands: [\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeAlpha'),\n            iconClass: 'fa-solid fa-arrow-down-a-z fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_SPELLBOOK,\n                'sort',\n                'm'\n              );\n            },\n            visible: spellbookSortMode === 'a',\n          },\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeManual'),\n            iconClass: 'fa-solid fa-arrow-down-short-wide fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_SPELLBOOK,\n                'sort',\n                'a'\n              );\n            },\n            visible: spellbookSortMode === 'm',\n          },\n          {\n            title: 'Spell Pips',\n            iconClass: 'fa-regular fa-circle-dot fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypePreference(\n                this.actor.type,\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_PREFERENCE,\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_VALUE_MAX\n              );\n            },\n            visible:\n              (npcPreferences?.spellSlotTrackerMode ??\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_PIPS) ===\n              CONSTANTS.SPELL_SLOT_TRACKER_MODE_PIPS,\n          },\n          {\n            title: 'Spell Value/Max',\n            iconClass: 'fa-regular fa-square fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypePreference(\n                this.actor.type,\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_PREFERENCE,\n                CONSTANTS.SPELL_SLOT_TRACKER_MODE_PIPS\n              );\n            },\n            visible:\n              npcPreferences?.spellSlotTrackerMode ===\n              CONSTANTS.SPELL_SLOT_TRACKER_MODE_VALUE_MAX,\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.ExpandAll'),\n            iconClass: 'fas fa-angles-down',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_SPELLBOOK,\n                true\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.CollapseAll'),\n            iconClass: 'fas fa-angles-up',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_SPELLBOOK,\n                false\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.ListLayout'),\n            iconClass: 'fas fa-th-list fa-fw toggle-list',\n            visible: !TidyFlags.spellbookGrid.get(this.actor),\n            execute: () => {\n              TidyFlags.spellbookGrid.set(this.actor);\n            },\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.GridLayout'),\n            iconClass: 'fas fa-th-large fa-fw toggle-grid',\n            visible: !!TidyFlags.spellbookGrid.get(this.actor),\n            execute: () => {\n              TidyFlags.spellbookGrid.unset(this.actor);\n            },\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Utilities.ConfigureSections'\n            ),\n            iconClass: 'fas fa-cog',\n            execute: ({ context, sections }) => {\n              new DocumentTabSectionConfigApplication({\n                document: context.actor,\n                sections: sections,\n                tabId: CONSTANTS.TAB_ACTOR_SPELLBOOK,\n                tabTitle: NpcSheetRuntime.getTabTitle(\n                  CONSTANTS.TAB_ACTOR_SPELLBOOK\n                ),\n              }).render(true);\n            },\n          },\n        ],\n      },\n      [CONSTANTS.TAB_ACTOR_ACTIONS]: {\n        utilityToolbarCommands: [\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeAlpha'),\n            iconClass: 'fa-solid fa-arrow-down-a-z fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_ACTIONS,\n                'sort',\n                'm'\n              );\n            },\n            visible: actionListSortMode === 'a',\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.SortMode.ActionListDefault'),\n            iconClass: 'fa-solid fa-arrow-down-short-wide fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_ACTIONS,\n                'sort',\n                'a'\n              );\n            },\n            visible: actionListSortMode === 'm',\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.ExpandAll'),\n            iconClass: 'fas fa-angles-down',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_ACTIONS,\n                true\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.CollapseAll'),\n            iconClass: 'fas fa-angles-up',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_ACTIONS,\n                false\n              ),\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Utilities.ConfigureSections'\n            ),\n            iconClass: 'fas fa-cog',\n            execute: ({ context, sections }) => {\n              new DocumentTabSectionConfigApplication({\n                document: context.actor,\n                sections: sections,\n                tabId: CONSTANTS.TAB_ACTOR_ACTIONS,\n                tabTitle: NpcSheetRuntime.getTabTitle(\n                  CONSTANTS.TAB_ACTOR_ACTIONS\n                ),\n              }).render(true);\n            },\n          },\n        ],\n      },\n      [CONSTANTS.TAB_ACTOR_INVENTORY]: {\n        utilityToolbarCommands: [\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeAlpha'),\n            iconClass: 'fa-solid fa-arrow-down-a-z fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_INVENTORY,\n                'sort',\n                'm'\n              );\n            },\n            visible: inventorySortMode === 'a',\n          },\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeManual'),\n            iconClass: 'fa-solid fa-arrow-down-short-wide fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_INVENTORY,\n                'sort',\n                'a'\n              );\n            },\n            visible: inventorySortMode === 'm',\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Commands.HideContainerPanel'\n            ),\n            iconClass: `fas fa-boxes-stacked fa-fw`,\n            execute: () => {\n              TidyFlags.showContainerPanel.unset(this.actor);\n            },\n            visible: !!TidyFlags.showContainerPanel.get(this.actor),\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Commands.ShowContainerPanel'\n            ),\n            iconClass: `fas fa-box fa-fw`,\n            execute: () => {\n              TidyFlags.showContainerPanel.set(this.actor, true);\n            },\n            visible: !TidyFlags.showContainerPanel.get(this.actor),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.ExpandAll'),\n            iconClass: 'fas fa-angles-down',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_INVENTORY,\n                true\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.CollapseAll'),\n            iconClass: 'fas fa-angles-up',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_INVENTORY,\n                false\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.ListLayout'),\n            iconClass: 'fas fa-th-list fa-fw toggle-list',\n            visible: !TidyFlags.inventoryGrid.get(this.actor),\n            execute: () => {\n              TidyFlags.inventoryGrid.set(this.actor);\n            },\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.GridLayout'),\n            iconClass: 'fas fa-th-large fa-fw toggle-grid',\n            visible: !!TidyFlags.inventoryGrid.get(this.actor),\n            execute: () => {\n              TidyFlags.inventoryGrid.unset(this.actor);\n            },\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Utilities.ConfigureSections'\n            ),\n            iconClass: 'fas fa-cog',\n            execute: ({ context, sections }) => {\n              new DocumentTabSectionConfigApplication({\n                document: context.actor,\n                sections: sections,\n                tabId: CONSTANTS.TAB_ACTOR_INVENTORY,\n                tabTitle: NpcSheetRuntime.getTabTitle(\n                  CONSTANTS.TAB_ACTOR_INVENTORY\n                ),\n              }).render(true);\n            },\n          },\n        ],\n      },\n    };\n\n    // Effects & Conditions\n    let { conditions, effects: enhancedEffectSections } =\n      await ConditionsAndEffects.getConditionsAndEffects(\n        this.actor,\n        this.object,\n        defaultDocumentContext.effects\n      );\n\n    const context: NpcSheetContext = {\n      ...defaultDocumentContext,\n      actions: await getActorActionSections(this.actor),\n      activateEditors: (node, options) =>\n        FoundryAdapter.activateEditors(node, this, options?.bindSecrets),\n      actorPortraitCommands:\n        ActorPortraitRuntime.getEnabledPortraitMenuCommands(this.actor),\n      allowEffectsManagement: true,\n      appearanceEnrichedHtml: await FoundryAdapter.enrichHtml(\n        TidyFlags.appearance.get(this.actor) ?? '',\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      appId: this.appId,\n      biographyEnrichedHtml: await FoundryAdapter.enrichHtml(\n        FoundryAdapter.getProperty<string>(\n          this.actor,\n          `system.details.biography.value`\n        ) ?? '',\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      bondEnrichedHtml: await FoundryAdapter.enrichHtml(\n        this.actor.system.details.bond,\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      conditions: conditions,\n      containerPanelItems: await Inventory.getContainerPanelItems(\n        defaultDocumentContext.items\n      ),\n      customActorTraits: CustomActorTraitsRuntime.getEnabledTraits(\n        defaultDocumentContext\n      ),\n      customContent: await NpcSheetRuntime.getContent(defaultDocumentContext),\n      document: this.document,\n      useClassicControls: settings.value.useClassicControlsForNpc,\n      effects: enhancedEffectSections,\n      editable: defaultDocumentContext.editable,\n      encumbrance: this.actor.system.attributes.encumbrance,\n      filterData: this.itemFilterService.getDocumentItemFilterData(),\n      filterPins: ItemFilterRuntime.defaultFilterPins[this.actor.type],\n      flawEnrichedHtml: await FoundryAdapter.enrichHtml(\n        this.actor.system.details.flaw,\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      hideEmptySpellbook:\n        lockSensitiveFields && defaultDocumentContext.spellbook.length === 0,\n      healthPercentage: this.actor.system.attributes.hp.pct.toNearest(0.1),\n      showSpellbookTab: settings.value.showSpellbookTabNpc,\n      idealEnrichedHtml: await FoundryAdapter.enrichHtml(\n        this.actor.system.details.ideal,\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      showContainerPanel:\n        TidyFlags.showContainerPanel.get(this.actor) === true &&\n        Array.from(defaultDocumentContext.items).some(\n          (i: Item5e) => i.type === CONSTANTS.ITEM_TYPE_CONTAINER\n        ),\n      showLoyalty:\n        this.actor.system.traits.important &&\n        game.settings.get('dnd5e', 'loyaltyScore') &&\n        game.user.isGM,\n      spellcastingInfo: FoundryAdapter.getSpellcastingInfo(\n        this.actor,\n        this.actor.itemTypes.spell\n      ),\n      lockSensitiveFields: lockSensitiveFields,\n      longRest: this._onLongRest.bind(this),\n      lockExpChanges: FoundryAdapter.shouldLockExpChanges(),\n      lockHpMaxChanges: FoundryAdapter.shouldLockHpMaxChanges(),\n      lockItemQuantity: FoundryAdapter.shouldLockItemQuantity(),\n      lockLevelSelector: FoundryAdapter.shouldLockLevelSelector(),\n      lockMoneyChanges: FoundryAdapter.shouldLockMoneyChanges(),\n      modernRules: FoundryAdapter.checkIfModernRules(this.actor),\n      notes1EnrichedHtml: await FoundryAdapter.enrichHtml(\n        TidyFlags.notes1.members.value.get(this.actor) ?? '',\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      notes2EnrichedHtml: await FoundryAdapter.enrichHtml(\n        TidyFlags.notes2.members.value.get(this.actor) ?? '',\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      notes3EnrichedHtml: await FoundryAdapter.enrichHtml(\n        TidyFlags.notes3.members.value.get(this.actor) ?? '',\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      notes4EnrichedHtml: await FoundryAdapter.enrichHtml(\n        TidyFlags.notes4.members.value.get(this.actor) ?? '',\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      notesEnrichedHtml: await FoundryAdapter.enrichHtml(\n        TidyFlags.notes.members.value.get(this.actor) ?? '',\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      owner: this.actor.isOwner,\n      shortRest: this._onShortRest.bind(this),\n      showLimitedSheet: FoundryAdapter.showLimitedSheet(this.actor),\n      spellComponentLabels: FoundryAdapter.getSpellComponentLabels(),\n      spellSlotTrackerMode:\n        npcPreferences.spellSlotTrackerMode ??\n        CONSTANTS.SPELL_SLOT_TRACKER_MODE_PIPS,\n      tabs: [],\n      traitEnrichedHtml: await FoundryAdapter.enrichHtml(\n        TidyFlags.trait.get(this.actor) ?? '',\n        {\n          secrets: this.actor.isOwner,\n          rollData: defaultDocumentContext.rollData,\n          relativeTo: this.actor,\n        }\n      ),\n      unlocked: unlocked,\n      useActionsFeature: actorUsesActionFeature(this.actor),\n      useRoundedPortraitStyle: [\n        CONSTANTS.CIRCULAR_PORTRAIT_OPTION_ALL as string,\n        CONSTANTS.CIRCULAR_PORTRAIT_OPTION_NPCVEHICLE as string,\n      ].includes(settings.value.useCircularPortraitStyle),\n      utilities: utilities,\n      viewableWarnings:\n        defaultDocumentContext.warnings?.filter(\n          (w: any) => !isNil(w.message?.trim(), '')\n        ) ?? [],\n    };\n\n    // Legendary Panel\n    context.hasLegendaries =\n      this.actor.system.resources.legact.max ||\n      this.actor.system.resources.legres.max ||\n      (context.modernRules && this.actor.system.resources.lair.value) ||\n      (!context.modernRules && this.actor.system.resources.lair.initiative);\n\n    // Container Contents Panel\n    for (const panelItem of context.containerPanelItems) {\n      const ctx = context.itemContext[panelItem.container.id];\n      ctx.containerContents = await Container.getContainerContents(\n        panelItem.container\n      );\n    }\n\n    // Treasure\n    let details = this.actor.system.details;\n    if (details?.treasure?.value.size) {\n      const any = details.treasure.value.has(CONSTANTS.TREASURE_ANY);\n      context.treasure = details.treasure.value\n        .reduce((arr: { label: string }[], id: string) => {\n          const { label } = CONFIG.DND5E.treasure[id] ?? {};\n          if (label && (!any || id === CONSTANTS.TREASURE_ANY))\n            arr.push({ label });\n          return arr;\n        }, [])\n        .toSorted((a: { label: string }, b: { label: string }) =>\n          a.label.localeCompare(b.label, game.i18n.lang)\n        );\n    }\n\n    let tabs = await NpcSheetRuntime.getTabs(context);\n\n    const selectedTabs = TidyFlags.selectedTabs.get(context.actor);\n\n    if (selectedTabs?.length) {\n      tabs = tabs\n        .filter((t) => selectedTabs?.includes(t.id))\n        .sort(\n          (a, b) => selectedTabs.indexOf(a.id) - selectedTabs.indexOf(b.id)\n        );\n    } else {\n      const defaultTabs = settings.value.defaultNpcSheetTabs;\n      tabs = tabs\n        .filter((t) => defaultTabs?.includes(t.id))\n        .sort((a, b) => defaultTabs.indexOf(a.id) - defaultTabs.indexOf(b.id));\n    }\n\n    context.tabs = tabs;\n\n    TidyHooks.tidy5eSheetsPreConfigureSections(\n      this,\n      this.element.get(0),\n      context\n    );\n\n    debug('NPC Sheet context data', context);\n\n    return context;\n  }\n\n  protected _prepareItems(context: NpcSheetContext) {\n    // Categorize Items as Features and Spells\n    const features: Record<string, NpcAbilitySection> = {\n      [CONSTANTS.NPC_ABILITY_SECTION_WEAPONS]: {\n        label: game.i18n.localize('DND5E.AttackPl'),\n        items: [],\n        hasActions: true,\n        dataset: {\n          type: CONSTANTS.ITEM_TYPE_WEAPON,\n          'system.weaponType': 'natural',\n        },\n        canCreate: true,\n        key: 'weapons',\n        show: true,\n      },\n      [CONSTANTS.NPC_ABILITY_SECTION_ACTIONS]: {\n        label: game.i18n.localize('DND5E.ActionPl'),\n        items: [],\n        hasActions: true,\n        dataset: {\n          type: CONSTANTS.ITEM_TYPE_FEAT,\n          'system.activation.type': 'action',\n        },\n        canCreate: true,\n        key: 'actions',\n        show: true,\n      },\n      [CONSTANTS.NPC_ABILITY_SECTION_PASSIVE]: {\n        label: game.i18n.localize('DND5E.Features'),\n        items: [],\n        dataset: { type: CONSTANTS.ITEM_TYPE_FEAT },\n        canCreate: true,\n        key: 'passive',\n        show: true,\n      },\n      [CONSTANTS.NPC_ABILITY_SECTION_EQUIPMENT]: {\n        label: game.i18n.localize('DND5E.Inventory'),\n        items: [],\n        dataset: { type: CONSTANTS.ITEM_TYPE_LOOT },\n        canCreate: true,\n        key: 'equipment',\n        show: true,\n      },\n      [CONSTANTS.NPC_ABILITY_SECTION_CLASSES]: {\n        label: `${CONFIG.Item.typeLabels.class}Pl`,\n        items: [],\n        dataset: { type: CONSTANTS.ITEM_TYPE_CLASS },\n        canCreate: true,\n        key: 'classes',\n        show: true,\n        isClass: true,\n      },\n    };\n\n    // Start by classifying items into groups for rendering\n    let { spells, classes, subclasses, other } = context.items.reduce<{\n      spells: Item5e[];\n      classes: Item5e[];\n      subclasses: Item5e[];\n      other: Item5e[];\n    }>(\n      (features, item) => {\n        const { quantity, uses } = item.system;\n        const ctx = (context.itemContext[item.id] ??= {});\n\n        // Activities\n        ctx.activities = Activities.getVisibleActivities(\n          item,\n          item.system.activities\n        )?.map(Activities.getActivityItemContext);\n\n        Activities.applyLinkedUses(item, this.actor, ctx);\n\n        ctx.attunement = FoundryAdapter.getAttunementContext(item);\n        ctx.isStack = Number.isNumeric(quantity) && quantity !== 1;\n        ctx.hasUses = uses && uses.max > 0;\n        ctx.canToggle = 'equipped' in item.system;\n\n        ctx.totalWeight = item.system.totalWeight?.toNearest(0.1);\n        if (item.type === CONSTANTS.ITEM_TYPE_SPELL) {\n          if (this._concentration.items.has(item)) {\n            ctx.concentration = true;\n          }\n          features.spells.push(item);\n        } else if (item.type === CONSTANTS.ITEM_TYPE_CLASS) {\n          features.classes.push(item);\n        } else if (item.type === CONSTANTS.ITEM_TYPE_SUBCLASS) {\n          features.subclasses.push(item);\n        } else {\n          features.other.push(item);\n        }\n        return features;\n      },\n      { spells: [], subclasses: [], classes: [], other: [] }\n    );\n\n    classes = SheetSections.prepareClassItems(\n      context,\n      classes,\n      subclasses,\n      this.actor\n    );\n\n    for (const subclass of subclasses) {\n      const message = game.i18n.format('DND5E.SubclassMismatchWarn', {\n        name: subclass.name,\n        class: subclass.system.classIdentifier,\n      });\n      context.warnings.push({ message, type: 'warning' });\n    }\n\n    other = [...other, ...subclasses];\n\n    features.classes.items = classes;\n\n    const inventoryTypesArray = Inventory.getDefaultInventoryTypes();\n    const inventoryTypes = new Set(inventoryTypesArray);\n    const inventory: ActorInventoryTypes =\n      Inventory.getDefaultInventorySections();\n\n    SheetSections.getFilteredGlobalSectionsToShowWhenEmpty(\n      context.actor,\n      CONSTANTS.TAB_ACTOR_INVENTORY\n    ).forEach((s) => {\n      inventory[s] ??= Inventory.createInventorySection(\n        s,\n        inventoryTypesArray,\n        {\n          canCreate: true,\n        }\n      );\n    });\n\n    // Organize Features\n    for (let item of other) {\n      if (inventoryTypes.has(item.type)) {\n        Inventory.applyInventoryItemToSection(\n          inventory,\n          item,\n          inventoryTypesArray,\n          {\n            canCreate: true,\n          }\n        );\n      }\n      // Handle custom section, if present\n      if (TidyFlags.section.get(item)) {\n        NpcSheetSections.applyAbilityToSection(features, item, {\n          canCreate: true,\n        });\n      } else if (item.type === CONSTANTS.ITEM_TYPE_WEAPON)\n        features.weapons.items.push(item);\n      else if (\n        [\n          CONSTANTS.ITEM_TYPE_BACKGROUND,\n          CONSTANTS.ITEM_TYPE_CLASS,\n          CONSTANTS.ITEM_TYPE_FEAT,\n          CONSTANTS.ITEM_TYPE_RACE,\n          CONSTANTS.ITEM_TYPE_SUBCLASS,\n        ].includes(item.type)\n      ) {\n        if (ItemUtils.hasActivationType(item)) {\n          features.actions.items.push(item);\n        } else {\n          // TODO: Partition classes/subclasses to their own area; this may have to happen in the original partition of the spells / other arrays.\n          features.passive.items.push(item);\n        }\n      } else features.equipment.items.push(item);\n    }\n\n    SheetSections.getFilteredGlobalSectionsToShowWhenEmpty(\n      this.actor,\n      CONSTANTS.TAB_NPC_ABILITIES\n    ).forEach((s) => {\n      features[s] ??= NpcSheetSections.createFeatureSection(s, {\n        canCreate: true,\n      });\n    });\n\n    // Organize Spellbook\n    // Section spells\n    // TODO: Take over `_prepareSpellbook` and have custom sectioning built right in\n    const spellbook = SheetSections.prepareTidySpellbook(\n      context,\n      CONSTANTS.TAB_ACTOR_SPELLBOOK,\n      spells,\n      {\n        canCreate: true,\n      },\n      this\n    );\n\n    context.features = Object.values(features);\n    context.spellbook = spellbook;\n    context.inventory = Object.values(inventory);\n  }\n\n  private async setExpandedItemData() {\n    this.expandedItemData.clear();\n    for (const id of this.expandedItems.keys()) {\n      const item = this.actor.items.get(id);\n      if (item) {\n        this.expandedItemData.set(\n          id,\n          await item.getChatData({ secrets: this.actor.isOwner })\n        );\n      }\n    }\n  }\n\n  _prepareTraits(systemData: any) {\n    const traits = super._prepareTraits(systemData);\n    FoundryAdapter.prepareLanguageTrait(this.actor, traits);\n    return traits;\n  }\n\n  onToggleAbilityProficiency(event: Event) {\n    return this._onToggleAbilityProficiency(event);\n  }\n\n  async _onDropSingleItem(itemData: any, event: DragEvent) {\n    // Create a Consumable spell scroll on the Inventory tab\n    if (\n      itemData.type === CONSTANTS.ITEM_TYPE_SPELL &&\n      this.currentTabId === CONSTANTS.TAB_ACTOR_INVENTORY\n    ) {\n      const options: Record<string, unknown> = {};\n\n      if (settings.value.includeFlagsInSpellScrollCreation) {\n        options.flags = itemData.flags;\n      }\n\n      const scroll = await dnd5e.documents.Item5e.createScrollFromSpell(\n        itemData,\n        options\n      );\n\n      return scroll.toObject();\n    }\n\n    return super._onDropSingleItem(itemData, event);\n  }\n\n  async _renderOuter() {\n    const html = await super._renderOuter();\n    if (!game.user.isGM && this.actor.limited) return html;\n    const header = html[0].querySelector('.window-header');\n\n    // Preparation warnings.\n    const warnings = document.createElement('a');\n    warnings.classList.add('preparation-warnings');\n    warnings.dataset.tooltip = 'Warnings';\n    warnings.setAttribute('aria-label', game.i18n.localize('Warnings'));\n    warnings.innerHTML = '<i class=\"fas fa-triangle-exclamation\"></i>';\n    warnings.addEventListener('click', this._onOpenWarnings.bind(this));\n    header\n      .querySelector('.window-title')\n      .insertAdjacentElement('afterend', warnings);\n\n    return html;\n  }\n\n  /**\n   * Handle opening the warnings dialog.\n   * @param {PointerEvent} event  The triggering event.\n   * @protected\n   */\n  _onOpenWarnings(event: MouseEvent) {\n    event.stopImmediatePropagation();\n    // @ts-expect-error\n    const { top, left, height } = event.currentTarget!.getBoundingClientRect();\n    const { clientWidth } = document.documentElement;\n    const dialog = this.form.querySelector('dialog.warnings');\n    Object.assign(dialog.style, {\n      top: `${top + height}px`,\n      left: `${Math.min(left - 16, clientWidth - 300)}px`,\n    });\n    dialog.showModal();\n  }\n\n  /**\n   * A boolean which gates double-rendering and prevents a second\n   * colliding render from triggering an infamous\n   * \"One of original or other are not Objects!\" error.\n   */\n  private tidyRendering = false;\n\n  render(...args: unknown[]) {\n    debug('Sheet render begin');\n    this.tidyRendering = true;\n    super.render(...args);\n\n    const [warnings] = this.element.find(\n      '.window-header .preparation-warnings'\n    );\n    warnings?.toggleAttribute(\n      'hidden',\n      !this.actor._preparationWarnings?.length\n    );\n  }\n\n  private _renderMutex = new AsyncMutex();\n  async _render(force?: boolean, options = {}) {\n    await this._renderMutex.lock(async () => {\n      const doubleRenderDetected =\n        this.options.token && this.tidyRendering === false;\n\n      if (doubleRenderDetected) {\n        return;\n      }\n\n      await this._renderSheet(force, options);\n    });\n    this.tidyRendering = false;\n    debug('Sheet render end');\n  }\n\n  private async _renderSheet(force?: boolean, options = {}) {\n    await this.setExpandedItemData();\n    const data = await this.getData();\n    SheetSections.accountForExternalSections(['features', 'spellbook'], data);\n    this.context.data = data;\n\n    if (force) {\n      const { width, height } =\n        SheetPreferencesService.getByType(this.actor.type) ?? {};\n      this.position = {\n        ...this.position,\n        width: width ?? this.position.width,\n        height: height ?? this.position.height,\n      };\n\n      this._saveScrollPositions(this.element);\n      this._destroySvelteComponent();\n      await super._render(force, options);\n      applySheetAttributesToWindow(\n        this.actor.documentName,\n        this.actor.uuid,\n        this.actor.type,\n        this.element.get(0)\n      );\n      await this.renderCustomContent({ data, isFullRender: true });\n      TidyHooks.tidy5eSheetsRenderActorSheet(\n        this,\n        this.element.get(0),\n        data,\n        true\n      );\n      CustomContentRenderer.wireCompatibilityEventListeners(\n        this.element,\n        super.activateListeners,\n        this\n      );\n      blurUntabbableButtonsOnClick(this.element.get(0));\n      return;\n    }\n\n    await maintainCustomContentInputFocus(this, async () => {\n      applyTitleToWindow(this.title, this.element.get(0));\n      await this.renderCustomContent({ data, isFullRender: false });\n      TidyHooks.tidy5eSheetsRenderActorSheet(\n        this,\n        this.element.get(0),\n        data,\n        false\n      );\n      CustomContentRenderer.wireCompatibilityEventListeners(\n        this.element,\n        super.activateListeners,\n        this\n      );\n    });\n  }\n\n  private async renderCustomContent(args: {\n    data: NpcSheetContext;\n    isFullRender: boolean;\n  }) {\n    await CustomContentRenderer.render({\n      app: this,\n      customContent: args.data.customContent,\n      data: args.data,\n      element: this.element,\n      isFullRender: args.isFullRender,\n      superActivateListeners: super.activateListeners,\n      tabs: args.data.tabs,\n    });\n  }\n\n  _getHeaderButtons() {\n    const buttons = super._getHeaderButtons();\n\n    return FoundryAdapter.removeConfigureSettingsButtonWhenLockedForNonGm(\n      buttons\n    );\n  }\n\n  _destroySvelteComponent() {\n    if (this.component) {\n      unmount(this.component);\n    }\n    this.component = undefined;\n\n    this.additionalComponents.forEach((c) => unmount(c));\n    this.additionalComponents = [];\n  }\n\n  _saveScrollPositions(html: any) {\n    if (html.length && this.component) {\n      const save = super._saveScrollPositions(html);\n      debug('Saved scroll positions', this._scrollPositions);\n      return save;\n    }\n  }\n\n  /**\n   * Take a short rest, calling the relevant function on the Actor instance.\n   * @param {Event} event             The triggering click event.\n   * @returns {Promise<RestResult>}  Result of the rest action.\n   */\n  async _onShortRest(event: Event) {\n    event.preventDefault();\n    await this._onSubmit(event);\n    return this.actor.shortRest({\n      chat: settings.value.showNpcRestInChat,\n    });\n  }\n\n  /**\n   * Take a long rest, calling the relevant function on the Actor instance\n   * @param {Event} event   The triggering click event\n   * @private\n   */\n  async _onLongRest(event: Event) {\n    event.preventDefault();\n    await this._onSubmit(event);\n    return this.actor.longRest({\n      chat: settings.value.showNpcRestInChat,\n    });\n  }\n\n  async _onSubmit(...args: any[]) {\n    await super._onSubmit(...args);\n    this.stats.lastSubmissionTime = new Date();\n  }\n\n  close(options: unknown = {}) {\n    this._effectCleanup?.();\n    this._destroySvelteComponent();\n    delete game.user.apps[this.id];\n    return super.close(options);\n  }\n\n  _disableFields(...args: any[]) {\n    debug('Ignoring call to disable fields. Delegating to Tidy Sheets...');\n  }\n\n  _onResize(event: any) {\n    super._onResize(event);\n    const { width, height } = this.position;\n    SheetPreferencesService.setDocumentTypePreference(\n      this.actor.type,\n      'width',\n      width\n    );\n    SheetPreferencesService.setDocumentTypePreference(\n      this.actor.type,\n      'height',\n      height\n    );\n  }\n\n  /* -------------------------------------------- */\n  /* SheetTabCacheable\n  /* -------------------------------------------- */\n\n  onTabSelected(tabId: string) {\n    this.currentTabId = tabId;\n  }\n\n  /* -------------------------------------------- */\n  /* SheetExpandedItemsCacheable\n  /* -------------------------------------------- */\n\n  onItemToggled(itemId: string, isVisible: boolean, location: string) {\n    const locationSet =\n      this.expandedItems.get(itemId) ??\n      this.expandedItems.set(itemId, new Set<string>()).get(itemId);\n\n    if (isVisible) {\n      locationSet?.add(location);\n    } else {\n      locationSet?.delete(location);\n    }\n\n    debug('Item Toggled', {\n      expandedItems: this.expandedItems,\n    });\n  }\n\n  /* -------------------------------------------- */\n  /* SearchFilterCacheable\n  /* -------------------------------------------- */\n\n  onSearch(location: string, text: string): void {\n    debug('Searched', {\n      location,\n      text,\n    });\n    this.searchFilters.set(location, text);\n  }\n}\n","<script lang=\"ts\">\n  import HpBar from 'src/components/bar/HpBar.svelte';\n  import ResourceWithBar from 'src/components/bar/ResourceWithBar.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getVehicleSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getVehicleSheetContext());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"portrait-hp\" title={localize('DND5E.HitPoints')}>\n  <ResourceWithBar\n    document={context.actor}\n    value={context.system.attributes.hp.value}\n    valueField=\"system.attributes.hp.value\"\n    valueTitle={localize('DND5E.HitPointsCurrent')}\n    valueDisabled={!context.editable}\n    max={context.system.attributes.hp.max}\n    maxField=\"system.attributes.hp.max\"\n    maxTitle={localize('DND5E.HitPointsMax')}\n    maxDisabled={!context.editable ||\n      context.lockHpMaxChanges ||\n      context.lockSensitiveFields}\n    percentage={context.healthPercentage}\n    Bar={settings.value.useHpBarVehicle ? HpBar : null}\n  />\n</div>\n\n<style lang=\"scss\">\n  .portrait-hp {\n    position: absolute;\n    width: 8.5rem;\n    left: 50%;\n    height: 1.25rem;\n    font-size: 1.125rem;\n    transform: translateX(-50%);\n    bottom: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-family: var(--t5e-title-font-family);\n\n    :global(.resource-value),\n    :global(.resource-max) {\n      font-weight: 700;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getVehicleSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getVehicleSheetContext());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"profile-thresholds\">\n  <TextInput\n    document={context.actor}\n    field=\"system.attributes.hp.dt\"\n    class=\"damage-threshold\"\n    placeholder={localize('DND5E.Threshold')}\n    value={context.system.attributes.hp.dt?.toString() ?? ''}\n    allowDeltaChanges={true}\n    maxlength={5}\n    title={localize('DND5E.DamageThreshold')}\n    disabled={!context.editable || context.lockSensitiveFields}\n  />\n  <TextInput\n    document={context.actor}\n    field=\"system.attributes.hp.mt\"\n    class=\"mishap-threshold\"\n    placeholder={localize('DND5E.VehicleMishap')}\n    value={context.system.attributes.hp.mt?.toString() ?? ''}\n    allowDeltaChanges={true}\n    maxlength={5}\n    title={localize('DND5E.VehicleMishapThreshold')}\n    disabled={!context.editable || context.lockSensitiveFields}\n  />\n</div>\n\n<style lang=\"scss\">\n  .profile-thresholds {\n    display: flex;\n    justify-content: center;\n\n    :global(input) {\n      flex: 0 0 4.6875rem; // Or hard width\n      display: flex;\n      font-size: 0.75rem;\n      line-height: 0.75rem;\n      height: 0.875rem;\n      padding: 0.0625rem 0;\n    }\n\n    :global(input.damage-threshold),\n    :global(input.mishap-threshold) {\n      text-align: center;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import Checkbox from 'src/components/inputs/Checkbox.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import { getVehicleSheetContext } from 'src/sheets/sheet-context.svelte';\n  import type { PortraitCharmRadiusClass } from 'src/types/types';\n\n  let context = $derived(getVehicleSheetContext());\n\n  interface Props {\n    motion: boolean;\n    cssClass?: string;\n    radiusClass: PortraitCharmRadiusClass;\n    animate?: boolean;\n  }\n\n  let { motion, cssClass = '', radiusClass, animate = true }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div\n  class=\"motion {cssClass}\"\n  class:is-in-motion={motion}\n  title={localize(\n    motion ? 'TIDY5E.VehicleInMotion' : 'TIDY5E.VehicleMotionless',\n  )}\n>\n  <Checkbox\n    checkboxCssClass=\"motion-toggle\"\n    labelCssClass=\"{motion ? 'motion' : ''} {radiusClass}\"\n    document={context.actor}\n    field={TidyFlags.motion.prop}\n    checked={motion}\n    disabled={!context.editable}\n  >\n    <i class=\"motion-icon fas fa-sailboat\" class:animate></i>\n  </Checkbox>\n</div>\n\n<style lang=\"scss\">\n  .motion {\n    position: absolute;\n    right: 0;\n    top: 0;\n    width: 2.125rem;\n    height: 2.125rem;\n\n    &.only-show-on-hover {\n      :global(label) {\n        visibility: hidden;\n      }\n\n      &:hover :global(label) {\n        visibility: visible;\n      }\n    }\n\n    :global(input.motion-toggle) {\n      display: none;\n    }\n\n    :global(label) {\n      width: 100%;\n      height: 100%;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      font-size: 1.25rem;\n      color: var(--t5e-icon-font-color);\n      cursor: pointer;\n      box-shadow: 0 0 0.625rem var(--t5e-icon-shadow-color) inset;\n      border: 0.0625rem solid var(--t5e-icon-outline-color);\n      background: var(--t5e-icon-background);\n    }\n\n    :global(label i) {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      border-radius: 50%;\n      text-align: center;\n      line-height: 2.125rem;\n    }\n\n    :global(label:hover) {\n      color: var(--t5e-vehicle-motion-hover-color);\n      text-shadow: 0 0 0.3125rem\n        var(--t5e-vehicle-motion-text-shadow-hover-color);\n    }\n  }\n\n  .is-in-motion {\n    :global(label) {\n      color: var(--t5e-activated-profile-toggle-color);\n      text-shadow: 0 0 0.625rem var(--t5e-vehicle-in-motion-text-shadow-color);\n      background: var(--t5e-vehicle-in-motion-background);\n    }\n\n    :global(label i.animate) {\n      color: var(--t5e-activated-profile-toggle-color);\n      animation: boat 5s linear infinite;\n    }\n  }\n\n  @keyframes boat {\n    0% {\n      transform: rotate(0);\n    }\n    25% {\n      transform: rotate(-3deg) translate(0.0625rem, 0);\n    }\n    50% {\n      transform: rotate(3deg) translate(0.0625rem, 0);\n    }\n    100% {\n      transform: rotate(0);\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import ActorProfile from 'src/sheets/classic/actor/ActorProfile.svelte';\n  import VehicleHitPoints from './VehicleHitPoints.svelte';\n  import VehicleDamageAndMishapThresholds from './VehicleDamageAndMishapThresholds.svelte';\n  import ExhaustionTracker from 'src/sheets/classic/actor/ExhaustionTracker.svelte';\n  import VehicleMovement from './VehicleMovement.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import ExhaustionInput from 'src/sheets/classic/actor/ExhaustionInput.svelte';\n  import { ActiveEffectsHelper } from 'src/utils/active-effect';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import { getVehicleSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getVehicleSheetContext());\n\n  function onLevelSelected(level: number) {\n    TidyFlags.setFlag(context.actor, 'exhaustion', level);\n  }\n</script>\n\n<ActorProfile\n  useHpOverlay={settings.value.useHpOverlayVehicle &&\n    context.system.attributes.hp.max > 0}\n>\n  {#if settings.value.useExhaustion && settings.value.vehicleExhaustionConfig.type === 'specific'}\n    <ExhaustionTracker\n      level={TidyFlags.exhaustion.get(context.actor) ?? 0}\n      radiusClass={context.useRoundedPortraitStyle ? 'rounded' : 'top-left'}\n      {onLevelSelected}\n      exhaustionConfig={settings.value.vehicleExhaustionConfig}\n      isActiveEffectApplied={ActiveEffectsHelper.isActiveEffectAppliedToField(\n        context.actor,\n        TidyFlags.exhaustion.prop,\n      )}\n    />\n  {:else if settings.value.useExhaustion && settings.value.vehicleExhaustionConfig.type === 'open'}\n    <ExhaustionInput\n      level={TidyFlags.exhaustion.get(context.actor) ?? 0}\n      radiusClass={context.useRoundedPortraitStyle ? 'rounded' : 'top-left'}\n      {onLevelSelected}\n      isActiveEffectApplied={ActiveEffectsHelper.isActiveEffectAppliedToField(\n        context.actor,\n        TidyFlags.exhaustion.prop,\n      )}\n    />\n  {/if}\n  {#if settings.value.useVehicleMotion}\n    <VehicleMovement\n      motion={TidyFlags.motion.get(context.actor) === true}\n      radiusClass={context.useRoundedPortraitStyle ? 'rounded' : 'top-right'}\n      animate={true}\n    />\n  {/if}\n  <VehicleHitPoints />\n</ActorProfile>\n<VehicleDamageAndMishapThresholds />\n","<script lang=\"ts\">\n  import AcShieldBase from './AcShieldBase.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import NumberInput from 'src/components/inputs/NumberInput.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { getVehicleSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getVehicleSheetContext());\n\n  interface Props {\n    /**\n     * Optional CSS class list string to apply to the AC Shield container element.\n     */\n    cssClass?: string;\n  }\n\n  let { cssClass = '' }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"vehicle-armor-class-wrapper\">\n  <AcShieldBase cssClass=\"{cssClass} vehicle-ac-shield\">\n    <NumberInput\n      document={context.actor}\n      field=\"system.attributes.ac.flat\"\n      value={context.actor.system.attributes.ac.flat}\n      step=\"1\"\n      min=\"0\"\n      placeholder=\"\"\n      title={localize('DND5E.ArmorClass')}\n      cssClass=\"armor-class-flat\"\n      selectOnFocus={true}\n      disabled={!context.editable || context.lockSensitiveFields}\n    />\n    <TextInput\n      document={context.actor}\n      field=\"system.attributes.ac.motionless\"\n      value={context.system.attributes.ac.motionless}\n      placeholder=\"\"\n      title={localize('DND5E.ArmorClassMotionless')}\n      class=\"armor-class-motionless\"\n      selectOnFocus={true}\n      disabled={!context.editable || context.lockSensitiveFields}\n    />\n  </AcShieldBase>\n</div>\n\n<style lang=\"scss\">\n  .vehicle-armor-class-wrapper {\n    display: flex;\n\n    :global(.armor-class-flat) {\n      flex: 3;\n      font-family: var(--t5e-title-font-family);\n      position: absolute;\n      top: 40%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      font-size: 2.1875rem;\n      height: 2.5rem;\n      font-weight: 700;\n      margin: 0 auto;\n      width: 3.75rem;\n      text-align: center;\n    }\n\n    :global(.armor-class-motionless) {\n      position: absolute;\n      bottom: 0.375rem;\n      left: 0;\n      width: 100%;\n      font-size: 0.75rem;\n      line-height: 0.875rem;\n      height: 0.875rem;\n      padding: 0.0625rem 0;\n      text-align: center;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import type { DropdownListOption } from 'src/types/types';\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import SheetEditModeToggle from 'src/sheets/classic/actor/SheetEditModeToggle.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import VehicleProfile from './parts/VehicleProfile.svelte';\n  import ContentEditableFormField from 'src/components/inputs/ContentEditableFormField.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import HorizontalLineSeparator from 'src/components/layout/HorizontalLineSeparator.svelte';\n  import DelimitedTruncatedContent from 'src/components/layout/DelimitedTruncatedContent.svelte';\n  import InlineTextDropdownList from '../../../components/inputs/InlineTextDropdownList.svelte';\n  import ActorMovement from '../actor/ActorMovement.svelte';\n  import AcShieldVehicle from '../actor/AcShieldVehicle.svelte';\n  import VerticalLineSeparator from 'src/components/layout/VerticalLineSeparator.svelte';\n  import AttributeBlock from '../actor/AttributeBlock.svelte';\n  import SheetMenu from '../actor/SheetMenu.svelte';\n  import { settings } from 'src/settings/settings.svelte';\n  import ActorWarnings from '../actor/ActorWarnings.svelte';\n  import InlineSource from '../shared/InlineSource.svelte';\n  import ActorOriginSummaryConfigFormApplication from 'src/applications/actor-origin-summary/ActorOriginSummaryConfigFormApplication.svelte';\n  import ActorName from '../actor/ActorName.svelte';\n  import { getVehicleSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let selectedTabId: string = $state('');\n\n  let context = $derived(getVehicleSheetContext());\n\n  let sizes = $derived(\n    Object.entries(context.config.actorSizes).map(\n      ([key, size]: [string, any]) => ({\n        value: key,\n        text: size.label,\n      }),\n    ) satisfies DropdownListOption[],\n  );\n\n  let currentSize: DropdownListOption = $derived({\n    value: context.system.traits.size,\n    text: context.config.actorSizes[context.system.traits.size]?.label,\n  });\n\n  let vehicleTypes = $derived(\n    Object.entries(context.config.vehicleTypes).map(\n      ([key, label]: [string, any]) => ({\n        value: key,\n        text: label,\n      }),\n    ) satisfies DropdownListOption[],\n  );\n\n  let currentVehicleType: DropdownListOption = $derived({\n    value: context.system.vehicleType,\n    text: context.config.vehicleTypes[context.system.vehicleType],\n  });\n\n  let abilities = $derived(Object.entries<any>(context.abilities));\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n{#if context.viewableWarnings.length}\n  <ActorWarnings warnings={context.viewableWarnings} />\n{/if}\n<header>\n  <div class=\"flex-0\">\n    <VehicleProfile />\n  </div>\n  <div class=\"flex-grow-1\">\n    <div\n      class=\"actor-name-row flex-row justify-content-space-between align-items-center small-gap\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n    >\n      <div\n        class=\"actor-name\"\n        data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n      >\n        <ActorName />\n      </div>\n      <SheetMenu defaultSettingsTab={CONSTANTS.TAB_USER_SETTINGS_VEHICLES} />\n    </div>\n    <HorizontalLineSeparator\n      borderColor=\"light\"\n      class=\"header-line-margin-left\"\n    />\n    <div class=\"origin-summary\">\n      <div class=\"flex-row extra-small-gap\">\n        {#if context.editable}\n          <InlineTextDropdownList\n            options={sizes}\n            selected={currentSize}\n            onOptionClicked={(option) =>\n              context.actor.update({\n                'system.traits.size': option.value,\n              })}\n            title={localize('DND5E.Size')}\n          />\n        {:else}\n          <span title={localize('DND5E.Size')}>{currentSize.text}</span>\n        {/if}\n      </div>\n      <span>&#8226;</span>\n      <div class=\"flex-row extra-small-gap\">\n        {#if context.editable}\n          <InlineTextDropdownList\n            options={vehicleTypes}\n            selected={currentVehicleType}\n            onOptionClicked={(option) =>\n              context.actor.update({\n                'system.vehicleType': option,\n              })}\n            title={localize('DND5E.VehicleType')}\n          />\n        {:else}\n          <span title={localize('DND5E.VehicleType')}\n            >{currentVehicleType.text}</span\n          >\n        {/if}\n      </div>\n      <span>&#8226;</span>\n      {#key context.lockSensitiveFields}\n        <DelimitedTruncatedContent cssClass=\"flex-1\">\n          <ContentEditableFormField\n            element=\"span\"\n            document={context.actor}\n            field=\"system.traits.dimensions\"\n            value={context.system.traits.dimensions}\n            title={context.system.traits.dimensions}\n            editable={context.editable && !context.lockSensitiveFields}\n            placeholder={localize('DND5E.Dimensions')}\n            selectOnFocus={true}\n          />\n          <InlineSource\n            document={context.actor}\n            keyPath=\"system.source\"\n            editable={context.unlocked}\n          />\n        </DelimitedTruncatedContent>\n      {/key}\n      <div class=\"flex-row align-items-center extra-small-gap\">\n        {#if context.editable && !context.lockSensitiveFields}\n          <button\n            type=\"button\"\n            onclick={() =>\n              new ActorOriginSummaryConfigFormApplication(context.actor).render(\n                true,\n              )}\n            class=\"origin-summary-tidy inline-icon-button\"\n            title={localize('TIDY5E.OriginSummaryConfig')}\n            tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n          >\n            <i class=\"fas fa-cog\"></i>\n          </button>\n        {/if}\n      </div>\n    </div>\n    <HorizontalLineSeparator\n      borderColor=\"light\"\n      class=\"header-line-margin-left\"\n    />\n    <ActorMovement class=\"header-line-margin\" />\n    <HorizontalLineSeparator\n      borderColor=\"light\"\n      class=\"header-line-margin-left\"\n    />\n    <section class=\"actor-stats\">\n      <AcShieldVehicle />\n      {#each abilities as [id, ability]}\n        <VerticalLineSeparator />\n        <div>\n          <AttributeBlock\n            {id}\n            {ability}\n            useConfigurationOption={false}\n            useSavingThrowProficiency={false}\n          />\n        </div>\n      {/each}\n    </section>\n  </div>\n</header>\n<Tabs tabs={context.tabs} bind:selectedTabId sheet={context.actor.sheet}>\n  {#snippet tabEnd()}\n    {#if context.editable}\n      <SheetEditModeToggle\n        hint={settings.value.permanentlyUnlockVehicleSheetForGm &&\n        FoundryAdapter.userIsGm()\n          ? localize(\n              'TIDY5E.Settings.value.PermanentlyUnlockVehicleSheetForGM.title',\n            )\n          : null}\n      />\n    {/if}\n  {/snippet}\n</Tabs>\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n\n<style lang=\"scss\">\n  header {\n    display: flex;\n    flex-direction: row;\n    gap: 1rem;\n    justify-content: center;\n    padding: 0.625rem 1rem 1rem 1rem;\n    background: var(--t5e-header-background);\n\n    .actor-name-row {\n      margin-bottom: 0.125rem;\n    }\n\n    .origin-summary {\n      margin-left: 0.25rem;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      gap: 0.25rem;\n      font-size: 0.75rem;\n      line-height: 1rem;\n      padding: 0.1875rem 0 0.125rem 0;\n    }\n  }\n\n  .tidy-sheet-body {\n    :global(.item-table-cell:not(.primary) input) {\n      text-align: center;\n    }\n\n    :global(.item-table-cell input) {\n      height: 1.5rem;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import RerenderAfterFormSubmission from 'src/components/utility/RerenderAfterFormSubmission.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import SheetEditor from '../../../components/editor/SheetEditor.svelte';\n  import LimitedHeader from '../actor/LimitedHeader.svelte';\n  import { getVehicleSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getVehicleSheetContext());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"limited-vehicle\">\n  <LimitedHeader rounded={context.useRoundedPortraitStyle} />\n  <section class=\"tidy-sheet-body\">\n    <div class=\"note-entries\">\n      <RerenderAfterFormSubmission\n        andOnValueChange={context.system.details.biography.value}\n      >\n        <article class=\"biography-notes\" use:context.activateEditors>\n          <div class=\"section-titles\">\n            {localize('DND5E.Description')}\n          </div>\n          <SheetEditor\n            content={context.biographyHTML}\n            target=\"system.details.biography.value\"\n            editable={context.editable}\n          />\n        </article>\n      </RerenderAfterFormSubmission>\n    </div>\n  </section>\n</div>\n\n<style lang=\"scss\">\n  .limited-vehicle {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n  }\n\n  .tidy-sheet-body {\n    flex: 1;\n    margin-right: 1rem;\n    display: flex;\n\n    .note-entries {\n      height: 100%;\n      display: flex;\n      flex-direction: row;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import type { VehicleSheetContext } from 'src/types/types';\n  import VehicleSheetFull from './VehicleSheetFull.svelte';\n  import VehicleSheetLimited from './VehicleSheetLimited.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getSheetContext<VehicleSheetContext>());\n</script>\n\n{#if context.showLimitedSheet}\n  <VehicleSheetLimited />\n{:else}\n  <VehicleSheetFull />\n{/if}\n","import { CONSTANTS } from \"src/constants\";\n\nexport function getInheritedClassByName(obj: any, className: string) {\n  let proto = obj.__proto__;\n  for (let i = 0; i < 42; i++) {\n    if (proto.constructor.name === className) {\n      return proto;\n    }\n    proto = proto.__proto__;\n  }\n  return false;\n}\n\nexport function getBaseActorSheet5e(obj: any) {\n  return getInheritedClassByName(obj, CONSTANTS.CLASS_ACTOR_SHEET_5E);\n}\n","import { CONSTANTS } from 'src/constants';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { settings } from 'src/settings/settings.svelte';\nimport type {\n  SheetExpandedItemsCacheable,\n  SheetStats,\n  SheetTabCacheable,\n  ExpandedItemData,\n  ExpandedItemIdToLocationsMap,\n  VehicleSheetContext,\n  Utilities,\n  MessageBus,\n  SearchFilterCacheable,\n  VehicleCargoSection,\n  VehicleFeatureSection,\n  SimpleEditableColumn,\n  VehicleItemContext,\n} from 'src/types/types';\nimport VehicleSheet from './vehicle/VehicleSheet.svelte';\nimport { initTidy5eContextMenu } from 'src/context-menu/tidy5e-context-menu';\nimport {\n  applySheetAttributesToWindow,\n  applyMutableSettingAttributesToWindow,\n  applyTitleToWindow,\n  blurUntabbableButtonsOnClick,\n  maintainCustomContentInputFocus,\n} from 'src/utils/applications.svelte';\nimport { mount, unmount } from 'svelte';\nimport { debug } from 'src/utils/logging';\nimport type { Item5e, ItemChatData } from 'src/types/item.types';\nimport { VehicleSheetRuntime } from 'src/runtime/VehicleSheetRuntime';\nimport {\n  actorUsesActionFeature,\n  getActorActionSections,\n} from 'src/features/actions/actions.svelte';\nimport { isNil } from 'src/utils/data';\nimport { CustomContentRenderer } from '../CustomContentRenderer';\nimport { getBaseActorSheet5e } from 'src/utils/class-inheritance';\nimport { ActorPortraitRuntime } from 'src/runtime/ActorPortraitRuntime';\nimport { CustomActorTraitsRuntime } from 'src/runtime/actor-traits/CustomActorTraitsRuntime';\nimport { ItemTableToggleCacheService } from 'src/features/caching/ItemTableToggleCacheService';\nimport { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\nimport { ItemFilterService } from 'src/features/filtering/ItemFilterService.svelte';\nimport { AsyncMutex } from 'src/utils/mutex';\nimport { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\nimport { Tidy5eBaseActorSheet } from './Tidy5eBaseActorSheet.svelte';\nimport { DocumentTabSectionConfigApplication } from 'src/applications/section-config/DocumentTabSectionConfigApplication.svelte';\nimport { SheetSections } from 'src/features/sections/SheetSections';\nimport { TidyFlags } from 'src/foundry/TidyFlags';\nimport { TidyHooks } from 'src/foundry/TidyHooks';\nimport { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\nimport { Container } from 'src/features/containers/Container';\nimport { Activities } from 'src/features/activities/activities';\nimport type { Activity5e } from 'src/foundry/dnd5e.types';\nimport { CoarseReactivityProvider } from 'src/features/reactivity/CoarseReactivityProvider.svelte';\nimport AttachedInfoCard from 'src/components/info-card/AttachedInfoCard.svelte';\nimport { ExpansionTracker } from 'src/features/expand-collapse/ExpansionTracker.svelte';\n\nexport class Tidy5eVehicleSheet\n  extends dnd5e.applications.actor.ActorSheet5eVehicle\n  implements\n    SheetTabCacheable,\n    SheetExpandedItemsCacheable,\n    SearchFilterCacheable\n{\n  context = new CoarseReactivityProvider<VehicleSheetContext | undefined>(\n    undefined\n  );\n  stats = $state<SheetStats>({\n    lastSubmissionTime: null,\n  });\n  currentTabId: string;\n  expandedItems: ExpandedItemIdToLocationsMap = new Map<string, Set<string>>();\n  expandedItemData: ExpandedItemData = new Map<string, ItemChatData>();\n  inlineToggleService = new InlineToggleService();\n  itemTableTogglesCache: ItemTableToggleCacheService;\n  itemFilterService: ItemFilterService;\n  messageBus = $state<MessageBus>({ message: undefined });\n  sectionExpansionTracker = new ExpansionTracker(\n    true,\n    CONSTANTS.LOCATION_SECTION\n  );\n\n  constructor(...args: any[]) {\n    super(...args);\n\n    this.itemTableTogglesCache = new ItemTableToggleCacheService({\n      userId: game.user.id,\n      documentId: this.actor.id,\n    });\n\n    this.itemFilterService = new ItemFilterService({}, this.actor);\n\n    this.currentTabId = settings.value.initialVehicleSheetTab;\n  }\n\n  get template() {\n    return FoundryAdapter.getTemplate('empty-form-template.hbs');\n  }\n\n  static get defaultOptions() {\n    const { width, height } =\n      SheetPreferencesService.getByType(CONSTANTS.SHEET_TYPE_VEHICLE) ?? {};\n\n    return FoundryAdapter.mergeObject(super.defaultOptions, {\n      classes: [\n        CONSTANTS.MODULE_ID,\n        'sheet',\n        'actor',\n        CONSTANTS.SHEET_TYPE_VEHICLE,\n        CONSTANTS.SHEET_LAYOUT_CLASSIC,\n        'app-v1',\n      ],\n      width: width ?? 740,\n      height: height ?? 810,\n      scrollY: ['[data-tidy-track-scroll-y]', '.scroll-container'],\n    });\n  }\n\n  component: Record<string, any> | undefined;\n  additionalComponents: Record<string, any>[] = [];\n  _effectCleanup?: () => void;\n  activateListeners(html: { get: (index: 0) => HTMLElement }) {\n    // Document Apps Reactivity\n    game.user.apps[this.id] = this;\n\n    // Sheet effects\n    let first = true;\n\n    this._effectCleanup = $effect.root(() => {\n      $effect(() => {\n        if (first) return;\n        applyMutableSettingAttributesToWindow(\n          settings.value,\n          this.element.get(0)\n        );\n        this.render();\n      });\n\n      $effect(() => {\n        debug('Message bus message received', {\n          app: this,\n          actor: this.actor,\n          message: this.messageBus,\n        });\n      });\n    });\n\n    first = false;\n\n    const node = html.get(0);\n\n    this.component = mount(VehicleSheet, {\n      target: node,\n      context: new Map<any, any>([\n        [CONSTANTS.SVELTE_CONTEXT.APP_ID, this.appId],\n        [CONSTANTS.SVELTE_CONTEXT.CONTEXT, this.context],\n        [CONSTANTS.SVELTE_CONTEXT.MESSAGE_BUS, this.messageBus],\n        [CONSTANTS.SVELTE_CONTEXT.STATS, this.stats],\n        [\n          CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n          this.inlineToggleService,\n        ],\n        [CONSTANTS.SVELTE_CONTEXT.ITEM_FILTER_SERVICE, this.itemFilterService],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_FILTER,\n          this.itemFilterService.onFilter.bind(this.itemFilterService),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_FILTER_CLEAR_ALL,\n          this.itemFilterService.onFilterClearAll.bind(this.itemFilterService),\n        ],\n        [CONSTANTS.SVELTE_CONTEXT.CURRENT_TAB_ID, this.currentTabId],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_TAB_SELECTED,\n          this.onTabSelected.bind(this),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_ITEM_TOGGLED,\n          this.onItemToggled.bind(this),\n        ],\n        [CONSTANTS.SVELTE_CONTEXT.LOCATION, ''],\n        [CONSTANTS.SVELTE_CONTEXT.EXPANDED_ITEMS, new Map(this.expandedItems)],\n        [\n          CONSTANTS.SVELTE_CONTEXT.EXPANDED_ITEM_DATA,\n          new Map(this.expandedItemData),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ITEM_TABLE_TOGGLES,\n          new Map(this.itemTableTogglesCache.itemTableToggles),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_ITEM_TABLE_TOGGLE,\n          this.itemTableTogglesCache.onItemTableToggle.bind(\n            this.itemTableTogglesCache\n          ),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.SECTION_EXPANSION_TRACKER,\n          this.sectionExpansionTracker,\n        ],\n      ]),\n    });\n\n    const infoCard = mount(AttachedInfoCard, {\n      target: node,\n      props: {\n        sheet: this,\n      },\n    });\n\n    this.additionalComponents.push(infoCard);\n\n    initTidy5eContextMenu(this, html);\n  }\n\n  async getData(options = {}) {\n    const defaultDocumentContext = await super.getData(this.options);\n\n    Tidy5eBaseActorSheet.applyCommonContext(defaultDocumentContext);\n\n    const unlocked =\n      FoundryAdapter.isSheetUnlocked(this.actor) &&\n      defaultDocumentContext.editable;\n\n    const vehiclePreferences = SheetPreferencesService.getByType(\n      this.actor.type\n    );\n\n    const actionListSortMode =\n      vehiclePreferences.tabs?.[CONSTANTS.TAB_ACTOR_ACTIONS]?.sort ?? 'm';\n\n    const utilities: Utilities<VehicleSheetContext> = {\n      [CONSTANTS.TAB_ACTOR_ACTIONS]: {\n        utilityToolbarCommands: [\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeAlpha'),\n            iconClass: 'fa-solid fa-arrow-down-a-z fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_ACTIONS,\n                'sort',\n                'm'\n              );\n            },\n            visible: actionListSortMode === 'a',\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.SortMode.ActionListDefault'),\n            iconClass: 'fa-solid fa-arrow-down-short-wide fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_ACTIONS,\n                'sort',\n                'a'\n              );\n            },\n            visible: actionListSortMode === 'm',\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.ExpandAll'),\n            iconClass: 'fas fa-angles-down',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_ACTIONS,\n                true\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.CollapseAll'),\n            iconClass: 'fas fa-angles-up',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_ACTIONS,\n                false\n              ),\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Utilities.ConfigureSections'\n            ),\n            iconClass: 'fas fa-cog',\n            execute: ({ context, sections }) => {\n              new DocumentTabSectionConfigApplication({\n                document: context.actor,\n                sections: sections,\n                tabId: CONSTANTS.TAB_ACTOR_ACTIONS,\n                tabTitle: VehicleSheetRuntime.getTabTitle(\n                  CONSTANTS.TAB_ACTOR_ACTIONS\n                ),\n              }).render(true);\n            },\n          },\n        ],\n      },\n    };\n\n    const context: VehicleSheetContext = {\n      ...defaultDocumentContext,\n      actions: await getActorActionSections(this.actor),\n      activateEditors: (node, options) =>\n        FoundryAdapter.activateEditors(node, this, options?.bindSecrets),\n      actorPortraitCommands:\n        ActorPortraitRuntime.getEnabledPortraitMenuCommands(this.actor),\n      allowEffectsManagement: true,\n      appId: this.appId,\n      customActorTraits: CustomActorTraitsRuntime.getEnabledTraits(\n        defaultDocumentContext\n      ),\n      customContent: await VehicleSheetRuntime.getContent(\n        defaultDocumentContext\n      ),\n      document: this.document,\n      filterData: this.itemFilterService.getDocumentItemFilterData(),\n      filterPins: ItemFilterRuntime.defaultFilterPins[this.actor.type],\n      useClassicControls: settings.value.useClassicControlsForVehicle,\n      editable: defaultDocumentContext.editable,\n      healthPercentage: this.actor.system.attributes.hp.pct.toNearest(0.1),\n      lockExpChanges: FoundryAdapter.shouldLockExpChanges(),\n      lockHpMaxChanges: FoundryAdapter.shouldLockHpMaxChanges(),\n      lockItemQuantity: FoundryAdapter.shouldLockItemQuantity(),\n      lockLevelSelector: FoundryAdapter.shouldLockLevelSelector(),\n      lockMoneyChanges: FoundryAdapter.shouldLockMoneyChanges(),\n      lockSensitiveFields:\n        (!unlocked && settings.value.useTotalSheetLock) ||\n        !defaultDocumentContext.editable,\n      modernRules: FoundryAdapter.checkIfModernRules(this.actor),\n      owner: this.actor.isOwner,\n      showLimitedSheet: FoundryAdapter.showLimitedSheet(this.actor),\n      tabs: [],\n      unlocked: unlocked,\n      useActionsFeature: actorUsesActionFeature(this.actor),\n      useRoundedPortraitStyle: [\n        CONSTANTS.CIRCULAR_PORTRAIT_OPTION_ALL as string,\n        CONSTANTS.CIRCULAR_PORTRAIT_OPTION_NPCVEHICLE as string,\n      ].includes(settings.value.useCircularPortraitStyle),\n      utilities: utilities,\n      viewableWarnings:\n        defaultDocumentContext.warnings?.filter(\n          (w: any) => !isNil(w.message?.trim(), '')\n        ) ?? [],\n    };\n\n    for (const item of context.items) {\n      const ctx = context.itemContext[item.id];\n      if (item.type === CONSTANTS.ITEM_TYPE_CONTAINER) {\n        ctx.containerContents = await Container.getContainerContents(item);\n      }\n    }\n\n    let tabs = await VehicleSheetRuntime.getTabs(context);\n\n    const selectedTabs = TidyFlags.selectedTabs.get(context.actor);\n\n    if (selectedTabs?.length) {\n      tabs = tabs\n        .filter((t) => selectedTabs?.includes(t.id))\n        .sort(\n          (a, b) => selectedTabs.indexOf(a.id) - selectedTabs.indexOf(b.id)\n        );\n    } else {\n      const defaultTabs = settings.value.defaultVehicleSheetTabs;\n      tabs = tabs\n        .filter((t) => defaultTabs?.includes(t.id))\n        .sort((a, b) => defaultTabs.indexOf(a.id) - defaultTabs.indexOf(b.id));\n    }\n\n    context.tabs = tabs;\n\n    debug('Vehicle Sheet context data', context);\n\n    return context;\n  }\n\n  protected _prepareItems(context: VehicleSheetContext) {\n    // TODO: Replace with Tidy Column Selection implementation\n    const cargoColumns: SimpleEditableColumn[] = [\n      {\n        label: game.i18n.localize('DND5E.Quantity'),\n        css: 'item-qty',\n        property: 'quantity',\n        editable: 'Number',\n      },\n    ];\n\n    // TODO: Replace with Tidy Column Selection implementation\n    const equipmentColumns: SimpleEditableColumn[] = [\n      {\n        label: game.i18n.localize('DND5E.Quantity'),\n        css: 'item-qty',\n        property: 'system.quantity',\n        editable: 'Number',\n      },\n      {\n        label: game.i18n.localize('DND5E.AC'),\n        css: 'item-ac',\n        property: 'system.armor.value',\n      },\n      {\n        label: game.i18n.localize('DND5E.HP'),\n        css: 'item-hp',\n        property: 'system.hp.value',\n        maxProperty: 'system.hp.max',\n        editable: 'Number',\n      },\n      {\n        label: game.i18n.localize('DND5E.Threshold'),\n        css: 'item-threshold',\n        property: 'threshold',\n      },\n    ];\n\n    const features: Record<string, VehicleFeatureSection> = {\n      actions: {\n        label: game.i18n.localize('DND5E.ActionPl'),\n        items: [],\n        hasActions: true,\n        crewable: true,\n        key: 'actions',\n        dataset: { type: 'feat' },\n        columns: [\n          {\n            label: game.i18n.localize('DND5E.Cover'),\n            css: 'item-cover',\n            property: 'cover',\n          },\n        ],\n        show: true,\n      },\n      equipment: {\n        label: game.i18n.localize(CONFIG.Item.typeLabels.equipment),\n        items: [],\n        crewable: true,\n        dataset: { type: 'equipment', 'system.type.value': 'vehicle' },\n        columns: equipmentColumns,\n        key: 'equipment',\n        show: true,\n      },\n      passive: {\n        label: game.i18n.localize('DND5E.Features'),\n        items: [],\n        dataset: { type: 'feat' },\n        key: 'passive',\n        show: true,\n      },\n      reactions: {\n        label: game.i18n.localize('DND5E.ReactionPl'),\n        items: [],\n        dataset: { type: 'feat' },\n        key: 'reactions',\n        show: true,\n      },\n      weapons: {\n        label: game.i18n.localize(`${CONFIG.Item.typeLabels.weapon}Pl`),\n        items: [],\n        crewable: true,\n        dataset: { type: 'weapon', 'system.weaponType': 'siege' },\n        columns: equipmentColumns,\n        key: 'weapons',\n        show: true,\n      },\n    };\n\n    context.items.forEach((item) => {\n      context.itemContext[item.id] ??= this._prepareItem(item, context);\n    });\n\n    const cargo: Record<string, VehicleCargoSection> = {\n      crew: {\n        label: game.i18n.localize('DND5E.VehicleCrew'),\n        items: context.actor.system.cargo.crew,\n        css: 'cargo-row crew',\n        editableName: true,\n        dataset: { type: 'crew' },\n        columns: cargoColumns,\n        key: 'crew',\n        show: true,\n      },\n      passengers: {\n        label: game.i18n.localize('DND5E.VehiclePassengers'),\n        items: context.actor.system.cargo.passengers,\n        css: 'cargo-row passengers',\n        editableName: true,\n        dataset: { type: 'passengers' },\n        columns: cargoColumns,\n        key: 'passengers',\n        show: true,\n      },\n      cargo: {\n        label: game.i18n.localize('DND5E.VehicleCargo'),\n        items: [],\n        dataset: { type: 'loot' },\n        columns: [\n          {\n            label: game.i18n.localize('DND5E.Quantity'),\n            css: 'item-qty',\n            property: 'system.quantity',\n            editable: 'Number',\n          },\n          {\n            label: game.i18n.localize('DND5E.Price'),\n            css: 'item-price',\n            property: 'system.price.value',\n            editable: 'Number',\n          },\n          {\n            label: game.i18n.localize('DND5E.Weight'),\n            css: 'item-weight',\n            property: 'system.weight.value',\n            editable: 'Number',\n          },\n        ],\n        key: 'cargo',\n        show: true,\n      },\n    };\n\n    const baseUnits =\n      CONFIG.DND5E.encumbrance.baseUnits[\n        this.actor.type as keyof typeof CONFIG.DND5E.encumbrance.baseUnits\n      ] ?? CONFIG.DND5E.encumbrance.baseUnits.default;\n    const units = game.settings.get('dnd5e', 'metricWeightUnits')\n      ? baseUnits.metric\n      : baseUnits.imperial;\n\n    // Classify items owned by the vehicle and compute total cargo weight\n    let totalWeight = 0;\n    for (const item of context.items) {\n      const ctx = (context.itemContext[item.id] ??= {});\n      this._prepareCrewedItem(item, ctx);\n\n      // Handle cargo explicitly\n      const isCargo = item.flags.dnd5e?.vehicleCargo === true;\n      if (isCargo) {\n        totalWeight += item.system.totalWeightin?.(units) ?? 0;\n        cargo.cargo.items.push(item);\n        continue;\n      }\n\n      // Handle non-cargo item types\n      switch (item.type) {\n        case 'weapon':\n          features.weapons.items.push(item);\n          break;\n        case 'equipment':\n          features.equipment.items.push(item);\n          break;\n        case 'feat':\n          // TODO: Determine the best way to delineate active, passive, and reaction-based item sections.\n          const firstActivityActivationType =\n            item.system.activities?.contents[0]?.activation?.type;\n          if (\n            !firstActivityActivationType ||\n            firstActivityActivationType === 'none'\n          ) {\n            features.passive.items.push(item);\n          } else if (firstActivityActivationType === 'reaction') {\n            features.reactions.items.push(item);\n          } else {\n            features.actions.items.push(item);\n          }\n          break;\n        default:\n          totalWeight += item.system.totalWeightIn?.(units) ?? 0;\n          cargo.cargo.items.push(item);\n      }\n    }\n\n    // Update the rendering context data\n    context.features = Object.values(features);\n    context.cargo = Object.values(cargo);\n    context.encumbrance = context.system.attributes.encumbrance;\n  }\n\n  _prepareItem(item: Item5e, context: VehicleSheetContext): VehicleItemContext {\n    const { uses } = item.system;\n    const ctx: VehicleItemContext = {};\n    ctx.canToggle = false;\n    ctx.hasUses = uses && uses.max > 0;\n    // Activities\n    ctx.activities = Activities.getVisibleActivities(\n      item,\n      item.system.activities\n    )?.map(Activities.getActivityItemContext);\n    return ctx;\n  }\n\n  /**\n   * Prepare items that are mounted to a vehicle and require one or more crew to operate.\n   * @param {object} item     Copy of the item data being prepared for display.\n   * @param {object} context  Display context for the item.\n   * @protected\n   */\n  _prepareCrewedItem(item: Item5e, context: VehicleItemContext) {\n    // Determine crewed status\n    const isCrewed = item.system.crewed;\n    context.toggleClass = isCrewed ? 'active' : '';\n    context.toggleTitle = game.i18n.localize(\n      `DND5E.${isCrewed ? 'Crewed' : 'Uncrewed'}`\n    );\n\n    // Handle crew actions\n    if (item.type === 'feat' && item.system.activation.type === 'crew') {\n      if (item.system.cover === 1) {\n        context.cover = game.i18n.localize('DND5E.CoverTotal');\n      } else if (item.system.cover === 0.5) {\n        context.cover = '';\n      } else if (item.system.cover === 0.75) {\n        context.cover = '';\n      } else {\n        context.cover = '';\n      }\n    }\n\n    // Prepare vehicle weapons\n    if (item.type === 'equipment' || item.type === 'weapon') {\n      context.threshold = item.system.hp?.dt ? item.system.hp.dt : '';\n    }\n  }\n\n  private async setExpandedItemData() {\n    this.expandedItemData.clear();\n    for (const id of this.expandedItems.keys()) {\n      const item = this.actor.items.get(id);\n      if (item) {\n        this.expandedItemData.set(\n          id,\n          await item.getChatData({ secrets: this.actor.isOwner })\n        );\n      }\n    }\n  }\n\n  async _renderOuter() {\n    const html = await super._renderOuter();\n    if (!game.user.isGM && this.actor.limited) return html;\n    const header = html[0].querySelector('.window-header');\n\n    // Preparation warnings.\n    const warnings = document.createElement('a');\n    warnings.classList.add('preparation-warnings');\n    warnings.dataset.tooltip = 'Warnings';\n    warnings.setAttribute('aria-label', game.i18n.localize('Warnings'));\n    warnings.innerHTML = '<i class=\"fas fa-triangle-exclamation\"></i>';\n    warnings.addEventListener('click', this._onOpenWarnings.bind(this));\n    header\n      .querySelector('.window-title')\n      .insertAdjacentElement('afterend', warnings);\n\n    return html;\n  }\n\n  /**\n   * Handle opening the warnings dialog.\n   * @param {PointerEvent} event  The triggering event.\n   * @protected\n   */\n  _onOpenWarnings(event: MouseEvent) {\n    event.stopImmediatePropagation();\n    // @ts-expect-error\n    const { top, left, height } = event.currentTarget!.getBoundingClientRect();\n    const { clientWidth } = document.documentElement;\n    const dialog = this.form.querySelector('dialog.warnings');\n    Object.assign(dialog.style, {\n      top: `${top + height}px`,\n      left: `${Math.min(left - 16, clientWidth - 300)}px`,\n    });\n    dialog.showModal();\n  }\n\n  /**\n   * A boolean which gates double-rendering and prevents a second\n   * colliding render from triggering an infamous\n   * \"One of original or other are not Objects!\" error.\n   */\n  private tidyRendering = false;\n\n  render(...args: unknown[]) {\n    debug('Sheet render begin');\n    this.tidyRendering = true;\n    super.render(...args);\n\n    const [warnings] = this.element.find(\n      '.window-header .preparation-warnings'\n    );\n    warnings?.toggleAttribute(\n      'hidden',\n      !this.actor._preparationWarnings?.length\n    );\n  }\n\n  private _renderMutex = new AsyncMutex();\n  async _render(force?: boolean, options = {}) {\n    await this._renderMutex.lock(async () => {\n      const doubleRenderDetected =\n        this.options.token && this.tidyRendering === false;\n\n      if (doubleRenderDetected) {\n        return;\n      }\n\n      await this._renderSheet(force, options);\n    });\n    this.tidyRendering = false;\n    debug('Sheet render end');\n  }\n\n  private async _renderSheet(force?: boolean, options = {}) {\n    await this.setExpandedItemData();\n    const data = await this.getData();\n    SheetSections.accountForExternalSections(['features'], data);\n    this.context.data = data;\n\n    if (force) {\n      const { width, height } =\n        SheetPreferencesService.getByType(CONSTANTS.SHEET_TYPE_VEHICLE) ?? {};\n      this.position = {\n        ...this.position,\n        width: width ?? this.position.width,\n        height: height ?? this.position.height,\n      };\n\n      this._saveScrollPositions(this.element);\n      this._destroySvelteComponent();\n      await super._render(force, options);\n      applySheetAttributesToWindow(\n        this.actor.documentName,\n        this.actor.uuid,\n        this.actor.type,\n        this.element.get(0)\n      );\n      await this.renderCustomContent({ data, isFullRender: true });\n      TidyHooks.tidy5eSheetsRenderActorSheet(\n        this,\n        this.element.get(0),\n        data,\n        true\n      );\n      CustomContentRenderer.wireCompatibilityEventListeners(\n        this.element,\n        super.activateListeners,\n        this\n      );\n      blurUntabbableButtonsOnClick(this.element.get(0));\n      return;\n    }\n\n    await maintainCustomContentInputFocus(this, async () => {\n      applyTitleToWindow(this.title, this.element.get(0));\n      await this.renderCustomContent({ data, isFullRender: false });\n      TidyHooks.tidy5eSheetsRenderActorSheet(\n        this,\n        this.element.get(0),\n        data,\n        false\n      );\n      CustomContentRenderer.wireCompatibilityEventListeners(\n        this.element,\n        super.activateListeners,\n        this\n      );\n    });\n  }\n\n  private async renderCustomContent(args: {\n    data: VehicleSheetContext;\n    isFullRender: boolean;\n  }) {\n    await CustomContentRenderer.render({\n      app: this,\n      customContent: args.data.customContent,\n      data: args.data,\n      element: this.element,\n      isFullRender: args.isFullRender,\n      superActivateListeners: super.activateListeners,\n      tabs: args.data.tabs,\n    });\n  }\n\n  _getHeaderButtons() {\n    const buttons = super._getHeaderButtons();\n    return FoundryAdapter.removeConfigureSettingsButtonWhenLockedForNonGm(\n      buttons\n    );\n  }\n\n  _destroySvelteComponent() {\n    if (this.component) {\n      unmount(this.component);\n    }\n    this.component = undefined;\n\n    this.additionalComponents.forEach((c) => unmount(c));\n    this.additionalComponents = [];\n  }\n\n  _saveScrollPositions(html: any) {\n    if (html.length && this.component) {\n      const save = super._saveScrollPositions(html);\n      debug('Saved scroll positions', this._scrollPositions);\n      return save;\n    }\n  }\n\n  async _onDropSingleItem(itemData: any, event: DragEvent) {\n    const cargoTypes = [\n      'weapon',\n      'equipment',\n      'consumable',\n      'tool',\n      'loot',\n      'container',\n    ];\n    const isCargo =\n      cargoTypes.includes(itemData.type) &&\n      this.currentTabId === CONSTANTS.TAB_VEHICLE_CARGO_AND_CREW;\n    foundry.utils.setProperty(itemData, 'flags.dnd5e.vehicleCargo', isCargo);\n\n    // Create a Consumable spell scroll on the Inventory tab\n    if (itemData.type === 'spell') {\n      const options: Record<string, unknown> = {};\n\n      if (settings.value.includeFlagsInSpellScrollCreation) {\n        options.flags = itemData.flags;\n      }\n\n      const scroll = await dnd5e.documents.Item5e.createScrollFromSpell(\n        itemData,\n        options\n      );\n\n      return scroll.toObject();\n    }\n\n    if (itemData.type === 'consumable') {\n      return super._onDropSingleItem(itemData, event);\n    }\n\n    // Skip the default vehicle sheet handler, as we are handling all use cases.\n    const baseActor5eClass = getBaseActorSheet5e(this);\n    if (baseActor5eClass) {\n      return baseActor5eClass._onDropSingleItem.call(this, itemData, event);\n    }\n  }\n\n  close(options: unknown = {}) {\n    this._effectCleanup?.();\n    this._destroySvelteComponent();\n    delete game.user.apps[this.id];\n    return super.close(options);\n  }\n\n  async _onSubmit(...args: any[]) {\n    await super._onSubmit(...args);\n    this.stats.lastSubmissionTime = new Date();\n  }\n\n  _disableFields(...args: any[]) {\n    debug('Ignoring call to disable fields. Delegating to Tidy Sheets...');\n  }\n\n  _onResize(event: any) {\n    super._onResize(event);\n    const { width, height } = this.position;\n    SheetPreferencesService.setDocumentTypePreference(\n      CONSTANTS.SHEET_TYPE_VEHICLE,\n      'width',\n      width\n    );\n    SheetPreferencesService.setDocumentTypePreference(\n      CONSTANTS.SHEET_TYPE_VEHICLE,\n      'height',\n      height\n    );\n  }\n\n  /* -------------------------------------------- */\n  /* SheetTabCacheable\n  /* -------------------------------------------- */\n\n  onTabSelected(tabId: string) {\n    this.currentTabId = tabId;\n  }\n\n  /* -------------------------------------------- */\n  /* SheetExpandedItemsCacheable\n  /* -------------------------------------------- */\n\n  onItemToggled(itemId: string, isVisible: boolean, location: string) {\n    const locationSet =\n      this.expandedItems.get(itemId) ??\n      this.expandedItems.set(itemId, new Set<string>()).get(itemId);\n\n    if (isVisible) {\n      locationSet?.add(location);\n    } else {\n      locationSet?.delete(location);\n    }\n\n    debug('Item Toggled', {\n      expandedItems: this.expandedItems,\n    });\n  }\n\n  /* -------------------------------------------- */\n  /* SearchFilterCacheable\n  /* -------------------------------------------- */\n\n  onSearch(location: string, text: string): void {\n    debug('Searched', {\n      location,\n      text,\n    });\n    this.searchFilters.set(location, text);\n  }\n}\n","<script lang=\"ts\">\n  import { getItemSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getItemSheetContext());\n</script>\n\n<h2>Item Type Not Found</h2>\n\n<p>\n  The item type <code>{context.item.type}</code> does not have a sheet in Tidy\n  5e Sheets. Please request any item type sheets in an issue on the\n  <a\n    target=\"_blank\"\n    href=\"https://github.com/kgar/foundry-vtt-tidy-5e-sheets/issues\"\n    >Tidy 5e github repository</a\n  >.\n</p>\n","export function DragAndDropMixin(BaseApplication: any) {\n  class DragAndDrop extends BaseApplication {\n    #dragDrop;\n\n    constructor(...args: any[]) {\n      super(...args);\n\n      this.#dragDrop = this.#createDragDropHandlers();\n    }\n\n    /**\n     * Create drag-and-drop workflow handlers for this Application\n     * @returns {DragDrop[]}     An array of DragDrop handlers\n     * @private\n     */\n    #createDragDropHandlers(): DragDrop[] {\n      const dragDrop = this.options.dragDrop;\n\n      if (!dragDrop || !Array.isArray(dragDrop)) {\n        return [];\n      }\n\n      return Array.isArray(dragDrop)\n        ? dragDrop.map((d) => {\n            d.permissions = {\n              dragstart: this._canDragStart.bind(this),\n              drop: this._canDragDrop.bind(this),\n            };\n            d.callbacks = {\n              dragstart: this._onDragStart.bind(this),\n              dragover: this._onDragOver.bind(this),\n              drop: this._onDrop.bind(this),\n            };\n            return new DragDrop(d);\n          })\n        : [];\n    }\n\n    /** @inheritdoc */\n    _canDragStart(selector: string) {\n      return this.isEditable;\n    }\n\n    /* -------------------------------------------- */\n\n    /** @inheritdoc */\n    _canDragDrop(selector: string) {\n      return this.isEditable;\n    }\n\n    _onDragStart(event: DragEvent & { currentTarget: HTMLElement }) {}\n\n    _onDragOver(event: DragEvent & { currentTarget: HTMLElement }) {}\n\n    _onDrop(\n      event: DragEvent & { currentTarget: HTMLElement }\n    ): Promise<any> | undefined {\n      return undefined;\n    }\n\n    /**\n     * Returns an array of DragDrop instances\n     * @type {DragDrop[]}\n     */\n    get dragDrop() {\n      return this.#dragDrop;\n    }\n\n    _onRender(...args: any[]) {\n      this.#dragDrop.forEach((d: DragDrop) => d.bind(this.element));\n      super._onRender(...args);\n    }\n  }\n\n  return DragAndDrop;\n}\n","import type { CustomHeaderControlsEntry } from 'src/api/api.types';\n\nexport class ImportSheetControl {\n  static actionName = 'importFromCompendium';\n\n  static getSheetControl(): CustomHeaderControlsEntry {\n    return {\n      action: 'importFromCompendium',\n      icon: 'fas fa-download',\n      label: 'Import',\n      visible(this: any) {\n        const document = this.document;\n        return (\n          document.constructor.name !== 'Folder' &&\n          !document.isEmbedded &&\n          document.compendium &&\n          document.constructor.canUserCreate(game.user)\n        );\n      },\n      position: 'header',\n    };\n  }\n\n  static async importFromCompendium(app: any, document: any) {\n    await app.close();\n    return document.collection.importFromCompendium(\n      document.compendium,\n      document.id\n    );\n  }\n}\n","import { CONSTANTS } from 'src/constants';\nimport { SvelteApplicationMixin } from 'src/mixins/SvelteApplicationMixin.svelte';\nimport { ItemSheetRuntime } from 'src/runtime/item/ItemSheetRuntime';\nimport type {\n  ApplicationConfiguration,\n  ApplicationRenderOptions,\n} from 'src/types/application.types';\nimport type {\n  Item5e,\n  ItemDescription,\n  ItemFacilityOrdersContext,\n  ItemSheetContext as ItemSheetClassicContext,\n  ItemSheetContext,\n  UsesRecoveryData,\n} from 'src/types/item.types';\nimport TypeNotFoundSheet from './item/TypeNotFoundSheet.svelte';\nimport { mount } from 'svelte';\nimport { TidyHooks } from 'src/foundry/TidyHooks';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { TabManager } from 'src/runtime/tab/TabManager';\nimport type { GroupableSelectOption, Tab } from 'src/types/types';\nimport { getPercentage } from 'src/utils/numbers';\nimport { isNil } from 'src/utils/data';\nimport { DragAndDropMixin } from 'src/mixins/DragAndDropBaseMixin';\nimport { initTidy5eContextMenu } from 'src/context-menu/tidy5e-context-menu';\nimport { Activities } from 'src/features/activities/activities';\nimport { settings } from 'src/settings/settings.svelte';\nimport AttachedInfoCard from 'src/components/info-card/AttachedInfoCard.svelte';\nimport { ImportSheetControl } from 'src/features/sheet-header-controls/ImportSheetControl';\nimport { ExpansionTracker } from 'src/features/expand-collapse/ExpansionTracker.svelte';\n\nexport class Tidy5eItemSheetClassic extends DragAndDropMixin(\n  SvelteApplicationMixin<ItemSheetClassicContext>(\n    foundry.applications.sheets.ItemSheetV2\n  )\n) {\n  currentTabId: string | undefined = undefined;\n  sectionExpansionTracker = new ExpansionTracker(\n    true,\n    CONSTANTS.LOCATION_SECTION\n  );\n\n  constructor(...args: any[]) {\n    super(...args);\n  }\n\n  static DEFAULT_OPTIONS: Partial<\n    ApplicationConfiguration & { dragDrop: Partial<DragDropConfiguration>[] }\n  > = {\n    classes: [\n      CONSTANTS.MODULE_ID,\n      'sheet',\n      CONSTANTS.SHEET_TYPE_ITEM,\n      'app-v2',\n      CONSTANTS.SHEET_LAYOUT_CLASSIC,\n    ],\n    tag: 'form',\n    window: {\n      frame: true,\n      positioned: true,\n      resizable: true,\n      controls: [ImportSheetControl.getSheetControl()],\n    },\n    position: {\n      width: 560,\n      height: 600,\n    },\n    actions: {\n      [ImportSheetControl.actionName]: async function (this: any) {\n        await ImportSheetControl.importFromCompendium(this, this.document);\n      },\n    },\n    dragDrop: [{ dropSelector: 'form' }],\n    submitOnClose: false,\n  };\n\n  _createComponent(node: HTMLElement): Record<string, any> {\n    const sheetComponent = ItemSheetRuntime.sheets[this.item.type];\n\n    const context = new Map<any, any>([\n      [CONSTANTS.SVELTE_CONTEXT.CONTEXT, this._context],\n      [CONSTANTS.SVELTE_CONTEXT.CURRENT_TAB_ID, this.currentTabId],\n      [\n        CONSTANTS.SVELTE_CONTEXT.SECTION_EXPANSION_TRACKER,\n        this.sectionExpansionTracker,\n      ],\n    ]);\n\n    const component = sheetComponent\n      ? mount(sheetComponent.Sheet, {\n          target: node,\n          context: context,\n        })\n      : mount(TypeNotFoundSheet, {\n          target: node,\n          context: context,\n        });\n\n    // Advancement context menu\n    const contextOptions = this._getAdvancementContextMenuOptions();\n\n    const html = globalThis.$(this.element);\n\n    TidyHooks.dnd5eGetItemAdvancementContext(html, contextOptions);\n\n    if (contextOptions) {\n      FoundryAdapter.createContextMenu(\n        html,\n        '.advancement-item',\n        contextOptions\n      );\n    }\n\n    FoundryAdapter.createContextMenu(html, '.activity[data-activity-id]', [], {\n      onOpen: (target: HTMLElement) =>\n        dnd5e.documents.activity.UtilityActivity.onContextMenu(\n          this.item,\n          target\n        ),\n    });\n\n    initTidy5eContextMenu(this, html);\n\n    return component;\n  }\n\n  _createAdditionalComponents(content: HTMLElement) {\n    const infoCard = mount(AttachedInfoCard, {\n      target: content,\n      props: {\n        sheet: this,\n      },\n    });\n\n    return [infoCard];\n  }\n\n  async _prepareContext(\n    options: ApplicationRenderOptions\n  ): Promise<ItemSheetClassicContext> {\n    const rollData = this.document.getRollData();\n\n    // Enrich HTML description\n    const enrichmentOptions = {\n      secrets: this.document.isOwner,\n      relativeTo: this.item,\n      rollData: rollData,\n    };\n\n    const enriched = {\n      description: await TextEditor.enrichHTML(\n        this.document.system.description.value,\n        enrichmentOptions\n      ),\n      unidentified: await TextEditor.enrichHTML(\n        this.document.system.unidentified?.description,\n        enrichmentOptions\n      ),\n      chat: await TextEditor.enrichHTML(\n        this.document.system.description.chat,\n        enrichmentOptions\n      ),\n    };\n\n    const isIdentifiable = 'identified' in this.document.system;\n\n    const itemDescriptions: ItemDescription[] = [];\n    itemDescriptions.push({\n      enriched: enriched.description,\n      content: this.document.system.description.value,\n      field: 'system.description.value',\n      label: FoundryAdapter.localize('DND5E.Description'),\n    });\n\n    if (isIdentifiable && FoundryAdapter.userIsGm()) {\n      itemDescriptions.push({\n        enriched: enriched.unidentified,\n        content: this.document.system.unidentified.description,\n        field: 'system.unidentified.description',\n        label: FoundryAdapter.localize('DND5E.DescriptionUnidentified'),\n      });\n    }\n    itemDescriptions.push({\n      enriched: enriched.chat,\n      content: this.document.system.description.chat,\n      field: 'system.description.chat',\n      label: FoundryAdapter.localize('DND5E.DescriptionChat'),\n    });\n\n    const sourceSystem = this.item.system.toObject();\n\n    const editable = this.isEditable;\n\n    const target = this.item.type === 'spell' ? this.item.system.target : null;\n\n    const context: ItemSheetContext = {\n      activities: (this.document.system.activities ?? [])\n        .filter((a: any) => {\n          return Activities.isConfigurable(a);\n        })\n        .map(({ _id: id, name, img, sort, uuid }: any) => ({\n          id,\n          name,\n          sort,\n          uuid,\n          img: { src: img, svg: img?.endsWith('.svg') },\n        }))\n        .sort((a: any, b: any) => a.sort - b.sort),\n      affectsPlaceholder: game.i18n.localize(\n        `DND5E.TARGET.Count.${target?.template?.type ? 'Every' : 'Any'}`\n      ),\n      advancementEditable:\n        (this.advancementConfigurationMode || !this.document.isEmbedded) &&\n        editable,\n      config: CONFIG.DND5E,\n      coverOptions: Object.entries(CONFIG.DND5E.cover).map(\n        ([value, label]) => ({ value, label })\n      ),\n      customContent: [],\n      customEquipmentTypeGroups:\n        ItemSheetRuntime.getCustomEquipmentTypeGroups(),\n      data: this.document.toObject(false),\n      defaultAbility: '',\n      dimensions: target?.template?.dimensions,\n      document: this.document,\n      durationUnits: [\n        ...Object.entries(CONFIG.DND5E.specialTimePeriods).map(\n          ([value, label]) => ({ value, label })\n        ),\n        ...Object.entries(CONFIG.DND5E.scalarTimePeriods).map(\n          ([value, label]) => {\n            return { value, label, group: 'DND5E.DurationTime' };\n          }\n        ),\n        ...Object.entries(CONFIG.DND5E.permanentTimePeriods).map(\n          ([value, label]) => {\n            return { value, label, group: 'DND5E.DurationPermanent' };\n          }\n        ),\n      ],\n      editable: editable,\n      enriched,\n      isEmbedded: this.document.isEmbedded,\n      item: this.document,\n      itemDescriptions,\n      itemOverrides: new Set<string>(this._getItemOverrides()),\n      healthPercentage: getPercentage(\n        this.item?.system?.hp?.value,\n        this.item?.system?.hp?.max\n      ),\n      identifiedName: FoundryAdapter.getIdentifiedName(this.item),\n      labels: this.document.labels,\n      lockItemQuantity: FoundryAdapter.shouldLockItemQuantity(),\n      limited: this.document.limited,\n      modernRules: FoundryAdapter.checkIfModernRules(this.item),\n      options: this.options,\n      owner: this.document.isOwner,\n      scalarTarget:\n        target?.affects?.type &&\n        CONFIG.DND5E.individualTargetTypes[target.affects.type]?.scalar !==\n          false,\n      source: sourceSystem,\n      system: this.document.system,\n      tabs: [],\n      title: this.title,\n      rollData: rollData,\n      user: game.user,\n\n      // Item Type, Status, and Details\n      // @ts-expect-error\n      itemType: game.i18n.localize(CONFIG.Item.typeLabels[this.item.type]),\n      itemStatus: this._getItemStatus(),\n      baseItems: {},\n      isPhysical: this.document.system.hasOwnProperty('quantity'),\n\n      // Identified state\n      isIdentifiable: isIdentifiable,\n      isIdentified: this.document.system.identified !== false,\n\n      // Armor Class\n      hasDexModifier:\n        this.document.isArmor && this.document.system.type.value !== 'shield',\n\n      // Advancement\n      advancement: this._getItemAdvancement(this.document),\n\n      effects: dnd5e.applications.components.EffectsElement.prepareCategories(\n        this.document.effects,\n        { parent: this.item }\n      ),\n\n      concealDetails:\n        !game.user.isGM && this.document.system.identified === false,\n\n      toggleAdvancementLock: this.toggleAdvancementLock.bind(this),\n\n      rangeTypes: [\n        ...Object.entries(CONFIG.DND5E.rangeTypes).map(([value, label]) => ({\n          value,\n          label,\n        })),\n        ...Object.entries(CONFIG.DND5E.movementUnits).map(([value, config]) => {\n          return { value, label: config.label, group: 'DND5E.RangeDistance' };\n        }),\n      ],\n\n      activationTypes: [\n        ...Object.entries(CONFIG.DND5E.activityActivationTypes).map(\n          // @ts-ignore\n          ([value, { label, group }]) => {\n            return { value, label, group: group ?? '' };\n          }\n        ),\n        { value: '', label: 'DND5E.NoneActionLabel' },\n      ],\n\n      properties: {\n        active: [],\n        object: {},\n        options: [],\n      },\n\n      equipmentTypes: [\n        ...Object.entries(CONFIG.DND5E.miscEquipmentTypes).map(\n          ([value, label]) => ({ value, label })\n        ),\n        ...Object.entries(CONFIG.DND5E.armorTypes).map(([value, label]) => ({\n          value,\n          label,\n          group: 'DND5E.Armor',\n        })),\n        ...ItemSheetRuntime.getCustomEquipmentTypeGroups().reduce<\n          GroupableSelectOption[]\n        >((prev, curr) => {\n          for (let [key, typeLabel] of Object.entries(curr.types)) {\n            prev.push({\n              value: key,\n              label: typeLabel,\n              group: curr.label,\n            });\n          }\n          return prev;\n        }, []),\n      ],\n\n      recoveryPeriods: CONFIG.DND5E.limitedUsePeriods.recoveryOptions,\n\n      recoveryTypes: [\n        { value: 'recoverAll', label: 'DND5E.USES.Recovery.Type.RecoverAll' },\n        { value: 'loseAll', label: 'DND5E.USES.Recovery.Type.LoseAll' },\n        { value: 'formula', label: 'DND5E.USES.Recovery.Type.Formula' },\n      ],\n\n      usesRecovery: (this.document.system.uses?.recovery ?? []).map(\n        (data: UsesRecoveryData) => ({\n          data,\n          formulaOptions:\n            data.period === 'recharge' ? data.recharge?.options : null,\n        })\n      ),\n\n      damageTypes: [],\n      denominationOptions: [],\n    };\n\n    if (!context.editable) {\n      context.source = context.system;\n    }\n\n    // Physical items\n    context.baseItems = await this._getItemBaseTypes(context);\n\n    // Properties\n    context.properties = {\n      active: [],\n      object: Object.fromEntries(\n        (this.document.system.properties ?? []).map((p: string) => [p, true])\n      ),\n      options: (this.document.system.validProperties ?? []).reduce(\n        (arr: ItemSheetContext['properties']['options'], k: any) => {\n          // @ts-ignore\n          const { label } = CONFIG.DND5E.itemProperties[k];\n          arr.push({\n            label,\n            value: k,\n            selected:\n              context.source.properties?.includes?.(k) ??\n              context.source.properties?.has?.(k),\n          });\n          return arr;\n        },\n        []\n      ),\n    };\n\n    if (this.item.type !== 'spell') {\n      context.properties.options.sort((a, b) =>\n        a.label.localeCompare(b.label, game.i18n.lang)\n      );\n    }\n\n    if (game.user.isGM || this.item.system.identified !== false) {\n      context.properties.active.push(\n        ...(this.item.system.cardProperties ?? []),\n        // @ts-expect-error\n        ...Object.values(this.item.labels.activations[0] ?? {}),\n        ...(this.item.system.equippableItemCardProperties ?? [])\n      );\n    }\n\n    // Facilities\n    const { building, craft, order, type } = this.item.system;\n\n    if (this.item.type === 'facility') {\n      context.orders = Object.entries(\n        CONFIG.DND5E.facilities.orders\n      ).reduce<ItemFacilityOrdersContext>(\n        (obj, [value, config]) => {\n          const { label, basic, hidden } = config;\n          if (hidden) {\n            return obj;\n          }\n\n          if (value === 'build') {\n            if (!building.built) obj.executable.push({ value, label });\n            return obj;\n          }\n\n          if (value === 'change') {\n            if (type.subtype === 'garden')\n              obj.executable.push({ value, label });\n            return obj;\n          }\n\n          if (type.value === 'basic') {\n            if (!building.built) return obj;\n            if (basic) obj.executable.push({ value, label });\n          } else if (type.value === 'special' && !basic) {\n            obj.available.push({ value, label });\n            if (value === order || value === 'maintain')\n              obj.executable.push({ value, label });\n          }\n\n          return obj;\n        },\n        { available: [], executable: [] }\n      );\n    }\n\n    if (\n      type?.value === 'special' &&\n      (order === 'craft' || order === 'harvest')\n    ) {\n      context.canCraft = true;\n      context.isHarvesting = order === 'harvest';\n      const crafting = await fromUuid(craft.item);\n      if (crafting) {\n        context.craft = {\n          img: crafting.img,\n          name: crafting.name,\n          contentLink: crafting.toAnchor().outerHTML,\n        };\n      }\n    }\n\n    // Tabs\n    const eligibleCustomTabs = ItemSheetRuntime.getCustomItemTabs(context);\n\n    const customTabs: Tab[] = await TabManager.prepareTabsForRender(\n      context,\n      eligibleCustomTabs\n    );\n\n    const tabs = ItemSheetRuntime.sheets[this.item.type]?.defaultTabs() ?? [];\n\n    tabs.push(...customTabs);\n\n    context.tabs = tabs;\n\n    // Custom Content\n    context.customContent = await ItemSheetRuntime.getContent(context);\n\n    // Handle item subtypes.\n    if (['feat', 'loot', 'consumable'].includes(this.document.type)) {\n      const name =\n        this.document.type === 'feat' ? 'feature' : this.document.type;\n      const itemTypes =\n        // @ts-expect-error\n        CONFIG.DND5E[`${name}Types`][this.document.system.type.value];\n      if (itemTypes) {\n        context.itemType = itemTypes.label;\n        context.itemSubtypes = itemTypes.subtypes;\n      }\n    }\n\n    await this.item.system.getSheetData?.(context);\n\n    return context;\n  }\n\n  /**\n   * Whether advancements on embedded items should be configurable.\n   * @type {boolean}\n   */\n  advancementConfigurationMode = false;\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the display object used to show the advancement tab.\n   * @param {Item5e} item  The item for which the advancement is being prepared.\n   * @returns {object}     Object with advancement data grouped by levels.\n   */\n  _getItemAdvancement(item: Item5e) {\n    if (!item.system.advancement) return {};\n    const advancement: Record<string, any> = {};\n    const configMode = !item.parent || this.advancementConfigurationMode;\n    const legacyDisplay = this.options.legacyDisplay;\n    const maxLevel = !configMode\n      ? item.system.levels ??\n        item.class?.system.levels ??\n        item.parent.system.details?.level ??\n        -1\n      : -1;\n\n    // Improperly configured advancements\n    if (item.advancement.needingConfiguration.length) {\n      advancement.unconfigured = {\n        items: item.advancement.needingConfiguration.map((a: any) => ({\n          id: a.id,\n          order: a.constructor.order,\n          title: a.title,\n          icon: a.icon,\n          classRestriction: a.classRestriction,\n          configured: false,\n          tags: this._getItemAdvancementTags(a),\n          classes: [a.icon?.endsWith('.svg') ? 'svg' : ''].filterJoin(' '),\n        })),\n        configured: 'partial',\n      };\n    }\n\n    // All other advancements by level\n    for (let [level, advancements] of Object.entries<any>(\n      item.advancement.byLevel\n    )) {\n      if (!configMode)\n        advancements = advancements.filter((a: any) => a.appliesToClass);\n      const items = advancements.map((advancement: any) => ({\n        id: advancement.id,\n        order: advancement.sortingValueForLevel(level),\n        title: advancement.titleForLevel(level, { configMode, legacyDisplay }),\n        icon: advancement.icon,\n        classRestriction: advancement.classRestriction,\n        summary: advancement.summaryForLevel(level, {\n          configMode,\n          legacyDisplay,\n        }),\n        configured: advancement.configuredForLevel(level),\n        tags: this._getItemAdvancementTags(advancement),\n        value: advancement.valueForLevel?.(level),\n        classes: [advancement.icon?.endsWith('.svg') ? 'svg' : ''].filterJoin(\n          ' '\n        ),\n      }));\n      if (!items.length) continue;\n      advancement[level] = {\n        items: items.sort((a: any, b: any) =>\n          a.order.localeCompare(b.order, game.i18n.lang)\n        ),\n        configured:\n          level > maxLevel\n            ? false\n            : items.some((a: any) => !a.configured)\n            ? 'partial'\n            : 'full',\n      };\n    }\n    return advancement;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Prepare tags for an Advancement.\n   * @param {Advancement} advancement  The Advancement.\n   * @returns {{label: string, icon: string}[]}\n   * @protected\n   */\n  _getItemAdvancementTags(advancement: any) {\n    return [];\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the base weapons and tools based on the selected type.\n   * @param context        Sheet preparation context.\n   * @returns             Object with base items for this type formatted for selectOptions.\n   * @protected\n   */\n  async _getItemBaseTypes(\n    context: ItemSheetClassicContext\n  ): Promise<Record<string, any>> {\n    const baseIds =\n      this.item.type === 'equipment'\n        ? {\n            ...CONFIG.DND5E.armorIds,\n            ...CONFIG.DND5E.shieldIds,\n          }\n        : // @ts-expect-error\n          CONFIG.DND5E[`${this.item.type}Ids`];\n    if (baseIds === undefined) return {};\n\n    const baseType = context?.source.type.value ?? this.item.system.type.value;\n\n    const items: Record<string, any> = {};\n    for (const [name, id] of Object.entries(baseIds)) {\n      const baseItem = await dnd5e.documents.Trait.getBaseItem(id);\n      if (baseType !== baseItem?.system?.type?.value) continue;\n      items[name] = baseItem.name;\n    }\n    if (foundry.utils.isEmpty(items)) return {};\n    return Object.fromEntries(\n      Object.entries(items).sort((lhs, rhs) =>\n        lhs[1].localeCompare(rhs[1], game.i18n.lang)\n      )\n    );\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the text item status which is shown beneath the Item type in the top-right corner of the sheet.\n   * @returns {string|null}  Item status string if applicable to item's type.\n   * @protected\n   */\n  _getItemStatus() {\n    switch (this.item.type) {\n      case 'class':\n        return game.i18n.format('DND5E.LevelCount', {\n          ordinal: this.item.system.levels.ordinalString(),\n        });\n      case 'equipment':\n      case 'weapon':\n        return game.i18n.localize(\n          this.item.system.equipped ? 'DND5E.Equipped' : 'DND5E.Unequipped'\n        );\n      case 'feat':\n      case 'consumable':\n        return this.item.system.type.label;\n      case 'spell':\n        return CONFIG.DND5E.spellPreparationModes[\n          this.item.system.preparation.mode\n        ]?.label;\n      case 'tool':\n        // @ts-expect-error\n        return CONFIG.DND5E.proficiencyLevels[\n          this.item.system.prof?.multiplier || 0\n        ];\n    }\n    return null;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Retrieve the list of fields that are currently modified by Active Effects on the Item.\n   * @returns {string[]}\n   * @protected\n   */\n  _getItemOverrides() {\n    const overrides = Object.keys(\n      foundry.utils.flattenObject(this.item.overrides ?? {})\n    );\n    this.item.system.getItemOverrides?.(overrides);\n    if ('properties' in this.item.system) {\n      dnd5e.documents.ActiveEffect5e.addOverriddenChoices(\n        this.item,\n        'system.properties',\n        'system.properties',\n        overrides\n      );\n    }\n    if (\n      'damage' in this.item.system &&\n      foundry.utils.getProperty(this.item.overrides, 'system.damage.parts')\n    ) {\n      overrides.push('damage-control');\n      Array.fromRange(this.item.system.damage.parts.length).forEach((index) =>\n        overrides.push(\n          `system.damage.parts.${index}.0`,\n          `system.damage.parts.${index}.1`\n        )\n      );\n    }\n    return overrides;\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Get the set of ContextMenu options which should be applied for advancement entries.\n   * @returns {ContextMenuEntry[]}  Context menu entries.\n   * @protected\n   */\n  _getAdvancementContextMenuOptions() {\n    const condition = (li: any) =>\n      (this.advancementConfigurationMode || !this.isEmbedded) &&\n      this.isEditable;\n    return [\n      {\n        name: 'DND5E.AdvancementControlEdit',\n        icon: \"<i class='fas fa-edit fa-fw'></i>\",\n        condition,\n        callback: (li: any) => this._onAdvancementAction(li[0], 'edit'),\n      },\n      {\n        name: 'DND5E.AdvancementControlDuplicate',\n        icon: \"<i class='fas fa-copy fa-fw'></i>\",\n        condition: (li: any) => {\n          const id = li[0].closest('.advancement-item')?.dataset.id;\n          const advancement = this.item.advancement.byId[id];\n          return (\n            condition(li) &&\n            advancement?.constructor.availableForItem(this.item)\n          );\n        },\n        callback: (li: any) => this._onAdvancementAction(li[0], 'duplicate'),\n      },\n      {\n        name: 'DND5E.AdvancementControlDelete',\n        icon: \"<i class='fas fa-trash fa-fw' style='color: rgb(255, 65, 65);'></i>\",\n        condition,\n        callback: (li: any) => this._onAdvancementAction(li[0], 'delete'),\n      },\n    ];\n  }\n\n  /* -------------------------------------------- */\n  /*  Drag and Drop                               */\n  /* -------------------------------------------- */\n\n  /** @inheritDoc */\n  _canDragStart(selector: string) {\n    if (['.advancement-item', '[data-effect-id]'].includes(selector))\n      return true;\n    return this.isEditable;\n  }\n\n  /* -------------------------------------------- */\n\n  /** @inheritDoc */\n  _canDragDrop(selector: string) {\n    return this.isEditable;\n  }\n\n  /* -------------------------------------------- */\n\n  /** @inheritDoc */\n  _onDragStart(\n    event: DragEvent & { currentTarget: HTMLElement; target: HTMLElement }\n  ) {\n    const li = event.currentTarget;\n    if (event.target.classList.contains('content-link')) return;\n\n    // Create drag data\n    let dragData;\n\n    // Active Effect\n    if (li.dataset.effectId) {\n      const effect = this.item.effects.get(li.dataset.effectId);\n      dragData = effect.toDragData();\n    } else if (\n      li.classList.contains('advancement-item') &&\n      !isNil(li.dataset.id)\n    ) {\n      dragData = this.item.advancement.byId[li.dataset.id]?.toDragData();\n    }\n\n    if (!dragData) return;\n\n    // Set data transfer\n    event.dataTransfer?.setData('text/plain', JSON.stringify(dragData));\n  }\n\n  /* -------------------------------------------- */\n\n  /** @inheritDoc */\n  async _onDrop(\n    event: DragEvent & { currentTarget: HTMLElement; target: HTMLElement }\n  ) {\n    const data = TextEditor.getDragEventData(event);\n    const item = this.item;\n\n    const allowed = TidyHooks.dnd5eDropItemSheetData(item, this, data);\n    if (allowed === false) return;\n\n    switch (data.type) {\n      case 'ActiveEffect':\n        return this._onDropActiveEffect(event, data);\n      case 'Activity':\n        return this._onDropActivity(event, data);\n      case 'Advancement':\n      case 'Item':\n        return this._onDropAdvancement(event, data);\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle the dropping of ActiveEffect data onto an Item Sheet\n   * @param {DragEvent} event                  The concluding DragEvent which contains drop data\n   * @param {object} data                      The data transfer extracted from the event\n   * @returns {Promise<ActiveEffect|boolean>}  The created ActiveEffect object or false if it couldn't be created.\n   * @protected\n   */\n  async _onDropActiveEffect(event: DragEvent, data: any) {\n    const effect = await ActiveEffect.implementation.fromDropData(data);\n    if (\n      !this.item.isOwner ||\n      !effect ||\n      this.item.uuid === effect.parent?.uuid ||\n      this.item.uuid === effect.origin\n    )\n      return false;\n    const effectData = effect.toObject();\n    const options: Record<string, any> = {\n      parent: this.item,\n      keepOrigin: false,\n    };\n\n    if (effect.type === 'enchantment') {\n      effectData.origin ??= effect.parent.uuid;\n      options.keepOrigin = true;\n      options.dnd5e = {\n        enchantmentProfile: effect.id,\n        activityId: data.activityId,\n      };\n    }\n\n    return ActiveEffect.create(effectData, options);\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle dropping an Activity onto the sheet.\n   * @param {DragEvent} event       The drag event.\n   * @param {object} transfer       The dropped data.\n   * @param {object} transfer.data  The Activity data.\n   * @protected\n   */\n  _onDropActivity(\n    event: DragEvent & { currentTarget: HTMLElement; target: HTMLElement },\n    { data }: any\n  ) {\n    const { _id: id, type } = data;\n    const source = this.item.system.activities.get(id);\n\n    // Reordering\n    if (source) {\n      const targetId = event.target.closest<HTMLElement>(\n        '.activity[data-activity-id]'\n      )?.dataset.activityId;\n      const target = this.item.system.activities.get(targetId);\n      if (!target || target === source) return;\n      const siblings = this.item.system.activities.filter(\n        (a: any) => a._id !== id\n      );\n      const sortUpdates = SortingHelpers.performIntegerSort(source, {\n        target,\n        siblings,\n      });\n      const updateData = Object.fromEntries(\n        sortUpdates.map(({ target, update }: { target: any; update: any }) => {\n          return [target._id, { sort: update.sort }];\n        })\n      );\n      this.item.update({ 'system.activities': updateData });\n    }\n\n    // Copying\n    else {\n      delete data._id;\n      this.item.createActivity(type, data, { renderSheet: false });\n    }\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle the dropping of an advancement or item with advancements onto the advancements tab.\n   * @param {DragEvent} event                  The concluding DragEvent which contains drop data.\n   * @param {object} data                      The data transfer extracted from the event.\n   * @returns {Promise}\n   */\n  async _onDropAdvancement(event: DragEvent, data: any) {\n    if (!this.item.system.advancement) return;\n\n    let advancements;\n    let showDialog = false;\n    if (data.type === 'Advancement') {\n      advancements = [await fromUuid(data.uuid)];\n    } else if (data.type === 'Item') {\n      const item = await Item.implementation.fromDropData(data);\n      if (!item?.system.advancement) return false;\n      advancements = Object.values(item.advancement.byId);\n      showDialog = true;\n    } else {\n      return false;\n    }\n    advancements = advancements.filter((a) => {\n      const validItemTypes =\n        // @ts-expect-error\n        CONFIG.DND5E.advancementTypes[a.constructor.typeName]?.validItemTypes ??\n        a.metadata.validItemTypes;\n      return (\n        !this.item.advancement.byId[a.id] &&\n        validItemTypes.has(this.item.type) &&\n        a.constructor.availableForItem(this.item)\n      );\n    });\n\n    // Display dialog prompting for which advancements to add\n    if (showDialog) {\n      try {\n        advancements =\n          await dnd5e.applications.advancement.AdvancementMigrationDialog.createDialog(\n            this.item,\n            advancements\n          );\n      } catch (err) {\n        return false;\n      }\n    }\n\n    if (!advancements.length) return false;\n    if (\n      this.item.actor?.system.metadata?.supportsAdvancement &&\n      !game.settings.get('dnd5e', 'disableAdvancements')\n    ) {\n      const manager =\n        dnd5e.applications.advancement.AdvancementManager.forNewAdvancement(\n          this.item.actor,\n          this.item.id,\n          advancements\n        );\n      if (manager.steps.length) return manager.render(true);\n    }\n\n    // If no advancements need to be applied, just add them to the item\n    const advancementArray = this.item.system.toObject().advancement;\n    advancementArray.push(...advancements.map((a: any) => a.toObject()));\n    this.item.update({ 'system.advancement': advancementArray });\n  }\n\n  async toggleAdvancementLock() {\n    this.advancementConfigurationMode = !this.advancementConfigurationMode;\n    this.render();\n  }\n\n  /* -------------------------------------------- */\n  /* Actions\n  /* -------------------------------------------- */\n\n  addActivity() {\n    return dnd5e.documents.activity.UtilityActivity.createDialog(\n      {},\n      {\n        parent: this.item,\n        types: Object.entries(CONFIG.DND5E.activityTypes)\n          .filter(([, { configurable }]: any) => {\n            return configurable !== false;\n          })\n          .map(([k]) => k),\n      }\n    );\n  }\n\n  /**\n   * Create a new recovery profile.\n   */\n  addRecovery(): Promise<any> {\n    return this.submit({\n      updateData: {\n        'system.uses.recovery': [\n          ...this.item.system.toObject().uses.recovery,\n          {},\n        ],\n      },\n    });\n  }\n\n  deleteRecovery(index: number) {\n    const recovery = this.item.system.toObject().uses.recovery;\n    recovery.splice(index, 1);\n    return this.submit({ updateData: { 'system.uses.recovery': recovery } });\n  }\n\n  updateRecovery(index: number, prop: string, value: keyof UsesRecoveryData) {\n    const recovery = this.item.system.toObject().uses.recovery;\n    recovery[index][prop] = value;\n    return this.submit({ updateData: { 'system.uses.recovery': recovery } });\n  }\n\n  /**\n   * Handle one of the advancement actions from the buttons or context menu.\n   * @param {Element} target  Button or context menu entry that triggered this action.\n   * @param {string} action   Action being triggered.\n   * @returns {Promise|void}\n   */\n  _onAdvancementAction(target: HTMLElement, action: string) {\n    const id = target.closest<HTMLElement>('.advancement-item')?.dataset.id;\n\n    if (!id) {\n      return;\n    }\n\n    const advancement = this.item.advancement.byId[id];\n    let manager;\n    if (['edit', 'delete', 'duplicate'].includes(action) && !advancement)\n      return;\n    switch (action) {\n      case 'add':\n        return game.dnd5e.applications.advancement.AdvancementSelection.createDialog(\n          this.item\n        );\n      case 'edit':\n        return new advancement.constructor.metadata.apps.config(\n          advancement\n        ).render(true);\n      case 'delete':\n        if (\n          this.item.actor?.system.metadata?.supportsAdvancement &&\n          !game.settings.get('dnd5e', 'disableAdvancements')\n        ) {\n          manager =\n            dnd5e.applications.advancement.AdvancementManager.forDeletedAdvancement(\n              this.item.actor,\n              this.item.id,\n              id\n            );\n          if (manager.steps.length) return manager.render(true);\n        }\n        return this.item.deleteAdvancement(id);\n      case 'duplicate':\n        return this.item.duplicateAdvancement(id);\n      case 'modify-choices':\n        const level =\n          target.closest<HTMLElement>('[data-level]')?.dataset.level;\n\n        if (!level) {\n          return;\n        }\n\n        manager =\n          dnd5e.applications.advancement.AdvancementManager.forModifyChoices(\n            this.item.actor,\n            this.item.id,\n            Number(level)\n          );\n        if (manager.steps.length) manager.render(true);\n        return;\n      case 'toggle-configuration':\n        this.advancementConfigurationMode = !this.advancementConfigurationMode;\n        return this.render();\n    }\n  }\n}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { type Actor5e } from 'src/types/types';\n  import { settings } from 'src/settings/settings.svelte';\n  import HpBar from 'src/components/bar/HpBar.svelte';\n  import ResourceWithBar from 'src/components/bar/ResourceWithBar.svelte';\n  import { getCharacterSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  interface Props {\n    value: number;\n    max: number;\n    actor: Actor5e;\n  }\n\n  let { value, max, actor }: Props = $props();\n\n  let context = $derived(getCharacterSheetContext());\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<!-- TODO: Just use the bar and put own readonly text in the bar -->\n<!-- TODO: Curate the tooltip to show selected members for calculation. -->\n<div\n  class=\"group-hp-container\"\n  class:widen-for-rounded-portrait={context.useRoundedPortraitStyle}\n  title={localize('DND5E.GroupHP')}\n>\n  <ResourceWithBar\n    document={actor}\n    {value}\n    valueField=\"system.attributes.hp.value\"\n    valueTitle={null}\n    valueDisabled={true}\n    {max}\n    maxField=\"system.attributes.hp.max\"\n    maxTitle={null}\n    maxDisabled={true}\n    percentage={context.healthPercentage}\n    Bar={settings.value.useHpBar ? HpBar : null}\n  />\n</div>\n","<script lang=\"ts\">\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import { CONSTANTS } from 'src/constants';\n  import Select from 'src/components/inputs/Select.svelte';\n  import SelectOptions from 'src/components/inputs/SelectOptions.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import ActorProfile from '../actor/ActorProfile.svelte';\n  import ActorMovement from '../actor/ActorMovement.svelte';\n  import HorizontalLineSeparator from 'src/components/layout/HorizontalLineSeparator.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import GroupHitPoints from './parts/GroupHitPoints.svelte';\n  import { getGroupSheetClassicContext } from 'src/sheets/sheet-context.svelte';\n  import { onMount } from 'svelte';\n\n  const context = $derived(getGroupSheetClassicContext());\n\n  const localize = FoundryAdapter.localize;\n\n  let selectedTabId = $state<string>('');\n\n  onMount(() => {\n    selectedTabId = context.tabs[0]?.id ?? '';\n  });\n</script>\n\n<header class=\"tidy5e-sheet-header flex-row\">\n  <div class=\"flex-0\">\n    <ActorProfile useHpOverlay={false} size=\"small\">\n      {#if context.canObserveAll}\n        <GroupHitPoints\n          actor={context.actor}\n          value={context.currentHP}\n          max={context.maxHP}\n        />\n      {/if}\n    </ActorProfile>\n  </div>\n  <div class=\"flex-grow-1\">\n    <div\n      class=\"flex-row justify-content-space-between align-items-center small-gap\"\n      data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_HEADER_ROW}\n    >\n      <div\n        class=\"actor-name\"\n        data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.NAME_CONTAINER}\n      >\n        <TextInput\n          document={context.actor}\n          editable={context.unlocked}\n          disabled={!context.unlocked}\n          spellcheck={false}\n          placeholder={localize('TIDY5E.Group.NamePlaceholder')}\n          value={context.actor.name}\n          field=\"name\"\n        />\n      </div>\n\n      <!-- Any other content adjacent to Actor Name -->\n    </div>\n    <div\n      class=\"flex-row align-items-center header-line-margin\"\n      style=\"margin-top: 0;\"\n    >\n      <span class=\"flex-1 fs-sm text-body-secondary\">{context.summary}</span>\n      {#if context.unlocked}\n        <Select\n          document={context.actor}\n          value={context.system.type.value}\n          field=\"system.type.value\"\n          blankValue=\"\"\n          class=\"flex-grow-0 flex-shrink-0 flex-basis-max-content\"\n        >\n          <SelectOptions\n            data={context.config.groupTypes}\n            blank={localize('DND5E.Group.TypeGeneric')}\n          />\n        </Select>\n      {:else}\n        <span class=\"semibold\">\n          {context.config.groupTypes[context.system.type.value] ??\n            localize('DND5E.Group.TypeGeneric')}\n        </span>\n      {/if}\n    </div>\n    <HorizontalLineSeparator class=\"header-line-margin-left\" />\n    <div\n      class=\"flex-row header-line-margin justify-content-space-between align-items-center\"\n    >\n      <ActorMovement movementLabelKey=\"DND5E.Movement\" />\n      {#if !context.disableExperience}\n        {#if context.unlocked}\n          <div class=\"flex-row align-items-center no-gap\">\n            <TextInput\n              document={context.actor}\n              field=\"system.details.xp.value\"\n              value={context.system.details.xp.value}\n              placeholder={context.system.details.xp.derived?.toString() ?? '0'}\n              class=\"group-xp-input fs-sm\"\n              saveEmptyAsNull={true}\n            />\n            <span class=\"fs-sm semibold\"\n              >{localize('DND5E.ExperiencePoints.Abbreviation')}</span\n            >\n          </div>\n        {:else}\n          <strong class=\"fs-sm semibold\">\n            {localize('DND5E.ExperiencePoints.Format', {\n              value:\n                context.system.details.xp.value ??\n                context.system.details.xp.derived ??\n                '0',\n            })}\n          </strong>\n        {/if}\n      {/if}\n    </div>\n    <HorizontalLineSeparator class=\"header-line-margin-left\" />\n    {#if context.isGM}\n      <div class=\"group-commands\">\n        <button\n          type=\"button\"\n          class=\"group-action-button flex-row small-gap flex-grow-0 flex-basis-max-content\"\n          onclick={() => context.actor.sheet.award()}\n          tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n        >\n          <i class=\"fa-solid fa-trophy\"></i>\n          {localize('DND5E.Award.Action')}\n        </button>\n        <button\n          type=\"button\"\n          class=\"group-action-button flex-row small-gap flex-grow-0 flex-basis-max-content\"\n          onclick={() => context.actor.system.placeMembers()}\n          tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n        >\n          <i class=\"fa-solid fa-location-dot\"></i>\n          {localize('DND5E.Group.PlaceMembers')}\n        </button>\n        <button\n          type=\"button\"\n          class=\"group-action-button flex-row small-gap rest-button flex-grow-0 flex-basis-max-content\"\n          onclick={() => context.actor.shortRest({ advanceTime: true })}\n          tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n        >\n          <i class=\"fa-solid fa-utensils\"></i>\n          {localize('DND5E.REST.Short.Label')}\n        </button>\n        <button\n          type=\"button\"\n          class=\"group-action-button flex-row small-gap rest-button flex-grow-0 flex-basis-max-content\"\n          onclick={() => context.actor.longRest({ advanceTime: true })}\n          tabindex={settings.value.useAccessibleKeyboardSupport ? 0 : -1}\n        >\n          <i class=\"fa-solid fa-campground\"></i>\n          {localize('DND5E.REST.Long.Label')}\n        </button>\n      </div>\n    {/if}\n  </div>\n</header>\n\n<Tabs tabs={context.tabs} bind:selectedTabId sheet={context.actor.sheet} />\n\n<section class=\"tidy-sheet-body\">\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</section>\n","export function firstOfSet<T>(set: Set<T>): T | undefined {\n  return set.values().next().value;\n}\n","import { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { DragAndDropMixin } from './DragAndDropBaseMixin';\nimport type { Item5e } from 'src/types/item.types';\nimport { firstOfSet } from 'src/utils/set';\nimport { CONSTANTS } from 'src/constants';\nimport type { ApplicationPosition } from 'src/types/application.types';\nimport type { Actor5e } from 'src/types/types';\nimport { settings } from 'src/settings/settings.svelte';\nimport TabSelectionFormApplication from 'src/applications/tab-selection/TabSelectionFormApplication.svelte';\n\nexport function Tidy5eActorSheetBaseMixin(BaseApplication: any) {\n  class Tidy5eActorSheetBase extends DragAndDropMixin(BaseApplication) {\n    _supportedItemTypes: Set<string> = new Set();\n    _currentDragEvent: (DragEvent & { currentTarget: HTMLElement }) | undefined;\n\n    static readonly ACTOR_ACTIONS_AND_CONTROLS = {\n      configureToken: {\n        control: {\n          action: 'configureToken',\n          icon: 'fa-solid fa-user-circle',\n          label:\n            'This Actions Title Changes Based on an Actor-specific piece of data',\n          ownership: 'OWNER',\n        },\n        action: {\n          configureToken: Tidy5eActorSheetBase.#onConfigureToken,\n        },\n      },\n      showPortraitArtwork: {\n        control: {\n          action: 'showPortraitArtwork',\n          icon: 'fa-solid fa-image',\n          label: 'SIDEBAR.CharArt',\n          ownership: 'OWNER',\n        },\n        action: {\n          showPortraitArtwork: Tidy5eActorSheetBase.#onShowPortraitArtwork,\n        },\n      },\n      showTokenArtwork: {\n        control: {\n          action: 'showTokenArtwork',\n          icon: 'fa-solid fa-image',\n          label: 'SIDEBAR.TokenArt',\n          ownership: 'OWNER',\n        },\n        action: {\n          showTokenArtwork: Tidy5eActorSheetBase.#onShowTokenArtwork,\n        },\n      },\n      openTabSelection: {\n        control: {\n          action: 'openTabSelection',\n          icon: 'fas fa-file-invoice',\n          label: 'TIDY5E.TabSelection.MenuOptionText',\n        },\n        action: {\n          openTabSelection: async function (this: { actor?: Actor5e }) {\n            new TabSelectionFormApplication(this.actor).render(true);\n          },\n        },\n      },\n    };\n\n    /* -------------------------------------------- */\n    /*  Application Lifecycle Functions             */\n    /* -------------------------------------------- */\n\n    /**\n     * Perform any dynamic behavior on controls which depends on the current state of the sheet.\n     * @returns\n     */\n    _getHeaderControls() {\n      const controls = super._getHeaderControls();\n\n      const configureTokenControl = controls.find(\n        (c: any) =>\n          c.action ===\n          Tidy5eActorSheetBase.ACTOR_ACTIONS_AND_CONTROLS.configureToken.control\n            .action\n      );\n      if (configureTokenControl && this.token) {\n        configureTokenControl.label = 'Token';\n        configureTokenControl.icon = 'far fa-user-circle';\n      } else {\n        configureTokenControl.label = 'TOKEN.TitlePrototype';\n      }\n\n      return controls;\n    }\n\n    /* -------------------------------------------- */\n    /*  Drag and Drop Handlers                      */\n    /* -------------------------------------------- */\n\n    async _onDrop(\n      event: DragEvent & { currentTarget: HTMLElement }\n    ): Promise<any> {\n      this._currentDragEvent = event;\n      const data = TextEditor.getDragEventData(event);\n      const actor = this.actor;\n      // TODO: Extract hook call\n      const allowed = Hooks.call('dropActorSheetData', actor, this, data);\n      if (allowed === false) return;\n\n      // Handle different data types\n      switch (data.type) {\n        case 'ActiveEffect':\n          return this._onDropActiveEffect(event, data);\n        case 'Actor':\n          return this._onDropActor(event, data);\n        case 'Item':\n          return this._onDropItem(event, data);\n        case 'Folder':\n          return this._onDropFolder(event, data);\n      }\n    }\n\n    /**\n     * Handle the dropping of ActiveEffect data onto an Actor Sheet\n     */\n    async _onDropActiveEffect(\n      _currentDragEvent: DragEvent & { currentTarget: HTMLElement },\n      data: Record<string, any>\n    ): Promise</*ActiveEffect*/ unknown | boolean> {\n      const effect = await ActiveEffect.implementation.fromDropData(data);\n\n      if (!this.actor.isOwner || !effect) {\n        return false;\n      }\n\n      if (effect.target === this.actor) {\n        return false;\n      }\n\n      return ActiveEffect.create(effect.toObject(), { parent: this.actor });\n    }\n\n    async _onDropActor(\n      _currentDragEvent: DragEvent & { currentTarget: HTMLElement },\n      data: any\n    ): Promise<object | boolean | undefined> {\n      const canPolymorph =\n        game.user.isGM ||\n        (this.actor.isOwner && game.settings.get('dnd5e', 'allowPolymorphing'));\n      if (!canPolymorph) return false;\n\n      // Get the target actor\n      const cls = getDocumentClass('Actor');\n      const sourceActor = await cls.fromDropData(data);\n      if (!sourceActor) return;\n\n      // Define a function to record polymorph settings for future use\n      const rememberOptions = (html: any) => {\n        const options: Record<string, any> = {};\n        html.find('input').each((i: number, el: HTMLInputElement) => {\n          options[el.name] = el.checked;\n        });\n        const settings = foundry.utils.mergeObject(\n          game.settings.get('dnd5e', 'polymorphSettings') ?? {},\n          options\n        );\n        game.settings.set('dnd5e', 'polymorphSettings', settings);\n        return settings;\n      };\n\n      // Create and render the Dialog\n      return new Dialog(\n        {\n          title: game.i18n.localize('DND5E.PolymorphPromptTitle'),\n          content: {\n            options: game.settings.get('dnd5e', 'polymorphSettings'),\n            settings: CONFIG.DND5E.polymorphSettings,\n            effectSettings: CONFIG.DND5E.polymorphEffectSettings,\n            isToken: this.actor.isToken,\n          },\n          default: 'accept',\n          buttons: {\n            accept: {\n              icon: '<i class=\"fas fa-check\"></i>',\n              label: game.i18n.localize('DND5E.PolymorphAcceptSettings'),\n              callback: (html: any) =>\n                this.actor.transformInto(sourceActor, rememberOptions(html)),\n            },\n            wildshape: {\n              icon: CONFIG.DND5E.transformationPresets.wildshape.icon,\n              label: CONFIG.DND5E.transformationPresets.wildshape.label,\n              callback: (html: any) =>\n                this.actor.transformInto(\n                  sourceActor,\n                  foundry.utils.mergeObject(\n                    CONFIG.DND5E.transformationPresets.wildshape.options,\n                    { transformTokens: rememberOptions(html).transformTokens }\n                  )\n                ),\n            },\n            polymorph: {\n              icon: CONFIG.DND5E.transformationPresets.polymorph.icon,\n              label: CONFIG.DND5E.transformationPresets.polymorph.label,\n              callback: (html: any) =>\n                this.actor.transformInto(\n                  sourceActor,\n                  foundry.utils.mergeObject(\n                    CONFIG.DND5E.transformationPresets.polymorph.options,\n                    { transformTokens: rememberOptions(html).transformTokens }\n                  )\n                ),\n            },\n            self: {\n              icon: CONFIG.DND5E.transformationPresets.polymorphSelf.icon,\n              label: CONFIG.DND5E.transformationPresets.polymorphSelf.label,\n              callback: (html: any) =>\n                this.actor.transformInto(\n                  sourceActor,\n                  foundry.utils.mergeObject(\n                    CONFIG.DND5E.transformationPresets.polymorphSelf.options,\n                    { transformTokens: rememberOptions(html).transformTokens }\n                  )\n                ),\n            },\n            cancel: {\n              icon: '<i class=\"fas fa-times\"></i>',\n              label: game.i18n.localize('Cancel'),\n            },\n          },\n        },\n        {\n          classes: ['dialog', 'dnd5e', 'polymorph'],\n          width: 900,\n          template: 'systems/dnd5e/templates/apps/polymorph-prompt.hbs',\n        }\n      ).render(true);\n    }\n\n    async _onDropItem(\n      event: DragEvent & { currentTarget: HTMLElement },\n      data: unknown\n    ): Promise<object | boolean | undefined> {\n      if (!this.actor.isOwner) return false;\n      const item = await Item.implementation.fromDropData(data);\n\n      // Handle moving out of container & item sorting\n      if (this.actor.uuid === item.parent?.uuid) {\n        if (item.system.container !== null)\n          await item.update({ 'system.container': null });\n        return FoundryAdapter.onSortItemForActor(\n          this.actor,\n          event,\n          item.toObject()\n        );\n      }\n\n      return this._onDropItemCreate(item, event);\n    }\n\n    /**\n     * Handle the final creation of dropped Item data on the Actor.\n     */\n    async _onDropItemCreate(\n      itemData: Item5e[] | Item5e,\n      event: DragEvent\n    ): Promise<Item5e[]> {\n      let items = itemData instanceof Array ? itemData : [itemData];\n      const itemsWithoutAdvancement = items.filter(\n        (i) => !i.system.advancement?.length\n      );\n      const multipleAdvancements =\n        items.length - itemsWithoutAdvancement.length > 1;\n      if (\n        multipleAdvancements &&\n        !game.settings.get('dnd5e', 'disableAdvancements')\n      ) {\n        ui.notifications.warn(\n          game.i18n.format('DND5E.WarnCantAddMultipleAdvancements')\n        );\n        items = itemsWithoutAdvancement;\n      }\n\n      // Filter out items already in containers to avoid creating duplicates\n      const containers = new Set(\n        items.filter((i) => i.type === 'container').map((i) => i._id)\n      );\n\n      items = items.filter((i) => !containers.has(i.system.container));\n\n      // Create the owned items & contents as normal\n      const toCreate = await dnd5e.documents.Item5e.createWithContents(items, {\n        transformFirst: (item: Item5e) =>\n          this._onDropSingleItem(item.toObject(), event),\n      });\n\n      return dnd5e.documents.Item5e.createDocuments(toCreate, {\n        pack: this.actor.pack,\n        parent: this.actor,\n        keepId: true,\n      });\n    }\n\n    /**\n     * Handles dropping of a single item onto this character sheet.\n     */\n    async _onDropSingleItem(\n      itemData: any,\n      event: DragEvent\n    ): Promise<object | boolean> {\n      const isSupportedItemType =\n        this._supportedItemTypes.size === 0 ||\n        this._supportedItemTypes.has(itemData.type);\n\n      // Check to make sure items of this type are allowed on this actor\n      if (!isSupportedItemType) {\n        ui.notifications.warn(\n          game.i18n.format('DND5E.ActorWarningInvalidItem', {\n            itemType: game.i18n.localize(\n              CONFIG.Item.typeLabels[\n                itemData.type as keyof typeof CONFIG.Item.typeLabels\n              ]\n            ),\n            actorType: game.i18n.localize(\n              CONFIG.Actor.typeLabels[\n                this.actor.type as keyof typeof CONFIG.Actor.typeLabels\n              ]\n            ),\n          })\n        );\n        return false;\n      }\n\n      const isOnInventoryTab = this.element.matches(\n        `:has([data-tab-id=\"${CONSTANTS.TAB_ACTOR_INVENTORY}\"].active)`\n      );\n\n      // Create a Consumable spell scroll on the Inventory tab\n      if (\n        itemData.type === 'spell' &&\n        (isOnInventoryTab ||\n          this.actor.type === CONSTANTS.SHEET_TYPE_VEHICLE ||\n          this.actor.type === CONSTANTS.SHEET_TYPE_GROUP)\n      ) {\n        const options: Record<string, unknown> = {};\n\n        if (settings.value.includeFlagsInSpellScrollCreation) {\n          options.flags = itemData.flags;\n        }\n\n        const scroll = await dnd5e.documents.Item5e.createScrollFromSpell(\n          itemData,\n          options\n        );\n\n        return scroll?.toObject?.() ?? false;\n      }\n\n      // Clean up data\n      this._onDropResetData(itemData);\n\n      // Stack identical consumables\n      const stacked = this._onDropStackConsumables(itemData, {}, event);\n      if (stacked) return false;\n\n      // Bypass normal creation flow for any items with advancement\n      if (\n        this.actor.system.metadata?.supportsAdvancement &&\n        itemData.system.advancement?.length &&\n        !game.settings.get('dnd5e', 'disableAdvancements')\n      ) {\n        // Ensure that this item isn't violating the singleton rule\n        const dataModel =\n          CONFIG.Item.dataModels[\n            itemData.type as keyof typeof CONFIG.Item.dataModels\n          ];\n        const singleton = dataModel?.metadata.singleton ?? false;\n        if (singleton && this.actor.itemTypes[itemData.type].length) {\n          ui.notifications.error(\n            game.i18n.format('DND5E.ActorWarningSingleton', {\n              itemType: game.i18n.localize(\n                CONFIG.Item.typeLabels[\n                  itemData.type as keyof typeof CONFIG.Item.typeLabels\n                ]\n              ),\n              actorType: game.i18n.localize(\n                CONFIG.Actor.typeLabels[\n                  this.actor.type as keyof typeof CONFIG.Actor.typeLabels\n                ]\n              ),\n            })\n          );\n          return false;\n        }\n\n        const manager =\n          dnd5e.applications.advacement.AdvancementManager.forNewItem(\n            this.actor,\n            itemData\n          );\n        if (manager.steps.length) {\n          manager.render(true);\n          return false;\n        }\n      }\n\n      // Adjust the preparation mode of a leveled spell depending on the section on which it is dropped.\n      if (itemData.type === 'spell') this._onDropSpell(itemData);\n\n      return itemData;\n    }\n\n    /**\n     * Stack identical consumables when a new one is dropped rather than creating a duplicate item.\n     */\n    _onDropStackConsumables(\n      itemData: any,\n      { container = null } = {},\n      event: DragEvent\n    ): Promise<Item5e> | null {\n      return FoundryAdapter.onDropStackConsumablesForActor(\n        this.actor,\n        itemData,\n        { container },\n        event\n      );\n    }\n\n    /**\n     * Reset certain pieces of data stored on items when they are dropped onto the actor.\n     */\n    _onDropResetData(itemData: any) {\n      if (!itemData.system) return;\n      ['attuned', 'equipped', 'proficient', 'prepared'].forEach(\n        (k) => delete itemData.system[k]\n      );\n    }\n\n    /**\n     * Adjust the preparation mode of a dropped spell depending on the drop location on the sheet.\n     */\n    _onDropSpell(itemData: any) {\n      if (!['npc', 'character'].includes(this.document.type)) return;\n\n      const dropTarget = this._currentDragEvent?.target;\n\n      if (!dropTarget || !(dropTarget instanceof HTMLElement)) {\n        return;\n      }\n\n      // Determine the section it is dropped on, if any.\n      let header = dropTarget.closest<HTMLElement>('.items-header'); // Dropped directly on the header.\n      if (header === null) {\n        const list = dropTarget.closest<HTMLElement>('.item-list'); // Dropped inside an existing list.\n        header =\n          list?.previousElementSibling instanceof HTMLElement\n            ? list.previousElementSibling\n            : null;\n      }\n\n      const { level, preparationMode } =\n        header?.closest<HTMLElement>('[data-level]')?.dataset ?? {};\n\n      // Determine the actor's spell slot progressions, if any.\n      const spellcastKeys = Object.keys(CONFIG.DND5E.spellcastingTypes);\n      const progs = Object.values(this.document.classes).reduce<Set<string>>(\n        (acc: any, cls: any) => {\n          const type = cls.spellcasting?.type;\n          if (spellcastKeys.includes(type)) acc.add(type);\n          return acc;\n        },\n        new Set()\n      );\n\n      const prep = itemData.system.preparation;\n\n      // Case 1: Drop a cantrip.\n      if (itemData.system.level === 0 && preparationMode) {\n        const modes = CONFIG.DND5E.spellPreparationModes;\n\n        const mode =\n          modes[\n            preparationMode as keyof typeof CONFIG.DND5E.spellPreparationModes\n          ] ?? {};\n\n        if ('cantrips' in mode && mode.cantrips) {\n          prep.mode = 'prepared';\n        } else if (!preparationMode) {\n          const isCaster =\n            this.document.system.details.spellLevel || progs.size;\n          prep.mode = isCaster ? 'prepared' : 'innate';\n        } else {\n          prep.mode = preparationMode;\n        }\n\n        if ('prepares' in mode && mode.prepares) {\n          prep.prepared = true;\n        }\n      }\n\n      // Case 2: Drop a leveled spell in a section without a mode.\n      else if (level === '0' || !preparationMode) {\n        if (this.document.type === 'npc') {\n          prep.mode = this.document.system.details.spellLevel\n            ? 'prepared'\n            : 'innate';\n        } else {\n          const m = progs.has('leveled')\n            ? 'prepared'\n            : firstOfSet(progs) ?? 'innate';\n          prep.mode = progs.has(prep.mode) ? prep.mode : m;\n        }\n      }\n\n      // Case 3: Drop a leveled spell in a specific section.\n      else prep.mode = preparationMode;\n    }\n\n    async _onDropFolder(\n      event: DragEvent & { currentTarget: HTMLElement },\n      data: Record<string, any>\n    ): Promise<object | boolean | undefined> {\n      if (!this.actor.isOwner) {\n        return [];\n      }\n\n      const folder = await Folder.implementation.fromDropData(data);\n\n      if (folder.type !== 'Item') {\n        return [];\n      }\n\n      const droppedItemData = await Promise.all(\n        folder.contents.map(async (item: any) => {\n          if (!(item instanceof Item)) item = await fromUuid(item.uuid);\n          return item;\n        })\n      );\n\n      return this._onDropItemCreate(droppedItemData, event);\n    }\n\n    /* -------------------------------------------- */\n    /*  Event Listeners and Handlers                */\n    /* -------------------------------------------- */\n\n    /**\n     * Handle header control button clicks to render the Prototype Token configuration sheet.\n     * @this {ActorSheetV2}\n     * @param {PointerEvent} event\n     */\n    static async #onConfigureToken(\n      this: { position: ApplicationPosition; token?: any; actor?: Actor5e },\n      event: PointerEvent\n    ) {\n      event.preventDefault();\n      const renderOptions = {\n        left: Math.max(this.position.left - 560 - 10, 10),\n        top: this.position.top,\n      };\n      if (this.token) {\n        return this.token.sheet.render(true, renderOptions);\n      } else {\n        new CONFIG.Token.prototypeSheetClass(\n          this.actor.prototypeToken,\n          renderOptions\n        ).render(true);\n      }\n    }\n\n    /* -------------------------------------------- */\n\n    /**\n     * Handle header control button clicks to display actor portrait artwork.\n     * @this {ActorSheetV2}\n     * @param {PointerEvent} event\n     */\n    static async #onShowPortraitArtwork(\n      this: { actor?: Actor5e },\n      event: PointerEvent\n    ) {\n      const { img, name, uuid } = this.actor;\n      new ImagePopout(img, { title: name, uuid: uuid }).render(true);\n    }\n\n    /* -------------------------------------------- */\n\n    /**\n     * Handle header control button clicks to display actor portrait artwork.\n     * @this {ActorSheetV2}\n     * @param {PointerEvent} event\n     */\n    static async #onShowTokenArtwork(\n      this: { actor?: Actor5e },\n      event: PointerEvent\n    ) {\n      const { prototypeToken, name, uuid } = this.actor;\n      new ImagePopout(prototypeToken.texture.src, {\n        title: name,\n        uuid: uuid,\n      }).render(true);\n    }\n  }\n\n  return Tidy5eActorSheetBase;\n}\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { TidyFlags } from 'src/foundry/TidyFlags';\n  import TidySwitch from 'src/components/toggles/TidySwitch.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { settings } from 'src/settings/settings.svelte';\n  import type { MouseEventHandler } from 'svelte/elements';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n  interface Props {\n    ondblclick?: MouseEventHandler<HTMLElement>;\n    [key: string]: any;\n  }\n\n  let { ondblclick, ...rest }: Props = $props();\n\n  let context =\n    $derived(getSheetContext<{ document: any; editable: boolean }>());\n\n  async function toggleLock() {\n    await TidyFlags.allowEdit.set(context.document, !allowEdit);\n  }\n\n  const localize = FoundryAdapter.localize;\n  let allowEdit = $derived(TidyFlags.allowEdit.get(context.document));\n  let descriptionVariable = $derived(\n    settings.value.useTotalSheetLock\n      ? localize('TIDY5E.SheetLock.Description')\n      : localize('TIDY5E.SheetEdit.Description'),\n  );\n  let lockHintVariable = $derived(\n    settings.value.useTotalSheetLock\n      ? 'TIDY5E.SheetLock.Unlock.Hint'\n      : 'TIDY5E.SheetEdit.Enable.Hint',\n  );\n  let unlockHintVariable = $derived(\n    settings.value.useTotalSheetLock\n      ? 'TIDY5E.SheetLock.Lock.Hint'\n      : 'TIDY5E.SheetEdit.Disable.Hint',\n  );\n  let unlockTitle = $derived(\n    localize(unlockHintVariable, {\n      description: descriptionVariable,\n    }),\n  );\n  let lockTitle = $derived(\n    localize(lockHintVariable, {\n      description: descriptionVariable,\n    }),\n  );\n</script>\n\n{#if context.editable}\n  <div\n    class=\"header-sheet-edit-mode-toggle {rest.class ?? ''}\"\n    data-tidy-sheet-part={CONSTANTS.SHEET_PARTS.SHEET_LOCK_TOGGLE}\n    ondblclick={(event) => {\n      event.stopPropagation();\n      ondblclick?.(event);\n    }}\n  >\n    <TidySwitch\n      --tidy-switch-scale=\"1\"\n      --tidy-switch-thumb-transform-duration=\"0.15s\"\n      title={allowEdit ? unlockTitle : lockTitle}\n      checked={allowEdit}\n      thumbIconClass=\"{allowEdit ? 'fas fa-unlock' : 'fas fa-lock'} fa-fw\"\n      onChange={() => toggleLock()}\n    ></TidySwitch>\n  </div>\n{/if}\n","import { CONSTANTS } from 'src/constants';\nimport {\n  type ApplicationClosingOptions,\n  type ApplicationConfiguration,\n  type ApplicationRenderOptions,\n} from 'src/types/application.types';\nimport { mount } from 'svelte';\nimport GroupSheet from './group/GroupSheet.svelte';\nimport type {\n  Actor5e,\n  ActorInventoryTypes,\n  MessageBus,\n  Utilities,\n} from 'src/types/types';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport type {\n  Group5e,\n  Group5eMember,\n  Group5eXp,\n  GroupItemContext,\n  GroupLanguage,\n  GroupMemberContext,\n  GroupMemberSection,\n  GroupMemberSkillInfo,\n  GroupSheetClassicContext,\n  GroupSkill,\n} from 'src/types/group.types';\nimport { Inventory } from 'src/features/sections/Inventory';\nimport { settings } from 'src/settings/settings.svelte';\nimport { ActorPortraitRuntime } from 'src/runtime/ActorPortraitRuntime';\nimport { getPercentage } from 'src/utils/numbers';\nimport type { Item5e } from 'src/types/item.types';\nimport { Tidy5eActorSheetBaseMixin } from 'src/mixins/Tidy5eActorSheetBaseMixin';\nimport { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\nimport { TidyFlags } from 'src/foundry/TidyFlags';\nimport { Container } from 'src/features/containers/Container';\nimport { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\nimport { ItemFilterService } from 'src/features/filtering/ItemFilterService.svelte';\nimport { DocumentTabSectionConfigApplication } from 'src/applications/section-config/DocumentTabSectionConfigApplication.svelte';\nimport GroupSheetRuntime from 'src/runtime/GroupSheetRuntime.svelte';\nimport { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\nimport { initTidy5eContextMenu } from 'src/context-menu/tidy5e-context-menu';\nimport { debug, warn } from 'src/utils/logging';\nimport { processInputChangeDeltaFromValues } from 'src/utils/form';\nimport { isNil } from 'src/utils/data';\nimport { formatAsModifier } from 'src/utils/formatting';\nimport { SvelteApplicationMixin } from 'src/mixins/SvelteApplicationMixin.svelte';\nimport SheetHeaderEditModeToggle from 'src/sheets/classic/shared/SheetHeaderEditModeToggle.svelte';\nimport { Activities } from 'src/features/activities/activities';\nimport AttachedInfoCard from 'src/components/info-card/AttachedInfoCard.svelte';\nimport { ImportSheetControl } from '../../features/sheet-header-controls/ImportSheetControl';\nimport { SheetSections } from 'src/features/sections/SheetSections';\nimport { ExpansionTracker } from 'src/features/expand-collapse/ExpansionTracker.svelte';\n\ntype MemberStats = {\n  currentHP: number;\n  maxHP: number;\n  memberCount: number;\n  vehicleCount: number;\n};\n\nexport class Tidy5eGroupSheetClassic extends Tidy5eActorSheetBaseMixin(\n  SvelteApplicationMixin<GroupSheetClassicContext>(\n    foundry.applications.sheets.ActorSheetV2\n  )\n) {\n  sectionExpansionTracker = new ExpansionTracker(\n    true,\n    CONSTANTS.LOCATION_SECTION\n  );\n\n  constructor(...args: any[]) {\n    super(...args);\n\n    this._supportedItemTypes = new Set(Inventory.getDefaultInventoryTypes());\n    this._supportedItemTypes.add(CONSTANTS.ITEM_TYPE_SPELL);\n    this.#itemFilterService = new ItemFilterService({}, this.actor);\n  }\n\n  static DEFAULT_OPTIONS: Partial<\n    ApplicationConfiguration & { dragDrop: Partial<DragDropConfiguration>[] }\n  > = {\n    classes: [\n      CONSTANTS.MODULE_ID,\n      'sheet',\n      'actor',\n      CONSTANTS.SHEET_TYPE_GROUP,\n      'app-v2',\n      CONSTANTS.SHEET_LAYOUT_CLASSIC,\n    ],\n    tag: 'form',\n    window: {\n      frame: true,\n      positioned: true,\n      resizable: true,\n      controls: [\n        ImportSheetControl.getSheetControl(),\n        this.ACTOR_ACTIONS_AND_CONTROLS.configureToken.control,\n        this.ACTOR_ACTIONS_AND_CONTROLS.showPortraitArtwork.control,\n        this.ACTOR_ACTIONS_AND_CONTROLS.showTokenArtwork.control,\n        this.ACTOR_ACTIONS_AND_CONTROLS.openTabSelection.control,\n      ],\n    },\n    position: {\n      width: 600,\n      height: 700,\n    },\n    dragDrop: [\n      {\n        dragSelector: '[data-member-drag]',\n      },\n    ],\n    actions: {\n      [ImportSheetControl.actionName]: async function (this: any) {\n        await ImportSheetControl.importFromCompendium(this, this.document);\n      },\n      ...this.ACTOR_ACTIONS_AND_CONTROLS.configureToken.action,\n      ...this.ACTOR_ACTIONS_AND_CONTROLS.showPortraitArtwork.action,\n      ...this.ACTOR_ACTIONS_AND_CONTROLS.showTokenArtwork.action,\n      ...this.ACTOR_ACTIONS_AND_CONTROLS.openTabSelection.action,\n    },\n    submitOnClose: false,\n  };\n\n  #itemFilterService: ItemFilterService;\n  #inlineToggleService = new InlineToggleService();\n  messageBus = $state<MessageBus>({ message: undefined });\n\n  // TODO: First render, derive options that come from user preference\n\n  _createComponent(node: HTMLElement): Record<string, any> {\n    const component = mount(GroupSheet, {\n      target: node,\n      context: new Map<any, any>([\n        [CONSTANTS.SVELTE_CONTEXT.CONTEXT, this._context],\n        [\n          CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n          this.#inlineToggleService,\n        ],\n        [CONSTANTS.SVELTE_CONTEXT.ITEM_FILTER_SERVICE, this.#itemFilterService],\n        [CONSTANTS.SVELTE_CONTEXT.LOCATION, ''],\n        [CONSTANTS.SVELTE_CONTEXT.MESSAGE_BUS, this.messageBus],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_FILTER,\n          this.#itemFilterService.onFilter.bind(this.#itemFilterService),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.ON_FILTER_CLEAR_ALL,\n          this.#itemFilterService.onFilterClearAll.bind(\n            this.#itemFilterService\n          ),\n        ],\n        [\n          CONSTANTS.SVELTE_CONTEXT.SECTION_EXPANSION_TRACKER,\n          this.sectionExpansionTracker,\n        ],\n      ]),\n    });\n\n    initTidy5eContextMenu(this, globalThis.$(this.element));\n\n    return component;\n  }\n\n  _createAdditionalComponents(content: HTMLElement) {\n    const windowHeader = this.element.querySelector('.window-header');\n    const sheetLock = mount(SheetHeaderEditModeToggle, {\n      target: windowHeader,\n      anchor: windowHeader.querySelector('.window-title'),\n      context: new Map<string, any>([\n        [CONSTANTS.SVELTE_CONTEXT.CONTEXT, this._context],\n      ]),\n      props: {\n        class: 'header-control',\n      },\n    });\n\n    const infoCard = mount(AttachedInfoCard, {\n      target: content,\n      props: {\n        sheet: this,\n      },\n    });\n\n    return [sheetLock, infoCard];\n  }\n\n  async _prepareContext(\n    options: ApplicationRenderOptions\n  ): Promise<GroupSheetClassicContext> {\n    let xp: Group5eXp | undefined = undefined;\n    if (\n      FoundryAdapter.getSystemSetting(\n        CONSTANTS.SYSTEM_SETTING_LEVELING_MODE\n      ) !== CONSTANTS.SYSTEM_SETTING_LEVELING_MODE_NO_XP\n    ) {\n      xp = this.actor.system.details.xp;\n    }\n\n    const descriptionFullEnrichedHtml = await TextEditor.enrichHTML(\n      this.actor.system.description.full,\n      {\n        secrets: this.actor.isOwner,\n        rollData: this.actor.getRollData(),\n        relativeTo: this.actor,\n      }\n    );\n\n    const {\n      sections: memberSections,\n      stats,\n      memberContext,\n      groupLanguages,\n      groupSkills,\n    } = this.#prepareMembers();\n\n    const source = this.actor.toObject();\n\n    const unlocked =\n      FoundryAdapter.isSheetUnlocked(this.actor) && this.isEditable;\n\n    const editable = this.isEditable;\n\n    const summary = this.#getSummary(stats);\n\n    const movement = this.#prepareMovementSpeed();\n\n    const sheetPreferences = SheetPreferencesService.getByType(this.actor.type);\n\n    const membersSortMode =\n      sheetPreferences.tabs?.[CONSTANTS.TAB_GROUP_MEMBERS]?.sort ?? 'm';\n\n    const inventorySortMode =\n      sheetPreferences.tabs?.[CONSTANTS.TAB_ACTOR_INVENTORY]?.sort ?? 'm';\n\n    const utilities: Utilities<GroupSheetClassicContext> = {\n      [CONSTANTS.TAB_GROUP_MEMBERS]: {\n        utilityToolbarCommands: [\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeAlpha'),\n            iconClass: 'fa-solid fa-arrow-down-a-z fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_GROUP_MEMBERS,\n                'sort',\n                'm'\n              );\n            },\n            visible: membersSortMode === 'a',\n          },\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeManual'),\n            iconClass: 'fa-solid fa-arrow-down-short-wide fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_GROUP_MEMBERS,\n                'sort',\n                'a'\n              );\n            },\n            visible: membersSortMode === 'm',\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Group.ShowMemberTabInfoPanel'\n            ),\n            iconClass: 'fa-solid fa-people-group fa-fw',\n            execute: async () => {\n              await TidyFlags.showGroupMemberTabInfoPanel.set(this.actor, true);\n            },\n            visible:\n              FoundryAdapter.userIsGm() &&\n              !TidyFlags.showGroupMemberTabInfoPanel.get(this.actor),\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Group.HideMemberTabInfoPanel'\n            ),\n            iconClass: 'fa-solid fa-people-group fa-fw active',\n            execute: async () => {\n              await TidyFlags.showGroupMemberTabInfoPanel.unset(this.actor);\n            },\n            visible:\n              FoundryAdapter.userIsGm() &&\n              TidyFlags.showGroupMemberTabInfoPanel.get(this.actor),\n          },\n        ],\n      },\n      [CONSTANTS.TAB_ACTOR_INVENTORY]: {\n        utilityToolbarCommands: [\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeAlpha'),\n            iconClass: 'fa-solid fa-arrow-down-a-z fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_INVENTORY,\n                'sort',\n                'm'\n              );\n            },\n            visible: inventorySortMode === 'a',\n          },\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeManual'),\n            iconClass: 'fa-solid fa-arrow-down-short-wide fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.actor.type,\n                CONSTANTS.TAB_ACTOR_INVENTORY,\n                'sort',\n                'a'\n              );\n            },\n            visible: inventorySortMode === 'm',\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Commands.HideContainerPanel'\n            ),\n            iconClass: `fas fa-boxes-stacked fa-fw`,\n            execute: () => {\n              TidyFlags.showContainerPanel.unset(this.actor);\n            },\n            visible: !!TidyFlags.showContainerPanel.get(this.actor),\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Commands.ShowContainerPanel'\n            ),\n            iconClass: `fas fa-box fa-fw`,\n            execute: () => {\n              TidyFlags.showContainerPanel.set(this.actor, true);\n            },\n            visible: !TidyFlags.showContainerPanel.get(this.actor),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.ExpandAll'),\n            iconClass: 'fas fa-angles-down',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_INVENTORY,\n                true\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.Commands.CollapseAll'),\n            iconClass: 'fas fa-angles-up',\n            execute: () =>\n              this.sectionExpansionTracker.setAll(\n                CONSTANTS.TAB_ACTOR_INVENTORY,\n                false\n              ),\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.ListLayout'),\n            iconClass: 'fas fa-th-list fa-fw toggle-list',\n            visible: !TidyFlags.inventoryGrid.get(this.actor),\n            execute: () => {\n              TidyFlags.inventoryGrid.set(this.actor);\n            },\n          },\n          {\n            title: FoundryAdapter.localize('TIDY5E.GridLayout'),\n            iconClass: 'fas fa-th-large fa-fw toggle-grid',\n            visible: !!TidyFlags.inventoryGrid.get(this.actor),\n            execute: () => {\n              TidyFlags.inventoryGrid.unset(this.actor);\n            },\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Utilities.ConfigureSections'\n            ),\n            iconClass: 'fas fa-cog',\n            execute: ({ context, sections }) => {\n              new DocumentTabSectionConfigApplication({\n                document: context.actor,\n                sections: sections,\n                tabId: CONSTANTS.TAB_ACTOR_INVENTORY,\n                tabTitle: GroupSheetRuntime.getTabTitle(\n                  CONSTANTS.TAB_ACTOR_INVENTORY\n                ),\n              }).render(true);\n            },\n          },\n        ],\n      },\n    };\n\n    const uncontainedItems: Item5e[] = Array.from(this.actor.items).filter(\n      (i: Item5e) => !this.actor.items.has(i.system.container)\n    );\n\n    const inventoryTypesArray = Inventory.getDefaultInventoryTypes();\n    const inventoryTypes = new Set(inventoryTypesArray);\n    const inventory: ActorInventoryTypes =\n      Inventory.getDefaultInventorySections();\n\n    for (let item of uncontainedItems) {\n      if (inventoryTypes.has(item.type)) {\n        Inventory.applyInventoryItemToSection(\n          inventory,\n          item,\n          inventoryTypesArray,\n          {\n            canCreate: true,\n          }\n        );\n      }\n    }\n\n    SheetSections.getFilteredGlobalSectionsToShowWhenEmpty(\n      this.actor,\n      CONSTANTS.TAB_ACTOR_INVENTORY\n    ).forEach((s) => {\n      inventory[s] ??= Inventory.createInventorySection(\n        s,\n        inventoryTypesArray,\n        {\n          canCreate: true,\n        }\n      );\n    });\n\n    let context: GroupSheetClassicContext = {\n      actor: this.actor,\n      actorPortraitCommands:\n        ActorPortraitRuntime.getEnabledPortraitMenuCommands(this.actor),\n      canObserveAll: Object.values(memberContext).every((m) => m.canObserve),\n      config: CONFIG.DND5E,\n      containerPanelItems: await Inventory.getContainerPanelItems(\n        uncontainedItems\n      ),\n      currentHP: stats.currentHP,\n      customContent: GroupSheetRuntime.content,\n      descriptionFullEnrichedHtml: descriptionFullEnrichedHtml,\n      disableExperience:\n        FoundryAdapter.getSystemSetting(\n          CONSTANTS.SYSTEM_SETTING_LEVELING_MODE\n        ) === CONSTANTS.SYSTEM_SETTING_LEVELING_MODE_NO_XP,\n      document: this.actor,\n      editable: editable,\n      effects: dnd5e.applications.components.EffectsElement.prepareCategories(\n        this.actor.allApplicableEffects()\n      ),\n      filterData: this.#itemFilterService.getDocumentItemFilterData(),\n      filterPins: ItemFilterRuntime.defaultFilterPins[this.actor.type],\n      groupLanguages: groupLanguages,\n      groupSkills: groupSkills,\n      healthPercentage: getPercentage(stats.currentHP, stats.maxHP),\n      inventory: Object.values(inventory),\n      isGM: game.user.isGM,\n      itemContext: {},\n      items: Array.from(this.actor.items),\n      limited: this.actor.limited,\n      lockSensitiveFields:\n        (!unlocked && settings.value.useTotalSheetLock) || !editable,\n      maxHP: stats.maxHP,\n      memberContext: memberContext,\n      memberSections: memberSections,\n      modernRules: FoundryAdapter.checkIfModernRules(this.actor),\n      movement: movement,\n      owner: this.actor.isOwner,\n      showContainerPanel:\n        TidyFlags.showContainerPanel.get(this.actor) === true &&\n        Array.from(uncontainedItems).some(\n          (i: Item5e) => i.type === CONSTANTS.ITEM_TYPE_CONTAINER\n        ),\n      showGroupMemberTabInfoPanel: TidyFlags.showGroupMemberTabInfoPanel.get(\n        this.actor\n      ),\n      source: source,\n      summary: summary,\n      system: this.actor.system,\n      tabs: [],\n      unlocked: unlocked,\n      useClassicControls: true, // TODO: Establish setting for this; and group section in settings\n      useRoundedPortraitStyle: [\n        CONSTANTS.CIRCULAR_PORTRAIT_OPTION_ALL as string,\n      ].includes(settings.value.useCircularPortraitStyle),\n      utilities: utilities,\n      xp: xp,\n    };\n\n    await this._prepareItems(context);\n\n    let tabs = await GroupSheetRuntime.getTabs(context);\n\n    const selectedTabs = TidyFlags.selectedTabs.get(context.actor);\n\n    if (selectedTabs?.length) {\n      tabs = tabs\n        .filter((t) => selectedTabs?.includes(t.id))\n        .sort(\n          (a, b) => selectedTabs.indexOf(a.id) - selectedTabs.indexOf(b.id)\n        );\n    } else {\n      const defaultTabs: string[] = GroupSheetRuntime.getDefaultTabs();\n      tabs = tabs\n        .filter((t) => defaultTabs?.includes(t.id))\n        .sort((a, b) => defaultTabs.indexOf(a.id) - defaultTabs.indexOf(b.id));\n    }\n\n    context.tabs = tabs;\n\n    return context;\n  }\n\n  #getSummary(stats: MemberStats) {\n    const formatter = game.i18n.getListFormatter({\n      style: 'long',\n      type: 'conjunction',\n    });\n    const rule = new Intl.PluralRules(game.i18n.lang);\n    const members = [];\n    if (stats.memberCount) {\n      members.push(\n        `${stats.memberCount} ${game.i18n.localize(\n          `DND5E.Group.Member.${rule.select(stats.memberCount)}`\n        )}`\n      );\n    }\n    if (stats.vehicleCount) {\n      members.push(\n        `${stats.vehicleCount} ${game.i18n.localize(\n          `DND5E.Group.Vehicle.${rule.select(stats.vehicleCount)}`\n        )}`\n      );\n    }\n    if (!members.length) return game.i18n.localize('DND5E.GroupSummaryEmpty');\n    return game.i18n.format('DND5E.GroupSummary', {\n      members: formatter.format(members),\n    });\n  }\n\n  #prepareMembers(): {\n    sections: GroupMemberSection[];\n    stats: MemberStats;\n    memberContext: GroupSheetClassicContext['memberContext'];\n    groupLanguages: GroupLanguage[];\n    groupSkills: GroupSkill[];\n  } {\n    const stats: MemberStats = {\n      currentHP: 0,\n      maxHP: 0,\n      memberCount: 0,\n      vehicleCount: 0,\n    };\n\n    const sections: Record<string, GroupMemberSection> = {\n      character: {\n        label: `${CONFIG.Actor.typeLabels.character}Pl`,\n        members: [],\n        dataset: {},\n        key: 'character',\n        show: true,\n        custom: undefined,\n        isExternal: false,\n        showCrColumn: false,\n      },\n      npc: {\n        label: `${CONFIG.Actor.typeLabels.npc}Pl`,\n        members: [],\n        dataset: {},\n        key: 'npc',\n        show: true,\n        custom: undefined,\n        isExternal: false,\n        showCrColumn: true,\n      },\n      vehicle: {\n        label: `${CONFIG.Actor.typeLabels.vehicle}Pl`,\n        members: [],\n        dataset: {},\n        key: 'vehicle',\n        show: true,\n        custom: undefined,\n        isExternal: false,\n        showCrColumn: false,\n      },\n    };\n\n    const type = this.actor.system.type.value;\n\n    const memberContext: GroupSheetClassicContext['memberContext'] = {};\n\n    const groupLanguages: Record<string, GroupLanguage> = {};\n    const groupSkills: Record<string, GroupSkill> = {};\n    const collectAggregates = FoundryAdapter.userIsGm();\n    const configuredSkills = Object.entries(CONFIG.DND5E.skills);\n\n    for (const [index, memberData] of this.actor.system.members.entries()) {\n      const ctx: GroupMemberContext = (memberContext[memberData.actor.id] = {\n        index: index,\n        quantity: memberData.quantity,\n        canObserve: memberData.actor.testUserPermission(game.user, 'OBSERVER'),\n        senses: [],\n        conditionImmunities: [],\n        topSkills: [],\n      });\n\n      const member = memberData.actor;\n      const hp = member.system.attributes.hp;\n      const multiplier =\n        type === 'encounter' ? memberData.quantity.value ?? 1 : 1;\n\n      const memberCurrentHp = hp.value + (hp.temp || 0);\n      const memberMaxHp = Math.max(0, hp.effectiveMax);\n\n      stats.currentHP += memberCurrentHp * multiplier;\n      stats.maxHP += memberMaxHp * multiplier;\n\n      if (member.type === 'vehicle') {\n        stats.vehicleCount += multiplier;\n      } else {\n        stats.memberCount += multiplier;\n      }\n\n      sections[member.type].members.push(member);\n\n      if (collectAggregates && member.system.traits?.languages?.value) {\n        const customLanguageString =\n          member.system.traits.languages.custom?.trim();\n        const customLanguages = isNil(customLanguageString, '')\n          ? []\n          : dnd5e.utils.splitSemicolons(customLanguageString);\n        const languageKeys = [\n          ...member.system.traits.languages.value,\n          ...customLanguages,\n        ];\n\n        for (let key of languageKeys) {\n          const language = dnd5e.documents.Trait.keyLabel(key, {\n            trait: 'languages',\n          });\n\n          const groupLanguage = (groupLanguages[language] ??=\n            this.#createEmptyGroupLanguage(language));\n\n          groupLanguage.members.push(member);\n        }\n      }\n\n      if (collectAggregates && member.system.skills) {\n        for (let [key, skill] of Object.entries<any>(member.system.skills)) {\n          const groupSkill = (groupSkills[key] ??=\n            this.#createEmptyGroupSkill(key));\n\n          groupSkill.total = Math.max(groupSkill.total, skill.total);\n          groupSkill.members.push(member);\n        }\n      }\n\n      if (ctx.canObserve) {\n        // Member Senses\n        const senses = member.system.attributes.senses ?? {};\n        const tags: Record<string, string> = {};\n        for (let [k, label] of Object.entries(CONFIG.DND5E.senses)) {\n          const v = senses[k] ?? 0;\n          if (v === 0) continue;\n          tags[k] = `${game.i18n.localize(label)} ${v} ${\n            senses.units ??\n            Object.values(CONFIG.DND5E.movementUnits)[0].abbreviation\n          }`;\n        }\n        if (senses.special)\n          dnd5e.utils\n            .splitSemicolons(senses.special)\n            .forEach(\n              (c: string, i: number) => (tags[`custom${i + 1}`] = c.trim())\n            );\n        ctx.senses = Object.values(tags);\n\n        // Member Condition Immunities\n        const conditionImmunities: string[] = [];\n        for (let entry of member.system.traits.ci.value) {\n          conditionImmunities.push(\n            CONFIG.DND5E.conditionTypes[\n              entry as keyof typeof CONFIG.DND5E.conditionTypes\n            ]?.label ?? entry\n          );\n        }\n\n        const customImmunity = member.system.traits.ci.custom?.trim();\n        if (!isNil(customImmunity, '')) {\n          conditionImmunities.push(customImmunity);\n        }\n\n        ctx.conditionImmunities = conditionImmunities;\n\n        // Perception and Top Skills\n\n        let skills: GroupMemberSkillInfo[];\n        skills = member.system.skills\n          ? Array.from(configuredSkills).reduce<GroupMemberSkillInfo[]>(\n              (prev, [key, configSkill]: [string, any]) => {\n                const skill = this.#getSkill(member, key);\n\n                if (!skill) {\n                  warn(\n                    'Unable to find skill. Ensure custom skills are added at \"init\" time.',\n                    false,\n                    { key, configSkill }\n                  );\n                  return prev;\n                }\n\n                const label =\n                  CONFIG.DND5E.skills[key as keyof typeof CONFIG.DND5E.skills]\n                    ?.label ?? key;\n\n                prev.push({\n                  key: key,\n                  label: label,\n                  passive: skill.passive,\n                  total: skill.total,\n                  formattedTotal: formatAsModifier(skill.total),\n                });\n\n                return prev;\n              },\n              []\n            )\n          : [];\n\n        ctx.topSkills = skills\n          .filter((s) => s.key !== CONSTANTS.SKILL_KEY_PERCEPTION)\n          .sort((a, b) => b.total - a.total)\n          .slice(0, 4);\n\n        ctx.perception = skills.find(\n          (s) => s.key === CONSTANTS.SKILL_KEY_PERCEPTION\n        );\n      }\n    }\n\n    return {\n      sections: Object.values(sections).filter((s) => s.members.length > 0),\n      stats: stats,\n      memberContext: memberContext,\n      groupLanguages: Object.values(groupLanguages).sort((a, b) =>\n        a.label.localeCompare(b.label, game.i18n.lang)\n      ),\n      groupSkills: Object.values(groupSkills).sort((a, b) =>\n        a.label.localeCompare(b.label, game.i18n.lang)\n      ),\n    };\n  }\n\n  #createEmptyGroupLanguage(language: any): GroupLanguage {\n    return {\n      label: language,\n      members: [],\n    };\n  }\n\n  #createEmptyGroupSkill(key: string): GroupSkill {\n    return {\n      key: key,\n      label:\n        CONFIG.DND5E.skills[key as keyof typeof CONFIG.DND5E.skills]?.label ??\n        key,\n      members: [],\n      total: Number.NEGATIVE_INFINITY,\n    };\n  }\n\n  #prepareMovementSpeed() {\n    const movement = this.actor.system.attributes.movement;\n    let speeds = [\n      [\n        movement.land,\n        `${game.i18n.localize('DND5E.MovementLand')} ${movement.land}`,\n      ],\n      [\n        movement.water,\n        `${game.i18n.localize('DND5E.MovementWater')} ${movement.water}`,\n      ],\n      [\n        movement.air,\n        `${game.i18n.localize('DND5E.MovementAir')} ${movement.air}`,\n      ],\n    ];\n    speeds = speeds.filter((s) => s[0]).sort((a, b) => b[0] - a[0]);\n    const primary = speeds.shift();\n    return {\n      primary: `${primary ? primary[1] : '0'}`,\n      secondary: speeds.map((s) => s[1]).join(', '),\n    };\n  }\n\n  #getSkill(member: Actor5e, key: string): any | null {\n    if (key in member.system.skills) {\n      return member.system.skills[key];\n    }\n\n    return null;\n  }\n\n  async _prepareItems(context: GroupSheetClassicContext) {\n    for (const item of context.items) {\n      if (Inventory.isInventoryType(item)) {\n        context.itemContext[item.id] ??= await this._prepareItem(item, context);\n      }\n    }\n\n    for (const panelItem of context.containerPanelItems) {\n      const ctx = context.itemContext[panelItem.container.id];\n      ctx.containerContents = await Container.getContainerContents(\n        panelItem.container\n      );\n    }\n  }\n\n  async _prepareItem(\n    item: Item5e,\n    context: GroupSheetClassicContext\n  ): Promise<GroupItemContext> {\n    return {\n      activities: Activities.getVisibleActivities(\n        item,\n        item.system.activities\n      )?.map(Activities.getActivityItemContext),\n      canToggle: false,\n      containerContents: undefined,\n      hasUses: item.hasLimitedUses,\n      isStack: item.system.quantity > 1,\n      totalWeight: (await item.system.totalWeight)?.toNearest(0.1) ?? 0,\n    };\n  }\n\n  _configureEffects() {\n    let first = true;\n\n    $effect(() => {\n      settings;\n\n      if (first) {\n        return;\n      }\n\n      this.render();\n    });\n\n    $effect(() => {\n      debug('Message bus message received', {\n        app: this,\n        actor: this.actor,\n        message: this.messageBus,\n      });\n    });\n\n    first = false;\n  }\n\n  async _renderHTML(\n    context: GroupSheetClassicContext,\n    options: ApplicationRenderOptions\n  ) {\n    game.user.apps[this.id] = this;\n    for (const member of this.actor.system.members) {\n      member.actor.apps[this.id] = this;\n    }\n    return await super._renderHTML(context, options);\n  }\n\n  async close(options: ApplicationClosingOptions = {}) {\n    delete game.user.apps[this.id];\n    for (const member of this.actor.system.members) {\n      delete member.actor.apps[this.id];\n    }\n    return await super.close(options);\n  }\n\n  // ---------------------------------------------\n  // Drag and Drop\n  // ---------------------------------------------\n\n  _onDragStart(\n    event: DragEvent & { currentTarget: HTMLElement; target: HTMLElement }\n  ): void {\n    const memberId = event.currentTarget\n      .closest('[data-member-drag][data-member-id]')\n      ?.getAttribute('data-member-id');\n\n    if (!memberId) {\n      super._onDragStart(event);\n      return;\n    }\n\n    const actor = this.#findMemberActor(memberId);\n\n    if (!actor) {\n      return;\n    }\n\n    const dragData = actor.toDragData();\n    dragData['groupId'] = this.actor.id;\n    event.dataTransfer?.setData('text/plain', JSON.stringify(dragData));\n  }\n\n  async _onDropActiveEffect(\n    ..._args: any[]\n  ): Promise</*ActiveEffect*/ unknown | boolean> {\n    // Tidy Group Sheet doesn't support active effect drops.\n    return false;\n  }\n\n  async _onDropActor(\n    event: DragEvent & { currentTarget: HTMLElement; target: HTMLElement },\n    data: any\n  ): Promise<object | boolean | undefined> {\n    if (!this.isEditable) {\n      return false;\n    }\n\n    const cls = getDocumentClass('Actor');\n    const sourceActor = await cls.fromDropData(data);\n    if (!sourceActor) {\n      return;\n    }\n\n    const groupId = data['groupId'];\n\n    if (groupId !== this.actor.id) {\n      return this.actor.system.addMember(sourceActor);\n    }\n\n    const dropTarget = event.target?.closest<HTMLElement>(\n      '[data-member-drag][data-member-id]'\n    );\n    const targetMemberId = dropTarget?.getAttribute('data-member-id');\n\n    const targetMemberActor = this.#findMemberActor(targetMemberId);\n\n    if (\n      !dropTarget ||\n      !targetMemberActor ||\n      targetMemberId === sourceActor.id\n    ) {\n      return false;\n    }\n\n    return await this._onSortMember(sourceActor, targetMemberActor);\n  }\n\n  #findMemberActor(actorId: string | null | undefined): Actor5e | undefined {\n    return this.actor.system.members.find(\n      (m: Group5eMember) => m.actor.id === actorId\n    )?.actor;\n  }\n\n  async _onSortMember(sourceActor: Actor5e, targetActor: Actor5e) {\n    const membersCollection: Group5eMember[] =\n      this.actor.system.toObject().members;\n    const sourceIndex = membersCollection.findIndex(\n      (m) => m.actor === sourceActor.id\n    );\n    const targetIndex = membersCollection.findIndex(\n      (m) => m.actor === targetActor.id\n    );\n\n    const sortBefore = sourceIndex > targetIndex;\n\n    if (sortBefore) {\n      const sourceMember = membersCollection.splice(sourceIndex, 1)[0];\n      membersCollection.splice(targetIndex, 0, sourceMember);\n    } else {\n      const sourceMember = membersCollection[sourceIndex];\n      membersCollection.splice(targetIndex + 1, 0, sourceMember);\n      membersCollection.splice(sourceIndex, 1);\n    }\n\n    return await this.actor.update({ 'system.members': membersCollection });\n  }\n\n  async _onDropFolder(\n    event: DragEvent & { currentTarget: HTMLElement; target: HTMLElement },\n    data: Record<string, any>\n  ) {\n    if (!this.isEditable) {\n      return false;\n    }\n\n    const folder = await Folder.implementation.fromDropData(data);\n\n    if (folder.type === 'Actor') {\n      const results: any[] = [];\n      for (let actor of folder.contents) {\n        results.push(await this.actor.system.addMember(actor));\n      }\n      return results;\n    }\n\n    return await super._onDropFolder(event, data);\n  }\n\n  // ---------------------------------------------\n  // Actions\n  // ---------------------------------------------\n\n  award() {\n    const award = new dnd5e.applications.Award(this.actor, {\n      savedDestinations: this.actor.getFlag('dnd5e', 'awardDestinations'),\n    });\n    award.render(true);\n  }\n\n  async updateMemberQuantity(\n    memberActorId: string,\n    event: Event & {\n      currentTarget: EventTarget & HTMLInputElement;\n    }\n  ): Promise<Group5e | undefined> {\n    const membersCollection = this.actor.system.toObject().members;\n\n    const index = membersCollection.findIndex(\n      (m: any) => m.actor === memberActorId\n    );\n\n    const originalValue = membersCollection[index].quantity.value;\n\n    const amount = event.currentTarget.value;\n    const newQuantity =\n      amount?.trim() === ''\n        ? null\n        : processInputChangeDeltaFromValues(amount, originalValue);\n\n    membersCollection[index].quantity.value = newQuantity;\n\n    const result = await this.actor.update({\n      ['system.members']: membersCollection,\n    });\n\n    if (!result) {\n      event.currentTarget.value = originalValue.toString();\n    }\n\n    return result;\n  }\n\n  async updateMemberFormula(\n    memberActorId: string,\n    event: Event & {\n      currentTarget: EventTarget & HTMLInputElement;\n    }\n  ): Promise<Group5e | undefined> {\n    const membersCollection = this.actor.system.toObject().members;\n\n    const index = membersCollection.findIndex(\n      (m: any) => m.actor === memberActorId\n    );\n\n    const originalValue = membersCollection[index].quantity.formula;\n\n    membersCollection[index].quantity.formula = event.currentTarget.value;\n\n    const result = await this.actor.update({\n      ['system.members']: membersCollection,\n    });\n\n    if (!result) {\n      event.currentTarget.value = originalValue;\n    }\n\n    return result;\n  }\n}\n","import { CONSTANTS } from 'src/constants';\nimport { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\nimport { ItemFilterService } from 'src/features/filtering/ItemFilterService.svelte';\nimport { DragAndDropMixin } from 'src/mixins/DragAndDropBaseMixin';\nimport { SvelteApplicationMixin } from 'src/mixins/SvelteApplicationMixin.svelte';\nimport type {\n  ApplicationConfiguration,\n  ApplicationRenderOptions,\n} from 'src/types/application.types';\nimport type {\n  ContainerSheetClassicContext,\n  Item5e,\n  ItemChatData,\n  ItemDescription,\n} from 'src/types/item.types';\nimport type {\n  LocationToSearchTextMap,\n  ExpandedItemIdToLocationsMap,\n  ExpandedItemData,\n  MessageBus,\n  Utilities,\n  Tab,\n} from 'src/types/types';\nimport { mount } from 'svelte';\nimport ContainerSheet from './item/ContainerSheet.svelte';\nimport { initTidy5eContextMenu } from 'src/context-menu/tidy5e-context-menu';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { Container } from 'src/features/containers/Container';\nimport { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\nimport { ItemSheetRuntime } from 'src/runtime/item/ItemSheetRuntime';\nimport { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\nimport { DocumentTabSectionConfigApplication } from 'src/applications/section-config/DocumentTabSectionConfigApplication.svelte';\nimport { TabManager } from 'src/runtime/tab/TabManager';\nimport { TidyHooks } from 'src/foundry/TidyHooks';\nimport { settings } from 'src/settings/settings.svelte';\nimport { Inventory } from 'src/features/sections/Inventory';\nimport { ImportSheetControl } from 'src/features/sheet-header-controls/ImportSheetControl';\nimport { ExpansionTracker } from 'src/features/expand-collapse/ExpansionTracker.svelte';\n\nexport class Tidy5eContainerSheetClassic extends DragAndDropMixin(\n  SvelteApplicationMixin<ContainerSheetClassicContext>(\n    foundry.applications.sheets.ItemSheetV2\n  )\n) {\n  currentTabId: string | undefined = undefined;\n  searchFilters: LocationToSearchTextMap = new Map<string, string>();\n  expandedItems: ExpandedItemIdToLocationsMap = new Map<string, Set<string>>();\n  expandedItemData: ExpandedItemData = new Map<string, ItemChatData>();\n  inlineToggleService = new InlineToggleService();\n  itemFilterService: ItemFilterService;\n  messageBus = $state<MessageBus>({ message: undefined });\n  sectionExpansionTracker = new ExpansionTracker(\n    true,\n    CONSTANTS.LOCATION_SECTION\n  );\n\n  constructor(...args: any[]) {\n    super(...args);\n\n    this.itemFilterService = new ItemFilterService({}, this.item);\n  }\n\n  static DEFAULT_OPTIONS: Partial<\n    ApplicationConfiguration & { dragDrop: Partial<DragDropConfiguration>[] }\n  > = {\n    classes: [\n      CONSTANTS.MODULE_ID,\n      'sheet',\n      'item',\n      CONSTANTS.ITEM_TYPE_CONTAINER,\n      'app-v2',\n      CONSTANTS.SHEET_LAYOUT_CLASSIC,\n    ],\n    tag: 'form',\n    window: {\n      frame: true,\n      positioned: true,\n      resizable: true,\n      controls: [ImportSheetControl.getSheetControl()],\n    },\n    position: {\n      width: 560,\n      height: 600,\n    },\n    actions: {\n      [ImportSheetControl.actionName]: async function (this: any) {\n        await ImportSheetControl.importFromCompendium(this, this.document);\n      },\n    },\n    dragDrop: [{ dropSelector: 'form' }],\n    submitOnClose: false,\n  };\n\n  _createComponent(node: HTMLElement): Record<string, any> {\n    const context = new Map<any, any>([\n      [CONSTANTS.SVELTE_CONTEXT.CONTEXT, this._context],\n      [CONSTANTS.SVELTE_CONTEXT.CURRENT_TAB_ID, this.currentTabId],\n      [CONSTANTS.SVELTE_CONTEXT.MESSAGE_BUS, this.messageBus],\n      [\n        CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n        this.inlineToggleService,\n      ],\n      [CONSTANTS.SVELTE_CONTEXT.ITEM_FILTER_SERVICE, this.itemFilterService],\n      [\n        CONSTANTS.SVELTE_CONTEXT.ON_FILTER,\n        this.itemFilterService.onFilter.bind(this.itemFilterService),\n      ],\n      [\n        CONSTANTS.SVELTE_CONTEXT.ON_FILTER_CLEAR_ALL,\n        this.itemFilterService.onFilterClearAll.bind(this.itemFilterService),\n      ],\n      [CONSTANTS.SVELTE_CONTEXT.SEARCH_FILTERS, new Map(this.searchFilters)],\n      [\n        CONSTANTS.SVELTE_CONTEXT.SECTION_EXPANSION_TRACKER,\n        this.sectionExpansionTracker,\n      ],\n    ]);\n\n    const component = mount(ContainerSheet, {\n      target: node,\n      context: context,\n    });\n\n    const html = globalThis.$(this.element);\n\n    initTidy5eContextMenu(this, html);\n\n    return component;\n  }\n\n  async _prepareContext(\n    options: ApplicationRenderOptions\n  ): Promise<ContainerSheetClassicContext> {\n    const rollData = this.item.getRollData();\n\n    const enrichmentOptions = {\n      secrets: this.item.isOwner,\n      relativeTo: this.item,\n      rollData: rollData,\n    };\n\n    const enriched = {\n      description: await TextEditor.enrichHTML(\n        this.item.system.description.value,\n        enrichmentOptions\n      ),\n      unidentified: await TextEditor.enrichHTML(\n        this.item.system.unidentified?.description,\n        enrichmentOptions\n      ),\n      chat: await TextEditor.enrichHTML(\n        this.item.system.description.chat,\n        enrichmentOptions\n      ),\n    };\n\n    const isIdentifiable = 'identified' in this.item.system;\n\n    const itemDescriptions: ItemDescription[] = [];\n\n    itemDescriptions.push({\n      enriched: enriched.description,\n      content: this.document.system.description.value,\n      field: 'system.description.value',\n      label: FoundryAdapter.localize('DND5E.Description'),\n    });\n\n    if (isIdentifiable && FoundryAdapter.userIsGm()) {\n      itemDescriptions.push({\n        enriched: enriched.unidentified,\n        content: this.document.system.unidentified.description,\n        field: 'system.unidentified.description',\n        label: FoundryAdapter.localize('DND5E.DescriptionUnidentified'),\n      });\n    }\n\n    itemDescriptions.push({\n      enriched: enriched.chat,\n      content: this.document.system.description.chat,\n      field: 'system.description.chat',\n      label: FoundryAdapter.localize('DND5E.DescriptionChat'),\n    });\n\n    const containerPreferences = SheetPreferencesService.getByType(\n      this.item.type\n    );\n\n    const contentsSortMode =\n      containerPreferences.tabs?.[CONSTANTS.TAB_CONTAINER_CONTENTS]?.sort ??\n      'm';\n\n    // Utilities\n    let utilities: Utilities<ContainerSheetClassicContext> = {\n      [CONSTANTS.TAB_CONTAINER_CONTENTS]: {\n        utilityToolbarCommands: [\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeAlpha'),\n            iconClass: 'fa-solid fa-arrow-down-a-z fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.item.type,\n                CONSTANTS.TAB_CONTAINER_CONTENTS,\n                'sort',\n                'm'\n              );\n              this.render();\n            },\n            visible: contentsSortMode === 'a',\n          },\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeManual'),\n            iconClass: 'fa-solid fa-arrow-down-short-wide fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.item.type,\n                CONSTANTS.TAB_CONTAINER_CONTENTS,\n                'sort',\n                'a'\n              );\n              this.render();\n            },\n            visible: contentsSortMode === 'm',\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Utilities.ConfigureSections'\n            ),\n            iconClass: 'fas fa-cog',\n            execute: ({ context, sections }) => {\n              new DocumentTabSectionConfigApplication({\n                document: context.item,\n                // Provide a way to build the necessary config, perhaps within the application constructor. We've got all the info we need in order to perform the operation.\n                sections: sections,\n                tabId: CONSTANTS.TAB_CONTAINER_CONTENTS,\n                tabTitle: ItemSheetRuntime.getTabTitle(\n                  CONSTANTS.TAB_CONTAINER_CONTENTS\n                ),\n              }).render(true);\n            },\n          },\n        ],\n      },\n    };\n\n    const context: ContainerSheetClassicContext = {\n      capacity: await this.item.system.computeCapacity(),\n      concealDetails:\n        !game.user.isGM && this.document.system.identified === false,\n      config: CONFIG.DND5E,\n      containerContents: await Container.getContainerContents(this.item),\n      customContent: [],\n      document: this.document,\n      editable: this.isEditable,\n      enriched: enriched,\n      filterData: this.itemFilterService.getDocumentItemFilterData(),\n      filterPins: ItemFilterRuntime.defaultFilterPins[this.item.type],\n      identifiedName: FoundryAdapter.getIdentifiedName(this.item),\n      isContainer: true,\n      isIdentifiable: isIdentifiable,\n      isIdentified: this.document.system.identified !== false,\n      isPhysical: this.document.system.hasOwnProperty('quantity'),\n      item: this.item,\n      itemContext: await Container.getContainerItemContext(this.item),\n      itemDescriptions: itemDescriptions,\n      itemOverrides: new Set<string>(this._getItemOverrides()),\n      items: Array.from(await this.item.system.contents),\n      // @ts-expect-error\n      itemType: game.i18n.localize(CONFIG.Item.typeLabels[this.item.type]),\n      labels: this.document.labels,\n      lockItemQuantity: FoundryAdapter.shouldLockItemQuantity(),\n      lockMoneyChanges: FoundryAdapter.shouldLockMoneyChanges(),\n      modernRules: FoundryAdapter.checkIfModernRules(this.item),\n      owner: this.item.isOwner,\n      properties: {\n        active: [],\n        object: {},\n        options: [],\n      },\n      rollData: rollData,\n      source: this.document.toObject().system,\n      system: this.document.system,\n      tabs: [],\n      utilities: utilities,\n    };\n\n    // Properties\n    context.properties = {\n      active: [],\n      object: Object.fromEntries(\n        (this.document.system.properties ?? []).map((p: string) => [p, true])\n      ),\n      options: (this.document.system.validProperties ?? [])\n        .reduce(\n          (\n            arr: ContainerSheetClassicContext['properties']['options'],\n            k: any\n          ) => {\n            // @ts-ignore\n            const { label } = CONFIG.DND5E.itemProperties[k];\n            arr.push({\n              label,\n              value: k,\n              selected: this.item._source.system.properties?.includes(k),\n            });\n            return arr;\n          },\n          []\n        )\n        .sort(\n          (\n            a: ContainerSheetClassicContext['properties']['options'][0],\n            b: ContainerSheetClassicContext['properties']['options'][0]\n          ) => a.label.localeCompare(b.label, game.i18n.lang)\n        ),\n    };\n\n    // Tabs\n    context.customContent = await ItemSheetRuntime.getContent(context);\n\n    const eligibleCustomTabs = ItemSheetRuntime.getCustomItemTabs(context);\n\n    const customTabs: Tab[] = await TabManager.prepareTabsForRender(\n      context,\n      eligibleCustomTabs\n    );\n\n    context.tabs = ItemSheetRuntime.sheets[this.item.type]?.defaultTabs() ?? [];\n    context.tabs.push(...customTabs);\n\n    TidyHooks.tidy5eSheetsPreConfigureSections(this, this.element, context);\n\n    return context;\n  }\n\n  /**\n   * Retrieve the list of fields that are currently modified by Active Effects on the Item.\n   */\n  _getItemOverrides(): string[] {\n    const overrides = Object.keys(\n      foundry.utils.flattenObject(this.item.overrides ?? {})\n    );\n    this.item.system.getItemOverrides?.(overrides);\n    if ('properties' in this.item.system) {\n      dnd5e.documents.ActiveEffect5e.addOverriddenChoices(\n        this.item,\n        'system.properties',\n        'system.properties',\n        overrides\n      );\n    }\n    if (\n      'damage' in this.item.system &&\n      foundry.utils.getProperty(this.item.overrides, 'system.damage.parts')\n    ) {\n      overrides.push('damage-control');\n      Array.fromRange(this.item.system.damage.parts.length).forEach((index) =>\n        overrides.push(\n          `system.damage.parts.${index}.0`,\n          `system.damage.parts.${index}.1`\n        )\n      );\n    }\n    return overrides;\n  }\n\n  /* -------------------------------------------- */\n  /*  Drag and Drop                               */\n  /* -------------------------------------------- */\n\n  /** @inheritDoc */\n  async _onDrop(\n    event: DragEvent & { currentTarget: HTMLElement; target: HTMLElement }\n  ): Promise<unknown> {\n    const data = TextEditor.getDragEventData(event);\n    if (!['Item', 'Folder'].includes(data.type)) {\n      return super._onDrop(event);\n    }\n\n    if (TidyHooks.dnd5eDropItemSheetData(this.item, this, data) === false) {\n      return;\n    }\n\n    if (data.type === 'Folder') {\n      return this._onDropFolder(event, data);\n    }\n\n    return this._onDropItem(event, data);\n  }\n\n  /* -------------------------------------------- */\n\n  async _onDropFolder(\n    event: DragEvent & { currentTarget: HTMLElement; target: HTMLElement },\n    data: any\n  ): Promise<Item5e[]> {\n    const folder = await Folder.implementation.fromDropData(data);\n    if (!this.item.isOwner || folder.type !== 'Item') return [];\n\n    let recursiveWarning = false;\n    const parentContainers = await this.item.system.allContainers();\n    const containers = new Set();\n\n    let items = await Promise.all(\n      folder.contents.map(async (item: any) => {\n        if (!(item instanceof Item)) item = await fromUuid(item.uuid);\n        if (item.system.container === this.item.id) return;\n        if (this.item.uuid === item.uuid || parentContainers.includes(item)) {\n          recursiveWarning = true;\n          return;\n        }\n        if (item.type === 'container') containers.add(item.id);\n        return item;\n      })\n    );\n    items = items.filter((i) => i && !containers.has(i.system.container));\n\n    // Display recursive warning, but continue with any remaining items\n    if (recursiveWarning)\n      ui.notifications.warn('DND5E.ContainerRecursiveError', {\n        localize: true,\n      });\n    if (!items.length) return [];\n\n    // Create any remaining items\n    const toCreate = await dnd5e.documents.Item5e.createWithContents(items, {\n      container: this.item,\n      transformAll: (itemData: any, options: any) =>\n        this._onDropSingleItem(itemData, { ...options, event }),\n    });\n    if (this.item.folder)\n      toCreate.forEach((d: any) => (d.folder = this.item.folder.id));\n    return dnd5e.documents.Item5e.createDocuments(toCreate, {\n      pack: this.item.pack,\n      parent: this.item.parent,\n      keepId: true,\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  async _onDropItem(\n    event: DragEvent & { currentTarget: HTMLElement; target: HTMLElement },\n    data: any\n  ): Promise<Item5e[] | boolean | void> {\n    const item = await Item.implementation.fromDropData(data);\n    if (!this.item.isOwner || !item) return false;\n\n    // If item already exists in this container, just adjust its sorting\n    if (item.system.container === this.item.id) {\n      return this._onSortItem(event, item);\n    }\n\n    // Prevent dropping containers within themselves\n    const parentContainers = await this.item.system.allContainers();\n    if (this.item.uuid === item.uuid || parentContainers.includes(item)) {\n      ui.notifications.error('DND5E.ContainerRecursiveError', {\n        localize: true,\n      });\n      return;\n    }\n\n    // If item already exists in same DocumentCollection, just adjust its container property\n    if (\n      item.actor === this.item.actor &&\n      item.pack === this.item.pack &&\n      Inventory.getDefaultInventoryTypes().includes(item.type)\n    ) {\n      return item.update({\n        folder: this.item.folder,\n        'system.container': this.item.id,\n      });\n    }\n\n    // Otherwise, create a new item & contents in this context\n    const toCreate = await dnd5e.documents.Item5e.createWithContents([item], {\n      container: this.item,\n      transformAll: (itemData: any, options: any) =>\n        this._onDropSingleItem(itemData, { ...options, event }),\n    });\n    if (this.item.folder)\n      toCreate.forEach((d: any) => (d.folder = this.item.folder.id));\n    return dnd5e.documents.Item5e.createDocuments(toCreate, {\n      pack: this.item.pack,\n      parent: this.item.actor,\n      keepId: true,\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Process a single item when dropping into the container.\n   * @param {object} itemData           The item data to create.\n   * @param {object} options\n   * @param {string} options.container  ID of the container to create the items.\n   * @param {number} options.depth      Current depth of the item being created.\n   * @param {DragEvent} options.event   The concluding DragEvent which provided the drop data.\n   * @returns {Promise<object|false>}   The item data to create after processing, or false if the item should not be\n   *                                    created or creation has been otherwise handled.\n   * @protected\n   */\n  async _onDropSingleItem(\n    itemData: Record<string, any>,\n    {\n      container,\n      depth,\n      event,\n    }: { container: string; depth: number; event: DragEvent }\n  ) {\n    if (itemData.type === 'spell') {\n      const createOptions: Record<string, unknown> = {};\n\n      if (settings.value.includeFlagsInSpellScrollCreation) {\n        createOptions.flags = itemData.flags;\n      }\n\n      const scroll = await dnd5e.documents.Item5e.createScrollFromSpell(\n        itemData,\n        createOptions\n      );\n\n      return scroll?.toObject?.() ?? false;\n    }\n\n    if (this.item.actor && container === this.item.id) {\n      const result = await FoundryAdapter.onDropStackConsumablesForActor(\n        this.actor,\n        itemData,\n        { container },\n        event\n      );\n      if (result) return false;\n    }\n\n    return itemData;\n  }\n\n  /**\n   * Handle a drop event for an existing contained Item to sort it relative to its siblings.\n   */\n  async _onSortItem(\n    event: DragEvent & { currentTarget: HTMLElement; target: HTMLElement },\n    item: Item5e\n  ) {\n    const dropTarget = event.target.closest<HTMLElement>('[data-item-id]');\n    if (!dropTarget) return;\n    const contents = await this.item.system.contents;\n    const target = contents.get(dropTarget.dataset.itemId);\n\n    // Don't sort on yourself\n    if (item.id === target.id) return;\n\n    // Identify sibling items based on adjacent HTML elements\n    const siblings = [];\n    for (const el of Array.from(dropTarget.parentElement!.children)) {\n      if (el instanceof HTMLElement) {\n        const siblingId = el.dataset.itemId;\n        if (siblingId && siblingId !== item.id)\n          siblings.push(contents.get(siblingId));\n      }\n    }\n\n    // Perform the sort\n    const sortUpdates = SortingHelpers.performIntegerSort(item, {\n      target,\n      siblings,\n    });\n    const updateData = sortUpdates.map((u: any) => {\n      const update = u.update;\n      update._id = u.target.id;\n      return update;\n    });\n\n    // Perform the update\n    Item.updateDocuments(updateData, {\n      pack: this.item.pack,\n      parent: this.item.actor,\n    });\n  }\n\n  // TODO: Plug in or reimplement\n  // - SheetTabCacheable\n  // - SheetExpandedItemsCacheable\n  // - SearchFilterCacheable\n}\n","import { mount } from 'svelte';\nimport SvelteFormApplicationBase from '../SvelteFormApplicationBase';\nimport ApplyTidySheetPreferences from './ApplyTidySheetPreferences.svelte';\nimport { Tidy5eCharacterSheet } from 'src/sheets/classic/Tidy5eCharacterSheet.svelte';\nimport { Tidy5eNpcSheet } from 'src/sheets/classic/Tidy5eNpcSheet.svelte';\nimport { Tidy5eVehicleSheet } from 'src/sheets/classic/Tidy5eKgarVehicleSheet.svelte';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { debug, error } from 'src/utils/logging';\nimport { Tidy5eItemSheetClassic } from 'src/sheets/classic/Tidy5eItemSheetClassic.svelte';\nimport { Tidy5eGroupSheetClassic } from 'src/sheets/classic/Tidy5eGroupSheetClassic.svelte';\nimport { Tidy5eContainerSheetClassic } from 'src/sheets/classic/Tidy5eContainerSheetClassic.svelte';\n\nexport type SheetPreferenceOption = {\n  label: string;\n  documentName: string;\n  subType: string;\n  sheetClassIdentifier: string;\n  selected: boolean;\n};\n\n// Regrettably manual, but hopefully a temporary arrangement\nconst supportedSheetClasses: string[] = [\n  Tidy5eCharacterSheet.name,\n  Tidy5eNpcSheet.name,\n  Tidy5eVehicleSheet.name,\n  Tidy5eItemSheetClassic.name,\n  Tidy5eContainerSheetClassic.name,\n  Tidy5eGroupSheetClassic.name,\n];\n\nexport class ApplyTidySheetPreferencesApplication extends SvelteFormApplicationBase {\n  sheetOptions = $state<SheetPreferenceOption[]>([]);\n\n  static get defaultOptions() {\n    return FoundryAdapter.mergeObject(super.defaultOptions, {\n      width: 650,\n      height: 500,\n      id: 'tidy-5e-sheet-preferences',\n      popOut: true,\n      title: FoundryAdapter.localize('TIDY5E.Settings.SheetPreferences.name'),\n    });\n  }\n\n  createComponent(node: HTMLElement): Record<string, any> {\n    this.sheetOptions = this.getTidySheetPreferenceOptions();\n    return mount(ApplyTidySheetPreferences, {\n      target: node,\n      props: {\n        options: this.sheetOptions,\n        onConfirm: this._onConfirm.bind(this),\n      },\n    });\n  }\n\n  getTidySheetPreferenceOptions(): SheetPreferenceOption[] {\n    const sheetClassOptions = [];\n\n    const setting = game.settings.get('core', 'sheetClasses');\n\n    for (const { documentName, hasTypeData } of Object.values<any>(\n      foundry.documents\n    )) {\n      // documentName -> e.g., \"Actor\", \"Item\", ...\n      if (!hasTypeData) {\n        continue;\n      }\n\n      // e.g., \"character\", \"npc\", \"vehicle\" for \"Actor\"\n      const subTypes = game.documentTypes[documentName].filter(\n        (t: string) => t !== CONST.BASE_DOCUMENT_TYPE\n      );\n\n      if (!subTypes.length) {\n        continue;\n      }\n\n      for (let subType of subTypes) {\n        const { defaultClasses } =\n          DocumentSheetConfig.getSheetClassesForSubType(documentName, subType);\n\n        const tidySheetClass = Object.keys(defaultClasses).find((c: string) =>\n          supportedSheetClasses.includes(c.split('.').at(-1) ?? 'Not Found')\n        );\n\n        if (!tidySheetClass) {\n          continue;\n        }\n\n        const typeLabel = FoundryAdapter.localize(\n          // @ts-ignore\n          CONFIG[documentName].typeLabels?.[subType]\n        );\n\n        const isDefault =\n          tidySheetClass ===\n          foundry.utils.getProperty(setting, `${documentName}.${subType}`);\n\n        sheetClassOptions.push({\n          label: typeLabel,\n          documentName,\n          subType,\n          sheetClassIdentifier: tidySheetClass,\n          selected: isDefault,\n        });\n      }\n    }\n\n    return sheetClassOptions;\n  }\n\n  private async _onConfirm(): Promise<void> {\n    try {\n      // We intend to adjust the existing settings.\n      let sheetSettings = this.getSheetClassesSetting();\n\n      // Evaluate each option.\n      this.sheetOptions.forEach((o) => {\n        const compositeSettingKey = `${o.documentName}.${o.subType}`;\n\n        // When selected, simply assign the Tidy class to the appropriate subtype of the appropriate document name\n        if (o.selected) {\n          debug(\n            `Tidy Sheet ${o.sheetClassIdentifier} selected; ensuring it is set in settings.`\n          );\n          sheetSettings = foundry.utils.mergeObject(sheetSettings, {\n            [compositeSettingKey]: o.sheetClassIdentifier,\n          });\n          return;\n        }\n\n        debug(\n          `Tidy Sheet ${o.sheetClassIdentifier} unselected; checking setting.`\n        );\n        // When not selected, we want to remove any Tidy\n        const currentSetting = foundry.utils.getProperty(\n          sheetSettings,\n          compositeSettingKey\n        );\n        if (currentSetting !== o.sheetClassIdentifier) {\n          debug(\n            `Tidy Sheet ${o.sheetClassIdentifier} not currently configured and is unselected; ignoring.`\n          );\n          // The option was unselected, and the setting does not reference Tidy. Do not change it.\n          return;\n        }\n\n        debug(\n          `Tidy Sheet ${o.sheetClassIdentifier} currently configured and is unselected; removing setting.`\n        );\n        // The option was unselected, but the setting currently points to Tidy. Clear out this setting.\n        delete sheetSettings[o.documentName][o.subType];\n\n        // Prune settings where the document name no longer has any subtype properties.\n        if (Object.keys(sheetSettings[o.documentName]).length === 0) {\n          debug(\n            `${o.documentName} is now empty. Pruning property from settings.`\n          );\n          delete sheetSettings[o.documentName];\n        }\n      });\n\n      await game.settings.set('core', 'sheetClasses', sheetSettings);\n\n      debug('New sheetClasses settings', { sheetClasses: sheetSettings });\n\n      this.close();\n\n      Dialog.confirm({\n        title: FoundryAdapter.localize('SETTINGS.ReloadPromptTitle'),\n        content: FoundryAdapter.localize('SETTINGS.ReloadPromptBody'),\n        yes: () => foundry.utils.debouncedReload(),\n        no: () => {},\n        defaultYes: true,\n      });\n    } catch (e) {\n      error(FoundryAdapter.localize('TIDY5E.GenericErrorNotification'), true, {\n        error: e,\n      });\n    }\n  }\n\n  private getSheetClassesSetting() {\n    return game.settings.get('core', 'sheetClasses');\n  }\n}\n","import { CONSTANTS } from '../constants';\nimport { FoundryAdapter } from '../foundry/foundry-adapter';\nimport { ResetSettingsDialog } from './ResetSettingsDialog';\nimport type { GetFunctionReturnType } from 'src/types/types';\nimport { applyTheme, getThemeOrDefault } from 'src/theme/theme';\nimport { defaultLightTheme } from 'src/theme/default-light-theme';\nimport { getCoreThemes, themeVariables } from 'src/theme/theme-reference';\nimport { UserSettingsFormApplication } from 'src/applications/settings/user-settings/UserSettingsFormApplication.svelte';\nimport { WorldSettingsFormApplication } from 'src/applications/settings/world-settings/WorldSettingsFormApplication.svelte';\nimport { ThemeSettingsFormApplication } from 'src/applications/theme/ThemeSettingsFormApplication.svelte';\nimport type { ExhaustionConfig } from '../features/exhaustion/exhaustion.types';\nimport NpcSheetRuntime from 'src/runtime/NpcSheetRuntime.svelte';\nimport CharacterSheetRuntime from 'src/runtime/CharacterSheetRuntime.svelte';\nimport { VehicleSheetRuntime } from 'src/runtime/VehicleSheetRuntime';\nimport { TabManager } from 'src/runtime/tab/TabManager';\nimport { BulkMigrationsApplication } from 'src/migrations/BulkMigrationsApplication';\nimport { AboutApplication } from 'src/applications/settings/about/AboutApplication';\nimport { ApplyTidySheetPreferencesApplication } from 'src/applications/sheet-preferences/ApplyTidySheetPreferencesApplication.svelte';\nimport { getDefaultExhaustionConfig } from 'src/features/exhaustion/exhaustion';\nimport type { GlobalCustomSectionsetting } from './settings.types';\n\nexport type Tidy5eSettings = {\n  [settingKey: string]: Tidy5eSetting;\n};\n\nexport type Tidy5eSettingKey = keyof (typeof SettingsProvider)['settings'];\n\n/**\n * A simple object-to-value mapping of all settings at a given point in time.\n */\nexport type CurrentSettings = {\n  [K in Tidy5eSettingKey]: GetFunctionReturnType<\n    (typeof SettingsProvider.settings)[K]\n  >;\n};\n\nexport function getCurrentSettings(): CurrentSettings {\n  const keys = Object.keys(\n    SettingsProvider.settings\n  ) as (keyof (typeof SettingsProvider)['settings'])[];\n\n  return keys.reduce<Record<string, any>>((obj, key) => {\n    obj[key] = SettingsProvider.settings[key].get();\n    return obj;\n  }, {}) as CurrentSettings;\n}\n\nexport type Tidy5eSetting = {\n  options: {\n    /**\n     * The human-readable name\n     */\n    name: string;\n    /**\n     * An additional human readable hint\n     */\n    hint?: string;\n    /**\n     * The scope the Setting is stored in, either World or Client\n     */\n    scope: 'world' | 'client';\n    /**\n     * Indicates if this Setting should render in the Config application\n     */\n    config: boolean;\n    /**\n     * The JS Type that the Setting is storing\n     */\n    type: any;\n    /**\n     * For string Types, defines the allowable values\n     */\n    choices?: any;\n    /**\n     * For numeric Types, defines the allowable range\n     */\n    range?: {\n      min: number;\n      max: number;\n      step: number;\n    };\n    /**\n     * The default value\n     */\n    default?: any;\n    /**\n     * Executes when the value of this Setting changes\n     * @param data the new value\n     */\n    onChange?: (data: any) => void;\n\n    /**\n     * Prompts a reload if the setting is changed.\n     */\n    requiresReload?: boolean;\n  };\n  get: () => any;\n  /**\n   * Denotes which CSS Variable is represented by the target setting. Used for color picking.\n   */\n  representsCssVariable?: keyof typeof themeVariables;\n};\n\n/**\n * The current Tidy 5e settings.\n */\nlet _settings: CurrentSettings = $state()!; // For ergonomics, pretend like this is never undefined, because it is initialized in the hooks lifecycle.\n\nexport const settings = {\n  get value() {\n    return _settings;\n  },\n};\n\nexport function createSettings() {\n  return {\n    menus: {\n      worldSettings: {\n        options: {\n          name: `TIDY5E.WorldSettings.Menu.name`,\n          label: 'TIDY5E.WorldSettings.Menu.label',\n          hint: `TIDY5E.WorldSettings.Menu.hint`,\n          icon: 'fa-solid fa-globe',\n          type: WorldSettingsFormApplication,\n          restricted: true,\n        },\n      },\n      userMenu: {\n        options: {\n          name: `TIDY5E.UserSettings.Menu.name`,\n          label: 'TIDY5E.UserSettings.Menu.label',\n          hint: `TIDY5E.UserSettings.Menu.hint`,\n          icon: 'fa-solid fa-user-gear',\n          type: UserSettingsFormApplication,\n          restricted: false,\n        },\n      },\n      theme: {\n        options: {\n          name: `TIDY5E.ThemeSettings.SheetMenu.name`,\n          label: 'TIDY5E.ThemeSettings.SheetMenu.buttonLabel',\n          hint: `TIDY5E.ThemeSettings.SheetMenu.hint`,\n          icon: 'fa-solid fa-palette',\n          type: ThemeSettingsFormApplication,\n          restricted: false,\n        },\n      },\n      resetAllSettings: {\n        options: {\n          name: `TIDY5E.Settings.Reset.name`,\n          hint: `TIDY5E.Settings.Reset.hint`,\n          icon: 'fa-solid fa-database',\n          type: ResetSettingsDialog,\n          restricted: true,\n        },\n      },\n      migrations: {\n        options: {\n          name: `TIDY5E.Settings.Migrations.name`,\n          label: 'TIDY5E.Settings.Migrations.buttonLabel',\n          hint: `TIDY5E.Settings.Migrations.hint`,\n          icon: 'fa-solid fa-right-left',\n          type: BulkMigrationsApplication,\n          restricted: true,\n        },\n      },\n      applyTidySheetPreferences: {\n        options: {\n          name: `TIDY5E.Settings.SheetPreferences.name`,\n          label: 'TIDY5E.Settings.SheetPreferences.buttonLabel',\n          hint: `TIDY5E.Settings.SheetPreferences.hint`,\n          icon: 'fa-solid fa-file-pen',\n          type: ApplyTidySheetPreferencesApplication,\n          restricted: true,\n        },\n      },\n      about: {\n        options: {\n          name: `TIDY5E.Settings.About.name`,\n          label: 'TIDY5E.Settings.About.buttonLabel',\n          hint: `TIDY5E.Settings.About.hint`,\n          icon: 'fa-solid fa-question',\n          type: AboutApplication,\n          restricted: false,\n        },\n      },\n    },\n    settings: {\n      migrationsConfirmationTally: {\n        options: {\n          name: 'Migrations Confirmation Tally',\n          hint: 'Developer Only: This field tells the developer when was the last time the GM indicated \"Do Not Show Again\" for a migration notification. This is so Tidy does not notify of migrations until a new migration has become available. A migration tick counter increments each release where a migration has become available.',\n          scope: 'world',\n          config: false,\n          type: Number,\n          default: 0,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<number>(\n            'migrationsConfirmationTally'\n          );\n        },\n      },\n      defaultTheme: {\n        options: {\n          name: 'TIDY5E.Settings.DefaultTheme.name',\n          hint: 'TIDY5E.Settings.DefaultTheme.hint',\n          scope: 'world',\n          config: true,\n          type: new foundry.data.fields.StringField({\n            required: true,\n            blank: false,\n            initial: CONSTANTS.THEME_ID_DEFAULT_LIGHT,\n            choices: () => getCoreThemes(false),\n          }),\n          onChange: (data: string) => {\n            const theme = getThemeOrDefault(data);\n\n            const colorScheme = SettingsProvider.settings.colorScheme.get();\n\n            if (theme && colorScheme === CONSTANTS.THEME_ID_DEFAULT) {\n              applyTheme(theme);\n            }\n          },\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>('defaultTheme');\n        },\n      },\n      // Color Theme\n      colorScheme: {\n        options: {\n          name: 'TIDY5E.Settings.SheetTheme.name',\n          hint: 'TIDY5E.Settings.SheetTheme.hint',\n          scope: 'client',\n          config: true,\n          type: new foundry.data.fields.StringField({\n            required: true,\n            blank: false,\n            initial: CONSTANTS.THEME_ID_DEFAULT,\n            choices: () => getCoreThemes(true),\n          }),\n          onChange: (\n            data: string,\n            colorPickerEnabledOverride: boolean | null = null\n          ) => {\n            const theme = getThemeOrDefault(data);\n            applyTheme(theme, colorPickerEnabledOverride);\n          },\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>('colorScheme');\n        },\n      },\n\n      // Context Menu\n      useContextMenu: {\n        options: {\n          name: 'TIDY5E.Settings.UseContextMenu.name',\n          hint: 'TIDY5E.Settings.UseContextMenu.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('useContextMenu');\n        },\n      },\n\n      // Player Character Settings\n\n      initialCharacterSheetTab: {\n        options: {\n          name: 'TIDY5E.Settings.InitialSheetTab.name',\n          hint: 'TIDY5E.Settings.InitialSheetTab.hint',\n          scope: 'world',\n          config: false,\n          type: String,\n          choices: () =>\n            TabManager.getTabsAsConfigOptions(\n              CharacterSheetRuntime.getAllRegisteredTabs()\n            ),\n          default: CONSTANTS.TAB_CHARACTER_ATTRIBUTES,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'initialCharacterSheetTab'\n          );\n        },\n      },\n\n      defaultCharacterSheetTabs: {\n        options: {\n          name: 'TIDY5E.Settings.DefaultSheetTabs.name',\n          hint: 'TIDY5E.Settings.DefaultSheetTabs.hint',\n          scope: 'world',\n          config: false,\n          type: Array,\n          default: [\n            CONSTANTS.TAB_CHARACTER_ATTRIBUTES,\n            CONSTANTS.TAB_ACTOR_INVENTORY,\n            CONSTANTS.TAB_ACTOR_SPELLBOOK,\n            CONSTANTS.TAB_CHARACTER_FEATURES,\n            CONSTANTS.TAB_CHARACTER_EFFECTS,\n            CONSTANTS.TAB_CHARACTER_BIOGRAPHY,\n            CONSTANTS.TAB_CHARACTER_JOURNAL,\n            CONSTANTS.TAB_CHARACTER_BASTION,\n          ],\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string[]>(\n            'defaultCharacterSheetTabs'\n          );\n        },\n      },\n\n      useClassicControlsForCharacter: {\n        options: {\n          name: 'TIDY5E.Settings.UseClassicControls.name',\n          hint: 'TIDY5E.Settings.UseClassicControls.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'useClassicControlsForCharacter'\n          );\n        },\n      },\n\n      // Info Cards\n      itemCardsForAllItems: {\n        options: {\n          name: 'TIDY5E.Settings.ItemCardsForAllItems.name',\n          hint: 'TIDY5E.Settings.ItemCardsForAllItems.hint',\n          scope: 'client',\n          config: true,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('itemCardsForAllItems');\n        },\n      },\n\n      useEffectCards: {\n        options: {\n          name: 'TIDY5E.Settings.UseEffectCards.name',\n          hint: 'TIDY5E.Settings.UseEffectCards.hint',\n          scope: 'client',\n          config: true,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('useEffectCards');\n        },\n      },\n\n      itemCardsAreFloating: {\n        options: {\n          name: 'TIDY5E.Settings.ItemCardsAreFloating.name',\n          hint: 'TIDY5E.Settings.ItemCardsAreFloating.hint',\n          scope: 'client',\n          config: true,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('itemCardsAreFloating');\n        },\n      },\n\n      itemCardsDelay: {\n        options: {\n          name: 'TIDY5E.Settings.ItemCardsDelay.name',\n          hint: 'TIDY5E.Settings.ItemCardsDelay.hint',\n          scope: 'client',\n          config: true,\n          default: 300,\n          type: Number,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<number>('itemCardsDelay');\n        },\n      },\n\n      useAccessibleKeyboardSupport: {\n        options: {\n          name: 'TIDY5E.Settings.UseAccessibleKeyboardSupport.name',\n          hint: 'TIDY5E.Settings.UseAccessibleKeyboardSupport.hint',\n          scope: 'world',\n          config: true,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'useAccessibleKeyboardSupport'\n          );\n        },\n      },\n\n      useDefaultSheetAttributeTabbing: {\n        options: {\n          name: 'TIDY5E.Settings.UseDefaultSheetAttributeTabbing.name',\n          hint: 'TIDY5E.Settings.UseDefaultSheetAttributeTabbing.hint',\n          scope: 'client',\n          config: true,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'useDefaultSheetAttributeTabbing'\n          );\n        },\n      },\n\n      useDefaultSheetHpTabbing: {\n        options: {\n          name: 'TIDY5E.Settings.UseDefaultSheetHpTabbing.name',\n          hint: 'TIDY5E.Settings.UseDefaultSheetHpTabbing.hint',\n          scope: 'client',\n          config: true,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'useDefaultSheetHpTabbing'\n          );\n        },\n      },\n\n      itemCardsFixKey: {\n        options: {\n          name: 'TIDY5E.Settings.InfoCardsInspectKey.name',\n          hint: 'TIDY5E.Settings.InfoCardsInspectKey.hint',\n          scope: 'world',\n          config: false,\n          default: 't',\n          type: String,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>('itemCardsFixKey');\n        },\n      },\n\n      //Show trait labels\n      showTraitLabels: {\n        options: {\n          name: 'TIDY5E.Settings.ShowTraitLabels.name',\n          hint: 'TIDY5E.Settings.ShowTraitLabels.hint',\n          scope: 'world',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('showTraitLabels');\n        },\n      },\n\n      showClassList: {\n        options: {\n          name: 'TIDY5E.Settings.ShowClassList.name',\n          hint: 'TIDY5E.Settings.ShowClassList.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('showClassList');\n        },\n      },\n\n      animateInspiration: {\n        options: {\n          name: 'TIDY5E.Settings.InspirationAnimation.name',\n          hint: 'TIDY5E.Settings.InspirationAnimation.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('animateInspiration');\n        },\n      },\n\n      hideIfZero: {\n        options: {\n          name: 'TIDY5E.Settings.HideIfZero.name',\n          hint: 'TIDY5E.Settings.HideIfZero.hint',\n          scope: 'client',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('hideIfZero');\n        },\n      },\n\n      showInspirationOnHover: {\n        options: {\n          name: 'TIDY5E.Settings.ShowInspirationOnHover.name',\n          hint: 'TIDY5E.Settings.ShowInspirationOnHover.hint',\n          scope: 'client',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'showInspirationOnHover'\n          );\n        },\n      },\n\n      showExhaustionOnHover: {\n        options: {\n          name: 'TIDY5E.Settings.ShowExhaustionOnHover.name',\n          hint: 'TIDY5E.Settings.ShowExhaustionOnHover.hint',\n          scope: 'client',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'showExhaustionOnHover'\n          );\n        },\n      },\n\n      useHpBar: {\n        options: {\n          name: 'TIDY5E.Settings.UseHpBar.name',\n          hint: 'TIDY5E.Settings.UseHpBar.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('useHpBar');\n        },\n      },\n\n      useHpOverlay: {\n        options: {\n          name: 'TIDY5E.Settings.UseHpOverlay.name',\n          hint: 'TIDY5E.Settings.UseHpOverlay.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('useHpOverlay');\n        },\n      },\n\n      toggleEmptyCharacterSkills: {\n        options: {\n          name: 'TIDY5E.Settings.ToggleEmptyCharacterSkills.name',\n          hint: 'TIDY5E.Settings.ToggleEmptyCharacterSkills.hint',\n          scope: 'client',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'toggleEmptyCharacterSkills'\n          );\n        },\n      },\n\n      moveCharacterTraitsToRightOfSkills: {\n        options: {\n          name: 'TIDY5E.Settings.MoveTraitsToRightOfSkills.name',\n          hint: 'TIDY5E.Settings.MoveTraitsToRightOfSkills.hint',\n          scope: 'client',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'moveCharacterTraitsToRightOfSkills'\n          );\n        },\n      },\n\n      showEquippedAmmoOnly: {\n        options: {\n          name: 'TIDY5E.Settings.ShowEquippedAmmoOnly.name',\n          hint: 'TIDY5E.Settings.ShowEquippedAmmoOnly.hint',\n          scope: 'client',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('showEquippedAmmoOnly');\n        },\n      },\n\n      initialNpcSheetTab: {\n        options: {\n          name: 'TIDY5E.Settings.InitialSheetTab.name',\n          hint: 'TIDY5E.Settings.InitialSheetTab.hint',\n          scope: 'world',\n          config: false,\n          type: String,\n          choices: () =>\n            TabManager.getTabsAsConfigOptions(\n              NpcSheetRuntime.getAllRegisteredTabs()\n            ),\n          default: CONSTANTS.TAB_NPC_ABILITIES,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>('initialNpcSheetTab');\n        },\n      },\n\n      defaultNpcSheetTabs: {\n        options: {\n          name: 'TIDY5E.Settings.DefaultSheetTabs.name',\n          hint: 'TIDY5E.Settings.DefaultSheetTabs.hint',\n          scope: 'world',\n          config: false,\n          type: Array,\n          default: [\n            CONSTANTS.TAB_NPC_ABILITIES,\n            CONSTANTS.TAB_ACTOR_SPELLBOOK,\n            CONSTANTS.TAB_NPC_EFFECTS,\n            CONSTANTS.TAB_NPC_BIOGRAPHY,\n            CONSTANTS.TAB_NPC_JOURNAL,\n          ],\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string[]>('defaultNpcSheetTabs');\n        },\n      },\n\n      useClassicControlsForNpc: {\n        options: {\n          name: 'TIDY5E.Settings.UseClassicControls.name',\n          hint: 'TIDY5E.Settings.UseClassicControls.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'useClassicControlsForNpc'\n          );\n        },\n      },\n\n      moveNpcTraitsToRightOfSkills: {\n        options: {\n          name: 'TIDY5E.Settings.MoveTraitsToRightOfSkills.name',\n          hint: 'TIDY5E.Settings.MoveTraitsToRightOfSkills.hint',\n          scope: 'client',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'moveNpcTraitsToRightOfSkills'\n          );\n        },\n      },\n\n      useHpBarNpc: {\n        options: {\n          name: 'TIDY5E.Settings.UseHpBar.name',\n          hint: 'TIDY5E.Settings.UseHpBar.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('useHpBarNpc');\n        },\n      },\n\n      useHpOverlayNpc: {\n        options: {\n          name: 'TIDY5E.Settings.UseHpOverlay.name',\n          hint: 'TIDY5E.Settings.UseHpOverlay.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('useHpOverlayNpc');\n        },\n      },\n\n      alwaysShowNpcSkills: {\n        options: {\n          name: 'TIDY5E.Settings.AlwaysShowSkills.name',\n          hint: 'TIDY5E.Settings.AlwaysShowSkills.hint',\n          scope: 'client',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('alwaysShowNpcSkills');\n        },\n      },\n\n      showSpellbookTabNpc: {\n        options: {\n          name: 'TIDY5E.Settings.ShowNPCSpellbookTab.name',\n          hint: 'TIDY5E.Settings.ShowNPCSpellbookTab.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('showSpellbookTabNpc');\n        },\n      },\n\n      initialVehicleSheetTab: {\n        options: {\n          name: 'TIDY5E.Settings.InitialSheetTab.name',\n          hint: 'TIDY5E.Settings.InitialSheetTab.hint',\n          scope: 'world',\n          config: false,\n          type: String,\n          choices: () =>\n            TabManager.getTabsAsConfigOptions(\n              VehicleSheetRuntime.getAllRegisteredTabs()\n            ),\n          default: CONSTANTS.TAB_VEHICLE_ATTRIBUTES,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'initialVehicleSheetTab'\n          );\n        },\n      },\n\n      defaultVehicleSheetTabs: {\n        options: {\n          name: 'TIDY5E.Settings.DefaultSheetTabs.name',\n          hint: 'TIDY5E.Settings.DefaultSheetTabs.hint',\n          scope: 'world',\n          config: false,\n          type: Array,\n          default: [\n            CONSTANTS.TAB_VEHICLE_ATTRIBUTES,\n            CONSTANTS.TAB_VEHICLE_CARGO_AND_CREW,\n            CONSTANTS.TAB_VEHICLE_EFFECTS,\n            CONSTANTS.TAB_VEHICLE_DESCRIPTION,\n          ],\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string[]>(\n            'defaultVehicleSheetTabs'\n          );\n        },\n      },\n\n      useClassicControlsForVehicle: {\n        options: {\n          name: 'TIDY5E.Settings.UseClassicControls.name',\n          hint: 'TIDY5E.Settings.UseClassicControls.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'useClassicControlsForVehicle'\n          );\n        },\n      },\n\n      useHpBarVehicle: {\n        options: {\n          name: 'TIDY5E.Settings.UseHpBar.name',\n          hint: 'TIDY5E.Settings.UseHpBar.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('useHpBarVehicle');\n        },\n      },\n\n      useHpOverlayVehicle: {\n        options: {\n          name: 'TIDY5E.Settings.UseHpOverlay.name',\n          hint: 'TIDY5E.Settings.UseHpOverlay.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('useHpOverlayVehicle');\n        },\n      },\n\n      showPlayerName: {\n        options: {\n          name: 'TIDY5E.Settings.ShowPlayerName.name',\n          hint: 'TIDY5E.Settings.ShowPlayerName.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('showPlayerName');\n        },\n      },\n\n      // Expanded Sheet\n      showExpandedLimitedView: {\n        options: {\n          name: 'TIDY5E.Settings.ShowExpandedLimitedView.name',\n          hint: 'TIDY5E.Settings.ShowExpandedLimitedView.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'showExpandedLimitedView'\n          );\n        },\n      },\n\n      useCircularPortraitStyle: {\n        options: {\n          name: 'TIDY5E.Settings.UseCircularPortraitStyle.name',\n          hint: 'TIDY5E.Settings.UseCircularPortraitStyle.hint',\n          scope: 'world',\n          config: false,\n          type: String,\n          choices: {\n            [CONSTANTS.CIRCULAR_PORTRAIT_OPTION_NONE]:\n              'TIDY5E.Settings.UseCircularPortraitStyle.none',\n            [CONSTANTS.CIRCULAR_PORTRAIT_OPTION_CHARACTER]:\n              'TIDY5E.Settings.UseCircularPortraitStyle.pc',\n            [CONSTANTS.CIRCULAR_PORTRAIT_OPTION_NPCVEHICLE]:\n              'TIDY5E.Settings.UseCircularPortraitStyle.npc',\n            [CONSTANTS.CIRCULAR_PORTRAIT_OPTION_ALL]:\n              'TIDY5E.Settings.UseCircularPortraitStyle.all',\n          },\n          default: CONSTANTS.CIRCULAR_PORTRAIT_OPTION_ALL,\n        },\n        get(): string {\n          return FoundryAdapter.getTidySetting<string>(\n            'useCircularPortraitStyle'\n          );\n        },\n      },\n\n      useTotalSheetLock: {\n        options: {\n          name: 'TIDY5E.Settings.UseTotalSheetLock.name',\n          hint: 'TIDY5E.Settings.UseTotalSheetLock.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('useTotalSheetLock');\n        },\n      },\n\n      permanentlyUnlockCharacterSheetForGm: {\n        options: {\n          name: 'TIDY5E.Settings.PermanentlyUnlockCharacterSheetForGM.name',\n          hint: 'TIDY5E.Settings.PermanentlyUnlockCharacterSheetForGM.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'permanentlyUnlockCharacterSheetForGm'\n          );\n        },\n      },\n\n      limitEffectsManagementToGm: {\n        options: {\n          name: 'TIDY5E.Settings.LimitEffectsManagementToGM.name',\n          hint: 'TIDY5E.Settings.LimitEffectsManagementToGM.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'limitEffectsManagementToGm'\n          );\n        },\n      },\n\n      hideDeathSavesFromPlayers: {\n        options: {\n          name: 'TIDY5E.Settings.HideDeathSavesFromPlayers.name',\n          hint: 'TIDY5E.Settings.HideDeathSavesFromPlayers.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'hideDeathSavesFromPlayers'\n          );\n        },\n      },\n\n      defaultDeathSaveRoll: {\n        options: {\n          name: 'TIDY5E.Settings.DefaultDeathSaveRoll.name',\n          hint: 'TIDY5E.Settings.DefaultDeathSaveRoll.hint',\n          scope: 'world',\n          config: false,\n          default: CONST.DICE_ROLL_MODES.PUBLIC,\n          type: String,\n          choices: {\n            [CONST.DICE_ROLL_MODES.PUBLIC]: 'CHAT.RollPublic',\n            [CONST.DICE_ROLL_MODES.PRIVATE]: 'CHAT.RollPrivate',\n            [CONST.DICE_ROLL_MODES.BLIND]: 'CHAT.RollBlind',\n            [CONST.DICE_ROLL_MODES.SELF]: 'CHAT.RollSelf',\n          },\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>('defaultDeathSaveRoll');\n        },\n      },\n\n      useCharacterEncumbranceBar: {\n        options: {\n          name: 'TIDY5E.Settings.UseCharacterEncumbranceBar.name',\n          hint: 'TIDY5E.Settings.UseCharacterEncumbranceBar.hint',\n          scope: 'world',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'useCharacterEncumbranceBar'\n          );\n        },\n      },\n\n      useNpcEncumbranceBar: {\n        options: {\n          name: 'TIDY5E.Settings.UseNPCEncumbranceBar.name',\n          hint: 'TIDY5E.Settings.UseNPCEncumbranceBar.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('useNpcEncumbranceBar');\n        },\n      },\n\n      useVehicleEncumbranceBar: {\n        options: {\n          name: 'TIDY5E.Settings.UseVehicleEncumbranceBar.name',\n          hint: 'TIDY5E.Settings.UseVehicleEncumbranceBar.hint',\n          scope: 'world',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'useVehicleEncumbranceBar'\n          );\n        },\n      },\n\n      useExhaustion: {\n        options: {\n          name: 'TIDY5E.Settings.UseExhaustion.name',\n          hint: 'TIDY5E.Settings.UseExhaustion.hint',\n          scope: 'world',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('useExhaustion');\n        },\n      },\n\n      useCharacterInspiration: {\n        options: {\n          name: 'TIDY5E.Settings.UseInspiration.name',\n          hint: 'TIDY5E.Settings.UseInspiration.hint',\n          scope: 'world',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'useCharacterInspiration'\n          );\n        },\n      },\n\n      useVehicleMotion: {\n        options: {\n          name: 'TIDY5E.Settings.UseVehicleMotion.name',\n          hint: 'TIDY5E.Settings.UseVehicleMotion.hint',\n          scope: 'world',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('useVehicleMotion');\n        },\n      },\n\n      showNpcRestInChat: {\n        options: {\n          name: 'TIDY5E.Settings.ShowNPCRestInChat.name',\n          hint: 'TIDY5E.Settings.ShowNPCRestInChat.hint',\n          scope: 'world',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('showNpcRestInChat');\n        },\n      },\n\n      showNpcActorLinkMarker: {\n        options: {\n          name: 'TIDY5E.Settings.ShowNPCActorLinkMarker.name',\n          hint: 'TIDY5E.Settings.ShowNPCActorLinkMarker.hint',\n          scope: 'world',\n          config: false,\n          type: String,\n          choices: {\n            default: 'TIDY5E.Settings.ShowNPCActorLinkMarker.default',\n            unlinked: 'TIDY5E.Settings.ShowNPCActorLinkMarker.unlinked',\n            both: 'TIDY5E.Settings.ShowNPCActorLinkMarker.both',\n          },\n          default: 'default',\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<'default' | 'unlinked' | 'both'>(\n            'showNpcActorLinkMarker'\n          );\n        },\n      },\n\n      showActiveEffectsMarker: {\n        options: {\n          name: 'TIDY5E.Settings.ShowActiveEffectsMarker.name',\n          hint: 'TIDY5E.Settings.ShowActiveEffectsMarker.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'showActiveEffectsMarker'\n          );\n        },\n      },\n\n      permanentlyUnlockNpcSheetForGm: {\n        options: {\n          name: 'TIDY5E.Settings.PermanentlyUnlockNPCSheetForGM.name',\n          hint: 'TIDY5E.Settings.PermanentlyUnlockNPCSheetForGM.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'permanentlyUnlockNpcSheetForGm'\n          );\n        },\n      },\n\n      permanentlyUnlockVehicleSheetForGm: {\n        options: {\n          name: 'TIDY5E.Settings.PermanentlyUnlockVehicleSheetForGM.name',\n          hint: 'TIDY5E.Settings.PermanentlyUnlockVehicleSheetForGM.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'permanentlyUnlockVehicleSheetForGm'\n          );\n        },\n      },\n\n      lockMoneyChanges: {\n        options: {\n          name: 'TIDY5E.Settings.LockMoneyChanges.name',\n          hint: 'TIDY5E.Settings.LockMoneyChanges.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('lockMoneyChanges');\n        },\n      },\n\n      lockExpChanges: {\n        options: {\n          name: 'TIDY5E.Settings.LockExpChanges.name',\n          hint: 'TIDY5E.Settings.LockExpChanges.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('lockExpChanges');\n        },\n      },\n\n      lockHpMaxChanges: {\n        options: {\n          name: 'TIDY5E.Settings.LockHpMaxChanges.name',\n          hint: 'TIDY5E.Settings.LockHpMaxChanges.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('lockHpMaxChanges');\n        },\n      },\n\n      lockLevelSelector: {\n        options: {\n          name: 'TIDY5E.Settings.LockLevelSelector.name',\n          hint: 'TIDY5E.Settings.LockLevelSelector.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('lockLevelSelector');\n        },\n      },\n\n      lockConfigureSheet: {\n        options: {\n          name: 'TIDY5E.Settings.LockConfigureSheet.name',\n          hint: 'TIDY5E.Settings.LockConfigureSheet.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('lockConfigureSheet');\n        },\n      },\n\n      lockItemQuantity: {\n        options: {\n          name: 'TIDY5E.Settings.LockItemQuantity.name',\n          hint: 'TIDY5E.Settings.LockItemQuantity.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('lockItemQuantity');\n        },\n      },\n\n      allowCantripsToBePrepared: {\n        options: {\n          name: 'TIDY5E.Settings.AllowCantripsToBePrepared.name',\n          hint: 'TIDY5E.Settings.AllowCantripsToBePrepared.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'allowCantripsToBePrepared'\n          );\n        },\n      },\n\n      useMulticlassSpellbookFilter: {\n        options: {\n          name: 'TIDY5E.Settings.UseMulticlassSpellbookFilter.name',\n          hint: 'TIDY5E.Settings.UseMulticlassSpellbookFilter.hint',\n          scope: 'client',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'useMulticlassSpellbookFilter'\n          );\n        },\n      },\n\n      useSpellClassFilterIcons: {\n        options: {\n          name: 'TIDY5E.Settings.UseSpellClassIcons.name',\n          hint: 'TIDY5E.Settings.UseSpellClassIcons.hint',\n          scope: 'client',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'useSpellClassFilterIcons'\n          );\n        },\n      },\n\n      allowHpMaxOverride: {\n        options: {\n          name: 'TIDY5E.Settings.AllowHpMaxOverride.name',\n          hint: 'TIDY5E.Settings.AllowHpMaxOverride.hint',\n          scope: 'world',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('allowHpMaxOverride');\n        },\n      },\n\n      actionListLimitActionsToCantrips: {\n        options: {\n          name: 'TIDY5E.Settings.ActionListLimitActionsToCantrips.name',\n          hint: 'TIDY5E.Settings.ActionListLimitActionsToCantrips.hint',\n          scope: 'client',\n          config: false,\n          default: false,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'actionListLimitActionsToCantrips'\n          );\n        },\n      },\n\n      actionListIncludeMinuteLongSpellsAsActions: {\n        options: {\n          name: 'TIDY5E.Settings.ActionListIncludeMinuteLongSpellsAsActions.name',\n          hint: 'TIDY5E.Settings.ActionListIncludeMinuteLongSpellsAsActions.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'actionListIncludeMinuteLongSpellsAsActions'\n          );\n        },\n      },\n\n      actionListIncludeSpellsWithActiveEffects: {\n        options: {\n          name: 'TIDY5E.Settings.ActionListIncludeSpellsWithActiveEffects.name',\n          hint: 'TIDY5E.Settings.ActionListIncludeSpellsWithActiveEffects.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'actionListIncludeSpellsWithActiveEffects'\n          );\n        },\n      },\n\n      actionListIncludeConsumables: {\n        options: {\n          name: 'TIDY5E.Settings.ActionListIncludeConsumables.name',\n          hint: 'TIDY5E.Settings.ActionListIncludeConsumables.hint',\n          scope: 'client',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'actionListIncludeConsumables'\n          );\n        },\n      },\n\n      exhaustionConfig: {\n        options: {\n          name: 'TIDY5E.WorldSettings.Exhaustion.name',\n          hint: 'TIDY5E.WorldSettings.Exhaustion.hint',\n          scope: 'world',\n          config: false,\n          default: getDefaultExhaustionConfig(),\n          type: Object,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<ExhaustionConfig>(\n            'exhaustionConfig'\n          );\n        },\n      },\n\n      vehicleExhaustionConfig: {\n        options: {\n          name: 'TIDY5E.WorldSettings.VehicleExhaustion.name',\n          hint: 'TIDY5E.WorldSettings.VehicleExhaustion.hint',\n          scope: 'world',\n          config: false,\n          default: getDefaultExhaustionConfig(),\n          type: Object,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<ExhaustionConfig>(\n            'vehicleExhaustionConfig'\n          );\n        },\n      },\n\n      includeTidySectionFieldsInDefaultSheets: {\n        options: {\n          name: 'TIDY5E.WorldSettings.IncludeTidySectionFieldsInDefaultSheets.name',\n          hint: 'TIDY5E.WorldSettings.IncludeTidySectionFieldsInDefaultSheets.hint',\n          scope: 'world',\n          config: false,\n          default: true,\n          type: Boolean,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'includeTidySectionFieldsInDefaultSheets'\n          );\n        },\n      },\n\n      itemIdentificationPermission: {\n        options: {\n          name: 'TIDY5E.WorldSettings.ItemIdentificationPermission.name',\n          hint: 'TIDY5E.WorldSettings.ItemIdentificationPermission.hint',\n          scope: 'world',\n          type: String,\n          default: CONSTANTS.SHEET_SETTINGS_OPTION_GM_AND_OWNERS,\n          config: false,\n          choices: {\n            [CONSTANTS.SHEET_SETTINGS_OPTION_GM_AND_OWNERS]:\n              'TIDY5E.WorldSettings.ItemIdentificationPermission.options.GmAndOwners',\n            [CONSTANTS.SHEET_SETTINGS_OPTION_GM_ONLY]:\n              'TIDY5E.WorldSettings.ItemIdentificationPermission.options.GmOnly',\n          },\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'itemIdentificationPermission'\n          );\n        },\n      },\n\n      includeFlagsInSpellScrollCreation: {\n        options: {\n          name: 'TIDY5E.WorldSettings.IncludeFlagsInSpellScrollCreation.name',\n          hint: 'TIDY5E.WorldSettings.IncludeFlagsInSpellScrollCreation.hint',\n          scope: 'world',\n          type: Boolean,\n          default: false,\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'includeFlagsInSpellScrollCreation'\n          );\n        },\n      },\n\n      colorPickerEnabled: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerEnabled.name',\n          hint: 'TIDY5E.Settings.ColorPickerEnabled.hint',\n          scope: 'client',\n          type: Boolean,\n          default: false,\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('colorPickerEnabled');\n        },\n      },\n\n      colorPickerPrimaryAccent: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerPrimaryAccent.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-primary-accent-color'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerPrimaryAccent'\n          );\n        },\n        representsCssVariable: '--t5e-primary-accent-color',\n      },\n      colorPickerHpBar: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerHpBar.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-hp-bar-color'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>('colorPickerHpBar');\n        },\n        representsCssVariable: '--t5e-hp-bar-color',\n      },\n      colorPickerEquipped: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerEquipped.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-equipped-background'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>('colorPickerEquipped');\n        },\n        representsCssVariable: '--t5e-equipped-background',\n      },\n      colorPickerEquippedOutline: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerEquippedOutline.name',\n          scope: 'client',\n          type: String,\n          default:\n            defaultLightTheme.variables[\n              '--t5e-equipped-item-grid-tile-outline-color'\n            ],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerEquippedOutline'\n          );\n        },\n        representsCssVariable: '--t5e-equipped-item-grid-tile-outline-color',\n      },\n      colorPickerEquippedAccent: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerEquippedAccent.name',\n          scope: 'client',\n          type: String,\n          default:\n            defaultLightTheme.variables[\n              '--t5e-equipped-item-grid-tile-accent-color'\n            ],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerEquippedAccent'\n          );\n        },\n        representsCssVariable: '--t5e-equipped-item-grid-tile-accent-color',\n      },\n\n      colorPickerPrepared: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerPrepared.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-prepared-background'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>('colorPickerPrepared');\n        },\n        representsCssVariable: '--t5e-prepared-background',\n      },\n      colorPickerPreparedOutline: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerPreparedOutline.name',\n          scope: 'client',\n          type: String,\n          default:\n            defaultLightTheme.variables[\n              '--t5e-prepared-item-grid-tile-outline-color'\n            ],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerPreparedOutline'\n          );\n        },\n        representsCssVariable: '--t5e-prepared-item-grid-tile-outline-color',\n      },\n      colorPickerPreparedAccent: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerPreparedAccent.name',\n          scope: 'client',\n          type: String,\n          default:\n            defaultLightTheme.variables[\n              '--t5e-prepared-item-grid-tile-accent-color'\n            ],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerPreparedAccent'\n          );\n        },\n        representsCssVariable: '--t5e-prepared-item-grid-tile-accent-color',\n      },\n\n      colorPickerPact: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerPact.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-pact-background'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>('colorPickerPact');\n        },\n        representsCssVariable: '--t5e-pact-background',\n      },\n      colorPickerPactOutline: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerPactOutline.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-pact-outline-color'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerPactOutline'\n          );\n        },\n        representsCssVariable: '--t5e-pact-outline-color',\n      },\n      colorPickerPactAccent: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerPactAccent.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-pact-accent-color'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>('colorPickerPactAccent');\n        },\n        representsCssVariable: '--t5e-pact-accent-color',\n      },\n\n      colorPickerAtWill: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerAtWill.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-atwill-background'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>('colorPickerAtWill');\n        },\n        representsCssVariable: '--t5e-atwill-background',\n      },\n      colorPickerAtWillOutline: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerAtWillOutline.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-atwill-outline-color'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerAtWillOutline'\n          );\n        },\n        representsCssVariable: '--t5e-atwill-outline-color',\n      },\n      colorPickerAtWillAccent: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerAtWillAccent.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-atwill-accent-color'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerAtWillAccent'\n          );\n        },\n        representsCssVariable: '--t5e-atwill-accent-color',\n      },\n\n      colorPickerRitualOnly: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerRitualOnly.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-ritual-only-background'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>('colorPickerRitualOnly');\n        },\n        representsCssVariable: '--t5e-ritual-only-background',\n      },\n      colorPickerRitualOnlyOutline: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerRitualOnlyOutline.name',\n          scope: 'client',\n          type: String,\n          default:\n            defaultLightTheme.variables['--t5e-ritual-only-outline-color'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerRitualOnlyOutline'\n          );\n        },\n        representsCssVariable: '--t5e-ritual-only-outline-color',\n      },\n      colorPickerRitualOnlyAccent: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerRitualOnlyAccent.name',\n          scope: 'client',\n          type: String,\n          default:\n            defaultLightTheme.variables['--t5e-ritual-only-accent-color'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerRitualOnlyAccent'\n          );\n        },\n        representsCssVariable: '--t5e-ritual-only-accent-color',\n      },\n\n      colorPickerInnate: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerInnate.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-innate-background'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>('colorPickerInnate');\n        },\n        representsCssVariable: '--t5e-innate-background',\n      },\n      colorPickerInnateOutline: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerInnateOutline.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-innate-outline'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerInnateOutline'\n          );\n        },\n        representsCssVariable: '--t5e-innate-outline',\n      },\n      colorPickerInnateAccent: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerInnateAccent.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-innate-accent'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerInnateAccent'\n          );\n        },\n        representsCssVariable: '--t5e-innate-accent',\n      },\n\n      colorPickerAlwaysPrepared: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerAlwaysPrepared.name',\n          scope: 'client',\n          type: String,\n          default:\n            defaultLightTheme.variables['--t5e-alwaysprepared-background'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerAlwaysPrepared'\n          );\n        },\n        representsCssVariable: '--t5e-alwaysprepared-background',\n      },\n      colorPickerAlwaysPreparedOutline: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerAlwaysPreparedOutline.name',\n          scope: 'client',\n          type: String,\n          default:\n            defaultLightTheme.variables['--t5e-alwaysprepared-outline-color'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerAlwaysPreparedOutline'\n          );\n        },\n        representsCssVariable: '--t5e-alwaysprepared-outline-color',\n      },\n      colorPickerAlwaysPreparedAccent: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerAlwaysPreparedAccent.name',\n          scope: 'client',\n          type: String,\n          default:\n            defaultLightTheme.variables['--t5e-alwaysprepared-accent-color'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerAlwaysPreparedAccent'\n          );\n        },\n        representsCssVariable: '--t5e-alwaysprepared-accent-color',\n      },\n      colorPickerScrollbarThumb: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerScrollbarThumb.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-scrollbar-thumb-color'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerScrollbarThumb'\n          );\n        },\n        representsCssVariable: '--t5e-scrollbar-thumb-color',\n      },\n      colorPickerScrollbarTrack: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerScrollbarTrack.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-scrollbar-track-color'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerScrollbarTrack'\n          );\n        },\n        representsCssVariable: '--t5e-scrollbar-track-color',\n      },\n      colorPickerMagicAccent: {\n        options: {\n          name: 'TIDY5E.Settings.ColorPickerMagicAccent.name',\n          scope: 'client',\n          type: String,\n          default: defaultLightTheme.variables['--t5e-magic-accent-color'],\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'colorPickerMagicAccent'\n          );\n        },\n        representsCssVariable: '--t5e-magic-accent-color',\n      },\n\n      // Icons\n      useTidySpellSchoolIcons: {\n        options: {\n          name: 'TIDY5E.Settings.UseTidySpellSchoolIcons.name',\n          hint: 'TIDY5E.Settings.UseTidySpellSchoolIcons.hint',\n          scope: 'world',\n          type: Boolean,\n          default: true,\n          config: false,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>(\n            'useTidySpellSchoolIcons'\n          );\n        },\n      },\n\n      // Custom Sections\n      globalCustomSections: {\n        options: {\n          name: 'TIDY5E.Settings.GlobalCustomSections.name',\n          hint: 'TIDY5E.Settings.GlobalCustomSections.hint',\n          scope: 'world',\n          config: false,\n          type: Array,\n          default: [],\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<\n            Partial<GlobalCustomSectionsetting>[]\n          >('globalCustomSections').map((c) => ({\n            section: '',\n            showWhenEmptyFilters: {},\n            showWhenEmpty: false,\n            ...c,\n          }));\n        },\n      },\n\n      // Activities\n      inlineActivitiesPosition: {\n        options: {\n          name: 'TIDY5E.Settings.InlineActivitiesPosition.name',\n          hint: 'TIDY5E.Settings.InlineActivitiesPosition.hint',\n          scope: 'client',\n          config: false,\n          default: CONSTANTS.INLINE_ACTIVITIES_POSITION_TOP,\n          type: String,\n          choices: {\n            [CONSTANTS.INLINE_ACTIVITIES_POSITION_TOP]:\n              'TIDY5E.Settings.InlineActivitiesPosition.top',\n            [CONSTANTS.INLINE_ACTIVITIES_POSITION_BOTTOM]:\n              'TIDY5E.Settings.InlineActivitiesPosition.bottom',\n          },\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<string>(\n            'inlineActivitiesPosition'\n          );\n        },\n      },\n\n      // Development and Troubleshooting\n      debug: {\n        options: {\n          name: `TIDY5E.Settings.Debug.name`,\n          hint: `TIDY5E.Settings.Debug.hint`,\n          scope: 'client',\n          config: true,\n          default: false,\n          type: Boolean,\n          requiresReload: true,\n        },\n        get() {\n          return FoundryAdapter.getTidySetting<boolean>('debug');\n        },\n      },\n    } satisfies Tidy5eSettings,\n  } as const;\n}\n\nexport let SettingsProvider: ReturnType<typeof createSettings>;\n\nexport function initSettings() {\n  SettingsProvider = createSettings();\n\n  for (let menu of Object.entries(SettingsProvider.menus)) {\n    FoundryAdapter.registerTidyMenu(menu[0], menu[1].options);\n  }\n\n  const debouncedSettingStoreRefresh = FoundryAdapter.debounce(() => {\n    _settings = getCurrentSettings();\n  }, 100);\n\n  for (let setting of Object.entries(SettingsProvider.settings)) {\n    const options = {\n      ...setting[1].options,\n      onChange: (...args: any[]) => {\n        debouncedSettingStoreRefresh();\n\n        (setting[1].options as any).onChange?.(...args);\n      },\n    };\n    FoundryAdapter.registerTidySetting(setting[0], options);\n  }\n\n  // Apply current color scheme\n  SettingsProvider.settings.colorScheme.options.onChange(\n    SettingsProvider.settings.colorScheme.get()\n  );\n\n  _settings = getCurrentSettings();\n\n  Hooks.on('closeSettingsConfig', () => {\n    _settings = getCurrentSettings();\n  });\n}\n","import type {\n  ActionItem,\n  ActiveEffect5e,\n  ActiveEffectContext,\n  AttunementContext,\n  CharacterSheetContext,\n  ClassSummary,\n  DropdownListOption,\n  HTMLElementOrGettable,\n  NpcSheetContext,\n  SpellcastingInfo,\n} from 'src/types/types';\nimport { CONSTANTS } from '../constants';\nimport type { Actor5e } from 'src/types/types';\nimport type { Item5e } from 'src/types/item.types';\nimport { settings, type CurrentSettings } from 'src/settings/settings.svelte';\nimport { debug, error } from 'src/utils/logging';\nimport FloatingContextMenu from 'src/context-menu/FloatingContextMenu';\nimport { TidyFlags } from './TidyFlags';\nimport { TidyHooks } from './TidyHooks';\nimport { isNil } from 'src/utils/data';\nimport { clamp } from 'src/utils/numbers';\nimport { processInputChangeDelta } from 'src/utils/form';\nimport { calculateSpellAttackAndDc } from 'src/utils/formula';\nimport type { Activity5e } from './dnd5e.types';\n\nexport const FoundryAdapter = {\n  deepClone(obj: any) {\n    return foundry.utils.deepClone(obj);\n  },\n  userIsGm() {\n    return game.user.isGM;\n  },\n  getTidySetting<T = string>(settingName: string): T {\n    return game.settings.get(CONSTANTS.MODULE_ID, settingName) as T;\n  },\n  async setTidySetting(\n    key: keyof CurrentSettings,\n    value: unknown\n  ): Promise<void> {\n    await game.settings.set(CONSTANTS.MODULE_ID, key, value);\n  },\n  registerTidySetting(key: string, data: any): void {\n    game.settings.register(CONSTANTS.MODULE_ID, key, data);\n  },\n  registerTidyMenu(key: string, data: any): void {\n    game.settings.registerMenu(CONSTANTS.MODULE_ID, key, data);\n  },\n  getGameSetting<T = string>(namespace: string, settingName: string): T {\n    return game.settings.get(namespace, settingName) as T;\n  },\n  getSystemSetting<T = string>(settingName: string): T {\n    return FoundryAdapter.getGameSetting(\n      CONSTANTS.DND5E_SYSTEM_ID,\n      settingName\n    );\n  },\n  async setGameSetting(\n    namespace: string,\n    key: string,\n    value: unknown\n  ): Promise<void> {\n    await game.settings.set(namespace, key, value);\n  },\n  onGetActiveEffectContextOptions(func: (...args: any[]) => void) {\n    Hooks.on('dnd5e.getActiveEffectContextOptions', func);\n  },\n  getTemplate(templateName: string) {\n    return `modules/${CONSTANTS.MODULE_ID}/templates/${templateName}`;\n  },\n  localize(value: string, options?: Record<string, unknown>) {\n    if (options) {\n      return game.i18n.format(value, options);\n    }\n\n    return game.i18n.localize(value);\n  },\n  // TODO: Extract a dedicated ActiveEffectManager or the like\n  addEffect(effectType: string, owner: any) {\n    const isActor = owner instanceof Actor;\n\n    const effectData = {\n      label: isActor ? game.i18n.localize('DND5E.EffectNew') : owner.name,\n      icon: isActor ? 'icons/svg/aura.svg' : owner.img,\n      origin: owner.uuid,\n      'duration.rounds': effectType === 'temporary' ? 1 : undefined,\n      disabled: effectType === 'inactive',\n    };\n\n    if (\n      !TidyHooks.tidy5eSheetsPreCreateActiveEffect(\n        owner,\n        effectData,\n        game.user.id\n      )\n    ) {\n      return;\n    }\n\n    return owner.createEmbeddedDocuments('ActiveEffect', [effectData]);\n  },\n  canPrepareSpell(item: Item5e) {\n    return (\n      item.system.preparation?.mode !==\n        CONSTANTS.SPELL_PREPARATION_MODE_ATWILL &&\n      item.system.preparation?.mode !==\n        CONSTANTS.SPELL_PREPARATION_MODE_INNATE &&\n      item.system.preparation?.mode !==\n        CONSTANTS.SPELL_PREPARATION_MODE_ALWAYS &&\n      item.system.preparation?.mode !== CONSTANTS.SPELL_PREPARATION_MODE_PACT &&\n      (item.system.level !== 0 || settings.value.allowCantripsToBePrepared)\n    );\n  },\n  /**\n   *\n   * @param content           - the editor content to include\n   * @param targetDataField   - the data field to update when this editor is saved\n   * @param editable          - whether the editor should allow editing\n   * @returns\n   */\n  createEditorHtml(\n    content: string,\n    targetDataField: string,\n    editable: boolean\n  ) {\n    return HandlebarsHelpers.editor(content, {\n      hash: {\n        target: targetDataField,\n        button: true,\n        engine: 'prosemirror',\n        collaborate: false,\n        editable,\n      },\n    });\n  },\n  mergeObject<T>(original: T, ...args: any[]) {\n    return foundry.utils.mergeObject(original, ...args) as T;\n  },\n  expandObject(data: any) {\n    return foundry.utils.expandObject(data);\n  },\n  isEmpty(obj: any) {\n    return foundry.utils.isEmpty(obj);\n  },\n  getClassIdentifier(item: Item5e): string {\n    return item.system.identifier || item.name.slugify({ strict: true });\n  },\n  getClassAndSubclassSummaries(actor: Actor5e): Map<string, ClassSummary> {\n    return actor.items.reduce(\n      (map: Map<string, ClassSummary>, item: Item5e) => {\n        if (item.type === 'class') {\n          const identifier = FoundryAdapter.getClassIdentifier(item);\n          const data: ClassSummary = map.get(identifier) ?? {};\n          data.class = item.name;\n          data.level = item.system.levels?.toString();\n          map.set(identifier, data);\n        }\n\n        if (\n          item.type === 'subclass' &&\n          item.system.classIdentifier !== undefined\n        ) {\n          const data: ClassSummary = map.get(item.system.classIdentifier) ?? {};\n          data.subclass = item.name;\n          if (item.system.classIdentifier !== undefined) {\n            map.set(item.system.classIdentifier, data);\n          }\n        }\n\n        return map;\n      },\n      new Map<string, ClassSummary>()\n    );\n  },\n  getActorCharacterSummaryEntries(actorContext: any): string[] {\n    const entries: string[] = [];\n\n    if (actorContext.system.details.race?.name) {\n      entries.push(actorContext.system.details.race.name);\n    } else if (actorContext.system.details.race) {\n      entries.push(actorContext.system.details.race);\n    }\n\n    if (actorContext.system.details.background?.name) {\n      entries.push(actorContext.system.details.background.name);\n    } else if (actorContext.system.details.background) {\n      entries.push(actorContext.system.details.background);\n    }\n\n    if (actorContext.system.details.alignment) {\n      entries.push(actorContext.system.details.alignment);\n    }\n\n    return entries;\n  },\n  getCurrentLang() {\n    return game.i18n.lang;\n  },\n  editOnMiddleClick(\n    event: MouseEvent,\n    entityWithSheet: {\n      sheet: { render: (force: boolean) => void; isEditable: boolean };\n    }\n  ) {\n    if (event.button !== CONSTANTS.MOUSE_BUTTON_AUXILIARY) {\n      return;\n    }\n\n    if (!entityWithSheet.sheet.isEditable) {\n      return;\n    }\n\n    event.preventDefault();\n    event.stopImmediatePropagation();\n\n    entityWithSheet.sheet.render(true);\n  },\n  createItem({ type, ...data }: Record<string, any>, actor: Actor5e) {\n    // Check to make sure the newly created class doesn't take player over level cap\n    if (\n      type === 'class' &&\n      actor.system.details.level + 1 > CONFIG.DND5E.maxLevel\n    ) {\n      const error = game.i18n.format('DND5E.MaxCharacterLevelExceededWarn', {\n        max: CONFIG.DND5E.maxLevel,\n      });\n      ui.notifications.error(error);\n      return null;\n    }\n\n    // Enforce the singleton rule for singleton items (e.g., an actor can have only one race)\n    const dataModel = CONFIG.Item.dataModels[type];\n    const singleton = dataModel?.metadata.singleton ?? false;\n    if (singleton && actor.itemTypes[type].length) {\n      const error = FoundryAdapter.localize('DND5E.ActorWarningSingleton', {\n        itemType: type,\n        actorType: actor.type,\n      });\n      ui.notifications.error(error);\n      return null;\n    }\n\n    const itemData = foundry.utils.mergeObject(\n      {\n        name: FoundryAdapter.localize('DND5E.ItemNew', {\n          type: FoundryAdapter.localize(\n            CONFIG.Item.typeLabels[type as keyof typeof CONFIG.Item.typeLabels]\n          ),\n        }),\n        type,\n      },\n      foundry.utils.expandObject({ ...data })\n    );\n\n    if (!TidyHooks.tidy5eSheetsPreCreateItem(actor, itemData, game.user.id)) {\n      return;\n    }\n\n    return actor.createEmbeddedDocuments('Item', [itemData]);\n  },\n  async onLevelChange(\n    event: Event & { currentTarget: EventTarget & HTMLSelectElement },\n    item: any,\n    actor: Actor5e\n  ) {\n    event.preventDefault();\n    const target = event.currentTarget;\n    if (!target?.value === undefined) {\n      return;\n    }\n\n    const delta = Number(event.currentTarget.value);\n    const classId = item.id;\n    if (!delta || !classId) {\n      return;\n    }\n\n    const classItem = actor.items.get(classId);\n\n    if (!game.settings.get('dnd5e', 'disableAdvancements')) {\n      const manager =\n        dnd5e.applications.advancement.AdvancementManager.forLevelChange(\n          actor,\n          classId,\n          delta\n        );\n      if (manager.steps.length) {\n        if (delta > 0) return manager.render(true);\n        try {\n          const shouldRemoveAdvancements =\n            await dnd5e.applications.advancement.AdvancementConfirmationDialog.forLevelDown(\n              classItem\n            );\n          if (shouldRemoveAdvancements) return manager.render(true);\n        } catch (err) {\n          return;\n        }\n      }\n    }\n\n    return classItem.update({\n      'system.levels': classItem.system.levels + delta,\n    });\n  },\n  getSpellComponentLabels() {\n    return Array.from(CONFIG.DND5E.validProperties.spell).reduce<\n      Record<string, string>\n    >((prev, curr) => {\n      const config =\n        CONFIG.DND5E.itemProperties[\n          curr as keyof typeof CONFIG.DND5E.itemProperties\n        ];\n      if ('abbreviation' in config) {\n        prev[config.abbreviation] = config.label;\n      }\n      return prev;\n    }, {});\n  },\n  getProperty<T = unknown>(obj: any, path: string): T | undefined {\n    return foundry.utils.getProperty(obj, path);\n  },\n  getInventoryRowClasses(item: Item5e, ctx?: any, extras?: string[]): string {\n    const itemClasses: string[] = [];\n\n    if (item?.system?.properties?.has('mgc')) {\n      itemClasses.push('magic-item');\n    }\n\n    if (ctx?.attunement?.cls && !FoundryAdapter.concealDetails(item)) {\n      itemClasses.push(ctx.attunement.cls);\n    }\n\n    if (item?.system?.equipped) {\n      itemClasses.push('equipped');\n    }\n\n    if (extras?.length) {\n      itemClasses.push(...extras);\n    }\n\n    return itemClasses.join(' ');\n  },\n  getSpellRowClasses(spell: any): string {\n    const classes: string[] = [];\n\n    if (\n      spell.system.preparation.mode ===\n        CONSTANTS.SPELL_PREPARATION_MODE_PREPARED &&\n      (spell.system.level > 0 || settings.value.allowCantripsToBePrepared)\n    ) {\n      classes.push('preparable');\n    }\n\n    if (spell.system.preparation.prepared) {\n      classes.push('prepared');\n    }\n\n    if (\n      spell.system.preparation.mode === CONSTANTS.SPELL_PREPARATION_MODE_ALWAYS\n    ) {\n      classes.push('always-prepared');\n    }\n\n    if (\n      spell.system.preparation.mode === CONSTANTS.SPELL_PREPARATION_MODE_PACT\n    ) {\n      classes.push('pact');\n    }\n\n    if (\n      spell.system.preparation.mode === CONSTANTS.SPELL_PREPARATION_MODE_ATWILL\n    ) {\n      classes.push('at-will');\n    }\n\n    if (\n      spell.system.preparation.mode === CONSTANTS.SPELL_PREPARATION_MODE_RITUAL\n    ) {\n      classes.push('ritual-only');\n    }\n\n    if (\n      spell.system.preparation.mode === CONSTANTS.SPELL_PREPARATION_MODE_INNATE\n    ) {\n      classes.push('innate');\n    }\n\n    return classes.join(' ');\n  },\n  getSpellAttackModAndTooltip(\n    context: CharacterSheetContext | NpcSheetContext\n  ) {\n    let actor = context.actor;\n    let formula = Roll.replaceFormulaData(\n      actor.system.bonuses.rsak.attack,\n      actor.getRollData(),\n      { missing: 0, warn: false }\n    );\n\n    let prof = actor.system.attributes.prof ?? 0;\n    let spellAbility = context.system.attributes.spellcasting;\n    let abilityMod =\n      (spellAbility != '' ? actor.system.abilities[spellAbility].mod : 0) ?? 0;\n    let spellAttackMod = prof + abilityMod;\n    let spellAttackText =\n      spellAttackMod > 0 ? '+' + spellAttackMod : spellAttackMod;\n\n    let spellAttackTextTooltip = `${prof} (prof.)+${abilityMod} (${spellAbility})`;\n\n    return {\n      mod: spellAttackText /* TODO: apply static bonuses; mention rolled bonuses without rolling them */,\n      bonus: formula,\n      modTooltip: spellAttackTextTooltip,\n    };\n  },\n  cycleProficiency(\n    actor: Actor5e,\n    key: string,\n    currentValue: number | undefined,\n    systemFieldName: string,\n    reverse: boolean = false\n  ): Promise<any | undefined> {\n    // TODO: Check for active effects and prevent if applicable.\n\n    if (currentValue === null || currentValue === undefined) {\n      return Promise.resolve(undefined);\n    }\n\n    const levels = [0, 1, 0.5, 2];\n    const idx = levels.indexOf(currentValue);\n    const next = idx + (reverse ? 3 : 1);\n    return actor.update({\n      [`system.${systemFieldName}.${key}.value`]: levels[next % levels.length],\n    });\n  },\n  getProficiencyIconClass(level: number) {\n    const icons: Record<number, string> = {\n      0: 'far fa-circle',\n      0.5: 'fas fa-adjust',\n      1: 'fas fa-check',\n      2: 'fas fa-check-double',\n    };\n    return icons[level] || icons[0];\n  },\n  getSpellImageUrl(\n    context: CharacterSheetContext | NpcSheetContext,\n    spell: any\n  ): string | undefined {\n    if (!settings.value.useSpellClassFilterIcons) {\n      return spell.img;\n    }\n\n    const sourceClass = spell.system.sourceClass;\n\n    const classImage =\n      sourceClass && 'actorClassesToImages' in context\n        ? context.actorClassesToImages[sourceClass]\n        : undefined;\n\n    return classImage ?? spell.img;\n  },\n  searchActors(searchCriteria: string, actors: Actor5e[]) {\n    return new Set(\n      actors\n        .filter((actor) => FoundryAdapter.searchActor(searchCriteria, actor))\n        .map((actor) => actor.uuid)\n    );\n  },\n  searchActor(searchCriteria: string, actor: Actor5e) {\n    return (\n      searchCriteria.trim() === '' ||\n      actor.name.toLowerCase().includes(searchCriteria.toLowerCase())\n    );\n  },\n  searchItems(searchCriteria: string, items: Item5e[]): Set<string> {\n    return new Set(\n      items\n        .filter((item) => FoundryAdapter.searchItem(item, searchCriteria))\n        .map((item) => item.uuid)\n    );\n  },\n  searchItem(item: any, searchCriteria: string): boolean {\n    return (\n      searchCriteria.trim() === '' ||\n      (item.system.identified === false &&\n        item.system.unidentified?.name\n          ?.toLowerCase()\n          .includes(searchCriteria.toLowerCase())) ||\n      (item.system.identified !== false &&\n        item.name.toLowerCase().includes(searchCriteria.toLowerCase()))\n    );\n  },\n  searchEffects(\n    searchCriteria: string,\n    effects: ActiveEffect5e[]\n  ): Set<string> {\n    return new Set(\n      effects\n        .filter(\n          (effect: any) =>\n            searchCriteria.trim() === '' ||\n            effect.name.toLowerCase().includes(searchCriteria.toLowerCase())\n        )\n        .map((effect) => effect.id)\n    );\n  },\n  searchActivities(\n    searchCriteria: string,\n    activities: Activity5e[]\n  ): Set<string> {\n    return new Set(\n      activities\n        .filter(\n          (activities: any) =>\n            searchCriteria.trim() === '' ||\n            activities.name.toLowerCase().includes(searchCriteria.toLowerCase())\n        )\n        .map((activities) => activities.uuid)\n    );\n  },\n  getFilteredActionItems(searchCriteria: string, items: ActionItem[]) {\n    return items.filter(\n      (x: ActionItem) =>\n        searchCriteria.trim() === '' ||\n        x.item?.name?.toLowerCase().includes(searchCriteria.toLowerCase())\n    );\n  },\n  getAllClassesDropdownOptions(\n    spellClassFilterAdditionalClassesText: string = ''\n  ) {\n    const allClasses: DropdownListOption[] = Object.entries(\n      CONSTANTS.DND5E_CLASSES\n    ).map((x) => ({\n      value: x[0],\n      text: x[1],\n    }));\n\n    if (spellClassFilterAdditionalClassesText?.trim() !== '') {\n      const additionalClasses = spellClassFilterAdditionalClassesText\n        .split(',')\n        .reduce((arr: DropdownListOption[], x: string) => {\n          const pieces = x.split('|');\n          if (pieces.length !== 2) {\n            return arr;\n          }\n          arr.push({\n            value: pieces[0],\n            text: pieces[1],\n          });\n          return arr;\n        }, []);\n\n      allClasses.push(...additionalClasses);\n    }\n\n    allClasses.sort((a, b) => a.text.localeCompare(b.text, game.i18n.lang));\n\n    return allClasses;\n  },\n  parseAdditionalClassesDropDownItems(\n    spellClassFilterAdditionalClassesText: string\n  ) {\n    return spellClassFilterAdditionalClassesText\n      .split(',')\n      .reduce((arr: DropdownListOption[], x: string) => {\n        const pieces = x.split('|');\n        if (pieces.length !== 2) {\n          return arr;\n        }\n        arr.push({\n          value: pieces[0],\n          text: pieces[1],\n        });\n        return arr;\n      }, []);\n  },\n  removeConfigureSettingsButtonWhenLockedForNonGm(buttons: any[]) {\n    if (FoundryAdapter.shouldLockConfigureSheet()) {\n      const configureSheetButtonIndex = buttons.findIndex((b) =>\n        b.class.includes('configure-sheet')\n      );\n      if (configureSheetButtonIndex >= 0) {\n        buttons.splice(configureSheetButtonIndex, 1);\n      }\n    }\n\n    return buttons;\n  },\n  getNewCargo() {\n    return { name: '', quantity: 1 };\n  },\n  getWeightUnit() {\n    return FoundryAdapter.localize(\n      `DND5E.Abbreviation${\n        game.settings.get('dnd5e', 'metricWeightUnits') ? 'Kg' : 'Lbs'\n      }`\n    );\n  },\n  isActiveEffectContextFavorited(context: ActiveEffectContext, actor: Actor5e) {\n    if (!actor) {\n      return false;\n    }\n\n    const effect = FoundryAdapter.getEffect({\n      document: actor,\n      effectId: context.id,\n      parentId: context.parentId,\n    });\n\n    return FoundryAdapter.isEffectFavorited(effect, actor);\n  },\n  getEffectActor(effect: ActiveEffect5e) {\n    return (\n      // Item-Owned\n      effect.parent?.actor ??\n      // Actor-Owned\n      effect.parent\n    );\n  },\n  isEffectFavorited(effect: ActiveEffect5e, actor: Actor5e) {\n    if (\n      actor?.documentName === CONSTANTS.DOCUMENT_NAME_ACTOR &&\n      'favorites' in actor.system\n    ) {\n      const relativeUuid = effect.getRelativeUUID(actor);\n      return actor.system.favorites.some((f: any) => f.id === relativeUuid);\n    }\n  },\n  async toggleFavoriteEffect(effect: ActiveEffect5e) {\n    const actor = FoundryAdapter.getEffectActor(effect);\n\n    if (!actor || !actor.system?.addFavorite) {\n      return;\n    }\n\n    const favorited = FoundryAdapter.isEffectFavorited(effect, actor);\n    if (favorited) {\n      await actor.system.removeFavorite(effect.getRelativeUUID(actor));\n    } else {\n      await actor.system.addFavorite({\n        type: 'effect',\n        id: effect.getRelativeUUID(actor),\n      });\n    }\n  },\n  isItemFavorited(document: any) {\n    const actor = document.actor;\n\n    if (actor && 'favorites' in actor.system) {\n      const relativeUuid = document.getRelativeUUID(actor);\n      return actor.system.hasFavorite(relativeUuid);\n    }\n\n    return false;\n  },\n  isActivityFavorited(activity: Activity5e) {\n    const actor = activity.actor;\n\n    if (actor && 'favorites' in actor.system) {\n      return actor.system.hasFavorite(activity.relativeUUID);\n    }\n\n    return false;\n  },\n  async toggleFavoriteItem(document: any) {\n    const actor = document.actor;\n\n    if (!actor || !actor.system?.addFavorite) {\n      return;\n    }\n\n    const favorited = FoundryAdapter.isItemFavorited(document);\n\n    if (favorited) {\n      await actor.system.removeFavorite(document.getRelativeUUID(actor));\n    } else {\n      await actor.system.addFavorite({\n        type: 'item',\n        id: document.getRelativeUUID(actor),\n      });\n    }\n  },\n  async toggleFavoriteActivity(activity: Activity5e) {\n    const actor = activity.actor;\n\n    if (!actor || !actor.system?.addFavorite) {\n      return;\n    }\n\n    const favorited = FoundryAdapter.isActivityFavorited(activity);\n\n    if (favorited) {\n      await actor.system.removeFavorite(activity.relativeUUID);\n    } else {\n      await actor.system.addFavorite({\n        type: 'activity',\n        id: activity.relativeUUID,\n      });\n    }\n  },\n  isSheetUnlocked(document: any): boolean {\n    return (\n      (document.isOwner && TidyFlags.allowEdit.get(document)) ||\n      (FoundryAdapter.userIsGm() &&\n        settings.value.permanentlyUnlockCharacterSheetForGm &&\n        document.type === CONSTANTS.SHEET_TYPE_CHARACTER) ||\n      (FoundryAdapter.userIsGm() &&\n        settings.value.permanentlyUnlockNpcSheetForGm &&\n        document.type === CONSTANTS.SHEET_TYPE_NPC) ||\n      (FoundryAdapter.userIsGm() &&\n        settings.value.permanentlyUnlockVehicleSheetForGm &&\n        document.type === CONSTANTS.SHEET_TYPE_VEHICLE)\n    );\n  },\n  allowCharacterEffectsManagement(actor: any) {\n    return (\n      (settings.value.limitEffectsManagementToGm &&\n        FoundryAdapter.userIsGm()) ||\n      (!settings.value.limitEffectsManagementToGm && actor.isOwner)\n    );\n  },\n  shouldLockMoneyChanges() {\n    return !FoundryAdapter.userIsGm() && settings.value.lockMoneyChanges;\n  },\n  shouldLockExpChanges() {\n    return !FoundryAdapter.userIsGm() && settings.value.lockExpChanges;\n  },\n  shouldLockHpMaxChanges() {\n    return !FoundryAdapter.userIsGm() && settings.value.lockHpMaxChanges;\n  },\n  shouldLockLevelSelector() {\n    return !FoundryAdapter.userIsGm() && settings.value.lockLevelSelector;\n  },\n  shouldLockConfigureSheet() {\n    return !FoundryAdapter.userIsGm() && settings.value.lockConfigureSheet;\n  },\n  shouldLockItemQuantity() {\n    return !FoundryAdapter.userIsGm() && settings.value.lockItemQuantity;\n  },\n  showLimitedSheet(actor: any): boolean {\n    const showLimitedSheet = !FoundryAdapter.userIsGm() && actor.limited;\n    if (actor.type === CONSTANTS.SHEET_TYPE_CHARACTER) {\n      return showLimitedSheet && !settings.value.showExpandedLimitedView;\n    }\n    return showLimitedSheet;\n  },\n  flattenObject(obj: Object) {\n    return foundry.utils.flattenObject(obj || {});\n  },\n  getGameItem(id: string): any | undefined {\n    return game.items.get(id);\n  },\n  getGameActor(id: string): any | undefined {\n    return game.actors.get(id);\n  },\n  getModule(moduleId: string): any | undefined {\n    return game.modules.get(moduleId);\n  },\n  debounce(callback: Function, delay: number): Function {\n    return foundry.utils.debounce(callback, delay);\n  },\n  roll(\n    formula: string,\n    rollData?: unknown,\n    rollFnOptions: any = {}\n  ): Promise<any> {\n    return new Roll(formula, rollData).roll(rollFnOptions);\n  },\n  renderCreatureTypeConfig(document: Actor5e) {\n    const raceId: string | undefined = document.system.details?.race?.id;\n\n    const documentToUpdate = raceId ? document.system.details.race : document;\n\n    const keyPath =\n      documentToUpdate.type === CONSTANTS.ITEM_TYPE_RACE\n        ? // A species document\n          'type'\n        : // An actor without a species\n          'details.type';\n\n    const options: Record<string, any> = {\n      document: documentToUpdate,\n      keyPath,\n    };\n\n    return new dnd5e.applications.shared.CreatureTypeConfig(options).render(\n      true\n    );\n  },\n  playDiceSound() {\n    return foundry.audio.AudioHelper.play({ src: CONFIG.sounds.dice });\n  },\n  calculateAverageFromFormula(formula: string) {\n    let r = new Roll(formula);\n    let term = r.terms;\n    debug(`tidy5e-npc | activateListeners | term: ${term}`);\n    let averageString: string | any[] = '';\n    for (let i = 0; i < term.length; i++) {\n      let type = term[i].constructor.name;\n      switch (type) {\n        case 'Die': {\n          averageString += Math.floor(\n            (term[i].faces * term[i].number + term[i].number) / 2\n          );\n          break;\n        }\n        case 'OperatorTerm': {\n          averageString += term[i].operator;\n          break;\n        }\n        case 'NumericTerm': {\n          averageString += term[i].number;\n          break;\n        }\n        default: {\n          break;\n        }\n      }\n    }\n    debug(`tidy5e-npc | activateListeners | averageString: ${averageString}`);\n    let average = 0;\n    averageString =\n      averageString.replace(/\\s/g, '').match(/[+\\-]?([0-9\\.\\s]+)/g) ?? [];\n    while (averageString.length) {\n      average += parseFloat(averageString.shift());\n    }\n    debug(`tidy5e-npc | activateListeners | average: ${average}`);\n    return average;\n  },\n  enrichHtml(value: string, options?: any): Promise<string> {\n    return TextEditor.enrichHTML(value, options);\n  },\n  createContextMenu(...args: any[]): any {\n    return new FloatingContextMenu(...args);\n  },\n  createAdvancementSelectionDialog(item: any) {\n    return game.dnd5e.applications.advancement.AdvancementSelection.createDialog(\n      item\n    );\n  },\n  deleteAdvancement(advancementItemId: string, item: Item5e) {\n    const advancement = item.advancement.byId[advancementItemId];\n    return advancement?.deleteDialog();\n  },\n  modifyAdvancementChoices(advancementLevel: string, item: Item5e) {\n    let manager =\n      dnd5e.applications.advancement.AdvancementManager.forModifyChoices(\n        item.actor,\n        item.id,\n        Number(advancementLevel)\n      );\n\n    if (manager.steps.length) {\n      manager.render(true);\n    }\n  },\n  editAdvancement(advancementItemId: string, item: Item5e) {\n    const advancement = item.advancement.byId[advancementItemId];\n\n    return new advancement.constructor.metadata.apps.config(advancement).render(\n      true\n    );\n  },\n  async renderSheetFromUuid(uuid: string) {\n    (await fromUuid(uuid))?.sheet?.render(true);\n  },\n  renderImagePopout(...args: any[]) {\n    return new ImagePopout(...args).render(true);\n  },\n  browseFilePicker(...args: any[]) {\n    return new FilePicker(...args).browse();\n  },\n  renderArmorConfig(document: any) {\n    return new dnd5e.applications.actor.ArmorClassConfig({ document }).render(\n      true\n    );\n  },\n  renderInitiativeConfig(document: any) {\n    return new dnd5e.applications.actor.InitiativeConfig({\n      document,\n    }).render(true);\n  },\n  renderAbilityConfig(document: any, key: any) {\n    return new dnd5e.applications.actor.AbilityConfig({\n      document,\n      key,\n    }).render(true);\n  },\n  renderMovementSensesConfig(document: any, type: 'movement' | 'senses') {\n    return new dnd5e.applications.shared.MovementSensesConfig({\n      document,\n      type,\n    }).render(true);\n  },\n  renderHitPointsDialog(document: any) {\n    return new dnd5e.applications.actor.HitPointsConfig({ document }).render(\n      true\n    );\n  },\n  renderHitDiceConfig(document: any) {\n    return new dnd5e.applications.actor.HitDiceConfig({ document }).render(\n      true\n    );\n  },\n  dialogConfirm(...args: any[]) {\n    return Dialog.confirm(...args);\n  },\n  renderActorSheetFlags(actor: any) {\n    return new dnd5e.applications.actor.ActorSheetFlags(actor).render(true);\n  },\n  renderToolsConfig(document: any) {\n    return new dnd5e.applications.actor.ToolsConfig({\n      document,\n      trait: 'tool',\n    }).render(true);\n  },\n  renderTraitsConfig(document: any, trait: string) {\n    return new dnd5e.applications.actor.TraitsConfig({\n      document,\n      trait,\n    }).render(true);\n  },\n  renderWeaponsConfig(actor: any) {\n    return new dnd5e.applications.actor.WeaponsConfig({\n      document: actor,\n      trait: 'weapon',\n    }).render({ force: true });\n  },\n  renderSkillToolConfig(document: any, trait: 'skills' | 'tools', key: string) {\n    return new dnd5e.applications.actor.SkillToolConfig({\n      document,\n      trait,\n      key,\n    }).render(true);\n  },\n  renderSourceConfig(document: any, keyPath: string) {\n    return new dnd5e.applications.SourceConfig(\n      { document: document },\n      {\n        keyPath,\n      }\n    ).render(true);\n  },\n  async onActorItemDelete(actor: Actor5e, item: Item5e) {\n    // If item has advancement, handle it separately\n    if (!game.settings.get('dnd5e', 'disableAdvancements')) {\n      const manager =\n        dnd5e.applications.advancement.AdvancementManager.forDeletedItem(\n          actor,\n          item.id\n        );\n\n      if (manager.steps.length) {\n        try {\n          const shouldRemoveAdvancements =\n            await dnd5e.applications.advancement.AdvancementConfirmationDialog.forDelete(\n              item\n            );\n\n          if (shouldRemoveAdvancements) {\n            return manager.render(true);\n          }\n\n          return item.delete({ shouldRemoveAdvancements });\n        } catch (err) {\n          // This dialog throws an exception when you click cancel. We'll ignore it.\n          return;\n        }\n      }\n    }\n\n    return item.deleteDialog();\n  },\n  getActivationTypeLabel(activationType: string) {\n    return activationType === 'other'\n      ? FoundryAdapter.localize('DND5E.ActionOther')\n      : game.dnd5e.config.abilityActivationTypes[activationType];\n  },\n  lookupDamageType(type: string) {\n    return game.dnd5e.config.damageTypes[type]?.label;\n  },\n  lookupHealingType(type: string) {\n    return game.dnd5e.config.healingTypes[type];\n  },\n  lookupAbility(abbr: string) {\n    return game.dnd5e.config.abilities[abbr];\n  },\n  actorTryUseItem(item: Item5e, event: Event) {\n    const config = { legacy: false, event };\n\n    const suppressItemUse =\n      TidyHooks.tidy5eSheetsActorPreUseItem(item, config) === false;\n\n    if (suppressItemUse) {\n      return;\n    }\n\n    item.use(config);\n  },\n  onActorItemButtonContextMenu(item: Item5e, options: { event: Event }) {\n    // Allow another module to react to a context menu action on the item use button.\n    TidyHooks.tidy5eSheetsActorItemUseContextMenu(item, options);\n  },\n  /**\n   * Fires appropriate hooks related to tab selection and reports whether tab selection was cancelled.\n   * @param app the associated sheets\n   * @param newTabId the new tab ID to select\n   * @returns `true` to indicate proceeding with tab change; `false` to halt tab change\n   */\n  onTabSelecting(\n    app: { currentTabId: string; element: HTMLElementOrGettable },\n    newTabId: string\n  ) {\n    const canProceed = TidyHooks.tidy5eSheetsPreSelectTab(\n      app,\n      FoundryAdapter.getElementFromAppV1OrV2(app.element),\n      {\n        currentTab: app.currentTabId,\n        newTab: newTabId,\n      }\n    );\n\n    if (!canProceed) {\n      return false;\n    }\n\n    setTimeout(() => {\n      TidyHooks.tidy5eSheetsSelectTab(\n        app,\n        FoundryAdapter.getElementFromAppV1OrV2(app.element),\n        newTabId\n      );\n    });\n\n    return true;\n  },\n  getElementFromAppV1OrV2(element: HTMLElementOrGettable) {\n    return 'get' in element ? element.get(0) : element;\n  },\n  getAbilitiesAsDropdownOptions(abilities: any): DropdownListOption[] {\n    try {\n      return Object.entries<any>(abilities).map(([key, { label }]) => ({\n        value: key,\n        text: label,\n      }));\n    } catch (e) {\n      error(\n        'An error occurred while mapping abilities as dropdown items',\n        false,\n        e\n      );\n      debug('Dropdown mapping error troubleshooting info', { abilities });\n      return [];\n    }\n  },\n  countPreparedSpells(items: Item5e[]) {\n    return items.filter(\n      (item: Item5e) =>\n        item.type === CONSTANTS.ITEM_TYPE_SPELL &&\n        item.system.level > 0 &&\n        item.system.preparation.mode ===\n          CONSTANTS.SPELL_PREPARATION_MODE_PREPARED &&\n        item.system.preparation.prepared\n    ).length;\n  },\n  concealDetails(item: Item5e | null | undefined) {\n    return !game.user.isGM && item?.system?.identified === false;\n  },\n  getIdentifiedName(item: Item5e): string {\n    if (!FoundryAdapter.userIsGm() || item?.system?.identified !== false) {\n      return item.name;\n    }\n\n    try {\n      return FoundryAdapter.localize('TIDY5E.GMOnly.Message', {\n        message: item.toJSON().name,\n      });\n    } catch (e) {\n      error(\n        'An error occurred while getting the identified name of this item for the GM',\n        false,\n        e\n      );\n      return '';\n    }\n  },\n  async toggleCondition(document: Actor5e, condition: any) {\n    const existing = document.effects.get(\n      dnd5e.utils.staticID(`dnd5e${condition.id}`)\n    );\n\n    if (existing) {\n      return existing.delete();\n    }\n\n    const effect = await ActiveEffect.implementation.fromStatusEffect(\n      condition.id\n    );\n\n    return ActiveEffect.implementation.create(effect, {\n      parent: document,\n      keepId: true,\n    });\n  },\n  getEffect({\n    document,\n    effectId,\n    parentId,\n  }: {\n    document: any;\n    effectId: string;\n    parentId?: string;\n  }) {\n    let effect = document.effects?.get(effectId);\n    if (effect) {\n      return effect;\n    }\n    const parentDocument = document.items.get(parentId);\n    effect = parentDocument?.effects?.get(effectId);\n    return (\n      effect ??\n      FoundryAdapter.tryGetLegacyTransferredEffect(parentDocument, effectId)\n    );\n  },\n  /** Last-ditch effort to find an effect by ID in a given document. */\n  tryGetLegacyTransferredEffect(document: any, effectId: string) {\n    return document\n      ?.allApplicableEffects?.()\n      .find((e: ActiveEffect5e) => e.id === effectId);\n  },\n  canUseItem(item: Item5e) {\n    return !(!item.actor || !item.actor.isOwner || item.actor.pack);\n  },\n  useClassicControls(document: any) {\n    return (\n      (document.type === CONSTANTS.SHEET_TYPE_CHARACTER &&\n        settings.value.useClassicControlsForCharacter) ||\n      (document.type === CONSTANTS.SHEET_TYPE_NPC &&\n        settings.value.useClassicControlsForNpc) ||\n      (document.type === CONSTANTS.SHEET_TYPE_VEHICLE &&\n        settings.value.useClassicControlsForVehicle) ||\n      // Temporary stopgap: When we don't recognize a supported document for Classic Controls options, fall back to the character user setting\n      settings.value.useClassicControlsForCharacter\n    );\n  },\n  attunementContextApplicable: {\n    icon: 'fa-sun',\n    cls: 'not-attuned',\n    title: 'ERROR: This should be replaced with valid attunement type text',\n  },\n  attunementContextAttune: {\n    icon: 'fa-sun',\n    cls: 'attuned',\n    title: 'DND5E.AttunementAttuned',\n  },\n  isAttunementApplicable(item: Item5e) {\n    return !!CONFIG.DND5E.attunementTypes[\n      item.system.attunement as keyof typeof CONFIG.DND5E.attunementTypes\n    ];\n  },\n  getAttunementContext(item: Item5e): AttunementContext | undefined {\n    return FoundryAdapter.isAttunementApplicable(item) && !item.system.attuned\n      ? {\n          ...FoundryAdapter.attunementContextApplicable,\n          title:\n            CONFIG.DND5E.attunementTypes[\n              item.system\n                .attunement as keyof typeof CONFIG.DND5E.attunementTypes\n            ],\n        }\n      : !!item.system.attunement && item.system.attuned\n      ? FoundryAdapter.attunementContextAttune\n      : undefined;\n  },\n  async identifyAllItemsForContainer(container: any, items: Item5e[]) {\n    const updates = items.map((i) => ({\n      _id: i.id,\n      'system.identified': true,\n    }));\n    await Item.updateDocuments(updates, {\n      parent: container.actor,\n      pack: container.pack,\n    });\n  },\n  async markAllItemsAsUnidentifiedForContainer(\n    container: any,\n    items: Item5e[]\n  ) {\n    const updates = items.map((i) => ({\n      _id: i.id,\n      'system.identified': false,\n    }));\n    await Item.updateDocuments(updates, {\n      parent: container.actor,\n      pack: container.pack,\n    });\n  },\n  canIdentify(item: Item5e) {\n    return (\n      FoundryAdapter.userIsGm() ||\n      (settings.value.itemIdentificationPermission ===\n        CONSTANTS.SHEET_SETTINGS_OPTION_GM_AND_OWNERS &&\n        item.isOwner)\n    );\n  },\n  getJqueryWrappedElement(el: HTMLElement) {\n    return globalThis.$(el);\n  },\n  openSpellSlotsConfig(document: any) {\n    new dnd5e.applications.actor.SpellSlotsConfig({ document }).render(true);\n  },\n  openSummonConfig(item: Item5e) {\n    new dnd5e.applications.item.SummoningConfig(item).render(true);\n  },\n  openDamagesConfig(document: Actor5e, trait: 'dr' | 'di' | 'dv' | 'dm') {\n    new dnd5e.applications.actor.DamagesConfig({ document, trait }).render(\n      true\n    );\n  },\n  openConcentrationConfig(document: any) {\n    new dnd5e.applications.actor.ConcentrationConfig({\n      document: document,\n    }).render(true);\n  },\n  openStartingEquipmentConfig(item: Item5e) {\n    new dnd5e.applications.item.StartingEquipmentConfig(item).render(true);\n  },\n  isConcentrationEffect(effect: ActiveEffect5e, app: any) {\n    return (\n      app.document instanceof dnd5e.documents.Actor5e &&\n      app._concentration?.effects.has(effect)\n    );\n  },\n  activateEditors(node: HTMLElement, sheet: any, bindSecrets: boolean = true) {\n    try {\n      const nodes = node.matches(\n        CONSTANTS.TEXT_EDITOR_ACTIVATION_ELEMENT_SELECTOR\n      )\n        ? [node]\n        : Array.from(\n            node.querySelectorAll<HTMLElement>(\n              CONSTANTS.TEXT_EDITOR_ACTIVATION_ELEMENT_SELECTOR\n            )\n          );\n\n      for (let editorDiv of nodes) {\n        sheet._activateEditor(editorDiv);\n      }\n      if (bindSecrets) {\n        sheet._secrets.forEach((s: any) => s.bind(node));\n      }\n    } catch (e) {\n      error('An error occurred while activating text editors', false, e);\n      debug('Text editor error trobuleshooting info', { node, sheet });\n    }\n  },\n  async renderFromUuid(uuid: string, force: boolean = true) {\n    const doc = await fromUuid(uuid);\n    return doc?.sheet?.render(force);\n  },\n  /**\n   * Stack identical consumables when a new one is dropped rather than creating a duplicate item.\n   */\n  onDropStackConsumablesForActor(\n    actor: Actor5e,\n    itemData: any,\n    { container = null }: { container: any | null },\n    event: DragEvent\n  ): Promise<Item5e> | null {\n    // TODO: Move this to the base actor sheet in app V2 when all actors go App V2.\n    const droppedSourceId =\n      itemData._stats?.compendiumSource ?? itemData.flags.core?.sourceId;\n\n    if (itemData.type !== 'consumable' || !droppedSourceId) {\n      return null;\n    }\n\n    const similarItem = actor.sourcedItems\n      .get(droppedSourceId, { legacy: false })\n      ?.filter(\n        (i: Item5e) =>\n          i.system.container === container && i.name === itemData.name\n      )\n      ?.first();\n\n    if (!similarItem) {\n      return null;\n    }\n\n    return similarItem.update({\n      'system.quantity':\n        similarItem.system.quantity + Math.max(itemData.system.quantity, 1),\n    });\n  },\n  /**\n   * Handle a drop event for an existing embedded Item to sort that Item relative to its siblings\n   */\n  onSortItemForActor(actor: Actor5e, event: Event, itemData: any): any {\n    // Handle Tidy Custom Section Transfer\n    const sourceSection = foundry.utils.getProperty(\n      itemData,\n      TidyFlags.section.prop\n    );\n\n    const targetSection = (event.target as HTMLElement | null)\n      ?.closest('[data-tidy-section-key][data-custom-section=\"true\"]')\n      ?.getAttribute('data-tidy-section-key');\n\n    const isMovedToNewSection =\n      !isNil(targetSection?.trim(), '') && sourceSection !== targetSection;\n\n    const isMovedToDefaultSection =\n      !isNil(sourceSection?.trim(), '') && isNil(targetSection?.trim(), '');\n\n    // Get the drag source and drop target\n    const items = actor.items;\n    const source = items.get(itemData._id);\n    const eventTarget = event.target;\n    if (!(eventTarget instanceof HTMLElement)) {\n      return;\n    }\n    const dropTarget = eventTarget.closest<HTMLElement>('[data-item-id]');\n    if (!dropTarget) return;\n    const target = items.get(dropTarget.dataset.itemId);\n\n    // Don't sort on yourself\n    if (source.id === target.id) return;\n\n    // Identify sibling items based on adjacent HTML elements\n    const siblings = [];\n    for (let el of Array.from(dropTarget.parentElement!.children)) {\n      if (el instanceof HTMLElement) {\n        const siblingId = el.dataset.itemId;\n        if (siblingId && siblingId !== source.id)\n          siblings.push(items.get(el.dataset.itemId));\n      }\n    }\n\n    // Perform the sort\n    const sortUpdates = SortingHelpers.performIntegerSort(source, {\n      target,\n      siblings,\n    });\n    const updateData = sortUpdates.map((u: any) => {\n      const update = u.update;\n      update._id = u.target._id;\n      if (update._id === source.id) {\n        // apply section change, if any\n        if (isMovedToNewSection) {\n          update[TidyFlags.section.prop] = targetSection;\n        } else if (isMovedToDefaultSection) {\n          update[TidyFlags.section.unsetProp] = null;\n        }\n      }\n      return update;\n    });\n\n    // Perform the update\n    return actor.updateEmbeddedDocuments('Item', updateData);\n  },\n  formatCr(cr: unknown) {\n    return dnd5e.utils.formatCR(cr);\n  },\n  formatNumber(num: number) {\n    return dnd5e.utils.formatNumber(num);\n  },\n  // TODO: Consolidate uses changed to one function\n  handleItemUsesChanged(\n    event: Event & {\n      currentTarget: EventTarget & HTMLInputElement;\n    },\n    documentWithUses: any,\n    valueProp: string = 'system.uses.value',\n    spentProp: string = 'system.uses.spent',\n    maxProp: string = 'system.uses.max'\n  ) {\n    const value = processInputChangeDelta(\n      event.currentTarget.value,\n      documentWithUses,\n      valueProp\n    );\n\n    const max =\n      FoundryAdapter.getProperty<number>(documentWithUses, maxProp) ?? 0;\n\n    const uses = clamp(0, value, max);\n    event.currentTarget.value = uses.toString();\n\n    return documentWithUses.update({ [spentProp]: max - uses });\n  },\n  handleActivityUsesChanged(\n    event: Event & {\n      currentTarget: EventTarget & HTMLInputElement;\n    },\n    activity: Activity5e\n  ) {\n    const value = processInputChangeDelta(\n      event.currentTarget.value,\n      activity,\n      'uses.value'\n    );\n\n    const uses = clamp(0, value, activity.uses.max);\n    event.currentTarget.value = uses.toString();\n\n    return activity.update({ 'system.uses.spent': activity.uses.max - uses });\n  },\n  // TEMP: Find better home\n  groupSelectOptions(entries: [string, any][]) {\n    const groupMap: Record<string, typeof entries> = {};\n    for (let [key, value] of entries) {\n      let groupMapKey =\n        typeof value === 'object' && 'group' in value ? value.group ?? '' : '';\n      (groupMap[groupMapKey] ??= []).push([key, value]);\n    }\n    return Object.entries<any>(groupMap);\n  },\n  getFilteredClassOrOriginal(actor: Actor5e): Item5e | undefined | null {\n    return (\n      FoundryAdapter.getFilteredClassOrNull(actor) ??\n      actor.items.get(actor.system.details.originalClass) ??\n      actor.itemTypes.class[0]\n    );\n  },\n  getFilteredClassOrNull(actor: Actor5e): Item5e | undefined | null {\n    return actor.itemTypes.class.find(\n      (c: any) => c.system.identifier === TidyFlags.classFilter.get(actor)\n    );\n  },\n  getSpellcastingInfo(actor: Actor5e, spells: Item5e[]): SpellcastingInfo {\n    const currentFilteredClass =\n      FoundryAdapter.getFilteredClassOrOriginal(actor);\n\n    return {\n      currentFilteredClass: currentFilteredClass,\n      prepared: {\n        value:\n          currentFilteredClass?.system?.spellcasting?.preparation?.value ?? 0,\n        max: currentFilteredClass?.system?.spellcasting?.preparation?.max ?? 0,\n      },\n      calculations: calculateSpellAttackAndDc(actor, currentFilteredClass),\n    };\n  },\n  getSaveAbilityAbbreviation(save: any) {\n    return save.ability?.size\n      ? save.ability.size === 1\n        ? CONFIG.DND5E.abilities[save.ability.first()]?.abbreviation\n        : FoundryAdapter.localize('DND5E.AbbreviationDC')\n      : null;\n  },\n  checkIfModernRules(document: any) {\n    return document.system.source?.rules\n      ? document.system.source?.rules === '2024'\n      : game.settings.get('dnd5e', 'rulesVersion') === 'modern';\n  },\n  prepareLanguageTrait(actor: any, traits: any) {\n    const languages = actor.system.traits?.languages?.labels;\n    traits.languages ??= [];\n\n    if (languages?.languages?.length)\n      traits.languages = languages.languages.map((label: string) => ({\n        label,\n      }));\n    for (const [key, { label }] of Object.entries(\n      CONFIG.DND5E.communicationTypes\n    )) {\n      const data = actor.system.traits?.languages?.communication?.[key];\n      if (!data?.value) continue;\n      let value = data.value;\n      if (data.units) {\n        value += ` ${data.units}`;\n      }\n      traits.languages.push({ label, value: value });\n    }\n  },\n  /**\n   * Forwards the current mode of the actor sheet\n   * to the default item sheet.\n   * Works only for toggling default item sheets as present.\n   */\n  getItemSheetMode(sheet: any) {\n    try {\n      const mode = FoundryAdapter.isSheetUnlocked(sheet)\n        ? dnd5e.applications.item.ItemSheet5e2.MODES.EDIT\n        : dnd5e.applications.item.ItemSheet5e2.MODES.PLAY;\n\n      return { mode };\n    } catch (e) {\n      error('Failed to get item sheet mode', false, e);\n      return {};\n    }\n  },\n};\n","import { ItemFilterRuntime } from './item/ItemFilterRuntime.svelte';\n\nexport function initRuntime() {\n  ItemFilterRuntime.init();\n}\n","/**\n * A tally that represents the number of migrations that have been added to Tidy.\n * This field is used by the developer to control whether a migration notification appears for the GM.\n * When the GM indicates \"Do Not Show Again,\" the migration tally is saved to world config,\n * to prevent the dialog from showing until the next round of migrations.\n * The number of times this tally advances is not as important as the fact that it advances at least once for any release that contains at least one new migration.\n */\n\nexport const MigrationTally = 6 as const;\n","import type { Tidy5eSheetsApi } from 'src/api';\nimport type { ModuleIntegrationBase } from '../integration-classes';\nimport type { ContextMenuPositionInfo } from 'src/context-menu/context-menu.types';\n\ndeclare var PopoutModule: any;\n\nexport class PopoutModuleIntegration implements ModuleIntegrationBase {\n  get moduleId(): string {\n    return 'popout';\n  }\n  init(api: Tidy5eSheetsApi): void {\n    this.setCorrectContextMenuPosition();\n    //this.addPopOutHeaderButton(api); // Uncomment if PopOut! supports App V2\n  }\n\n  private setCorrectContextMenuPosition() {\n    Hooks.on(\n      'tidy5e-sheet.prepareFloatingContextMenuPosition',\n      (info: ContextMenuPositionInfo) => {\n        const appNode = info.target.closest('[data-appId]');\n        const appIdAttribute = appNode?.getAttribute('data-appId');\n        const appId = parseInt(appIdAttribute ?? '');\n\n        const isPoppedOut = PopoutModule.singleton.poppedOut.has(appId);\n\n        if (!isPoppedOut) {\n          return;\n        }\n\n        const poppedOutBody =\n          PopoutModule.singleton.poppedOut.get(appId).window.document.body;\n\n        // Make the popped out Window Proxy the insert target for the context menu.\n        info.insertTarget = poppedOutBody;\n\n        poppedOutBody.addEventListener(\n          'click',\n          () => {\n            ui.context?.close();\n            // Remove the \"context\" class from any Tidy content, since some things may be decorated by that class.\n            poppedOutBody\n              .querySelectorAll('[data-context-menu]')\n              .forEach((el: HTMLElement) => el.classList.remove('context'));\n          },\n          { once: true }\n        );\n      }\n    );\n  }\n\n  private addPopOutHeaderButton(api: Tidy5eSheetsApi) {\n    api.registerItemHeaderControls({\n      controls: [\n        {\n          icon: 'fas fa-external-link-alt',\n          label: 'POPOUT.PopOut',\n          action: 'popout-module-on-popout-clicked',\n          async onClickAction(event, target) {\n            PopoutModule.singleton.onPopoutClicked(this);\n          },\n        },\n      ],\n    });\n  }\n}\n","import type { Tidy5eSheetsApi } from 'src/api/Tidy5eSheetsApi';\nimport type { ModuleIntegrationBase } from '../integration-classes';\n\nexport class CustomCharacterSheetsModuleIntegration\n  implements ModuleIntegrationBase\n{\n  get moduleId(): string {\n    return 'custom-character-sheet-sections';\n  }\n  init(api: Tidy5eSheetsApi): void {\n    Hooks.on(\n      'custom-character-sheet-sections.preCustomSectionGetData',\n      (data: any) => {\n        return !api.isTidy5eSheet(data.actor.sheet);\n      }\n    );\n  }\n}\n","<script lang=\"ts\">\n  interface Props {\n    total?: number;\n    selected?: number;\n    onChange?: (change: number) => void;\n  }\n\n  let { total = 5, selected = 0, onChange }: Props = $props();\n\n  function onPipClick(index: number) {\n    if (selected === index + 1) {\n      onChange?.(selected - 1);\n\n      return;\n    }\n\n    onChange?.(index + 1);\n  }\n\n  let pipArray = $derived(Array(total));\n</script>\n\n<div class=\"pips\">\n  {#each pipArray, i}\n    <button\n      type=\"button\"\n      class=\"pip\"\n      class:inactive={selected < i + 1}\n      class:active={selected >= i + 1}\n      class:last-selected={selected === i + 1}\n      onclick={() => onPipClick(i)}><i></i></button\n    >\n  {/each}\n\n  <span aria-hidden=\"true\" style=\"display: none\" class=\"pip-end\"></span>\n</div>\n","export const DRAKKENHEIM_CORE_CONSTANTS = {\n  MODULE_ID: 'drakkenheim-core',\n  CONTAMINATION_LEVEL_FLAG_PROP: `flags.drakkenheim.contamination`,\n} as const;\n","<script lang=\"ts\">\n  import Pips from 'src/components/pips/Pips.svelte';\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import type {\n    ActorSheetContextV1,\n    ActorSheetContextV2,\n  } from 'src/types/types';\n  import { DRAKKENHEIM_CORE_CONSTANTS } from './DrakkenheimCoreConstants';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  const context = $derived(getSheetContext<ActorSheetContextV1 | ActorSheetContextV2>());\n\n  let contanimationLevel = $derived(\n    FoundryAdapter.getProperty<number | undefined>(\n      context.actor,\n      DRAKKENHEIM_CORE_CONSTANTS.CONTAMINATION_LEVEL_FLAG_PROP,\n    ) ?? 0,\n  );\n\n  let levels = $derived(Array.fromRange(6, 1));\n\n  async function onContaminationLevelChanged(level: number): Promise<void> {\n    await context.actor.update({\n      [DRAKKENHEIM_CORE_CONSTANTS.CONTAMINATION_LEVEL_FLAG_PROP]: level,\n    });\n  }\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"scroll-container\">\n  <div class=\"description\">\n    {localize('DRAKKENHEIM.ContaminationTable')}\n  </div>\n  <table class=\"contamination-table\">\n    <thead>\n      <tr>\n        <th class=\"symptom\">{localize('DRAKKENHEIM.ContaminationSymptoms')}</th>\n      </tr>\n    </thead>\n    <tbody>\n      {#each levels as level}\n        <tr class:active={level <= contanimationLevel}>\n          <td class=\"symptom\">\n            {localize(`DRAKKENHEIM.ContaminationEffect${level}`)}\n          </td>\n        </tr>\n      {/each}\n    </tbody>\n  </table>\n\n  <Pips\n    total={levels.length}\n    selected={contanimationLevel}\n    onChange={(ev) => onContaminationLevelChanged(ev)}\n  />\n</div>\n","import type { Tidy5eSheetsApi } from 'src/api';\nimport type { ModuleIntegrationBase } from 'src/integration/integration-classes';\nimport DrakkenheimCoreContaminationTab from './DrakkenheimCoreContaminationTab.svelte';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\nexport class DrakkenheimCoreModuleIntegration implements ModuleIntegrationBase {\n  get moduleId(): string {\n    return 'drakkenheim-core';\n  }\n  init(api: Tidy5eSheetsApi): void {\n    import('./DrakkenheimContaminationTabClassic.scss');\n\n    const contaminationTab = new api.models.SvelteTab({\n      title: () => FoundryAdapter.localize('DRAKKENHEIM.Contamination'),\n      tabId: 'drakkenheim-contamination-tab',\n      component: DrakkenheimCoreContaminationTab,\n      getContext(context) {\n        return context;\n      },\n    });\n\n    api.registerCharacterTab(contaminationTab, { layout: 'classic' });\n    api.registerNpcTab(contaminationTab, { layout: 'classic' });\n  }\n}\n","import { TidyFlags, type Tidy5eSheetsApi } from 'src/api';\nimport type { SystemIntegrationBase } from '../integration-classes';\nimport { CONSTANTS } from 'src/constants';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { settings } from 'src/settings/settings.svelte';\n\nexport class TidyCustomSectionsInDefaultItemSheetIntegration\n  implements SystemIntegrationBase\n{\n  init(_: Tidy5eSheetsApi): void {\n    Hooks.on('renderItemSheet5e', (app: any) => {\n      const includeSectionFields =\n        settings.value.includeTidySectionFieldsInDefaultSheets;\n\n      if (!includeSectionFields) {\n        return;\n      }\n\n      const isUnsupportedItemType = [\n        CONSTANTS.ITEM_TYPE_RACE,\n        CONSTANTS.ITEM_TYPE_BACKGROUND,\n        CONSTANTS.ITEM_TYPE_CLASS,\n        CONSTANTS.ITEM_TYPE_SUBCLASS,\n      ].includes(app.document.type);\n\n      if (isUnsupportedItemType) {\n        return;\n      }\n\n      const inputIdPrefix = foundry.utils.randomID();\n      const section =\n        foundry.utils.getProperty(app.document, TidyFlags.section.prop) ?? '';\n      const actionSection =\n        foundry.utils.getProperty(app.document, TidyFlags.actionSection.prop) ??\n        '';\n      const customSectionId = `i-${inputIdPrefix}-tidy-5e-custom-section`;\n      const customActionSectionId = `i-${inputIdPrefix}-tidy-5e-custom-action-section`;\n      const html = `\n          <fieldset>\n            <legend>${FoundryAdapter.localize('TIDY5E.Tidy5eSettings')}</legend>\n            <div class=\"form-group custom-section\">\n              <label for=\"${customSectionId}\">\n                ${FoundryAdapter.localize('TIDY5E.Section.Label')}\n              </label>\n              <div class=\"form-fields\">\n                <input\n                  type=\"text\"\n                  name=\"${TidyFlags.section.prop}\"\n                  id=\"${customSectionId}\"\n                  value=\"\"\n                />\n              </div>\n            </div>\n            <div class=\"form-group custom-action-section\">\n              <label for=\"${customActionSectionId}\">\n                ${FoundryAdapter.localize('TIDY5E.Section.ActionLabel')}\n              </label>\n              <div class=\"form-fields\">\n                <input\n                  type=\"text\"\n                  name=\"${TidyFlags.actionSection.prop}\"\n                  id=\"${customActionSectionId}\"\n                  value=\"\"\n                />\n              </div>\n            </div>\n          </fieldset>`;\n\n      const element = FoundryAdapter.getElementFromAppV1OrV2(app.element);\n\n      element\n        .querySelector('.tab.details')\n        ?.insertAdjacentHTML('beforeend', html);\n\n      const sectionInput = element.querySelector<HTMLInputElement>(\n        `#${customSectionId}`\n      );\n\n      if (sectionInput) {\n        sectionInput.value = section;\n      }\n\n      const actionSectionInput = element.querySelector<HTMLInputElement>(\n        `#${customActionSectionId}`\n      );\n\n      if (actionSectionInput) {\n        actionSectionInput.value = actionSection;\n      }\n    });\n  }\n}\n","import type { Tidy5eSheetsApi } from 'src/api';\n\nexport abstract class ModuleIntegrationBase {\n  abstract get moduleId(): string;\n  abstract init(api: Tidy5eSheetsApi): void;\n}\n\nexport abstract class SystemIntegrationBase {\n  abstract init(api: Tidy5eSheetsApi): void;\n}\n\nexport abstract class ThirdPartyIntegrationBase {\n  abstract init(api: Tidy5eSheetsApi): void;\n  abstract name: string;\n}\n","const Coloris = (() => {\n  /*!\r\n  * Copyright (c) 2021-2024 Momo Bassit.\r\n  * Licensed under the MIT License (MIT)\r\n  * https://github.com/mdbassit/Coloris\r\n  * Version: 0.24.0\r\n  * NPM: https://github.com/melloware/coloris-npm\r\n  */\n\n  return ((window, document, Math, undefined) => {\n    const ctx = document.createElement('canvas').getContext('2d');\n    const currentColor = { r: 0, g: 0, b: 0, h: 0, s: 0, v: 0, a: 1 };\n    let container,picker,colorArea,colorMarker,colorPreview,colorValue,clearButton,closeButton,\n      hueSlider,hueMarker,alphaSlider,alphaMarker,currentEl,currentFormat,oldColor,keyboardNav,\n      colorAreaDims = {};\n\n    // Default settings\n    const settings = {\n      el: '[data-coloris]',\n      parent: 'body',\n      theme: 'default',\n      themeMode: 'light',\n      rtl: false,\n      wrap: true,\n      margin: 2,\n      format: 'hex',\n      formatToggle: false,\n      swatches: [],\n      swatchesOnly: false,\n      alpha: true,\n      forceAlpha: false,\n      focusInput: true,\n      selectInput: false,\n      inline: false,\n      defaultColor: '#000000',\n      clearButton: false,\n      clearLabel: 'Clear',\n      closeButton: false,\n      closeLabel: 'Close',\n      onChange: () => undefined,\n      a11y: {\n        open: 'Open color picker',\n        close: 'Close color picker',\n        clear: 'Clear the selected color',\n        marker: 'Saturation: {s}. Brightness: {v}.',\n        hueSlider: 'Hue slider',\n        alphaSlider: 'Opacity slider',\n        input: 'Color value field',\n        format: 'Color format',\n        swatch: 'Color swatch',\n        instruction: 'Saturation and brightness selector. Use up, down, left and right arrow keys to select.'\n      }\n    };\n\n    // Virtual instances cache\n    const instances = {};\n    let currentInstanceId = '';\n    let defaultInstance = {};\n    let hasInstance = false;\n\n    /**\r\n     * Configure the color picker.\r\n     * @param {object} options Configuration options.\r\n     */\n    function configure(options) {\n      if (typeof options !== 'object') {\n        return;\n      }\n\n      for (const key in options) {\n        switch (key) {\n          case 'el':\n            bindFields(options.el);\n            if (options.wrap !== false) {\n              wrapFields(options.el);\n            }\n            break;\n          case 'parent':\n            container = options.parent instanceof HTMLElement ? options.parent : document.querySelector(options.parent);\n            if (container) {\n              container.appendChild(picker);\n              settings.parent = options.parent;\n\n              // document.body is special\n              if (container === document.body) {\n                container = undefined;\n              }\n            }\n            break;\n          case 'themeMode':\n            settings.themeMode = options.themeMode;\n            if (options.themeMode === 'auto' && window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {\n              settings.themeMode = 'dark';\n            }\n          // The lack of a break statement is intentional\n          case 'theme':\n            if (options.theme) {\n              settings.theme = options.theme;\n            }\n\n            // Set the theme and color scheme\n            picker.className = \"clr-picker clr-\" + settings.theme + \" clr-\" + settings.themeMode;\n\n            // Update the color picker's position if inline mode is in use\n            if (settings.inline) {\n              updatePickerPosition();\n            }\n            break;\n          case 'rtl':\n            settings.rtl = !!options.rtl;\n            Array.from(document.getElementsByClassName('clr-field')).forEach((field) => field.classList.toggle('clr-rtl', settings.rtl));\n            break;\n          case 'margin':\n            options.margin *= 1;\n            settings.margin = !isNaN(options.margin) ? options.margin : settings.margin;\n            break;\n          case 'wrap':\n            if (options.el && options.wrap) {\n              wrapFields(options.el);\n            }\n            break;\n          case 'formatToggle':\n            settings.formatToggle = !!options.formatToggle;\n            getEl('clr-format').style.display = settings.formatToggle ? 'block' : 'none';\n            if (settings.formatToggle) {\n              settings.format = 'auto';\n            }\n            break;\n          case 'swatches':\n            if (Array.isArray(options.swatches)) {\n              const swatchesContainer = getEl('clr-swatches');\n              const swatches = document.createElement('div');\n\n              // Clear current swatches\n              swatchesContainer.textContent = '';\n\n              // Build new swatches\n              options.swatches.forEach((swatch, i) => {\n                const button = document.createElement('button');\n\n                button.setAttribute('type', \"button\");\n                button.setAttribute('id', \"clr-swatch-\" + i);\n                button.setAttribute('aria-labelledby', \"clr-swatch-label clr-swatch-\" + i);\n                button.style.color = swatch;\n                button.textContent = swatch;\n\n                swatches.appendChild(button);\n              });\n\n              // Append new swatches if any\n              if (options.swatches.length) {\n                swatchesContainer.appendChild(swatches);\n              }\n\n              settings.swatches = options.swatches.slice();\n            }\n            break;\n          case 'swatchesOnly':\n            settings.swatchesOnly = !!options.swatchesOnly;\n            picker.setAttribute('data-minimal', settings.swatchesOnly);\n            break;\n          case 'alpha':\n            settings.alpha = !!options.alpha;\n            picker.setAttribute('data-alpha', settings.alpha);\n            break;\n          case 'inline':\n            settings.inline = !!options.inline;\n            picker.setAttribute('data-inline', settings.inline);\n\n            if (settings.inline) {\n              const defaultColor = options.defaultColor || settings.defaultColor;\n\n              currentFormat = getColorFormatFromStr(defaultColor);\n              updatePickerPosition();\n              setColorFromStr(defaultColor);\n            }\n            break;\n          case 'clearButton':\n            // Backward compatibility\n            if (typeof options.clearButton === 'object') {\n              if (options.clearButton.label) {\n                settings.clearLabel = options.clearButton.label;\n                clearButton.innerHTML = settings.clearLabel;\n              }\n\n              options.clearButton = options.clearButton.show;\n            }\n\n            settings.clearButton = !!options.clearButton;\n            clearButton.style.display = settings.clearButton ? 'block' : 'none';\n            break;\n          case 'clearLabel':\n            settings.clearLabel = options.clearLabel;\n            clearButton.innerHTML = settings.clearLabel;\n            break;\n          case 'closeButton':\n            settings.closeButton = !!options.closeButton;\n\n            if (settings.closeButton) {\n              picker.insertBefore(closeButton, colorPreview);\n            } else {\n              colorPreview.appendChild(closeButton);\n            }\n\n            break;\n          case 'closeLabel':\n            settings.closeLabel = options.closeLabel;\n            closeButton.innerHTML = settings.closeLabel;\n            break;\n          case 'a11y':\n            const labels = options.a11y;\n            let update = false;\n\n            if (typeof labels === 'object') {\n              for (const label in labels) {\n                if (labels[label] && settings.a11y[label]) {\n                  settings.a11y[label] = labels[label];\n                  update = true;\n                }\n              }\n            }\n\n            if (update) {\n              const openLabel = getEl('clr-open-label');\n              const swatchLabel = getEl('clr-swatch-label');\n\n              openLabel.innerHTML = settings.a11y.open;\n              swatchLabel.innerHTML = settings.a11y.swatch;\n              closeButton.setAttribute('aria-label', settings.a11y.close);\n              clearButton.setAttribute('aria-label', settings.a11y.clear);\n              hueSlider.setAttribute('aria-label', settings.a11y.hueSlider);\n              alphaSlider.setAttribute('aria-label', settings.a11y.alphaSlider);\n              colorValue.setAttribute('aria-label', settings.a11y.input);\n              colorArea.setAttribute('aria-label', settings.a11y.instruction);\n            }\n            break;\n          default:\n            settings[key] = options[key];\n        }\n      }\n    }\n\n    /**\r\n     * Add or update a virtual instance.\r\n     * @param {String} selector The CSS selector of the elements to which the instance is attached.\r\n     * @param {Object} options Per-instance options to apply.\r\n     */\n    function setVirtualInstance(selector, options) {\n      if (typeof selector === 'string' && typeof options === 'object') {\n        instances[selector] = options;\n        hasInstance = true;\n      }\n    }\n\n    /**\r\n     * Remove a virtual instance.\r\n     * @param {String} selector The CSS selector of the elements to which the instance is attached.\r\n     */\n    function removeVirtualInstance(selector) {\n      delete instances[selector];\n\n      if (Object.keys(instances).length === 0) {\n        hasInstance = false;\n\n        if (selector === currentInstanceId) {\n          resetVirtualInstance();\n        }\n      }\n    }\n\n    /**\r\n     * Attach a virtual instance to an element if it matches a selector.\r\n     * @param {Object} element Target element that will receive a virtual instance if applicable.\r\n     */\n    function attachVirtualInstance(element) {\n      if (hasInstance) {\n        // These options can only be set globally, not per instance\n        const unsupportedOptions = ['el', 'wrap', 'rtl', 'inline', 'defaultColor', 'a11y'];\n\n        for (let selector in instances) {\n          const options = instances[selector];\n\n          // If the element matches an instance's CSS selector\n          if (element.matches(selector)) {\n            currentInstanceId = selector;\n            defaultInstance = {};\n\n            // Delete unsupported options\n            unsupportedOptions.forEach((option) => delete options[option]);\n\n            // Back up the default options so we can restore them later\n            for (let option in options) {\n              defaultInstance[option] = Array.isArray(settings[option]) ? settings[option].slice() : settings[option];\n            }\n\n            // Set the instance's options\n            configure(options);\n            break;\n          }\n        }\n      }\n    }\n\n    /**\r\n     * Revert any per-instance options that were previously applied.\r\n     */\n    function resetVirtualInstance() {\n      if (Object.keys(defaultInstance).length > 0) {\n        configure(defaultInstance);\n        currentInstanceId = '';\n        defaultInstance = {};\n      }\n    }\n\n    /**\r\n     * Bind the color picker to input fields that match the selector.\r\n     * @param {(string|HTMLElement|HTMLElement[])} selector A CSS selector string, a DOM element or a list of DOM elements.\r\n     */\n    function bindFields(selector) {\n      if (selector instanceof HTMLElement) {\n        selector = [selector];\n      }\n\n      if (Array.isArray(selector)) {\n        selector.forEach((field) => {\n          addListener(field, 'click', openPicker);\n          addListener(field, 'input', updateColorPreview);\n        });\n      } else {\n        addListener(document, 'click', selector, openPicker);\n        addListener(document, 'input', selector, updateColorPreview);\n      }\n    }\n\n    /**\r\n     * Open the color picker.\r\n     * @param {object} event The event that opens the color picker.\r\n     */\n    function openPicker(event) {\n      // Skip if inline mode is in use\n      if (settings.inline) {\n        return;\n      }\n\n      // Apply any per-instance options first\n      attachVirtualInstance(event.target);\n\n      currentEl = event.target;\n      oldColor = currentEl.value;\n      currentFormat = getColorFormatFromStr(oldColor);\n      picker.classList.add('clr-open');\n\n      updatePickerPosition();\n      setColorFromStr(oldColor);\n\n      if (settings.focusInput || settings.selectInput) {\n        colorValue.focus({ preventScroll: true });\n        colorValue.setSelectionRange(currentEl.selectionStart, currentEl.selectionEnd);\n      }\n\n      if (settings.selectInput) {\n        colorValue.select();\n      }\n\n      // Always focus the first element when using keyboard navigation\n      if (keyboardNav || settings.swatchesOnly) {\n        getFocusableElements().shift().focus();\n      }\n\n      // Trigger an \"open\" event\n      currentEl.dispatchEvent(new Event('open', { bubbles: true }));\n    }\n\n    /**\r\n     * Update the color picker's position and the color gradient's offset\r\n     */\n    function updatePickerPosition() {\n      if (!picker || !currentEl && !settings.inline) return; //** DO NOT REMOVE: in case called before initialized\n      const parent = container;\n      const scrollY = window.scrollY;\n      const pickerWidth = picker.offsetWidth;\n      const pickerHeight = picker.offsetHeight;\n      const reposition = { left: false, top: false };\n      let parentStyle, parentMarginTop, parentBorderTop;\n      let offset = { x: 0, y: 0 };\n\n      if (parent) {\n        parentStyle = window.getComputedStyle(parent);\n        parentMarginTop = parseFloat(parentStyle.marginTop);\n        parentBorderTop = parseFloat(parentStyle.borderTopWidth);\n\n        offset = parent.getBoundingClientRect();\n        offset.y += parentBorderTop + scrollY;\n      }\n\n      if (!settings.inline) {\n        const coords = currentEl.getBoundingClientRect();\n        let left = coords.x;\n        let top = scrollY + coords.y + coords.height + settings.margin;\n\n        // If the color picker is inside a custom container\n        // set the position relative to it\n        if (parent) {\n          left -= offset.x;\n          top -= offset.y;\n\n          if (left + pickerWidth > parent.clientWidth) {\n            left += coords.width - pickerWidth;\n            reposition.left = true;\n          }\n\n          if (top + pickerHeight > parent.clientHeight - parentMarginTop) {\n            if (pickerHeight + settings.margin <= coords.top - (offset.y - scrollY)) {\n              top -= coords.height + pickerHeight + settings.margin * 2;\n              reposition.top = true;\n            }\n          }\n\n          top += parent.scrollTop;\n\n          // Otherwise set the position relative to the whole document\n        } else {\n          if (left + pickerWidth > document.documentElement.clientWidth) {\n            left += coords.width - pickerWidth;\n            reposition.left = true;\n          }\n\n          if (top + pickerHeight - scrollY > document.documentElement.clientHeight) {\n            if (pickerHeight + settings.margin <= coords.top) {\n              top = scrollY + coords.y - pickerHeight - settings.margin;\n              reposition.top = true;\n            }\n          }\n        }\n\n        picker.classList.toggle('clr-left', reposition.left);\n        picker.classList.toggle('clr-top', reposition.top);\n        picker.style.left = left + \"px\";\n        picker.style.top = top + \"px\";\n        offset.x += picker.offsetLeft;\n        offset.y += picker.offsetTop;\n      }\n\n      colorAreaDims = {\n        width: colorArea.offsetWidth,\n        height: colorArea.offsetHeight,\n        x: colorArea.offsetLeft + offset.x,\n        y: colorArea.offsetTop + offset.y\n      };\n    }\n\n    /**\r\n     * Wrap the linked input fields in a div that adds a color preview.\r\n     * @param {(string|HTMLElement|HTMLElement[])} selector A CSS selector string, a DOM element or a list of DOM elements.\r\n     */\n    function wrapFields(selector) {\n      if (selector instanceof HTMLElement) {\n        wrapColorField(selector);\n      } else if (Array.isArray(selector)) {\n        selector.forEach(wrapColorField);\n      } else {\n        document.querySelectorAll(selector).forEach(wrapColorField);\n      }\n    }\n\n    /**\r\n       * Wrap an input field in a div that adds a color preview.\r\n       * @param {object} field The input field.\r\n       */\n    function wrapColorField(field) {\n      const parentNode = field.parentNode;\n\n      if (!parentNode.classList.contains('clr-field')) {\n        const wrapper = document.createElement('div');\n        let classes = 'clr-field';\n\n        if (settings.rtl || field.classList.contains('clr-rtl')) {\n          classes += ' clr-rtl';\n        }\n\n        wrapper.innerHTML = '<button type=\"button\" aria-labelledby=\"clr-open-label\"></button>';\n        parentNode.insertBefore(wrapper, field);\n        wrapper.className = classes;\n        wrapper.style.color = field.value;\n        wrapper.appendChild(field);\n      }\n    }\n\n    /**\r\n     * Update the color preview of an input field\r\n     * @param {object} event The \"input\" event that triggers the color change.\r\n     */\n    function updateColorPreview(event) {\n      const parent = event.target.parentNode;\n\n      // Only update the preview if the field has been previously wrapped\n      if (parent.classList.contains('clr-field')) {\n        parent.style.color = event.target.value;\n      }\n    }\n\n    /**\r\n     * Close the color picker.\r\n     * @param {boolean} [revert] If true, revert the color to the original value.\r\n     */\n    function closePicker(revert) {\n      if (currentEl && !settings.inline) {\n        const prevEl = currentEl;\n\n        // Revert the color to the original value if needed\n        if (revert) {\n          // This will prevent the \"change\" event on the colorValue input to execute its handler\n          currentEl = undefined;\n\n          if (oldColor !== prevEl.value) {\n            prevEl.value = oldColor;\n\n            // Trigger an \"input\" event to force update the thumbnail next to the input field\n            prevEl.dispatchEvent(new Event('input', { bubbles: true }));\n          }\n        }\n\n        // Trigger a \"change\" event if needed\n        setTimeout(() => {// Add this to the end of the event loop\n          if (oldColor !== prevEl.value) {\n            prevEl.dispatchEvent(new Event('change', { bubbles: true }));\n          }\n        });\n\n        // Hide the picker dialog\n        picker.classList.remove('clr-open');\n\n        // Reset any previously set per-instance options\n        if (hasInstance) {\n          resetVirtualInstance();\n        }\n\n        // Trigger a \"close\" event\n        prevEl.dispatchEvent(new Event('close', { bubbles: true }));\n\n        if (settings.focusInput) {\n          prevEl.focus({ preventScroll: true });\n        }\n\n        // This essentially marks the picker as closed\n        currentEl = undefined;\n      }\n    }\n\n    /**\r\n     * Set the active color from a string.\r\n     * @param {string} str String representing a color.\r\n     */\n    function setColorFromStr(str) {\n      const rgba = strToRGBA(str);\n      const hsva = RGBAtoHSVA(rgba);\n\n      updateMarkerA11yLabel(hsva.s, hsva.v);\n      updateColor(rgba, hsva);\n\n      // Update the UI\n      hueSlider.value = hsva.h;\n      picker.style.color = \"hsl(\" + hsva.h + \", 100%, 50%)\";\n      hueMarker.style.left = hsva.h / 360 * 100 + \"%\";\n\n      colorMarker.style.left = colorAreaDims.width * hsva.s / 100 + \"px\";\n      colorMarker.style.top = colorAreaDims.height - colorAreaDims.height * hsva.v / 100 + \"px\";\n\n      alphaSlider.value = hsva.a * 100;\n      alphaMarker.style.left = hsva.a * 100 + \"%\";\n    }\n\n    /**\r\n     * Guess the color format from a string.\r\n     * @param {string} str String representing a color.\r\n     * @return {string} The color format.\r\n     */\n    function getColorFormatFromStr(str) {\n      const format = str.substring(0, 3).toLowerCase();\n\n      if (format === 'rgb' || format === 'hsl') {\n        return format;\n      }\n\n      return 'hex';\n    }\n\n    /**\r\n     * Copy the active color to the linked input field.\r\n     * @param {number} [color] Color value to override the active color.\r\n     */\n    function pickColor(color) {\n      color = color !== undefined ? color : colorValue.value;\n\n      if (currentEl) {\n        currentEl.value = color;\n        currentEl.dispatchEvent(new Event('input', { bubbles: true }));\n      }\n\n      if (settings.onChange) {\n        settings.onChange.call(window, color, currentEl);\n      }\n\n      document.dispatchEvent(new CustomEvent('coloris:pick', { detail: { color, currentEl } }));\n    }\n\n    /**\r\n     * Set the active color based on a specific point in the color gradient.\r\n     * @param {number} x Left position.\r\n     * @param {number} y Top position.\r\n     */\n    function setColorAtPosition(x, y) {\n      const hsva = {\n        h: hueSlider.value * 1,\n        s: x / colorAreaDims.width * 100,\n        v: 100 - y / colorAreaDims.height * 100,\n        a: alphaSlider.value / 100\n      };\n      const rgba = HSVAtoRGBA(hsva);\n\n      updateMarkerA11yLabel(hsva.s, hsva.v);\n      updateColor(rgba, hsva);\n      pickColor();\n    }\n\n    /**\r\n     * Update the color marker's accessibility label.\r\n     * @param {number} saturation\r\n     * @param {number} value\r\n     */\n    function updateMarkerA11yLabel(saturation, value) {\n      let label = settings.a11y.marker;\n\n      saturation = saturation.toFixed(1) * 1;\n      value = value.toFixed(1) * 1;\n      label = label.replace('{s}', saturation);\n      label = label.replace('{v}', value);\n      colorMarker.setAttribute('aria-label', label);\n    }\n\n    //\n    /**\r\n     * Get the pageX and pageY positions of the pointer.\r\n     * @param {object} event The MouseEvent or TouchEvent object.\r\n     * @return {object} The pageX and pageY positions.\r\n     */\n    function getPointerPosition(event) {\n      return {\n        pageX: event.changedTouches ? event.changedTouches[0].pageX : event.pageX,\n        pageY: event.changedTouches ? event.changedTouches[0].pageY : event.pageY\n      };\n    }\n\n    /**\r\n     * Move the color marker when dragged.\r\n     * @param {object} event The MouseEvent object.\r\n     */\n    function moveMarker(event) {\n      const pointer = getPointerPosition(event);\n      let x = pointer.pageX - colorAreaDims.x;\n      let y = pointer.pageY - colorAreaDims.y;\n\n      if (container) {\n        y += container.scrollTop;\n      }\n\n      setMarkerPosition(x, y);\n\n      // Prevent scrolling while dragging the marker\n      event.preventDefault();\n      event.stopPropagation();\n    }\n\n    /**\r\n     * Move the color marker when the arrow keys are pressed.\r\n     * @param {number} offsetX The horizontal amount to move.\r\n     * @param {number} offsetY The vertical amount to move.\r\n     */\n    function moveMarkerOnKeydown(offsetX, offsetY) {\n      let x = colorMarker.style.left.replace('px', '') * 1 + offsetX;\n      let y = colorMarker.style.top.replace('px', '') * 1 + offsetY;\n\n      setMarkerPosition(x, y);\n    }\n\n    /**\r\n     * Set the color marker's position.\r\n     * @param {number} x Left position.\r\n     * @param {number} y Top position.\r\n     */\n    function setMarkerPosition(x, y) {\n      // Make sure the marker doesn't go out of bounds\n      x = x < 0 ? 0 : x > colorAreaDims.width ? colorAreaDims.width : x;\n      y = y < 0 ? 0 : y > colorAreaDims.height ? colorAreaDims.height : y;\n\n      // Set the position\n      colorMarker.style.left = x + \"px\";\n      colorMarker.style.top = y + \"px\";\n\n      // Update the color\n      setColorAtPosition(x, y);\n\n      // Make sure the marker is focused\n      colorMarker.focus();\n    }\n\n    /**\r\n     * Update the color picker's input field and preview thumb.\r\n     * @param {Object} rgba Red, green, blue and alpha values.\r\n     * @param {Object} [hsva] Hue, saturation, value and alpha values.\r\n     */\n    function updateColor(rgba, hsva) {if (rgba === void 0) {rgba = {};}if (hsva === void 0) {hsva = {};}\n      let format = settings.format;\n\n      for (const key in rgba) {\n        currentColor[key] = rgba[key];\n      }\n\n      for (const key in hsva) {\n        currentColor[key] = hsva[key];\n      }\n\n      const hex = RGBAToHex(currentColor);\n      const opaqueHex = hex.substring(0, 7);\n\n      colorMarker.style.color = opaqueHex;\n      alphaMarker.parentNode.style.color = opaqueHex;\n      alphaMarker.style.color = hex;\n      colorPreview.style.color = hex;\n\n      // Force repaint the color and alpha gradients as a workaround for a Google Chrome bug\n      colorArea.style.display = 'none';\n      colorArea.offsetHeight;\n      colorArea.style.display = '';\n      alphaMarker.nextElementSibling.style.display = 'none';\n      alphaMarker.nextElementSibling.offsetHeight;\n      alphaMarker.nextElementSibling.style.display = '';\n\n      if (format === 'mixed') {\n        format = currentColor.a === 1 ? 'hex' : 'rgb';\n      } else if (format === 'auto') {\n        format = currentFormat;\n      }\n\n      switch (format) {\n        case 'hex':\n          colorValue.value = hex;\n          break;\n        case 'rgb':\n          colorValue.value = RGBAToStr(currentColor);\n          break;\n        case 'hsl':\n          colorValue.value = HSLAToStr(HSVAtoHSLA(currentColor));\n          break;\n      }\n\n      // Select the current format in the format switcher\n      document.querySelector(\".clr-format [value=\\\"\" + format + \"\\\"]\").checked = true;\n    }\n\n    /**\r\n     * Set the hue when its slider is moved.\r\n     */\n    function setHue() {\n      const hue = hueSlider.value * 1;\n      const x = colorMarker.style.left.replace('px', '') * 1;\n      const y = colorMarker.style.top.replace('px', '') * 1;\n\n      picker.style.color = \"hsl(\" + hue + \", 100%, 50%)\";\n      hueMarker.style.left = hue / 360 * 100 + \"%\";\n\n      setColorAtPosition(x, y);\n    }\n\n    /**\r\n     * Set the alpha when its slider is moved.\r\n     */\n    function setAlpha() {\n      const alpha = alphaSlider.value / 100;\n\n      alphaMarker.style.left = alpha * 100 + \"%\";\n      updateColor({ a: alpha });\n      pickColor();\n    }\n\n    /**\r\n     * Convert HSVA to RGBA.\r\n     * @param {object} hsva Hue, saturation, value and alpha values.\r\n     * @return {object} Red, green, blue and alpha values.\r\n     */\n    function HSVAtoRGBA(hsva) {\n      const saturation = hsva.s / 100;\n      const value = hsva.v / 100;\n      let chroma = saturation * value;\n      let hueBy60 = hsva.h / 60;\n      let x = chroma * (1 - Math.abs(hueBy60 % 2 - 1));\n      let m = value - chroma;\n\n      chroma = chroma + m;\n      x = x + m;\n\n      const index = Math.floor(hueBy60) % 6;\n      const red = [chroma, x, m, m, x, chroma][index];\n      const green = [x, chroma, chroma, x, m, m][index];\n      const blue = [m, m, x, chroma, chroma, x][index];\n\n      return {\n        r: Math.round(red * 255),\n        g: Math.round(green * 255),\n        b: Math.round(blue * 255),\n        a: hsva.a\n      };\n    }\n\n    /**\r\n     * Convert HSVA to HSLA.\r\n     * @param {object} hsva Hue, saturation, value and alpha values.\r\n     * @return {object} Hue, saturation, lightness and alpha values.\r\n     */\n    function HSVAtoHSLA(hsva) {\n      const value = hsva.v / 100;\n      const lightness = value * (1 - hsva.s / 100 / 2);\n      let saturation;\n\n      if (lightness > 0 && lightness < 1) {\n        saturation = Math.round((value - lightness) / Math.min(lightness, 1 - lightness) * 100);\n      }\n\n      return {\n        h: hsva.h,\n        s: saturation || 0,\n        l: Math.round(lightness * 100),\n        a: hsva.a\n      };\n    }\n\n    /**\r\n     * Convert RGBA to HSVA.\r\n     * @param {object} rgba Red, green, blue and alpha values.\r\n     * @return {object} Hue, saturation, value and alpha values.\r\n     */\n    function RGBAtoHSVA(rgba) {\n      const red = rgba.r / 255;\n      const green = rgba.g / 255;\n      const blue = rgba.b / 255;\n      const xmax = Math.max(red, green, blue);\n      const xmin = Math.min(red, green, blue);\n      const chroma = xmax - xmin;\n      const value = xmax;\n      let hue = 0;\n      let saturation = 0;\n\n      if (chroma) {\n        if (xmax === red) {hue = (green - blue) / chroma;}\n        if (xmax === green) {hue = 2 + (blue - red) / chroma;}\n        if (xmax === blue) {hue = 4 + (red - green) / chroma;}\n        if (xmax) {saturation = chroma / xmax;}\n      }\n\n      hue = Math.floor(hue * 60);\n\n      return {\n        h: hue < 0 ? hue + 360 : hue,\n        s: Math.round(saturation * 100),\n        v: Math.round(value * 100),\n        a: rgba.a\n      };\n    }\n\n    /**\r\n     * Parse a string to RGBA.\r\n     * @param {string} str String representing a color.\r\n     * @return {object} Red, green, blue and alpha values.\r\n     */\n    function strToRGBA(str) {\n      const regex = /^((rgba)|rgb)[\\D]+([\\d.]+)[\\D]+([\\d.]+)[\\D]+([\\d.]+)[\\D]*?([\\d.]+|$)/i;\n      let match, rgba;\n\n      // Default to black for invalid color strings\n      ctx.fillStyle = '#000';\n\n      // Use canvas to convert the string to a valid color string\n      ctx.fillStyle = str;\n      match = regex.exec(ctx.fillStyle);\n\n      if (match) {\n        rgba = {\n          r: match[3] * 1,\n          g: match[4] * 1,\n          b: match[5] * 1,\n          a: match[6] * 1\n        };\n\n      } else {\n        match = ctx.fillStyle.replace('#', '').match(/.{2}/g).map((h) => parseInt(h, 16));\n        rgba = {\n          r: match[0],\n          g: match[1],\n          b: match[2],\n          a: 1\n        };\n      }\n\n      return rgba;\n    }\n\n    /**\r\n     * Convert RGBA to Hex.\r\n     * @param {object} rgba Red, green, blue and alpha values.\r\n     * @return {string} Hex color string.\r\n     */\n    function RGBAToHex(rgba) {\n      let R = rgba.r.toString(16);\n      let G = rgba.g.toString(16);\n      let B = rgba.b.toString(16);\n      let A = '';\n\n      if (rgba.r < 16) {\n        R = '0' + R;\n      }\n\n      if (rgba.g < 16) {\n        G = '0' + G;\n      }\n\n      if (rgba.b < 16) {\n        B = '0' + B;\n      }\n\n      if (settings.alpha && (rgba.a < 1 || settings.forceAlpha)) {\n        const alpha = rgba.a * 255 | 0;\n        A = alpha.toString(16);\n\n        if (alpha < 16) {\n          A = '0' + A;\n        }\n      }\n\n      return '#' + R + G + B + A;\n    }\n\n    /**\r\n     * Convert RGBA values to a CSS rgb/rgba string.\r\n     * @param {object} rgba Red, green, blue and alpha values.\r\n     * @return {string} CSS color string.\r\n     */\n    function RGBAToStr(rgba) {\n      if (!settings.alpha || rgba.a === 1 && !settings.forceAlpha) {\n        return \"rgb(\" + rgba.r + \", \" + rgba.g + \", \" + rgba.b + \")\";\n      } else {\n        return \"rgba(\" + rgba.r + \", \" + rgba.g + \", \" + rgba.b + \", \" + rgba.a + \")\";\n      }\n    }\n\n    /**\r\n     * Convert HSLA values to a CSS hsl/hsla string.\r\n     * @param {object} hsla Hue, saturation, lightness and alpha values.\r\n     * @return {string} CSS color string.\r\n     */\n    function HSLAToStr(hsla) {\n      if (!settings.alpha || hsla.a === 1 && !settings.forceAlpha) {\n        return \"hsl(\" + hsla.h + \", \" + hsla.s + \"%, \" + hsla.l + \"%)\";\n      } else {\n        return \"hsla(\" + hsla.h + \", \" + hsla.s + \"%, \" + hsla.l + \"%, \" + hsla.a + \")\";\n      }\n    }\n\n    /**\r\n     * Init the color picker.\r\n     */\n    function init() {\n      if (document.getElementById('clr-picker')) return; //** DO NOT REMOVE: Prevent binding events multiple times\n      // Render the UI\n      container = undefined;\n      picker = document.createElement('div');\n      picker.setAttribute('id', 'clr-picker');\n      picker.className = 'clr-picker';\n      picker.innerHTML =\n      \"<input id=\\\"clr-color-value\\\" name=\\\"clr-color-value\\\" class=\\\"clr-color\\\" type=\\\"text\\\" value=\\\"\\\" spellcheck=\\\"false\\\" aria-label=\\\"\" + settings.a11y.input + \"\\\">\" + (\"<div id=\\\"clr-color-area\\\" class=\\\"clr-gradient\\\" role=\\\"application\\\" aria-label=\\\"\" +\n      settings.a11y.instruction + \"\\\">\") +\n      '<div id=\"clr-color-marker\" class=\"clr-marker\" tabindex=\"0\"></div>' +\n      '</div>' +\n      '<div class=\"clr-hue\">' + (\"<input id=\\\"clr-hue-slider\\\" name=\\\"clr-hue-slider\\\" type=\\\"range\\\" min=\\\"0\\\" max=\\\"360\\\" step=\\\"1\\\" aria-label=\\\"\" +\n      settings.a11y.hueSlider + \"\\\">\") +\n      '<div id=\"clr-hue-marker\"></div>' +\n      '</div>' +\n      '<div class=\"clr-alpha\">' + (\"<input id=\\\"clr-alpha-slider\\\" name=\\\"clr-alpha-slider\\\" type=\\\"range\\\" min=\\\"0\\\" max=\\\"100\\\" step=\\\"1\\\" aria-label=\\\"\" +\n      settings.a11y.alphaSlider + \"\\\">\") +\n      '<div id=\"clr-alpha-marker\"></div>' +\n      '<span></span>' +\n      '</div>' +\n      '<div id=\"clr-format\" class=\"clr-format\">' +\n      '<fieldset class=\"clr-segmented\">' + (\"<legend>\" +\n      settings.a11y.format + \"</legend>\") +\n      '<input id=\"clr-f1\" type=\"radio\" name=\"clr-format\" value=\"hex\">' +\n      '<label for=\"clr-f1\">Hex</label>' +\n      '<input id=\"clr-f2\" type=\"radio\" name=\"clr-format\" value=\"rgb\">' +\n      '<label for=\"clr-f2\">RGB</label>' +\n      '<input id=\"clr-f3\" type=\"radio\" name=\"clr-format\" value=\"hsl\">' +\n      '<label for=\"clr-f3\">HSL</label>' +\n      '<span></span>' +\n      '</fieldset>' +\n      '</div>' +\n      '<div id=\"clr-swatches\" class=\"clr-swatches\"></div>' + (\"<button type=\\\"button\\\" id=\\\"clr-clear\\\" class=\\\"clr-clear\\\" aria-label=\\\"\" +\n      settings.a11y.clear + \"\\\">\" + settings.clearLabel + \"</button>\") +\n      '<div id=\"clr-color-preview\" class=\"clr-preview\">' + (\"<button type=\\\"button\\\" id=\\\"clr-close\\\" class=\\\"clr-close\\\" aria-label=\\\"\" +\n      settings.a11y.close + \"\\\">\" + settings.closeLabel + \"</button>\") +\n      '</div>' + (\"<span id=\\\"clr-open-label\\\" hidden>\" +\n      settings.a11y.open + \"</span>\") + (\"<span id=\\\"clr-swatch-label\\\" hidden>\" +\n      settings.a11y.swatch + \"</span>\");\n\n      // Append the color picker to the DOM\n      document.body.appendChild(picker);\n\n      // Reference the UI elements\n      colorArea = getEl('clr-color-area');\n      colorMarker = getEl('clr-color-marker');\n      clearButton = getEl('clr-clear');\n      closeButton = getEl('clr-close');\n      colorPreview = getEl('clr-color-preview');\n      colorValue = getEl('clr-color-value');\n      hueSlider = getEl('clr-hue-slider');\n      hueMarker = getEl('clr-hue-marker');\n      alphaSlider = getEl('clr-alpha-slider');\n      alphaMarker = getEl('clr-alpha-marker');\n\n      // Bind the picker to the default selector\n      bindFields(settings.el);\n      wrapFields(settings.el);\n\n      addListener(picker, 'mousedown', (event) => {\n        picker.classList.remove('clr-keyboard-nav');\n        event.stopPropagation();\n      });\n\n      addListener(colorArea, 'mousedown', (event) => {\n        addListener(document, 'mousemove', moveMarker);\n      });\n\n      addListener(colorArea, 'contextmenu', (event) => {\n        event.preventDefault();\n      });\n\n      addListener(colorArea, 'touchstart', (event) => {\n        document.addEventListener('touchmove', moveMarker, { passive: false });\n      });\n\n      addListener(colorMarker, 'mousedown', (event) => {\n        addListener(document, 'mousemove', moveMarker);\n      });\n\n      addListener(colorMarker, 'touchstart', (event) => {\n        document.addEventListener('touchmove', moveMarker, { passive: false });\n      });\n\n      addListener(colorValue, 'change', (event) => {\n        const value = colorValue.value;\n\n        if (currentEl || settings.inline) {\n          const color = value === '' ? value : setColorFromStr(value);\n          pickColor(color);\n        }\n      });\n\n      addListener(clearButton, 'click', (event) => {\n        pickColor('');\n        closePicker();\n      });\n\n      addListener(closeButton, 'click', (event) => {\n        pickColor();\n        closePicker();\n      });\n\n      addListener(getEl('clr-format'), 'click', '.clr-format input', (event) => {\n        currentFormat = event.target.value;\n        updateColor();\n        pickColor();\n      });\n\n      addListener(picker, 'click', '.clr-swatches button', (event) => {\n        setColorFromStr(event.target.textContent);\n        pickColor();\n\n        if (settings.swatchesOnly) {\n          closePicker();\n        }\n      });\n\n      addListener(document, 'mouseup', (event) => {\n        document.removeEventListener('mousemove', moveMarker);\n      });\n\n      addListener(document, 'touchend', (event) => {\n        document.removeEventListener('touchmove', moveMarker);\n      });\n\n      addListener(document, 'mousedown', (event) => {\n        keyboardNav = false;\n        picker.classList.remove('clr-keyboard-nav');\n        closePicker();\n      });\n\n      addListener(document, 'keydown', (event) => {\n        const key = event.key;\n        const target = event.target;\n        const shiftKey = event.shiftKey;\n        const navKeys = ['Tab', 'ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'];\n\n        if (key === 'Escape') {\n          closePicker(true);\n\n          // Display focus rings when using the keyboard\n        } else if (navKeys.includes(key)) {\n          keyboardNav = true;\n          picker.classList.add('clr-keyboard-nav');\n        }\n\n        // Trap the focus within the color picker while it's open\n        if (key === 'Tab' && target.matches('.clr-picker *')) {\n          const focusables = getFocusableElements();\n          const firstFocusable = focusables.shift();\n          const lastFocusable = focusables.pop();\n\n          if (shiftKey && target === firstFocusable) {\n            lastFocusable.focus();\n            event.preventDefault();\n          } else if (!shiftKey && target === lastFocusable) {\n            firstFocusable.focus();\n            event.preventDefault();\n          }\n        }\n      });\n\n      addListener(document, 'click', '.clr-field button', (event) => {\n        // Reset any previously set per-instance options\n        if (hasInstance) {\n          resetVirtualInstance();\n        }\n\n        // Open the color picker\n        event.target.nextElementSibling.dispatchEvent(new Event('click', { bubbles: true }));\n      });\n\n      addListener(colorMarker, 'keydown', (event) => {\n        const movements = {\n          ArrowUp: [0, -1],\n          ArrowDown: [0, 1],\n          ArrowLeft: [-1, 0],\n          ArrowRight: [1, 0]\n        };\n\n        if (Object.keys(movements).includes(event.key)) {\n          moveMarkerOnKeydown(...movements[event.key]);\n          event.preventDefault();\n        }\n      });\n\n      addListener(colorArea, 'click', moveMarker);\n      addListener(hueSlider, 'input', setHue);\n      addListener(alphaSlider, 'input', setAlpha);\n    }\n\n    /**\r\n     * Return a list of focusable elements within the color picker.\r\n     * @return {array} The list of focusable DOM elemnts.\r\n     */\n    function getFocusableElements() {\n      const controls = Array.from(picker.querySelectorAll('input, button'));\n      const focusables = controls.filter((node) => !!node.offsetWidth);\n\n      return focusables;\n    }\n\n    /**\r\n     * Shortcut for getElementById to optimize the minified JS.\r\n     * @param {string} id The element id.\r\n     * @return {object} The DOM element with the provided id.\r\n     */\n    function getEl(id) {\n      return document.getElementById(id);\n    }\n\n    /**\r\n     * Shortcut for addEventListener to optimize the minified JS.\r\n     * @param {object} context The context to which the listener is attached.\r\n     * @param {string} type Event type.\r\n     * @param {(string|function)} selector Event target if delegation is used, event handler if not.\r\n     * @param {function} [fn] Event handler if delegation is used.\r\n     */\n    function addListener(context, type, selector, fn) {\n      const matches = Element.prototype.matches || Element.prototype.msMatchesSelector;\n\n      // Delegate event to the target of the selector\n      if (typeof selector === 'string') {\n        context.addEventListener(type, (event) => {\n          if (matches.call(event.target, selector)) {\n            fn.call(event.target, event);\n          }\n        });\n\n        // If the selector is not a string then it's a function\n        // in which case we need a regular event listener\n      } else {\n        fn = selector;\n        context.addEventListener(type, fn);\n      }\n    }\n\n    /**\r\n     * Call a function only when the DOM is ready.\r\n     * @param {function} fn The function to call.\r\n     * @param {array} [args] Arguments to pass to the function.\r\n     */\n    function DOMReady(fn, args) {\n      args = args !== undefined ? args : [];\n\n      if (document.readyState !== 'loading') {\n        fn(...args);\n      } else {\n        document.addEventListener('DOMContentLoaded', () => {\n          fn(...args);\n        });\n      }\n    }\n\n    // Polyfill for Nodelist.forEach\n    if (NodeList !== undefined && NodeList.prototype && !NodeList.prototype.forEach) {\n      NodeList.prototype.forEach = Array.prototype.forEach;\n    }\n\n    //*****************************************************\n    //******* NPM: Custom code starts here ****************\n    //*****************************************************\n\n    /**\r\n     * Copy the active color to the linked input field and set the color.\r\n     * @param {string} [color] Color value to override the active color.\r\n     * @param {HTMLelement} [target] the element setting the color on\r\n     */\n    function setColor(color, target) {\n      currentEl = target;\n      oldColor = currentEl.value;\n      attachVirtualInstance(target);\n      currentFormat = getColorFormatFromStr(color);\n      updatePickerPosition();\n      setColorFromStr(color);\n      pickColor();\n      if (oldColor !== color) {\n        currentEl.dispatchEvent(new Event('change', { bubbles: true }));\n      }\n    }\n\n    // Expose the color picker to the global scope\n    const Coloris = (() => {\n      const methods = {\n        init: init,\n        set: configure,\n        wrap: wrapFields,\n        close: closePicker,\n        setInstance: setVirtualInstance,\n        setColor: setColor,\n        removeInstance: removeVirtualInstance,\n        updatePosition: updatePickerPosition,\n        ready: DOMReady\n      };\n\n      function Coloris(options) {\n        DOMReady(() => {\n          if (options) {\n            if (typeof options === 'string') {\n              bindFields(options);\n            } else {\n              configure(options);\n            }\n          }\n        });\n      }\n\n      for (const key in methods) {\n        Coloris[key] = function () {for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {args[_key] = arguments[_key];}\n          DOMReady(methods[key], args);\n        };\n      }\n\n      // handle window resize events re-aligning the panel\n      DOMReady(() => {\n        window.addEventListener('resize', (event) => {Coloris.updatePosition();});\n        window.addEventListener('scroll', (event) => {Coloris.updatePosition();});\n      });\n\n      return Coloris;\n    })();\n\n    // Ensure init function is available not only as as a default import\n    Coloris.coloris = Coloris;\n\n    // Init the color picker when the DOM is ready\n    return Coloris;\n\n  })(window, document, Math);\n})();\n\nconst _coloris = Coloris.coloris;\nconst _init = Coloris.init;\nconst _set = Coloris.set;\nconst _wrap = Coloris.wrap;\nconst _close = Coloris.close;\nconst _setInstance = Coloris.setInstance;\nconst _removeInstance = Coloris.removeInstance;\nconst _updatePosition = Coloris.updatePosition;\nexport default Coloris;\nexport {\n  _coloris as coloris,\n  _close as close,\n  _init as init,\n  _set as set,\n  _wrap as wrap,\n  _setInstance as setInstance,\n  _removeInstance as removeInstance,\n  _updatePosition as updatePosition };","import type { Tidy5eSheetsApi } from 'src/api';\nimport { ThirdPartyIntegrationBase } from '../integration-classes';\nimport Coloris from '@melloware/coloris';\nimport { settings } from 'src/settings/settings.svelte';\nimport { getThemeOrDefault } from 'src/theme/theme';\n\nexport class ColorisThirdPartyIntegration extends ThirdPartyIntegrationBase {\n  name: string = 'Coloris';\n\n  init(_api: Tidy5eSheetsApi): void {\n    import('./coloris.scss');\n    Coloris.init();\n    Coloris.coloris({\n      el: '.coloris',\n      formatToggle: true,\n      swatches: [\n        'rgba(58, 116, 126, 1)',\n        'rgba(60, 179, 113, 0.3)',\n        'rgba(25, 94, 59, 1)',\n        'rgba(144, 238, 144, 1)',\n        'rgba(255, 99, 71, 0.3)',\n        'rgba(139, 0, 0, 1)',\n        'rgba(255, 160, 122, 1)',\n        'rgba(102, 205, 170, 0.3)',\n        'rgba(0, 100, 0, 1)',\n        'rgba(152, 251, 152, 1)',\n        'rgba(221, 160, 221, 0.3)',\n        'rgba(138, 43, 226, 1)',\n        'rgba(255, 182, 193, 1)',\n        'rgba(255, 165, 0, 0.3)',\n        'rgba(184, 134, 11, 1)',\n        'rgba(255, 215, 0, 1)',\n      ],\n    });\n\n    $effect.root(() => {\n      const theme = getThemeOrDefault(settings.value.colorScheme);\n      // The documentation supports this usage, even if TypeScript does not.\n      //@ts-expect-error\n      Coloris({ themeMode: theme.type });\n    });\n  }\n}\n","import { PopoutModuleIntegration } from './modules/PopoutModuleIntegration';\nimport type {\n  ModuleIntegrationBase,\n  SystemIntegrationBase,\n  ThirdPartyIntegrationBase,\n} from './integration-classes';\nimport { error } from 'src/utils/logging';\nimport { CustomCharacterSheetsModuleIntegration } from './modules/CustomCharacterSheetsModuleIntegration';\nimport type { Tidy5eSheetsApi } from 'src/api/Tidy5eSheetsApi';\nimport { DrakkenheimCoreModuleIntegration } from './modules/Drakkenheim/DrakkenheimCore';\nimport { TidyCustomSectionsInDefaultItemSheetIntegration } from './system/TidyCustomSectionsInDefaultItemSheetIntegration';\nimport { ColorisThirdPartyIntegration } from './third-party/Coloris.svelte';\n\nexport function setupIntegrations(api: Tidy5eSheetsApi) {\n  setupSystemIntegrations(api);\n  setupModuleIntegrations(api);\n  setupThirdPartyIntegrations(api);\n}\n\n/* System Integrations */\n\nconst systemIntegrations: SystemIntegrationBase[] = [\n  new TidyCustomSectionsInDefaultItemSheetIntegration(),\n  // Add other system integrations here\n];\n\nfunction setupSystemIntegrations(api: Tidy5eSheetsApi) {\n  systemIntegrations.forEach((systemIntegration) => {\n    try {\n      systemIntegration.init(api);\n    } catch (e) {\n      error(`System integration failed`, false, e);\n    }\n  });\n}\n\n/* Module Integrations */\n\nconst moduleIntegrations: ModuleIntegrationBase[] = [\n  new PopoutModuleIntegration(),\n  new CustomCharacterSheetsModuleIntegration(),\n  new DrakkenheimCoreModuleIntegration(),\n  // Add other module integrations here\n];\n\nfunction setupModuleIntegrations(api: Tidy5eSheetsApi) {\n  moduleIntegrations.forEach((m) => {\n    try {\n      if (game.modules.get(m.moduleId)?.active) {\n        m.init(api);\n      }\n    } catch (e) {\n      error(`Module integration failed for ${m.moduleId}`, false, e);\n    }\n  });\n}\n\nconst thirdPartyIntegrations: ThirdPartyIntegrationBase[] = [\n  new ColorisThirdPartyIntegration(),\n];\n\nfunction setupThirdPartyIntegrations(api: Tidy5eSheetsApi) {\n  thirdPartyIntegrations.forEach((m) => {\n    try {\n      m.init(api);\n    } catch (e) {\n      error(`Module integration failed for third party script ${m.name}`, false, e);\n    }\n  });\n}\n","import { Tidy5eSheetsApi, TidyFlags } from 'src/api';\nimport { CONSTANTS } from 'src/constants';\n\nexport function initKeybindings() {\n  registerSheetLockToggleKeybinding();\n  registerHeaderMenuToggleKeybinding();\n}\n\nfunction registerSheetLockToggleKeybinding() {\n  game.keybindings.register(CONSTANTS.MODULE_ID, 'toggleSheetLock', {\n    name: 'TIDY5E.Keybindings.ToggleSheetLock.Name',\n    hint: 'TIDY5E.Keybindings.ToggleSheetLock.Hint',\n    onDown: async () => {\n      const tidyApi = Tidy5eSheetsApi._getApi();\n\n      if (!ui.activeWindow || !tidyApi.isTidy5eSheet(ui.activeWindow)) {\n        return;\n      }\n\n      const sheetDocument = ui.activeWindow.document;\n\n      if (!sheetDocument) {\n        return;\n      }\n\n      const allowEdit = TidyFlags.allowEdit.get(sheetDocument);\n      await TidyFlags.allowEdit.set(sheetDocument, !allowEdit);\n    },\n    onUp: () => {},\n    precedence: CONST.KEYBINDING_PRECEDENCE.NORMAL,\n  });\n}\n\nfunction registerHeaderMenuToggleKeybinding() {\n  game.keybindings.register(CONSTANTS.MODULE_ID, 'toggleHeaderMenu', {\n    name: \"TIDY5E.Keybindings.ToggleHeaderMenu.Name\",\n    hint: \"TIDY5E.Keybindings.ToggleHeaderMenu.Hint\",\n    onDown: async () => {\n      const tidyApi = Tidy5eSheetsApi._getApi();\n\n      if (!ui.activeWindow || !tidyApi.isTidy5eSheet(ui.activeWindow)) {\n        return;\n      }\n\n      ui.activeWindow.toggleControls?.();\n    },\n    onUp: () => {},\n    precedence: CONST.KEYBINDING_PRECEDENCE.NORMAL,\n    editable: [\n      {\n        key: \"KeyB\",\n        modifiers: [\"Alt\"]\n      }\n    ]\n  });\n}\n","import {\n  type HeaderControlRegistrationParams,\n  type Tidy5eSheetsApi,\n} from 'src/api';\nimport { settings } from 'src/settings/settings.svelte';\n\nexport class DebugTools {\n  static onReady(api: Tidy5eSheetsApi) {\n    if (settings.value.debug) {\n      async function onDebugButtonClick(app: any) {\n        ui.notifications.info(`${app.document.name} written to the console.`);\n        console.log(app.document);\n        console.log(await app.document.sheet.getData());\n      }\n\n      Hooks.on('getActorSheetHeaderButtons', (app: any, buttons: any[]) => {\n        buttons.unshift({\n          label: 'Tidy Debug Button',\n          class: 'tidy-debug-button',\n          icon: 'fas fa-broom',\n          onclick() {\n            onDebugButtonClick(app);\n          },\n        });\n      });\n\n      const controlRegistrationParams: HeaderControlRegistrationParams = {\n        controls: [\n          {\n            async onClickAction(this: any, event: PointerEvent) {\n              ui.notifications.info(\n                `${this.document.name} written to the console.`\n              );\n              console.log(this.document);\n              console.log(await this.document.sheet._prepareContext());\n            },\n            icon: 'fas fa-broom',\n            label: 'Tidy Debug Button',\n          },\n        ],\n      };\n      api.registerItemHeaderControls(controlRegistrationParams);\n      api.registerActorHeaderControls(controlRegistrationParams);\n    }\n  }\n}\n","<script lang=\"ts\">\n  import type { ChangeEventHandler } from 'svelte/elements';\n\n  interface Props {\n    checked?: boolean;\n    disabled?: boolean | undefined;\n    onchange?: ChangeEventHandler<HTMLInputElement>;\n  }\n\n  let {\n    checked = false,\n    onchange = undefined,\n    disabled = false,\n  }: Props = $props();\n</script>\n\n<label class=\"field-toggle\" class:disabled>\n  <!-- fa-check -->\n  <svg\n    class=\"checked-icon\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 448 512\"\n    ><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path\n      d=\"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\n    /></svg\n  >\n  <!-- fa-xmark -->\n  <svg\n    class=\"unchecked-icon\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 384 512\"\n    ><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path\n      d=\"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z\"\n    /></svg\n  >\n  <!-- fa-circle -->\n  <svg class=\"thumb\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"\n    ><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path\n      d=\"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512z\"\n    /></svg\n  >\n  <input\n    type=\"checkbox\"\n    {onchange}\n    {checked}\n    {disabled}\n    class=\"toggle hidden\"\n  />\n</label>\n","<script lang=\"ts\">\n  import type { Snippet } from 'svelte';\n  import Dnd5eIcon from '../icon/Dnd5eIcon.svelte';\n  import FieldToggle from './FieldToggle.svelte';\n\n  interface Props {\n    checked?: boolean;\n    checkedIconClass?: string | undefined;\n    checkedSvgSrc?: string | undefined;\n    uncheckedIconClass?: string | undefined;\n    uncheckedSvgSrc?: string | undefined;\n    disabled?: boolean | undefined;\n    onchange?:\n      | ((\n          event: Event & {\n            currentTarget: EventTarget & HTMLInputElement;\n          },\n        ) => void)\n      | undefined;\n    children?: Snippet;\n  }\n\n  let {\n    checked = $bindable(false),\n    checkedIconClass = undefined,\n    checkedSvgSrc = undefined,\n    uncheckedIconClass = undefined,\n    uncheckedSvgSrc = undefined,\n    disabled = false,\n    onchange = undefined,\n    children,\n  }: Props = $props();\n</script>\n\n<label class=\"pill pill-switch interactive\" class:disabled>\n  <span>\n    <span class=\"pill-switch-icon-container\" class:hidden={!checked}>\n      {#if checkedIconClass}\n        <i class={checkedIconClass}></i>\n      {/if}\n      {#if checkedSvgSrc}\n        <Dnd5eIcon class=\"fa-fw\" src={checkedSvgSrc} />\n      {/if}\n    </span>\n    <span class=\"pill-switch-icon-container\" class:hidden={checked}>\n      {#if uncheckedIconClass}\n        <i class={uncheckedIconClass}></i>\n      {/if}\n      {#if uncheckedSvgSrc}\n        <Dnd5eIcon class=\"fa-fw\" src={uncheckedSvgSrc} />\n      {/if}\n    </span>\n    {@render children?.()}\n  </span>\n  <FieldToggle {checked} {onchange} {disabled} />\n</label>\n","export class RarityColors {\n  static getRarityText(key: string) {\n    return CONFIG.DND5E.itemRarity[key] ?? '';\n  }\n\n  static getRarityColorVariableName(key: string) {\n    return `--t5e-color-rarity-${RarityColors.getRarityText(key).slugify()}`;\n  }\n}\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n  import { CONSTANTS } from 'src/constants';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import ItemImageBorder from '../item/parts/ItemImageBorder.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import PillSwitch from 'src/components/toggles/PillSwitch.svelte';\n  import { getContainerSheetQuadroneContext } from 'src/sheets/sheet-context.svelte';\n  import { coalesce } from 'src/utils/formatting';\n  import { untrack } from 'svelte';\n  import TidyVisibilityObserver from 'src/components/utility/TidyVisibilityObserver.svelte';\n  import Select from 'src/components/inputs/Select.svelte';\n  import { RarityColors } from 'src/features/rarity-colors/RarityColors';\n  import { TidyFlags } from 'src/api';\n  import { SectionSelectorApplication } from 'src/applications/section-selector/SectionSelectorApplication.svelte';\n\n  let context = $derived(getContainerSheetQuadroneContext());\n\n  const localize = FoundryAdapter.localize;\n\n  let selectedTabId: string = $state(CONSTANTS.TAB_CONTAINER_CONTENTS);\n\n  let identifiedText = $derived(\n    context.system.identified\n      ? localize('DND5E.Identified')\n      : localize('DND5E.Unidentified.Title'),\n  );\n\n  let rarityColorVariable = $derived(\n    RarityColors.getRarityColorVariableName(context.system.rarity),\n  );\n\n  let rarityText = $derived(\n    RarityColors.getRarityText(context.system.rarity).titleCase(),\n  );\n\n  let denomination = $derived(\n    CONFIG.DND5E.currencies[context.system.price.denomination],\n  );\n\n  let itemValueText = $derived(\n    FoundryAdapter.formatNumber(context.system.price?.value),\n  );\n\n  let containerNameEl: HTMLElement | undefined = $state();\n  let scrollMarkerEl: HTMLElement | undefined = $state();\n\n  const headerOffset = $derived.by(() => {\n    return untrack(() => {\n      const headerHeight = coalesce(\n        window.getComputedStyle(context.item.sheet.window.header).height,\n        '36',\n      );\n\n      return `-${headerHeight}px`;\n    });\n  });\n\n  let itemRarities = $derived(\n    Object.entries(context.config.itemRarity).map(([key, value]) => {\n      return {\n        key,\n        label: value,\n        rarityColorVariableName: RarityColors.getRarityColorVariableName(key),\n      };\n    }),\n  );\n\n  let section = $derived(\n    TidyFlags.section.get(context.item) ?? localize('Default'),\n  );\n\n  let actionSection = $derived(\n    TidyFlags.actionSection.get(context.item) ?? localize('Default'),\n  );\n\n  let holdsMarkup = $derived.by(() => {\n    return localize('TIDY5E.Containers.HoldsNumberUnits', {\n      holdsElementStart: '<span class=\"text-secondary fw-normal\">',\n      holdsElementEnd: '</span>',\n      numberElementStart: '<span>',\n      numberElementEnd: '</span>',\n      number: context.capacity.max,\n      unitsElementStart: '<span class=\"text-secondary fw-normal\">',\n      unitsElementEnd: '</span>',\n      units: context.capacity.units,\n    });\n  });\n</script>\n\n{#if !!containerNameEl}\n  <TidyVisibilityObserver\n    root={context.item.sheet.windowContent}\n    trackWhenOffScreen={true}\n    toObserve={[containerNameEl]}\n    toAffect=\"self\"\n    rootMargin={headerOffset}\n  />\n{/if}\n\n{#if !!scrollMarkerEl}\n  <TidyVisibilityObserver\n    root={context.item.sheet.windowContent}\n    trackWhenOffScreen={true}\n    toObserve={[scrollMarkerEl]}\n    toAffect=\"self\"\n  />\n{/if}\n\n<div\n  bind:this={scrollMarkerEl}\n  class=\"container-header-start-scroll-marker\"\n  role=\"presentation\"\n></div>\n\n<aside\n  class=\"sidebar inverse\"\n  style=\"\n    --t5e-item-rarity-color: var({rarityColorVariable}, var(--t5e-color-gold)); \n    --filigree-border-color: var({rarityColorVariable}, var(--t5e-color-gold))\"\n>\n  <div class=\"item-image-rarity-container\">\n    <div class=\"item-image-container\">\n      <img class=\"item-image\" src={context.item.img} alt={context.item.name} />\n      <ItemImageBorder />\n    </div>\n    <div class=\"item-rarity-container\">\n      {#if context.unlocked}\n        <Select\n          id=\"rarity-{context.item.sheet.id}\"\n          document={context.item}\n          field=\"system.rarity\"\n          class=\"item-rarity-selector capitalize\"\n          value={context.system.rarity}\n          disabled={!context.editable}\n          blankValue=\"\"\n        >\n          <option\n            value=\"\"\n            style=\"--t5e-item-rarity-color: var(--t5e-color-gold);\"\n            >{localize('DND5E.Rarity')}</option\n          >\n          {#each itemRarities as rarity (rarity.key)}\n            <option\n              value={rarity.key}\n              style=\"--t5e-item-rarity-color: var({rarity.rarityColorVariableName}, var(--t5e-color-text-oninverse-default));\"\n            >\n              {rarity.label}\n            </option>\n          {/each}\n        </Select>\n      {:else}\n        <div class=\"item-rarity-text\">{rarityText}</div>\n      {/if}\n    </div>\n  </div>\n\n  <ul class=\"pills stacked\">\n    <li>\n      <PillSwitch\n        checked={context.system.equipped}\n        checkedIconClass=\"fas fa-hand-fist equip-icon fa-fw\"\n        uncheckedIconClass=\"far fa-hand fa-fw\"\n        onchange={(ev) =>\n          context.item.update({\n            'system.equipped': ev.currentTarget?.checked,\n          })}\n        disabled={!context.editable}\n      >\n        {localize('DND5E.Equipped')}\n      </PillSwitch>\n    </li>\n    {#if FoundryAdapter.isAttunementApplicable(context.item)}\n      <li>\n        <PillSwitch\n          checked={context.system.attuned}\n          checkedIconClass=\"fas fa-sun equip-icon fa-fw\"\n          uncheckedIconClass=\"fas fa-sun equip-icon fa-fw\"\n          onchange={(ev) =>\n            context.item.update({\n              'system.attuned': ev.currentTarget?.checked,\n            })}\n          disabled={!context.editable}\n        >\n          {localize('DND5E.Attuned')}\n        </PillSwitch>\n      </li>\n    {/if}\n    {#if context.unlocked}\n      <li>\n        <PillSwitch\n          checked={context.system.identified}\n          checkedIconClass=\"fas fa-search fa-fw\"\n          uncheckedIconClass=\"fas fa-search fa-fw\"\n          onchange={(ev) =>\n            context.item.update({\n              'system.identified': ev.currentTarget?.checked,\n            })}\n          disabled={!context.editable}\n        >\n          {localize('DND5E.Identified')}\n        </PillSwitch>\n      </li>\n    {:else}\n      <li class=\"pill\">\n        <i class=\"fas fa-search\"></i>\n        <span class=\"label\">\n          {identifiedText}\n        </span>\n      </li>\n    {/if}\n\n    <li class=\"pill\">\n      <span>\n        {@html holdsMarkup}\n      </span>\n    </li>\n  </ul>\n\n  <div>\n    <h4 class=\"currency-header\">\n      <span>{localize('DND5E.Currency')}</span>\n      <a\n        class=\"button icon-button currency-conversion\"\n        class:disabled={!context.editable}\n        onclick={() =>\n          context.owner &&\n          new dnd5e.applications.CurrencyManager(context.document).render(true)}\n        title={localize('DND5E.CurrencyManager.Title')}\n      >\n        <i class=\"fas fa-database\"></i>\n      </a>\n    </h4>\n    <div class=\"currencies\">\n      {#each context.currencies as currency (currency.key)}\n        <label class=\"input-group\">\n          <i class=\"currency {currency.key}\" aria-label={currency.key}></i>\n          <TextInput\n            document={context.document}\n            field=\"system.currency.{currency.key}\"\n            id=\"{context.document.id}-system.currency.{currency.key}\"\n            value={currency.value}\n            allowDeltaChanges={true}\n            selectOnFocus={true}\n            disabled={!context.editable || context.lockMoneyChanges}\n            class=\"currency-item currency-{currency.key}\"\n            placeholder=\"0\"\n          />\n          <span class=\"denomination {currency.key}\" data-denom={currency.key}>\n            {currency.abbr}\n          </span>\n        </label>\n      {/each}\n    </div>\n  </div>\n\n  {#if !context.concealDetails}\n    {#if context.labels.toHit || context.labels.damages.length}\n      <h4>\n        {localize('DND5E.Attack')}/{localize('DND5E.Damage')}\n      </h4>\n      <ul class=\"pills\" inert={context.concealDetails}>\n        {#if context.labels.save}\n          <li class=\"pill\">\n            {context.labels.save}\n          </li>\n        {/if}\n\n        {#if context.labels.toHit}\n          <li class=\"pill\">\n            {context.labels.toHit}\n            {localize('DND5E.ToHit')}\n          </li>\n        {/if}\n\n        {#each context.labels.damages ?? [] as damage}\n          {@const label = damage.label}\n          <li class=\"pill\">\n            {label}\n          </li>\n        {/each}\n      </ul>\n    {/if}\n  {/if}\n\n  <div>\n    <h4>{localize('TIDY5E.Section.LabelPl')}</h4>\n    <div class=\"pills stacked\">\n      <a\n        title={localize('TIDY5E.Section.SectionSelectorChooseSectionTooltip')}\n        class=\"pill interactive wrapped no-row-gap\"\n        class:disabled={!context.editable}\n        onclick={() =>\n          new SectionSelectorApplication(\n            context.item,\n            TidyFlags.section.prop,\n            localize('TIDY5E.Section.Label'),\n          ).render(true)}\n      >\n        <span class=\"lighter centered\">\n          {localize('DND5E.Inventory')}\n        </span>\n        <span class=\"hyphens-auto centered\">\n          {section}\n        </span>\n      </a>\n      <a\n        class=\"pill interactive wrapped no-row-gap\"\n        class:disabled={!context.editable}\n        title={localize(\n          'TIDY5E.Section.SectionSelectorChooseActionSectionTooltip',\n        )}\n        onclick={() =>\n          new SectionSelectorApplication(\n            context.item,\n            TidyFlags.actionSection.prop,\n            localize('TIDY5E.Section.ActionLabel'),\n          ).render(true)}\n      >\n        <span class=\"lighter centered\">\n          {localize('TIDY5E.Actions.TabName')}\n        </span>\n        <span class=\"hyphens-auto centered\">\n          {actionSection}\n        </span>\n      </a>\n    </div>\n  </div>\n</aside>\n<main class=\"item-content\">\n  <div\n    bind:this={containerNameEl}\n    class=\"container-name-wrapper flex-row extra-small-gap align-items-center\"\n  >\n    <!-- Name -->\n    {#if context.unlocked}\n      <TextInput\n        field=\"name\"\n        document={context.item}\n        value={context.item.name}\n        class=\"document-name\"\n      />\n    {:else}\n      <div class=\"document-name\">{context.item.name ?? ''}</div>\n    {/if}\n  </div>\n\n  <!-- Header Summary -->\n  <div class=\"item-header-summary\">\n    <!-- Value -->\n    <div class=\"item-value\">\n      <!-- Currency Image -->\n      <i\n        class=\"currency {context.system?.price?.denomination ?? ''}\"\n        aria-label={denomination?.label ?? ''}\n      ></i>\n      <span class=\"item-value-number\">\n        <!-- Value Text -->\n        <span class=\"text-default\">\n          {itemValueText}\n        </span>\n        <!-- Denom -->\n        <span class=\"item-value-denomination text-lighter\">\n          {denomination?.abbreviation ?? ''}\n        </span>\n      </span>\n    </div>\n\n    <div class=\"item-header-summary-separator\" role=\"presentation\"></div>\n\n    <!-- Weight -->\n    <div class=\"item-weight\">\n      <i class=\"fas fa-weight-hanging item-weight-icon text-lightest\"></i>\n      <span class=\"item-weight-value\">\n        {context.system.weight?.value}\n      </span>\n    </div>\n\n    <!-- <div class=\"item-header-summary-separator\" role=\"presentation\"></div> -->\n\n    <!-- Quantity -->\n    <!-- <div class=\"item-quantity\">\n      <span class=\"item-quantity-label text-lighter\">\n        {localize('DND5E.Quantity')}\n      </span>\n      <span class=\"item-quantity-value\">\n        {context.system.quantity}\n      </span>\n    </div> -->\n  </div>\n\n  <!-- Tab Strip -->\n  <Tabs\n    bind:selectedTabId\n    tabs={context.tabs}\n    cssClass=\"item-tabs\"\n    sheet={context.item.sheet}\n  />\n\n  <hr class=\"golden-fade\" />\n\n  <!-- Tab Contents -->\n  <TabContents tabs={context.tabs} {selectedTabId} />\n</main>\n","<script lang=\"ts\">\n  import { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\n  interface Props {\n    unlocked: boolean;\n    sourceText: string;\n    document: any;\n    keyPath: string;\n    buttonClass?: string;\n  }\n\n  let {\n    unlocked,\n    sourceText,\n    document,\n    keyPath,\n    buttonClass = '',\n  }: Props = $props();\n\n  const localize = FoundryAdapter.localize;\n</script>\n\n<div class=\"configurable-source\">\n  <span class=\"source-text truncate\" title={sourceText ?? ''}>\n    {sourceText ?? ''}\n  </span>\n  {#if unlocked}\n    <button\n      type=\"button\"\n      class=\"configure-source {buttonClass}\"\n      onclick={() => FoundryAdapter.renderSourceConfig(document, keyPath)}\n      title={localize('DND5E.SOURCE.Action.Configure')}\n    >\n      <i class=\"fas fa-cog\"></i>\n    </button>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import ConfigurableSource from '../../shared/ConfigurableSource.svelte';\n  import SheetHeaderEditModeToggle from 'src/sheets/classic/shared/SheetHeaderEditModeToggle.svelte';\n  import { getContainerSheetQuadroneContext } from 'src/sheets/sheet-context.svelte';\n\n  const context = $derived(getContainerSheetQuadroneContext());\n\n  let sourceText = $derived(\n    context.editable\n      ? context.system.source?.label ||\n          game.i18n.localize('DND5E.SOURCE.FIELDS.source.label')\n      : context.system.source?.label,\n  );\n</script>\n\n<div class=\"header-over-sidebar\">\n  <SheetHeaderEditModeToggle class=\"header-control\" />\n\n  <span class=\"header-item-type-label\">\n    {context.itemType}\n  </span>\n</div>\n\n<div class=\"container-header-start-document-name truncate\">\n  {context.item.name}\n</div>\n\n<ConfigurableSource\n  document={context.document}\n  keyPath=\"system.source\"\n  {sourceText}\n  unlocked={context.unlocked}\n  buttonClass=\"header-control unbutton\"\n/>\n","import { mount } from 'svelte';\nimport { CONSTANTS } from 'src/constants';\nimport ContainerSheet from './container/ContainerSheet.svelte';\nimport type {\n  ApplicationClosingOptions,\n  ApplicationConfiguration,\n  ApplicationRenderOptions,\n} from 'src/types/application.types';\nimport { DragAndDropMixin } from 'src/mixins/DragAndDropBaseMixin';\nimport { SvelteApplicationMixin } from 'src/mixins/SvelteApplicationMixin.svelte';\nimport type {\n  ContainerSheetQuadroneContext,\n  CurrencyContext,\n  Item5e,\n  ItemChatData,\n  ItemDescription,\n} from 'src/types/item.types';\nimport { InlineToggleService } from 'src/features/expand-collapse/InlineToggleService.svelte';\nimport { ItemFilterService } from 'src/features/filtering/ItemFilterService.svelte';\nimport type {\n  LocationToSearchTextMap,\n  ExpandedItemIdToLocationsMap,\n  ExpandedItemData,\n  MessageBus,\n  Utilities,\n  Tab,\n} from 'src/types/types';\nimport { initTidy5eContextMenu } from 'src/context-menu/tidy5e-context-menu';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\nimport { SheetPreferencesService } from 'src/features/user-preferences/SheetPreferencesService';\nimport { DocumentTabSectionConfigApplication } from 'src/applications/section-config/DocumentTabSectionConfigApplication.svelte';\nimport { ItemSheetRuntime } from 'src/runtime/item/ItemSheetRuntime';\nimport { Container } from 'src/features/containers/Container';\nimport { ItemFilterRuntime } from 'src/runtime/item/ItemFilterRuntime.svelte';\nimport { TabManager } from 'src/runtime/tab/TabManager';\nimport { TidyHooks } from 'src/foundry/TidyHooks';\nimport { settings, SettingsProvider } from 'src/settings/settings.svelte';\nimport ContainerHeaderStart from './item/parts/ContainerHeaderStart.svelte';\nimport { ExpansionTracker } from 'src/features/expand-collapse/ExpansionTracker.svelte';\nimport UserPreferencesService from 'src/features/user-preferences/UserPreferencesService';\n\nexport class Tidy5eContainerSheetQuadrone extends DragAndDropMixin(\n  SvelteApplicationMixin<ContainerSheetQuadroneContext>(\n    foundry.applications.sheets.ItemSheetV2\n  )\n) {\n  currentTabId: string | undefined = undefined;\n  searchFilters: LocationToSearchTextMap = new Map<string, string>();\n  expandedItems: ExpandedItemIdToLocationsMap = new Map<string, Set<string>>();\n  expandedItemData: ExpandedItemData = new Map<string, ItemChatData>();\n  inlineToggleService = new InlineToggleService();\n  itemFilterService: ItemFilterService;\n  messageBus = $state<MessageBus>({ message: undefined });\n  sectionExpansionTracker = new ExpansionTracker(\n    true,\n    CONSTANTS.LOCATION_SECTION\n  );\n\n  constructor(...args: any[]) {\n    super(...args);\n\n    this.itemFilterService = new ItemFilterService({}, this.item);\n  }\n\n  static DEFAULT_OPTIONS: Partial<\n    ApplicationConfiguration & { dragDrop: Partial<DragDropConfiguration>[] }\n  > = {\n    classes: [\n      CONSTANTS.MODULE_ID,\n      'sheet',\n      'item',\n      CONSTANTS.ITEM_TYPE_CONTAINER,\n      'app-v2',\n      'quadrone',\n    ],\n    tag: 'form',\n    window: {\n      frame: true,\n      positioned: true,\n      resizable: true,\n      controls: [],\n    },\n    position: {\n      width: 560,\n      height: 560,\n    },\n    actions: {},\n    dragDrop: [{ dropSelector: 'form' }],\n    submitOnClose: false,\n  };\n\n  _createComponent(node: HTMLElement): Record<string, any> {\n    const context = new Map<any, any>([\n      [CONSTANTS.SVELTE_CONTEXT.CONTEXT, this._context],\n      [CONSTANTS.SVELTE_CONTEXT.CURRENT_TAB_ID, this.currentTabId],\n      [CONSTANTS.SVELTE_CONTEXT.MESSAGE_BUS, this.messageBus],\n      [\n        CONSTANTS.SVELTE_CONTEXT.INLINE_TOGGLE_SERVICE,\n        this.inlineToggleService,\n      ],\n      [CONSTANTS.SVELTE_CONTEXT.ITEM_FILTER_SERVICE, this.itemFilterService],\n      [\n        CONSTANTS.SVELTE_CONTEXT.ON_FILTER,\n        this.itemFilterService.onFilter.bind(this.itemFilterService),\n      ],\n      [\n        CONSTANTS.SVELTE_CONTEXT.ON_FILTER_CLEAR_ALL,\n        this.itemFilterService.onFilterClearAll.bind(this.itemFilterService),\n      ],\n      [CONSTANTS.SVELTE_CONTEXT.SEARCH_FILTERS, new Map(this.searchFilters)],\n      [\n        CONSTANTS.SVELTE_CONTEXT.SECTION_EXPANSION_TRACKER,\n        this.sectionExpansionTracker,\n      ],\n    ]);\n\n    const component = mount(ContainerSheet, {\n      target: node,\n      context: context,\n    });\n\n    const html = globalThis.$(this.element);\n\n    initTidy5eContextMenu(this, html);\n\n    return component;\n  }\n\n  _createAdditionalComponents(node: HTMLElement) {\n    const windowHeader = this.element.querySelector('.window-header');\n\n    const headerStart = mount(ContainerHeaderStart, {\n      target: windowHeader,\n      anchor: windowHeader.querySelector('.window-title'),\n      context: new Map<string, any>([\n        [CONSTANTS.SVELTE_CONTEXT.CONTEXT, this._context],\n      ]),\n    });\n\n    return [headerStart];\n  }\n\n  async _prepareContext(\n    options: ApplicationRenderOptions\n  ): Promise<ContainerSheetQuadroneContext> {\n    const rollData = this.item.getRollData();\n\n    const enrichmentOptions = {\n      secrets: this.item.isOwner,\n      relativeTo: this.item,\n      rollData: rollData,\n    };\n\n    const enriched = {\n      description: await TextEditor.enrichHTML(\n        this.item.system.description.value,\n        enrichmentOptions\n      ),\n      unidentified: await TextEditor.enrichHTML(\n        this.item.system.unidentified?.description,\n        enrichmentOptions\n      ),\n      chat: await TextEditor.enrichHTML(\n        this.item.system.description.chat,\n        enrichmentOptions\n      ),\n    };\n\n    const isIdentifiable = 'identified' in this.item.system;\n\n    const itemDescriptions: ItemDescription[] = [];\n\n    itemDescriptions.push({\n      enriched: enriched.description,\n      content: this.document.system.description.value,\n      field: 'system.description.value',\n      label: FoundryAdapter.localize('DND5E.Description'),\n    });\n\n    if (isIdentifiable && FoundryAdapter.userIsGm()) {\n      itemDescriptions.push({\n        enriched: enriched.unidentified,\n        content: this.document.system.unidentified.description,\n        field: 'system.unidentified.description',\n        label: FoundryAdapter.localize('DND5E.DescriptionUnidentified'),\n      });\n    }\n\n    itemDescriptions.push({\n      enriched: enriched.chat,\n      content: this.document.system.description.chat,\n      field: 'system.description.chat',\n      label: FoundryAdapter.localize('DND5E.DescriptionChat'),\n    });\n\n    const containerPreferences = SheetPreferencesService.getByType(\n      this.item.type\n    );\n\n    const contentsSortMode =\n      containerPreferences.tabs?.[CONSTANTS.TAB_CONTAINER_CONTENTS]?.sort ??\n      'm';\n\n    // Utilities\n    let utilities: Utilities<ContainerSheetQuadroneContext> = {\n      [CONSTANTS.TAB_CONTAINER_CONTENTS]: {\n        utilityToolbarCommands: [\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeAlpha'),\n            iconClass: 'fa-solid fa-arrow-down-a-z fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.item.type,\n                CONSTANTS.TAB_CONTAINER_CONTENTS,\n                'sort',\n                'm'\n              );\n              this.render();\n            },\n            visible: contentsSortMode === 'a',\n          },\n          {\n            title: FoundryAdapter.localize('SIDEBAR.SortModeManual'),\n            iconClass: 'fa-solid fa-arrow-down-short-wide fa-fw',\n            execute: async () => {\n              await SheetPreferencesService.setDocumentTypeTabPreference(\n                this.item.type,\n                CONSTANTS.TAB_CONTAINER_CONTENTS,\n                'sort',\n                'a'\n              );\n              this.render();\n            },\n            visible: contentsSortMode === 'm',\n          },\n          {\n            title: FoundryAdapter.localize(\n              'TIDY5E.Utilities.ConfigureSections'\n            ),\n            iconClass: 'fas fa-cog',\n            execute: ({ context, sections }) => {\n              new DocumentTabSectionConfigApplication({\n                document: context.item,\n                // Provide a way to build the necessary config, perhaps within the application constructor. We've got all the info we need in order to perform the operation.\n                sections: sections,\n                tabId: CONSTANTS.TAB_CONTAINER_CONTENTS,\n                tabTitle: ItemSheetRuntime.getTabTitle(\n                  CONSTANTS.TAB_CONTAINER_CONTENTS\n                ),\n              }).render(true);\n            },\n          },\n        ],\n      },\n    };\n\n    const editable = this.isEditable;\n\n    const unlocked = FoundryAdapter.isSheetUnlocked(this.item) && editable;\n\n    const currencies: CurrencyContext[] = [];\n\n    Object.keys(CONFIG.DND5E.currencies).forEach((key) =>\n      currencies.push({\n        key: key,\n        value: this.item.system.currency[key] as number,\n        abbr:\n          CONFIG.DND5E.currencies[key as keyof typeof CONFIG.DND5E.currencies]\n            ?.abbreviation ?? key,\n      })\n    );\n\n    const capacityContext = await Container.computeCapacity(this.item);\n\n    const context: ContainerSheetQuadroneContext = {\n      capacity: capacityContext,\n      concealDetails:\n        !game.user.isGM && this.document.system.identified === false,\n      config: CONFIG.DND5E,\n      containerContents: await Container.getContainerContents(this.item),\n      customContent: [],\n      currencies,\n      document: this.document,\n      editable: editable,\n      enriched: enriched,\n      filterData: this.itemFilterService.getDocumentItemFilterData(),\n      filterPins: ItemFilterRuntime.defaultFilterPins[this.item.type],\n      identifiedName: FoundryAdapter.getIdentifiedName(this.item),\n      isContainer: true,\n      isIdentifiable: isIdentifiable,\n      isIdentified: this.document.system.identified !== false,\n      isPhysical: this.document.system.hasOwnProperty('quantity'),\n      item: this.item,\n      itemContext: await Container.getContainerItemContext(this.item),\n      itemDescriptions: itemDescriptions,\n      itemOverrides: new Set<string>(this._getItemOverrides()),\n      items: Array.from(await this.item.system.contents),\n      // @ts-expect-error\n      itemType: game.i18n.localize(CONFIG.Item.typeLabels[this.item.type]),\n      labels: this.document.labels,\n      lockItemQuantity: FoundryAdapter.shouldLockItemQuantity(),\n      lockMoneyChanges: FoundryAdapter.shouldLockMoneyChanges(),\n      modernRules: FoundryAdapter.checkIfModernRules(this.item),\n      owner: this.item.isOwner,\n      properties: {\n        active: [],\n        object: {},\n        options: [],\n      },\n      rollData: rollData,\n      source: this.document.toObject().system,\n      system: this.document.system,\n      tabs: [],\n      unlocked: unlocked,\n      userPreferences: UserPreferencesService.get(),\n      utilities: utilities,\n    };\n\n    // Properties\n    context.properties = {\n      active: [],\n      object: Object.fromEntries(\n        (this.document.system.properties ?? []).map((p: string) => [p, true])\n      ),\n      options: (this.document.system.validProperties ?? [])\n        .reduce(\n          (\n            arr: ContainerSheetQuadroneContext['properties']['options'],\n            k: any\n          ) => {\n            // @ts-ignore\n            const { label } = CONFIG.DND5E.itemProperties[k];\n            arr.push({\n              label,\n              value: k,\n              selected: this.item._source.system.properties?.includes(k),\n            });\n            return arr;\n          },\n          []\n        )\n        .sort(\n          (\n            a: ContainerSheetQuadroneContext['properties']['options'][0],\n            b: ContainerSheetQuadroneContext['properties']['options'][0]\n          ) => a.label.localeCompare(b.label, game.i18n.lang)\n        ),\n    };\n\n    // Tabs\n    context.customContent = await ItemSheetRuntime.getContent(context);\n\n    const eligibleCustomTabs = ItemSheetRuntime.getCustomItemTabs(context);\n\n    const customTabs: Tab[] = await TabManager.prepareTabsForRender(\n      context,\n      eligibleCustomTabs\n    );\n\n    context.tabs =\n      // TODO: Eliminate null forgiving operator and temp field when items are fully converted.\n      ItemSheetRuntime.sheets[this.item.type]?.tempQuadroneTabs!() ?? [];\n    context.tabs.push(...customTabs);\n\n    TidyHooks.tidy5eSheetsPreConfigureSections(this, this.element, context);\n\n    return context;\n  }\n\n  /**\n   * Retrieve the list of fields that are currently modified by Active Effects on the Item.\n   */\n  _getItemOverrides(): string[] {\n    const overrides = Object.keys(\n      foundry.utils.flattenObject(this.item.overrides ?? {})\n    );\n    this.item.system.getItemOverrides?.(overrides);\n    if ('properties' in this.item.system) {\n      dnd5e.documents.ActiveEffect5e.addOverriddenChoices(\n        this.item,\n        'system.properties',\n        'system.properties',\n        overrides\n      );\n    }\n    if (\n      'damage' in this.item.system &&\n      foundry.utils.getProperty(this.item.overrides, 'system.damage.parts')\n    ) {\n      overrides.push('damage-control');\n      Array.fromRange(this.item.system.damage.parts.length).forEach((index) =>\n        overrides.push(\n          `system.damage.parts.${index}.0`,\n          `system.damage.parts.${index}.1`\n        )\n      );\n    }\n    return overrides;\n  }\n\n  /* -------------------------------------------- */\n  /*  Rendering Life-Cycle Methods                */\n  /* -------------------------------------------- */\n\n  async _renderHTML(\n    context: ContainerSheetQuadroneContext,\n    options: ApplicationRenderOptions\n  ) {\n    game.user.apps[this.id] = this;\n\n    return await super._renderHTML(context, options);\n  }\n\n  async close(options: ApplicationClosingOptions = {}) {\n    delete game.user.apps[this.id];\n\n    return await super.close(options);\n  }\n\n  /* -------------------------------------------- */\n  /*  Drag and Drop                               */\n  /* -------------------------------------------- */\n\n  /** @inheritDoc */\n  async _onDrop(\n    event: DragEvent & { currentTarget: HTMLElement; target: HTMLElement }\n  ): Promise<unknown> {\n    const data = TextEditor.getDragEventData(event);\n    if (!['Item', 'Folder'].includes(data.type)) {\n      return super._onDrop(event);\n    }\n\n    if (TidyHooks.dnd5eDropItemSheetData(this.item, this, data) === false) {\n      return;\n    }\n\n    if (data.type === 'Folder') {\n      return this._onDropFolder(event, data);\n    }\n\n    return this._onDropItem(event, data);\n  }\n\n  /* -------------------------------------------- */\n\n  async _onDropFolder(\n    event: DragEvent & { currentTarget: HTMLElement; target: HTMLElement },\n    data: any\n  ): Promise<Item5e[]> {\n    const folder = await Folder.implementation.fromDropData(data);\n    if (!this.item.isOwner || folder.type !== 'Item') return [];\n\n    let recursiveWarning = false;\n    const parentContainers = await this.item.system.allContainers();\n    const containers = new Set();\n\n    let items = await Promise.all(\n      folder.contents.map(async (item: any) => {\n        if (!(item instanceof Item)) item = await fromUuid(item.uuid);\n        if (item.system.container === this.item.id) return;\n        if (this.item.uuid === item.uuid || parentContainers.includes(item)) {\n          recursiveWarning = true;\n          return;\n        }\n        if (item.type === 'container') containers.add(item.id);\n        return item;\n      })\n    );\n    items = items.filter((i) => i && !containers.has(i.system.container));\n\n    // Display recursive warning, but continue with any remaining items\n    if (recursiveWarning)\n      ui.notifications.warn('DND5E.ContainerRecursiveError', {\n        localize: true,\n      });\n    if (!items.length) return [];\n\n    // Create any remaining items\n    const toCreate = await dnd5e.documents.Item5e.createWithContents(items, {\n      container: this.item,\n      transformAll: (itemData: any) => {\n        const options: Record<string, unknown> = {};\n\n        if (settings.value.includeFlagsInSpellScrollCreation) {\n          options.flags = itemData.flags;\n        }\n\n        return itemData.type === 'spell'\n          ? dnd5e.documents.Item5e.createScrollFromSpell(itemData, options)\n          : itemData;\n      },\n    });\n    if (this.item.folder)\n      toCreate.forEach((d: any) => (d.folder = this.item.folder.id));\n    return dnd5e.documents.Item5e.createDocuments(toCreate, {\n      pack: this.item.pack,\n      parent: this.item.parent,\n      keepId: true,\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  async _onDropItem(\n    event: DragEvent & { currentTarget: HTMLElement; target: HTMLElement },\n    data: any\n  ): Promise<Item5e[] | boolean | void> {\n    const item = await Item.implementation.fromDropData(data);\n    if (!this.item.isOwner || !item) return false;\n\n    // If item already exists in this container, just adjust its sorting\n    if (item.system.container === this.item.id) {\n      return this._onSortItem(event, item);\n    }\n\n    // Prevent dropping containers within themselves\n    const parentContainers = await this.item.system.allContainers();\n    if (this.item.uuid === item.uuid || parentContainers.includes(item)) {\n      ui.notifications.error('DND5E.ContainerRecursiveError', {\n        localize: true,\n      });\n      return;\n    }\n\n    // If item already exists in same DocumentCollection, just adjust its container property\n    if (item.actor === this.item.actor && item.pack === this.item.pack) {\n      return item.update({\n        folder: this.item.folder,\n        'system.container': this.item.id,\n      });\n    }\n\n    // Otherwise, create a new item & contents in this context\n    const toCreate = await dnd5e.documents.Item5e.createWithContents([item], {\n      container: this.item,\n      transformAll: (itemData: any) => {\n        const options: Record<string, unknown> = {};\n\n        if (settings.value.includeFlagsInSpellScrollCreation) {\n          options.flags = itemData.flags;\n        }\n\n        return itemData.type === 'spell'\n          ? dnd5e.documents.Item5e.createScrollFromSpell(itemData, options)\n          : itemData;\n      },\n    });\n    if (this.item.folder)\n      toCreate.forEach((d: any) => (d.folder = this.item.folder.id));\n    return dnd5e.documents.Item5e.createDocuments(toCreate, {\n      pack: this.item.pack,\n      parent: this.item.actor,\n      keepId: true,\n    });\n  }\n\n  /* -------------------------------------------- */\n\n  /**\n   * Handle a drop event for an existing contained Item to sort it relative to its siblings.\n   */\n  async _onSortItem(\n    event: DragEvent & { currentTarget: HTMLElement; target: HTMLElement },\n    item: Item5e\n  ) {\n    const dropTarget = event.target.closest<HTMLElement>('[data-item-id]');\n    if (!dropTarget) return;\n    const contents = await this.item.system.contents;\n    const target = contents.get(dropTarget.dataset.itemId);\n\n    // Don't sort on yourself\n    if (item.id === target.id) return;\n\n    // Identify sibling items based on adjacent HTML elements\n    const siblings = [];\n    for (const el of Array.from(dropTarget.parentElement!.children)) {\n      if (el instanceof HTMLElement) {\n        const siblingId = el.dataset.itemId;\n        if (siblingId && siblingId !== item.id)\n          siblings.push(contents.get(siblingId));\n      }\n    }\n\n    // Perform the sort\n    const sortUpdates = SortingHelpers.performIntegerSort(item, {\n      target,\n      siblings,\n    });\n    const updateData = sortUpdates.map((u: any) => {\n      const update = u.update;\n      update._id = u.target.id;\n      return update;\n    });\n\n    // Perform the update\n    Item.updateDocuments(updateData, {\n      pack: this.item.pack,\n      parent: this.item.actor,\n    });\n  }\n\n  // TODO: Plug in or reimplement\n  // - SheetTabCacheable\n  // - SheetExpandedItemsCacheable\n  // - SearchFilterCacheable\n}\n","export function preventNewlines(node: HTMLElement) {\n  node.addEventListener('keypress', (ev: KeyboardEvent) => {\n    if (ev.key === 'Enter') {\n      ev.preventDefault();\n      return false;\n    }\n  });\n\n  node.addEventListener('change', (ev: Event) => {\n    const currentTarget = ev.currentTarget;\n\n    if (\n      currentTarget instanceof HTMLInputElement ||\n      currentTarget instanceof HTMLTextAreaElement\n    ) {\n      currentTarget.value = currentTarget.value?.replaceAll('\\n', '');\n    }\n  });\n}\n","<script lang=\"ts\">\n  import { CONSTANTS } from 'src/constants';\n  import { settings } from 'src/settings/settings.svelte';\n  import { getThemeOrDefault } from 'src/theme/theme';\n  import type { ItemDebugSheetQuadroneContext } from '../Tidy5eItemDebugSheetQuadrone.svelte';\n  import ButtonWithOptionPanel from 'src/components/buttons/ButtonWithOptionPanel.svelte';\n  import ToggleButton from 'src/components/buttons/ToggleButton.svelte';\n  import Dnd5eIcon from 'src/components/icon/Dnd5eIcon.svelte';\n  import TextInput from 'src/components/inputs/TextInput.svelte';\n  import FieldToggle from 'src/components/toggles/FieldToggle.svelte';\n  import Tabs from 'src/components/tabs/Tabs.svelte';\n  import TabContents from 'src/components/tabs/TabContents.svelte';\n  import PillSwitch from 'src/components/toggles/PillSwitch.svelte';\n  import Search from '../shared/Search.svelte';\n  import { preventNewlines } from 'src/actions/prevent-newlines';\n  import ItemDescriptions from '../shared/ItemDescriptions.svelte';\n  import { getSheetContext } from 'src/sheets/sheet-context.svelte';\n\n  let context = $derived(getSheetContext<ItemDebugSheetQuadroneContext>());\n\n  let theme = $derived(getThemeOrDefault(settings.value.colorScheme));\n\n  let inverse = $state(false);\n\n  let selectedTabId: string = $state('hallo-tab');\n\n  function selectTheme(themeId: string) {\n    game.settings.set(CONSTANTS.MODULE_ID, 'colorScheme', themeId);\n  }\n</script>\n\n<aside class=\"sidebar inverse\">\n  <div class=\"sidebar-contents\">\n    <h4>Theme</h4>\n    <div style=\"display: flex; flex-direction: column; gap: 0.25rem\">\n      <label for=\"light-mode-toggle\">\n        <input\n          id=\"light-mode-toggle\"\n          type=\"radio\"\n          name=\"theme-selector\"\n          value={CONSTANTS.THEME_ID_DEFAULT_LIGHT}\n          checked={theme.id === CONSTANTS.THEME_ID_DEFAULT_LIGHT}\n          onclick={(ev) => selectTheme(CONSTANTS.THEME_ID_DEFAULT_LIGHT)}\n        />\n        {game.i18n.localize('TIDY5E.Settings.SheetTheme.light')}\n      </label>\n      <label for=\"dark-mode-toggle\">\n        <input\n          id=\"dark-mode-toggle\"\n          type=\"radio\"\n          name=\"theme-selector\"\n          value={CONSTANTS.THEME_ID_DEFAULT_DARK}\n          checked={theme.id === CONSTANTS.THEME_ID_DEFAULT_DARK}\n          onclick={(ev) => selectTheme(CONSTANTS.THEME_ID_DEFAULT_DARK)}\n        />\n        {game.i18n.localize('TIDY5E.Settings.SheetTheme.dark')}\n      </label>\n    </div>\n    <h4>Inversion</h4>\n    <div style=\"display: flex; flex-direction: column; gap: 0.25rem\">\n      <label for=\"default-mode-toggle\">\n        <input\n          id=\"default-mode-toggle\"\n          type=\"radio\"\n          name=\"inversion-mode-selector\"\n          value={CONSTANTS.VIEW_MODE_DEFAULT}\n          checked={!inverse}\n          onclick={() => (inverse = false)}\n        />\n        Default\n      </label>\n      <label for=\"inverse-mode-toggle\">\n        <input\n          id=\"inverse-mode-toggle\"\n          type=\"radio\"\n          name=\"inversion-mode-selector\"\n          value={CONSTANTS.VIEW_MODE_INVERSE}\n          checked={inverse}\n          onclick={() => (inverse = true)}\n        />\n        Inverse\n      </label>\n    </div>\n  </div>\n</aside>\n<div class=\"item-content\" class:inverse>\n  <div class=\"controls-gallery\">\n    <div class=\"span-all\">\n      <!-- Name -->\n      {#if context.unlocked}\n        <TextInput\n          field=\"name\"\n          document={context.item}\n          value={context.item.name}\n          class=\"document-name\"\n        />\n      {:else}\n        <div class=\"document-name\">{context.item.name ?? ''}</div>\n      {/if}\n    </div>\n    <div class=\"span-all\">\n      <Tabs\n        tabs={context.tabs}\n        bind:selectedTabId\n        cssClass=\"item-tabs\"\n        sheet={context.item.sheet}\n      />\n    </div>\n    <div class=\"span-all\">\n      <TabContents tabs={context.tabs} {selectedTabId} />\n    </div>\n    <div>\n      <ItemDescriptions\n        document={context.document}\n        itemDescriptions={context.itemDescriptions}\n      />\n    </div>\n    <fieldset>\n      <legend> Colors </legend>\n      <div style=\"background-color: var(--t5e-color-palette-red-45); padding: 0.5rem; color:white;\">\n        Brand red\n      </div>\n      <div style=\"background-color: var(--t5e-theme-color-default); padding: 0.5rem; color:white;\">\n        Default theme color\n      </div>\n      <div style=\"background-color: var(--t5e-theme-color-darkest); padding: 0.5rem; color:white;\">\n        Darkest theme color\n      </div>\n      <div style=\"background-color: var(--t5e-theme-color-darker); padding: 0.5rem; color:white;\">\n        Darker theme color\n      </div>\n      <div style=\"background-color: var(--t5e-theme-color-lighter); padding: 0.5rem; color:white;\">\n        Lighter theme color\n      </div>\n      <div style=\"background-color: var(--t5e-theme-color-lightest); padding: 0.5rem; color:white;\">\n        Lightest theme color\n      </div>\n      <div style=\"background-color: var(--t5e-theme-color-highlight); padding: 0.5rem; color:white;\">\n        Highlight theme color\n      </div>\n      <div style=\"background: linear-gradient(90deg, var(--t5e-theme-color-darkest), var(--t5e-theme-color-default)); padding: 0.5rem; color:white;\">\n        Theme gradient\n      </div>\n      <!-- TODO -->\n    </fieldset>\n    <fieldset class=\"vertical-gallery\">\n      <legend> Button / Attention </legend>\n      Anchor\n      <a class=\"button active\">\n        <i class=\"fas fa-edit\"></i>\n        Edit Details\n      </a>\n      Button\n      <button class=\"active\">\n        <i class=\"fas fa-edit\"></i>\n        Edit Details\n      </button>\n    </fieldset>\n    <fieldset class=\"vertical-gallery\">\n      <legend> Button / Default </legend>\n      Anchor\n      <a class=\"button\">\n        <i class=\"fas fa-edit\"></i>\n        Edit Details\n      </a>\n      Button\n      <button>\n        <i class=\"fas fa-edit\"></i>\n        Edit Details\n      </button>\n    </fieldset>\n    <fieldset style=\"display: flex; gap: 0.5rem;\">\n      <legend> Button / Icon Only </legend>\n      <div class=\"vertical-gallery\">\n        Anchors\n        <a class=\"button icon-button\">\n          <i class=\"fas fa-hand\"></i>\n        </a>\n        <a class=\"button icon-button active\">\n          <i class=\"fas fa-hand\"></i>\n        </a>\n        <a class=\"button icon-button disabled\">\n          <i class=\"fas fa-hand\"></i>\n        </a>\n        <a class=\"button icon-button active disabled\">\n          <i class=\"fas fa-hand\"></i>\n        </a>\n      </div>\n      <div class=\"vertical-gallery\">\n        Buttons\n        <button class=\"icon-button\">\n          <i class=\"fas fa-hand\"></i>\n        </button>\n        <button class=\"icon-button active\">\n          <i class=\"fas fa-hand\"></i>\n        </button>\n        <button class=\"icon-button disabled\">\n          <i class=\"fas fa-hand\"></i>\n        </button>\n        <button class=\"icon-button active disabled\">\n          <i class=\"fas fa-hand\"></i>\n        </button>\n      </div>\n    </fieldset>\n    <fieldset>\n      <legend> Button / Icon Only Menu </legend>\n      <div class=\"wrapped-gallery\">\n        <ButtonWithOptionPanel class=\"icon-button\">\n          <i class=\"fas fa-hand\"></i>\n          {#snippet options()}\n            <label>\n              <input type=\"radio\" name=\"icon-menu-test\" value=\"1\" /> Test Option\n              1\n            </label>\n            <label>\n              <input type=\"radio\" name=\"icon-menu-test\" value=\"2\" /> Test Option\n              2\n            </label>\n          {/snippet}\n        </ButtonWithOptionPanel>\n        <ButtonWithOptionPanel class=\"icon-button\" active={true}>\n          <i class=\"fas fa-hand\"></i>\n          {#snippet options()}\n            O hai \n          {/snippet}\n        </ButtonWithOptionPanel>\n        <ButtonWithOptionPanel class=\"icon-button\" disabled={true}>\n          <i class=\"fas fa-hand\"></i>\n          {#snippet options()}\n            O hai \n          {/snippet}\n        </ButtonWithOptionPanel>\n        <ButtonWithOptionPanel\n          class=\"icon-button active\"\n          disabled={true}\n          active={true}\n        >\n          <i class=\"fas fa-hand\"></i>\n          {#snippet options()}\n            O hai \n          {/snippet}\n        </ButtonWithOptionPanel>\n      </div>\n    </fieldset>\n    <fieldset>\n      <legend> Button / Edit Description </legend>\n      <a class=\"button icon-button\">\n        <i class=\"fa-solid fa-feather\"></i>\n      </a>\n      <a class=\"button icon-button disabled\">\n        <i class=\"fa-solid fa-feather\"></i>\n      </a>\n    </fieldset>\n    <fieldset class=\"span-all\">\n      <legend> Button / Group </legend>\n      <div>\n        <span>\n          Change the sheet size to see the options show/hide dynamically.\n        </span>\n      </div>\n      <div class=\"button-group\">\n        <ToggleButton>\n          <span class=\"hide-before-850\">Action</span>\n          <span class=\"show-before-850\">A</span>\n        </ToggleButton>\n        <ToggleButton checked={true}>Bonus Action</ToggleButton>\n        <ToggleButton class=\"hide-before-1000\">Reaction</ToggleButton>\n        <ToggleButton class=\"hide-before-950\">Can Use</ToggleButton>\n        <ToggleButton class=\"hide-before-900\">Magical</ToggleButton>\n      </div>\n    </fieldset>\n    <fieldset class=\"wrapped-gallery\">\n      <legend> Button / Toggle </legend>\n      <div class=\"vertical-gallery\">\n        <ToggleButton checked={false}>Tidy</ToggleButton>\n        <ToggleButton checked={true}>Tidy</ToggleButton>\n        <ToggleButton checked={false} disabled={true}>Tidy</ToggleButton>\n        <ToggleButton checked={true} disabled={true}>Tidy</ToggleButton>\n      </div>\n      <div class=\"vertical-gallery\">\n        <ToggleButton checked={false}>\n          <i class=\"fas fa-broom\"></i> Tidy\n        </ToggleButton>\n        <ToggleButton checked={true}>\n          <i class=\"fas fa-broom\"></i> Tidy\n        </ToggleButton>\n        <ToggleButton checked={false} disabled={true}>\n          <i class=\"fas fa-broom\"></i> Tidy\n        </ToggleButton>\n        <ToggleButton checked={true} disabled={true}>\n          <i class=\"fas fa-broom\"></i> Tidy\n        </ToggleButton>\n      </div>\n      <div class=\"vertical-gallery\">\n        <ToggleButton checked={false}>\n          <Dnd5eIcon src=\"systems/dnd5e/icons/svg/statuses/concentrating.svg\" />\n          Tidy\n        </ToggleButton>\n        <ToggleButton checked={true}>\n          <Dnd5eIcon src=\"systems/dnd5e/icons/svg/statuses/concentrating.svg\" />\n          Tidy\n        </ToggleButton>\n        <ToggleButton checked={false} disabled={true}>\n          <Dnd5eIcon src=\"systems/dnd5e/icons/svg/statuses/concentrating.svg\" />\n          Tidy\n        </ToggleButton>\n        <ToggleButton checked={true} disabled={true}>\n          <Dnd5eIcon src=\"systems/dnd5e/icons/svg/statuses/concentrating.svg\" />\n          Tidy\n        </ToggleButton>\n      </div>\n    </fieldset>\n    <fieldset>\n      <legend> Category / Spell context icon </legend>\n      <!-- TODO -->\n    </fieldset>\n    <fieldset>\n      <legend> Data / Spell Components </legend>\n      <ul class=\"unlist spell-components\">\n        <li class=\"spell-component\" data-tooltip=\"Verbal\">V</li>\n        <li class=\"spell-component\" data-tooltip=\"Somatic\">S</li>\n        <li class=\"spell-component\" data-tooltip=\"Material\">M</li>\n        <li class=\"spell-component-special\" data-tooltip=\"Ritual\">R</li>\n        <li class=\"spell-component-special\" data-tooltip=\"Concentration\">C</li>\n      </ul>\n    </fieldset>\n    <fieldset>\n      <legend> Data / Time </legend>\n      <div class=\"time\">\n        <div class=\"title\">Action</div>\n        <div class=\"subtitle\">Ritual</div>\n      </div>\n    </fieldset>\n    <fieldset>\n      <legend> Data / Uses </legend>\n      <!-- TODO -->\n    </fieldset>\n    <fieldset>\n      <legend> Enricher </legend>\n      <!-- TODO -->\n    </fieldset>\n    <fieldset>\n      <legend> Field </legend>\n      <!-- TODO -->\n    </fieldset>\n    <fieldset>\n      <legend> Filigree box </legend>\n      <!-- TODO -->\n    </fieldset>\n    <fieldset>\n      <legend> Input / Checkbox </legend>\n      <label for=\"checkbox-test-1\" class=\"checkbox\">\n        <input type=\"checkbox\" id=\"checkbox-test-1\" /> Property\n      </label>\n      <label for=\"checkbox-test-2\" class=\"checkbox\">\n        <input type=\"checkbox\" id=\"checkbox-test-2\" checked /> Property\n      </label>\n      <label for=\"checkbox-test-3\" class=\"checkbox\">\n        <input type=\"checkbox\" id=\"checkbox-test-3\" disabled /> Property\n      </label>\n      <label for=\"checkbox-test-4\" class=\"checkbox\">\n        <input type=\"checkbox\" id=\"checkbox-test-4\" checked disabled /> Property\n      </label>\n    </fieldset>\n    <fieldset class=\"vertical-gallery\">\n      <legend>Input / Radio</legend>\n      <!--\n        Radio button checkmarks aren't quite centering. Let's try to fix that:\n        - https://codepen.io/isaacabrahamson/pen/qVXOWW?editors=1100\n        - https://forum.freecodecamp.org/t/css-center-radio-buttons/158932/3\n        - https://github.com/carbon-design-system/carbon/pull/6097/files\n        - Working version, though using divs and not a radio button: https://js.devexpress.com/Angular/Demos/WidgetsGallery/Demo/RadioGroup/Overview/MaterialBlueDark/\n        - https://github.com/shadcn-ui/ui/pull/2758 - another example of top/left at 50% and translate X/Y at -50%\n    \n      -->\n      <label class=\"radio\" for=\"test-1\">\n        <input type=\"radio\" name=\"test\" id=\"test-1\" checked={true} />\n        <span class=\"radio-label\">Property</span>\n      </label>\n      <label class=\"radio\" for=\"test-2\">\n        <input type=\"radio\" name=\"test\" id=\"test-2\" />\n        <span class=\"radio-label\">Property</span>\n      </label>\n      <label class=\"radio\" for=\"test-3\">\n        <input type=\"radio\" name=\"test\" id=\"test-3\" disabled />\n        <span class=\"radio-label\">Property <br />with line breaks</span>\n      </label>\n    </fieldset>\n    <fieldset class=\"vertical-gallery\">\n      <legend> Input / Search </legend>\n      <Search />\n      <Search disabled={true} />\n    </fieldset>\n    <fieldset class=\"vertical-gallery\">\n      <legend> Input / Select </legend>\n      <select>\n        <option value=\"\"></option>\n        <option value=\"1\">Attunement Required</option>\n        <option value=\"2\">Attunement Optional</option>\n        <option value=\"3\">No Attunement Required</option>\n        <option value=\"4\">Absolutely Cursed </option>\n      </select>\n      <select>\n        <option value=\"\"></option>\n        <option value=\"1\" selected>Attunement Required</option>\n        <option value=\"2\">Attunement Optional</option>\n        <option value=\"3\">No Attunement Required</option>\n        <option value=\"4\">Absolutely Cursed </option>\n      </select>\n      <select disabled>\n        <option value=\"\"></option>\n        <option value=\"1\">Attunement Required</option>\n        <option value=\"2\">Attunement Optional</option>\n        <option value=\"3\">No Attunement Required</option>\n        <option value=\"4\">Absolutely Cursed </option>\n      </select>\n      <select disabled>\n        <option value=\"\"></option>\n        <option value=\"1\" selected>Attunement Required</option>\n        <option value=\"2\">Attunement Optional</option>\n        <option value=\"3\">No Attunement Required</option>\n        <option value=\"4\">Absolutely Cursed </option>\n      </select>\n    </fieldset>\n    <fieldset>\n      <legend>Input / Switch - Field Toggle</legend>\n      <!-- TODO -->\n      <FieldToggle></FieldToggle>\n      <FieldToggle checked={true}></FieldToggle>\n    </fieldset>\n    <fieldset class=\"vertical-gallery\">\n      <legend> Input / Text </legend>\n      <input\n        type=\"text\"\n        value=\"Value\"\n        placeholder=\"Aha! You found me! The hidden placeholder!\"\n      />\n      <input type=\"text\" placeholder=\"A placeholder here\" />\n      <input\n        type=\"text\"\n        value=\"Value\"\n        placeholder=\"Aha! You found me! The hidden placeholder!\"\n        disabled\n      />\n      <input type=\"text\" placeholder=\"A placeholder here\" disabled />\n    </fieldset>\n    <fieldset class=\"vertical-gallery\">\n      <legend> Input / Text with Icon </legend>\n      <div class=\"input-group\">\n        <i class=\"fa-solid fa-cube\"></i>\n        <input type=\"text\" value=\"Value\" />\n      </div>\n      <div class=\"input-group\">\n        <i class=\"fa-solid fa-cube\"></i>\n        <input type=\"text\" value=\"Value\" disabled />\n      </div>\n    </fieldset>\n    <fieldset class=\"vertical-gallery\">\n      <legend> Input / Text with Label </legend>\n      <div class=\"input-group\">\n        <i class=\"currency gp\" aria-label=\"gp\"></i>\n        <input type=\"text\" value=\"Value\" />\n        <span> GP </span>\n      </div>\n      <div class=\"input-group\">\n        <i class=\"currency gp\" aria-label=\"gp\"></i>\n        <input type=\"text\" value=\"Value\" disabled />\n        <span> GP </span>\n      </div>\n      <div class=\"input-group right\">\n        <i class=\"currency gp\" aria-label=\"gp\"></i>\n        <input type=\"text\" value=\"Value\" />\n        <span> GP </span>\n      </div>\n      <div class=\"input-group right\">\n        <i class=\"currency gp\" aria-label=\"gp\"></i>\n        <input type=\"text\" value=\"Value\" disabled />\n        <span> GP </span>\n      </div>\n    </fieldset>\n    <fieldset>\n      <legend> Pill </legend>\n      <ul class=\"pills unlist\">\n        <li class=\"pill\">Label</li>\n        <li class=\"pill negative\">\n          Label <span><span class=\"lighter\">-</span>1</span>\n        </li>\n        <li class=\"pill positive\">\n          Label <span><span class=\"lighter\">+</span>1</span>\n        </li>\n      </ul>\n    </fieldset>\n    <fieldset>\n      <legend> Pill / Readonly </legend>\n      <ul class=\"pills\">\n        <li class=\"pill\">\n          Panache <span><span class=\"lighter\">+</span>10</span>\n        </li>\n        <li class=\"pill\"><i class=\"fas fa-broom\"></i> Tidy 5e</li>\n        <li class=\"pill\">\n          <Dnd5eIcon src=\"systems/dnd5e/icons/svg/statuses/concentrating.svg\"\n          ></Dnd5eIcon> Big Concentrate\n        </li>\n      </ul>\n    </fieldset>\n    <fieldset>\n      <legend> Pill / Switch </legend>\n      Fontawesome\n      <PillSwitch\n        checked={context.system.equipped}\n        checkedIconClass=\"fas fa-hand-fist equip-icon fa-fw\"\n        uncheckedIconClass=\"far fa-hand fa-fw\"\n        onchange={(ev) =>\n          context.item.update({\n            'system.equipped': ev.currentTarget.checked,\n          })}\n      >\n        Equipped\n      </PillSwitch>\n      SVG\n      <PillSwitch\n        checked={context.system.attuned}\n        checkedSvgSrc=\"systems/dnd5e/icons/svg/statuses/concentrating.svg\"\n        uncheckedSvgSrc=\"systems/dnd5e/icons/svg/statuses/concentrating.svg\"\n        onchange={(ev) =>\n          context.item.update({\n            'system.attuned': ev.currentTarget.checked,\n          })}\n      >\n        Attuned\n      </PillSwitch>\n    </fieldset>\n    <fieldset style=\"max-width: 75rem;\">\n      <legend>Form Example</legend>\n      <div class=\"form-group\">\n        <label>Spell Level</label>\n        <div class=\"form-fields\">\n          <select>\n            <option>Cantrip</option>\n          </select>\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <label>Spell School</label>\n        <div class=\"form-fields\">\n          <select>\n            <option>Abjuration</option>\n          </select>\n        </div>\n      </div>\n      <div class=\"form-group stacked checkbox-grid checkbox-grid-3\">\n        <label>Spell Components</label>\n        <div class=\"form-fields\">\n          <label class=\"checkbox\">\n            <input type=\"checkbox\" />\n            <span>Property</span>\n          </label>\n          <label class=\"checkbox\">\n            <input type=\"checkbox\" />\n            <span>Property</span>\n          </label>\n          <label class=\"checkbox\">\n            <input type=\"checkbox\" />\n            <span>Property</span>\n          </label>\n          <label class=\"checkbox\">\n            <input type=\"checkbox\" />\n            <span>Property</span>\n          </label>\n          <label class=\"checkbox\">\n            <input type=\"checkbox\" />\n            <span>Property</span>\n          </label>\n          <label class=\"checkbox\">\n            <input type=\"checkbox\" />\n            <span>Property</span>\n          </label>\n          <label class=\"checkbox\">\n            <input type=\"checkbox\" />\n            <span>Property</span>\n          </label>\n          <label class=\"checkbox\">\n            <input type=\"checkbox\" />\n            <span>Property</span>\n          </label>\n          <label class=\"checkbox\">\n            <input type=\"checkbox\" />\n            <span>Property</span>\n          </label>\n          <label class=\"checkbox\">\n            <input type=\"checkbox\" />\n            <span>Property</span>\n          </label>\n          <label class=\"checkbox\">\n            <input type=\"checkbox\" />\n            <span>Property</span>\n          </label>\n          <label class=\"checkbox\">\n            <input type=\"checkbox\" />\n            <span>Property</span>\n          </label>\n          <label class=\"checkbox\">\n            <input type=\"checkbox\" />\n            <span>Property</span>\n          </label>\n        </div>\n      </div>\n      <div class=\"form-group split-group\">\n        <label>Spellcasting Materials</label>\n        <div class=\"form-fields\">\n          <div class=\"form-group label-top\">\n            <label>Supply</label>\n            <div class=\"form-fields\">\n              <input\n                type=\"number\"\n                value=\"0\"\n                min=\"0\"\n                step=\"any\"\n                placeholder=\"0\"\n              />\n            </div>\n          </div>\n          <div class=\"form-group label-top\">\n            <label class=\"label-icon currency gp\" aria-label=\"Cost (GP)\">\n              Cost\n            </label>\n            <div class=\"form-fields\">\n              <input\n                type=\"number\"\n                value=\"0\"\n                min=\"0\"\n                step=\"any\"\n                placeholder=\"\"\n              />\n            </div>\n          </div>\n          <div class=\"form-group checkbox\">\n            <div class=\"form-fields\">\n              <input type=\"checkbox\" />\n            </div>\n            <label>Consumed</label>\n          </div>\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <label role=\"presentation\"></label>\n        <div class=\"form-fields\">\n          <textarea\n            rows=\"2\"\n            value=\"A tiny ball of bat guano and sulfur\"\n            class=\"full-width\"\n            aria-multiline=\"false\"\n            use:preventNewlines\n          ></textarea>\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <label>Spell Preparation Mode</label>\n        <div class=\"form-fields\">\n          <input type=\"checkbox\" />\n          <select>\n            <option></option>\n          </select>\n        </div>\n      </div>\n      <div class=\"form-group split-group\">\n        <label>Casting Time</label>\n        <div class=\"form-fields\">\n          <div class=\"form-group label-top\">\n            <label>Cost</label>\n            <div class=\"form-fields\">\n              <select name=\"system.activation.type\"\n                ><optgroup label=\"Standard\"\n                  ><option value=\"action\">Action</option><option value=\"bonus\"\n                    >Bonus Action</option\n                  ><option value=\"reaction\">Reaction</option></optgroup\n                ><optgroup label=\"Time\"\n                  ><option value=\"minute\">Minutes</option><option value=\"hour\"\n                    >Hours</option\n                  ><option value=\"day\">Days</option></optgroup\n                ><optgroup label=\"Monster\"\n                  ><option value=\"legendary\">Legendary Action</option><option\n                    value=\"mythic\">Mythic Action</option\n                  ><option value=\"lair\">Lair Action</option></optgroup\n                ><optgroup label=\"Vehicle\"\n                  ><option value=\"crew\">Crew Action</option></optgroup\n                ><option value=\"special\">Special</option><option value=\"\"\n                  >None</option\n                ></select\n              >\n            </div>\n          </div>\n        </div>\n        <input\n          type=\"text\"\n          name=\"system.activation.condition\"\n          value=\"\"\n          placeholder=\"Activation Condition\"\n          class=\"full-width\"\n        />\n      </div>\n      <div class=\"form-group split-group\">\n        <label>Range</label>\n        <div class=\"form-fields\">\n          <div class=\"form-group label-top\">\n            <label>Value</label>\n            <div class=\"form-fields\">\n              <input type=\"text\" name=\"system.range.value\" value=\"150\" />\n            </div>\n          </div>\n          <div class=\"form-group label-top\">\n            <label>Units</label>\n            <div class=\"form-fields\">\n              <select name=\"system.range.units\"\n                ><option value=\"self\">Self</option><option value=\"touch\"\n                  >Touch</option\n                ><option value=\"spec\">Special</option><option value=\"any\"\n                  >Any</option\n                ><optgroup label=\"Distance\"\n                  ><option value=\"ft\">Feet</option><option value=\"mi\"\n                    >Miles</option\n                  ><option value=\"m\">Meters</option><option value=\"km\"\n                    >Kilometers</option\n                  ></optgroup\n                ></select\n              >\n            </div>\n          </div>\n        </div>\n        <input\n          type=\"text\"\n          name=\"system.range.special\"\n          value=\"\"\n          placeholder=\"Special Range\"\n          class=\"full-width\"\n        />\n      </div>\n      <div class=\"form-group split-group\">\n        <label>Duration</label>\n        <div class=\"form-fields\">\n          <div class=\"form-group label-top\">\n            <label>Time</label>\n            <div class=\"form-fields\">\n              <select>\n                <option value=\"inst\">Instantaneous</option>\n                <option value=\"spec\">Special</option>\n                <optgroup label=\"Time\">\n                  <option value=\"turn\">Turns</option>\n                  <option value=\"round\">Rounds </option>\n                  <option value=\"minute\">Minutes</option>\n                  <option value=\"hour\">Hours</option>\n                  <option value=\"day\">Days</option>\n                  <option value=\"month\">Months</option>\n                  <option value=\"year\">Years</option>\n                </optgroup>\n                <optgroup label=\"Permanent\">\n                  <option value=\"disp\">Until Dispelled</option>\n                  <option value=\"dstr\">Until Dispelled or Triggered</option>\n                  <option value=\"perm\">Permanent</option>\n                </optgroup>\n              </select>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"form-group split-group\">\n        <label>Type</label>\n        <div class=\"form-fields\">\n          <div class=\"form-group label-top\">\n            <label>Amount</label>\n            <div class=\"form-fields\">\n              <input type=\"text\" value=\"\" placeholder=\"Every\" />\n            </div>\n          </div>\n          <div class=\"form-group label-top\">\n            <label>Type</label>\n            <div class=\"form-fields\">\n              <select>\n                <option value=\"\"></option>\n                <option value=\"self\">Self</option>\n                <option value=\"ally\">Ally</option>\n                <option value=\"enemy\">Enemy</option>\n                <option value=\"creature\">Creature</option>\n                <option value=\"object\">Object</option>\n                <option value=\"space\">Space</option>\n                <option value=\"creatureOrObject\">Creature or Object</option>\n                <option value=\"any\">Any</option>\n                <option value=\"willing\">Willing Creature</option>\n              </select>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <label>Choose Targets</label>\n        <div class=\"form-fields\">\n          <span style=\"display: flex; align-items: center;\">\n            <input type=\"checkbox\" />\n          </span>\n        </div>\n        <div class=\"form-group\" style=\"flex-basis: 100%\">\n          <label role=\"presentation\"></label>\n          <p class=\"hint\" style=\"flex-basis: auto; flex: 3;\">\n            When targeting an area, can the user choose who it affects?\n          </p>\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <label>Shape</label>\n        <div class=\"form-fields\">\n          <select>\n            <option value=\"\"></option>\n            <option value=\"cone\">Cone</option>\n            <option value=\"cube\">Cube</option>\n            <option value=\"cylinder\">Cylinder</option>\n            <option value=\"radius\">Emanation</option>\n            <option value=\"line\">Line</option>\n            <option value=\"sphere\">Sphere</option>\n            <hr />\n            <option value=\"circle\">Circle</option>\n            <option value=\"square\">Square</option>\n            <option value=\"wall\">Wall</option>\n          </select>\n        </div>\n      </div>\n      <div class=\"form-group split-group\">\n        <label>Dimensions</label>\n        <div class=\"form-fields\">\n          <div class=\"form-group label-top\">\n            <label>Radius</label>\n            <div class=\"form-fields\">\n              <input type=\"text\" value=\"20\" />\n            </div>\n          </div>\n          <div class=\"form-group label-top\">\n            <label>Units</label>\n            <div class=\"form-fields\">\n              <select>\n                <option value=\"\"> </option>\n                <option value=\"ft\">Feet</option>\n                <option value=\"mi\">Miles</option>\n                <option value=\"m\">Meters</option>\n                <option value=\"km\">Kilometers</option>\n              </select>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"form-group split-group\">\n        <label>Multiple</label>\n        <div class=\"form-fields\">\n          <div class=\"form-group label-top\">\n            <label>Amount</label>\n            <div class=\"form-fields\">\n              <input type=\"text\" value=\"\" placeholder=\"1\" />\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"form-group split-group\">\n        <label>Limited Uses</label>\n        <div class=\"form-fields\">\n          <div class=\"form-group label-top\">\n            <label>Spent</label>\n            <div class=\"form-fields\">\n              <input type=\"number\" value=\"0\" min=\"0\" step=\"1\" />\n            </div>\n          </div>\n          <div class=\"form-group label-top\">\n            <label>Max</label>\n            <div class=\"form-fields\">\n              <input type=\"text\" value=\"\" />\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"form-group custom-section\">\n        <label for=\"i-o8WdxHamTy4ZvN3n-tidy-5e-custom-section\"> Section </label>\n        <div class=\"form-fields\">\n          <input\n            type=\"text\"\n            id=\"i-o8WdxHamTy4ZvN3n-tidy-5e-custom-section\"\n            value=\"\"\n          />\n        </div>\n      </div>\n      <div class=\"form-group custom-action-section\">\n        <label for=\"i-o8WdxHamTy4ZvN3n-tidy-5e-custom-action-section\">\n          Action Section\n        </label>\n        <div class=\"form-fields\">\n          <input\n            type=\"text\"\n            id=\"i-o8WdxHamTy4ZvN3n-tidy-5e-custom-action-section\"\n            value=\"\"\n          />\n        </div>\n      </div>\n    </fieldset>\n  </div>\n</div>\n\n<style lang=\"scss\">\n  .sidebar-contents {\n    position: sticky;\n    top: var(--header-height);\n  }\n\n  .controls-gallery {\n    display: flex;\n    flex-direction: row;\n    gap: 1rem;\n    flex-wrap: wrap;\n    align-content: flex-start;\n    justify-content: flex-start;\n    container-type: inline-size;\n    padding-bottom: 1rem;\n\n    > * {\n      flex: 1 0 auto;\n    }\n\n    legend {\n      white-space: nowrap;\n    }\n\n    &.inverse {\n      background: var(--t5e-component-card-oninverse-default);\n    }\n  }\n\n  .span-all {\n    flex-basis: 100%;\n  }\n\n  .vertical-gallery {\n    display: flex;\n    flex-direction: column;\n    align-items: flex-start;\n    justify-content: flex-start;\n    gap: 0.25rem;\n  }\n\n  .wrapped-gallery {\n    display: flex;\n    flex-direction: row;\n    align-items: flex-start;\n    justify-content: flex-start;\n    flex-wrap: wrap;\n    gap: 0.25rem;\n  }\n\n  .show-before-850 {\n    display: none;\n  }\n\n  @container (width < 850px) {\n    .show-before-850 {\n      display: flex !important;\n    }\n  }\n  @container (width < 850px) {\n    .hide-before-850 {\n      display: none !important;\n    }\n  }\n  @container (width < 900px) {\n    .hide-before-900 {\n      display: none !important;\n    }\n  }\n  @container (width < 950px) {\n    .hide-before-950 {\n      display: none !important;\n    }\n  }\n  @container (width < 1000px) {\n    .hide-before-1000 {\n      display: none !important;\n    }\n  }\n</style>\n","import { CONSTANTS } from 'src/constants';\nimport { SvelteApplicationMixin } from 'src/mixins/SvelteApplicationMixin.svelte';\nimport type {\n  ApplicationConfiguration,\n  ApplicationRenderOptions,\n} from 'src/types/application.types';\nimport { mount } from 'svelte';\nimport ItemDebugSheet from './item/ItemDebugSheet.svelte';\nimport ItemHeaderStart from './item/parts/ContainerHeaderStart.svelte';\nimport type { Tab } from 'src/types/types';\nimport type { Item5e, ItemDescription } from 'src/types/item.types';\nimport { FoundryAdapter } from 'src/foundry/foundry-adapter';\n\nexport type ItemDebugSheetQuadroneContext = {\n  document: any;\n  editable: boolean;\n  item: Item5e;\n  itemDescriptions: ItemDescription[];\n  system: any;\n  tabs: Tab[];\n  unlocked: boolean;\n};\n\nexport class Tidy5eItemDebugSheetQuadrone extends SvelteApplicationMixin<ItemDebugSheetQuadroneContext>(\n  foundry.applications.sheets.ItemSheetV2\n) {\n  static DEFAULT_OPTIONS: Partial<\n    ApplicationConfiguration & { dragDrop: Partial<DragDropConfiguration>[] }\n  > = {\n    classes: [\n      CONSTANTS.MODULE_ID,\n      'sheet',\n      'item',\n      CONSTANTS.ITEM_TYPE_CONTAINER,\n      'app-v2',\n      'quadrone',\n    ],\n    tag: 'form',\n    window: {\n      frame: true,\n      positioned: true,\n      resizable: true,\n      controls: [],\n    },\n    position: {\n      width: 1600,\n      height: 2400,\n    },\n    actions: {},\n    dragDrop: [{ dropSelector: 'div' }],\n    submitOnClose: false,\n  };\n\n  _createComponent(node: HTMLElement): Record<string, any> {\n    return mount(ItemDebugSheet, {\n      target: node,\n      context: new Map<any, any>([\n        [CONSTANTS.SVELTE_CONTEXT.CONTEXT, this._context],\n      ]),\n    });\n  }\n\n  _createAdditionalComponents(node: HTMLElement) {\n    const windowHeader = this.element.querySelector('.window-header');\n\n    const sheetLock = mount(ItemHeaderStart, {\n      target: windowHeader,\n      anchor: windowHeader.querySelector('.window-title'),\n      context: new Map<string, any>([\n        [CONSTANTS.SVELTE_CONTEXT.CONTEXT, this._context],\n      ]),\n    });\n\n    return [sheetLock];\n  }\n\n  async _prepareContext(\n    options: ApplicationRenderOptions\n  ): Promise<ItemDebugSheetQuadroneContext> {\n    const rollData = this.document.getRollData();\n\n    // Enrich HTML description\n    const enrichmentOptions = {\n      secrets: this.document.isOwner,\n      relativeTo: this.item,\n      rollData: rollData,\n    };\n\n    const enriched = {\n      description: await TextEditor.enrichHTML(\n        this.document.system.description.value,\n        enrichmentOptions\n      ),\n      unidentified: await TextEditor.enrichHTML(\n        this.document.system.unidentified?.description,\n        enrichmentOptions\n      ),\n      chat: await TextEditor.enrichHTML(\n        this.document.system.description.chat,\n        enrichmentOptions\n      ),\n    };\n\n    const isIdentifiable = 'identified' in this.document.system;\n\n    const itemDescriptions: ItemDescription[] = [];\n    itemDescriptions.push({\n      enriched: enriched.description,\n      content: this.document.system.description.value,\n      field: 'system.description.value',\n      label: FoundryAdapter.localize('DND5E.Description'),\n    });\n\n    if (isIdentifiable && FoundryAdapter.userIsGm()) {\n      itemDescriptions.push({\n        enriched: enriched.unidentified,\n        content: this.document.system.unidentified.description,\n        field: 'system.unidentified.description',\n        label: FoundryAdapter.localize('DND5E.DescriptionUnidentified'),\n      });\n    }\n    itemDescriptions.push({\n      enriched: enriched.chat,\n      content: this.document.system.description.chat,\n      field: 'system.description.chat',\n      label: FoundryAdapter.localize('DND5E.DescriptionChat'),\n    });\n\n    return {\n      document: this.document,\n      editable: this.isEditable,\n      item: this.document,\n      itemDescriptions,\n      system: this.document.system,\n      tabs: [\n        {\n          content: {\n            type: 'html',\n            html: `<h1>Hallo </h1>`,\n            renderScheme: 'handlebars',\n          },\n          id: 'hallo-tab',\n          title: 'Say Hallo',\n        },\n        {\n          content: {\n            type: 'html',\n            html: `<h1>Welcome </h1>`,\n            renderScheme: 'handlebars',\n          },\n          id: 'welcome-tab',\n          title: 'Welcome',\n        },\n      ],\n      unlocked: FoundryAdapter.isSheetUnlocked(this.document),\n    };\n  }\n}\n","import { Tidy5eSheetsApi } from 'src/api/Tidy5eSheetsApi';\nimport { CONSTANTS } from 'src/constants';\nimport { TidyFlags } from 'src/foundry/TidyFlags';\n\nexport function initReadyHooks() {\n  assignDroppedSpellsToClassFilter();\n}\n\nfunction assignDroppedSpellsToClassFilter() {\n  Hooks.on('createItem', (item: any) => {\n    const parent = item.parent;\n    const api = Tidy5eSheetsApi._getApi();\n\n    if (!parent?.sheet?.element || !api.isTidy5eSheet(parent.sheet)) {\n      return;\n    }\n\n    if (item.type !== CONSTANTS.ITEM_TYPE_SPELL) {\n      return;\n    }\n\n    const classFilter = TidyFlags.classFilter.get(parent);\n\n    if (classFilter) {\n      item.update({\n        [`system.sourceClass`]: classFilter,\n      });\n    }\n  });\n}\n","import { FoundryAdapter } from './foundry/foundry-adapter';\nimport { Tidy5eCharacterSheet } from './sheets/classic/Tidy5eCharacterSheet.svelte';\nimport './scss/tidy5e.scss';\nimport {\n  SettingsProvider,\n  initSettings,\n  settings,\n} from './settings/settings.svelte';\nimport { Tidy5eItemSheetClassic } from './sheets/classic/Tidy5eItemSheetClassic.svelte';\nimport { Tidy5eNpcSheet } from './sheets/classic/Tidy5eNpcSheet.svelte';\nimport { Tidy5eVehicleSheet } from './sheets/classic/Tidy5eKgarVehicleSheet.svelte';\nimport { CONSTANTS } from './constants';\nimport { Tidy5eSheetsApi } from './api/Tidy5eSheetsApi';\nimport '../public/rpg-awesome/style/rpg-awesome.min.css';\nimport { initRuntime } from './runtime/runtime-init';\nimport { MigrationTally } from 'src/migrations/MigrationTally';\nimport { setupIntegrations } from './integration/integration';\nimport { TidyHooks } from './foundry/TidyHooks';\nimport { initKeybindings } from './keybindings/keybind-init';\nimport { Tidy5eGroupSheetClassic } from './sheets/classic/Tidy5eGroupSheetClassic.svelte';\nimport { DebugTools } from './utils/DebugTools';\nimport { Tidy5eContainerSheetClassic } from './sheets/classic/Tidy5eContainerSheetClassic.svelte';\nimport { Tidy5eContainerSheetQuadrone } from './sheets/quadrone/Tidy5eContainerSheetQuadrone.svelte';\nimport { Tidy5eItemDebugSheetQuadrone } from './sheets/quadrone/Tidy5eItemDebugSheetQuadrone.svelte';\nimport { initReadyHooks } from './features/ready-hooks';\nimport '@melloware/coloris/dist/coloris.css';\nimport { debug } from './utils/logging';\n\nHooks.once('init', () => {\n  DocumentSheetConfig.registerSheet(\n    Actor,\n    CONSTANTS.DND5E_SYSTEM_ID,\n    Tidy5eCharacterSheet,\n    {\n      types: [CONSTANTS.SHEET_TYPE_CHARACTER],\n      label: 'TIDY5E.Tidy5eCharacterSheetClassic',\n    }\n  );\n\n  DocumentSheetConfig.registerSheet(\n    Actor,\n    CONSTANTS.DND5E_SYSTEM_ID,\n    Tidy5eNpcSheet,\n    {\n      types: [CONSTANTS.SHEET_TYPE_NPC],\n      label: 'TIDY5E.Tidy5eNpcSheetClassic',\n    }\n  );\n\n  DocumentSheetConfig.registerSheet(\n    Actor,\n    CONSTANTS.DND5E_SYSTEM_ID,\n    Tidy5eVehicleSheet,\n    {\n      types: [CONSTANTS.SHEET_TYPE_VEHICLE],\n      label: 'TIDY5E.Tidy5eVehicleSheetClassic',\n    }\n  );\n\n  const supportedItemTypes = [\n    CONSTANTS.ITEM_TYPE_BACKGROUND,\n    CONSTANTS.ITEM_TYPE_CLASS,\n    CONSTANTS.ITEM_TYPE_CONSUMABLE,\n    CONSTANTS.ITEM_TYPE_EQUIPMENT,\n    CONSTANTS.ITEM_TYPE_FACILITY,\n    CONSTANTS.ITEM_TYPE_FEAT,\n    CONSTANTS.ITEM_TYPE_LOOT,\n    CONSTANTS.ITEM_TYPE_RACE,\n    CONSTANTS.ITEM_TYPE_SPELL,\n    CONSTANTS.ITEM_TYPE_SUBCLASS,\n    CONSTANTS.ITEM_TYPE_TOOL,\n    CONSTANTS.ITEM_TYPE_WEAPON,\n  ];\n\n  DocumentSheetConfig.registerSheet(\n    Item,\n    CONSTANTS.DND5E_SYSTEM_ID,\n    Tidy5eItemSheetClassic,\n    {\n      types: supportedItemTypes,\n      label: 'TIDY5E.Tidy5eItemSheetClassic',\n    }\n  );\n\n  DocumentSheetConfig.registerSheet(\n    Item,\n    CONSTANTS.DND5E_SYSTEM_ID,\n    Tidy5eContainerSheetClassic,\n    {\n      types: [CONSTANTS.SHEET_TYPE_CONTAINER],\n      label: 'TIDY5E.Tidy5eContainerSheetClassic',\n    }\n  );\n\n  DocumentSheetConfig.registerSheet(\n    Actor,\n    CONSTANTS.DND5E_SYSTEM_ID,\n    Tidy5eGroupSheetClassic,\n    {\n      types: [CONSTANTS.SHEET_TYPE_GROUP],\n      label: 'TIDY5E.Tidy5eGroupSheetClassic',\n    }\n  );\n\n  initSettings();\n  initRuntime();\n  initKeybindings();\n\n  const thisIsKGarsVisualOverhaulBranch = false; // When the first draft of the container overhaul sheet is done, remove this extra layer and let it depend on the debug setting alone.\n\n  if (settings.value.debug && thisIsKGarsVisualOverhaulBranch) {\n    DocumentSheetConfig.registerSheet(\n      Item,\n      CONSTANTS.DND5E_SYSTEM_ID,\n      Tidy5eContainerSheetQuadrone,\n      {\n        types: [CONSTANTS.SHEET_TYPE_CONTAINER],\n        label: 'Tidy 5e Container Sheet - Quadrone',\n      }\n    );\n\n    DocumentSheetConfig.registerSheet(\n      Item,\n      CONSTANTS.DND5E_SYSTEM_ID,\n      Tidy5eItemDebugSheetQuadrone,\n      {\n        types: supportedItemTypes,\n        label: 'Tidy 5e Debug Item Sheet (Visual Overhaul)',\n      }\n    );\n  }\n});\n\nHooks.once('ready', async () => {\n  const tidy5eModule = FoundryAdapter.getModule(CONSTANTS.MODULE_ID);\n  const api = Tidy5eSheetsApi._getApi();\n  tidy5eModule.api = api;\n\n  TidyHooks.tidy5eSheetsReady(api);\n\n  setupIntegrations(api);\n\n  handleMigrationNotification();\n\n  initReadyHooks();\n\n  DebugTools.onReady(api);\n});\n\nfunction handleMigrationNotification() {\n  let tally = SettingsProvider.settings.migrationsConfirmationTally.get();\n\n  if (FoundryAdapter.userIsGm() && tally === 0) {\n    debug(\n      'Skipping migration notification because this appears to be a new Tidy installation.'\n    );\n    tally = MigrationTally;\n  }\n\n  if (FoundryAdapter.userIsGm() && tally < MigrationTally) {\n    let migrationNotification = {\n      user: game.user._id,\n      whisper: game.users.filter((u: any) => u.isGM).map((u: any) => u._id),\n      content: `\n      <h2>${game.i18n.localize('TIDY5E.ModuleName')}</h2>\n      <p>\n        ${game.i18n.localize('TIDY5E.Settings.Migrations.chatNotification')}\n      </p>\n      `,\n    };\n\n    ChatMessage.create(migrationNotification, {});\n\n    FoundryAdapter.setTidySetting(\n      'migrationsConfirmationTally',\n      MigrationTally\n    );\n  }\n}\n"],"names":["i","a","b","v","s","source","e.state_unsafe_mutation","prop","e.state_descriptors_fixed","n","value","key","e.state_prototype_fixed","d","derived","child","e.effect_orphan","e.effect_in_unowned_derived","e.effect_in_teardown","effect","push","e","teardown","transition","sibling","is_micro_task_queued","error","component_context","index","e.effect_update_depth_exceeded","e.state_unsafe_local_read","component","get","element","event","html","root","t","text","events","unmount","update","state","fn","j","node","snippet","action","inited","r","f","o","clsx","_clsx","handle","prev","now","linear","animation","to","run","block","delay","tick","keyframes","styles","set","props","l","p","e.props_invalid_value","boundary","notify","u","h","Colord","c","on_click","$.set","$.user_effect","$.each","$.get","$.set_class","$.clsx","$.set_attribute","$.toggle_class","$.bind_this","$.derived","$.prop","$.template_effect","$.set_text","$.mutate","m","$$anchor","$.noop","$.index","$$item","save","apply","ActivitiesSettingsTab","x","y","sx","sy","crossfade","$.proxy","$.snippet","$.animation","$.transition","$.event","$.derived_safe_equal","$.bind_value","$.bind_select_value","on_click_1","$.action","document","on_contextmenu","on_click_2","$.html","$.state","expansions","$.rest_props","handleHeaderRowClick","$.set_value","$.await","on_mousedown","on_click_3","secret","$.key","$.update","$.effect_root","on_change","increment","controller","UserPreferencesService","$.set_checked","QuadroneItemDescriptionsTab","ContainerSheet","$.set_selected","NpcSheetRuntime","$.safe_get","$.bind_checked","AssignSpellsToSourceClasses","$.bind_content_editable","on_click_4","$.exclude_from_object","singleton","Bar","context","on_mouseover","CharacterSheetRuntime","GroupSheetRuntime","uses","settings","Info","animate","options","$.spread_props","$.set_style","w","img","name","target","features","advancement","activities","window","Math","undefined","init","Coloris","ItemHeaderStart"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,56,59,60,66,81,82,83,208,209,210,528]}